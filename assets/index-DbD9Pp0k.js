import{a as zf,b as t3,g as oi,r as g,u as tt,c as Hb,L as $e,d as jn,e as wA,f as CA,R as r3,h as n3,i as Le,N as Ud,j as a3,B as i3}from"./vendor-react-BMsfgiGx.js";import{i as s3,g as l3,a as o3,p as c3,b as u3,c as d3,o as m3,d as je,u as Ve,s as kt,e as f3,f as p3,h as h3,G as v3,j as g3,k as x3,l as pt,m as rl,w as Se,n as Qe,q as $t,r as ze,t as _e,v as Ae,x as Ln,T as Ee,y as Ir,z as kf,A as Ot,B as cr,C as Ls,D as $s,E as In,F as ss,H as Vb,I as b3,J as uu}from"./vendor-firebase-LntcAirY.js";import{H as Mx,B as xn,F as y3,G as Bs,S as jr,L as D1,a as j3,C as Us,b as qc,D as EA,c as jm,U as _3,d as N3,e as P1,X as Xi,M as S3,f as mm,g as w3,P as C3,h as E3,i as A3,j as z3,k as Qb,l as fm,m as k3,n as O3,T as D3,I as P3,o as M3,Y as T3,A as Os,p as so,q as Ht,Z as AA,r as zA,s as po,t as ns,u as _m,v as Rc,w as kA,x as Yb,y as Tx,E as co,z as q3,J as M1,K as R3,N as I3,O as L3,R as $3,Q as B3,V as U3,W as Ic,_ as Nm,$ as Uv,a0 as F3,a1 as G3,a2 as qx,a3 as Fv,a4 as Fd,a5 as H3,a6 as V3,a7 as Q3,a8 as Y3,a9 as K3}from"./vendor-icons-B5C-ccqU.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}})();var Gv={exports:{}},Nc={};var T1;function W3(){if(T1)return Nc;T1=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function n(a,l,o){var u=null;if(o!==void 0&&(u=""+o),l.key!==void 0&&(u=""+l.key),"key"in l){o={};for(var d in l)d!=="key"&&(o[d]=l[d])}else o=l;return l=o.ref,{$$typeof:e,type:a,key:u,ref:l!==void 0?l:null,props:o}}return Nc.Fragment=r,Nc.jsx=n,Nc.jsxs=n,Nc}var q1;function X3(){return q1||(q1=1,Gv.exports=W3()),Gv.exports}var t=X3(),Hv={exports:{}},Sc={},Vv={exports:{}},Qv={};var R1;function Z3(){return R1||(R1=1,(function(e){function r(L,I){var U=L.length;L.push(I);e:for(;0<U;){var B=U-1>>>1,T=L[B];if(0<l(T,I))L[B]=I,L[U]=T,U=B;else break e}}function n(L){return L.length===0?null:L[0]}function a(L){if(L.length===0)return null;var I=L[0],U=L.pop();if(U!==I){L[0]=U;e:for(var B=0,T=L.length,Z=T>>>1;B<Z;){var H=2*(B+1)-1,ce=L[H],xe=H+1,fe=L[xe];if(0>l(ce,U))xe<T&&0>l(fe,ce)?(L[B]=fe,L[xe]=U,B=xe):(L[B]=ce,L[H]=U,B=H);else if(xe<T&&0>l(fe,U))L[B]=fe,L[xe]=U,B=xe;else break e}}return I}function l(L,I){var U=L.sortIndex-I.sortIndex;return U!==0?U:L.id-I.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var m=[],p=[],h=1,v=null,b=3,x=!1,j=!1,_=!1,w=!1,C=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function A(L){for(var I=n(p);I!==null;){if(I.callback===null)a(p);else if(I.startTime<=L)a(p),I.sortIndex=I.expirationTime,r(m,I);else break;I=n(p)}}function z(L){if(_=!1,A(L),!j)if(n(m)!==null)j=!0,k||(k=!0,M());else{var I=n(p);I!==null&&X(z,I.startTime-L)}}var k=!1,P=-1,D=5,$=-1;function F(){return w?!0:!(e.unstable_now()-$<D)}function Y(){if(w=!1,k){var L=e.unstable_now();$=L;var I=!0;try{e:{j=!1,_&&(_=!1,E(P),P=-1),x=!0;var U=b;try{t:{for(A(L),v=n(m);v!==null&&!(v.expirationTime>L&&F());){var B=v.callback;if(typeof B=="function"){v.callback=null,b=v.priorityLevel;var T=B(v.expirationTime<=L);if(L=e.unstable_now(),typeof T=="function"){v.callback=T,A(L),I=!0;break t}v===n(m)&&a(m),A(L)}else a(m);v=n(m)}if(v!==null)I=!0;else{var Z=n(p);Z!==null&&X(z,Z.startTime-L),I=!1}}break e}finally{v=null,b=U,x=!1}I=void 0}}finally{I?M():k=!1}}}var M;if(typeof S=="function")M=function(){S(Y)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,ee=K.port2;K.port1.onmessage=Y,M=function(){ee.postMessage(null)}}else M=function(){C(Y,0)};function X(L,I){P=C(function(){L(e.unstable_now())},I)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(L){L.callback=null},e.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<L?Math.floor(1e3/L):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(L){switch(b){case 1:case 2:case 3:var I=3;break;default:I=b}var U=b;b=I;try{return L()}finally{b=U}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(L,I){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var U=b;b=L;try{return I()}finally{b=U}},e.unstable_scheduleCallback=function(L,I,U){var B=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?B+U:B):U=B,L){case 1:var T=-1;break;case 2:T=250;break;case 5:T=1073741823;break;case 4:T=1e4;break;default:T=5e3}return T=U+T,L={id:h++,callback:I,priorityLevel:L,startTime:U,expirationTime:T,sortIndex:-1},U>B?(L.sortIndex=U,r(p,L),n(m)===null&&L===n(p)&&(_?(E(P),P=-1):_=!0,X(z,U-B))):(L.sortIndex=T,r(m,L),j||x||(j=!0,k||(k=!0,M()))),L},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(L){var I=b;return function(){var U=b;b=I;try{return L.apply(this,arguments)}finally{b=U}}}})(Qv)),Qv}var I1;function J3(){return I1||(I1=1,Vv.exports=Z3()),Vv.exports}var L1;function e5(){if(L1)return Sc;L1=1;var e=J3(),r=zf(),n=t3();function a(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function u(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function d(i){if(i.tag===31){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function m(i){if(o(i)!==i)throw Error(a(188))}function p(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(a(188));return s!==i?null:i}for(var c=i,f=s;;){var y=c.return;if(y===null)break;var N=y.alternate;if(N===null){if(f=y.return,f!==null){c=f;continue}break}if(y.child===N.child){for(N=y.child;N;){if(N===c)return m(y),i;if(N===f)return m(y),s;N=N.sibling}throw Error(a(188))}if(c.return!==f.return)c=y,f=N;else{for(var O=!1,q=y.child;q;){if(q===c){O=!0,c=y,f=N;break}if(q===f){O=!0,f=y,c=N;break}q=q.sibling}if(!O){for(q=N.child;q;){if(q===c){O=!0,c=N,f=y;break}if(q===f){O=!0,f=N,c=y;break}q=q.sibling}if(!O)throw Error(a(189))}}if(c.alternate!==f)throw Error(a(190))}if(c.tag!==3)throw Error(a(188));return c.stateNode.current===c?i:s}function h(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=h(i),s!==null)return s;i=i.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),E=Symbol.for("react.consumer"),S=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),$=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),Y=Symbol.iterator;function M(i){return i===null||typeof i!="object"?null:(i=Y&&i[Y]||i["@@iterator"],typeof i=="function"?i:null)}var K=Symbol.for("react.client.reference");function ee(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===K?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case _:return"Fragment";case C:return"Profiler";case w:return"StrictMode";case z:return"Suspense";case k:return"SuspenseList";case $:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case j:return"Portal";case S:return i.displayName||"Context";case E:return(i._context.displayName||"Context")+".Consumer";case A:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case P:return s=i.displayName||null,s!==null?s:ee(i.type)||"Memo";case D:s=i._payload,i=i._init;try{return ee(i(s))}catch{}}return null}var X=Array.isArray,L=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U={pending:!1,data:null,method:null,action:null},B=[],T=-1;function Z(i){return{current:i}}function H(i){0>T||(i.current=B[T],B[T]=null,T--)}function ce(i,s){T++,B[T]=i.current,i.current=s}var xe=Z(null),fe=Z(null),G=Z(null),ve=Z(null);function De(i,s){switch(ce(G,s),ce(fe,i),ce(xe,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?t1(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=t1(s),i=r1(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}H(xe),ce(xe,i)}function de(){H(xe),H(fe),H(G)}function we(i){i.memoizedState!==null&&ce(ve,i);var s=xe.current,c=r1(s,i.type);s!==c&&(ce(fe,i),ce(xe,c))}function R(i){fe.current===i&&(H(xe),H(fe)),ve.current===i&&(H(ve),bc._currentValue=U)}var ae,Ce;function ke(i){if(ae===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);ae=s&&s[1]||"",Ce=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ae+i+Ce}var Ke=!1;function et(i,s){if(!i||Ke)return"";Ke=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(pe){var ue=pe}Reflect.construct(i,[],ye)}else{try{ye.call()}catch(pe){ue=pe}i.call(ye.prototype)}}else{try{throw Error()}catch(pe){ue=pe}(ye=i())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(pe){if(pe&&ue&&typeof pe.stack=="string")return[pe.stack,ue.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var N=f.DetermineComponentFrameRoot(),O=N[0],q=N[1];if(O&&q){var Q=O.split(`
`),oe=q.split(`
`);for(y=f=0;f<Q.length&&!Q[f].includes("DetermineComponentFrameRoot");)f++;for(;y<oe.length&&!oe[y].includes("DetermineComponentFrameRoot");)y++;if(f===Q.length||y===oe.length)for(f=Q.length-1,y=oe.length-1;1<=f&&0<=y&&Q[f]!==oe[y];)y--;for(;1<=f&&0<=y;f--,y--)if(Q[f]!==oe[y]){if(f!==1||y!==1)do if(f--,y--,0>y||Q[f]!==oe[y]){var ge=`
`+Q[f].replace(" at new "," at ");return i.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",i.displayName)),ge}while(1<=f&&0<=y);break}}}finally{Ke=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?ke(c):""}function rt(i,s){switch(i.tag){case 26:case 27:case 5:return ke(i.type);case 16:return ke("Lazy");case 13:return i.child!==s&&s!==null?ke("Suspense Fallback"):ke("Suspense");case 19:return ke("SuspenseList");case 0:case 15:return et(i.type,!1);case 11:return et(i.type.render,!1);case 1:return et(i.type,!0);case 31:return ke("Activity");default:return""}}function Yt(i){try{var s="",c=null;do s+=rt(i,c),c=i,i=i.return;while(i);return s}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var mr=Object.prototype.hasOwnProperty,fr=e.unstable_scheduleCallback,$r=e.unstable_cancelCallback,he=e.unstable_shouldYield,Pe=e.unstable_requestPaint,Ie=e.unstable_now,Ye=e.unstable_getCurrentPriorityLevel,nt=e.unstable_ImmediatePriority,qt=e.unstable_UserBlockingPriority,Kt=e.unstable_NormalPriority,se=e.unstable_LowPriority,Oe=e.unstable_IdlePriority,dt=e.log,te=e.unstable_setDisableYieldValue,W=null,ie=null;function Ne(i){if(typeof dt=="function"&&te(i),ie&&typeof ie.setStrictMode=="function")try{ie.setStrictMode(W,i)}catch{}}var We=Math.clz32?Math.clz32:Tr,Dt=Math.log,Kr=Math.LN2;function Tr(i){return i>>>=0,i===0?32:31-(Dt(i)/Kr|0)|0}var la=256,ul=262144,dl=4194304;function Ea(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ml(i,s,c){var f=i.pendingLanes;if(f===0)return 0;var y=0,N=i.suspendedLanes,O=i.pingedLanes;i=i.warmLanes;var q=f&134217727;return q!==0?(f=q&~N,f!==0?y=Ea(f):(O&=q,O!==0?y=Ea(O):c||(c=q&~i,c!==0&&(y=Ea(c))))):(q=f&~N,q!==0?y=Ea(q):O!==0?y=Ea(O):c||(c=f&~i,c!==0&&(y=Ea(c)))),y===0?0:s!==0&&s!==y&&(s&N)===0&&(N=y&-y,c=s&-s,N>=c||N===32&&(c&4194048)!==0)?s:y}function Qn(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function kp(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function re(){var i=dl;return dl<<=1,(dl&62914560)===0&&(dl=4194304),i}function Fe(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function gt(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Nn(i,s,c,f,y,N){var O=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var q=i.entanglements,Q=i.expirationTimes,oe=i.hiddenUpdates;for(c=O&~c;0<c;){var ge=31-We(c),ye=1<<ge;q[ge]=0,Q[ge]=-1;var ue=oe[ge];if(ue!==null)for(oe[ge]=null,ge=0;ge<ue.length;ge++){var pe=ue[ge];pe!==null&&(pe.lane&=-536870913)}c&=~ye}f!==0&&fl(i,f,0),N!==0&&y===0&&i.tag!==0&&(i.suspendedLanes|=N&~(O&~s))}function fl(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var f=31-We(s);i.entangledLanes|=s,i.entanglements[f]=i.entanglements[f]|1073741824|c&261930}function ds(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var f=31-We(c),y=1<<f;y&s|i[f]&s&&(i[f]|=s),c&=~y}}function Lj(i,s){var c=s&-s;return c=(c&42)!==0?1:Op(c),(c&(i.suspendedLanes|s))!==0?0:c}function Op(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Dp(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function $j(){var i=I.p;return i!==0?i:(i=window.event,i===void 0?32:w1(i.type))}function Bj(i,s){var c=I.p;try{return I.p=i,s()}finally{I.p=c}}var yi=Math.random().toString(36).slice(2),Er="__reactFiber$"+yi,Wr="__reactProps$"+yi,pl="__reactContainer$"+yi,Pp="__reactEvents$"+yi,GM="__reactListeners$"+yi,HM="__reactHandles$"+yi,Uj="__reactResources$"+yi,Mo="__reactMarker$"+yi;function Mp(i){delete i[Er],delete i[Wr],delete i[Pp],delete i[GM],delete i[HM]}function hl(i){var s=i[Er];if(s)return s;for(var c=i.parentNode;c;){if(s=c[pl]||c[Er]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=c1(i);i!==null;){if(c=i[Er])return c;i=c1(i)}return s}i=c,c=i.parentNode}return null}function vl(i){if(i=i[Er]||i[pl]){var s=i.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return i}return null}function To(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(a(33))}function gl(i){var s=i[Uj];return s||(s=i[Uj]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function pr(i){i[Mo]=!0}var Fj=new Set,Gj={};function ms(i,s){xl(i,s),xl(i+"Capture",s)}function xl(i,s){for(Gj[i]=s,i=0;i<s.length;i++)Fj.add(s[i])}var VM=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Hj={},Vj={};function QM(i){return mr.call(Vj,i)?!0:mr.call(Hj,i)?!1:VM.test(i)?Vj[i]=!0:(Hj[i]=!0,!1)}function ku(i,s,c){if(QM(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function Ou(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function Aa(i,s,c,f){if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+f)}}function Sn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Qj(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function YM(i,s,c){var f=Object.getOwnPropertyDescriptor(i.constructor.prototype,s);if(!i.hasOwnProperty(s)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var y=f.get,N=f.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return y.call(this)},set:function(O){c=""+O,N.call(this,O)}}),Object.defineProperty(i,s,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(O){c=""+O},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function Tp(i){if(!i._valueTracker){var s=Qj(i)?"checked":"value";i._valueTracker=YM(i,s,""+i[s])}}function Yj(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),f="";return i&&(f=Qj(i)?i.checked?"true":"false":i.value),i=f,i!==c?(s.setValue(i),!0):!1}function Du(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var KM=/[\n"\\]/g;function wn(i){return i.replace(KM,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function qp(i,s,c,f,y,N,O,q){i.name="",O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?i.type=O:i.removeAttribute("type"),s!=null?O==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+Sn(s)):i.value!==""+Sn(s)&&(i.value=""+Sn(s)):O!=="submit"&&O!=="reset"||i.removeAttribute("value"),s!=null?Rp(i,O,Sn(s)):c!=null?Rp(i,O,Sn(c)):f!=null&&i.removeAttribute("value"),y==null&&N!=null&&(i.defaultChecked=!!N),y!=null&&(i.checked=y&&typeof y!="function"&&typeof y!="symbol"),q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?i.name=""+Sn(q):i.removeAttribute("name")}function Kj(i,s,c,f,y,N,O,q){if(N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(i.type=N),s!=null||c!=null){if(!(N!=="submit"&&N!=="reset"||s!=null)){Tp(i);return}c=c!=null?""+Sn(c):"",s=s!=null?""+Sn(s):c,q||s===i.value||(i.value=s),i.defaultValue=s}f=f??y,f=typeof f!="function"&&typeof f!="symbol"&&!!f,i.checked=q?i.checked:!!f,i.defaultChecked=!!f,O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(i.name=O),Tp(i)}function Rp(i,s,c){s==="number"&&Du(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function bl(i,s,c,f){if(i=i.options,s){s={};for(var y=0;y<c.length;y++)s["$"+c[y]]=!0;for(c=0;c<i.length;c++)y=s.hasOwnProperty("$"+i[c].value),i[c].selected!==y&&(i[c].selected=y),y&&f&&(i[c].defaultSelected=!0)}else{for(c=""+Sn(c),s=null,y=0;y<i.length;y++){if(i[y].value===c){i[y].selected=!0,f&&(i[y].defaultSelected=!0);return}s!==null||i[y].disabled||(s=i[y])}s!==null&&(s.selected=!0)}}function Wj(i,s,c){if(s!=null&&(s=""+Sn(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+Sn(c):""}function Xj(i,s,c,f){if(s==null){if(f!=null){if(c!=null)throw Error(a(92));if(X(f)){if(1<f.length)throw Error(a(93));f=f[0]}c=f}c==null&&(c=""),s=c}c=Sn(s),i.defaultValue=c,f=i.textContent,f===c&&f!==""&&f!==null&&(i.value=f),Tp(i)}function yl(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var WM=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zj(i,s,c){var f=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":f?i.setProperty(s,c):typeof c!="number"||c===0||WM.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function Jj(i,s,c){if(s!=null&&typeof s!="object")throw Error(a(62));if(i=i.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?i.setProperty(f,""):f==="float"?i.cssFloat="":i[f]="");for(var y in s)f=s[y],s.hasOwnProperty(y)&&c[y]!==f&&Zj(i,y,f)}else for(var N in s)s.hasOwnProperty(N)&&Zj(i,N,s[N])}function Ip(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var XM=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ZM=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pu(i){return ZM.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function za(){}var Lp=null;function $p(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var jl=null,_l=null;function e0(i){var s=vl(i);if(s&&(i=s.stateNode)){var c=i[Wr]||null;e:switch(i=s.stateNode,s.type){case"input":if(qp(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+wn(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var f=c[s];if(f!==i&&f.form===i.form){var y=f[Wr]||null;if(!y)throw Error(a(90));qp(f,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(s=0;s<c.length;s++)f=c[s],f.form===i.form&&Yj(f)}break e;case"textarea":Wj(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&bl(i,!!c.multiple,s,!1)}}}var Bp=!1;function t0(i,s,c){if(Bp)return i(s,c);Bp=!0;try{var f=i(s);return f}finally{if(Bp=!1,(jl!==null||_l!==null)&&(yd(),jl&&(s=jl,i=_l,_l=jl=null,e0(s),i)))for(s=0;s<i.length;s++)e0(i[s])}}function qo(i,s){var c=i.stateNode;if(c===null)return null;var f=c[Wr]||null;if(f===null)return null;c=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(a(231,s,typeof c));return c}var ka=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Up=!1;if(ka)try{var Ro={};Object.defineProperty(Ro,"passive",{get:function(){Up=!0}}),window.addEventListener("test",Ro,Ro),window.removeEventListener("test",Ro,Ro)}catch{Up=!1}var ji=null,Fp=null,Mu=null;function r0(){if(Mu)return Mu;var i,s=Fp,c=s.length,f,y="value"in ji?ji.value:ji.textContent,N=y.length;for(i=0;i<c&&s[i]===y[i];i++);var O=c-i;for(f=1;f<=O&&s[c-f]===y[N-f];f++);return Mu=y.slice(i,1<f?1-f:void 0)}function Tu(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function qu(){return!0}function n0(){return!1}function Xr(i){function s(c,f,y,N,O){this._reactName=c,this._targetInst=y,this.type=f,this.nativeEvent=N,this.target=O,this.currentTarget=null;for(var q in i)i.hasOwnProperty(q)&&(c=i[q],this[q]=c?c(N):N[q]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?qu:n0,this.isPropagationStopped=n0,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=qu)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=qu)},persist:function(){},isPersistent:qu}),s}var fs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ru=Xr(fs),Io=v({},fs,{view:0,detail:0}),JM=Xr(Io),Gp,Hp,Lo,Iu=v({},Io,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qp,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Lo&&(Lo&&i.type==="mousemove"?(Gp=i.screenX-Lo.screenX,Hp=i.screenY-Lo.screenY):Hp=Gp=0,Lo=i),Gp)},movementY:function(i){return"movementY"in i?i.movementY:Hp}}),a0=Xr(Iu),eT=v({},Iu,{dataTransfer:0}),tT=Xr(eT),rT=v({},Io,{relatedTarget:0}),Vp=Xr(rT),nT=v({},fs,{animationName:0,elapsedTime:0,pseudoElement:0}),aT=Xr(nT),iT=v({},fs,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),sT=Xr(iT),lT=v({},fs,{data:0}),i0=Xr(lT),oT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dT(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=uT[i])?!!s[i]:!1}function Qp(){return dT}var mT=v({},Io,{key:function(i){if(i.key){var s=oT[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Tu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?cT[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qp,charCode:function(i){return i.type==="keypress"?Tu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Tu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),fT=Xr(mT),pT=v({},Iu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),s0=Xr(pT),hT=v({},Io,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qp}),vT=Xr(hT),gT=v({},fs,{propertyName:0,elapsedTime:0,pseudoElement:0}),xT=Xr(gT),bT=v({},Iu,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),yT=Xr(bT),jT=v({},fs,{newState:0,oldState:0}),_T=Xr(jT),NT=[9,13,27,32],Yp=ka&&"CompositionEvent"in window,$o=null;ka&&"documentMode"in document&&($o=document.documentMode);var ST=ka&&"TextEvent"in window&&!$o,l0=ka&&(!Yp||$o&&8<$o&&11>=$o),o0=" ",c0=!1;function u0(i,s){switch(i){case"keyup":return NT.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function d0(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Nl=!1;function wT(i,s){switch(i){case"compositionend":return d0(s);case"keypress":return s.which!==32?null:(c0=!0,o0);case"textInput":return i=s.data,i===o0&&c0?null:i;default:return null}}function CT(i,s){if(Nl)return i==="compositionend"||!Yp&&u0(i,s)?(i=r0(),Mu=Fp=ji=null,Nl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return l0&&s.locale!=="ko"?null:s.data;default:return null}}var ET={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function m0(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!ET[i.type]:s==="textarea"}function f0(i,s,c,f){jl?_l?_l.push(f):_l=[f]:jl=f,s=Ed(s,"onChange"),0<s.length&&(c=new Ru("onChange","change",null,c,f),i.push({event:c,listeners:s}))}var Bo=null,Uo=null;function AT(i){KN(i,0)}function Lu(i){var s=To(i);if(Yj(s))return i}function p0(i,s){if(i==="change")return s}var h0=!1;if(ka){var Kp;if(ka){var Wp="oninput"in document;if(!Wp){var v0=document.createElement("div");v0.setAttribute("oninput","return;"),Wp=typeof v0.oninput=="function"}Kp=Wp}else Kp=!1;h0=Kp&&(!document.documentMode||9<document.documentMode)}function g0(){Bo&&(Bo.detachEvent("onpropertychange",x0),Uo=Bo=null)}function x0(i){if(i.propertyName==="value"&&Lu(Uo)){var s=[];f0(s,Uo,i,$p(i)),t0(AT,s)}}function zT(i,s,c){i==="focusin"?(g0(),Bo=s,Uo=c,Bo.attachEvent("onpropertychange",x0)):i==="focusout"&&g0()}function kT(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Lu(Uo)}function OT(i,s){if(i==="click")return Lu(s)}function DT(i,s){if(i==="input"||i==="change")return Lu(s)}function PT(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var on=typeof Object.is=="function"?Object.is:PT;function Fo(i,s){if(on(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),f=Object.keys(s);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var y=c[f];if(!mr.call(s,y)||!on(i[y],s[y]))return!1}return!0}function b0(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function y0(i,s){var c=b0(i);i=0;for(var f;c;){if(c.nodeType===3){if(f=i+c.textContent.length,i<=s&&f>=s)return{node:c,offset:s-i};i=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=b0(c)}}function j0(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?j0(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function _0(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Du(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=Du(i.document)}return s}function Xp(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var MT=ka&&"documentMode"in document&&11>=document.documentMode,Sl=null,Zp=null,Go=null,Jp=!1;function N0(i,s,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Jp||Sl==null||Sl!==Du(f)||(f=Sl,"selectionStart"in f&&Xp(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Go&&Fo(Go,f)||(Go=f,f=Ed(Zp,"onSelect"),0<f.length&&(s=new Ru("onSelect","select",null,s,c),i.push({event:s,listeners:f}),s.target=Sl)))}function ps(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var wl={animationend:ps("Animation","AnimationEnd"),animationiteration:ps("Animation","AnimationIteration"),animationstart:ps("Animation","AnimationStart"),transitionrun:ps("Transition","TransitionRun"),transitionstart:ps("Transition","TransitionStart"),transitioncancel:ps("Transition","TransitionCancel"),transitionend:ps("Transition","TransitionEnd")},eh={},S0={};ka&&(S0=document.createElement("div").style,"AnimationEvent"in window||(delete wl.animationend.animation,delete wl.animationiteration.animation,delete wl.animationstart.animation),"TransitionEvent"in window||delete wl.transitionend.transition);function hs(i){if(eh[i])return eh[i];if(!wl[i])return i;var s=wl[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in S0)return eh[i]=s[c];return i}var w0=hs("animationend"),C0=hs("animationiteration"),E0=hs("animationstart"),TT=hs("transitionrun"),qT=hs("transitionstart"),RT=hs("transitioncancel"),A0=hs("transitionend"),z0=new Map,th="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");th.push("scrollEnd");function Yn(i,s){z0.set(i,s),ms(s,[i])}var $u=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Cn=[],Cl=0,rh=0;function Bu(){for(var i=Cl,s=rh=Cl=0;s<i;){var c=Cn[s];Cn[s++]=null;var f=Cn[s];Cn[s++]=null;var y=Cn[s];Cn[s++]=null;var N=Cn[s];if(Cn[s++]=null,f!==null&&y!==null){var O=f.pending;O===null?y.next=y:(y.next=O.next,O.next=y),f.pending=y}N!==0&&k0(c,y,N)}}function Uu(i,s,c,f){Cn[Cl++]=i,Cn[Cl++]=s,Cn[Cl++]=c,Cn[Cl++]=f,rh|=f,i.lanes|=f,i=i.alternate,i!==null&&(i.lanes|=f)}function nh(i,s,c,f){return Uu(i,s,c,f),Fu(i)}function vs(i,s){return Uu(i,null,null,s),Fu(i)}function k0(i,s,c){i.lanes|=c;var f=i.alternate;f!==null&&(f.lanes|=c);for(var y=!1,N=i.return;N!==null;)N.childLanes|=c,f=N.alternate,f!==null&&(f.childLanes|=c),N.tag===22&&(i=N.stateNode,i===null||i._visibility&1||(y=!0)),i=N,N=N.return;return i.tag===3?(N=i.stateNode,y&&s!==null&&(y=31-We(c),i=N.hiddenUpdates,f=i[y],f===null?i[y]=[s]:f.push(s),s.lane=c|536870912),N):null}function Fu(i){if(50<mc)throw mc=0,mv=null,Error(a(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var El={};function IT(i,s,c,f){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cn(i,s,c,f){return new IT(i,s,c,f)}function ah(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Oa(i,s){var c=i.alternate;return c===null?(c=cn(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function O0(i,s){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Gu(i,s,c,f,y,N){var O=0;if(f=i,typeof i=="function")ah(i)&&(O=1);else if(typeof i=="string")O=Fq(i,c,xe.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case $:return i=cn(31,c,s,y),i.elementType=$,i.lanes=N,i;case _:return gs(c.children,y,N,s);case w:O=8,y|=24;break;case C:return i=cn(12,c,s,y|2),i.elementType=C,i.lanes=N,i;case z:return i=cn(13,c,s,y),i.elementType=z,i.lanes=N,i;case k:return i=cn(19,c,s,y),i.elementType=k,i.lanes=N,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case S:O=10;break e;case E:O=9;break e;case A:O=11;break e;case P:O=14;break e;case D:O=16,f=null;break e}O=29,c=Error(a(130,i===null?"null":typeof i,"")),f=null}return s=cn(O,c,s,y),s.elementType=i,s.type=f,s.lanes=N,s}function gs(i,s,c,f){return i=cn(7,i,f,s),i.lanes=c,i}function ih(i,s,c){return i=cn(6,i,null,s),i.lanes=c,i}function D0(i){var s=cn(18,null,null,0);return s.stateNode=i,s}function sh(i,s,c){return s=cn(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var P0=new WeakMap;function En(i,s){if(typeof i=="object"&&i!==null){var c=P0.get(i);return c!==void 0?c:(s={value:i,source:s,stack:Yt(s)},P0.set(i,s),s)}return{value:i,source:s,stack:Yt(s)}}var Al=[],zl=0,Hu=null,Ho=0,An=[],zn=0,_i=null,oa=1,ca="";function Da(i,s){Al[zl++]=Ho,Al[zl++]=Hu,Hu=i,Ho=s}function M0(i,s,c){An[zn++]=oa,An[zn++]=ca,An[zn++]=_i,_i=i;var f=oa;i=ca;var y=32-We(f)-1;f&=~(1<<y),c+=1;var N=32-We(s)+y;if(30<N){var O=y-y%5;N=(f&(1<<O)-1).toString(32),f>>=O,y-=O,oa=1<<32-We(s)+y|c<<y|f,ca=N+i}else oa=1<<N|c<<y|f,ca=i}function lh(i){i.return!==null&&(Da(i,1),M0(i,1,0))}function oh(i){for(;i===Hu;)Hu=Al[--zl],Al[zl]=null,Ho=Al[--zl],Al[zl]=null;for(;i===_i;)_i=An[--zn],An[zn]=null,ca=An[--zn],An[zn]=null,oa=An[--zn],An[zn]=null}function T0(i,s){An[zn++]=oa,An[zn++]=ca,An[zn++]=_i,oa=s.id,ca=s.overflow,_i=i}var Ar=null,Pt=null,ot=!1,Ni=null,kn=!1,ch=Error(a(519));function Si(i){var s=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Vo(En(s,i)),ch}function q0(i){var s=i.stateNode,c=i.type,f=i.memoizedProps;switch(s[Er]=i,s[Wr]=f,c){case"dialog":it("cancel",s),it("close",s);break;case"iframe":case"object":case"embed":it("load",s);break;case"video":case"audio":for(c=0;c<pc.length;c++)it(pc[c],s);break;case"source":it("error",s);break;case"img":case"image":case"link":it("error",s),it("load",s);break;case"details":it("toggle",s);break;case"input":it("invalid",s),Kj(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":it("invalid",s);break;case"textarea":it("invalid",s),Xj(s,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||f.suppressHydrationWarning===!0||JN(s.textContent,c)?(f.popover!=null&&(it("beforetoggle",s),it("toggle",s)),f.onScroll!=null&&it("scroll",s),f.onScrollEnd!=null&&it("scrollend",s),f.onClick!=null&&(s.onclick=za),s=!0):s=!1,s||Si(i,!0)}function R0(i){for(Ar=i.return;Ar;)switch(Ar.tag){case 5:case 31:case 13:kn=!1;return;case 27:case 3:kn=!0;return;default:Ar=Ar.return}}function kl(i){if(i!==Ar)return!1;if(!ot)return R0(i),ot=!0,!1;var s=i.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||Ev(i.type,i.memoizedProps)),c=!c),c&&Pt&&Si(i),R0(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));Pt=o1(i)}else if(s===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));Pt=o1(i)}else s===27?(s=Pt,Ii(i.type)?(i=Dv,Dv=null,Pt=i):Pt=s):Pt=Ar?Dn(i.stateNode.nextSibling):null;return!0}function xs(){Pt=Ar=null,ot=!1}function uh(){var i=Ni;return i!==null&&(tn===null?tn=i:tn.push.apply(tn,i),Ni=null),i}function Vo(i){Ni===null?Ni=[i]:Ni.push(i)}var dh=Z(null),bs=null,Pa=null;function wi(i,s,c){ce(dh,s._currentValue),s._currentValue=c}function Ma(i){i._currentValue=dh.current,H(dh)}function mh(i,s,c){for(;i!==null;){var f=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),i===c)break;i=i.return}}function fh(i,s,c,f){var y=i.child;for(y!==null&&(y.return=i);y!==null;){var N=y.dependencies;if(N!==null){var O=y.child;N=N.firstContext;e:for(;N!==null;){var q=N;N=y;for(var Q=0;Q<s.length;Q++)if(q.context===s[Q]){N.lanes|=c,q=N.alternate,q!==null&&(q.lanes|=c),mh(N.return,c,i),f||(O=null);break e}N=q.next}}else if(y.tag===18){if(O=y.return,O===null)throw Error(a(341));O.lanes|=c,N=O.alternate,N!==null&&(N.lanes|=c),mh(O,c,i),O=null}else O=y.child;if(O!==null)O.return=y;else for(O=y;O!==null;){if(O===i){O=null;break}if(y=O.sibling,y!==null){y.return=O.return,O=y;break}O=O.return}y=O}}function Ol(i,s,c,f){i=null;for(var y=s,N=!1;y!==null;){if(!N){if((y.flags&524288)!==0)N=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var O=y.alternate;if(O===null)throw Error(a(387));if(O=O.memoizedProps,O!==null){var q=y.type;on(y.pendingProps.value,O.value)||(i!==null?i.push(q):i=[q])}}else if(y===ve.current){if(O=y.alternate,O===null)throw Error(a(387));O.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(i!==null?i.push(bc):i=[bc])}y=y.return}i!==null&&fh(s,i,c,f),s.flags|=262144}function Vu(i){for(i=i.firstContext;i!==null;){if(!on(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ys(i){bs=i,Pa=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function zr(i){return I0(bs,i)}function Qu(i,s){return bs===null&&ys(i),I0(i,s)}function I0(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Pa===null){if(i===null)throw Error(a(308));Pa=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Pa=Pa.next=s;return c}var LT=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,f){i.push(f)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},$T=e.unstable_scheduleCallback,BT=e.unstable_NormalPriority,Jt={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ph(){return{controller:new LT,data:new Map,refCount:0}}function Qo(i){i.refCount--,i.refCount===0&&$T(BT,function(){i.controller.abort()})}var Yo=null,hh=0,Dl=0,Pl=null;function UT(i,s){if(Yo===null){var c=Yo=[];hh=0,Dl=xv(),Pl={status:"pending",value:void 0,then:function(f){c.push(f)}}}return hh++,s.then(L0,L0),s}function L0(){if(--hh===0&&Yo!==null){Pl!==null&&(Pl.status="fulfilled");var i=Yo;Yo=null,Dl=0,Pl=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function FT(i,s){var c=[],f={status:"pending",value:null,reason:null,then:function(y){c.push(y)}};return i.then(function(){f.status="fulfilled",f.value=s;for(var y=0;y<c.length;y++)(0,c[y])(s)},function(y){for(f.status="rejected",f.reason=y,y=0;y<c.length;y++)(0,c[y])(void 0)}),f}var $0=L.S;L.S=function(i,s){NN=Ie(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&UT(i,s),$0!==null&&$0(i,s)};var js=Z(null);function vh(){var i=js.current;return i!==null?i:Et.pooledCache}function Yu(i,s){s===null?ce(js,js.current):ce(js,s.pool)}function B0(){var i=vh();return i===null?null:{parent:Jt._currentValue,pool:i}}var Ml=Error(a(460)),gh=Error(a(474)),Ku=Error(a(542)),Wu={then:function(){}};function U0(i){return i=i.status,i==="fulfilled"||i==="rejected"}function F0(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(za,za),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,H0(i),i;default:if(typeof s.status=="string")s.then(za,za);else{if(i=Et,i!==null&&100<i.shellSuspendCounter)throw Error(a(482));i=s,i.status="pending",i.then(function(f){if(s.status==="pending"){var y=s;y.status="fulfilled",y.value=f}},function(f){if(s.status==="pending"){var y=s;y.status="rejected",y.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,H0(i),i}throw Ns=s,Ml}}function _s(i){try{var s=i._init;return s(i._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Ns=c,Ml):c}}var Ns=null;function G0(){if(Ns===null)throw Error(a(459));var i=Ns;return Ns=null,i}function H0(i){if(i===Ml||i===Ku)throw Error(a(483))}var Tl=null,Ko=0;function Xu(i){var s=Ko;return Ko+=1,Tl===null&&(Tl=[]),F0(Tl,i,s)}function Wo(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Zu(i,s){throw s.$$typeof===b?Error(a(525)):(i=Object.prototype.toString.call(s),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function V0(i){function s(ne,J){if(i){var le=ne.deletions;le===null?(ne.deletions=[J],ne.flags|=16):le.push(J)}}function c(ne,J){if(!i)return null;for(;J!==null;)s(ne,J),J=J.sibling;return null}function f(ne){for(var J=new Map;ne!==null;)ne.key!==null?J.set(ne.key,ne):J.set(ne.index,ne),ne=ne.sibling;return J}function y(ne,J){return ne=Oa(ne,J),ne.index=0,ne.sibling=null,ne}function N(ne,J,le){return ne.index=le,i?(le=ne.alternate,le!==null?(le=le.index,le<J?(ne.flags|=67108866,J):le):(ne.flags|=67108866,J)):(ne.flags|=1048576,J)}function O(ne){return i&&ne.alternate===null&&(ne.flags|=67108866),ne}function q(ne,J,le,be){return J===null||J.tag!==6?(J=ih(le,ne.mode,be),J.return=ne,J):(J=y(J,le),J.return=ne,J)}function Q(ne,J,le,be){var Ue=le.type;return Ue===_?ge(ne,J,le.props.children,be,le.key):J!==null&&(J.elementType===Ue||typeof Ue=="object"&&Ue!==null&&Ue.$$typeof===D&&_s(Ue)===J.type)?(J=y(J,le.props),Wo(J,le),J.return=ne,J):(J=Gu(le.type,le.key,le.props,null,ne.mode,be),Wo(J,le),J.return=ne,J)}function oe(ne,J,le,be){return J===null||J.tag!==4||J.stateNode.containerInfo!==le.containerInfo||J.stateNode.implementation!==le.implementation?(J=sh(le,ne.mode,be),J.return=ne,J):(J=y(J,le.children||[]),J.return=ne,J)}function ge(ne,J,le,be,Ue){return J===null||J.tag!==7?(J=gs(le,ne.mode,be,Ue),J.return=ne,J):(J=y(J,le),J.return=ne,J)}function ye(ne,J,le){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return J=ih(""+J,ne.mode,le),J.return=ne,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case x:return le=Gu(J.type,J.key,J.props,null,ne.mode,le),Wo(le,J),le.return=ne,le;case j:return J=sh(J,ne.mode,le),J.return=ne,J;case D:return J=_s(J),ye(ne,J,le)}if(X(J)||M(J))return J=gs(J,ne.mode,le,null),J.return=ne,J;if(typeof J.then=="function")return ye(ne,Xu(J),le);if(J.$$typeof===S)return ye(ne,Qu(ne,J),le);Zu(ne,J)}return null}function ue(ne,J,le,be){var Ue=J!==null?J.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return Ue!==null?null:q(ne,J,""+le,be);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case x:return le.key===Ue?Q(ne,J,le,be):null;case j:return le.key===Ue?oe(ne,J,le,be):null;case D:return le=_s(le),ue(ne,J,le,be)}if(X(le)||M(le))return Ue!==null?null:ge(ne,J,le,be,null);if(typeof le.then=="function")return ue(ne,J,Xu(le),be);if(le.$$typeof===S)return ue(ne,J,Qu(ne,le),be);Zu(ne,le)}return null}function pe(ne,J,le,be,Ue){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return ne=ne.get(le)||null,q(J,ne,""+be,Ue);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case x:return ne=ne.get(be.key===null?le:be.key)||null,Q(J,ne,be,Ue);case j:return ne=ne.get(be.key===null?le:be.key)||null,oe(J,ne,be,Ue);case D:return be=_s(be),pe(ne,J,le,be,Ue)}if(X(be)||M(be))return ne=ne.get(le)||null,ge(J,ne,be,Ue,null);if(typeof be.then=="function")return pe(ne,J,le,Xu(be),Ue);if(be.$$typeof===S)return pe(ne,J,le,Qu(J,be),Ue);Zu(J,be)}return null}function Te(ne,J,le,be){for(var Ue=null,mt=null,Re=J,Je=J=0,lt=null;Re!==null&&Je<le.length;Je++){Re.index>Je?(lt=Re,Re=null):lt=Re.sibling;var ft=ue(ne,Re,le[Je],be);if(ft===null){Re===null&&(Re=lt);break}i&&Re&&ft.alternate===null&&s(ne,Re),J=N(ft,J,Je),mt===null?Ue=ft:mt.sibling=ft,mt=ft,Re=lt}if(Je===le.length)return c(ne,Re),ot&&Da(ne,Je),Ue;if(Re===null){for(;Je<le.length;Je++)Re=ye(ne,le[Je],be),Re!==null&&(J=N(Re,J,Je),mt===null?Ue=Re:mt.sibling=Re,mt=Re);return ot&&Da(ne,Je),Ue}for(Re=f(Re);Je<le.length;Je++)lt=pe(Re,ne,Je,le[Je],be),lt!==null&&(i&&lt.alternate!==null&&Re.delete(lt.key===null?Je:lt.key),J=N(lt,J,Je),mt===null?Ue=lt:mt.sibling=lt,mt=lt);return i&&Re.forEach(function(Fi){return s(ne,Fi)}),ot&&Da(ne,Je),Ue}function He(ne,J,le,be){if(le==null)throw Error(a(151));for(var Ue=null,mt=null,Re=J,Je=J=0,lt=null,ft=le.next();Re!==null&&!ft.done;Je++,ft=le.next()){Re.index>Je?(lt=Re,Re=null):lt=Re.sibling;var Fi=ue(ne,Re,ft.value,be);if(Fi===null){Re===null&&(Re=lt);break}i&&Re&&Fi.alternate===null&&s(ne,Re),J=N(Fi,J,Je),mt===null?Ue=Fi:mt.sibling=Fi,mt=Fi,Re=lt}if(ft.done)return c(ne,Re),ot&&Da(ne,Je),Ue;if(Re===null){for(;!ft.done;Je++,ft=le.next())ft=ye(ne,ft.value,be),ft!==null&&(J=N(ft,J,Je),mt===null?Ue=ft:mt.sibling=ft,mt=ft);return ot&&Da(ne,Je),Ue}for(Re=f(Re);!ft.done;Je++,ft=le.next())ft=pe(Re,ne,Je,ft.value,be),ft!==null&&(i&&ft.alternate!==null&&Re.delete(ft.key===null?Je:ft.key),J=N(ft,J,Je),mt===null?Ue=ft:mt.sibling=ft,mt=ft);return i&&Re.forEach(function(e3){return s(ne,e3)}),ot&&Da(ne,Je),Ue}function St(ne,J,le,be){if(typeof le=="object"&&le!==null&&le.type===_&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case x:e:{for(var Ue=le.key;J!==null;){if(J.key===Ue){if(Ue=le.type,Ue===_){if(J.tag===7){c(ne,J.sibling),be=y(J,le.props.children),be.return=ne,ne=be;break e}}else if(J.elementType===Ue||typeof Ue=="object"&&Ue!==null&&Ue.$$typeof===D&&_s(Ue)===J.type){c(ne,J.sibling),be=y(J,le.props),Wo(be,le),be.return=ne,ne=be;break e}c(ne,J);break}else s(ne,J);J=J.sibling}le.type===_?(be=gs(le.props.children,ne.mode,be,le.key),be.return=ne,ne=be):(be=Gu(le.type,le.key,le.props,null,ne.mode,be),Wo(be,le),be.return=ne,ne=be)}return O(ne);case j:e:{for(Ue=le.key;J!==null;){if(J.key===Ue)if(J.tag===4&&J.stateNode.containerInfo===le.containerInfo&&J.stateNode.implementation===le.implementation){c(ne,J.sibling),be=y(J,le.children||[]),be.return=ne,ne=be;break e}else{c(ne,J);break}else s(ne,J);J=J.sibling}be=sh(le,ne.mode,be),be.return=ne,ne=be}return O(ne);case D:return le=_s(le),St(ne,J,le,be)}if(X(le))return Te(ne,J,le,be);if(M(le)){if(Ue=M(le),typeof Ue!="function")throw Error(a(150));return le=Ue.call(le),He(ne,J,le,be)}if(typeof le.then=="function")return St(ne,J,Xu(le),be);if(le.$$typeof===S)return St(ne,J,Qu(ne,le),be);Zu(ne,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,J!==null&&J.tag===6?(c(ne,J.sibling),be=y(J,le),be.return=ne,ne=be):(c(ne,J),be=ih(le,ne.mode,be),be.return=ne,ne=be),O(ne)):c(ne,J)}return function(ne,J,le,be){try{Ko=0;var Ue=St(ne,J,le,be);return Tl=null,Ue}catch(Re){if(Re===Ml||Re===Ku)throw Re;var mt=cn(29,Re,null,ne.mode);return mt.lanes=be,mt.return=ne,mt}}}var Ss=V0(!0),Q0=V0(!1),Ci=!1;function xh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bh(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Ei(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Ai(i,s,c){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(vt&2)!==0){var y=f.pending;return y===null?s.next=s:(s.next=y.next,y.next=s),f.pending=s,s=Fu(i),k0(i,null,c),s}return Uu(i,f,s,c),Fu(i)}function Xo(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var f=s.lanes;f&=i.pendingLanes,c|=f,s.lanes=c,ds(i,c)}}function yh(i,s){var c=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var y=null,N=null;if(c=c.firstBaseUpdate,c!==null){do{var O={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};N===null?y=N=O:N=N.next=O,c=c.next}while(c!==null);N===null?y=N=s:N=N.next=s}else y=N=s;c={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:N,shared:f.shared,callbacks:f.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var jh=!1;function Zo(){if(jh){var i=Pl;if(i!==null)throw i}}function Jo(i,s,c,f){jh=!1;var y=i.updateQueue;Ci=!1;var N=y.firstBaseUpdate,O=y.lastBaseUpdate,q=y.shared.pending;if(q!==null){y.shared.pending=null;var Q=q,oe=Q.next;Q.next=null,O===null?N=oe:O.next=oe,O=Q;var ge=i.alternate;ge!==null&&(ge=ge.updateQueue,q=ge.lastBaseUpdate,q!==O&&(q===null?ge.firstBaseUpdate=oe:q.next=oe,ge.lastBaseUpdate=Q))}if(N!==null){var ye=y.baseState;O=0,ge=oe=Q=null,q=N;do{var ue=q.lane&-536870913,pe=ue!==q.lane;if(pe?(st&ue)===ue:(f&ue)===ue){ue!==0&&ue===Dl&&(jh=!0),ge!==null&&(ge=ge.next={lane:0,tag:q.tag,payload:q.payload,callback:null,next:null});e:{var Te=i,He=q;ue=s;var St=c;switch(He.tag){case 1:if(Te=He.payload,typeof Te=="function"){ye=Te.call(St,ye,ue);break e}ye=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=He.payload,ue=typeof Te=="function"?Te.call(St,ye,ue):Te,ue==null)break e;ye=v({},ye,ue);break e;case 2:Ci=!0}}ue=q.callback,ue!==null&&(i.flags|=64,pe&&(i.flags|=8192),pe=y.callbacks,pe===null?y.callbacks=[ue]:pe.push(ue))}else pe={lane:ue,tag:q.tag,payload:q.payload,callback:q.callback,next:null},ge===null?(oe=ge=pe,Q=ye):ge=ge.next=pe,O|=ue;if(q=q.next,q===null){if(q=y.shared.pending,q===null)break;pe=q,q=pe.next,pe.next=null,y.lastBaseUpdate=pe,y.shared.pending=null}}while(!0);ge===null&&(Q=ye),y.baseState=Q,y.firstBaseUpdate=oe,y.lastBaseUpdate=ge,N===null&&(y.shared.lanes=0),Pi|=O,i.lanes=O,i.memoizedState=ye}}function Y0(i,s){if(typeof i!="function")throw Error(a(191,i));i.call(s)}function K0(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)Y0(c[i],s)}var ql=Z(null),Ju=Z(0);function W0(i,s){i=Fa,ce(Ju,i),ce(ql,s),Fa=i|s.baseLanes}function _h(){ce(Ju,Fa),ce(ql,ql.current)}function Nh(){Fa=Ju.current,H(ql),H(Ju)}var un=Z(null),On=null;function zi(i){var s=i.alternate;ce(Wt,Wt.current&1),ce(un,i),On===null&&(s===null||ql.current!==null||s.memoizedState!==null)&&(On=i)}function Sh(i){ce(Wt,Wt.current),ce(un,i),On===null&&(On=i)}function X0(i){i.tag===22?(ce(Wt,Wt.current),ce(un,i),On===null&&(On=i)):ki()}function ki(){ce(Wt,Wt.current),ce(un,un.current)}function dn(i){H(un),On===i&&(On=null),H(Wt)}var Wt=Z(0);function ed(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||kv(c)||Ov(c)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Ta=0,Ze=null,_t=null,er=null,td=!1,Rl=!1,ws=!1,rd=0,ec=0,Il=null,GT=0;function Ut(){throw Error(a(321))}function wh(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!on(i[c],s[c]))return!1;return!0}function Ch(i,s,c,f,y,N){return Ta=N,Ze=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,L.H=i===null||i.memoizedState===null?M_:Bh,ws=!1,N=c(f,y),ws=!1,Rl&&(N=J0(s,c,f,y)),Z0(i),N}function Z0(i){L.H=nc;var s=_t!==null&&_t.next!==null;if(Ta=0,er=_t=Ze=null,td=!1,ec=0,Il=null,s)throw Error(a(300));i===null||tr||(i=i.dependencies,i!==null&&Vu(i)&&(tr=!0))}function J0(i,s,c,f){Ze=i;var y=0;do{if(Rl&&(Il=null),ec=0,Rl=!1,25<=y)throw Error(a(301));if(y+=1,er=_t=null,i.updateQueue!=null){var N=i.updateQueue;N.lastEffect=null,N.events=null,N.stores=null,N.memoCache!=null&&(N.memoCache.index=0)}L.H=T_,N=s(c,f)}while(Rl);return N}function HT(){var i=L.H,s=i.useState()[0];return s=typeof s.then=="function"?tc(s):s,i=i.useState()[0],(_t!==null?_t.memoizedState:null)!==i&&(Ze.flags|=1024),s}function Eh(){var i=rd!==0;return rd=0,i}function Ah(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function zh(i){if(td){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}td=!1}Ta=0,er=_t=Ze=null,Rl=!1,ec=rd=0,Il=null}function Br(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return er===null?Ze.memoizedState=er=i:er=er.next=i,er}function Xt(){if(_t===null){var i=Ze.alternate;i=i!==null?i.memoizedState:null}else i=_t.next;var s=er===null?Ze.memoizedState:er.next;if(s!==null)er=s,_t=i;else{if(i===null)throw Ze.alternate===null?Error(a(467)):Error(a(310));_t=i,i={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},er===null?Ze.memoizedState=er=i:er=er.next=i}return er}function nd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function tc(i){var s=ec;return ec+=1,Il===null&&(Il=[]),i=F0(Il,i,s),s=Ze,(er===null?s.memoizedState:er.next)===null&&(s=s.alternate,L.H=s===null||s.memoizedState===null?M_:Bh),i}function ad(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return tc(i);if(i.$$typeof===S)return zr(i)}throw Error(a(438,String(i)))}function kh(i){var s=null,c=Ze.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var f=Ze.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(y){return y.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=nd(),Ze.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),f=0;f<i;f++)c[f]=F;return s.index++,c}function qa(i,s){return typeof s=="function"?s(i):s}function id(i){var s=Xt();return Oh(s,_t,i)}function Oh(i,s,c){var f=i.queue;if(f===null)throw Error(a(311));f.lastRenderedReducer=c;var y=i.baseQueue,N=f.pending;if(N!==null){if(y!==null){var O=y.next;y.next=N.next,N.next=O}s.baseQueue=y=N,f.pending=null}if(N=i.baseState,y===null)i.memoizedState=N;else{s=y.next;var q=O=null,Q=null,oe=s,ge=!1;do{var ye=oe.lane&-536870913;if(ye!==oe.lane?(st&ye)===ye:(Ta&ye)===ye){var ue=oe.revertLane;if(ue===0)Q!==null&&(Q=Q.next={lane:0,revertLane:0,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),ye===Dl&&(ge=!0);else if((Ta&ue)===ue){oe=oe.next,ue===Dl&&(ge=!0);continue}else ye={lane:0,revertLane:oe.revertLane,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},Q===null?(q=Q=ye,O=N):Q=Q.next=ye,Ze.lanes|=ue,Pi|=ue;ye=oe.action,ws&&c(N,ye),N=oe.hasEagerState?oe.eagerState:c(N,ye)}else ue={lane:ye,revertLane:oe.revertLane,gesture:oe.gesture,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},Q===null?(q=Q=ue,O=N):Q=Q.next=ue,Ze.lanes|=ye,Pi|=ye;oe=oe.next}while(oe!==null&&oe!==s);if(Q===null?O=N:Q.next=q,!on(N,i.memoizedState)&&(tr=!0,ge&&(c=Pl,c!==null)))throw c;i.memoizedState=N,i.baseState=O,i.baseQueue=Q,f.lastRenderedState=N}return y===null&&(f.lanes=0),[i.memoizedState,f.dispatch]}function Dh(i){var s=Xt(),c=s.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=i;var f=c.dispatch,y=c.pending,N=s.memoizedState;if(y!==null){c.pending=null;var O=y=y.next;do N=i(N,O.action),O=O.next;while(O!==y);on(N,s.memoizedState)||(tr=!0),s.memoizedState=N,s.baseQueue===null&&(s.baseState=N),c.lastRenderedState=N}return[N,f]}function e_(i,s,c){var f=Ze,y=Xt(),N=ot;if(N){if(c===void 0)throw Error(a(407));c=c()}else c=s();var O=!on((_t||y).memoizedState,c);if(O&&(y.memoizedState=c,tr=!0),y=y.queue,Th(n_.bind(null,f,y,i),[i]),y.getSnapshot!==s||O||er!==null&&er.memoizedState.tag&1){if(f.flags|=2048,Ll(9,{destroy:void 0},r_.bind(null,f,y,c,s),null),Et===null)throw Error(a(349));N||(Ta&127)!==0||t_(f,s,c)}return c}function t_(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=Ze.updateQueue,s===null?(s=nd(),Ze.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function r_(i,s,c,f){s.value=c,s.getSnapshot=f,a_(s)&&i_(i)}function n_(i,s,c){return c(function(){a_(s)&&i_(i)})}function a_(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!on(i,c)}catch{return!0}}function i_(i){var s=vs(i,2);s!==null&&rn(s,i,2)}function Ph(i){var s=Br();if(typeof i=="function"){var c=i;if(i=c(),ws){Ne(!0);try{c()}finally{Ne(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:i},s}function s_(i,s,c,f){return i.baseState=c,Oh(i,_t,typeof f=="function"?f:qa)}function VT(i,s,c,f,y){if(od(i))throw Error(a(485));if(i=s.action,i!==null){var N={payload:y,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(O){N.listeners.push(O)}};L.T!==null?c(!0):N.isTransition=!1,f(N),c=s.pending,c===null?(N.next=s.pending=N,l_(s,N)):(N.next=c.next,s.pending=c.next=N)}}function l_(i,s){var c=s.action,f=s.payload,y=i.state;if(s.isTransition){var N=L.T,O={};L.T=O;try{var q=c(y,f),Q=L.S;Q!==null&&Q(O,q),o_(i,s,q)}catch(oe){Mh(i,s,oe)}finally{N!==null&&O.types!==null&&(N.types=O.types),L.T=N}}else try{N=c(y,f),o_(i,s,N)}catch(oe){Mh(i,s,oe)}}function o_(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){c_(i,s,f)},function(f){return Mh(i,s,f)}):c_(i,s,c)}function c_(i,s,c){s.status="fulfilled",s.value=c,u_(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,l_(i,c)))}function Mh(i,s,c){var f=i.pending;if(i.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=c,u_(s),s=s.next;while(s!==f)}i.action=null}function u_(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function d_(i,s){return s}function m_(i,s){if(ot){var c=Et.formState;if(c!==null){e:{var f=Ze;if(ot){if(Pt){t:{for(var y=Pt,N=kn;y.nodeType!==8;){if(!N){y=null;break t}if(y=Dn(y.nextSibling),y===null){y=null;break t}}N=y.data,y=N==="F!"||N==="F"?y:null}if(y){Pt=Dn(y.nextSibling),f=y.data==="F!";break e}}Si(f)}f=!1}f&&(s=c[0])}}return c=Br(),c.memoizedState=c.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d_,lastRenderedState:s},c.queue=f,c=O_.bind(null,Ze,f),f.dispatch=c,f=Ph(!1),N=$h.bind(null,Ze,!1,f.queue),f=Br(),y={state:s,dispatch:null,action:i,pending:null},f.queue=y,c=VT.bind(null,Ze,y,N,c),y.dispatch=c,f.memoizedState=i,[s,c,!1]}function f_(i){var s=Xt();return p_(s,_t,i)}function p_(i,s,c){if(s=Oh(i,s,d_)[0],i=id(qa)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=tc(s)}catch(O){throw O===Ml?Ku:O}else f=s;s=Xt();var y=s.queue,N=y.dispatch;return c!==s.memoizedState&&(Ze.flags|=2048,Ll(9,{destroy:void 0},QT.bind(null,y,c),null)),[f,N,i]}function QT(i,s){i.action=s}function h_(i){var s=Xt(),c=_t;if(c!==null)return p_(s,c,i);Xt(),s=s.memoizedState,c=Xt();var f=c.queue.dispatch;return c.memoizedState=i,[s,f,!1]}function Ll(i,s,c,f){return i={tag:i,create:c,deps:f,inst:s,next:null},s=Ze.updateQueue,s===null&&(s=nd(),Ze.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(f=c.next,c.next=i,i.next=f,s.lastEffect=i),i}function v_(){return Xt().memoizedState}function sd(i,s,c,f){var y=Br();Ze.flags|=i,y.memoizedState=Ll(1|s,{destroy:void 0},c,f===void 0?null:f)}function ld(i,s,c,f){var y=Xt();f=f===void 0?null:f;var N=y.memoizedState.inst;_t!==null&&f!==null&&wh(f,_t.memoizedState.deps)?y.memoizedState=Ll(s,N,c,f):(Ze.flags|=i,y.memoizedState=Ll(1|s,N,c,f))}function g_(i,s){sd(8390656,8,i,s)}function Th(i,s){ld(2048,8,i,s)}function YT(i){Ze.flags|=4;var s=Ze.updateQueue;if(s===null)s=nd(),Ze.updateQueue=s,s.events=[i];else{var c=s.events;c===null?s.events=[i]:c.push(i)}}function x_(i){var s=Xt().memoizedState;return YT({ref:s,nextImpl:i}),function(){if((vt&2)!==0)throw Error(a(440));return s.impl.apply(void 0,arguments)}}function b_(i,s){return ld(4,2,i,s)}function y_(i,s){return ld(4,4,i,s)}function j_(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function __(i,s,c){c=c!=null?c.concat([i]):null,ld(4,4,j_.bind(null,s,i),c)}function qh(){}function N_(i,s){var c=Xt();s=s===void 0?null:s;var f=c.memoizedState;return s!==null&&wh(s,f[1])?f[0]:(c.memoizedState=[i,s],i)}function S_(i,s){var c=Xt();s=s===void 0?null:s;var f=c.memoizedState;if(s!==null&&wh(s,f[1]))return f[0];if(f=i(),ws){Ne(!0);try{i()}finally{Ne(!1)}}return c.memoizedState=[f,s],f}function Rh(i,s,c){return c===void 0||(Ta&1073741824)!==0&&(st&261930)===0?i.memoizedState=s:(i.memoizedState=c,i=wN(),Ze.lanes|=i,Pi|=i,c)}function w_(i,s,c,f){return on(c,s)?c:ql.current!==null?(i=Rh(i,c,f),on(i,s)||(tr=!0),i):(Ta&42)===0||(Ta&1073741824)!==0&&(st&261930)===0?(tr=!0,i.memoizedState=c):(i=wN(),Ze.lanes|=i,Pi|=i,s)}function C_(i,s,c,f,y){var N=I.p;I.p=N!==0&&8>N?N:8;var O=L.T,q={};L.T=q,$h(i,!1,s,c);try{var Q=y(),oe=L.S;if(oe!==null&&oe(q,Q),Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var ge=FT(Q,f);rc(i,s,ge,pn(i))}else rc(i,s,f,pn(i))}catch(ye){rc(i,s,{then:function(){},status:"rejected",reason:ye},pn())}finally{I.p=N,O!==null&&q.types!==null&&(O.types=q.types),L.T=O}}function KT(){}function Ih(i,s,c,f){if(i.tag!==5)throw Error(a(476));var y=E_(i).queue;C_(i,y,s,U,c===null?KT:function(){return A_(i),c(f)})}function E_(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:U,baseState:U,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:U},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function A_(i){var s=E_(i);s.next===null&&(s=i.alternate.memoizedState),rc(i,s.next.queue,{},pn())}function Lh(){return zr(bc)}function z_(){return Xt().memoizedState}function k_(){return Xt().memoizedState}function WT(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=pn();i=Ei(c);var f=Ai(s,i,c);f!==null&&(rn(f,s,c),Xo(f,s,c)),s={cache:ph()},i.payload=s;return}s=s.return}}function XT(i,s,c){var f=pn();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},od(i)?D_(s,c):(c=nh(i,s,c,f),c!==null&&(rn(c,i,f),P_(c,s,f)))}function O_(i,s,c){var f=pn();rc(i,s,c,f)}function rc(i,s,c,f){var y={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(od(i))D_(s,y);else{var N=i.alternate;if(i.lanes===0&&(N===null||N.lanes===0)&&(N=s.lastRenderedReducer,N!==null))try{var O=s.lastRenderedState,q=N(O,c);if(y.hasEagerState=!0,y.eagerState=q,on(q,O))return Uu(i,s,y,0),Et===null&&Bu(),!1}catch{}if(c=nh(i,s,y,f),c!==null)return rn(c,i,f),P_(c,s,f),!0}return!1}function $h(i,s,c,f){if(f={lane:2,revertLane:xv(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},od(i)){if(s)throw Error(a(479))}else s=nh(i,c,f,2),s!==null&&rn(s,i,2)}function od(i){var s=i.alternate;return i===Ze||s!==null&&s===Ze}function D_(i,s){Rl=td=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function P_(i,s,c){if((c&4194048)!==0){var f=s.lanes;f&=i.pendingLanes,c|=f,s.lanes=c,ds(i,c)}}var nc={readContext:zr,use:ad,useCallback:Ut,useContext:Ut,useEffect:Ut,useImperativeHandle:Ut,useLayoutEffect:Ut,useInsertionEffect:Ut,useMemo:Ut,useReducer:Ut,useRef:Ut,useState:Ut,useDebugValue:Ut,useDeferredValue:Ut,useTransition:Ut,useSyncExternalStore:Ut,useId:Ut,useHostTransitionStatus:Ut,useFormState:Ut,useActionState:Ut,useOptimistic:Ut,useMemoCache:Ut,useCacheRefresh:Ut};nc.useEffectEvent=Ut;var M_={readContext:zr,use:ad,useCallback:function(i,s){return Br().memoizedState=[i,s===void 0?null:s],i},useContext:zr,useEffect:g_,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,sd(4194308,4,j_.bind(null,s,i),c)},useLayoutEffect:function(i,s){return sd(4194308,4,i,s)},useInsertionEffect:function(i,s){sd(4,2,i,s)},useMemo:function(i,s){var c=Br();s=s===void 0?null:s;var f=i();if(ws){Ne(!0);try{i()}finally{Ne(!1)}}return c.memoizedState=[f,s],f},useReducer:function(i,s,c){var f=Br();if(c!==void 0){var y=c(s);if(ws){Ne(!0);try{c(s)}finally{Ne(!1)}}}else y=s;return f.memoizedState=f.baseState=y,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:y},f.queue=i,i=i.dispatch=XT.bind(null,Ze,i),[f.memoizedState,i]},useRef:function(i){var s=Br();return i={current:i},s.memoizedState=i},useState:function(i){i=Ph(i);var s=i.queue,c=O_.bind(null,Ze,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:qh,useDeferredValue:function(i,s){var c=Br();return Rh(c,i,s)},useTransition:function(){var i=Ph(!1);return i=C_.bind(null,Ze,i.queue,!0,!1),Br().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var f=Ze,y=Br();if(ot){if(c===void 0)throw Error(a(407));c=c()}else{if(c=s(),Et===null)throw Error(a(349));(st&127)!==0||t_(f,s,c)}y.memoizedState=c;var N={value:c,getSnapshot:s};return y.queue=N,g_(n_.bind(null,f,N,i),[i]),f.flags|=2048,Ll(9,{destroy:void 0},r_.bind(null,f,N,c,s),null),c},useId:function(){var i=Br(),s=Et.identifierPrefix;if(ot){var c=ca,f=oa;c=(f&~(1<<32-We(f)-1)).toString(32)+c,s="_"+s+"R_"+c,c=rd++,0<c&&(s+="H"+c.toString(32)),s+="_"}else c=GT++,s="_"+s+"r_"+c.toString(32)+"_";return i.memoizedState=s},useHostTransitionStatus:Lh,useFormState:m_,useActionState:m_,useOptimistic:function(i){var s=Br();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=$h.bind(null,Ze,!0,c),c.dispatch=s,[i,s]},useMemoCache:kh,useCacheRefresh:function(){return Br().memoizedState=WT.bind(null,Ze)},useEffectEvent:function(i){var s=Br(),c={impl:i};return s.memoizedState=c,function(){if((vt&2)!==0)throw Error(a(440));return c.impl.apply(void 0,arguments)}}},Bh={readContext:zr,use:ad,useCallback:N_,useContext:zr,useEffect:Th,useImperativeHandle:__,useInsertionEffect:b_,useLayoutEffect:y_,useMemo:S_,useReducer:id,useRef:v_,useState:function(){return id(qa)},useDebugValue:qh,useDeferredValue:function(i,s){var c=Xt();return w_(c,_t.memoizedState,i,s)},useTransition:function(){var i=id(qa)[0],s=Xt().memoizedState;return[typeof i=="boolean"?i:tc(i),s]},useSyncExternalStore:e_,useId:z_,useHostTransitionStatus:Lh,useFormState:f_,useActionState:f_,useOptimistic:function(i,s){var c=Xt();return s_(c,_t,i,s)},useMemoCache:kh,useCacheRefresh:k_};Bh.useEffectEvent=x_;var T_={readContext:zr,use:ad,useCallback:N_,useContext:zr,useEffect:Th,useImperativeHandle:__,useInsertionEffect:b_,useLayoutEffect:y_,useMemo:S_,useReducer:Dh,useRef:v_,useState:function(){return Dh(qa)},useDebugValue:qh,useDeferredValue:function(i,s){var c=Xt();return _t===null?Rh(c,i,s):w_(c,_t.memoizedState,i,s)},useTransition:function(){var i=Dh(qa)[0],s=Xt().memoizedState;return[typeof i=="boolean"?i:tc(i),s]},useSyncExternalStore:e_,useId:z_,useHostTransitionStatus:Lh,useFormState:h_,useActionState:h_,useOptimistic:function(i,s){var c=Xt();return _t!==null?s_(c,_t,i,s):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:kh,useCacheRefresh:k_};T_.useEffectEvent=x_;function Uh(i,s,c,f){s=i.memoizedState,c=c(f,s),c=c==null?s:v({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var Fh={enqueueSetState:function(i,s,c){i=i._reactInternals;var f=pn(),y=Ei(f);y.payload=s,c!=null&&(y.callback=c),s=Ai(i,y,f),s!==null&&(rn(s,i,f),Xo(s,i,f))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var f=pn(),y=Ei(f);y.tag=1,y.payload=s,c!=null&&(y.callback=c),s=Ai(i,y,f),s!==null&&(rn(s,i,f),Xo(s,i,f))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=pn(),f=Ei(c);f.tag=2,s!=null&&(f.callback=s),s=Ai(i,f,c),s!==null&&(rn(s,i,c),Xo(s,i,c))}};function q_(i,s,c,f,y,N,O){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,N,O):s.prototype&&s.prototype.isPureReactComponent?!Fo(c,f)||!Fo(y,N):!0}function R_(i,s,c,f){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,f),s.state!==i&&Fh.enqueueReplaceState(s,s.state,null)}function Cs(i,s){var c=s;if("ref"in s){c={};for(var f in s)f!=="ref"&&(c[f]=s[f])}if(i=i.defaultProps){c===s&&(c=v({},c));for(var y in i)c[y]===void 0&&(c[y]=i[y])}return c}function I_(i){$u(i)}function L_(i){console.error(i)}function $_(i){$u(i)}function cd(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function B_(i,s,c){try{var f=i.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Gh(i,s,c){return c=Ei(c),c.tag=3,c.payload={element:null},c.callback=function(){cd(i,s)},c}function U_(i){return i=Ei(i),i.tag=3,i}function F_(i,s,c,f){var y=c.type.getDerivedStateFromError;if(typeof y=="function"){var N=f.value;i.payload=function(){return y(N)},i.callback=function(){B_(s,c,f)}}var O=c.stateNode;O!==null&&typeof O.componentDidCatch=="function"&&(i.callback=function(){B_(s,c,f),typeof y!="function"&&(Mi===null?Mi=new Set([this]):Mi.add(this));var q=f.stack;this.componentDidCatch(f.value,{componentStack:q!==null?q:""})})}function ZT(i,s,c,f,y){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=c.alternate,s!==null&&Ol(s,c,y,!0),c=un.current,c!==null){switch(c.tag){case 31:case 13:return On===null?jd():c.alternate===null&&Ft===0&&(Ft=3),c.flags&=-257,c.flags|=65536,c.lanes=y,f===Wu?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([f]):s.add(f),hv(i,f,y)),!1;case 22:return c.flags|=65536,f===Wu?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([f]):c.add(f)),hv(i,f,y)),!1}throw Error(a(435,c.tag))}return hv(i,f,y),jd(),!1}if(ot)return s=un.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=y,f!==ch&&(i=Error(a(422),{cause:f}),Vo(En(i,c)))):(f!==ch&&(s=Error(a(423),{cause:f}),Vo(En(s,c))),i=i.current.alternate,i.flags|=65536,y&=-y,i.lanes|=y,f=En(f,c),y=Gh(i.stateNode,f,y),yh(i,y),Ft!==4&&(Ft=2)),!1;var N=Error(a(520),{cause:f});if(N=En(N,c),dc===null?dc=[N]:dc.push(N),Ft!==4&&(Ft=2),s===null)return!0;f=En(f,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=y&-y,c.lanes|=i,i=Gh(c.stateNode,f,i),yh(c,i),!1;case 1:if(s=c.type,N=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(Mi===null||!Mi.has(N))))return c.flags|=65536,y&=-y,c.lanes|=y,y=U_(y),F_(y,i,c,f),yh(c,y),!1}c=c.return}while(c!==null);return!1}var Hh=Error(a(461)),tr=!1;function kr(i,s,c,f){s.child=i===null?Q0(s,null,c,f):Ss(s,i.child,c,f)}function G_(i,s,c,f,y){c=c.render;var N=s.ref;if("ref"in f){var O={};for(var q in f)q!=="ref"&&(O[q]=f[q])}else O=f;return ys(s),f=Ch(i,s,c,O,N,y),q=Eh(),i!==null&&!tr?(Ah(i,s,y),Ra(i,s,y)):(ot&&q&&lh(s),s.flags|=1,kr(i,s,f,y),s.child)}function H_(i,s,c,f,y){if(i===null){var N=c.type;return typeof N=="function"&&!ah(N)&&N.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=N,V_(i,s,N,f,y)):(i=Gu(c.type,null,f,s,s.mode,y),i.ref=s.ref,i.return=s,s.child=i)}if(N=i.child,!Jh(i,y)){var O=N.memoizedProps;if(c=c.compare,c=c!==null?c:Fo,c(O,f)&&i.ref===s.ref)return Ra(i,s,y)}return s.flags|=1,i=Oa(N,f),i.ref=s.ref,i.return=s,s.child=i}function V_(i,s,c,f,y){if(i!==null){var N=i.memoizedProps;if(Fo(N,f)&&i.ref===s.ref)if(tr=!1,s.pendingProps=f=N,Jh(i,y))(i.flags&131072)!==0&&(tr=!0);else return s.lanes=i.lanes,Ra(i,s,y)}return Vh(i,s,c,f,y)}function Q_(i,s,c,f){var y=f.children,N=i!==null?i.memoizedState:null;if(i===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((s.flags&128)!==0){if(N=N!==null?N.baseLanes|c:c,i!==null){for(f=s.child=i.child,y=0;f!==null;)y=y|f.lanes|f.childLanes,f=f.sibling;f=y&~N}else f=0,s.child=null;return Y_(i,s,N,c,f)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Yu(s,N!==null?N.cachePool:null),N!==null?W0(s,N):_h(),X0(s);else return f=s.lanes=536870912,Y_(i,s,N!==null?N.baseLanes|c:c,c,f)}else N!==null?(Yu(s,N.cachePool),W0(s,N),ki(),s.memoizedState=null):(i!==null&&Yu(s,null),_h(),ki());return kr(i,s,y,c),s.child}function ac(i,s){return i!==null&&i.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function Y_(i,s,c,f,y){var N=vh();return N=N===null?null:{parent:Jt._currentValue,pool:N},s.memoizedState={baseLanes:c,cachePool:N},i!==null&&Yu(s,null),_h(),X0(s),i!==null&&Ol(i,s,f,!0),s.childLanes=y,null}function ud(i,s){return s=md({mode:s.mode,children:s.children},i.mode),s.ref=i.ref,i.child=s,s.return=i,s}function K_(i,s,c){return Ss(s,i.child,null,c),i=ud(s,s.pendingProps),i.flags|=2,dn(s),s.memoizedState=null,i}function JT(i,s,c){var f=s.pendingProps,y=(s.flags&128)!==0;if(s.flags&=-129,i===null){if(ot){if(f.mode==="hidden")return i=ud(s,f),s.lanes=536870912,ac(null,i);if(Sh(s),(i=Pt)?(i=l1(i,kn),i=i!==null&&i.data==="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:_i!==null?{id:oa,overflow:ca}:null,retryLane:536870912,hydrationErrors:null},c=D0(i),c.return=s,s.child=c,Ar=s,Pt=null)):i=null,i===null)throw Si(s);return s.lanes=536870912,null}return ud(s,f)}var N=i.memoizedState;if(N!==null){var O=N.dehydrated;if(Sh(s),y)if(s.flags&256)s.flags&=-257,s=K_(i,s,c);else if(s.memoizedState!==null)s.child=i.child,s.flags|=128,s=null;else throw Error(a(558));else if(tr||Ol(i,s,c,!1),y=(c&i.childLanes)!==0,tr||y){if(f=Et,f!==null&&(O=Lj(f,c),O!==0&&O!==N.retryLane))throw N.retryLane=O,vs(i,O),rn(f,i,O),Hh;jd(),s=K_(i,s,c)}else i=N.treeContext,Pt=Dn(O.nextSibling),Ar=s,ot=!0,Ni=null,kn=!1,i!==null&&T0(s,i),s=ud(s,f),s.flags|=4096;return s}return i=Oa(i.child,{mode:f.mode,children:f.children}),i.ref=s.ref,s.child=i,i.return=s,i}function dd(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(a(284));(i===null||i.ref!==c)&&(s.flags|=4194816)}}function Vh(i,s,c,f,y){return ys(s),c=Ch(i,s,c,f,void 0,y),f=Eh(),i!==null&&!tr?(Ah(i,s,y),Ra(i,s,y)):(ot&&f&&lh(s),s.flags|=1,kr(i,s,c,y),s.child)}function W_(i,s,c,f,y,N){return ys(s),s.updateQueue=null,c=J0(s,f,c,y),Z0(i),f=Eh(),i!==null&&!tr?(Ah(i,s,N),Ra(i,s,N)):(ot&&f&&lh(s),s.flags|=1,kr(i,s,c,N),s.child)}function X_(i,s,c,f,y){if(ys(s),s.stateNode===null){var N=El,O=c.contextType;typeof O=="object"&&O!==null&&(N=zr(O)),N=new c(f,N),s.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,N.updater=Fh,s.stateNode=N,N._reactInternals=s,N=s.stateNode,N.props=f,N.state=s.memoizedState,N.refs={},xh(s),O=c.contextType,N.context=typeof O=="object"&&O!==null?zr(O):El,N.state=s.memoizedState,O=c.getDerivedStateFromProps,typeof O=="function"&&(Uh(s,c,O,f),N.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(O=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),O!==N.state&&Fh.enqueueReplaceState(N,N.state,null),Jo(s,f,N,y),Zo(),N.state=s.memoizedState),typeof N.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(i===null){N=s.stateNode;var q=s.memoizedProps,Q=Cs(c,q);N.props=Q;var oe=N.context,ge=c.contextType;O=El,typeof ge=="object"&&ge!==null&&(O=zr(ge));var ye=c.getDerivedStateFromProps;ge=typeof ye=="function"||typeof N.getSnapshotBeforeUpdate=="function",q=s.pendingProps!==q,ge||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(q||oe!==O)&&R_(s,N,f,O),Ci=!1;var ue=s.memoizedState;N.state=ue,Jo(s,f,N,y),Zo(),oe=s.memoizedState,q||ue!==oe||Ci?(typeof ye=="function"&&(Uh(s,c,ye,f),oe=s.memoizedState),(Q=Ci||q_(s,c,Q,f,ue,oe,O))?(ge||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(s.flags|=4194308)):(typeof N.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=oe),N.props=f,N.state=oe,N.context=O,f=Q):(typeof N.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{N=s.stateNode,bh(i,s),O=s.memoizedProps,ge=Cs(c,O),N.props=ge,ye=s.pendingProps,ue=N.context,oe=c.contextType,Q=El,typeof oe=="object"&&oe!==null&&(Q=zr(oe)),q=c.getDerivedStateFromProps,(oe=typeof q=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(O!==ye||ue!==Q)&&R_(s,N,f,Q),Ci=!1,ue=s.memoizedState,N.state=ue,Jo(s,f,N,y),Zo();var pe=s.memoizedState;O!==ye||ue!==pe||Ci||i!==null&&i.dependencies!==null&&Vu(i.dependencies)?(typeof q=="function"&&(Uh(s,c,q,f),pe=s.memoizedState),(ge=Ci||q_(s,c,ge,f,ue,pe,Q)||i!==null&&i.dependencies!==null&&Vu(i.dependencies))?(oe||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(f,pe,Q),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(f,pe,Q)),typeof N.componentDidUpdate=="function"&&(s.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof N.componentDidUpdate!="function"||O===i.memoizedProps&&ue===i.memoizedState||(s.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||O===i.memoizedProps&&ue===i.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=pe),N.props=f,N.state=pe,N.context=Q,f=ge):(typeof N.componentDidUpdate!="function"||O===i.memoizedProps&&ue===i.memoizedState||(s.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||O===i.memoizedProps&&ue===i.memoizedState||(s.flags|=1024),f=!1)}return N=f,dd(i,s),f=(s.flags&128)!==0,N||f?(N=s.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:N.render(),s.flags|=1,i!==null&&f?(s.child=Ss(s,i.child,null,y),s.child=Ss(s,null,c,y)):kr(i,s,c,y),s.memoizedState=N.state,i=s.child):i=Ra(i,s,y),i}function Z_(i,s,c,f){return xs(),s.flags|=256,kr(i,s,c,f),s.child}var Qh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yh(i){return{baseLanes:i,cachePool:B0()}}function Kh(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=fn),i}function J_(i,s,c){var f=s.pendingProps,y=!1,N=(s.flags&128)!==0,O;if((O=N)||(O=i!==null&&i.memoizedState===null?!1:(Wt.current&2)!==0),O&&(y=!0,s.flags&=-129),O=(s.flags&32)!==0,s.flags&=-33,i===null){if(ot){if(y?zi(s):ki(),(i=Pt)?(i=l1(i,kn),i=i!==null&&i.data!=="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:_i!==null?{id:oa,overflow:ca}:null,retryLane:536870912,hydrationErrors:null},c=D0(i),c.return=s,s.child=c,Ar=s,Pt=null)):i=null,i===null)throw Si(s);return Ov(i)?s.lanes=32:s.lanes=536870912,null}var q=f.children;return f=f.fallback,y?(ki(),y=s.mode,q=md({mode:"hidden",children:q},y),f=gs(f,y,c,null),q.return=s,f.return=s,q.sibling=f,s.child=q,f=s.child,f.memoizedState=Yh(c),f.childLanes=Kh(i,O,c),s.memoizedState=Qh,ac(null,f)):(zi(s),Wh(s,q))}var Q=i.memoizedState;if(Q!==null&&(q=Q.dehydrated,q!==null)){if(N)s.flags&256?(zi(s),s.flags&=-257,s=Xh(i,s,c)):s.memoizedState!==null?(ki(),s.child=i.child,s.flags|=128,s=null):(ki(),q=f.fallback,y=s.mode,f=md({mode:"visible",children:f.children},y),q=gs(q,y,c,null),q.flags|=2,f.return=s,q.return=s,f.sibling=q,s.child=f,Ss(s,i.child,null,c),f=s.child,f.memoizedState=Yh(c),f.childLanes=Kh(i,O,c),s.memoizedState=Qh,s=ac(null,f));else if(zi(s),Ov(q)){if(O=q.nextSibling&&q.nextSibling.dataset,O)var oe=O.dgst;O=oe,f=Error(a(419)),f.stack="",f.digest=O,Vo({value:f,source:null,stack:null}),s=Xh(i,s,c)}else if(tr||Ol(i,s,c,!1),O=(c&i.childLanes)!==0,tr||O){if(O=Et,O!==null&&(f=Lj(O,c),f!==0&&f!==Q.retryLane))throw Q.retryLane=f,vs(i,f),rn(O,i,f),Hh;kv(q)||jd(),s=Xh(i,s,c)}else kv(q)?(s.flags|=192,s.child=i.child,s=null):(i=Q.treeContext,Pt=Dn(q.nextSibling),Ar=s,ot=!0,Ni=null,kn=!1,i!==null&&T0(s,i),s=Wh(s,f.children),s.flags|=4096);return s}return y?(ki(),q=f.fallback,y=s.mode,Q=i.child,oe=Q.sibling,f=Oa(Q,{mode:"hidden",children:f.children}),f.subtreeFlags=Q.subtreeFlags&65011712,oe!==null?q=Oa(oe,q):(q=gs(q,y,c,null),q.flags|=2),q.return=s,f.return=s,f.sibling=q,s.child=f,ac(null,f),f=s.child,q=i.child.memoizedState,q===null?q=Yh(c):(y=q.cachePool,y!==null?(Q=Jt._currentValue,y=y.parent!==Q?{parent:Q,pool:Q}:y):y=B0(),q={baseLanes:q.baseLanes|c,cachePool:y}),f.memoizedState=q,f.childLanes=Kh(i,O,c),s.memoizedState=Qh,ac(i.child,f)):(zi(s),c=i.child,i=c.sibling,c=Oa(c,{mode:"visible",children:f.children}),c.return=s,c.sibling=null,i!==null&&(O=s.deletions,O===null?(s.deletions=[i],s.flags|=16):O.push(i)),s.child=c,s.memoizedState=null,c)}function Wh(i,s){return s=md({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function md(i,s){return i=cn(22,i,null,s),i.lanes=0,i}function Xh(i,s,c){return Ss(s,i.child,null,c),i=Wh(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function eN(i,s,c){i.lanes|=s;var f=i.alternate;f!==null&&(f.lanes|=s),mh(i.return,s,c)}function Zh(i,s,c,f,y,N){var O=i.memoizedState;O===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:y,treeForkCount:N}:(O.isBackwards=s,O.rendering=null,O.renderingStartTime=0,O.last=f,O.tail=c,O.tailMode=y,O.treeForkCount=N)}function tN(i,s,c){var f=s.pendingProps,y=f.revealOrder,N=f.tail;f=f.children;var O=Wt.current,q=(O&2)!==0;if(q?(O=O&1|2,s.flags|=128):O&=1,ce(Wt,O),kr(i,s,f,c),f=ot?Ho:0,!q&&i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&eN(i,c,s);else if(i.tag===19)eN(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(y){case"forwards":for(c=s.child,y=null;c!==null;)i=c.alternate,i!==null&&ed(i)===null&&(y=c),c=c.sibling;c=y,c===null?(y=s.child,s.child=null):(y=c.sibling,c.sibling=null),Zh(s,!1,y,c,N,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,y=s.child,s.child=null;y!==null;){if(i=y.alternate,i!==null&&ed(i)===null){s.child=y;break}i=y.sibling,y.sibling=c,c=y,y=i}Zh(s,!0,c,null,N,f);break;case"together":Zh(s,!1,null,null,void 0,f);break;default:s.memoizedState=null}return s.child}function Ra(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),Pi|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(Ol(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(a(153));if(s.child!==null){for(i=s.child,c=Oa(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=Oa(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function Jh(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Vu(i)))}function eq(i,s,c){switch(s.tag){case 3:De(s,s.stateNode.containerInfo),wi(s,Jt,i.memoizedState.cache),xs();break;case 27:case 5:we(s);break;case 4:De(s,s.stateNode.containerInfo);break;case 10:wi(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Sh(s),null;break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(zi(s),s.flags|=128,null):(c&s.child.childLanes)!==0?J_(i,s,c):(zi(s),i=Ra(i,s,c),i!==null?i.sibling:null);zi(s);break;case 19:var y=(i.flags&128)!==0;if(f=(c&s.childLanes)!==0,f||(Ol(i,s,c,!1),f=(c&s.childLanes)!==0),y){if(f)return tN(i,s,c);s.flags|=128}if(y=s.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),ce(Wt,Wt.current),f)break;return null;case 22:return s.lanes=0,Q_(i,s,c,s.pendingProps);case 24:wi(s,Jt,i.memoizedState.cache)}return Ra(i,s,c)}function rN(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)tr=!0;else{if(!Jh(i,c)&&(s.flags&128)===0)return tr=!1,eq(i,s,c);tr=(i.flags&131072)!==0}else tr=!1,ot&&(s.flags&1048576)!==0&&M0(s,Ho,s.index);switch(s.lanes=0,s.tag){case 16:e:{var f=s.pendingProps;if(i=_s(s.elementType),s.type=i,typeof i=="function")ah(i)?(f=Cs(i,f),s.tag=1,s=X_(null,s,i,f,c)):(s.tag=0,s=Vh(null,s,i,f,c));else{if(i!=null){var y=i.$$typeof;if(y===A){s.tag=11,s=G_(null,s,i,f,c);break e}else if(y===P){s.tag=14,s=H_(null,s,i,f,c);break e}}throw s=ee(i)||i,Error(a(306,s,""))}}return s;case 0:return Vh(i,s,s.type,s.pendingProps,c);case 1:return f=s.type,y=Cs(f,s.pendingProps),X_(i,s,f,y,c);case 3:e:{if(De(s,s.stateNode.containerInfo),i===null)throw Error(a(387));f=s.pendingProps;var N=s.memoizedState;y=N.element,bh(i,s),Jo(s,f,null,c);var O=s.memoizedState;if(f=O.cache,wi(s,Jt,f),f!==N.cache&&fh(s,[Jt],c,!0),Zo(),f=O.element,N.isDehydrated)if(N={element:f,isDehydrated:!1,cache:O.cache},s.updateQueue.baseState=N,s.memoizedState=N,s.flags&256){s=Z_(i,s,f,c);break e}else if(f!==y){y=En(Error(a(424)),s),Vo(y),s=Z_(i,s,f,c);break e}else for(i=s.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,Pt=Dn(i.firstChild),Ar=s,ot=!0,Ni=null,kn=!0,c=Q0(s,null,f,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(xs(),f===y){s=Ra(i,s,c);break e}kr(i,s,f,c)}s=s.child}return s;case 26:return dd(i,s),i===null?(c=f1(s.type,null,s.pendingProps,null))?s.memoizedState=c:ot||(c=s.type,i=s.pendingProps,f=Ad(G.current).createElement(c),f[Er]=s,f[Wr]=i,Or(f,c,i),pr(f),s.stateNode=f):s.memoizedState=f1(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return we(s),i===null&&ot&&(f=s.stateNode=u1(s.type,s.pendingProps,G.current),Ar=s,kn=!0,y=Pt,Ii(s.type)?(Dv=y,Pt=Dn(f.firstChild)):Pt=y),kr(i,s,s.pendingProps.children,c),dd(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&ot&&((y=f=Pt)&&(f=kq(f,s.type,s.pendingProps,kn),f!==null?(s.stateNode=f,Ar=s,Pt=Dn(f.firstChild),kn=!1,y=!0):y=!1),y||Si(s)),we(s),y=s.type,N=s.pendingProps,O=i!==null?i.memoizedProps:null,f=N.children,Ev(y,N)?f=null:O!==null&&Ev(y,O)&&(s.flags|=32),s.memoizedState!==null&&(y=Ch(i,s,HT,null,null,c),bc._currentValue=y),dd(i,s),kr(i,s,f,c),s.child;case 6:return i===null&&ot&&((i=c=Pt)&&(c=Oq(c,s.pendingProps,kn),c!==null?(s.stateNode=c,Ar=s,Pt=null,i=!0):i=!1),i||Si(s)),null;case 13:return J_(i,s,c);case 4:return De(s,s.stateNode.containerInfo),f=s.pendingProps,i===null?s.child=Ss(s,null,f,c):kr(i,s,f,c),s.child;case 11:return G_(i,s,s.type,s.pendingProps,c);case 7:return kr(i,s,s.pendingProps,c),s.child;case 8:return kr(i,s,s.pendingProps.children,c),s.child;case 12:return kr(i,s,s.pendingProps.children,c),s.child;case 10:return f=s.pendingProps,wi(s,s.type,f.value),kr(i,s,f.children,c),s.child;case 9:return y=s.type._context,f=s.pendingProps.children,ys(s),y=zr(y),f=f(y),s.flags|=1,kr(i,s,f,c),s.child;case 14:return H_(i,s,s.type,s.pendingProps,c);case 15:return V_(i,s,s.type,s.pendingProps,c);case 19:return tN(i,s,c);case 31:return JT(i,s,c);case 22:return Q_(i,s,c,s.pendingProps);case 24:return ys(s),f=zr(Jt),i===null?(y=vh(),y===null&&(y=Et,N=ph(),y.pooledCache=N,N.refCount++,N!==null&&(y.pooledCacheLanes|=c),y=N),s.memoizedState={parent:f,cache:y},xh(s),wi(s,Jt,y)):((i.lanes&c)!==0&&(bh(i,s),Jo(s,null,null,c),Zo()),y=i.memoizedState,N=s.memoizedState,y.parent!==f?(y={parent:f,cache:f},s.memoizedState=y,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=y),wi(s,Jt,f)):(f=N.cache,wi(s,Jt,f),f!==y.cache&&fh(s,[Jt],c,!0))),kr(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(a(156,s.tag))}function Ia(i){i.flags|=4}function ev(i,s,c,f,y){if((s=(i.mode&32)!==0)&&(s=!1),s){if(i.flags|=16777216,(y&335544128)===y)if(i.stateNode.complete)i.flags|=8192;else if(zN())i.flags|=8192;else throw Ns=Wu,gh}else i.flags&=-16777217}function nN(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!x1(s))if(zN())i.flags|=8192;else throw Ns=Wu,gh}function fd(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?re():536870912,i.lanes|=s,Fl|=s)}function ic(i,s){if(!ot)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function Mt(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,f=0;if(s)for(var y=i.child;y!==null;)c|=y.lanes|y.childLanes,f|=y.subtreeFlags&65011712,f|=y.flags&65011712,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)c|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=f,i.childLanes=c,s}function tq(i,s,c){var f=s.pendingProps;switch(oh(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mt(s),null;case 1:return Mt(s),null;case 3:return c=s.stateNode,f=null,i!==null&&(f=i.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),Ma(Jt),de(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(kl(s)?Ia(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,uh())),Mt(s),null;case 26:var y=s.type,N=s.memoizedState;return i===null?(Ia(s),N!==null?(Mt(s),nN(s,N)):(Mt(s),ev(s,y,null,f,c))):N?N!==i.memoizedState?(Ia(s),Mt(s),nN(s,N)):(Mt(s),s.flags&=-16777217):(i=i.memoizedProps,i!==f&&Ia(s),Mt(s),ev(s,y,i,f,c)),null;case 27:if(R(s),c=G.current,y=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==f&&Ia(s);else{if(!f){if(s.stateNode===null)throw Error(a(166));return Mt(s),null}i=xe.current,kl(s)?q0(s):(i=u1(y,f,c),s.stateNode=i,Ia(s))}return Mt(s),null;case 5:if(R(s),y=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==f&&Ia(s);else{if(!f){if(s.stateNode===null)throw Error(a(166));return Mt(s),null}if(N=xe.current,kl(s))q0(s);else{var O=Ad(G.current);switch(N){case 1:N=O.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:N=O.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":N=O.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":N=O.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":N=O.createElement("div"),N.innerHTML="<script><\/script>",N=N.removeChild(N.firstChild);break;case"select":N=typeof f.is=="string"?O.createElement("select",{is:f.is}):O.createElement("select"),f.multiple?N.multiple=!0:f.size&&(N.size=f.size);break;default:N=typeof f.is=="string"?O.createElement(y,{is:f.is}):O.createElement(y)}}N[Er]=s,N[Wr]=f;e:for(O=s.child;O!==null;){if(O.tag===5||O.tag===6)N.appendChild(O.stateNode);else if(O.tag!==4&&O.tag!==27&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===s)break e;for(;O.sibling===null;){if(O.return===null||O.return===s)break e;O=O.return}O.sibling.return=O.return,O=O.sibling}s.stateNode=N;e:switch(Or(N,y,f),y){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Ia(s)}}return Mt(s),ev(s,s.type,i===null?null:i.memoizedProps,s.pendingProps,c),null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==f&&Ia(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(a(166));if(i=G.current,kl(s)){if(i=s.stateNode,c=s.memoizedProps,f=null,y=Ar,y!==null)switch(y.tag){case 27:case 5:f=y.memoizedProps}i[Er]=s,i=!!(i.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||JN(i.nodeValue,c)),i||Si(s,!0)}else i=Ad(i).createTextNode(f),i[Er]=s,s.stateNode=i}return Mt(s),null;case 31:if(c=s.memoizedState,i===null||i.memoizedState!==null){if(f=kl(s),c!==null){if(i===null){if(!f)throw Error(a(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(557));i[Er]=s}else xs(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Mt(s),i=!1}else c=uh(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=c),i=!0;if(!i)return s.flags&256?(dn(s),s):(dn(s),null);if((s.flags&128)!==0)throw Error(a(558))}return Mt(s),null;case 13:if(f=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(y=kl(s),f!==null&&f.dehydrated!==null){if(i===null){if(!y)throw Error(a(318));if(y=s.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(a(317));y[Er]=s}else xs(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Mt(s),y=!1}else y=uh(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=y),y=!0;if(!y)return s.flags&256?(dn(s),s):(dn(s),null)}return dn(s),(s.flags&128)!==0?(s.lanes=c,s):(c=f!==null,i=i!==null&&i.memoizedState!==null,c&&(f=s.child,y=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(y=f.alternate.memoizedState.cachePool.pool),N=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(N=f.memoizedState.cachePool.pool),N!==y&&(f.flags|=2048)),c!==i&&c&&(s.child.flags|=8192),fd(s,s.updateQueue),Mt(s),null);case 4:return de(),i===null&&_v(s.stateNode.containerInfo),Mt(s),null;case 10:return Ma(s.type),Mt(s),null;case 19:if(H(Wt),f=s.memoizedState,f===null)return Mt(s),null;if(y=(s.flags&128)!==0,N=f.rendering,N===null)if(y)ic(f,!1);else{if(Ft!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(N=ed(i),N!==null){for(s.flags|=128,ic(f,!1),i=N.updateQueue,s.updateQueue=i,fd(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)O0(c,i),c=c.sibling;return ce(Wt,Wt.current&1|2),ot&&Da(s,f.treeForkCount),s.child}i=i.sibling}f.tail!==null&&Ie()>xd&&(s.flags|=128,y=!0,ic(f,!1),s.lanes=4194304)}else{if(!y)if(i=ed(N),i!==null){if(s.flags|=128,y=!0,i=i.updateQueue,s.updateQueue=i,fd(s,i),ic(f,!0),f.tail===null&&f.tailMode==="hidden"&&!N.alternate&&!ot)return Mt(s),null}else 2*Ie()-f.renderingStartTime>xd&&c!==536870912&&(s.flags|=128,y=!0,ic(f,!1),s.lanes=4194304);f.isBackwards?(N.sibling=s.child,s.child=N):(i=f.last,i!==null?i.sibling=N:s.child=N,f.last=N)}return f.tail!==null?(i=f.tail,f.rendering=i,f.tail=i.sibling,f.renderingStartTime=Ie(),i.sibling=null,c=Wt.current,ce(Wt,y?c&1|2:c&1),ot&&Da(s,f.treeForkCount),i):(Mt(s),null);case 22:case 23:return dn(s),Nh(),f=s.memoizedState!==null,i!==null?i.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(c&536870912)!==0&&(s.flags&128)===0&&(Mt(s),s.subtreeFlags&6&&(s.flags|=8192)):Mt(s),c=s.updateQueue,c!==null&&fd(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==c&&(s.flags|=2048),i!==null&&H(js),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Ma(Jt),Mt(s),null;case 25:return null;case 30:return null}throw Error(a(156,s.tag))}function rq(i,s){switch(oh(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Ma(Jt),de(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return R(s),null;case 31:if(s.memoizedState!==null){if(dn(s),s.alternate===null)throw Error(a(340));xs()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 13:if(dn(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(a(340));xs()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return H(Wt),null;case 4:return de(),null;case 10:return Ma(s.type),null;case 22:case 23:return dn(s),Nh(),i!==null&&H(js),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Ma(Jt),null;case 25:return null;default:return null}}function aN(i,s){switch(oh(s),s.tag){case 3:Ma(Jt),de();break;case 26:case 27:case 5:R(s);break;case 4:de();break;case 31:s.memoizedState!==null&&dn(s);break;case 13:dn(s);break;case 19:H(Wt);break;case 10:Ma(s.type);break;case 22:case 23:dn(s),Nh(),i!==null&&H(js);break;case 24:Ma(Jt)}}function sc(i,s){try{var c=s.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var y=f.next;c=y;do{if((c.tag&i)===i){f=void 0;var N=c.create,O=c.inst;f=N(),O.destroy=f}c=c.next}while(c!==y)}}catch(q){bt(s,s.return,q)}}function Oi(i,s,c){try{var f=s.updateQueue,y=f!==null?f.lastEffect:null;if(y!==null){var N=y.next;f=N;do{if((f.tag&i)===i){var O=f.inst,q=O.destroy;if(q!==void 0){O.destroy=void 0,y=s;var Q=c,oe=q;try{oe()}catch(ge){bt(y,Q,ge)}}}f=f.next}while(f!==N)}}catch(ge){bt(s,s.return,ge)}}function iN(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{K0(s,c)}catch(f){bt(i,i.return,f)}}}function sN(i,s,c){c.props=Cs(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(f){bt(i,s,f)}}function lc(i,s){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var f=i.stateNode;break;case 30:f=i.stateNode;break;default:f=i.stateNode}typeof c=="function"?i.refCleanup=c(f):c.current=f}}catch(y){bt(i,s,y)}}function ua(i,s){var c=i.ref,f=i.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(y){bt(i,s,y)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(y){bt(i,s,y)}else c.current=null}function lN(i){var s=i.type,c=i.memoizedProps,f=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(y){bt(i,i.return,y)}}function tv(i,s,c){try{var f=i.stateNode;Sq(f,i.type,c,s),f[Wr]=s}catch(y){bt(i,i.return,y)}}function oN(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ii(i.type)||i.tag===4}function rv(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||oN(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ii(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function nv(i,s,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(i),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=za));else if(f!==4&&(f===27&&Ii(i.type)&&(c=i.stateNode,s=null),i=i.child,i!==null))for(nv(i,s,c),i=i.sibling;i!==null;)nv(i,s,c),i=i.sibling}function pd(i,s,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(f!==4&&(f===27&&Ii(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(pd(i,s,c),i=i.sibling;i!==null;)pd(i,s,c),i=i.sibling}function cN(i){var s=i.stateNode,c=i.memoizedProps;try{for(var f=i.type,y=s.attributes;y.length;)s.removeAttributeNode(y[0]);Or(s,f,c),s[Er]=i,s[Wr]=c}catch(N){bt(i,i.return,N)}}var La=!1,rr=!1,av=!1,uN=typeof WeakSet=="function"?WeakSet:Set,hr=null;function nq(i,s){if(i=i.containerInfo,wv=Td,i=_0(i),Xp(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var y=f.anchorOffset,N=f.focusNode;f=f.focusOffset;try{c.nodeType,N.nodeType}catch{c=null;break e}var O=0,q=-1,Q=-1,oe=0,ge=0,ye=i,ue=null;t:for(;;){for(var pe;ye!==c||y!==0&&ye.nodeType!==3||(q=O+y),ye!==N||f!==0&&ye.nodeType!==3||(Q=O+f),ye.nodeType===3&&(O+=ye.nodeValue.length),(pe=ye.firstChild)!==null;)ue=ye,ye=pe;for(;;){if(ye===i)break t;if(ue===c&&++oe===y&&(q=O),ue===N&&++ge===f&&(Q=O),(pe=ye.nextSibling)!==null)break;ye=ue,ue=ye.parentNode}ye=pe}c=q===-1||Q===-1?null:{start:q,end:Q}}else c=null}c=c||{start:0,end:0}}else c=null;for(Cv={focusedElem:i,selectionRange:c},Td=!1,hr=s;hr!==null;)if(s=hr,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,hr=i;else for(;hr!==null;){switch(s=hr,N=s.alternate,i=s.flags,s.tag){case 0:if((i&4)!==0&&(i=s.updateQueue,i=i!==null?i.events:null,i!==null))for(c=0;c<i.length;c++)y=i[c],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&N!==null){i=void 0,c=s,y=N.memoizedProps,N=N.memoizedState,f=c.stateNode;try{var Te=Cs(c.type,y);i=f.getSnapshotBeforeUpdate(Te,N),f.__reactInternalSnapshotBeforeUpdate=i}catch(He){bt(c,c.return,He)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)zv(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":zv(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(a(163))}if(i=s.sibling,i!==null){i.return=s.return,hr=i;break}hr=s.return}}function dN(i,s,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:Ba(i,c),f&4&&sc(5,c);break;case 1:if(Ba(i,c),f&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(O){bt(c,c.return,O)}else{var y=Cs(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(y,s,i.__reactInternalSnapshotBeforeUpdate)}catch(O){bt(c,c.return,O)}}f&64&&iN(c),f&512&&lc(c,c.return);break;case 3:if(Ba(i,c),f&64&&(i=c.updateQueue,i!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{K0(i,s)}catch(O){bt(c,c.return,O)}}break;case 27:s===null&&f&4&&cN(c);case 26:case 5:Ba(i,c),s===null&&f&4&&lN(c),f&512&&lc(c,c.return);break;case 12:Ba(i,c);break;case 31:Ba(i,c),f&4&&pN(i,c);break;case 13:Ba(i,c),f&4&&hN(i,c),f&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=mq.bind(null,c),Dq(i,c))));break;case 22:if(f=c.memoizedState!==null||La,!f){s=s!==null&&s.memoizedState!==null||rr,y=La;var N=rr;La=f,(rr=s)&&!N?Ua(i,c,(c.subtreeFlags&8772)!==0):Ba(i,c),La=y,rr=N}break;case 30:break;default:Ba(i,c)}}function mN(i){var s=i.alternate;s!==null&&(i.alternate=null,mN(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&Mp(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Rt=null,Zr=!1;function $a(i,s,c){for(c=c.child;c!==null;)fN(i,s,c),c=c.sibling}function fN(i,s,c){if(ie&&typeof ie.onCommitFiberUnmount=="function")try{ie.onCommitFiberUnmount(W,c)}catch{}switch(c.tag){case 26:rr||ua(c,s),$a(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:rr||ua(c,s);var f=Rt,y=Zr;Ii(c.type)&&(Rt=c.stateNode,Zr=!1),$a(i,s,c),vc(c.stateNode),Rt=f,Zr=y;break;case 5:rr||ua(c,s);case 6:if(f=Rt,y=Zr,Rt=null,$a(i,s,c),Rt=f,Zr=y,Rt!==null)if(Zr)try{(Rt.nodeType===9?Rt.body:Rt.nodeName==="HTML"?Rt.ownerDocument.body:Rt).removeChild(c.stateNode)}catch(N){bt(c,s,N)}else try{Rt.removeChild(c.stateNode)}catch(N){bt(c,s,N)}break;case 18:Rt!==null&&(Zr?(i=Rt,i1(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),Xl(i)):i1(Rt,c.stateNode));break;case 4:f=Rt,y=Zr,Rt=c.stateNode.containerInfo,Zr=!0,$a(i,s,c),Rt=f,Zr=y;break;case 0:case 11:case 14:case 15:Oi(2,c,s),rr||Oi(4,c,s),$a(i,s,c);break;case 1:rr||(ua(c,s),f=c.stateNode,typeof f.componentWillUnmount=="function"&&sN(c,s,f)),$a(i,s,c);break;case 21:$a(i,s,c);break;case 22:rr=(f=rr)||c.memoizedState!==null,$a(i,s,c),rr=f;break;default:$a(i,s,c)}}function pN(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Xl(i)}catch(c){bt(s,s.return,c)}}}function hN(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Xl(i)}catch(c){bt(s,s.return,c)}}function aq(i){switch(i.tag){case 31:case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new uN),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new uN),s;default:throw Error(a(435,i.tag))}}function hd(i,s){var c=aq(i);s.forEach(function(f){if(!c.has(f)){c.add(f);var y=fq.bind(null,i,f);f.then(y,y)}})}function Jr(i,s){var c=s.deletions;if(c!==null)for(var f=0;f<c.length;f++){var y=c[f],N=i,O=s,q=O;e:for(;q!==null;){switch(q.tag){case 27:if(Ii(q.type)){Rt=q.stateNode,Zr=!1;break e}break;case 5:Rt=q.stateNode,Zr=!1;break e;case 3:case 4:Rt=q.stateNode.containerInfo,Zr=!0;break e}q=q.return}if(Rt===null)throw Error(a(160));fN(N,O,y),Rt=null,Zr=!1,N=y.alternate,N!==null&&(N.return=null),y.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)vN(s,i),s=s.sibling}var Kn=null;function vN(i,s){var c=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Jr(s,i),en(i),f&4&&(Oi(3,i,i.return),sc(3,i),Oi(5,i,i.return));break;case 1:Jr(s,i),en(i),f&512&&(rr||c===null||ua(c,c.return)),f&64&&La&&(i=i.updateQueue,i!==null&&(f=i.callbacks,f!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var y=Kn;if(Jr(s,i),en(i),f&512&&(rr||c===null||ua(c,c.return)),f&4){var N=c!==null?c.memoizedState:null;if(f=i.memoizedState,c===null)if(f===null)if(i.stateNode===null){e:{f=i.type,c=i.memoizedProps,y=y.ownerDocument||y;t:switch(f){case"title":N=y.getElementsByTagName("title")[0],(!N||N[Mo]||N[Er]||N.namespaceURI==="http://www.w3.org/2000/svg"||N.hasAttribute("itemprop"))&&(N=y.createElement(f),y.head.insertBefore(N,y.querySelector("head > title"))),Or(N,f,c),N[Er]=i,pr(N),f=N;break e;case"link":var O=v1("link","href",y).get(f+(c.href||""));if(O){for(var q=0;q<O.length;q++)if(N=O[q],N.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&N.getAttribute("rel")===(c.rel==null?null:c.rel)&&N.getAttribute("title")===(c.title==null?null:c.title)&&N.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){O.splice(q,1);break t}}N=y.createElement(f),Or(N,f,c),y.head.appendChild(N);break;case"meta":if(O=v1("meta","content",y).get(f+(c.content||""))){for(q=0;q<O.length;q++)if(N=O[q],N.getAttribute("content")===(c.content==null?null:""+c.content)&&N.getAttribute("name")===(c.name==null?null:c.name)&&N.getAttribute("property")===(c.property==null?null:c.property)&&N.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&N.getAttribute("charset")===(c.charSet==null?null:c.charSet)){O.splice(q,1);break t}}N=y.createElement(f),Or(N,f,c),y.head.appendChild(N);break;default:throw Error(a(468,f))}N[Er]=i,pr(N),f=N}i.stateNode=f}else g1(y,i.type,i.stateNode);else i.stateNode=h1(y,f,i.memoizedProps);else N!==f?(N===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):N.count--,f===null?g1(y,i.type,i.stateNode):h1(y,f,i.memoizedProps)):f===null&&i.stateNode!==null&&tv(i,i.memoizedProps,c.memoizedProps)}break;case 27:Jr(s,i),en(i),f&512&&(rr||c===null||ua(c,c.return)),c!==null&&f&4&&tv(i,i.memoizedProps,c.memoizedProps);break;case 5:if(Jr(s,i),en(i),f&512&&(rr||c===null||ua(c,c.return)),i.flags&32){y=i.stateNode;try{yl(y,"")}catch(Te){bt(i,i.return,Te)}}f&4&&i.stateNode!=null&&(y=i.memoizedProps,tv(i,y,c!==null?c.memoizedProps:y)),f&1024&&(av=!0);break;case 6:if(Jr(s,i),en(i),f&4){if(i.stateNode===null)throw Error(a(162));f=i.memoizedProps,c=i.stateNode;try{c.nodeValue=f}catch(Te){bt(i,i.return,Te)}}break;case 3:if(Od=null,y=Kn,Kn=zd(s.containerInfo),Jr(s,i),Kn=y,en(i),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Xl(s.containerInfo)}catch(Te){bt(i,i.return,Te)}av&&(av=!1,gN(i));break;case 4:f=Kn,Kn=zd(i.stateNode.containerInfo),Jr(s,i),en(i),Kn=f;break;case 12:Jr(s,i),en(i);break;case 31:Jr(s,i),en(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,hd(i,f)));break;case 13:Jr(s,i),en(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(gd=Ie()),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,hd(i,f)));break;case 22:y=i.memoizedState!==null;var Q=c!==null&&c.memoizedState!==null,oe=La,ge=rr;if(La=oe||y,rr=ge||Q,Jr(s,i),rr=ge,La=oe,en(i),f&8192)e:for(s=i.stateNode,s._visibility=y?s._visibility&-2:s._visibility|1,y&&(c===null||Q||La||rr||Es(i)),c=null,s=i;;){if(s.tag===5||s.tag===26){if(c===null){Q=c=s;try{if(N=Q.stateNode,y)O=N.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{q=Q.stateNode;var ye=Q.memoizedProps.style,ue=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;q.style.display=ue==null||typeof ue=="boolean"?"":(""+ue).trim()}}catch(Te){bt(Q,Q.return,Te)}}}else if(s.tag===6){if(c===null){Q=s;try{Q.stateNode.nodeValue=y?"":Q.memoizedProps}catch(Te){bt(Q,Q.return,Te)}}}else if(s.tag===18){if(c===null){Q=s;try{var pe=Q.stateNode;y?s1(pe,!0):s1(Q.stateNode,!1)}catch(Te){bt(Q,Q.return,Te)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=i.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,hd(i,c))));break;case 19:Jr(s,i),en(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,hd(i,f)));break;case 30:break;case 21:break;default:Jr(s,i),en(i)}}function en(i){var s=i.flags;if(s&2){try{for(var c,f=i.return;f!==null;){if(oN(f)){c=f;break}f=f.return}if(c==null)throw Error(a(160));switch(c.tag){case 27:var y=c.stateNode,N=rv(i);pd(i,N,y);break;case 5:var O=c.stateNode;c.flags&32&&(yl(O,""),c.flags&=-33);var q=rv(i);pd(i,q,O);break;case 3:case 4:var Q=c.stateNode.containerInfo,oe=rv(i);nv(i,oe,Q);break;default:throw Error(a(161))}}catch(ge){bt(i,i.return,ge)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function gN(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;gN(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Ba(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)dN(i,s.alternate,s),s=s.sibling}function Es(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:Oi(4,s,s.return),Es(s);break;case 1:ua(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&sN(s,s.return,c),Es(s);break;case 27:vc(s.stateNode);case 26:case 5:ua(s,s.return),Es(s);break;case 22:s.memoizedState===null&&Es(s);break;case 30:Es(s);break;default:Es(s)}i=i.sibling}}function Ua(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,y=i,N=s,O=N.flags;switch(N.tag){case 0:case 11:case 15:Ua(y,N,c),sc(4,N);break;case 1:if(Ua(y,N,c),f=N,y=f.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(oe){bt(f,f.return,oe)}if(f=N,y=f.updateQueue,y!==null){var q=f.stateNode;try{var Q=y.shared.hiddenCallbacks;if(Q!==null)for(y.shared.hiddenCallbacks=null,y=0;y<Q.length;y++)Y0(Q[y],q)}catch(oe){bt(f,f.return,oe)}}c&&O&64&&iN(N),lc(N,N.return);break;case 27:cN(N);case 26:case 5:Ua(y,N,c),c&&f===null&&O&4&&lN(N),lc(N,N.return);break;case 12:Ua(y,N,c);break;case 31:Ua(y,N,c),c&&O&4&&pN(y,N);break;case 13:Ua(y,N,c),c&&O&4&&hN(y,N);break;case 22:N.memoizedState===null&&Ua(y,N,c),lc(N,N.return);break;case 30:break;default:Ua(y,N,c)}s=s.sibling}}function iv(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Qo(c))}function sv(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Qo(i))}function Wn(i,s,c,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)xN(i,s,c,f),s=s.sibling}function xN(i,s,c,f){var y=s.flags;switch(s.tag){case 0:case 11:case 15:Wn(i,s,c,f),y&2048&&sc(9,s);break;case 1:Wn(i,s,c,f);break;case 3:Wn(i,s,c,f),y&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Qo(i)));break;case 12:if(y&2048){Wn(i,s,c,f),i=s.stateNode;try{var N=s.memoizedProps,O=N.id,q=N.onPostCommit;typeof q=="function"&&q(O,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Q){bt(s,s.return,Q)}}else Wn(i,s,c,f);break;case 31:Wn(i,s,c,f);break;case 13:Wn(i,s,c,f);break;case 23:break;case 22:N=s.stateNode,O=s.alternate,s.memoizedState!==null?N._visibility&2?Wn(i,s,c,f):oc(i,s):N._visibility&2?Wn(i,s,c,f):(N._visibility|=2,$l(i,s,c,f,(s.subtreeFlags&10256)!==0||!1)),y&2048&&iv(O,s);break;case 24:Wn(i,s,c,f),y&2048&&sv(s.alternate,s);break;default:Wn(i,s,c,f)}}function $l(i,s,c,f,y){for(y=y&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var N=i,O=s,q=c,Q=f,oe=O.flags;switch(O.tag){case 0:case 11:case 15:$l(N,O,q,Q,y),sc(8,O);break;case 23:break;case 22:var ge=O.stateNode;O.memoizedState!==null?ge._visibility&2?$l(N,O,q,Q,y):oc(N,O):(ge._visibility|=2,$l(N,O,q,Q,y)),y&&oe&2048&&iv(O.alternate,O);break;case 24:$l(N,O,q,Q,y),y&&oe&2048&&sv(O.alternate,O);break;default:$l(N,O,q,Q,y)}s=s.sibling}}function oc(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,f=s,y=f.flags;switch(f.tag){case 22:oc(c,f),y&2048&&iv(f.alternate,f);break;case 24:oc(c,f),y&2048&&sv(f.alternate,f);break;default:oc(c,f)}s=s.sibling}}var cc=8192;function Bl(i,s,c){if(i.subtreeFlags&cc)for(i=i.child;i!==null;)bN(i,s,c),i=i.sibling}function bN(i,s,c){switch(i.tag){case 26:Bl(i,s,c),i.flags&cc&&i.memoizedState!==null&&Gq(c,Kn,i.memoizedState,i.memoizedProps);break;case 5:Bl(i,s,c);break;case 3:case 4:var f=Kn;Kn=zd(i.stateNode.containerInfo),Bl(i,s,c),Kn=f;break;case 22:i.memoizedState===null&&(f=i.alternate,f!==null&&f.memoizedState!==null?(f=cc,cc=16777216,Bl(i,s,c),cc=f):Bl(i,s,c));break;default:Bl(i,s,c)}}function yN(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function uc(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];hr=f,_N(f,i)}yN(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)jN(i),i=i.sibling}function jN(i){switch(i.tag){case 0:case 11:case 15:uc(i),i.flags&2048&&Oi(9,i,i.return);break;case 3:uc(i);break;case 12:uc(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,vd(i)):uc(i);break;default:uc(i)}}function vd(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];hr=f,_N(f,i)}yN(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:Oi(8,s,s.return),vd(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,vd(s));break;default:vd(s)}i=i.sibling}}function _N(i,s){for(;hr!==null;){var c=hr;switch(c.tag){case 0:case 11:case 15:Oi(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Qo(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,hr=f;else e:for(c=i;hr!==null;){f=hr;var y=f.sibling,N=f.return;if(mN(f),f===c){hr=null;break e}if(y!==null){y.return=N,hr=y;break e}hr=N}}}var iq={getCacheForType:function(i){var s=zr(Jt),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c},cacheSignal:function(){return zr(Jt).controller.signal}},sq=typeof WeakMap=="function"?WeakMap:Map,vt=0,Et=null,at=null,st=0,xt=0,mn=null,Di=!1,Ul=!1,lv=!1,Fa=0,Ft=0,Pi=0,As=0,ov=0,fn=0,Fl=0,dc=null,tn=null,cv=!1,gd=0,NN=0,xd=1/0,bd=null,Mi=null,lr=0,Ti=null,Gl=null,Ga=0,uv=0,dv=null,SN=null,mc=0,mv=null;function pn(){return(vt&2)!==0&&st!==0?st&-st:L.T!==null?xv():$j()}function wN(){if(fn===0)if((st&536870912)===0||ot){var i=ul;ul<<=1,(ul&3932160)===0&&(ul=262144),fn=i}else fn=536870912;return i=un.current,i!==null&&(i.flags|=32),fn}function rn(i,s,c){(i===Et&&(xt===2||xt===9)||i.cancelPendingCommit!==null)&&(Hl(i,0),qi(i,st,fn,!1)),gt(i,c),((vt&2)===0||i!==Et)&&(i===Et&&((vt&2)===0&&(As|=c),Ft===4&&qi(i,st,fn,!1)),da(i))}function CN(i,s,c){if((vt&6)!==0)throw Error(a(327));var f=!c&&(s&127)===0&&(s&i.expiredLanes)===0||Qn(i,s),y=f?cq(i,s):pv(i,s,!0),N=f;do{if(y===0){Ul&&!f&&qi(i,s,0,!1);break}else{if(c=i.current.alternate,N&&!lq(c)){y=pv(i,s,!1),N=!1;continue}if(y===2){if(N=s,i.errorRecoveryDisabledLanes&N)var O=0;else O=i.pendingLanes&-536870913,O=O!==0?O:O&536870912?536870912:0;if(O!==0){s=O;e:{var q=i;y=dc;var Q=q.current.memoizedState.isDehydrated;if(Q&&(Hl(q,O).flags|=256),O=pv(q,O,!1),O!==2){if(lv&&!Q){q.errorRecoveryDisabledLanes|=N,As|=N,y=4;break e}N=tn,tn=y,N!==null&&(tn===null?tn=N:tn.push.apply(tn,N))}y=O}if(N=!1,y!==2)continue}}if(y===1){Hl(i,0),qi(i,s,0,!0);break}e:{switch(f=i,N=y,N){case 0:case 1:throw Error(a(345));case 4:if((s&4194048)!==s)break;case 6:qi(f,s,fn,!Di);break e;case 2:tn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((s&62914560)===s&&(y=gd+300-Ie(),10<y)){if(qi(f,s,fn,!Di),ml(f,0,!0)!==0)break e;Ga=s,f.timeoutHandle=n1(EN.bind(null,f,c,tn,bd,cv,s,fn,As,Fl,Di,N,"Throttled",-0,0),y);break e}EN(f,c,tn,bd,cv,s,fn,As,Fl,Di,N,null,-0,0)}}break}while(!0);da(i)}function EN(i,s,c,f,y,N,O,q,Q,oe,ge,ye,ue,pe){if(i.timeoutHandle=-1,ye=s.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:za},bN(s,N,ye);var Te=(N&62914560)===N?gd-Ie():(N&4194048)===N?NN-Ie():0;if(Te=Hq(ye,Te),Te!==null){Ga=N,i.cancelPendingCommit=Te(TN.bind(null,i,s,N,c,f,y,O,q,Q,ge,ye,null,ue,pe)),qi(i,N,O,!oe);return}}TN(i,s,N,c,f,y,O,q,Q)}function lq(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var y=c[f],N=y.getSnapshot;y=y.value;try{if(!on(N(),y))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function qi(i,s,c,f){s&=~ov,s&=~As,i.suspendedLanes|=s,i.pingedLanes&=~s,f&&(i.warmLanes|=s),f=i.expirationTimes;for(var y=s;0<y;){var N=31-We(y),O=1<<N;f[N]=-1,y&=~O}c!==0&&fl(i,c,s)}function yd(){return(vt&6)===0?(fc(0),!1):!0}function fv(){if(at!==null){if(xt===0)var i=at.return;else i=at,Pa=bs=null,zh(i),Tl=null,Ko=0,i=at;for(;i!==null;)aN(i.alternate,i),i=i.return;at=null}}function Hl(i,s){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,Eq(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),Ga=0,fv(),Et=i,at=c=Oa(i.current,null),st=s,xt=0,mn=null,Di=!1,Ul=Qn(i,s),lv=!1,Fl=fn=ov=As=Pi=Ft=0,tn=dc=null,cv=!1,(s&8)!==0&&(s|=s&32);var f=i.entangledLanes;if(f!==0)for(i=i.entanglements,f&=s;0<f;){var y=31-We(f),N=1<<y;s|=i[y],f&=~N}return Fa=s,Bu(),c}function AN(i,s){Ze=null,L.H=nc,s===Ml||s===Ku?(s=G0(),xt=3):s===gh?(s=G0(),xt=4):xt=s===Hh?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,mn=s,at===null&&(Ft=1,cd(i,En(s,i.current)))}function zN(){var i=un.current;return i===null?!0:(st&4194048)===st?On===null:(st&62914560)===st||(st&536870912)!==0?i===On:!1}function kN(){var i=L.H;return L.H=nc,i===null?nc:i}function ON(){var i=L.A;return L.A=iq,i}function jd(){Ft=4,Di||(st&4194048)!==st&&un.current!==null||(Ul=!0),(Pi&134217727)===0&&(As&134217727)===0||Et===null||qi(Et,st,fn,!1)}function pv(i,s,c){var f=vt;vt|=2;var y=kN(),N=ON();(Et!==i||st!==s)&&(bd=null,Hl(i,s)),s=!1;var O=Ft;e:do try{if(xt!==0&&at!==null){var q=at,Q=mn;switch(xt){case 8:fv(),O=6;break e;case 3:case 2:case 9:case 6:un.current===null&&(s=!0);var oe=xt;if(xt=0,mn=null,Vl(i,q,Q,oe),c&&Ul){O=0;break e}break;default:oe=xt,xt=0,mn=null,Vl(i,q,Q,oe)}}oq(),O=Ft;break}catch(ge){AN(i,ge)}while(!0);return s&&i.shellSuspendCounter++,Pa=bs=null,vt=f,L.H=y,L.A=N,at===null&&(Et=null,st=0,Bu()),O}function oq(){for(;at!==null;)DN(at)}function cq(i,s){var c=vt;vt|=2;var f=kN(),y=ON();Et!==i||st!==s?(bd=null,xd=Ie()+500,Hl(i,s)):Ul=Qn(i,s);e:do try{if(xt!==0&&at!==null){s=at;var N=mn;t:switch(xt){case 1:xt=0,mn=null,Vl(i,s,N,1);break;case 2:case 9:if(U0(N)){xt=0,mn=null,PN(s);break}s=function(){xt!==2&&xt!==9||Et!==i||(xt=7),da(i)},N.then(s,s);break e;case 3:xt=7;break e;case 4:xt=5;break e;case 7:U0(N)?(xt=0,mn=null,PN(s)):(xt=0,mn=null,Vl(i,s,N,7));break;case 5:var O=null;switch(at.tag){case 26:O=at.memoizedState;case 5:case 27:var q=at;if(O?x1(O):q.stateNode.complete){xt=0,mn=null;var Q=q.sibling;if(Q!==null)at=Q;else{var oe=q.return;oe!==null?(at=oe,_d(oe)):at=null}break t}}xt=0,mn=null,Vl(i,s,N,5);break;case 6:xt=0,mn=null,Vl(i,s,N,6);break;case 8:fv(),Ft=6;break e;default:throw Error(a(462))}}uq();break}catch(ge){AN(i,ge)}while(!0);return Pa=bs=null,L.H=f,L.A=y,vt=c,at!==null?0:(Et=null,st=0,Bu(),Ft)}function uq(){for(;at!==null&&!he();)DN(at)}function DN(i){var s=rN(i.alternate,i,Fa);i.memoizedProps=i.pendingProps,s===null?_d(i):at=s}function PN(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=W_(c,s,s.pendingProps,s.type,void 0,st);break;case 11:s=W_(c,s,s.pendingProps,s.type.render,s.ref,st);break;case 5:zh(s);default:aN(c,s),s=at=O0(s,Fa),s=rN(c,s,Fa)}i.memoizedProps=i.pendingProps,s===null?_d(i):at=s}function Vl(i,s,c,f){Pa=bs=null,zh(s),Tl=null,Ko=0;var y=s.return;try{if(ZT(i,y,s,c,st)){Ft=1,cd(i,En(c,i.current)),at=null;return}}catch(N){if(y!==null)throw at=y,N;Ft=1,cd(i,En(c,i.current)),at=null;return}s.flags&32768?(ot||f===1?i=!0:Ul||(st&536870912)!==0?i=!1:(Di=i=!0,(f===2||f===9||f===3||f===6)&&(f=un.current,f!==null&&f.tag===13&&(f.flags|=16384))),MN(s,i)):_d(s)}function _d(i){var s=i;do{if((s.flags&32768)!==0){MN(s,Di);return}i=s.return;var c=tq(s.alternate,s,Fa);if(c!==null){at=c;return}if(s=s.sibling,s!==null){at=s;return}at=s=i}while(s!==null);Ft===0&&(Ft=5)}function MN(i,s){do{var c=rq(i.alternate,i);if(c!==null){c.flags&=32767,at=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){at=i;return}at=i=c}while(i!==null);Ft=6,at=null}function TN(i,s,c,f,y,N,O,q,Q){i.cancelPendingCommit=null;do Nd();while(lr!==0);if((vt&6)!==0)throw Error(a(327));if(s!==null){if(s===i.current)throw Error(a(177));if(N=s.lanes|s.childLanes,N|=rh,Nn(i,c,N,O,q,Q),i===Et&&(at=Et=null,st=0),Gl=s,Ti=i,Ga=c,uv=N,dv=y,SN=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,pq(Kt,function(){return $N(),null})):(i.callbackNode=null,i.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=L.T,L.T=null,y=I.p,I.p=2,O=vt,vt|=4;try{nq(i,s,c)}finally{vt=O,I.p=y,L.T=f}}lr=1,qN(),RN(),IN()}}function qN(){if(lr===1){lr=0;var i=Ti,s=Gl,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=L.T,L.T=null;var f=I.p;I.p=2;var y=vt;vt|=4;try{vN(s,i);var N=Cv,O=_0(i.containerInfo),q=N.focusedElem,Q=N.selectionRange;if(O!==q&&q&&q.ownerDocument&&j0(q.ownerDocument.documentElement,q)){if(Q!==null&&Xp(q)){var oe=Q.start,ge=Q.end;if(ge===void 0&&(ge=oe),"selectionStart"in q)q.selectionStart=oe,q.selectionEnd=Math.min(ge,q.value.length);else{var ye=q.ownerDocument||document,ue=ye&&ye.defaultView||window;if(ue.getSelection){var pe=ue.getSelection(),Te=q.textContent.length,He=Math.min(Q.start,Te),St=Q.end===void 0?He:Math.min(Q.end,Te);!pe.extend&&He>St&&(O=St,St=He,He=O);var ne=y0(q,He),J=y0(q,St);if(ne&&J&&(pe.rangeCount!==1||pe.anchorNode!==ne.node||pe.anchorOffset!==ne.offset||pe.focusNode!==J.node||pe.focusOffset!==J.offset)){var le=ye.createRange();le.setStart(ne.node,ne.offset),pe.removeAllRanges(),He>St?(pe.addRange(le),pe.extend(J.node,J.offset)):(le.setEnd(J.node,J.offset),pe.addRange(le))}}}}for(ye=[],pe=q;pe=pe.parentNode;)pe.nodeType===1&&ye.push({element:pe,left:pe.scrollLeft,top:pe.scrollTop});for(typeof q.focus=="function"&&q.focus(),q=0;q<ye.length;q++){var be=ye[q];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}Td=!!wv,Cv=wv=null}finally{vt=y,I.p=f,L.T=c}}i.current=s,lr=2}}function RN(){if(lr===2){lr=0;var i=Ti,s=Gl,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=L.T,L.T=null;var f=I.p;I.p=2;var y=vt;vt|=4;try{dN(i,s.alternate,s)}finally{vt=y,I.p=f,L.T=c}}lr=3}}function IN(){if(lr===4||lr===3){lr=0,Pe();var i=Ti,s=Gl,c=Ga,f=SN;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?lr=5:(lr=0,Gl=Ti=null,LN(i,i.pendingLanes));var y=i.pendingLanes;if(y===0&&(Mi=null),Dp(c),s=s.stateNode,ie&&typeof ie.onCommitFiberRoot=="function")try{ie.onCommitFiberRoot(W,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=L.T,y=I.p,I.p=2,L.T=null;try{for(var N=i.onRecoverableError,O=0;O<f.length;O++){var q=f[O];N(q.value,{componentStack:q.stack})}}finally{L.T=s,I.p=y}}(Ga&3)!==0&&Nd(),da(i),y=i.pendingLanes,(c&261930)!==0&&(y&42)!==0?i===mv?mc++:(mc=0,mv=i):mc=0,fc(0)}}function LN(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Qo(s)))}function Nd(){return qN(),RN(),IN(),$N()}function $N(){if(lr!==5)return!1;var i=Ti,s=uv;uv=0;var c=Dp(Ga),f=L.T,y=I.p;try{I.p=32>c?32:c,L.T=null,c=dv,dv=null;var N=Ti,O=Ga;if(lr=0,Gl=Ti=null,Ga=0,(vt&6)!==0)throw Error(a(331));var q=vt;if(vt|=4,jN(N.current),xN(N,N.current,O,c),vt=q,fc(0,!1),ie&&typeof ie.onPostCommitFiberRoot=="function")try{ie.onPostCommitFiberRoot(W,N)}catch{}return!0}finally{I.p=y,L.T=f,LN(i,s)}}function BN(i,s,c){s=En(c,s),s=Gh(i.stateNode,s,2),i=Ai(i,s,2),i!==null&&(gt(i,2),da(i))}function bt(i,s,c){if(i.tag===3)BN(i,i,c);else for(;s!==null;){if(s.tag===3){BN(s,i,c);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Mi===null||!Mi.has(f))){i=En(c,i),c=U_(2),f=Ai(s,c,2),f!==null&&(F_(c,f,s,i),gt(f,2),da(f));break}}s=s.return}}function hv(i,s,c){var f=i.pingCache;if(f===null){f=i.pingCache=new sq;var y=new Set;f.set(s,y)}else y=f.get(s),y===void 0&&(y=new Set,f.set(s,y));y.has(c)||(lv=!0,y.add(c),i=dq.bind(null,i,s,c),s.then(i,i))}function dq(i,s,c){var f=i.pingCache;f!==null&&f.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,Et===i&&(st&c)===c&&(Ft===4||Ft===3&&(st&62914560)===st&&300>Ie()-gd?(vt&2)===0&&Hl(i,0):ov|=c,Fl===st&&(Fl=0)),da(i)}function UN(i,s){s===0&&(s=re()),i=vs(i,s),i!==null&&(gt(i,s),da(i))}function mq(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),UN(i,c)}function fq(i,s){var c=0;switch(i.tag){case 31:case 13:var f=i.stateNode,y=i.memoizedState;y!==null&&(c=y.retryLane);break;case 19:f=i.stateNode;break;case 22:f=i.stateNode._retryCache;break;default:throw Error(a(314))}f!==null&&f.delete(s),UN(i,c)}function pq(i,s){return fr(i,s)}var Sd=null,Ql=null,vv=!1,wd=!1,gv=!1,Ri=0;function da(i){i!==Ql&&i.next===null&&(Ql===null?Sd=Ql=i:Ql=Ql.next=i),wd=!0,vv||(vv=!0,vq())}function fc(i,s){if(!gv&&wd){gv=!0;do for(var c=!1,f=Sd;f!==null;){if(i!==0){var y=f.pendingLanes;if(y===0)var N=0;else{var O=f.suspendedLanes,q=f.pingedLanes;N=(1<<31-We(42|i)+1)-1,N&=y&~(O&~q),N=N&201326741?N&201326741|1:N?N|2:0}N!==0&&(c=!0,VN(f,N))}else N=st,N=ml(f,f===Et?N:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(N&3)===0||Qn(f,N)||(c=!0,VN(f,N));f=f.next}while(c);gv=!1}}function hq(){FN()}function FN(){wd=vv=!1;var i=0;Ri!==0&&Cq()&&(i=Ri);for(var s=Ie(),c=null,f=Sd;f!==null;){var y=f.next,N=GN(f,s);N===0?(f.next=null,c===null?Sd=y:c.next=y,y===null&&(Ql=c)):(c=f,(i!==0||(N&3)!==0)&&(wd=!0)),f=y}lr!==0&&lr!==5||fc(i),Ri!==0&&(Ri=0)}function GN(i,s){for(var c=i.suspendedLanes,f=i.pingedLanes,y=i.expirationTimes,N=i.pendingLanes&-62914561;0<N;){var O=31-We(N),q=1<<O,Q=y[O];Q===-1?((q&c)===0||(q&f)!==0)&&(y[O]=kp(q,s)):Q<=s&&(i.expiredLanes|=q),N&=~q}if(s=Et,c=st,c=ml(i,i===s?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f=i.callbackNode,c===0||i===s&&(xt===2||xt===9)||i.cancelPendingCommit!==null)return f!==null&&f!==null&&$r(f),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||Qn(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(f!==null&&$r(f),Dp(c)){case 2:case 8:c=qt;break;case 32:c=Kt;break;case 268435456:c=Oe;break;default:c=Kt}return f=HN.bind(null,i),c=fr(c,f),i.callbackPriority=s,i.callbackNode=c,s}return f!==null&&f!==null&&$r(f),i.callbackPriority=2,i.callbackNode=null,2}function HN(i,s){if(lr!==0&&lr!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(Nd()&&i.callbackNode!==c)return null;var f=st;return f=ml(i,i===Et?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f===0?null:(CN(i,f,s),GN(i,Ie()),i.callbackNode!=null&&i.callbackNode===c?HN.bind(null,i):null)}function VN(i,s){if(Nd())return null;CN(i,s,!0)}function vq(){Aq(function(){(vt&6)!==0?fr(nt,hq):FN()})}function xv(){if(Ri===0){var i=Dl;i===0&&(i=la,la<<=1,(la&261888)===0&&(la=256)),Ri=i}return Ri}function QN(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Pu(""+i)}function YN(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function gq(i,s,c,f,y){if(s==="submit"&&c&&c.stateNode===y){var N=QN((y[Wr]||null).action),O=f.submitter;O&&(s=(s=O[Wr]||null)?QN(s.formAction):O.getAttribute("formAction"),s!==null&&(N=s,O=null));var q=new Ru("action","action",null,f,y);i.push({event:q,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ri!==0){var Q=O?YN(y,O):new FormData(y);Ih(c,{pending:!0,data:Q,method:y.method,action:N},null,Q)}}else typeof N=="function"&&(q.preventDefault(),Q=O?YN(y,O):new FormData(y),Ih(c,{pending:!0,data:Q,method:y.method,action:N},N,Q))},currentTarget:y}]})}}for(var bv=0;bv<th.length;bv++){var yv=th[bv],xq=yv.toLowerCase(),bq=yv[0].toUpperCase()+yv.slice(1);Yn(xq,"on"+bq)}Yn(w0,"onAnimationEnd"),Yn(C0,"onAnimationIteration"),Yn(E0,"onAnimationStart"),Yn("dblclick","onDoubleClick"),Yn("focusin","onFocus"),Yn("focusout","onBlur"),Yn(TT,"onTransitionRun"),Yn(qT,"onTransitionStart"),Yn(RT,"onTransitionCancel"),Yn(A0,"onTransitionEnd"),xl("onMouseEnter",["mouseout","mouseover"]),xl("onMouseLeave",["mouseout","mouseover"]),xl("onPointerEnter",["pointerout","pointerover"]),xl("onPointerLeave",["pointerout","pointerover"]),ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ms("onBeforeInput",["compositionend","keypress","textInput","paste"]),ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yq=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(pc));function KN(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var f=i[c],y=f.event;f=f.listeners;e:{var N=void 0;if(s)for(var O=f.length-1;0<=O;O--){var q=f[O],Q=q.instance,oe=q.currentTarget;if(q=q.listener,Q!==N&&y.isPropagationStopped())break e;N=q,y.currentTarget=oe;try{N(y)}catch(ge){$u(ge)}y.currentTarget=null,N=Q}else for(O=0;O<f.length;O++){if(q=f[O],Q=q.instance,oe=q.currentTarget,q=q.listener,Q!==N&&y.isPropagationStopped())break e;N=q,y.currentTarget=oe;try{N(y)}catch(ge){$u(ge)}y.currentTarget=null,N=Q}}}}function it(i,s){var c=s[Pp];c===void 0&&(c=s[Pp]=new Set);var f=i+"__bubble";c.has(f)||(WN(s,i,2,!1),c.add(f))}function jv(i,s,c){var f=0;s&&(f|=4),WN(c,i,f,s)}var Cd="_reactListening"+Math.random().toString(36).slice(2);function _v(i){if(!i[Cd]){i[Cd]=!0,Fj.forEach(function(c){c!=="selectionchange"&&(yq.has(c)||jv(c,!1,i),jv(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Cd]||(s[Cd]=!0,jv("selectionchange",!1,s))}}function WN(i,s,c,f){switch(w1(s)){case 2:var y=Yq;break;case 8:y=Kq;break;default:y=Rv}c=y.bind(null,s,c,i),y=void 0,!Up||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(y=!0),f?y!==void 0?i.addEventListener(s,c,{capture:!0,passive:y}):i.addEventListener(s,c,!0):y!==void 0?i.addEventListener(s,c,{passive:y}):i.addEventListener(s,c,!1)}function Nv(i,s,c,f,y){var N=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var O=f.tag;if(O===3||O===4){var q=f.stateNode.containerInfo;if(q===y)break;if(O===4)for(O=f.return;O!==null;){var Q=O.tag;if((Q===3||Q===4)&&O.stateNode.containerInfo===y)return;O=O.return}for(;q!==null;){if(O=hl(q),O===null)return;if(Q=O.tag,Q===5||Q===6||Q===26||Q===27){f=N=O;continue e}q=q.parentNode}}f=f.return}t0(function(){var oe=N,ge=$p(c),ye=[];e:{var ue=z0.get(i);if(ue!==void 0){var pe=Ru,Te=i;switch(i){case"keypress":if(Tu(c)===0)break e;case"keydown":case"keyup":pe=fT;break;case"focusin":Te="focus",pe=Vp;break;case"focusout":Te="blur",pe=Vp;break;case"beforeblur":case"afterblur":pe=Vp;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=a0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=tT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=vT;break;case w0:case C0:case E0:pe=aT;break;case A0:pe=xT;break;case"scroll":case"scrollend":pe=JM;break;case"wheel":pe=yT;break;case"copy":case"cut":case"paste":pe=sT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=s0;break;case"toggle":case"beforetoggle":pe=_T}var He=(s&4)!==0,St=!He&&(i==="scroll"||i==="scrollend"),ne=He?ue!==null?ue+"Capture":null:ue;He=[];for(var J=oe,le;J!==null;){var be=J;if(le=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||le===null||ne===null||(be=qo(J,ne),be!=null&&He.push(hc(J,be,le))),St)break;J=J.return}0<He.length&&(ue=new pe(ue,Te,null,c,ge),ye.push({event:ue,listeners:He}))}}if((s&7)===0){e:{if(ue=i==="mouseover"||i==="pointerover",pe=i==="mouseout"||i==="pointerout",ue&&c!==Lp&&(Te=c.relatedTarget||c.fromElement)&&(hl(Te)||Te[pl]))break e;if((pe||ue)&&(ue=ge.window===ge?ge:(ue=ge.ownerDocument)?ue.defaultView||ue.parentWindow:window,pe?(Te=c.relatedTarget||c.toElement,pe=oe,Te=Te?hl(Te):null,Te!==null&&(St=o(Te),He=Te.tag,Te!==St||He!==5&&He!==27&&He!==6)&&(Te=null)):(pe=null,Te=oe),pe!==Te)){if(He=a0,be="onMouseLeave",ne="onMouseEnter",J="mouse",(i==="pointerout"||i==="pointerover")&&(He=s0,be="onPointerLeave",ne="onPointerEnter",J="pointer"),St=pe==null?ue:To(pe),le=Te==null?ue:To(Te),ue=new He(be,J+"leave",pe,c,ge),ue.target=St,ue.relatedTarget=le,be=null,hl(ge)===oe&&(He=new He(ne,J+"enter",Te,c,ge),He.target=le,He.relatedTarget=St,be=He),St=be,pe&&Te)t:{for(He=jq,ne=pe,J=Te,le=0,be=ne;be;be=He(be))le++;be=0;for(var Ue=J;Ue;Ue=He(Ue))be++;for(;0<le-be;)ne=He(ne),le--;for(;0<be-le;)J=He(J),be--;for(;le--;){if(ne===J||J!==null&&ne===J.alternate){He=ne;break t}ne=He(ne),J=He(J)}He=null}else He=null;pe!==null&&XN(ye,ue,pe,He,!1),Te!==null&&St!==null&&XN(ye,St,Te,He,!0)}}e:{if(ue=oe?To(oe):window,pe=ue.nodeName&&ue.nodeName.toLowerCase(),pe==="select"||pe==="input"&&ue.type==="file")var mt=p0;else if(m0(ue))if(h0)mt=DT;else{mt=kT;var Re=zT}else pe=ue.nodeName,!pe||pe.toLowerCase()!=="input"||ue.type!=="checkbox"&&ue.type!=="radio"?oe&&Ip(oe.elementType)&&(mt=p0):mt=OT;if(mt&&(mt=mt(i,oe))){f0(ye,mt,c,ge);break e}Re&&Re(i,ue,oe),i==="focusout"&&oe&&ue.type==="number"&&oe.memoizedProps.value!=null&&Rp(ue,"number",ue.value)}switch(Re=oe?To(oe):window,i){case"focusin":(m0(Re)||Re.contentEditable==="true")&&(Sl=Re,Zp=oe,Go=null);break;case"focusout":Go=Zp=Sl=null;break;case"mousedown":Jp=!0;break;case"contextmenu":case"mouseup":case"dragend":Jp=!1,N0(ye,c,ge);break;case"selectionchange":if(MT)break;case"keydown":case"keyup":N0(ye,c,ge)}var Je;if(Yp)e:{switch(i){case"compositionstart":var lt="onCompositionStart";break e;case"compositionend":lt="onCompositionEnd";break e;case"compositionupdate":lt="onCompositionUpdate";break e}lt=void 0}else Nl?u0(i,c)&&(lt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(lt="onCompositionStart");lt&&(l0&&c.locale!=="ko"&&(Nl||lt!=="onCompositionStart"?lt==="onCompositionEnd"&&Nl&&(Je=r0()):(ji=ge,Fp="value"in ji?ji.value:ji.textContent,Nl=!0)),Re=Ed(oe,lt),0<Re.length&&(lt=new i0(lt,i,null,c,ge),ye.push({event:lt,listeners:Re}),Je?lt.data=Je:(Je=d0(c),Je!==null&&(lt.data=Je)))),(Je=ST?wT(i,c):CT(i,c))&&(lt=Ed(oe,"onBeforeInput"),0<lt.length&&(Re=new i0("onBeforeInput","beforeinput",null,c,ge),ye.push({event:Re,listeners:lt}),Re.data=Je)),gq(ye,i,oe,c,ge)}KN(ye,s)})}function hc(i,s,c){return{instance:i,listener:s,currentTarget:c}}function Ed(i,s){for(var c=s+"Capture",f=[];i!==null;){var y=i,N=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||N===null||(y=qo(i,c),y!=null&&f.unshift(hc(i,y,N)),y=qo(i,s),y!=null&&f.push(hc(i,y,N))),i.tag===3)return f;i=i.return}return[]}function jq(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function XN(i,s,c,f,y){for(var N=s._reactName,O=[];c!==null&&c!==f;){var q=c,Q=q.alternate,oe=q.stateNode;if(q=q.tag,Q!==null&&Q===f)break;q!==5&&q!==26&&q!==27||oe===null||(Q=oe,y?(oe=qo(c,N),oe!=null&&O.unshift(hc(c,oe,Q))):y||(oe=qo(c,N),oe!=null&&O.push(hc(c,oe,Q)))),c=c.return}O.length!==0&&i.push({event:s,listeners:O})}var _q=/\r\n?/g,Nq=/\u0000|\uFFFD/g;function ZN(i){return(typeof i=="string"?i:""+i).replace(_q,`
`).replace(Nq,"")}function JN(i,s){return s=ZN(s),ZN(i)===s}function Nt(i,s,c,f,y,N){switch(c){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||yl(i,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&yl(i,""+f);break;case"className":Ou(i,"class",f);break;case"tabIndex":Ou(i,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Ou(i,c,f);break;case"style":Jj(i,f,N);break;case"data":if(s!=="object"){Ou(i,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(c);break}f=Pu(""+f),i.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof N=="function"&&(c==="formAction"?(s!=="input"&&Nt(i,s,"name",y.name,y,null),Nt(i,s,"formEncType",y.formEncType,y,null),Nt(i,s,"formMethod",y.formMethod,y,null),Nt(i,s,"formTarget",y.formTarget,y,null)):(Nt(i,s,"encType",y.encType,y,null),Nt(i,s,"method",y.method,y,null),Nt(i,s,"target",y.target,y,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(c);break}f=Pu(""+f),i.setAttribute(c,f);break;case"onClick":f!=null&&(i.onclick=za);break;case"onScroll":f!=null&&it("scroll",i);break;case"onScrollEnd":f!=null&&it("scrollend",i);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(a(61));if(c=f.__html,c!=null){if(y.children!=null)throw Error(a(60));i.innerHTML=c}}break;case"multiple":i.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":i.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){i.removeAttribute("xlink:href");break}c=Pu(""+f),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,""+f):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":f===!0?i.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,f):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?i.setAttribute(c,f):i.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?i.removeAttribute(c):i.setAttribute(c,f);break;case"popover":it("beforetoggle",i),it("toggle",i),ku(i,"popover",f);break;case"xlinkActuate":Aa(i,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Aa(i,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Aa(i,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Aa(i,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Aa(i,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Aa(i,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Aa(i,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Aa(i,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Aa(i,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":ku(i,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=XM.get(c)||c,ku(i,c,f))}}function Sv(i,s,c,f,y,N){switch(c){case"style":Jj(i,f,N);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(a(61));if(c=f.__html,c!=null){if(y.children!=null)throw Error(a(60));i.innerHTML=c}}break;case"children":typeof f=="string"?yl(i,f):(typeof f=="number"||typeof f=="bigint")&&yl(i,""+f);break;case"onScroll":f!=null&&it("scroll",i);break;case"onScrollEnd":f!=null&&it("scrollend",i);break;case"onClick":f!=null&&(i.onclick=za);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Gj.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(y=c.endsWith("Capture"),s=c.slice(2,y?c.length-7:void 0),N=i[Wr]||null,N=N!=null?N[c]:null,typeof N=="function"&&i.removeEventListener(s,N,y),typeof f=="function")){typeof N!="function"&&N!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,f,y);break e}c in i?i[c]=f:f===!0?i.setAttribute(c,""):ku(i,c,f)}}}function Or(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":it("error",i),it("load",i);var f=!1,y=!1,N;for(N in c)if(c.hasOwnProperty(N)){var O=c[N];if(O!=null)switch(N){case"src":f=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:Nt(i,s,N,O,c,null)}}y&&Nt(i,s,"srcSet",c.srcSet,c,null),f&&Nt(i,s,"src",c.src,c,null);return;case"input":it("invalid",i);var q=N=O=y=null,Q=null,oe=null;for(f in c)if(c.hasOwnProperty(f)){var ge=c[f];if(ge!=null)switch(f){case"name":y=ge;break;case"type":O=ge;break;case"checked":Q=ge;break;case"defaultChecked":oe=ge;break;case"value":N=ge;break;case"defaultValue":q=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(a(137,s));break;default:Nt(i,s,f,ge,c,null)}}Kj(i,N,q,Q,oe,O,y,!1);return;case"select":it("invalid",i),f=O=N=null;for(y in c)if(c.hasOwnProperty(y)&&(q=c[y],q!=null))switch(y){case"value":N=q;break;case"defaultValue":O=q;break;case"multiple":f=q;default:Nt(i,s,y,q,c,null)}s=N,c=O,i.multiple=!!f,s!=null?bl(i,!!f,s,!1):c!=null&&bl(i,!!f,c,!0);return;case"textarea":it("invalid",i),N=y=f=null;for(O in c)if(c.hasOwnProperty(O)&&(q=c[O],q!=null))switch(O){case"value":f=q;break;case"defaultValue":y=q;break;case"children":N=q;break;case"dangerouslySetInnerHTML":if(q!=null)throw Error(a(91));break;default:Nt(i,s,O,q,c,null)}Xj(i,f,y,N);return;case"option":for(Q in c)c.hasOwnProperty(Q)&&(f=c[Q],f!=null)&&(Q==="selected"?i.selected=f&&typeof f!="function"&&typeof f!="symbol":Nt(i,s,Q,f,c,null));return;case"dialog":it("beforetoggle",i),it("toggle",i),it("cancel",i),it("close",i);break;case"iframe":case"object":it("load",i);break;case"video":case"audio":for(f=0;f<pc.length;f++)it(pc[f],i);break;case"image":it("error",i),it("load",i);break;case"details":it("toggle",i);break;case"embed":case"source":case"link":it("error",i),it("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in c)if(c.hasOwnProperty(oe)&&(f=c[oe],f!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:Nt(i,s,oe,f,c,null)}return;default:if(Ip(s)){for(ge in c)c.hasOwnProperty(ge)&&(f=c[ge],f!==void 0&&Sv(i,s,ge,f,c,void 0));return}}for(q in c)c.hasOwnProperty(q)&&(f=c[q],f!=null&&Nt(i,s,q,f,c,null))}function Sq(i,s,c,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,N=null,O=null,q=null,Q=null,oe=null,ge=null;for(pe in c){var ye=c[pe];if(c.hasOwnProperty(pe)&&ye!=null)switch(pe){case"checked":break;case"value":break;case"defaultValue":Q=ye;default:f.hasOwnProperty(pe)||Nt(i,s,pe,null,f,ye)}}for(var ue in f){var pe=f[ue];if(ye=c[ue],f.hasOwnProperty(ue)&&(pe!=null||ye!=null))switch(ue){case"type":N=pe;break;case"name":y=pe;break;case"checked":oe=pe;break;case"defaultChecked":ge=pe;break;case"value":O=pe;break;case"defaultValue":q=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(a(137,s));break;default:pe!==ye&&Nt(i,s,ue,pe,f,ye)}}qp(i,O,q,Q,oe,ge,N,y);return;case"select":pe=O=q=ue=null;for(N in c)if(Q=c[N],c.hasOwnProperty(N)&&Q!=null)switch(N){case"value":break;case"multiple":pe=Q;default:f.hasOwnProperty(N)||Nt(i,s,N,null,f,Q)}for(y in f)if(N=f[y],Q=c[y],f.hasOwnProperty(y)&&(N!=null||Q!=null))switch(y){case"value":ue=N;break;case"defaultValue":q=N;break;case"multiple":O=N;default:N!==Q&&Nt(i,s,y,N,f,Q)}s=q,c=O,f=pe,ue!=null?bl(i,!!c,ue,!1):!!f!=!!c&&(s!=null?bl(i,!!c,s,!0):bl(i,!!c,c?[]:"",!1));return;case"textarea":pe=ue=null;for(q in c)if(y=c[q],c.hasOwnProperty(q)&&y!=null&&!f.hasOwnProperty(q))switch(q){case"value":break;case"children":break;default:Nt(i,s,q,null,f,y)}for(O in f)if(y=f[O],N=c[O],f.hasOwnProperty(O)&&(y!=null||N!=null))switch(O){case"value":ue=y;break;case"defaultValue":pe=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(a(91));break;default:y!==N&&Nt(i,s,O,y,f,N)}Wj(i,ue,pe);return;case"option":for(var Te in c)ue=c[Te],c.hasOwnProperty(Te)&&ue!=null&&!f.hasOwnProperty(Te)&&(Te==="selected"?i.selected=!1:Nt(i,s,Te,null,f,ue));for(Q in f)ue=f[Q],pe=c[Q],f.hasOwnProperty(Q)&&ue!==pe&&(ue!=null||pe!=null)&&(Q==="selected"?i.selected=ue&&typeof ue!="function"&&typeof ue!="symbol":Nt(i,s,Q,ue,f,pe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var He in c)ue=c[He],c.hasOwnProperty(He)&&ue!=null&&!f.hasOwnProperty(He)&&Nt(i,s,He,null,f,ue);for(oe in f)if(ue=f[oe],pe=c[oe],f.hasOwnProperty(oe)&&ue!==pe&&(ue!=null||pe!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(a(137,s));break;default:Nt(i,s,oe,ue,f,pe)}return;default:if(Ip(s)){for(var St in c)ue=c[St],c.hasOwnProperty(St)&&ue!==void 0&&!f.hasOwnProperty(St)&&Sv(i,s,St,void 0,f,ue);for(ge in f)ue=f[ge],pe=c[ge],!f.hasOwnProperty(ge)||ue===pe||ue===void 0&&pe===void 0||Sv(i,s,ge,ue,f,pe);return}}for(var ne in c)ue=c[ne],c.hasOwnProperty(ne)&&ue!=null&&!f.hasOwnProperty(ne)&&Nt(i,s,ne,null,f,ue);for(ye in f)ue=f[ye],pe=c[ye],!f.hasOwnProperty(ye)||ue===pe||ue==null&&pe==null||Nt(i,s,ye,ue,f,pe)}function e1(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function wq(){if(typeof performance.getEntriesByType=="function"){for(var i=0,s=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var y=c[f],N=y.transferSize,O=y.initiatorType,q=y.duration;if(N&&q&&e1(O)){for(O=0,q=y.responseEnd,f+=1;f<c.length;f++){var Q=c[f],oe=Q.startTime;if(oe>q)break;var ge=Q.transferSize,ye=Q.initiatorType;ge&&e1(ye)&&(Q=Q.responseEnd,O+=ge*(Q<q?1:(q-oe)/(Q-oe)))}if(--f,s+=8*(N+O)/(y.duration/1e3),i++,10<i)break}}if(0<i)return s/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var wv=null,Cv=null;function Ad(i){return i.nodeType===9?i:i.ownerDocument}function t1(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function r1(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function Ev(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Av=null;function Cq(){var i=window.event;return i&&i.type==="popstate"?i===Av?!1:(Av=i,!0):(Av=null,!1)}var n1=typeof setTimeout=="function"?setTimeout:void 0,Eq=typeof clearTimeout=="function"?clearTimeout:void 0,a1=typeof Promise=="function"?Promise:void 0,Aq=typeof queueMicrotask=="function"?queueMicrotask:typeof a1<"u"?function(i){return a1.resolve(null).then(i).catch(zq)}:n1;function zq(i){setTimeout(function(){throw i})}function Ii(i){return i==="head"}function i1(i,s){var c=s,f=0;do{var y=c.nextSibling;if(i.removeChild(c),y&&y.nodeType===8)if(c=y.data,c==="/$"||c==="/&"){if(f===0){i.removeChild(y),Xl(s);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")vc(i.ownerDocument.documentElement);else if(c==="head"){c=i.ownerDocument.head,vc(c);for(var N=c.firstChild;N;){var O=N.nextSibling,q=N.nodeName;N[Mo]||q==="SCRIPT"||q==="STYLE"||q==="LINK"&&N.rel.toLowerCase()==="stylesheet"||c.removeChild(N),N=O}}else c==="body"&&vc(i.ownerDocument.body);c=y}while(c);Xl(s)}function s1(i,s){var c=i;i=0;do{var f=c.nextSibling;if(c.nodeType===1?s?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(s?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(i===0)break;i--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||i++;c=f}while(c)}function zv(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":zv(c),Mp(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function kq(i,s,c,f){for(;i.nodeType===1;){var y=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(f){if(!i[Mo])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(N=i.getAttribute("rel"),N==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(N!==y.rel||i.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||i.getAttribute("title")!==(y.title==null?null:y.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(N=i.getAttribute("src"),(N!==(y.src==null?null:y.src)||i.getAttribute("type")!==(y.type==null?null:y.type)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&N&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var N=y.name==null?null:""+y.name;if(y.type==="hidden"&&i.getAttribute("name")===N)return i}else return i;if(i=Dn(i.nextSibling),i===null)break}return null}function Oq(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=Dn(i.nextSibling),i===null))return null;return i}function l1(i,s){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!s||(i=Dn(i.nextSibling),i===null))return null;return i}function kv(i){return i.data==="$?"||i.data==="$~"}function Ov(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function Dq(i,s){var c=i.ownerDocument;if(i.data==="$~")i._reactRetry=s;else if(i.data!=="$?"||c.readyState!=="loading")s();else{var f=function(){s(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),i._reactRetry=f}}function Dn(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return i}var Dv=null;function o1(i){i=i.nextSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"||c==="/&"){if(s===0)return Dn(i.nextSibling);s--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||s++}i=i.nextSibling}return null}function c1(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(s===0)return i;s--}else c!=="/$"&&c!=="/&"||s++}i=i.previousSibling}return null}function u1(i,s,c){switch(s=Ad(c),i){case"html":if(i=s.documentElement,!i)throw Error(a(452));return i;case"head":if(i=s.head,!i)throw Error(a(453));return i;case"body":if(i=s.body,!i)throw Error(a(454));return i;default:throw Error(a(451))}}function vc(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);Mp(i)}var Pn=new Map,d1=new Set;function zd(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ha=I.d;I.d={f:Pq,r:Mq,D:Tq,C:qq,L:Rq,m:Iq,X:$q,S:Lq,M:Bq};function Pq(){var i=Ha.f(),s=yd();return i||s}function Mq(i){var s=vl(i);s!==null&&s.tag===5&&s.type==="form"?A_(s):Ha.r(i)}var Yl=typeof document>"u"?null:document;function m1(i,s,c){var f=Yl;if(f&&typeof s=="string"&&s){var y=wn(s);y='link[rel="'+i+'"][href="'+y+'"]',typeof c=="string"&&(y+='[crossorigin="'+c+'"]'),d1.has(y)||(d1.add(y),i={rel:i,crossOrigin:c,href:s},f.querySelector(y)===null&&(s=f.createElement("link"),Or(s,"link",i),pr(s),f.head.appendChild(s)))}}function Tq(i){Ha.D(i),m1("dns-prefetch",i,null)}function qq(i,s){Ha.C(i,s),m1("preconnect",i,s)}function Rq(i,s,c){Ha.L(i,s,c);var f=Yl;if(f&&i&&s){var y='link[rel="preload"][as="'+wn(s)+'"]';s==="image"&&c&&c.imageSrcSet?(y+='[imagesrcset="'+wn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(y+='[imagesizes="'+wn(c.imageSizes)+'"]')):y+='[href="'+wn(i)+'"]';var N=y;switch(s){case"style":N=Kl(i);break;case"script":N=Wl(i)}Pn.has(N)||(i=v({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),Pn.set(N,i),f.querySelector(y)!==null||s==="style"&&f.querySelector(gc(N))||s==="script"&&f.querySelector(xc(N))||(s=f.createElement("link"),Or(s,"link",i),pr(s),f.head.appendChild(s)))}}function Iq(i,s){Ha.m(i,s);var c=Yl;if(c&&i){var f=s&&typeof s.as=="string"?s.as:"script",y='link[rel="modulepreload"][as="'+wn(f)+'"][href="'+wn(i)+'"]',N=y;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":N=Wl(i)}if(!Pn.has(N)&&(i=v({rel:"modulepreload",href:i},s),Pn.set(N,i),c.querySelector(y)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(xc(N)))return}f=c.createElement("link"),Or(f,"link",i),pr(f),c.head.appendChild(f)}}}function Lq(i,s,c){Ha.S(i,s,c);var f=Yl;if(f&&i){var y=gl(f).hoistableStyles,N=Kl(i);s=s||"default";var O=y.get(N);if(!O){var q={loading:0,preload:null};if(O=f.querySelector(gc(N)))q.loading=5;else{i=v({rel:"stylesheet",href:i,"data-precedence":s},c),(c=Pn.get(N))&&Pv(i,c);var Q=O=f.createElement("link");pr(Q),Or(Q,"link",i),Q._p=new Promise(function(oe,ge){Q.onload=oe,Q.onerror=ge}),Q.addEventListener("load",function(){q.loading|=1}),Q.addEventListener("error",function(){q.loading|=2}),q.loading|=4,kd(O,s,f)}O={type:"stylesheet",instance:O,count:1,state:q},y.set(N,O)}}}function $q(i,s){Ha.X(i,s);var c=Yl;if(c&&i){var f=gl(c).hoistableScripts,y=Wl(i),N=f.get(y);N||(N=c.querySelector(xc(y)),N||(i=v({src:i,async:!0},s),(s=Pn.get(y))&&Mv(i,s),N=c.createElement("script"),pr(N),Or(N,"link",i),c.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},f.set(y,N))}}function Bq(i,s){Ha.M(i,s);var c=Yl;if(c&&i){var f=gl(c).hoistableScripts,y=Wl(i),N=f.get(y);N||(N=c.querySelector(xc(y)),N||(i=v({src:i,async:!0,type:"module"},s),(s=Pn.get(y))&&Mv(i,s),N=c.createElement("script"),pr(N),Or(N,"link",i),c.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},f.set(y,N))}}function f1(i,s,c,f){var y=(y=G.current)?zd(y):null;if(!y)throw Error(a(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Kl(c.href),c=gl(y).hoistableStyles,f=c.get(s),f||(f={type:"style",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Kl(c.href);var N=gl(y).hoistableStyles,O=N.get(i);if(O||(y=y.ownerDocument||y,O={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},N.set(i,O),(N=y.querySelector(gc(i)))&&!N._p&&(O.instance=N,O.state.loading=5),Pn.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Pn.set(i,c),N||Uq(y,i,c,O.state))),s&&f===null)throw Error(a(528,""));return O}if(s&&f!==null)throw Error(a(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Wl(c),c=gl(y).hoistableScripts,f=c.get(s),f||(f={type:"script",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,i))}}function Kl(i){return'href="'+wn(i)+'"'}function gc(i){return'link[rel="stylesheet"]['+i+"]"}function p1(i){return v({},i,{"data-precedence":i.precedence,precedence:null})}function Uq(i,s,c,f){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=i.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),Or(s,"link",c),pr(s),i.head.appendChild(s))}function Wl(i){return'[src="'+wn(i)+'"]'}function xc(i){return"script[async]"+i}function h1(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var f=i.querySelector('style[data-href~="'+wn(c.href)+'"]');if(f)return s.instance=f,pr(f),f;var y=v({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(i.ownerDocument||i).createElement("style"),pr(f),Or(f,"style",y),kd(f,c.precedence,i),s.instance=f;case"stylesheet":y=Kl(c.href);var N=i.querySelector(gc(y));if(N)return s.state.loading|=4,s.instance=N,pr(N),N;f=p1(c),(y=Pn.get(y))&&Pv(f,y),N=(i.ownerDocument||i).createElement("link"),pr(N);var O=N;return O._p=new Promise(function(q,Q){O.onload=q,O.onerror=Q}),Or(N,"link",f),s.state.loading|=4,kd(N,c.precedence,i),s.instance=N;case"script":return N=Wl(c.src),(y=i.querySelector(xc(N)))?(s.instance=y,pr(y),y):(f=c,(y=Pn.get(N))&&(f=v({},c),Mv(f,y)),i=i.ownerDocument||i,y=i.createElement("script"),pr(y),Or(y,"link",f),i.head.appendChild(y),s.instance=y);case"void":return null;default:throw Error(a(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,kd(f,c.precedence,i));return s.instance}function kd(i,s,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=f.length?f[f.length-1]:null,N=y,O=0;O<f.length;O++){var q=f[O];if(q.dataset.precedence===s)N=q;else if(N!==y)break}N?N.parentNode.insertBefore(i,N.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function Pv(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function Mv(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var Od=null;function v1(i,s,c){if(Od===null){var f=new Map,y=Od=new Map;y.set(c,f)}else y=Od,f=y.get(c),f||(f=new Map,y.set(c,f));if(f.has(i))return f;for(f.set(i,null),c=c.getElementsByTagName(i),y=0;y<c.length;y++){var N=c[y];if(!(N[Mo]||N[Er]||i==="link"&&N.getAttribute("rel")==="stylesheet")&&N.namespaceURI!=="http://www.w3.org/2000/svg"){var O=N.getAttribute(s)||"";O=i+O;var q=f.get(O);q?q.push(N):f.set(O,[N])}}return f}function g1(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function Fq(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(i=s.disabled,typeof s.precedence=="string"&&i==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function x1(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function Gq(i,s,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var y=Kl(f.href),N=s.querySelector(gc(y));if(N){s=N._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(i.count++,i=Dd.bind(i),s.then(i,i)),c.state.loading|=4,c.instance=N,pr(N);return}N=s.ownerDocument||s,f=p1(f),(y=Pn.get(y))&&Pv(f,y),N=N.createElement("link"),pr(N);var O=N;O._p=new Promise(function(q,Q){O.onload=q,O.onerror=Q}),Or(N,"link",f),c.instance=N}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(i.count++,c=Dd.bind(i),s.addEventListener("load",c),s.addEventListener("error",c))}}var Tv=0;function Hq(i,s){return i.stylesheets&&i.count===0&&Md(i,i.stylesheets),0<i.count||0<i.imgCount?function(c){var f=setTimeout(function(){if(i.stylesheets&&Md(i,i.stylesheets),i.unsuspend){var N=i.unsuspend;i.unsuspend=null,N()}},6e4+s);0<i.imgBytes&&Tv===0&&(Tv=62500*wq());var y=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Md(i,i.stylesheets),i.unsuspend)){var N=i.unsuspend;i.unsuspend=null,N()}},(i.imgBytes>Tv?50:800)+s);return i.unsuspend=c,function(){i.unsuspend=null,clearTimeout(f),clearTimeout(y)}}:null}function Dd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Md(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Pd=null;function Md(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Pd=new Map,s.forEach(Vq,i),Pd=null,Dd.call(i))}function Vq(i,s){if(!(s.state.loading&4)){var c=Pd.get(i);if(c)var f=c.get(null);else{c=new Map,Pd.set(i,c);for(var y=i.querySelectorAll("link[data-precedence],style[data-precedence]"),N=0;N<y.length;N++){var O=y[N];(O.nodeName==="LINK"||O.getAttribute("media")!=="not all")&&(c.set(O.dataset.precedence,O),f=O)}f&&c.set(null,f)}y=s.instance,O=y.getAttribute("data-precedence"),N=c.get(O)||f,N===f&&c.set(null,y),c.set(O,y),this.count++,f=Dd.bind(this),y.addEventListener("load",f),y.addEventListener("error",f),N?N.parentNode.insertBefore(y,N.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(y,i.firstChild)),s.state.loading|=4}}var bc={$$typeof:S,Provider:null,Consumer:null,_currentValue:U,_currentValue2:U,_threadCount:0};function Qq(i,s,c,f,y,N,O,q,Q){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Fe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fe(0),this.hiddenUpdates=Fe(null),this.identifierPrefix=f,this.onUncaughtError=y,this.onCaughtError=N,this.onRecoverableError=O,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Q,this.incompleteTransitions=new Map}function b1(i,s,c,f,y,N,O,q,Q,oe,ge,ye){return i=new Qq(i,s,c,O,Q,oe,ge,ye,q),s=1,N===!0&&(s|=24),N=cn(3,null,null,s),i.current=N,N.stateNode=i,s=ph(),s.refCount++,i.pooledCache=s,s.refCount++,N.memoizedState={element:f,isDehydrated:c,cache:s},xh(N),i}function y1(i){return i?(i=El,i):El}function j1(i,s,c,f,y,N){y=y1(y),f.context===null?f.context=y:f.pendingContext=y,f=Ei(s),f.payload={element:c},N=N===void 0?null:N,N!==null&&(f.callback=N),c=Ai(i,f,s),c!==null&&(rn(c,i,s),Xo(c,i,s))}function _1(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function qv(i,s){_1(i,s),(i=i.alternate)&&_1(i,s)}function N1(i){if(i.tag===13||i.tag===31){var s=vs(i,67108864);s!==null&&rn(s,i,67108864),qv(i,67108864)}}function S1(i){if(i.tag===13||i.tag===31){var s=pn();s=Op(s);var c=vs(i,s);c!==null&&rn(c,i,s),qv(i,s)}}var Td=!0;function Yq(i,s,c,f){var y=L.T;L.T=null;var N=I.p;try{I.p=2,Rv(i,s,c,f)}finally{I.p=N,L.T=y}}function Kq(i,s,c,f){var y=L.T;L.T=null;var N=I.p;try{I.p=8,Rv(i,s,c,f)}finally{I.p=N,L.T=y}}function Rv(i,s,c,f){if(Td){var y=Iv(f);if(y===null)Nv(i,s,f,qd,c),C1(i,f);else if(Xq(y,i,s,c,f))f.stopPropagation();else if(C1(i,f),s&4&&-1<Wq.indexOf(i)){for(;y!==null;){var N=vl(y);if(N!==null)switch(N.tag){case 3:if(N=N.stateNode,N.current.memoizedState.isDehydrated){var O=Ea(N.pendingLanes);if(O!==0){var q=N;for(q.pendingLanes|=2,q.entangledLanes|=2;O;){var Q=1<<31-We(O);q.entanglements[1]|=Q,O&=~Q}da(N),(vt&6)===0&&(xd=Ie()+500,fc(0))}}break;case 31:case 13:q=vs(N,2),q!==null&&rn(q,N,2),yd(),qv(N,2)}if(N=Iv(f),N===null&&Nv(i,s,f,qd,c),N===y)break;y=N}y!==null&&f.stopPropagation()}else Nv(i,s,f,null,c)}}function Iv(i){return i=$p(i),Lv(i)}var qd=null;function Lv(i){if(qd=null,i=hl(i),i!==null){var s=o(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=u(s),i!==null)return i;i=null}else if(c===31){if(i=d(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return qd=i,null}function w1(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ye()){case nt:return 2;case qt:return 8;case Kt:case se:return 32;case Oe:return 268435456;default:return 32}default:return 32}}var $v=!1,Li=null,$i=null,Bi=null,yc=new Map,jc=new Map,Ui=[],Wq="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function C1(i,s){switch(i){case"focusin":case"focusout":Li=null;break;case"dragenter":case"dragleave":$i=null;break;case"mouseover":case"mouseout":Bi=null;break;case"pointerover":case"pointerout":yc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":jc.delete(s.pointerId)}}function _c(i,s,c,f,y,N){return i===null||i.nativeEvent!==N?(i={blockedOn:s,domEventName:c,eventSystemFlags:f,nativeEvent:N,targetContainers:[y]},s!==null&&(s=vl(s),s!==null&&N1(s)),i):(i.eventSystemFlags|=f,s=i.targetContainers,y!==null&&s.indexOf(y)===-1&&s.push(y),i)}function Xq(i,s,c,f,y){switch(s){case"focusin":return Li=_c(Li,i,s,c,f,y),!0;case"dragenter":return $i=_c($i,i,s,c,f,y),!0;case"mouseover":return Bi=_c(Bi,i,s,c,f,y),!0;case"pointerover":var N=y.pointerId;return yc.set(N,_c(yc.get(N)||null,i,s,c,f,y)),!0;case"gotpointercapture":return N=y.pointerId,jc.set(N,_c(jc.get(N)||null,i,s,c,f,y)),!0}return!1}function E1(i){var s=hl(i.target);if(s!==null){var c=o(s);if(c!==null){if(s=c.tag,s===13){if(s=u(c),s!==null){i.blockedOn=s,Bj(i.priority,function(){S1(c)});return}}else if(s===31){if(s=d(c),s!==null){i.blockedOn=s,Bj(i.priority,function(){S1(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Rd(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=Iv(i.nativeEvent);if(c===null){c=i.nativeEvent;var f=new c.constructor(c.type,c);Lp=f,c.target.dispatchEvent(f),Lp=null}else return s=vl(c),s!==null&&N1(s),i.blockedOn=c,!1;s.shift()}return!0}function A1(i,s,c){Rd(i)&&c.delete(s)}function Zq(){$v=!1,Li!==null&&Rd(Li)&&(Li=null),$i!==null&&Rd($i)&&($i=null),Bi!==null&&Rd(Bi)&&(Bi=null),yc.forEach(A1),jc.forEach(A1)}function Id(i,s){i.blockedOn===s&&(i.blockedOn=null,$v||($v=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Zq)))}var Ld=null;function z1(i){Ld!==i&&(Ld=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Ld===i&&(Ld=null);for(var s=0;s<i.length;s+=3){var c=i[s],f=i[s+1],y=i[s+2];if(typeof f!="function"){if(Lv(f||c)===null)continue;break}var N=vl(c);N!==null&&(i.splice(s,3),s-=3,Ih(N,{pending:!0,data:y,method:c.method,action:f},f,y))}}))}function Xl(i){function s(Q){return Id(Q,i)}Li!==null&&Id(Li,i),$i!==null&&Id($i,i),Bi!==null&&Id(Bi,i),yc.forEach(s),jc.forEach(s);for(var c=0;c<Ui.length;c++){var f=Ui[c];f.blockedOn===i&&(f.blockedOn=null)}for(;0<Ui.length&&(c=Ui[0],c.blockedOn===null);)E1(c),c.blockedOn===null&&Ui.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var y=c[f],N=c[f+1],O=y[Wr]||null;if(typeof N=="function")O||z1(c);else if(O){var q=null;if(N&&N.hasAttribute("formAction")){if(y=N,O=N[Wr]||null)q=O.formAction;else if(Lv(y)!==null)continue}else q=O.action;typeof q=="function"?c[f+1]=q:(c.splice(f,3),f-=3),z1(c)}}}function k1(){function i(N){N.canIntercept&&N.info==="react-transition"&&N.intercept({handler:function(){return new Promise(function(O){return y=O})},focusReset:"manual",scroll:"manual"})}function s(){y!==null&&(y(),y=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var N=navigation.currentEntry;N&&N.url!=null&&navigation.navigate(N.url,{state:N.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,y=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),y!==null&&(y(),y=null)}}}function Bv(i){this._internalRoot=i}$d.prototype.render=Bv.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(a(409));var c=s.current,f=pn();j1(c,f,i,s,null,null)},$d.prototype.unmount=Bv.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;j1(i.current,2,null,i,null,null),yd(),s[pl]=null}};function $d(i){this._internalRoot=i}$d.prototype.unstable_scheduleHydration=function(i){if(i){var s=$j();i={blockedOn:null,target:i,priority:s};for(var c=0;c<Ui.length&&s!==0&&s<Ui[c].priority;c++);Ui.splice(c,0,i),c===0&&E1(i)}};var O1=r.version;if(O1!=="19.2.4")throw Error(a(527,O1,"19.2.4"));I.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=p(s),i=i!==null?h(i):null,i=i===null?null:i.stateNode,i};var Jq={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bd.isDisabled&&Bd.supportsFiber)try{W=Bd.inject(Jq),ie=Bd}catch{}}return Sc.createRoot=function(i,s){if(!l(i))throw Error(a(299));var c=!1,f="",y=I_,N=L_,O=$_;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(y=s.onUncaughtError),s.onCaughtError!==void 0&&(N=s.onCaughtError),s.onRecoverableError!==void 0&&(O=s.onRecoverableError)),s=b1(i,1,!1,null,null,c,f,null,y,N,O,k1),i[pl]=s.current,_v(i),new Bv(s)},Sc.hydrateRoot=function(i,s,c){if(!l(i))throw Error(a(299));var f=!1,y="",N=I_,O=L_,q=$_,Q=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(O=c.onCaughtError),c.onRecoverableError!==void 0&&(q=c.onRecoverableError),c.formState!==void 0&&(Q=c.formState)),s=b1(i,1,!0,s,c??null,f,y,Q,N,O,q,k1),s.context=y1(null),c=s.current,f=pn(),f=Op(f),y=Ei(f),y.callback=null,Ai(c,y,f),c=f,s.current.lanes=c,gt(s,c),da(s),i[pl]=s.current,_v(i),new $d(s)},Sc.version="19.2.4",Sc}var $1;function t5(){if($1)return Hv.exports;$1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),Hv.exports=e5(),Hv.exports}var r5=t5();const n5=oi(r5),a5={apiKey:"AIzaSyDgk_1graNBFkIURTJnyLZTZ1nyxi7slUo",authDomain:"pedaclic.firebaseapp.com",projectId:"pedaclic",storageBucket:"pedaclic.firebasestorage.app",messagingSenderId:"863649621890",appId:"1:863649621890:web:6ab56a8c8db111e3a9119b"},Kb=s3(a5),no=l3(Kb),V=o3(Kb,{localCache:c3({tabManager:d3()})}),ar=u3(Kb),i5=Object.freeze(Object.defineProperty({__proto__:null,auth:no,db:V,storage:ar},Symbol.toStringTag,{value:"Module"})),B1={"auth/email-already-in-use":"Cette adresse email est dj utilise.","auth/invalid-email":"Adresse email invalide.","auth/operation-not-allowed":"Opration non autorise.","auth/weak-password":"Le mot de passe doit contenir au moins 6 caractres.","auth/user-disabled":"Ce compte a t dsactiv.","auth/user-not-found":"Aucun compte associ  cette adresse email.","auth/wrong-password":"Mot de passe incorrect.","auth/too-many-requests":"Trop de tentatives. Veuillez ressayer plus tard.","auth/network-request-failed":"Erreur de connexion. Vrifiez votre connexion internet.",default:"Une erreur est survenue. Veuillez ressayer."},Yv=e=>B1[e]||B1.default,OA=g.createContext(null),s5=({children:e})=>{const[r,n]=g.useState(null),[a,l]=g.useState(!0),o=async x=>{try{const j=await pt(je(V,"users",x));if(j.exists()){const _=j.data();return{uid:x,email:_.email,displayName:_.displayName,role:_.role,isPremium:_.isPremium||!1,subscriptionEnd:_.subscriptionEnd?.toDate()||null,subscriptionPlan:_.subscriptionPlan||void 0,coursChoisis:_.coursChoisis||[],usageRessources:_.usageRessourcesTotal??_.usageRessources??0,photoURL:_.photoURL,createdAt:_.createdAt?.toDate()||new Date,lastLogin:_.lastLogin?.toDate()}}return null}catch(j){return console.error("Erreur lors de la rcupration des donnes utilisateur:",j),null}},u=async(x,j)=>{const _=je(V,"users",x.uid);(await pt(_)).exists()?await Ve(_,{lastLogin:kt()}):await rl(_,{email:x.email,displayName:x.displayName||j?.displayName||"",role:j?.role||"eleve",isPremium:!1,photoURL:x.photoURL,createdAt:kt(),lastLogin:kt()})},d=async(x,j)=>{try{const _=await x3(no,x,j);await u(_.user)}catch(_){throw new Error(Yv(_.code))}},m=async x=>{try{if(x.password!==x.confirmPassword)throw new Error("Les mots de passe ne correspondent pas.");const j=await p3(no,x.email,x.password);await h3(j.user,{displayName:x.displayName}),await u(j.user,{displayName:x.displayName,role:x.role})}catch(j){throw j.message?j:new Error(Yv(j.code))}},p=async x=>{try{const j=new v3;j.setCustomParameters({prompt:"select_account"});const _=await g3(no,j);await u(_.user,{role:x??"eleve"})}catch(j){throw new Error(Yv(j.code))}},h=async()=>{try{await f3(no),n(null)}catch{throw new Error("Erreur lors de la dconnexion.")}},v=async x=>{if(!r)throw new Error("Aucun utilisateur connect.");try{const j=je(V,"users",r.uid);await Ve(j,{...x,updatedAt:kt()}),n(_=>_?{..._,...x}:null)}catch{throw new Error("Erreur lors de la mise  jour du profil.")}};g.useEffect(()=>{const x=m3(no,async j=>{if(j){const _=await o(j.uid);n(_)}else n(null);l(!1)});return()=>x()},[]);const b={currentUser:r,loading:a,login:d,loginWithGoogle:p,register:m,logout:h,updateProfile:v};return t.jsx(OA.Provider,{value:b,children:a?t.jsxs("div",{className:"loading-container",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement..."})]}):e})},Xe=()=>{const e=g.useContext(OA);if(!e)throw new Error("useAuth doit tre utilis  l'intrieur d'un AuthProvider");return e},Hi=({children:e,allowedRoles:r,requirePremium:n=!1})=>{const{currentUser:a,loading:l}=Xe();return l?t.jsxs("div",{className:"loading-container",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Vrification des autorisations..."})]}):a?r&&!r.includes(a.role)?t.jsxs("div",{className:"error-container",children:[t.jsx("h2",{children:"Accs non autoris"}),t.jsx("p",{children:"Vous n'avez pas les permissions ncessaires pour accder  cette page."}),t.jsx("a",{href:"/",className:"btn btn-primary",children:"Retour  l'accueil"})]}):n&&!a.isPremium?t.jsxs("div",{className:"error-container premium-required",children:[t.jsx("h2",{children:"Contenu Premium"}),t.jsx("p",{children:"Cette ressource est rserve aux abonns Premium."}),t.jsxs("div",{className:"premium-cta",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Ds 10 000 FCFA / 3 mois"}),"  Accs illimit"]}),t.jsx("a",{href:"/premium",className:"btn btn-premium",children:"Devenir Premium"})]})]}):t.jsx(t.Fragment,{children:e}):t.jsxs("div",{className:"error-container",children:[t.jsx("h2",{children:"Accs refus"}),t.jsx("p",{children:"Vous devez tre connect pour accder  cette page."}),t.jsx("a",{href:"/connexion",className:"btn btn-primary",children:"Se connecter"})]})},Ur=({children:e})=>t.jsx(Hi,{allowedRoles:["admin"],children:e}),Xn=({children:e})=>t.jsx(Hi,{allowedRoles:["admin","prof"],children:e}),l5="http://localhost:3001",Ca="notifications";function DA(e,r){return{id:e,destinataireId:r.destinataireId,destinataireRole:r.destinataireRole,type:r.type,titre:r.titre,message:r.message,lienAction:r.lienAction,labelAction:r.labelAction,emetteurId:r.emetteurId,emetteurNom:r.emetteurNom,entiteId:r.entiteId,entiteType:r.entiteType,statut:r.statut,canal:r.canal,emailEnvoye:r.emailEnvoye,emailErreur:r.emailErreur,createdAt:r.createdAt?.toDate()??new Date,luAt:r.luAt?.toDate()??void 0}}async function o5(e){return(await Ot(_e(V,Ca),{destinataireId:e.destinataireId,destinataireRole:e.destinataireRole,type:e.type,titre:e.titre,message:e.message,lienAction:e.lienAction??null,labelAction:e.labelAction??null,emetteurId:e.emetteurId??null,emetteurNom:e.emetteurNom??null,entiteId:e.entiteId??null,entiteType:e.entiteType??null,statut:"non_lue",canal:e.canal,emailEnvoye:!1,createdAt:Ee.now()})).id}async function c5(e){try{const r=await fetch(`${l5}/api/notifications/send-email`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok){const a=await r.text();return{success:!1,error:`HTTP ${r.status}: ${a}`}}return await r.json()}catch(r){return{success:!1,error:r instanceof Error?r.message:"Erreur rseau inconnue"}}}async function u5(e){const r=await o5(e);let n=!1,a;if((e.canal==="email"||e.canal==="les_deux")&&e.emailDestinataire){const l=await c5({to:e.emailDestinataire,toName:e.emailDestinatairNom,type:e.type,titre:e.titre,message:e.message,lienAction:e.lienAction,labelAction:e.labelAction,emetteurNom:e.emetteurNom});n=l.success,a=l.error,await Ve(je(V,Ca,r),{emailEnvoye:n,emailErreur:a??null})}return{notifId:r,emailEnvoye:n,emailErreur:a}}async function d5(e,r){const n=ze(_e(V,"inscriptions_groupe"),Se("groupeId","==",e),Se("statut","==","actif")),a=await Ae(n);let l=0;const o=Ln(V);return a.docs.forEach(u=>{const d=u.data().eleveId,m=je(_e(V,Ca));o.set(m,{destinataireId:d,destinataireRole:"eleve",type:r.type,titre:r.titre,message:r.message,lienAction:r.lienAction??null,labelAction:r.labelAction??null,emetteurId:r.emetteurId??null,emetteurNom:r.emetteurNom??null,entiteId:r.entiteId??null,entiteType:r.entiteType??null,statut:"non_lue",canal:r.canal,emailEnvoye:!1,createdAt:Ee.now()}),l++}),await o.commit(),l}async function m5(e,r){const n=e==="tous"?ze(_e(V,"users"),$t(500)):ze(_e(V,"users"),Se("role","==",e),$t(500)),a=await Ae(n);let l=0;const o=Ln(V);return a.docs.forEach(u=>{const d=u.data(),m=je(_e(V,Ca));o.set(m,{destinataireId:u.id,destinataireRole:d.role??e,type:r.type,titre:r.titre,message:r.message,lienAction:r.lienAction??null,labelAction:r.labelAction??null,emetteurId:r.emetteurId??null,emetteurNom:r.emetteurNom??null,entiteId:r.entiteId??null,entiteType:r.entiteType??null,statut:"non_lue",canal:r.canal,emailEnvoye:!1,createdAt:Ee.now()}),l++}),await o.commit(),l}async function f5(e,r={}){const{includeArchived:n=!1,limitCount:a=50}=r,l=[Se("destinataireId","==",e),Qe("createdAt","desc"),$t(a)];n||l.splice(1,0,Se("statut","!=","archivee"));const o=ze(_e(V,Ca),...l);return(await Ae(o)).docs.map(d=>DA(d.id,d.data()))}function p5(e,r){const n=ze(_e(V,Ca),Se("destinataireId","==",e),Se("statut","==","non_lue"),Qe("createdAt","desc"),$t(20));return kf(n,a=>{const l=a.docs.map(o=>DA(o.id,o.data()));r(l)})}async function Rx(e){await Ve(je(V,Ca,e),{statut:"lue",luAt:Ee.now()})}async function PA(e){const r=ze(_e(V,Ca),Se("destinataireId","==",e),Se("statut","==","non_lue")),n=await Ae(r),a=Ln(V);n.docs.forEach(l=>{a.update(l.ref,{statut:"lue",luAt:Ee.now()})}),await a.commit()}async function h5(e){await Ve(je(V,Ca,e),{statut:"archivee"})}async function v5(e){await Ir(je(V,Ca,e))}const Sm={nouveau_cours:{titreDefaut:"Nouveau cours disponible",messageDefaut:"Un nouveau cours vient d'tre publi dans votre matire.",icone:"",couleur:"#2563eb"},resultat_quiz:{titreDefaut:"Rsultat de votre quiz",messageDefaut:"Votre rsultat au quiz est disponible.",icone:"",couleur:"#10b981"},rappel_echeance:{titreDefaut:"Rappel d'chance",messageDefaut:"N'oubliez pas votre examen approche.",icone:"",couleur:"#f59e0b"},message_prof:{titreDefaut:"Message de votre professeur",messageDefaut:"",icone:"",couleur:"#8b5cf6"},annonce:{titreDefaut:"Annonce importante",messageDefaut:"",icone:"",couleur:"#ef4444"},nouveau_abonnement:{titreDefaut:"Abonnement Premium activ ",messageDefaut:"Votre abonnement Premium PedaClic est maintenant actif. Profitez de tous les contenus !",icone:"",couleur:"#f59e0b"},bienvenue:{titreDefaut:"Bienvenue sur PedaClic !",messageDefaut:"Bienvenue sur PedaClic, la plateforme ducative sngalaise. Commencez votre apprentissage ds maintenant !",icone:"",couleur:"#10b981"}},Wb={nouveau_cours:" Nouveau cours",resultat_quiz:" Rsultat quiz",rappel_echeance:" Rappel chance",message_prof:" Message prof",annonce:" Annonce",nouveau_abonnement:" Abonnement",bienvenue:" Bienvenue"},g5={eleve:" lves",parent:" Parents",prof:" Professeurs",admin:" Admins",tous:" Tous les utilisateurs"};function x5(e){const n=new Date().getTime()-e.getTime(),a=Math.floor(n/6e4),l=Math.floor(a/60),o=Math.floor(l/24);return a<1?" l'instant":a<60?`Il y a ${a} min`:l<24?`Il y a ${l}h`:o===1?"Hier":o<7?`Il y a ${o} jours`:e.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})}const b5=()=>{const{currentUser:e}=Xe(),r=tt(),[n,a]=g.useState([]),[l,o]=g.useState(!1),[u,d]=g.useState(!1),m=g.useRef(null);g.useEffect(()=>{if(!e)return;const x=p5(e.uid,j=>a(j));return()=>x()},[e]),g.useEffect(()=>{function x(j){m.current&&!m.current.contains(j.target)&&o(!1)}return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const p=n.length,h=g.useCallback(async x=>{await Rx(x.id),o(!1),x.lienAction&&r(x.lienAction)},[r]),v=g.useCallback(async()=>{if(!(!e||u)){d(!0);try{await PA(e.uid)}finally{d(!1)}}},[e,u]),b=()=>{o(!1),r("/notifications")};return e?t.jsxs("div",{className:"notif-bell",ref:m,children:[t.jsxs("button",{className:"notif-bell__btn",onClick:()=>o(x=>!x),"aria-label":`Notifications${p>0?`  ${p} non lues`:""}`,"aria-expanded":l,"aria-haspopup":"true",children:[t.jsx("span",{className:"notif-bell__icon","aria-hidden":"true",children:""}),p>0&&t.jsx("span",{className:"notif-bell__badge","aria-hidden":"true",children:p>99?"99+":p})]}),l&&t.jsxs("div",{className:"notif-bell__dropdown",role:"dialog","aria-label":"Notifications rcentes",children:[t.jsxs("div",{className:"notif-bell__dropdown-header",children:[t.jsxs("h3",{className:"notif-bell__dropdown-title",children:[" Notifications",p>0&&t.jsxs("span",{className:"notif-bell__dropdown-count",children:[p," nouvelles"]})]}),p>0&&t.jsx("button",{className:"notif-bell__mark-all-btn",onClick:v,disabled:u,children:u?"":"Tout lire"})]}),t.jsx("div",{className:"notif-bell__list",children:n.length===0?t.jsxs("div",{className:"notif-bell__empty",children:[t.jsx("span",{className:"notif-bell__empty-icon",children:""}),t.jsx("p",{children:"Tout est  jour !"})]}):n.slice(0,5).map(x=>{const j=Sm[x.type];return t.jsxs("button",{className:`notif-bell__item ${x.statut==="non_lue"?"notif-bell__item--unread":""}`,onClick:()=>h(x),children:[t.jsx("span",{className:"notif-bell__item-icon",style:{background:j.couleur+"20",color:j.couleur},"aria-hidden":"true",children:j.icone}),t.jsxs("div",{className:"notif-bell__item-content",children:[t.jsx("p",{className:"notif-bell__item-titre",children:x.titre}),t.jsx("p",{className:"notif-bell__item-message",children:x.message}),t.jsx("p",{className:"notif-bell__item-date",children:x5(x.createdAt)})]}),x.statut==="non_lue"&&t.jsx("span",{className:"notif-bell__item-dot","aria-hidden":"true"})]},x.id)})}),t.jsx("div",{className:"notif-bell__dropdown-footer",children:t.jsx("button",{className:"notif-bell__see-all-btn",onClick:b,children:"Voir toutes les notifications "})})]})]}):null},y5=()=>{const{currentUser:e,logout:r,loading:n}=Xe(),a=tt(),l=Hb(),[o,u]=g.useState(!1),[d,m]=g.useState(!1),[p,h]=g.useState(!1),[v,b]=g.useState(null),x=g.useRef(null),j=[{path:"/",label:"Accueil",icon:t.jsx(Mx,{size:18})},{path:"/disciplines",label:"Disciplines",icon:t.jsx(xn,{size:18})},{path:"/ebooks",label:"Bibliothque",icon:t.jsx(xn,{size:18})},{path:"/mediatheque",label:"Mdiathque",icon:t.jsx(y3,{size:18})},{path:"/quiz-gratuits",label:"Quiz",icon:t.jsx(Bs,{size:18}),requireAuth:!1},{path:"/quizzes",label:"Quiz Avancs",icon:t.jsx(Bs,{size:18}),requireAuth:!0,requirePremium:!0},{path:"/premium",label:"Premium",icon:t.jsx(jr,{size:18}),hideIfPremium:!0},{path:e?.role==="eleve"?"/eleve/dashboard":e?.role==="prof"?"/prof/dashboard":e?.role==="parent"?"/parent/dashboard":"/admin",label:"Tableau de bord",icon:t.jsx(D1,{size:18}),requireAuth:!0},{path:"/generateur",label:"Gnrateur IA",icon:t.jsx(j3,{size:18}),requireAuth:!0,requirePremium:!0},{path:"/parent/dashboard",label:"Espace Parent",icon:t.jsx(Us,{size:18}),requireAuth:!0,requireRole:["parent"]}];g.useEffect(()=>{const P=D=>{x.current&&!x.current.contains(D.target)&&m(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]),g.useEffect(()=>{const P=$=>{$.preventDefault(),b($)},D=()=>b(null);return window.addEventListener("beforeinstallprompt",P),window.addEventListener("appinstalled",D),()=>{window.removeEventListener("beforeinstallprompt",P),window.removeEventListener("appinstalled",D)}},[]);const _=g.useCallback(async()=>{if(!v)return;await v.prompt();const{outcome:P}=await v.userChoice;P==="accepted"&&b(null)},[v]);g.useEffect(()=>{u(!1),m(!1)},[l.pathname]),g.useEffect(()=>(o?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[o]);const w=async()=>{try{h(!0),await r(),m(!1),a("/")}catch(P){console.error("Erreur lors de la dconnexion:",P)}finally{h(!1)}},C=()=>{u(!o)},E=()=>{m(!d)},S=P=>!(P.requireAuth&&!e||P.requirePremium&&e&&!e.isPremium||P.hideIfPremium&&(e?.isPremium||e?.role==="admin")||P.requireRole&&e&&!P.requireRole.includes(e.role)),A=P=>P==="/"?l.pathname==="/":l.pathname.startsWith(P),z=P=>({admin:"Administrateur",prof:"Professeur",eleve:"lve",parent:"Parent"})[P]||P,k=()=>e?e.displayName?e.displayName.split(" ").map(D=>D[0]).join("").toUpperCase().slice(0,2):e.email[0].toUpperCase():"?";return t.jsxs("header",{className:"header",children:[t.jsxs("div",{className:"header__container",children:[t.jsxs($e,{to:"/",className:"header__logo",children:[t.jsx(Bs,{className:"header__logo-icon",size:32}),t.jsxs("div",{className:"header__logo-text",children:[t.jsx("span",{className:"header__logo-name",children:"PedaClic"}),t.jsx("span",{className:"header__logo-tagline",children:"L'cole en un clic"})]})]}),t.jsx("nav",{className:"header__nav header__nav--desktop",children:t.jsx("ul",{className:"header__nav-list",children:j.map(P=>S(P)&&t.jsx("li",{className:"header__nav-item",children:t.jsxs($e,{to:P.path,className:`header__nav-link ${A(P.path)?"header__nav-link--active":""} ${P.hideIfPremium?"header__nav-link--premium-cta":""}`,children:[P.icon,t.jsx("span",{children:P.label}),P.requirePremium&&t.jsx(qc,{size:14,className:"header__premium-badge"})]})},P.path))})}),t.jsxs("div",{className:"header__actions",children:[v&&t.jsxs("button",{className:"header__install-btn",onClick:_,title:"Installer PedaClic sur cet appareil",children:[t.jsx(EA,{size:16}),t.jsx("span",{children:"Installer"})]}),n?t.jsx("div",{className:"header__loading",children:t.jsx("div",{className:"header__spinner"})}):e?t.jsxs(t.Fragment,{children:[t.jsx(b5,{}),t.jsxs("div",{className:"header__user",ref:x,children:[e.isPremium&&t.jsxs("span",{className:"header__premium-tag",children:[t.jsx(qc,{size:14}),"Premium"]}),t.jsxs("button",{className:"header__user-button",onClick:E,"aria-expanded":d,"aria-haspopup":"true",children:[t.jsx("div",{className:"header__avatar",children:e.photoURL?t.jsx("img",{src:e.photoURL,alt:e.displayName||"Avatar",className:"header__avatar-img"}):t.jsx("span",{className:"header__avatar-initials",children:k()})}),t.jsx("span",{className:"header__user-name",children:e.displayName||e.email.split("@")[0]}),t.jsx(jm,{size:16,className:`header__chevron ${d?"header__chevron--open":""}`})]}),d&&t.jsxs("div",{className:"header__dropdown",children:[t.jsxs("div",{className:"header__dropdown-header",children:[t.jsx("p",{className:"header__dropdown-email",children:e.email}),t.jsx("span",{className:`header__dropdown-role header__dropdown-role--${e.role}`,children:z(e.role)})]}),t.jsx("div",{className:"header__dropdown-divider"}),t.jsxs("nav",{className:"header__dropdown-nav",children:[t.jsxs($e,{to:e.role==="eleve"?"/eleve/dashboard":e.role==="prof"?"/prof/dashboard":e.role==="parent"?"/parent/dashboard":"/admin",className:"header__dropdown-link",children:[t.jsx(D1,{size:18}),t.jsx("span",{children:"Tableau de bord"})]}),e.role==="eleve"&&t.jsxs($e,{to:"/eleve/suivi",className:"header__dropdown-link",children:[t.jsx(Us,{size:18}),t.jsx("span",{children:"Mes points  amliorer"})]}),e.role==="parent"&&t.jsxs($e,{to:"/parent/dashboard",className:"header__dropdown-link",children:[t.jsx(Us,{size:18}),t.jsx("span",{children:"Espace Parent"})]}),t.jsxs($e,{to:"/profil",className:"header__dropdown-link",children:[t.jsx(_3,{size:18}),t.jsx("span",{children:"Mon profil"})]}),e.role==="admin"&&t.jsxs($e,{to:"/admin",className:"header__dropdown-link",children:[t.jsx(N3,{size:18}),t.jsx("span",{children:"Administration"})]}),!e.isPremium&&t.jsxs($e,{to:"/premium",className:"header__dropdown-link header__dropdown-link--premium",children:[t.jsx(qc,{size:18}),t.jsx("span",{children:"Passer Premium"})]})]}),t.jsx("div",{className:"header__dropdown-divider"}),t.jsxs("button",{className:"header__dropdown-logout",onClick:w,disabled:p,children:[t.jsx(P1,{size:18}),t.jsx("span",{children:p?"Dconnexion...":"Se dconnecter"})]})]})]})]}):t.jsxs("div",{className:"header__auth-buttons",children:[t.jsx($e,{to:"/connexion",className:"header__btn header__btn--outline",children:"Connexion"}),t.jsx($e,{to:"/inscription",className:"header__btn header__btn--primary",children:"S'inscrire"})]}),t.jsx("button",{className:"header__mobile-toggle",onClick:C,"aria-label":o?"Fermer le menu":"Ouvrir le menu","aria-expanded":o,children:o?t.jsx(Xi,{size:24}):t.jsx(S3,{size:24})})]})]}),t.jsxs("div",{className:`header__mobile-menu ${o?"header__mobile-menu--open":""}`,children:[t.jsx("div",{className:"header__mobile-overlay",onClick:()=>u(!1)}),t.jsxs("div",{className:"header__mobile-content",children:[t.jsx("nav",{className:"header__mobile-nav",children:t.jsx("ul",{className:"header__mobile-list",children:j.map(P=>S(P)&&t.jsx("li",{className:"header__mobile-item",children:t.jsxs($e,{to:P.path,className:`header__mobile-link ${A(P.path)?"header__mobile-link--active":""} ${P.hideIfPremium?"header__mobile-link--premium-cta":""}`,children:[P.icon,t.jsx("span",{children:P.label}),P.requirePremium&&t.jsx(qc,{size:14,className:"header__premium-badge"})]})},P.path))})}),!e&&t.jsxs("div",{className:"header__mobile-auth",children:[t.jsx($e,{to:"/connexion",className:"header__btn header__btn--outline header__btn--block",children:"Connexion"}),t.jsx($e,{to:"/inscription",className:"header__btn header__btn--primary header__btn--block",children:"S'inscrire"})]}),e&&t.jsxs("div",{className:"header__mobile-user",children:[t.jsxs("div",{className:"header__mobile-user-info",children:[t.jsx("div",{className:"header__avatar header__avatar--large",children:e.photoURL?t.jsx("img",{src:e.photoURL,alt:e.displayName||"Avatar",className:"header__avatar-img"}):t.jsx("span",{className:"header__avatar-initials",children:k()})}),t.jsxs("div",{className:"header__mobile-user-details",children:[t.jsx("p",{className:"header__mobile-user-name",children:e.displayName||e.email.split("@")[0]}),t.jsx("p",{className:"header__mobile-user-email",children:e.email})]})]}),t.jsxs("button",{className:"header__mobile-logout",onClick:w,disabled:p,children:[t.jsx(P1,{size:18}),t.jsx("span",{children:p?"Dconnexion...":"Se dconnecter"})]})]})]})]})]})},j5=()=>{const e=new Date().getFullYear(),{currentUser:r}=Xe(),a=[{label:"Accueil",path:"/"},{label:"Disciplines",path:"/disciplines"},{label:"Quiz Avancs",path:"/quizzes"},{label:"Tarifs",path:"/premium"},{label:"Tableau de bord",path:(()=>{if(!r)return"/connexion";switch(r.role){case"eleve":return"/eleve/dashboard";case"prof":return"/prof/dashboard";case"parent":return"/parent/dashboard";case"admin":return"/admin";default:return"/connexion"}})()}],l=[{label:"Cours en ligne",path:"/cours",badge:"Nouveau",icon:t.jsx(k3,{size:14})},{label:"Exercices corrigs",path:"/disciplines"},{label:"Annales examens",path:"/disciplines"},{label:"Fiches de rvision",path:"/disciplines"}],o=[{name:"Facebook",url:"https://facebook.com/pedaclic",icon:t.jsx(O3,{size:20})},{name:"Twitter",url:"https://twitter.com/pedaclic",icon:t.jsx(D3,{size:20})},{name:"Instagram",url:"https://instagram.com/pedaclic",icon:t.jsx(P3,{size:20})},{name:"LinkedIn",url:"https://linkedin.com/company/pedaclic",icon:t.jsx(M3,{size:20})},{name:"YouTube",url:"https://youtube.com/@pedaclic",icon:t.jsx(T3,{size:20})}];return t.jsxs("footer",{className:"footer",children:[t.jsx("div",{className:"footer__main",children:t.jsxs("div",{className:"footer__container",children:[t.jsxs("div",{className:"footer__column footer__column--about",children:[t.jsxs($e,{to:"/",className:"footer__logo",children:[t.jsx(Bs,{className:"footer__logo-icon",size:36}),t.jsxs("div",{className:"footer__logo-text",children:[t.jsx("span",{className:"footer__logo-name",children:"PedaClic"}),t.jsx("span",{className:"footer__logo-tagline",children:"L'cole en un clic"})]})]}),t.jsx("p",{className:"footer__description",children:"PedaClic est la plateforme ducative de rfrence au Sngal. Nous accompagnons les lves du collge au lyce avec des cours, exercices et quiz de qualit."}),t.jsxs("div",{className:"footer__stats",children:[t.jsxs("div",{className:"footer__stat",children:[t.jsx(xn,{size:18}),t.jsx("span",{children:"500+ cours"})]}),t.jsxs("div",{className:"footer__stat",children:[t.jsx(mm,{size:18}),t.jsx("span",{children:"10 000+ lves"})]})]})]}),t.jsxs("div",{className:"footer__column",children:[t.jsxs("h3",{className:"footer__title",children:[t.jsx("span",{className:"footer__title-icon",children:""}),"Plateforme"]}),t.jsx("nav",{className:"footer__nav",children:t.jsx("ul",{className:"footer__list",children:a.map((u,d)=>t.jsx("li",{className:"footer__item",children:t.jsx($e,{to:u.path,className:"footer__link",children:u.label})},d))})})]}),t.jsxs("div",{className:"footer__column",children:[t.jsxs("h3",{className:"footer__title",children:[t.jsx("span",{className:"footer__title-icon",children:""}),"Ressources"]}),t.jsx("nav",{className:"footer__nav",children:t.jsx("ul",{className:"footer__list",children:l.map((u,d)=>t.jsx("li",{className:"footer__item",children:t.jsxs($e,{to:u.path,className:`footer__link${u.badge?" footer__link--new":""}`,children:[u.icon&&t.jsx("span",{className:"footer__link-icon",children:u.icon}),u.label,u.badge&&t.jsx("span",{className:"footer__badge",children:u.badge})]})},d))})})]}),t.jsxs("div",{className:"footer__column",children:[t.jsxs("h3",{className:"footer__title",children:[t.jsx("span",{className:"footer__title-icon",children:""}),"Contact"]}),t.jsxs("div",{className:"footer__contact",children:[t.jsxs("a",{href:"mailto:contact@pedaclic.sn",className:"footer__contact-item",children:[t.jsx(w3,{size:16,className:"footer__contact-icon"}),t.jsx("span",{children:"contact@pedaclic.sn"})]}),t.jsxs("a",{href:"tel:+221770000000",className:"footer__contact-item",children:[t.jsx(C3,{size:16,className:"footer__contact-icon"}),t.jsx("span",{children:"+221 77 000 00 00"})]}),t.jsxs("div",{className:"footer__contact-item",children:[t.jsx(E3,{size:16,className:"footer__contact-icon"}),t.jsx("span",{children:"Dakar, Sngal"})]})]}),t.jsxs("div",{className:"footer__social",children:[t.jsx("h4",{className:"footer__social-title",children:"Suivez-nous"}),t.jsx("div",{className:"footer__social-links",children:o.map((u,d)=>t.jsx("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",className:"footer__social-link",title:u.name,children:u.icon},d))})]})]})]})}),t.jsx("div",{className:"footer__bottom",children:t.jsxs("div",{className:"footer__container footer__bottom-content",children:[t.jsxs("p",{className:"footer__copyright",children:[" ",e," PedaClic. Tous droits rservs."]}),t.jsxs("p",{className:"footer__made-with",children:["Fait avec ",t.jsx(A3,{size:14,className:"footer__heart"})," au Sngal "]}),t.jsxs("nav",{className:"footer__legal",children:[t.jsxs($e,{to:"/mentions-legales",className:"footer__legal-link",children:[t.jsx(z3,{size:14})," Mentions lgales"]}),t.jsxs($e,{to:"/confidentialite",className:"footer__legal-link",children:[t.jsx(Qb,{size:14})," Confidentialit"]}),t.jsxs($e,{to:"/aide",className:"footer__legal-link",children:[t.jsx(fm,{size:14})," Aide"]})]})]})})]})},ct=({children:e,hideHeader:r=!1,hideFooter:n=!1,className:a=""})=>t.jsxs("div",{className:"layout",children:[!r&&t.jsx(y5,{}),t.jsx("main",{className:`layout__main ${r?"":"layout__main--with-header"} ${a}`,children:e}),!n&&t.jsx(j5,{})]}),_5=()=>{const{currentUser:e}=Xe();return t.jsxs("div",{className:"home-page",children:[t.jsxs("section",{className:"home-page__hero",children:[t.jsxs("div",{className:"home-page__hero-content",children:[t.jsxs("div",{className:"home-page__hero-badge",children:[t.jsx(jr,{size:14}),t.jsx("span",{children:"Plateforme N1 au Sngal"})]}),t.jsxs("h1",{className:"home-page__hero-title",children:["Russis tes examens avec",t.jsx("span",{className:"home-page__hero-highlight",children:" PedaClic"})]}),t.jsx("p",{className:"home-page__hero-subtitle",children:"La plateforme ducative qui accompagne les lves sngalais du collge au lyce avec des cours, exercices et quiz de qualit."}),t.jsx("div",{className:"home-page__hero-cta",children:e?t.jsxs($e,{to:e.role==="eleve"?"/eleve/dashboard":e.role==="prof"?"/prof/dashboard":e.role==="parent"?"/parent/dashboard":"/admin",className:"home-page__btn home-page__btn--primary",children:["Accder  mon espace",t.jsx(Os,{size:20})]}):t.jsxs(t.Fragment,{children:[t.jsxs($e,{to:"/inscription",className:"home-page__btn home-page__btn--primary",children:["Commencer gratuitement",t.jsx(Os,{size:20})]}),t.jsxs($e,{to:"/disciplines",className:"home-page__btn home-page__btn--outline",children:[t.jsx(so,{size:18}),"Dcouvrir les cours"]})]})}),t.jsxs("div",{className:"home-page__hero-stats",children:[t.jsxs("div",{className:"home-page__hero-stat",children:[t.jsx("strong",{children:"10 000+"}),t.jsx("span",{children:"lves inscrits"})]}),t.jsxs("div",{className:"home-page__hero-stat",children:[t.jsx("strong",{children:"500+"}),t.jsx("span",{children:"Cours disponibles"})]}),t.jsxs("div",{className:"home-page__hero-stat",children:[t.jsx("strong",{children:"95%"}),t.jsx("span",{children:"Taux de russite"})]})]})]}),t.jsx("div",{className:"home-page__hero-image",children:t.jsxs("div",{className:"home-page__hero-illustration",children:[t.jsx(Bs,{size:120}),t.jsx("div",{className:"home-page__hero-floating home-page__hero-floating--1",children:""}),t.jsx("div",{className:"home-page__hero-floating home-page__hero-floating--2",children:""}),t.jsx("div",{className:"home-page__hero-floating home-page__hero-floating--3",children:""})]})})]}),t.jsx("section",{className:"home-page__levels",children:t.jsxs("div",{className:"home-page__container",children:[t.jsx("h2",{className:"home-page__section-title",children:"Tous les niveaux, toutes les matires"}),t.jsx("p",{className:"home-page__section-subtitle",children:"Du collge au lyce, prpare tes examens avec confiance"}),t.jsxs("div",{className:"home-page__levels-grid",children:[t.jsxs($e,{to:"/disciplines?niveau=college",className:"home-page__level-card",children:[t.jsx("div",{className:"home-page__level-icon home-page__level-icon--college",children:""}),t.jsx("h3",{children:"Collge"}),t.jsx("p",{children:"6me  3me"}),t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx(Ht,{size:16})," Prparation au BFEM"]}),t.jsxs("li",{children:[t.jsx(Ht,{size:16})," 9 matires disponibles"]}),t.jsxs("li",{children:[t.jsx(Ht,{size:16})," Exercices corrigs"]})]}),t.jsxs("span",{className:"home-page__level-link",children:["Voir les cours ",t.jsx(Os,{size:16})]})]}),t.jsxs($e,{to:"/disciplines?niveau=lycee",className:"home-page__level-card",children:[t.jsx("div",{className:"home-page__level-icon home-page__level-icon--lycee",children:""}),t.jsx("h3",{children:"Lyce"}),t.jsx("p",{children:"2nde  Terminale"}),t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx(Ht,{size:16})," Prparation au BAC"]}),t.jsxs("li",{children:[t.jsx(Ht,{size:16})," 12 matires disponibles"]}),t.jsxs("li",{children:[t.jsx(Ht,{size:16})," Annales d'examens"]})]}),t.jsxs("span",{className:"home-page__level-link",children:["Voir les cours ",t.jsx(Os,{size:16})]})]})]})]})}),t.jsx("section",{className:"home-page__features",children:t.jsxs("div",{className:"home-page__container",children:[t.jsx("h2",{className:"home-page__section-title",children:"Pourquoi choisir PedaClic ?"}),t.jsx("p",{className:"home-page__section-subtitle",children:"Des outils modernes pour une ducation de qualit"}),t.jsxs("div",{className:"home-page__features-grid",children:[t.jsxs("div",{className:"home-page__feature-card",children:[t.jsx("div",{className:"home-page__feature-icon",children:t.jsx(xn,{size:28})}),t.jsx("h3",{children:"Cours complets"}),t.jsx("p",{children:"Des cours structurs et conformes au programme sngalais, rdigs par des enseignants expriments."})]}),t.jsxs("div",{className:"home-page__feature-card",children:[t.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--secondary",children:t.jsx(AA,{size:28})}),t.jsx("h3",{children:"Quiz interactifs"}),t.jsx("p",{children:"Testez vos connaissances avec des quiz adapts  chaque niveau et obtenez un feedback instantan."})]}),t.jsxs("div",{className:"home-page__feature-card",children:[t.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--warning",children:t.jsx(zA,{size:28})}),t.jsx("h3",{children:"Suivi de progression"}),t.jsx("p",{children:"Visualisez vos progrs et identifiez vos points faibles pour cibler vos rvisions."})]}),t.jsxs("div",{className:"home-page__feature-card",children:[t.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--success",children:t.jsx(Qb,{size:28})}),t.jsx("h3",{children:"Contenu vrifi"}),t.jsx("p",{children:"Tous nos contenus sont valids par des professeurs certifis pour garantir leur qualit."})]}),t.jsxs("div",{className:"home-page__feature-card",children:[t.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--info",children:t.jsx(po,{size:28})}),t.jsx("h3",{children:"Accessible 24/7"}),t.jsx("p",{children:"tudiez  votre rythme, o que vous soyez, sur ordinateur, tablette ou smartphone."})]}),t.jsxs("div",{className:"home-page__feature-card",children:[t.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--premium",children:t.jsx(ns,{size:28})}),t.jsx("h3",{children:"Certificats"}),t.jsx("p",{children:"Obtenez des certificats de russite pour valoriser vos comptences acquises."})]})]})]})}),t.jsx("section",{className:"home-page__premium",children:t.jsx("div",{className:"home-page__container",children:t.jsxs("div",{className:"home-page__premium-content",children:[t.jsxs("div",{className:"home-page__premium-text",children:[t.jsx("span",{className:"home-page__premium-badge",children:" Premium"}),t.jsx("h2",{children:"Passez  la vitesse suprieure"}),t.jsxs("p",{children:["Accdez  tous les quiz, exercices corrigs et ressources exclusives pour seulement ",t.jsx("strong",{children:"2 000 FCFA/mois"}),"."]}),t.jsxs("ul",{className:"home-page__premium-features",children:[t.jsxs("li",{children:[t.jsx(Ht,{size:18})," Quiz illimits dans toutes les matires"]}),t.jsxs("li",{children:[t.jsx(Ht,{size:18})," Corrections dtailles des exercices"]}),t.jsxs("li",{children:[t.jsx(Ht,{size:18})," Annales des examens (BFEM, BAC)"]}),t.jsxs("li",{children:[t.jsx(Ht,{size:18})," Support prioritaire"]})]}),t.jsxs($e,{to:"/premium",className:"home-page__btn home-page__btn--premium",children:["Dcouvrir Premium",t.jsx(Os,{size:20})]})]}),t.jsx("div",{className:"home-page__premium-pricing",children:t.jsxs("div",{className:"home-page__pricing-card",children:[t.jsx("span",{className:"home-page__pricing-popular",children:"Plus populaire"}),t.jsx("h3",{children:"Accs illimit 6 mois"}),t.jsxs("div",{className:"home-page__pricing-price",children:[t.jsx("span",{className:"home-page__pricing-amount",children:"20 000"}),t.jsx("span",{className:"home-page__pricing-currency",children:"FCFA"}),t.jsx("span",{className:"home-page__pricing-period",children:"/6 mois"})]}),t.jsx("p",{className:"home-page__pricing-save",children:"conomisez 10 000 FCFA vs 23 mois"}),t.jsx($e,{to:"/premium",className:"home-page__btn home-page__btn--primary home-page__btn--block",children:"Choisir ce plan"})]})})]})})}),t.jsx("section",{className:"home-page__testimonials",children:t.jsxs("div",{className:"home-page__container",children:[t.jsx("h2",{className:"home-page__section-title",children:"Ce qu'en disent nos lves"}),t.jsxs("div",{className:"home-page__testimonials-grid",children:[t.jsxs("div",{className:"home-page__testimonial-card",children:[t.jsx("div",{className:"home-page__testimonial-stars",children:[1,2,3,4,5].map(r=>t.jsx(jr,{size:16,fill:"#f59e0b",color:"#f59e0b"},r))}),t.jsx("p",{className:"home-page__testimonial-text",children:`"Grce  PedaClic, j'ai obtenu mon BFEM avec mention. Les quiz m'ont vraiment aid  me prparer !"`}),t.jsxs("div",{className:"home-page__testimonial-author",children:[t.jsx("div",{className:"home-page__testimonial-avatar",children:"FA"}),t.jsxs("div",{children:[t.jsx("strong",{children:"Fatou Adara"}),t.jsx("span",{children:"lve en 3me - Dakar"})]})]})]}),t.jsxs("div",{className:"home-page__testimonial-card",children:[t.jsx("div",{className:"home-page__testimonial-stars",children:[1,2,3,4,5].map(r=>t.jsx(jr,{size:16,fill:"#f59e0b",color:"#f59e0b"},r))}),t.jsx("p",{className:"home-page__testimonial-text",children:`"Les cours de maths sont trs bien expliqus. J'ai enfin compris les quations du second degr !"`}),t.jsxs("div",{className:"home-page__testimonial-author",children:[t.jsx("div",{className:"home-page__testimonial-avatar",children:"MD"}),t.jsxs("div",{children:[t.jsx("strong",{children:"Moussa Diallo"}),t.jsx("span",{children:"lve en Terminale S - This"})]})]})]}),t.jsxs("div",{className:"home-page__testimonial-card",children:[t.jsx("div",{className:"home-page__testimonial-stars",children:[1,2,3,4,5].map(r=>t.jsx(jr,{size:16,fill:"#f59e0b",color:"#f59e0b"},r))}),t.jsx("p",{className:"home-page__testimonial-text",children:`"Je recommande PedaClic  tous les parents. Ma fille a beaucoup progress depuis qu'elle l'utilise."`}),t.jsxs("div",{className:"home-page__testimonial-author",children:[t.jsx("div",{className:"home-page__testimonial-avatar",children:"AN"}),t.jsxs("div",{children:[t.jsx("strong",{children:"Aminata Ndiaye"}),t.jsx("span",{children:"Parent d'lve - Saint-Louis"})]})]})]})]})]})}),t.jsx("section",{className:"home-page__final-cta",children:t.jsxs("div",{className:"home-page__container",children:[t.jsx("h2",{children:"Prt  russir ?"}),t.jsx("p",{children:"Rejoignez les milliers d'lves qui font confiance  PedaClic"}),!e&&t.jsxs($e,{to:"/inscription",className:"home-page__btn home-page__btn--large",children:["Crer mon compte gratuit",t.jsx(Os,{size:24})]})]})})]})},MA=[{value:"6eme",label:"6me"},{value:"5eme",label:"5me"},{value:"4eme",label:"4me"},{value:"3eme",label:"3me"}],TA=[{value:"2nde",label:"2nde"},{value:"1ere",label:"1re"},{value:"Terminale",label:"Terminale"}],qA=[{value:"debutant",label:"Dbutant"},{value:"intermediaire",label:"Intermdiaire"},{value:"avance",label:"Avanc"}],RA={college:"Collge",lycee:"Lyce",formation_libre:"Formation libre"};function U1(e){switch(e){case"college":return MA;case"lycee":return TA;case"formation_libre":return qA;default:return[]}}function IA(e){return[...MA,...TA,...qA].find(n=>n.value===e)?.label||e}const F1=[{niveau:"college",icon:"",label:"Collge",color:"#2b6cb0",bgLight:"#ebf8ff"},{niveau:"lycee",icon:"",label:"Lyce",color:"#975a16",bgLight:"#fefcbf"},{niveau:"formation_libre",icon:"",label:"Formation libre",color:"#276749",bgLight:"#f0fff4"}],N5=()=>{const[e,r]=g.useState("college"),[n,a]=g.useState([]),[l,o]=g.useState(!0),u=tt();g.useEffect(()=>{const p=ze(_e(V,"disciplines"),Qe("ordre")),h=kf(p,v=>{const b=v.docs.map(x=>({id:x.id,...x.data(),createdAt:x.data().createdAt?.toDate()||new Date,updatedAt:x.data().updatedAt?.toDate()||new Date}));a(b),o(!1)});return()=>h()},[]);const d=n.filter(p=>p.niveau===e),m=F1.find(p=>p.niveau===e);return t.jsxs("div",{style:{maxWidth:"1100px",margin:"0 auto",padding:"24px"},children:[t.jsxs("div",{style:{marginBottom:"32px",textAlign:"center"},children:[t.jsx("h1",{style:{fontSize:"1.8rem",fontWeight:700,color:"#1a365d",marginBottom:"8px"},children:" Disciplines"}),t.jsx("p",{style:{color:"#718096",fontSize:"1rem"},children:"Explorez les disciplines disponibles sur PedaClic"})]}),t.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"12px",marginBottom:"32px",flexWrap:"wrap"},children:F1.map(p=>{const h=e===p.niveau;return t.jsxs("button",{onClick:()=>r(p.niveau),style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 28px",borderRadius:"12px",border:`2px solid ${h?p.color:"#e2e8f0"}`,background:h?p.bgLight:"#fff",color:h?p.color:"#718096",fontSize:"1rem",fontWeight:h?700:500,cursor:"pointer",transition:"all 0.25s ease",boxShadow:h?`0 2px 8px ${p.color}20`:"none"},children:[t.jsx("span",{style:{fontSize:"1.2rem"},children:p.icon}),p.label]},p.niveau)})}),l&&t.jsx("div",{style:{textAlign:"center",padding:"48px",color:"#a0aec0"},children:"Chargement des disciplines..."}),!l&&d.length===0&&t.jsxs("div",{style:{textAlign:"center",padding:"48px",background:"#f7fafc",borderRadius:"12px",border:"1px dashed #e2e8f0"},children:[t.jsx("p",{style:{fontSize:"2rem",marginBottom:"8px"},children:""}),t.jsxs("p",{style:{color:"#a0aec0",fontSize:"1rem"},children:["Aucune discipline disponible en ",RA[e]," pour le moment."]})]}),!l&&d.length>0&&t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:d.map(p=>t.jsxs("div",{onClick:()=>u(`/disciplines/${p.id}`),style:{background:"#fff",borderRadius:"12px",padding:"24px",border:"1px solid #e2e8f0",boxShadow:"0 2px 6px rgba(0,0,0,0.05)",cursor:"pointer",transition:"all 0.2s ease",borderTop:`3px solid ${p.couleur||m.color}`},onMouseEnter:h=>{h.currentTarget.style.transform="translateY(-2px)",h.currentTarget.style.boxShadow="0 6px 16px rgba(0,0,0,0.1)"},onMouseLeave:h=>{h.currentTarget.style.transform="translateY(0)",h.currentTarget.style.boxShadow="0 2px 6px rgba(0,0,0,0.05)"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"12px"},children:[t.jsx("span",{style:{fontSize:"1.8rem"},children:p.icone||""}),t.jsx("h3",{style:{fontSize:"1.1rem",fontWeight:600,color:"#2d3748",margin:0},children:p.nom})]}),p.description&&t.jsx("p",{style:{fontSize:"0.875rem",color:"#718096",marginBottom:"12px",lineHeight:1.5},children:p.description.length>100?`${p.description.slice(0,100)}...`:p.description}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginBottom:"8px"},children:t.jsx("span",{style:{display:"inline-block",padding:"2px 10px",borderRadius:"10px",fontSize:"0.75rem",fontWeight:500,background:m.bgLight,color:m.color},children:IA(p.classe)})}),p.coefficient!==void 0&&t.jsxs("p",{style:{fontSize:"0.8rem",color:"#a0aec0"},children:["Coefficient : ",p.coefficient]})]},p.id))})]})},wc="disciplines",G1=e=>{const r=e.data();return{id:e.id,nom:r.nom,niveau:r.niveau,classe:r.classe,ordre:r.ordre,coefficient:r.coefficient,couleur:r.couleur,icone:r.icone,description:r.description,createdAt:r.createdAt?.toDate()||new Date,updatedAt:r.updatedAt?.toDate()}},ls={async getAll(e){try{const r=[Qe("ordre","asc")];e?.niveau&&r.unshift(Se("niveau","==",e.niveau)),e?.classe&&r.unshift(Se("classe","==",e.classe));const n=ze(_e(V,wc),...r);return(await Ae(n)).docs.map(G1)}catch(r){throw console.error("Erreur lors de la rcupration des disciplines:",r),new Error("Impossible de rcuprer les disciplines")}},async getById(e){try{const r=je(V,wc,e),n=await pt(r);return n.exists()?G1(n):null}catch(r){throw console.error("Erreur lors de la rcupration de la discipline:",r),new Error("Impossible de rcuprer la discipline")}},async getByNiveau(e){return this.getAll({niveau:e})},async getByClasse(e){return this.getAll({classe:e})},async create(e){try{return(await Ot(_e(V,wc),{...e,createdAt:kt(),updatedAt:kt()})).id}catch(r){throw console.error("Erreur lors de la cration de la discipline:",r),new Error("Impossible de crer la discipline")}},async update(e,r){try{const n=je(V,wc,e);await Ve(n,{...r,updatedAt:kt()})}catch(n){throw console.error("Erreur lors de la mise  jour de la discipline:",n),new Error("Impossible de mettre  jour la discipline")}},async delete(e){try{const r=je(V,wc,e);await Ir(r)}catch(r){throw console.error("Erreur lors de la suppression de la discipline:",r),new Error("Impossible de supprimer la discipline")}},async exists(e){return await this.getById(e)!==null},async countByNiveau(e){return(await this.getByNiveau(e)).length}},S5="modulepreload",w5=function(e){return"/"+e},H1={},V1=function(r,n,a){let l=Promise.resolve();if(n&&n.length>0){let m=function(p){return Promise.all(p.map(h=>Promise.resolve(h).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=u?.nonce||u?.getAttribute("nonce");l=m(n.map(p=>{if(p=w5(p),p in H1)return;H1[p]=!0;const h=p.endsWith(".css"),v=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${v}`))return;const b=document.createElement("link");if(b.rel=h?"stylesheet":S5,h||(b.as="script"),b.crossOrigin="",b.href=p,d&&b.setAttribute("nonce",d),document.head.appendChild(b),h)return new Promise((x,j)=>{b.addEventListener("load",x),b.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return l.then(u=>{for(const d of u||[])d.status==="rejected"&&o(d.reason);return r().catch(o)})},zs="ressources",C5="ressources",Q1=e=>{const r=e.data();return{id:e.id,disciplineId:r.disciplineId,titre:r.titre,type:r.type,contenu:r.contenu,description:r.description,isPremium:r.isPremium||!1,ordre:r.ordre||0,chapitre:r.chapitre,fichierURL:r.fichierURL,fichierNom:r.fichierNom,dureeEstimee:r.dureeEstimee,duree:r.duree,tags:r.tags||[],actif:r.actif!==!1,urlExterne:r.urlExterne,chapitreId:r.chapitreId,auteurId:r.auteurId,createdAt:r.createdAt?.toDate()||new Date,updatedAt:r.updatedAt?.toDate()}},E5=e=>{const r=Date.now(),n=e.split(".").pop();return`${e.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9]/g,"_")}_${r}.${n}`},ha={async getAll(e,r){try{const n=[Qe("ordre","asc")];e?.disciplineId&&n.unshift(Se("disciplineId","==",e.disciplineId)),e?.chapitreId&&n.unshift(Se("chapitre","==",e.chapitreId)),e?.type&&n.unshift(Se("type","==",e.type)),e?.isPremium!==void 0&&n.unshift(Se("isPremium","==",e.isPremium)),e?.auteurId&&n.unshift(Se("auteurId","==",e.auteurId)),r&&n.push($t(r));const a=ze(_e(V,zs),...n);return(await Ae(a)).docs.map(Q1)}catch(n){throw console.error("Erreur lors de la rcupration des ressources:",n),new Error("Impossible de rcuprer les ressources")}},async getById(e){try{const r=je(V,zs,e),n=await pt(r);return n.exists()?Q1(n):null}catch(r){throw console.error("Erreur lors de la rcupration de la ressource:",r),new Error("Impossible de rcuprer la ressource")}},async getByDiscipline(e){return this.getAll({disciplineId:e})},async getByChapitre(e){return this.getAll({chapitreId:e})},async getByType(e){return this.getAll({type:e})},async getPremium(){return this.getAll({isPremium:!0})},async getFree(){return this.getAll({isPremium:!1})},async create(e,r){try{const n={...e,auteurId:r,createdAt:kt(),updatedAt:kt()};return Object.keys(n).forEach(l=>{n[l]===void 0&&delete n[l]}),(await Ot(_e(V,zs),n)).id}catch(n){throw console.error("Erreur lors de la cration de la ressource:",n),new Error("Impossible de crer la ressource")}},async update(e,r){try{const n={...r,updatedAt:kt()};Object.keys(n).forEach(l=>{n[l]===void 0&&delete n[l]});const a=je(V,zs,e);await Ve(a,n)}catch(n){throw console.error("Erreur lors de la mise  jour de la ressource:",n),new Error("Impossible de mettre  jour la ressource")}},async delete(e){try{const r=await this.getById(e);r?.fichierURL&&await this.deleteFile(r.fichierURL);const n=je(V,zs,e);await Ir(n)}catch(r){throw console.error("Erreur lors de la suppression de la ressource:",r),new Error("Impossible de supprimer la ressource")}},async deleteByDiscipline(e){try{const r=await this.getByDiscipline(e),n=Ln(V);for(const a of r){a.fichierURL&&await this.deleteFile(a.fichierURL);const l=je(V,zs,a.id);n.delete(l)}await n.commit()}catch(r){throw console.error("Erreur lors de la suppression des ressources:",r),new Error("Impossible de supprimer les ressources")}},async uploadFile(e,r){try{const n=E5(e.name),a=`${C5}/${r}/${n}`,l=cr(ar,a);return await $s(l,e),await In(l)}catch(n){throw console.error("Erreur lors de l'upload du fichier:",n),new Error("Impossible d'uploader le fichier")}},async deleteFile(e){try{const r=cr(ar,e);await Ls(r)}catch(r){console.warn("Fichier non trouv ou dj supprim:",r)}},async reorder(e,r){try{const n=Ln(V);r.forEach((a,l)=>{const o=je(V,zs,a);n.update(o,{ordre:l+1,updatedAt:kt()})}),await n.commit()}catch(n){throw console.error("Erreur lors de la rorganisation des ressources:",n),new Error("Impossible de rorganiser les ressources")}},async togglePremium(e,r){await this.update(e,{isPremium:r})},async toggleActive(e,r){await this.update(e,{actif:r})},async countByType(e){return(await this.getByType(e)).length},async getStats(){try{const e=await this.getAll(),r={total:e.length,premium:e.filter(n=>n.isPremium).length,gratuit:e.filter(n=>!n.isPremium).length,parType:{cours:0,exercice:0,video:0,document:0,quiz:0}};return e.forEach(n=>{r.parType[n.type]!==void 0&&r.parType[n.type]++}),r}catch(e){throw console.error("Erreur lors du calcul des statistiques:",e),new Error("Impossible de calculer les statistiques")}}},A5=()=>{const{id:e}=jn(),r=tt(),[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState([]),[m,p]=g.useState(!0),[h,v]=g.useState(null),[b,x]=g.useState("tous"),[j,_]=g.useState(new Set),w=g.useCallback(async()=>{if(e)try{p(!0),v(null);const $=await ls.getById(e);if(!$){v("Discipline introuvable."),p(!1);return}a($);const F=await ha.getAll({disciplineId:e}),Y=new Map,M=[];for(const ee of F){const X=ee.chapitre||ee.chapitreId;X?(Y.has(X)||Y.set(X,[]),Y.get(X).push(ee)):M.push(ee)}const K=Array.from(Y.entries()).map(([ee,X])=>({chapitreNom:ee,ressources:X.sort((L,I)=>L.ordre-I.ordre)})).sort((ee,X)=>ee.chapitreNom.localeCompare(X.chapitreNom,"fr"));o(K),d(M),K.length>0&&_(new Set([K[0].chapitreNom]))}catch($){console.error("Erreur chargement discipline:",$),v("Impossible de charger les donnes. Ressayez plus tard.")}finally{p(!1)}},[e]);g.useEffect(()=>{w()},[w]);const C=$=>{_(F=>{const Y=new Set(F);return Y.has($)?Y.delete($):Y.add($),Y})},E=$=>b==="tous"?$:$.filter(F=>F.type===b),S=$=>{switch($){case"cours":return"";case"exercice":return"";case"video":return"";case"document":return"";case"quiz":return"";default:return""}},A=$=>{switch($){case"cours":return"Cours";case"exercice":return"Exercice";case"video":return"Vido";case"document":return"Document";case"quiz":return"Quiz";default:return $}},z=$=>{switch($){case"cours":return"#3b82f6";case"exercice":return"#10b981";case"video":return"#f59e0b";case"document":return"#8b5cf6";case"quiz":return"#ef4444";default:return"#6b7280"}},k=$=>$==="college"?"Collge":"Lyce";if(m)return t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem 1rem",minHeight:"50vh"},children:[t.jsx("div",{style:{width:"48px",height:"48px",border:"4px solid #e5e7eb",borderTopColor:"#2563eb",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),t.jsx("p",{style:{marginTop:"1rem",color:"#6b7280"},children:"Chargement de la discipline..."}),t.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"})]});if(h||!n)return t.jsxs("div",{style:{maxWidth:"600px",margin:"3rem auto",padding:"2rem",textAlign:"center",background:"#fef2f2",borderRadius:"12px",border:"1px solid #fecaca"},children:[t.jsx("span",{style:{fontSize:"3rem"},children:""}),t.jsx("h2",{style:{color:"#991b1b",margin:"1rem 0 0.5rem"},children:h||"Discipline introuvable"}),t.jsx("p",{style:{color:"#b91c1c",marginBottom:"1.5rem"},children:"Vrifiez le lien ou retournez  la liste des disciplines."}),t.jsx("button",{onClick:()=>r("/disciplines"),style:{padding:"0.75rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:600},children:" Retour aux disciplines"})]});const P=[...l.flatMap($=>$.ressources),...u],D=[...new Set(P.map($=>$.type))];return t.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto",padding:"1.5rem 1rem"},children:[t.jsxs("nav",{style:{marginBottom:"1.5rem",fontSize:"0.875rem",color:"#6b7280"},children:[t.jsx($e,{to:"/",style:{color:"#2563eb",textDecoration:"none"},children:"Accueil"}),t.jsx("span",{style:{margin:"0 0.5rem"},children:"/"}),t.jsx($e,{to:"/disciplines",style:{color:"#2563eb",textDecoration:"none"},children:"Disciplines"}),t.jsx("span",{style:{margin:"0 0.5rem"},children:"/"}),t.jsx("span",{style:{color:"#374151"},children:n.nom})]}),t.jsxs("header",{style:{background:"linear-gradient(135deg, #1e40af 0%, #3b82f6 100%)",borderRadius:"16px",padding:"2rem",color:"#fff",marginBottom:"2rem"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.75rem"},children:[t.jsx("span",{style:{fontSize:"2.5rem"},children:n.icone||""}),t.jsxs("div",{children:[t.jsx("h1",{style:{fontSize:"1.75rem",fontWeight:700,margin:0},children:n.nom}),n.description&&t.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.9,fontSize:"0.95rem"},children:n.description})]})]}),t.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap",marginTop:"1rem"},children:[t.jsxs("span",{style:{background:"rgba(255,255,255,0.2)",padding:"0.35rem 0.75rem",borderRadius:"20px",fontSize:"0.8rem",fontWeight:600},children:[" ",k(n.niveau),"  ",n.classe]}),t.jsxs("span",{style:{background:"rgba(255,255,255,0.2)",padding:"0.35rem 0.75rem",borderRadius:"20px",fontSize:"0.8rem",fontWeight:600},children:[" ",P.length," ressource",P.length!==1?"s":""]}),n.coefficient&&t.jsxs("span",{style:{background:"rgba(255,255,255,0.2)",padding:"0.35rem 0.75rem",borderRadius:"20px",fontSize:"0.8rem",fontWeight:600},children:[" Coeff. ",n.coefficient]})]})]}),D.length>1&&t.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginBottom:"1.5rem"},children:[t.jsxs("button",{onClick:()=>x("tous"),style:{padding:"0.5rem 1rem",borderRadius:"20px",border:b==="tous"?"2px solid #2563eb":"1px solid #d1d5db",background:b==="tous"?"#2563eb":"#fff",color:b==="tous"?"#fff":"#374151",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:["Tous (",P.length,")"]}),D.map($=>{const F=P.filter(M=>M.type===$).length,Y=b===$;return t.jsxs("button",{onClick:()=>x($),style:{padding:"0.5rem 1rem",borderRadius:"20px",border:Y?`2px solid ${z($)}`:"1px solid #d1d5db",background:Y?z($):"#fff",color:Y?"#fff":"#374151",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:[S($)," ",A($)," (",F,")"]},$)})]}),l.length===0&&u.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"3rem 1rem",background:"#f9fafb",borderRadius:"12px",border:"1px solid #e5e7eb"},children:[t.jsx("span",{style:{fontSize:"3rem"},children:""}),t.jsx("h3",{style:{color:"#374151",margin:"1rem 0 0.5rem"},children:"Aucune ressource disponible"}),t.jsx("p",{style:{color:"#6b7280"},children:"Les cours et exercices pour cette discipline seront bientt ajouts."})]}):t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[l.map($=>{const F=E($.ressources);if(F.length===0&&b!=="tous")return null;const Y=j.has($.chapitreNom),M=b==="tous"?$.ressources:F;return t.jsxs("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e5e7eb",overflow:"hidden",transition:"box-shadow 0.2s",boxShadow:Y?"0 4px 12px rgba(0,0,0,0.08)":"none"},children:[t.jsx("button",{onClick:()=>C($.chapitreNom),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1rem 1.25rem",background:Y?"#f0f5ff":"#fff",border:"none",cursor:"pointer",textAlign:"left",transition:"background 0.2s"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[t.jsx("span",{style:{fontSize:"1.25rem",transform:Y?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s"},children:""}),t.jsxs("div",{children:[t.jsx("span",{style:{fontWeight:700,color:"#1f2937",fontSize:"1rem"},children:$.chapitreNom}),t.jsxs("span",{style:{display:"block",fontSize:"0.75rem",color:"#6b7280",marginTop:"2px"},children:[$.ressources.length," ressource",$.ressources.length!==1?"s":""]})]})]})}),Y&&t.jsx("div",{style:{padding:"0 1.25rem 1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:M.map(K=>t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #f3f4f6",transition:"background 0.15s",cursor:"pointer"},onMouseEnter:ee=>ee.currentTarget.style.background="#eef2ff",onMouseLeave:ee=>ee.currentTarget.style.background="#f9fafb",children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flex:1},children:[t.jsx("span",{style:{fontSize:"1.2rem"},children:S(K.type)}),t.jsxs("div",{children:[t.jsx("span",{style:{fontWeight:600,color:"#1f2937",fontSize:"0.9rem"},children:K.titre}),K.description&&t.jsx("span",{style:{display:"block",fontSize:"0.75rem",color:"#9ca3af",marginTop:"2px"},children:K.description})]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexShrink:0},children:[t.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#fff",background:z(K.type)},children:A(K.type)}),K.isPremium&&t.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#92400e",background:"#fef3c7",border:"1px solid #fde68a"},children:" Premium"}),K.dureeEstimee&&t.jsxs("span",{style:{fontSize:"0.75rem",color:"#6b7280"},children:[" ",K.dureeEstimee," min"]})]})]},K.id))})]},$.chapitreNom)}),E(u).length>0&&t.jsxs("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e5e7eb",padding:"1rem 1.25rem"},children:[t.jsx("h3",{style:{fontSize:"1rem",fontWeight:700,color:"#374151",marginBottom:"0.75rem"},children:" Autres ressources"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:E(u).map($=>t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #f3f4f6"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[t.jsx("span",{style:{fontSize:"1.2rem"},children:S($.type)}),t.jsx("span",{style:{fontWeight:600,color:"#1f2937",fontSize:"0.9rem"},children:$.titre})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#fff",background:z($.type)},children:A($.type)}),$.isPremium&&t.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#92400e",background:"#fef3c7",border:"1px solid #fde68a"},children:" Premium"})]})]},$.id))})]})]}),t.jsx("div",{style:{marginTop:"2rem",textAlign:"center"},children:t.jsx($e,{to:"/disciplines",style:{display:"inline-block",padding:"0.75rem 1.5rem",background:"#f3f4f6",color:"#374151",borderRadius:"8px",textDecoration:"none",fontWeight:600,transition:"background 0.2s"},children:" Retour aux disciplines"})})]})},z5=()=>{const{login:e,loginWithGoogle:r}=Xe(),n=tt(),a=Hb(),l=new URLSearchParams(a.search).get("redirect"),o=a.state?.from||l||"/",[u,d]=g.useState({email:"",password:""}),[m,p]=g.useState(!1),[h,v]=g.useState(!1),[b,x]=g.useState(""),[j,_]=g.useState(!1),w=A=>{const{name:z,value:k}=A.target;d(P=>({...P,[z]:k})),b&&x("")},C=()=>u.email.trim()?u.password?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email)?!0:(x("Veuillez entrer une adresse email valide."),!1):(x("Veuillez entrer votre mot de passe."),!1):(x("Veuillez entrer votre adresse email."),!1),E=async A=>{if(A.preventDefault(),!!C()){p(!0),x("");try{await e(u.email,u.password),n(o,{replace:!0})}catch(z){z instanceof Error?x(z.message):x("Une erreur est survenue lors de la connexion.")}finally{p(!1)}}},S=async()=>{v(!0),x("");try{await r(),n(o,{replace:!0})}catch(A){A instanceof Error&&x(A.message)}finally{v(!1)}};return t.jsx("div",{className:"auth-page",children:t.jsxs("div",{className:"auth-container",children:[t.jsxs("div",{className:"auth-card",children:[t.jsxs("div",{className:"auth-header",children:[t.jsxs($e,{to:"/",className:"auth-logo",children:[t.jsx("div",{className:"auth-logo__icon",children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})})}),t.jsx("span",{children:"PedaClic"})]}),t.jsx("h1",{className:"auth-title",children:"Connexion"}),t.jsx("p",{className:"auth-subtitle",children:"Accdez  votre espace d'apprentissage"})]}),b&&t.jsxs("div",{className:"auth-error",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("path",{d:"M12 8v4M12 16h.01"})]}),t.jsx("span",{children:b})]}),t.jsxs("form",{onSubmit:E,className:"auth-form",children:[t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"email",className:"auth-label",children:"Adresse email"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("input",{type:"email",id:"email",name:"email",value:u.email,onChange:w,placeholder:"exemple@email.com",className:"auth-input",autoComplete:"email",disabled:m})]})]}),t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"password",className:"auth-label",children:"Mot de passe"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:[t.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",strokeWidth:"2"}),t.jsx("path",{strokeWidth:"2",d:"M7 11V7a5 5 0 0110 0v4"})]}),t.jsx("input",{type:j?"text":"password",id:"password",name:"password",value:u.password,onChange:w,placeholder:"Votre mot de passe",className:"auth-input",autoComplete:"current-password",disabled:m}),t.jsx("button",{type:"button",className:"auth-password-toggle",onClick:()=>_(!j),"aria-label":j?"Masquer le mot de passe":"Afficher le mot de passe",children:j?t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),t.jsx("div",{className:"auth-forgot",children:t.jsx($e,{to:"/mot-de-passe-oublie",className:"auth-forgot-link",children:"Mot de passe oubli ?"})}),t.jsx("button",{type:"submit",className:"auth-button",disabled:m,children:m?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"auth-button-spinner"}),"Connexion en cours..."]}):"Se connecter"})]}),t.jsx("div",{className:"auth-divider",children:t.jsx("span",{children:"ou"})}),t.jsx("button",{type:"button",className:"auth-google-btn",onClick:S,disabled:m||h,children:h?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"auth-button-spinner auth-button-spinner--dark"}),"Connexion en cours"]}):t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"auth-google-icon",viewBox:"0 0 24 24","aria-hidden":"true",children:[t.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),t.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),t.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z"}),t.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continuer avec Google"]})}),t.jsxs("p",{className:"auth-switch",children:["Pas encore de compte ?"," ",t.jsx($e,{to:"/inscription",className:"auth-switch-link",children:"Crer un compte"})]})]}),t.jsxs("div",{className:"auth-welcome",children:[t.jsx("h2",{children:"Bienvenue sur PedaClic !"}),t.jsx("p",{children:"L'cole en un clic - Accdez  des milliers de cours, exercices et quiz."}),t.jsxs("ul",{className:"auth-features",children:[t.jsxs("li",{children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Cours du programme sngalais"]}),t.jsxs("li",{children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Exercices interactifs"]}),t.jsxs("li",{children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Quiz pour tester vos connaissances"]}),t.jsxs("li",{children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Suivi de progression"]})]})]})]})})},k5=()=>{const{register:e,loginWithGoogle:r}=Xe(),n=tt(),[a,l]=g.useState({email:"",password:"",confirmPassword:"",displayName:"",role:"eleve"}),[o,u]=g.useState(!1),[d,m]=g.useState(""),[p,h]=g.useState(!1),[v,b]=g.useState(!1),[x,j]=g.useState(!1),[_,w]=g.useState(!1),C=z=>{const{name:k,value:P}=z.target;l(D=>({...D,[k]:P})),d&&m("")},E=()=>a.displayName.trim()?a.displayName.trim().length<2?(m("Le nom doit contenir au moins 2 caractres."),!1):a.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)?a.password?a.password.length<6?(m("Le mot de passe doit contenir au moins 6 caractres."),!1):a.password!==a.confirmPassword?(m("Les mots de passe ne correspondent pas."),!1):x?!0:(m("Veuillez accepter les conditions d'utilisation."),!1):(m("Veuillez entrer un mot de passe."),!1):(m("Veuillez entrer une adresse email valide."),!1):(m("Veuillez entrer votre adresse email."),!1):(m("Veuillez entrer votre nom complet."),!1),S=async z=>{if(z.preventDefault(),!!E()){u(!0),m("");try{await e(a),n("/disciplines",{replace:!0})}catch(k){k instanceof Error?m(k.message):m("Une erreur est survenue lors de l'inscription.")}finally{u(!1)}}},A=async()=>{if(!x){m("Veuillez accepter les conditions d'utilisation.");return}w(!0),m("");try{await r(a.role),n("/disciplines",{replace:!0})}catch(z){z instanceof Error&&m(z.message)}finally{w(!1)}};return t.jsx("div",{className:"auth-page",children:t.jsxs("div",{className:"auth-container",children:[t.jsxs("div",{className:"auth-card auth-card--register",children:[t.jsxs("div",{className:"auth-header",children:[t.jsxs($e,{to:"/",className:"auth-logo",children:[t.jsx("div",{className:"auth-logo__icon",children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})})}),t.jsx("span",{children:"PedaClic"})]}),t.jsx("h1",{className:"auth-title",children:"Crer un compte"}),t.jsx("p",{className:"auth-subtitle",children:"Rejoignez PedaClic et commencez  apprendre"})]}),d&&t.jsxs("div",{className:"auth-error",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("path",{d:"M12 8v4M12 16h.01"})]}),t.jsx("span",{children:d})]}),t.jsxs("form",{onSubmit:S,className:"auth-form",children:[t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"displayName",className:"auth-label",children:"Nom complet"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),t.jsx("input",{type:"text",id:"displayName",name:"displayName",value:a.displayName,onChange:C,placeholder:"Amadou Diallo",className:"auth-input",autoComplete:"name",disabled:o})]})]}),t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"email",className:"auth-label",children:"Adresse email"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("input",{type:"email",id:"email",name:"email",value:a.email,onChange:C,placeholder:"exemple@email.com",className:"auth-input",autoComplete:"email",disabled:o})]})]}),t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{className:"auth-label",children:"Je suis :"}),t.jsxs("div",{className:"auth-role-selector",children:[t.jsxs("label",{className:`auth-role-option ${a.role==="eleve"?"auth-role-option--selected":""}`,children:[t.jsx("input",{type:"radio",name:"role",value:"eleve",checked:a.role==="eleve",onChange:C,className:"auth-role-input",disabled:o}),t.jsxs("div",{className:"auth-role-content",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 14l9-5-9-5-9 5 9 5z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"})]}),t.jsx("span",{children:"lve"})]})]}),t.jsxs("label",{className:`auth-role-option ${a.role==="prof"?"auth-role-option--selected":""}`,children:[t.jsx("input",{type:"radio",name:"role",value:"prof",checked:a.role==="prof",onChange:C,className:"auth-role-input",disabled:o}),t.jsxs("div",{className:"auth-role-content",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),t.jsx("span",{children:"Professeur"})]})]}),t.jsxs("label",{className:`auth-role-option ${a.role==="parent"?"auth-role-option--selected":""}`,children:[t.jsx("input",{type:"radio",name:"role",value:"parent",checked:a.role==="parent",onChange:C,className:"auth-role-input",disabled:o}),t.jsxs("div",{className:"auth-role-content",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})}),t.jsx("span",{children:"Parent d'lve"})]})]})]})]}),t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"password",className:"auth-label",children:"Mot de passe"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:[t.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",strokeWidth:"2"}),t.jsx("path",{strokeWidth:"2",d:"M7 11V7a5 5 0 0110 0v4"})]}),t.jsx("input",{type:p?"text":"password",id:"password",name:"password",value:a.password,onChange:C,placeholder:"Minimum 6 caractres",className:"auth-input",autoComplete:"new-password",disabled:o}),t.jsx("button",{type:"button",className:"auth-password-toggle",onClick:()=>h(!p),"aria-label":p?"Masquer":"Afficher",children:p?t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),t.jsx("p",{className:"auth-hint",children:"Au moins 6 caractres avec des lettres et des chiffres"})]}),t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"confirmPassword",className:"auth-label",children:"Confirmer le mot de passe"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),t.jsx("input",{type:v?"text":"password",id:"confirmPassword",name:"confirmPassword",value:a.confirmPassword,onChange:C,placeholder:"Retapez votre mot de passe",className:"auth-input",autoComplete:"new-password",disabled:o}),t.jsx("button",{type:"button",className:"auth-password-toggle",onClick:()=>b(!v),"aria-label":v?"Masquer":"Afficher",children:v?t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),t.jsx("div",{className:"auth-checkbox-field",children:t.jsxs("label",{className:"auth-checkbox-label",children:[t.jsx("input",{type:"checkbox",checked:x,onChange:z=>j(z.target.checked),className:"auth-checkbox",disabled:o}),t.jsx("span",{className:"auth-checkbox-custom"}),t.jsxs("span",{children:["J'accepte les"," ",t.jsx($e,{to:"/cgu",target:"_blank",className:"auth-link",children:"conditions d'utilisation"})," ","et la"," ",t.jsx($e,{to:"/confidentialite",target:"_blank",className:"auth-link",children:"politique de confidentialit"})]})]})}),t.jsx("button",{type:"submit",className:"auth-button",disabled:o,children:o?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"auth-button-spinner"}),"Cration du compte..."]}):"Crer mon compte"})]}),t.jsx("div",{className:"auth-divider",children:t.jsx("span",{children:"ou"})}),t.jsx("button",{type:"button",className:"auth-google-btn",onClick:A,disabled:o||_,children:_?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"auth-button-spinner auth-button-spinner--dark"}),"Cration du compte"]}):t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"auth-google-icon",viewBox:"0 0 24 24","aria-hidden":"true",children:[t.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),t.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),t.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z"}),t.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"S'inscrire avec Google"]})}),t.jsx("p",{className:"auth-google-hint",children:"Le rle slectionn ci-dessus sera utilis pour votre compte Google."}),t.jsxs("p",{className:"auth-switch",children:["Dj un compte ?"," ",t.jsx($e,{to:"/connexion",className:"auth-switch-link",children:"Se connecter"})]})]}),t.jsxs("div",{className:"auth-welcome auth-welcome--register",children:[t.jsx("h2",{children:"Rejoignez la communaut PedaClic"}),t.jsx("p",{children:"Des milliers d'lves et professeurs sngalais nous font dj confiance."}),t.jsxs("div",{className:"auth-stats",children:[t.jsxs("div",{className:"auth-stat",children:[t.jsx("span",{className:"auth-stat-number",children:"10 000+"}),t.jsx("span",{className:"auth-stat-label",children:"lves inscrits"})]}),t.jsxs("div",{className:"auth-stat",children:[t.jsx("span",{className:"auth-stat-number",children:"500+"}),t.jsx("span",{className:"auth-stat-label",children:"Cours disponibles"})]}),t.jsxs("div",{className:"auth-stat",children:[t.jsx("span",{className:"auth-stat-number",children:"95%"}),t.jsx("span",{className:"auth-stat-label",children:"Taux de satisfaction"})]})]}),t.jsxs("div",{className:"auth-testimonial",children:[t.jsx("p",{className:"auth-testimonial-text",children:`"Grce  PedaClic, j'ai amlior mes notes en mathmatiques de 4 points !"`}),t.jsx("p",{className:"auth-testimonial-author",children:" Fatou N., lve de 3me  Dakar"})]})]})]})})},O5=()=>{const e=async b=>{const{sendPasswordResetEmail:x}=await V1(async()=>{const{sendPasswordResetEmail:_}=await import("./vendor-firebase-LntcAirY.js").then(w=>w.K);return{sendPasswordResetEmail:_}},[]),{auth:j}=await V1(async()=>{const{auth:_}=await Promise.resolve().then(()=>i5);return{auth:_}},void 0);await x(j,b)},[r,n]=g.useState(""),[a,l]=g.useState(!1),[o,u]=g.useState(""),[d,m]=g.useState(!1),p=()=>r.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)?!0:(u("Veuillez entrer une adresse email valide."),!1):(u("Veuillez entrer votre adresse email."),!1),h=async b=>{if(b.preventDefault(),!!p()){l(!0),u("");try{await e(r),m(!0)}catch(x){x instanceof Error?u(x.message):u("Une erreur est survenue. Veuillez ressayer.")}finally{l(!1)}}},v=()=>{m(!1),n(""),u("")};return t.jsx("div",{className:"auth-page",children:t.jsx("div",{className:"auth-container auth-container--centered",children:t.jsxs("div",{className:"auth-card auth-card--narrow",children:[t.jsx("div",{className:"auth-header",children:t.jsxs($e,{to:"/",className:"auth-logo",children:[t.jsx("div",{className:"auth-logo__icon",children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})})}),t.jsx("span",{children:"PedaClic"})]})}),d?t.jsxs("div",{className:"auth-success-content",children:[t.jsx("div",{className:"auth-success-icon",children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("h1",{className:"auth-title",children:"Email envoy !"}),t.jsxs("p",{className:"auth-subtitle",children:["Nous avons envoy un lien de rinitialisation  ",t.jsx("strong",{children:r})]}),t.jsxs("div",{className:"auth-instructions",children:[t.jsx("p",{children:"Vrifiez votre bote de rception et cliquez sur le lien pour rinitialiser votre mot de passe."}),t.jsxs("p",{className:"auth-instructions-note",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"Si vous ne voyez pas l'email, vrifiez votre dossier spam."]})]}),t.jsxs("div",{className:"auth-success-actions",children:[t.jsx($e,{to:"/connexion",className:"auth-button",children:"Retour  la connexion"}),t.jsx("button",{type:"button",className:"auth-button auth-button--outline",onClick:v,children:"Renvoyer l'email"})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"auth-icon",children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),t.jsx("h1",{className:"auth-title",children:"Mot de passe oubli ?"}),t.jsx("p",{className:"auth-subtitle",children:"Pas de panique ! Entrez votre email et nous vous enverrons un lien pour rinitialiser votre mot de passe."}),o&&t.jsxs("div",{className:"auth-error",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("path",{d:"M12 8v4M12 16h.01"})]}),t.jsx("span",{children:o})]}),t.jsxs("form",{onSubmit:h,className:"auth-form",children:[t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"email",className:"auth-label",children:"Adresse email"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("input",{type:"email",id:"email",value:r,onChange:b=>{n(b.target.value),o&&u("")},placeholder:"exemple@email.com",className:"auth-input",autoComplete:"email",disabled:a,autoFocus:!0})]})]}),t.jsx("button",{type:"submit",className:"auth-button",disabled:a,children:a?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"auth-button-spinner"}),"Envoi en cours..."]}):"Envoyer le lien"})]}),t.jsx("div",{className:"auth-back",children:t.jsxs($e,{to:"/connexion",className:"auth-back-link",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Retour  la connexion"]})})]})]})})})},LA="https://api.pedaclic.sn",Va={a_la_carte_1:{label:"1 cours",montant:1e3,duree:"1 mois",description:"Choisissez 1 cours par discipline et niveau"},a_la_carte_3:{label:"3 cours",montant:2e3,duree:"1 mois",description:"Choisissez 3 cours par discipline et niveau"},a_la_carte_7:{label:"7 cours",montant:5e3,duree:"1 mois",description:"Choisissez 7 cours par discipline et niveau"},a_la_carte_tous:{label:"Tous les contenus",montant:25e3,duree:"9 mois",description:"Accs  l'intgralit du catalogue pendant 9 mois"},illimite_3m:{label:"3 mois",montant:1e4,duree:"3 mois",description:"Accs illimit aux cours, quiz et ressources pendant 3 mois"},illimite_6m:{label:"6 mois",montant:2e4,duree:"6 mois",description:"Accs illimit pendant 6 mois  conomisez 10 000 FCFA !"},illimite_1an:{label:"1 an",montant:3e4,duree:"1 an",description:"Accs illimit toute l'anne  conomisez 30 000 FCFA !"}};async function D5(e){const r=await fetch(`${LA}/api/moneroo/initiate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok){const a=await r.json().catch(()=>({}));throw new Error(a.error||`Erreur serveur (${r.status})`)}const n=await r.json();if(!n.success||!n.checkoutUrl)throw new Error("Rponse invalide du serveur de paiement");return n}async function P5(e){const r=await fetch(`${LA}/api/moneroo/verify/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`Erreur vrification paiement (${r.status})`);return r.json()}function M5(e){window.location.href=e}function T5(){const e=new URLSearchParams(window.location.search);return{paymentId:e.get("paymentId"),paymentStatus:e.get("paymentStatus"),status:e.get("status")}}const q5={"6eme":1,"6me":1,"5eme":2,"5me":2,"4eme":3,"4me":3,"3eme":4,"3me":4,"2nde":5,seconde:5,"1ere":6,"1re":6,terminale:7};function Y1(e){const r=e.toLowerCase().trim();return q5[r]??99}function _n(){const[e,r]=g.useState([]),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null);return g.useEffect(()=>{let m=!1;async function p(){o(!0),d(null);try{const h=ze(_e(V,"disciplines"),Qe("ordre")),v=await Ae(h);if(m)return;const b=new Set,x=new Set;v.forEach(w=>{const C=w.data();C.nom&&typeof C.nom=="string"&&b.add(C.nom.trim()),C.classe&&typeof C.classe=="string"&&x.add(C.classe.trim())});const j=Array.from(b).sort((w,C)=>w.localeCompare(C,"fr")).map(w=>({valeur:w,label:w})),_=Array.from(x).sort((w,C)=>{const E=Y1(w),S=Y1(C);return E!==S?E-S:w.localeCompare(C,"fr")}).map(w=>({valeur:w,label:w}));r(j),a(_)}catch(h){m||(console.error("[useDisciplinesOptions] Erreur Firestore :",h),d("Impossible de charger les matires/niveaux."))}finally{m||o(!1)}}return p(),()=>{m=!0}},[]),{matieres:e,niveaux:n,loading:l,error:u}}const yr=["6me","5me","4me","3me","2nde","1re","Terminale"],ci=yr.map(e=>({valeur:e,label:e}));function uo(e){return e?{"6eme":"6me","5eme":"5me","4eme":"4me","3eme":"3me","1ere":"1re"}[e]||e:""}ci.filter(e=>["6me","5me","4me","3me"].includes(e.valeur));ci.filter(e=>["2nde","1re","Terminale"].includes(e.valeur));const K1=["2023-2024","2024-2025","2025-2026","2026-2027"],R5=["#2563eb","#7c3aed","#059669","#d97706","#dc2626","#0891b2","#db2777","#65a30d"],Zi={cours:{label:"Cours",emoji:"",color:"#3b82f6"},exercices:{label:"Exercices",emoji:"",color:"#8b5cf6"},correction:{label:"Correction",emoji:"",color:"#10b981"},devoir_surveille:{label:"Devoir surveill",emoji:"",color:"#f59e0b"},devoir_maison:{label:"Devoir  la maison",emoji:"",color:"#6366f1"},travaux_pratiques:{label:"Travaux pratiques",emoji:"",color:"#14b8a6"},evaluation:{label:"valuation",emoji:"",color:"#ef4444"},revision:{label:"Rvision",emoji:"",color:"#f97316"}},Uc={realise:{label:"Ralis",color:"#059669",bg:"#d1fae5"},planifie:{label:"Planifi",color:"#d97706",bg:"#fef3c7"},annule:{label:"Annul",color:"#dc2626",bg:"#fee2e2"},reporte:{label:"Report",color:"#2563eb",bg:"#dbeafe"}},$A={interro:"Interrogation",ds:"Devoir Surveill",examen:"Examen",oral:"Oral",autre:"Autre"},BA={devoir:{label:"Devoir  corriger",emoji:""},evaluation:{label:"valuation  prparer",emoji:""},notes:{label:"Notes  saisir",emoji:""},cours:{label:"Cours  prparer",emoji:""},personnalise:{label:"Rappel personnalis",emoji:""}},I5=["Communiquer  l'crit","Communiquer  l'oral","Raisonner et rsoudre des problmes","Chercher et s'informer","Modliser","Reprsenter","Calculer et algorithmiser","Analyser et interprter","Exprimenter et observer","Cooprer et mutualiser"],L5=[{id:"illimite_3m",nom:"3 mois",description:"Accs illimit  tous les cours",prix:1e4,duree:"3 mois",nombreCoursMax:null,accesIllimite:!0},{id:"illimite_6m",nom:"6 mois",description:"Accs illimit  tous les cours",prix:2e4,duree:"6 mois",economie:"10 000 FCFA vs 23 mois",popular:!0,nombreCoursMax:null,accesIllimite:!0},{id:"illimite_1an",nom:"1 an",description:"Accs illimit  tous les cours",prix:3e4,duree:"12 mois",economie:"30 000 FCFA vs 43 mois",nombreCoursMax:null,accesIllimite:!0}],UA=[{id:"a_la_carte_1",nom:"1 cours",description:"Choisissez 1 cours par discipline et niveau",prix:1e3,duree:"1 mois",nombreCoursMax:1,accesIllimite:!1},{id:"a_la_carte_3",nom:"3 cours",description:"Choisissez 3 cours par discipline et niveau",prix:2e3,duree:"1 mois",nombreCoursMax:3,accesIllimite:!1},{id:"a_la_carte_7",nom:"7 cours",description:"Choisissez 7 cours par discipline et niveau",prix:5e3,duree:"1 mois",nombreCoursMax:7,accesIllimite:!1},{id:"a_la_carte_tous",nom:"Tous les contenus",description:"Accs  l'intgralit du catalogue",prix:25e3,duree:"9 mois",nombreCoursMax:null,accesIllimite:!0}],FA=[...UA,...L5];function So(e){return!e||typeof e!="string"?!1:e.startsWith("a_la_carte_")}function GA(e){return e?FA.find(n=>n.id===e)?.nombreCoursMax??null:null}function $5(e){const r=FA.find(n=>n.id===e);return r?r.accesIllimite:["mensuel","annuel","illimite_3m","illimite_6m","illimite_1an"].includes(e)}const B5=["illimite_1an","a_la_carte_tous"];function U5(e){return e?B5.includes(e):!1}const W1=30;function F5(e){return e&&U5(e)?null:W1}const HA=({matieres:e,value:r,onChange:n,formule:a,hint:l,compact:o=!1})=>{const u=a?GA(a):null,d=ci;return t.jsxs("div",{className:`matieres-niveaux-selector ${o?"matieres-niveaux-selector--compact":""}`,children:[t.jsxs("div",{className:"matieres-niveaux-selector__row",children:[t.jsxs("div",{className:"matieres-niveaux-selector__field",children:[t.jsx("label",{htmlFor:"mn-matiere",className:"matieres-niveaux-selector__label",children:"Matire"}),t.jsxs("select",{id:"mn-matiere",value:r.matiere,onChange:m=>n({...r,matiere:m.target.value}),className:"matieres-niveaux-selector__select","aria-label":"Filtrer par matire",children:[t.jsx("option",{value:"",children:"Toutes les matires"}),e.map(m=>t.jsx("option",{value:m.valeur,children:m.label},m.valeur))]})]}),t.jsxs("div",{className:"matieres-niveaux-selector__field",children:[t.jsx("label",{htmlFor:"mn-niveau",className:"matieres-niveaux-selector__label",children:"Niveau"}),t.jsxs("select",{id:"mn-niveau",value:r.niveau,onChange:m=>n({...r,niveau:m.target.value}),className:"matieres-niveaux-selector__select","aria-label":"Filtrer par niveau",children:[t.jsx("option",{value:"",children:"Tous les niveaux"}),d.map(m=>t.jsx("option",{value:m.valeur,children:m.label},m.valeur))]})]})]}),(l||u!=null)&&t.jsxs("p",{className:"matieres-niveaux-selector__hint",children:[l,u!=null&&t.jsxs("span",{children:[l?"  ":"","Slection possible : jusqu' ",t.jsxs("strong",{children:[u," cours"]}),"."]})]})]})},G5=[{icone:"",titre:"Cours complets",description:"Accs aux cours du programme sngalais 6me  Terminale"},{icone:"",titre:"Quiz illimits",description:"Tous les quiz par matire avec corrections dtailles et explications"},{icone:"",titre:"Suivi de progression",description:"Tableaux de bord analytiques pour suivre les performances en temps rel"},{icone:"",titre:"Bibliothque ebooks",description:"Accs aux manuels et ressources pdagogiques numriques"},{icone:"",titre:"Notifications",description:"Alertes personnalises pour devoirs, valuations et rappels scolaires"}],H5=[{icone:"",titre:"Cahier de textes",description:"Grez vos cahiers de textes numriques et partagez avec vos lves"},{icone:"",titre:"Gnrateur de contenus",description:"Gnration de cours, fiches et valuations par intelligence artificielle"},{icone:"",titre:"Cours en ligne",description:"Crez et publiez des cours pour vos lves"},{icone:"",titre:"Mdiathque",description:"Accdez  la mdiathque pdagogique et enrichissez vos squences"},{icone:"",titre:"Crateur de squences",description:"Construisez des squences pdagogiques compltes"},{icone:"",titre:"Suivi des groupes",description:"Suivez la progression de vos classes et lves"}],V5=[{nom:"Wave",couleur:"#1976D2",emoji:""},{nom:"Orange Money",couleur:"#FF6B00",emoji:""},{nom:"Free Money",couleur:"#E30613",emoji:""},{nom:"FLASH",couleur:"#6B21A8",emoji:""},{nom:"Carte Bancaire",couleur:"#059669",emoji:""}];function Q5(){const e=tt(),{currentUser:r}=Xe(),{matieres:n}=_n(),[a,l]=g.useState("a_la_carte"),[o,u]=g.useState("a_la_carte_3"),[d,m]=g.useState(!1),[p,h]=g.useState(null),[v,b]=g.useState({matiere:"",niveau:""}),x=r?.isPremium===!0,j=r?.role==="prof",_=j?H5:G5,w=So(o);async function C(){if(!r){e("/connexion?redirect=/premium");return}m(!0),h(null);try{const E=await D5({plan:o,userId:r.uid,userEmail:r.email||"",userFirstName:r.displayName?.split(" ")[0]||(j?"Professeur":"lve"),userLastName:r.displayName?.split(" ").slice(1).join(" ")||"PedaClic"});M5(E.checkoutUrl)}catch(E){h(E instanceof Error?E.message:"Une erreur est survenue. Veuillez ressayer."),m(!1)}}return t.jsxs("div",{className:"premium-page",children:[t.jsx("header",{className:"premium-hero",children:t.jsxs("div",{className:"premium-hero__content",children:[t.jsx("span",{className:"premium-hero__badge",children:" PREMIUM"}),t.jsx("h1",{className:"premium-hero__titre",children:j?"Premium Pro  Outils pdagogiques":"Dbloque tout PedaClic"}),t.jsx("p",{className:"premium-hero__sous-titre",children:j?"Cahier de textes, Gnrateur IA, Cours en ligne, Mdiathque Accdez  tous les outils Premium Pro.":"Accde  tous les cours, quiz et ressources du programme sngalais. Du 6me au BAC  L'cole en un clic !"})]})}),t.jsxs("div",{className:"premium-contenu",children:[x&&t.jsxs("section",{className:"premium-abonne",children:[t.jsx("div",{className:"premium-abonne__icone",children:""}),t.jsx("h2",{children:"Tu es dj abonn Premium !"}),t.jsx("p",{children:"Ton abonnement est actif. Profite de tous les contenus exclusifs."}),t.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>{const E=r?.role==="eleve"?"/eleve/dashboard":r?.role==="prof"?"/prof/dashboard":r?.role==="parent"?"/parent/dashboard":"/";e(E)},children:"Aller au tableau de bord"})]}),!x&&t.jsxs("section",{className:"premium-plans",children:[t.jsx("h2",{className:"premium-section__titre",children:"Choisir un abonnement"}),t.jsxs("div",{className:"premium-pricing__tabs",style:{marginBottom:"1.5rem"},children:[t.jsx("button",{type:"button",className:`premium-pricing__tab ${a==="a_la_carte"?"premium-pricing__tab--active":""}`,onClick:()=>{l("a_la_carte"),u("a_la_carte_3")},children:" Cours  la carte"}),t.jsx("button",{type:"button",className:`premium-pricing__tab ${a==="illimite"?"premium-pricing__tab--active":""}`,onClick:()=>{l("illimite"),u("illimite_6m")},children:" Accs illimit"})]}),t.jsx("div",{className:"premium-plans__grille",style:{gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))"},children:a==="a_la_carte"?t.jsx(t.Fragment,{children:["a_la_carte_1","a_la_carte_3","a_la_carte_7","a_la_carte_tous"].map(E=>t.jsxs("div",{className:`premium-plan-card ${o===E?"premium-plan-card--actif":""} ${E==="a_la_carte_3"?"premium-plan-card--populaire":""}`,onClick:()=>u(E),role:"button",tabIndex:0,onKeyDown:S=>S.key==="Enter"&&u(E),children:[E==="a_la_carte_3"&&t.jsx("div",{className:"premium-plan-card__badge-populaire",children:"Populaire"}),t.jsx("div",{className:"premium-plan-card__select",children:t.jsx("span",{className:o===E?"premium-plan-card__radio--actif":"premium-plan-card__radio"})}),t.jsxs("div",{className:"premium-plan-card__header",children:[t.jsx("span",{className:"premium-plan-card__icone",children:""}),t.jsx("h3",{className:"premium-plan-card__nom",children:Va[E].label})]}),t.jsxs("div",{className:"premium-plan-card__prix",children:[t.jsx("span",{className:"premium-plan-card__montant",children:Va[E].montant.toLocaleString("fr-FR")}),t.jsxs("span",{className:"premium-plan-card__devise",children:["FCFA / ",Va[E].duree]})]}),t.jsx("p",{className:"premium-plan-card__description",children:Va[E].description})]},E))}):t.jsx(t.Fragment,{children:["illimite_3m","illimite_6m","illimite_1an"].map(E=>t.jsxs("div",{className:`premium-plan-card ${o===E?"premium-plan-card--actif":""} ${E==="illimite_6m"?"premium-plan-card--populaire":""}`,onClick:()=>u(E),role:"button",tabIndex:0,onKeyDown:S=>S.key==="Enter"&&u(E),children:[E==="illimite_6m"&&t.jsx("div",{className:"premium-plan-card__badge-populaire",children:" Meilleure offre"}),t.jsx("div",{className:"premium-plan-card__select",children:t.jsx("span",{className:o===E?"premium-plan-card__radio--actif":"premium-plan-card__radio"})}),t.jsxs("div",{className:"premium-plan-card__header",children:[t.jsx("span",{className:"premium-plan-card__icone",children:""}),t.jsx("h3",{className:"premium-plan-card__nom",children:Va[E].label})]}),t.jsxs("div",{className:"premium-plan-card__prix",children:[t.jsx("span",{className:"premium-plan-card__montant",children:Va[E].montant.toLocaleString("fr-FR")}),t.jsxs("span",{className:"premium-plan-card__devise",children:["FCFA / ",Va[E].duree]})]}),E==="illimite_6m"&&t.jsx("div",{className:"premium-plan-card__economie",children:" conomisez 10 000 FCFA vs 23 mois"}),E==="illimite_1an"&&t.jsx("div",{className:"premium-plan-card__economie",children:" conomisez 30 000 FCFA vs 43 mois"}),t.jsx("p",{className:"premium-plan-card__description",children:Va[E].description})]},E))})}),w&&t.jsxs("div",{className:"premium-plans__selector",style:{marginTop:"1.5rem",padding:"1rem",background:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0"},children:[t.jsx("h3",{style:{fontSize:"1rem",fontWeight:600,marginBottom:"0.75rem",color:"#475569"},children:"Aperu  Choisir matire et niveau"}),t.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",marginBottom:"1rem"},children:"Aprs votre souscription, vous pourrez slectionner vos cours par matire et niveau. La slection du niveau affichera uniquement les contenus correspondants."}),t.jsx(HA,{matieres:n,niveaux:ci,value:v,onChange:b,formule:o,hint:"Filtrez pour prvisualiser les contenus disponibles."})]}),p&&t.jsxs("div",{className:"premium-erreur",role:"alert",children:[" ",p]}),t.jsxs("div",{className:"premium-paiement",children:[t.jsx("button",{className:"premium-btn premium-btn--principal",onClick:C,disabled:d,"aria-busy":d,children:d?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"premium-spinner","aria-hidden":"true"})," Redirection en cours"]}):t.jsxs(t.Fragment,{children:[" S'abonner  ",Va[o]?.montant.toLocaleString("fr-FR")," FCFA"]})}),t.jsx("p",{className:"premium-paiement__securite",children:" Paiement 100% scuris via Moneroo"}),t.jsxs("div",{className:"premium-moyens-paiement",children:[t.jsx("p",{className:"premium-moyens-paiement__titre",children:"Moyens de paiement accepts :"}),t.jsx("div",{className:"premium-moyens-paiement__liste",children:V5.map(E=>t.jsxs("span",{className:"premium-moyen-badge",style:{borderColor:E.couleur,color:E.couleur},title:E.nom,children:[E.emoji," ",E.nom]},E.nom))})]})]})]}),t.jsxs("section",{className:"premium-avantages",children:[t.jsx("h2",{className:"premium-section__titre",children:j?"Ce qui est inclus  Premium Pro":"Ce qui est inclus"}),t.jsx("div",{className:"premium-avantages__grille",children:_.map(E=>t.jsxs("div",{className:"premium-avantage-card",children:[t.jsx("span",{className:"premium-avantage-card__icone",children:E.icone}),t.jsxs("div",{className:"premium-avantage-card__texte",children:[t.jsx("h3",{children:E.titre}),t.jsx("p",{children:E.description})]})]},E.titre))})]}),t.jsxs("section",{className:"premium-faq",children:[t.jsx("h2",{className:"premium-section__titre",children:"Questions frquentes"}),t.jsxs("div",{className:"premium-faq__liste",children:[t.jsxs("div",{className:"premium-faq__item",children:[t.jsx("h3",{children:"Comment payer avec Wave ou Orange Money ?"}),t.jsx("p",{children:`Clique sur "S'abonner", tu seras redirig vers la page de paiement Moneroo. Choisis ton moyen de paiement prfr et suis les instructions.`})]}),t.jsxs("div",{className:"premium-faq__item",children:[t.jsx("h3",{children:"Mon accs est activ quand ?"}),t.jsx("p",{children:"L'accs Premium est activ automatiquement ds la confirmation de ton paiement, en quelques secondes."})]}),t.jsxs("div",{className:"premium-faq__item",children:[t.jsx("h3",{children:"Puis-je annuler mon abonnement ?"}),t.jsx("p",{children:"Oui. Contacte-nous via WhatsApp ou email. L'accs reste actif jusqu' la fin de la priode paye."})]}),t.jsxs("div",{className:"premium-faq__item",children:[t.jsx("h3",{children:"L'abonnement est-il renouvel automatiquement ?"}),t.jsx("p",{children:"Non. Tu recevras une notification avant l'expiration pour renouveler si tu le souhaites."})]})]})]})]})]})}const Gn="cours_en_ligne",nl="cours_sections";function Y5(e){const r=[/(?:youtube\.com\/watch\?v=)([^&\n?#]+)/,/(?:youtu\.be\/)([^&\n?#]+)/,/(?:youtube\.com\/embed\/)([^&\n?#]+)/];for(const n of r){const a=e.match(n);if(a)return a[1]}return null}async function VA(e){let r=ze(_e(V,Gn),Se("statut","==","publie"),Qe("updatedAt","desc"),$t(50));return(await Ae(r)).docs.map(l=>({id:l.id,...l.data()}))}async function QA(e){const r=await pt(je(V,Gn,e));return r.exists()?{id:r.id,...r.data()}:null}async function K5(e){const r=ze(_e(V,Gn),Se("profId","==",e),Qe("updatedAt","desc"));return(await Ae(r)).docs.map(a=>({id:a.id,...a.data()}))}async function W5(){const e=ze(_e(V,Gn),Qe("updatedAt","desc"),$t(200));return(await Ae(e)).docs.map(n=>({id:n.id,...n.data()}))}async function X5(e,r,n){const a=Ee.now();return(await Ot(_e(V,Gn),{...n,profId:e,profNom:r,statut:n.statut??"brouillon",nombreInscrits:0,nombreSections:0,createdAt:a,updatedAt:a})).id}async function Z5(e,r){await Ve(je(V,Gn,e),{...r,updatedAt:Ee.now()})}async function Ix(e){await Ve(je(V,Gn,e),{statut:"publie",publieAt:Ee.now(),updatedAt:Ee.now()})}async function J5(e){await Ve(je(V,Gn,e),{statut:"archive",updatedAt:Ee.now()})}async function eR(e){const r=Ln(V);(await Ae(ze(_e(V,nl),Se("coursId","==",e)))).docs.forEach(a=>r.delete(a.ref)),r.delete(je(V,Gn,e)),await r.commit()}async function YA(e){const r=ze(_e(V,nl),Se("coursId","==",e),Qe("ordre","asc"));return(await Ae(r)).docs.map(a=>({id:a.id,...a.data()}))}async function tR(e,r){const n=Ln(V),a=Ee.now(),l=je(_e(V,nl));return n.set(l,{...r,coursId:e,blocs:r.blocs??[],createdAt:a,updatedAt:a}),n.update(je(V,Gn,e),{nombreSections:ss(1),updatedAt:a}),await n.commit(),l.id}async function X1(e,r){const n=Ee.now();let a={...r,updatedAt:n};r.blocs&&(a.dureeEstimee=KA(r.blocs)),await Ve(je(V,nl,e),a)}async function rR(e,r){const n=Ln(V),a=Ee.now();n.delete(je(V,nl,e)),n.update(je(V,Gn,r),{nombreSections:ss(-1),updatedAt:a}),await n.commit()}async function nR(e){const r=Ln(V),n=Ee.now();e.forEach(({id:a,ordre:l})=>{r.update(je(V,nl,a),{ordre:l,updatedAt:n})}),await r.commit()}async function aR(e,r){const n=r.map((a,l)=>({...a,ordre:l}));await Ve(je(V,nl,e),{blocs:n,dureeEstimee:KA(n),updatedAt:Ee.now()})}function KA(e){let r=0;return e.forEach(n=>{switch(n.type){case"texte":r+=Math.max(1,Math.ceil(n.contenu.split(" ").length/200));break;case"video":r+=5;break;case"quiz":r+=2;break;case"exercice":r+=n.difficulte==="difficile"?10:n.difficulte==="moyen"?5:3;break;case"image":case"encadre":r+=1;break}}),Math.max(1,r)}async function iR(e){await Ve(je(V,Gn,e),{nombreInscrits:ss(1)})}async function sR(e,r){await Ve(je(V,"users",e),{coursChoisis:r,updatedAt:kt()})}function lR(e,r,n,a){return r?$5(n||"illimite_6m")||!So(n||"illimite_6m")?!0:a.includes(e):!1}function oR(){const{currentUser:e}=Xe(),r=tt(),{matieres:n}=_n(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,m]=g.useState(!1),[p,h]=g.useState({matiere:"",niveau:""}),[v,b]=g.useState(e?.coursChoisis??[]),x=e?.subscriptionPlan,j=GA(x||"a_la_carte_1"),_=So(x||"a_la_carte_1"),w=UA.find(z=>z.id===x);g.useEffect(()=>{C()},[]);async function C(){u(!0);try{let z=await VA();e?.role==="eleve"&&(z=z.filter(k=>!k.reservedPro)),l(z)}catch{l([])}finally{u(!1)}}const E=a.filter(z=>!(p.matiere&&z.matiere!==p.matiere||p.niveau&&uo(z.niveau)!==uo(p.niveau)));function S(z){if(!j)return;v.indexOf(z)>=0?b(v.filter(P=>P!==z)):v.length<j&&b([...v,z])}async function A(){if(e){m(!0);try{await sR(e.uid,v);const z=e.role==="eleve"?"/eleve/dashboard":e.role==="prof"?"/prof/dashboard":e.role==="parent"?"/parent/dashboard":"/";r(z,{state:{message:"Vos cours ont t mis  jour."}})}catch{m(!1)}}}return e?.isPremium?!_||j===null?t.jsx("div",{className:"cours-catalogue",children:t.jsxs("div",{className:"cours-catalogue__hero",children:[t.jsx("h1",{children:"Accs illimit"}),t.jsx("p",{children:"Votre formule vous donne accs  tous les cours. Aucun choix  faire !"}),t.jsx($e,{to:"/cours",className:"btn btn--primary",children:"Voir le catalogue"})]})}):t.jsxs("div",{className:"cours-catalogue",children:[t.jsxs("section",{className:"cours-catalogue__hero",children:[t.jsx("h1",{className:"cours-catalogue__hero-titre",children:" Mes cours  la carte"}),t.jsxs("p",{className:"cours-catalogue__hero-sous-titre",children:["Choisissez jusqu' ",t.jsxs("strong",{children:[j," cours"]})," parmi le catalogue. Filtrez par discipline et niveau."]}),t.jsxs("div",{className:"premium-cours-choice__plan",children:[t.jsxs("span",{className:"badge badge--premium",children:[w?.nom,"  ",w?.prix.toLocaleString("fr-FR")," FCFA / ",w?.duree]}),t.jsxs("span",{className:"premium-cours-choice__count",children:[v.length," / ",j," cours slectionns"]})]})]}),t.jsx("section",{className:"cours-catalogue__filtres",children:t.jsx("div",{className:"cours-catalogue__filtres-inner",children:t.jsx(HA,{matieres:n,niveaux:ci,value:p,onChange:h,formule:x,hint:"La slection du niveau affiche uniquement les contenus correspondants."})})}),t.jsx("main",{className:"cours-catalogue__contenu",children:o?t.jsx("div",{className:"cours-catalogue__grille","aria-busy":"true",children:[1,2,3,4].map(z=>t.jsxs("div",{className:"cours-card cours-card--skeleton",children:[t.jsx("div",{className:"skeleton cours-card__cover"}),t.jsxs("div",{className:"cours-card__body",children:[t.jsx("div",{className:"skeleton",style:{height:16,width:"60%",marginBottom:8}}),t.jsx("div",{className:"skeleton",style:{height:20,marginBottom:8}})]})]},z))}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"premium-cours-choice__actions",children:[t.jsx("button",{className:"btn-primary",onClick:A,disabled:d,children:d?"Enregistrement...":" Enregistrer mes choix"}),t.jsx($e,{to:"/cours",className:"btn-secondary",children:"Voir le catalogue"})]}),t.jsx("div",{className:"cours-catalogue__grille",children:E.map(z=>{const k=v.includes(z.id),P=v.length<(j||0)||k,D=uo(z.niveau)||z.niveau;return t.jsxs("article",{className:`cours-card ${k?"cours-card--selected":""}`,onClick:()=>P&&S(z.id),role:"button",tabIndex:0,onKeyDown:$=>$.key==="Enter"&&P&&S(z.id),children:[t.jsxs("div",{className:"cours-card__cover",children:[z.couvertureUrl?t.jsx("img",{src:z.couvertureUrl,alt:z.titre,loading:"lazy"}):t.jsx("div",{className:"cours-card__cover-placeholder",children:t.jsx("span",{children:z.matiere.charAt(0)})}),t.jsx("span",{className:`cours-card__badge ${k?"cours-card__badge--premium":"cours-card__badge--gratuit"}`,children:k?" Slectionn":"Cliquer pour ajouter"})]}),t.jsxs("div",{className:"cours-card__body",children:[t.jsxs("div",{className:"cours-card__meta",children:[t.jsx("span",{className:"cours-card__matiere",children:z.matiere}),t.jsx("span",{className:"cours-card__niveau",children:D})]}),t.jsx("h3",{className:"cours-card__titre",children:z.titre}),t.jsx("p",{className:"cours-card__description",children:z.description})]})]},z.id)})}),E.length===0&&!o&&t.jsxs("div",{className:"cours-catalogue__vide",children:[t.jsx("span",{children:""}),t.jsx("h3",{children:"Aucun cours trouv"}),t.jsx("p",{children:"Modifiez vos filtres ou consultez le catalogue complet."})]})]})})]}):t.jsx("div",{className:"cours-catalogue",children:t.jsxs("div",{className:"cours-catalogue__hero",children:[t.jsx("h1",{children:"Choix des cours"}),t.jsx("p",{children:"Cette page est rserve aux abonns Premium."}),t.jsx($e,{to:"/premium",className:"btn btn--primary",children:"Dcouvrir Premium"})]})})}function cR(){const e=tt(),[r,n]=g.useState("chargement"),[a,l]=g.useState(null);return g.useEffect(()=>{async function o(){const{paymentId:u,paymentStatus:d}=T5();if(!u){e("/premium");return}if(d==="failed"||d==="cancelled"){n("echec"),l("Le paiement a t annul ou a chou. Aucun montant n'a t dbit.");return}try{const m=await P5(u);m.status==="success"?n("succes"):m.status==="pending"?n("attente"):(n("echec"),l("Le paiement n'a pas pu tre confirm. Contactez le support si le montant a t dbit."))}catch{n("attente")}}o()},[e]),r==="chargement"?t.jsx("div",{className:"premium-confirmation",children:t.jsxs("div",{className:"premium-confirmation__card",children:[t.jsx("div",{className:"premium-spinner premium-spinner--lg","aria-label":"Vrification en cours"}),t.jsx("h2",{children:"Vrification du paiement"}),t.jsx("p",{children:"Merci de patienter quelques secondes."})]})}):r==="succes"?t.jsx("div",{className:"premium-confirmation",children:t.jsxs("div",{className:"premium-confirmation__card premium-confirmation__card--succes",children:[t.jsx("div",{className:"premium-confirmation__icone premium-confirmation__icone--succes",children:""}),t.jsx("h1",{children:"Bienvenue dans Premium ! "}),t.jsxs("p",{className:"premium-confirmation__message",children:["Ton abonnement est activ. Tu as maintenant accs  ",t.jsx("strong",{children:"tous les cours, quiz et ressources"})," de PedaClic."]}),t.jsxs("div",{className:"premium-confirmation__actions",children:[t.jsx("button",{className:"premium-btn premium-btn--principal",onClick:()=>e("/dashboard"),children:" Accder au tableau de bord"}),t.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/cours"),children:" Voir les cours"})]})]})}):r==="attente"?t.jsx("div",{className:"premium-confirmation",children:t.jsxs("div",{className:"premium-confirmation__card premium-confirmation__card--attente",children:[t.jsx("div",{className:"premium-confirmation__icone premium-confirmation__icone--attente",children:""}),t.jsx("h1",{children:"Paiement en cours de traitement"}),t.jsx("p",{className:"premium-confirmation__message",children:"Ton paiement est en cours de vrification. Ton accs Premium sera activ automatiquement ds confirmation (gnralement moins de 5 minutes)."}),t.jsx("p",{className:"premium-confirmation__message",children:"Tu recevras une notification ds que c'est prt. Tu peux fermer cette page."}),t.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/dashboard"),children:"Aller au tableau de bord"})]})}):t.jsx("div",{className:"premium-confirmation",children:t.jsxs("div",{className:"premium-confirmation__card premium-confirmation__card--echec",children:[t.jsx("div",{className:"premium-confirmation__icone premium-confirmation__icone--echec",children:""}),t.jsx("h1",{children:"Paiement non abouti"}),t.jsx("p",{className:"premium-confirmation__message",children:a||"Une erreur est survenue lors du paiement."}),t.jsxs("div",{className:"premium-confirmation__actions",children:[t.jsx("button",{className:"premium-btn premium-btn--principal",onClick:()=>e("/premium"),children:" Ressayer"}),t.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/dashboard"),children:"Retour au tableau de bord"})]})]})})}const uR=[{title:"Principal",items:[{id:"dashboard",label:"Tableau de bord",icon:"",href:"/admin"},{id:"disciplines",label:"Disciplines",icon:"",href:"/admin/disciplines"},{id:"chapitres",label:"Chapitres",icon:"",href:"/admin/chapitres"},{id:"ressources",label:"Ressources",icon:"",href:"/admin/ressources"},{id:"cours",label:"Cours en ligne",icon:"",href:"/prof/cours"},{id:"ebooks",label:"Bibliothque Ebooks",icon:"",href:"/admin/ebooks"},{id:"mediatheque",label:"Mdiathque",icon:"",href:"/mediatheque"}]},{title:"valuation",items:[{id:"quiz",label:"Quiz",icon:"",href:"/admin/quiz"},{id:"quiz-avance",label:"Quiz Avancs",icon:"",href:"/admin/quiz-avance"},{id:"resultats",label:"Rsultats",icon:"",href:"/admin/resultats"}]},{title:"Utilisateurs",items:[{id:"utilisateurs",label:"Tous les utilisateurs",icon:"",href:"/admin/utilisateurs"},{id:"premium",label:"Abonns Premium",icon:"",href:"/admin/premium"}]},{title:"Outils IA",items:[{id:"generateur",label:"Gnrateur IA",icon:"",href:"/generateur"}]},{title:"Paramtres",items:[{id:"settings",label:"Configuration",icon:"",href:"/admin/settings"}]}],hn=({children:e,currentPage:r="dashboard"})=>{const{currentUser:n,logout:a}=Xe(),[l,o]=g.useState(!0),[u,d]=g.useState(!1),m=Hb(),p=async()=>{try{d(!0),await a(),window.location.href="/connexion"}catch(x){console.error("Erreur lors de la dconnexion:",x),d(!1)}},h=()=>n?.displayName?n.displayName.split(" ").map(x=>x[0]).join("").toUpperCase().slice(0,2):"AD",v=()=>{switch(n?.role){case"admin":return"Administrateur";case"prof":return"Professeur";case"eleve":return"lve";default:return"Utilisateur"}},b=x=>x.href==="/admin"?m.pathname==="/admin"||m.pathname==="/admin/":m.pathname.startsWith(x.href);return t.jsxs("div",{className:"admin-layout",children:[t.jsxs("aside",{className:`admin-sidebar ${l?"":"admin-sidebar--collapsed"}`,children:[t.jsx("header",{className:"admin-sidebar__header",children:t.jsxs($e,{to:"/",className:"admin-sidebar__logo",children:[t.jsx("div",{className:"admin-sidebar__logo-icon",children:""}),t.jsx("span",{children:"PedaClic"})]})}),t.jsx("nav",{className:"admin-sidebar__nav",children:uR.map((x,j)=>t.jsxs("div",{className:"admin-nav__section",children:[t.jsx("h3",{className:"admin-nav__title",children:x.title}),t.jsx("ul",{className:"admin-nav__list",children:x.items.map(_=>t.jsx("li",{className:"admin-nav__item",children:t.jsxs($e,{to:_.href,className:`admin-nav__link ${b(_)?"admin-nav__link--active":""}`,children:[t.jsx("span",{className:"admin-nav__icon",children:_.icon}),t.jsx("span",{className:"admin-nav__label",children:_.label})]})},_.id))})]},j))}),t.jsx("footer",{className:"admin-sidebar__footer",children:t.jsxs("div",{className:"admin-user",children:[t.jsx("div",{className:"admin-user__avatar",children:h()}),t.jsxs("div",{className:"admin-user__info",children:[t.jsx("div",{className:"admin-user__name",children:n?.displayName||"Administrateur"}),t.jsx("div",{className:"admin-user__role",children:v()})]}),t.jsx("button",{onClick:p,disabled:u,className:"admin-logout-btn",title:"Se dconnecter",children:u?"...":""})]})})]}),t.jsxs("main",{className:"admin-content",children:[t.jsx("button",{className:"admin-sidebar-toggle",onClick:()=>o(!l),"aria-label":"Toggle sidebar",children:""}),e]}),t.jsx("style",{children:`
        /* Bouton de dconnexion */
        .admin-logout-btn {
          width: 36px;
          height: 36px;
          border: none;
          background: rgba(255, 255, 255, 0.1);
          color: white;
          border-radius: var(--radius-md);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all var(--transition-base);
          font-size: var(--text-lg);
        }

        .admin-logout-btn:hover {
          background: rgba(255, 255, 255, 0.2);
        }

        .admin-logout-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        /* Bouton toggle sidebar (mobile) */
        .admin-sidebar-toggle {
          display: none;
          position: fixed;
          top: var(--spacing-md);
          left: var(--spacing-md);
          z-index: var(--z-fixed);
          width: 44px;
          height: 44px;
          border: none;
          background: var(--color-primary);
          color: white;
          border-radius: var(--radius-md);
          cursor: pointer;
          font-size: var(--text-xl);
        }

        @media (max-width: 768px) {
          .admin-sidebar-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
          }

          .admin-sidebar {
            transform: translateX(-100%);
            transition: transform var(--transition-base);
          }

          .admin-sidebar:not(.admin-sidebar--collapsed) {
            transform: translateX(0);
          }

          .admin-content {
            padding-top: calc(var(--spacing-xl) + 44px);
          }
        }

        /* Animation de la sidebar rduite */
        .admin-sidebar--collapsed {
          width: 80px;
        }

        .admin-sidebar--collapsed .admin-nav__label,
        .admin-sidebar--collapsed .admin-nav__title,
        .admin-sidebar--collapsed .admin-sidebar__logo span,
        .admin-sidebar--collapsed .admin-user__info {
          display: none;
        }

        .admin-sidebar--collapsed .admin-sidebar__logo {
          justify-content: center;
        }
      `})]})},Gi="chapitres",dR=e=>Object.fromEntries(Object.entries(e).filter(([,r])=>r!==void 0)),Kv=e=>{const r=e.data();return{id:e.id,disciplineId:r.disciplineId,numero:r.numero,titre:r.titre,description:r.description,objectifs:r.objectifs||[],dureeEstimee:r.dureeEstimee,isPremium:r.isPremium||!1,actif:r.actif!==!1,createdAt:r.createdAt?.toDate()||new Date,updatedAt:r.updatedAt?.toDate()}},Vi={async getByDiscipline(e){try{const r=ze(_e(V,Gi),Se("disciplineId","==",e),Qe("numero","asc"));return(await Ae(r)).docs.map(Kv)}catch(r){throw console.error("Erreur lors de la rcupration des chapitres:",r),new Error("Impossible de rcuprer les chapitres")}},async getAll(){try{const e=ze(_e(V,Gi),Qe("numero","asc"));return(await Ae(e)).docs.map(Kv)}catch(e){throw console.error("Erreur lors de la rcupration des chapitres:",e),new Error("Impossible de rcuprer les chapitres")}},async getById(e){try{const r=je(V,Gi,e),n=await pt(r);return n.exists()?Kv(n):null}catch(r){throw console.error("Erreur lors de la rcupration du chapitre:",r),new Error("Impossible de rcuprer le chapitre")}},async create(e){try{return(await Ot(_e(V,Gi),{...e,actif:e.actif!==!1,createdAt:kt(),updatedAt:kt()})).id}catch(r){throw console.error("Erreur lors de la cration du chapitre:",r),new Error("Impossible de crer le chapitre")}},async update(e,r){try{const n=je(V,Gi,e),a=dR({...r,updatedAt:kt()});await Ve(n,a)}catch(n){throw console.error("Erreur lors de la mise  jour du chapitre:",n),new Error("Impossible de mettre  jour le chapitre")}},async delete(e){try{const r=je(V,Gi,e);await Ir(r)}catch(r){throw console.error("Erreur lors de la suppression du chapitre:",r),new Error("Impossible de supprimer le chapitre")}},async deleteByDiscipline(e){try{const r=await this.getByDiscipline(e),n=Ln(V);r.forEach(a=>{const l=je(V,Gi,a.id);n.delete(l)}),await n.commit()}catch(r){throw console.error("Erreur lors de la suppression des chapitres:",r),new Error("Impossible de supprimer les chapitres")}},async reorder(e,r){try{const n=Ln(V);r.forEach((a,l)=>{const o=je(V,Gi,a);n.update(o,{numero:l+1,updatedAt:kt()})}),await n.commit()}catch(n){throw console.error("Erreur lors de la rorganisation des chapitres:",n),new Error("Impossible de rorganiser les chapitres")}},async toggleActive(e,r){await this.update(e,{actif:r})},async countByDiscipline(e){return(await this.getByDiscipline(e)).length},async getNextNumero(e){return await this.countByDiscipline(e)+1}},mR=()=>{const{currentUser:e}=Xe(),r=tt(),[n,a]=g.useState({totalDisciplines:0,totalChapitres:0,totalRessources:0,ressourcesPremium:0,ressourcesGratuites:0,totalCours:0,totalQuiz:0,totalQuizAvances:0,ressourcesParType:{cours:0,exercice:0,video:0,document:0,quiz:0}}),[l,o]=g.useState(!0),[u,d]=g.useState(null);return g.useEffect(()=>{(async()=>{try{o(!0),d(null);const[p,h,v,b,x,j]=await Promise.all([ls.getAll(),Vi.getAll(),ha.getStats(),Ae(_e(V,"quizzes")),Ae(_e(V,"quizzes_v2")),Ae(_e(V,"cours_en_ligne"))]);a({totalDisciplines:p.length,totalChapitres:h.length,totalRessources:v.total,ressourcesPremium:v.premium,ressourcesGratuites:v.gratuit,totalCours:j.size,totalQuiz:b.size,totalQuizAvances:x.size,ressourcesParType:v.parType})}catch(p){console.error("Erreur lors du chargement des statistiques:",p),d("Impossible de charger les statistiques")}finally{o(!1)}})()},[]),t.jsxs("div",{className:"admin-dashboard",children:[t.jsx("header",{className:"admin-page-header",children:t.jsxs("div",{className:"admin-page-header__info",children:[t.jsx("h1",{className:"admin-page-header__title",children:"Tableau de bord"}),t.jsxs("p",{className:"admin-page-header__subtitle",children:["Bienvenue, ",e?.displayName||"Administrateur"," ! Grez votre contenu pdagogique depuis cette interface."]})]})}),u&&t.jsxs("div",{className:"alert alert--error",children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:u})})]}),l?t.jsxs("div",{className:"loading-container",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement des statistiques..."})]}):t.jsxs(t.Fragment,{children:[t.jsxs("section",{className:"stats-grid",children:[t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/admin/disciplines"),role:"button",tabIndex:0,onKeyDown:m=>m.key==="Enter"&&r("/admin/disciplines"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--primary",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalDisciplines}),t.jsx("div",{className:"stat-card__label",children:"Disciplines"})]})]}),t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/admin/chapitres"),role:"button",tabIndex:0,onKeyDown:m=>m.key==="Enter"&&r("/admin/chapitres"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--secondary",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalChapitres}),t.jsx("div",{className:"stat-card__label",children:"Chapitres"})]})]}),t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/admin/ressources"),role:"button",tabIndex:0,onKeyDown:m=>m.key==="Enter"&&r("/admin/ressources"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--info",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalRessources}),t.jsx("div",{className:"stat-card__label",children:"Ressources"})]})]}),t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/admin/ressources"),role:"button",tabIndex:0,onKeyDown:m=>m.key==="Enter"&&r("/admin/ressources"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--warning",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.ressourcesPremium}),t.jsx("div",{className:"stat-card__label",children:"Ressources Premium"})]})]}),t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/prof/cours"),role:"button",tabIndex:0,onKeyDown:m=>m.key==="Enter"&&r("/prof/cours"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--primary",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalCours}),t.jsx("div",{className:"stat-card__label",children:"Cours en ligne"})]})]}),t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/admin/quiz"),role:"button",tabIndex:0,onKeyDown:m=>m.key==="Enter"&&r("/admin/quiz"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--quiz",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalQuiz}),t.jsx("div",{className:"stat-card__label",children:"Quiz"})]})]}),t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/admin/quiz-avance"),role:"button",tabIndex:0,onKeyDown:m=>m.key==="Enter"&&r("/admin/quiz-avance"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--advanced",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalQuizAvances}),t.jsx("div",{className:"stat-card__label",children:"Quiz Avancs"})]})]})]}),t.jsxs("section",{className:"content-card",children:[t.jsx("div",{className:"content-card__header",children:t.jsx("h2",{children:"Rpartition des ressources par type"})}),t.jsx("div",{className:"content-card__body",children:t.jsxs("div",{className:"resource-type-grid",children:[t.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>r("/admin/ressources"),role:"button",tabIndex:0,children:[t.jsx("div",{className:"resource-item__icon resource-item__icon--cours",children:""}),t.jsxs("div",{className:"resource-type-info",children:[t.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.cours}),t.jsx("span",{className:"resource-type-label",children:"Cours"})]})]}),t.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>r("/admin/ressources"),role:"button",tabIndex:0,children:[t.jsx("div",{className:"resource-item__icon resource-item__icon--exercice",children:""}),t.jsxs("div",{className:"resource-type-info",children:[t.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.exercice}),t.jsx("span",{className:"resource-type-label",children:"Exercices"})]})]}),t.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>r("/admin/ressources"),role:"button",tabIndex:0,children:[t.jsx("div",{className:"resource-item__icon resource-item__icon--video",children:""}),t.jsxs("div",{className:"resource-type-info",children:[t.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.video}),t.jsx("span",{className:"resource-type-label",children:"Vidos"})]})]}),t.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>r("/admin/ressources"),role:"button",tabIndex:0,children:[t.jsx("div",{className:"resource-item__icon resource-item__icon--document",children:""}),t.jsxs("div",{className:"resource-type-info",children:[t.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.document}),t.jsx("span",{className:"resource-type-label",children:"Documents"})]})]}),t.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>r("/admin/quiz"),role:"button",tabIndex:0,children:[t.jsx("div",{className:"resource-item__icon resource-item__icon--quiz",children:""}),t.jsxs("div",{className:"resource-type-info",children:[t.jsx("span",{className:"resource-type-value",children:n.totalQuiz+n.totalQuizAvances}),t.jsx("span",{className:"resource-type-label",children:"Quiz (tous)"})]})]})]})})]}),t.jsxs("section",{className:"content-card",style:{marginTop:"var(--spacing-xl)"},children:[t.jsx("div",{className:"content-card__header",children:t.jsx("h2",{children:"Actions rapides"})}),t.jsx("div",{className:"content-card__body",children:t.jsxs("div",{className:"quick-actions-grid",children:[t.jsxs("a",{href:"/admin/disciplines",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Grer les disciplines"}),t.jsx("p",{children:"Ajouter, modifier ou supprimer des matires"})]})]}),t.jsxs("a",{href:"/admin/chapitres",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Grer les chapitres"}),t.jsx("p",{children:"Organiser le contenu par chapitres"})]})]}),t.jsxs("a",{href:"/admin/ressources",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Grer les ressources"}),t.jsx("p",{children:"Cours, exercices, vidos et documents"})]})]}),t.jsxs("a",{href:"/admin/quiz",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Grer les quiz"}),t.jsx("p",{children:"Crer et modifier des quiz pour les lves"})]})]}),t.jsxs("a",{href:"/admin/quiz-avance",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Quiz avancs"}),t.jsx("p",{children:"Quiz interactifs avec niveaux de difficult"})]})]}),t.jsxs("a",{href:"/admin/utilisateurs",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Grer les utilisateurs"}),t.jsx("p",{children:"lves, professeurs et administrateurs"})]})]}),t.jsxs("a",{href:"/prof/cahiers",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Cahier de Textes"}),t.jsx("p",{children:"Planifier et suivre l'enseignement"})]})]}),t.jsxs("a",{href:"/prof/sequences",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Squences Pdagogiques"}),t.jsx("p",{children:"Crer et organiser des squences de cours"})]})]}),t.jsxs("a",{href:"/prof/cours",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Cours en ligne"}),t.jsx("p",{children:"Crer et grer les cours en ligne"})]})]}),t.jsxs("a",{href:"/mediatheque",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Mdiathque"}),t.jsx("p",{children:"Vidos, podcasts et webinaires pdagogiques"})]})]})]})})]})]}),t.jsx("style",{children:`
        /* ====== Stat cards cliquables ====== */
        /* Curseur pointer + effet hover sur les cartes de statistiques */
        .stat-card--clickable {
          cursor: pointer;
          transition: all 0.2s ease;
        }
        .stat-card--clickable:hover {
          transform: translateY(-3px);
          box-shadow: var(--shadow-lg, 0 8px 24px rgba(0,0,0,0.12));
          border-color: var(--color-primary, #3182ce);
        }
        .stat-card--clickable:active {
          transform: translateY(-1px);
        }

        /* Icne quiz (violet) */
        .stat-card__icon--quiz {
          background: #f3e8ff;
          color: #7c3aed;
        }
        /* Icne quiz avanc (rose) */
        .stat-card__icon--advanced {
          background: #fce7f3;
          color: #db2777;
        }

        /* ====== Grille des types de ressources ====== */
        .resource-type-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
          gap: var(--spacing-lg);
        }

        .resource-type-item {
          display: flex;
          align-items: center;
          gap: var(--spacing-md);
          padding: var(--spacing-md);
          background: var(--color-bg-secondary);
          border-radius: var(--radius-lg);
        }

        /* Cartes de rpartition cliquables */
        .resource-type-item--clickable {
          cursor: pointer;
          transition: all 0.2s ease;
          border: 1px solid transparent;
        }
        .resource-type-item--clickable:hover {
          border-color: var(--color-primary, #3182ce);
          box-shadow: 0 2px 8px rgba(0,0,0,0.08);
          transform: translateY(-2px);
        }

        .resource-type-info {
          display: flex;
          flex-direction: column;
        }

        .resource-type-value {
          font-size: var(--text-2xl);
          font-weight: var(--font-bold);
          color: var(--color-text);
        }

        .resource-type-label {
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        /* ====== Actions rapides ====== */
        .quick-actions-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
          gap: var(--spacing-lg);
        }

        .quick-action-card {
          display: flex;
          align-items: flex-start;
          gap: var(--spacing-lg);
          padding: var(--spacing-lg);
          background: var(--color-bg-secondary);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-lg);
          text-decoration: none;
          color: inherit;
          transition: all var(--transition-base);
        }

        .quick-action-card:hover {
          border-color: var(--color-primary);
          box-shadow: var(--shadow-md);
          transform: translateY(-2px);
        }

        .quick-action-icon {
          font-size: 2rem;
          line-height: 1;
        }

        .quick-action-content h3 {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          margin-bottom: var(--spacing-xs);
          color: var(--color-text);
        }

        .quick-action-content p {
          font-size: var(--text-sm);
          color: var(--color-text-light);
          margin: 0;
        }

        @media (max-width: 768px) {
          .resource-type-grid,
          .quick-actions-grid {
            grid-template-columns: 1fr;
          }
        }
      `})]})},Ge={container:{maxWidth:"900px",margin:"0 auto",padding:"24px"},title:{fontSize:"1.5rem",fontWeight:700,color:"#1a365d",marginBottom:"24px"},form:{background:"#ffffff",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",marginBottom:"32px",border:"1px solid #e2e8f0"},formTitle:{fontSize:"1.1rem",fontWeight:600,color:"#2d3748",marginBottom:"20px",paddingBottom:"12px",borderBottom:"2px solid #3182ce"},formGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"16px",marginBottom:"20px"},fieldGroup:{display:"flex",flexDirection:"column",gap:"6px"},label:{fontSize:"0.875rem",fontWeight:600,color:"#4a5568"},labelOptional:{fontSize:"0.75rem",fontWeight:400,color:"#a0aec0",marginLeft:"4px"},input:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"0.95rem",outline:"none",transition:"border-color 0.2s"},select:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"0.95rem",background:"#fff",cursor:"pointer"},textarea:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"0.95rem",minHeight:"80px",resize:"vertical",fontFamily:"inherit"},btnPrimary:{padding:"12px 28px",background:"#3182ce",color:"#fff",border:"none",borderRadius:"8px",fontSize:"0.95rem",fontWeight:600,cursor:"pointer",transition:"background 0.2s"},btnSecondary:{padding:"12px 28px",background:"#e2e8f0",color:"#4a5568",border:"none",borderRadius:"8px",fontSize:"0.95rem",fontWeight:600,cursor:"pointer",marginLeft:"12px"},btnDanger:{padding:"6px 14px",background:"#fed7d7",color:"#c53030",border:"1px solid #fc8181",borderRadius:"6px",fontSize:"0.8rem",cursor:"pointer"},btnEdit:{padding:"6px 14px",background:"#ebf8ff",color:"#2b6cb0",border:"1px solid #90cdf4",borderRadius:"6px",fontSize:"0.8rem",cursor:"pointer",marginRight:"8px"},card:{background:"#fff",borderRadius:"10px",padding:"16px 20px",boxShadow:"0 1px 4px rgba(0,0,0,0.06)",border:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},badge:{display:"inline-block",padding:"3px 10px",borderRadius:"12px",fontSize:"0.75rem",fontWeight:600},badgeCollege:{background:"#ebf8ff",color:"#2b6cb0"},badgeLycee:{background:"#fefcbf",color:"#975a16"},badgeFormationLibre:{background:"#f0fff4",color:"#276749"},tabs:{display:"flex",gap:"8px",marginBottom:"20px",flexWrap:"wrap"},tab:{padding:"8px 20px",borderRadius:"8px",border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,transition:"all 0.2s"},tabActive:{background:"#3182ce",color:"#fff",borderColor:"#3182ce"}},Wv={nom:"",niveau:"college",classe:"6eme",ordre:0,coefficient:void 0,couleur:"",icone:"",description:""},fR=()=>{const[e,r]=g.useState([]),[n,a]=g.useState(Wv),[l,o]=g.useState(null),[u,d]=g.useState(!1),[m,p]=g.useState("all");g.useEffect(()=>{const E=ze(_e(V,"disciplines"),Qe("nom")),S=kf(E,A=>{const z=A.docs.map(k=>({id:k.id,...k.data(),createdAt:k.data().createdAt?.toDate()||new Date,updatedAt:k.data().updatedAt?.toDate()||new Date}));r(z)});return()=>S()},[]);const h=g.useCallback(E=>{const S=U1(E)[0]?.value||"6eme";a(A=>({...A,niveau:E,classe:S,coefficient:E==="formation_libre"?void 0:A.coefficient}))},[]),v=async E=>{if(E.preventDefault(),!!n.nom.trim()){d(!0);try{const S={nom:n.nom.trim(),niveau:n.niveau,classe:n.classe,ordre:n.ordre,...n.coefficient!==void 0&&{coefficient:n.coefficient},couleur:n.couleur||"",icone:n.icone||"",description:n.description||"",updatedAt:Ee.now()};l?await Ve(je(V,"disciplines",l),S):await Ot(_e(V,"disciplines"),{...S,createdAt:Ee.now()}),a(Wv),o(null)}catch(S){console.error("Erreur lors de la sauvegarde :",S),alert("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{d(!1)}}},b=E=>{a({nom:E.nom,niveau:E.niveau,classe:E.classe,ordre:E.ordre,coefficient:E.coefficient,couleur:E.couleur||"",icone:E.icone||"",description:E.description||""}),o(E.id)},x=async(E,S)=>{if(window.confirm(`Supprimer la discipline "${S}" ? Cette action est irrversible.`))try{await Ir(je(V,"disciplines",E))}catch(A){console.error("Erreur lors de la suppression :",A)}},j=()=>{a(Wv),o(null)},_=U1(n.niveau),w=m==="all"?e:e.filter(E=>E.niveau===m),C=E=>({...Ge.badge,...E==="college"?Ge.badgeCollege:{},...E==="lycee"?Ge.badgeLycee:{},...E==="formation_libre"?Ge.badgeFormationLibre:{}});return t.jsxs("div",{style:Ge.container,children:[t.jsx("h2",{style:Ge.title,children:" Gestion des Disciplines"}),t.jsxs("form",{style:Ge.form,onSubmit:v,children:[t.jsx("h3",{style:Ge.formTitle,children:l?" Modifier la discipline":" Ajouter une discipline"}),t.jsxs("div",{style:Ge.formGrid,children:[t.jsxs("div",{style:Ge.fieldGroup,children:[t.jsx("label",{style:Ge.label,children:"Nom de la discipline"}),t.jsx("input",{type:"text",style:Ge.input,value:n.nom,onChange:E=>a({...n,nom:E.target.value}),placeholder:"Ex : Cuisine sngalaise, Couture, Franais...",required:!0})]}),t.jsxs("div",{style:Ge.fieldGroup,children:[t.jsx("label",{style:Ge.label,children:"Niveau"}),t.jsxs("select",{style:Ge.select,value:n.niveau,onChange:E=>h(E.target.value),children:[t.jsx("option",{value:"college",children:" Collge"}),t.jsx("option",{value:"lycee",children:" Lyce"}),t.jsx("option",{value:"formation_libre",children:" Formation libre"})]})]}),t.jsxs("div",{style:Ge.fieldGroup,children:[t.jsx("label",{style:Ge.label,children:n.niveau==="formation_libre"?"Niveau de formation":"Classe"}),t.jsx("select",{style:Ge.select,value:n.classe,onChange:E=>a({...n,classe:E.target.value}),children:_.map(({value:E,label:S})=>t.jsx("option",{value:E,children:S},E))})]}),t.jsxs("div",{style:Ge.fieldGroup,children:[t.jsx("label",{style:Ge.label,children:"Ordre d'affichage"}),t.jsx("input",{type:"number",style:Ge.input,value:n.ordre,onChange:E=>a({...n,ordre:Number(E.target.value)}),placeholder:"Ex : 1",min:"0"})]}),t.jsxs("div",{style:Ge.fieldGroup,children:[t.jsxs("label",{style:Ge.label,children:["Coefficient",n.niveau==="formation_libre"&&t.jsx("span",{style:Ge.labelOptional,children:"(optionnel)"})]}),t.jsx("input",{type:"number",style:Ge.input,value:n.coefficient??"",onChange:E=>a({...n,coefficient:E.target.value?Number(E.target.value):void 0}),placeholder:n.niveau==="formation_libre"?"Non requis":"Ex : 3",min:"1",max:"10",required:n.niveau!=="formation_libre"})]}),t.jsxs("div",{style:Ge.fieldGroup,children:[t.jsxs("label",{style:Ge.label,children:["Couleur",t.jsx("span",{style:Ge.labelOptional,children:"(optionnel)"})]}),t.jsx("input",{type:"color",style:{...Ge.input,maxWidth:"80px",padding:"4px",height:"40px"},value:n.couleur||"#3182ce",onChange:E=>a({...n,couleur:E.target.value})})]})]}),t.jsxs("div",{style:{...Ge.fieldGroup,marginBottom:"20px"},children:[t.jsxs("label",{style:Ge.label,children:["Description",t.jsx("span",{style:Ge.labelOptional,children:"(optionnel)"})]}),t.jsx("textarea",{style:Ge.textarea,value:n.description,onChange:E=>a({...n,description:E.target.value}),placeholder:"Brve description de la discipline..."})]}),t.jsxs("div",{style:{...Ge.fieldGroup,marginBottom:"20px"},children:[t.jsxs("label",{style:Ge.label,children:["Icne (emoji)",t.jsx("span",{style:Ge.labelOptional,children:"(optionnel)"})]}),t.jsx("input",{type:"text",style:{...Ge.input,maxWidth:"120px"},value:n.icone,onChange:E=>a({...n,icone:E.target.value}),placeholder:""})]}),t.jsxs("div",{children:[t.jsx("button",{type:"submit",style:Ge.btnPrimary,disabled:u,children:u?"Enregistrement...":l?"Mettre  jour":"Ajouter la discipline"}),l&&t.jsx("button",{type:"button",style:Ge.btnSecondary,onClick:j,children:"Annuler"})]})]}),t.jsxs("div",{children:[t.jsxs("h3",{style:Ge.formTitle,children:[" Disciplines existantes (",w.length,")"]}),t.jsxs("div",{style:Ge.tabs,children:[t.jsx("button",{style:{...Ge.tab,...m==="all"?Ge.tabActive:{}},onClick:()=>p("all"),children:"Toutes"}),t.jsx("button",{style:{...Ge.tab,...m==="college"?Ge.tabActive:{}},onClick:()=>p("college"),children:" Collge"}),t.jsx("button",{style:{...Ge.tab,...m==="lycee"?Ge.tabActive:{}},onClick:()=>p("lycee"),children:" Lyce"}),t.jsx("button",{style:{...Ge.tab,...m==="formation_libre"?Ge.tabActive:{}},onClick:()=>p("formation_libre"),children:" Formation libre"})]}),w.length===0?t.jsx("p",{style:{color:"#a0aec0",fontStyle:"italic",textAlign:"center",padding:"32px"},children:"Aucune discipline trouve pour ce filtre."}):w.map(E=>t.jsxs("div",{style:Ge.card,children:[t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[E.icone&&t.jsx("span",{style:{fontSize:"1.2rem"},children:E.icone}),t.jsx("strong",{style:{fontSize:"1rem",color:"#2d3748"},children:E.nom}),t.jsx("span",{style:C(E.niveau),children:RA[E.niveau]})]}),t.jsxs("div",{style:{fontSize:"0.85rem",color:"#718096"},children:[E.niveau==="formation_libre"?"Niveau":"Classe"," :"," ",IA(E.classe),E.coefficient!==void 0&&t.jsxs("span",{style:{marginLeft:"12px"},children:["| Coeff : ",E.coefficient]})]})]}),t.jsxs("div",{style:{display:"flex",gap:"4px"},children:[t.jsx("button",{style:Ge.btnEdit,onClick:()=>b(E),children:"Modifier"}),t.jsx("button",{style:Ge.btnDanger,onClick:()=>x(E.id,E.nom),children:"Supprimer"})]})]},E.id))]})]})},Z1={numero:1,titre:"",description:"",objectifs:[],dureeEstimee:0,isPremium:!1,actif:!0},pR=()=>{const[e,r]=g.useState([]),[n,a]=g.useState([]),[l,o]=g.useState(""),[u,d]=g.useState(!0),[m,p]=g.useState(!1),[h,v]=g.useState(!1),[b,x]=g.useState(null),[j,_]=g.useState(null),[w,C]=g.useState(null),[E,S]=g.useState(!1),[A,z]=g.useState(!1),[k,P]=g.useState(null),[D,$]=g.useState(null),[F,Y]=g.useState({...Z1,disciplineId:""}),[M,K]=g.useState({}),[ee,X]=g.useState(""),L=g.useCallback(async()=>{try{d(!0);const R=await ls.getAll();r(R),R.length>0&&!l&&o(R[0].id)}catch(R){console.error("Erreur lors du chargement des disciplines:",R),_("Impossible de charger les disciplines.")}finally{d(!1)}},[l]),I=g.useCallback(async()=>{if(!l){a([]);return}try{p(!0);const R=await Vi.getByDiscipline(l);a(R)}catch(R){console.error("Erreur lors du chargement des chapitres:",R),_("Impossible de charger les chapitres.")}finally{p(!1)}},[l]);g.useEffect(()=>{L()},[L]),g.useEffect(()=>{I()},[I]);const U=()=>{const R={};return F.disciplineId||(R.disciplineId="Veuillez slectionner une discipline"),F.titre.trim()?F.titre.length<3&&(R.titre="Le titre doit contenir au moins 3 caractres"):R.titre="Le titre du chapitre est requis",F.numero<1&&(R.numero="Le numro doit tre suprieur  0"),K(R),Object.keys(R).length===0},B=R=>{o(R),_(null)},T=async()=>{const R=await Vi.getNextNumero(l);P(null),Y({...Z1,disciplineId:l,numero:R}),K({}),X(""),S(!0)},Z=R=>{P(R),Y({disciplineId:R.disciplineId,numero:R.numero,titre:R.titre,description:R.description,objectifs:R.objectifs||[],dureeEstimee:R.dureeEstimee,isPremium:R.isPremium,actif:R.actif}),K({}),X(""),S(!0)},H=R=>{$(R),z(!0)},ce=()=>{S(!1),z(!1),P(null),$(null),K({}),X("")},xe=R=>{const{name:ae,value:Ce,type:ke}=R.target,Ke=R.target.checked;Y(et=>({...et,[ae]:ke==="checkbox"?Ke:ke==="number"?Number(Ce):Ce})),M[ae]&&K(et=>({...et,[ae]:void 0}))},fe=()=>{ee.trim()&&(Y(R=>({...R,objectifs:[...R.objectifs||[],ee.trim()]})),X(""))},G=R=>{Y(ae=>({...ae,objectifs:(ae.objectifs||[]).filter((Ce,ke)=>ke!==R)}))},ve=async R=>{if(R.preventDefault(),!!U())try{v(!0),_(null),k?(await Vi.update(k.id,F),C("Chapitre modifi avec succs !")):(await Vi.create(F),C("Chapitre cr avec succs !")),ce(),await I(),setTimeout(()=>C(null),3e3)}catch(ae){console.error("Erreur lors de la sauvegarde:",ae),_("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{v(!1)}},De=async()=>{if(D)try{x(D.id),await Vi.delete(D.id),C("Chapitre supprim avec succs !"),ce(),await I(),setTimeout(()=>C(null),3e3)}catch(R){console.error("Erreur lors de la suppression:",R),_("Erreur lors de la suppression. Veuillez ressayer.")}finally{x(null)}},de=async R=>{try{await Vi.toggleActive(R.id,!R.actif),await I(),C(R.actif?"Chapitre dsactiv":"Chapitre activ"),setTimeout(()=>C(null),2e3)}catch{_("Erreur lors de la mise  jour")}},we=R=>{const ae=e.find(Ce=>Ce.id===R);return ae?ae.nom:"Non trouve"};return t.jsxs("div",{className:"chapitre-manager",children:[t.jsxs("header",{className:"admin-page-header",children:[t.jsxs("div",{className:"admin-page-header__info",children:[t.jsx("h1",{className:"admin-page-header__title",children:"Gestion des Chapitres"}),t.jsx("p",{className:"admin-page-header__subtitle",children:"Organisez le contenu pdagogique par chapitres"})]}),t.jsx("div",{className:"admin-page-header__actions",children:t.jsxs("button",{onClick:T,className:"btn btn--primary",disabled:!l||u,children:[t.jsx("span",{children:""}),"Nouveau chapitre"]})})]}),j&&t.jsxs("div",{className:"alert alert--error",children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:j})}),t.jsx("button",{onClick:()=>_(null),className:"alert__close",children:""})]}),w&&t.jsxs("div",{className:"alert alert--success",children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:w})})]}),t.jsx("div",{className:"content-card",style:{marginBottom:"var(--spacing-lg)"},children:t.jsx("div",{className:"content-card__body",children:t.jsxs("div",{className:"discipline-selector",children:[t.jsx("label",{className:"form-label",children:"Slectionner une discipline :"}),u?t.jsx("p",{className:"text-muted",children:"Chargement des disciplines..."}):e.length===0?t.jsxs("p",{className:"text-muted",children:["Aucune discipline disponible.",t.jsx("a",{href:"/admin/disciplines",children:" Crer une discipline"})]}):t.jsx("div",{className:"discipline-tabs",children:e.map(R=>t.jsxs("button",{className:`discipline-tab ${l===R.id?"discipline-tab--active":""}`,onClick:()=>B(R.id),style:{"--discipline-color":R.couleur||"#2563eb"},children:[t.jsx("span",{className:"discipline-tab__icon",children:R.icone||""}),t.jsx("span",{className:"discipline-tab__name",children:R.nom}),t.jsx("span",{className:"discipline-tab__class",children:R.classe})]},R.id))})]})})}),t.jsxs("div",{className:"admin-table-container",children:[t.jsx("div",{className:"admin-table-header",children:t.jsxs("h2",{className:"admin-table-title",children:["Chapitres ",l&&`- ${we(l)}`,n.length>0&&` (${n.length})`]})}),m?t.jsxs("div",{className:"loading-container",style:{padding:"var(--spacing-2xl)"},children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement des chapitres..."})]}):l?n.length===0?t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{className:"empty-state__icon",children:""}),t.jsx("h3",{className:"empty-state__title",children:"Aucun chapitre"}),t.jsx("p",{className:"empty-state__message",children:"Cette discipline n'a pas encore de chapitres."}),t.jsx("button",{onClick:T,className:"btn btn--primary",children:"Crer le premier chapitre"})]}):t.jsx("div",{className:"chapitres-list",children:n.map(R=>t.jsxs("div",{className:`chapitre-card ${R.actif?"":"chapitre-card--inactive"}`,children:[t.jsx("div",{className:"chapitre-card__number",children:R.numero}),t.jsxs("div",{className:"chapitre-card__content",children:[t.jsxs("h3",{className:"chapitre-card__title",children:[R.titre,R.isPremium&&t.jsx("span",{className:"badge badge--premium",children:"Premium"}),!R.actif&&t.jsx("span",{className:"badge badge--warning",children:"Inactif"})]}),R.description&&t.jsx("p",{className:"chapitre-card__description",children:R.description}),t.jsxs("div",{className:"chapitre-card__meta",children:[R.dureeEstimee&&t.jsxs("span",{children:[" ",R.dureeEstimee,"h estime"]}),R.objectifs&&R.objectifs.length>0&&t.jsxs("span",{children:[" ",R.objectifs.length," objectif(s)"]})]})]}),t.jsxs("div",{className:"chapitre-card__actions",children:[t.jsx("button",{onClick:()=>de(R),className:`table-action-btn ${R.actif?"table-action-btn--view":"table-action-btn--edit"}`,title:R.actif?"Dsactiver":"Activer",children:R.actif?"":""}),t.jsx("button",{onClick:()=>Z(R),className:"table-action-btn table-action-btn--edit",title:"Modifier",children:""}),t.jsx("button",{onClick:()=>H(R),className:"table-action-btn table-action-btn--delete",title:"Supprimer",disabled:b===R.id,children:b===R.id?"":""})]})]},R.id))}):t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{className:"empty-state__icon",children:""}),t.jsx("h3",{className:"empty-state__title",children:"Slectionnez une discipline"}),t.jsx("p",{className:"empty-state__message",children:"Choisissez une discipline ci-dessus pour voir ses chapitres."})]})]}),E&&t.jsx("div",{className:"modal-overlay",onClick:ce,children:t.jsxs("div",{className:"modal modal--lg",onClick:R=>R.stopPropagation(),children:[t.jsxs("div",{className:"modal__header",children:[t.jsx("h2",{className:"modal__title",children:k?"Modifier le chapitre":"Nouveau chapitre"}),t.jsx("button",{onClick:ce,className:"modal__close",children:""})]}),t.jsxs("form",{onSubmit:ve,children:[t.jsxs("div",{className:"modal__body",children:[!k&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label form-label--required",children:"Discipline"}),t.jsxs("select",{name:"disciplineId",className:`form-select ${M.disciplineId?"form-select--error":""}`,value:F.disciplineId,onChange:xe,children:[t.jsx("option",{value:"",children:"Slectionner une discipline"}),e.map(R=>t.jsxs("option",{value:R.id,children:[R.icone," ",R.nom," (",R.classe,")"]},R.id))]}),M.disciplineId&&t.jsx("span",{className:"form-error",children:M.disciplineId})]}),t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",style:{flex:"0 0 100px"},children:[t.jsx("label",{className:"form-label form-label--required",children:"N"}),t.jsx("input",{type:"number",name:"numero",className:`form-input ${M.numero?"form-input--error":""}`,min:"1",value:F.numero,onChange:xe}),M.numero&&t.jsx("span",{className:"form-error",children:M.numero})]}),t.jsxs("div",{className:"form-group",style:{flex:1},children:[t.jsx("label",{className:"form-label form-label--required",children:"Titre du chapitre"}),t.jsx("input",{type:"text",name:"titre",className:`form-input ${M.titre?"form-input--error":""}`,placeholder:"Ex: Les fractions, La Rvolution franaise...",value:F.titre,onChange:xe}),M.titre&&t.jsx("span",{className:"form-error",children:M.titre})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Description"}),t.jsx("textarea",{name:"description",className:"form-textarea",rows:3,placeholder:"Description du chapitre...",value:F.description||"",onChange:xe})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Objectifs pdagogiques"}),t.jsxs("div",{className:"objectifs-input",children:[t.jsx("input",{type:"text",className:"form-input",placeholder:"Ajouter un objectif...",value:ee,onChange:R=>X(R.target.value),onKeyPress:R=>R.key==="Enter"&&(R.preventDefault(),fe())}),t.jsx("button",{type:"button",onClick:fe,className:"btn btn--outline btn--sm",children:"Ajouter"})]}),F.objectifs&&F.objectifs.length>0&&t.jsx("ul",{className:"objectifs-list",children:F.objectifs.map((R,ae)=>t.jsxs("li",{className:"objectif-item",children:[t.jsxs("span",{children:[" ",R]}),t.jsx("button",{type:"button",onClick:()=>G(ae),className:"objectif-remove",children:""})]},ae))})]}),t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Dure estime (heures)"}),t.jsx("input",{type:"number",name:"dureeEstimee",className:"form-input",min:"0",step:"0.5",placeholder:"Ex: 2",value:F.dureeEstimee||"",onChange:xe})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Options"}),t.jsxs("div",{className:"form-options",children:[t.jsxs("label",{className:"form-checkbox",children:[t.jsx("input",{type:"checkbox",name:"isPremium",checked:F.isPremium,onChange:xe}),t.jsx("span",{children:"Contenu Premium "})]}),t.jsxs("label",{className:"form-checkbox",children:[t.jsx("input",{type:"checkbox",name:"actif",checked:F.actif!==!1,onChange:xe}),t.jsx("span",{children:"Chapitre actif"})]})]})]})]})]}),t.jsxs("div",{className:"modal__footer",children:[t.jsx("button",{type:"button",onClick:ce,className:"btn btn--outline",disabled:h,children:"Annuler"}),t.jsx("button",{type:"submit",className:"btn btn--primary",disabled:h,children:h?"Enregistrement...":k?"Mettre  jour":"Crer le chapitre"})]})]})]})}),A&&D&&t.jsx("div",{className:"modal-overlay",onClick:ce,children:t.jsxs("div",{className:"modal",onClick:R=>R.stopPropagation(),children:[t.jsxs("div",{className:"modal__header",children:[t.jsx("h2",{className:"modal__title",children:"Confirmer la suppression"}),t.jsx("button",{onClick:ce,className:"modal__close",children:""})]}),t.jsxs("div",{className:"modal__body",children:[t.jsxs("p",{children:["Supprimer le chapitre ",t.jsxs("strong",{children:[D.numero,". ",D.titre]})," ?"]}),t.jsxs("div",{className:"alert alert--warning",style:{marginTop:"var(--spacing-md)"},children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:"Les ressources associes ne seront pas supprimes automatiquement."})})]})]}),t.jsxs("div",{className:"modal__footer",children:[t.jsx("button",{onClick:ce,className:"btn btn--outline",children:"Annuler"}),t.jsx("button",{onClick:De,className:"btn btn--danger",disabled:b!==null,children:b?"Suppression...":"Supprimer"})]})]})}),t.jsx("style",{children:`
        /* Slecteur de discipline */
        .discipline-tabs {
          display: flex;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
          margin-top: var(--spacing-md);
        }

        .discipline-tab {
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          padding: var(--spacing-sm) var(--spacing-md);
          border: 2px solid var(--color-border);
          border-radius: var(--radius-lg);
          background: white;
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .discipline-tab:hover {
          border-color: var(--discipline-color, var(--color-primary));
        }

        .discipline-tab--active {
          border-color: var(--discipline-color, var(--color-primary));
          background: color-mix(in srgb, var(--discipline-color, var(--color-primary)) 10%, white);
        }

        .discipline-tab__icon {
          font-size: var(--text-lg);
        }

        .discipline-tab__name {
          font-weight: var(--font-medium);
        }

        .discipline-tab__class {
          font-size: var(--text-xs);
          color: var(--color-text-light);
          background: var(--color-bg-secondary);
          padding: 2px 6px;
          border-radius: var(--radius-sm);
        }

        /* Liste des chapitres */
        .chapitres-list {
          display: flex;
          flex-direction: column;
          gap: var(--spacing-md);
          padding: var(--spacing-lg);
        }

        .chapitre-card {
          display: flex;
          align-items: center;
          gap: var(--spacing-lg);
          padding: var(--spacing-lg);
          background: var(--color-bg-secondary);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-lg);
          transition: all var(--transition-base);
        }

        .chapitre-card:hover {
          border-color: var(--color-primary);
          box-shadow: var(--shadow-md);
        }

        .chapitre-card--inactive {
          opacity: 0.6;
          background: var(--color-bg-tertiary);
        }

        .chapitre-card__number {
          width: 48px;
          height: 48px;
          background: var(--color-primary);
          color: white;
          border-radius: var(--radius-md);
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
          flex-shrink: 0;
        }

        .chapitre-card__content {
          flex: 1;
          min-width: 0;
        }

        .chapitre-card__title {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          margin-bottom: var(--spacing-xs);
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
        }

        .chapitre-card__description {
          font-size: var(--text-sm);
          color: var(--color-text-light);
          margin: 0 0 var(--spacing-sm);
        }

        .chapitre-card__meta {
          display: flex;
          gap: var(--spacing-lg);
          font-size: var(--text-xs);
          color: var(--color-text-lighter);
        }

        .chapitre-card__actions {
          display: flex;
          gap: var(--spacing-sm);
        }

        /* Formulaire: Ligne */
        .form-row {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: var(--spacing-lg);
        }

        @media (max-width: 600px) {
          .form-row {
            grid-template-columns: 1fr;
          }
        }

        /* Objectifs */
        .objectifs-input {
          display: flex;
          gap: var(--spacing-sm);
        }

        .objectifs-list {
          list-style: none;
          margin-top: var(--spacing-md);
        }

        .objectif-item {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: var(--spacing-sm) var(--spacing-md);
          background: var(--color-bg-secondary);
          border-radius: var(--radius-md);
          margin-bottom: var(--spacing-xs);
        }

        .objectif-remove {
          background: none;
          border: none;
          cursor: pointer;
          color: var(--color-error);
          opacity: 0.7;
        }

        .objectif-remove:hover {
          opacity: 1;
        }

        /* Options */
        .form-options {
          display: flex;
          flex-direction: column;
          gap: var(--spacing-sm);
          margin-top: var(--spacing-sm);
        }
      `})]})},Gd=[{value:"cours",label:"Cours",icon:"",color:"#2563eb"},{value:"exercice",label:"Exercice",icon:"",color:"#10b981"},{value:"video",label:"Vido",icon:"",color:"#ef4444"},{value:"document",label:"Document",icon:"",color:"#f59e0b"},{value:"quiz",label:"Quiz",icon:"",color:"#8b5cf6"}],Hd={cours:[".pdf",".doc",".docx",".ppt",".pptx"],exercice:[".pdf",".doc",".docx"],video:[".mp4",".webm",".mov",".avi"],document:[".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx"],quiz:[".json",".pdf"]},Xv=50,J1={titre:"",type:"cours",description:"",contenu:"",chapitre:"",ordre:1,isPremium:!1,actif:!0,tags:[],duree:void 0,urlExterne:""},hR=()=>{const{currentUser:e}=Xe(),[r,n]=g.useState([]),[a,l]=g.useState([]),[o,u]=g.useState([]),[d,m]=g.useState([]),[p,h]=g.useState(""),[v,b]=g.useState(""),[x,j]=g.useState(""),[_,w]=g.useState(""),[C,E]=g.useState(""),[S,A]=g.useState(!0),[z,k]=g.useState(!1),[P,D]=g.useState(!1),[$,F]=g.useState(!1),[Y,M]=g.useState(null),[K,ee]=g.useState(!1),[X,L]=g.useState(0),[I,U]=g.useState(null),[B,T]=g.useState(null),[Z,H]=g.useState(!1),[ce,xe]=g.useState(!1),[fe,G]=g.useState(!1),[ve,De]=g.useState(null),[de,we]=g.useState(null),[R,ae]=g.useState(null),[Ce,ke]=g.useState({...J1,disciplineId:""}),[Ke,et]=g.useState({}),[rt,Yt]=g.useState(null),[mr,fr]=g.useState(null),$r=g.useRef(null),[he,Pe]=g.useState(""),Ie=g.useCallback(async()=>{try{A(!0);const re=await ls.getAll();n(re),re.length>0&&!p&&h(re[0].id)}catch(re){console.error("Erreur lors du chargement des disciplines:",re),U("Impossible de charger les disciplines.")}finally{A(!1)}},[p]),Ye=g.useCallback(async()=>{if(!p){l([]);return}try{k(!0);const re=await Vi.getByDiscipline(p);l(re)}catch(re){console.error("Erreur lors du chargement des chapitres:",re)}finally{k(!1)}},[p]),nt=g.useCallback(async()=>{if(!p){u([]),m([]);return}try{D(!0);const re=await ha.getByDiscipline(p);u(re),m(re)}catch(re){console.error("Erreur lors du chargement des ressources:",re),U("Impossible de charger les ressources.")}finally{D(!1)}},[p]);g.useEffect(()=>{Ie()},[Ie]),g.useEffect(()=>{Ye()},[Ye]),g.useEffect(()=>{nt()},[nt]),g.useEffect(()=>{let re=[...o];if(v&&(re=re.filter(Fe=>Fe.chapitre===v)),x&&(re=re.filter(Fe=>Fe.type===x)),_==="premium"?re=re.filter(Fe=>Fe.isPremium):_==="free"&&(re=re.filter(Fe=>!Fe.isPremium)),C){const Fe=C.toLowerCase();re=re.filter(gt=>gt.titre.toLowerCase().includes(Fe)||gt.description?.toLowerCase().includes(Fe)||gt.tags?.some(Nn=>Nn.toLowerCase().includes(Fe)))}m(re)},[o,v,x,_,C]);const qt=()=>{const re={};if(Ce.disciplineId||(re.disciplineId="Veuillez slectionner une discipline"),Ce.titre.trim()?Ce.titre.length<3&&(re.titre="Le titre doit contenir au moins 3 caractres"):re.titre="Le titre est requis",Ce.type||(re.type="Veuillez slectionner un type de ressource"),rt){const Fe="."+rt.name.split(".").pop()?.toLowerCase(),gt=Hd[Ce.type];gt.includes(Fe)||(re.fichier=`Extension non autorise. Extensions acceptes : ${gt.join(", ")}`),rt.size/(1024*1024)>Xv&&(re.fichier=`Le fichier est trop volumineux (max ${Xv} Mo)`)}return et(re),Object.keys(re).length===0},Kt=re=>{h(re),b(""),U(null)},se=()=>{De(null),ke({...J1,disciplineId:p}),et({}),Yt(null),fr(null),Pe(""),H(!0)},Oe=re=>{De(re),ke({disciplineId:re.disciplineId,titre:re.titre,type:re.type,description:re.description,contenu:re.contenu,chapitre:re.chapitre||"",ordre:re.ordre,isPremium:re.isPremium,actif:re.actif,tags:re.tags||[],duree:re.duree,urlExterne:re.urlExterne||""}),et({}),Yt(null),fr(re.fichierURL||null),Pe(""),H(!0)},dt=re=>{ae(re),G(!0)},te=re=>{we(re),xe(!0)},W=()=>{H(!1),xe(!1),G(!1),De(null),we(null),ae(null),et({}),Yt(null),fr(null),Pe("")},ie=re=>{const{name:Fe,value:gt,type:Nn}=re.target,fl=re.target.checked;ke(ds=>({...ds,[Fe]:Nn==="checkbox"?fl:Nn==="number"?Number(gt):gt})),Ke[Fe]&&et(ds=>({...ds,[Fe]:void 0}))},Ne=re=>{const Fe=re.target.files?.[0];if(Fe)if(Yt(Fe),et(gt=>({...gt,fichier:void 0})),Fe.type.startsWith("image/")||Fe.type.startsWith("video/")){const gt=new FileReader;gt.onloadend=()=>{fr(gt.result)},gt.readAsDataURL(Fe)}else fr(null)},We=()=>{Yt(null),fr(null),$r.current&&($r.current.value="")},Dt=()=>{he.trim()&&!Ce.tags?.includes(he.trim())&&(ke(re=>({...re,tags:[...re.tags||[],he.trim()]})),Pe(""))},Kr=re=>{ke(Fe=>({...Fe,tags:(Fe.tags||[]).filter((gt,Nn)=>Nn!==re)}))},Tr=async re=>{if(re.preventDefault(),!!qt())try{F(!0),U(null);let Fe=ve?.fichierURL,gt=ve?.fichierNom;if(rt){ee(!0);const fl=ve?.id||`temp_${Date.now()}`;Fe=await ha.uploadFile(rt,fl),gt=rt?.name||"fichier",ee(!1)}const Nn={...Ce,fichierURL:Fe,fichierNom:gt};ve?(await ha.update(ve.id,Nn),T("Ressource modifie avec succs !")):(await ha.create(Nn,"admin"),T("Ressource cre avec succs !")),W(),await nt(),setTimeout(()=>T(null),3e3)}catch(Fe){console.error("Erreur lors de la sauvegarde:",Fe),U("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{F(!1),ee(!1),L(0)}},la=async()=>{if(de)try{M(de.id),de.fichierURL&&await ha.deleteFile(de.fichierURL),await ha.delete(de.id),T("Ressource supprime avec succs !"),W(),await nt(),setTimeout(()=>T(null),3e3)}catch(re){console.error("Erreur lors de la suppression:",re),U("Erreur lors de la suppression. Veuillez ressayer.")}finally{M(null)}},ul=async re=>{try{await ha.togglePremium(re.id,!re.isPremium),await nt(),T(re.isPremium?"Ressource passe en gratuit":"Ressource passe en Premium"),setTimeout(()=>T(null),2e3)}catch{U("Erreur lors de la mise  jour")}},dl=async re=>{try{await ha.toggleActive(re.id,re.actif===!1),await nt(),T(re.actif!==!1?"Ressource dsactive":"Ressource active"),setTimeout(()=>T(null),2e3)}catch{U("Erreur lors de la mise  jour")}},Ea=re=>{const Fe=r.find(gt=>gt.id===re);return Fe?Fe.nom:"Non trouve"},ml=re=>{const Fe=a.find(gt=>gt.id===re);return Fe?`${Fe.numero}. ${Fe.titre}`:""},Qn=re=>Gd.find(Fe=>Fe.value===re)||Gd[0],kp=re=>re<1024?re+" o":re<1024*1024?(re/1024).toFixed(1)+" Ko":(re/(1024*1024)).toFixed(1)+" Mo";return t.jsxs("div",{className:"resource-manager",children:[t.jsxs("header",{className:"admin-page-header",children:[t.jsxs("div",{className:"admin-page-header__info",children:[t.jsx("h1",{className:"admin-page-header__title",children:"Gestion des Ressources"}),t.jsx("p",{className:"admin-page-header__subtitle",children:"Grez les cours, exercices, vidos et documents pdagogiques"})]}),t.jsx("div",{className:"admin-page-header__actions",children:t.jsxs("button",{onClick:se,className:"btn btn--primary",disabled:!p||S,children:[t.jsx("span",{children:""}),"Nouvelle ressource"]})})]}),I&&t.jsxs("div",{className:"alert alert--error",children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:I})}),t.jsx("button",{onClick:()=>U(null),className:"alert__close",children:""})]}),B&&t.jsxs("div",{className:"alert alert--success",children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:B})})]}),t.jsx("div",{className:"content-card",style:{marginBottom:"var(--spacing-lg)"},children:t.jsx("div",{className:"content-card__body",children:t.jsxs("div",{className:"discipline-selector",children:[t.jsx("label",{className:"form-label",children:"Slectionner une discipline :"}),S?t.jsx("p",{className:"text-muted",children:"Chargement des disciplines..."}):r.length===0?t.jsxs("p",{className:"text-muted",children:["Aucune discipline disponible.",t.jsx("a",{href:"/admin/disciplines",children:" Crer une discipline"})]}):t.jsx("div",{className:"discipline-tabs",children:r.map(re=>t.jsxs("button",{className:`discipline-tab ${p===re.id?"discipline-tab--active":""}`,onClick:()=>Kt(re.id),style:{"--discipline-color":re.couleur||"#2563eb"},children:[t.jsx("span",{className:"discipline-tab__icon",children:re.icone||""}),t.jsx("span",{className:"discipline-tab__name",children:re.nom}),t.jsx("span",{className:"discipline-tab__class",children:re.classe})]},re.id))})]})})}),t.jsxs("div",{className:"admin-table-container",children:[t.jsxs("div",{className:"admin-table-header",children:[t.jsxs("h2",{className:"admin-table-title",children:["Ressources ",p&&`- ${Ea(p)}`,d.length>0&&` (${d.length})`]}),t.jsxs("div",{className:"admin-table-actions",children:[t.jsxs("div",{className:"search-input",children:[t.jsx("span",{className:"search-input__icon",children:""}),t.jsx("input",{type:"text",className:"search-input__field",placeholder:"Rechercher...",value:C,onChange:re=>E(re.target.value)})]}),t.jsxs("select",{className:"form-select form-select--sm",value:v,onChange:re=>b(re.target.value),disabled:z||a.length===0,children:[t.jsx("option",{value:"",children:"Tous les chapitres"}),a.map(re=>t.jsxs("option",{value:re.id,children:[re.numero,". ",re.titre]},re.id))]}),t.jsxs("select",{className:"form-select form-select--sm",value:x,onChange:re=>j(re.target.value),children:[t.jsx("option",{value:"",children:"Tous les types"}),Gd.map(re=>t.jsxs("option",{value:re.value,children:[re.icon," ",re.label]},re.value))]}),t.jsxs("select",{className:"form-select form-select--sm",value:_,onChange:re=>w(re.target.value),children:[t.jsx("option",{value:"",children:"Tous"}),t.jsx("option",{value:"premium",children:" Premium"}),t.jsx("option",{value:"free",children:"Gratuit"})]})]})]}),P?t.jsxs("div",{className:"loading-container",style:{padding:"var(--spacing-2xl)"},children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement des ressources..."})]}):p?d.length===0?t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{className:"empty-state__icon",children:""}),t.jsx("h3",{className:"empty-state__title",children:"Aucune ressource"}),t.jsx("p",{className:"empty-state__message",children:C||x||_||v?"Aucune ressource ne correspond aux critres de recherche.":"Cette discipline n'a pas encore de ressources."}),!C&&!x&&!_&&!v&&t.jsx("button",{onClick:se,className:"btn btn--primary",children:"Crer la premire ressource"})]}):t.jsx("div",{className:"resource-list",style:{padding:"var(--spacing-lg)"},children:d.map(re=>{const Fe=Qn(re.type);return t.jsxs("div",{className:"resource-item",children:[t.jsx("div",{className:`resource-item__icon resource-item__icon--${re.type}`,style:{backgroundColor:`${Fe.color}15`,color:Fe.color},children:Fe.icon}),t.jsxs("div",{className:"resource-item__content",children:[t.jsxs("div",{className:"resource-item__title",children:[re.titre,re.isPremium&&t.jsx("span",{className:"badge badge--premium",children:"Premium"}),!re.actif&&t.jsx("span",{className:"badge badge--warning",children:"Inactif"})]}),t.jsxs("div",{className:"resource-item__meta",children:[t.jsx("span",{children:Fe.label}),re.chapitre&&t.jsxs("span",{children:[" ",ml(re.chapitre)]}),re.duree&&t.jsxs("span",{children:[" ",re.duree," min"]}),re.fichierNom&&t.jsxs("span",{children:[" ",re.fichierNom]}),re.tags&&re.tags.length>0&&t.jsxs("span",{children:[" ",re.tags.join(", ")]})]})]}),t.jsxs("div",{className:"resource-item__actions",children:[t.jsx("button",{onClick:()=>ul(re),className:`table-action-btn ${re.isPremium?"table-action-btn--warning":"table-action-btn--view"}`,title:re.isPremium?"Passer en gratuit":"Passer en Premium",children:re.isPremium?"":""}),t.jsx("button",{onClick:()=>dl(re),className:`table-action-btn ${re.actif!==!1?"table-action-btn--view":"table-action-btn--warning"}`,title:re.actif!==!1?"Dsactiver":"Activer",children:re.actif!==!1?"":""}),(re.fichierURL||re.urlExterne)&&t.jsx("button",{onClick:()=>dt(re),className:"table-action-btn table-action-btn--view",title:"Prvisualiser",children:""}),t.jsx("button",{onClick:()=>Oe(re),className:"table-action-btn table-action-btn--edit",title:"Modifier",children:""}),t.jsx("button",{onClick:()=>te(re),className:"table-action-btn table-action-btn--delete",title:"Supprimer",disabled:Y===re.id,children:Y===re.id?"":""})]})]},re.id)})}):t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{className:"empty-state__icon",children:""}),t.jsx("h3",{className:"empty-state__title",children:"Slectionnez une discipline"}),t.jsx("p",{className:"empty-state__message",children:"Choisissez une discipline ci-dessus pour voir ses ressources."})]})]}),Z&&t.jsx("div",{className:"modal-overlay",onClick:W,children:t.jsxs("div",{className:"modal modal--xl",onClick:re=>re.stopPropagation(),children:[t.jsxs("div",{className:"modal__header",children:[t.jsx("h2",{className:"modal__title",children:ve?"Modifier la ressource":"Nouvelle ressource"}),t.jsx("button",{onClick:W,className:"modal__close",children:""})]}),t.jsxs("form",{onSubmit:Tr,children:[t.jsxs("div",{className:"modal__body",children:[!ve&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label form-label--required",children:"Discipline"}),t.jsxs("select",{name:"disciplineId",className:`form-select ${Ke.disciplineId?"form-select--error":""}`,value:Ce.disciplineId,onChange:ie,children:[t.jsx("option",{value:"",children:"Slectionner une discipline"}),r.map(re=>t.jsxs("option",{value:re.id,children:[re.icone," ",re.nom," (",re.classe,")"]},re.id))]}),Ke.disciplineId&&t.jsx("span",{className:"form-error",children:Ke.disciplineId})]}),t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",style:{flex:2},children:[t.jsx("label",{className:"form-label form-label--required",children:"Titre"}),t.jsx("input",{type:"text",name:"titre",className:`form-input ${Ke.titre?"form-input--error":""}`,placeholder:"Ex: Introduction aux fractions",value:Ce.titre,onChange:ie}),Ke.titre&&t.jsx("span",{className:"form-error",children:Ke.titre})]}),t.jsxs("div",{className:"form-group",style:{flex:1},children:[t.jsx("label",{className:"form-label form-label--required",children:"Type"}),t.jsx("select",{name:"type",className:`form-select ${Ke.type?"form-select--error":""}`,value:Ce.type,onChange:ie,children:Gd.map(re=>t.jsxs("option",{value:re.value,children:[re.icon," ",re.label]},re.value))}),Ke.type&&t.jsx("span",{className:"form-error",children:Ke.type})]})]}),t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Chapitre (optionnel)"}),t.jsxs("select",{name:"chapitre",className:"form-select",value:Ce.chapitre||Ce.chapitreId||"",onChange:ie,disabled:z,children:[t.jsx("option",{value:"",children:"Aucun chapitre"}),a.map(re=>t.jsxs("option",{value:re.id,children:[re.numero,". ",re.titre]},re.id))]})]}),t.jsxs("div",{className:"form-group",style:{flex:"0 0 120px"},children:[t.jsx("label",{className:"form-label",children:"Ordre"}),t.jsx("input",{type:"number",name:"ordre",className:"form-input",min:"1",value:Ce.ordre,onChange:ie})]}),t.jsxs("div",{className:"form-group",style:{flex:"0 0 120px"},children:[t.jsx("label",{className:"form-label",children:"Dure (min)"}),t.jsx("input",{type:"number",name:"duree",className:"form-input",min:"0",placeholder:"Ex: 30",value:Ce.duree||"",onChange:ie})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Description"}),t.jsx("textarea",{name:"description",className:"form-textarea",rows:3,placeholder:"Description de la ressource...",value:Ce.description||"",onChange:ie})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{className:"form-label",children:["Fichier",t.jsxs("span",{className:"form-helper",style:{marginLeft:"var(--spacing-sm)"},children:["(",Hd[Ce.type].join(", ")," - max ",Xv," Mo)"]})]}),t.jsxs("div",{className:"file-upload",children:[t.jsx("input",{ref:$r,type:"file",accept:Hd[Ce.type].join(","),onChange:Ne,className:"file-upload__input",id:"file-input"}),!rt&&!mr?t.jsxs("label",{htmlFor:"file-input",className:"file-upload__dropzone",children:[t.jsx("div",{className:"file-upload__icon",children:""}),t.jsx("p",{className:"file-upload__text",children:"Cliquez ou glissez un fichier ici"}),t.jsx("p",{className:"file-upload__hint",children:Hd[Ce.type].join(", ")})]}):t.jsxs("div",{className:"file-upload__preview",children:[rt?.type.startsWith("image/")&&mr&&t.jsx("img",{src:mr,alt:"Aperu",className:"file-preview__image"}),rt?.type.startsWith("video/")&&mr&&t.jsx("video",{src:mr,controls:!0,className:"file-preview__video"}),!rt?.type.startsWith("image/")&&!rt?.type.startsWith("video/")&&t.jsx("div",{className:"file-preview__document",children:t.jsx("span",{className:"file-preview__icon",children:Qn(Ce.type).icon})}),t.jsxs("div",{className:"file-preview__info",children:[t.jsx("p",{className:"file-preview__name",children:rt?.name||ve?.fichierNom}),rt&&t.jsx("p",{className:"file-preview__size",children:kp(rt.size)})]}),t.jsx("button",{type:"button",onClick:We,className:"file-preview__remove",children:""})]})]}),Ke.fichier&&t.jsx("span",{className:"form-error",children:Ke.fichier}),K&&t.jsxs("div",{className:"upload-progress",children:[t.jsx("div",{className:"upload-progress__bar",style:{width:`${X}%`}}),t.jsxs("span",{className:"upload-progress__text",children:[X,"%"]})]})]}),Ce.type==="video"&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"URL externe (YouTube, Vimeo...)"}),t.jsx("input",{type:"url",name:"urlExterne",className:"form-input",placeholder:"https://www.youtube.com/watch?v=...",value:Ce.urlExterne||"",onChange:ie}),t.jsx("span",{className:"form-helper",children:"Alternative  l'upload de fichier"})]}),Ce.type==="cours"&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Contenu du cours"}),t.jsx("textarea",{name:"contenu",className:"form-textarea",rows:6,placeholder:"Saisissez le contenu du cours ici...",value:Ce.contenu||"",onChange:ie}),t.jsx("span",{className:"form-helper",children:"Optionnel si vous uploadez un fichier"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Tags"}),t.jsxs("div",{className:"tags-input",children:[t.jsx("input",{type:"text",className:"form-input",placeholder:"Ajouter un tag...",value:he,onChange:re=>Pe(re.target.value),onKeyPress:re=>re.key==="Enter"&&(re.preventDefault(),Dt())}),t.jsx("button",{type:"button",onClick:Dt,className:"btn btn--outline btn--sm",children:"Ajouter"})]}),Ce.tags&&Ce.tags.length>0&&t.jsx("div",{className:"tags-list",children:Ce.tags.map((re,Fe)=>t.jsxs("span",{className:"tag",children:[re,t.jsx("button",{type:"button",onClick:()=>Kr(Fe),className:"tag__remove",children:""})]},Fe))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Options"}),t.jsxs("div",{className:"form-options",children:[t.jsxs("label",{className:"form-checkbox",children:[t.jsx("input",{type:"checkbox",name:"isPremium",checked:Ce.isPremium,onChange:ie}),t.jsx("span",{children:"Contenu Premium "})]}),t.jsxs("label",{className:"form-checkbox",children:[t.jsx("input",{type:"checkbox",name:"actif",checked:Ce.actif!==!1,onChange:ie}),t.jsx("span",{children:"Ressource active"})]})]})]})]}),t.jsxs("div",{className:"modal__footer",children:[t.jsx("button",{type:"button",onClick:W,className:"btn btn--outline",disabled:$||K,children:"Annuler"}),t.jsx("button",{type:"submit",className:"btn btn--primary",disabled:$||K,children:$||K?K?`Upload ${X}%...`:"Enregistrement...":ve?"Mettre  jour":"Crer la ressource"})]})]})]})}),fe&&R&&t.jsx("div",{className:"modal-overlay",onClick:W,children:t.jsxs("div",{className:"modal modal--xl",onClick:re=>re.stopPropagation(),children:[t.jsxs("div",{className:"modal__header",children:[t.jsxs("h2",{className:"modal__title",children:[Qn(R.type).icon," ",R.titre]}),t.jsx("button",{onClick:W,className:"modal__close",children:""})]}),t.jsxs("div",{className:"modal__body",children:[R.type==="video"&&R.urlExterne?t.jsx("div",{className:"preview-video",children:t.jsx("iframe",{src:R.urlExterne.replace("watch?v=","embed/"),title:R.titre,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}):R.fichierURL?t.jsx("div",{className:"preview-file",children:R.fichierURL.match(/\.(jpg|jpeg|png|gif|webp)$/i)?t.jsx("img",{src:R.fichierURL,alt:R.titre}):R.fichierURL.match(/\.(mp4|webm)$/i)?t.jsx("video",{src:R.fichierURL,controls:!0}):R.fichierURL.match(/\.pdf$/i)?t.jsx("iframe",{src:R.fichierURL,title:R.titre}):t.jsxs("div",{className:"preview-download",children:[t.jsx("span",{className:"preview-download__icon",children:Qn(R.type).icon}),t.jsx("p",{children:R.fichierNom}),t.jsx("a",{href:R.fichierURL,target:"_blank",rel:"noopener noreferrer",className:"btn btn--primary",children:"Tlcharger"})]})}):R.contenu?t.jsx("div",{className:"preview-content",children:t.jsx("p",{children:R.contenu})}):t.jsx("div",{className:"preview-empty",children:t.jsx("p",{children:"Aucun contenu  prvisualiser"})}),t.jsxs("div",{className:"preview-info",children:[R.description&&t.jsx("p",{className:"preview-description",children:R.description}),t.jsxs("div",{className:"preview-meta",children:[t.jsxs("span",{children:["Type : ",Qn(R.type).label]}),R.duree&&t.jsxs("span",{children:["Dure : ",R.duree," min"]}),R.isPremium&&t.jsx("span",{className:"badge badge--premium",children:"Premium"})]})]})]})]})}),ce&&de&&t.jsx("div",{className:"modal-overlay",onClick:W,children:t.jsxs("div",{className:"modal",onClick:re=>re.stopPropagation(),children:[t.jsxs("div",{className:"modal__header",children:[t.jsx("h2",{className:"modal__title",children:"Confirmer la suppression"}),t.jsx("button",{onClick:W,className:"modal__close",children:""})]}),t.jsxs("div",{className:"modal__body",children:[t.jsxs("p",{children:["Supprimer la ressource ",t.jsx("strong",{children:de.titre})," ?"]}),de.fichierURL&&t.jsxs("div",{className:"alert alert--warning",style:{marginTop:"var(--spacing-md)"},children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:"Le fichier associ sera galement supprim de faon permanente."})})]})]}),t.jsxs("div",{className:"modal__footer",children:[t.jsx("button",{onClick:W,className:"btn btn--outline",children:"Annuler"}),t.jsx("button",{onClick:la,className:"btn btn--danger",disabled:Y!==null,children:Y?"Suppression...":"Supprimer"})]})]})}),t.jsx("style",{children:`
        /* ==================== SLECTEUR DE DISCIPLINE ==================== */
        
        .discipline-tabs {
          display: flex;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
          margin-top: var(--spacing-md);
        }

        .discipline-tab {
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          padding: var(--spacing-sm) var(--spacing-md);
          border: 2px solid var(--color-border);
          border-radius: var(--radius-lg);
          background: white;
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .discipline-tab:hover {
          border-color: var(--discipline-color, var(--color-primary));
        }

        .discipline-tab--active {
          border-color: var(--discipline-color, var(--color-primary));
          background: color-mix(in srgb, var(--discipline-color, var(--color-primary)) 10%, white);
        }

        .discipline-tab__icon {
          font-size: var(--text-lg);
        }

        .discipline-tab__name {
          font-weight: var(--font-medium);
        }

        .discipline-tab__class {
          font-size: var(--text-xs);
          color: var(--color-text-light);
          background: var(--color-bg-secondary);
          padding: 2px 6px;
          border-radius: var(--radius-sm);
        }

        /* ==================== FORMULAIRE ==================== */
        
        .form-row {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
          gap: var(--spacing-lg);
        }

        .form-options {
          display: flex;
          flex-wrap: wrap;
          gap: var(--spacing-lg);
          margin-top: var(--spacing-sm);
        }

        .form-select--sm {
          padding: var(--spacing-sm) var(--spacing-md);
          font-size: var(--text-sm);
          min-width: 140px;
        }

        /* ==================== UPLOAD DE FICHIER ==================== */
        
        .file-upload {
          position: relative;
        }

        .file-upload__input {
          position: absolute;
          opacity: 0;
          pointer-events: none;
        }

        .file-upload__dropzone {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: var(--spacing-xl);
          border: 2px dashed var(--color-border);
          border-radius: var(--radius-lg);
          background: var(--color-bg-secondary);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .file-upload__dropzone:hover {
          border-color: var(--color-primary);
          background: rgba(37, 99, 235, 0.05);
        }

        .file-upload__icon {
          font-size: 48px;
          margin-bottom: var(--spacing-md);
        }

        .file-upload__text {
          font-weight: var(--font-medium);
          margin-bottom: var(--spacing-xs);
        }

        .file-upload__hint {
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        .file-upload__preview {
          display: flex;
          align-items: center;
          gap: var(--spacing-lg);
          padding: var(--spacing-md);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-lg);
          background: var(--color-bg-secondary);
        }

        .file-preview__image,
        .file-preview__video {
          width: 120px;
          height: 80px;
          object-fit: cover;
          border-radius: var(--radius-md);
        }

        .file-preview__document {
          width: 80px;
          height: 80px;
          background: white;
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .file-preview__icon {
          font-size: 32px;
        }

        .file-preview__info {
          flex: 1;
        }

        .file-preview__name {
          font-weight: var(--font-medium);
          margin-bottom: var(--spacing-xs);
          word-break: break-all;
        }

        .file-preview__size {
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        .file-preview__remove {
          width: 32px;
          height: 32px;
          border: none;
          background: var(--color-error);
          color: white;
          border-radius: 50%;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all var(--transition-base);
        }

        .file-preview__remove:hover {
          background: #dc2626;
          transform: scale(1.1);
        }

        /* ==================== BARRE DE PROGRESSION ==================== */
        
        .upload-progress {
          margin-top: var(--spacing-md);
          height: 8px;
          background: var(--color-bg-tertiary);
          border-radius: var(--radius-full);
          overflow: hidden;
          position: relative;
        }

        .upload-progress__bar {
          height: 100%;
          background: linear-gradient(90deg, var(--color-primary), var(--color-secondary));
          border-radius: var(--radius-full);
          transition: width var(--transition-base);
        }

        .upload-progress__text {
          position: absolute;
          right: var(--spacing-sm);
          top: 50%;
          transform: translateY(-50%);
          font-size: var(--text-xs);
          font-weight: var(--font-semibold);
          color: var(--color-text);
        }

        /* ==================== TAGS ==================== */
        
        .tags-input {
          display: flex;
          gap: var(--spacing-sm);
        }

        .tags-list {
          display: flex;
          flex-wrap: wrap;
          gap: var(--spacing-sm);
          margin-top: var(--spacing-md);
        }

        .tag {
          display: inline-flex;
          align-items: center;
          gap: var(--spacing-xs);
          padding: var(--spacing-xs) var(--spacing-sm);
          background: var(--color-bg-tertiary);
          border-radius: var(--radius-full);
          font-size: var(--text-sm);
          color: var(--color-text);
        }

        .tag__remove {
          width: 18px;
          height: 18px;
          border: none;
          background: transparent;
          color: var(--color-text-light);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          border-radius: 50%;
          transition: all var(--transition-base);
        }

        .tag__remove:hover {
          background: var(--color-error);
          color: white;
        }

        /* ==================== PRVISUALISATION ==================== */
        
        .preview-video {
          position: relative;
          padding-bottom: 56.25%;
          height: 0;
          overflow: hidden;
          border-radius: var(--radius-lg);
        }

        .preview-video iframe {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          border: none;
        }

        .preview-file {
          text-align: center;
        }

        .preview-file img,
        .preview-file video {
          max-width: 100%;
          max-height: 60vh;
          border-radius: var(--radius-lg);
        }

        .preview-file iframe {
          width: 100%;
          height: 60vh;
          border: none;
          border-radius: var(--radius-lg);
        }

        .preview-download {
          padding: var(--spacing-2xl);
          text-align: center;
        }

        .preview-download__icon {
          font-size: 64px;
          display: block;
          margin-bottom: var(--spacing-lg);
        }

        .preview-content {
          padding: var(--spacing-lg);
          background: var(--color-bg-secondary);
          border-radius: var(--radius-lg);
          white-space: pre-wrap;
        }

        .preview-empty {
          padding: var(--spacing-2xl);
          text-align: center;
          color: var(--color-text-light);
        }

        .preview-info {
          margin-top: var(--spacing-lg);
          padding-top: var(--spacing-lg);
          border-top: 1px solid var(--color-border);
        }

        .preview-description {
          color: var(--color-text-light);
          margin-bottom: var(--spacing-md);
        }

        .preview-meta {
          display: flex;
          flex-wrap: wrap;
          gap: var(--spacing-lg);
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        /* ==================== RESSOURCES - AFFICHAGE CARTE ==================== */
        
        .resource-item__title {
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
        }

        /* ==================== ACTION WARNING ==================== */
        
        .table-action-btn--warning {
          color: var(--color-warning);
        }

        /* ==================== RESPONSIVE ==================== */
        
        @media (max-width: 768px) {
          .form-row {
            grid-template-columns: 1fr;
          }

          .admin-table-actions {
            flex-direction: column;
            align-items: stretch;
          }

          .search-input__field {
            width: 100%;
          }

          .file-upload__preview {
            flex-direction: column;
            text-align: center;
          }

          .preview-meta {
            flex-direction: column;
            gap: var(--spacing-sm);
          }
        }
      `})]})},WA=_e(V,"quizzes"),XA=async e=>{try{let r=ze(WA,Qe("titre","asc"));e?.disciplineId;let a=(await Ae(r)).docs.map(l=>({id:l.id,...l.data()}));return e?.isPremium,e?.difficulte,a}catch(r){throw console.error("Erreur lors de la rcupration des quiz :",r),r}},vR=async e=>{try{const r=await pt(je(V,"quizzes",e));return r.exists()?{id:r.id,...r.data()}:null}catch(r){throw console.error("Erreur lors de la rcupration du quiz :",r),r}},gR=async e=>{try{return(await Ot(WA,{...e,createdAt:Ee.now(),updatedAt:Ee.now()})).id}catch(r){throw console.error("Erreur lors de la cration du quiz :",r),r}},xR=async(e,r)=>{try{await Ve(je(V,"quizzes",e),{...r,updatedAt:Ee.now()})}catch(n){throw console.error("Erreur lors de la mise  jour du quiz :",n),n}},bR=async e=>{try{await Ir(je(V,"quizzes",e))}catch(r){throw console.error("Erreur lors de la suppression du quiz :",r),r}},yR=()=>`q_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,eS=()=>({id:yR(),question:"",options:["","","",""],reponseCorrecte:0,explication:"",difficulte:"moyen",points:1}),tS=e=>{const r=e.questions||[],n=r.reduce((l,o)=>l+(o.points||1),0),a={facile:r.filter(l=>l.difficulte==="facile").length,moyen:r.filter(l=>l.difficulte==="moyen").length,difficile:r.filter(l=>l.difficulte==="difficile").length};return{nombreQuestions:r.length,totalPoints:n,parDifficulte:a,duree:e.duree||0}},jR=()=>{const[e,r]=g.useState([]),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[m,p]=g.useState(null),[h,v]=g.useState(""),[b,x]=g.useState(""),[j,_]=g.useState(""),[w,C]=g.useState(""),[E,S]=g.useState(!1),[A,z]=g.useState("list"),[k,P]=g.useState(null),[D,$]=g.useState({disciplineId:"",titre:"",questions:[],duree:15,isPremium:!1,noteMinimale:50}),[F,Y]=g.useState(null),[M,K]=g.useState(!1),[ee,X]=g.useState(null),[L,I]=g.useState(null),[U,B]=g.useState({}),[T,Z]=g.useState(!1),H=g.useCallback(async()=>{o(!0),d(null);try{const[he,Pe]=await Promise.all([XA(),ls.getAll()]);r(he),a(Pe.map(Ie=>({id:Ie.id,nom:Ie.nom||Ie.name||Ie.id})))}catch(he){d("Erreur lors du chargement des donnes."),console.error(he)}finally{o(!1)}},[]);g.useEffect(()=>{H()},[H]),g.useEffect(()=>{if(m){const he=setTimeout(()=>p(null),4e3);return()=>clearTimeout(he)}},[m]);const ce=e.filter(he=>{if(h){const Pe=h.toLowerCase();if(!he.titre.toLowerCase().includes(Pe))return!1}return!(b&&he.disciplineId!==b||j==="true"&&!he.isPremium||j==="false"&&he.isPremium||w&&!he.questions?.some(Ie=>Ie.difficulte===w))}),xe=()=>{P(null),$({disciplineId:"",titre:"",questions:[eS()],duree:15,isPremium:!1,noteMinimale:50}),Y(null),z("form")},fe=he=>{P(he),$({disciplineId:he.disciplineId,titre:he.titre,questions:he.questions||[],duree:he.duree||15,isPremium:he.isPremium||!1,noteMinimale:he.noteMinimale||50}),Y(null),z("form")},G=async()=>{if(!D.titre.trim()){d("Le titre du quiz est obligatoire.");return}if(!D.disciplineId){d("Veuillez slectionner une discipline.");return}if(D.questions.length===0){d("Le quiz doit contenir au moins une question.");return}for(let he=0;he<D.questions.length;he++){const Pe=D.questions[he];if(!Pe.question.trim()){d(`La question ${he+1} n'a pas d'nonc.`);return}if(Pe.options.filter(Ye=>!Ye.trim()).length>0){d(`La question ${he+1} a des options vides.`);return}}K(!0),d(null);try{k?(await xR(k.id,D),p("Quiz mis  jour avec succs !")):(await gR(D),p("Quiz cr avec succs !")),await H(),z("list")}catch(he){d("Erreur lors de la sauvegarde du quiz."),console.error(he)}finally{K(!1)}},ve=async he=>{try{await bR(he),p("Quiz supprim avec succs."),X(null),await H()}catch(Pe){d("Erreur lors de la suppression du quiz."),console.error(Pe)}},De=()=>{const he=eS();$(Pe=>({...Pe,questions:[...Pe.questions,he]})),Y(he.id)},de=he=>{const Pe=D.questions.find(qt=>qt.id===he);if(!Pe)return;const Ie={...Pe,id:`q_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,question:`${Pe.question} (copie)`},Ye=D.questions.findIndex(qt=>qt.id===he),nt=[...D.questions];nt.splice(Ye+1,0,Ie),$(qt=>({...qt,questions:nt})),Y(Ie.id)},we=he=>{$(Pe=>({...Pe,questions:Pe.questions.filter(Ie=>Ie.id!==he)})),F===he&&Y(null)},R=(he,Pe,Ie)=>{$(Ye=>({...Ye,questions:Ye.questions.map(nt=>nt.id===he?{...nt,[Pe]:Ie}:nt)}))},ae=(he,Pe,Ie)=>{$(Ye=>({...Ye,questions:Ye.questions.map(nt=>nt.id===he?{...nt,options:nt.options.map((qt,Kt)=>Kt===Pe?Ie:qt)}:nt)}))},Ce=he=>{I(he),B({}),Z(!1),z("preview")},ke=(he,Pe)=>{T||B(Ie=>({...Ie,[he]:Pe}))},Ke=()=>{Z(!0)},et=he=>n.find(Pe=>Pe.id===he)?.nom||he,rt=({level:he})=>{const Pe={facile:"quiz-badge-facile",moyen:"quiz-badge-moyen",difficile:"quiz-badge-difficile"};return t.jsx("span",{className:`quiz-badge ${Pe[he]||"quiz-badge-moyen"}`,children:he.charAt(0).toUpperCase()+he.slice(1)})},Yt=()=>t.jsxs(t.Fragment,{children:[u&&t.jsxs("div",{className:"admin-message admin-message-error",children:[t.jsx(_m,{size:18}),t.jsx("span",{children:u}),t.jsx("button",{onClick:()=>d(null),className:"admin-message-close",children:t.jsx(Xi,{size:16})})]}),m&&t.jsxs("div",{className:"admin-message admin-message-success",children:[t.jsx(Ht,{size:18}),t.jsx("span",{children:m})]})]}),mr=()=>t.jsxs("div",{className:"quiz-manager",children:[t.jsxs("div",{className:"admin-header",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"admin-title",children:[t.jsx(xn,{size:24})," Gestion des Quiz"]}),t.jsxs("p",{className:"admin-subtitle",children:[e.length," quiz au total  ",ce.length," affich(s)"]})]}),t.jsxs("button",{className:"admin-btn admin-btn-primary",onClick:xe,children:[t.jsx(Rc,{size:18})," Nouveau Quiz"]})]}),t.jsxs("div",{className:"admin-toolbar",children:[t.jsxs("div",{className:"admin-search-wrapper",children:[t.jsx(kA,{size:18,className:"admin-search-icon"}),t.jsx("input",{type:"text",className:"admin-search-input",placeholder:"Rechercher un quiz...",value:h,onChange:he=>v(he.target.value)})]}),t.jsxs("button",{className:`admin-btn admin-btn-outline ${E?"active":""}`,onClick:()=>S(!E),children:[t.jsx(Yb,{size:16})," Filtres",E?t.jsx(Tx,{size:14}):t.jsx(jm,{size:14})]})]}),E&&t.jsxs("div",{className:"admin-filters-panel",children:[t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Discipline"}),t.jsxs("select",{className:"admin-select",value:b,onChange:he=>x(he.target.value),children:[t.jsx("option",{value:"",children:"Toutes les disciplines"}),n.map(he=>t.jsx("option",{value:he.id,children:he.nom},he.id))]})]}),t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Accs"}),t.jsxs("select",{className:"admin-select",value:j,onChange:he=>_(he.target.value),children:[t.jsx("option",{value:"",children:"Tous"}),t.jsx("option",{value:"false",children:"Gratuit"}),t.jsx("option",{value:"true",children:"Premium"})]})]}),t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Difficult"}),t.jsxs("select",{className:"admin-select",value:w,onChange:he=>C(he.target.value),children:[t.jsx("option",{value:"",children:"Toutes"}),t.jsx("option",{value:"facile",children:"Facile"}),t.jsx("option",{value:"moyen",children:"Moyen"}),t.jsx("option",{value:"difficile",children:"Difficile"})]})]}),t.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{x(""),_(""),C(""),v("")},children:"Rinitialiser"})]}),l?t.jsxs("div",{className:"admin-loading",children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement des quiz..."})]}):ce.length===0?t.jsxs("div",{className:"admin-empty-state",children:[t.jsx(fm,{size:48}),t.jsx("h3",{children:"Aucun quiz trouv"}),t.jsx("p",{children:e.length===0?"Crez votre premier quiz pour vos lves.":"Aucun quiz ne correspond  vos filtres."}),e.length===0&&t.jsxs("button",{className:"admin-btn admin-btn-primary",onClick:xe,children:[t.jsx(Rc,{size:18})," Crer un quiz"]})]}):t.jsx("div",{className:"quiz-grid",children:ce.map(he=>{const Pe=tS(he);return t.jsxs("div",{className:"quiz-card",children:[t.jsxs("div",{className:"quiz-card-header",children:[t.jsxs("div",{className:"quiz-card-title-row",children:[t.jsx("h3",{className:"quiz-card-title",children:he.titre}),he.isPremium&&t.jsxs("span",{className:"quiz-badge quiz-badge-premium",children:[t.jsx(jr,{size:12})," Premium"]})]}),t.jsx("span",{className:"quiz-card-discipline",children:et(he.disciplineId)})]}),t.jsxs("div",{className:"quiz-card-stats",children:[t.jsxs("div",{className:"quiz-stat",children:[t.jsx(fm,{size:14}),t.jsxs("span",{children:[Pe.nombreQuestions," question(s)"]})]}),t.jsxs("div",{className:"quiz-stat",children:[t.jsx(ns,{size:14}),t.jsxs("span",{children:[Pe.totalPoints," pts"]})]}),t.jsxs("div",{className:"quiz-stat",children:[t.jsx(po,{size:14}),t.jsxs("span",{children:[Pe.duree," min"]})]})]}),t.jsxs("div",{className:"quiz-card-difficulty",children:[Pe.parDifficulte.facile>0&&t.jsx(rt,{level:"facile"}),Pe.parDifficulte.moyen>0&&t.jsx(rt,{level:"moyen"}),Pe.parDifficulte.difficile>0&&t.jsx(rt,{level:"difficile"})]}),t.jsxs("div",{className:"quiz-card-actions",children:[t.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>Ce(he),title:"Prvisualiser",children:[t.jsx(co,{size:14})," Aperu"]}),t.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>fe(he),title:"Modifier",children:[t.jsx(q3,{size:14})," Modifier"]}),ee===he.id?t.jsxs("div",{className:"quiz-delete-confirm",children:[t.jsx("button",{className:"admin-btn admin-btn-sm admin-btn-danger",onClick:()=>ve(he.id),children:"Confirmer"}),t.jsx("button",{className:"admin-btn admin-btn-sm admin-btn-ghost",onClick:()=>X(null),children:"Annuler"})]}):t.jsx("button",{className:"admin-btn admin-btn-sm admin-btn-danger-outline",onClick:()=>X(he.id),title:"Supprimer",children:t.jsx(M1,{size:14})})]})]},he.id)})})]}),fr=()=>t.jsxs("div",{className:"quiz-manager",children:[t.jsxs("div",{className:"admin-header",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"admin-title",children:[t.jsx(xn,{size:24}),k?"Modifier le quiz":"Nouveau quiz"]}),t.jsxs("p",{className:"admin-subtitle",children:[D.questions.length," question(s) ajoute(s)"]})]}),t.jsxs("div",{className:"admin-header-actions",children:[t.jsxs("button",{className:"admin-btn admin-btn-ghost",onClick:()=>z("list"),children:[t.jsx(Xi,{size:18})," Annuler"]}),t.jsxs("button",{className:"admin-btn admin-btn-primary",onClick:G,disabled:M,children:[t.jsx(R3,{size:18})," ",M?"Enregistrement...":"Enregistrer"]})]})]}),t.jsxs("div",{className:"admin-card quiz-form-section",children:[t.jsx("h3",{className:"quiz-form-section-title",children:"Informations gnrales"}),t.jsxs("div",{className:"quiz-form-grid",children:[t.jsxs("div",{className:"admin-form-group quiz-form-full",children:[t.jsx("label",{className:"admin-label",children:"Titre du quiz *"}),t.jsx("input",{type:"text",className:"admin-input",placeholder:"Ex : Quiz - Les Misrables, Chapitre 1",value:D.titre,onChange:he=>$(Pe=>({...Pe,titre:he.target.value}))})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Discipline *"}),t.jsxs("select",{className:"admin-select",value:D.disciplineId,onChange:he=>$(Pe=>({...Pe,disciplineId:he.target.value})),children:[t.jsx("option",{value:"",children:"-- Slectionner --"}),n.map(he=>t.jsx("option",{value:he.id,children:he.nom},he.id))]})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Dure (minutes)"}),t.jsx("input",{type:"number",className:"admin-input",min:1,max:180,value:D.duree,onChange:he=>$(Pe=>({...Pe,duree:parseInt(he.target.value)||15}))})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Note minimale (%)"}),t.jsx("input",{type:"number",className:"admin-input",min:0,max:100,value:D.noteMinimale,onChange:he=>$(Pe=>({...Pe,noteMinimale:parseInt(he.target.value)||50}))})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Accs"}),t.jsxs("div",{className:`quiz-toggle ${D.isPremium?"quiz-toggle-active":""}`,onClick:()=>$(he=>({...he,isPremium:!he.isPremium})),children:[t.jsx(jr,{size:16}),t.jsx("span",{children:D.isPremium?"Premium (2 000 FCFA/mois)":"Gratuit"})]})]})]})]}),t.jsxs("div",{className:"admin-card quiz-form-section",children:[t.jsxs("div",{className:"quiz-questions-header",children:[t.jsxs("h3",{className:"quiz-form-section-title",children:["Questions (",D.questions.length,")"]}),t.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-primary",onClick:De,children:[t.jsx(Rc,{size:14})," Ajouter une question"]})]}),D.questions.length===0?t.jsxs("div",{className:"admin-empty-state",style:{padding:"2rem"},children:[t.jsx(fm,{size:36}),t.jsx("p",{children:'Aucune question. Cliquez sur "Ajouter une question" pour commencer.'})]}):t.jsx("div",{className:"quiz-questions-list",children:D.questions.map((he,Pe)=>t.jsxs("div",{className:`quiz-question-item ${F===he.id?"expanded":""}`,children:[t.jsxs("div",{className:"quiz-question-header",onClick:()=>Y(F===he.id?null:he.id),children:[t.jsxs("div",{className:"quiz-question-header-left",children:[t.jsx(I3,{size:16,className:"quiz-grip-icon"}),t.jsxs("span",{className:"quiz-question-number",children:["Q",Pe+1]}),t.jsx("span",{className:"quiz-question-preview",children:he.question||"Question sans nonc..."})]}),t.jsxs("div",{className:"quiz-question-header-right",children:[t.jsx(rt,{level:he.difficulte||"moyen"}),t.jsxs("span",{className:"quiz-question-points",children:[he.points," pt(s)"]}),F===he.id?t.jsx(Tx,{size:16}):t.jsx(jm,{size:16})]})]}),F===he.id&&t.jsxs("div",{className:"quiz-question-body",children:[t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"nonc de la question *"}),t.jsx("textarea",{className:"admin-textarea",rows:2,placeholder:"Ex : Quel est le personnage principal du roman ?",value:he.question,onChange:Ie=>R(he.id,"question",Ie.target.value)})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Options de rponse (cliquez sur la bonne rponse)"}),t.jsx("div",{className:"quiz-options-grid",children:he.options.map((Ie,Ye)=>t.jsxs("div",{className:`quiz-option-item ${he.reponseCorrecte===Ye?"quiz-option-correct":""}`,children:[t.jsx("button",{type:"button",className:`quiz-option-radio ${he.reponseCorrecte===Ye?"active":""}`,onClick:()=>R(he.id,"reponseCorrecte",Ye),title:he.reponseCorrecte===Ye?"Bonne rponse":"Marquer comme bonne rponse",children:he.reponseCorrecte===Ye?t.jsx(Ht,{size:16}):t.jsx("span",{className:"quiz-option-letter",children:String.fromCharCode(65+Ye)})}),t.jsx("input",{type:"text",className:"admin-input",placeholder:`Option ${String.fromCharCode(65+Ye)}`,value:Ie,onChange:nt=>ae(he.id,Ye,nt.target.value)})]},Ye))})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Explication (affiche aprs rponse)"}),t.jsx("textarea",{className:"admin-textarea",rows:2,placeholder:"Ex : Jean Valjean est le protagoniste du roman de Victor Hugo...",value:he.explication,onChange:Ie=>R(he.id,"explication",Ie.target.value)})]}),t.jsxs("div",{className:"quiz-question-meta",children:[t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Difficult"}),t.jsxs("select",{className:"admin-select",value:he.difficulte,onChange:Ie=>R(he.id,"difficulte",Ie.target.value),children:[t.jsx("option",{value:"facile",children:"Facile"}),t.jsx("option",{value:"moyen",children:"Moyen"}),t.jsx("option",{value:"difficile",children:"Difficile"})]})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Points"}),t.jsx("input",{type:"number",className:"admin-input",min:1,max:10,value:he.points,onChange:Ie=>R(he.id,"points",parseInt(Ie.target.value)||1)})]})]}),t.jsxs("div",{className:"quiz-question-actions",children:[t.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>de(he.id),children:[t.jsx(L3,{size:14})," Dupliquer"]}),t.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-danger-outline",onClick:()=>we(he.id),children:[t.jsx(M1,{size:14})," Supprimer"]})]})]})]},he.id))}),D.questions.length>0&&t.jsx("div",{className:"quiz-add-question-bottom",children:t.jsxs("button",{className:"admin-btn admin-btn-outline",onClick:De,children:[t.jsx(Rc,{size:16})," Ajouter une question"]})})]})]}),$r=()=>{if(!L)return null;const he=tS(L);let Pe=0,Ie=0;return T&&L.questions.forEach(Ye=>{Ie+=Ye.points||1,U[Ye.id]===Ye.reponseCorrecte&&(Pe+=Ye.points||1)}),t.jsxs("div",{className:"quiz-manager",children:[t.jsxs("div",{className:"admin-header",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"admin-title",children:[t.jsx(co,{size:24})," Prvisualisation : ",L.titre]}),t.jsxs("p",{className:"admin-subtitle",children:[et(L.disciplineId),"  ",he.nombreQuestions," questions  ",he.duree," min"]})]}),t.jsxs("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{z("list"),I(null)},children:[t.jsx(Xi,{size:18})," Fermer"]})]}),T&&t.jsxs("div",{className:`quiz-preview-score ${Pe/Ie>=(L.noteMinimale||50)/100?"success":"fail"}`,children:[t.jsx(ns,{size:32}),t.jsxs("div",{children:[t.jsxs("h3",{children:["Score : ",Pe,"/",Ie," (",Math.round(Pe/Ie*100),"%)"]}),t.jsxs("p",{children:["Note minimale : ",L.noteMinimale||50,"% "," ",Pe/Ie>=(L.noteMinimale||50)/100?" Russi !":" Non russi"]})]})]}),t.jsx("div",{className:"quiz-preview-questions",children:L.questions.map((Ye,nt)=>{const qt=U[Ye.id],Kt=qt===Ye.reponseCorrecte;return t.jsxs("div",{className:"admin-card quiz-preview-question",children:[t.jsxs("div",{className:"quiz-preview-question-header",children:[t.jsxs("span",{className:"quiz-question-number",children:["Q",nt+1]}),t.jsx(rt,{level:Ye.difficulte||"moyen"}),t.jsxs("span",{className:"quiz-question-points",children:[Ye.points," pt(s)"]})]}),t.jsx("p",{className:"quiz-preview-question-text",children:Ye.question}),t.jsx("div",{className:"quiz-preview-options",children:Ye.options.map((se,Oe)=>{let dt="quiz-preview-option";return T?Oe===Ye.reponseCorrecte?dt+=" correct":Oe===qt&&!Kt&&(dt+=" incorrect"):qt===Oe&&(dt+=" selected"),t.jsxs("button",{className:dt,onClick:()=>ke(Ye.id,Oe),disabled:T,children:[t.jsx("span",{className:"quiz-preview-option-letter",children:String.fromCharCode(65+Oe)}),t.jsx("span",{children:se}),T&&Oe===Ye.reponseCorrecte&&t.jsx(Ht,{size:16,className:"quiz-preview-check"})]},Oe)})}),T&&Ye.explication&&t.jsxs("div",{className:"quiz-preview-explication",children:[t.jsx("strong",{children:"Explication :"})," ",Ye.explication]})]},Ye.id)})}),!T&&t.jsx("div",{className:"quiz-preview-submit",children:t.jsxs("button",{className:"admin-btn admin-btn-primary admin-btn-lg",onClick:Ke,disabled:Object.keys(U).length<L.questions.length,children:[t.jsx(Ht,{size:18})," Soumettre (",Object.keys(U).length,"/",L.questions.length,")"]})})]})};return t.jsxs("div",{className:"admin-container",children:[Yt(),A==="list"&&mr(),A==="form"&&fr(),A==="preview"&&$r()]})},ZA=_e(V,"users"),_R=_e(V,"quizResults"),NR=async e=>{try{let r=ze(ZA,Qe("displayName","asc"));e?.role;let a=(await Ae(r)).docs.map(l=>({uid:l.id,...l.data()}));return e?.isPremium,e?.isActive,e?.search,a}catch(r){throw console.error("Erreur lors de la rcupration des utilisateurs :",r),r}},SR=async(e,r)=>{try{await Ve(je(V,"users",e),{role:r,updatedAt:Ee.now()})}catch(n){throw console.error("Erreur lors de la mise  jour du rle :",n),n}},wR=async(e,r)=>{try{const n={isPremium:r,updatedAt:Ee.now()};if(r){const a=new Date;a.setDate(a.getDate()+30),n.subscriptionEnd=Ee.fromDate(a)}else n.subscriptionEnd=null;await Ve(je(V,"users",e),n)}catch(n){throw console.error("Erreur lors de la mise  jour du statut Premium :",n),n}},CR=async(e,r)=>{try{await Ve(je(V,"users",e),{isActive:r,updatedAt:Ee.now()})}catch(n){throw console.error("Erreur lors du changement de statut du compte :",n),n}},ER=async e=>{try{const r=ze(_R,Se("userId","==",e)),a=(await Ae(r)).docs.map(m=>({id:m.id,...m.data()})),l=a.length,o=a.filter(m=>m.reussi).length,u=l>0?Math.round(a.reduce((m,p)=>m+p.score,0)/l):0,d=a.length>0?new Date(Math.max(...a.map(m=>{const p=m.datePassage;return p?.toDate?p.toDate().getTime():new Date(p).getTime()}))):null;return{totalQuizPasses:l,scoresMoyens:u,quizReussis:o,dernierQuiz:d}}catch(r){return console.error("Erreur lors du calcul des statistiques :",r),{totalQuizPasses:0,scoresMoyens:0,quizReussis:0,dernierQuiz:null}}},AR=async()=>{try{const r=(await Ae(ZA)).docs.map(n=>n.data());return{total:r.length,admins:r.filter(n=>n.role==="admin").length,profs:r.filter(n=>n.role==="prof").length,eleves:r.filter(n=>n.role==="eleve").length,premium:r.filter(n=>n.isPremium).length,actifs:r.filter(n=>n.isActive!==!1).length}}catch(e){throw console.error("Erreur lors du calcul des stats globales :",e),e}},zR=()=>{const[e,r]=g.useState([]),[n,a]=g.useState(null),[l,o]=g.useState(!0),[u,d]=g.useState(null),[m,p]=g.useState(null),[h,v]=g.useState(""),[b,x]=g.useState(""),[j,_]=g.useState(""),[w,C]=g.useState(""),[E,S]=g.useState(!1),[A]=wA();g.useEffect(()=>{A.get("filter")==="premium"&&_("true")},[A]);const[z,k]=g.useState(null),[P,D]=g.useState(null),[$,F]=g.useState(!1),[Y,M]=g.useState(null),[K,ee]=g.useState(null),X=g.useCallback(async()=>{o(!0),d(null);try{const[G,ve]=await Promise.all([NR(),AR()]);r(G),a(ve)}catch(G){d("Erreur lors du chargement des utilisateurs."),console.error(G)}finally{o(!1)}},[]);g.useEffect(()=>{X()},[X]),g.useEffect(()=>{if(m){const G=setTimeout(()=>p(null),4e3);return()=>clearTimeout(G)}},[m]);const L=e.filter(G=>{if(h){const ve=h.toLowerCase();if(!G.displayName?.toLowerCase().includes(ve)&&!G.email?.toLowerCase().includes(ve))return!1}return!(b&&G.role!==b||j==="true"&&!G.isPremium||j==="false"&&G.isPremium||w==="true"&&G.isActive===!1||w==="false"&&G.isActive!==!1)}),I=async G=>{k(G),F(!0);try{const ve=await ER(G.uid);D(ve)}catch(ve){console.error("Erreur lors du chargement des statistiques :",ve),D(null)}finally{F(!1)}},U=async()=>{if(K){M(K.userId);try{switch(K.type){case"role":await SR(K.userId,K.value),p("Rle mis  jour avec succs.");break;case"premium":await wR(K.userId,K.value),p(K.value?"Statut Premium activ (30 jours).":"Statut Premium dsactiv.");break;case"active":await CR(K.userId,K.value),p(K.value?"Compte ractiv.":"Compte dsactiv.");break}await X()}catch(G){d("Erreur lors de l'excution de l'action."),console.error(G)}finally{M(null),ee(null)}}},B=({role:G})=>{const ve={admin:{icon:t.jsx(Qb,{size:12}),className:"user-badge-admin",label:"Admin"},prof:{icon:t.jsx(Bs,{size:12}),className:"user-badge-prof",label:"Professeur"},eleve:{icon:t.jsx(xn,{size:12}),className:"user-badge-eleve",label:"lve"}},De=ve[G]||ve.eleve;return t.jsxs("span",{className:`user-badge ${De.className}`,children:[De.icon," ",De.label]})},T=G=>G?(G?.toDate?G.toDate():new Date(G)).toLocaleDateString("fr-SN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",Z=G=>G?G.charAt(0).toUpperCase():"?",H=()=>t.jsxs(t.Fragment,{children:[u&&t.jsxs("div",{className:"admin-message admin-message-error",children:[t.jsx(_m,{size:18}),t.jsx("span",{children:u}),t.jsx("button",{onClick:()=>d(null),className:"admin-message-close",children:t.jsx(Xi,{size:16})})]}),m&&t.jsxs("div",{className:"admin-message admin-message-success",children:[t.jsx(Ht,{size:18}),t.jsx("span",{children:m})]})]}),ce=()=>{if(!n)return null;const G=[{label:"Total",value:n.total,icon:t.jsx(mm,{size:20}),color:"stat-blue"},{label:"lves",value:n.eleves,icon:t.jsx(xn,{size:20}),color:"stat-green"},{label:"Professeurs",value:n.profs,icon:t.jsx(Bs,{size:20}),color:"stat-purple"},{label:"Premium",value:n.premium,icon:t.jsx(jr,{size:20}),color:"stat-gold"}];return t.jsx("div",{className:"user-stats-grid",children:G.map(ve=>t.jsxs("div",{className:`user-stat-card ${ve.color}`,children:[t.jsx("div",{className:"user-stat-icon",children:ve.icon}),t.jsxs("div",{className:"user-stat-info",children:[t.jsx("span",{className:"user-stat-value",children:ve.value}),t.jsx("span",{className:"user-stat-label",children:ve.label})]})]},ve.label))})},xe=()=>K?t.jsx("div",{className:"admin-modal-overlay",onClick:()=>ee(null),children:t.jsxs("div",{className:"admin-modal",onClick:G=>G.stopPropagation(),children:[t.jsxs("div",{className:"admin-modal-header",children:[t.jsx("h3",{children:"Confirmer l'action"}),t.jsx("button",{className:"admin-modal-close",onClick:()=>ee(null),children:t.jsx(Xi,{size:20})})]}),t.jsx("div",{className:"admin-modal-body",children:t.jsx("p",{children:K.label})}),t.jsxs("div",{className:"admin-modal-footer",children:[t.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>ee(null),children:"Annuler"}),t.jsx("button",{className:"admin-btn admin-btn-primary",onClick:U,disabled:Y===K.userId,children:Y===K.userId?"En cours...":"Confirmer"})]})]})}):null,fe=()=>z?t.jsx("div",{className:"admin-modal-overlay",onClick:()=>k(null),children:t.jsxs("div",{className:"admin-modal admin-modal-lg",onClick:G=>G.stopPropagation(),children:[t.jsxs("div",{className:"admin-modal-header",children:[t.jsx("h3",{children:"Dtail de l'utilisateur"}),t.jsx("button",{className:"admin-modal-close",onClick:()=>k(null),children:t.jsx(Xi,{size:20})})]}),t.jsxs("div",{className:"admin-modal-body",children:[t.jsxs("div",{className:"user-detail-profile",children:[t.jsx("div",{className:"user-detail-avatar",children:Z(z.displayName)}),t.jsxs("div",{className:"user-detail-info",children:[t.jsx("h4",{children:z.displayName||"Sans nom"}),t.jsx("p",{children:z.email}),t.jsxs("div",{className:"user-detail-badges",children:[t.jsx(B,{role:z.role}),z.isPremium&&t.jsxs("span",{className:"user-badge user-badge-premium",children:[t.jsx(jr,{size:12})," Premium"]}),t.jsx("span",{className:`user-badge ${z.isActive!==!1?"user-badge-active":"user-badge-inactive"}`,children:z.isActive!==!1?"Actif":"Dsactiv"})]})]})]}),t.jsxs("div",{className:"user-detail-dates",children:[t.jsxs("div",{children:[t.jsx("span",{className:"user-detail-date-label",children:"Inscription"}),t.jsx("span",{children:T(z.createdAt)})]}),z.isPremium&&z.subscriptionEnd&&t.jsxs("div",{children:[t.jsx("span",{className:"user-detail-date-label",children:"Premium jusqu'au"}),t.jsx("span",{children:T(z.subscriptionEnd)})]})]}),t.jsxs("div",{className:"user-detail-stats-section",children:[t.jsxs("h4",{children:[t.jsx(Us,{size:18})," Statistiques"]}),$?t.jsxs("div",{className:"admin-loading",style:{padding:"1rem"},children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement des statistiques..."})]}):P?t.jsxs("div",{className:"user-detail-stats-grid",children:[t.jsxs("div",{className:"user-detail-stat",children:[t.jsx(xn,{size:20}),t.jsx("span",{className:"user-detail-stat-value",children:P.totalQuizPasses}),t.jsx("span",{className:"user-detail-stat-label",children:"Quiz passs"})]}),t.jsxs("div",{className:"user-detail-stat",children:[t.jsx(Ic,{size:20}),t.jsxs("span",{className:"user-detail-stat-value",children:[P.scoresMoyens,"%"]}),t.jsx("span",{className:"user-detail-stat-label",children:"Score moyen"})]}),t.jsxs("div",{className:"user-detail-stat",children:[t.jsx(ns,{size:20}),t.jsx("span",{className:"user-detail-stat-value",children:P.quizReussis}),t.jsx("span",{className:"user-detail-stat-label",children:"Quiz russis"})]}),t.jsxs("div",{className:"user-detail-stat",children:[t.jsx(po,{size:20}),t.jsx("span",{className:"user-detail-stat-value",children:P.dernierQuiz?T(P.dernierQuiz):"Aucun"}),t.jsx("span",{className:"user-detail-stat-label",children:"Dernier quiz"})]})]}):t.jsx("p",{className:"user-detail-no-stats",children:"Aucune statistique disponible."})]})]})]})}):null;return t.jsxs("div",{className:"admin-container",children:[H(),xe(),fe(),t.jsxs("div",{className:"user-manager",children:[t.jsxs("div",{className:"admin-header",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"admin-title",children:[t.jsx(mm,{size:24})," Gestion des Utilisateurs"]}),t.jsxs("p",{className:"admin-subtitle",children:[e.length," utilisateur(s) au total  ",L.length," affich(s)"]})]}),t.jsxs("button",{className:"admin-btn admin-btn-outline",onClick:X,children:[t.jsx($3,{size:16})," Actualiser"]})]}),ce(),t.jsxs("div",{className:"admin-toolbar",children:[t.jsxs("div",{className:"admin-search-wrapper",children:[t.jsx(kA,{size:18,className:"admin-search-icon"}),t.jsx("input",{type:"text",className:"admin-search-input",placeholder:"Rechercher par nom ou email...",value:h,onChange:G=>v(G.target.value)})]}),t.jsxs("button",{className:`admin-btn admin-btn-outline ${E?"active":""}`,onClick:()=>S(!E),children:[t.jsx(Yb,{size:16})," Filtres",E?t.jsx(Tx,{size:14}):t.jsx(jm,{size:14})]})]}),E&&t.jsxs("div",{className:"admin-filters-panel",children:[t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Rle"}),t.jsxs("select",{className:"admin-select",value:b,onChange:G=>x(G.target.value),children:[t.jsx("option",{value:"",children:"Tous les rles"}),t.jsx("option",{value:"admin",children:"Admin"}),t.jsx("option",{value:"prof",children:"Professeur"}),t.jsx("option",{value:"eleve",children:"lve"})]})]}),t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Abonnement"}),t.jsxs("select",{className:"admin-select",value:j,onChange:G=>_(G.target.value),children:[t.jsx("option",{value:"",children:"Tous"}),t.jsx("option",{value:"true",children:"Premium"}),t.jsx("option",{value:"false",children:"Gratuit"})]})]}),t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Statut"}),t.jsxs("select",{className:"admin-select",value:w,onChange:G=>C(G.target.value),children:[t.jsx("option",{value:"",children:"Tous"}),t.jsx("option",{value:"true",children:"Actifs"}),t.jsx("option",{value:"false",children:"Dsactivs"})]})]}),t.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{x(""),_(""),C(""),v("")},children:"Rinitialiser"})]}),l?t.jsxs("div",{className:"admin-loading",children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement des utilisateurs..."})]}):L.length===0?t.jsxs("div",{className:"admin-empty-state",children:[t.jsx(mm,{size:48}),t.jsx("h3",{children:"Aucun utilisateur trouv"}),t.jsx("p",{children:e.length===0?"Aucun utilisateur n'est encore inscrit.":"Aucun utilisateur ne correspond  vos filtres."})]}):t.jsx("div",{className:"user-table-wrapper",children:t.jsxs("table",{className:"user-table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Utilisateur"}),t.jsx("th",{children:"Rle"}),t.jsx("th",{children:"Abonnement"}),t.jsx("th",{children:"Statut"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:L.map(G=>t.jsxs("tr",{className:G.isActive===!1?"user-row-inactive":"",children:[t.jsx("td",{children:t.jsxs("div",{className:"user-cell-info",children:[t.jsx("div",{className:"user-avatar-sm",children:Z(G.displayName)}),t.jsxs("div",{children:[t.jsx("span",{className:"user-cell-name",children:G.displayName||"Sans nom"}),t.jsx("span",{className:"user-cell-email",children:G.email})]})]})}),t.jsx("td",{children:t.jsxs("select",{className:"admin-select admin-select-sm",value:G.role,onChange:ve=>ee({type:"role",userId:G.uid,value:ve.target.value,label:`Changer le rle de "${G.displayName||G.email}" en "${ve.target.value}" ?`}),children:[t.jsx("option",{value:"eleve",children:"lve"}),t.jsx("option",{value:"prof",children:"Professeur"}),t.jsx("option",{value:"admin",children:"Admin"})]})}),t.jsx("td",{children:t.jsx("button",{className:`user-premium-toggle ${G.isPremium?"active":""}`,onClick:()=>ee({type:"premium",userId:G.uid,value:!G.isPremium,label:G.isPremium?`Dsactiver le statut Premium de "${G.displayName||G.email}" ?`:`Activer le statut Premium de "${G.displayName||G.email}" pour 30 jours ?`}),disabled:Y===G.uid,children:G.isPremium?t.jsxs(t.Fragment,{children:[t.jsx(qc,{size:14})," Premium"]}):t.jsxs(t.Fragment,{children:[t.jsx(jr,{size:14})," Gratuit"]})})}),t.jsx("td",{children:t.jsx("button",{className:`user-status-toggle ${G.isActive!==!1?"active":"inactive"}`,onClick:()=>ee({type:"active",userId:G.uid,value:G.isActive===!1,label:G.isActive===!1?`Ractiver le compte de "${G.displayName||G.email}" ?`:`Dsactiver le compte de "${G.displayName||G.email}" ?`}),disabled:Y===G.uid,children:G.isActive!==!1?t.jsxs(t.Fragment,{children:[t.jsx(B3,{size:14})," Actif"]}):t.jsxs(t.Fragment,{children:[t.jsx(U3,{size:14})," Dsactiv"]})})}),t.jsx("td",{children:t.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>I(G),title:"Voir les statistiques",children:[t.jsx(co,{size:14})," Dtail"]})})]},G.uid))})]})})]})]})},kR=()=>{const[e,r]=g.useState([]),[n,a]=g.useState(null),[l,o]=g.useState(!0),[u,d]=g.useState(null),[m,p]=g.useState(""),[h,v]=g.useState(""),[b,x]=g.useState(""),[j,_]=g.useState(!1),w=g.useCallback(async()=>{try{o(!0),d(null);const z=await Ae(_e(V,"users")),k=new Map;z.docs.forEach(ce=>{const xe=ce.data();k.set(ce.id,{name:xe.displayName||"Sans nom",email:xe.email||""})});const P=await Ae(_e(V,"quizzes")),D=new Map;P.docs.forEach(ce=>{const xe=ce.data();D.set(ce.id,{titre:xe.titre||xe.quizTitre||"Quiz sans titre",discipline:xe.disciplineNom||xe.matiereNom||""})});const $=await Ae(_e(V,"quizzes_v2")),F=new Map;$.docs.forEach(ce=>{const xe=ce.data();F.set(ce.id,{titre:xe.titre||"Quiz avanc sans titre",discipline:xe.disciplineNom||""})});const Y=[];try{(await Ae(ze(_e(V,"quiz_results"),Qe("datePassage","desc"),$t(200)))).docs.forEach(xe=>{const fe=xe.data(),G=k.get(fe.userId)||{name:"Inconnu",email:""},ve=D.get(fe.quizId)||{titre:fe.quizTitre||"Quiz",discipline:fe.disciplineNom||""},De=fe.pourcentage??(fe.totalPoints>0?Math.round(fe.score/fe.totalPoints*100):fe.score>0?Math.round(fe.score/20*100):0);Y.push({id:xe.id,quizId:fe.quizId||"",quizTitre:ve.titre,userId:fe.userId||"",userName:G.name,userEmail:G.email,score:fe.score||0,scoreMax:fe.totalPoints||20,pourcentage:De,reussi:fe.reussi??De>=50,tempsEcoule:fe.tempsEcoule||0,datePassage:fe.datePassage?.toDate?.()||new Date,type:"classique",disciplineNom:ve.discipline})})}catch(ce){console.warn("Pas de rsultats v1 ou index manquant:",ce)}const M=[];try{(await Ae(ze(_e(V,"quiz_results_v2"),Qe("datePassage","desc"),$t(200)))).docs.forEach(xe=>{const fe=xe.data(),G=k.get(fe.userId)||{name:"Inconnu",email:""},ve=F.get(fe.quizId)||{titre:fe.quizTitre||"Quiz avanc",discipline:fe.disciplineNom||""},De=fe.scoreMax>0?Math.round(fe.score/fe.scoreMax*100):0;M.push({id:xe.id,quizId:fe.quizId||"",quizTitre:ve.titre,userId:fe.userId||"",userName:G.name,userEmail:G.email,score:fe.score||0,scoreMax:fe.scoreMax||0,pourcentage:De,reussi:fe.reussi??De>=50,tempsEcoule:fe.tempsTotal||fe.tempsEcoule||0,datePassage:fe.datePassage?.toDate?.()||new Date,type:"avance",disciplineNom:ve.discipline})})}catch(ce){console.warn("Pas de rsultats v2 ou index manquant:",ce)}const K=[...Y,...M].sort((ce,xe)=>xe.datePassage.getTime()-ce.datePassage.getTime());r(K);const ee=new Date,X=new Date(ee.getFullYear(),ee.getMonth(),ee.getDate()),L=new Date(X.getTime()-10080*60*1e3),I=K.length,U=I>0?Math.round(K.reduce((ce,xe)=>ce+xe.pourcentage,0)/I):0,B=I>0?Math.round(K.filter(ce=>ce.reussi).length/I*100):0,T=I>0?Math.round(K.reduce((ce,xe)=>ce+xe.tempsEcoule,0)/I):0,Z=K.filter(ce=>ce.datePassage>=X).length,H=K.filter(ce=>ce.datePassage>=L).length;a({totalResultats:I,moyenneGenerale:U,tauxReussite:B,tempsEcouleMoyen:T,resultatsAujourdHui:Z,resultats7Jours:H})}catch(z){console.error("Erreur chargement rsultats:",z),d("Impossible de charger les rsultats. Vrifiez votre connexion.")}finally{o(!1)}},[]);g.useEffect(()=>{w()},[w]);const C=e.filter(z=>{if(m&&z.type!==m||h==="true"&&!z.reussi||h==="false"&&z.reussi)return!1;if(b){const k=b.toLowerCase();if(!z.userName.toLowerCase().includes(k)&&!z.userEmail.toLowerCase().includes(k)&&!z.quizTitre.toLowerCase().includes(k)&&!z.disciplineNom.toLowerCase().includes(k))return!1}return!0}),E=z=>{if(z<60)return`${z}s`;const k=Math.floor(z/60),P=z%60;return P>0?`${k}min ${P}s`:`${k}min`},S=z=>z.toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),A=z=>z>=80?"results-score--excellent":z>=60?"results-score--bien":z>=40?"results-score--moyen":"results-score--faible";return t.jsxs("div",{className:"results-admin",children:[t.jsxs("div",{className:"admin-page-header",children:[t.jsxs("div",{className:"admin-page-header__info",children:[t.jsx("h1",{className:"admin-page-header__title",children:" Rsultats des Quiz"}),t.jsx("p",{className:"admin-page-header__subtitle",children:"Vue d'ensemble des performances des lves"})]}),t.jsx("div",{className:"admin-page-header__actions",children:t.jsx("button",{className:"admin-btn admin-btn-secondary",onClick:w,children:" Actualiser"})})]}),n&&t.jsxs("div",{className:"stats-grid",children:[t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--primary",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalResultats}),t.jsx("div",{className:"stat-card__label",children:"Rsultats totaux"})]})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--secondary",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsxs("div",{className:"stat-card__value",children:[n.moyenneGenerale,"%"]}),t.jsx("div",{className:"stat-card__label",children:"Moyenne gnrale"})]})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--warning",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsxs("div",{className:"stat-card__value",children:[n.tauxReussite,"%"]}),t.jsx("div",{className:"stat-card__label",children:"Taux de russite"})]})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--info",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.resultatsAujourdHui}),t.jsx("div",{className:"stat-card__label",children:"Aujourd'hui"})]})]})]}),t.jsxs("div",{className:"admin-toolbar",children:[t.jsxs("div",{className:"admin-search",children:[t.jsx("span",{className:"admin-search-icon",children:""}),t.jsx("input",{type:"text",className:"admin-search-input",placeholder:"Rechercher par lve, quiz ou discipline...",value:b,onChange:z=>x(z.target.value)})]}),t.jsx("button",{className:`admin-btn admin-btn-ghost ${j?"active":""}`,onClick:()=>_(!j),children:" Filtres"})]}),j&&t.jsxs("div",{className:"admin-filters-panel",children:[t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Type de quiz"}),t.jsxs("select",{className:"admin-select",value:m,onChange:z=>p(z.target.value),children:[t.jsx("option",{value:"",children:"Tous les types"}),t.jsx("option",{value:"classique",children:"Classique (v1)"}),t.jsx("option",{value:"avance",children:"Avanc (v2)"})]})]}),t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Rsultat"}),t.jsxs("select",{className:"admin-select",value:h,onChange:z=>v(z.target.value),children:[t.jsx("option",{value:"",children:"Tous"}),t.jsx("option",{value:"true",children:"Russis"}),t.jsx("option",{value:"false",children:"chous"})]})]}),t.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{p(""),v(""),x("")},children:"Rinitialiser"})]}),l?t.jsxs("div",{className:"admin-loading",children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement des rsultats..."})]}):u?t.jsxs("div",{className:"admin-error",children:[t.jsxs("p",{children:[" ",u]}),t.jsx("button",{className:"admin-btn admin-btn-primary",onClick:w,children:"Ressayer"})]}):C.length===0?t.jsxs("div",{className:"admin-empty-state",children:[t.jsx("span",{style:{fontSize:"3rem"},children:""}),t.jsx("h3",{children:"Aucun rsultat trouv"}),t.jsx("p",{children:e.length===0?"Aucun lve n'a encore pass de quiz.":"Aucun rsultat ne correspond  vos filtres."})]}):t.jsxs("div",{className:"results-table-wrapper",children:[t.jsxs("table",{className:"results-table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"lve"}),t.jsx("th",{children:"Quiz"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Score"}),t.jsx("th",{children:"Rsultat"}),t.jsx("th",{children:"Dure"}),t.jsx("th",{children:"Date"})]})}),t.jsx("tbody",{children:C.map(z=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsxs("div",{className:"results-cell-user",children:[t.jsx("span",{className:"results-cell-name",children:z.userName}),t.jsx("span",{className:"results-cell-email",children:z.userEmail})]})}),t.jsx("td",{children:t.jsxs("div",{className:"results-cell-quiz",children:[t.jsx("span",{className:"results-cell-quiz-title",children:z.quizTitre}),z.disciplineNom&&t.jsx("span",{className:"results-cell-discipline",children:z.disciplineNom})]})}),t.jsx("td",{children:t.jsx("span",{className:`results-badge results-badge--${z.type}`,children:z.type==="classique"?" Classique":" Avanc"})}),t.jsxs("td",{children:[t.jsxs("span",{className:`results-score ${A(z.pourcentage)}`,children:[z.pourcentage,"%"]}),t.jsxs("span",{className:"results-score-detail",children:[z.score,"/",z.scoreMax]})]}),t.jsx("td",{children:t.jsx("span",{className:`results-status ${z.reussi?"results-status--success":"results-status--fail"}`,children:z.reussi?" Russi":" chou"})}),t.jsx("td",{className:"results-cell-duration",children:E(z.tempsEcoule)}),t.jsx("td",{className:"results-cell-date",children:S(z.datePassage)})]},`${z.type}-${z.id}`))})]}),t.jsx("div",{className:"results-footer",children:t.jsxs("p",{children:[C.length," rsultat",C.length>1?"s":""," affich",C.length>1?"s":"",C.length!==e.length&&` sur ${e.length} au total`]})})]})]})},Zl={siteName:"PedaClic",siteDescription:"L'cole en un clic  Plateforme ducative sngalaise",contactEmail:"contact@pedaclic.sn",contactPhone:"+221 XX XXX XX XX",premium3m:1e4,premium6m:2e4,premium1an:3e4,quizDureeDefaut:15,quizNoteMinimale:10,quizTentativesMax:3,maintenanceMode:!1,maintenanceMessage:"PedaClic est en maintenance. Nous revenons bientt !",cahierPdfExport:!0},OR=()=>{const[e,r]=g.useState(Zl),[n,a]=g.useState(Zl),[l,o]=g.useState(!0),[u,d]=g.useState(!1),[m,p]=g.useState(null),[h,v]=g.useState(null),[b,x]=g.useState(!1),j=g.useCallback(async()=>{try{o(!0),p(null);const S=je(V,"settings","platform"),A=await pt(S);if(A.exists()){const z=A.data(),k={...Zl,...z};r(k),a(k)}else r(Zl),a(Zl)}catch(S){console.error("Erreur chargement paramtres:",S),p("Impossible de charger les paramtres.")}finally{o(!1)}},[]);g.useEffect(()=>{j()},[j]),g.useEffect(()=>{if(h){const S=setTimeout(()=>v(null),4e3);return()=>clearTimeout(S)}},[h]),g.useEffect(()=>{const S=JSON.stringify(e)!==JSON.stringify(n);x(S)},[e,n]);const _=(S,A)=>{r(z=>({...z,[S]:A}))},w=async()=>{try{if(d(!0),p(null),e.premium3m<0||e.premium6m<0||e.premium1an<0){p("Les tarifs ne peuvent pas tre ngatifs.");return}if(e.quizNoteMinimale<0||e.quizNoteMinimale>20){p("La note minimale doit tre entre 0 et 20.");return}const S=je(V,"settings","platform");await rl(S,{...e,updatedAt:kt()}),a(e),x(!1),v("Paramtres sauvegards avec succs !")}catch(S){console.error("Erreur sauvegarde paramtres:",S),p("Impossible de sauvegarder les paramtres.")}finally{d(!1)}},C=()=>{r(n),x(!1)},E=()=>{window.confirm("Rinitialiser tous les paramtres aux valeurs par dfaut ?")&&r(Zl)};return l?t.jsxs("div",{className:"admin-loading",children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement des paramtres..."})]}):t.jsxs("div",{className:"settings-admin",children:[t.jsxs("div",{className:"admin-page-header",children:[t.jsxs("div",{className:"admin-page-header__info",children:[t.jsx("h1",{className:"admin-page-header__title",children:" Configuration"}),t.jsx("p",{className:"admin-page-header__subtitle",children:"Paramtres gnraux de la plateforme PedaClic"})]}),t.jsxs("div",{className:"admin-page-header__actions",children:[b&&t.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:C,children:"Annuler"}),t.jsx("button",{className:"admin-btn admin-btn-primary",onClick:w,disabled:!b||u,children:u?" Sauvegarde...":" Sauvegarder"})]})]}),b&&t.jsx("div",{className:"settings-unsaved-banner",children:" Vous avez des modifications non sauvegardes."}),m&&t.jsxs("div",{className:"admin-alert admin-alert--error",children:[" ",m]}),h&&t.jsxs("div",{className:"admin-alert admin-alert--success",children:[" ",h]}),t.jsxs("div",{className:"settings-section",children:[t.jsxs("div",{className:"settings-section__header",children:[t.jsx("h2",{className:"settings-section__title",children:" Informations gnrales"}),t.jsx("p",{className:"settings-section__description",children:"Informations de base de la plateforme"})]}),t.jsxs("div",{className:"settings-grid",children:[t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Nom du site"}),t.jsx("input",{type:"text",className:"admin-input",value:e.siteName,onChange:S=>_("siteName",S.target.value)})]}),t.jsxs("div",{className:"settings-field settings-field--full",children:[t.jsx("label",{className:"settings-label",children:"Description"}),t.jsx("input",{type:"text",className:"admin-input",value:e.siteDescription,onChange:S=>_("siteDescription",S.target.value)})]}),t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Email de contact"}),t.jsx("input",{type:"email",className:"admin-input",value:e.contactEmail,onChange:S=>_("contactEmail",S.target.value)})]}),t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Tlphone"}),t.jsx("input",{type:"tel",className:"admin-input",value:e.contactPhone,onChange:S=>_("contactPhone",S.target.value)})]})]})]}),t.jsxs("div",{className:"settings-section",children:[t.jsxs("div",{className:"settings-section__header",children:[t.jsx("h2",{className:"settings-section__title",children:" Tarifs Premium"}),t.jsx("p",{className:"settings-section__description",children:"Montants des abonnements en FCFA"})]}),t.jsxs("div",{className:"settings-grid",children:[t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Accs illimit 3 mois (FCFA)"}),t.jsx("input",{type:"number",className:"admin-input",value:e.premium3m,onChange:S=>_("premium3m",parseInt(S.target.value)||0),min:0,step:500})]}),t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Accs illimit 6 mois (FCFA)"}),t.jsx("input",{type:"number",className:"admin-input",value:e.premium6m,onChange:S=>_("premium6m",parseInt(S.target.value)||0),min:0,step:1e3}),t.jsxs("span",{className:"settings-hint",children:["conomie vs 23 mois : ",(e.premium3m*2-e.premium6m).toLocaleString("fr-FR")," FCFA"]})]}),t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Accs illimit 1 an (FCFA)"}),t.jsx("input",{type:"number",className:"admin-input",value:e.premium1an,onChange:S=>_("premium1an",parseInt(S.target.value)||0),min:0,step:1e3}),t.jsxs("span",{className:"settings-hint",children:["conomie vs 43 mois : ",(e.premium3m*4-e.premium1an).toLocaleString("fr-FR")," FCFA"]})]})]})]}),t.jsxs("div",{className:"settings-section",children:[t.jsxs("div",{className:"settings-section__header",children:[t.jsx("h2",{className:"settings-section__title",children:" Paramtres des Quiz"}),t.jsx("p",{className:"settings-section__description",children:"Valeurs par dfaut pour la cration de quiz"})]}),t.jsxs("div",{className:"settings-grid",children:[t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Dure par dfaut (minutes)"}),t.jsx("input",{type:"number",className:"admin-input",value:e.quizDureeDefaut,onChange:S=>_("quizDureeDefaut",parseInt(S.target.value)||0),min:1,max:120})]}),t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Note minimale pour russir (/20)"}),t.jsx("input",{type:"number",className:"admin-input",value:e.quizNoteMinimale,onChange:S=>_("quizNoteMinimale",parseInt(S.target.value)||0),min:0,max:20})]}),t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Tentatives max par quiz"}),t.jsx("input",{type:"number",className:"admin-input",value:e.quizTentativesMax,onChange:S=>_("quizTentativesMax",parseInt(S.target.value)||0),min:1,max:10}),t.jsx("span",{className:"settings-hint",children:"0 = illimit"})]})]})]}),t.jsxs("div",{className:"settings-section",children:[t.jsxs("div",{className:"settings-section__header",children:[t.jsx("h2",{className:"settings-section__title",children:" Cahier de Textes"}),t.jsx("p",{className:"settings-section__description",children:"Options des fonctionnalits du cahier de textes pour les professeurs"})]}),t.jsx("div",{className:"settings-grid",children:t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Export PDF du cahier"}),t.jsxs("div",{className:"settings-toggle-wrapper",children:[t.jsx("button",{className:`settings-toggle ${e.cahierPdfExport?"settings-toggle--active":""}`,onClick:()=>_("cahierPdfExport",!e.cahierPdfExport),children:t.jsx("span",{className:"settings-toggle__knob"})}),t.jsx("span",{className:`settings-toggle-label ${e.cahierPdfExport?"settings-toggle-label--active":""}`,children:e.cahierPdfExport?" Export PDF activ":" Export PDF dsactiv"})]}),t.jsx("span",{className:"settings-hint",children:'Affiche le bouton " PDF" dans les cahiers de textes des professeurs'})]})})]}),t.jsxs("div",{className:"settings-section",children:[t.jsxs("div",{className:"settings-section__header",children:[t.jsx("h2",{className:"settings-section__title",children:" Mode Maintenance"}),t.jsx("p",{className:"settings-section__description",children:"Activer pour bloquer l'accs au site pendant les mises  jour"})]}),t.jsxs("div",{className:"settings-grid",children:[t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Mode maintenance"}),t.jsxs("div",{className:"settings-toggle-wrapper",children:[t.jsx("button",{className:`settings-toggle ${e.maintenanceMode?"settings-toggle--active":""}`,onClick:()=>_("maintenanceMode",!e.maintenanceMode),children:t.jsx("span",{className:"settings-toggle__knob"})}),t.jsx("span",{className:`settings-toggle-label ${e.maintenanceMode?"settings-toggle-label--active":""}`,children:e.maintenanceMode?" Maintenance active":" Site en ligne"})]})]}),t.jsxs("div",{className:"settings-field settings-field--full",children:[t.jsx("label",{className:"settings-label",children:"Message affich aux visiteurs"}),t.jsx("textarea",{className:"admin-input admin-textarea",rows:3,value:e.maintenanceMessage,onChange:S=>_("maintenanceMessage",S.target.value),disabled:!e.maintenanceMode})]})]})]}),t.jsxs("div",{className:"settings-actions",children:[t.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:E,children:" Rinitialiser aux valeurs par dfaut"}),t.jsx("button",{className:"admin-btn admin-btn-primary",onClick:w,disabled:!b||u,children:u?" Sauvegarde...":" Sauvegarder les modifications"})]})]})},DR=["#000000","#1f2937","#374151","#6b7280","#dc2626","#ef4444","#f97316","#d97706","#eab308","#65a30d","#059669","#14b8a6","#2563eb","#3b82f6","#0891b2","#7c3aed","#db2777","#ec4899","#be185d","#9333ea","#ffffff","#f3f4f6","#fef3c7","#dbeafe"],PR=["#fef08a","#fde68a","#fef3c7","#bbf7d0","#d1fae5","#a7f3d0","#bfdbfe","#dbeafe","#c7d2fe","#fecaca","#fee2e2","#fde8e8","#e9d5ff","#f3e8ff","#d8b4fe","#fed7aa","#ffedd5","#fce7f3","transparent","#ffffff"],MR=["#f0fdf4","#ecfdf5","#f0f9ff","#eff6ff","#faf5ff","#fdf2f8","#fff7ed","#fffbeb","#fef2f2","#f9fafb","#f3f4f6","transparent"],TR=[{tag:"p",label:" Paragraphe"},{tag:"h1",label:"H1  Titre 1"},{tag:"h2",label:"H2  Titre 2"},{tag:"h3",label:"H3  Titre 3"},{tag:"h4",label:"H4  Titre 4"},{tag:"pre",label:"</> Code"},{tag:"blockquote",label:" Citation"}],qR=[{value:"1",label:"Trs petit"},{value:"2",label:"Petit"},{value:"3",label:"Normal"},{value:"4",label:"Grand"},{value:"5",label:"Trs grand"},{value:"6",label:"norme"}],RR=["headinglevel","fontsize","separator","bold","italic","underline","strikethrough","separator","color","highlight","blockBg","separator","alignLeft","alignCenter","alignRight","alignJustify","separator","bulletList","numberedList","indent","outdent","separator","subscript","superscript","link","clean"],ja=({value:e,onChange:r,placeholder:n="Saisissez votre texte...",minHeight:a=120,maxHeight:l=500,toolbar:o=RR,disabled:u=!1,className:d=""})=>{const m=g.useRef(null),p=g.useRef(!1),[h,v]=g.useState(!1),[b,x]=g.useState(!1),[j,_]=g.useState(!1);g.useEffect(()=>{m.current&&!p.current&&m.current.innerHTML!==e&&(m.current.innerHTML=e||""),p.current=!1},[e]);const w=g.useCallback(()=>{m.current&&(p.current=!0,r(m.current.innerHTML))},[r]),C=g.useCallback((k,P)=>{m.current?.focus(),document.execCommand(k,!1,P),w()},[w]),E=g.useCallback(k=>{m.current?.focus();const P=window.getSelection();if(!P||!m.current)return;let D=P.anchorNode;for(;D&&D!==m.current;){if(D.nodeType===Node.ELEMENT_NODE){const $=D,F=$.tagName;if(["P","DIV","H1","H2","H3","H4","LI","BLOCKQUOTE","PRE"].includes(F)){$.style.backgroundColor=k==="transparent"?"":k,w();return}}D=D.parentNode}document.execCommand("hiliteColor",!1,k==="transparent"?"transparent":k),w()},[w]),S=g.useCallback(()=>{const k=prompt("URL du lien :","https://");k&&C("createLink",k)},[C]),A=g.useCallback(()=>{C("removeFormat"),C("formatBlock","p")},[C]);g.useEffect(()=>{const k=()=>{v(!1),x(!1),_(!1)};return document.addEventListener("click",k),()=>document.removeEventListener("click",k)},[]);const z=(k,P)=>{switch(k){case"separator":return t.jsx("span",{className:"rte-separator"},`sep-${P}`);case"bold":return t.jsx("button",{type:"button",className:"rte-btn",title:"Gras (Ctrl+B)",onMouseDown:D=>{D.preventDefault(),C("bold")},children:t.jsx("strong",{children:"G"})},"bold");case"italic":return t.jsx("button",{type:"button",className:"rte-btn",title:"Italique (Ctrl+I)",onMouseDown:D=>{D.preventDefault(),C("italic")},children:t.jsx("em",{children:"I"})},"italic");case"underline":return t.jsx("button",{type:"button",className:"rte-btn",title:"Soulign (Ctrl+U)",onMouseDown:D=>{D.preventDefault(),C("underline")},children:t.jsx("u",{children:"S"})},"underline");case"strikethrough":return t.jsx("button",{type:"button",className:"rte-btn",title:"Barr",onMouseDown:D=>{D.preventDefault(),C("strikeThrough")},children:t.jsx("s",{children:"R"})},"strike");case"headinglevel":return t.jsxs("select",{className:"rte-select",title:"Niveau de titre",defaultValue:"",onChange:D=>{const $=D.target.value;m.current?.focus(),document.execCommand("formatBlock",!1,$),w(),D.target.value=""},children:[t.jsx("option",{value:"",disabled:!0,children:"Titre"}),TR.map(D=>t.jsx("option",{value:D.tag,children:D.label},D.tag))]},"headinglevel");case"fontsize":return t.jsxs("select",{className:"rte-select",title:"Taille de police",defaultValue:"",onChange:D=>{const $=D.target.value;m.current?.focus(),document.execCommand("fontSize",!1,$),w(),D.target.value=""},children:[t.jsx("option",{value:"",disabled:!0,children:"Taille"}),qR.map(D=>t.jsx("option",{value:D.value,children:D.label},D.value))]},"fontsize");case"color":return t.jsxs("span",{className:"rte-dropdown-wrapper",onClick:D=>D.stopPropagation(),children:[t.jsx("button",{type:"button",className:"rte-btn",title:"Couleur du texte",onClick:()=>{v(D=>!D),x(!1),_(!1)},children:t.jsx("span",{style:{borderBottom:"3px solid #dc2626",paddingBottom:1},children:"A"})}),h&&t.jsx("div",{className:"rte-color-picker rte-color-picker--grid",children:DR.map(D=>t.jsx("button",{type:"button",className:"rte-color-swatch",style:{backgroundColor:D,border:D==="#ffffff"||D==="#f3f4f6"?"1px solid #d1d5db":"1px solid transparent"},title:D,onMouseDown:$=>{$.preventDefault(),C("foreColor",D),v(!1)}},D))})]},"color");case"highlight":return t.jsxs("span",{className:"rte-dropdown-wrapper",onClick:D=>D.stopPropagation(),children:[t.jsx("button",{type:"button",className:"rte-btn",title:"Fond de texte (surlignage)",onClick:()=>{x(D=>!D),v(!1),_(!1)},children:t.jsx("span",{style:{backgroundColor:"#fef08a",padding:"0 3px",borderRadius:2},children:"A"})}),b&&t.jsx("div",{className:"rte-color-picker rte-color-picker--grid",children:PR.map((D,$)=>t.jsx("button",{type:"button",className:"rte-color-swatch",style:{backgroundColor:D==="transparent"?"#fff":D,border:"1px solid #d1d5db"},title:D==="transparent"?"Aucun fond":D,onMouseDown:F=>{F.preventDefault(),C("hiliteColor",D==="transparent"?"transparent":D),x(!1)},children:D==="transparent"?t.jsx("span",{style:{fontSize:10,color:"#6b7280"},children:""}):null},$))})]},"highlight");case"blockBg":return t.jsxs("span",{className:"rte-dropdown-wrapper",onClick:D=>D.stopPropagation(),children:[t.jsx("button",{type:"button",className:"rte-btn",title:"Trame de fond du paragraphe",onClick:()=>{_(D=>!D),v(!1),x(!1)},children:t.jsx("span",{style:{background:"linear-gradient(135deg, #dbeafe 40%, #d1fae5 100%)",padding:"0 3px",borderRadius:2},children:""})}),j&&t.jsx("div",{className:"rte-color-picker rte-color-picker--grid",children:MR.map((D,$)=>t.jsx("button",{type:"button",className:"rte-color-swatch rte-color-swatch--block",style:{backgroundColor:D==="transparent"?"#fff":D,border:"1px solid #d1d5db"},title:D==="transparent"?"Aucun fond":"Fond de bloc",onMouseDown:F=>{F.preventDefault(),E(D),_(!1)},children:D==="transparent"?t.jsx("span",{style:{fontSize:10,color:"#6b7280"},children:""}):null},$))})]},"blockbg");case"alignLeft":return t.jsx("button",{type:"button",className:"rte-btn",title:"Aligner  gauche",onMouseDown:D=>{D.preventDefault(),C("justifyLeft")},children:t.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:t.jsx("path",{d:"M2 12.5a.5.5 0 010-1h7a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h11a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h7a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h11a.5.5 0 010 1H2z"})})},"alignL");case"alignCenter":return t.jsx("button",{type:"button",className:"rte-btn",title:"Centrer",onMouseDown:D=>{D.preventDefault(),C("justifyCenter")},children:t.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:t.jsx("path",{d:"M4 12.5a.5.5 0 010-1h8a.5.5 0 010 1H4zm-2-3a.5.5 0 010-1h12a.5.5 0 010 1H2zm2-3a.5.5 0 010-1h8a.5.5 0 010 1H4zm-2-3a.5.5 0 010-1h12a.5.5 0 010 1H2z"})})},"alignC");case"alignRight":return t.jsx("button",{type:"button",className:"rte-btn",title:"Aligner  droite",onMouseDown:D=>{D.preventDefault(),C("justifyRight")},children:t.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:t.jsx("path",{d:"M14 12.5a.5.5 0 010-1H7a.5.5 0 010 1h7zm0-3a.5.5 0 010-1H3a.5.5 0 010 1h11zm0-3a.5.5 0 010-1H7a.5.5 0 010 1h7zm0-3a.5.5 0 010-1H3a.5.5 0 010 1h11z"})})},"alignR");case"alignJustify":return t.jsx("button",{type:"button",className:"rte-btn",title:"Justifier",onMouseDown:D=>{D.preventDefault(),C("justifyFull")},children:t.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:t.jsx("path",{d:"M2 12.5a.5.5 0 010-1h12a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h12a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h12a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h12a.5.5 0 010 1H2z"})})},"alignJ");case"bulletList":return t.jsx("button",{type:"button",className:"rte-btn",title:"Liste  puces",onMouseDown:D=>{D.preventDefault(),C("insertUnorderedList")},children:""},"ul");case"numberedList":return t.jsx("button",{type:"button",className:"rte-btn",title:"Liste numrote",onMouseDown:D=>{D.preventDefault(),C("insertOrderedList")},children:"1"},"ol");case"indent":return t.jsx("button",{type:"button",className:"rte-btn",title:"Augmenter le retrait",onMouseDown:D=>{D.preventDefault(),C("indent")},children:""},"indent");case"outdent":return t.jsx("button",{type:"button",className:"rte-btn",title:"Diminuer le retrait",onMouseDown:D=>{D.preventDefault(),C("outdent")},children:""},"outdent");case"blockquote":return t.jsx("button",{type:"button",className:"rte-btn",title:"Citation",onMouseDown:D=>{D.preventDefault(),C("formatBlock","blockquote")},children:""},"blockquote");case"subscript":return t.jsxs("button",{type:"button",className:"rte-btn",title:"Indice",onMouseDown:D=>{D.preventDefault(),C("subscript")},children:["X",t.jsx("sub",{children:""})]},"sub");case"superscript":return t.jsxs("button",{type:"button",className:"rte-btn",title:"Exposant",onMouseDown:D=>{D.preventDefault(),C("superscript")},children:["X",t.jsx("sup",{children:""})]},"sup");case"link":return t.jsx("button",{type:"button",className:"rte-btn",title:"Insrer un lien",onMouseDown:D=>{D.preventDefault(),S()},children:""},"link");case"clean":return t.jsx("button",{type:"button",className:"rte-btn rte-btn-clean",title:"Effacer le formatage",onMouseDown:D=>{D.preventDefault(),A()},children:""},"clean");default:return null}};return t.jsxs("div",{className:`rte-container ${u?"rte-disabled":""} ${d}`,children:[!u&&t.jsx("div",{className:"rte-toolbar",children:o.map((k,P)=>z(k,P))}),t.jsx("div",{ref:m,className:"rte-editor",contentEditable:!u,onInput:w,onBlur:w,"data-placeholder":n,style:{minHeight:`${a}px`,maxHeight:`${l}px`},suppressContentEditableWarning:!0})]})},ho={qcm_unique:"QCM  Choix unique",qcm_multiple:"QCM  Choix multiple",drag_drop:"Glisser-Dposer",mise_en_relation:"Mise en relation",essai:"Essai / Rdaction"},wm={qcm_unique:"",qcm_multiple:"",drag_drop:"",mise_en_relation:"",essai:""},Cm={qcm_unique:"#2563eb",qcm_multiple:"#7c3aed",drag_drop:"#059669",mise_en_relation:"#d97706",essai:"#dc2626"};function nr(e="id"){return`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function IR(e,r){const n={id:nr("q"),type:e,enonce:"",difficulte:"moyen",points:2,ordre:r};switch(e){case"qcm_unique":return{...n,typeData:{options:[{id:nr("opt"),texte:"",isCorrect:!0},{id:nr("opt"),texte:"",isCorrect:!1},{id:nr("opt"),texte:"",isCorrect:!1},{id:nr("opt"),texte:"",isCorrect:!1}]}};case"qcm_multiple":return{...n,typeData:{options:[{id:nr("opt"),texte:"",isCorrect:!0},{id:nr("opt"),texte:"",isCorrect:!0},{id:nr("opt"),texte:"",isCorrect:!1},{id:nr("opt"),texte:"",isCorrect:!1}],scoringPartiel:!0}};case"drag_drop":return{...n,typeData:{items:[{id:nr("item"),texte:"",ordreCorrect:1},{id:nr("item"),texte:"",ordreCorrect:2},{id:nr("item"),texte:"",ordreCorrect:3}],consigneOrdre:"Remettez les lments dans le bon ordre"}};case"mise_en_relation":return{...n,typeData:{paires:[{id:nr("pair"),gauche:"",droite:""},{id:nr("pair"),gauche:"",droite:""},{id:nr("pair"),gauche:"",droite:""}]}};case"essai":return{...n,points:5,typeData:{nombreMotsMin:50,nombreMotsMax:500,motsCles:[],correctionMode:"manuelle"}}}}const du="quizzes_v2",LR="quiz_results_v2";async function $R(e,r){try{const n=await Ot(_e(V,du),{...e,auteurId:r,createdAt:kt(),updatedAt:kt()});return console.log(" Quiz avanc cr :",n.id),n.id}catch(n){throw console.error(" Erreur cration quiz avanc :",n),new Error("Impossible de crer le quiz")}}async function BR(e,r){try{const n=je(V,du,e);await Ve(n,{...r,updatedAt:kt()}),console.log(" Quiz avanc mis  jour :",e)}catch(n){throw console.error(" Erreur mise  jour quiz :",n),new Error("Impossible de mettre  jour le quiz")}}async function UR(e){try{await Ir(je(V,du,e)),console.log(" Quiz avanc supprim :",e)}catch(r){throw console.error(" Erreur suppression quiz :",r),new Error("Impossible de supprimer le quiz")}}async function JA(e){try{const r=await pt(je(V,du,e));if(!r.exists())return null;const n=r.data();return{id:r.id,...n,createdAt:n.createdAt?.toDate()||new Date,updatedAt:n.updatedAt?.toDate()||void 0}}catch(r){throw console.error(" Erreur rcupration quiz :",r),new Error("Impossible de rcuprer le quiz")}}async function ez(){try{const e=ze(_e(V,du),Qe("createdAt","desc"));return(await Ae(e)).docs.map(n=>{const a=n.data();return{id:n.id,...a,createdAt:a.createdAt?.toDate()||new Date,updatedAt:a.updatedAt?.toDate()||void 0}})}catch(e){throw console.error(" Erreur rcupration tous les quiz :",e),new Error("Impossible de rcuprer les quiz")}}function FR(e,r){let n=0,a=0;const l=[];for(const o of e.questions){a+=o.points;const u=r.find(v=>v.questionId===o.id);if(!u){l.push({questionId:o.id,type:o.type,pointsObtenus:0,pointsMax:o.points,isCorrect:!1});continue}let d=0,m=!1,p=!1,h=!1;switch(o.type){case"qcm_unique":{const b=o.typeData.options.find(x=>x.isCorrect);b&&u.selectedOptionId===b.id&&(d=o.points,m=!0);break}case"qcm_multiple":{const v=o.typeData,b=v.options.filter(C=>C.isCorrect).map(C=>C.id),x=v.options.filter(C=>!C.isCorrect).map(C=>C.id),j=u.selectedOptionIds||[],_=j.some(C=>x.includes(C)),w=j.filter(C=>b.includes(C)).length;!_&&w===b.length?(d=o.points,m=!0):v.scoringPartiel&&w>0&&!_&&(d=Math.round(o.points*w/b.length*100)/100,p=!0);break}case"drag_drop":{const v=o.typeData,b=u.ordrePropose||[],x=v.items.sort((_,w)=>_.ordreCorrect-w.ordreCorrect).map(_=>_.id);let j=0;for(let _=0;_<x.length;_++)b[_]===x[_]&&j++;j===x.length?(d=o.points,m=!0):j>0&&(d=Math.round(o.points*j/x.length*100)/100,p=!0);break}case"mise_en_relation":{const v=o.typeData,b=u.relationsProposees||{};let x=0;for(const j of v.paires)b[j.id]===j.id&&x++;x===v.paires.length?(d=o.points,m=!0):x>0&&(d=Math.round(o.points*x/v.paires.length*100)/100,p=!0);break}case"essai":{const v=o.typeData,b=u.texteReponse||"";if(v.correctionMode==="mots_cles"&&v.motsCles.length>0){const x=b.toLowerCase().replace(/<[^>]*>/g,"");let j=0,_=0;for(const w of v.motsCles)j+=w.poids,x.includes(w.mot.toLowerCase())&&(_+=w.poids);j>0&&(d=Math.round(o.points*_/j*100)/100,m=_===j,p=_>0&&_<j)}else h=!0;break}}n+=d,l.push({questionId:o.id,type:o.type,pointsObtenus:d,pointsMax:o.points,isCorrect:m,isPartiel:p,correctionManuelleRequise:h})}return{score:n,scoreMax:a,details:l}}async function GR(e,r,n,a){try{const{score:l,scoreMax:o,details:u}=FR(e,n),d=o>0?Math.round(l/o*20*100)/100:0,m=u.some(v=>v.correctionManuelleRequise),p={quizId:e.id,userId:r,reponses:n,score:l,scoreMax:o,note20:d,tempsEcoule:a,datePassage:new Date,reussi:d>=e.noteMinimale,correctionManuelle:m,detailsParQuestion:u},h=await Ot(_e(V,LR),{...p,datePassage:kt()});return console.log(" Rsultat quiz enregistr :",h.id),{id:h.id,...p}}catch(l){throw console.error(" Erreur soumission quiz :",l),new Error("Impossible d'enregistrer le rsultat")}}const HR=({existingQuiz:e,disciplines:r,auteurId:n,onSave:a,onCancel:l})=>{const[o,u]=g.useState(e?.titre||""),[d,m]=g.useState(e?.description||""),[p,h]=g.useState(e?.disciplineId||""),[v,b]=g.useState(e?.duree||30),[x,j]=g.useState(e?.isPremium??!0),[_,w]=g.useState(e?.noteMinimale||10),[C,E]=g.useState(e?.melangerQuestions??!1),[S,A]=g.useState(e?.melangerOptions??!1),[z,k]=g.useState(e?.afficherCorrection??!0),[P,D]=g.useState(e?.tentativesMax||0),[$,F]=g.useState(e?.questions||[]),[Y,M]=g.useState(null),[K,ee]=g.useState(!1),[X,L]=g.useState(null),[I,U]=g.useState(!1),B=g.useCallback(G=>{const ve=IR(G,$.length+1);F(De=>[...De,ve]),M($.length),U(!1)},[$.length]),T=g.useCallback(G=>{confirm("Supprimer cette question ?")&&(F(ve=>ve.filter((de,we)=>we!==G).map((de,we)=>({...de,ordre:we+1}))),M(null))},[]),Z=g.useCallback(G=>{F(ve=>{const De=ve[G],de={...JSON.parse(JSON.stringify(De)),id:nr("q"),ordre:ve.length+1};return[...ve,de]})},[]),H=g.useCallback((G,ve)=>{F(De=>{const de=[...De],we=ve==="up"?G-1:G+1;return we<0||we>=de.length?De:([de[G],de[we]]=[de[we],de[G]],de.map((R,ae)=>({...R,ordre:ae+1})))}),M(ve==="up"?Y!==null?Y-1:null:Y!==null?Y+1:null)},[Y]),ce=g.useCallback((G,ve)=>{F(De=>De.map((de,we)=>we===G?{...de,...ve}:de))},[]),xe=async()=>{if(!o.trim()){L("Le titre est obligatoire");return}if(!p){L("Slectionnez une discipline");return}if($.length===0){L("Ajoutez au moins une question");return}for(let G=0;G<$.length;G++)if(!$[G].enonce.replace(/<[^>]*>/g,"").trim()){L(`La question ${G+1} n'a pas d'nonc`),M(G);return}L(null),ee(!0);try{const G={disciplineId:p,titre:o.trim(),description:d.trim()||void 0,questions:$,duree:v,isPremium:x,noteMinimale:_,melangerQuestions:C,melangerOptions:S,afficherCorrection:z,tentativesMax:P};let ve;e?.id?(await BR(e.id,G),ve=e.id):ve=await $R(G,n),a?.(ve)}catch(G){L(G.message||"Erreur lors de la sauvegarde")}finally{ee(!1)}},fe=$.reduce((G,ve)=>G+ve.points,0);return t.jsxs("div",{className:"quiz-editor",children:[t.jsxs("div",{className:"quiz-editor__header",children:[t.jsx("h2",{children:e?" Modifier le quiz":" Nouveau quiz avanc"}),t.jsxs("div",{className:"quiz-editor__header-actions",children:[t.jsxs("span",{className:"quiz-editor__score-badge",children:["Score total : ",fe," pts"]}),t.jsxs("span",{className:"quiz-editor__count-badge",children:[$.length," question",$.length>1?"s":""]})]})]}),X&&t.jsxs("div",{className:"quiz-editor__error",children:[" ",X,t.jsx("button",{onClick:()=>L(null),children:""})]}),t.jsxs("div",{className:"quiz-editor__section",children:[t.jsx("h3",{className:"quiz-editor__section-title",children:" Paramtres du quiz"}),t.jsxs("div",{className:"quiz-editor__grid",children:[t.jsxs("div",{className:"quiz-editor__field quiz-editor__field--full",children:[t.jsx("label",{children:"Titre du quiz *"}),t.jsx("input",{type:"text",value:o,onChange:G=>u(G.target.value),placeholder:"Ex: valuation Chapitre 3  Les fonctions",className:"quiz-editor__input"})]}),t.jsxs("div",{className:"quiz-editor__field",children:[t.jsx("label",{children:"Discipline *"}),t.jsxs("select",{value:p,onChange:G=>h(G.target.value),className:"quiz-editor__select",children:[t.jsx("option",{value:"",children:" Slectionner "}),r.map(G=>t.jsxs("option",{value:G.id,children:[G.nom," (",G.classe,")"]},G.id))]})]}),t.jsxs("div",{className:"quiz-editor__field",children:[t.jsx("label",{children:"Dure (minutes)"}),t.jsx("input",{type:"number",value:v,onChange:G=>b(Number(G.target.value)),min:1,max:180,className:"quiz-editor__input"})]}),t.jsxs("div",{className:"quiz-editor__field",children:[t.jsx("label",{children:"Note minimale (/20)"}),t.jsx("input",{type:"number",value:_,onChange:G=>w(Number(G.target.value)),min:0,max:20,className:"quiz-editor__input"})]}),t.jsxs("div",{className:"quiz-editor__field",children:[t.jsx("label",{children:"Tentatives max (0 = illimit)"}),t.jsx("input",{type:"number",value:P,onChange:G=>D(Number(G.target.value)),min:0,max:10,className:"quiz-editor__input"})]}),t.jsxs("div",{className:"quiz-editor__field quiz-editor__field--full",children:[t.jsx("label",{children:"Description (optionnel)"}),t.jsx(ja,{value:d,onChange:m,placeholder:"Dcrivez le contenu et les objectifs de ce quiz...",minHeight:80,toolbar:["bold","italic","underline","color","bulletList"]})]})]}),t.jsxs("div",{className:"quiz-editor__options-row",children:[t.jsxs("label",{className:"quiz-editor__checkbox",children:[t.jsx("input",{type:"checkbox",checked:x,onChange:G=>j(G.target.checked)}),t.jsx("span",{children:" Premium"})]}),t.jsxs("label",{className:"quiz-editor__checkbox",children:[t.jsx("input",{type:"checkbox",checked:C,onChange:G=>E(G.target.checked)}),t.jsx("span",{children:" Mlanger les questions"})]}),t.jsxs("label",{className:"quiz-editor__checkbox",children:[t.jsx("input",{type:"checkbox",checked:S,onChange:G=>A(G.target.checked)}),t.jsx("span",{children:" Mlanger les options QCM"})]}),t.jsxs("label",{className:"quiz-editor__checkbox",children:[t.jsx("input",{type:"checkbox",checked:z,onChange:G=>k(G.target.checked)}),t.jsx("span",{children:" Afficher la correction"})]})]})]}),t.jsxs("div",{className:"quiz-editor__section",children:[t.jsx("h3",{className:"quiz-editor__section-title",children:" Questions"}),t.jsx("div",{className:"quiz-editor__questions-list",children:$.map((G,ve)=>t.jsx(VR,{question:G,index:ve,isActive:Y===ve,onToggle:()=>M(Y===ve?null:ve),onUpdate:De=>ce(ve,De),onDelete:()=>T(ve),onDuplicate:()=>Z(ve),onMoveUp:()=>H(ve,"up"),onMoveDown:()=>H(ve,"down"),isFirst:ve===0,isLast:ve===$.length-1},G.id))}),t.jsxs("div",{className:"quiz-editor__add-wrapper",children:[t.jsx("button",{type:"button",className:"quiz-editor__add-btn",onClick:()=>U(!I),children:"+ Ajouter une question"}),I&&t.jsx("div",{className:"quiz-editor__add-menu",children:Object.keys(ho).map(G=>t.jsxs("button",{type:"button",className:"quiz-editor__add-menu-item",onClick:()=>B(G),children:[t.jsx("span",{className:"quiz-editor__type-badge",style:{backgroundColor:Cm[G]},children:wm[G]}),t.jsx("span",{children:ho[G]})]},G))})]})]}),t.jsxs("div",{className:"quiz-editor__actions",children:[t.jsx("button",{type:"button",className:"quiz-editor__btn quiz-editor__btn--secondary",onClick:l,disabled:K,children:"Annuler"}),t.jsx("button",{type:"button",className:"quiz-editor__btn quiz-editor__btn--primary",onClick:xe,disabled:K||$.length===0,children:K?" Sauvegarde...":e?" Mettre  jour":" Crer le quiz"})]})]})},VR=({question:e,index:r,isActive:n,onToggle:a,onUpdate:l,onDelete:o,onDuplicate:u,onMoveUp:d,onMoveDown:m,isFirst:p,isLast:h})=>{const v=Cm[e.type],b=wm[e.type],x=ho[e.type],j=_=>{const w=_.replace(/<[^>]*>/g,"").trim();return w.length>80?w.substring(0,80)+"...":w||"(sans nonc)"};return t.jsxs("div",{className:`question-editor ${n?"question-editor--active":""}`,style:{borderLeftColor:v},children:[t.jsxs("div",{className:"question-editor__header",onClick:a,children:[t.jsxs("div",{className:"question-editor__header-left",children:[t.jsx("span",{className:"question-editor__number",children:r+1}),t.jsxs("span",{className:"question-editor__type-badge",style:{backgroundColor:v},children:[b," ",x]}),!n&&t.jsx("span",{className:"question-editor__preview",children:j(e.enonce)})]}),t.jsxs("div",{className:"question-editor__header-right",children:[t.jsxs("span",{className:"question-editor__points",children:[e.points," pts"]}),t.jsx("span",{className:"question-editor__toggle",children:n?"":""})]})]}),n&&t.jsxs("div",{className:"question-editor__body",children:[t.jsxs("div",{className:"question-editor__toolbar",children:[t.jsx("button",{type:"button",onClick:d,disabled:p,title:"Monter",children:""}),t.jsx("button",{type:"button",onClick:m,disabled:h,title:"Descendre",children:""}),t.jsx("button",{type:"button",onClick:u,title:"Dupliquer",children:""}),t.jsx("button",{type:"button",onClick:o,className:"btn-danger",title:"Supprimer",children:""})]}),t.jsxs("div",{className:"question-editor__field",children:[t.jsx("label",{children:"nonc de la question *"}),t.jsx(ja,{value:e.enonce,onChange:_=>l({enonce:_}),placeholder:"Saisissez l'nonc de la question...",minHeight:100})]}),t.jsxs("div",{className:"question-editor__params",children:[t.jsxs("div",{className:"question-editor__param",children:[t.jsx("label",{children:"Difficult"}),t.jsxs("select",{value:e.difficulte,onChange:_=>l({difficulte:_.target.value}),children:[t.jsx("option",{value:"facile",children:" Facile"}),t.jsx("option",{value:"moyen",children:" Moyen"}),t.jsx("option",{value:"difficile",children:" Difficile"})]})]}),t.jsxs("div",{className:"question-editor__param",children:[t.jsx("label",{children:"Points"}),t.jsx("input",{type:"number",value:e.points,onChange:_=>l({points:Number(_.target.value)}),min:1,max:20})]})]}),t.jsxs("div",{className:"question-editor__type-specific",children:[e.type==="qcm_unique"&&t.jsx(QR,{data:e.typeData,onChange:_=>l({typeData:_})}),e.type==="qcm_multiple"&&t.jsx(YR,{data:e.typeData,onChange:_=>l({typeData:_})}),e.type==="drag_drop"&&t.jsx(KR,{data:e.typeData,onChange:_=>l({typeData:_})}),e.type==="mise_en_relation"&&t.jsx(WR,{data:e.typeData,onChange:_=>l({typeData:_})}),e.type==="essai"&&t.jsx(XR,{data:e.typeData,onChange:_=>l({typeData:_})})]}),t.jsxs("div",{className:"question-editor__field",children:[t.jsx("label",{children:"Explication (affiche aprs correction, optionnel)"}),t.jsx(ja,{value:e.explication||"",onChange:_=>l({explication:_}),placeholder:"Expliquez la bonne rponse...",minHeight:60,toolbar:["bold","italic","color","link"]})]})]})]})},QR=({data:e,onChange:r})=>{const n=(o,u)=>{const d=e.options.map((m,p)=>p===o?{...m,...u}:u.isCorrect===!0?{...m,isCorrect:!1}:m);r({options:d})},a=()=>{e.options.length>=6||r({options:[...e.options,{id:nr("opt"),texte:"",isCorrect:!1}]})},l=o=>{e.options.length<=2||r({options:e.options.filter((u,d)=>d!==o)})};return t.jsxs("div",{className:"type-editor",children:[t.jsx("label",{className:"type-editor__label",children:" Options (slectionnez la bonne rponse)"}),e.options.map((o,u)=>t.jsxs("div",{className:"type-editor__option-row",children:[t.jsx("input",{type:"radio",name:`qcm_unique_${o.id}`,checked:o.isCorrect,onChange:()=>n(u,{isCorrect:!0}),className:"type-editor__radio",title:"Bonne rponse"}),t.jsx("div",{className:"type-editor__option-text",children:t.jsx(ja,{value:o.texte,onChange:d=>n(u,{texte:d}),placeholder:`Option ${u+1}...`,minHeight:40,toolbar:["bold","italic","color","subscript","superscript"]})}),o.isCorrect&&t.jsx("span",{className:"type-editor__correct-badge",children:""}),t.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.options.length<=2,title:"Supprimer cette option",children:""})]},o.id)),e.options.length<6&&t.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter une option"})]})},YR=({data:e,onChange:r})=>{const n=(o,u)=>{const d=e.options.map((m,p)=>p===o?{...m,...u}:m);r({...e,options:d})},a=()=>{e.options.length>=8||r({...e,options:[...e.options,{id:nr("opt"),texte:"",isCorrect:!1}]})},l=o=>{e.options.length<=2||r({...e,options:e.options.filter((u,d)=>d!==o)})};return t.jsxs("div",{className:"type-editor",children:[t.jsx("label",{className:"type-editor__label",children:" Options (cochez toutes les bonnes rponses)"}),e.options.map((o,u)=>t.jsxs("div",{className:"type-editor__option-row",children:[t.jsx("input",{type:"checkbox",checked:o.isCorrect,onChange:d=>n(u,{isCorrect:d.target.checked}),className:"type-editor__checkbox",title:"Bonne rponse"}),t.jsx("div",{className:"type-editor__option-text",children:t.jsx(ja,{value:o.texte,onChange:d=>n(u,{texte:d}),placeholder:`Option ${u+1}...`,minHeight:40,toolbar:["bold","italic","color","subscript","superscript"]})}),o.isCorrect&&t.jsx("span",{className:"type-editor__correct-badge",children:""}),t.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.options.length<=2,children:""})]},o.id)),e.options.length<8&&t.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter une option"}),t.jsxs("label",{className:"type-editor__sub-option",children:[t.jsx("input",{type:"checkbox",checked:e.scoringPartiel,onChange:o=>r({...e,scoringPartiel:o.target.checked})}),t.jsx("span",{children:"Accorder des points partiels (proportionnel aux bonnes rponses trouves)"})]})]})},KR=({data:e,onChange:r})=>{const n=(o,u)=>{const d=e.items.map((m,p)=>p===o?{...m,...u}:m);r({...e,items:d})},a=()=>{e.items.length>=10||r({...e,items:[...e.items,{id:nr("item"),texte:"",ordreCorrect:e.items.length+1}]})},l=o=>{if(e.items.length<=2)return;const u=e.items.filter((d,m)=>m!==o).map((d,m)=>({...d,ordreCorrect:m+1}));r({...e,items:u})};return t.jsxs("div",{className:"type-editor",children:[t.jsx("label",{className:"type-editor__label",children:" lments  rordonner (dans l'ordre correct)"}),t.jsx("p",{className:"type-editor__hint",children:"Saisissez les lments dans l'ordre correct. Ils seront mlangs automatiquement pour l'lve."}),t.jsxs("div",{className:"type-editor__field-inline",children:[t.jsx("label",{children:"Consigne :"}),t.jsx("input",{type:"text",value:e.consigneOrdre,onChange:o=>r({...e,consigneOrdre:o.target.value}),placeholder:"Ex: Classez du plus ancien au plus rcent",className:"type-editor__input"})]}),e.items.map((o,u)=>t.jsxs("div",{className:"type-editor__drag-row",children:[t.jsx("span",{className:"type-editor__drag-number",children:u+1}),t.jsx("div",{className:"type-editor__option-text",children:t.jsx(ja,{value:o.texte,onChange:d=>n(u,{texte:d}),placeholder:`lment ${u+1}...`,minHeight:40,toolbar:["bold","italic","color"]})}),t.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.items.length<=2,children:""})]},o.id)),e.items.length<10&&t.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter un lment"})]})},WR=({data:e,onChange:r})=>{const n=(o,u)=>{const d=e.paires.map((m,p)=>p===o?{...m,...u}:m);r({paires:d})},a=()=>{e.paires.length>=8||r({paires:[...e.paires,{id:nr("pair"),gauche:"",droite:""}]})},l=o=>{e.paires.length<=2||r({paires:e.paires.filter((u,d)=>d!==o)})};return t.jsxs("div",{className:"type-editor",children:[t.jsx("label",{className:"type-editor__label",children:" Paires  relier (gauche  droite)"}),t.jsx("p",{className:"type-editor__hint",children:"Saisissez les correspondances correctes. La colonne droite sera mlange pour l'lve."}),t.jsxs("div",{className:"type-editor__relation-header",children:[t.jsx("span",{children:"Colonne A (gauche)"}),t.jsx("span",{}),t.jsx("span",{children:"Colonne B (droite)"}),t.jsx("span",{})]}),e.paires.map((o,u)=>t.jsxs("div",{className:"type-editor__relation-row",children:[t.jsx("div",{className:"type-editor__relation-cell",children:t.jsx(ja,{value:o.gauche,onChange:d=>n(u,{gauche:d}),placeholder:`lment A${u+1}...`,minHeight:40,toolbar:["bold","italic","color"]})}),t.jsx("span",{className:"type-editor__relation-arrow",children:""}),t.jsx("div",{className:"type-editor__relation-cell",children:t.jsx(ja,{value:o.droite,onChange:d=>n(u,{droite:d}),placeholder:`lment B${u+1}...`,minHeight:40,toolbar:["bold","italic","color"]})}),t.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.paires.length<=2,children:""})]},o.id)),e.paires.length<8&&t.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter une paire"})]})},XR=({data:e,onChange:r})=>{const n=()=>{r({...e,motsCles:[...e.motsCles,{mot:"",poids:1,obligatoire:!1}]})},a=(o,u)=>{const d=e.motsCles.map((m,p)=>p===o?{...m,...u}:m);r({...e,motsCles:d})},l=o=>{r({...e,motsCles:e.motsCles.filter((u,d)=>d!==o)})};return t.jsxs("div",{className:"type-editor",children:[t.jsx("label",{className:"type-editor__label",children:" Paramtres de l'essai"}),t.jsxs("div",{className:"type-editor__params-row",children:[t.jsxs("div",{className:"type-editor__param-inline",children:[t.jsx("label",{children:"Mots minimum :"}),t.jsx("input",{type:"number",value:e.nombreMotsMin||"",onChange:o=>r({...e,nombreMotsMin:Number(o.target.value)||void 0}),min:0,placeholder:"Ex: 50"})]}),t.jsxs("div",{className:"type-editor__param-inline",children:[t.jsx("label",{children:"Mots maximum :"}),t.jsx("input",{type:"number",value:e.nombreMotsMax||"",onChange:o=>r({...e,nombreMotsMax:Number(o.target.value)||void 0}),min:0,placeholder:"Ex: 500"})]})]}),t.jsxs("div",{className:"type-editor__field-inline",children:[t.jsx("label",{children:"Mode de correction :"}),t.jsxs("select",{value:e.correctionMode,onChange:o=>r({...e,correctionMode:o.target.value}),children:[t.jsx("option",{value:"manuelle",children:" Manuelle (par le prof)"}),t.jsx("option",{value:"mots_cles",children:" Par mots-cls (automatique)"}),t.jsx("option",{value:"semi_auto",children:" Semi-automatique (mots-cls + validation prof)"})]})]}),(e.correctionMode==="mots_cles"||e.correctionMode==="semi_auto")&&t.jsxs("div",{className:"type-editor__keywords",children:[t.jsx("label",{className:"type-editor__sub-label",children:"Mots-cls attendus"}),e.motsCles.map((o,u)=>t.jsxs("div",{className:"type-editor__keyword-row",children:[t.jsx("input",{type:"text",value:o.mot,onChange:d=>a(u,{mot:d.target.value}),placeholder:"Mot ou expression...",className:"type-editor__keyword-input"}),t.jsxs("select",{value:o.poids,onChange:d=>a(u,{poids:Number(d.target.value)}),className:"type-editor__keyword-weight",children:[t.jsx("option",{value:1,children:"Poids 1"}),t.jsx("option",{value:2,children:"Poids 2"}),t.jsx("option",{value:3,children:"Poids 3"}),t.jsx("option",{value:4,children:"Poids 4"}),t.jsx("option",{value:5,children:"Poids 5"})]}),t.jsxs("label",{className:"type-editor__keyword-required",children:[t.jsx("input",{type:"checkbox",checked:o.obligatoire,onChange:d=>a(u,{obligatoire:d.target.checked})}),t.jsx("span",{children:"Obligatoire"})]}),t.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),children:""})]},u)),t.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:n,children:"+ Ajouter un mot-cl"})]}),t.jsxs("div",{className:"type-editor__field-block",children:[t.jsx("label",{children:"Rponse modle (optionnel  pour le prof)"}),t.jsx(ja,{value:e.reponseModele||"",onChange:o=>r({...e,reponseModele:o}),placeholder:"Saisissez une rponse modle...",minHeight:80})]})]})},rS=()=>{const{quizId:e}=jn(),r=tt(),{currentUser:n}=Xe(),[a,l]=g.useState([]),[o,u]=g.useState(void 0),[d,m]=g.useState(!0),[p,h]=g.useState(null);return g.useEffect(()=>{(async()=>{try{m(!0);const b=await ls.getAll();if(l(b.map(x=>({id:x.id,nom:x.nom,classe:x.classe||""}))),e){const x=await JA(e);x?u(x):h("Quiz introuvable")}}catch(b){console.error("Erreur chargement donnes:",b),h(b.message||"Erreur de chargement")}finally{m(!1)}})()},[e]),d?t.jsx("div",{style:{textAlign:"center",padding:"3rem"},children:t.jsx("p",{children:" Chargement..."})}):p?t.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[t.jsxs("p",{style:{color:"#dc2626"},children:[" ",p]}),t.jsx("button",{onClick:()=>r(-1),children:" Retour"})]}):t.jsx(HR,{existingQuiz:o?{...o,id:o.id}:void 0,disciplines:a,auteurId:n?.uid||"",onSave:v=>{alert(" Quiz sauvegard avec succs !"),r("/admin/quiz")},onCancel:()=>r(-1)})},ZR=()=>{const e=tt(),{currentUser:r}=Xe(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[m,p]=g.useState(null);g.useEffect(()=>{h()},[]);const h=async()=>{try{o(!0),d(null);const _=await ez();a(_)}catch(_){console.error("Erreur chargement quiz:",_),d("Impossible de charger les quiz")}finally{o(!1)}},v=async _=>{try{await UR(_),a(w=>w.filter(C=>C.id!==_)),p(null)}catch(w){console.error("Erreur suppression:",w),alert("Erreur lors de la suppression : "+w.message)}},b=_=>{const w={};return _.questions.forEach(C=>{w[C.type]=(w[C.type]||0)+1}),Object.entries(w).map(([C,E])=>`${E} ${ho[C]||C}`).join(", ")},x=_=>_?(_.toDate?_.toDate():new Date(_)).toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric"}):"",j=_=>_.questions.reduce((w,C)=>w+C.points,0);return t.jsxs("div",{style:{padding:"1.5rem"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",flexWrap:"wrap",gap:"1rem"},children:[t.jsxs("div",{children:[t.jsx("h1",{style:{fontSize:"1.5rem",fontWeight:700,color:"#1f2937",margin:0},children:" Quiz Avancs (Multi-types)"}),t.jsxs("p",{style:{color:"#6b7280",margin:"0.25rem 0 0",fontSize:"0.9rem"},children:[n.length," quiz cr",n.length!==1?"s":""]})]}),t.jsx("button",{onClick:()=>e("/admin/quiz/nouveau"),style:{padding:"0.7rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:" Nouveau quiz avanc"})]}),u&&t.jsxs("div",{style:{padding:"1rem",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",color:"#991b1b",marginBottom:"1rem"},children:[" ",u,t.jsx("button",{onClick:h,style:{marginLeft:"1rem",padding:"0.3rem 0.8rem",background:"#fff",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer"},children:" Ressayer"})]}),l&&t.jsx("div",{style:{textAlign:"center",padding:"3rem",color:"#6b7280"},children:" Chargement des quiz..."}),!l&&n.length===0&&!u&&t.jsxs("div",{style:{textAlign:"center",padding:"3rem",background:"#f9fafb",borderRadius:"12px",border:"1px solid #e5e7eb"},children:[t.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),t.jsx("h3",{style:{color:"#374151",marginBottom:"0.5rem"},children:"Aucun quiz avanc"}),t.jsx("p",{style:{color:"#6b7280",marginBottom:"1.5rem"},children:"Crez votre premier quiz multi-types avec l'diteur riche !"}),t.jsx("button",{onClick:()=>e("/admin/quiz/nouveau"),style:{padding:"0.7rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:" Crer un quiz"})]}),!l&&n.length>0&&t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:n.map(_=>t.jsx("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e5e7eb",padding:"1.25rem",boxShadow:"0 1px 3px rgba(0,0,0,0.04)",transition:"box-shadow 0.2s"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"1rem"},children:[t.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[t.jsx("h3",{style:{fontSize:"1.05rem",fontWeight:700,color:"#1f2937",margin:0},children:_.titre}),_.isPremium&&t.jsx("span",{style:{padding:"0.15rem 0.5rem",background:"#fef3c7",color:"#92400e",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,border:"1px solid #fde68a"},children:" Premium"})]}),t.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.4rem",marginBottom:"0.5rem"},children:[t.jsxs("span",{style:{padding:"0.2rem 0.6rem",background:"#eff6ff",color:"#1d4ed8",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500},children:[" ",_.questions.length," question",_.questions.length!==1?"s":""]}),t.jsxs("span",{style:{padding:"0.2rem 0.6rem",background:"#f0fdf4",color:"#166534",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500},children:[" ",j(_)," pts"]}),t.jsxs("span",{style:{padding:"0.2rem 0.6rem",background:"#fdf4ff",color:"#86198f",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500},children:[" ",_.duree," min"]})]}),t.jsxs("p",{style:{fontSize:"0.8rem",color:"#6b7280",margin:0},children:["Types : ",b(_)]}),t.jsxs("p",{style:{fontSize:"0.75rem",color:"#9ca3af",margin:"0.25rem 0 0"},children:["Cr le ",x(_.createdAt)]})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,flexWrap:"wrap"},children:[t.jsx("button",{onClick:()=>e(`/quiz-avance/${_.id}`),title:"Tester le quiz",style:{padding:"0.5rem 0.9rem",background:"#f0fdf4",color:"#166534",border:"1px solid #bbf7d0",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Tester"}),t.jsx("button",{onClick:()=>e(`/admin/quiz/modifier/${_.id}`),title:"Modifier le quiz",style:{padding:"0.5rem 0.9rem",background:"#eff6ff",color:"#1d4ed8",border:"1px solid #bfdbfe",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Modifier"}),t.jsx("button",{onClick:()=>{const w=`${window.location.origin}/quiz-avance/${_.id}`;navigator.clipboard.writeText(w).then(()=>{alert(` Lien copi !

`+w+`

Partagez ce lien aux lves.`)})},title:"Copier le lien pour les lves",style:{padding:"0.5rem 0.9rem",background:"#fdf4ff",color:"#86198f",border:"1px solid #e9d5ff",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Lien"}),m===_.id?t.jsxs("div",{style:{display:"flex",gap:"0.3rem"},children:[t.jsx("button",{onClick:()=>v(_.id),style:{padding:"0.5rem 0.7rem",background:"#dc2626",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Confirmer"}),t.jsx("button",{onClick:()=>p(null),style:{padding:"0.5rem 0.7rem",background:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontSize:"0.8rem"},children:""})]}):t.jsx("button",{onClick:()=>p(_.id),title:"Supprimer le quiz",style:{padding:"0.5rem 0.9rem",background:"#fef2f2",color:"#991b1b",border:"1px solid #fecaca",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:""})]})]})},_.id))})]})},JR=({quiz:e,userId:r,onComplete:n,onQuit:a})=>{const l=g.useMemo(()=>{let D=[...e.questions];return e.melangerQuestions&&(D=D.sort(()=>Math.random()-.5)),D},[e]),[o,u]=g.useState(0),[d,m]=g.useState(new Map),[p,h]=g.useState(e.duree*60),[v,b]=g.useState(!1),[x,j]=g.useState(null),[_,w]=g.useState(!1),C=g.useRef(Date.now());g.useEffect(()=>{if(x)return;const D=setInterval(()=>{h($=>$<=1?(clearInterval(D),k(),0):$-1)},1e3);return()=>clearInterval(D)},[x]);const E=D=>{const $=Math.floor(D/60),F=D%60;return`${$.toString().padStart(2,"0")}:${F.toString().padStart(2,"0")}`},S=l[o],A=g.useCallback((D,$)=>{m(F=>{const Y=new Map(F),M=Y.get(D)||{questionId:D,type:S.type};return Y.set(D,{...M,...$}),Y})},[S]),z=D=>{D>=0&&D<l.length&&u(D)},k=async()=>{w(!1),b(!0);try{const D=Array.from(d.values()),$=Math.round((Date.now()-C.current)/1e3),F=await GR(e,r,D,$);j(F),n?.(F)}catch(D){alert("Erreur lors de la soumission : "+D.message)}finally{b(!1)}},P=d.size;return x?t.jsx("div",{className:"quiz-player quiz-player--results",children:t.jsxs("div",{className:"quiz-results",children:[t.jsxs("div",{className:`quiz-results__header ${x.reussi?"quiz-results__header--success":"quiz-results__header--fail"}`,children:[t.jsx("div",{className:"quiz-results__emoji",children:x.reussi?"":""}),t.jsx("h2",{children:x.reussi?"Flicitations !":"Quiz termin"}),t.jsxs("div",{className:"quiz-results__score",children:[t.jsxs("span",{className:"quiz-results__note",children:[x.note20,"/20"]}),t.jsxs("span",{className:"quiz-results__detail",children:[x.score,"/",x.scoreMax," points"]})]}),t.jsxs("div",{className:"quiz-results__time",children:[" Temps : ",E(x.tempsEcoule)]}),x.correctionManuelle&&t.jsx("p",{className:"quiz-results__pending",children:" Ce quiz contient des questions  correction manuelle. Votre note finale pourra tre ajuste par le professeur."})]}),e.afficherCorrection&&t.jsxs("div",{className:"quiz-results__details",children:[t.jsx("h3",{children:" Dtail des rponses"}),l.map((D,$)=>{const F=x.detailsParQuestion.find(Y=>Y.questionId===D.id);return t.jsxs("div",{className:`quiz-results__question ${F?.isCorrect?"quiz-results__question--correct":F?.isPartiel?"quiz-results__question--partial":"quiz-results__question--wrong"}`,children:[t.jsxs("div",{className:"quiz-results__q-header",children:[t.jsxs("span",{children:["Q",$+1," "," ",t.jsxs("span",{style:{color:Cm[D.type]},children:[wm[D.type]," ",ho[D.type]]})]}),t.jsxs("span",{className:"quiz-results__q-score",children:[F?.pointsObtenus||0,"/",F?.pointsMax||D.points," pts",F?.isCorrect&&" ",F?.isPartiel&&" ",!F?.isCorrect&&!F?.isPartiel&&" "]})]}),t.jsx("div",{className:"quiz-results__q-enonce",dangerouslySetInnerHTML:{__html:D.enonce}}),D.explication&&t.jsxs("div",{className:"quiz-results__q-explanation",children:[t.jsx("strong",{children:" Explication :"}),t.jsx("div",{dangerouslySetInnerHTML:{__html:D.explication}})]})]},D.id)})]}),t.jsx("div",{className:"quiz-results__actions",children:t.jsx("button",{className:"quiz-player__btn quiz-player__btn--primary",onClick:a,children:"Retour au tableau de bord"})})]})}):t.jsxs("div",{className:"quiz-player",children:[t.jsxs("div",{className:"quiz-player__topbar",children:[t.jsxs("div",{className:"quiz-player__info",children:[t.jsx("span",{className:"quiz-player__title",children:e.titre}),t.jsxs("span",{className:"quiz-player__progress",children:["Question ",o+1,"/",l.length]})]}),t.jsxs("div",{className:"quiz-player__topbar-right",children:[t.jsxs("span",{className:`quiz-player__timer ${p<60?"quiz-player__timer--danger":p<300?"quiz-player__timer--warning":""}`,children:[" ",E(p)]}),t.jsxs("span",{className:"quiz-player__answered",children:[P,"/",l.length," rpondue",P>1?"s":""]})]})]}),t.jsx("div",{className:"quiz-player__progress-bar",children:t.jsx("div",{className:"quiz-player__progress-fill",style:{width:`${(o+1)/l.length*100}%`}})}),t.jsxs("div",{className:"quiz-player__question-area",children:[t.jsxs("div",{className:"quiz-player__question-meta",children:[t.jsxs("span",{className:"quiz-player__type-badge",style:{backgroundColor:Cm[S.type]},children:[wm[S.type]," ",ho[S.type]]}),t.jsxs("span",{className:"quiz-player__points",children:[S.points," point",S.points>1?"s":""]})]}),t.jsx("div",{className:"quiz-player__enonce",dangerouslySetInnerHTML:{__html:S.enonce}}),t.jsxs("div",{className:"quiz-player__answer-area",children:[S.type==="qcm_unique"&&t.jsx(eI,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D),melangerOptions:e.melangerOptions}),S.type==="qcm_multiple"&&t.jsx(tI,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D),melangerOptions:e.melangerOptions}),S.type==="drag_drop"&&t.jsx(rI,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D)}),S.type==="mise_en_relation"&&t.jsx(nI,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D)}),S.type==="essai"&&t.jsx(aI,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D)})]})]}),t.jsxs("div",{className:"quiz-player__nav",children:[t.jsx("button",{className:"quiz-player__btn quiz-player__btn--secondary",onClick:()=>z(o-1),disabled:o===0,children:" Prcdent"}),t.jsx("div",{className:"quiz-player__pagination",children:l.map((D,$)=>t.jsx("button",{className:`quiz-player__page-dot ${$===o?"quiz-player__page-dot--current":""} ${d.has(D.id)?"quiz-player__page-dot--answered":""}`,onClick:()=>z($),title:`Question ${$+1}`,children:$+1},D.id))}),o<l.length-1?t.jsx("button",{className:"quiz-player__btn quiz-player__btn--primary",onClick:()=>z(o+1),children:"Suivant "}):t.jsx("button",{className:"quiz-player__btn quiz-player__btn--submit",onClick:()=>w(!0),disabled:v,children:v?" Envoi...":" Soumettre le quiz"})]}),_&&t.jsx("div",{className:"quiz-player__modal-overlay",children:t.jsxs("div",{className:"quiz-player__modal",children:[t.jsx("h3",{children:"Soumettre le quiz ?"}),t.jsxs("p",{children:["Vous avez rpondu  ",t.jsx("strong",{children:P})," question",P>1?"s":""," sur"," ",t.jsx("strong",{children:l.length}),"."]}),P<l.length&&t.jsxs("p",{className:"quiz-player__modal-warning",children:[" ",l.length-P," question",l.length-P>1?"s":""," sans rponse !"]}),t.jsxs("div",{className:"quiz-player__modal-actions",children:[t.jsx("button",{className:"quiz-player__btn quiz-player__btn--secondary",onClick:()=>w(!1),children:"Continuer le quiz"}),t.jsx("button",{className:"quiz-player__btn quiz-player__btn--submit",onClick:k,children:"Confirmer la soumission"})]})]})})]})},eI=({question:e,reponse:r,onUpdate:n,melangerOptions:a})=>{const l=e.typeData,o=g.useMemo(()=>a?[...l.options].sort(()=>Math.random()-.5):l.options,[l.options,a]);return t.jsx("div",{className:"player-qcm",children:o.map(u=>t.jsxs("label",{className:`player-qcm__option ${r?.selectedOptionId===u.id?"player-qcm__option--selected":""}`,children:[t.jsx("input",{type:"radio",name:`q_${e.id}`,checked:r?.selectedOptionId===u.id,onChange:()=>n({selectedOptionId:u.id})}),t.jsx("div",{className:"player-qcm__text",dangerouslySetInnerHTML:{__html:u.texte}})]},u.id))})},tI=({question:e,reponse:r,onUpdate:n,melangerOptions:a})=>{const l=e.typeData,o=g.useMemo(()=>a?[...l.options].sort(()=>Math.random()-.5):l.options,[l.options,a]),u=r?.selectedOptionIds||[],d=m=>{const p=u.includes(m)?u.filter(h=>h!==m):[...u,m];n({selectedOptionIds:p})};return t.jsxs("div",{className:"player-qcm",children:[t.jsx("p",{className:"player-qcm__hint",children:"Plusieurs rponses possibles"}),o.map(m=>t.jsxs("label",{className:`player-qcm__option ${u.includes(m.id)?"player-qcm__option--selected":""}`,children:[t.jsx("input",{type:"checkbox",checked:u.includes(m.id),onChange:()=>d(m.id)}),t.jsx("div",{className:"player-qcm__text",dangerouslySetInnerHTML:{__html:m.texte}})]},m.id))]})},rI=({question:e,reponse:r,onUpdate:n})=>{const a=e.typeData,[l,o]=g.useState(()=>r?.ordrePropose?r.ordrePropose.map(b=>a.items.find(x=>x.id===b)).filter(Boolean):[...a.items].sort(()=>Math.random()-.5)),[u,d]=g.useState(null);g.useEffect(()=>{n({ordrePropose:l.map(b=>b.id)})},[l]);const m=b=>{d(b)},p=(b,x)=>{if(b.preventDefault(),u===null||u===x)return;const j=[...l],[_]=j.splice(u,1);j.splice(x,0,_),o(j),d(x)},h=()=>{d(null)},v=(b,x)=>{const j=x==="up"?b-1:b+1;if(j<0||j>=l.length)return;const _=[...l];[_[b],_[j]]=[_[j],_[b]],o(_)};return t.jsxs("div",{className:"player-dragdrop",children:[t.jsx("p",{className:"player-dragdrop__consigne",children:a.consigneOrdre}),t.jsx("div",{className:"player-dragdrop__list",children:l.map((b,x)=>t.jsxs("div",{className:`player-dragdrop__item ${u===x?"player-dragdrop__item--dragging":""}`,draggable:!0,onDragStart:()=>m(x),onDragOver:j=>p(j,x),onDragEnd:h,children:[t.jsx("span",{className:"player-dragdrop__handle",children:""}),t.jsx("span",{className:"player-dragdrop__number",children:x+1}),t.jsx("div",{className:"player-dragdrop__text",dangerouslySetInnerHTML:{__html:b.texte}}),t.jsxs("div",{className:"player-dragdrop__mobile-btns",children:[t.jsx("button",{type:"button",onClick:()=>v(x,"up"),disabled:x===0,children:""}),t.jsx("button",{type:"button",onClick:()=>v(x,"down"),disabled:x===l.length-1,children:""})]})]},b.id))})]})},nI=({question:e,reponse:r,onUpdate:n})=>{const a=e.typeData,l=g.useMemo(()=>[...a.paires].sort(()=>Math.random()-.5),[a.paires]),[o,u]=g.useState(r?.relationsProposees||{}),[d,m]=g.useState(null);g.useEffect(()=>{n({relationsProposees:o})},[o]);const p=x=>{m(x)},h=x=>{d&&(u(j=>({...j,[d]:x})),m(null))},v=x=>{u(j=>{const _={...j};return delete _[x],_})},b=new Set(Object.values(o));return t.jsxs("div",{className:"player-relation",children:[t.jsx("p",{className:"player-relation__hint",children:"Cliquez sur un lment  gauche puis sur son correspondant  droite"}),t.jsxs("div",{className:"player-relation__columns",children:[t.jsxs("div",{className:"player-relation__col",children:[t.jsx("h4",{className:"player-relation__col-title",children:"Colonne A"}),a.paires.map(x=>t.jsxs("div",{className:`player-relation__item player-relation__item--left ${d===x.id?"player-relation__item--selected":""} ${o[x.id]?"player-relation__item--matched":""}`,onClick:()=>{o[x.id]?v(x.id):p(x.id)},children:[t.jsx("div",{dangerouslySetInnerHTML:{__html:x.gauche}}),o[x.id]&&t.jsx("span",{className:"player-relation__linked",children:""})]},x.id))]}),t.jsxs("div",{className:"player-relation__col",children:[t.jsx("h4",{className:"player-relation__col-title",children:"Colonne B"}),l.map(x=>t.jsxs("div",{className:`player-relation__item player-relation__item--right ${b.has(x.id)?"player-relation__item--matched":""} ${d&&!b.has(x.id)?"player-relation__item--clickable":""}`,onClick:()=>{d&&!b.has(x.id)&&h(x.id)},children:[t.jsx("div",{dangerouslySetInnerHTML:{__html:x.droite}}),b.has(x.id)&&t.jsx("span",{className:"player-relation__linked",children:""})]},x.id))]})]})]})},aI=({question:e,reponse:r,onUpdate:n})=>{const a=e.typeData,[l,o]=g.useState(r?.texteReponse||""),u=l.replace(/<[^>]*>/g,"").trim().split(/\s+/).filter(Boolean).length;return g.useEffect(()=>{n({texteReponse:l})},[l]),t.jsxs("div",{className:"player-essai",children:[t.jsxs("div",{className:"player-essai__info",children:[a.nombreMotsMin&&t.jsxs("span",{className:u<a.nombreMotsMin?"player-essai__warning":"",children:["Minimum : ",a.nombreMotsMin," mots"]}),a.nombreMotsMax&&t.jsxs("span",{className:u>a.nombreMotsMax?"player-essai__warning":"",children:["Maximum : ",a.nombreMotsMax," mots"]}),t.jsxs("span",{className:"player-essai__count",children:[u," mot",u>1?"s":""]})]}),t.jsx("textarea",{className:"player-essai__textarea",value:l,onChange:d=>o(d.target.value),placeholder:"Rdigez votre rponse ici...",rows:10})]})},iI=()=>{const{quizId:e}=jn(),r=tt(),{currentUser:n}=Xe(),[a,l]=g.useState(null),[o,u]=g.useState(!0),[d,m]=g.useState(null);return g.useEffect(()=>{(async()=>{if(!e){m("ID du quiz manquant"),u(!1);return}try{const h=await JA(e);if(!h){m("Quiz introuvable");return}if(h.isPremium&&!n?.isPremium){m("Ce quiz est rserv aux abonns Premium");return}l(h)}catch(h){console.error("Erreur chargement quiz:",h),m(h.message||"Impossible de charger le quiz")}finally{u(!1)}})()},[e,n]),o?t.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[t.jsx("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:""}),t.jsx("p",{children:"Chargement du quiz..."})]}):d?t.jsx("div",{style:{textAlign:"center",padding:"3rem",maxWidth:"500px",margin:"2rem auto"},children:t.jsxs("div",{style:{padding:"2rem",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px"},children:[t.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:""}),t.jsx("p",{style:{color:"#991b1b",fontWeight:600,marginBottom:"1rem"},children:d}),d.includes("Premium")&&t.jsx("button",{onClick:()=>r("/premium"),style:{padding:"0.6rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",marginRight:"0.5rem",fontWeight:600},children:" Devenir Premium"}),t.jsx("button",{onClick:()=>r(-1),style:{padding:"0.6rem 1.5rem",background:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:" Retour"})]})}):a?t.jsx(JR,{quiz:a,userId:n?.uid||"",onComplete:p=>{console.log(" Quiz termin  Note:",p.note20,"/20")},onQuit:()=>r("/dashboard")}):t.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[t.jsx("p",{children:"Quiz introuvable"}),t.jsx("button",{onClick:()=>r(-1),children:" Retour"})]})},sI=e=>{if(!e?.length)return{label:"",color:"#9ca3af"};const r=e.map(a=>a.difficulte),n=r.reduce((a,l)=>a+(l==="facile"?1:l==="moyen"?2:3),0)/r.length;return n<1.5?{label:"Facile",color:"#059669"}:n<2.5?{label:"Moyen",color:"#d97706"}:{label:"Difficile",color:"#dc2626"}},lI=e=>e?.reduce((r,n)=>r+(n.points??0),0)??0,oI=()=>{const e=tt(),{currentUser:r}=Xe(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(""),[m,p]=g.useState("");g.useEffect(()=>{(async()=>{try{const b=await ez();a(b)}catch{d("Impossible de charger les quiz.")}finally{o(!1)}})()},[]);const h=n.filter(v=>v.titre.toLowerCase().includes(m.toLowerCase())||(v.description??"").toLowerCase().includes(m.toLowerCase()));return t.jsxs("div",{style:{maxWidth:1100,margin:"0 auto",padding:"2rem 1rem"},children:[t.jsxs("div",{style:{marginBottom:"2rem"},children:[t.jsx("h1",{style:{fontSize:"1.8rem",fontWeight:800,color:"#1f2937",margin:"0 0 0.4rem"},children:" Quiz disponibles"}),t.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem",margin:0},children:"Testez vos connaissances avec nos quiz interactifs"})]}),t.jsx("div",{style:{marginBottom:"1.5rem"},children:t.jsx("input",{type:"text",placeholder:"Rechercher un quiz...",value:m,onChange:v=>p(v.target.value),style:{width:"100%",maxWidth:400,padding:"0.6rem 1rem",border:"1.5px solid #e5e7eb",borderRadius:10,fontSize:"0.9rem",outline:"none",boxSizing:"border-box"}})}),l&&t.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"#6b7280"},children:[t.jsx("div",{style:{width:36,height:36,border:"3px solid #e5e7eb",borderTopColor:"#2563eb",borderRadius:"50%",animation:"spin 0.8s linear infinite",margin:"0 auto 1rem"}}),"Chargement des quiz..."]}),u&&t.jsxs("div",{style:{background:"#fee2e2",color:"#dc2626",padding:"0.9rem 1.2rem",borderRadius:10,marginBottom:"1.5rem"},children:[" ",u]}),!l&&!u&&h.length===0&&t.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"#9ca3af"},children:[t.jsx("div",{style:{fontSize:"3rem",marginBottom:"0.75rem",opacity:.4},children:""}),t.jsx("p",{style:{margin:0},children:m?"Aucun quiz ne correspond  votre recherche.":"Aucun quiz disponible pour le moment."})]}),!l&&!u&&h.length>0&&t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1.25rem"},children:h.map(v=>{const b=sI(v.questions),x=lI(v.questions),j=v.questions?.length??0,_=v.isPremium,w=!_||r?.isPremium;return t.jsxs("div",{onClick:()=>w&&e(`/quiz-avance/${v.id}`),style:{background:"white",borderRadius:14,boxShadow:"0 2px 10px rgba(0,0,0,0.08)",padding:"1.25rem",cursor:w?"pointer":"default",opacity:w?1:.65,transition:"transform 0.15s, box-shadow 0.15s",border:"1.5px solid #f3f4f6",display:"flex",flexDirection:"column",gap:"0.6rem",position:"relative"},onMouseEnter:C=>{w&&(C.currentTarget.style.transform="translateY(-3px)",C.currentTarget.style.boxShadow="0 6px 20px rgba(0,0,0,0.12)")},onMouseLeave:C=>{C.currentTarget.style.transform="",C.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.08)"},children:[_&&t.jsx("span",{style:{position:"absolute",top:12,right:12,background:"#fef3c7",color:"#d97706",fontSize:"0.7rem",fontWeight:700,padding:"0.15rem 0.5rem",borderRadius:20},children:" Premium"}),t.jsx("h3",{style:{fontSize:"1.05rem",fontWeight:700,color:"#1f2937",margin:0,lineHeight:1.3,paddingRight:_?"4rem":0},children:v.titre}),v.description&&t.jsx("p",{style:{fontSize:"0.82rem",color:"#6b7280",margin:0,lineHeight:1.5,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},dangerouslySetInnerHTML:{__html:v.description}}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginTop:"0.25rem"},children:[t.jsxs("span",{style:{fontSize:"0.75rem",background:"#eff6ff",color:"#2563eb",padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:600},children:[" ",j," question",j>1?"s":""]}),t.jsxs("span",{style:{fontSize:"0.75rem",background:"#f3f4f6",color:"#374151",padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:600},children:[" ",v.duree," min"]}),x>0&&t.jsxs("span",{style:{fontSize:"0.75rem",background:"#f0fdf4",color:"#059669",padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:600},children:[" ",x," pts"]}),t.jsx("span",{style:{fontSize:"0.75rem",background:"#fafafa",color:b.color,padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:700,border:`1px solid ${b.color}30`},children:b.label})]}),t.jsx("button",{disabled:!w,onClick:C=>{C.stopPropagation(),w&&e(`/quiz-avance/${v.id}`)},style:{marginTop:"auto",padding:"0.55rem 1rem",background:w?"#2563eb":"#e5e7eb",color:w?"white":"#9ca3af",border:"none",borderRadius:8,fontWeight:600,fontSize:"0.85rem",cursor:w?"pointer":"not-allowed",transition:"background 0.15s"},children:w?" Commencer le quiz":" Premium requis"})]},v.id)})}),!l&&h.length>0&&t.jsxs("p",{style:{textAlign:"center",color:"#9ca3af",fontSize:"0.8rem",marginTop:"2rem"},children:[h.length," quiz",(h.length>1,"")," disponible",h.length>1?"s":""]})]})},cI="quizzes",uI="quizzes_v2",nS=50;function dI(e){const r=e.data();return{id:e.id,titre:r.titre||"Quiz sans titre",description:r.description||"",matiere:r.matiere||r.disciplineId||"",niveau:r.niveau||"",classe:r.classe||"",nombreQuestions:Array.isArray(r.questions)?r.questions.length:0,duree:r.duree||void 0,difficulte:r.difficulte||"moyen",source:"quizzes",isPremium:!1,createdAt:r.createdAt||void 0}}function mI(e){const r=e.data();return{id:e.id,titre:r.titre||"Quiz sans titre",description:r.description||"",matiere:r.matiere||"",niveau:r.niveau||"",classe:r.classe||"",nombreQuestions:Array.isArray(r.questions)?r.questions.length:0,duree:r.dureeEstimee||void 0,difficulte:r.difficulte||"moyen",source:"quizzes_v2",isPremium:!1,createdAt:r.createdAt||void 0}}async function tz(){const[e,r]=await Promise.all([Ae(ze(_e(V,cI),Se("isPremium","==",!1),Qe("createdAt","desc"),$t(nS))),Ae(ze(_e(V,uI),Se("isPremium","==",!1),Qe("createdAt","desc"),$t(nS)))]),n=e.docs.map(dI),a=r.docs.map(mI);return[...n,...a].sort((l,o)=>{const u=l.createdAt?.toMillis()??0;return(o.createdAt?.toMillis()??0)-u})}async function fI(){return(await tz()).slice(0,3)}const pI={facile:{label:"Facile",color:"#059669",bg:"#d1fae5"},moyen:{label:"Moyen",color:"#d97706",bg:"#fef3c7"},difficile:{label:"Difficile",color:"#dc2626",bg:"#fee2e2"}},hI=({quiz:e,onJouer:r,estConnecte:n})=>{const a=pI[e.difficulte??"moyen"];return t.jsxs("div",{className:"qg-card",onClick:()=>r(e),children:[t.jsxs("div",{className:"qg-card__header",children:[t.jsx("span",{className:`qg-card__source qg-card__source--${e.source}`,children:e.source==="quizzes_v2"?" Quiz avanc":" Quiz"}),t.jsx("span",{className:"qg-card__difficulte",style:{color:a.color,background:a.bg},children:a.label})]}),t.jsx("h3",{className:"qg-card__titre",children:e.titre}),e.description&&t.jsx("p",{className:"qg-card__description",children:e.description}),t.jsxs("div",{className:"qg-card__meta",children:[e.matiere&&t.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.matiere]}),e.classe&&t.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.classe]}),t.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.nombreQuestions," question",e.nombreQuestions>1?"s":""]}),e.duree&&t.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.duree," min"]})]}),t.jsx("button",{className:"qg-card__btn",children:n?" Commencer":" Aperu"})]})},vI=()=>t.jsxs("div",{className:"qg-banniere qg-banniere--inscription",children:[t.jsx("div",{className:"qg-banniere__icone",children:""}),t.jsxs("div",{className:"qg-banniere__texte",children:[t.jsx("h3",{children:"Connectez-vous pour accder  tous les quiz gratuits"}),t.jsx("p",{children:"Crez un compte gratuitement et commencez  vous entraner ds maintenant."})]}),t.jsxs("div",{className:"qg-banniere__actions",children:[t.jsx($e,{to:"/inscription",className:"btn btn-primary",children:"Crer un compte gratuit"}),t.jsx($e,{to:"/connexion",className:"btn btn-secondary",children:"Se connecter"})]})]}),gI=()=>t.jsxs("div",{className:"qg-banniere qg-banniere--premium",children:[t.jsx("div",{className:"qg-banniere__icone",children:""}),t.jsxs("div",{className:"qg-banniere__texte",children:[t.jsx("h3",{children:"Dbloquez les Quiz Avancs Premium"}),t.jsx("p",{children:"Accdez  des centaines de quiz avancs avec corrections dtailles, suivi de progression et bien plus encore."}),t.jsxs("p",{className:"qg-banniere__prix",children:[t.jsx("strong",{children:"Ds 10 000 FCFA / 3 mois"}),"  Accs illimit"]})]}),t.jsx($e,{to:"/premium",className:"btn btn-premium",children:" Devenir Premium"})]}),xI=()=>{const e=tt(),{currentUser:r}=Xe(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(""),[m,p]=g.useState(""),[h,v]=g.useState(""),[b,x]=g.useState(""),{matieres:j}=_n(),_=!!r,w=r?.isPremium??!1,C=r?.role==="prof"||r?.role==="admin";g.useEffect(()=>{(async()=>{o(!0),d("");try{const z=_?await tz():await fI();a(z)}catch(z){console.error("Erreur chargement quiz gratuits:",z),d("Impossible de charger les quiz. Veuillez ressayer.")}finally{o(!1)}})()},[_]);const E=n.filter(A=>{const z=!b||A.titre.toLowerCase().includes(b.toLowerCase())||A.matiere.toLowerCase().includes(b.toLowerCase()),k=!m||A.matiere.toLowerCase().includes(m.toLowerCase()),P=!h||(A.niveau??"").toLowerCase().includes(h.toLowerCase())||(A.classe??"").toLowerCase().includes(h.toLowerCase());return z&&k&&P}),S=A=>{if(!_){e("/connexion");return}A.source==="quizzes_v2"?e(`/quiz-avance/${A.id}`):e(`/quiz/${A.id}`)};return t.jsxs("div",{className:"qg-page",children:[t.jsxs("div",{className:"qg-hero",children:[t.jsxs("div",{className:"qg-hero__content",children:[t.jsx("h1",{className:"qg-hero__titre",children:" Quiz Gratuits"}),t.jsx("p",{className:"qg-hero__sous-titre",children:"Entranez-vous gratuitement avec nos quiz de rvision pour tous les niveaux du collge au lyce."}),t.jsxs("div",{className:"qg-hero__stats",children:[t.jsxs("span",{className:"qg-hero__stat",children:[t.jsx("strong",{children:n.length}),_?" quiz disponibles":"+ quiz"]}),t.jsxs("span",{className:"qg-hero__stat",children:[t.jsx("strong",{children:"100%"})," gratuit"]}),t.jsxs("span",{className:"qg-hero__stat",children:[t.jsx("strong",{children:"6me"}),"  ",t.jsx("strong",{children:"Terminale"})]})]})]}),(w||C)&&t.jsx($e,{to:"/quizzes",className:"qg-hero__lien-premium",children:" Voir les Quiz Premium "})]}),t.jsxs("div",{className:"qg-filtres",children:[t.jsx("div",{className:"qg-filtres__recherche",children:t.jsx("input",{type:"text",placeholder:" Rechercher un quiz...",value:b,onChange:A=>x(A.target.value),className:"qg-filtres__input"})}),t.jsxs("select",{value:m,onChange:A=>p(A.target.value),className:"qg-filtres__select",children:[t.jsx("option",{value:"",children:"Toutes les matires"}),j.map(A=>t.jsx("option",{value:A.valeur,children:A.label},A.valeur))]}),(m||h||b)&&t.jsx("button",{className:"qg-filtres__reset",onClick:()=>{p(""),v(""),x("")},children:" Rinitialiser"})]}),t.jsxs("div",{className:"qg-contenu",children:[l&&t.jsxs("div",{className:"qg-loading",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement des quiz..."})]}),!l&&u&&t.jsxs("div",{className:"qg-erreur",children:[t.jsxs("p",{children:[" ",u]}),t.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-secondary",children:"Ressayer"})]}),!l&&!u&&t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"qg-compteur",children:[E.length," quiz",E.length>1?"s":"",m?` en ${m}`:"",_?"":" (aperu  connectez-vous pour tout voir)"]}),E.length>0?t.jsx("div",{className:"qg-grille",children:E.map(A=>t.jsx(hI,{quiz:A,onJouer:S,estConnecte:_},`${A.source}-${A.id}`))}):t.jsxs("div",{className:"qg-vide",children:[t.jsx("p",{children:" Aucun quiz trouv pour ces critres."}),t.jsx("button",{onClick:()=>{p(""),x("")},className:"btn btn-secondary",children:"Voir tous les quiz"})]}),!_&&t.jsx(vI,{}),_&&!w&&!C&&t.jsx(gI,{})]})]})]})},rz=_e(V,"quiz_results"),Xb=_e(V,"progressions"),bI=async e=>{try{const r=await Ot(rz,{...e,datePassage:Ee.now()});return e.reussi&&await wI(e.userId,e.disciplineId,e.disciplineNom,e.quizId),r.id}catch(r){throw console.error("Erreur lors de la sauvegarde du rsultat :",r),r}},Of=async(e,r)=>{try{let n=ze(rz,Se("userId","==",e),Qe("datePassage","desc"));return r&&(n=ze(n,$t(r))),(await Ae(n)).docs.map(l=>({id:l.id,...l.data()}))}catch(n){throw console.error("Erreur rcupration historique :",n),n}},yI=async e=>{try{const r=await Of(e);if(r.length===0)return{totalQuizPasses:0,totalQuizReussis:0,moyenneGenerale:0,tempsTotal:0,meilleurScore:0,serieReussites:0,meilleureSerieReussites:0};const n=r.reduce((h,v)=>h+v.pourcentage,0),a=Math.round(n/r.length),l=Math.max(...r.map(h=>h.pourcentage)),o=r.reduce((h,v)=>h+(v.tempsEcoule||0),0),u=r.filter(h=>h.reussi).length;let d=0,m=0;for(const h of r)h.reussi?(d++,m=Math.max(m,d)):d=0;let p=0;for(const h of r)if(h.reussi)p++;else break;return{totalQuizPasses:r.length,totalQuizReussis:u,moyenneGenerale:a,tempsTotal:o,meilleurScore:l,serieReussites:p,meilleureSerieReussites:Math.max(m,p)}}catch(r){return console.error("Erreur calcul stats :",r),{totalQuizPasses:0,totalQuizReussis:0,moyenneGenerale:0,tempsTotal:0,meilleurScore:0,serieReussites:0,meilleureSerieReussites:0}}},jI=async e=>{try{const r=await Of(e);if(r.length===0)return[];const n={};for(const a of r){const l=a.disciplineId;n[l]||(n[l]=[]),n[l].push(a)}return Object.entries(n).map(([a,l])=>{const o=Math.round(l.reduce((v,b)=>v+b.pourcentage,0)/l.length),u=Math.max(...l.map(v=>v.pourcentage)),d=l[0].pourcentage,m=l.filter(v=>v.reussi).length,p=l.reduce((v,b)=>v+(b.tempsEcoule||0),0);let h="stable";if(l.length>=4){const v=l.slice(0,3),b=l.slice(3,6),x=v.reduce((_,w)=>_+w.pourcentage,0)/v.length,j=b.reduce((_,w)=>_+w.pourcentage,0)/b.length;x-j>5?h="up":j-x>5&&(h="down")}return{disciplineId:a,disciplineNom:l[0].disciplineNom||a,nombreQuiz:l.length,moyenne:o,meilleurScore:u,dernierScore:d,quizReussis:m,tempsTotal:p,tendance:h}})}catch(r){return console.error("Erreur progression par discipline :",r),[]}},_I=async(e,r)=>{try{return(await Of(e,r||20)).reverse().map(a=>({date:(a.datePassage?.toDate?a.datePassage.toDate():new Date(a.datePassage)).toLocaleDateString("fr-SN",{day:"2-digit",month:"2-digit"}),score:a.pourcentage,discipline:a.disciplineNom||a.disciplineId}))}catch(n){return console.error("Erreur donnes temporelles :",n),[]}},NI=async(e,r,n)=>{const a=`${e}_${r}`,l=je(Xb,a),o=await pt(l);if(o.exists())return{...o.data()};const[u,d]=await Promise.all([aS("ressources",r),aS("quizzes",r)]),m={userId:e,disciplineId:r,disciplineNom:n,ressourcesVues:[],quizReussis:[],totalRessources:u,totalQuiz:d,pourcentage:0,dernierAcces:Ee.now(),createdAt:Ee.now(),updatedAt:Ee.now()};return await rl(l,m),m},aS=async(e,r)=>{try{const n=ze(_e(V,e),Se("disciplineId","==",r));return(await Ae(n)).size}catch{return 0}},SI=e=>{if(e.totalRessources+e.totalQuiz===0)return 0;const n=e.totalRessources>0?e.ressourcesVues.length/e.totalRessources*40:0,a=e.totalQuiz>0?e.quizReussis.length/e.totalQuiz*60:0;return e.totalRessources===0?Math.min(100,Math.round(e.quizReussis.length/e.totalQuiz*100)):e.totalQuiz===0?Math.min(100,Math.round(e.ressourcesVues.length/e.totalRessources*100)):Math.min(100,Math.round(n+a))},wI=async(e,r,n,a)=>{try{const l=`${e}_${r}`,o=je(Xb,l),u=await NI(e,r,n);if(u.quizReussis.includes(a))return await Ve(o,{dernierAcces:Ee.now()}),u;const d=[...u.quizReussis,a],m={...u,quizReussis:d,dernierAcces:Ee.now(),updatedAt:Ee.now(),pourcentage:0};return m.pourcentage=SI(m),await rl(o,m),m}catch(l){throw console.error("Erreur enregistrement quiz russi :",l),l}},CI=async e=>{try{const r=ze(Xb,Se("userId","==",e));return(await Ae(r)).docs.map(a=>a.data())}catch(r){return console.error("Erreur rcupration progressions :",r),[]}},EI=async e=>{try{const r=await CI(e),n=await nz(e),a=r.reduce((d,m)=>d+m.ressourcesVues.length,0),l=r.reduce((d,m)=>d+m.quizReussis.length,0),o=r.length>0?Math.round(r.reduce((d,m)=>d+m.pourcentage,0)/r.length):0,u=r.filter(d=>d.pourcentage>=100).length;return{totalRessourcesVues:a,totalQuizReussis:l,pourcentageMoyen:o,disciplinesCommencees:r.length,disciplinesCompletees:u,streakActuel:n.streakActuel,meilleurStreak:n.meilleurStreak,parDiscipline:r}}catch(r){return console.error("Erreur progression globale :",r),{totalRessourcesVues:0,totalQuizReussis:0,pourcentageMoyen:0,disciplinesCommencees:0,disciplinesCompletees:0,streakActuel:0,meilleurStreak:0,parDiscipline:[]}}},AI=()=>new Date().toISOString().split("T")[0],zI=()=>{const e=new Date;return e.setDate(e.getDate()-1),e.toISOString().split("T")[0]},nz=async e=>{try{const r=je(V,"users",e),n=await pt(r);if(!n.exists())return{streakActuel:0,meilleurStreak:0,dernierJourAcces:""};const a=n.data();return{streakActuel:a.streakActuel||0,meilleurStreak:a.meilleurStreak||0,dernierJourAcces:a.dernierJourAcces||""}}catch(r){return console.error("Erreur rcupration streak :",r),{streakActuel:0,meilleurStreak:0,dernierJourAcces:""}}},kI=async e=>{try{const r=je(V,"users",e),n=await nz(e),a=AI();if(n.dernierJourAcces===a)return n;const l=zI();let o;n.dernierJourAcces===l?o=n.streakActuel+1:o=1;const u=Math.max(n.meilleurStreak,o);return await Ve(r,{streakActuel:o,meilleurStreak:u,dernierJourAcces:a}),{streakActuel:o,meilleurStreak:u,dernierJourAcces:a}}catch(r){return console.error("Erreur mise  jour streak :",r),{streakActuel:0,meilleurStreak:0,dernierJourAcces:""}}},OI=(e,r,n)=>{const a=n?.totalRessourcesVues||0;n?.totalQuizReussis;const l=n?.disciplinesCompletees||0;n?.streakActuel;const o=n?.meilleurStreak||0,u=n?.disciplinesCommencees||0;return[{id:"premier_pas",nom:"Premier pas ",description:"Consulter votre premire ressource",icone:"",condition:"1 ressource consulte",categorie:"ressources",obtenu:a>=1},{id:"lecteur_assidu",nom:"Lecteur assidu ",description:"Consulter 10 ressources",icone:"",condition:"10 ressources consultes",categorie:"ressources",obtenu:a>=10},{id:"bibliophile",nom:"Bibliophile ",description:"Consulter 25 ressources",icone:"",condition:"25 ressources consultes",categorie:"ressources",obtenu:a>=25},{id:"savant",nom:"Savant ",description:"Consulter 50 ressources",icone:"",condition:"50 ressources consultes",categorie:"ressources",obtenu:a>=50},{id:"premier_quiz",nom:"Apprenti ",description:"Passer votre premier quiz",icone:"",condition:"1 quiz pass",categorie:"quiz",obtenu:e.totalQuizPasses>=1},{id:"challenger",nom:"Challenger ",description:"Russir 5 quiz",icone:"",condition:"5 quiz russis",categorie:"quiz",obtenu:e.totalQuizReussis>=5},{id:"dix_quiz",nom:"Dcathlon ",description:"Passer 10 quiz",icone:"",condition:"10 quiz passs",categorie:"quiz",obtenu:e.totalQuizPasses>=10},{id:"cinquante_quiz",nom:"Marathonien ",description:"Passer 50 quiz",icone:"",condition:"50 quiz passs",categorie:"quiz",obtenu:e.totalQuizPasses>=50},{id:"score_parfait",nom:"Score parfait ",description:"Obtenir 100%  un quiz",icone:"",condition:"100%  un quiz",categorie:"performance",obtenu:e.meilleurScore>=100},{id:"moyenne_80",nom:"Excellent ",description:"Moyenne gnrale de 80%+",icone:"",condition:"Moyenne  80% (min. 5 quiz)",categorie:"performance",obtenu:e.moyenneGenerale>=80&&e.totalQuizPasses>=5},{id:"serie_5",nom:"Imbattable ",description:"5 quiz russis d'affile",icone:"",condition:"Srie de 5 russites",categorie:"performance",obtenu:e.meilleureSerieReussites>=5},{id:"serie_10",nom:"Lgende ",description:"10 quiz russis d'affile",icone:"",condition:"Srie de 10 russites",categorie:"performance",obtenu:e.meilleureSerieReussites>=10},{id:"maitre",nom:"Matre ",description:"Complter 100% d'une discipline",icone:"",condition:"1 discipline  100%",categorie:"discipline",obtenu:l>=1},{id:"explorateur_teranga",nom:"Explorateur Teranga ",description:"Commencer 3 disciplines diffrentes",icone:"",condition:"3 disciplines commences",categorie:"discipline",obtenu:u>=3||r.length>=3},{id:"touche_a_tout",nom:"Touche--tout ",description:"Commencer 5 disciplines diffrentes",icone:"",condition:"5 disciplines commences",categorie:"discipline",obtenu:u>=5||r.length>=5},{id:"en_feu_3",nom:"Rgulier ",description:"3 jours de connexion conscutifs",icone:"",condition:"3 jours conscutifs",categorie:"streak",obtenu:o>=3},{id:"en_feu_7",nom:"En feu ",description:"7 jours de connexion conscutifs",icone:"",condition:"7 jours conscutifs",categorie:"streak",obtenu:o>=7},{id:"en_feu_30",nom:"Infatigable ",description:"30 jours de connexion conscutifs",icone:"",condition:"30 jours conscutifs",categorie:"streak",obtenu:o>=30},{id:"diamant",nom:"Diamant ",description:"50 ressources + 20 quiz russis",icone:"",condition:"50 ressources + 20 quiz",categorie:"performance",obtenu:a>=50&&e.totalQuizReussis>=20}]},az=e=>{if(e<60)return`${e} s`;const r=Math.floor(e/60),n=e%60;return n>0?`${r} min ${n.toString().padStart(2,"0")} s`:`${r} min`},ao=e=>e>=80?"#10b981":e>=60?"#3b82f6":e>=40?"#f59e0b":"#ef4444",iz=e=>e>=80?"Excellent":e>=60?"Bien":e>=40?"Passable":" amliorer",DI=()=>{const{quizId:e}=jn(),r=tt(),{currentUser:n}=Xe(),[a,l]=g.useState(null),[o,u]=g.useState(""),[d,m]=g.useState(!0),[p,h]=g.useState(null),[v,b]=g.useState("intro"),[x,j]=g.useState(0),[_,w]=g.useState({}),[C,E]=g.useState(0),[S,A]=g.useState(0),z=g.useRef(null),[k,P]=g.useState(0),[D,$]=g.useState(0),[F,Y]=g.useState(0),[M,K]=g.useState(!1),[ee,X]=g.useState(!1);g.useEffect(()=>{(async()=>{if(!e){h("ID du quiz manquant."),m(!1);return}try{const G=await vR(e);if(!G){h("Quiz introuvable."),m(!1);return}l(G),E(G.duree*60);try{const De=(await ls.getAll()).find(de=>de.id===G.disciplineId);u(De?.nom||G.disciplineId)}catch{u(G.disciplineId)}}catch(G){h("Erreur lors du chargement du quiz."),console.error(G)}finally{m(!1)}})()},[e]),g.useEffect(()=>{if(v==="playing")return z.current=setInterval(()=>{E(fe=>fe<=1?(clearInterval(z.current),B(),0):fe-1),A(fe=>fe+1)},1e3),()=>{z.current&&clearInterval(z.current)}},[v]);const L=()=>{b("playing"),j(0),w({}),A(0),a&&E(a.duree*60)},I=(fe,G)=>{w(ve=>({...ve,[fe]:G}))},U=fe=>{a&&fe>=0&&fe<a.questions.length&&j(fe)},B=g.useCallback(async()=>{if(!a||!n||v==="review")return;z.current&&clearInterval(z.current);let fe=0,G=0,ve=0;a.questions.forEach(we=>{const R=we.points||1;G+=R,_[we.id]===we.reponseCorrecte&&(fe+=R,ve++)});const De=G>0?Math.round(fe/G*100):0,de=De>=(a.noteMinimale||50);P(fe),$(G),Y(ve),b("review"),K(!0);try{const we={quizId:a.id,quizTitre:a.titre,disciplineId:a.disciplineId,disciplineNom:o,userId:n.uid,reponses:a.questions.map(R=>_[R.id]??-1),tempsEcoule:S,score:fe,totalPoints:G,pourcentage:De,reussi:de,nombreQuestions:a.questions.length,bonnesReponses:ve};await bI(we),X(!0)}catch(we){console.error("Erreur lors de la sauvegarde :",we)}finally{K(!1)}},[a,n,_,S,o,v]),T=fe=>{const G=Math.floor(fe/60),ve=fe%60;return`${G.toString().padStart(2,"0")}:${ve.toString().padStart(2,"0")}`},Z=()=>{if(!a)return"";const fe=a.duree*60,G=C/fe;return G<=.1?"timer-critical":G<=.25?"timer-warning":""},H=Object.keys(_).length;if(d)return t.jsxs("div",{className:"quiz-player-loading",children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement du quiz..."})]});if(p||!a)return t.jsxs("div",{className:"quiz-player-error",children:[t.jsx(_m,{size:48}),t.jsx("h3",{children:p||"Quiz introuvable"}),t.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>r("/eleve/dashboard"),children:[t.jsx(Mx,{size:18})," Retour au tableau de bord"]})]});if(a.isPremium&&!n?.isPremium)return t.jsx("div",{className:"quiz-player-locked",children:t.jsxs("div",{className:"qp-locked-card",children:[t.jsx(Nm,{size:48}),t.jsx("h3",{children:"Quiz Premium"}),t.jsx("p",{children:"Ce quiz est rserv aux abonns Premium."}),t.jsxs("p",{className:"qp-locked-price",children:[" partir de ",t.jsx("strong",{children:"2 000 FCFA/mois"})]}),t.jsxs("div",{className:"qp-locked-actions",children:[t.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>r("/premium"),children:[t.jsx(jr,{size:18})," Devenir Premium"]}),t.jsxs("button",{className:"qp-btn qp-btn-outline",onClick:()=>r("/eleve/dashboard"),children:[t.jsx(Uv,{size:18})," Retour"]})]})]})});if(v==="intro")return t.jsx("div",{className:"quiz-player-intro",children:t.jsxs("div",{className:"qp-intro-card",children:[t.jsxs("div",{className:"qp-intro-header",children:[t.jsxs("button",{className:"qp-back-btn",onClick:()=>r(-1),children:[t.jsx(Uv,{size:20})," Retour"]}),a.isPremium&&t.jsxs("span",{className:"qp-badge qp-badge-premium",children:[t.jsx(jr,{size:12})," Premium"]})]}),t.jsxs("div",{className:"qp-intro-content",children:[t.jsx("h1",{className:"qp-intro-title",children:a.titre}),t.jsx("span",{className:"qp-intro-discipline",children:o}),t.jsxs("div",{className:"qp-intro-stats",children:[t.jsxs("div",{className:"qp-intro-stat",children:[t.jsx(xn,{size:20}),t.jsxs("div",{children:[t.jsx("span",{className:"qp-intro-stat-value",children:a.questions.length}),t.jsx("span",{className:"qp-intro-stat-label",children:"Questions"})]})]}),t.jsxs("div",{className:"qp-intro-stat",children:[t.jsx(po,{size:20}),t.jsxs("div",{children:[t.jsxs("span",{className:"qp-intro-stat-value",children:[a.duree," min"]}),t.jsx("span",{className:"qp-intro-stat-label",children:"Dure"})]})]}),t.jsxs("div",{className:"qp-intro-stat",children:[t.jsx(ns,{size:20}),t.jsxs("div",{children:[t.jsxs("span",{className:"qp-intro-stat-value",children:[a.noteMinimale||50,"%"]}),t.jsx("span",{className:"qp-intro-stat-label",children:"Note min."})]})]})]}),t.jsxs("div",{className:"qp-intro-instructions",children:[t.jsx("h3",{children:"Instructions"}),t.jsxs("ul",{children:[t.jsx("li",{children:"Rpondez  toutes les questions dans le temps imparti"}),t.jsx("li",{children:"Chaque question a une seule bonne rponse"}),t.jsx("li",{children:"Vous pouvez naviguer entre les questions"}),t.jsx("li",{children:"Le quiz est soumis automatiquement quand le temps est coul"}),t.jsxs("li",{children:["Il faut obtenir au moins ",a.noteMinimale||50,"% pour russir"]})]})]})]}),t.jsxs("button",{className:"qp-btn qp-btn-start",onClick:L,children:[t.jsx(so,{size:20})," Commencer le quiz"]})]})});if(v==="playing"){const fe=a.questions[x];return t.jsxs("div",{className:"quiz-player-game",children:[t.jsxs("div",{className:"qp-game-header",children:[t.jsxs("div",{className:"qp-game-info",children:[t.jsx("span",{className:"qp-game-title",children:a.titre}),t.jsx("span",{className:"qp-game-discipline",children:o})]}),t.jsxs("div",{className:`qp-timer ${Z()}`,children:[t.jsx(F3,{size:18}),t.jsx("span",{children:T(C)})]})]}),t.jsx("div",{className:"qp-progress-bar",children:t.jsx("div",{className:"qp-progress-fill",style:{width:`${(x+1)/a.questions.length*100}%`}})}),t.jsxs("div",{className:"qp-game-content",children:[t.jsxs("div",{className:"qp-question-header",children:[t.jsxs("span",{className:"qp-question-number",children:["Question ",x+1,"/",a.questions.length]}),t.jsxs("span",{className:"qp-question-points",children:[fe.points||1," pt(s)"]})]}),t.jsx("h2",{className:"qp-question-text",children:fe.question}),t.jsx("div",{className:"qp-options-list",children:fe.options.map((G,ve)=>t.jsxs("button",{className:`qp-option ${_[fe.id]===ve?"selected":""}`,onClick:()=>I(fe.id,ve),children:[t.jsx("span",{className:"qp-option-letter",children:String.fromCharCode(65+ve)}),t.jsx("span",{className:"qp-option-text",children:G}),_[fe.id]===ve&&t.jsx(Ht,{size:18,className:"qp-option-check"})]},ve))})]}),t.jsxs("div",{className:"qp-game-footer",children:[t.jsx("div",{className:"qp-question-indicators",children:a.questions.map((G,ve)=>t.jsx("button",{className:`qp-indicator ${ve===x?"active":""} ${_[G.id]!==void 0?"answered":""}`,onClick:()=>U(ve),children:ve+1},G.id))}),t.jsxs("div",{className:"qp-nav-buttons",children:[t.jsxs("button",{className:"qp-btn qp-btn-outline",onClick:()=>U(x-1),disabled:x===0,children:[t.jsx(Uv,{size:16})," Prcdent"]}),x<a.questions.length-1?t.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>U(x+1),children:["Suivant ",t.jsx(Os,{size:16})]}):t.jsxs("button",{className:"qp-btn qp-btn-submit",onClick:B,disabled:H<a.questions.length,children:[t.jsx(Ht,{size:16}),"Soumettre (",H,"/",a.questions.length,")"]})]})]})]})}const ce=D>0?Math.round(k/D*100):0,xe=ce>=(a.noteMinimale||50);return t.jsxs("div",{className:"quiz-player-review",children:[t.jsxs("div",{className:`qp-score-card ${xe?"success":"fail"}`,children:[t.jsx("div",{className:"qp-score-icon",children:xe?t.jsx(ns,{size:48}):t.jsx(_m,{size:48})}),t.jsx("h2",{className:"qp-score-title",children:xe?"Flicitations ! ":"Continuez vos efforts ! "}),t.jsxs("div",{className:"qp-score-circle",style:{borderColor:ao(ce)},children:[t.jsxs("span",{className:"qp-score-value",children:[ce,"%"]}),t.jsx("span",{className:"qp-score-label",children:iz(ce)})]}),t.jsxs("div",{className:"qp-score-details",children:[t.jsxs("div",{className:"qp-score-detail",children:[t.jsxs("span",{children:[F,"/",a.questions.length]}),t.jsx("small",{children:"Bonnes rponses"})]}),t.jsxs("div",{className:"qp-score-detail",children:[t.jsxs("span",{children:[k,"/",D]}),t.jsx("small",{children:"Points"})]}),t.jsxs("div",{className:"qp-score-detail",children:[t.jsx("span",{children:az(S)}),t.jsx("small",{children:"Temps"})]})]}),M&&t.jsx("p",{className:"qp-saving",children:"Sauvegarde en cours..."}),ee&&t.jsx("p",{className:"qp-saved",children:" Rsultat sauvegard"})]}),t.jsxs("div",{className:"qp-review-actions",children:[t.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>r("/eleve/dashboard"),children:[t.jsx(Mx,{size:18})," Tableau de bord"]}),t.jsxs("button",{className:"qp-btn qp-btn-outline",onClick:L,children:[t.jsx(G3,{size:18})," Recommencer"]})]}),t.jsxs("div",{className:"qp-review-questions",children:[t.jsx("h3",{className:"qp-review-title",children:"Correction dtaille"}),a.questions.map((fe,G)=>{const ve=_[fe.id],De=ve===fe.reponseCorrecte;return t.jsxs("div",{className:`qp-review-question ${De?"correct":"incorrect"}`,children:[t.jsxs("div",{className:"qp-review-question-header",children:[t.jsxs("span",{className:"qp-review-q-number",children:["Q",G+1]}),De?t.jsxs("span",{className:"qp-review-badge correct",children:[t.jsx(Ht,{size:14})," Correct"]}):t.jsxs("span",{className:"qp-review-badge incorrect",children:[t.jsx(qx,{size:14})," Incorrect"]}),t.jsxs("span",{className:"qp-review-q-points",children:[De?fe.points||1:0,"/",fe.points||1," pt(s)"]})]}),t.jsx("p",{className:"qp-review-q-text",children:fe.question}),t.jsx("div",{className:"qp-review-options",children:fe.options.map((de,we)=>{let R="qp-review-option";return we===fe.reponseCorrecte&&(R+=" correct-answer"),we===ve&&!De&&(R+=" wrong-answer"),t.jsxs("div",{className:R,children:[t.jsx("span",{className:"qp-review-option-letter",children:String.fromCharCode(65+we)}),t.jsx("span",{children:de}),we===fe.reponseCorrecte&&t.jsx(Ht,{size:14,className:"qp-review-check"}),we===ve&&!De&&t.jsx(qx,{size:14,className:"qp-review-x"})]},we)})}),fe.explication&&t.jsxs("div",{className:"qp-review-explication",children:[t.jsx("strong",{children:" Explication :"})," ",fe.explication]})]},fe.id)})]})]})};function sz(e){var r,n,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var l=e.length;for(r=0;r<l;r++)e[r]&&(n=sz(e[r]))&&(a&&(a+=" "),a+=n)}else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}function Ct(){for(var e,r,n=0,a="",l=arguments.length;n<l;n++)(e=arguments[n])&&(r=sz(e))&&(a&&(a+=" "),a+=r);return a}var PI=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Zb(e){if(typeof e!="string")return!1;var r=PI;return r.includes(e)}var MI=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],TI=new Set(MI);function lz(e){return typeof e!="string"?!1:TI.has(e)}function oz(e){return typeof e=="string"&&e.startsWith("data-")}function ra(e){if(typeof e!="object"||e===null)return{};var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(lz(n)||oz(n))&&(r[n]=e[n]);return r}function mu(e){if(e==null)return null;if(g.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var r=e.props;return ra(r)}return typeof e=="object"&&!Array.isArray(e)?ra(e):null}function Hr(e){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(lz(n)||oz(n)||Zb(n))&&(r[n]=e[n]);return r}function qI(e){return e==null?null:g.isValidElement(e)?Hr(e.props):typeof e=="object"&&!Array.isArray(e)?Hr(e):null}var RI=["children","width","height","viewBox","className","style","title","desc"];function Lx(){return Lx=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Lx.apply(null,arguments)}function II(e,r){if(e==null)return{};var n,a,l=LI(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function LI(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var cz=g.forwardRef((e,r)=>{var{children:n,width:a,height:l,viewBox:o,className:u,style:d,title:m,desc:p}=e,h=II(e,RI),v=o||{width:a,height:l,x:0,y:0},b=Ct("recharts-surface",u);return g.createElement("svg",Lx({},Hr(h),{className:b,width:a,height:l,style:d,viewBox:"".concat(v.x," ").concat(v.y," ").concat(v.width," ").concat(v.height),ref:r}),g.createElement("title",null,m),g.createElement("desc",null,p),n)}),$I=["children","className"];function $x(){return $x=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},$x.apply(null,arguments)}function BI(e,r){if(e==null)return{};var n,a,l=UI(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function UI(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var $n=g.forwardRef((e,r)=>{var{children:n,className:a}=e,l=BI(e,$I),o=Ct("recharts-layer",a);return g.createElement("g",$x({className:o},Hr(l),{ref:r}),n)}),FI=g.createContext(null);function zt(e){return function(){return e}}const uz=Math.cos,Em=Math.sin,ia=Math.sqrt,Am=Math.PI,Df=2*Am,Bx=Math.PI,Ux=2*Bx,Ds=1e-6,GI=Ux-Ds;function dz(e){this._+=e[0];for(let r=1,n=e.length;r<n;++r)this._+=arguments[r]+e[r]}function HI(e){let r=Math.floor(e);if(!(r>=0))throw new Error(`invalid digits: ${e}`);if(r>15)return dz;const n=10**r;return function(a){this._+=a[0];for(let l=1,o=a.length;l<o;++l)this._+=Math.round(arguments[l]*n)/n+a[l]}}class VI{constructor(r){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=r==null?dz:HI(r)}moveTo(r,n){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(r,n){this._append`L${this._x1=+r},${this._y1=+n}`}quadraticCurveTo(r,n,a,l){this._append`Q${+r},${+n},${this._x1=+a},${this._y1=+l}`}bezierCurveTo(r,n,a,l,o,u){this._append`C${+r},${+n},${+a},${+l},${this._x1=+o},${this._y1=+u}`}arcTo(r,n,a,l,o){if(r=+r,n=+n,a=+a,l=+l,o=+o,o<0)throw new Error(`negative radius: ${o}`);let u=this._x1,d=this._y1,m=a-r,p=l-n,h=u-r,v=d-n,b=h*h+v*v;if(this._x1===null)this._append`M${this._x1=r},${this._y1=n}`;else if(b>Ds)if(!(Math.abs(v*m-p*h)>Ds)||!o)this._append`L${this._x1=r},${this._y1=n}`;else{let x=a-u,j=l-d,_=m*m+p*p,w=x*x+j*j,C=Math.sqrt(_),E=Math.sqrt(b),S=o*Math.tan((Bx-Math.acos((_+b-w)/(2*C*E)))/2),A=S/E,z=S/C;Math.abs(A-1)>Ds&&this._append`L${r+A*h},${n+A*v}`,this._append`A${o},${o},0,0,${+(v*x>h*j)},${this._x1=r+z*m},${this._y1=n+z*p}`}}arc(r,n,a,l,o,u){if(r=+r,n=+n,a=+a,u=!!u,a<0)throw new Error(`negative radius: ${a}`);let d=a*Math.cos(l),m=a*Math.sin(l),p=r+d,h=n+m,v=1^u,b=u?l-o:o-l;this._x1===null?this._append`M${p},${h}`:(Math.abs(this._x1-p)>Ds||Math.abs(this._y1-h)>Ds)&&this._append`L${p},${h}`,a&&(b<0&&(b=b%Ux+Ux),b>GI?this._append`A${a},${a},0,1,${v},${r-d},${n-m}A${a},${a},0,1,${v},${this._x1=p},${this._y1=h}`:b>Ds&&this._append`A${a},${a},0,${+(b>=Bx)},${v},${this._x1=r+a*Math.cos(o)},${this._y1=n+a*Math.sin(o)}`)}rect(r,n,a,l){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+n}h${a=+a}v${+l}h${-a}Z`}toString(){return this._}}function Jb(e){let r=3;return e.digits=function(n){if(!arguments.length)return r;if(n==null)r=null;else{const a=Math.floor(n);if(!(a>=0))throw new RangeError(`invalid digits: ${n}`);r=a}return e},()=>new VI(r)}function ey(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function mz(e){this._context=e}mz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;default:this._context.lineTo(e,r);break}}};function Pf(e){return new mz(e)}function fz(e){return e[0]}function pz(e){return e[1]}function hz(e,r){var n=zt(!0),a=null,l=Pf,o=null,u=Jb(d);e=typeof e=="function"?e:e===void 0?fz:zt(e),r=typeof r=="function"?r:r===void 0?pz:zt(r);function d(m){var p,h=(m=ey(m)).length,v,b=!1,x;for(a==null&&(o=l(x=u())),p=0;p<=h;++p)!(p<h&&n(v=m[p],p,m))===b&&((b=!b)?o.lineStart():o.lineEnd()),b&&o.point(+e(v,p,m),+r(v,p,m));if(x)return o=null,x+""||null}return d.x=function(m){return arguments.length?(e=typeof m=="function"?m:zt(+m),d):e},d.y=function(m){return arguments.length?(r=typeof m=="function"?m:zt(+m),d):r},d.defined=function(m){return arguments.length?(n=typeof m=="function"?m:zt(!!m),d):n},d.curve=function(m){return arguments.length?(l=m,a!=null&&(o=l(a)),d):l},d.context=function(m){return arguments.length?(m==null?a=o=null:o=l(a=m),d):a},d}function Vd(e,r,n){var a=null,l=zt(!0),o=null,u=Pf,d=null,m=Jb(p);e=typeof e=="function"?e:e===void 0?fz:zt(+e),r=typeof r=="function"?r:zt(r===void 0?0:+r),n=typeof n=="function"?n:n===void 0?pz:zt(+n);function p(v){var b,x,j,_=(v=ey(v)).length,w,C=!1,E,S=new Array(_),A=new Array(_);for(o==null&&(d=u(E=m())),b=0;b<=_;++b){if(!(b<_&&l(w=v[b],b,v))===C)if(C=!C)x=b,d.areaStart(),d.lineStart();else{for(d.lineEnd(),d.lineStart(),j=b-1;j>=x;--j)d.point(S[j],A[j]);d.lineEnd(),d.areaEnd()}C&&(S[b]=+e(w,b,v),A[b]=+r(w,b,v),d.point(a?+a(w,b,v):S[b],n?+n(w,b,v):A[b]))}if(E)return d=null,E+""||null}function h(){return hz().defined(l).curve(u).context(o)}return p.x=function(v){return arguments.length?(e=typeof v=="function"?v:zt(+v),a=null,p):e},p.x0=function(v){return arguments.length?(e=typeof v=="function"?v:zt(+v),p):e},p.x1=function(v){return arguments.length?(a=v==null?null:typeof v=="function"?v:zt(+v),p):a},p.y=function(v){return arguments.length?(r=typeof v=="function"?v:zt(+v),n=null,p):r},p.y0=function(v){return arguments.length?(r=typeof v=="function"?v:zt(+v),p):r},p.y1=function(v){return arguments.length?(n=v==null?null:typeof v=="function"?v:zt(+v),p):n},p.lineX0=p.lineY0=function(){return h().x(e).y(r)},p.lineY1=function(){return h().x(e).y(n)},p.lineX1=function(){return h().x(a).y(r)},p.defined=function(v){return arguments.length?(l=typeof v=="function"?v:zt(!!v),p):l},p.curve=function(v){return arguments.length?(u=v,o!=null&&(d=u(o)),p):u},p.context=function(v){return arguments.length?(v==null?o=d=null:d=u(o=v),p):o},p}class vz{constructor(r,n){this._context=r,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(r,n){switch(r=+r,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+r)/2,this._y0,this._x0,n,r,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,r,this._y0,r,n);break}}this._x0=r,this._y0=n}}function QI(e){return new vz(e,!0)}function YI(e){return new vz(e,!1)}const ty={draw(e,r){const n=ia(r/Am);e.moveTo(n,0),e.arc(0,0,n,0,Df)}},KI={draw(e,r){const n=ia(r/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},gz=ia(1/3),WI=gz*2,XI={draw(e,r){const n=ia(r/WI),a=n*gz;e.moveTo(0,-n),e.lineTo(a,0),e.lineTo(0,n),e.lineTo(-a,0),e.closePath()}},ZI={draw(e,r){const n=ia(r),a=-n/2;e.rect(a,a,n,n)}},JI=.8908130915292852,xz=Em(Am/10)/Em(7*Am/10),e6=Em(Df/10)*xz,t6=-uz(Df/10)*xz,r6={draw(e,r){const n=ia(r*JI),a=e6*n,l=t6*n;e.moveTo(0,-n),e.lineTo(a,l);for(let o=1;o<5;++o){const u=Df*o/5,d=uz(u),m=Em(u);e.lineTo(m*n,-d*n),e.lineTo(d*a-m*l,m*a+d*l)}e.closePath()}},Zv=ia(3),n6={draw(e,r){const n=-ia(r/(Zv*3));e.moveTo(0,n*2),e.lineTo(-Zv*n,-n),e.lineTo(Zv*n,-n),e.closePath()}},Mn=-.5,Tn=ia(3)/2,Fx=1/ia(12),a6=(Fx/2+1)*3,i6={draw(e,r){const n=ia(r/a6),a=n/2,l=n*Fx,o=a,u=n*Fx+n,d=-o,m=u;e.moveTo(a,l),e.lineTo(o,u),e.lineTo(d,m),e.lineTo(Mn*a-Tn*l,Tn*a+Mn*l),e.lineTo(Mn*o-Tn*u,Tn*o+Mn*u),e.lineTo(Mn*d-Tn*m,Tn*d+Mn*m),e.lineTo(Mn*a+Tn*l,Mn*l-Tn*a),e.lineTo(Mn*o+Tn*u,Mn*u-Tn*o),e.lineTo(Mn*d+Tn*m,Mn*m-Tn*d),e.closePath()}};function s6(e,r){let n=null,a=Jb(l);e=typeof e=="function"?e:zt(e||ty),r=typeof r=="function"?r:zt(r===void 0?64:+r);function l(){let o;if(n||(n=o=a()),e.apply(this,arguments).draw(n,+r.apply(this,arguments)),o)return n=null,o+""||null}return l.type=function(o){return arguments.length?(e=typeof o=="function"?o:zt(o),l):e},l.size=function(o){return arguments.length?(r=typeof o=="function"?o:zt(+o),l):r},l.context=function(o){return arguments.length?(n=o??null,l):n},l}function zm(){}function km(e,r,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+r)/6,(e._y0+4*e._y1+n)/6)}function bz(e){this._context=e}bz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:km(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:km(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function l6(e){return new bz(e)}function yz(e){this._context=e}yz.prototype={areaStart:zm,areaEnd:zm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._x2=e,this._y2=r;break;case 1:this._point=2,this._x3=e,this._y3=r;break;case 2:this._point=3,this._x4=e,this._y4=r,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+r)/6);break;default:km(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function o6(e){return new yz(e)}function jz(e){this._context=e}jz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+r)/6;this._line?this._context.lineTo(n,a):this._context.moveTo(n,a);break;case 3:this._point=4;default:km(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function c6(e){return new jz(e)}function _z(e){this._context=e}_z.prototype={areaStart:zm,areaEnd:zm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,r){e=+e,r=+r,this._point?this._context.lineTo(e,r):(this._point=1,this._context.moveTo(e,r))}};function u6(e){return new _z(e)}function iS(e){return e<0?-1:1}function sS(e,r,n){var a=e._x1-e._x0,l=r-e._x1,o=(e._y1-e._y0)/(a||l<0&&-0),u=(n-e._y1)/(l||a<0&&-0),d=(o*l+u*a)/(a+l);return(iS(o)+iS(u))*Math.min(Math.abs(o),Math.abs(u),.5*Math.abs(d))||0}function lS(e,r){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-r)/2:r}function Jv(e,r,n){var a=e._x0,l=e._y0,o=e._x1,u=e._y1,d=(o-a)/3;e._context.bezierCurveTo(a+d,l+d*r,o-d,u-d*n,o,u)}function Om(e){this._context=e}Om.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Jv(this,this._t0,lS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){var n=NaN;if(e=+e,r=+r,!(e===this._x1&&r===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;break;case 2:this._point=3,Jv(this,lS(this,n=sS(this,e,r)),n);break;default:Jv(this,this._t0,n=sS(this,e,r));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r,this._t0=n}}};function Nz(e){this._context=new Sz(e)}(Nz.prototype=Object.create(Om.prototype)).point=function(e,r){Om.prototype.point.call(this,r,e)};function Sz(e){this._context=e}Sz.prototype={moveTo:function(e,r){this._context.moveTo(r,e)},closePath:function(){this._context.closePath()},lineTo:function(e,r){this._context.lineTo(r,e)},bezierCurveTo:function(e,r,n,a,l,o){this._context.bezierCurveTo(r,e,a,n,o,l)}};function d6(e){return new Om(e)}function m6(e){return new Nz(e)}function wz(e){this._context=e}wz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,r=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],r[0]):this._context.moveTo(e[0],r[0]),n===2)this._context.lineTo(e[1],r[1]);else for(var a=oS(e),l=oS(r),o=0,u=1;u<n;++o,++u)this._context.bezierCurveTo(a[0][o],l[0][o],a[1][o],l[1][o],e[u],r[u]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,r){this._x.push(+e),this._y.push(+r)}};function oS(e){var r,n=e.length-1,a,l=new Array(n),o=new Array(n),u=new Array(n);for(l[0]=0,o[0]=2,u[0]=e[0]+2*e[1],r=1;r<n-1;++r)l[r]=1,o[r]=4,u[r]=4*e[r]+2*e[r+1];for(l[n-1]=2,o[n-1]=7,u[n-1]=8*e[n-1]+e[n],r=1;r<n;++r)a=l[r]/o[r-1],o[r]-=a,u[r]-=a*u[r-1];for(l[n-1]=u[n-1]/o[n-1],r=n-2;r>=0;--r)l[r]=(u[r]-l[r+1])/o[r];for(o[n-1]=(e[n]+l[n-1])/2,r=0;r<n-1;++r)o[r]=2*e[r+1]-l[r+1];return[l,o]}function f6(e){return new wz(e)}function Mf(e,r){this._context=e,this._t=r}Mf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,r),this._context.lineTo(e,r);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,r)}break}}this._x=e,this._y=r}};function p6(e){return new Mf(e,.5)}function h6(e){return new Mf(e,0)}function v6(e){return new Mf(e,1)}function Vs(e,r){if((u=e.length)>1)for(var n=1,a,l,o=e[r[0]],u,d=o.length;n<u;++n)for(l=o,o=e[r[n]],a=0;a<d;++a)o[a][1]+=o[a][0]=isNaN(l[a][1])?l[a][0]:l[a][1]}function Gx(e){for(var r=e.length,n=new Array(r);--r>=0;)n[r]=r;return n}function g6(e,r){return e[r]}function x6(e){const r=[];return r.key=e,r}function b6(){var e=zt([]),r=Gx,n=Vs,a=g6;function l(o){var u=Array.from(e.apply(this,arguments),x6),d,m=u.length,p=-1,h;for(const v of o)for(d=0,++p;d<m;++d)(u[d][p]=[0,+a(v,u[d].key,p,o)]).data=v;for(d=0,h=ey(r(u));d<m;++d)u[h[d]].index=d;return n(u,h),u}return l.keys=function(o){return arguments.length?(e=typeof o=="function"?o:zt(Array.from(o)),l):e},l.value=function(o){return arguments.length?(a=typeof o=="function"?o:zt(+o),l):a},l.order=function(o){return arguments.length?(r=o==null?Gx:typeof o=="function"?o:zt(Array.from(o)),l):r},l.offset=function(o){return arguments.length?(n=o??Vs,l):n},l}function y6(e,r){if((a=e.length)>0){for(var n,a,l=0,o=e[0].length,u;l<o;++l){for(u=n=0;n<a;++n)u+=e[n][l][1]||0;if(u)for(n=0;n<a;++n)e[n][l][1]/=u}Vs(e,r)}}function j6(e,r){if((l=e.length)>0){for(var n=0,a=e[r[0]],l,o=a.length;n<o;++n){for(var u=0,d=0;u<l;++u)d+=e[u][n][1]||0;a[n][1]+=a[n][0]=-d/2}Vs(e,r)}}function _6(e,r){if(!(!((u=e.length)>0)||!((o=(l=e[r[0]]).length)>0))){for(var n=0,a=1,l,o,u;a<o;++a){for(var d=0,m=0,p=0;d<u;++d){for(var h=e[r[d]],v=h[a][1]||0,b=h[a-1][1]||0,x=(v-b)/2,j=0;j<d;++j){var _=e[r[j]],w=_[a][1]||0,C=_[a-1][1]||0;x+=w-C}m+=v,p+=x*v}l[a-1][1]+=l[a-1][0]=n,m&&(n-=p/m)}l[a-1][1]+=l[a-1][0]=n,Vs(e,r)}}var eg={},tg={},cS;function N6(){return cS||(cS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return n==="__proto__"}e.isUnsafeProperty=r})(tg)),tg}var rg={},uS;function Cz(){return uS||(uS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}e.isDeepKey=r})(rg)),rg}var ng={},dS;function ry(){return dS||(dS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return typeof n=="string"||typeof n=="symbol"?n:Object.is(n?.valueOf?.(),-0)?"-0":String(n)}e.toKey=r})(ng)),ng}var ag={},ig={},mS;function S6(){return mS||(mS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){if(n==null)return"";if(typeof n=="string")return n;if(Array.isArray(n))return n.map(r).join(",");const a=String(n);return a==="0"&&Object.is(Number(n),-0)?"-0":a}e.toString=r})(ig)),ig}var fS;function ny(){return fS||(fS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=S6(),n=ry();function a(l){if(Array.isArray(l))return l.map(n.toKey);if(typeof l=="symbol")return[l];l=r.toString(l);const o=[],u=l.length;if(u===0)return o;let d=0,m="",p="",h=!1;for(l.charCodeAt(0)===46&&(o.push(""),d++);d<u;){const v=l[d];p?v==="\\"&&d+1<u?(d++,m+=l[d]):v===p?p="":m+=v:h?v==='"'||v==="'"?p=v:v==="]"?(h=!1,o.push(m),m=""):m+=v:v==="["?(h=!0,m&&(o.push(m),m="")):v==="."?m&&(o.push(m),m=""):m+=v,d++}return m&&o.push(m),o}e.toPath=a})(ag)),ag}var pS;function ay(){return pS||(pS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=N6(),n=Cz(),a=ry(),l=ny();function o(d,m,p){if(d==null)return p;switch(typeof m){case"string":{if(r.isUnsafeProperty(m))return p;const h=d[m];return h===void 0?n.isDeepKey(m)?o(d,l.toPath(m),p):p:h}case"number":case"symbol":{typeof m=="number"&&(m=a.toKey(m));const h=d[m];return h===void 0?p:h}default:{if(Array.isArray(m))return u(d,m,p);if(Object.is(m?.valueOf(),-0)?m="-0":m=String(m),r.isUnsafeProperty(m))return p;const h=d[m];return h===void 0?p:h}}}function u(d,m,p){if(m.length===0)return p;let h=d;for(let v=0;v<m.length;v++){if(h==null||r.isUnsafeProperty(m[v]))return p;h=h[m[v]]}return h===void 0?p:h}e.get=o})(eg)),eg}var sg,hS;function w6(){return hS||(hS=1,sg=ay().get),sg}var C6=w6();const vo=oi(C6);var E6=4;function Wi(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E6,n=10**r,a=Math.round(e*n)/n;return Object.is(a,-0)?0:a}function Vt(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return e.reduce((l,o,u)=>{var d=n[u-1];return typeof d=="string"?l+d+o:d!==void 0?l+Wi(d)+o:l+o},"")}var nn=e=>e===0?0:e>0?1:-1,_a=e=>typeof e=="number"&&e!=+e,Qs=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,qe=e=>(typeof e=="number"||e instanceof Number)&&!_a(e),Na=e=>qe(e)||typeof e=="string",A6=0,Qc=e=>{var r=++A6;return"".concat(e||"").concat(r)},na=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!qe(r)&&typeof r!="string")return a;var o;if(Qs(r)){if(n==null)return a;var u=r.indexOf("%");o=n*parseFloat(r.slice(0,u))/100}else o=+r;return _a(o)&&(o=a),l&&n!=null&&o>n&&(o=n),o},Ez=e=>{if(!Array.isArray(e))return!1;for(var r=e.length,n={},a=0;a<r;a++)if(!n[String(e[a])])n[String(e[a])]=!0;else return!0;return!1};function Qt(e,r,n){return qe(e)&&qe(r)?Wi(e+n*(r-e)):r}function Az(e,r,n){if(!(!e||!e.length))return e.find(a=>a&&(typeof r=="function"?r(a):vo(a,r))===n)}var Bt=e=>e===null||typeof e>"u",fu=e=>Bt(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function an(e){return e!=null}function al(){}var z6=["type","size","sizeType"];function Hx(){return Hx=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Hx.apply(null,arguments)}function vS(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function gS(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?vS(Object(n),!0).forEach(function(a){k6(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vS(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function k6(e,r,n){return(r=O6(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function O6(e){var r=D6(e,"string");return typeof r=="symbol"?r:r+""}function D6(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function P6(e,r){if(e==null)return{};var n,a,l=M6(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function M6(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var zz={symbolCircle:ty,symbolCross:KI,symbolDiamond:XI,symbolSquare:ZI,symbolStar:r6,symbolTriangle:n6,symbolWye:i6},T6=Math.PI/180,q6=e=>{var r="symbol".concat(fu(e));return zz[r]||ty},R6=(e,r,n)=>{if(r==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var a=18*T6;return 1.25*e*e*(Math.tan(a)-Math.tan(a*2)*Math.tan(a)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},I6=(e,r)=>{zz["symbol".concat(fu(e))]=r},kz=e=>{var{type:r="circle",size:n=64,sizeType:a="area"}=e,l=P6(e,z6),o=gS(gS({},l),{},{type:r,size:n,sizeType:a}),u="circle";typeof r=="string"&&(u=r);var d=()=>{var b=q6(u),x=s6().type(b).size(R6(n,a,u)),j=x();if(j!==null)return j},{className:m,cx:p,cy:h}=o,v=Hr(o);return qe(p)&&qe(h)&&qe(n)?g.createElement("path",Hx({},v,{className:Ct("recharts-symbols",m),transform:"translate(".concat(p,", ").concat(h,")"),d:d()})):null};kz.registerSymbol=I6;var Oz=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,iy=(e,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(g.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(l=>{Zb(l)&&(a[l]=(o=>n[l](n,o)))}),a},L6=(e,r,n)=>a=>(e(r,n,a),null),sy=(e,r,n)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var a=null;return Object.keys(e).forEach(l=>{var o=e[l];Zb(l)&&typeof o=="function"&&(a||(a={}),a[l]=L6(o,r,n))}),a};function xS(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function $6(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?xS(Object(n),!0).forEach(function(a){B6(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xS(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function B6(e,r,n){return(r=U6(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function U6(e){var r=F6(e,"string");return typeof r=="symbol"?r:r+""}function F6(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Qr(e,r){var n=$6({},e),a=r,l=Object.keys(r),o=l.reduce((u,d)=>(u[d]===void 0&&a[d]!==void 0&&(u[d]=a[d]),u),n);return o}var lg={},og={},bS;function G6(){return bS||(bS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n,a){const l=new Map;for(let o=0;o<n.length;o++){const u=n[o],d=a(u,o,n);l.has(d)||l.set(d,u)}return Array.from(l.values())}e.uniqBy=r})(og)),og}var cg={},yS;function H6(){return yS||(yS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n,a){return function(...l){return n.apply(this,l.slice(0,a))}}e.ary=r})(cg)),cg}var ug={},jS;function Dz(){return jS||(jS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return n}e.identity=r})(ug)),ug}var dg={},mg={},fg={},_S;function V6(){return _S||(_S=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return Number.isSafeInteger(n)&&n>=0}e.isLength=r})(fg)),fg}var NS;function ly(){return NS||(NS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=V6();function n(a){return a!=null&&typeof a!="function"&&r.isLength(a.length)}e.isArrayLike=n})(mg)),mg}var pg={},SS;function Q6(){return SS||(SS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return typeof n=="object"&&n!==null}e.isObjectLike=r})(pg)),pg}var wS;function Y6(){return wS||(wS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=ly(),n=Q6();function a(l){return n.isObjectLike(l)&&r.isArrayLike(l)}e.isArrayLikeObject=a})(dg)),dg}var hg={},vg={},CS;function K6(){return CS||(CS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=ay();function n(a){return function(l){return r.get(l,a)}}e.property=n})(vg)),vg}var gg={},xg={},bg={},yg={},ES;function Pz(){return ES||(ES=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return n!==null&&(typeof n=="object"||typeof n=="function")}e.isObject=r})(yg)),yg}var jg={},AS;function Mz(){return AS||(AS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return n==null||typeof n!="object"&&typeof n!="function"}e.isPrimitive=r})(jg)),jg}var _g={},zS;function Tz(){return zS||(zS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n,a){return n===a||Number.isNaN(n)&&Number.isNaN(a)}e.isEqualsSameValueZero=r})(_g)),_g}var kS;function W6(){return kS||(kS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Pz(),n=Mz(),a=Tz();function l(h,v,b){return typeof b!="function"?l(h,v,()=>{}):o(h,v,function x(j,_,w,C,E,S){const A=b(j,_,w,C,E,S);return A!==void 0?!!A:o(j,_,x,S)},new Map)}function o(h,v,b,x){if(v===h)return!0;switch(typeof v){case"object":return u(h,v,b,x);case"function":return Object.keys(v).length>0?o(h,{...v},b,x):a.isEqualsSameValueZero(h,v);default:return r.isObject(h)?typeof v=="string"?v==="":!0:a.isEqualsSameValueZero(h,v)}}function u(h,v,b,x){if(v==null)return!0;if(Array.isArray(v))return m(h,v,b,x);if(v instanceof Map)return d(h,v,b,x);if(v instanceof Set)return p(h,v,b,x);const j=Object.keys(v);if(h==null||n.isPrimitive(h))return j.length===0;if(j.length===0)return!0;if(x?.has(v))return x.get(v)===h;x?.set(v,h);try{for(let _=0;_<j.length;_++){const w=j[_];if(!n.isPrimitive(h)&&!(w in h)||v[w]===void 0&&h[w]!==void 0||v[w]===null&&h[w]!==null||!b(h[w],v[w],w,h,v,x))return!1}return!0}finally{x?.delete(v)}}function d(h,v,b,x){if(v.size===0)return!0;if(!(h instanceof Map))return!1;for(const[j,_]of v.entries()){const w=h.get(j);if(b(w,_,j,h,v,x)===!1)return!1}return!0}function m(h,v,b,x){if(v.length===0)return!0;if(!Array.isArray(h))return!1;const j=new Set;for(let _=0;_<v.length;_++){const w=v[_];let C=!1;for(let E=0;E<h.length;E++){if(j.has(E))continue;const S=h[E];let A=!1;if(b(S,w,_,h,v,x)&&(A=!0),A){j.add(E),C=!0;break}}if(!C)return!1}return!0}function p(h,v,b,x){return v.size===0?!0:h instanceof Set?m([...h],[...v],b,x):!1}e.isMatchWith=l,e.isSetMatch=p})(bg)),bg}var OS;function qz(){return OS||(OS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=W6();function n(a,l){return r.isMatchWith(a,l,()=>{})}e.isMatch=n})(xg)),xg}var Ng={},Sg={},wg={},DS;function X6(){return DS||(DS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return Object.getOwnPropertySymbols(n).filter(a=>Object.prototype.propertyIsEnumerable.call(n,a))}e.getSymbols=r})(wg)),wg}var Cg={},PS;function oy(){return PS||(PS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}e.getTag=r})(Cg)),Cg}var Eg={},MS;function Rz(){return MS||(MS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r="[object RegExp]",n="[object String]",a="[object Number]",l="[object Boolean]",o="[object Arguments]",u="[object Symbol]",d="[object Date]",m="[object Map]",p="[object Set]",h="[object Array]",v="[object Function]",b="[object ArrayBuffer]",x="[object Object]",j="[object Error]",_="[object DataView]",w="[object Uint8Array]",C="[object Uint8ClampedArray]",E="[object Uint16Array]",S="[object Uint32Array]",A="[object BigUint64Array]",z="[object Int8Array]",k="[object Int16Array]",P="[object Int32Array]",D="[object BigInt64Array]",$="[object Float32Array]",F="[object Float64Array]";e.argumentsTag=o,e.arrayBufferTag=b,e.arrayTag=h,e.bigInt64ArrayTag=D,e.bigUint64ArrayTag=A,e.booleanTag=l,e.dataViewTag=_,e.dateTag=d,e.errorTag=j,e.float32ArrayTag=$,e.float64ArrayTag=F,e.functionTag=v,e.int16ArrayTag=k,e.int32ArrayTag=P,e.int8ArrayTag=z,e.mapTag=m,e.numberTag=a,e.objectTag=x,e.regexpTag=r,e.setTag=p,e.stringTag=n,e.symbolTag=u,e.uint16ArrayTag=E,e.uint32ArrayTag=S,e.uint8ArrayTag=w,e.uint8ClampedArrayTag=C})(Eg)),Eg}var Ag={},TS;function Z6(){return TS||(TS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}e.isTypedArray=r})(Ag)),Ag}var qS;function Iz(){return qS||(qS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=X6(),n=oy(),a=Rz(),l=Mz(),o=Z6();function u(h,v){return d(h,void 0,h,new Map,v)}function d(h,v,b,x=new Map,j=void 0){const _=j?.(h,v,b,x);if(_!==void 0)return _;if(l.isPrimitive(h))return h;if(x.has(h))return x.get(h);if(Array.isArray(h)){const w=new Array(h.length);x.set(h,w);for(let C=0;C<h.length;C++)w[C]=d(h[C],C,b,x,j);return Object.hasOwn(h,"index")&&(w.index=h.index),Object.hasOwn(h,"input")&&(w.input=h.input),w}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const w=new RegExp(h.source,h.flags);return w.lastIndex=h.lastIndex,w}if(h instanceof Map){const w=new Map;x.set(h,w);for(const[C,E]of h)w.set(C,d(E,C,b,x,j));return w}if(h instanceof Set){const w=new Set;x.set(h,w);for(const C of h)w.add(d(C,void 0,b,x,j));return w}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(o.isTypedArray(h)){const w=new(Object.getPrototypeOf(h)).constructor(h.length);x.set(h,w);for(let C=0;C<h.length;C++)w[C]=d(h[C],C,b,x,j);return w}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const w=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return x.set(h,w),m(w,h,b,x,j),w}if(typeof File<"u"&&h instanceof File){const w=new File([h],h.name,{type:h.type});return x.set(h,w),m(w,h,b,x,j),w}if(typeof Blob<"u"&&h instanceof Blob){const w=new Blob([h],{type:h.type});return x.set(h,w),m(w,h,b,x,j),w}if(h instanceof Error){const w=new h.constructor;return x.set(h,w),w.message=h.message,w.name=h.name,w.stack=h.stack,w.cause=h.cause,m(w,h,b,x,j),w}if(h instanceof Boolean){const w=new Boolean(h.valueOf());return x.set(h,w),m(w,h,b,x,j),w}if(h instanceof Number){const w=new Number(h.valueOf());return x.set(h,w),m(w,h,b,x,j),w}if(h instanceof String){const w=new String(h.valueOf());return x.set(h,w),m(w,h,b,x,j),w}if(typeof h=="object"&&p(h)){const w=Object.create(Object.getPrototypeOf(h));return x.set(h,w),m(w,h,b,x,j),w}return h}function m(h,v,b=h,x,j){const _=[...Object.keys(v),...r.getSymbols(v)];for(let w=0;w<_.length;w++){const C=_[w],E=Object.getOwnPropertyDescriptor(h,C);(E==null||E.writable)&&(h[C]=d(v[C],C,b,x,j))}}function p(h){switch(n.getTag(h)){case a.argumentsTag:case a.arrayTag:case a.arrayBufferTag:case a.dataViewTag:case a.booleanTag:case a.dateTag:case a.float32ArrayTag:case a.float64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.mapTag:case a.numberTag:case a.objectTag:case a.regexpTag:case a.setTag:case a.stringTag:case a.symbolTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=u,e.cloneDeepWithImpl=d,e.copyProperties=m})(Sg)),Sg}var RS;function J6(){return RS||(RS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Iz();function n(a){return r.cloneDeepWithImpl(a,void 0,a,new Map,void 0)}e.cloneDeep=n})(Ng)),Ng}var IS;function e4(){return IS||(IS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=qz(),n=J6();function a(l){return l=n.cloneDeep(l),o=>r.isMatch(o,l)}e.matches=a})(gg)),gg}var zg={},kg={},Og={},LS;function t4(){return LS||(LS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Iz(),n=oy(),a=Rz();function l(o,u){return r.cloneDeepWith(o,(d,m,p,h)=>{const v=u?.(d,m,p,h);if(v!==void 0)return v;if(typeof o=="object"){if(n.getTag(o)===a.objectTag&&typeof o.constructor!="function"){const b={};return h.set(o,b),r.copyProperties(b,o,p,h),b}switch(Object.prototype.toString.call(o)){case a.numberTag:case a.stringTag:case a.booleanTag:{const b=new o.constructor(o?.valueOf());return r.copyProperties(b,o),b}case a.argumentsTag:{const b={};return r.copyProperties(b,o),b.length=o.length,b[Symbol.iterator]=o[Symbol.iterator],b}default:return}}})}e.cloneDeepWith=l})(Og)),Og}var $S;function r4(){return $S||($S=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=t4();function n(a){return r.cloneDeepWith(a)}e.cloneDeep=n})(kg)),kg}var Dg={},Pg={},BS;function Lz(){return BS||(BS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=/^(?:0|[1-9]\d*)$/;function n(a,l=Number.MAX_SAFE_INTEGER){switch(typeof a){case"number":return Number.isInteger(a)&&a>=0&&a<l;case"symbol":return!1;case"string":return r.test(a)}}e.isIndex=n})(Pg)),Pg}var Mg={},US;function n4(){return US||(US=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=oy();function n(a){return a!==null&&typeof a=="object"&&r.getTag(a)==="[object Arguments]"}e.isArguments=n})(Mg)),Mg}var FS;function a4(){return FS||(FS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Cz(),n=Lz(),a=n4(),l=ny();function o(u,d){let m;if(Array.isArray(d)?m=d:typeof d=="string"&&r.isDeepKey(d)&&u?.[d]==null?m=l.toPath(d):m=[d],m.length===0)return!1;let p=u;for(let h=0;h<m.length;h++){const v=m[h];if((p==null||!Object.hasOwn(p,v))&&!((Array.isArray(p)||a.isArguments(p))&&n.isIndex(v)&&v<p.length))return!1;p=p[v]}return!0}e.has=o})(Dg)),Dg}var GS;function i4(){return GS||(GS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=qz(),n=ry(),a=r4(),l=ay(),o=a4();function u(d,m){switch(typeof d){case"object":{Object.is(d?.valueOf(),-0)&&(d="-0");break}case"number":{d=n.toKey(d);break}}return m=a.cloneDeep(m),function(p){const h=l.get(p,d);return h===void 0?o.has(p,d):m===void 0?h===void 0:r.isMatch(h,m)}}e.matchesProperty=u})(zg)),zg}var HS;function s4(){return HS||(HS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Dz(),n=K6(),a=e4(),l=i4();function o(u){if(u==null)return r.identity;switch(typeof u){case"function":return u;case"object":return Array.isArray(u)&&u.length===2?l.matchesProperty(u[0],u[1]):a.matches(u);case"string":case"symbol":case"number":return n.property(u)}}e.iteratee=o})(hg)),hg}var VS;function l4(){return VS||(VS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=G6(),n=H6(),a=Dz(),l=Y6(),o=s4();function u(d,m=a.identity){return l.isArrayLikeObject(d)?r.uniqBy(Array.from(d),n.ary(o.iteratee(m),1)):[]}e.uniqBy=u})(lg)),lg}var Tg,QS;function o4(){return QS||(QS=1,Tg=l4().uniqBy),Tg}var c4=o4();const YS=oi(c4);function u4(e,r,n){return r===!0?YS(e,n):typeof r=="function"?YS(e,r):e}var qg={exports:{}},Rg={},Ig={exports:{}},Lg={};var KS;function d4(){if(KS)return Lg;KS=1;var e=zf();function r(v,b){return v===b&&(v!==0||1/v===1/b)||v!==v&&b!==b}var n=typeof Object.is=="function"?Object.is:r,a=e.useState,l=e.useEffect,o=e.useLayoutEffect,u=e.useDebugValue;function d(v,b){var x=b(),j=a({inst:{value:x,getSnapshot:b}}),_=j[0].inst,w=j[1];return o(function(){_.value=x,_.getSnapshot=b,m(_)&&w({inst:_})},[v,x,b]),l(function(){return m(_)&&w({inst:_}),v(function(){m(_)&&w({inst:_})})},[v]),u(x),x}function m(v){var b=v.getSnapshot;v=v.value;try{var x=b();return!n(v,x)}catch{return!0}}function p(v,b){return b()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:d;return Lg.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,Lg}var WS;function m4(){return WS||(WS=1,Ig.exports=d4()),Ig.exports}var XS;function f4(){if(XS)return Rg;XS=1;var e=zf(),r=m4();function n(p,h){return p===h&&(p!==0||1/p===1/h)||p!==p&&h!==h}var a=typeof Object.is=="function"?Object.is:n,l=r.useSyncExternalStore,o=e.useRef,u=e.useEffect,d=e.useMemo,m=e.useDebugValue;return Rg.useSyncExternalStoreWithSelector=function(p,h,v,b,x){var j=o(null);if(j.current===null){var _={hasValue:!1,value:null};j.current=_}else _=j.current;j=d(function(){function C(k){if(!E){if(E=!0,S=k,k=b(k),x!==void 0&&_.hasValue){var P=_.value;if(x(P,k))return A=P}return A=k}if(P=A,a(S,k))return P;var D=b(k);return x!==void 0&&x(P,D)?(S=k,P):(S=k,A=D)}var E=!1,S,A,z=v===void 0?null:v;return[function(){return C(h())},z===null?void 0:function(){return C(z())}]},[h,v,b,x]);var w=l(p,j[0],j[1]);return u(function(){_.hasValue=!0,_.value=w},[w]),m(w),w},Rg}var ZS;function p4(){return ZS||(ZS=1,qg.exports=f4()),qg.exports}var h4=p4(),cy=g.createContext(null),v4=e=>e,Zt=()=>{var e=g.useContext(cy);return e?e.store.dispatch:v4},pm=()=>{},g4=()=>pm,x4=(e,r)=>e===r;function Be(e){var r=g.useContext(cy),n=g.useMemo(()=>r?a=>{if(a!=null)return e(a)}:pm,[r,e]);return h4.useSyncExternalStoreWithSelector(r?r.subscription.addNestedSub:g4,r?r.store.getState:pm,r?r.store.getState:pm,n,x4)}function b4(e,r=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(r)}function y4(e,r=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(r)}function j4(e,r="expected all items to be functions, instead received the following types: "){if(!e.every(n=>typeof n=="function")){const n=e.map(a=>typeof a=="function"?`function ${a.name||"unnamed"}()`:typeof a).join(", ");throw new TypeError(`${r}[${n}]`)}}var JS=e=>Array.isArray(e)?e:[e];function _4(e){const r=Array.isArray(e[0])?e[0]:e;return j4(r,"createSelector expects all input-selectors to be functions, but received the following types: "),r}function N4(e,r){const n=[],{length:a}=e;for(let l=0;l<a;l++)n.push(e[l].apply(null,r));return n}var S4=class{constructor(e){this.value=e}deref(){return this.value}},w4=typeof WeakRef<"u"?WeakRef:S4,C4=0,ew=1;function Qd(){return{s:C4,v:void 0,o:null,p:null}}function $z(e,r={}){let n=Qd();const{resultEqualityCheck:a}=r;let l,o=0;function u(){let d=n;const{length:m}=arguments;for(let v=0,b=m;v<b;v++){const x=arguments[v];if(typeof x=="function"||typeof x=="object"&&x!==null){let j=d.o;j===null&&(d.o=j=new WeakMap);const _=j.get(x);_===void 0?(d=Qd(),j.set(x,d)):d=_}else{let j=d.p;j===null&&(d.p=j=new Map);const _=j.get(x);_===void 0?(d=Qd(),j.set(x,d)):d=_}}const p=d;let h;if(d.s===ew)h=d.v;else if(h=e.apply(null,arguments),o++,a){const v=l?.deref?.()??l;v!=null&&a(v,h)&&(h=v,o!==0&&o--),l=typeof h=="object"&&h!==null||typeof h=="function"?new w4(h):h}return p.s=ew,p.v=h,h}return u.clearCache=()=>{n=Qd(),u.resetResultsCount()},u.resultsCount=()=>o,u.resetResultsCount=()=>{o=0},u}function E4(e,...r){const n=typeof e=="function"?{memoize:e,memoizeOptions:r}:e,a=(...l)=>{let o=0,u=0,d,m={},p=l.pop();typeof p=="object"&&(m=p,p=l.pop()),b4(p,`createSelector expects an output function after the inputs, but received: [${typeof p}]`);const h={...n,...m},{memoize:v,memoizeOptions:b=[],argsMemoize:x=$z,argsMemoizeOptions:j=[]}=h,_=JS(b),w=JS(j),C=_4(l),E=v(function(){return o++,p.apply(null,arguments)},..._),S=x(function(){u++;const z=N4(C,arguments);return d=E.apply(null,z),d},...w);return Object.assign(S,{resultFunc:p,memoizedResultFunc:E,dependencies:C,dependencyRecomputations:()=>u,resetDependencyRecomputations:()=>{u=0},lastResult:()=>d,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:v,argsMemoize:x})};return Object.assign(a,{withTypes:()=>a}),a}var me=E4($z),A4=Object.assign((e,r=me)=>{y4(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const n=Object.keys(e),a=n.map(o=>e[o]);return r(a,(...o)=>o.reduce((u,d,m)=>(u[n[m]]=d,u),{}))},{withTypes:()=>A4}),$g={},Bg={},Ug={},tw;function z4(){return tw||(tw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return typeof a=="symbol"?1:a===null?2:a===void 0?3:a!==a?4:0}const n=(a,l,o)=>{if(a!==l){const u=r(a),d=r(l);if(u===d&&u===0){if(a<l)return o==="desc"?1:-1;if(a>l)return o==="desc"?-1:1}return o==="desc"?d-u:u-d}return 0};e.compareValues=n})(Ug)),Ug}var Fg={},Gg={},rw;function Bz(){return rw||(rw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return typeof n=="symbol"||n instanceof Symbol}e.isSymbol=r})(Gg)),Gg}var nw;function k4(){return nw||(nw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Bz(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function l(o,u){return Array.isArray(o)?!1:typeof o=="number"||typeof o=="boolean"||o==null||r.isSymbol(o)?!0:typeof o=="string"&&(a.test(o)||!n.test(o))||u!=null&&Object.hasOwn(u,o)}e.isKey=l})(Fg)),Fg}var aw;function O4(){return aw||(aw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=z4(),n=k4(),a=ny();function l(o,u,d,m){if(o==null)return[];d=m?void 0:d,Array.isArray(o)||(o=Object.values(o)),Array.isArray(u)||(u=u==null?[null]:[u]),u.length===0&&(u=[null]),Array.isArray(d)||(d=d==null?[]:[d]),d=d.map(x=>String(x));const p=(x,j)=>{let _=x;for(let w=0;w<j.length&&_!=null;++w)_=_[j[w]];return _},h=(x,j)=>j==null||x==null?j:typeof x=="object"&&"key"in x?Object.hasOwn(j,x.key)?j[x.key]:p(j,x.path):typeof x=="function"?x(j):Array.isArray(x)?p(j,x):typeof j=="object"?j[x]:j,v=u.map(x=>(Array.isArray(x)&&x.length===1&&(x=x[0]),x==null||typeof x=="function"||Array.isArray(x)||n.isKey(x)?x:{key:x,path:a.toPath(x)}));return o.map(x=>({original:x,criteria:v.map(j=>h(j,x))})).slice().sort((x,j)=>{for(let _=0;_<v.length;_++){const w=r.compareValues(x.criteria[_],j.criteria[_],d[_]);if(w!==0)return w}return 0}).map(x=>x.original)}e.orderBy=l})(Bg)),Bg}var Hg={},iw;function D4(){return iw||(iw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n,a=1){const l=[],o=Math.floor(a),u=(d,m)=>{for(let p=0;p<d.length;p++){const h=d[p];Array.isArray(h)&&m<o?u(h,m+1):l.push(h)}};return u(n,0),l}e.flatten=r})(Hg)),Hg}var Vg={},sw;function Uz(){return sw||(sw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Lz(),n=ly(),a=Pz(),l=Tz();function o(u,d,m){return a.isObject(m)&&(typeof d=="number"&&n.isArrayLike(m)&&r.isIndex(d)&&d<m.length||typeof d=="string"&&d in m)?l.isEqualsSameValueZero(m[d],u):!1}e.isIterateeCall=o})(Vg)),Vg}var lw;function P4(){return lw||(lw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=O4(),n=D4(),a=Uz();function l(o,...u){const d=u.length;return d>1&&a.isIterateeCall(o,u[0],u[1])?u=[]:d>2&&a.isIterateeCall(u[0],u[1],u[2])&&(u=[u[0]]),r.orderBy(o,n.flatten(u),["asc"])}e.sortBy=l})($g)),$g}var Qg,ow;function M4(){return ow||(ow=1,Qg=P4().sortBy),Qg}var T4=M4();const Tf=oi(T4);var Fz=e=>e.legend.settings,q4=e=>e.legend.size,R4=e=>e.legend.payload;me([R4,Fz],(e,r)=>{var{itemSorter:n}=r,a=e.flat(1);return n?Tf(a,n):a});var Yd=1;function I4(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[r,n]=g.useState({height:0,left:0,top:0,width:0}),a=g.useCallback(l=>{if(l!=null){var o=l.getBoundingClientRect(),u={height:o.height,left:o.left,top:o.top,width:o.width};(Math.abs(u.height-r.height)>Yd||Math.abs(u.left-r.left)>Yd||Math.abs(u.top-r.top)>Yd||Math.abs(u.width-r.width)>Yd)&&n({height:u.height,left:u.left,top:u.top,width:u.width})}},[r.width,r.height,r.top,r.left,...e]);return[r,a]}function Dr(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var L4=typeof Symbol=="function"&&Symbol.observable||"@@observable",cw=L4,Yg=()=>Math.random().toString(36).substring(7).split("").join("."),$4={INIT:`@@redux/INIT${Yg()}`,REPLACE:`@@redux/REPLACE${Yg()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Yg()}`},Dm=$4;function uy(e){if(typeof e!="object"||e===null)return!1;let r=e;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r||Object.getPrototypeOf(e)===null}function Gz(e,r,n){if(typeof e!="function")throw new Error(Dr(2));if(typeof r=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Dr(0));if(typeof r=="function"&&typeof n>"u"&&(n=r,r=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Dr(1));return n(Gz)(e,r)}let a=e,l=r,o=new Map,u=o,d=0,m=!1;function p(){u===o&&(u=new Map,o.forEach((w,C)=>{u.set(C,w)}))}function h(){if(m)throw new Error(Dr(3));return l}function v(w){if(typeof w!="function")throw new Error(Dr(4));if(m)throw new Error(Dr(5));let C=!0;p();const E=d++;return u.set(E,w),function(){if(C){if(m)throw new Error(Dr(6));C=!1,p(),u.delete(E),o=null}}}function b(w){if(!uy(w))throw new Error(Dr(7));if(typeof w.type>"u")throw new Error(Dr(8));if(typeof w.type!="string")throw new Error(Dr(17));if(m)throw new Error(Dr(9));try{m=!0,l=a(l,w)}finally{m=!1}return(o=u).forEach(E=>{E()}),w}function x(w){if(typeof w!="function")throw new Error(Dr(10));a=w,b({type:Dm.REPLACE})}function j(){const w=v;return{subscribe(C){if(typeof C!="object"||C===null)throw new Error(Dr(11));function E(){const A=C;A.next&&A.next(h())}return E(),{unsubscribe:w(E)}},[cw](){return this}}}return b({type:Dm.INIT}),{dispatch:b,subscribe:v,getState:h,replaceReducer:x,[cw]:j}}function B4(e){Object.keys(e).forEach(r=>{const n=e[r];if(typeof n(void 0,{type:Dm.INIT})>"u")throw new Error(Dr(12));if(typeof n(void 0,{type:Dm.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Dr(13))})}function Hz(e){const r=Object.keys(e),n={};for(let o=0;o<r.length;o++){const u=r[o];typeof e[u]=="function"&&(n[u]=e[u])}const a=Object.keys(n);let l;try{B4(n)}catch(o){l=o}return function(u={},d){if(l)throw l;let m=!1;const p={};for(let h=0;h<a.length;h++){const v=a[h],b=n[v],x=u[v],j=b(x,d);if(typeof j>"u")throw d&&d.type,new Error(Dr(14));p[v]=j,m=m||j!==x}return m=m||a.length!==Object.keys(u).length,m?p:u}}function Pm(...e){return e.length===0?r=>r:e.length===1?e[0]:e.reduce((r,n)=>(...a)=>r(n(...a)))}function U4(...e){return r=>(n,a)=>{const l=r(n,a);let o=()=>{throw new Error(Dr(15))};const u={getState:l.getState,dispatch:(m,...p)=>o(m,...p)},d=e.map(m=>m(u));return o=Pm(...d)(l.dispatch),{...l,dispatch:o}}}function Vz(e){return uy(e)&&"type"in e&&typeof e.type=="string"}var Qz=Symbol.for("immer-nothing"),uw=Symbol.for("immer-draftable"),Vr=Symbol.for("immer-state");function Zn(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var gn=Object,go=gn.getPrototypeOf,Mm="constructor",qf="prototype",Vx="configurable",Tm="enumerable",hm="writable",Yc="value",ti=e=>!!e&&!!e[Vr];function aa(e){return e?Yz(e)||If(e)||!!e[uw]||!!e[Mm]?.[uw]||Lf(e)||$f(e):!1}var F4=gn[qf][Mm].toString(),dw=new WeakMap;function Yz(e){if(!e||!dy(e))return!1;const r=go(e);if(r===null||r===gn[qf])return!0;const n=gn.hasOwnProperty.call(r,Mm)&&r[Mm];if(n===Object)return!0;if(!io(n))return!1;let a=dw.get(n);return a===void 0&&(a=Function.toString.call(n),dw.set(n,a)),a===F4}function Rf(e,r,n=!0){pu(e)===0?(n?Reflect.ownKeys(e):gn.keys(e)).forEach(l=>{r(l,e[l],e)}):e.forEach((a,l)=>r(l,a,e))}function pu(e){const r=e[Vr];return r?r.type_:If(e)?1:Lf(e)?2:$f(e)?3:0}var mw=(e,r,n=pu(e))=>n===2?e.has(r):gn[qf].hasOwnProperty.call(e,r),Qx=(e,r,n=pu(e))=>n===2?e.get(r):e[r],qm=(e,r,n,a=pu(e))=>{a===2?e.set(r,n):a===3?e.add(n):e[r]=n};function G4(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}var If=Array.isArray,Lf=e=>e instanceof Map,$f=e=>e instanceof Set,dy=e=>typeof e=="object",io=e=>typeof e=="function",Kg=e=>typeof e=="boolean";function H4(e){const r=+e;return Number.isInteger(r)&&String(r)===e}var Qa=e=>e.copy_||e.base_,my=e=>e.modified_?e.copy_:e.base_;function Yx(e,r){if(Lf(e))return new Map(e);if($f(e))return new Set(e);if(If(e))return Array[qf].slice.call(e);const n=Yz(e);if(r===!0||r==="class_only"&&!n){const a=gn.getOwnPropertyDescriptors(e);delete a[Vr];let l=Reflect.ownKeys(a);for(let o=0;o<l.length;o++){const u=l[o],d=a[u];d[hm]===!1&&(d[hm]=!0,d[Vx]=!0),(d.get||d.set)&&(a[u]={[Vx]:!0,[hm]:!0,[Tm]:d[Tm],[Yc]:e[u]})}return gn.create(go(e),a)}else{const a=go(e);if(a!==null&&n)return{...e};const l=gn.create(a);return gn.assign(l,e)}}function fy(e,r=!1){return Bf(e)||ti(e)||!aa(e)||(pu(e)>1&&gn.defineProperties(e,{set:Kd,add:Kd,clear:Kd,delete:Kd}),gn.freeze(e),r&&Rf(e,(n,a)=>{fy(a,!0)},!1)),e}function V4(){Zn(2)}var Kd={[Yc]:V4};function Bf(e){return e===null||!dy(e)?!0:gn.isFrozen(e)}var Rm="MapSet",Kx="Patches",fw="ArrayMethods",Kz={};function Ys(e){const r=Kz[e];return r||Zn(0,e),r}var pw=e=>!!Kz[e],Kc,Wz=()=>Kc,Q4=(e,r)=>({drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:pw(Rm)?Ys(Rm):void 0,arrayMethodsPlugin_:pw(fw)?Ys(fw):void 0});function hw(e,r){r&&(e.patchPlugin_=Ys(Kx),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function Wx(e){Xx(e),e.drafts_.forEach(Y4),e.drafts_=null}function Xx(e){e===Kc&&(Kc=e.parent_)}var vw=e=>Kc=Q4(Kc,e);function Y4(e){const r=e[Vr];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function gw(e,r){r.unfinalizedDrafts_=r.drafts_.length;const n=r.drafts_[0];if(e!==void 0&&e!==n){n[Vr].modified_&&(Wx(r),Zn(4)),aa(e)&&(e=xw(r,e));const{patchPlugin_:l}=r;l&&l.generateReplacementPatches_(n[Vr].base_,e,r)}else e=xw(r,n);return K4(r,e,!0),Wx(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==Qz?e:void 0}function xw(e,r){if(Bf(r))return r;const n=r[Vr];if(!n)return Im(r,e.handledSet_,e);if(!Uf(n,e))return r;if(!n.modified_)return n.base_;if(!n.finalized_){const{callbacks_:a}=n;if(a)for(;a.length>0;)a.pop()(e);Jz(n,e)}return n.copy_}function K4(e,r,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&fy(r,n)}function Xz(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var Uf=(e,r)=>e.scope_===r,W4=[];function Zz(e,r,n,a){const l=Qa(e),o=e.type_;if(a!==void 0&&Qx(l,a,o)===r){qm(l,a,n,o);return}if(!e.draftLocations_){const d=e.draftLocations_=new Map;Rf(l,(m,p)=>{if(ti(p)){const h=d.get(p)||[];h.push(m),d.set(p,h)}})}const u=e.draftLocations_.get(r)??W4;for(const d of u)qm(l,d,n,o)}function X4(e,r,n){e.callbacks_.push(function(l){const o=r;if(!o||!Uf(o,l))return;l.mapSetPlugin_?.fixSetContents(o);const u=my(o);Zz(e,o.draft_??o,u,n),Jz(o,l)})}function Jz(e,r){if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){const{patchPlugin_:a}=r;if(a){const l=a.getPath(e);l&&a.generatePatches_(e,l,r)}Xz(e)}}function Z4(e,r,n){const{scope_:a}=e;if(ti(n)){const l=n[Vr];Uf(l,a)&&l.callbacks_.push(function(){vm(e);const u=my(l);Zz(e,n,u,r)})}else aa(n)&&e.callbacks_.push(function(){const o=Qa(e);e.type_===3?o.has(n)&&Im(n,a.handledSet_,a):Qx(o,r,e.type_)===n&&a.drafts_.length>1&&(e.assigned_.get(r)??!1)===!0&&e.copy_&&Im(Qx(e.copy_,r,e.type_),a.handledSet_,a)})}function Im(e,r,n){return!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||ti(e)||r.has(e)||!aa(e)||Bf(e)||(r.add(e),Rf(e,(a,l)=>{if(ti(l)){const o=l[Vr];if(Uf(o,n)){const u=my(o);qm(e,a,u,e.type_),Xz(o)}}else aa(l)&&Im(l,r,n)})),e}function J4(e,r){const n=If(e),a={type_:n?1:0,scope_:r?r.scope_:Wz(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let l=a,o=Lm;n&&(l=[a],o=Wc);const{revoke:u,proxy:d}=Proxy.revocable(l,o);return a.draft_=d,a.revoke_=u,[d,a]}var Lm={get(e,r){if(r===Vr)return e;let n=e.scope_.arrayMethodsPlugin_;const a=e.type_===1&&typeof r=="string";if(a&&n?.isArrayOperationMethod(r))return n.createMethodInterceptor(e,r);const l=Qa(e);if(!mw(l,r,e.type_))return eL(e,l,r);const o=l[r];if(e.finalized_||!aa(o)||a&&e.operationMethod&&n?.isMutatingArrayMethod(e.operationMethod)&&H4(r))return o;if(o===Wg(e.base_,r)){vm(e);const u=e.type_===1?+r:r,d=Jx(e.scope_,o,e,u);return e.copy_[u]=d}return o},has(e,r){return r in Qa(e)},ownKeys(e){return Reflect.ownKeys(Qa(e))},set(e,r,n){const a=ek(Qa(e),r);if(a?.set)return a.set.call(e.draft_,n),!0;if(!e.modified_){const l=Wg(Qa(e),r),o=l?.[Vr];if(o&&o.base_===n)return e.copy_[r]=n,e.assigned_.set(r,!1),!0;if(G4(n,l)&&(n!==void 0||mw(e.base_,r,e.type_)))return!0;vm(e),Zx(e)}return e.copy_[r]===n&&(n!==void 0||r in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=n,e.assigned_.set(r,!0),Z4(e,r,n)),!0},deleteProperty(e,r){return vm(e),Wg(e.base_,r)!==void 0||r in e.base_?(e.assigned_.set(r,!1),Zx(e)):e.assigned_.delete(r),e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const n=Qa(e),a=Reflect.getOwnPropertyDescriptor(n,r);return a&&{[hm]:!0,[Vx]:e.type_!==1||r!=="length",[Tm]:a[Tm],[Yc]:n[r]}},defineProperty(){Zn(11)},getPrototypeOf(e){return go(e.base_)},setPrototypeOf(){Zn(12)}},Wc={};for(let e in Lm){let r=Lm[e];Wc[e]=function(){const n=arguments;return n[0]=n[0][0],r.apply(this,n)}}Wc.deleteProperty=function(e,r){return Wc.set.call(this,e,r,void 0)};Wc.set=function(e,r,n){return Lm.set.call(this,e[0],r,n,e[0])};function Wg(e,r){const n=e[Vr];return(n?Qa(n):e)[r]}function eL(e,r,n){const a=ek(r,n);return a?Yc in a?a[Yc]:a.get?.call(e.draft_):void 0}function ek(e,r){if(!(r in e))return;let n=go(e);for(;n;){const a=Object.getOwnPropertyDescriptor(n,r);if(a)return a;n=go(n)}}function Zx(e){e.modified_||(e.modified_=!0,e.parent_&&Zx(e.parent_))}function vm(e){e.copy_||(e.assigned_=new Map,e.copy_=Yx(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var tL=class{constructor(r){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(n,a,l)=>{if(io(n)&&!io(a)){const u=a;a=n;const d=this;return function(p=u,...h){return d.produce(p,v=>a.call(this,v,...h))}}io(a)||Zn(6),l!==void 0&&!io(l)&&Zn(7);let o;if(aa(n)){const u=vw(this),d=Jx(u,n,void 0);let m=!0;try{o=a(d),m=!1}finally{m?Wx(u):Xx(u)}return hw(u,l),gw(o,u)}else if(!n||!dy(n)){if(o=a(n),o===void 0&&(o=n),o===Qz&&(o=void 0),this.autoFreeze_&&fy(o,!0),l){const u=[],d=[];Ys(Kx).generateReplacementPatches_(n,o,{patches_:u,inversePatches_:d}),l(u,d)}return o}else Zn(1,n)},this.produceWithPatches=(n,a)=>{if(io(n))return(d,...m)=>this.produceWithPatches(d,p=>n(p,...m));let l,o;return[this.produce(n,a,(d,m)=>{l=d,o=m}),l,o]},Kg(r?.autoFreeze)&&this.setAutoFreeze(r.autoFreeze),Kg(r?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(r.useStrictShallowCopy),Kg(r?.useStrictIteration)&&this.setUseStrictIteration(r.useStrictIteration)}createDraft(r){aa(r)||Zn(8),ti(r)&&(r=ta(r));const n=vw(this),a=Jx(n,r,void 0);return a[Vr].isManual_=!0,Xx(n),a}finishDraft(r,n){const a=r&&r[Vr];(!a||!a.isManual_)&&Zn(9);const{scope_:l}=a;return hw(l,n),gw(void 0,l)}setAutoFreeze(r){this.autoFreeze_=r}setUseStrictShallowCopy(r){this.useStrictShallowCopy_=r}setUseStrictIteration(r){this.useStrictIteration_=r}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(r,n){let a;for(a=n.length-1;a>=0;a--){const o=n[a];if(o.path.length===0&&o.op==="replace"){r=o.value;break}}a>-1&&(n=n.slice(a+1));const l=Ys(Kx).applyPatches_;return ti(r)?l(r,n):this.produce(r,o=>l(o,n))}};function Jx(e,r,n,a){const[l,o]=Lf(r)?Ys(Rm).proxyMap_(r,n):$f(r)?Ys(Rm).proxySet_(r,n):J4(r,n);return(n?.scope_??Wz()).drafts_.push(l),o.callbacks_=n?.callbacks_??[],o.key_=a,n&&a!==void 0?X4(n,o,a):o.callbacks_.push(function(m){m.mapSetPlugin_?.fixSetContents(o);const{patchPlugin_:p}=m;o.modified_&&p&&p.generatePatches_(o,[],m)}),l}function ta(e){return ti(e)||Zn(10,e),tk(e)}function tk(e){if(!aa(e)||Bf(e))return e;const r=e[Vr];let n,a=!0;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,n=Yx(e,r.scope_.immer_.useStrictShallowCopy_),a=r.scope_.immer_.shouldUseStrictIteration()}else n=Yx(e,!0);return Rf(n,(l,o)=>{qm(n,l,tk(o))},a),r&&(r.finalized_=!1),n}var rL=new tL,rk=rL.produce;function nk(e){return({dispatch:n,getState:a})=>l=>o=>typeof o=="function"?o(n,a,e):l(o)}var nL=nk(),aL=nk,iL=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Pm:Pm.apply(null,arguments)};function Bn(e,r){function n(...a){if(r){let l=r(...a);if(!l)throw new Error(bn(0));return{type:e,payload:l.payload,..."meta"in l&&{meta:l.meta},..."error"in l&&{error:l.error}}}return{type:e,payload:a[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=a=>Vz(a)&&a.type===e,n}var ak=class Lc extends Array{constructor(...r){super(...r),Object.setPrototypeOf(this,Lc.prototype)}static get[Symbol.species](){return Lc}concat(...r){return super.concat.apply(this,r)}prepend(...r){return r.length===1&&Array.isArray(r[0])?new Lc(...r[0].concat(this)):new Lc(...r.concat(this))}};function bw(e){return aa(e)?rk(e,()=>{}):e}function Wd(e,r,n){return e.has(r)?e.get(r):e.set(r,n(r)).get(r)}function sL(e){return typeof e=="boolean"}var lL=()=>function(r){const{thunk:n=!0,immutableCheck:a=!0,serializableCheck:l=!0,actionCreatorCheck:o=!0}=r??{};let u=new ak;return n&&(sL(n)?u.push(nL):u.push(aL(n.extraArgument))),u},ik="RTK_autoBatch",It=()=>e=>({payload:e,meta:{[ik]:!0}}),yw=e=>r=>{setTimeout(r,e)},sk=(e={type:"raf"})=>r=>(...n)=>{const a=r(...n);let l=!0,o=!1,u=!1;const d=new Set,m=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:yw(10):e.type==="callback"?e.queueNotification:yw(e.timeout),p=()=>{u=!1,o&&(o=!1,d.forEach(h=>h()))};return Object.assign({},a,{subscribe(h){const v=()=>l&&h(),b=a.subscribe(v);return d.add(h),()=>{b(),d.delete(h)}},dispatch(h){try{return l=!h?.meta?.[ik],o=!l,o&&(u||(u=!0,m(p))),a.dispatch(h)}finally{l=!0}}})},oL=e=>function(n){const{autoBatch:a=!0}=n??{};let l=new ak(e);return a&&l.push(sk(typeof a=="object"?a:void 0)),l};function cL(e){const r=lL(),{reducer:n=void 0,middleware:a,devTools:l=!0,preloadedState:o=void 0,enhancers:u=void 0}=e||{};let d;if(typeof n=="function")d=n;else if(uy(n))d=Hz(n);else throw new Error(bn(1));let m;typeof a=="function"?m=a(r):m=r();let p=Pm;l&&(p=iL({trace:!1,...typeof l=="object"&&l}));const h=U4(...m),v=oL(h);let b=typeof u=="function"?u(v):v();const x=p(...b);return Gz(d,o,x)}function lk(e){const r={},n=[];let a;const l={addCase(o,u){const d=typeof o=="string"?o:o.type;if(!d)throw new Error(bn(28));if(d in r)throw new Error(bn(29));return r[d]=u,l},addAsyncThunk(o,u){return u.pending&&(r[o.pending.type]=u.pending),u.rejected&&(r[o.rejected.type]=u.rejected),u.fulfilled&&(r[o.fulfilled.type]=u.fulfilled),u.settled&&n.push({matcher:o.settled,reducer:u.settled}),l},addMatcher(o,u){return n.push({matcher:o,reducer:u}),l},addDefaultCase(o){return a=o,l}};return e(l),[r,n,a]}function uL(e){return typeof e=="function"}function dL(e,r){let[n,a,l]=lk(r),o;if(uL(e))o=()=>bw(e());else{const d=bw(e);o=()=>d}function u(d=o(),m){let p=[n[m.type],...a.filter(({matcher:h})=>h(m)).map(({reducer:h})=>h)];return p.filter(h=>!!h).length===0&&(p=[l]),p.reduce((h,v)=>{if(v)if(ti(h)){const x=v(h,m);return x===void 0?h:x}else{if(aa(h))return rk(h,b=>v(b,m));{const b=v(h,m);if(b===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return b}}return h},d)}return u.getInitialState=o,u}var mL="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",fL=(e=21)=>{let r="",n=e;for(;n--;)r+=mL[Math.random()*64|0];return r},pL=Symbol.for("rtk-slice-createasyncthunk");function hL(e,r){return`${e}/${r}`}function vL({creators:e}={}){const r=e?.asyncThunk?.[pL];return function(a){const{name:l,reducerPath:o=l}=a;if(!l)throw new Error(bn(11));const u=(typeof a.reducers=="function"?a.reducers(xL()):a.reducers)||{},d=Object.keys(u),m={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},p={addCase(S,A){const z=typeof S=="string"?S:S.type;if(!z)throw new Error(bn(12));if(z in m.sliceCaseReducersByType)throw new Error(bn(13));return m.sliceCaseReducersByType[z]=A,p},addMatcher(S,A){return m.sliceMatchers.push({matcher:S,reducer:A}),p},exposeAction(S,A){return m.actionCreators[S]=A,p},exposeCaseReducer(S,A){return m.sliceCaseReducersByName[S]=A,p}};d.forEach(S=>{const A=u[S],z={reducerName:S,type:hL(l,S),createNotation:typeof a.reducers=="function"};yL(A)?_L(z,A,p,r):bL(z,A,p)});function h(){const[S={},A=[],z=void 0]=typeof a.extraReducers=="function"?lk(a.extraReducers):[a.extraReducers],k={...S,...m.sliceCaseReducersByType};return dL(a.initialState,P=>{for(let D in k)P.addCase(D,k[D]);for(let D of m.sliceMatchers)P.addMatcher(D.matcher,D.reducer);for(let D of A)P.addMatcher(D.matcher,D.reducer);z&&P.addDefaultCase(z)})}const v=S=>S,b=new Map,x=new WeakMap;let j;function _(S,A){return j||(j=h()),j(S,A)}function w(){return j||(j=h()),j.getInitialState()}function C(S,A=!1){function z(P){let D=P[S];return typeof D>"u"&&A&&(D=Wd(x,z,w)),D}function k(P=v){const D=Wd(b,A,()=>new WeakMap);return Wd(D,P,()=>{const $={};for(const[F,Y]of Object.entries(a.selectors??{}))$[F]=gL(Y,P,()=>Wd(x,P,w),A);return $})}return{reducerPath:S,getSelectors:k,get selectors(){return k(z)},selectSlice:z}}const E={name:l,reducer:_,actions:m.actionCreators,caseReducers:m.sliceCaseReducersByName,getInitialState:w,...C(o),injectInto(S,{reducerPath:A,...z}={}){const k=A??o;return S.inject({reducerPath:k,reducer:_},z),{...E,...C(k,!0)}}};return E}}function gL(e,r,n,a){function l(o,...u){let d=r(o);return typeof d>"u"&&a&&(d=n()),e(d,...u)}return l.unwrapped=e,l}var ln=vL();function xL(){function e(r,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:r,...n}}return e.withTypes=()=>e,{reducer(r){return Object.assign({[r.name](...n){return r(...n)}}[r.name],{_reducerDefinitionType:"reducer"})},preparedReducer(r,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:r,reducer:n}},asyncThunk:e}}function bL({type:e,reducerName:r,createNotation:n},a,l){let o,u;if("reducer"in a){if(n&&!jL(a))throw new Error(bn(17));o=a.reducer,u=a.prepare}else o=a;l.addCase(e,o).exposeCaseReducer(r,o).exposeAction(r,u?Bn(e,u):Bn(e))}function yL(e){return e._reducerDefinitionType==="asyncThunk"}function jL(e){return e._reducerDefinitionType==="reducerWithPrepare"}function _L({type:e,reducerName:r},n,a,l){if(!l)throw new Error(bn(18));const{payloadCreator:o,fulfilled:u,pending:d,rejected:m,settled:p,options:h}=n,v=l(e,o,h);a.exposeAction(r,v),u&&a.addCase(v.fulfilled,u),d&&a.addCase(v.pending,d),m&&a.addCase(v.rejected,m),p&&a.addMatcher(v.settled,p),a.exposeCaseReducer(r,{fulfilled:u||Xd,pending:d||Xd,rejected:m||Xd,settled:p||Xd})}function Xd(){}var NL="task",ok="listener",ck="completed",py="cancelled",SL=`task-${py}`,wL=`task-${ck}`,eb=`${ok}-${py}`,CL=`${ok}-${ck}`,Ff=class{constructor(e){this.code=e,this.message=`${NL} ${py} (reason: ${e})`}name="TaskAbortError";message},hy=(e,r)=>{if(typeof e!="function")throw new TypeError(bn(32))},$m=()=>{},uk=(e,r=$m)=>(e.catch(r),e),dk=(e,r)=>(e.addEventListener("abort",r,{once:!0}),()=>e.removeEventListener("abort",r)),Fs=e=>{if(e.aborted)throw new Ff(e.reason)};function mk(e,r){let n=$m;return new Promise((a,l)=>{const o=()=>l(new Ff(e.reason));if(e.aborted){o();return}n=dk(e,o),r.finally(()=>n()).then(a,l)}).finally(()=>{n=$m})}var EL=async(e,r)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof Ff?"cancelled":"rejected",error:n}}finally{r?.()}},Bm=e=>r=>uk(mk(e,r).then(n=>(Fs(e),n))),fk=e=>{const r=Bm(e);return n=>r(new Promise(a=>setTimeout(a,n)))},{assign:mo}=Object,jw={},Gf="listenerMiddleware",AL=(e,r)=>{const n=a=>dk(e,()=>a.abort(e.reason));return(a,l)=>{hy(a);const o=new AbortController;n(o);const u=EL(async()=>{Fs(e),Fs(o.signal);const d=await a({pause:Bm(o.signal),delay:fk(o.signal),signal:o.signal});return Fs(o.signal),d},()=>o.abort(wL));return l?.autoJoin&&r.push(u.catch($m)),{result:Bm(e)(u),cancel(){o.abort(SL)}}}},zL=(e,r)=>{const n=async(a,l)=>{Fs(r);let o=()=>{};const d=[new Promise((m,p)=>{let h=e({predicate:a,effect:(v,b)=>{b.unsubscribe(),m([v,b.getState(),b.getOriginalState()])}});o=()=>{h(),p()}})];l!=null&&d.push(new Promise(m=>setTimeout(m,l,null)));try{const m=await mk(r,Promise.race(d));return Fs(r),m}finally{o()}};return(a,l)=>uk(n(a,l))},pk=e=>{let{type:r,actionCreator:n,matcher:a,predicate:l,effect:o}=e;if(r)l=Bn(r).match;else if(n)r=n.type,l=n.match;else if(a)l=a;else if(!l)throw new Error(bn(21));return hy(o),{predicate:l,type:r,effect:o}},hk=mo(e=>{const{type:r,predicate:n,effect:a}=pk(e);return{id:fL(),effect:a,type:r,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(bn(22))}}},{withTypes:()=>hk}),_w=(e,r)=>{const{type:n,effect:a,predicate:l}=pk(r);return Array.from(e.values()).find(o=>(typeof n=="string"?o.type===n:o.predicate===l)&&o.effect===a)},tb=e=>{e.pending.forEach(r=>{r.abort(eb)})},kL=(e,r)=>()=>{for(const n of r.keys())tb(n);e.clear()},Nw=(e,r,n)=>{try{e(r,n)}catch(a){setTimeout(()=>{throw a},0)}},vk=mo(Bn(`${Gf}/add`),{withTypes:()=>vk}),OL=Bn(`${Gf}/removeAll`),gk=mo(Bn(`${Gf}/remove`),{withTypes:()=>gk}),DL=(...e)=>{console.error(`${Gf}/error`,...e)},hu=(e={})=>{const r=new Map,n=new Map,a=x=>{const j=n.get(x)??0;n.set(x,j+1)},l=x=>{const j=n.get(x)??1;j===1?n.delete(x):n.set(x,j-1)},{extra:o,onError:u=DL}=e;hy(u);const d=x=>(x.unsubscribe=()=>r.delete(x.id),r.set(x.id,x),j=>{x.unsubscribe(),j?.cancelActive&&tb(x)}),m=x=>{const j=_w(r,x)??hk(x);return d(j)};mo(m,{withTypes:()=>m});const p=x=>{const j=_w(r,x);return j&&(j.unsubscribe(),x.cancelActive&&tb(j)),!!j};mo(p,{withTypes:()=>p});const h=async(x,j,_,w)=>{const C=new AbortController,E=zL(m,C.signal),S=[];try{x.pending.add(C),a(x),await Promise.resolve(x.effect(j,mo({},_,{getOriginalState:w,condition:(A,z)=>E(A,z).then(Boolean),take:E,delay:fk(C.signal),pause:Bm(C.signal),extra:o,signal:C.signal,fork:AL(C.signal,S),unsubscribe:x.unsubscribe,subscribe:()=>{r.set(x.id,x)},cancelActiveListeners:()=>{x.pending.forEach((A,z,k)=>{A!==C&&(A.abort(eb),k.delete(A))})},cancel:()=>{C.abort(eb),x.pending.delete(C)},throwIfCancelled:()=>{Fs(C.signal)}})))}catch(A){A instanceof Ff||Nw(u,A,{raisedBy:"effect"})}finally{await Promise.all(S),C.abort(CL),l(x),x.pending.delete(C)}},v=kL(r,n);return{middleware:x=>j=>_=>{if(!Vz(_))return j(_);if(vk.match(_))return m(_.payload);if(OL.match(_)){v();return}if(gk.match(_))return p(_.payload);let w=x.getState();const C=()=>{if(w===jw)throw new Error(bn(23));return w};let E;try{if(E=j(_),r.size>0){const S=x.getState(),A=Array.from(r.values());for(const z of A){let k=!1;try{k=z.predicate(_,S,w)}catch(P){k=!1,Nw(u,P,{raisedBy:"predicate"})}k&&h(z,_,x,C)}}}finally{w=jw}return E},startListening:m,stopListening:p,clearListeners:v}};function bn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var PL={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},xk=ln({name:"chartLayout",initialState:PL,reducers:{setLayout(e,r){e.layoutType=r.payload},setChartSize(e,r){e.width=r.payload.width,e.height=r.payload.height},setMargin(e,r){var n,a,l,o;e.margin.top=(n=r.payload.top)!==null&&n!==void 0?n:0,e.margin.right=(a=r.payload.right)!==null&&a!==void 0?a:0,e.margin.bottom=(l=r.payload.bottom)!==null&&l!==void 0?l:0,e.margin.left=(o=r.payload.left)!==null&&o!==void 0?o:0},setScale(e,r){e.scale=r.payload}}}),{setMargin:ML,setLayout:TL,setChartSize:qL,setScale:RL}=xk.actions,IL=xk.reducer;function bk(e,r,n){return Array.isArray(e)&&e&&r+n!==0?e.slice(r,n+1):e}function ut(e){return Number.isFinite(e)}function Sa(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Sw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function lo(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Sw(Object(n),!0).forEach(function(a){LL(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function LL(e,r,n){return(r=$L(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function $L(e){var r=BL(e,"string");return typeof r=="symbol"?r:r+""}function BL(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function ir(e,r,n){return Bt(e)||Bt(r)?n:Na(r)?vo(e,r,n):typeof r=="function"?r(e):n}var UL=(e,r,n)=>{if(r&&n){var{width:a,height:l}=n,{align:o,verticalAlign:u,layout:d}=r;if((d==="vertical"||d==="horizontal"&&u==="middle")&&o!=="center"&&qe(e[o]))return lo(lo({},e),{},{[o]:e[o]+(a||0)});if((d==="horizontal"||d==="vertical"&&o==="center")&&u!=="middle"&&qe(e[u]))return lo(lo({},e),{},{[u]:e[u]+(l||0)})}return e},ui=(e,r)=>e==="horizontal"&&r==="xAxis"||e==="vertical"&&r==="yAxis"||e==="centric"&&r==="angleAxis"||e==="radial"&&r==="radiusAxis",yk=(e,r,n,a)=>{if(a)return e.map(d=>d.coordinate);var l,o,u=e.map(d=>(d.coordinate===r&&(l=!0),d.coordinate===n&&(o=!0),d.coordinate));return l||u.push(r),o||u.push(n),u},jk=(e,r,n)=>{if(!e)return null;var{duplicateDomain:a,type:l,range:o,scale:u,realScaleType:d,isCategorical:m,categoricalDomain:p,tickCount:h,ticks:v,niceTicks:b,axisType:x}=e;if(!u)return null;var j=d==="scaleBand"&&u.bandwidth?u.bandwidth()/2:2,_=l==="category"&&u.bandwidth?u.bandwidth()/j:0;if(_=x==="angleAxis"&&o&&o.length>=2?nn(o[0]-o[1])*2*_:_,v||b){var w=(v||b||[]).map((C,E)=>{var S=a?a.indexOf(C):C,A=u.map(S);return ut(A)?{coordinate:A+_,value:C,offset:_,index:E}:null}).filter(an);return w}return m&&p?p.map((C,E)=>{var S=u.map(C);return ut(S)?{coordinate:S+_,value:C,index:E,offset:_}:null}).filter(an):u.ticks&&h!=null?u.ticks(h).map((C,E)=>{var S=u.map(C);return ut(S)?{coordinate:S+_,value:C,index:E,offset:_}:null}).filter(an):u.domain().map((C,E)=>{var S=u.map(C);return ut(S)?{coordinate:S+_,value:a?a[C]:C,index:E,offset:_}:null}).filter(an)},FL=(e,r)=>{if(!r||r.length!==2||!qe(r[0])||!qe(r[1]))return e;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),l=[e[0],e[1]];return(!qe(e[0])||e[0]<n)&&(l[0]=n),(!qe(e[1])||e[1]>a)&&(l[1]=a),l[0]>a&&(l[0]=a),l[1]<n&&(l[1]=n),l},GL=e=>{var r,n=e.length;if(!(n<=0)){var a=(r=e[0])===null||r===void 0?void 0:r.length;if(!(a==null||a<=0))for(var l=0;l<a;++l)for(var o=0,u=0,d=0;d<n;++d){var m=e[d],p=m?.[l];if(p!=null){var h=p[1],v=p[0],b=_a(h)?v:h;b>=0?(p[0]=o,o+=b,p[1]=o):(p[0]=u,u+=b,p[1]=u)}}}},HL=e=>{var r,n=e.length;if(!(n<=0)){var a=(r=e[0])===null||r===void 0?void 0:r.length;if(!(a==null||a<=0))for(var l=0;l<a;++l)for(var o=0,u=0;u<n;++u){var d=e[u],m=d?.[l];if(m!=null){var p=_a(m[1])?m[0]:m[1];p>=0?(m[0]=o,o+=p,m[1]=o):(m[0]=0,m[1]=0)}}}},VL={sign:GL,expand:y6,none:Vs,silhouette:j6,wiggle:_6,positive:HL},QL=(e,r,n)=>{var a,l=(a=VL[n])!==null&&a!==void 0?a:Vs,o=b6().keys(r).value((d,m)=>Number(ir(d,m,0))).order(Gx).offset(l),u=o(e);return u.forEach((d,m)=>{d.forEach((p,h)=>{var v=ir(e[h],r[m],0);Array.isArray(v)&&v.length===2&&qe(v[0])&&qe(v[1])&&(p[0]=v[0],p[1]=v[1])})}),u};function YL(e){return e==null?void 0:String(e)}function ww(e){var{axis:r,ticks:n,bandSize:a,entry:l,index:o,dataKey:u}=e;if(r.type==="category"){if(!r.allowDuplicatedCategory&&r.dataKey&&!Bt(l[r.dataKey])){var d=Az(n,"value",l[r.dataKey]);if(d)return d.coordinate+a/2}return n!=null&&n[o]?n[o].coordinate+a/2:null}var m=ir(l,Bt(u)?r.dataKey:u),p=r.scale.map(m);return qe(p)?p:null}var Cw=e=>{var{axis:r,ticks:n,offset:a,bandSize:l,entry:o,index:u}=e;if(r.type==="category")return n[u]?n[u].coordinate+a:null;var d=ir(o,r.dataKey,r.scale.domain()[u]);if(Bt(d))return null;var m=r.scale.map(d);return qe(m)?m-l/2+a:null},KL=e=>{var{numericAxis:r}=e,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),l=Math.max(n[0],n[1]);return a<=0&&l>=0?0:l<0?l:a}return n[0]},WL=e=>{var r=e.flat(2).filter(qe);return[Math.min(...r),Math.max(...r)]},XL=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],ZL=(e,r,n)=>{if(e!=null)return XL(Object.keys(e).reduce((a,l)=>{var o=e[l];if(!o)return a;var{stackedData:u}=o,d=u.reduce((m,p)=>{var h=bk(p,r,n),v=WL(h);return!ut(v[0])||!ut(v[1])?m:[Math.min(m[0],v[0]),Math.max(m[1],v[1])]},[1/0,-1/0]);return[Math.min(d[0],a[0]),Math.max(d[1],a[1])]},[1/0,-1/0]))},Ew=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Aw=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,xo=(e,r,n)=>{if(e&&e.scale&&e.scale.bandwidth){var a=e.scale.bandwidth();if(!n||a>0)return a}if(e&&r&&r.length>=2){for(var l=Tf(r,h=>h.coordinate),o=1/0,u=1,d=l.length;u<d;u++){var m=l[u],p=l[u-1];o=Math.min((m?.coordinate||0)-(p?.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0};function zw(e){var{tooltipEntrySettings:r,dataKey:n,payload:a,value:l,name:o}=e;return lo(lo({},r),{},{dataKey:n,payload:a,value:l,name:o})}function Hf(e,r){if(e)return String(e);if(typeof r=="string")return r}var JL=(e,r)=>{if(r==="horizontal")return e.chartX;if(r==="vertical")return e.chartY},e8=(e,r)=>r==="centric"?e.angle:e.radius,di=e=>e.layout.width,mi=e=>e.layout.height,t8=e=>e.layout.scale,_k=e=>e.layout.margin,Vf=me(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Qf=me(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),r8="data-recharts-item-index",n8="data-recharts-item-id",vu=60;function kw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Zd(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?kw(Object(n),!0).forEach(function(a){a8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function a8(e,r,n){return(r=i8(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function i8(e){var r=s8(e,"string");return typeof r=="symbol"?r:r+""}function s8(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var l8=e=>e.brush.height;function o8(e){var r=Qf(e);return r.reduce((n,a)=>{if(a.orientation==="left"&&!a.mirror&&!a.hide){var l=typeof a.width=="number"?a.width:vu;return n+l}return n},0)}function c8(e){var r=Qf(e);return r.reduce((n,a)=>{if(a.orientation==="right"&&!a.mirror&&!a.hide){var l=typeof a.width=="number"?a.width:vu;return n+l}return n},0)}function u8(e){var r=Vf(e);return r.reduce((n,a)=>a.orientation==="top"&&!a.mirror&&!a.hide?n+a.height:n,0)}function d8(e){var r=Vf(e);return r.reduce((n,a)=>a.orientation==="bottom"&&!a.mirror&&!a.hide?n+a.height:n,0)}var Nr=me([di,mi,_k,l8,o8,c8,u8,d8,Fz,q4],(e,r,n,a,l,o,u,d,m,p)=>{var h={left:(n.left||0)+l,right:(n.right||0)+o},v={top:(n.top||0)+u,bottom:(n.bottom||0)+d},b=Zd(Zd({},v),h),x=b.bottom;b.bottom+=a,b=UL(b,m,p);var j=e-b.left-b.right,_=r-b.top-b.bottom;return Zd(Zd({brushBottom:x},b),{},{width:Math.max(j,0),height:Math.max(_,0)})}),m8=me(Nr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),vy=me(di,mi,(e,r)=>({x:0,y:0,width:e,height:r})),f8=g.createContext(null),Lr=()=>g.useContext(f8)!=null,Yf=e=>e.brush,Kf=me([Yf,Nr,_k],(e,r,n)=>({height:e.height,x:qe(e.x)?e.x:r.left,y:qe(e.y)?e.y:r.top+r.height+r.brushBottom-(n?.bottom||0),width:qe(e.width)?e.width:r.width})),Xg={},Zg={},Jg={},Ow;function p8(){return Ow||(Ow=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n,a,{signal:l,edges:o}={}){let u,d=null;const m=o!=null&&o.includes("leading"),p=o==null||o.includes("trailing"),h=()=>{d!==null&&(n.apply(u,d),u=void 0,d=null)},v=()=>{p&&h(),_()};let b=null;const x=()=>{b!=null&&clearTimeout(b),b=setTimeout(()=>{b=null,v()},a)},j=()=>{b!==null&&(clearTimeout(b),b=null)},_=()=>{j(),u=void 0,d=null},w=()=>{h()},C=function(...E){if(l?.aborted)return;u=this,d=E;const S=b==null;x(),m&&S&&h()};return C.schedule=x,C.cancel=_,C.flush=w,l?.addEventListener("abort",_,{once:!0}),C}e.debounce=r})(Jg)),Jg}var Dw;function h8(){return Dw||(Dw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=p8();function n(a,l=0,o={}){typeof o!="object"&&(o={});const{leading:u=!1,trailing:d=!0,maxWait:m}=o,p=Array(2);u&&(p[0]="leading"),d&&(p[1]="trailing");let h,v=null;const b=r.debounce(function(..._){h=a.apply(this,_),v=null},l,{edges:p}),x=function(..._){return m!=null&&(v===null&&(v=Date.now()),Date.now()-v>=m)?(h=a.apply(this,_),v=Date.now(),b.cancel(),b.schedule(),h):(b.apply(this,_),h)},j=()=>(b.flush(),h);return x.cancel=b.cancel,x.flush=j,x}e.debounce=n})(Zg)),Zg}var Pw;function v8(){return Pw||(Pw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=h8();function n(a,l=0,o={}){const{leading:u=!0,trailing:d=!0}=o;return r.debounce(a,l,{leading:u,maxWait:l,trailing:d})}e.throttle=n})(Xg)),Xg}var ex,Mw;function g8(){return Mw||(Mw=1,ex=v8().throttle),ex}var x8=g8();const b8=oi(x8);var Um=function(r,n){for(var a=arguments.length,l=new Array(a>2?a-2:0),o=2;o<a;o++)l[o-2]=arguments[o];if(typeof console<"u"&&console.warn&&(n===void 0&&console.warn("LogUtils requires an error message argument"),!r))if(n===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=0;console.warn(n.replace(/%s/g,()=>l[u++]))}},ga={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},Nk=(e,r,n)=>{var{width:a=ga.width,height:l=ga.height,aspect:o,maxHeight:u}=n,d=Qs(a)?e:Number(a),m=Qs(l)?r:Number(l);return o&&o>0&&(d?m=d/o:m&&(d=m*o),u&&m!=null&&m>u&&(m=u)),{calculatedWidth:d,calculatedHeight:m}},y8={width:0,height:0,overflow:"visible"},j8={width:0,overflowX:"visible"},_8={height:0,overflowY:"visible"},N8={},S8=e=>{var{width:r,height:n}=e,a=Qs(r),l=Qs(n);return a&&l?y8:a?j8:l?_8:N8};function w8(e){var{width:r,height:n,aspect:a}=e,l=r,o=n;return l===void 0&&o===void 0?(l=ga.width,o=ga.height):l===void 0?l=a&&a>0?void 0:ga.width:o===void 0&&(o=a&&a>0?void 0:ga.height),{width:l,height:o}}function rb(){return rb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},rb.apply(null,arguments)}function Tw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function qw(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Tw(Object(n),!0).forEach(function(a){C8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function C8(e,r,n){return(r=E8(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function E8(e){var r=A8(e,"string");return typeof r=="symbol"?r:r+""}function A8(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Sk=g.createContext(ga.initialDimension);function z8(e){return Sa(e.width)&&Sa(e.height)}function wk(e){var{children:r,width:n,height:a}=e,l=g.useMemo(()=>({width:n,height:a}),[n,a]);return z8(l)?g.createElement(Sk.Provider,{value:l},r):null}var gy=()=>g.useContext(Sk),k8=g.forwardRef((e,r)=>{var{aspect:n,initialDimension:a=ga.initialDimension,width:l,height:o,minWidth:u=ga.minWidth,minHeight:d,maxHeight:m,children:p,debounce:h=ga.debounce,id:v,className:b,onResize:x,style:j={}}=e,_=g.useRef(null),w=g.useRef();w.current=x,g.useImperativeHandle(r,()=>_.current);var[C,E]=g.useState({containerWidth:a.width,containerHeight:a.height}),S=g.useCallback((D,$)=>{E(F=>{var Y=Math.round(D),M=Math.round($);return F.containerWidth===Y&&F.containerHeight===M?F:{containerWidth:Y,containerHeight:M}})},[]);g.useEffect(()=>{if(_.current==null||typeof ResizeObserver>"u")return al;var D=M=>{var K,ee=M[0];if(ee!=null){var{width:X,height:L}=ee.contentRect;S(X,L),(K=w.current)===null||K===void 0||K.call(w,X,L)}};h>0&&(D=b8(D,h,{trailing:!0,leading:!1}));var $=new ResizeObserver(D),{width:F,height:Y}=_.current.getBoundingClientRect();return S(F,Y),$.observe(_.current),()=>{$.disconnect()}},[S,h]);var{containerWidth:A,containerHeight:z}=C;Um(!n||n>0,"The aspect(%s) must be greater than zero.",n);var{calculatedWidth:k,calculatedHeight:P}=Nk(A,z,{width:l,height:o,aspect:n,maxHeight:m});return Um(k!=null&&k>0||P!=null&&P>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,k,P,l,o,u,d,n),g.createElement("div",{id:v?"".concat(v):void 0,className:Ct("recharts-responsive-container",b),style:qw(qw({},j),{},{width:l,height:o,minWidth:u,minHeight:d,maxHeight:m}),ref:_},g.createElement("div",{style:S8({width:l,height:o})},g.createElement(wk,{width:k,height:P},p)))}),Rw=g.forwardRef((e,r)=>{var n=gy();if(Sa(n.width)&&Sa(n.height))return e.children;var{width:a,height:l}=w8({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:o,calculatedHeight:u}=Nk(void 0,void 0,{width:a,height:l,aspect:e.aspect,maxHeight:e.maxHeight});return qe(o)&&qe(u)?g.createElement(wk,{width:o,height:u},e.children):g.createElement(k8,rb({},e,{width:a,height:l,ref:r}))});function xy(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var Wf=()=>{var e,r=Lr(),n=Be(m8),a=Be(Kf),l=(e=Be(Yf))===null||e===void 0?void 0:e.padding;return!r||!a||!l?n:{width:a.width-l.left-l.right,height:a.height-l.top-l.bottom,x:l.left,y:l.top}},O8={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Ck=()=>{var e;return(e=Be(Nr))!==null&&e!==void 0?e:O8},Ek=()=>Be(di),Ak=()=>Be(mi),jt=e=>e.layout.layoutType,il=()=>Be(jt),zk=()=>{var e=il();if(e==="horizontal"||e==="vertical")return e},kk=e=>{var r=e.layout.layoutType;if(r==="centric"||r==="radial")return r},D8=()=>{var e=il();return e!==void 0},gu=e=>{var r=Zt(),n=Lr(),{width:a,height:l}=e,o=gy(),u=a,d=l;return o&&(u=o.width>0?o.width:a,d=o.height>0?o.height:l),g.useEffect(()=>{!n&&Sa(u)&&Sa(d)&&r(qL({width:u,height:d}))},[r,n,u,d]),null},Ok=Symbol.for("immer-nothing"),Iw=Symbol.for("immer-draftable"),yn=Symbol.for("immer-state");function Jn(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Xc=Object.getPrototypeOf;function bo(e){return!!e&&!!e[yn]}function Ks(e){return e?Dk(e)||Array.isArray(e)||!!e[Iw]||!!e.constructor?.[Iw]||xu(e)||Zf(e):!1}var P8=Object.prototype.constructor.toString(),Lw=new WeakMap;function Dk(e){if(!e||typeof e!="object")return!1;const r=Object.getPrototypeOf(e);if(r===null||r===Object.prototype)return!0;const n=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let a=Lw.get(n);return a===void 0&&(a=Function.toString.call(n),Lw.set(n,a)),a===P8}function Fm(e,r,n=!0){Xf(e)===0?(n?Reflect.ownKeys(e):Object.keys(e)).forEach(l=>{r(l,e[l],e)}):e.forEach((a,l)=>r(l,a,e))}function Xf(e){const r=e[yn];return r?r.type_:Array.isArray(e)?1:xu(e)?2:Zf(e)?3:0}function nb(e,r){return Xf(e)===2?e.has(r):Object.prototype.hasOwnProperty.call(e,r)}function Pk(e,r,n){const a=Xf(e);a===2?e.set(r,n):a===3?e.add(n):e[r]=n}function M8(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}function xu(e){return e instanceof Map}function Zf(e){return e instanceof Set}function Ps(e){return e.copy_||e.base_}function ab(e,r){if(xu(e))return new Map(e);if(Zf(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=Dk(e);if(r===!0||r==="class_only"&&!n){const a=Object.getOwnPropertyDescriptors(e);delete a[yn];let l=Reflect.ownKeys(a);for(let o=0;o<l.length;o++){const u=l[o],d=a[u];d.writable===!1&&(d.writable=!0,d.configurable=!0),(d.get||d.set)&&(a[u]={configurable:!0,writable:!0,enumerable:d.enumerable,value:e[u]})}return Object.create(Xc(e),a)}else{const a=Xc(e);if(a!==null&&n)return{...e};const l=Object.create(a);return Object.assign(l,e)}}function by(e,r=!1){return Jf(e)||bo(e)||!Ks(e)||(Xf(e)>1&&Object.defineProperties(e,{set:Jd,add:Jd,clear:Jd,delete:Jd}),Object.freeze(e),r&&Object.values(e).forEach(n=>by(n,!0))),e}function T8(){Jn(2)}var Jd={value:T8};function Jf(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var q8={};function Ws(e){const r=q8[e];return r||Jn(0,e),r}var Zc;function Mk(){return Zc}function R8(e,r){return{drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function $w(e,r){r&&(Ws("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function ib(e){sb(e),e.drafts_.forEach(I8),e.drafts_=null}function sb(e){e===Zc&&(Zc=e.parent_)}function Bw(e){return Zc=R8(Zc,e)}function I8(e){const r=e[yn];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function Uw(e,r){r.unfinalizedDrafts_=r.drafts_.length;const n=r.drafts_[0];return e!==void 0&&e!==n?(n[yn].modified_&&(ib(r),Jn(4)),Ks(e)&&(e=Gm(r,e),r.parent_||Hm(r,e)),r.patches_&&Ws("Patches").generateReplacementPatches_(n[yn].base_,e,r.patches_,r.inversePatches_)):e=Gm(r,n,[]),ib(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==Ok?e:void 0}function Gm(e,r,n){if(Jf(r))return r;const a=e.immer_.shouldUseStrictIteration(),l=r[yn];if(!l)return Fm(r,(o,u)=>Fw(e,l,r,o,u,n),a),r;if(l.scope_!==e)return r;if(!l.modified_)return Hm(e,l.base_,!0),l.base_;if(!l.finalized_){l.finalized_=!0,l.scope_.unfinalizedDrafts_--;const o=l.copy_;let u=o,d=!1;l.type_===3&&(u=new Set(o),o.clear(),d=!0),Fm(u,(m,p)=>Fw(e,l,o,m,p,n,d),a),Hm(e,o,!1),n&&e.patches_&&Ws("Patches").generatePatches_(l,n,e.patches_,e.inversePatches_)}return l.copy_}function Fw(e,r,n,a,l,o,u){if(l==null||typeof l!="object"&&!u)return;const d=Jf(l);if(!(d&&!u)){if(bo(l)){const m=o&&r&&r.type_!==3&&!nb(r.assigned_,a)?o.concat(a):void 0,p=Gm(e,l,m);if(Pk(n,a,p),bo(p))e.canAutoFreeze_=!1;else return}else u&&n.add(l);if(Ks(l)&&!d){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||r&&r.base_&&r.base_[a]===l&&d)return;Gm(e,l),(!r||!r.scope_.parent_)&&typeof a!="symbol"&&(xu(n)?n.has(a):Object.prototype.propertyIsEnumerable.call(n,a))&&Hm(e,l)}}}function Hm(e,r,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&by(r,n)}function L8(e,r){const n=Array.isArray(e),a={type_:n?1:0,scope_:r?r.scope_:Mk(),modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let l=a,o=yy;n&&(l=[a],o=Jc);const{revoke:u,proxy:d}=Proxy.revocable(l,o);return a.draft_=d,a.revoke_=u,d}var yy={get(e,r){if(r===yn)return e;const n=Ps(e);if(!nb(n,r))return $8(e,n,r);const a=n[r];return e.finalized_||!Ks(a)?a:a===tx(e.base_,r)?(rx(e),e.copy_[r]=ob(a,e)):a},has(e,r){return r in Ps(e)},ownKeys(e){return Reflect.ownKeys(Ps(e))},set(e,r,n){const a=Tk(Ps(e),r);if(a?.set)return a.set.call(e.draft_,n),!0;if(!e.modified_){const l=tx(Ps(e),r),o=l?.[yn];if(o&&o.base_===n)return e.copy_[r]=n,e.assigned_[r]=!1,!0;if(M8(n,l)&&(n!==void 0||nb(e.base_,r)))return!0;rx(e),lb(e)}return e.copy_[r]===n&&(n!==void 0||r in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=n,e.assigned_[r]=!0),!0},deleteProperty(e,r){return tx(e.base_,r)!==void 0||r in e.base_?(e.assigned_[r]=!1,rx(e),lb(e)):delete e.assigned_[r],e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const n=Ps(e),a=Reflect.getOwnPropertyDescriptor(n,r);return a&&{writable:!0,configurable:e.type_!==1||r!=="length",enumerable:a.enumerable,value:n[r]}},defineProperty(){Jn(11)},getPrototypeOf(e){return Xc(e.base_)},setPrototypeOf(){Jn(12)}},Jc={};Fm(yy,(e,r)=>{Jc[e]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});Jc.deleteProperty=function(e,r){return Jc.set.call(this,e,r,void 0)};Jc.set=function(e,r,n){return yy.set.call(this,e[0],r,n,e[0])};function tx(e,r){const n=e[yn];return(n?Ps(n):e)[r]}function $8(e,r,n){const a=Tk(r,n);return a?"value"in a?a.value:a.get?.call(e.draft_):void 0}function Tk(e,r){if(!(r in e))return;let n=Xc(e);for(;n;){const a=Object.getOwnPropertyDescriptor(n,r);if(a)return a;n=Xc(n)}}function lb(e){e.modified_||(e.modified_=!0,e.parent_&&lb(e.parent_))}function rx(e){e.copy_||(e.copy_=ab(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var B8=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(r,n,a)=>{if(typeof r=="function"&&typeof n!="function"){const o=n;n=r;const u=this;return function(m=o,...p){return u.produce(m,h=>n.call(this,h,...p))}}typeof n!="function"&&Jn(6),a!==void 0&&typeof a!="function"&&Jn(7);let l;if(Ks(r)){const o=Bw(this),u=ob(r,void 0);let d=!0;try{l=n(u),d=!1}finally{d?ib(o):sb(o)}return $w(o,a),Uw(l,o)}else if(!r||typeof r!="object"){if(l=n(r),l===void 0&&(l=r),l===Ok&&(l=void 0),this.autoFreeze_&&by(l,!0),a){const o=[],u=[];Ws("Patches").generateReplacementPatches_(r,l,o,u),a(o,u)}return l}else Jn(1,r)},this.produceWithPatches=(r,n)=>{if(typeof r=="function")return(u,...d)=>this.produceWithPatches(u,m=>r(m,...d));let a,l;return[this.produce(r,n,(u,d)=>{a=u,l=d}),a,l]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Ks(e)||Jn(8),bo(e)&&(e=U8(e));const r=Bw(this),n=ob(e,void 0);return n[yn].isManual_=!0,sb(r),n}finishDraft(e,r){const n=e&&e[yn];(!n||!n.isManual_)&&Jn(9);const{scope_:a}=n;return $w(a,r),Uw(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){const l=r[n];if(l.path.length===0&&l.op==="replace"){e=l.value;break}}n>-1&&(r=r.slice(n+1));const a=Ws("Patches").applyPatches_;return bo(e)?a(e,r):this.produce(e,l=>a(l,r))}};function ob(e,r){const n=xu(e)?Ws("MapSet").proxyMap_(e,r):Zf(e)?Ws("MapSet").proxySet_(e,r):L8(e,r);return(r?r.scope_:Mk()).drafts_.push(n),n}function U8(e){return bo(e)||Jn(10,e),qk(e)}function qk(e){if(!Ks(e)||Jf(e))return e;const r=e[yn];let n,a=!0;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,n=ab(e,r.scope_.immer_.useStrictShallowCopy_),a=r.scope_.immer_.shouldUseStrictIteration()}else n=ab(e,!0);return Fm(n,(l,o)=>{Pk(n,l,qk(o))},a),r&&(r.finalized_=!1),n}var F8=new B8;F8.produce;var G8={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Rk=ln({name:"legend",initialState:G8,reducers:{setLegendSize(e,r){e.size.width=r.payload.width,e.size.height=r.payload.height},setLegendSettings(e,r){e.settings.align=r.payload.align,e.settings.layout=r.payload.layout,e.settings.verticalAlign=r.payload.verticalAlign,e.settings.itemSorter=r.payload.itemSorter},addLegendPayload:{reducer(e,r){e.payload.push(r.payload)},prepare:It()},replaceLegendPayload:{reducer(e,r){var{prev:n,next:a}=r.payload,l=ta(e).payload.indexOf(n);l>-1&&(e.payload[l]=a)},prepare:It()},removeLegendPayload:{reducer(e,r){var n=ta(e).payload.indexOf(r.payload);n>-1&&e.payload.splice(n,1)},prepare:It()}}}),{setLegendSize:dre,setLegendSettings:mre,addLegendPayload:H8,replaceLegendPayload:V8,removeLegendPayload:Q8}=Rk.actions,Y8=Rk.reducer;function cb(){return cb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},cb.apply(null,arguments)}function Gw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Cc(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Gw(Object(n),!0).forEach(function(a){K8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function K8(e,r,n){return(r=W8(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function W8(e){var r=X8(e,"string");return typeof r=="symbol"?r:r+""}function X8(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Z8(e){return Array.isArray(e)&&Na(e[0])&&Na(e[1])?e.join(" ~ "):e}var Jl={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},J8=e=>{var{separator:r=Jl.separator,contentStyle:n,itemStyle:a,labelStyle:l=Jl.labelStyle,payload:o,formatter:u,itemSorter:d,wrapperClassName:m,labelClassName:p,label:h,labelFormatter:v,accessibilityLayer:b=Jl.accessibilityLayer}=e,x=()=>{if(o&&o.length){var z={padding:0,margin:0},k=(d?Tf(o,d):o).map((P,D)=>{if(P.type==="none")return null;var $=P.formatter||u||Z8,{value:F,name:Y}=P,M=F,K=Y;if($){var ee=$(F,Y,P,D,o);if(Array.isArray(ee))[M,K]=ee;else if(ee!=null)M=ee;else return null}var X=Cc(Cc({},Jl.itemStyle),{},{color:P.color||Jl.itemStyle.color},a);return g.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(D),style:X},Na(K)?g.createElement("span",{className:"recharts-tooltip-item-name"},K):null,Na(K)?g.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,g.createElement("span",{className:"recharts-tooltip-item-value"},M),g.createElement("span",{className:"recharts-tooltip-item-unit"},P.unit||""))});return g.createElement("ul",{className:"recharts-tooltip-item-list",style:z},k)}return null},j=Cc(Cc({},Jl.contentStyle),n),_=Cc({margin:0},l),w=!Bt(h),C=w?h:"",E=Ct("recharts-default-tooltip",m),S=Ct("recharts-tooltip-label",p);w&&v&&o!==void 0&&o!==null&&(C=v(h,o));var A=b?{role:"status","aria-live":"assertive"}:{};return g.createElement("div",cb({className:E,style:j},A),g.createElement("p",{className:S,style:_},g.isValidElement(C)?C:"".concat(C)),x())},Ec="recharts-tooltip-wrapper",e$={visibility:"hidden"};function t$(e){var{coordinate:r,translateX:n,translateY:a}=e;return Ct(Ec,{["".concat(Ec,"-right")]:qe(n)&&r&&qe(r.x)&&n>=r.x,["".concat(Ec,"-left")]:qe(n)&&r&&qe(r.x)&&n<r.x,["".concat(Ec,"-bottom")]:qe(a)&&r&&qe(r.y)&&a>=r.y,["".concat(Ec,"-top")]:qe(a)&&r&&qe(r.y)&&a<r.y})}function Hw(e){var{allowEscapeViewBox:r,coordinate:n,key:a,offset:l,position:o,reverseDirection:u,tooltipDimension:d,viewBox:m,viewBoxDimension:p}=e;if(o&&qe(o[a]))return o[a];var h=n[a]-d-(l>0?l:0),v=n[a]+l;if(r[a])return u[a]?h:v;var b=m[a];if(b==null)return 0;if(u[a]){var x=h,j=b;return x<j?Math.max(v,b):Math.max(h,b)}if(p==null)return 0;var _=v+d,w=b+p;return _>w?Math.max(h,b):Math.max(v,b)}function r$(e){var{translateX:r,translateY:n,useTranslate3d:a}=e;return{transform:a?"translate3d(".concat(r,"px, ").concat(n,"px, 0)"):"translate(".concat(r,"px, ").concat(n,"px)")}}function n$(e){var{allowEscapeViewBox:r,coordinate:n,offsetTop:a,offsetLeft:l,position:o,reverseDirection:u,tooltipBox:d,useTranslate3d:m,viewBox:p}=e,h,v,b;return d.height>0&&d.width>0&&n?(v=Hw({allowEscapeViewBox:r,coordinate:n,key:"x",offset:l,position:o,reverseDirection:u,tooltipDimension:d.width,viewBox:p,viewBoxDimension:p.width}),b=Hw({allowEscapeViewBox:r,coordinate:n,key:"y",offset:a,position:o,reverseDirection:u,tooltipDimension:d.height,viewBox:p,viewBoxDimension:p.height}),h=r$({translateX:v,translateY:b,useTranslate3d:m})):h=e$,{cssProperties:h,cssClasses:t$({translateX:v,translateY:b,coordinate:n})}}function Vw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function em(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Vw(Object(n),!0).forEach(function(a){ub(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function ub(e,r,n){return(r=a$(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function a$(e){var r=i$(e,"string");return typeof r=="symbol"?r:r+""}function i$(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}class s$ extends g.PureComponent{constructor(){super(...arguments),ub(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),ub(this,"handleKeyDown",r=>{if(r.key==="Escape"){var n,a,l,o;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==null&&n!==void 0?n:0,y:(l=(o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==null&&l!==void 0?l:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var r,n;this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:l,children:o,coordinate:u,hasPayload:d,isAnimationActive:m,offset:p,position:h,reverseDirection:v,useTranslate3d:b,viewBox:x,wrapperStyle:j,lastBoundingBox:_,innerRef:w,hasPortalFromProps:C}=this.props,E=typeof p=="number"?p:p.x,S=typeof p=="number"?p:p.y,{cssClasses:A,cssProperties:z}=n$({allowEscapeViewBox:n,coordinate:u,offsetLeft:E,offsetTop:S,position:h,reverseDirection:v,tooltipBox:{height:_.height,width:_.width},useTranslate3d:b,viewBox:x}),k=C?{}:em(em({transition:m&&r?"transform ".concat(a,"ms ").concat(l):void 0},z),{},{pointerEvents:"none",visibility:!this.state.dismissed&&r&&d?"visible":"hidden",position:"absolute",top:0,left:0}),P=em(em({},k),{},{visibility:!this.state.dismissed&&r&&d?"visible":"hidden"},j);return g.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:A,style:P,ref:w},o)}}var Ik=()=>{var e;return(e=Be(r=>r.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function db(){return db=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},db.apply(null,arguments)}function Qw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Yw(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Qw(Object(n),!0).forEach(function(a){l$(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function l$(e,r,n){return(r=o$(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function o$(e){var r=c$(e,"string");return typeof r=="symbol"?r:r+""}function c$(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Kw={curveBasisClosed:o6,curveBasisOpen:c6,curveBasis:l6,curveBumpX:QI,curveBumpY:YI,curveLinearClosed:u6,curveLinear:Pf,curveMonotoneX:d6,curveMonotoneY:m6,curveNatural:f6,curveStep:p6,curveStepAfter:v6,curveStepBefore:h6},Vm=e=>ut(e.x)&&ut(e.y),Ww=e=>e.base!=null&&Vm(e.base)&&Vm(e),Ac=e=>e.x,zc=e=>e.y,u$=(e,r)=>{if(typeof e=="function")return e;var n="curve".concat(fu(e));if((n==="curveMonotone"||n==="curveBump")&&r){var a=Kw["".concat(n).concat(r==="vertical"?"Y":"X")];if(a)return a}return Kw[n]||Pf},Xw={connectNulls:!1,type:"linear"},d$=e=>{var{type:r=Xw.type,points:n=[],baseLine:a,layout:l,connectNulls:o=Xw.connectNulls}=e,u=u$(r,l),d=o?n.filter(Vm):n;if(Array.isArray(a)){var m,p=n.map((j,_)=>Yw(Yw({},j),{},{base:a[_]}));l==="vertical"?m=Vd().y(zc).x1(Ac).x0(j=>j.base.x):m=Vd().x(Ac).y1(zc).y0(j=>j.base.y);var h=m.defined(Ww).curve(u),v=o?p.filter(Ww):p;return h(v)}var b;l==="vertical"&&qe(a)?b=Vd().y(zc).x1(Ac).x0(a):qe(a)?b=Vd().x(Ac).y1(zc).y0(a):b=hz().x(Ac).y(zc);var x=b.defined(Vm).curve(u);return x(d)},Lk=e=>{var{className:r,points:n,path:a,pathRef:l}=e,o=il();if((!n||!n.length)&&!a)return null;var u={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||o,connectNulls:e.connectNulls},d=n&&n.length?d$(u):a;return g.createElement("path",db({},ra(e),iy(e),{className:Ct("recharts-curve",r),d:d===null?void 0:d,ref:l}))},m$=["x","y","top","left","width","height","className"];function mb(){return mb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},mb.apply(null,arguments)}function Zw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function f$(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Zw(Object(n),!0).forEach(function(a){p$(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function p$(e,r,n){return(r=h$(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function h$(e){var r=v$(e,"string");return typeof r=="symbol"?r:r+""}function v$(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function g$(e,r){if(e==null)return{};var n,a,l=x$(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function x$(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var b$=(e,r,n,a,l,o)=>"M".concat(e,",").concat(l,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(n),y$=e=>{var{x:r=0,y:n=0,top:a=0,left:l=0,width:o=0,height:u=0,className:d}=e,m=g$(e,m$),p=f$({x:r,y:n,top:a,left:l,width:o,height:u},m);return!qe(r)||!qe(n)||!qe(o)||!qe(u)||!qe(a)||!qe(l)?null:g.createElement("path",mb({},Hr(p),{className:Ct("recharts-cross",d),d:b$(r,n,o,u,a,l)}))};function j$(e,r,n,a){var l=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?r.x-l:n.left+.5,y:e==="horizontal"?n.top+.5:r.y-l,width:e==="horizontal"?a:n.width-1,height:e==="horizontal"?n.height-1:a}}function Jw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function eC(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Jw(Object(n),!0).forEach(function(a){_$(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _$(e,r,n){return(r=N$(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function N$(e){var r=S$(e,"string");return typeof r=="symbol"?r:r+""}function S$(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var w$=e=>e.replace(/([A-Z])/g,r=>"-".concat(r.toLowerCase())),$k=(e,r,n)=>e.map(a=>"".concat(w$(a)," ").concat(r,"ms ").concat(n)).join(","),C$=(e,r)=>[Object.keys(e),Object.keys(r)].reduce((n,a)=>n.filter(l=>a.includes(l))),eu=(e,r)=>Object.keys(r).reduce((n,a)=>eC(eC({},n),{},{[a]:e(a,r[a])}),{});function tC(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function or(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?tC(Object(n),!0).forEach(function(a){E$(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tC(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function E$(e,r,n){return(r=A$(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function A$(e){var r=z$(e,"string");return typeof r=="symbol"?r:r+""}function z$(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Qm=(e,r,n)=>e+(r-e)*n,fb=e=>{var{from:r,to:n}=e;return r!==n},Bk=(e,r,n)=>{var a=eu((l,o)=>{if(fb(o)){var[u,d]=e(o.from,o.to,o.velocity);return or(or({},o),{},{from:u,velocity:d})}return o},r);return n<1?eu((l,o)=>fb(o)&&a[l]!=null?or(or({},o),{},{velocity:Qm(o.velocity,a[l].velocity,n),from:Qm(o.from,a[l].from,n)}):o,r):Bk(e,a,n-1)};function k$(e,r,n,a,l,o){var u,d=a.reduce((b,x)=>or(or({},b),{},{[x]:{from:e[x],velocity:0,to:r[x]}}),{}),m=()=>eu((b,x)=>x.from,d),p=()=>!Object.values(d).filter(fb).length,h=null,v=b=>{u||(u=b);var x=b-u,j=x/n.dt;d=Bk(n,d,j),l(or(or(or({},e),r),m())),u=b,p()||(h=o.setTimeout(v))};return()=>(h=o.setTimeout(v),()=>{var b;(b=h)===null||b===void 0||b()})}function O$(e,r,n,a,l,o,u){var d=null,m=l.reduce((v,b)=>{var x=e[b],j=r[b];return x==null||j==null?v:or(or({},v),{},{[b]:[x,j]})},{}),p,h=v=>{p||(p=v);var b=(v-p)/a,x=eu((_,w)=>Qm(...w,n(b)),m);if(o(or(or(or({},e),r),x)),b<1)d=u.setTimeout(h);else{var j=eu((_,w)=>Qm(...w,n(1)),m);o(or(or(or({},e),r),j))}};return()=>(d=u.setTimeout(h),()=>{var v;(v=d)===null||v===void 0||v()})}const D$=(e,r,n,a,l,o)=>{var u=C$(e,r);return n==null?()=>(l(or(or({},e),r)),()=>{}):n.isStepper===!0?k$(e,r,n,u,l,o):O$(e,r,n,a,u,l,o)};var Ym=1e-4,Uk=(e,r)=>[0,3*e,3*r-6*e,3*e-3*r+1],Fk=(e,r)=>e.map((n,a)=>n*r**a).reduce((n,a)=>n+a),rC=(e,r)=>n=>{var a=Uk(e,r);return Fk(a,n)},P$=(e,r)=>n=>{var a=Uk(e,r),l=[...a.map((o,u)=>o*u).slice(1),0];return Fk(l,n)},M$=e=>{var r,n=e.split("(");if(n.length!==2||n[0]!=="cubic-bezier")return null;var a=(r=n[1])===null||r===void 0||(r=r.split(")")[0])===null||r===void 0?void 0:r.split(",");if(a==null||a.length!==4)return null;var l=a.map(o=>parseFloat(o));return[l[0],l[1],l[2],l[3]]},T$=function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];if(n.length===1)switch(n[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var l=M$(n[0]);if(l)return l}}return n.length===4?n:[0,0,1,1]},q$=(e,r,n,a)=>{var l=rC(e,n),o=rC(r,a),u=P$(e,n),d=p=>p>1?1:p<0?0:p,m=p=>{for(var h=p>1?1:p,v=h,b=0;b<8;++b){var x=l(v)-h,j=u(v);if(Math.abs(x-h)<Ym||j<Ym)return o(v);v=d(v-x/j)}return o(v)};return m.isStepper=!1,m},nC=function(){return q$(...T$(...arguments))},R$=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:a=8,dt:l=17}=r,o=(u,d,m)=>{var p=-(u-d)*n,h=m*a,v=m+(p-h)*l/1e3,b=m*l/1e3+u;return Math.abs(b-d)<Ym&&Math.abs(v)<Ym?[d,0]:[b,v]};return o.isStepper=!0,o.dt=l,o},I$=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return nC(e);case"spring":return R$();default:if(e.split("(")[0]==="cubic-bezier")return nC(e)}return typeof e=="function"?e:null};function L$(e){var r,n=()=>null,a=!1,l=null,o=u=>{if(!a){if(Array.isArray(u)){if(!u.length)return;var d=u,[m,...p]=d;if(typeof m=="number"){l=e.setTimeout(o.bind(null,p),m);return}o(m),l=e.setTimeout(o.bind(null,p));return}typeof u=="string"&&(r=u,n(r)),typeof u=="object"&&(r=u,n(r)),typeof u=="function"&&u()}};return{stop:()=>{a=!0},start:u=>{a=!1,l&&(l(),l=null),o(u)},subscribe:u=>(n=u,()=>{n=()=>null}),getTimeoutController:()=>e}}class $${setTimeout(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=performance.now(),l=null,o=u=>{u-a>=n?r(u):typeof requestAnimationFrame=="function"&&(l=requestAnimationFrame(o))};return l=requestAnimationFrame(o),()=>{l!=null&&cancelAnimationFrame(l)}}}function B$(){return L$(new $$)}var U$=g.createContext(B$);function F$(e,r){var n=g.useContext(U$);return g.useMemo(()=>r??n(e),[e,r,n])}var G$=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),ep={isSsr:G$()},H$={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},aC={t:0},nx={t:1};function tp(e){var r=Qr(e,H$),{isActive:n,canBegin:a,duration:l,easing:o,begin:u,onAnimationEnd:d,onAnimationStart:m,children:p}=r,h=n==="auto"?!ep.isSsr:n,v=F$(r.animationId,r.animationManager),[b,x]=g.useState(h?aC:nx),j=g.useRef(null);return g.useEffect(()=>{h||x(nx)},[h]),g.useEffect(()=>{if(!h||!a)return al;var _=D$(aC,nx,I$(o),l,x,v.getTimeoutController()),w=()=>{j.current=_()};return v.start([m,u,w,l,d]),()=>{v.stop(),j.current&&j.current(),d()}},[h,a,l,o,u,m,d,v]),p(b.t)}function rp(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=g.useRef(Qc(r)),a=g.useRef(e);return a.current!==e&&(n.current=Qc(r),a.current=e),n.current}var V$=["radius"],Q$=["radius"],iC,sC,lC,oC,cC,uC,dC,mC,fC,pC;function hC(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function vC(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?hC(Object(n),!0).forEach(function(a){Y$(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hC(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Y$(e,r,n){return(r=K$(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function K$(e){var r=W$(e,"string");return typeof r=="symbol"?r:r+""}function W$(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Km(){return Km=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Km.apply(null,arguments)}function gC(e,r){if(e==null)return{};var n,a,l=X$(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function X$(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function ma(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}var xC=(e,r,n,a,l)=>{var o=Wi(n),u=Wi(a),d=Math.min(Math.abs(o)/2,Math.abs(u)/2),m=u>=0?1:-1,p=o>=0?1:-1,h=u>=0&&o>=0||u<0&&o<0?1:0,v;if(d>0&&Array.isArray(l)){for(var b=[0,0,0,0],x=0,j=4;x<j;x++){var _,w=(_=l[x])!==null&&_!==void 0?_:0;b[x]=w>d?d:w}v=Vt(iC||(iC=ma(["M",",",""])),e,r+m*b[0]),b[0]>0&&(v+=Vt(sC||(sC=ma(["A ",",",",0,0,",",",",",""])),b[0],b[0],h,e+p*b[0],r)),v+=Vt(lC||(lC=ma(["L ",",",""])),e+n-p*b[1],r),b[1]>0&&(v+=Vt(oC||(oC=ma(["A ",",",",0,0,",`,
        `,",",""])),b[1],b[1],h,e+n,r+m*b[1])),v+=Vt(cC||(cC=ma(["L ",",",""])),e+n,r+a-m*b[2]),b[2]>0&&(v+=Vt(uC||(uC=ma(["A ",",",",0,0,",`,
        `,",",""])),b[2],b[2],h,e+n-p*b[2],r+a)),v+=Vt(dC||(dC=ma(["L ",",",""])),e+p*b[3],r+a),b[3]>0&&(v+=Vt(mC||(mC=ma(["A ",",",",0,0,",`,
        `,",",""])),b[3],b[3],h,e,r+a-m*b[3])),v+="Z"}else if(d>0&&l===+l&&l>0){var C=Math.min(d,l);v=Vt(fC||(fC=ma(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,r+m*C,C,C,h,e+p*C,r,e+n-p*C,r,C,C,h,e+n,r+m*C,e+n,r+a-m*C,C,C,h,e+n-p*C,r+a,e+p*C,r+a,C,C,h,e,r+a-m*C)}else v=Vt(pC||(pC=ma(["M ",","," h "," v "," h "," Z"])),e,r,n,a,-n);return v},bC={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Gk=e=>{var r=Qr(e,bC),n=g.useRef(null),[a,l]=g.useState(-1);g.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var I=n.current.getTotalLength();I&&l(I)}catch{}},[]);var{x:o,y:u,width:d,height:m,radius:p,className:h}=r,{animationEasing:v,animationDuration:b,animationBegin:x,isAnimationActive:j,isUpdateAnimationActive:_}=r,w=g.useRef(d),C=g.useRef(m),E=g.useRef(o),S=g.useRef(u),A=g.useMemo(()=>({x:o,y:u,width:d,height:m,radius:p}),[o,u,d,m,p]),z=rp(A,"rectangle-");if(o!==+o||u!==+u||d!==+d||m!==+m||d===0||m===0)return null;var k=Ct("recharts-rectangle",h);if(!_){var P=Hr(r),{radius:D}=P,$=gC(P,V$);return g.createElement("path",Km({},$,{x:Wi(o),y:Wi(u),width:Wi(d),height:Wi(m),radius:typeof p=="number"?p:void 0,className:k,d:xC(o,u,d,m,p)}))}var F=w.current,Y=C.current,M=E.current,K=S.current,ee="0px ".concat(a===-1?1:a,"px"),X="".concat(a,"px 0px"),L=$k(["strokeDasharray"],b,typeof v=="string"?v:bC.animationEasing);return g.createElement(tp,{animationId:z,key:z,canBegin:a>0,duration:b,easing:v,isActive:_,begin:x},I=>{var U=Qt(F,d,I),B=Qt(Y,m,I),T=Qt(M,o,I),Z=Qt(K,u,I);n.current&&(w.current=U,C.current=B,E.current=T,S.current=Z);var H;j?I>0?H={transition:L,strokeDasharray:X}:H={strokeDasharray:ee}:H={strokeDasharray:X};var ce=Hr(r),{radius:xe}=ce,fe=gC(ce,Q$);return g.createElement("path",Km({},fe,{radius:typeof p=="number"?p:void 0,className:k,d:xC(T,Z,U,B,p),ref:n,style:vC(vC({},H),r.style)}))})};function yC(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function jC(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?yC(Object(n),!0).forEach(function(a){Z$(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yC(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Z$(e,r,n){return(r=J$(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function J$(e){var r=e7(e,"string");return typeof r=="symbol"?r:r+""}function e7(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Wm=Math.PI/180,t7=e=>e*180/Math.PI,Mr=(e,r,n,a)=>({x:e+Math.cos(-Wm*a)*n,y:r+Math.sin(-Wm*a)*n}),r7=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(r-(a.left||0)-(a.right||0)),Math.abs(n-(a.top||0)-(a.bottom||0)))/2},n7=(e,r)=>{var{x:n,y:a}=e,{x:l,y:o}=r;return Math.sqrt((n-l)**2+(a-o)**2)},a7=(e,r)=>{var{x:n,y:a}=e,{cx:l,cy:o}=r,u=n7({x:n,y:a},{x:l,y:o});if(u<=0)return{radius:u,angle:0};var d=(n-l)/u,m=Math.acos(d);return a>o&&(m=2*Math.PI-m),{radius:u,angle:t7(m),angleInRadian:m}},i7=e=>{var{startAngle:r,endAngle:n}=e,a=Math.floor(r/360),l=Math.floor(n/360),o=Math.min(a,l);return{startAngle:r-o*360,endAngle:n-o*360}},s7=(e,r)=>{var{startAngle:n,endAngle:a}=r,l=Math.floor(n/360),o=Math.floor(a/360),u=Math.min(l,o);return e+u*360},l7=(e,r)=>{var{chartX:n,chartY:a}=e,{radius:l,angle:o}=a7({x:n,y:a},r),{innerRadius:u,outerRadius:d}=r;if(l<u||l>d||l===0)return null;var{startAngle:m,endAngle:p}=i7(r),h=o,v;if(m<=p){for(;h>p;)h-=360;for(;h<m;)h+=360;v=h>=m&&h<=p}else{for(;h>m;)h-=360;for(;h<p;)h+=360;v=h>=p&&h<=m}return v?jC(jC({},r),{},{radius:l,angle:s7(h,r)}):null};function Hk(e){var{cx:r,cy:n,radius:a,startAngle:l,endAngle:o}=e,u=Mr(r,n,a,l),d=Mr(r,n,a,o);return{points:[u,d],cx:r,cy:n,radius:a,startAngle:l,endAngle:o}}var _C,NC,SC,wC,CC,EC,AC;function pb(){return pb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},pb.apply(null,arguments)}function Ts(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}var o7=(e,r)=>{var n=nn(r-e),a=Math.min(Math.abs(r-e),359.999);return n*a},tm=e=>{var{cx:r,cy:n,radius:a,angle:l,sign:o,isExternal:u,cornerRadius:d,cornerIsExternal:m}=e,p=d*(u?1:-1)+a,h=Math.asin(d/p)/Wm,v=m?l:l+o*h,b=Mr(r,n,p,v),x=Mr(r,n,a,v),j=m?l-o*h:l,_=Mr(r,n,p*Math.cos(h*Wm),j);return{center:b,circleTangency:x,lineTangency:_,theta:h}},Vk=e=>{var{cx:r,cy:n,innerRadius:a,outerRadius:l,startAngle:o,endAngle:u}=e,d=o7(o,u),m=o+d,p=Mr(r,n,l,o),h=Mr(r,n,l,m),v=Vt(_C||(_C=Ts(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),p.x,p.y,l,l,+(Math.abs(d)>180),+(o>m),h.x,h.y);if(a>0){var b=Mr(r,n,a,o),x=Mr(r,n,a,m);v+=Vt(NC||(NC=Ts(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),x.x,x.y,a,a,+(Math.abs(d)>180),+(o<=m),b.x,b.y)}else v+=Vt(SC||(SC=Ts(["L ",","," Z"])),r,n);return v},c7=e=>{var{cx:r,cy:n,innerRadius:a,outerRadius:l,cornerRadius:o,forceCornerRadius:u,cornerIsExternal:d,startAngle:m,endAngle:p}=e,h=nn(p-m),{circleTangency:v,lineTangency:b,theta:x}=tm({cx:r,cy:n,radius:l,angle:m,sign:h,cornerRadius:o,cornerIsExternal:d}),{circleTangency:j,lineTangency:_,theta:w}=tm({cx:r,cy:n,radius:l,angle:p,sign:-h,cornerRadius:o,cornerIsExternal:d}),C=d?Math.abs(m-p):Math.abs(m-p)-x-w;if(C<0)return u?Vt(wC||(wC=Ts(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),b.x,b.y,o,o,o*2,o,o,-o*2):Vk({cx:r,cy:n,innerRadius:a,outerRadius:l,startAngle:m,endAngle:p});var E=Vt(CC||(CC=Ts(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),b.x,b.y,o,o,+(h<0),v.x,v.y,l,l,+(C>180),+(h<0),j.x,j.y,o,o,+(h<0),_.x,_.y);if(a>0){var{circleTangency:S,lineTangency:A,theta:z}=tm({cx:r,cy:n,radius:a,angle:m,sign:h,isExternal:!0,cornerRadius:o,cornerIsExternal:d}),{circleTangency:k,lineTangency:P,theta:D}=tm({cx:r,cy:n,radius:a,angle:p,sign:-h,isExternal:!0,cornerRadius:o,cornerIsExternal:d}),$=d?Math.abs(m-p):Math.abs(m-p)-z-D;if($<0&&o===0)return"".concat(E,"L").concat(r,",").concat(n,"Z");E+=Vt(EC||(EC=Ts(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),P.x,P.y,o,o,+(h<0),k.x,k.y,a,a,+($>180),+(h>0),S.x,S.y,o,o,+(h<0),A.x,A.y)}else E+=Vt(AC||(AC=Ts(["L",",","Z"])),r,n);return E},u7={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Qk=e=>{var r=Qr(e,u7),{cx:n,cy:a,innerRadius:l,outerRadius:o,cornerRadius:u,forceCornerRadius:d,cornerIsExternal:m,startAngle:p,endAngle:h,className:v}=r;if(o<l||p===h)return null;var b=Ct("recharts-sector",v),x=o-l,j=na(u,x,0,!0),_;return j>0&&Math.abs(p-h)<360?_=c7({cx:n,cy:a,innerRadius:l,outerRadius:o,cornerRadius:Math.min(j,x/2),forceCornerRadius:d,cornerIsExternal:m,startAngle:p,endAngle:h}):_=Vk({cx:n,cy:a,innerRadius:l,outerRadius:o,startAngle:p,endAngle:h}),g.createElement("path",pb({},Hr(r),{className:b,d:_}))};function d7(e,r,n){if(e==="horizontal")return[{x:r.x,y:n.top},{x:r.x,y:n.top+n.height}];if(e==="vertical")return[{x:n.left,y:r.y},{x:n.left+n.width,y:r.y}];if(Oz(r)){if(e==="centric"){var{cx:a,cy:l,innerRadius:o,outerRadius:u,angle:d}=r,m=Mr(a,l,o,d),p=Mr(a,l,u,d);return[{x:m.x,y:m.y},{x:p.x,y:p.y}]}return Hk(r)}}var ax={},ix={},sx={},zC;function m7(){return zC||(zC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Bz();function n(a){return r.isSymbol(a)?NaN:Number(a)}e.toNumber=n})(sx)),sx}var kC;function f7(){return kC||(kC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=m7();function n(a){return a?(a=r.toNumber(a),a===1/0||a===-1/0?(a<0?-1:1)*Number.MAX_VALUE:a===a?a:0):a===0?a:0}e.toFinite=n})(ix)),ix}var OC;function p7(){return OC||(OC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Uz(),n=f7();function a(l,o,u){u&&typeof u!="number"&&r.isIterateeCall(l,o,u)&&(o=u=void 0),l=n.toFinite(l),o===void 0?(o=l,l=0):o=n.toFinite(o),u=u===void 0?l<o?1:-1:n.toFinite(u);const d=Math.max(Math.ceil((o-l)/(u||1)),0),m=new Array(d);for(let p=0;p<d;p++)m[p]=l,l+=u;return m}e.range=a})(ax)),ax}var lx,DC;function h7(){return DC||(DC=1,lx=p7().range),lx}var v7=h7();const Yk=oi(v7);function Ji(e,r){return e==null||r==null?NaN:e<r?-1:e>r?1:e>=r?0:NaN}function g7(e,r){return e==null||r==null?NaN:r<e?-1:r>e?1:r>=e?0:NaN}function jy(e){let r,n,a;e.length!==2?(r=Ji,n=(d,m)=>Ji(e(d),m),a=(d,m)=>e(d)-m):(r=e===Ji||e===g7?e:x7,n=e,a=e);function l(d,m,p=0,h=d.length){if(p<h){if(r(m,m)!==0)return h;do{const v=p+h>>>1;n(d[v],m)<0?p=v+1:h=v}while(p<h)}return p}function o(d,m,p=0,h=d.length){if(p<h){if(r(m,m)!==0)return h;do{const v=p+h>>>1;n(d[v],m)<=0?p=v+1:h=v}while(p<h)}return p}function u(d,m,p=0,h=d.length){const v=l(d,m,p,h-1);return v>p&&a(d[v-1],m)>-a(d[v],m)?v-1:v}return{left:l,center:u,right:o}}function x7(){return 0}function Kk(e){return e===null?NaN:+e}function*b7(e,r){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const y7=jy(Ji),bu=y7.right;jy(Kk).center;class PC extends Map{constructor(r,n=N7){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),r!=null)for(const[a,l]of r)this.set(a,l)}get(r){return super.get(MC(this,r))}has(r){return super.has(MC(this,r))}set(r,n){return super.set(j7(this,r),n)}delete(r){return super.delete(_7(this,r))}}function MC({_intern:e,_key:r},n){const a=r(n);return e.has(a)?e.get(a):n}function j7({_intern:e,_key:r},n){const a=r(n);return e.has(a)?e.get(a):(e.set(a,n),n)}function _7({_intern:e,_key:r},n){const a=r(n);return e.has(a)&&(n=e.get(a),e.delete(a)),n}function N7(e){return e!==null&&typeof e=="object"?e.valueOf():e}function S7(e=Ji){if(e===Ji)return Wk;if(typeof e!="function")throw new TypeError("compare is not a function");return(r,n)=>{const a=e(r,n);return a||a===0?a:(e(n,n)===0)-(e(r,r)===0)}}function Wk(e,r){return(e==null||!(e>=e))-(r==null||!(r>=r))||(e<r?-1:e>r?1:0)}const w7=Math.sqrt(50),C7=Math.sqrt(10),E7=Math.sqrt(2);function Xm(e,r,n){const a=(r-e)/Math.max(0,n),l=Math.floor(Math.log10(a)),o=a/Math.pow(10,l),u=o>=w7?10:o>=C7?5:o>=E7?2:1;let d,m,p;return l<0?(p=Math.pow(10,-l)/u,d=Math.round(e*p),m=Math.round(r*p),d/p<e&&++d,m/p>r&&--m,p=-p):(p=Math.pow(10,l)*u,d=Math.round(e/p),m=Math.round(r/p),d*p<e&&++d,m*p>r&&--m),m<d&&.5<=n&&n<2?Xm(e,r,n*2):[d,m,p]}function hb(e,r,n){if(r=+r,e=+e,n=+n,!(n>0))return[];if(e===r)return[e];const a=r<e,[l,o,u]=a?Xm(r,e,n):Xm(e,r,n);if(!(o>=l))return[];const d=o-l+1,m=new Array(d);if(a)if(u<0)for(let p=0;p<d;++p)m[p]=(o-p)/-u;else for(let p=0;p<d;++p)m[p]=(o-p)*u;else if(u<0)for(let p=0;p<d;++p)m[p]=(l+p)/-u;else for(let p=0;p<d;++p)m[p]=(l+p)*u;return m}function vb(e,r,n){return r=+r,e=+e,n=+n,Xm(e,r,n)[2]}function gb(e,r,n){r=+r,e=+e,n=+n;const a=r<e,l=a?vb(r,e,n):vb(e,r,n);return(a?-1:1)*(l<0?1/-l:l)}function TC(e,r){let n;for(const a of e)a!=null&&(n<a||n===void 0&&a>=a)&&(n=a);return n}function qC(e,r){let n;for(const a of e)a!=null&&(n>a||n===void 0&&a>=a)&&(n=a);return n}function Xk(e,r,n=0,a=1/0,l){if(r=Math.floor(r),n=Math.floor(Math.max(0,n)),a=Math.floor(Math.min(e.length-1,a)),!(n<=r&&r<=a))return e;for(l=l===void 0?Wk:S7(l);a>n;){if(a-n>600){const m=a-n+1,p=r-n+1,h=Math.log(m),v=.5*Math.exp(2*h/3),b=.5*Math.sqrt(h*v*(m-v)/m)*(p-m/2<0?-1:1),x=Math.max(n,Math.floor(r-p*v/m+b)),j=Math.min(a,Math.floor(r+(m-p)*v/m+b));Xk(e,r,x,j,l)}const o=e[r];let u=n,d=a;for(kc(e,n,r),l(e[a],o)>0&&kc(e,n,a);u<d;){for(kc(e,u,d),++u,--d;l(e[u],o)<0;)++u;for(;l(e[d],o)>0;)--d}l(e[n],o)===0?kc(e,n,d):(++d,kc(e,d,a)),d<=r&&(n=d+1),r<=d&&(a=d-1)}return e}function kc(e,r,n){const a=e[r];e[r]=e[n],e[n]=a}function A7(e,r,n){if(e=Float64Array.from(b7(e)),!(!(a=e.length)||isNaN(r=+r))){if(r<=0||a<2)return qC(e);if(r>=1)return TC(e);var a,l=(a-1)*r,o=Math.floor(l),u=TC(Xk(e,o).subarray(0,o+1)),d=qC(e.subarray(o+1));return u+(d-u)*(l-o)}}function z7(e,r,n=Kk){if(!(!(a=e.length)||isNaN(r=+r))){if(r<=0||a<2)return+n(e[0],0,e);if(r>=1)return+n(e[a-1],a-1,e);var a,l=(a-1)*r,o=Math.floor(l),u=+n(e[o],o,e),d=+n(e[o+1],o+1,e);return u+(d-u)*(l-o)}}function k7(e,r,n){e=+e,r=+r,n=(l=arguments.length)<2?(r=e,e=0,1):l<3?1:+n;for(var a=-1,l=Math.max(0,Math.ceil((r-e)/n))|0,o=new Array(l);++a<l;)o[a]=e+a*n;return o}function Hn(e,r){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(r).domain(e);break}return this}function fi(e,r){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof r=="function"?this.interpolator(r):this.range(r);break}}return this}const xb=Symbol("implicit");function _y(){var e=new PC,r=[],n=[],a=xb;function l(o){let u=e.get(o);if(u===void 0){if(a!==xb)return a;e.set(o,u=r.push(o)-1)}return n[u%n.length]}return l.domain=function(o){if(!arguments.length)return r.slice();r=[],e=new PC;for(const u of o)e.has(u)||e.set(u,r.push(u)-1);return l},l.range=function(o){return arguments.length?(n=Array.from(o),l):n.slice()},l.unknown=function(o){return arguments.length?(a=o,l):a},l.copy=function(){return _y(r,n).unknown(a)},Hn.apply(l,arguments),l}function Ny(){var e=_y().unknown(void 0),r=e.domain,n=e.range,a=0,l=1,o,u,d=!1,m=0,p=0,h=.5;delete e.unknown;function v(){var b=r().length,x=l<a,j=x?l:a,_=x?a:l;o=(_-j)/Math.max(1,b-m+p*2),d&&(o=Math.floor(o)),j+=(_-j-o*(b-m))*h,u=o*(1-m),d&&(j=Math.round(j),u=Math.round(u));var w=k7(b).map(function(C){return j+o*C});return n(x?w.reverse():w)}return e.domain=function(b){return arguments.length?(r(b),v()):r()},e.range=function(b){return arguments.length?([a,l]=b,a=+a,l=+l,v()):[a,l]},e.rangeRound=function(b){return[a,l]=b,a=+a,l=+l,d=!0,v()},e.bandwidth=function(){return u},e.step=function(){return o},e.round=function(b){return arguments.length?(d=!!b,v()):d},e.padding=function(b){return arguments.length?(m=Math.min(1,p=+b),v()):m},e.paddingInner=function(b){return arguments.length?(m=Math.min(1,b),v()):m},e.paddingOuter=function(b){return arguments.length?(p=+b,v()):p},e.align=function(b){return arguments.length?(h=Math.max(0,Math.min(1,b)),v()):h},e.copy=function(){return Ny(r(),[a,l]).round(d).paddingInner(m).paddingOuter(p).align(h)},Hn.apply(v(),arguments)}function Zk(e){var r=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Zk(r())},e}function O7(){return Zk(Ny.apply(null,arguments).paddingInner(1))}function Sy(e,r,n){e.prototype=r.prototype=n,n.constructor=e}function Jk(e,r){var n=Object.create(e.prototype);for(var a in r)n[a]=r[a];return n}function yu(){}var tu=.7,Zm=1/tu,fo="\\s*([+-]?\\d+)\\s*",ru="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ba="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",D7=/^#([0-9a-f]{3,8})$/,P7=new RegExp(`^rgb\\(${fo},${fo},${fo}\\)$`),M7=new RegExp(`^rgb\\(${ba},${ba},${ba}\\)$`),T7=new RegExp(`^rgba\\(${fo},${fo},${fo},${ru}\\)$`),q7=new RegExp(`^rgba\\(${ba},${ba},${ba},${ru}\\)$`),R7=new RegExp(`^hsl\\(${ru},${ba},${ba}\\)$`),I7=new RegExp(`^hsla\\(${ru},${ba},${ba},${ru}\\)$`),RC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Sy(yu,nu,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:IC,formatHex:IC,formatHex8:L7,formatHsl:$7,formatRgb:LC,toString:LC});function IC(){return this.rgb().formatHex()}function L7(){return this.rgb().formatHex8()}function $7(){return eO(this).formatHsl()}function LC(){return this.rgb().formatRgb()}function nu(e){var r,n;return e=(e+"").trim().toLowerCase(),(r=D7.exec(e))?(n=r[1].length,r=parseInt(r[1],16),n===6?$C(r):n===3?new sn(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):n===8?rm(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):n===4?rm(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=P7.exec(e))?new sn(r[1],r[2],r[3],1):(r=M7.exec(e))?new sn(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=T7.exec(e))?rm(r[1],r[2],r[3],r[4]):(r=q7.exec(e))?rm(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=R7.exec(e))?FC(r[1],r[2]/100,r[3]/100,1):(r=I7.exec(e))?FC(r[1],r[2]/100,r[3]/100,r[4]):RC.hasOwnProperty(e)?$C(RC[e]):e==="transparent"?new sn(NaN,NaN,NaN,0):null}function $C(e){return new sn(e>>16&255,e>>8&255,e&255,1)}function rm(e,r,n,a){return a<=0&&(e=r=n=NaN),new sn(e,r,n,a)}function B7(e){return e instanceof yu||(e=nu(e)),e?(e=e.rgb(),new sn(e.r,e.g,e.b,e.opacity)):new sn}function bb(e,r,n,a){return arguments.length===1?B7(e):new sn(e,r,n,a??1)}function sn(e,r,n,a){this.r=+e,this.g=+r,this.b=+n,this.opacity=+a}Sy(sn,bb,Jk(yu,{brighter(e){return e=e==null?Zm:Math.pow(Zm,e),new sn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?tu:Math.pow(tu,e),new sn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new sn(Gs(this.r),Gs(this.g),Gs(this.b),Jm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:BC,formatHex:BC,formatHex8:U7,formatRgb:UC,toString:UC}));function BC(){return`#${qs(this.r)}${qs(this.g)}${qs(this.b)}`}function U7(){return`#${qs(this.r)}${qs(this.g)}${qs(this.b)}${qs((isNaN(this.opacity)?1:this.opacity)*255)}`}function UC(){const e=Jm(this.opacity);return`${e===1?"rgb(":"rgba("}${Gs(this.r)}, ${Gs(this.g)}, ${Gs(this.b)}${e===1?")":`, ${e})`}`}function Jm(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Gs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function qs(e){return e=Gs(e),(e<16?"0":"")+e.toString(16)}function FC(e,r,n,a){return a<=0?e=r=n=NaN:n<=0||n>=1?e=r=NaN:r<=0&&(e=NaN),new ea(e,r,n,a)}function eO(e){if(e instanceof ea)return new ea(e.h,e.s,e.l,e.opacity);if(e instanceof yu||(e=nu(e)),!e)return new ea;if(e instanceof ea)return e;e=e.rgb();var r=e.r/255,n=e.g/255,a=e.b/255,l=Math.min(r,n,a),o=Math.max(r,n,a),u=NaN,d=o-l,m=(o+l)/2;return d?(r===o?u=(n-a)/d+(n<a)*6:n===o?u=(a-r)/d+2:u=(r-n)/d+4,d/=m<.5?o+l:2-o-l,u*=60):d=m>0&&m<1?0:u,new ea(u,d,m,e.opacity)}function F7(e,r,n,a){return arguments.length===1?eO(e):new ea(e,r,n,a??1)}function ea(e,r,n,a){this.h=+e,this.s=+r,this.l=+n,this.opacity=+a}Sy(ea,F7,Jk(yu,{brighter(e){return e=e==null?Zm:Math.pow(Zm,e),new ea(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?tu:Math.pow(tu,e),new ea(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*r,l=2*n-a;return new sn(ox(e>=240?e-240:e+120,l,a),ox(e,l,a),ox(e<120?e+240:e-120,l,a),this.opacity)},clamp(){return new ea(GC(this.h),nm(this.s),nm(this.l),Jm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Jm(this.opacity);return`${e===1?"hsl(":"hsla("}${GC(this.h)}, ${nm(this.s)*100}%, ${nm(this.l)*100}%${e===1?")":`, ${e})`}`}}));function GC(e){return e=(e||0)%360,e<0?e+360:e}function nm(e){return Math.max(0,Math.min(1,e||0))}function ox(e,r,n){return(e<60?r+(n-r)*e/60:e<180?n:e<240?r+(n-r)*(240-e)/60:r)*255}const wy=e=>()=>e;function G7(e,r){return function(n){return e+n*r}}function H7(e,r,n){return e=Math.pow(e,n),r=Math.pow(r,n)-e,n=1/n,function(a){return Math.pow(e+a*r,n)}}function V7(e){return(e=+e)==1?tO:function(r,n){return n-r?H7(r,n,e):wy(isNaN(r)?n:r)}}function tO(e,r){var n=r-e;return n?G7(e,n):wy(isNaN(e)?r:e)}const HC=(function e(r){var n=V7(r);function a(l,o){var u=n((l=bb(l)).r,(o=bb(o)).r),d=n(l.g,o.g),m=n(l.b,o.b),p=tO(l.opacity,o.opacity);return function(h){return l.r=u(h),l.g=d(h),l.b=m(h),l.opacity=p(h),l+""}}return a.gamma=e,a})(1);function Q7(e,r){r||(r=[]);var n=e?Math.min(r.length,e.length):0,a=r.slice(),l;return function(o){for(l=0;l<n;++l)a[l]=e[l]*(1-o)+r[l]*o;return a}}function Y7(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function K7(e,r){var n=r?r.length:0,a=e?Math.min(n,e.length):0,l=new Array(a),o=new Array(n),u;for(u=0;u<a;++u)l[u]=wo(e[u],r[u]);for(;u<n;++u)o[u]=r[u];return function(d){for(u=0;u<a;++u)o[u]=l[u](d);return o}}function W7(e,r){var n=new Date;return e=+e,r=+r,function(a){return n.setTime(e*(1-a)+r*a),n}}function ef(e,r){return e=+e,r=+r,function(n){return e*(1-n)+r*n}}function X7(e,r){var n={},a={},l;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(l in r)l in e?n[l]=wo(e[l],r[l]):a[l]=r[l];return function(o){for(l in n)a[l]=n[l](o);return a}}var yb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,cx=new RegExp(yb.source,"g");function Z7(e){return function(){return e}}function J7(e){return function(r){return e(r)+""}}function eB(e,r){var n=yb.lastIndex=cx.lastIndex=0,a,l,o,u=-1,d=[],m=[];for(e=e+"",r=r+"";(a=yb.exec(e))&&(l=cx.exec(r));)(o=l.index)>n&&(o=r.slice(n,o),d[u]?d[u]+=o:d[++u]=o),(a=a[0])===(l=l[0])?d[u]?d[u]+=l:d[++u]=l:(d[++u]=null,m.push({i:u,x:ef(a,l)})),n=cx.lastIndex;return n<r.length&&(o=r.slice(n),d[u]?d[u]+=o:d[++u]=o),d.length<2?m[0]?J7(m[0].x):Z7(r):(r=m.length,function(p){for(var h=0,v;h<r;++h)d[(v=m[h]).i]=v.x(p);return d.join("")})}function wo(e,r){var n=typeof r,a;return r==null||n==="boolean"?wy(r):(n==="number"?ef:n==="string"?(a=nu(r))?(r=a,HC):eB:r instanceof nu?HC:r instanceof Date?W7:Y7(r)?Q7:Array.isArray(r)?K7:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?X7:ef)(e,r)}function Cy(e,r){return e=+e,r=+r,function(n){return Math.round(e*(1-n)+r*n)}}function tB(e,r){r===void 0&&(r=e,e=wo);for(var n=0,a=r.length-1,l=r[0],o=new Array(a<0?0:a);n<a;)o[n]=e(l,l=r[++n]);return function(u){var d=Math.max(0,Math.min(a-1,Math.floor(u*=a)));return o[d](u-d)}}function rB(e){return function(){return e}}function tf(e){return+e}var VC=[0,1];function Gr(e){return e}function jb(e,r){return(r-=e=+e)?function(n){return(n-e)/r}:rB(isNaN(r)?NaN:.5)}function nB(e,r){var n;return e>r&&(n=e,e=r,r=n),function(a){return Math.max(e,Math.min(r,a))}}function aB(e,r,n){var a=e[0],l=e[1],o=r[0],u=r[1];return l<a?(a=jb(l,a),o=n(u,o)):(a=jb(a,l),o=n(o,u)),function(d){return o(a(d))}}function iB(e,r,n){var a=Math.min(e.length,r.length)-1,l=new Array(a),o=new Array(a),u=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),r=r.slice().reverse());++u<a;)l[u]=jb(e[u],e[u+1]),o[u]=n(r[u],r[u+1]);return function(d){var m=bu(e,d,1,a)-1;return o[m](l[m](d))}}function ju(e,r){return r.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function np(){var e=VC,r=VC,n=wo,a,l,o,u=Gr,d,m,p;function h(){var b=Math.min(e.length,r.length);return u!==Gr&&(u=nB(e[0],e[b-1])),d=b>2?iB:aB,m=p=null,v}function v(b){return b==null||isNaN(b=+b)?o:(m||(m=d(e.map(a),r,n)))(a(u(b)))}return v.invert=function(b){return u(l((p||(p=d(r,e.map(a),ef)))(b)))},v.domain=function(b){return arguments.length?(e=Array.from(b,tf),h()):e.slice()},v.range=function(b){return arguments.length?(r=Array.from(b),h()):r.slice()},v.rangeRound=function(b){return r=Array.from(b),n=Cy,h()},v.clamp=function(b){return arguments.length?(u=b?!0:Gr,h()):u!==Gr},v.interpolate=function(b){return arguments.length?(n=b,h()):n},v.unknown=function(b){return arguments.length?(o=b,v):o},function(b,x){return a=b,l=x,h()}}function Ey(){return np()(Gr,Gr)}function sB(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function rf(e,r){if(!isFinite(e)||e===0)return null;var n=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"),a=e.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+e.slice(n+1)]}function yo(e){return e=rf(Math.abs(e)),e?e[1]:NaN}function lB(e,r){return function(n,a){for(var l=n.length,o=[],u=0,d=e[0],m=0;l>0&&d>0&&(m+d+1>a&&(d=Math.max(1,a-m)),o.push(n.substring(l-=d,l+d)),!((m+=d+1)>a));)d=e[u=(u+1)%e.length];return o.reverse().join(r)}}function oB(e){return function(r){return r.replace(/[0-9]/g,function(n){return e[+n]})}}var cB=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function au(e){if(!(r=cB.exec(e)))throw new Error("invalid format: "+e);var r;return new Ay({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}au.prototype=Ay.prototype;function Ay(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Ay.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function uB(e){e:for(var r=e.length,n=1,a=-1,l;n<r;++n)switch(e[n]){case".":a=l=n;break;case"0":a===0&&(a=n),l=n;break;default:if(!+e[n])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(l+1):e}var nf;function dB(e,r){var n=rf(e,r);if(!n)return nf=void 0,e.toPrecision(r);var a=n[0],l=n[1],o=l-(nf=Math.max(-8,Math.min(8,Math.floor(l/3)))*3)+1,u=a.length;return o===u?a:o>u?a+new Array(o-u+1).join("0"):o>0?a.slice(0,o)+"."+a.slice(o):"0."+new Array(1-o).join("0")+rf(e,Math.max(0,r+o-1))[0]}function QC(e,r){var n=rf(e,r);if(!n)return e+"";var a=n[0],l=n[1];return l<0?"0."+new Array(-l).join("0")+a:a.length>l+1?a.slice(0,l+1)+"."+a.slice(l+1):a+new Array(l-a.length+2).join("0")}const YC={"%":(e,r)=>(e*100).toFixed(r),b:e=>Math.round(e).toString(2),c:e=>e+"",d:sB,e:(e,r)=>e.toExponential(r),f:(e,r)=>e.toFixed(r),g:(e,r)=>e.toPrecision(r),o:e=>Math.round(e).toString(8),p:(e,r)=>QC(e*100,r),r:QC,s:dB,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function KC(e){return e}var WC=Array.prototype.map,XC=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function mB(e){var r=e.grouping===void 0||e.thousands===void 0?KC:lB(WC.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",l=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?KC:oB(WC.call(e.numerals,String)),u=e.percent===void 0?"%":e.percent+"",d=e.minus===void 0?"":e.minus+"",m=e.nan===void 0?"NaN":e.nan+"";function p(v,b){v=au(v);var x=v.fill,j=v.align,_=v.sign,w=v.symbol,C=v.zero,E=v.width,S=v.comma,A=v.precision,z=v.trim,k=v.type;k==="n"?(S=!0,k="g"):YC[k]||(A===void 0&&(A=12),z=!0,k="g"),(C||x==="0"&&j==="=")&&(C=!0,x="0",j="=");var P=(b&&b.prefix!==void 0?b.prefix:"")+(w==="$"?n:w==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():""),D=(w==="$"?a:/[%p]/.test(k)?u:"")+(b&&b.suffix!==void 0?b.suffix:""),$=YC[k],F=/[defgprs%]/.test(k);A=A===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function Y(M){var K=P,ee=D,X,L,I;if(k==="c")ee=$(M)+ee,M="";else{M=+M;var U=M<0||1/M<0;if(M=isNaN(M)?m:$(Math.abs(M),A),z&&(M=uB(M)),U&&+M==0&&_!=="+"&&(U=!1),K=(U?_==="("?_:d:_==="-"||_==="("?"":_)+K,ee=(k==="s"&&!isNaN(M)&&nf!==void 0?XC[8+nf/3]:"")+ee+(U&&_==="("?")":""),F){for(X=-1,L=M.length;++X<L;)if(I=M.charCodeAt(X),48>I||I>57){ee=(I===46?l+M.slice(X+1):M.slice(X))+ee,M=M.slice(0,X);break}}}S&&!C&&(M=r(M,1/0));var B=K.length+M.length+ee.length,T=B<E?new Array(E-B+1).join(x):"";switch(S&&C&&(M=r(T+M,T.length?E-ee.length:1/0),T=""),j){case"<":M=K+M+ee+T;break;case"=":M=K+T+M+ee;break;case"^":M=T.slice(0,B=T.length>>1)+K+M+ee+T.slice(B);break;default:M=T+K+M+ee;break}return o(M)}return Y.toString=function(){return v+""},Y}function h(v,b){var x=Math.max(-8,Math.min(8,Math.floor(yo(b)/3)))*3,j=Math.pow(10,-x),_=p((v=au(v),v.type="f",v),{suffix:XC[8+x/3]});return function(w){return _(j*w)}}return{format:p,formatPrefix:h}}var am,zy,rO;fB({thousands:",",grouping:[3],currency:["$",""]});function fB(e){return am=mB(e),zy=am.format,rO=am.formatPrefix,am}function pB(e){return Math.max(0,-yo(Math.abs(e)))}function hB(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(yo(r)/3)))*3-yo(Math.abs(e)))}function vB(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,yo(r)-yo(e))+1}function nO(e,r,n,a){var l=gb(e,r,n),o;switch(a=au(a??",f"),a.type){case"s":{var u=Math.max(Math.abs(e),Math.abs(r));return a.precision==null&&!isNaN(o=hB(l,u))&&(a.precision=o),rO(a,u)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(o=vB(l,Math.max(Math.abs(e),Math.abs(r))))&&(a.precision=o-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(o=pB(l))&&(a.precision=o-(a.type==="%")*2);break}}return zy(a)}function os(e){var r=e.domain;return e.ticks=function(n){var a=r();return hb(a[0],a[a.length-1],n??10)},e.tickFormat=function(n,a){var l=r();return nO(l[0],l[l.length-1],n??10,a)},e.nice=function(n){n==null&&(n=10);var a=r(),l=0,o=a.length-1,u=a[l],d=a[o],m,p,h=10;for(d<u&&(p=u,u=d,d=p,p=l,l=o,o=p);h-- >0;){if(p=vb(u,d,n),p===m)return a[l]=u,a[o]=d,r(a);if(p>0)u=Math.floor(u/p)*p,d=Math.ceil(d/p)*p;else if(p<0)u=Math.ceil(u*p)/p,d=Math.floor(d*p)/p;else break;m=p}return e},e}function aO(){var e=Ey();return e.copy=function(){return ju(e,aO())},Hn.apply(e,arguments),os(e)}function iO(e){var r;function n(a){return a==null||isNaN(a=+a)?r:a}return n.invert=n,n.domain=n.range=function(a){return arguments.length?(e=Array.from(a,tf),n):e.slice()},n.unknown=function(a){return arguments.length?(r=a,n):r},n.copy=function(){return iO(e).unknown(r)},e=arguments.length?Array.from(e,tf):[0,1],os(n)}function sO(e,r){e=e.slice();var n=0,a=e.length-1,l=e[n],o=e[a],u;return o<l&&(u=n,n=a,a=u,u=l,l=o,o=u),e[n]=r.floor(l),e[a]=r.ceil(o),e}function ZC(e){return Math.log(e)}function JC(e){return Math.exp(e)}function gB(e){return-Math.log(-e)}function xB(e){return-Math.exp(-e)}function bB(e){return isFinite(e)?+("1e"+e):e<0?0:e}function yB(e){return e===10?bB:e===Math.E?Math.exp:r=>Math.pow(e,r)}function jB(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),r=>Math.log(r)/e)}function e2(e){return(r,n)=>-e(-r,n)}function ky(e){const r=e(ZC,JC),n=r.domain;let a=10,l,o;function u(){return l=jB(a),o=yB(a),n()[0]<0?(l=e2(l),o=e2(o),e(gB,xB)):e(ZC,JC),r}return r.base=function(d){return arguments.length?(a=+d,u()):a},r.domain=function(d){return arguments.length?(n(d),u()):n()},r.ticks=d=>{const m=n();let p=m[0],h=m[m.length-1];const v=h<p;v&&([p,h]=[h,p]);let b=l(p),x=l(h),j,_;const w=d==null?10:+d;let C=[];if(!(a%1)&&x-b<w){if(b=Math.floor(b),x=Math.ceil(x),p>0){for(;b<=x;++b)for(j=1;j<a;++j)if(_=b<0?j/o(-b):j*o(b),!(_<p)){if(_>h)break;C.push(_)}}else for(;b<=x;++b)for(j=a-1;j>=1;--j)if(_=b>0?j/o(-b):j*o(b),!(_<p)){if(_>h)break;C.push(_)}C.length*2<w&&(C=hb(p,h,w))}else C=hb(b,x,Math.min(x-b,w)).map(o);return v?C.reverse():C},r.tickFormat=(d,m)=>{if(d==null&&(d=10),m==null&&(m=a===10?"s":","),typeof m!="function"&&(!(a%1)&&(m=au(m)).precision==null&&(m.trim=!0),m=zy(m)),d===1/0)return m;const p=Math.max(1,a*d/r.ticks().length);return h=>{let v=h/o(Math.round(l(h)));return v*a<a-.5&&(v*=a),v<=p?m(h):""}},r.nice=()=>n(sO(n(),{floor:d=>o(Math.floor(l(d))),ceil:d=>o(Math.ceil(l(d)))})),r}function lO(){const e=ky(np()).domain([1,10]);return e.copy=()=>ju(e,lO()).base(e.base()),Hn.apply(e,arguments),e}function t2(e){return function(r){return Math.sign(r)*Math.log1p(Math.abs(r/e))}}function r2(e){return function(r){return Math.sign(r)*Math.expm1(Math.abs(r))*e}}function Oy(e){var r=1,n=e(t2(r),r2(r));return n.constant=function(a){return arguments.length?e(t2(r=+a),r2(r)):r},os(n)}function oO(){var e=Oy(np());return e.copy=function(){return ju(e,oO()).constant(e.constant())},Hn.apply(e,arguments)}function n2(e){return function(r){return r<0?-Math.pow(-r,e):Math.pow(r,e)}}function _B(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function NB(e){return e<0?-e*e:e*e}function Dy(e){var r=e(Gr,Gr),n=1;function a(){return n===1?e(Gr,Gr):n===.5?e(_B,NB):e(n2(n),n2(1/n))}return r.exponent=function(l){return arguments.length?(n=+l,a()):n},os(r)}function Py(){var e=Dy(np());return e.copy=function(){return ju(e,Py()).exponent(e.exponent())},Hn.apply(e,arguments),e}function SB(){return Py.apply(null,arguments).exponent(.5)}function a2(e){return Math.sign(e)*e*e}function wB(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function cO(){var e=Ey(),r=[0,1],n=!1,a;function l(o){var u=wB(e(o));return isNaN(u)?a:n?Math.round(u):u}return l.invert=function(o){return e.invert(a2(o))},l.domain=function(o){return arguments.length?(e.domain(o),l):e.domain()},l.range=function(o){return arguments.length?(e.range((r=Array.from(o,tf)).map(a2)),l):r.slice()},l.rangeRound=function(o){return l.range(o).round(!0)},l.round=function(o){return arguments.length?(n=!!o,l):n},l.clamp=function(o){return arguments.length?(e.clamp(o),l):e.clamp()},l.unknown=function(o){return arguments.length?(a=o,l):a},l.copy=function(){return cO(e.domain(),r).round(n).clamp(e.clamp()).unknown(a)},Hn.apply(l,arguments),os(l)}function uO(){var e=[],r=[],n=[],a;function l(){var u=0,d=Math.max(1,r.length);for(n=new Array(d-1);++u<d;)n[u-1]=z7(e,u/d);return o}function o(u){return u==null||isNaN(u=+u)?a:r[bu(n,u)]}return o.invertExtent=function(u){var d=r.indexOf(u);return d<0?[NaN,NaN]:[d>0?n[d-1]:e[0],d<n.length?n[d]:e[e.length-1]]},o.domain=function(u){if(!arguments.length)return e.slice();e=[];for(let d of u)d!=null&&!isNaN(d=+d)&&e.push(d);return e.sort(Ji),l()},o.range=function(u){return arguments.length?(r=Array.from(u),l()):r.slice()},o.unknown=function(u){return arguments.length?(a=u,o):a},o.quantiles=function(){return n.slice()},o.copy=function(){return uO().domain(e).range(r).unknown(a)},Hn.apply(o,arguments)}function dO(){var e=0,r=1,n=1,a=[.5],l=[0,1],o;function u(m){return m!=null&&m<=m?l[bu(a,m,0,n)]:o}function d(){var m=-1;for(a=new Array(n);++m<n;)a[m]=((m+1)*r-(m-n)*e)/(n+1);return u}return u.domain=function(m){return arguments.length?([e,r]=m,e=+e,r=+r,d()):[e,r]},u.range=function(m){return arguments.length?(n=(l=Array.from(m)).length-1,d()):l.slice()},u.invertExtent=function(m){var p=l.indexOf(m);return p<0?[NaN,NaN]:p<1?[e,a[0]]:p>=n?[a[n-1],r]:[a[p-1],a[p]]},u.unknown=function(m){return arguments.length&&(o=m),u},u.thresholds=function(){return a.slice()},u.copy=function(){return dO().domain([e,r]).range(l).unknown(o)},Hn.apply(os(u),arguments)}function mO(){var e=[.5],r=[0,1],n,a=1;function l(o){return o!=null&&o<=o?r[bu(e,o,0,a)]:n}return l.domain=function(o){return arguments.length?(e=Array.from(o),a=Math.min(e.length,r.length-1),l):e.slice()},l.range=function(o){return arguments.length?(r=Array.from(o),a=Math.min(e.length,r.length-1),l):r.slice()},l.invertExtent=function(o){var u=r.indexOf(o);return[e[u-1],e[u]]},l.unknown=function(o){return arguments.length?(n=o,l):n},l.copy=function(){return mO().domain(e).range(r).unknown(n)},Hn.apply(l,arguments)}const ux=new Date,dx=new Date;function ur(e,r,n,a){function l(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return l.floor=o=>(e(o=new Date(+o)),o),l.ceil=o=>(e(o=new Date(o-1)),r(o,1),e(o),o),l.round=o=>{const u=l(o),d=l.ceil(o);return o-u<d-o?u:d},l.offset=(o,u)=>(r(o=new Date(+o),u==null?1:Math.floor(u)),o),l.range=(o,u,d)=>{const m=[];if(o=l.ceil(o),d=d==null?1:Math.floor(d),!(o<u)||!(d>0))return m;let p;do m.push(p=new Date(+o)),r(o,d),e(o);while(p<o&&o<u);return m},l.filter=o=>ur(u=>{if(u>=u)for(;e(u),!o(u);)u.setTime(u-1)},(u,d)=>{if(u>=u)if(d<0)for(;++d<=0;)for(;r(u,-1),!o(u););else for(;--d>=0;)for(;r(u,1),!o(u););}),n&&(l.count=(o,u)=>(ux.setTime(+o),dx.setTime(+u),e(ux),e(dx),Math.floor(n(ux,dx))),l.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?l.filter(a?u=>a(u)%o===0:u=>l.count(0,u)%o===0):l)),l}const af=ur(()=>{},(e,r)=>{e.setTime(+e+r)},(e,r)=>r-e);af.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ur(r=>{r.setTime(Math.floor(r/e)*e)},(r,n)=>{r.setTime(+r+n*e)},(r,n)=>(n-r)/e):af);af.range;const Wa=1e3,Rn=Wa*60,Xa=Rn*60,ri=Xa*24,My=ri*7,i2=ri*30,mx=ri*365,Rs=ur(e=>{e.setTime(e-e.getMilliseconds())},(e,r)=>{e.setTime(+e+r*Wa)},(e,r)=>(r-e)/Wa,e=>e.getUTCSeconds());Rs.range;const Ty=ur(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Wa)},(e,r)=>{e.setTime(+e+r*Rn)},(e,r)=>(r-e)/Rn,e=>e.getMinutes());Ty.range;const qy=ur(e=>{e.setUTCSeconds(0,0)},(e,r)=>{e.setTime(+e+r*Rn)},(e,r)=>(r-e)/Rn,e=>e.getUTCMinutes());qy.range;const Ry=ur(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Wa-e.getMinutes()*Rn)},(e,r)=>{e.setTime(+e+r*Xa)},(e,r)=>(r-e)/Xa,e=>e.getHours());Ry.range;const Iy=ur(e=>{e.setUTCMinutes(0,0,0)},(e,r)=>{e.setTime(+e+r*Xa)},(e,r)=>(r-e)/Xa,e=>e.getUTCHours());Iy.range;const _u=ur(e=>e.setHours(0,0,0,0),(e,r)=>e.setDate(e.getDate()+r),(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Rn)/ri,e=>e.getDate()-1);_u.range;const ap=ur(e=>{e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r)},(e,r)=>(r-e)/ri,e=>e.getUTCDate()-1);ap.range;const fO=ur(e=>{e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r)},(e,r)=>(r-e)/ri,e=>Math.floor(e/ri));fO.range;function sl(e){return ur(r=>{r.setDate(r.getDate()-(r.getDay()+7-e)%7),r.setHours(0,0,0,0)},(r,n)=>{r.setDate(r.getDate()+n*7)},(r,n)=>(n-r-(n.getTimezoneOffset()-r.getTimezoneOffset())*Rn)/My)}const ip=sl(0),sf=sl(1),CB=sl(2),EB=sl(3),jo=sl(4),AB=sl(5),zB=sl(6);ip.range;sf.range;CB.range;EB.range;jo.range;AB.range;zB.range;function ll(e){return ur(r=>{r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-e)%7),r.setUTCHours(0,0,0,0)},(r,n)=>{r.setUTCDate(r.getUTCDate()+n*7)},(r,n)=>(n-r)/My)}const sp=ll(0),lf=ll(1),kB=ll(2),OB=ll(3),_o=ll(4),DB=ll(5),PB=ll(6);sp.range;lf.range;kB.range;OB.range;_o.range;DB.range;PB.range;const Ly=ur(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,r)=>{e.setMonth(e.getMonth()+r)},(e,r)=>r.getMonth()-e.getMonth()+(r.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Ly.range;const $y=ur(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCMonth(e.getUTCMonth()+r)},(e,r)=>r.getUTCMonth()-e.getUTCMonth()+(r.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());$y.range;const ni=ur(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r)},(e,r)=>r.getFullYear()-e.getFullYear(),e=>e.getFullYear());ni.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ur(r=>{r.setFullYear(Math.floor(r.getFullYear()/e)*e),r.setMonth(0,1),r.setHours(0,0,0,0)},(r,n)=>{r.setFullYear(r.getFullYear()+n*e)});ni.range;const ai=ur(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r)},(e,r)=>r.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ai.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ur(r=>{r.setUTCFullYear(Math.floor(r.getUTCFullYear()/e)*e),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,n)=>{r.setUTCFullYear(r.getUTCFullYear()+n*e)});ai.range;function pO(e,r,n,a,l,o){const u=[[Rs,1,Wa],[Rs,5,5*Wa],[Rs,15,15*Wa],[Rs,30,30*Wa],[o,1,Rn],[o,5,5*Rn],[o,15,15*Rn],[o,30,30*Rn],[l,1,Xa],[l,3,3*Xa],[l,6,6*Xa],[l,12,12*Xa],[a,1,ri],[a,2,2*ri],[n,1,My],[r,1,i2],[r,3,3*i2],[e,1,mx]];function d(p,h,v){const b=h<p;b&&([p,h]=[h,p]);const x=v&&typeof v.range=="function"?v:m(p,h,v),j=x?x.range(p,+h+1):[];return b?j.reverse():j}function m(p,h,v){const b=Math.abs(h-p)/v,x=jy(([,,w])=>w).right(u,b);if(x===u.length)return e.every(gb(p/mx,h/mx,v));if(x===0)return af.every(Math.max(gb(p,h,v),1));const[j,_]=u[b/u[x-1][2]<u[x][2]/b?x-1:x];return j.every(_)}return[d,m]}const[MB,TB]=pO(ai,$y,sp,fO,Iy,qy),[qB,RB]=pO(ni,Ly,ip,_u,Ry,Ty);function fx(e){if(0<=e.y&&e.y<100){var r=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return r.setFullYear(e.y),r}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function px(e){if(0<=e.y&&e.y<100){var r=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return r.setUTCFullYear(e.y),r}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Oc(e,r,n){return{y:e,m:r,d:n,H:0,M:0,S:0,L:0}}function IB(e){var r=e.dateTime,n=e.date,a=e.time,l=e.periods,o=e.days,u=e.shortDays,d=e.months,m=e.shortMonths,p=Dc(l),h=Pc(l),v=Dc(o),b=Pc(o),x=Dc(u),j=Pc(u),_=Dc(d),w=Pc(d),C=Dc(m),E=Pc(m),S={a:I,A:U,b:B,B:T,c:null,d:d2,e:d2,f:l9,g:g9,G:b9,H:a9,I:i9,j:s9,L:hO,m:o9,M:c9,p:Z,q:H,Q:p2,s:h2,S:u9,u:d9,U:m9,V:f9,w:p9,W:h9,x:null,X:null,y:v9,Y:x9,Z:y9,"%":f2},A={a:ce,A:xe,b:fe,B:G,c:null,d:m2,e:m2,f:S9,g:M9,G:q9,H:j9,I:_9,j:N9,L:gO,m:w9,M:C9,p:ve,q:De,Q:p2,s:h2,S:E9,u:A9,U:z9,V:k9,w:O9,W:D9,x:null,X:null,y:P9,Y:T9,Z:R9,"%":f2},z={a:F,A:Y,b:M,B:K,c:ee,d:c2,e:c2,f:e9,g:o2,G:l2,H:u2,I:u2,j:WB,L:JB,m:KB,M:XB,p:$,q:YB,Q:r9,s:n9,S:ZB,u:FB,U:GB,V:HB,w:UB,W:VB,x:X,X:L,y:o2,Y:l2,Z:QB,"%":t9};S.x=k(n,S),S.X=k(a,S),S.c=k(r,S),A.x=k(n,A),A.X=k(a,A),A.c=k(r,A);function k(de,we){return function(R){var ae=[],Ce=-1,ke=0,Ke=de.length,et,rt,Yt;for(R instanceof Date||(R=new Date(+R));++Ce<Ke;)de.charCodeAt(Ce)===37&&(ae.push(de.slice(ke,Ce)),(rt=s2[et=de.charAt(++Ce)])!=null?et=de.charAt(++Ce):rt=et==="e"?" ":"0",(Yt=we[et])&&(et=Yt(R,rt)),ae.push(et),ke=Ce+1);return ae.push(de.slice(ke,Ce)),ae.join("")}}function P(de,we){return function(R){var ae=Oc(1900,void 0,1),Ce=D(ae,de,R+="",0),ke,Ke;if(Ce!=R.length)return null;if("Q"in ae)return new Date(ae.Q);if("s"in ae)return new Date(ae.s*1e3+("L"in ae?ae.L:0));if(we&&!("Z"in ae)&&(ae.Z=0),"p"in ae&&(ae.H=ae.H%12+ae.p*12),ae.m===void 0&&(ae.m="q"in ae?ae.q:0),"V"in ae){if(ae.V<1||ae.V>53)return null;"w"in ae||(ae.w=1),"Z"in ae?(ke=px(Oc(ae.y,0,1)),Ke=ke.getUTCDay(),ke=Ke>4||Ke===0?lf.ceil(ke):lf(ke),ke=ap.offset(ke,(ae.V-1)*7),ae.y=ke.getUTCFullYear(),ae.m=ke.getUTCMonth(),ae.d=ke.getUTCDate()+(ae.w+6)%7):(ke=fx(Oc(ae.y,0,1)),Ke=ke.getDay(),ke=Ke>4||Ke===0?sf.ceil(ke):sf(ke),ke=_u.offset(ke,(ae.V-1)*7),ae.y=ke.getFullYear(),ae.m=ke.getMonth(),ae.d=ke.getDate()+(ae.w+6)%7)}else("W"in ae||"U"in ae)&&("w"in ae||(ae.w="u"in ae?ae.u%7:"W"in ae?1:0),Ke="Z"in ae?px(Oc(ae.y,0,1)).getUTCDay():fx(Oc(ae.y,0,1)).getDay(),ae.m=0,ae.d="W"in ae?(ae.w+6)%7+ae.W*7-(Ke+5)%7:ae.w+ae.U*7-(Ke+6)%7);return"Z"in ae?(ae.H+=ae.Z/100|0,ae.M+=ae.Z%100,px(ae)):fx(ae)}}function D(de,we,R,ae){for(var Ce=0,ke=we.length,Ke=R.length,et,rt;Ce<ke;){if(ae>=Ke)return-1;if(et=we.charCodeAt(Ce++),et===37){if(et=we.charAt(Ce++),rt=z[et in s2?we.charAt(Ce++):et],!rt||(ae=rt(de,R,ae))<0)return-1}else if(et!=R.charCodeAt(ae++))return-1}return ae}function $(de,we,R){var ae=p.exec(we.slice(R));return ae?(de.p=h.get(ae[0].toLowerCase()),R+ae[0].length):-1}function F(de,we,R){var ae=x.exec(we.slice(R));return ae?(de.w=j.get(ae[0].toLowerCase()),R+ae[0].length):-1}function Y(de,we,R){var ae=v.exec(we.slice(R));return ae?(de.w=b.get(ae[0].toLowerCase()),R+ae[0].length):-1}function M(de,we,R){var ae=C.exec(we.slice(R));return ae?(de.m=E.get(ae[0].toLowerCase()),R+ae[0].length):-1}function K(de,we,R){var ae=_.exec(we.slice(R));return ae?(de.m=w.get(ae[0].toLowerCase()),R+ae[0].length):-1}function ee(de,we,R){return D(de,r,we,R)}function X(de,we,R){return D(de,n,we,R)}function L(de,we,R){return D(de,a,we,R)}function I(de){return u[de.getDay()]}function U(de){return o[de.getDay()]}function B(de){return m[de.getMonth()]}function T(de){return d[de.getMonth()]}function Z(de){return l[+(de.getHours()>=12)]}function H(de){return 1+~~(de.getMonth()/3)}function ce(de){return u[de.getUTCDay()]}function xe(de){return o[de.getUTCDay()]}function fe(de){return m[de.getUTCMonth()]}function G(de){return d[de.getUTCMonth()]}function ve(de){return l[+(de.getUTCHours()>=12)]}function De(de){return 1+~~(de.getUTCMonth()/3)}return{format:function(de){var we=k(de+="",S);return we.toString=function(){return de},we},parse:function(de){var we=P(de+="",!1);return we.toString=function(){return de},we},utcFormat:function(de){var we=k(de+="",A);return we.toString=function(){return de},we},utcParse:function(de){var we=P(de+="",!0);return we.toString=function(){return de},we}}}var s2={"-":"",_:" ",0:"0"},Sr=/^\s*\d+/,LB=/^%/,$B=/[\\^$*+?|[\]().{}]/g;function ht(e,r,n){var a=e<0?"-":"",l=(a?-e:e)+"",o=l.length;return a+(o<n?new Array(n-o+1).join(r)+l:l)}function BB(e){return e.replace($B,"\\$&")}function Dc(e){return new RegExp("^(?:"+e.map(BB).join("|")+")","i")}function Pc(e){return new Map(e.map((r,n)=>[r.toLowerCase(),n]))}function UB(e,r,n){var a=Sr.exec(r.slice(n,n+1));return a?(e.w=+a[0],n+a[0].length):-1}function FB(e,r,n){var a=Sr.exec(r.slice(n,n+1));return a?(e.u=+a[0],n+a[0].length):-1}function GB(e,r,n){var a=Sr.exec(r.slice(n,n+2));return a?(e.U=+a[0],n+a[0].length):-1}function HB(e,r,n){var a=Sr.exec(r.slice(n,n+2));return a?(e.V=+a[0],n+a[0].length):-1}function VB(e,r,n){var a=Sr.exec(r.slice(n,n+2));return a?(e.W=+a[0],n+a[0].length):-1}function l2(e,r,n){var a=Sr.exec(r.slice(n,n+4));return a?(e.y=+a[0],n+a[0].length):-1}function o2(e,r,n){var a=Sr.exec(r.slice(n,n+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function QB(e,r,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(n,n+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function YB(e,r,n){var a=Sr.exec(r.slice(n,n+1));return a?(e.q=a[0]*3-3,n+a[0].length):-1}function KB(e,r,n){var a=Sr.exec(r.slice(n,n+2));return a?(e.m=a[0]-1,n+a[0].length):-1}function c2(e,r,n){var a=Sr.exec(r.slice(n,n+2));return a?(e.d=+a[0],n+a[0].length):-1}function WB(e,r,n){var a=Sr.exec(r.slice(n,n+3));return a?(e.m=0,e.d=+a[0],n+a[0].length):-1}function u2(e,r,n){var a=Sr.exec(r.slice(n,n+2));return a?(e.H=+a[0],n+a[0].length):-1}function XB(e,r,n){var a=Sr.exec(r.slice(n,n+2));return a?(e.M=+a[0],n+a[0].length):-1}function ZB(e,r,n){var a=Sr.exec(r.slice(n,n+2));return a?(e.S=+a[0],n+a[0].length):-1}function JB(e,r,n){var a=Sr.exec(r.slice(n,n+3));return a?(e.L=+a[0],n+a[0].length):-1}function e9(e,r,n){var a=Sr.exec(r.slice(n,n+6));return a?(e.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function t9(e,r,n){var a=LB.exec(r.slice(n,n+1));return a?n+a[0].length:-1}function r9(e,r,n){var a=Sr.exec(r.slice(n));return a?(e.Q=+a[0],n+a[0].length):-1}function n9(e,r,n){var a=Sr.exec(r.slice(n));return a?(e.s=+a[0],n+a[0].length):-1}function d2(e,r){return ht(e.getDate(),r,2)}function a9(e,r){return ht(e.getHours(),r,2)}function i9(e,r){return ht(e.getHours()%12||12,r,2)}function s9(e,r){return ht(1+_u.count(ni(e),e),r,3)}function hO(e,r){return ht(e.getMilliseconds(),r,3)}function l9(e,r){return hO(e,r)+"000"}function o9(e,r){return ht(e.getMonth()+1,r,2)}function c9(e,r){return ht(e.getMinutes(),r,2)}function u9(e,r){return ht(e.getSeconds(),r,2)}function d9(e){var r=e.getDay();return r===0?7:r}function m9(e,r){return ht(ip.count(ni(e)-1,e),r,2)}function vO(e){var r=e.getDay();return r>=4||r===0?jo(e):jo.ceil(e)}function f9(e,r){return e=vO(e),ht(jo.count(ni(e),e)+(ni(e).getDay()===4),r,2)}function p9(e){return e.getDay()}function h9(e,r){return ht(sf.count(ni(e)-1,e),r,2)}function v9(e,r){return ht(e.getFullYear()%100,r,2)}function g9(e,r){return e=vO(e),ht(e.getFullYear()%100,r,2)}function x9(e,r){return ht(e.getFullYear()%1e4,r,4)}function b9(e,r){var n=e.getDay();return e=n>=4||n===0?jo(e):jo.ceil(e),ht(e.getFullYear()%1e4,r,4)}function y9(e){var r=e.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+ht(r/60|0,"0",2)+ht(r%60,"0",2)}function m2(e,r){return ht(e.getUTCDate(),r,2)}function j9(e,r){return ht(e.getUTCHours(),r,2)}function _9(e,r){return ht(e.getUTCHours()%12||12,r,2)}function N9(e,r){return ht(1+ap.count(ai(e),e),r,3)}function gO(e,r){return ht(e.getUTCMilliseconds(),r,3)}function S9(e,r){return gO(e,r)+"000"}function w9(e,r){return ht(e.getUTCMonth()+1,r,2)}function C9(e,r){return ht(e.getUTCMinutes(),r,2)}function E9(e,r){return ht(e.getUTCSeconds(),r,2)}function A9(e){var r=e.getUTCDay();return r===0?7:r}function z9(e,r){return ht(sp.count(ai(e)-1,e),r,2)}function xO(e){var r=e.getUTCDay();return r>=4||r===0?_o(e):_o.ceil(e)}function k9(e,r){return e=xO(e),ht(_o.count(ai(e),e)+(ai(e).getUTCDay()===4),r,2)}function O9(e){return e.getUTCDay()}function D9(e,r){return ht(lf.count(ai(e)-1,e),r,2)}function P9(e,r){return ht(e.getUTCFullYear()%100,r,2)}function M9(e,r){return e=xO(e),ht(e.getUTCFullYear()%100,r,2)}function T9(e,r){return ht(e.getUTCFullYear()%1e4,r,4)}function q9(e,r){var n=e.getUTCDay();return e=n>=4||n===0?_o(e):_o.ceil(e),ht(e.getUTCFullYear()%1e4,r,4)}function R9(){return"+0000"}function f2(){return"%"}function p2(e){return+e}function h2(e){return Math.floor(+e/1e3)}var eo,bO,yO;I9({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function I9(e){return eo=IB(e),bO=eo.format,eo.parse,yO=eo.utcFormat,eo.utcParse,eo}function L9(e){return new Date(e)}function $9(e){return e instanceof Date?+e:+new Date(+e)}function By(e,r,n,a,l,o,u,d,m,p){var h=Ey(),v=h.invert,b=h.domain,x=p(".%L"),j=p(":%S"),_=p("%I:%M"),w=p("%I %p"),C=p("%a %d"),E=p("%b %d"),S=p("%B"),A=p("%Y");function z(k){return(m(k)<k?x:d(k)<k?j:u(k)<k?_:o(k)<k?w:a(k)<k?l(k)<k?C:E:n(k)<k?S:A)(k)}return h.invert=function(k){return new Date(v(k))},h.domain=function(k){return arguments.length?b(Array.from(k,$9)):b().map(L9)},h.ticks=function(k){var P=b();return e(P[0],P[P.length-1],k??10)},h.tickFormat=function(k,P){return P==null?z:p(P)},h.nice=function(k){var P=b();return(!k||typeof k.range!="function")&&(k=r(P[0],P[P.length-1],k??10)),k?b(sO(P,k)):h},h.copy=function(){return ju(h,By(e,r,n,a,l,o,u,d,m,p))},h}function B9(){return Hn.apply(By(qB,RB,ni,Ly,ip,_u,Ry,Ty,Rs,bO).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function U9(){return Hn.apply(By(MB,TB,ai,$y,sp,ap,Iy,qy,Rs,yO).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function lp(){var e=0,r=1,n,a,l,o,u=Gr,d=!1,m;function p(v){return v==null||isNaN(v=+v)?m:u(l===0?.5:(v=(o(v)-n)*l,d?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,r]=v,n=o(e=+e),a=o(r=+r),l=n===a?0:1/(a-n),p):[e,r]},p.clamp=function(v){return arguments.length?(d=!!v,p):d},p.interpolator=function(v){return arguments.length?(u=v,p):u};function h(v){return function(b){var x,j;return arguments.length?([x,j]=b,u=v(x,j),p):[u(0),u(1)]}}return p.range=h(wo),p.rangeRound=h(Cy),p.unknown=function(v){return arguments.length?(m=v,p):m},function(v){return o=v,n=v(e),a=v(r),l=n===a?0:1/(a-n),p}}function cs(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function jO(){var e=os(lp()(Gr));return e.copy=function(){return cs(e,jO())},fi.apply(e,arguments)}function _O(){var e=ky(lp()).domain([1,10]);return e.copy=function(){return cs(e,_O()).base(e.base())},fi.apply(e,arguments)}function NO(){var e=Oy(lp());return e.copy=function(){return cs(e,NO()).constant(e.constant())},fi.apply(e,arguments)}function Uy(){var e=Dy(lp());return e.copy=function(){return cs(e,Uy()).exponent(e.exponent())},fi.apply(e,arguments)}function F9(){return Uy.apply(null,arguments).exponent(.5)}function SO(){var e=[],r=Gr;function n(a){if(a!=null&&!isNaN(a=+a))return r((bu(e,a,1)-1)/(e.length-1))}return n.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let l of a)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Ji),n},n.interpolator=function(a){return arguments.length?(r=a,n):r},n.range=function(){return e.map((a,l)=>r(l/(e.length-1)))},n.quantiles=function(a){return Array.from({length:a+1},(l,o)=>A7(e,o/a))},n.copy=function(){return SO(r).domain(e)},fi.apply(n,arguments)}function op(){var e=0,r=.5,n=1,a=1,l,o,u,d,m,p=Gr,h,v=!1,b;function x(_){return isNaN(_=+_)?b:(_=.5+((_=+h(_))-o)*(a*_<a*o?d:m),p(v?Math.max(0,Math.min(1,_)):_))}x.domain=function(_){return arguments.length?([e,r,n]=_,l=h(e=+e),o=h(r=+r),u=h(n=+n),d=l===o?0:.5/(o-l),m=o===u?0:.5/(u-o),a=o<l?-1:1,x):[e,r,n]},x.clamp=function(_){return arguments.length?(v=!!_,x):v},x.interpolator=function(_){return arguments.length?(p=_,x):p};function j(_){return function(w){var C,E,S;return arguments.length?([C,E,S]=w,p=tB(_,[C,E,S]),x):[p(0),p(.5),p(1)]}}return x.range=j(wo),x.rangeRound=j(Cy),x.unknown=function(_){return arguments.length?(b=_,x):b},function(_){return h=_,l=_(e),o=_(r),u=_(n),d=l===o?0:.5/(o-l),m=o===u?0:.5/(u-o),a=o<l?-1:1,x}}function wO(){var e=os(op()(Gr));return e.copy=function(){return cs(e,wO())},fi.apply(e,arguments)}function CO(){var e=ky(op()).domain([.1,1,10]);return e.copy=function(){return cs(e,CO()).base(e.base())},fi.apply(e,arguments)}function EO(){var e=Oy(op());return e.copy=function(){return cs(e,EO()).constant(e.constant())},fi.apply(e,arguments)}function Fy(){var e=Dy(op());return e.copy=function(){return cs(e,Fy()).exponent(e.exponent())},fi.apply(e,arguments)}function G9(){return Fy.apply(null,arguments).exponent(.5)}const $c=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Ny,scaleDiverging:wO,scaleDivergingLog:CO,scaleDivergingPow:Fy,scaleDivergingSqrt:G9,scaleDivergingSymlog:EO,scaleIdentity:iO,scaleImplicit:xb,scaleLinear:aO,scaleLog:lO,scaleOrdinal:_y,scalePoint:O7,scalePow:Py,scaleQuantile:uO,scaleQuantize:dO,scaleRadial:cO,scaleSequential:jO,scaleSequentialLog:_O,scaleSequentialPow:Uy,scaleSequentialQuantile:SO,scaleSequentialSqrt:F9,scaleSequentialSymlog:NO,scaleSqrt:SB,scaleSymlog:oO,scaleThreshold:mO,scaleTime:B9,scaleUtc:U9,tickFormat:nO},Symbol.toStringTag,{value:"Module"}));var pi=e=>e.chartData,AO=me([pi],e=>{var r=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:r,dataStartIndex:0}}),Gy=(e,r,n,a)=>a?AO(e):pi(e),H9=(e,r,n)=>n?AO(e):pi(e);function ii(e){if(Array.isArray(e)&&e.length===2){var[r,n]=e;if(ut(r)&&ut(n))return!0}return!1}function v2(e,r,n){return n?e:[Math.min(e[0],r[0]),Math.max(e[1],r[1])]}function zO(e,r){if(r&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[n,a]=e,l,o;if(ut(n))l=n;else if(typeof n=="function")return;if(ut(a))o=a;else if(typeof a=="function")return;var u=[l,o];if(ii(u))return u}}function V9(e,r,n){if(!(!n&&r==null)){if(typeof e=="function"&&r!=null)try{var a=e(r,n);if(ii(a))return v2(a,r,n)}catch{}if(Array.isArray(e)&&e.length===2){var[l,o]=e,u,d;if(l==="auto")r!=null&&(u=Math.min(...r));else if(qe(l))u=l;else if(typeof l=="function")try{r!=null&&(u=l(r?.[0]))}catch{}else if(typeof l=="string"&&Ew.test(l)){var m=Ew.exec(l);if(m==null||m[1]==null||r==null)u=void 0;else{var p=+m[1];u=r[0]-p}}else u=r?.[0];if(o==="auto")r!=null&&(d=Math.max(...r));else if(qe(o))d=o;else if(typeof o=="function")try{r!=null&&(d=o(r?.[1]))}catch{}else if(typeof o=="string"&&Aw.test(o)){var h=Aw.exec(o);if(h==null||h[1]==null||r==null)d=void 0;else{var v=+h[1];d=r[1]+v}}else d=r?.[1];var b=[u,d];if(ii(b))return r==null?b:v2(b,r,n)}}}var Co=1e9,Q9={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Vy,Lt=!0,Un="[DecimalError] ",Hs=Un+"Invalid argument: ",Hy=Un+"Exponent out of range: ",Eo=Math.floor,Ms=Math.pow,Y9=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,vn,br=1e7,Tt=7,kO=9007199254740991,of=Eo(kO/Tt),Me={};Me.absoluteValue=Me.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Me.comparedTo=Me.cmp=function(e){var r,n,a,l,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(a=o.d.length,l=e.d.length,r=0,n=a<l?a:l;r<n;++r)if(o.d[r]!==e.d[r])return o.d[r]>e.d[r]^o.s<0?1:-1;return a===l?0:a>l^o.s<0?1:-1};Me.decimalPlaces=Me.dp=function(){var e=this,r=e.d.length-1,n=(r-e.e)*Tt;if(r=e.d[r],r)for(;r%10==0;r/=10)n--;return n<0?0:n};Me.dividedBy=Me.div=function(e){return Ja(this,new this.constructor(e))};Me.dividedToIntegerBy=Me.idiv=function(e){var r=this,n=r.constructor;return At(Ja(r,new n(e),0,1),n.precision)};Me.equals=Me.eq=function(e){return!this.cmp(e)};Me.exponent=function(){return sr(this)};Me.greaterThan=Me.gt=function(e){return this.cmp(e)>0};Me.greaterThanOrEqualTo=Me.gte=function(e){return this.cmp(e)>=0};Me.isInteger=Me.isint=function(){return this.e>this.d.length-2};Me.isNegative=Me.isneg=function(){return this.s<0};Me.isPositive=Me.ispos=function(){return this.s>0};Me.isZero=function(){return this.s===0};Me.lessThan=Me.lt=function(e){return this.cmp(e)<0};Me.lessThanOrEqualTo=Me.lte=function(e){return this.cmp(e)<1};Me.logarithm=Me.log=function(e){var r,n=this,a=n.constructor,l=a.precision,o=l+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(vn))throw Error(Un+"NaN");if(n.s<1)throw Error(Un+(n.s?"NaN":"-Infinity"));return n.eq(vn)?new a(0):(Lt=!1,r=Ja(iu(n,o),iu(e,o),o),Lt=!0,At(r,l))};Me.minus=Me.sub=function(e){var r=this;return e=new r.constructor(e),r.s==e.s?PO(r,e):OO(r,(e.s=-e.s,e))};Me.modulo=Me.mod=function(e){var r,n=this,a=n.constructor,l=a.precision;if(e=new a(e),!e.s)throw Error(Un+"NaN");return n.s?(Lt=!1,r=Ja(n,e,0,1).times(e),Lt=!0,n.minus(r)):At(new a(n),l)};Me.naturalExponential=Me.exp=function(){return DO(this)};Me.naturalLogarithm=Me.ln=function(){return iu(this)};Me.negated=Me.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Me.plus=Me.add=function(e){var r=this;return e=new r.constructor(e),r.s==e.s?OO(r,e):PO(r,(e.s=-e.s,e))};Me.precision=Me.sd=function(e){var r,n,a,l=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Hs+e);if(r=sr(l)+1,a=l.d.length-1,n=a*Tt+1,a=l.d[a],a){for(;a%10==0;a/=10)n--;for(a=l.d[0];a>=10;a/=10)n++}return e&&r>n?r:n};Me.squareRoot=Me.sqrt=function(){var e,r,n,a,l,o,u,d=this,m=d.constructor;if(d.s<1){if(!d.s)return new m(0);throw Error(Un+"NaN")}for(e=sr(d),Lt=!1,l=Math.sqrt(+d),l==0||l==1/0?(r=xa(d.d),(r.length+e)%2==0&&(r+="0"),l=Math.sqrt(r),e=Eo((e+1)/2)-(e<0||e%2),l==1/0?r="5e"+e:(r=l.toExponential(),r=r.slice(0,r.indexOf("e")+1)+e),a=new m(r)):a=new m(l.toString()),n=m.precision,l=u=n+3;;)if(o=a,a=o.plus(Ja(d,o,u+2)).times(.5),xa(o.d).slice(0,u)===(r=xa(a.d)).slice(0,u)){if(r=r.slice(u-3,u+1),l==u&&r=="4999"){if(At(o,n+1,0),o.times(o).eq(d)){a=o;break}}else if(r!="9999")break;u+=4}return Lt=!0,At(a,n)};Me.times=Me.mul=function(e){var r,n,a,l,o,u,d,m,p,h=this,v=h.constructor,b=h.d,x=(e=new v(e)).d;if(!h.s||!e.s)return new v(0);for(e.s*=h.s,n=h.e+e.e,m=b.length,p=x.length,m<p&&(o=b,b=x,x=o,u=m,m=p,p=u),o=[],u=m+p,a=u;a--;)o.push(0);for(a=p;--a>=0;){for(r=0,l=m+a;l>a;)d=o[l]+x[a]*b[l-a-1]+r,o[l--]=d%br|0,r=d/br|0;o[l]=(o[l]+r)%br|0}for(;!o[--u];)o.pop();return r?++n:o.shift(),e.d=o,e.e=n,Lt?At(e,v.precision):e};Me.toDecimalPlaces=Me.todp=function(e,r){var n=this,a=n.constructor;return n=new a(n),e===void 0?n:(wa(e,0,Co),r===void 0?r=a.rounding:wa(r,0,8),At(n,e+sr(n)+1,r))};Me.toExponential=function(e,r){var n,a=this,l=a.constructor;return e===void 0?n=Xs(a,!0):(wa(e,0,Co),r===void 0?r=l.rounding:wa(r,0,8),a=At(new l(a),e+1,r),n=Xs(a,!0,e+1)),n};Me.toFixed=function(e,r){var n,a,l=this,o=l.constructor;return e===void 0?Xs(l):(wa(e,0,Co),r===void 0?r=o.rounding:wa(r,0,8),a=At(new o(l),e+sr(l)+1,r),n=Xs(a.abs(),!1,e+sr(a)+1),l.isneg()&&!l.isZero()?"-"+n:n)};Me.toInteger=Me.toint=function(){var e=this,r=e.constructor;return At(new r(e),sr(e)+1,r.rounding)};Me.toNumber=function(){return+this};Me.toPower=Me.pow=function(e){var r,n,a,l,o,u,d=this,m=d.constructor,p=12,h=+(e=new m(e));if(!e.s)return new m(vn);if(d=new m(d),!d.s){if(e.s<1)throw Error(Un+"Infinity");return d}if(d.eq(vn))return d;if(a=m.precision,e.eq(vn))return At(d,a);if(r=e.e,n=e.d.length-1,u=r>=n,o=d.s,u){if((n=h<0?-h:h)<=kO){for(l=new m(vn),r=Math.ceil(a/Tt+4),Lt=!1;n%2&&(l=l.times(d),x2(l.d,r)),n=Eo(n/2),n!==0;)d=d.times(d),x2(d.d,r);return Lt=!0,e.s<0?new m(vn).div(l):At(l,a)}}else if(o<0)throw Error(Un+"NaN");return o=o<0&&e.d[Math.max(r,n)]&1?-1:1,d.s=1,Lt=!1,l=e.times(iu(d,a+p)),Lt=!0,l=DO(l),l.s=o,l};Me.toPrecision=function(e,r){var n,a,l=this,o=l.constructor;return e===void 0?(n=sr(l),a=Xs(l,n<=o.toExpNeg||n>=o.toExpPos)):(wa(e,1,Co),r===void 0?r=o.rounding:wa(r,0,8),l=At(new o(l),e,r),n=sr(l),a=Xs(l,e<=n||n<=o.toExpNeg,e)),a};Me.toSignificantDigits=Me.tosd=function(e,r){var n=this,a=n.constructor;return e===void 0?(e=a.precision,r=a.rounding):(wa(e,1,Co),r===void 0?r=a.rounding:wa(r,0,8)),At(new a(n),e,r)};Me.toString=Me.valueOf=Me.val=Me.toJSON=Me[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,r=sr(e),n=e.constructor;return Xs(e,r<=n.toExpNeg||r>=n.toExpPos)};function OO(e,r){var n,a,l,o,u,d,m,p,h=e.constructor,v=h.precision;if(!e.s||!r.s)return r.s||(r=new h(e)),Lt?At(r,v):r;if(m=e.d,p=r.d,u=e.e,l=r.e,m=m.slice(),o=u-l,o){for(o<0?(a=m,o=-o,d=p.length):(a=p,l=u,d=m.length),u=Math.ceil(v/Tt),d=u>d?u+1:d+1,o>d&&(o=d,a.length=1),a.reverse();o--;)a.push(0);a.reverse()}for(d=m.length,o=p.length,d-o<0&&(o=d,a=p,p=m,m=a),n=0;o;)n=(m[--o]=m[o]+p[o]+n)/br|0,m[o]%=br;for(n&&(m.unshift(n),++l),d=m.length;m[--d]==0;)m.pop();return r.d=m,r.e=l,Lt?At(r,v):r}function wa(e,r,n){if(e!==~~e||e<r||e>n)throw Error(Hs+e)}function xa(e){var r,n,a,l=e.length-1,o="",u=e[0];if(l>0){for(o+=u,r=1;r<l;r++)a=e[r]+"",n=Tt-a.length,n&&(o+=Qi(n)),o+=a;u=e[r],a=u+"",n=Tt-a.length,n&&(o+=Qi(n))}else if(u===0)return"0";for(;u%10===0;)u/=10;return o+u}var Ja=(function(){function e(a,l){var o,u=0,d=a.length;for(a=a.slice();d--;)o=a[d]*l+u,a[d]=o%br|0,u=o/br|0;return u&&a.unshift(u),a}function r(a,l,o,u){var d,m;if(o!=u)m=o>u?1:-1;else for(d=m=0;d<o;d++)if(a[d]!=l[d]){m=a[d]>l[d]?1:-1;break}return m}function n(a,l,o){for(var u=0;o--;)a[o]-=u,u=a[o]<l[o]?1:0,a[o]=u*br+a[o]-l[o];for(;!a[0]&&a.length>1;)a.shift()}return function(a,l,o,u){var d,m,p,h,v,b,x,j,_,w,C,E,S,A,z,k,P,D,$=a.constructor,F=a.s==l.s?1:-1,Y=a.d,M=l.d;if(!a.s)return new $(a);if(!l.s)throw Error(Un+"Division by zero");for(m=a.e-l.e,P=M.length,z=Y.length,x=new $(F),j=x.d=[],p=0;M[p]==(Y[p]||0);)++p;if(M[p]>(Y[p]||0)&&--m,o==null?E=o=$.precision:u?E=o+(sr(a)-sr(l))+1:E=o,E<0)return new $(0);if(E=E/Tt+2|0,p=0,P==1)for(h=0,M=M[0],E++;(p<z||h)&&E--;p++)S=h*br+(Y[p]||0),j[p]=S/M|0,h=S%M|0;else{for(h=br/(M[0]+1)|0,h>1&&(M=e(M,h),Y=e(Y,h),P=M.length,z=Y.length),A=P,_=Y.slice(0,P),w=_.length;w<P;)_[w++]=0;D=M.slice(),D.unshift(0),k=M[0],M[1]>=br/2&&++k;do h=0,d=r(M,_,P,w),d<0?(C=_[0],P!=w&&(C=C*br+(_[1]||0)),h=C/k|0,h>1?(h>=br&&(h=br-1),v=e(M,h),b=v.length,w=_.length,d=r(v,_,b,w),d==1&&(h--,n(v,P<b?D:M,b))):(h==0&&(d=h=1),v=M.slice()),b=v.length,b<w&&v.unshift(0),n(_,v,w),d==-1&&(w=_.length,d=r(M,_,P,w),d<1&&(h++,n(_,P<w?D:M,w))),w=_.length):d===0&&(h++,_=[0]),j[p++]=h,d&&_[0]?_[w++]=Y[A]||0:(_=[Y[A]],w=1);while((A++<z||_[0]!==void 0)&&E--)}return j[0]||j.shift(),x.e=m,At(x,u?o+sr(x)+1:o)}})();function DO(e,r){var n,a,l,o,u,d,m=0,p=0,h=e.constructor,v=h.precision;if(sr(e)>16)throw Error(Hy+sr(e));if(!e.s)return new h(vn);for(Lt=!1,d=v,u=new h(.03125);e.abs().gte(.1);)e=e.times(u),p+=5;for(a=Math.log(Ms(2,p))/Math.LN10*2+5|0,d+=a,n=l=o=new h(vn),h.precision=d;;){if(l=At(l.times(e),d),n=n.times(++m),u=o.plus(Ja(l,n,d)),xa(u.d).slice(0,d)===xa(o.d).slice(0,d)){for(;p--;)o=At(o.times(o),d);return h.precision=v,r==null?(Lt=!0,At(o,v)):o}o=u}}function sr(e){for(var r=e.e*Tt,n=e.d[0];n>=10;n/=10)r++;return r}function hx(e,r,n){if(r>e.LN10.sd())throw Lt=!0,n&&(e.precision=n),Error(Un+"LN10 precision limit exceeded");return At(new e(e.LN10),r)}function Qi(e){for(var r="";e--;)r+="0";return r}function iu(e,r){var n,a,l,o,u,d,m,p,h,v=1,b=10,x=e,j=x.d,_=x.constructor,w=_.precision;if(x.s<1)throw Error(Un+(x.s?"NaN":"-Infinity"));if(x.eq(vn))return new _(0);if(r==null?(Lt=!1,p=w):p=r,x.eq(10))return r==null&&(Lt=!0),hx(_,p);if(p+=b,_.precision=p,n=xa(j),a=n.charAt(0),o=sr(x),Math.abs(o)<15e14){for(;a<7&&a!=1||a==1&&n.charAt(1)>3;)x=x.times(e),n=xa(x.d),a=n.charAt(0),v++;o=sr(x),a>1?(x=new _("0."+n),o++):x=new _(a+"."+n.slice(1))}else return m=hx(_,p+2,w).times(o+""),x=iu(new _(a+"."+n.slice(1)),p-b).plus(m),_.precision=w,r==null?(Lt=!0,At(x,w)):x;for(d=u=x=Ja(x.minus(vn),x.plus(vn),p),h=At(x.times(x),p),l=3;;){if(u=At(u.times(h),p),m=d.plus(Ja(u,new _(l),p)),xa(m.d).slice(0,p)===xa(d.d).slice(0,p))return d=d.times(2),o!==0&&(d=d.plus(hx(_,p+2,w).times(o+""))),d=Ja(d,new _(v),p),_.precision=w,r==null?(Lt=!0,At(d,w)):d;d=m,l+=2}}function g2(e,r){var n,a,l;for((n=r.indexOf("."))>-1&&(r=r.replace(".","")),(a=r.search(/e/i))>0?(n<0&&(n=a),n+=+r.slice(a+1),r=r.substring(0,a)):n<0&&(n=r.length),a=0;r.charCodeAt(a)===48;)++a;for(l=r.length;r.charCodeAt(l-1)===48;)--l;if(r=r.slice(a,l),r){if(l-=a,n=n-a-1,e.e=Eo(n/Tt),e.d=[],a=(n+1)%Tt,n<0&&(a+=Tt),a<l){for(a&&e.d.push(+r.slice(0,a)),l-=Tt;a<l;)e.d.push(+r.slice(a,a+=Tt));r=r.slice(a),a=Tt-r.length}else a-=l;for(;a--;)r+="0";if(e.d.push(+r),Lt&&(e.e>of||e.e<-of))throw Error(Hy+n)}else e.s=0,e.e=0,e.d=[0];return e}function At(e,r,n){var a,l,o,u,d,m,p,h,v=e.d;for(u=1,o=v[0];o>=10;o/=10)u++;if(a=r-u,a<0)a+=Tt,l=r,p=v[h=0];else{if(h=Math.ceil((a+1)/Tt),o=v.length,h>=o)return e;for(p=o=v[h],u=1;o>=10;o/=10)u++;a%=Tt,l=a-Tt+u}if(n!==void 0&&(o=Ms(10,u-l-1),d=p/o%10|0,m=r<0||v[h+1]!==void 0||p%o,m=n<4?(d||m)&&(n==0||n==(e.s<0?3:2)):d>5||d==5&&(n==4||m||n==6&&(a>0?l>0?p/Ms(10,u-l):0:v[h-1])%10&1||n==(e.s<0?8:7))),r<1||!v[0])return m?(o=sr(e),v.length=1,r=r-o-1,v[0]=Ms(10,(Tt-r%Tt)%Tt),e.e=Eo(-r/Tt)||0):(v.length=1,v[0]=e.e=e.s=0),e;if(a==0?(v.length=h,o=1,h--):(v.length=h+1,o=Ms(10,Tt-a),v[h]=l>0?(p/Ms(10,u-l)%Ms(10,l)|0)*o:0),m)for(;;)if(h==0){(v[0]+=o)==br&&(v[0]=1,++e.e);break}else{if(v[h]+=o,v[h]!=br)break;v[h--]=0,o=1}for(a=v.length;v[--a]===0;)v.pop();if(Lt&&(e.e>of||e.e<-of))throw Error(Hy+sr(e));return e}function PO(e,r){var n,a,l,o,u,d,m,p,h,v,b=e.constructor,x=b.precision;if(!e.s||!r.s)return r.s?r.s=-r.s:r=new b(e),Lt?At(r,x):r;if(m=e.d,v=r.d,a=r.e,p=e.e,m=m.slice(),u=p-a,u){for(h=u<0,h?(n=m,u=-u,d=v.length):(n=v,a=p,d=m.length),l=Math.max(Math.ceil(x/Tt),d)+2,u>l&&(u=l,n.length=1),n.reverse(),l=u;l--;)n.push(0);n.reverse()}else{for(l=m.length,d=v.length,h=l<d,h&&(d=l),l=0;l<d;l++)if(m[l]!=v[l]){h=m[l]<v[l];break}u=0}for(h&&(n=m,m=v,v=n,r.s=-r.s),d=m.length,l=v.length-d;l>0;--l)m[d++]=0;for(l=v.length;l>u;){if(m[--l]<v[l]){for(o=l;o&&m[--o]===0;)m[o]=br-1;--m[o],m[l]+=br}m[l]-=v[l]}for(;m[--d]===0;)m.pop();for(;m[0]===0;m.shift())--a;return m[0]?(r.d=m,r.e=a,Lt?At(r,x):r):new b(0)}function Xs(e,r,n){var a,l=sr(e),o=xa(e.d),u=o.length;return r?(n&&(a=n-u)>0?o=o.charAt(0)+"."+o.slice(1)+Qi(a):u>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(l<0?"e":"e+")+l):l<0?(o="0."+Qi(-l-1)+o,n&&(a=n-u)>0&&(o+=Qi(a))):l>=u?(o+=Qi(l+1-u),n&&(a=n-l-1)>0&&(o=o+"."+Qi(a))):((a=l+1)<u&&(o=o.slice(0,a)+"."+o.slice(a)),n&&(a=n-u)>0&&(l+1===u&&(o+="."),o+=Qi(a))),e.s<0?"-"+o:o}function x2(e,r){if(e.length>r)return e.length=r,!0}function MO(e){var r,n,a;function l(o){var u=this;if(!(u instanceof l))return new l(o);if(u.constructor=l,o instanceof l){u.s=o.s,u.e=o.e,u.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(Hs+o);if(o>0)u.s=1;else if(o<0)o=-o,u.s=-1;else{u.s=0,u.e=0,u.d=[0];return}if(o===~~o&&o<1e7){u.e=0,u.d=[o];return}return g2(u,o.toString())}else if(typeof o!="string")throw Error(Hs+o);if(o.charCodeAt(0)===45?(o=o.slice(1),u.s=-1):u.s=1,Y9.test(o))g2(u,o);else throw Error(Hs+o)}if(l.prototype=Me,l.ROUND_UP=0,l.ROUND_DOWN=1,l.ROUND_CEIL=2,l.ROUND_FLOOR=3,l.ROUND_HALF_UP=4,l.ROUND_HALF_DOWN=5,l.ROUND_HALF_EVEN=6,l.ROUND_HALF_CEIL=7,l.ROUND_HALF_FLOOR=8,l.clone=MO,l.config=l.set=K9,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],r=0;r<a.length;)e.hasOwnProperty(n=a[r++])||(e[n]=this[n]);return l.config(e),l}function K9(e){if(!e||typeof e!="object")throw Error(Un+"Object expected");var r,n,a,l=["precision",1,Co,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(r=0;r<l.length;r+=3)if((a=e[n=l[r]])!==void 0)if(Eo(a)===a&&a>=l[r+1]&&a<=l[r+2])this[n]=a;else throw Error(Hs+n+": "+a);if((a=e[n="LN10"])!==void 0)if(a==Math.LN10)this[n]=new this(a);else throw Error(Hs+n+": "+a);return this}var Vy=MO(Q9);vn=new Vy(1);const yt=Vy;function TO(e){var r;return e===0?r=1:r=Math.floor(new yt(e).abs().log(10).toNumber())+1,r}function qO(e,r,n){for(var a=new yt(e),l=0,o=[];a.lt(r)&&l<1e5;)o.push(a.toNumber()),a=a.add(n),l++;return o}var RO=e=>{var[r,n]=e,[a,l]=[r,n];return r>n&&([a,l]=[n,r]),[a,l]},IO=(e,r,n)=>{if(e.lte(0))return new yt(0);var a=TO(e.toNumber()),l=new yt(10).pow(a),o=e.div(l),u=a!==1?.05:.1,d=new yt(Math.ceil(o.div(u).toNumber())).add(n).mul(u),m=d.mul(l);return r?new yt(m.toNumber()):new yt(Math.ceil(m.toNumber()))},W9=(e,r,n)=>{var a=new yt(1),l=new yt(e);if(!l.isint()&&n){var o=Math.abs(e);o<1?(a=new yt(10).pow(TO(e)-1),l=new yt(Math.floor(l.div(a).toNumber())).mul(a)):o>1&&(l=new yt(Math.floor(e)))}else e===0?l=new yt(Math.floor((r-1)/2)):n||(l=new yt(Math.floor(e)));for(var u=Math.floor((r-1)/2),d=[],m=0;m<r;m++)d.push(l.add(new yt(m-u).mul(a)).toNumber());return d},LO=function(r,n,a,l){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-r)/(a-1)))return{step:new yt(0),tickMin:new yt(0),tickMax:new yt(0)};var u=IO(new yt(n).sub(r).div(a-1),l,o),d;r<=0&&n>=0?d=new yt(0):(d=new yt(r).add(n).div(2),d=d.sub(new yt(d).mod(u)));var m=Math.ceil(d.sub(r).div(u).toNumber()),p=Math.ceil(new yt(n).sub(d).div(u).toNumber()),h=m+p+1;return h>a?LO(r,n,a,l,o+1):(h<a&&(p=n>0?p+(a-h):p,m=n>0?m:m+(a-h)),{step:u,tickMin:d.sub(new yt(m).mul(u)),tickMax:d.add(new yt(p).mul(u))})},X9=function(r){var[n,a]=r,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,u=Math.max(l,2),[d,m]=RO([n,a]);if(d===-1/0||m===1/0){var p=m===1/0?[d,...Array(l-1).fill(1/0)]:[...Array(l-1).fill(-1/0),m];return n>a?p.reverse():p}if(d===m)return W9(d,l,o);var{step:h,tickMin:v,tickMax:b}=LO(d,m,u,o,0),x=qO(v,b.add(new yt(.1).mul(h)),h);return n>a?x.reverse():x},Z9=function(r,n){var[a,l]=r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[u,d]=RO([a,l]);if(u===-1/0||d===1/0)return[a,l];if(u===d)return[u];var m=Math.max(n,2),p=IO(new yt(d).sub(u).div(m-1),o,0),h=[...qO(new yt(u),new yt(d),p),d];return o===!1&&(h=h.map(v=>Math.round(v))),a>l?h.reverse():h},$O=e=>e.rootProps.maxBarSize,J9=e=>e.rootProps.barGap,BO=e=>e.rootProps.barCategoryGap,eU=e=>e.rootProps.barSize,cp=e=>e.rootProps.stackOffset,UO=e=>e.rootProps.reverseStackOrder,Qy=e=>e.options.chartName,Yy=e=>e.rootProps.syncId,FO=e=>e.rootProps.syncMethod,Ky=e=>e.options.eventEmitter,_r={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},ks={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},fa={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},up=(e,r)=>{if(!(!e||!r))return e!=null&&e.reversed?[r[1],r[0]]:r};function dp(e,r,n){if(n!=="auto")return n;if(e!=null)return ui(e,r)?"category":"number"}function b2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function cf(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?b2(Object(n),!0).forEach(function(a){tU(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function tU(e,r,n){return(r=rU(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function rU(e){var r=nU(e,"string");return typeof r=="symbol"?r:r+""}function nU(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var y2={allowDataOverflow:ks.allowDataOverflow,allowDecimals:ks.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:ks.angleAxisId,includeHidden:!1,name:void 0,reversed:ks.reversed,scale:ks.scale,tick:ks.tick,tickCount:void 0,ticks:void 0,type:ks.type,unit:void 0},j2={allowDataOverflow:fa.allowDataOverflow,allowDecimals:fa.allowDecimals,allowDuplicatedCategory:fa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:fa.radiusAxisId,includeHidden:fa.includeHidden,name:void 0,reversed:fa.reversed,scale:fa.scale,tick:fa.tick,tickCount:fa.tickCount,ticks:void 0,type:fa.type,unit:void 0},aU=(e,r)=>{if(r!=null)return e.polarAxis.angleAxis[r]},Wy=me([aU,kk],(e,r)=>{var n;if(e!=null)return e;var a=(n=dp(r,"angleAxis",y2.type))!==null&&n!==void 0?n:"category";return cf(cf({},y2),{},{type:a})}),iU=(e,r)=>e.polarAxis.radiusAxis[r],Xy=me([iU,kk],(e,r)=>{var n;if(e!=null)return e;var a=(n=dp(r,"radiusAxis",j2.type))!==null&&n!==void 0?n:"category";return cf(cf({},j2),{},{type:a})}),mp=e=>e.polarOptions,Zy=me([di,mi,Nr],r7),GO=me([mp,Zy],(e,r)=>{if(e!=null)return na(e.innerRadius,r,0)}),HO=me([mp,Zy],(e,r)=>{if(e!=null)return na(e.outerRadius,r,r*.8)}),sU=e=>{if(e==null)return[0,0];var{startAngle:r,endAngle:n}=e;return[r,n]},VO=me([mp],sU);me([Wy,VO],up);var QO=me([Zy,GO,HO],(e,r,n)=>{if(!(e==null||r==null||n==null))return[r,n]});me([Xy,QO],up);var YO=me([jt,mp,GO,HO,di,mi],(e,r,n,a,l,o)=>{if(!(e!=="centric"&&e!=="radial"||r==null||n==null||a==null)){var{cx:u,cy:d,startAngle:m,endAngle:p}=r;return{cx:na(u,l,l/2),cy:na(d,o,o/2),innerRadius:n,outerRadius:a,startAngle:m,endAngle:p,clockWise:!1}}}),wr=(e,r)=>r,fp=(e,r,n)=>n;function Jy(e){return e?.id}function KO(e,r,n){var{chartData:a=[]}=r,{allowDuplicatedCategory:l,dataKey:o}=n,u=new Map;return e.forEach(d=>{var m,p=(m=d.data)!==null&&m!==void 0?m:a;if(!(p==null||p.length===0)){var h=Jy(d);p.forEach((v,b)=>{var x=o==null||l?b:String(ir(v,o,null)),j=ir(v,d.dataKey,0),_;u.has(x)?_=u.get(x):_={},Object.assign(_,{[h]:j}),u.set(x,_)})}}),Array.from(u.values())}function pp(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var hp=(e,r)=>e===r?!0:e==null||r==null?!1:e[0]===r[0]&&e[1]===r[1];function vp(e,r){return Array.isArray(e)&&Array.isArray(r)&&e.length===0&&r.length===0?!0:e===r}function lU(e,r){if(e.length===r.length){for(var n=0;n<e.length;n++)if(e[n]!==r[n])return!1;return!0}return!1}var Cr=e=>{var r=jt(e);return r==="horizontal"?"xAxis":r==="vertical"?"yAxis":r==="centric"?"angleAxis":"radiusAxis"},Ao=e=>e.tooltip.settings.axisId;function oU(e){if(e in $c)return $c[e]();var r="scale".concat(fu(e));if(r in $c)return $c[r]()}function _2(e){var r=e.ticks,n=e.bandwidth,a=e.range(),l=[Math.min(...a),Math.max(...a)];return{domain:()=>e.domain(),range:(function(o){function u(){return o.apply(this,arguments)}return u.toString=function(){return o.toString()},u})(()=>l),rangeMin:()=>l[0],rangeMax:()=>l[1],isInRange(o){var u=l[0],d=l[1];return u<=d?o>=u&&o<=d:o>=d&&o<=u},bandwidth:n?()=>n.call(e):void 0,ticks:r?o=>r.call(e,o):void 0,map:(o,u)=>{var d=e(o);if(d!=null){if(e.bandwidth&&u!==null&&u!==void 0&&u.position){var m=e.bandwidth();switch(u.position){case"middle":d+=m/2;break;case"end":d+=m;break}}return d}}}}function N2(e,r,n){if(typeof e=="function")return _2(e.copy().domain(r).range(n));if(e!=null){var a=oU(e);if(a!=null)return a.domain(r).range(n),_2(a)}}var cU=(e,r)=>{if(r!=null)switch(e){case"linear":{if(!ii(r)){for(var n,a,l=0;l<r.length;l++){var o=r[l];ut(o)&&((n===void 0||o<n)&&(n=o),(a===void 0||o>a)&&(a=o))}return n!==void 0&&a!==void 0?[n,a]:void 0}return r}default:return r}};function S2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function uf(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?S2(Object(n),!0).forEach(function(a){uU(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function uU(e,r,n){return(r=dU(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function dU(e){var r=mU(e,"string");return typeof r=="symbol"?r:r+""}function mU(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var _b=[0,"auto"],vr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},WO=(e,r)=>e.cartesianAxis.xAxis[r],hi=(e,r)=>{var n=WO(e,r);return n??vr},gr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:_b,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:vu},XO=(e,r)=>e.cartesianAxis.yAxis[r],vi=(e,r)=>{var n=XO(e,r);return n??gr},fU={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},ej=(e,r)=>{var n=e.cartesianAxis.zAxis[r];return n??fU},Yr=(e,r,n)=>{switch(r){case"xAxis":return hi(e,n);case"yAxis":return vi(e,n);case"zAxis":return ej(e,n);case"angleAxis":return Wy(e,n);case"radiusAxis":return Xy(e,n);default:throw new Error("Unexpected axis type: ".concat(r))}},pU=(e,r,n)=>{switch(r){case"xAxis":return hi(e,n);case"yAxis":return vi(e,n);default:throw new Error("Unexpected axis type: ".concat(r))}},Nu=(e,r,n)=>{switch(r){case"xAxis":return hi(e,n);case"yAxis":return vi(e,n);case"angleAxis":return Wy(e,n);case"radiusAxis":return Xy(e,n);default:throw new Error("Unexpected axis type: ".concat(r))}},ZO=e=>e.graphicalItems.cartesianItems.some(r=>r.type==="bar")||e.graphicalItems.polarItems.some(r=>r.type==="radialBar");function JO(e,r){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===r;case"yAxis":return"yAxisId"in n&&n.yAxisId===r;case"zAxis":return"zAxisId"in n&&n.zAxisId===r;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===r;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===r;default:return!1}}}var gp=e=>e.graphicalItems.cartesianItems,hU=me([wr,fp],JO),eD=(e,r,n)=>e.filter(n).filter(a=>r?.includeHidden===!0?!0:!a.hide),Su=me([gp,Yr,hU],eD,{memoizeOptions:{resultEqualityCheck:vp}}),tD=me([Su],e=>e.filter(r=>r.type==="area"||r.type==="bar").filter(pp)),rD=e=>e.filter(r=>!("stackId"in r)||r.stackId===void 0),vU=me([Su],rD),nD=e=>e.map(r=>r.data).filter(Boolean).flat(1),gU=me([Su],nD,{memoizeOptions:{resultEqualityCheck:vp}}),aD=(e,r)=>{var{chartData:n=[],dataStartIndex:a,dataEndIndex:l}=r;return e.length>0?e:n.slice(a,l+1)},tj=me([gU,Gy],aD),iD=(e,r,n)=>r?.dataKey!=null?e.map(a=>({value:ir(a,r.dataKey)})):n.length>0?n.map(a=>a.dataKey).flatMap(a=>e.map(l=>({value:ir(l,a)}))):e.map(a=>({value:a})),xp=me([tj,Yr,Su],iD);function sD(e,r){switch(e){case"xAxis":return r.direction==="x";case"yAxis":return r.direction==="y";default:return!1}}function gm(e){if(Na(e)||e instanceof Date){var r=Number(e);if(ut(r))return r}}function w2(e){if(Array.isArray(e)){var r=[gm(e[0]),gm(e[1])];return ii(r)?r:void 0}var n=gm(e);if(n!=null)return[n,n]}function si(e){return e.map(gm).filter(an)}function xU(e,r,n){return!n||typeof r!="number"||_a(r)?[]:n.length?si(n.flatMap(a=>{var l=ir(e,a.dataKey),o,u;if(Array.isArray(l)?[o,u]=l:o=u=l,!(!ut(o)||!ut(u)))return[r-o,r+u]})):[]}var dr=e=>{var r=Cr(e),n=Ao(e);return Nu(e,r,n)},wu=me([dr],e=>e?.dataKey),bU=me([tD,Gy,dr],KO),lD=(e,r,n,a)=>{var l={},o=r.reduce((u,d)=>{if(d.stackId==null)return u;var m=u[d.stackId];return m==null&&(m=[]),m.push(d),u[d.stackId]=m,u},l);return Object.fromEntries(Object.entries(o).map(u=>{var[d,m]=u,p=a?[...m].reverse():m,h=p.map(Jy);return[d,{stackedData:QL(e,h,n),graphicalItems:p}]}))},Nb=me([bU,tD,cp,UO],lD),oD=(e,r,n,a)=>{var{dataStartIndex:l,dataEndIndex:o}=r;if(a==null&&n!=="zAxis"){var u=ZL(e,l,o);if(!(u!=null&&u[0]===0&&u[1]===0))return u}},yU=me([Yr],e=>e.allowDataOverflow),rj=e=>{var r;if(e==null||!("domain"in e))return _b;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var n=si(e.ticks);return[Math.min(...n),Math.max(...n)]}if(e.type==="category")return e.ticks.map(String)}return(r=e?.domain)!==null&&r!==void 0?r:_b},cD=me([Yr],rj),uD=me([cD,yU],zO),jU=me([Nb,pi,wr,uD],oD,{memoizeOptions:{resultEqualityCheck:hp}}),nj=e=>e.errorBars,_U=(e,r,n)=>e.flatMap(a=>r[a.id]).filter(Boolean).filter(a=>sD(n,a)),df=function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var l=n.filter(Boolean);if(l.length!==0){var o=l.flat(),u=Math.min(...o),d=Math.max(...o);return[u,d]}},dD=(e,r,n,a,l)=>{var o,u;if(n.length>0&&e.forEach(d=>{n.forEach(m=>{var p,h,v=(p=a[m.id])===null||p===void 0?void 0:p.filter(C=>sD(l,C)),b=ir(d,(h=r.dataKey)!==null&&h!==void 0?h:m.dataKey),x=xU(d,b,v);if(x.length>=2){var j=Math.min(...x),_=Math.max(...x);(o==null||j<o)&&(o=j),(u==null||_>u)&&(u=_)}var w=w2(b);w!=null&&(o=o==null?w[0]:Math.min(o,w[0]),u=u==null?w[1]:Math.max(u,w[1]))})}),r?.dataKey!=null&&e.forEach(d=>{var m=w2(ir(d,r.dataKey));m!=null&&(o=o==null?m[0]:Math.min(o,m[0]),u=u==null?m[1]:Math.max(u,m[1]))}),ut(o)&&ut(u))return[o,u]},NU=me([tj,Yr,vU,nj,wr],dD,{memoizeOptions:{resultEqualityCheck:hp}});function SU(e){var{value:r}=e;if(Na(r)||r instanceof Date)return r}var wU=(e,r,n)=>{var a=e.map(SU).filter(l=>l!=null);return n&&(r.dataKey==null||r.allowDuplicatedCategory&&Ez(a))?Yk(0,e.length):r.allowDuplicatedCategory?a:Array.from(new Set(a))},mD=e=>e.referenceElements.dots,zo=(e,r,n)=>e.filter(a=>a.ifOverflow==="extendDomain").filter(a=>r==="xAxis"?a.xAxisId===n:a.yAxisId===n),CU=me([mD,wr,fp],zo),fD=e=>e.referenceElements.areas,EU=me([fD,wr,fp],zo),pD=e=>e.referenceElements.lines,AU=me([pD,wr,fp],zo),hD=(e,r)=>{if(e!=null){var n=si(e.map(a=>r==="xAxis"?a.x:a.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},zU=me(CU,wr,hD),vD=(e,r)=>{if(e!=null){var n=si(e.flatMap(a=>[r==="xAxis"?a.x1:a.y1,r==="xAxis"?a.x2:a.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},kU=me([EU,wr],vD);function OU(e){var r;if(e.x!=null)return si([e.x]);var n=(r=e.segment)===null||r===void 0?void 0:r.map(a=>a.x);return n==null||n.length===0?[]:si(n)}function DU(e){var r;if(e.y!=null)return si([e.y]);var n=(r=e.segment)===null||r===void 0?void 0:r.map(a=>a.y);return n==null||n.length===0?[]:si(n)}var gD=(e,r)=>{if(e!=null){var n=e.flatMap(a=>r==="xAxis"?OU(a):DU(a));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},PU=me([AU,wr],gD),MU=me(zU,PU,kU,(e,r,n)=>df(e,n,r)),xD=(e,r,n,a,l,o,u,d)=>{if(n!=null)return n;var m=u==="vertical"&&d==="xAxis"||u==="horizontal"&&d==="yAxis",p=m?df(a,o,l):df(o,l);return V9(r,p,e.allowDataOverflow)},TU=me([Yr,cD,uD,jU,NU,MU,jt,wr],xD,{memoizeOptions:{resultEqualityCheck:hp}}),qU=[0,1],bD=(e,r,n,a,l,o,u)=>{if(!((e==null||n==null||n.length===0)&&u===void 0)){var{dataKey:d,type:m}=e,p=ui(r,o);if(p&&d==null){var h;return Yk(0,(h=n?.length)!==null&&h!==void 0?h:0)}return m==="category"?wU(a,e,p):l==="expand"?qU:u}},aj=me([Yr,jt,tj,xp,cp,wr,TU],bD);function RU(e){return e in $c}var yD=(e,r,n)=>{if(e!=null){var{scale:a,type:l}=e;if(a==="auto")return l==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":l==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(fu(a));return RU(o)?o:"point"}}},ko=me([Yr,ZO,Qy],yD);function ij(e,r,n,a){if(!(n==null||a==null))return typeof e.scale=="function"?N2(e.scale,n,a):N2(r,n,a)}var jD=(e,r,n)=>{var a=rj(r);if(!(n!=="auto"&&n!=="linear")){if(r!=null&&r.tickCount&&Array.isArray(a)&&(a[0]==="auto"||a[1]==="auto")&&ii(e))return X9(e,r.tickCount,r.allowDecimals);if(r!=null&&r.tickCount&&r.type==="number"&&ii(e))return Z9(e,r.tickCount,r.allowDecimals)}},sj=me([aj,Nu,ko],jD),_D=(e,r,n,a)=>{if(a!=="angleAxis"&&e?.type==="number"&&ii(r)&&Array.isArray(n)&&n.length>0){var l,o,u=r[0],d=(l=n[0])!==null&&l!==void 0?l:0,m=r[1],p=(o=n[n.length-1])!==null&&o!==void 0?o:0;return[Math.min(u,d),Math.max(m,p)]}return r},IU=me([Yr,aj,sj,wr],_D),LU=me(xp,Yr,(e,r)=>{if(!(!r||r.type!=="number")){var n=1/0,a=Array.from(si(e.map(v=>v.value))).sort((v,b)=>v-b),l=a[0],o=a[a.length-1];if(l==null||o==null)return 1/0;var u=o-l;if(u===0)return 1/0;for(var d=0;d<a.length-1;d++){var m=a[d],p=a[d+1];if(!(m==null||p==null)){var h=p-m;n=Math.min(n,h)}}return n/u}}),ND=me(LU,jt,BO,Nr,(e,r,n,a,l)=>l,(e,r,n,a,l)=>{if(!ut(e))return 0;var o=r==="vertical"?a.height:a.width;if(l==="gap")return e*o/2;if(l==="no-gap"){var u=na(n,e*o),d=e*o/2;return d-u-(d-u)/o*u}return 0}),$U=(e,r,n)=>{var a=hi(e,r);return a==null||typeof a.padding!="string"?0:ND(e,"xAxis",r,n,a.padding)},BU=(e,r,n)=>{var a=vi(e,r);return a==null||typeof a.padding!="string"?0:ND(e,"yAxis",r,n,a.padding)},UU=me(hi,$U,(e,r)=>{var n,a;if(e==null)return{left:0,right:0};var{padding:l}=e;return typeof l=="string"?{left:r,right:r}:{left:((n=l.left)!==null&&n!==void 0?n:0)+r,right:((a=l.right)!==null&&a!==void 0?a:0)+r}}),FU=me(vi,BU,(e,r)=>{var n,a;if(e==null)return{top:0,bottom:0};var{padding:l}=e;return typeof l=="string"?{top:r,bottom:r}:{top:((n=l.top)!==null&&n!==void 0?n:0)+r,bottom:((a=l.bottom)!==null&&a!==void 0?a:0)+r}}),GU=me([Nr,UU,Kf,Yf,(e,r,n)=>n],(e,r,n,a,l)=>{var{padding:o}=a;return l?[o.left,n.width-o.right]:[e.left+r.left,e.left+e.width-r.right]}),HU=me([Nr,jt,FU,Kf,Yf,(e,r,n)=>n],(e,r,n,a,l,o)=>{var{padding:u}=l;return o?[a.height-u.bottom,u.top]:r==="horizontal"?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),Cu=(e,r,n,a)=>{var l;switch(r){case"xAxis":return GU(e,n,a);case"yAxis":return HU(e,n,a);case"zAxis":return(l=ej(e,n))===null||l===void 0?void 0:l.range;case"angleAxis":return VO(e);case"radiusAxis":return QO(e,n);default:return}},SD=me([Yr,Cu],up),VU=me([ko,IU],cU),bp=me([Yr,ko,VU,SD],ij);me([Su,nj,wr],_U);function wD(e,r){return e.id<r.id?-1:e.id>r.id?1:0}var yp=(e,r)=>r,jp=(e,r,n)=>n,QU=me(Vf,yp,jp,(e,r,n)=>e.filter(a=>a.orientation===r).filter(a=>a.mirror===n).sort(wD)),YU=me(Qf,yp,jp,(e,r,n)=>e.filter(a=>a.orientation===r).filter(a=>a.mirror===n).sort(wD)),CD=(e,r)=>({width:e.width,height:r.height}),KU=(e,r)=>{var n=typeof r.width=="number"?r.width:vu;return{width:n,height:e.height}},ED=me(Nr,hi,CD),WU=(e,r,n)=>{switch(r){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}},XU=(e,r,n)=>{switch(r){case"left":return e.left;case"right":return n-e.right;default:return 0}},ZU=me(mi,Nr,QU,yp,jp,(e,r,n,a,l)=>{var o={},u;return n.forEach(d=>{var m=CD(r,d);u==null&&(u=WU(r,a,e));var p=a==="top"&&!l||a==="bottom"&&l;o[d.id]=u-Number(p)*m.height,u+=(p?-1:1)*m.height}),o}),JU=me(di,Nr,YU,yp,jp,(e,r,n,a,l)=>{var o={},u;return n.forEach(d=>{var m=KU(r,d);u==null&&(u=XU(r,a,e));var p=a==="left"&&!l||a==="right"&&l;o[d.id]=u-Number(p)*m.width,u+=(p?-1:1)*m.width}),o}),eF=(e,r)=>{var n=hi(e,r);if(n!=null)return ZU(e,n.orientation,n.mirror)},tF=me([Nr,hi,eF,(e,r)=>r],(e,r,n,a)=>{if(r!=null){var l=n?.[a];return l==null?{x:e.left,y:0}:{x:e.left,y:l}}}),rF=(e,r)=>{var n=vi(e,r);if(n!=null)return JU(e,n.orientation,n.mirror)},nF=me([Nr,vi,rF,(e,r)=>r],(e,r,n,a)=>{if(r!=null){var l=n?.[a];return l==null?{x:0,y:e.top}:{x:l,y:e.top}}}),AD=me(Nr,vi,(e,r)=>{var n=typeof r.width=="number"?r.width:vu;return{width:n,height:e.height}}),C2=(e,r,n)=>{switch(r){case"xAxis":return ED(e,n).width;case"yAxis":return AD(e,n).height;default:return}},zD=(e,r,n,a)=>{if(n!=null){var{allowDuplicatedCategory:l,type:o,dataKey:u}=n,d=ui(e,a),m=r.map(p=>p.value);if(u&&d&&o==="category"&&l&&Ez(m))return m}},lj=me([jt,xp,Yr,wr],zD),kD=(e,r,n,a)=>{if(!(n==null||n.dataKey==null)){var{type:l,scale:o}=n,u=ui(e,a);if(u&&(l==="number"||o!=="auto"))return r.map(d=>d.value)}},oj=me([jt,xp,Nu,wr],kD),E2=me([jt,pU,ko,bp,lj,oj,Cu,sj,wr],(e,r,n,a,l,o,u,d,m)=>{if(r!=null){var p=ui(e,m);return{angle:r.angle,interval:r.interval,minTickGap:r.minTickGap,orientation:r.orientation,tick:r.tick,tickCount:r.tickCount,tickFormatter:r.tickFormatter,ticks:r.ticks,type:r.type,unit:r.unit,axisType:m,categoricalDomain:o,duplicateDomain:l,isCategorical:p,niceTicks:d,range:u,realScaleType:n,scale:a}}}),aF=(e,r,n,a,l,o,u,d,m)=>{if(!(r==null||a==null)){var p=ui(e,m),{type:h,ticks:v,tickCount:b}=r,x=n==="scaleBand"&&typeof a.bandwidth=="function"?a.bandwidth()/2:2,j=h==="category"&&a.bandwidth?a.bandwidth()/x:0;j=m==="angleAxis"&&o!=null&&o.length>=2?nn(o[0]-o[1])*2*j:j;var _=v||l;return _?_.map((w,C)=>{var E=u?u.indexOf(w):w,S=a.map(E);return ut(S)?{index:C,coordinate:S+j,value:w,offset:j}:null}).filter(an):p&&d?d.map((w,C)=>{var E=a.map(w);return ut(E)?{coordinate:E+j,value:w,index:C,offset:j}:null}).filter(an):a.ticks?a.ticks(b).map((w,C)=>{var E=a.map(w);return ut(E)?{coordinate:E+j,value:w,index:C,offset:j}:null}).filter(an):a.domain().map((w,C)=>{var E=a.map(w);return ut(E)?{coordinate:E+j,value:u?u[w]:w,index:C,offset:j}:null}).filter(an)}},OD=me([jt,Nu,ko,bp,sj,Cu,lj,oj,wr],aF),iF=(e,r,n,a,l,o,u)=>{if(!(r==null||n==null||a==null||a[0]===a[1])){var d=ui(e,u),{tickCount:m}=r,p=0;return p=u==="angleAxis"&&a?.length>=2?nn(a[0]-a[1])*2*p:p,d&&o?o.map((h,v)=>{var b=n.map(h);return ut(b)?{coordinate:b+p,value:h,index:v,offset:p}:null}).filter(an):n.ticks?n.ticks(m).map((h,v)=>{var b=n.map(h);return ut(b)?{coordinate:b+p,value:h,index:v,offset:p}:null}).filter(an):n.domain().map((h,v)=>{var b=n.map(h);return ut(b)?{coordinate:b+p,value:l?l[h]:h,index:v,offset:p}:null}).filter(an)}},as=me([jt,Nu,bp,Cu,lj,oj,wr],iF),is=me(Yr,bp,(e,r)=>{if(!(e==null||r==null))return uf(uf({},e),{},{scale:r})}),sF=me([Yr,ko,aj,SD],ij);me((e,r,n)=>ej(e,n),sF,(e,r)=>{if(!(e==null||r==null))return uf(uf({},e),{},{scale:r})});var lF=me([jt,Vf,Qf],(e,r,n)=>{switch(e){case"horizontal":return r.some(a=>a.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(a=>a.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),DD=e=>e.options.defaultTooltipEventType,PD=e=>e.options.validateTooltipEventTypes;function MD(e,r,n){if(e==null)return r;var a=e?"axis":"item";return n==null?r:n.includes(a)?a:r}function cj(e,r){var n=DD(e),a=PD(e);return MD(r,n,a)}function oF(e){return Be(r=>cj(r,e))}var TD=(e,r)=>{var n,a=Number(r);if(!(_a(a)||r==null))return a>=0?e==null||(n=e[a])===null||n===void 0?void 0:n.value:void 0},cF=e=>e.tooltip.settings,Ki={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},uF={itemInteraction:{click:Ki,hover:Ki},axisInteraction:{click:Ki,hover:Ki},keyboardInteraction:Ki,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},qD=ln({name:"tooltip",initialState:uF,reducers:{addTooltipEntrySettings:{reducer(e,r){e.tooltipItemPayloads.push(r.payload)},prepare:It()},replaceTooltipEntrySettings:{reducer(e,r){var{prev:n,next:a}=r.payload,l=ta(e).tooltipItemPayloads.indexOf(n);l>-1&&(e.tooltipItemPayloads[l]=a)},prepare:It()},removeTooltipEntrySettings:{reducer(e,r){var n=ta(e).tooltipItemPayloads.indexOf(r.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},prepare:It()},setTooltipSettingsState(e,r){e.settings=r.payload},setActiveMouseOverItemIndex(e,r){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=r.payload.activeIndex,e.itemInteraction.hover.dataKey=r.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=r.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=r.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,r){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=r.payload.activeIndex,e.itemInteraction.click.dataKey=r.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=r.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=r.payload.activeCoordinate},setMouseOverAxisIndex(e,r){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=r.payload.activeIndex,e.axisInteraction.hover.dataKey=r.payload.activeDataKey,e.axisInteraction.hover.coordinate=r.payload.activeCoordinate},setMouseClickAxisIndex(e,r){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=r.payload.activeIndex,e.axisInteraction.click.dataKey=r.payload.activeDataKey,e.axisInteraction.click.coordinate=r.payload.activeCoordinate},setSyncInteraction(e,r){e.syncInteraction=r.payload},setKeyboardInteraction(e,r){e.keyboardInteraction.active=r.payload.active,e.keyboardInteraction.index=r.payload.activeIndex,e.keyboardInteraction.coordinate=r.payload.activeCoordinate}}}),{addTooltipEntrySettings:dF,replaceTooltipEntrySettings:mF,removeTooltipEntrySettings:fF,setTooltipSettingsState:pF,setActiveMouseOverItemIndex:RD,mouseLeaveItem:hF,mouseLeaveChart:ID,setActiveClickItemIndex:vF,setMouseOverAxisIndex:LD,setMouseClickAxisIndex:gF,setSyncInteraction:Sb,setKeyboardInteraction:wb}=qD.actions,xF=qD.reducer;function A2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function im(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?A2(Object(n),!0).forEach(function(a){bF(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function bF(e,r,n){return(r=yF(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function yF(e){var r=jF(e,"string");return typeof r=="symbol"?r:r+""}function jF(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function _F(e,r,n){return r==="axis"?n==="click"?e.axisInteraction.click:e.axisInteraction.hover:n==="click"?e.itemInteraction.click:e.itemInteraction.hover}function NF(e){return e.index!=null}var $D=(e,r,n,a)=>{if(r==null)return Ki;var l=_F(e,r,n);if(l==null)return Ki;if(l.active)return l;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var o=e.settings.active===!0;if(NF(l)){if(o)return im(im({},l),{},{active:!0})}else if(a!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:a,graphicalItemId:void 0};return im(im({},Ki),{},{coordinate:l.coordinate})};function SF(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var r=e.valueOf();return Number.isFinite(r)?r:void 0}var n=Number(e);return Number.isFinite(n)?n:void 0}function wF(e,r){var n=SF(e),a=r[0],l=r[1];if(n===void 0)return!1;var o=Math.min(a,l),u=Math.max(a,l);return n>=o&&n<=u}function CF(e,r,n){if(n==null||r==null)return!0;var a=ir(e,r);return a==null||!ii(n)?!0:wF(a,n)}var uj=(e,r,n,a)=>{var l=e?.index;if(l==null)return null;var o=Number(l);if(!ut(o))return l;var u=0,d=1/0;r.length>0&&(d=r.length-1);var m=Math.max(u,Math.min(o,d)),p=r[m];return p==null||CF(p,n,a)?String(m):null},BD=(e,r,n,a,l,o,u)=>{if(o!=null){var d=u[0],m=d?.getPosition(o);if(m!=null)return m;var p=l?.[Number(o)];if(p)return n==="horizontal"?{x:p.coordinate,y:(a.top+r)/2}:{x:(a.left+e)/2,y:p.coordinate}}},UD=(e,r,n,a)=>{if(r==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var l;if(n==="hover"?l=e.itemInteraction.hover.graphicalItemId:l=e.itemInteraction.click.graphicalItemId,l==null&&a!=null){var o=e.tooltipItemPayloads[0];return o!=null?[o]:[]}return e.tooltipItemPayloads.filter(u=>{var d;return((d=u.settings)===null||d===void 0?void 0:d.graphicalItemId)===l})},FD=e=>e.options.tooltipPayloadSearcher,Oo=e=>e.tooltip;function z2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function k2(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?z2(Object(n),!0).forEach(function(a){EF(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function EF(e,r,n){return(r=AF(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function AF(e){var r=zF(e,"string");return typeof r=="symbol"?r:r+""}function zF(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function kF(e,r){return e??r}var GD=(e,r,n,a,l,o,u)=>{if(!(r==null||o==null)){var{chartData:d,computedData:m,dataStartIndex:p,dataEndIndex:h}=n,v=[];return e.reduce((b,x)=>{var j,{dataDefinedOnItem:_,settings:w}=x,C=kF(_,d),E=Array.isArray(C)?bk(C,p,h):C,S=(j=w?.dataKey)!==null&&j!==void 0?j:a,A=w?.nameKey,z;if(a&&Array.isArray(E)&&!Array.isArray(E[0])&&u==="axis"?z=Az(E,a,l):z=o(E,r,m,A),Array.isArray(z))z.forEach(P=>{var D=k2(k2({},w),{},{name:P.name,unit:P.unit,color:void 0,fill:void 0});b.push(zw({tooltipEntrySettings:D,dataKey:P.dataKey,payload:P.payload,value:ir(P.payload,P.dataKey),name:P.name}))});else{var k;b.push(zw({tooltipEntrySettings:w,dataKey:S,payload:z,value:ir(z,S),name:(k=ir(z,A))!==null&&k!==void 0?k:w?.name}))}return b},v)}},dj=me([dr,ZO,Qy],yD),OF=me([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,r)=>[...e,...r]),DF=me([Cr,Ao],JO),Do=me([OF,dr,DF],eD,{memoizeOptions:{resultEqualityCheck:vp}}),PF=me([Do],e=>e.filter(pp)),MF=me([Do],nD,{memoizeOptions:{resultEqualityCheck:vp}}),Po=me([MF,pi],aD),TF=me([PF,pi,dr],KO),mj=me([Po,dr,Do],iD),HD=me([dr],rj),qF=me([dr],e=>e.allowDataOverflow),VD=me([HD,qF],zO),RF=me([Do],e=>e.filter(pp)),IF=me([TF,RF,cp,UO],lD),LF=me([IF,pi,Cr,VD],oD),$F=me([Do],rD),BF=me([Po,dr,$F,nj,Cr],dD,{memoizeOptions:{resultEqualityCheck:hp}}),UF=me([mD,Cr,Ao],zo),FF=me([UF,Cr],hD),GF=me([fD,Cr,Ao],zo),HF=me([GF,Cr],vD),VF=me([pD,Cr,Ao],zo),QF=me([VF,Cr],gD),YF=me([FF,QF,HF],df),KF=me([dr,HD,VD,LF,BF,YF,jt,Cr],xD),Eu=me([dr,jt,Po,mj,cp,Cr,KF],bD),WF=me([Eu,dr,dj],jD),XF=me([dr,Eu,WF,Cr],_D),QD=e=>{var r=Cr(e),n=Ao(e),a=!1;return Cu(e,r,n,a)},YD=me([dr,QD],up),KD=me([dr,dj,XF,YD],ij),ZF=me([jt,mj,dr,Cr],zD),JF=me([jt,mj,dr,Cr],kD),eG=(e,r,n,a,l,o,u,d)=>{if(r){var{type:m}=r,p=ui(e,d);if(a){var h=n==="scaleBand"&&a.bandwidth?a.bandwidth()/2:2,v=m==="category"&&a.bandwidth?a.bandwidth()/h:0;return v=d==="angleAxis"&&l!=null&&l?.length>=2?nn(l[0]-l[1])*2*v:v,p&&u?u.map((b,x)=>{var j=a.map(b);return ut(j)?{coordinate:j+v,value:b,index:x,offset:v}:null}).filter(an):a.domain().map((b,x)=>{var j=a.map(b);return ut(j)?{coordinate:j+v,value:o?o[b]:b,index:x,offset:v}:null}).filter(an)}}},gi=me([jt,dr,dj,KD,QD,ZF,JF,Cr],eG),fj=me([DD,PD,cF],(e,r,n)=>MD(n.shared,e,r)),WD=e=>e.tooltip.settings.trigger,pj=e=>e.tooltip.settings.defaultIndex,Au=me([Oo,fj,WD,pj],$D),Zs=me([Au,Po,wu,Eu],uj),XD=me([gi,Zs],TD),ZD=me([Au],e=>{if(e)return e.dataKey});me([Au],e=>{if(e)return e.graphicalItemId});var JD=me([Oo,fj,WD,pj],UD),tG=me([di,mi,jt,Nr,gi,pj,JD],BD),rG=me([Au,tG],(e,r)=>e!=null&&e.coordinate?e.coordinate:r),nG=me([Au],e=>{var r;return(r=e?.active)!==null&&r!==void 0?r:!1}),aG=me([JD,Zs,pi,wu,XD,FD,fj],GD),iG=me([aG],e=>{if(e!=null){var r=e.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(r))}});function O2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function D2(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?O2(Object(n),!0).forEach(function(a){sG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function sG(e,r,n){return(r=lG(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function lG(e){var r=oG(e,"string");return typeof r=="symbol"?r:r+""}function oG(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var cG=()=>Be(dr),uG=()=>{var e=cG(),r=Be(gi),n=Be(KD);return xo(!e||!n?void 0:D2(D2({},e),{},{scale:n}),r)};function P2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function to(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?P2(Object(n),!0).forEach(function(a){dG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function dG(e,r,n){return(r=mG(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function mG(e){var r=fG(e,"string");return typeof r=="symbol"?r:r+""}function fG(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var pG=(e,r,n,a)=>{var l=r.find(o=>o&&o.index===n);if(l){if(e==="horizontal")return{x:l.coordinate,y:a.chartY};if(e==="vertical")return{x:a.chartX,y:l.coordinate}}return{x:0,y:0}},hG=(e,r,n,a)=>{var l=r.find(p=>p&&p.index===n);if(l){if(e==="centric"){var o=l.coordinate,{radius:u}=a;return to(to(to({},a),Mr(a.cx,a.cy,u,o)),{},{angle:o,radius:u})}var d=l.coordinate,{angle:m}=a;return to(to(to({},a),Mr(a.cx,a.cy,d,m)),{},{angle:m,radius:d})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function vG(e,r){var{chartX:n,chartY:a}=e;return n>=r.left&&n<=r.left+r.width&&a>=r.top&&a<=r.top+r.height}var eP=(e,r,n,a,l)=>{var o,u=(o=r?.length)!==null&&o!==void 0?o:0;if(u<=1||e==null)return 0;if(a==="angleAxis"&&l!=null&&Math.abs(Math.abs(l[1]-l[0])-360)<=1e-6)for(var d=0;d<u;d++){var m,p,h,v,b,x=d>0?(m=n[d-1])===null||m===void 0?void 0:m.coordinate:(p=n[u-1])===null||p===void 0?void 0:p.coordinate,j=(h=n[d])===null||h===void 0?void 0:h.coordinate,_=d>=u-1?(v=n[0])===null||v===void 0?void 0:v.coordinate:(b=n[d+1])===null||b===void 0?void 0:b.coordinate,w=void 0;if(!(x==null||j==null||_==null))if(nn(j-x)!==nn(_-j)){var C=[];if(nn(_-j)===nn(l[1]-l[0])){w=_;var E=j+l[1]-l[0];C[0]=Math.min(E,(E+x)/2),C[1]=Math.max(E,(E+x)/2)}else{w=x;var S=_+l[1]-l[0];C[0]=Math.min(j,(S+j)/2),C[1]=Math.max(j,(S+j)/2)}var A=[Math.min(j,(w+j)/2),Math.max(j,(w+j)/2)];if(e>A[0]&&e<=A[1]||e>=C[0]&&e<=C[1]){var z;return(z=n[d])===null||z===void 0?void 0:z.index}}else{var k=Math.min(x,_),P=Math.max(x,_);if(e>(k+j)/2&&e<=(P+j)/2){var D;return(D=n[d])===null||D===void 0?void 0:D.index}}}else if(r)for(var $=0;$<u;$++){var F=r[$];if(F!=null){var Y=r[$+1],M=r[$-1];if($===0&&Y!=null&&e<=(F.coordinate+Y.coordinate)/2||$===u-1&&M!=null&&e>(F.coordinate+M.coordinate)/2||$>0&&$<u-1&&M!=null&&Y!=null&&e>(F.coordinate+M.coordinate)/2&&e<=(F.coordinate+Y.coordinate)/2)return F.index}}return-1},gG=()=>Be(Qy),hj=(e,r)=>r,tP=(e,r,n)=>n,vj=(e,r,n,a)=>a,xG=me(gi,e=>Tf(e,r=>r.coordinate)),gj=me([Oo,hj,tP,vj],$D),xj=me([gj,Po,wu,Eu],uj),bG=(e,r,n)=>{if(r!=null){var a=Oo(e);return r==="axis"?n==="hover"?a.axisInteraction.hover.dataKey:a.axisInteraction.click.dataKey:n==="hover"?a.itemInteraction.hover.dataKey:a.itemInteraction.click.dataKey}},rP=me([Oo,hj,tP,vj],UD),mf=me([di,mi,jt,Nr,gi,vj,rP],BD),yG=me([gj,mf],(e,r)=>{var n;return(n=e.coordinate)!==null&&n!==void 0?n:r}),nP=me([gi,xj],TD),jG=me([rP,xj,pi,wu,nP,FD,hj],GD),_G=me([gj,xj],(e,r)=>({isActive:e.active&&r!=null,activeIndex:r})),NG=(e,r,n,a,l,o,u)=>{if(!(!e||!n||!a||!l)&&vG(e,u)){var d=JL(e,r),m=eP(d,o,l,n,a),p=pG(r,l,m,e);return{activeIndex:String(m),activeCoordinate:p}}},SG=(e,r,n,a,l,o,u)=>{if(!(!e||!a||!l||!o||!n)){var d=l7(e,n);if(d){var m=e8(d,r),p=eP(m,u,o,a,l),h=hG(r,o,p,d);return{activeIndex:String(p),activeCoordinate:h}}}},wG=(e,r,n,a,l,o,u,d)=>{if(!(!e||!r||!a||!l||!o))return r==="horizontal"||r==="vertical"?NG(e,r,a,l,o,u,d):SG(e,r,n,a,l,o,u)},CG=me(e=>e.zIndex.zIndexMap,(e,r)=>r,(e,r,n)=>n,(e,r,n)=>{if(r!=null){var a=e[r];if(a!=null)return n?a.panoramaElement:a.element}}),EG=me(e=>e.zIndex.zIndexMap,e=>{var r=Object.keys(e).map(a=>parseInt(a,10)).concat(Object.values(_r)),n=Array.from(new Set(r));return n.sort((a,l)=>a-l)},{memoizeOptions:{resultEqualityCheck:lU}});function M2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function T2(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?M2(Object(n),!0).forEach(function(a){AG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function AG(e,r,n){return(r=zG(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function zG(e){var r=kG(e,"string");return typeof r=="symbol"?r:r+""}function kG(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var OG={},DG={zIndexMap:Object.values(_r).reduce((e,r)=>T2(T2({},e),{},{[r]:{element:void 0,panoramaElement:void 0,consumers:0}}),OG)},PG=new Set(Object.values(_r));function MG(e){return PG.has(e)}var aP=ln({name:"zIndex",initialState:DG,reducers:{registerZIndexPortal:{reducer:(e,r)=>{var{zIndex:n}=r.payload;e.zIndexMap[n]?e.zIndexMap[n].consumers+=1:e.zIndexMap[n]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:It()},unregisterZIndexPortal:{reducer:(e,r)=>{var{zIndex:n}=r.payload;e.zIndexMap[n]&&(e.zIndexMap[n].consumers-=1,e.zIndexMap[n].consumers<=0&&!MG(n)&&delete e.zIndexMap[n])},prepare:It()},registerZIndexPortalElement:{reducer:(e,r)=>{var{zIndex:n,element:a,isPanorama:l}=r.payload;e.zIndexMap[n]?l?e.zIndexMap[n].panoramaElement=a:e.zIndexMap[n].element=a:e.zIndexMap[n]={consumers:0,element:l?void 0:a,panoramaElement:l?a:void 0}},prepare:It()},unregisterZIndexPortalElement:{reducer:(e,r)=>{var{zIndex:n}=r.payload;e.zIndexMap[n]&&(r.payload.isPanorama?e.zIndexMap[n].panoramaElement=void 0:e.zIndexMap[n].element=void 0)},prepare:It()}}}),{registerZIndexPortal:TG,unregisterZIndexPortal:qG,registerZIndexPortalElement:RG,unregisterZIndexPortalElement:IG}=aP.actions,LG=aP.reducer;function Vn(e){var{zIndex:r,children:n}=e,a=D8(),l=a&&r!==void 0&&r!==0,o=Lr(),u=Zt();g.useLayoutEffect(()=>l?(u(TG({zIndex:r})),()=>{u(qG({zIndex:r}))}):al,[u,r,l]);var d=Be(m=>CG(m,r,o));return l?d?CA.createPortal(n,d):null:n}function Cb(){return Cb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Cb.apply(null,arguments)}function q2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function sm(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?q2(Object(n),!0).forEach(function(a){$G(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function $G(e,r,n){return(r=BG(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function BG(e){var r=UG(e,"string");return typeof r=="symbol"?r:r+""}function UG(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function FG(e){var{cursor:r,cursorComp:n,cursorProps:a}=e;return g.isValidElement(r)?g.cloneElement(r,a):g.createElement(n,a)}function GG(e){var r,{coordinate:n,payload:a,index:l,offset:o,tooltipAxisBandSize:u,layout:d,cursor:m,tooltipEventType:p,chartName:h}=e,v=n,b=a,x=l;if(!m||!v||h!=="ScatterChart"&&p!=="axis")return null;var j,_,w;if(h==="ScatterChart")j=v,_=y$,w=_r.cursorLine;else if(h==="BarChart")j=j$(d,v,o,u),_=Gk,w=_r.cursorRectangle;else if(d==="radial"&&Oz(v)){var{cx:C,cy:E,radius:S,startAngle:A,endAngle:z}=Hk(v);j={cx:C,cy:E,startAngle:A,endAngle:z,innerRadius:S,outerRadius:S},_=Qk,w=_r.cursorLine}else j={points:d7(d,v,o)},_=Lk,w=_r.cursorLine;var k=typeof m=="object"&&"className"in m?m.className:void 0,P=sm(sm(sm(sm({stroke:"#ccc",pointerEvents:"none"},o),j),mu(m)),{},{payload:b,payloadIndex:x,className:Ct("recharts-tooltip-cursor",k)});return g.createElement(Vn,{zIndex:(r=e.zIndex)!==null&&r!==void 0?r:w},g.createElement(FG,{cursor:m,cursorComp:_,cursorProps:P}))}function HG(e){var r=uG(),n=Ck(),a=il(),l=gG();return r==null||n==null||a==null||l==null?null:g.createElement(GG,Cb({},e,{offset:n,layout:a,tooltipAxisBandSize:r,chartName:l}))}var iP=g.createContext(null),VG=()=>g.useContext(iP),vx={exports:{}},R2;function QG(){return R2||(R2=1,(function(e){var r=Object.prototype.hasOwnProperty,n="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(n=!1));function l(m,p,h){this.fn=m,this.context=p,this.once=h||!1}function o(m,p,h,v,b){if(typeof h!="function")throw new TypeError("The listener must be a function");var x=new l(h,v||m,b),j=n?n+p:p;return m._events[j]?m._events[j].fn?m._events[j]=[m._events[j],x]:m._events[j].push(x):(m._events[j]=x,m._eventsCount++),m}function u(m,p){--m._eventsCount===0?m._events=new a:delete m._events[p]}function d(){this._events=new a,this._eventsCount=0}d.prototype.eventNames=function(){var p=[],h,v;if(this._eventsCount===0)return p;for(v in h=this._events)r.call(h,v)&&p.push(n?v.slice(1):v);return Object.getOwnPropertySymbols?p.concat(Object.getOwnPropertySymbols(h)):p},d.prototype.listeners=function(p){var h=n?n+p:p,v=this._events[h];if(!v)return[];if(v.fn)return[v.fn];for(var b=0,x=v.length,j=new Array(x);b<x;b++)j[b]=v[b].fn;return j},d.prototype.listenerCount=function(p){var h=n?n+p:p,v=this._events[h];return v?v.fn?1:v.length:0},d.prototype.emit=function(p,h,v,b,x,j){var _=n?n+p:p;if(!this._events[_])return!1;var w=this._events[_],C=arguments.length,E,S;if(w.fn){switch(w.once&&this.removeListener(p,w.fn,void 0,!0),C){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,h),!0;case 3:return w.fn.call(w.context,h,v),!0;case 4:return w.fn.call(w.context,h,v,b),!0;case 5:return w.fn.call(w.context,h,v,b,x),!0;case 6:return w.fn.call(w.context,h,v,b,x,j),!0}for(S=1,E=new Array(C-1);S<C;S++)E[S-1]=arguments[S];w.fn.apply(w.context,E)}else{var A=w.length,z;for(S=0;S<A;S++)switch(w[S].once&&this.removeListener(p,w[S].fn,void 0,!0),C){case 1:w[S].fn.call(w[S].context);break;case 2:w[S].fn.call(w[S].context,h);break;case 3:w[S].fn.call(w[S].context,h,v);break;case 4:w[S].fn.call(w[S].context,h,v,b);break;default:if(!E)for(z=1,E=new Array(C-1);z<C;z++)E[z-1]=arguments[z];w[S].fn.apply(w[S].context,E)}}return!0},d.prototype.on=function(p,h,v){return o(this,p,h,v,!1)},d.prototype.once=function(p,h,v){return o(this,p,h,v,!0)},d.prototype.removeListener=function(p,h,v,b){var x=n?n+p:p;if(!this._events[x])return this;if(!h)return u(this,x),this;var j=this._events[x];if(j.fn)j.fn===h&&(!b||j.once)&&(!v||j.context===v)&&u(this,x);else{for(var _=0,w=[],C=j.length;_<C;_++)(j[_].fn!==h||b&&!j[_].once||v&&j[_].context!==v)&&w.push(j[_]);w.length?this._events[x]=w.length===1?w[0]:w:u(this,x)}return this},d.prototype.removeAllListeners=function(p){var h;return p?(h=n?n+p:p,this._events[h]&&u(this,h)):(this._events=new a,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=n,d.EventEmitter=d,e.exports=d})(vx)),vx.exports}var YG=QG();const KG=oi(YG);var su=new KG,Eb="recharts.syncEvent.tooltip",I2="recharts.syncEvent.brush",sP=(e,r)=>{if(r&&Array.isArray(e)){var n=Number.parseInt(r,10);if(!_a(n))return e[n]}},WG={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},lP=ln({name:"options",initialState:WG,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),XG=lP.reducer,{createEventEmitter:ZG}=lP.actions;function JG(e){return e.tooltip.syncInteraction}var eH={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},oP=ln({name:"chartData",initialState:eH,reducers:{setChartData(e,r){if(e.chartData=r.payload,r.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}r.payload.length>0&&e.dataEndIndex!==r.payload.length-1&&(e.dataEndIndex=r.payload.length-1)},setComputedData(e,r){e.computedData=r.payload},setDataStartEndIndexes(e,r){var{startIndex:n,endIndex:a}=r.payload;n!=null&&(e.dataStartIndex=n),a!=null&&(e.dataEndIndex=a)}}}),{setChartData:L2,setDataStartEndIndexes:tH,setComputedData:fre}=oP.actions,rH=oP.reducer,nH=["x","y"];function $2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function ro(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?$2(Object(n),!0).forEach(function(a){aH(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function aH(e,r,n){return(r=iH(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function iH(e){var r=sH(e,"string");return typeof r=="symbol"?r:r+""}function sH(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function lH(e,r){if(e==null)return{};var n,a,l=oH(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function oH(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function cH(){var e=Be(Yy),r=Be(Ky),n=Zt(),a=Be(FO),l=Be(gi),o=il(),u=Wf(),d=Be(m=>m.rootProps.className);g.useEffect(()=>{if(e==null)return al;var m=(p,h,v)=>{if(r!==v&&e===p){if(a==="index"){var b;if(u&&h!==null&&h!==void 0&&(b=h.payload)!==null&&b!==void 0&&b.coordinate&&h.payload.sourceViewBox){var x=h.payload.coordinate,{x:j,y:_}=x,w=lH(x,nH),{x:C,y:E,width:S,height:A}=h.payload.sourceViewBox,z=ro(ro({},w),{},{x:u.x+(S?(j-C)/S:0)*u.width,y:u.y+(A?(_-E)/A:0)*u.height});n(ro(ro({},h),{},{payload:ro(ro({},h.payload),{},{coordinate:z})}))}else n(h);return}if(l!=null){var k;if(typeof a=="function"){var P={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},D=a(l,P);k=l[D]}else a==="value"&&(k=l.find(L=>String(L.value)===h.payload.label));var{coordinate:$}=h.payload;if(k==null||h.payload.active===!1||$==null||u==null){n(Sb({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:F,y:Y}=$,M=Math.min(F,u.x+u.width),K=Math.min(Y,u.y+u.height),ee={x:o==="horizontal"?k.coordinate:M,y:o==="horizontal"?K:k.coordinate},X=Sb({active:h.payload.active,coordinate:ee,dataKey:h.payload.dataKey,index:String(k.index),label:h.payload.label,sourceViewBox:h.payload.sourceViewBox,graphicalItemId:h.payload.graphicalItemId});n(X)}}};return su.on(Eb,m),()=>{su.off(Eb,m)}},[d,n,r,e,a,l,o,u])}function uH(){var e=Be(Yy),r=Be(Ky),n=Zt();g.useEffect(()=>{if(e==null)return al;var a=(l,o,u)=>{r!==u&&e===l&&n(tH(o))};return su.on(I2,a),()=>{su.off(I2,a)}},[n,r,e])}function dH(){var e=Zt();g.useEffect(()=>{e(ZG())},[e]),cH(),uH()}function mH(e,r,n,a,l,o){var u=Be(x=>bG(x,e,r)),d=Be(Ky),m=Be(Yy),p=Be(FO),h=Be(JG),v=h?.active,b=Wf();g.useEffect(()=>{if(!v&&m!=null&&d!=null){var x=Sb({active:o,coordinate:n,dataKey:u,index:l,label:typeof a=="number"?String(a):a,sourceViewBox:b,graphicalItemId:void 0});su.emit(Eb,m,x,d)}},[v,n,u,l,a,d,m,p,o,b])}function B2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function U2(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?B2(Object(n),!0).forEach(function(a){fH(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function fH(e,r,n){return(r=pH(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function pH(e){var r=hH(e,"string");return typeof r=="symbol"?r:r+""}function hH(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function vH(e){return e.dataKey}function gH(e,r){return g.isValidElement(e)?g.cloneElement(e,r):typeof e=="function"?g.createElement(e,r):g.createElement(J8,r)}var F2=[],xH={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function G2(e){var r,n,a=Qr(e,xH),{active:l,allowEscapeViewBox:o,animationDuration:u,animationEasing:d,content:m,filterNull:p,isAnimationActive:h,offset:v,payloadUniqBy:b,position:x,reverseDirection:j,useTranslate3d:_,wrapperStyle:w,cursor:C,shared:E,trigger:S,defaultIndex:A,portal:z,axisId:k}=a,P=Zt(),D=typeof A=="number"?String(A):A;g.useEffect(()=>{P(pF({shared:E,trigger:S,axisId:k,active:l,defaultIndex:D}))},[P,E,S,k,l,D]);var $=Wf(),F=Ik(),Y=oF(E),{activeIndex:M,isActive:K}=(r=Be(ve=>_G(ve,Y,S,D)))!==null&&r!==void 0?r:{},ee=Be(ve=>jG(ve,Y,S,D)),X=Be(ve=>nP(ve,Y,S,D)),L=Be(ve=>yG(ve,Y,S,D)),I=ee,U=VG(),B=(n=l??K)!==null&&n!==void 0?n:!1,[T,Z]=I4([I,B]),H=Y==="axis"?X:void 0;mH(Y,S,L,H,M,B);var ce=z??U;if(ce==null||$==null||Y==null)return null;var xe=I??F2;B||(xe=F2),p&&xe.length&&(xe=u4(xe.filter(ve=>ve.value!=null&&(ve.hide!==!0||a.includeHidden)),b,vH));var fe=xe.length>0,G=g.createElement(s$,{allowEscapeViewBox:o,animationDuration:u,animationEasing:d,isAnimationActive:h,active:B,coordinate:L,hasPayload:fe,offset:v,position:x,reverseDirection:j,useTranslate3d:_,viewBox:$,wrapperStyle:w,lastBoundingBox:T,innerRef:Z,hasPortalFromProps:!!z},gH(m,U2(U2({},a),{},{payload:xe,label:H,active:B,activeIndex:M,coordinate:L,accessibilityLayer:F})));return g.createElement(g.Fragment,null,CA.createPortal(G,ce),B&&g.createElement(HG,{cursor:C,tooltipEventType:Y,coordinate:L,payload:xe,index:M}))}var bj=e=>null;bj.displayName="Cell";function bH(e,r,n){return(r=yH(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function yH(e){var r=jH(e,"string");return typeof r=="symbol"?r:r+""}function jH(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}class _H{constructor(r){bH(this,"cache",new Map),this.maxSize=r}get(r){var n=this.cache.get(r);return n!==void 0&&(this.cache.delete(r),this.cache.set(r,n)),n}set(r,n){if(this.cache.has(r))this.cache.delete(r);else if(this.cache.size>=this.maxSize){var a=this.cache.keys().next().value;a!=null&&this.cache.delete(a)}this.cache.set(r,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function H2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function NH(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?H2(Object(n),!0).forEach(function(a){SH(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function SH(e,r,n){return(r=wH(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function wH(e){var r=CH(e,"string");return typeof r=="symbol"?r:r+""}function CH(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var EH={cacheSize:2e3,enableCache:!0},cP=NH({},EH),V2=new _H(cP.cacheSize),AH={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Q2="recharts_measurement_span";function zH(e,r){var n=r.fontSize||"",a=r.fontFamily||"",l=r.fontWeight||"",o=r.fontStyle||"",u=r.letterSpacing||"",d=r.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(a,"|").concat(l,"|").concat(o,"|").concat(u,"|").concat(d)}var Y2=(e,r)=>{try{var n=document.getElementById(Q2);n||(n=document.createElement("span"),n.setAttribute("id",Q2),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,AH,r),n.textContent="".concat(e);var a=n.getBoundingClientRect();return{width:a.width,height:a.height}}catch{return{width:0,height:0}}},Fc=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r==null||ep.isSsr)return{width:0,height:0};if(!cP.enableCache)return Y2(r,n);var a=zH(r,n),l=V2.get(a);if(l)return l;var o=Y2(r,n);return V2.set(a,o),o},uP;function kH(e,r,n){return(r=OH(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function OH(e){var r=DH(e,"string");return typeof r=="symbol"?r:r+""}function DH(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var K2=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,W2=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,PH=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,MH=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,TH={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},qH=["cm","mm","pt","pc","in","Q","px"];function RH(e){return qH.includes(e)}var oo="NaN";function IH(e,r){return e*TH[r]}class Pr{static parse(r){var n,[,a,l]=(n=MH.exec(r))!==null&&n!==void 0?n:[];return a==null?Pr.NaN:new Pr(parseFloat(a),l??"")}constructor(r,n){this.num=r,this.unit=n,this.num=r,this.unit=n,_a(r)&&(this.unit=""),n!==""&&!PH.test(n)&&(this.num=NaN,this.unit=""),RH(n)&&(this.num=IH(r,n),this.unit="px")}add(r){return this.unit!==r.unit?new Pr(NaN,""):new Pr(this.num+r.num,this.unit)}subtract(r){return this.unit!==r.unit?new Pr(NaN,""):new Pr(this.num-r.num,this.unit)}multiply(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new Pr(NaN,""):new Pr(this.num*r.num,this.unit||r.unit)}divide(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new Pr(NaN,""):new Pr(this.num/r.num,this.unit||r.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return _a(this.num)}}uP=Pr;kH(Pr,"NaN",new uP(NaN,""));function dP(e){if(e==null||e.includes(oo))return oo;for(var r=e;r.includes("*")||r.includes("/");){var n,[,a,l,o]=(n=K2.exec(r))!==null&&n!==void 0?n:[],u=Pr.parse(a??""),d=Pr.parse(o??""),m=l==="*"?u.multiply(d):u.divide(d);if(m.isNaN())return oo;r=r.replace(K2,m.toString())}for(;r.includes("+")||/.-\d+(?:\.\d+)?/.test(r);){var p,[,h,v,b]=(p=W2.exec(r))!==null&&p!==void 0?p:[],x=Pr.parse(h??""),j=Pr.parse(b??""),_=v==="+"?x.add(j):x.subtract(j);if(_.isNaN())return oo;r=r.replace(W2,_.toString())}return r}var X2=/\(([^()]*)\)/;function LH(e){for(var r=e,n;(n=X2.exec(r))!=null;){var[,a]=n;r=r.replace(X2,dP(a))}return r}function $H(e){var r=e.replace(/\s+/g,"");return r=LH(r),r=dP(r),r}function BH(e){try{return $H(e)}catch{return oo}}function gx(e){var r=BH(e.slice(5,-1));return r===oo?"":r}var UH=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],FH=["dx","dy","angle","className","breakAll"];function Ab(){return Ab=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ab.apply(null,arguments)}function Z2(e,r){if(e==null)return{};var n,a,l=GH(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function GH(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var mP=/[ \f\n\r\t\v\u2028\u2029]+/,fP=e=>{var{children:r,breakAll:n,style:a}=e;try{var l=[];Bt(r)||(n?l=r.toString().split(""):l=r.toString().split(mP));var o=l.map(d=>({word:d,width:Fc(d,a).width})),u=n?0:Fc("",a).width;return{wordsWithComputedWidth:o,spaceWidth:u}}catch{return null}};function HH(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var pP=(e,r,n,a)=>e.reduce((l,o)=>{var{word:u,width:d}=o,m=l[l.length-1];if(m&&d!=null&&(r==null||a||m.width+d+n<Number(r)))m.words.push(u),m.width+=d+n;else{var p={words:[u],width:d};l.push(p)}return l},[]),hP=e=>e.reduce((r,n)=>r.width>n.width?r:n),VH="",J2=(e,r,n,a,l,o,u,d)=>{var m=e.slice(0,r),p=fP({breakAll:n,style:a,children:m+VH});if(!p)return[!1,[]];var h=pP(p.wordsWithComputedWidth,o,u,d),v=h.length>l||hP(h).width>Number(o);return[v,h]},QH=(e,r,n,a,l)=>{var{maxLines:o,children:u,style:d,breakAll:m}=e,p=qe(o),h=String(u),v=pP(r,a,n,l);if(!p||l)return v;var b=v.length>o||hP(v).width>Number(a);if(!b)return v;for(var x=0,j=h.length-1,_=0,w;x<=j&&_<=h.length-1;){var C=Math.floor((x+j)/2),E=C-1,[S,A]=J2(h,E,m,d,o,a,n,l),[z]=J2(h,C,m,d,o,a,n,l);if(!S&&!z&&(x=C+1),S&&z&&(j=C-1),!S&&z){w=A;break}_++}return w||v},eE=e=>{var r=Bt(e)?[]:e.toString().split(mP);return[{words:r,width:void 0}]},YH=e=>{var{width:r,scaleToFit:n,children:a,style:l,breakAll:o,maxLines:u}=e;if((r||n)&&!ep.isSsr){var d,m,p=fP({breakAll:o,children:a,style:l});if(p){var{wordsWithComputedWidth:h,spaceWidth:v}=p;d=h,m=v}else return eE(a);return QH({breakAll:o,children:a,maxLines:u,style:l},d,m,r,!!n)}return eE(a)},vP="#808080",KH={angle:0,breakAll:!1,capHeight:"0.71em",fill:vP,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},yj=g.forwardRef((e,r)=>{var n=Qr(e,KH),{x:a,y:l,lineHeight:o,capHeight:u,fill:d,scaleToFit:m,textAnchor:p,verticalAnchor:h}=n,v=Z2(n,UH),b=g.useMemo(()=>YH({breakAll:v.breakAll,children:v.children,maxLines:v.maxLines,scaleToFit:m,style:v.style,width:v.width}),[v.breakAll,v.children,v.maxLines,m,v.style,v.width]),{dx:x,dy:j,angle:_,className:w,breakAll:C}=v,E=Z2(v,FH);if(!Na(a)||!Na(l)||b.length===0)return null;var S=Number(a)+(qe(x)?x:0),A=Number(l)+(qe(j)?j:0);if(!ut(S)||!ut(A))return null;var z;switch(h){case"start":z=gx("calc(".concat(u,")"));break;case"middle":z=gx("calc(".concat((b.length-1)/2," * -").concat(o," + (").concat(u," / 2))"));break;default:z=gx("calc(".concat(b.length-1," * -").concat(o,")"));break}var k=[],P=b[0];if(m&&P!=null){var D=P.width,{width:$}=v;k.push("scale(".concat(qe($)&&qe(D)?$/D:1,")"))}return _&&k.push("rotate(".concat(_,", ").concat(S,", ").concat(A,")")),k.length&&(E.transform=k.join(" ")),g.createElement("text",Ab({},Hr(E),{ref:r,x:S,y:A,className:Ct("recharts-text",w),textAnchor:p,fill:d.includes("url")?vP:d}),b.map((F,Y)=>{var M=F.words.join(C?"":" ");return g.createElement("tspan",{x:S,dy:Y===0?z:o,key:"".concat(M,"-").concat(Y)},M)}))});yj.displayName="Text";function tE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function pa(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?tE(Object(n),!0).forEach(function(a){WH(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function WH(e,r,n){return(r=XH(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function XH(e){var r=ZH(e,"string");return typeof r=="symbol"?r:r+""}function ZH(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var JH=e=>{var{viewBox:r,position:n,offset:a=0,parentViewBox:l}=e,{x:o,y:u,height:d,upperWidth:m,lowerWidth:p}=xy(r),h=o,v=o+(m-p)/2,b=(h+v)/2,x=(m+p)/2,j=h+m/2,_=d>=0?1:-1,w=_*a,C=_>0?"end":"start",E=_>0?"start":"end",S=m>=0?1:-1,A=S*a,z=S>0?"end":"start",k=S>0?"start":"end",P=l;if(n==="top"){var D={x:h+m/2,y:u-w,horizontalAnchor:"middle",verticalAnchor:C};return P&&(D.height=Math.max(u-P.y,0),D.width=m),D}if(n==="bottom"){var $={x:v+p/2,y:u+d+w,horizontalAnchor:"middle",verticalAnchor:E};return P&&($.height=Math.max(P.y+P.height-(u+d),0),$.width=p),$}if(n==="left"){var F={x:b-A,y:u+d/2,horizontalAnchor:z,verticalAnchor:"middle"};return P&&(F.width=Math.max(F.x-P.x,0),F.height=d),F}if(n==="right"){var Y={x:b+x+A,y:u+d/2,horizontalAnchor:k,verticalAnchor:"middle"};return P&&(Y.width=Math.max(P.x+P.width-Y.x,0),Y.height=d),Y}var M=P?{width:x,height:d}:{};return n==="insideLeft"?pa({x:b+A,y:u+d/2,horizontalAnchor:k,verticalAnchor:"middle"},M):n==="insideRight"?pa({x:b+x-A,y:u+d/2,horizontalAnchor:z,verticalAnchor:"middle"},M):n==="insideTop"?pa({x:h+m/2,y:u+w,horizontalAnchor:"middle",verticalAnchor:E},M):n==="insideBottom"?pa({x:v+p/2,y:u+d-w,horizontalAnchor:"middle",verticalAnchor:C},M):n==="insideTopLeft"?pa({x:h+A,y:u+w,horizontalAnchor:k,verticalAnchor:E},M):n==="insideTopRight"?pa({x:h+m-A,y:u+w,horizontalAnchor:z,verticalAnchor:E},M):n==="insideBottomLeft"?pa({x:v+A,y:u+d-w,horizontalAnchor:k,verticalAnchor:C},M):n==="insideBottomRight"?pa({x:v+p-A,y:u+d-w,horizontalAnchor:z,verticalAnchor:C},M):n&&typeof n=="object"&&(qe(n.x)||Qs(n.x))&&(qe(n.y)||Qs(n.y))?pa({x:o+na(n.x,x),y:u+na(n.y,d),horizontalAnchor:"end",verticalAnchor:"end"},M):pa({x:j,y:u+d/2,horizontalAnchor:"middle",verticalAnchor:"middle"},M)},eV=["labelRef"],tV=["content"];function rE(e,r){if(e==null)return{};var n,a,l=rV(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function rV(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function nE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Bc(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?nE(Object(n),!0).forEach(function(a){nV(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function nV(e,r,n){return(r=aV(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function aV(e){var r=iV(e,"string");return typeof r=="symbol"?r:r+""}function iV(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Ya(){return Ya=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ya.apply(null,arguments)}var gP=g.createContext(null),sV=e=>{var{x:r,y:n,upperWidth:a,lowerWidth:l,width:o,height:u,children:d}=e,m=g.useMemo(()=>({x:r,y:n,upperWidth:a,lowerWidth:l,width:o,height:u}),[r,n,a,l,o,u]);return g.createElement(gP.Provider,{value:m},d)},xP=()=>{var e=g.useContext(gP),r=Wf();return e||(r?xy(r):void 0)},lV=g.createContext(null),oV=()=>{var e=g.useContext(lV),r=Be(YO);return e||r},cV=e=>{var{value:r,formatter:n}=e,a=Bt(e.children)?r:e.children;return typeof n=="function"?n(a):a},jj=e=>e!=null&&typeof e=="function",uV=(e,r)=>{var n=nn(r-e),a=Math.min(Math.abs(r-e),360);return n*a},dV=(e,r,n,a,l)=>{var{offset:o,className:u}=e,{cx:d,cy:m,innerRadius:p,outerRadius:h,startAngle:v,endAngle:b,clockWise:x}=l,j=(p+h)/2,_=uV(v,b),w=_>=0?1:-1,C,E;switch(r){case"insideStart":C=v+w*o,E=x;break;case"insideEnd":C=b-w*o,E=!x;break;case"end":C=b+w*o,E=x;break;default:throw new Error("Unsupported position ".concat(r))}E=_<=0?E:!E;var S=Mr(d,m,j,C),A=Mr(d,m,j,C+(E?1:-1)*359),z="M".concat(S.x,",").concat(S.y,`
    A`).concat(j,",").concat(j,",0,1,").concat(E?0:1,`,
    `).concat(A.x,",").concat(A.y),k=Bt(e.id)?Qc("recharts-radial-line-"):e.id;return g.createElement("text",Ya({},a,{dominantBaseline:"central",className:Ct("recharts-radial-bar-label",u)}),g.createElement("defs",null,g.createElement("path",{id:k,d:z})),g.createElement("textPath",{xlinkHref:"#".concat(k)},n))},mV=(e,r,n)=>{var{cx:a,cy:l,innerRadius:o,outerRadius:u,startAngle:d,endAngle:m}=e,p=(d+m)/2;if(n==="outside"){var{x:h,y:v}=Mr(a,l,u+r,p);return{x:h,y:v,textAnchor:h>=a?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"end"};var b=(o+u)/2,{x,y:j}=Mr(a,l,b,p);return{x,y:j,textAnchor:"middle",verticalAnchor:"middle"}},xm=e=>e!=null&&"cx"in e&&qe(e.cx),fV={angle:0,offset:5,zIndex:_r.label,position:"middle",textBreakAll:!1};function pV(e){if(!xm(e))return e;var{cx:r,cy:n,outerRadius:a}=e,l=a*2;return{x:r-a,y:n-a,width:l,upperWidth:l,lowerWidth:l,height:l}}function Yi(e){var r=Qr(e,fV),{viewBox:n,parentViewBox:a,position:l,value:o,children:u,content:d,className:m="",textBreakAll:p,labelRef:h}=r,v=oV(),b=xP(),x=l==="center"?b:v??b,j,_,w;n==null?j=x:xm(n)?j=n:j=xy(n);var C=pV(j);if(!j||Bt(o)&&Bt(u)&&!g.isValidElement(d)&&typeof d!="function")return null;var E=Bc(Bc({},r),{},{viewBox:j});if(g.isValidElement(d)){var{labelRef:S}=E,A=rE(E,eV);return g.cloneElement(d,A)}if(typeof d=="function"){var{content:z}=E,k=rE(E,tV);if(_=g.createElement(d,k),g.isValidElement(_))return _}else _=cV(r);var P=Hr(r);if(xm(j)){if(l==="insideStart"||l==="insideEnd"||l==="end")return dV(r,l,_,P,j);w=mV(j,r.offset,r.position)}else{if(!C)return null;var D=JH({viewBox:C,position:l,offset:r.offset,parentViewBox:xm(a)?void 0:a});w=Bc(Bc({x:D.x,y:D.y,textAnchor:D.horizontalAnchor,verticalAnchor:D.verticalAnchor},D.width!==void 0?{width:D.width}:{}),D.height!==void 0?{height:D.height}:{})}return g.createElement(Vn,{zIndex:r.zIndex},g.createElement(yj,Ya({ref:h,className:Ct("recharts-label",m)},P,w,{textAnchor:HH(P.textAnchor)?P.textAnchor:w.textAnchor,breakAll:p}),_))}Yi.displayName="Label";var hV=(e,r,n)=>{if(!e)return null;var a={viewBox:r,labelRef:n};return e===!0?g.createElement(Yi,Ya({key:"label-implicit"},a)):Na(e)?g.createElement(Yi,Ya({key:"label-implicit",value:e},a)):g.isValidElement(e)?e.type===Yi?g.cloneElement(e,Bc({key:"label-implicit"},a)):g.createElement(Yi,Ya({key:"label-implicit",content:e},a)):jj(e)?g.createElement(Yi,Ya({key:"label-implicit",content:e},a)):e&&typeof e=="object"?g.createElement(Yi,Ya({},e,{key:"label-implicit"},a)):null};function vV(e){var{label:r,labelRef:n}=e,a=xP();return hV(r,a,n)||null}var xx={},bx={},aE;function gV(){return aE||(aE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return n[n.length-1]}e.last=r})(bx)),bx}var yx={},iE;function xV(){return iE||(iE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return Array.isArray(n)?n:Array.from(n)}e.toArray=r})(yx)),yx}var sE;function bV(){return sE||(sE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=gV(),n=xV(),a=ly();function l(o){if(a.isArrayLike(o))return r.last(n.toArray(o))}e.last=l})(xx)),xx}var jx,lE;function yV(){return lE||(lE=1,jx=bV().last),jx}var jV=yV();const _V=oi(jV);var NV=["valueAccessor"],SV=["dataKey","clockWise","id","textBreakAll","zIndex"];function ff(){return ff=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ff.apply(null,arguments)}function oE(e,r){if(e==null)return{};var n,a,l=wV(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function wV(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var CV=e=>Array.isArray(e.value)?_V(e.value):e.value,bP=g.createContext(void 0),yP=bP.Provider,jP=g.createContext(void 0);jP.Provider;function EV(){return g.useContext(bP)}function AV(){return g.useContext(jP)}function bm(e){var{valueAccessor:r=CV}=e,n=oE(e,NV),{dataKey:a,clockWise:l,id:o,textBreakAll:u,zIndex:d}=n,m=oE(n,SV),p=EV(),h=AV(),v=p||h;return!v||!v.length?null:g.createElement(Vn,{zIndex:d??_r.label},g.createElement($n,{className:"recharts-label-list"},v.map((b,x)=>{var j,_=Bt(a)?r(b,x):ir(b.payload,a),w=Bt(o)?{}:{id:"".concat(o,"-").concat(x)};return g.createElement(Yi,ff({key:"label-".concat(x)},Hr(b),m,w,{fill:(j=n.fill)!==null&&j!==void 0?j:b.fill,parentViewBox:b.parentViewBox,value:_,textBreakAll:u,viewBox:b.viewBox,index:x,zIndex:0}))})))}bm.displayName="LabelList";function _P(e){var{label:r}=e;return r?r===!0?g.createElement(bm,{key:"labelList-implicit"}):g.isValidElement(r)||jj(r)?g.createElement(bm,{key:"labelList-implicit",content:r}):typeof r=="object"?g.createElement(bm,ff({key:"labelList-implicit"},r,{type:String(r.type)})):null:null}function zb(){return zb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},zb.apply(null,arguments)}var NP=e=>{var{cx:r,cy:n,r:a,className:l}=e,o=Ct("recharts-dot",l);return qe(r)&&qe(n)&&qe(a)?g.createElement("circle",zb({},ra(e),iy(e),{className:o,cx:r,cy:n,r:a})):null},zV={radiusAxis:{},angleAxis:{}},SP=ln({name:"polarAxis",initialState:zV,reducers:{addRadiusAxis(e,r){e.radiusAxis[r.payload.id]=r.payload},removeRadiusAxis(e,r){delete e.radiusAxis[r.payload.id]},addAngleAxis(e,r){e.angleAxis[r.payload.id]=r.payload},removeAngleAxis(e,r){delete e.angleAxis[r.payload.id]}}}),{addRadiusAxis:pre,removeRadiusAxis:hre,addAngleAxis:vre,removeAngleAxis:gre}=SP.actions,kV=SP.reducer;function OV(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var _x={exports:{}},wt={};var cE;function DV(){if(cE)return wt;cE=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),b=Symbol.for("react.view_transition"),x=Symbol.for("react.client.reference");function j(_){if(typeof _=="object"&&_!==null){var w=_.$$typeof;switch(w){case e:switch(_=_.type,_){case n:case l:case a:case m:case p:case b:return _;default:switch(_=_&&_.$$typeof,_){case u:case d:case v:case h:return _;case o:return _;default:return w}}case r:return w}}}return wt.ContextConsumer=o,wt.ContextProvider=u,wt.Element=e,wt.ForwardRef=d,wt.Fragment=n,wt.Lazy=v,wt.Memo=h,wt.Portal=r,wt.Profiler=l,wt.StrictMode=a,wt.Suspense=m,wt.SuspenseList=p,wt.isContextConsumer=function(_){return j(_)===o},wt.isContextProvider=function(_){return j(_)===u},wt.isElement=function(_){return typeof _=="object"&&_!==null&&_.$$typeof===e},wt.isForwardRef=function(_){return j(_)===d},wt.isFragment=function(_){return j(_)===n},wt.isLazy=function(_){return j(_)===v},wt.isMemo=function(_){return j(_)===h},wt.isPortal=function(_){return j(_)===r},wt.isProfiler=function(_){return j(_)===l},wt.isStrictMode=function(_){return j(_)===a},wt.isSuspense=function(_){return j(_)===m},wt.isSuspenseList=function(_){return j(_)===p},wt.isValidElementType=function(_){return typeof _=="string"||typeof _=="function"||_===n||_===l||_===a||_===m||_===p||typeof _=="object"&&_!==null&&(_.$$typeof===v||_.$$typeof===h||_.$$typeof===u||_.$$typeof===o||_.$$typeof===d||_.$$typeof===x||_.getModuleId!==void 0)},wt.typeOf=j,wt}var uE;function PV(){return uE||(uE=1,_x.exports=DV()),_x.exports}var MV=PV(),dE=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",mE=null,Nx=null,wP=e=>{if(e===mE&&Array.isArray(Nx))return Nx;var r=[];return g.Children.forEach(e,n=>{Bt(n)||(MV.isFragment(n)?r=r.concat(wP(n.props.children)):r.push(n))}),Nx=r,mE=e,r};function TV(e,r){var n=[],a=[];return Array.isArray(r)?a=r.map(l=>dE(l)):a=[dE(r)],wP(e).forEach(l=>{var o=vo(l,"type.displayName")||vo(l,"type.name");o&&a.indexOf(o)!==-1&&n.push(l)}),n}var CP=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,Sx={},fE;function qV(){return fE||(fE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const l=n[Symbol.toStringTag];return l==null||!Object.getOwnPropertyDescriptor(n,Symbol.toStringTag)?.writable?!1:n.toString()===`[object ${l}]`}let a=n;for(;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(n)===a}e.isPlainObject=r})(Sx)),Sx}var wx,pE;function RV(){return pE||(pE=1,wx=qV().isPlainObject),wx}var IV=RV();const LV=oi(IV);var hE,vE,gE,xE,bE;function yE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function jE(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?yE(Object(n),!0).forEach(function(a){$V(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function $V(e,r,n){return(r=BV(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function BV(e){var r=UV(e,"string");return typeof r=="symbol"?r:r+""}function UV(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function pf(){return pf=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},pf.apply(null,arguments)}function Mc(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}var _E=(e,r,n,a,l)=>{var o=n-a,u;return u=Vt(hE||(hE=Mc(["M ",",",""])),e,r),u+=Vt(vE||(vE=Mc(["L ",",",""])),e+n,r),u+=Vt(gE||(gE=Mc(["L ",",",""])),e+n-o/2,r+l),u+=Vt(xE||(xE=Mc(["L ",",",""])),e+n-o/2-a,r+l),u+=Vt(bE||(bE=Mc(["L ",","," Z"])),e,r),u},FV={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},GV=e=>{var r=Qr(e,FV),{x:n,y:a,upperWidth:l,lowerWidth:o,height:u,className:d}=r,{animationEasing:m,animationDuration:p,animationBegin:h,isUpdateAnimationActive:v}=r,b=g.useRef(null),[x,j]=g.useState(-1),_=g.useRef(l),w=g.useRef(o),C=g.useRef(u),E=g.useRef(n),S=g.useRef(a),A=rp(e,"trapezoid-");if(g.useEffect(()=>{if(b.current&&b.current.getTotalLength)try{var ee=b.current.getTotalLength();ee&&j(ee)}catch{}},[]),n!==+n||a!==+a||l!==+l||o!==+o||u!==+u||l===0&&o===0||u===0)return null;var z=Ct("recharts-trapezoid",d);if(!v)return g.createElement("g",null,g.createElement("path",pf({},Hr(r),{className:z,d:_E(n,a,l,o,u)})));var k=_.current,P=w.current,D=C.current,$=E.current,F=S.current,Y="0px ".concat(x===-1?1:x,"px"),M="".concat(x,"px 0px"),K=$k(["strokeDasharray"],p,m);return g.createElement(tp,{animationId:A,key:A,canBegin:x>0,duration:p,easing:m,isActive:v,begin:h},ee=>{var X=Qt(k,l,ee),L=Qt(P,o,ee),I=Qt(D,u,ee),U=Qt($,n,ee),B=Qt(F,a,ee);b.current&&(_.current=X,w.current=L,C.current=I,E.current=U,S.current=B);var T=ee>0?{transition:K,strokeDasharray:M}:{strokeDasharray:Y};return g.createElement("path",pf({},Hr(r),{className:z,d:_E(U,B,X,L,I),ref:b,style:jE(jE({},T),r.style)}))})},HV=["option","shapeType","activeClassName"];function VV(e,r){if(e==null)return{};var n,a,l=QV(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function QV(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function NE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function hf(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?NE(Object(n),!0).forEach(function(a){YV(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function YV(e,r,n){return(r=KV(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function KV(e){var r=WV(e,"string");return typeof r=="symbol"?r:r+""}function WV(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function XV(e,r){return hf(hf({},r),e)}function ZV(e,r){return e==="symbols"}function SE(e){var{shapeType:r,elementProps:n}=e;switch(r){case"rectangle":return g.createElement(Gk,n);case"trapezoid":return g.createElement(GV,n);case"sector":return g.createElement(Qk,n);case"symbols":if(ZV(r))return g.createElement(kz,n);break;case"curve":return g.createElement(Lk,n);default:return null}}function JV(e){return g.isValidElement(e)?e.props:e}function EP(e){var{option:r,shapeType:n,activeClassName:a="recharts-active-shape"}=e,l=VV(e,HV),o;if(g.isValidElement(r))o=g.cloneElement(r,hf(hf({},l),JV(r)));else if(typeof r=="function")o=r(l,l.index);else if(LV(r)&&typeof r!="boolean"){var u=XV(r,l);o=g.createElement(SE,{shapeType:n,elementProps:u})}else{var d=l;o=g.createElement(SE,{shapeType:n,elementProps:d})}return l.isActive?g.createElement($n,{className:a},o):o}var AP=(e,r,n)=>{var a=Zt();return(l,o)=>u=>{e?.(l,o,u),a(RD({activeIndex:String(o),activeDataKey:r,activeCoordinate:l.tooltipPosition,activeGraphicalItemId:n}))}},zP=e=>{var r=Zt();return(n,a)=>l=>{e?.(n,a,l),r(hF())}},kP=(e,r,n)=>{var a=Zt();return(l,o)=>u=>{e?.(l,o,u),a(vF({activeIndex:String(o),activeDataKey:r,activeCoordinate:l.tooltipPosition,activeGraphicalItemId:n}))}};function OP(e){var{tooltipEntrySettings:r}=e,n=Zt(),a=Lr(),l=g.useRef(null);return g.useLayoutEffect(()=>{a||(l.current===null?n(dF(r)):l.current!==r&&n(mF({prev:l.current,next:r})),l.current=r)},[r,n,a]),g.useLayoutEffect(()=>()=>{l.current&&(n(fF(l.current)),l.current=null)},[n]),null}function DP(e){var{legendPayload:r}=e,n=Zt(),a=Lr(),l=g.useRef(null);return g.useLayoutEffect(()=>{a||(l.current===null?n(H8(r)):l.current!==r&&n(V8({prev:l.current,next:r})),l.current=r)},[n,a,r]),g.useLayoutEffect(()=>()=>{l.current&&(n(Q8(l.current)),l.current=null)},[n]),null}var Cx,eQ=()=>{var[e]=g.useState(()=>Qc("uid-"));return e},tQ=(Cx=r3.useId)!==null&&Cx!==void 0?Cx:eQ;function rQ(e,r){var n=tQ();return r||(e?"".concat(e,"-").concat(n):n)}var nQ=g.createContext(void 0),PP=e=>{var{id:r,type:n,children:a}=e,l=rQ("recharts-".concat(n),r);return g.createElement(nQ.Provider,{value:l},a(l))},aQ={cartesianItems:[],polarItems:[]},MP=ln({name:"graphicalItems",initialState:aQ,reducers:{addCartesianGraphicalItem:{reducer(e,r){e.cartesianItems.push(r.payload)},prepare:It()},replaceCartesianGraphicalItem:{reducer(e,r){var{prev:n,next:a}=r.payload,l=ta(e).cartesianItems.indexOf(n);l>-1&&(e.cartesianItems[l]=a)},prepare:It()},removeCartesianGraphicalItem:{reducer(e,r){var n=ta(e).cartesianItems.indexOf(r.payload);n>-1&&e.cartesianItems.splice(n,1)},prepare:It()},addPolarGraphicalItem:{reducer(e,r){e.polarItems.push(r.payload)},prepare:It()},removePolarGraphicalItem:{reducer(e,r){var n=ta(e).polarItems.indexOf(r.payload);n>-1&&e.polarItems.splice(n,1)},prepare:It()}}}),{addCartesianGraphicalItem:iQ,replaceCartesianGraphicalItem:sQ,removeCartesianGraphicalItem:lQ,addPolarGraphicalItem:xre,removePolarGraphicalItem:bre}=MP.actions,oQ=MP.reducer,cQ=e=>{var r=Zt(),n=g.useRef(null);return g.useLayoutEffect(()=>{n.current===null?r(iQ(e)):n.current!==e&&r(sQ({prev:n.current,next:e})),n.current=e},[r,e]),g.useLayoutEffect(()=>()=>{n.current&&(r(lQ(n.current)),n.current=null)},[r]),null},TP=g.memo(cQ),uQ=["points"];function wE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Ex(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?wE(Object(n),!0).forEach(function(a){dQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function dQ(e,r,n){return(r=mQ(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function mQ(e){var r=fQ(e,"string");return typeof r=="symbol"?r:r+""}function fQ(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function vf(){return vf=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},vf.apply(null,arguments)}function pQ(e,r){if(e==null)return{};var n,a,l=hQ(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function hQ(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function vQ(e){var{option:r,dotProps:n,className:a}=e;if(g.isValidElement(r))return g.cloneElement(r,n);if(typeof r=="function")return r(n);var l=Ct(a,typeof r!="boolean"?r.className:""),o=n??{},{points:u}=o,d=pQ(o,uQ);return g.createElement(NP,vf({},d,{className:l}))}function gQ(e,r){return e==null?!1:r?!0:e.length===1}function xQ(e){var{points:r,dot:n,className:a,dotClassName:l,dataKey:o,baseProps:u,needClip:d,clipPathId:m,zIndex:p=_r.scatter}=e;if(!gQ(r,n))return null;var h=CP(n),v=qI(n),b=r.map((j,_)=>{var w,C,E=Ex(Ex(Ex({r:3},u),v),{},{index:_,cx:(w=j.x)!==null&&w!==void 0?w:void 0,cy:(C=j.y)!==null&&C!==void 0?C:void 0,dataKey:o,value:j.value,payload:j.payload,points:r});return g.createElement(vQ,{key:"dot-".concat(_),option:n,dotProps:E,className:l})}),x={};return d&&m!=null&&(x.clipPath="url(#clipPath-".concat(h?"":"dots-").concat(m,")")),g.createElement(Vn,{zIndex:p},g.createElement($n,vf({className:a},x),b))}function CE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function EE(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?CE(Object(n),!0).forEach(function(a){bQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function bQ(e,r,n){return(r=yQ(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function yQ(e){var r=jQ(e,"string");return typeof r=="symbol"?r:r+""}function jQ(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var qP=0,_Q={xAxis:{},yAxis:{},zAxis:{}},RP=ln({name:"cartesianAxis",initialState:_Q,reducers:{addXAxis:{reducer(e,r){e.xAxis[r.payload.id]=r.payload},prepare:It()},replaceXAxis:{reducer(e,r){var{prev:n,next:a}=r.payload;e.xAxis[n.id]!==void 0&&(n.id!==a.id&&delete e.xAxis[n.id],e.xAxis[a.id]=a)},prepare:It()},removeXAxis:{reducer(e,r){delete e.xAxis[r.payload.id]},prepare:It()},addYAxis:{reducer(e,r){e.yAxis[r.payload.id]=r.payload},prepare:It()},replaceYAxis:{reducer(e,r){var{prev:n,next:a}=r.payload;e.yAxis[n.id]!==void 0&&(n.id!==a.id&&delete e.yAxis[n.id],e.yAxis[a.id]=a)},prepare:It()},removeYAxis:{reducer(e,r){delete e.yAxis[r.payload.id]},prepare:It()},addZAxis:{reducer(e,r){e.zAxis[r.payload.id]=r.payload},prepare:It()},replaceZAxis:{reducer(e,r){var{prev:n,next:a}=r.payload;e.zAxis[n.id]!==void 0&&(n.id!==a.id&&delete e.zAxis[n.id],e.zAxis[a.id]=a)},prepare:It()},removeZAxis:{reducer(e,r){delete e.zAxis[r.payload.id]},prepare:It()},updateYAxisWidth(e,r){var{id:n,width:a}=r.payload,l=e.yAxis[n];if(l){var o,u=l.widthHistory||[];if(u.length===3&&u[0]===u[2]&&a===u[1]&&a!==l.width&&Math.abs(a-((o=u[0])!==null&&o!==void 0?o:0))<=1)return;var d=[...u,a].slice(-3);e.yAxis[n]=EE(EE({},l),{},{width:a,widthHistory:d})}}}}),{addXAxis:NQ,replaceXAxis:SQ,removeXAxis:wQ,addYAxis:CQ,replaceYAxis:EQ,removeYAxis:AQ,addZAxis:yre,replaceZAxis:jre,removeZAxis:_re,updateYAxisWidth:zQ}=RP.actions,kQ=RP.reducer,OQ=me([Nr],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),DQ=me([OQ,di,mi],(e,r,n)=>{if(!(!e||r==null||n==null))return{x:e.left,y:e.top,width:Math.max(0,r-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),_j=()=>Be(DQ),PQ=()=>Be(iG);function AE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Ax(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?AE(Object(n),!0).forEach(function(a){MQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function MQ(e,r,n){return(r=TQ(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function TQ(e){var r=qQ(e,"string");return typeof r=="symbol"?r:r+""}function qQ(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var RQ=e=>{var{point:r,childIndex:n,mainColor:a,activeDot:l,dataKey:o,clipPath:u}=e;if(l===!1||r.x==null||r.y==null)return null;var d={index:n,dataKey:o,cx:r.x,cy:r.y,r:4,fill:a??"none",strokeWidth:2,stroke:"#fff",payload:r.payload,value:r.value},m=Ax(Ax(Ax({},d),mu(l)),iy(l)),p;return g.isValidElement(l)?p=g.cloneElement(l,m):typeof l=="function"?p=l(m):p=g.createElement(NP,m),g.createElement($n,{className:"recharts-active-dot",clipPath:u},p)};function IQ(e){var{points:r,mainColor:n,activeDot:a,itemDataKey:l,clipPath:o,zIndex:u=_r.activeDot}=e,d=Be(Zs),m=PQ();if(r==null||m==null)return null;var p=r.find(h=>m.includes(h.payload));return Bt(p)?null:g.createElement(Vn,{zIndex:u},g.createElement(RQ,{point:p,childIndex:Number(d),mainColor:n,dataKey:l,activeDot:a,clipPath:o}))}var zE=(e,r,n)=>{var a=n??e;if(!Bt(a))return na(a,r,0)},LQ=(e,r,n)=>{var a={},l=e.filter(pp),o=e.filter(p=>p.stackId==null),u=l.reduce((p,h)=>{var v=p[h.stackId];return v==null&&(v=[]),v.push(h),p[h.stackId]=v,p},a),d=Object.entries(u).map(p=>{var h,[v,b]=p,x=b.map(_=>_.dataKey),j=zE(r,n,(h=b[0])===null||h===void 0?void 0:h.barSize);return{stackId:v,dataKeys:x,barSize:j}}),m=o.map(p=>{var h=[p.dataKey].filter(b=>b!=null),v=zE(r,n,p.barSize);return{stackId:void 0,dataKeys:h,barSize:v}});return[...d,...m]};function kE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function lm(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?kE(Object(n),!0).forEach(function(a){$Q(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function $Q(e,r,n){return(r=BQ(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function BQ(e){var r=UQ(e,"string");return typeof r=="symbol"?r:r+""}function UQ(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function FQ(e,r,n,a,l){var o,u=a.length;if(!(u<1)){var d=na(e,n,0,!0),m,p=[];if(ut((o=a[0])===null||o===void 0?void 0:o.barSize)){var h=!1,v=n/u,b=a.reduce((E,S)=>E+(S.barSize||0),0);b+=(u-1)*d,b>=n&&(b-=(u-1)*d,d=0),b>=n&&v>0&&(h=!0,v*=.9,b=u*v);var x=(n-b)/2>>0,j={offset:x-d,size:0};m=a.reduce((E,S)=>{var A,z={stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:j.offset+j.size+d,size:h?v:(A=S.barSize)!==null&&A!==void 0?A:0}},k=[...E,z];return j=z.position,k},p)}else{var _=na(r,n,0,!0);n-2*_-(u-1)*d<=0&&(d=0);var w=(n-2*_-(u-1)*d)/u;w>1&&(w>>=0);var C=ut(l)?Math.min(w,l):w;m=a.reduce((E,S,A)=>[...E,{stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:_+(w+d)*A+(w-C)/2,size:C}}],p)}return m}}var GQ=(e,r,n,a,l,o,u)=>{var d=Bt(u)?r:u,m=FQ(n,a,l!==o?l:o,e,d);return l!==o&&m!=null&&(m=m.map(p=>lm(lm({},p),{},{position:lm(lm({},p.position),{},{offset:p.position.offset-l/2})}))),m},HQ=(e,r)=>{var n=Jy(r);if(!(!e||n==null||r==null)){var{stackId:a}=r;if(a!=null){var l=e[a];if(l){var{stackedData:o}=l;if(o)return o.find(u=>u.key===n)}}}},VQ=(e,r)=>{if(!(e==null||r==null)){var n=e.find(a=>a.stackId===r.stackId&&r.dataKey!=null&&a.dataKeys.includes(r.dataKey));if(n!=null)return n.position}};function QQ(e,r){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&ut(e.zIndex)?e.zIndex:r}var YQ=e=>{var{chartData:r}=e,n=Zt(),a=Lr();return g.useEffect(()=>a?()=>{}:(n(L2(r)),()=>{n(L2(void 0))}),[r,n,a]),null},OE={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},IP=ln({name:"brush",initialState:OE,reducers:{setBrushSettings(e,r){return r.payload==null?OE:r.payload}}}),{setBrushSettings:Nre}=IP.actions,KQ=IP.reducer;function WQ(e){return(e%180+180)%180}var XQ=function(r){var{width:n,height:a}=r,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=WQ(l),u=o*Math.PI/180,d=Math.atan(a/n),m=u>d&&u<Math.PI-d?a/Math.sin(u):n/Math.cos(u);return Math.abs(m)},ZQ={dots:[],areas:[],lines:[]},LP=ln({name:"referenceElements",initialState:ZQ,reducers:{addDot:(e,r)=>{e.dots.push(r.payload)},removeDot:(e,r)=>{var n=ta(e).dots.findIndex(a=>a===r.payload);n!==-1&&e.dots.splice(n,1)},addArea:(e,r)=>{e.areas.push(r.payload)},removeArea:(e,r)=>{var n=ta(e).areas.findIndex(a=>a===r.payload);n!==-1&&e.areas.splice(n,1)},addLine:(e,r)=>{e.lines.push(r.payload)},removeLine:(e,r)=>{var n=ta(e).lines.findIndex(a=>a===r.payload);n!==-1&&e.lines.splice(n,1)}}}),{addDot:Sre,removeDot:wre,addArea:Cre,removeArea:Ere,addLine:Are,removeLine:zre}=LP.actions,JQ=LP.reducer,eY=g.createContext(void 0),tY=e=>{var{children:r}=e,[n]=g.useState("".concat(Qc("recharts"),"-clip")),a=_j();if(a==null)return null;var{x:l,y:o,width:u,height:d}=a;return g.createElement(eY.Provider,{value:n},g.createElement("defs",null,g.createElement("clipPath",{id:n},g.createElement("rect",{x:l,y:o,height:d,width:u}))),r)};function $P(e,r){if(r<1)return[];if(r===1)return e;for(var n=[],a=0;a<e.length;a+=r){var l=e[a];l!==void 0&&n.push(l)}return n}function rY(e,r,n){var a={width:e.width+r.width,height:e.height+r.height};return XQ(a,n)}function nY(e,r,n){var a=n==="width",{x:l,y:o,width:u,height:d}=e;return r===1?{start:a?l:o,end:a?l+u:o+d}:{start:a?l+u:o+d,end:a?l:o}}function lu(e,r,n,a,l){if(e*r<e*a||e*r>e*l)return!1;var o=n();return e*(r-e*o/2-a)>=0&&e*(r+e*o/2-l)<=0}function aY(e,r){return $P(e,r+1)}function iY(e,r,n,a,l){for(var o=(a||[]).slice(),{start:u,end:d}=r,m=0,p=1,h=u,v=function(){var j=a?.[m];if(j===void 0)return{v:$P(a,p)};var _=m,w,C=()=>(w===void 0&&(w=n(j,_)),w),E=j.coordinate,S=m===0||lu(e,E,C,h,d);S||(m=0,h=u,p+=1),S&&(h=E+e*(C()/2+l),m+=p)},b;p<=o.length;)if(b=v(),b)return b.v;return[]}function sY(e,r,n,a,l){var o=(a||[]).slice(),u=o.length;if(u===0)return[];for(var{start:d,end:m}=r,p=1;p<=u;p++){for(var h=(u-1)%p,v=d,b=!0,x=function(){var A=a[_];if(A==null)return 0;var z=_,k,P=()=>(k===void 0&&(k=n(A,z)),k),D=A.coordinate,$=_===h||lu(e,D,P,v,m);if(!$)return b=!1,1;$&&(v=D+e*(P()/2+l))},j,_=h;_<u&&(j=x(),!(j!==0&&j===1));_+=p);if(b){for(var w=[],C=h;C<u;C+=p){var E=a[C];E!=null&&w.push(E)}return w}}return[]}function DE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function qr(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?DE(Object(n),!0).forEach(function(a){lY(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function lY(e,r,n){return(r=oY(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function oY(e){var r=cY(e,"string");return typeof r=="symbol"?r:r+""}function cY(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function uY(e,r,n,a,l){for(var o=(a||[]).slice(),u=o.length,{start:d}=r,{end:m}=r,p=function(b){var x=o[b];if(x==null)return 1;var j=x,_,w=()=>(_===void 0&&(_=n(x,b)),_);if(b===u-1){var C=e*(j.coordinate+e*w()/2-m);o[b]=j=qr(qr({},j),{},{tickCoord:C>0?j.coordinate-C*e:j.coordinate})}else o[b]=j=qr(qr({},j),{},{tickCoord:j.coordinate});if(j.tickCoord!=null){var E=lu(e,j.tickCoord,w,d,m);E&&(m=j.tickCoord-e*(w()/2+l),o[b]=qr(qr({},j),{},{isShow:!0}))}},h=u-1;h>=0;h--)p(h);return o}function dY(e,r,n,a,l,o){var u=(a||[]).slice(),d=u.length,{start:m,end:p}=r;if(o){var h=a[d-1];if(h!=null){var v=n(h,d-1),b=e*(h.coordinate+e*v/2-p);if(u[d-1]=h=qr(qr({},h),{},{tickCoord:b>0?h.coordinate-b*e:h.coordinate}),h.tickCoord!=null){var x=lu(e,h.tickCoord,()=>v,m,p);x&&(p=h.tickCoord-e*(v/2+l),u[d-1]=qr(qr({},h),{},{isShow:!0}))}}}for(var j=o?d-1:d,_=function(E){var S=u[E];if(S==null)return 1;var A=S,z,k=()=>(z===void 0&&(z=n(S,E)),z);if(E===0){var P=e*(A.coordinate-e*k()/2-m);u[E]=A=qr(qr({},A),{},{tickCoord:P<0?A.coordinate-P*e:A.coordinate})}else u[E]=A=qr(qr({},A),{},{tickCoord:A.coordinate});if(A.tickCoord!=null){var D=lu(e,A.tickCoord,k,m,p);D&&(m=A.tickCoord+e*(k()/2+l),u[E]=qr(qr({},A),{},{isShow:!0}))}},w=0;w<j;w++)_(w);return u}function Nj(e,r,n){var{tick:a,ticks:l,viewBox:o,minTickGap:u,orientation:d,interval:m,tickFormatter:p,unit:h,angle:v}=e;if(!l||!l.length||!a)return[];if(qe(m)||ep.isSsr){var b;return(b=aY(l,qe(m)?m:0))!==null&&b!==void 0?b:[]}var x=[],j=d==="top"||d==="bottom"?"width":"height",_=h&&j==="width"?Fc(h,{fontSize:r,letterSpacing:n}):{width:0,height:0},w=(z,k)=>{var P=typeof p=="function"?p(z.value,k):z.value;return j==="width"?rY(Fc(P,{fontSize:r,letterSpacing:n}),_,v):Fc(P,{fontSize:r,letterSpacing:n})[j]},C=l[0],E=l[1],S=l.length>=2&&C!=null&&E!=null?nn(E.coordinate-C.coordinate):1,A=nY(o,S,j);return m==="equidistantPreserveStart"?iY(S,A,w,l,u):m==="equidistantPreserveEnd"?sY(S,A,w,l,u):(m==="preserveStart"||m==="preserveStartEnd"?x=dY(S,A,w,l,u,m==="preserveStartEnd"):x=uY(S,A,w,l,u),x.filter(z=>z.isShow))}var mY=e=>{var{ticks:r,label:n,labelGapWithTick:a=5,tickSize:l=0,tickMargin:o=0}=e,u=0;if(r){Array.from(r).forEach(h=>{if(h){var v=h.getBoundingClientRect();v.width>u&&(u=v.width)}});var d=n?n.getBoundingClientRect().width:0,m=l+o,p=u+m+d+(n?a:0);return Math.round(p)}return 0},fY=["axisLine","width","height","className","hide","ticks","axisType"];function pY(e,r){if(e==null)return{};var n,a,l=hY(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function hY(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function Js(){return Js=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Js.apply(null,arguments)}function PE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Gt(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?PE(Object(n),!0).forEach(function(a){vY(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function vY(e,r,n){return(r=gY(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function gY(e){var r=xY(e,"string");return typeof r=="symbol"?r:r+""}function xY(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var ei={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:_r.axis};function bY(e){var{x:r,y:n,width:a,height:l,orientation:o,mirror:u,axisLine:d,otherSvgProps:m}=e;if(!d)return null;var p=Gt(Gt(Gt({},m),ra(d)),{},{fill:"none"});if(o==="top"||o==="bottom"){var h=+(o==="top"&&!u||o==="bottom"&&u);p=Gt(Gt({},p),{},{x1:r,y1:n+h*l,x2:r+a,y2:n+h*l})}else{var v=+(o==="left"&&!u||o==="right"&&u);p=Gt(Gt({},p),{},{x1:r+v*a,y1:n,x2:r+v*a,y2:n+l})}return g.createElement("line",Js({},p,{className:Ct("recharts-cartesian-axis-line",vo(d,"className"))}))}function yY(e,r,n,a,l,o,u,d,m){var p,h,v,b,x,j,_=d?-1:1,w=e.tickSize||u,C=qe(e.tickCoord)?e.tickCoord:e.coordinate;switch(o){case"top":p=h=e.coordinate,b=n+ +!d*l,v=b-_*w,j=v-_*m,x=C;break;case"left":v=b=e.coordinate,h=r+ +!d*a,p=h-_*w,x=p-_*m,j=C;break;case"right":v=b=e.coordinate,h=r+ +d*a,p=h+_*w,x=p+_*m,j=C;break;default:p=h=e.coordinate,b=n+ +d*l,v=b+_*w,j=v+_*m,x=C;break}return{line:{x1:p,y1:v,x2:h,y2:b},tick:{x,y:j}}}function jY(e,r){switch(e){case"left":return r?"start":"end";case"right":return r?"end":"start";default:return"middle"}}function _Y(e,r){switch(e){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}function NY(e){var{option:r,tickProps:n,value:a}=e,l,o=Ct(n.className,"recharts-cartesian-axis-tick-value");if(g.isValidElement(r))l=g.cloneElement(r,Gt(Gt({},n),{},{className:o}));else if(typeof r=="function")l=r(Gt(Gt({},n),{},{className:o}));else{var u="recharts-cartesian-axis-tick-value";typeof r!="boolean"&&(u=Ct(u,OV(r))),l=g.createElement(yj,Js({},n,{className:u}),a)}return l}var SY=g.forwardRef((e,r)=>{var{ticks:n=[],tick:a,tickLine:l,stroke:o,tickFormatter:u,unit:d,padding:m,tickTextProps:p,orientation:h,mirror:v,x:b,y:x,width:j,height:_,tickSize:w,tickMargin:C,fontSize:E,letterSpacing:S,getTicksConfig:A,events:z,axisType:k}=e,P=Nj(Gt(Gt({},A),{},{ticks:n}),E,S),D=jY(h,v),$=_Y(h,v),F=ra(A),Y=mu(a),M={};typeof l=="object"&&(M=l);var K=Gt(Gt({},F),{},{fill:"none"},M),ee=P.map(I=>Gt({entry:I},yY(I,b,x,j,_,h,w,v,C))),X=ee.map(I=>{var{entry:U,line:B}=I;return g.createElement($n,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(U.value,"-").concat(U.coordinate,"-").concat(U.tickCoord)},l&&g.createElement("line",Js({},K,B,{className:Ct("recharts-cartesian-axis-tick-line",vo(l,"className"))})))}),L=ee.map((I,U)=>{var B,T,{entry:Z,tick:H}=I,ce=Gt(Gt(Gt(Gt({verticalAnchor:$},F),{},{textAnchor:D,stroke:"none",fill:o},H),{},{index:U,payload:Z,visibleTicksCount:P.length,tickFormatter:u,padding:m},p),{},{angle:(B=(T=p?.angle)!==null&&T!==void 0?T:F.angle)!==null&&B!==void 0?B:0}),xe=Gt(Gt({},ce),Y);return g.createElement($n,Js({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(Z.value,"-").concat(Z.coordinate,"-").concat(Z.tickCoord)},sy(z,Z,U)),a&&g.createElement(NY,{option:a,tickProps:xe,value:"".concat(typeof u=="function"?u(Z.value,U):Z.value).concat(d||"")}))});return g.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(k,"-ticks")},L.length>0&&g.createElement(Vn,{zIndex:_r.label},g.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(k,"-tick-labels"),ref:r},L)),X.length>0&&g.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(k,"-tick-lines")},X))}),wY=g.forwardRef((e,r)=>{var{axisLine:n,width:a,height:l,className:o,hide:u,ticks:d,axisType:m}=e,p=pY(e,fY),[h,v]=g.useState(""),[b,x]=g.useState(""),j=g.useRef(null);g.useImperativeHandle(r,()=>({getCalculatedWidth:()=>{var w;return mY({ticks:j.current,label:(w=e.labelRef)===null||w===void 0?void 0:w.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var _=g.useCallback(w=>{if(w){var C=w.getElementsByClassName("recharts-cartesian-axis-tick-value");j.current=C;var E=C[0];if(E){var S=window.getComputedStyle(E),A=S.fontSize,z=S.letterSpacing;(A!==h||z!==b)&&(v(A),x(z))}}},[h,b]);return u||a!=null&&a<=0||l!=null&&l<=0?null:g.createElement(Vn,{zIndex:e.zIndex},g.createElement($n,{className:Ct("recharts-cartesian-axis",o)},g.createElement(bY,{x:e.x,y:e.y,width:a,height:l,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:ra(e)}),g.createElement(SY,{ref:_,axisType:m,events:p,fontSize:h,getTicksConfig:e,height:e.height,letterSpacing:b,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:d,unit:e.unit,width:e.width,x:e.x,y:e.y}),g.createElement(sV,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},g.createElement(vV,{label:e.label,labelRef:e.labelRef}),e.children)))}),Sj=g.forwardRef((e,r)=>{var n=Qr(e,ei);return g.createElement(wY,Js({},n,{ref:r}))});Sj.displayName="CartesianAxis";var CY=["x1","y1","x2","y2","key"],EY=["offset"],AY=["xAxisId","yAxisId"],zY=["xAxisId","yAxisId"];function ME(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Rr(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?ME(Object(n),!0).forEach(function(a){kY(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ME(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function kY(e,r,n){return(r=OY(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function OY(e){var r=DY(e,"string");return typeof r=="symbol"?r:r+""}function DY(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Is(){return Is=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Is.apply(null,arguments)}function gf(e,r){if(e==null)return{};var n,a,l=PY(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function PY(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var MY=e=>{var{fill:r}=e;if(!r||r==="none")return null;var{fillOpacity:n,x:a,y:l,width:o,height:u,ry:d}=e;return g.createElement("rect",{x:a,y:l,ry:d,width:o,height:u,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function BP(e){var{option:r,lineItemProps:n}=e,a;if(g.isValidElement(r))a=g.cloneElement(r,n);else if(typeof r=="function")a=r(n);else{var l,{x1:o,y1:u,x2:d,y2:m,key:p}=n,h=gf(n,CY),v=(l=ra(h))!==null&&l!==void 0?l:{},{offset:b}=v,x=gf(v,EY);a=g.createElement("line",Is({},x,{x1:o,y1:u,x2:d,y2:m,fill:"none",key:p}))}return a}function TY(e){var{x:r,width:n,horizontal:a=!0,horizontalPoints:l}=e;if(!a||!l||!l.length)return null;var{xAxisId:o,yAxisId:u}=e,d=gf(e,AY),m=l.map((p,h)=>{var v=Rr(Rr({},d),{},{x1:r,y1:p,x2:r+n,y2:p,key:"line-".concat(h),index:h});return g.createElement(BP,{key:"line-".concat(h),option:a,lineItemProps:v})});return g.createElement("g",{className:"recharts-cartesian-grid-horizontal"},m)}function qY(e){var{y:r,height:n,vertical:a=!0,verticalPoints:l}=e;if(!a||!l||!l.length)return null;var{xAxisId:o,yAxisId:u}=e,d=gf(e,zY),m=l.map((p,h)=>{var v=Rr(Rr({},d),{},{x1:p,y1:r,x2:p,y2:r+n,key:"line-".concat(h),index:h});return g.createElement(BP,{option:a,lineItemProps:v,key:"line-".concat(h)})});return g.createElement("g",{className:"recharts-cartesian-grid-vertical"},m)}function RY(e){var{horizontalFill:r,fillOpacity:n,x:a,y:l,width:o,height:u,horizontalPoints:d,horizontal:m=!0}=e;if(!m||!r||!r.length||d==null)return null;var p=d.map(v=>Math.round(v+l-l)).sort((v,b)=>v-b);l!==p[0]&&p.unshift(0);var h=p.map((v,b)=>{var x=p[b+1],j=x==null,_=j?l+u-v:x-v;if(_<=0)return null;var w=b%r.length;return g.createElement("rect",{key:"react-".concat(b),y:v,x:a,height:_,width:o,stroke:"none",fill:r[w],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return g.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function IY(e){var{vertical:r=!0,verticalFill:n,fillOpacity:a,x:l,y:o,width:u,height:d,verticalPoints:m}=e;if(!r||!n||!n.length)return null;var p=m.map(v=>Math.round(v+l-l)).sort((v,b)=>v-b);l!==p[0]&&p.unshift(0);var h=p.map((v,b)=>{var x=p[b+1],j=x==null,_=j?l+u-v:x-v;if(_<=0)return null;var w=b%n.length;return g.createElement("rect",{key:"react-".concat(b),x:v,y:o,width:_,height:d,stroke:"none",fill:n[w],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return g.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var LY=(e,r)=>{var{xAxis:n,width:a,height:l,offset:o}=e;return yk(Nj(Rr(Rr(Rr({},ei),n),{},{ticks:jk(n),viewBox:{x:0,y:0,width:a,height:l}})),o.left,o.left+o.width,r)},$Y=(e,r)=>{var{yAxis:n,width:a,height:l,offset:o}=e;return yk(Nj(Rr(Rr(Rr({},ei),n),{},{ticks:jk(n),viewBox:{x:0,y:0,width:a,height:l}})),o.top,o.top+o.height,r)},BY={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:_r.grid};function kb(e){var r=Ek(),n=Ak(),a=Ck(),l=Rr(Rr({},Qr(e,BY)),{},{x:qe(e.x)?e.x:a.left,y:qe(e.y)?e.y:a.top,width:qe(e.width)?e.width:a.width,height:qe(e.height)?e.height:a.height}),{xAxisId:o,yAxisId:u,x:d,y:m,width:p,height:h,syncWithTicks:v,horizontalValues:b,verticalValues:x}=l,j=Lr(),_=Be($=>E2($,"xAxis",o,j)),w=Be($=>E2($,"yAxis",u,j));if(!Sa(p)||!Sa(h)||!qe(d)||!qe(m))return null;var C=l.verticalCoordinatesGenerator||LY,E=l.horizontalCoordinatesGenerator||$Y,{horizontalPoints:S,verticalPoints:A}=l;if((!S||!S.length)&&typeof E=="function"){var z=b&&b.length,k=E({yAxis:w?Rr(Rr({},w),{},{ticks:z?b:w.ticks}):void 0,width:r??p,height:n??h,offset:a},z?!0:v);Um(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof k,"]")),Array.isArray(k)&&(S=k)}if((!A||!A.length)&&typeof C=="function"){var P=x&&x.length,D=C({xAxis:_?Rr(Rr({},_),{},{ticks:P?x:_.ticks}):void 0,width:r??p,height:n??h,offset:a},P?!0:v);Um(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(A=D)}return g.createElement(Vn,{zIndex:l.zIndex},g.createElement("g",{className:"recharts-cartesian-grid"},g.createElement(MY,{fill:l.fill,fillOpacity:l.fillOpacity,x:l.x,y:l.y,width:l.width,height:l.height,ry:l.ry}),g.createElement(RY,Is({},l,{horizontalPoints:S})),g.createElement(IY,Is({},l,{verticalPoints:A})),g.createElement(TY,Is({},l,{offset:a,horizontalPoints:S,xAxis:_,yAxis:w})),g.createElement(qY,Is({},l,{offset:a,verticalPoints:A,xAxis:_,yAxis:w}))))}kb.displayName="CartesianGrid";var UY={},UP=ln({name:"errorBars",initialState:UY,reducers:{addErrorBar:(e,r)=>{var{itemId:n,errorBar:a}=r.payload;e[n]||(e[n]=[]),e[n].push(a)},replaceErrorBar:(e,r)=>{var{itemId:n,prev:a,next:l}=r.payload;e[n]&&(e[n]=e[n].map(o=>o.dataKey===a.dataKey&&o.direction===a.direction?l:o))},removeErrorBar:(e,r)=>{var{itemId:n,errorBar:a}=r.payload;e[n]&&(e[n]=e[n].filter(l=>l.dataKey!==a.dataKey||l.direction!==a.direction))}}}),{addErrorBar:kre,replaceErrorBar:Ore,removeErrorBar:Dre}=UP.actions,FY=UP.reducer,GY=["children"];function HY(e,r){if(e==null)return{};var n,a,l=VY(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function VY(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var QY={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},YY=g.createContext(QY);function FP(e){var{children:r}=e,n=HY(e,GY);return g.createElement(YY.Provider,{value:n},r)}function wj(e,r){var n,a,l=Be(p=>hi(p,e)),o=Be(p=>vi(p,r)),u=(n=l?.allowDataOverflow)!==null&&n!==void 0?n:vr.allowDataOverflow,d=(a=o?.allowDataOverflow)!==null&&a!==void 0?a:gr.allowDataOverflow,m=u||d;return{needClip:m,needClipX:u,needClipY:d}}function GP(e){var{xAxisId:r,yAxisId:n,clipPathId:a}=e,l=_j(),{needClipX:o,needClipY:u,needClip:d}=wj(r,n);if(!d||!l)return null;var{x:m,y:p,width:h,height:v}=l;return g.createElement("clipPath",{id:"clipPath-".concat(a)},g.createElement("rect",{x:o?m:m-h/2,y:u?p:p-v/2,width:o?h:h*2,height:u?v:v*2}))}var HP=(e,r,n,a)=>is(e,"xAxis",r,a),VP=(e,r,n,a)=>as(e,"xAxis",r,a),QP=(e,r,n,a)=>is(e,"yAxis",n,a),YP=(e,r,n,a)=>as(e,"yAxis",n,a),KY=me([jt,HP,QP,VP,YP],(e,r,n,a,l)=>ui(e,"xAxis")?xo(r,a,!1):xo(n,l,!1)),WY=(e,r,n,a,l)=>l;function XY(e){return e.type==="line"}var ZY=me([gp,WY],(e,r)=>e.filter(XY).find(n=>n.id===r)),JY=me([jt,HP,QP,VP,YP,ZY,KY,Gy],(e,r,n,a,l,o,u,d)=>{var{chartData:m,dataStartIndex:p,dataEndIndex:h}=d;if(!(o==null||r==null||n==null||a==null||l==null||a.length===0||l.length===0||u==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:v,data:b}=o,x;if(b!=null&&b.length>0?x=b:x=m?.slice(p,h+1),x!=null)return $K({layout:e,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:l,dataKey:v,bandSize:u,displayedData:x})}});function eK(e){var r=mu(e),n=3,a=2;if(r!=null){var{r:l,strokeWidth:o}=r,u=Number(l),d=Number(o);return(Number.isNaN(u)||u<0)&&(u=n),(Number.isNaN(d)||d<0)&&(d=a),{r:u,strokeWidth:d}}return{r:n,strokeWidth:a}}var zx={exports:{}},kx={};var TE;function tK(){if(TE)return kx;TE=1;var e=zf();function r(m,p){return m===p&&(m!==0||1/m===1/p)||m!==m&&p!==p}var n=typeof Object.is=="function"?Object.is:r,a=e.useSyncExternalStore,l=e.useRef,o=e.useEffect,u=e.useMemo,d=e.useDebugValue;return kx.useSyncExternalStoreWithSelector=function(m,p,h,v,b){var x=l(null);if(x.current===null){var j={hasValue:!1,value:null};x.current=j}else j=x.current;x=u(function(){function w(z){if(!C){if(C=!0,E=z,z=v(z),b!==void 0&&j.hasValue){var k=j.value;if(b(k,z))return S=k}return S=z}if(k=S,n(E,z))return k;var P=v(z);return b!==void 0&&b(k,P)?(E=z,k):(E=z,S=P)}var C=!1,E,S,A=h===void 0?null:h;return[function(){return w(p())},A===null?void 0:function(){return w(A())}]},[p,h,v,b]);var _=a(m,x[0],x[1]);return o(function(){j.hasValue=!0,j.value=_},[_]),d(_),_},kx}var qE;function rK(){return qE||(qE=1,zx.exports=tK()),zx.exports}rK();function nK(e){e()}function aK(){let e=null,r=null;return{clear(){e=null,r=null},notify(){nK(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){const n=[];let a=e;for(;a;)n.push(a),a=a.next;return n},subscribe(n){let a=!0;const l=r={callback:n,next:null,prev:r};return l.prev?l.prev.next=l:e=l,function(){!a||e===null||(a=!1,l.next?l.next.prev=l.prev:r=l.prev,l.prev?l.prev.next=l.next:e=l.next)}}}}var RE={notify(){},get:()=>[]};function iK(e,r){let n,a=RE,l=0,o=!1;function u(_){h();const w=a.subscribe(_);let C=!1;return()=>{C||(C=!0,w(),v())}}function d(){a.notify()}function m(){j.onStateChange&&j.onStateChange()}function p(){return o}function h(){l++,n||(n=e.subscribe(m),a=aK())}function v(){l--,n&&l===0&&(n(),n=void 0,a.clear(),a=RE)}function b(){o||(o=!0,h())}function x(){o&&(o=!1,v())}const j={addNestedSub:u,notifyNestedSubs:d,handleChangeWrapper:m,isSubscribed:p,trySubscribe:b,tryUnsubscribe:x,getListeners:()=>a};return j}var sK=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",lK=sK(),oK=()=>typeof navigator<"u"&&navigator.product==="ReactNative",cK=oK(),uK=()=>lK||cK?g.useLayoutEffect:g.useEffect,dK=uK();function IE(e,r){return e===r?e!==0||r!==0||1/e===1/r:e!==e&&r!==r}function mK(e,r){if(IE(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;const n=Object.keys(e),a=Object.keys(r);if(n.length!==a.length)return!1;for(let l=0;l<n.length;l++)if(!Object.prototype.hasOwnProperty.call(r,n[l])||!IE(e[n[l]],r[n[l]]))return!1;return!0}var fK=Symbol.for("react-redux-context"),pK=typeof globalThis<"u"?globalThis:{};function hK(){if(!g.createContext)return{};const e=pK[fK]??=new Map;let r=e.get(g.createContext);return r||(r=g.createContext(null),e.set(g.createContext,r)),r}var vK=hK();function gK(e){const{children:r,context:n,serverState:a,store:l}=e,o=g.useMemo(()=>{const m=iK(l);return{store:l,subscription:m,getServerState:a?()=>a:void 0}},[l,a]),u=g.useMemo(()=>l.getState(),[l]);dK(()=>{const{subscription:m}=o;return m.onStateChange=m.notifyNestedSubs,m.trySubscribe(),u!==l.getState()&&m.notifyNestedSubs(),()=>{m.tryUnsubscribe(),m.onStateChange=void 0}},[o,u]);const d=n||vK;return g.createElement(d.Provider,{value:o},r)}var xK=gK,bK=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function yK(e,r){return e==null&&r==null?!0:typeof e=="number"&&typeof r=="number"?e===r||e!==e&&r!==r:e===r}function _p(e,r){var n=new Set([...Object.keys(e),...Object.keys(r)]);for(var a of n)if(bK.has(a)){if(e[a]==null&&r[a]==null)continue;if(!mK(e[a],r[a]))return!1}else if(!yK(e[a],r[a]))return!1;return!0}var jK=["id"],_K=["type","layout","connectNulls","needClip","shape"],NK=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function ou(){return ou=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ou.apply(null,arguments)}function LE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function va(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?LE(Object(n),!0).forEach(function(a){SK(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function SK(e,r,n){return(r=wK(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function wK(e){var r=CK(e,"string");return typeof r=="symbol"?r:r+""}function CK(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Cj(e,r){if(e==null)return{};var n,a,l=EK(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function EK(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var AK=e=>{var{dataKey:r,name:n,stroke:a,legendType:l,hide:o}=e;return[{inactive:o,dataKey:r,type:l,color:a,value:Hf(n,r),payload:e}]},zK=g.memo(e=>{var{dataKey:r,data:n,stroke:a,strokeWidth:l,fill:o,name:u,hide:d,unit:m,tooltipType:p,id:h}=e,v={dataDefinedOnItem:n,getPosition:al,settings:{stroke:a,strokeWidth:l,fill:o,dataKey:r,nameKey:void 0,name:Hf(u,r),hide:d,type:p,color:a,unit:m,graphicalItemId:h}};return g.createElement(OP,{tooltipEntrySettings:v})}),KP=(e,r)=>"".concat(r,"px ").concat(e-r,"px");function kK(e,r){for(var n=e.length%2!==0?[...e,0]:e,a=[],l=0;l<r;++l)a=[...a,...n];return a}var OK=(e,r,n)=>{var a=n.reduce((x,j)=>x+j);if(!a)return KP(r,e);for(var l=Math.floor(e/a),o=e%a,u=r-e,d=[],m=0,p=0;m<n.length;p+=(h=n[m])!==null&&h!==void 0?h:0,++m){var h,v=n[m];if(v!=null&&p+v>o){d=[...n.slice(0,m),o-p];break}}var b=d.length%2===0?[0,u]:[u];return[...kK(n,l),...d,...b].map(x=>"".concat(x,"px")).join(", ")};function DK(e){var{clipPathId:r,points:n,props:a}=e,{dot:l,dataKey:o,needClip:u}=a,{id:d}=a,m=Cj(a,jK),p=ra(m);return g.createElement(xQ,{points:n,dot:l,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:o,baseProps:p,needClip:u,clipPathId:r})}function PK(e){var{showLabels:r,children:n,points:a}=e,l=g.useMemo(()=>a?.map(o=>{var u,d,m={x:(u=o.x)!==null&&u!==void 0?u:0,y:(d=o.y)!==null&&d!==void 0?d:0,width:0,lowerWidth:0,upperWidth:0,height:0};return va(va({},m),{},{value:o.value,payload:o.payload,viewBox:m,parentViewBox:void 0,fill:void 0})}),[a]);return g.createElement(yP,{value:r?l:void 0},n)}function $E(e){var{clipPathId:r,pathRef:n,points:a,strokeDasharray:l,props:o}=e,{type:u,layout:d,connectNulls:m,needClip:p,shape:h}=o,v=Cj(o,_K),b=va(va({},Hr(v)),{},{fill:"none",className:"recharts-line-curve",clipPath:p?"url(#clipPath-".concat(r,")"):void 0,points:a,type:u,layout:d,connectNulls:m,strokeDasharray:l??o.strokeDasharray});return g.createElement(g.Fragment,null,a?.length>1&&g.createElement(EP,ou({shapeType:"curve",option:h},b,{pathRef:n})),g.createElement(DK,{points:a,clipPathId:r,props:o}))}function MK(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function TK(e){var{clipPathId:r,props:n,pathRef:a,previousPointsRef:l,longestAnimatedLengthRef:o}=e,{points:u,strokeDasharray:d,isAnimationActive:m,animationBegin:p,animationDuration:h,animationEasing:v,animateNewValues:b,width:x,height:j,onAnimationEnd:_,onAnimationStart:w}=n,C=l.current,E=rp(u,"recharts-line-"),S=g.useRef(E),[A,z]=g.useState(!1),k=!A,P=g.useCallback(()=>{typeof _=="function"&&_(),z(!1)},[_]),D=g.useCallback(()=>{typeof w=="function"&&w(),z(!0)},[w]),$=MK(a.current),F=g.useRef(0);S.current!==E&&(F.current=o.current,S.current=E);var Y=F.current;return g.createElement(PK,{points:u,showLabels:k},n.children,g.createElement(tp,{animationId:E,begin:p,duration:h,isActive:m,easing:v,onAnimationEnd:P,onAnimationStart:D,key:E},M=>{var K=Qt(Y,$+Y,M),ee=Math.min(K,$),X;if(m)if(d){var L="".concat(d).split(/[,\s]+/gim).map(B=>parseFloat(B));X=OK(ee,$,L)}else X=KP($,ee);else X=d==null?void 0:String(d);if(M>0&&$>0&&(l.current=u,o.current=Math.max(o.current,ee)),C){var I=C.length/u.length,U=M===1?u:u.map((B,T)=>{var Z=Math.floor(T*I);if(C[Z]){var H=C[Z];return va(va({},B),{},{x:Qt(H.x,B.x,M),y:Qt(H.y,B.y,M)})}return b?va(va({},B),{},{x:Qt(x*2,B.x,M),y:Qt(j/2,B.y,M)}):va(va({},B),{},{x:B.x,y:B.y})});return l.current=U,g.createElement($E,{props:n,points:U,clipPathId:r,pathRef:a,strokeDasharray:X})}return g.createElement($E,{props:n,points:u,clipPathId:r,pathRef:a,strokeDasharray:X})}),g.createElement(_P,{label:n.label}))}function qK(e){var{clipPathId:r,props:n}=e,a=g.useRef(null),l=g.useRef(0),o=g.useRef(null);return g.createElement(TK,{props:n,clipPathId:r,previousPointsRef:a,longestAnimatedLengthRef:l,pathRef:o})}var RK=(e,r)=>{var n,a;return{x:(n=e.x)!==null&&n!==void 0?n:void 0,y:(a=e.y)!==null&&a!==void 0?a:void 0,value:e.value,errorVal:ir(e.payload,r)}};class IK extends g.Component{render(){var{hide:r,dot:n,points:a,className:l,xAxisId:o,yAxisId:u,top:d,left:m,width:p,height:h,id:v,needClip:b,zIndex:x}=this.props;if(r)return null;var j=Ct("recharts-line",l),_=v,{r:w,strokeWidth:C}=eK(n),E=CP(n),S=w*2+C,A=b?"url(#clipPath-".concat(E?"":"dots-").concat(_,")"):void 0;return g.createElement(Vn,{zIndex:x},g.createElement($n,{className:j},b&&g.createElement("defs",null,g.createElement(GP,{clipPathId:_,xAxisId:o,yAxisId:u}),!E&&g.createElement("clipPath",{id:"clipPath-dots-".concat(_)},g.createElement("rect",{x:m-S/2,y:d-S/2,width:p+S,height:h+S}))),g.createElement(FP,{xAxisId:o,yAxisId:u,data:a,dataPointFormatter:RK,errorBarOffset:0},g.createElement(qK,{props:this.props,clipPathId:_}))),g.createElement(IQ,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:A}))}}var WP={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:_r.line,type:"linear"};function LK(e){var r=Qr(e,WP),{activeDot:n,animateNewValues:a,animationBegin:l,animationDuration:o,animationEasing:u,connectNulls:d,dot:m,hide:p,isAnimationActive:h,label:v,legendType:b,xAxisId:x,yAxisId:j,id:_}=r,w=Cj(r,NK),{needClip:C}=wj(x,j),E=_j(),S=il(),A=Lr(),z=Be(F=>JY(F,x,j,A,_));if(S!=="horizontal"&&S!=="vertical"||z==null||E==null)return null;var{height:k,width:P,x:D,y:$}=E;return g.createElement(IK,ou({},w,{id:_,connectNulls:d,dot:m,activeDot:n,animateNewValues:a,animationBegin:l,animationDuration:o,animationEasing:u,isAnimationActive:h,hide:p,label:v,legendType:b,xAxisId:x,yAxisId:j,points:z,layout:S,height:k,width:P,left:D,top:$,needClip:C}))}function $K(e){var{layout:r,xAxis:n,yAxis:a,xAxisTicks:l,yAxisTicks:o,dataKey:u,bandSize:d,displayedData:m}=e;return m.map((p,h)=>{var v=ir(p,u);if(r==="horizontal"){var b=ww({axis:n,ticks:l,bandSize:d,entry:p,index:h}),x=Bt(v)?null:a.scale.map(v);return{x:b,y:x??null,value:v,payload:p}}var j=Bt(v)?null:n.scale.map(v),_=ww({axis:a,ticks:o,bandSize:d,entry:p,index:h});return j==null||_==null?null:{x:j,y:_,value:v,payload:p}}).filter(Boolean)}function BK(e){var r=Qr(e,WP),n=Lr();return g.createElement(PP,{id:r.id,type:"line"},a=>g.createElement(g.Fragment,null,g.createElement(DP,{legendPayload:AK(r)}),g.createElement(zK,{dataKey:r.dataKey,data:r.data,stroke:r.stroke,strokeWidth:r.strokeWidth,fill:r.fill,name:r.name,hide:r.hide,unit:r.unit,tooltipType:r.tooltipType,id:a}),g.createElement(TP,{type:"line",id:a,data:r.data,xAxisId:r.xAxisId,yAxisId:r.yAxisId,zAxisId:0,dataKey:r.dataKey,hide:r.hide,isPanorama:n}),g.createElement(LK,ou({},r,{id:a}))))}var XP=g.memo(BK,_p);XP.displayName="Line";function ol(e,r){var n,a;return(n=(a=e.graphicalItems.cartesianItems.find(l=>l.id===r))===null||a===void 0?void 0:a.xAxisId)!==null&&n!==void 0?n:qP}function cl(e,r){var n,a;return(n=(a=e.graphicalItems.cartesianItems.find(l=>l.id===r))===null||a===void 0?void 0:a.yAxisId)!==null&&n!==void 0?n:qP}var UK="Invariant failed";function FK(e,r){throw new Error(UK)}function Ob(){return Ob=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ob.apply(null,arguments)}function xf(e){return g.createElement(EP,Ob({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var GK=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a,l)=>{if(qe(r))return r;var o=qe(a)||Bt(a);return o?r(a,l):(o||FK(),n)}},HK=(e,r,n)=>n,VK=(e,r)=>r,zu=me([gp,VK],(e,r)=>e.filter(n=>n.type==="bar").find(n=>n.id===r)),QK=me([zu],e=>e?.maxBarSize),YK=(e,r,n,a)=>a,KK=me([jt,gp,ol,cl,HK],(e,r,n,a,l)=>r.filter(o=>e==="horizontal"?o.xAxisId===n:o.yAxisId===a).filter(o=>o.isPanorama===l).filter(o=>o.hide===!1).filter(o=>o.type==="bar")),WK=(e,r,n)=>{var a=jt(e),l=ol(e,r),o=cl(e,r);if(!(l==null||o==null))return a==="horizontal"?Nb(e,"yAxis",o,n):Nb(e,"xAxis",l,n)},XK=(e,r)=>{var n=jt(e),a=ol(e,r),l=cl(e,r);if(!(a==null||l==null))return n==="horizontal"?C2(e,"xAxis",a):C2(e,"yAxis",l)},ZK=me([KK,eU,XK],LQ),JK=(e,r,n)=>{var a,l,o=zu(e,r);if(o==null)return 0;var u=ol(e,r),d=cl(e,r);if(u==null||d==null)return 0;var m=jt(e),p=$O(e),{maxBarSize:h}=o,v=Bt(h)?p:h,b,x;return m==="horizontal"?(b=is(e,"xAxis",u,n),x=as(e,"xAxis",u,n)):(b=is(e,"yAxis",d,n),x=as(e,"yAxis",d,n)),(a=(l=xo(b,x,!0))!==null&&l!==void 0?l:v)!==null&&a!==void 0?a:0},ZP=(e,r,n)=>{var a=jt(e),l=ol(e,r),o=cl(e,r);if(!(l==null||o==null)){var u,d;return a==="horizontal"?(u=is(e,"xAxis",l,n),d=as(e,"xAxis",l,n)):(u=is(e,"yAxis",o,n),d=as(e,"yAxis",o,n)),xo(u,d)}},eW=me([ZK,$O,J9,BO,JK,ZP,QK],GQ),tW=(e,r,n)=>{var a=ol(e,r);if(a!=null)return is(e,"xAxis",a,n)},rW=(e,r,n)=>{var a=cl(e,r);if(a!=null)return is(e,"yAxis",a,n)},nW=(e,r,n)=>{var a=ol(e,r);if(a!=null)return as(e,"xAxis",a,n)},aW=(e,r,n)=>{var a=cl(e,r);if(a!=null)return as(e,"yAxis",a,n)},iW=me([eW,zu],VQ),sW=me([WK,zu],HQ),lW=me([Nr,vy,tW,rW,nW,aW,iW,jt,H9,ZP,sW,zu,YK],(e,r,n,a,l,o,u,d,m,p,h,v,b)=>{var{chartData:x,dataStartIndex:j,dataEndIndex:_}=m;if(!(v==null||u==null||r==null||d!=="horizontal"&&d!=="vertical"||n==null||a==null||l==null||o==null||p==null)){var{data:w}=v,C;if(w!=null&&w.length>0?C=w:C=x?.slice(j,_+1),C!=null)return TW({layout:d,barSettings:v,pos:u,parentViewBox:r,bandSize:p,xAxis:n,yAxis:a,xAxisTicks:l,yAxisTicks:o,stackedData:h,displayedData:C,offset:e,cells:b,dataStartIndex:j})}}),oW=["index"];function Db(){return Db=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Db.apply(null,arguments)}function cW(e,r){if(e==null)return{};var n,a,l=uW(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function uW(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var JP=g.createContext(void 0),dW=e=>{var r=g.useContext(JP);if(r!=null)return r.stackId;if(e!=null)return YL(e)},mW=(e,r)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(r),fW=e=>{var r=g.useContext(JP);if(r!=null){var{stackId:n}=r;return"url(#".concat(mW(n,e),")")}},eM=e=>{var{index:r}=e,n=cW(e,oW),a=fW(r);return g.createElement($n,Db({className:"recharts-bar-stack-layer",clipPath:a},n))},pW=["onMouseEnter","onMouseLeave","onClick"],hW=["value","background","tooltipPosition"],vW=["id"],gW=["onMouseEnter","onClick","onMouseLeave"];function li(){return li=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},li.apply(null,arguments)}function BE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Fr(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?BE(Object(n),!0).forEach(function(a){xW(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function xW(e,r,n){return(r=bW(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function bW(e){var r=yW(e,"string");return typeof r=="symbol"?r:r+""}function yW(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function bf(e,r){if(e==null)return{};var n,a,l=jW(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function jW(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var _W=e=>{var{dataKey:r,name:n,fill:a,legendType:l,hide:o}=e;return[{inactive:o,dataKey:r,type:l,color:a,value:Hf(n,r),payload:e}]},NW=g.memo(e=>{var{dataKey:r,stroke:n,strokeWidth:a,fill:l,name:o,hide:u,unit:d,tooltipType:m,id:p}=e,h={dataDefinedOnItem:void 0,getPosition:al,settings:{stroke:n,strokeWidth:a,fill:l,dataKey:r,nameKey:void 0,name:Hf(o,r),hide:u,type:m,color:l,unit:d,graphicalItemId:p}};return g.createElement(OP,{tooltipEntrySettings:h})});function SW(e){var r=Be(Zs),{data:n,dataKey:a,background:l,allOtherBarProps:o}=e,{onMouseEnter:u,onMouseLeave:d,onClick:m}=o,p=bf(o,pW),h=AP(u,a,o.id),v=zP(d),b=kP(m,a,o.id);if(!l||n==null)return null;var x=mu(l);return g.createElement(Vn,{zIndex:QQ(l,_r.barBackground)},n.map((j,_)=>{var{value:w,background:C,tooltipPosition:E}=j,S=bf(j,hW);if(!C)return null;var A=h(j,_),z=v(j,_),k=b(j,_),P=Fr(Fr(Fr(Fr(Fr({option:l,isActive:String(_)===r},S),{},{fill:"#eee"},C),x),sy(p,j,_)),{},{onMouseEnter:A,onMouseLeave:z,onClick:k,dataKey:a,index:_,className:"recharts-bar-background-rectangle"});return g.createElement(xf,li({key:"background-bar-".concat(_)},P))}))}function wW(e){var{showLabels:r,children:n,rects:a}=e,l=a?.map(o=>{var u={x:o.x,y:o.y,width:o.width,lowerWidth:o.width,upperWidth:o.width,height:o.height};return Fr(Fr({},u),{},{value:o.value,payload:o.payload,parentViewBox:o.parentViewBox,viewBox:u,fill:o.fill})});return g.createElement(yP,{value:r?l:void 0},n)}function CW(e){var{shape:r,activeBar:n,baseProps:a,entry:l,index:o,dataKey:u}=e,d=Be(Zs),m=Be(ZD),p=n&&String(o)===d&&(m==null||u===m),h=p?n:r;return p?g.createElement(Vn,{zIndex:_r.activeBar},g.createElement(eM,{index:o},g.createElement(xf,li({},a,{name:String(a.name)},l,{isActive:p,option:h,index:o,dataKey:u})))):g.createElement(xf,li({},a,{name:String(a.name)},l,{isActive:p,option:h,index:o,dataKey:u}))}function EW(e){var{shape:r,baseProps:n,entry:a,index:l,dataKey:o}=e;return g.createElement(xf,li({},n,{name:String(n.name)},a,{isActive:!1,option:r,index:l,dataKey:o}))}function AW(e){var r,{data:n,props:a}=e,l=(r=ra(a))!==null&&r!==void 0?r:{},{id:o}=l,u=bf(l,vW),{shape:d,dataKey:m,activeBar:p}=a,{onMouseEnter:h,onClick:v,onMouseLeave:b}=a,x=bf(a,gW),j=AP(h,m,o),_=zP(b),w=kP(v,m,o);return n?g.createElement(g.Fragment,null,n.map((C,E)=>g.createElement(eM,li({index:E,key:"rectangle-".concat(C?.x,"-").concat(C?.y,"-").concat(C?.value,"-").concat(E),className:"recharts-bar-rectangle"},sy(x,C,E),{onMouseEnter:j(C,E),onMouseLeave:_(C,E),onClick:w(C,E)}),p?g.createElement(CW,{shape:d,activeBar:p,baseProps:u,entry:C,index:E,dataKey:m}):g.createElement(EW,{shape:d,baseProps:u,entry:C,index:E,dataKey:m})))):null}function zW(e){var{props:r,previousRectanglesRef:n}=e,{data:a,layout:l,isAnimationActive:o,animationBegin:u,animationDuration:d,animationEasing:m,onAnimationEnd:p,onAnimationStart:h}=r,v=n.current,b=rp(r,"recharts-bar-"),[x,j]=g.useState(!1),_=!x,w=g.useCallback(()=>{typeof p=="function"&&p(),j(!1)},[p]),C=g.useCallback(()=>{typeof h=="function"&&h(),j(!0)},[h]);return g.createElement(wW,{showLabels:_,rects:a},g.createElement(tp,{animationId:b,begin:u,duration:d,isActive:o,easing:m,onAnimationEnd:w,onAnimationStart:C,key:b},E=>{var S=E===1?a:a?.map((A,z)=>{var k=v&&v[z];if(k)return Fr(Fr({},A),{},{x:Qt(k.x,A.x,E),y:Qt(k.y,A.y,E),width:Qt(k.width,A.width,E),height:Qt(k.height,A.height,E)});if(l==="horizontal"){var P=Qt(0,A.height,E),D=Qt(A.stackedBarStart,A.y,E);return Fr(Fr({},A),{},{y:D,height:P})}var $=Qt(0,A.width,E),F=Qt(A.stackedBarStart,A.x,E);return Fr(Fr({},A),{},{width:$,x:F})});return E>0&&(n.current=S??null),S==null?null:g.createElement($n,null,g.createElement(AW,{props:r,data:S}))}),g.createElement(_P,{label:r.label}),r.children)}function kW(e){var r=g.useRef(null);return g.createElement(zW,{previousRectanglesRef:r,props:e})}var tM=0,OW=(e,r)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:ir(e,r)}};class DW extends g.PureComponent{render(){var{hide:r,data:n,dataKey:a,className:l,xAxisId:o,yAxisId:u,needClip:d,background:m,id:p}=this.props;if(r||n==null)return null;var h=Ct("recharts-bar",l),v=p;return g.createElement($n,{className:h,id:p},d&&g.createElement("defs",null,g.createElement(GP,{clipPathId:v,xAxisId:o,yAxisId:u})),g.createElement($n,{className:"recharts-bar-rectangles",clipPath:d?"url(#clipPath-".concat(v,")"):void 0},g.createElement(SW,{data:n,dataKey:a,background:m,allOtherBarProps:this.props}),g.createElement(kW,this.props)))}}var PW={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:tM,xAxisId:0,yAxisId:0,zIndex:_r.bar};function MW(e){var{xAxisId:r,yAxisId:n,hide:a,legendType:l,minPointSize:o,activeBar:u,animationBegin:d,animationDuration:m,animationEasing:p,isAnimationActive:h}=e,{needClip:v}=wj(r,n),b=il(),x=Lr(),j=TV(e.children,bj),_=Be(E=>lW(E,e.id,x,j));if(b!=="vertical"&&b!=="horizontal")return null;var w,C=_?.[0];return C==null||C.height==null||C.width==null?w=0:w=b==="vertical"?C.height/2:C.width/2,g.createElement(FP,{xAxisId:r,yAxisId:n,data:_,dataPointFormatter:OW,errorBarOffset:w},g.createElement(DW,li({},e,{layout:b,needClip:v,data:_,xAxisId:r,yAxisId:n,hide:a,legendType:l,minPointSize:o,activeBar:u,animationBegin:d,animationDuration:m,animationEasing:p,isAnimationActive:h})))}function TW(e){var{layout:r,barSettings:{dataKey:n,minPointSize:a},pos:l,bandSize:o,xAxis:u,yAxis:d,xAxisTicks:m,yAxisTicks:p,stackedData:h,displayedData:v,offset:b,cells:x,parentViewBox:j,dataStartIndex:_}=e,w=r==="horizontal"?d:u,C=h?w.scale.domain():null,E=KL({numericAxis:w}),S=w.scale.map(E);return v.map((A,z)=>{var k,P,D,$,F,Y;if(h){var M=h[z+_];if(M==null)return null;k=FL(M,C)}else k=ir(A,n),Array.isArray(k)||(k=[E,k]);var K=GK(a,tM)(k[1],z);if(r==="horizontal"){var ee,X=d.scale.map(k[0]),L=d.scale.map(k[1]);if(X==null||L==null)return null;P=Cw({axis:u,ticks:m,bandSize:o,offset:l.offset,entry:A,index:z}),D=(ee=L??X)!==null&&ee!==void 0?ee:void 0,$=l.size;var I=X-L;if(F=_a(I)?0:I,Y={x:P,y:b.top,width:$,height:b.height},Math.abs(K)>0&&Math.abs(F)<Math.abs(K)){var U=nn(F||K)*(Math.abs(K)-Math.abs(F));D-=U,F+=U}}else{var B=u.scale.map(k[0]),T=u.scale.map(k[1]);if(B==null||T==null)return null;if(P=B,D=Cw({axis:d,ticks:p,bandSize:o,offset:l.offset,entry:A,index:z}),$=T-B,F=l.size,Y={x:b.left,y:D,width:b.width,height:F},Math.abs(K)>0&&Math.abs($)<Math.abs(K)){var Z=nn($||K)*(Math.abs(K)-Math.abs($));$+=Z}}if(P==null||D==null||$==null||F==null)return null;var H=Fr(Fr({},A),{},{stackedBarStart:S,x:P,y:D,width:$,height:F,value:h?k:k[1],payload:A,background:Y,tooltipPosition:{x:P+$/2,y:D+F/2},parentViewBox:j},x&&x[z]&&x[z].props);return H}).filter(Boolean)}function qW(e){var r=Qr(e,PW),n=dW(r.stackId),a=Lr();return g.createElement(PP,{id:r.id,type:"bar"},l=>g.createElement(g.Fragment,null,g.createElement(DP,{legendPayload:_W(r)}),g.createElement(NW,{dataKey:r.dataKey,stroke:r.stroke,strokeWidth:r.strokeWidth,fill:r.fill,name:r.name,hide:r.hide,unit:r.unit,tooltipType:r.tooltipType,id:l}),g.createElement(TP,{type:"bar",id:l,data:void 0,xAxisId:r.xAxisId,yAxisId:r.yAxisId,zAxisId:0,dataKey:r.dataKey,stackId:n,hide:r.hide,barSize:r.barSize,minPointSize:r.minPointSize,maxBarSize:r.maxBarSize,isPanorama:a}),g.createElement(Vn,{zIndex:r.zIndex},g.createElement(MW,li({},r,{id:l})))))}var rM=g.memo(qW,_p);rM.displayName="Bar";var RW=["domain","range"],IW=["domain","range"];function UE(e,r){if(e==null)return{};var n,a,l=LW(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function LW(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function FE(e,r){return e===r?!0:Array.isArray(e)&&e.length===2&&Array.isArray(r)&&r.length===2?e[0]===r[0]&&e[1]===r[1]:!1}function nM(e,r){if(e===r)return!0;var{domain:n,range:a}=e,l=UE(e,RW),{domain:o,range:u}=r,d=UE(r,IW);return!FE(n,o)||!FE(a,u)?!1:_p(l,d)}var $W=["type"],BW=["dangerouslySetInnerHTML","ticks","scale"],UW=["id","scale"];function Pb(){return Pb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Pb.apply(null,arguments)}function GE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function HE(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?GE(Object(n),!0).forEach(function(a){FW(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function FW(e,r,n){return(r=GW(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function GW(e){var r=HW(e,"string");return typeof r=="symbol"?r:r+""}function HW(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Mb(e,r){if(e==null)return{};var n,a,l=VW(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function VW(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function QW(e){var r=Zt(),n=g.useRef(null),a=zk(),{type:l}=e,o=Mb(e,$W),u=dp(a,"xAxis",l),d=g.useMemo(()=>{if(u!=null)return HE(HE({},o),{},{type:u})},[o,u]);return g.useLayoutEffect(()=>{d!=null&&(n.current===null?r(NQ(d)):n.current!==d&&r(SQ({prev:n.current,next:d})),n.current=d)},[d,r]),g.useLayoutEffect(()=>()=>{n.current&&(r(wQ(n.current)),n.current=null)},[r]),null}var YW=e=>{var{xAxisId:r,className:n}=e,a=Be(vy),l=Lr(),o="xAxis",u=Be(C=>OD(C,o,r,l)),d=Be(C=>ED(C,r)),m=Be(C=>tF(C,r)),p=Be(C=>WO(C,r));if(d==null||m==null||p==null)return null;var{dangerouslySetInnerHTML:h,ticks:v,scale:b}=e,x=Mb(e,BW),{id:j,scale:_}=p,w=Mb(p,UW);return g.createElement(Sj,Pb({},x,w,{x:m.x,y:m.y,width:d.width,height:d.height,className:Ct("recharts-".concat(o," ").concat(o),n),viewBox:a,ticks:u,axisType:o}))},KW={allowDataOverflow:vr.allowDataOverflow,allowDecimals:vr.allowDecimals,allowDuplicatedCategory:vr.allowDuplicatedCategory,angle:vr.angle,axisLine:ei.axisLine,height:vr.height,hide:!1,includeHidden:vr.includeHidden,interval:vr.interval,label:!1,minTickGap:vr.minTickGap,mirror:vr.mirror,orientation:vr.orientation,padding:vr.padding,reversed:vr.reversed,scale:vr.scale,tick:vr.tick,tickCount:vr.tickCount,tickLine:ei.tickLine,tickSize:ei.tickSize,type:vr.type,xAxisId:0},WW=e=>{var r=Qr(e,KW);return g.createElement(g.Fragment,null,g.createElement(QW,{allowDataOverflow:r.allowDataOverflow,allowDecimals:r.allowDecimals,allowDuplicatedCategory:r.allowDuplicatedCategory,angle:r.angle,dataKey:r.dataKey,domain:r.domain,height:r.height,hide:r.hide,id:r.xAxisId,includeHidden:r.includeHidden,interval:r.interval,minTickGap:r.minTickGap,mirror:r.mirror,name:r.name,orientation:r.orientation,padding:r.padding,reversed:r.reversed,scale:r.scale,tick:r.tick,tickCount:r.tickCount,tickFormatter:r.tickFormatter,ticks:r.ticks,type:r.type,unit:r.unit}),g.createElement(YW,r))},Tb=g.memo(WW,nM);Tb.displayName="XAxis";var XW=["type"],ZW=["dangerouslySetInnerHTML","ticks","scale"],JW=["id","scale"];function qb(){return qb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},qb.apply(null,arguments)}function VE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function QE(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?VE(Object(n),!0).forEach(function(a){eX(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function eX(e,r,n){return(r=tX(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function tX(e){var r=rX(e,"string");return typeof r=="symbol"?r:r+""}function rX(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Rb(e,r){if(e==null)return{};var n,a,l=nX(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function nX(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function aX(e){var r=Zt(),n=g.useRef(null),a=zk(),{type:l}=e,o=Rb(e,XW),u=dp(a,"yAxis",l),d=g.useMemo(()=>{if(u!=null)return QE(QE({},o),{},{type:u})},[u,o]);return g.useLayoutEffect(()=>{d!=null&&(n.current===null?r(CQ(d)):n.current!==d&&r(EQ({prev:n.current,next:d})),n.current=d)},[d,r]),g.useLayoutEffect(()=>()=>{n.current&&(r(AQ(n.current)),n.current=null)},[r]),null}function iX(e){var{yAxisId:r,className:n,width:a,label:l}=e,o=g.useRef(null),u=g.useRef(null),d=Be(vy),m=Lr(),p=Zt(),h="yAxis",v=Be(k=>AD(k,r)),b=Be(k=>nF(k,r)),x=Be(k=>OD(k,h,r,m)),j=Be(k=>XO(k,r));if(g.useLayoutEffect(()=>{if(!(a!=="auto"||!v||jj(l)||g.isValidElement(l)||j==null)){var k=o.current;if(k){var P=k.getCalculatedWidth();Math.round(v.width)!==Math.round(P)&&p(zQ({id:r,width:P}))}}},[x,v,p,l,r,a,j]),v==null||b==null||j==null)return null;var{dangerouslySetInnerHTML:_,ticks:w,scale:C}=e,E=Rb(e,ZW),{id:S,scale:A}=j,z=Rb(j,JW);return g.createElement(Sj,qb({},E,z,{ref:o,labelRef:u,x:b.x,y:b.y,tickTextProps:a==="auto"?{width:void 0}:{width:a},width:v.width,height:v.height,className:Ct("recharts-".concat(h," ").concat(h),n),viewBox:d,ticks:x,axisType:h}))}var sX={allowDataOverflow:gr.allowDataOverflow,allowDecimals:gr.allowDecimals,allowDuplicatedCategory:gr.allowDuplicatedCategory,angle:gr.angle,axisLine:ei.axisLine,hide:!1,includeHidden:gr.includeHidden,interval:gr.interval,label:!1,minTickGap:gr.minTickGap,mirror:gr.mirror,orientation:gr.orientation,padding:gr.padding,reversed:gr.reversed,scale:gr.scale,tick:gr.tick,tickCount:gr.tickCount,tickLine:ei.tickLine,tickSize:ei.tickSize,type:gr.type,width:gr.width,yAxisId:0},lX=e=>{var r=Qr(e,sX);return g.createElement(g.Fragment,null,g.createElement(aX,{interval:r.interval,id:r.yAxisId,scale:r.scale,type:r.type,domain:r.domain,allowDataOverflow:r.allowDataOverflow,dataKey:r.dataKey,allowDuplicatedCategory:r.allowDuplicatedCategory,allowDecimals:r.allowDecimals,tickCount:r.tickCount,padding:r.padding,includeHidden:r.includeHidden,reversed:r.reversed,ticks:r.ticks,width:r.width,orientation:r.orientation,mirror:r.mirror,hide:r.hide,unit:r.unit,name:r.name,angle:r.angle,minTickGap:r.minTickGap,tick:r.tick,tickFormatter:r.tickFormatter}),g.createElement(iX,r))},Ib=g.memo(lX,nM);Ib.displayName="YAxis";var oX=(e,r)=>r,Ej=me([oX,jt,YO,Cr,YD,gi,xG,Nr],wG),Aj=e=>{var r=e.currentTarget.getBoundingClientRect(),n=r.width/e.currentTarget.offsetWidth,a=r.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-r.left)/n),chartY:Math.round((e.clientY-r.top)/a)}},aM=Bn("mouseClick"),iM=hu();iM.startListening({actionCreator:aM,effect:(e,r)=>{var n=e.payload,a=Ej(r.getState(),Aj(n));a?.activeIndex!=null&&r.dispatch(gF({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}});var Lb=Bn("mouseMove"),sM=hu(),om=null;sM.startListening({actionCreator:Lb,effect:(e,r)=>{var n=e.payload;om!==null&&cancelAnimationFrame(om);var a=Aj(n);om=requestAnimationFrame(()=>{var l=r.getState(),o=cj(l,l.tooltip.settings.shared);if(o==="axis"){var u=Ej(l,a);u?.activeIndex!=null?r.dispatch(LD({activeIndex:u.activeIndex,activeDataKey:void 0,activeCoordinate:u.activeCoordinate})):r.dispatch(ID())}om=null})}});function cX(e,r){return r instanceof HTMLElement?"HTMLElement <".concat(r.tagName,' class="').concat(r.className,'">'):r===window?"global.window":e==="children"&&typeof r=="object"&&r!==null?"<<CHILDREN>>":r}var YE={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},lM=ln({name:"rootProps",initialState:YE,reducers:{updateOptions:(e,r)=>{var n;e.accessibilityLayer=r.payload.accessibilityLayer,e.barCategoryGap=r.payload.barCategoryGap,e.barGap=(n=r.payload.barGap)!==null&&n!==void 0?n:YE.barGap,e.barSize=r.payload.barSize,e.maxBarSize=r.payload.maxBarSize,e.stackOffset=r.payload.stackOffset,e.syncId=r.payload.syncId,e.syncMethod=r.payload.syncMethod,e.className=r.payload.className,e.baseValue=r.payload.baseValue,e.reverseStackOrder=r.payload.reverseStackOrder}}}),uX=lM.reducer,{updateOptions:dX}=lM.actions,mX=null,fX={updatePolarOptions:(e,r)=>r.payload},oM=ln({name:"polarOptions",initialState:mX,reducers:fX}),{updatePolarOptions:Pre}=oM.actions,pX=oM.reducer,cM=Bn("keyDown"),uM=Bn("focus"),zj=hu();zj.startListening({actionCreator:cM,effect:(e,r)=>{var n=r.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:l}=n.tooltip,o=e.payload;if(!(o!=="ArrowRight"&&o!=="ArrowLeft"&&o!=="Enter")){var u=uj(l,Po(n),wu(n),Eu(n)),d=u==null?-1:Number(u);if(!(!Number.isFinite(d)||d<0)){var m=gi(n);if(o==="Enter"){var p=mf(n,"axis","hover",String(l.index));r.dispatch(wb({active:!l.active,activeIndex:l.index,activeCoordinate:p}));return}var h=lF(n),v=h==="left-to-right"?1:-1,b=o==="ArrowRight"?1:-1,x=d+b*v;if(!(m==null||x>=m.length||x<0)){var j=mf(n,"axis","hover",String(x));r.dispatch(wb({active:!0,activeIndex:x.toString(),activeCoordinate:j}))}}}}}});zj.startListening({actionCreator:uM,effect:(e,r)=>{var n=r.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:l}=n.tooltip;if(!l.active&&l.index==null){var o="0",u=mf(n,"axis","hover",String(o));r.dispatch(wb({active:!0,activeIndex:o,activeCoordinate:u}))}}}});var qn=Bn("externalEvent"),dM=hu(),Ox=new Map;dM.startListening({actionCreator:qn,effect:(e,r)=>{var{handler:n,reactEvent:a}=e.payload;if(n!=null){a.persist();var l=a.type,o=Ox.get(l);o!==void 0&&cancelAnimationFrame(o);var u=requestAnimationFrame(()=>{try{var d=r.getState(),m={activeCoordinate:rG(d),activeDataKey:ZD(d),activeIndex:Zs(d),activeLabel:XD(d),activeTooltipIndex:Zs(d),isTooltipActive:nG(d)};n(m,a)}finally{Ox.delete(l)}});Ox.set(l,u)}}});var hX=me([Oo],e=>e.tooltipItemPayloads),vX=me([hX,(e,r)=>r,(e,r,n)=>n],(e,r,n)=>{if(r!=null){var a=e.find(o=>o.settings.graphicalItemId===n);if(a!=null){var{getPosition:l}=a;if(l!=null)return l(r)}}}),mM=Bn("touchMove"),fM=hu();fM.startListening({actionCreator:mM,effect:(e,r)=>{var n=e.payload;if(!(n.touches==null||n.touches.length===0)){var a=r.getState(),l=cj(a,a.tooltip.settings.shared);if(l==="axis"){var o=n.touches[0];if(o==null)return;var u=Ej(a,Aj({clientX:o.clientX,clientY:o.clientY,currentTarget:n.currentTarget}));u?.activeIndex!=null&&r.dispatch(LD({activeIndex:u.activeIndex,activeDataKey:void 0,activeCoordinate:u.activeCoordinate}))}else if(l==="item"){var d,m=n.touches[0];if(document.elementFromPoint==null||m==null)return;var p=document.elementFromPoint(m.clientX,m.clientY);if(!p||!p.getAttribute)return;var h=p.getAttribute(r8),v=(d=p.getAttribute(n8))!==null&&d!==void 0?d:void 0,b=Do(a).find(_=>_.id===v);if(h==null||b==null||v==null)return;var{dataKey:x}=b,j=vX(a,h,v);r.dispatch(RD({activeDataKey:x,activeIndex:h,activeCoordinate:j,activeGraphicalItemId:v}))}}}});var gX=Hz({brush:KQ,cartesianAxis:kQ,chartData:rH,errorBars:FY,graphicalItems:oQ,layout:IL,legend:Y8,options:XG,polarAxis:kV,polarOptions:pX,referenceElements:JQ,rootProps:uX,tooltip:xF,zIndex:LG}),xX=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return cL({reducer:gX,preloadedState:r,middleware:a=>{var l;return a({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((l="es6")!==null&&l!==void 0?l:"")}).concat([iM.middleware,sM.middleware,zj.middleware,dM.middleware,fM.middleware])},enhancers:a=>{var l=a;return typeof a=="function"&&(l=a()),l.concat(sk({type:"raf"}))},devTools:{serialize:{replacer:cX},name:"recharts-".concat(n)}})};function bX(e){var{preloadedState:r,children:n,reduxStoreName:a}=e,l=Lr(),o=g.useRef(null);if(l)return n;o.current==null&&(o.current=xX(r,a));var u=cy;return g.createElement(xK,{context:u,store:o.current},n)}function yX(e){var{layout:r,margin:n}=e,a=Zt(),l=Lr();return g.useEffect(()=>{l||(a(TL(r)),a(ML(n)))},[a,l,r,n]),null}var jX=g.memo(yX,_p);function _X(e){var r=Zt();return g.useEffect(()=>{r(dX(e))},[r,e]),null}function KE(e){var{zIndex:r,isPanorama:n}=e,a=g.useRef(null),l=Zt();return g.useLayoutEffect(()=>(a.current&&l(RG({zIndex:r,element:a.current,isPanorama:n})),()=>{l(IG({zIndex:r,isPanorama:n}))}),[l,r,n]),g.createElement("g",{tabIndex:-1,ref:a})}function WE(e){var{children:r,isPanorama:n}=e,a=Be(EG);if(!a||a.length===0)return r;var l=a.filter(u=>u<0),o=a.filter(u=>u>0);return g.createElement(g.Fragment,null,l.map(u=>g.createElement(KE,{key:u,zIndex:u,isPanorama:n})),r,o.map(u=>g.createElement(KE,{key:u,zIndex:u,isPanorama:n})))}var NX=["children"];function SX(e,r){if(e==null)return{};var n,a,l=wX(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function wX(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function yf(){return yf=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},yf.apply(null,arguments)}var CX={width:"100%",height:"100%",display:"block"},EX=g.forwardRef((e,r)=>{var n=Ek(),a=Ak(),l=Ik();if(!Sa(n)||!Sa(a))return null;var{children:o,otherAttributes:u,title:d,desc:m}=e,p,h;return u!=null&&(typeof u.tabIndex=="number"?p=u.tabIndex:p=l?0:void 0,typeof u.role=="string"?h=u.role:h=l?"application":void 0),g.createElement(cz,yf({},u,{title:d,desc:m,role:h,tabIndex:p,width:n,height:a,style:CX,ref:r}),o)}),AX=e=>{var{children:r}=e,n=Be(Kf);if(!n)return null;var{width:a,height:l,y:o,x:u}=n;return g.createElement(cz,{width:a,height:l,x:u,y:o},r)},XE=g.forwardRef((e,r)=>{var{children:n}=e,a=SX(e,NX),l=Lr();return l?g.createElement(AX,null,g.createElement(WE,{isPanorama:!0},n)):g.createElement(EX,yf({ref:r},a),g.createElement(WE,{isPanorama:!1},n))});function zX(){var e=Zt(),[r,n]=g.useState(null),a=Be(t8);return g.useEffect(()=>{if(r!=null){var l=r.getBoundingClientRect(),o=l.width/r.offsetWidth;ut(o)&&o!==a&&e(RL(o))}},[r,e,a]),n}function ZE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function kX(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?ZE(Object(n),!0).forEach(function(a){OX(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function OX(e,r,n){return(r=DX(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function DX(e){var r=PX(e,"string");return typeof r=="symbol"?r:r+""}function PX(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function es(){return es=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},es.apply(null,arguments)}var MX=()=>(dH(),null);function jf(e){if(typeof e=="number")return e;if(typeof e=="string"){var r=parseFloat(e);if(!Number.isNaN(r))return r}return 0}var TX=g.forwardRef((e,r)=>{var n,a,l=g.useRef(null),[o,u]=g.useState({containerWidth:jf((n=e.style)===null||n===void 0?void 0:n.width),containerHeight:jf((a=e.style)===null||a===void 0?void 0:a.height)}),d=g.useCallback((p,h)=>{u(v=>{var b=Math.round(p),x=Math.round(h);return v.containerWidth===b&&v.containerHeight===x?v:{containerWidth:b,containerHeight:x}})},[]),m=g.useCallback(p=>{if(typeof r=="function"&&r(p),p!=null&&typeof ResizeObserver<"u"){var{width:h,height:v}=p.getBoundingClientRect();d(h,v);var b=j=>{var _=j[0];if(_!=null){var{width:w,height:C}=_.contentRect;d(w,C)}},x=new ResizeObserver(b);x.observe(p),l.current=x}},[r,d]);return g.useEffect(()=>()=>{var p=l.current;p?.disconnect()},[d]),g.createElement(g.Fragment,null,g.createElement(gu,{width:o.containerWidth,height:o.containerHeight}),g.createElement("div",es({ref:m},e)))}),qX=g.forwardRef((e,r)=>{var{width:n,height:a}=e,[l,o]=g.useState({containerWidth:jf(n),containerHeight:jf(a)}),u=g.useCallback((m,p)=>{o(h=>{var v=Math.round(m),b=Math.round(p);return h.containerWidth===v&&h.containerHeight===b?h:{containerWidth:v,containerHeight:b}})},[]),d=g.useCallback(m=>{if(typeof r=="function"&&r(m),m!=null){var{width:p,height:h}=m.getBoundingClientRect();u(p,h)}},[r,u]);return g.createElement(g.Fragment,null,g.createElement(gu,{width:l.containerWidth,height:l.containerHeight}),g.createElement("div",es({ref:d},e)))}),RX=g.forwardRef((e,r)=>{var{width:n,height:a}=e;return g.createElement(g.Fragment,null,g.createElement(gu,{width:n,height:a}),g.createElement("div",es({ref:r},e)))}),IX=g.forwardRef((e,r)=>{var{width:n,height:a}=e;return typeof n=="string"||typeof a=="string"?g.createElement(qX,es({},e,{ref:r})):typeof n=="number"&&typeof a=="number"?g.createElement(RX,es({},e,{width:n,height:a,ref:r})):g.createElement(g.Fragment,null,g.createElement(gu,{width:n,height:a}),g.createElement("div",es({ref:r},e)))});function LX(e){return e?TX:IX}var $X=g.forwardRef((e,r)=>{var{children:n,className:a,height:l,onClick:o,onContextMenu:u,onDoubleClick:d,onMouseDown:m,onMouseEnter:p,onMouseLeave:h,onMouseMove:v,onMouseUp:b,onTouchEnd:x,onTouchMove:j,onTouchStart:_,style:w,width:C,responsive:E,dispatchTouchEvents:S=!0}=e,A=g.useRef(null),z=Zt(),[k,P]=g.useState(null),[D,$]=g.useState(null),F=zX(),Y=gy(),M=Y?.width>0?Y.width:C,K=Y?.height>0?Y.height:l,ee=g.useCallback(de=>{F(de),typeof r=="function"&&r(de),P(de),$(de),de!=null&&(A.current=de)},[F,r,P,$]),X=g.useCallback(de=>{z(aM(de)),z(qn({handler:o,reactEvent:de}))},[z,o]),L=g.useCallback(de=>{z(Lb(de)),z(qn({handler:p,reactEvent:de}))},[z,p]),I=g.useCallback(de=>{z(ID()),z(qn({handler:h,reactEvent:de}))},[z,h]),U=g.useCallback(de=>{z(Lb(de)),z(qn({handler:v,reactEvent:de}))},[z,v]),B=g.useCallback(()=>{z(uM())},[z]),T=g.useCallback(de=>{z(cM(de.key))},[z]),Z=g.useCallback(de=>{z(qn({handler:u,reactEvent:de}))},[z,u]),H=g.useCallback(de=>{z(qn({handler:d,reactEvent:de}))},[z,d]),ce=g.useCallback(de=>{z(qn({handler:m,reactEvent:de}))},[z,m]),xe=g.useCallback(de=>{z(qn({handler:b,reactEvent:de}))},[z,b]),fe=g.useCallback(de=>{z(qn({handler:_,reactEvent:de}))},[z,_]),G=g.useCallback(de=>{S&&z(mM(de)),z(qn({handler:j,reactEvent:de}))},[z,S,j]),ve=g.useCallback(de=>{z(qn({handler:x,reactEvent:de}))},[z,x]),De=LX(E);return g.createElement(iP.Provider,{value:k},g.createElement(FI.Provider,{value:D},g.createElement(De,{width:M??w?.width,height:K??w?.height,className:Ct("recharts-wrapper",a),style:kX({position:"relative",cursor:"default",width:M,height:K},w),onClick:X,onContextMenu:Z,onDoubleClick:H,onFocus:B,onKeyDown:T,onMouseDown:ce,onMouseEnter:L,onMouseLeave:I,onMouseMove:U,onMouseUp:xe,onTouchEnd:ve,onTouchMove:G,onTouchStart:fe,ref:ee},g.createElement(MX,null),n)))}),BX=["width","height","responsive","children","className","style","compact","title","desc"];function UX(e,r){if(e==null)return{};var n,a,l=FX(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function FX(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var GX=g.forwardRef((e,r)=>{var{width:n,height:a,responsive:l,children:o,className:u,style:d,compact:m,title:p,desc:h}=e,v=UX(e,BX),b=ra(v);return m?g.createElement(g.Fragment,null,g.createElement(gu,{width:n,height:a}),g.createElement(XE,{otherAttributes:b,title:p,desc:h},o)):g.createElement($X,{className:u,style:d,width:n,height:a,responsive:l??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},g.createElement(XE,{otherAttributes:b,title:p,desc:h,ref:r},g.createElement(tY,null,o)))});function $b(){return $b=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},$b.apply(null,arguments)}var HX={top:5,right:5,bottom:5,left:5},VX={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:HX,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},pM=g.forwardRef(function(r,n){var a,l=Qr(r.categoricalChartProps,VX),{chartName:o,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:m,categoricalChartProps:p}=r,h={chartName:o,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:m,eventEmitter:void 0};return g.createElement(bX,{preloadedState:{options:h},reduxStoreName:(a=p.id)!==null&&a!==void 0?a:o},g.createElement(YQ,{chartData:p.data}),g.createElement(jX,{layout:l.layout,margin:l.margin}),g.createElement(_X,{baseValue:l.baseValue,accessibilityLayer:l.accessibilityLayer,barCategoryGap:l.barCategoryGap,maxBarSize:l.maxBarSize,stackOffset:l.stackOffset,barGap:l.barGap,barSize:l.barSize,syncId:l.syncId,syncMethod:l.syncMethod,className:l.className,reverseStackOrder:l.reverseStackOrder}),g.createElement(GX,$b({},l,{ref:n})))}),QX=["axis"],YX=g.forwardRef((e,r)=>g.createElement(pM,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:QX,tooltipPayloadSearcher:sP,categoricalChartProps:e,ref:r})),KX=["axis","item"],WX=g.forwardRef((e,r)=>g.createElement(pM,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:KX,tooltipPayloadSearcher:sP,categoricalChartProps:e,ref:r}));const XX=8,ZX=12,JX=14,eZ=1;function kj(e){return e instanceof Ee?e.toDate():e instanceof Date?e:e?.seconds?new Date(e.seconds*1e3):new Date(e)}function JE(e,r){return e.getFullYear()===r.getFullYear()&&e.getMonth()===r.getMonth()&&e.getDate()===r.getDate()}function Np(){const e=new Date,r=e.getDay(),n=r===0?-6:1-r,a=new Date(e);return a.setDate(e.getDate()+n),a.setHours(0,0,0,0),a}function tZ(){const e=Np(),r=new Date(e);return r.setDate(e.getDate()+6),r.setHours(23,59,59,999),r}function Dx(e,r){return Math.floor(Math.abs(r.getTime()-e.getTime())/864e5)}async function Sp(e){try{const r=ze(_e(V,"quiz_results"),Se("userId","==",e),Qe("datePassage","desc"));return(await Ae(r)).docs.map(a=>({id:a.id,...a.data()}))}catch(r){return console.error("Erreur rcupration rsultats lve:",r),[]}}async function rZ(e){try{const r=await Sp(e);if(r.length===0)return[];const n=new Map;r.forEach(o=>{const u=o.disciplineId;n.has(u)||n.set(u,[]),n.get(u).push(o)});const a=[];n.forEach((o,u)=>{if(o.length<eZ)return;const d=o.map(w=>w.pourcentage/100*20),m=d.reduce((w,C)=>w+C,0)/d.length;if(m>=JX)return;let p="stable";if(d.length>=3){const w=d.slice(0,2),C=d.slice(2,4),E=w.reduce((z,k)=>z+k,0)/w.length,S=C.reduce((z,k)=>z+k,0)/C.length,A=E-S;A>1.5?p="hausse":A<-1.5&&(p="baisse")}let h="modere";m<XX?h="critique":m<ZX&&(h="important");const v=d[0],b=Math.max(...d),x=Math.min(...d),j=kj(o[0].datePassage),_=o[0].disciplineNom||"Discipline inconnue";a.push({id:`lacune_${u}`,disciplineId:u,disciplineNom:_,moyenne:Math.round(m*10)/10,nombreQuiz:o.length,tendance:p,niveauUrgence:h,dernierQuizDate:j,scoreDetails:{dernierScore:Math.round(v*10)/10,meilleurScore:Math.round(b*10)/10,pireScore:Math.round(x*10)/10}})});const l={critique:0,important:1,modere:2};return a.sort((o,u)=>{const d=l[o.niveauUrgence]-l[u.niveauUrgence];return d!==0?d:o.moyenne-u.moyenne}),a}catch(r){return console.error("Erreur dtection lacunes:",r),[]}}function nZ(e){const r=[];let n=1;return e.forEach(a=>{const{id:l,disciplineNom:o,niveauUrgence:u,moyenne:d,tendance:m}=a;switch(u){case"critique":r.push({id:`reco_cours_${l}`,lacuneId:l,type:"revoir_cours",titre:` Revoir les cours de ${o}`,description:`Ta moyenne est de ${d}/20 en ${o}. Il est important de reprendre les bases. Consulte les cours disponibles et prends des notes.`,disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date}),r.push({id:`reco_quiz_${l}`,lacuneId:l,type:"refaire_quiz",titre:` Refaire les quiz de ${o}`,description:"Aprs avoir rvis, refais les quiz pour vrifier ta comprhension. Vise au moins 12/20 !",disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date});break;case"important":r.push({id:`reco_exercice_${l}`,lacuneId:l,type:"exercice_cible",titre:` Exercices cibls en ${o}`,description:`Avec ${d}/20 de moyenne, concentre-toi sur les exercices pratiques. ${m==="hausse"?"Tu progresses, continue !":"Un effort supplmentaire est ncessaire."}`,disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date}),r.push({id:`reco_cours2_${l}`,lacuneId:l,type:"revoir_cours",titre:` Rviser les points cls en ${o}`,description:"Identifie les concepts qui te posent problme et revois-les attentivement.",disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date});break;case"modere":r.push({id:`reco_consolider_${l}`,lacuneId:l,type:"refaire_quiz",titre:` Consolider tes acquis en ${o}`,description:`Tu es proche du niveau attendu (${d}/20). Un quiz supplmentaire devrait suffire pour atteindre 14/20 !`,disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date});break}}),r}async function aZ(e){try{const r=await Sp(e);if(r.length===0)return{userId:e,streakActuel:0,meilleurStreak:0,dernierJourActif:null,totalJoursActifs:0,semaineCourante:[!1,!1,!1,!1,!1,!1,!1],historiqueHebdo:[]};const n=new Set;r.forEach(_=>{const w=kj(_.datePassage),C=`${w.getFullYear()}-${w.getMonth()}-${w.getDate()}`;n.add(C)});const a=Array.from(n).map(_=>{const[w,C,E]=_.split("-").map(Number);return new Date(w,C,E)}).sort((_,w)=>w.getTime()-_.getTime()),l=a.length,o=a[0];let u=0;const d=new Date;d.setHours(0,0,0,0);const m=a[0];if(Dx(m,d)<=1){u=1;for(let _=1;_<a.length&&Dx(a[_],a[_-1])===1;_++)u++}let h=0,v=1;for(let _=1;_<a.length;_++)Dx(a[_],a[_-1])===1?v++:(h=Math.max(h,v),v=1);h=Math.max(h,v,u);const b=Np(),x=[];for(let _=0;_<7;_++){const w=new Date(b);w.setDate(b.getDate()+_);const C=a.some(E=>JE(E,w));x.push(C)}const j=[];for(let _=0;_<4;_++){const w=new Date(b);w.setDate(b.getDate()-_*7);let C=0;for(let S=0;S<7;S++){const A=new Date(w);A.setDate(w.getDate()+S),a.some(z=>JE(z,A))&&C++}const E=Math.ceil((w.getDate()+new Date(w.getFullYear(),w.getMonth(),1).getDay())/7);j.push({semaine:_===0?"Cette sem.":`Sem. -${_}`,joursActifs:C})}return{userId:e,streakActuel:u,meilleurStreak:h,dernierJourActif:o,totalJoursActifs:l,semaineCourante:x,historiqueHebdo:j.reverse()}}catch(r){return console.error("Erreur calcul streak:",r),{userId:e,streakActuel:0,meilleurStreak:0,dernierJourActif:null,totalJoursActifs:0,semaineCourante:[!1,!1,!1,!1,!1,!1,!1],historiqueHebdo:[]}}}function iZ(e,r,n){const a=[],l=Np(),o=tZ(),u=r.length>2?5:3;if(a.push({id:`obj_quiz_${e}_${l.getTime()}`,userId:e,titre:`Passer ${u} quiz cette semaine`,description:`Entrane-toi en passant au moins ${u} quiz pour progresser dans tes matires.`,type:"quiz_count",cible:u,progression:0,statut:"en_cours",dateDebut:l,dateFin:o,recompense:' Badge "Travailleur"'}),r.length>0){const m=r[0],p=Math.min(m.moyenne+3,14);a.push({id:`obj_score_${e}_${l.getTime()}`,userId:e,titre:`Atteindre ${Math.round(p)}/20 en ${m.disciplineNom}`,description:`Ta moyenne actuelle est de ${m.moyenne}/20. Vise ${Math.round(p)}/20 lors de ton prochain quiz !`,type:"score_min",cible:Math.round(p),progression:Math.round(m.moyenne),statut:"en_cours",disciplineId:m.disciplineId,disciplineNom:m.disciplineNom,dateDebut:l,dateFin:o,recompense:' Badge "En progrs"'})}const d=n.streakActuel>=5?7:n.streakActuel+2;return a.push({id:`obj_streak_${e}_${l.getTime()}`,userId:e,titre:`Maintenir un streak de ${d} jours`,description:`Tu es actuellement  ${n.streakActuel} jour(s) conscutif(s). Continue !`,type:"streak",cible:d,progression:n.streakActuel,statut:n.streakActuel>=d?"atteint":"en_cours",dateDebut:l,dateFin:o,recompense:' Badge "Flamme"'}),a}function sZ(e,r,n,a){let l=0;if(a.length>0){const v=a.reduce((b,x)=>b+x.pourcentage/100*20,0)/a.length;l=Math.min(v/20*100,100)}let o=100;const u=e.filter(v=>v.niveauUrgence==="critique").length,d=e.filter(v=>v.niveauUrgence==="important").length;o-=u*25,o-=d*15,o=Math.max(o,0);const m=Math.min(r.streakActuel/7*100,100);let p=0;n.length>0&&(p=n.filter(b=>b.statut==="atteint").length/n.length*100);const h=l*.4+o*.25+m*.2+p*.15;return Math.round(Math.min(Math.max(h,0),100))}function lZ(e,r,n){const a=Np(),l=r.filter(o=>kj(o.datePassage)>=a);return e.map(o=>{const u={...o};switch(o.type){case"quiz_count":u.progression=l.length;break;case"score_min":if(o.disciplineId){const d=l.filter(m=>m.disciplineId===o.disciplineId);if(d.length>0){const m=Math.max(...d.map(p=>p.pourcentage));u.progression=Math.round(m/100*20)}}break;case"streak":u.progression=n.streakActuel;break}return u.progression>=u.cible&&(u.statut="atteint"),u})}async function Oj(e){try{const r=await rZ(e),n=nZ(r),a=await aZ(e);let l=iZ(e,r,a);const o=await Sp(e);l=lZ(l,o,a);const u=sZ(r,a,l,o);return{lacunes:r,recommandations:n,streak:a,objectifs:l,scoreGlobal:u}}catch(r){return console.error("Erreur suivi complet:",r),{lacunes:[],recommandations:[],streak:{userId:e,streakActuel:0,meilleurStreak:0,dernierJourActif:null,totalJoursActifs:0,semaineCourante:[!1,!1,!1,!1,!1,!1,!1],historiqueHebdo:[]},objectifs:[],scoreGlobal:0}}}function _f(e){switch(e){case"critique":return"#ef4444";case"important":return"#f59e0b";case"modere":return"#eab308";case"info":return"#10b981";default:return"#6b7280"}}function hM(e){switch(e){case"critique":return"Critique";case"important":return"Important";case"modere":return"Modr";case"info":return"Info";default:return"Inconnu"}}function vM(e){switch(e){case"hausse":return"";case"baisse":return"";case"stable":return"";default:return""}}function oZ(e){return e>=80?"Excellent travail ! Continue comme a, tu es sur la bonne voie ! ":e>=60?"Bon travail ! Quelques efforts supplmentaires et tu seras au top ! ":e>=40?"Tu peux faire mieux ! Suis les recommandations pour progresser. ":e>=20?"Courage ! Chaque effort compte. Commence par les recommandations prioritaires. ":"C'est le moment de se lancer ! Passe ton premier quiz pour commencer. "}function cZ(e){return e.cible===0?0:Math.min(Math.round(e.progression/e.cible*100),100)}const uZ="PEDA",dZ=4,mZ=5,fZ=40,gM=5;function Za(e){return e instanceof Ee?e.toDate():e instanceof Date?e:e?.seconds?new Date(e.seconds*1e3):new Date(e)}function xM(e){const r=new Date,n=r.getDay(),a=n===0?-6:1-n,l=new Date(r);return l.setDate(r.getDate()+a),l.setHours(0,0,0,0),l}function pZ(e){const r=xM(),n=new Date(r);return n.setDate(r.getDate()+6),n.setHours(23,59,59,999),n}function eA(e){const r=["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"];return`${e.getDate()} ${r[e.getMonth()]}`}function bM(e,r){return Math.floor(Math.abs(r.getTime()-e.getTime())/864e5)}async function hZ(e){try{const r="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let n="",a="";for(let u=0;u<dZ;u++)n+=r.charAt(Math.floor(Math.random()*r.length)),a+=r.charAt(Math.floor(Math.random()*r.length));const l=`${uZ}-${n}-${a}`,o=je(V,"users",e);return await Ve(o,{codeParent:l,codeParentGenere:new Date}),l}catch(r){throw console.error("Erreur gnration code invitation:",r),new Error("Impossible de gnrer le code d'invitation")}}async function vZ(e){try{const r=je(V,"users",e),n=await pt(r);if(!n.exists())throw new Error("lve introuvable");const a=n.data();return a.codeParent?a.codeParent:await hZ(e)}catch(r){throw console.error("Erreur rcupration code invitation:",r),new Error("Impossible de rcuprer le code d'invitation")}}async function gZ(e,r){try{const n=r.trim().toUpperCase(),a=_e(V,"users"),l=ze(a,Se("codeParent","==",n),Se("role","==","eleve"),$t(1)),o=await Ae(l);if(o.empty)throw new Error("Code d'invitation invalide. Vrifiez le code et ressayez.");const u=o.docs[0],d=u.data(),m=u.id,p=_e(V,"liens_parent_enfant"),h=ze(p,Se("parentId","==",e),Se("enfantId","==",m),Se("statut","==","actif"),$t(1));if(!(await Ae(h)).empty)throw new Error("Cet enfant est dj li  votre compte.");const b={parentId:e,enfantId:m,enfantNom:d.displayName||d.email,enfantEmail:d.email,enfantClasse:d.classe||void 0,codeInvitation:n,statut:"actif",dateCreation:new Date};return{id:(await Ot(p,b)).id,...b}}catch(n){throw console.error("Erreur liaison parent-enfant:",n),n}}async function xZ(e){try{const r=_e(V,"liens_parent_enfant"),n=ze(r,Se("parentId","==",e),Se("statut","==","actif"),Qe("dateCreation","desc"));return(await Ae(n)).docs.map(l=>({id:l.id,...l.data(),dateCreation:Za(l.data().dateCreation),dateDerniereConsultation:l.data().dateDerniereConsultation?Za(l.data().dateDerniereConsultation):void 0}))}catch(r){return console.error("Erreur rcupration enfants lis:",r),[]}}async function bZ(e,r){try{const n=je(V,"liens_parent_enfant",e),a=await pt(n);if(!a.exists())throw new Error("Lien introuvable");if(a.data().parentId!==r)throw new Error("Action non autorise");await Ve(n,{statut:"revoque",dateRevocation:new Date})}catch(n){throw console.error("Erreur rvocation lien:",n),n}}async function yZ(e,r){try{const n=_e(V,"liens_parent_enfant"),a=ze(n,Se("parentId","==",e),Se("enfantId","==",r),Se("statut","==","actif"),$t(1)),l=await Ae(a);if(l.empty)throw new Error("Vous n'tes pas autoris  consulter le suivi de cet enfant.");const o=je(V,"users",r),u=await pt(o);if(!u.exists())throw new Error("Profil de l'enfant introuvable.");const d=u.data(),m=await Oj(r),p=await Sp(r),h=p.slice(0,gM).map(j=>({quizTitre:j.quizTitre||"Quiz",disciplineNom:j.disciplineNom||"Discipline",pourcentage:j.pourcentage,noteSur20:Math.round(j.pourcentage/100*20*10)/10,reussi:j.reussi,datePassage:Za(j.datePassage)})),v=await jZ(e,r,d.displayName||d.email,m.lacunes,m.streak,m.scoreGlobal,p),b=_Z(r,d.displayName||d.email,m,p),x=l.docs[0];return await Ve(je(V,"liens_parent_enfant",x.id),{dateDerniereConsultation:new Date}),{enfant:{id:r,nom:d.displayName||d.email,email:d.email,classe:d.classe||void 0,derniereConnexion:d.lastLogin?Za(d.lastLogin):void 0},scoreGlobal:m.scoreGlobal,streak:{actuel:m.streak.streakActuel,meilleur:m.streak.meilleurStreak,semaineCourante:m.streak.semaineCourante},lacunes:m.lacunes.map(j=>({disciplineNom:j.disciplineNom,moyenne:j.moyenne,niveauUrgence:j.niveauUrgence,tendance:j.tendance})),objectifs:m.objectifs.map(j=>({titre:j.titre,progression:j.progression,cible:j.cible,statut:j.statut})),derniersQuiz:h,resume:b,alertes:v}}catch(n){throw console.error("Erreur dashboard parent:",n),n}}async function jZ(e,r,n,a,l,o,u){const d=[],m=new Date;if(a.filter(h=>h.niveauUrgence==="critique").forEach(h=>{d.push({id:`alerte_parent_lacune_${h.id}`,parentId:e,enfantId:r,enfantNom:n,type:"lacune_critique",niveau:"critique",titre:` Alerte critique en ${h.disciplineNom}`,message:`${n} a une moyenne de ${h.moyenne}/20 en ${h.disciplineNom}. Un suivi rapproch est recommand.`,lue:!1,dateCreation:m})}),l.dernierJourActif){const h=bM(Za(l.dernierJourActif),m);h>=mZ&&d.push({id:`alerte_parent_inactif_${r}`,parentId:e,enfantId:r,enfantNom:n,type:"inactivite",niveau:"important",titre:` ${n} est inactif`,message:`${n} n'a pas utilis PedaClic depuis ${h} jours. Un petit encouragement pourrait aider !`,lue:!1,dateCreation:m})}else u.length===0&&d.push({id:`alerte_parent_jamais_actif_${r}`,parentId:e,enfantId:r,enfantNom:n,type:"inactivite",niveau:"modere",titre:` ${n} n'a pas encore commenc`,message:`${n} n'a pas encore pass de quiz sur PedaClic. Encouragez-le  commencer !`,lue:!1,dateCreation:m});o<fZ&&u.length>0&&d.push({id:`alerte_parent_score_${r}`,parentId:e,enfantId:r,enfantNom:n,type:"score_bas",niveau:"important",titre:` Score global bas : ${o}/100`,message:`Le score de sant global de ${n} est de ${o}/100. Des efforts supplmentaires sont ncessaires dans plusieurs matires.`,lue:!1,dateCreation:m}),a.filter(h=>h.tendance==="hausse").forEach(h=>{d.push({id:`alerte_parent_progression_${h.id}`,parentId:e,enfantId:r,enfantNom:n,type:"progression",niveau:"info",titre:` Progression en ${h.disciplineNom}`,message:`Bonne nouvelle ! ${n} montre une tendance  la hausse en ${h.disciplineNom}.`,lue:!1,dateCreation:m})}),l.streakActuel>=5&&d.push({id:`alerte_parent_streak_${r}`,parentId:e,enfantId:r,enfantNom:n,type:"objectif_atteint",niveau:"info",titre:` Streak de ${l.streakActuel} jours !`,message:`Flicitations ! ${n} maintient un streak de ${l.streakActuel} jours conscutifs de travail.`,lue:!1,dateCreation:m});const p={critique:0,important:1,modere:2,info:3};return d.sort((h,v)=>p[h.niveau]-p[v.niveau]),d}function _Z(e,r,n,a){const l=xM(),o=pZ(),u=new Date(l);u.setDate(u.getDate()-7);const d=new Date(o);d.setDate(d.getDate()-7);const m=a.filter(A=>{const z=Za(A.datePassage);return z>=l&&z<=o}),p=a.filter(A=>{const z=Za(A.datePassage);return z>=u&&z<=d}),h=m.slice(0,gM).map(A=>({quizTitre:A.quizTitre||"Quiz",disciplineNom:A.disciplineNom||"Discipline",pourcentage:A.pourcentage,noteSur20:Math.round(A.pourcentage/100*20*10)/10,reussi:A.reussi,datePassage:Za(A.datePassage)})),v=NZ(m,p),b=new Set;m.forEach(A=>{const z=Za(A.datePassage);b.add(`${z.getFullYear()}-${z.getMonth()}-${z.getDate()}`)});const x=m.reduce((A,z)=>A+(z.tempsEcoule||5),0);let j=0;if(p.length>0){const A=p.reduce((z,k)=>z+k.pourcentage,0)/p.length;j=Math.round(A)}let _="stable";const w=n.scoreGlobal-j;w>5?_="hausse":w<-5&&(_="baisse");const C=n.lacunes.filter(A=>A.niveauUrgence==="critique"||A.niveauUrgence==="important").map(A=>A.disciplineNom),E=n.objectifs.filter(A=>A.statut==="atteint").length,S=`${eA(l)} - ${eA(o)} ${o.getFullYear()}`;return{enfantId:e,enfantNom:r,semaine:S,dateDebut:l,dateFin:o,scoreGlobal:n.scoreGlobal,scoreGlobalPrecedent:j,evolutionScore:_,nombreQuizSemaine:m.length,tempsEstimeMinutes:Math.round(x),joursActifsSemaine:b.size,streakActuel:n.streak.streakActuel,derniersQuiz:h,evolutionDisciplines:v,lacunesCritiques:n.lacunes.filter(A=>A.niveauUrgence==="critique").length,lacunesImportantes:n.lacunes.filter(A=>A.niveauUrgence==="important").length,disciplinesEnDifficulte:C,objectifsAtteints:E,objectifsTotal:n.objectifs.length}}function NZ(e,r){const n=new Map;e.forEach(o=>{n.has(o.disciplineId)||n.set(o.disciplineId,{scores:[],nom:o.disciplineNom||"Discipline"}),n.get(o.disciplineId).scores.push(o.pourcentage)});const a=new Map;r.forEach(o=>{a.has(o.disciplineId)||a.set(o.disciplineId,[]),a.get(o.disciplineId).push(o.pourcentage)});const l=[];return n.forEach((o,u)=>{const d=o.scores.reduce((j,_)=>j+_,0)/o.scores.length,m=a.get(u)||[],p=m.length>0?m.reduce((j,_)=>j+_,0)/m.length:d,h=Math.round(d/100*20*10)/10,v=Math.round(p/100*20*10)/10,b=Math.round((h-v)*10)/10;let x="stable";b>1?x="hausse":b<-1&&(x="baisse"),l.push({disciplineNom:o.nom,disciplineId:u,moyenneSemainePrecedente:v,moyenneSemaineCourante:h,evolution:x,ecart:b})}),l}function SZ(e){return _f(e)}function wZ(e){return{lacune_critique:"Lacune critique",inactivite:"Inactivit",streak_perdu:"Streak perdu",objectif_atteint:"Objectif atteint",progression:"Progression",score_bas:"Score bas",nouveau_quiz:"Nouveau quiz"}[e]||"Alerte"}function tA(e){switch(e){case"hausse":return"";case"baisse":return"";case"stable":return"";default:return""}}function CZ(e){return e>=80?"Votre enfant fait un excellent travail ! Continuez  l'encourager. ":e>=60?"De bons rsultats ! Quelques efforts supplmentaires et ce sera parfait. ":e>=40?"Des progrs sont possibles. Encouragez votre enfant  suivre les recommandations. ":e>=20?"Votre enfant a besoin de soutien. Un suivi rgulier est recommand. ":"Il est temps de commencer ! Encouragez votre enfant  passer ses premiers quiz. "}function Px(e){const n=bM(e,new Date);return n===0?"Aujourd'hui":n===1?"Hier":n<7?`Il y a ${n} jours`:n<30?`Il y a ${Math.floor(n/7)} semaine(s)`:`Il y a ${Math.floor(n/30)} mois`}const EZ="PROF",AZ=4,cm="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",yM=8,zZ=7,kZ=16;function el(e){return e instanceof Ee?e.toDate():e instanceof Date?e:e?.seconds?new Ee(e.seconds,e.nanoseconds||0).toDate():new Date(e)}function OZ(e,r){return Math.floor(Math.abs(r.getTime()-e.getTime())/864e5)}async function jM(){let e=0;const r=10;for(;e<r;){let n="",a="";for(let d=0;d<AZ;d++)n+=cm.charAt(Math.floor(Math.random()*cm.length)),a+=cm.charAt(Math.floor(Math.random()*cm.length));const l=`${EZ}-${n}-${a}`,o=ze(_e(V,"groupes_prof"),Se("codeInvitation","==",l),$t(1));if((await Ae(o)).empty)return l;e++}throw new Error("Impossible de gnrer un code unique aprs plusieurs tentatives")}async function DZ(e,r,n){try{const a=await jM(),l={profId:e,profNom:r,nom:n.nom.trim(),description:n.description?.trim()||"",matiereId:n.matiereId,matiereNom:n.matiereNom,classeNiveau:n.classeNiveau,codeInvitation:a,nombreInscrits:0,statut:"actif",anneeScolaire:n.anneeScolaire,dateCreation:new Date,dateMiseAJour:new Date},o=await Ot(_e(V,"groupes_prof"),l);return console.log(` Groupe "${n.nom}" cr avec code: ${a}`),{id:o.id,...l}}catch(a){throw console.error(" Erreur cration groupe:",a),new Error("Impossible de crer le groupe. Ressayez.")}}async function _M(e){try{const r=ze(_e(V,"groupes_prof"),Se("profId","==",e),Qe("dateCreation","desc"));return(await Ae(r)).docs.map(a=>({id:a.id,...a.data(),dateCreation:el(a.data().dateCreation),dateMiseAJour:a.data().dateMiseAJour?el(a.data().dateMiseAJour):void 0}))}catch(r){throw console.error(" Erreur rcupration groupes:",r),new Error("Impossible de charger vos groupes.")}}async function PZ(e){try{const r=await pt(je(V,"groupes_prof",e));if(!r.exists())return null;const n=r.data();return{id:r.id,...n,dateCreation:el(n.dateCreation),dateMiseAJour:n.dateMiseAJour?el(n.dateMiseAJour):void 0}}catch(r){return console.error(" Erreur rcupration groupe:",r),null}}async function Dj(e,r){try{const n=je(V,"groupes_prof",e);await Ve(n,{...r,dateMiseAJour:new Date}),console.log(` Groupe ${e} mis  jour`)}catch(n){throw console.error(" Erreur modification groupe:",n),new Error("Impossible de modifier le groupe.")}}async function MZ(e){try{const r=Ln(V),n=ze(_e(V,"inscriptions_groupe"),Se("groupeId","==",e));(await Ae(n)).docs.forEach(l=>r.delete(l.ref)),r.delete(je(V,"groupes_prof",e)),await r.commit(),console.log(` Groupe ${e} et ses inscriptions supprims`)}catch(r){throw console.error(" Erreur suppression groupe:",r),new Error("Impossible de supprimer le groupe.")}}async function TZ(e){await Dj(e,{statut:"archive"})}async function qZ(e){await Dj(e,{statut:"actif"})}async function RZ(e){try{const r=await jM();return await Ve(je(V,"groupes_prof",e),{codeInvitation:r,dateMiseAJour:new Date}),console.log(` Nouveau code pour groupe ${e}: ${r}`),r}catch(r){throw console.error(" Erreur rgnration code:",r),new Error("Impossible de rgnrer le code.")}}async function IZ(e,r,n,a){try{const l=a.trim().toUpperCase(),o=ze(_e(V,"groupes_prof"),Se("codeInvitation","==",l),$t(1)),u=await Ae(o);if(u.empty)throw new Error("Code d'invitation invalide. Vrifiez le code et ressayez.");const d=u.docs[0],m=d.data();if(m.statut!=="actif")throw new Error("Ce groupe n'accepte plus de nouvelles inscriptions.");const p=ze(_e(V,"inscriptions_groupe"),Se("groupeId","==",d.id),Se("eleveId","==",e),Se("statut","==","actif"),$t(1));if(!(await Ae(p)).empty)throw new Error("Tu es dj inscrit(e) dans ce groupe.");const v={groupeId:d.id,eleveId:e,eleveNom:r,eleveEmail:n,statut:"actif",dateInscription:new Date},b=await Ot(_e(V,"inscriptions_groupe"),v);return await Ve(je(V,"groupes_prof",d.id),{nombreInscrits:ss(1),dateMiseAJour:new Date}),console.log(` lve ${r} inscrit au groupe "${m.nom}"`),{id:b.id,...v}}catch(l){throw console.error(" Erreur inscription groupe:",l),l}}async function wp(e,r="actif"){try{const n=ze(_e(V,"inscriptions_groupe"),Se("groupeId","==",e),Se("statut","==",r),Qe("dateInscription","asc"));return(await Ae(n)).docs.map(l=>({id:l.id,...l.data(),dateInscription:el(l.data().dateInscription),dateRetrait:l.data().dateRetrait?el(l.data().dateRetrait):void 0}))}catch(n){throw console.error(" Erreur rcupration lves groupe:",n),new Error("Impossible de charger les lves du groupe.")}}async function Pj(e){try{const r=ze(_e(V,"inscriptions_groupe"),Se("eleveId","==",e),Se("statut","==","actif")),n=await Ae(r);if(n.empty)return[];const a=[];for(const l of n.docs){const o=l.data().groupeId,u=await PZ(o);u&&u.statut==="actif"&&a.push(u)}return a}catch(r){return console.error(" Erreur rcupration groupes lve:",r),[]}}async function LZ(e,r){try{await Ve(je(V,"inscriptions_groupe",e),{statut:"retire",dateRetrait:new Date}),await Ve(je(V,"groupes_prof",r),{nombreInscrits:ss(-1),dateMiseAJour:new Date}),console.log(" lve retir du groupe")}catch(n){throw console.error(" Erreur retrait lve:",n),new Error("Impossible de retirer l'lve du groupe.")}}async function Mj(e){try{const n=(await wp(e)).map(b=>b.eleveId);if(n.length===0)return{groupeId:e,nombreEleves:0,moyenneClasse:0,tauxReussite:0,tauxParticipation:0,totalQuizPasses:0,elevesEnDifficulte:0,meilleureNote:0,pireNote:0,derniereMiseAJour:new Date};const a=[],l=[];for(let b=0;b<n.length;b+=10)l.push(n.slice(b,b+10));for(const b of l){const x=ze(_e(V,"quiz_results"),Se("userId","in",b));(await Ae(x)).docs.forEach(_=>a.push({id:_.id,..._.data()}))}const o=new Map;for(const b of a){const x=b.userId;o.has(x)||o.set(x,{total:0,somme:0,reussis:0});const j=o.get(x);j.total++,j.somme+=b.score||0,(b.score||0)>=10&&j.reussis++}let u=0,d=0,m=0,p=0,h=20,v=0;for(const[,b]of o){const x=b.total>0?b.somme/b.total:0;u+=x,d++,v+=b.total,x<yM&&m++,x>p&&(p=x),x<h&&(h=x)}return d===0&&(h=0),{groupeId:e,nombreEleves:n.length,moyenneClasse:d>0?Math.round(u/d*10)/10:0,tauxReussite:v>0?Math.round(Array.from(o.values()).reduce((b,x)=>b+x.reussis,0)/v*100):0,tauxParticipation:Math.round(d/n.length*100),totalQuizPasses:v,elevesEnDifficulte:m,meilleureNote:Math.round(p*10)/10,pireNote:Math.round(h*10)/10,derniereMiseAJour:new Date}}catch(r){throw console.error(" Erreur calcul stats groupe:",r),new Error("Impossible de calculer les statistiques du groupe.")}}async function $Z(e){try{const r=await wp(e);if(r.length===0)return[];const n=[];for(const a of r)try{const l=await Oj(a.eleveId),o=ze(_e(V,"quiz_results"),Se("userId","==",a.eleveId),Qe("datePassage","desc")),d=(await Ae(o)).docs.map(x=>x.data());let m=0,p=0,h;if(d.length>0){const x=d.reduce((j,_)=>j+(_.score||0),0);m=Math.round(x/d.length*10)/10,p=Math.round(d.filter(j=>(j.score||0)>=10).length/d.length*100),h=el(d[0].datePassage)}let v="stable";if(d.length>=4){const x=d.slice(0,Math.ceil(d.length/2)),j=d.slice(Math.ceil(d.length/2)),_=x.reduce((C,E)=>C+(E.score||0),0)/x.length,w=j.reduce((C,E)=>C+(E.score||0),0)/j.length;_-w>1?v="hausse":w-_>1&&(v="baisse")}const b=l.lacunes.map(x=>({disciplineNom:x.disciplineNom,chapitre:x.chapitre,moyenne:x.moyenne,niveauUrgence:x.niveauUrgence}));n.push({eleveId:a.eleveId,eleveNom:a.eleveNom,eleveEmail:a.eleveEmail,moyenne:m,totalQuiz:d.length,tauxReussite:p,scoreGlobal:l.scoreGlobal,streak:{actuel:l.streak.streakActuel,meilleur:l.streak.meilleurStreak},lacunes:b,dernierQuiz:h,tendance:v})}catch(l){console.warn(` Suivi incomplet pour lve ${a.eleveNom}:`,l),n.push({eleveId:a.eleveId,eleveNom:a.eleveNom,eleveEmail:a.eleveEmail,moyenne:0,totalQuiz:0,tauxReussite:0,scoreGlobal:0,streak:{actuel:0,meilleur:0},lacunes:[],tendance:"stable"})}return n.sort((a,l)=>l.moyenne-a.moyenne),n}catch(r){throw console.error(" Erreur stats lves groupe:",r),new Error("Impossible de charger les statistiques des lves.")}}async function BZ(e,r,n){try{const l=(await wp(e)).map(x=>x.eleveId);if(l.length===0)return null;let o=null,u="quiz_results";if(n!=="quizzes_v2"){if(n!=="quizzes"){const x=await pt(je(V,"quizzes_v2",r));if(x.exists())o=x.data(),u="quiz_results_v2";else{const j=await pt(je(V,"quizzes",r));j.exists()&&(o=j.data(),u="quiz_results")}}}if(!o)return null;const d=[],m=[];for(let x=0;x<l.length;x+=10)m.push(l.slice(x,x+10));for(const x of m){const j=ze(_e(V,u),Se("quizId","==",r),Se("userId","in",x));(await Ae(j)).docs.forEach(w=>d.push(w.data()))}if(d.length===0)return null;const p=u==="quiz_results_v2",h=d.map(x=>p?x.note20||(x.scoreMax>0?x.score/x.scoreMax*20:0):x.score||0),v=d.map(x=>x.tempsEcoule||0),b=[];if(p&&o.questions)for(let x=0;x<o.questions.length;x++){const j=o.questions[x];let _=0,w=0;for(const S of d){const A=S.detailsParQuestion?.find(z=>z.questionId===j.id);A&&(w++,A.isCorrect||_++)}const C=w>0?Math.round(_/w*100):0,E=j.enonce?.replace(/<[^>]*>/g,"").trim()||`Question ${x+1}`;b.push({questionIndex:x,questionTexte:E,tauxEchec:C,reponseCorrecte:"Voir correction dtaille",reponsesFrequentes:[]})}else if(o.questions)for(let x=0;x<o.questions.length;x++){const j=o.questions[x];let _=0;const w=new Map;for(const S of d){const A=S.reponses?.[x];A!==void 0&&(w.set(A,(w.get(A)||0)+1),A!==j.reponseCorrecte&&_++)}const C=Math.round(_/d.length*100),E=Array.from(w.entries()).filter(([S])=>S!==j.reponseCorrecte).map(([S,A])=>({reponse:j.options?.[S]||`Option ${S+1}`,nombre:A})).sort((S,A)=>A.nombre-S.nombre);b.push({questionIndex:x,questionTexte:j.question,tauxEchec:C,reponseCorrecte:j.options?.[j.reponseCorrecte]||"N/A",reponsesFrequentes:E})}return b.sort((x,j)=>j.tauxEchec-x.tauxEchec),{quizId:r,quizTitre:o.titre||"Quiz sans titre",disciplineNom:o.disciplineNom||o.matiereNom||"",totalPassages:d.length,moyenneScore:Math.round(h.reduce((x,j)=>x+j,0)/h.length*10)/10,tauxReussite:Math.round(h.filter(x=>x>=10).length/h.length*100),tempsEcouleMoyen:Math.round(v.reduce((x,j)=>x+j,0)/v.length),questionsRatees:b}}catch(a){return console.error(" Erreur analyse quiz groupe:",a),null}}async function UZ(e){try{const r=[];try{const n=ze(_e(V,"quizzes"),Se("disciplineId","==",e),Qe("createdAt","desc"));(await Ae(n)).docs.forEach(l=>{r.push({id:l.id,titre:l.data().titre||"Quiz sans titre",source:"quizzes"})})}catch(n){console.warn(" Recherche quizzes choue (index manquant ?):",n)}try{const n=ze(_e(V,"quizzes_v2"),Se("disciplineId","==",e),Qe("createdAt","desc"));(await Ae(n)).docs.forEach(l=>{r.push({id:l.id,titre:l.data().titre||"Quiz avanc sans titre",source:"quizzes_v2"})})}catch(n){console.warn(" Recherche quizzes_v2 choue (index manquant ?):",n)}return console.log(` ${r.length} quiz trouv(s) pour discipline ${e}`),r}catch(r){return console.error(" Erreur rcupration quiz par matire:",r),[]}}function FZ(e,r){const n=[],a=new Date;for(const o of e){if(o.totalQuiz>0&&o.moyenne<yM&&n.push({id:`diff-${o.eleveId}`,type:"difficulte",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:r,message:`${o.eleveNom} a une moyenne de ${o.moyenne}/20. Lacunes : ${o.lacunes.map(u=>u.disciplineNom).join(", ")||"non dtectes"}.`,niveauUrgence:o.moyenne<5?"critique":"important",dateCreation:a}),o.dernierQuiz){const u=OZ(o.dernierQuiz,a);u>=zZ&&n.push({id:`inact-${o.eleveId}`,type:"inactivite",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:r,message:`${o.eleveNom} n'a pas fait de quiz depuis ${u} jours.`,niveauUrgence:u>=14?"important":"info",dateCreation:a})}else o.totalQuiz===0&&n.push({id:`inact-${o.eleveId}`,type:"inactivite",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:r,message:`${o.eleveNom} n'a encore pass aucun quiz.`,niveauUrgence:"info",dateCreation:a});o.tendance==="baisse"&&o.totalQuiz>=4&&n.push({id:`baisse-${o.eleveId}`,type:"baisse",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:r,message:`${o.eleveNom} est en baisse de rsultats (tendance ngative).`,niveauUrgence:"important",dateCreation:a}),o.moyenne>=kZ&&o.totalQuiz>=3&&n.push({id:`felicite-${o.eleveId}`,type:"felicitation",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:r,message:`${o.eleveNom} excelle avec ${o.moyenne}/20 ! `,niveauUrgence:"info",dateCreation:a})}const l={critique:0,important:1,info:2};return n.sort((o,u)=>l[o.niveauUrgence]-l[u.niveauUrgence]),n}function GZ(e,r){const n=["Nom","Email","Moyenne (/20)","Quiz passs","Taux russite (%)","Streak (jours)","Lacunes principales","Tendance"],a=e.map(o=>{const u=o.lacunes.map(d=>`${d.disciplineNom} (${d.moyenne}/20)`).join(" | ")||"Aucune";return[`"${o.eleveNom}"`,`"${o.eleveEmail}"`,o.moyenne.toString(),o.totalQuiz.toString(),o.tauxReussite.toString(),o.streak.actuel.toString(),`"${u}"`,o.tendance].join(",")});return"\uFEFF"+[n.join(","),...a].join(`
`)}function HZ(e,r){const n=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(n),l=document.createElement("a");l.href=a,l.download=`${r}.csv`,l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)}const Cp="travaux_a_faire";function No(e){return e instanceof Ee?e.toDate():e instanceof Date?e:e&&typeof e=="object"&&"seconds"in e?new Ee(e.seconds,e.nanoseconds||0).toDate():new Date(e)}async function VZ(e){const r=await Ot(_e(V,Cp),{...e,dateEcheance:e.dateEcheance instanceof Date?Ee.fromDate(e.dateEcheance):e.dateEcheance,createdAt:Ee.now()}),n=await pt(r);return{id:r.id,...n.data(),dateEcheance:No(n.data().dateEcheance),createdAt:No(n.data().createdAt)}}async function QZ(e){await Ir(je(V,Cp,e))}async function rA(e){const r=ze(_e(V,Cp),Se("groupeId","==",e),Qe("dateEcheance","asc"));return(await Ae(r)).docs.map(a=>({id:a.id,...a.data(),dateEcheance:No(a.data().dateEcheance),createdAt:No(a.data().createdAt)}))}async function NM(e){if(e.length===0)return[];const r=[],n=new Date;n.setHours(0,0,0,0);for(const a of e.slice(0,10)){const l=ze(_e(V,Cp),Se("groupeId","==",a),Qe("dateEcheance","asc"),$t(50));(await Ae(l)).docs.forEach(u=>{const d={id:u.id,...u.data(),dateEcheance:No(u.data().dateEcheance),createdAt:No(u.data().createdAt)};d.dateEcheance>=n&&r.push(d)})}return r.sort((a,l)=>a.dateEcheance.getTime()-l.dateEcheance.getTime()),r}async function YZ(e){return NM(e)}const KZ=()=>{const{currentUser:e}=Xe(),[r,n]=g.useState([]),[a,l]=g.useState(!1),[o,u]=g.useState(""),[d,m]=g.useState(!0),[p,h]=g.useState(!1),[v,b]=g.useState(null),[x,j]=g.useState(null),_=g.useCallback(async()=>{if(e?.uid)try{m(!0);const C=await Pj(e.uid);n(C)}catch(C){console.error("Erreur chargement groupes:",C)}finally{m(!1)}},[e?.uid]);g.useEffect(()=>{_()},[_]);const w=async C=>{if(C.preventDefault(),!(!e?.uid||!o.trim()))try{h(!0),b(null),j(null),await IZ(e.uid,e.displayName||e.email||"lve",e.email||"",o),j("Tu as rejoint le groupe avec succs ! "),u(""),l(!1),await _(),setTimeout(()=>j(null),5e3)}catch(E){b(E.message||"Impossible de rejoindre le groupe.")}finally{h(!1)}};return t.jsxs("div",{className:"rejoindre-groupe-section",children:[t.jsxs("div",{className:"rejoindre-groupe-header",children:[t.jsx("h3",{children:" Mes groupes-classes"}),t.jsx("button",{className:"prof-btn prof-btn-primary prof-btn-sm",onClick:()=>l(!a),children:a?" Annuler":" Rejoindre un groupe"})]}),v&&t.jsxs("div",{className:"prof-alert prof-alert-error",children:[" ",v,t.jsx("button",{onClick:()=>b(null),className:"prof-alert-close",children:""})]}),x&&t.jsx("div",{className:"prof-alert",style:{background:"#d1fae5",border:"1px solid #a7f3d0",color:"#065f46"},children:x}),a&&t.jsxs("div",{className:"groupe-form-container",style:{marginBottom:"1rem"},children:[t.jsx("p",{style:{marginBottom:"0.75rem",color:"#6b7280",fontSize:"0.875rem"},children:"Saisis le code donn par ton professeur (format: PROF-XXXX-XXXX)"}),t.jsxs("form",{onSubmit:w,style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[t.jsx("input",{type:"text",placeholder:"PROF-XXXX-XXXX",value:o,onChange:C=>u(C.target.value.toUpperCase()),maxLength:14,disabled:p,className:"prof-input",style:{flex:1,maxWidth:"280px",fontFamily:"monospace",letterSpacing:"2px"}}),t.jsx("button",{type:"submit",className:"prof-btn prof-btn-primary",disabled:p||o.length<14,children:p?" Vrification...":" Rejoindre"})]})]}),d?t.jsx("p",{style:{color:"#9ca3af",textAlign:"center",padding:"1rem"},children:"Chargement..."}):r.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"2rem",color:"#9ca3af"},children:[t.jsx("p",{children:"Tu n'es inscrit(e) dans aucun groupe-classe."}),t.jsx("p",{style:{fontSize:"0.875rem"},children:"Demande  ton professeur un code d'invitation pour rejoindre son groupe."})]}):t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:r.map(C=>t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[t.jsxs("div",{children:[t.jsx("strong",{style:{color:"#1f2937"},children:C.nom}),t.jsxs("span",{style:{display:"block",fontSize:"0.75rem",color:"#9ca3af"},children:[C.matiereNom,"  Prof: ",C.profNom]})]}),t.jsx("span",{style:{fontSize:"0.875rem",color:"#10b981",fontWeight:600},children:" Inscrit(e)"})]},C.id))})]})},WZ=e=>e>=80?"#10b981":e>=60?"#3b82f6":e>=40?"#f59e0b":e>0?"#ef4444":"#d1d5db",nA=({pourcentage:e,label:r,size:n="md",showPercent:a=!0,color:l,showCheck:o=!0,className:u=""})=>{const[d,m]=g.useState(0);g.useEffect(()=>{const x=setTimeout(()=>{m(Math.min(100,Math.max(0,e)))},100);return()=>clearTimeout(x)},[e]);const h={sm:"4px",md:"8px",lg:"12px"}[n],v=l||WZ(e),b=e>=100;return t.jsxs("div",{className:`progress-bar-wrapper ${u}`,children:[(r||a)&&t.jsxs("div",{className:"progress-bar-header",children:[r&&t.jsx("span",{className:"progress-bar-label",children:r}),a&&t.jsxs("span",{className:"progress-bar-percent",style:{color:v},children:[b&&o?" ":"",e,"%"]})]}),t.jsx("div",{className:"progress-bar-track",style:{height:h},children:t.jsx("div",{className:"progress-bar-fill",style:{width:`${d}%`,backgroundColor:v,height:"100%"}})})]})},XZ=()=>{const e=tt(),{currentUser:r}=Xe(),[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState([]),[m,p]=g.useState([]),[h,v]=g.useState([]),[b,x]=g.useState(null),[j,_]=g.useState([]),[w,C]=g.useState("all"),[E,S]=g.useState(!0),[A,z]=g.useState("overview"),[k,P]=g.useState(null),[D,$]=g.useState(!1),[F,Y]=g.useState(!1),[M,K]=g.useState([]),ee=async()=>{if(r){$(!0);try{const T=await vZ(r.uid);P(T)}catch(T){console.error("Erreur gnration code parent :",T)}finally{$(!1)}}},X=()=>{k&&(navigator.clipboard.writeText(k),Y(!0),setTimeout(()=>Y(!1),2e3))};if(g.useEffect(()=>{(async()=>{if(r){S(!0);try{await kI(r.uid);const[Z,H,ce,xe,fe,G]=await Promise.all([yI(r.uid),jI(r.uid),_I(r.uid,20),Of(r.uid,10),XA().catch(()=>[]),EI(r.uid)]);a(Z),o(H),d(ce),p(xe),v(fe),x(G);const ve=OI(Z,H,G);_(ve);const de=(await Pj(r.uid)).map(R=>R.id),we=await NM(de);K(we.map(R=>({id:R.id,titre:R.titre,description:R.description,dateEcheance:R.dateEcheance instanceof Date?R.dateEcheance:new Date(R.dateEcheance),groupeNom:R.groupeNom})))}catch(Z){console.error("Erreur chargement dashboard :",Z)}finally{S(!1)}}})()},[r]),E)return t.jsxs("div",{className:"sd-loading",children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement de votre tableau de bord..."})]});const L=j.filter(T=>T.obtenu),I=j.length,U=r?.displayName||r?.email?.split("@")[0]||"lve",B=w==="all"?j:j.filter(T=>T.categorie===w);return t.jsxs("div",{className:"student-dashboard",children:[t.jsxs("div",{className:"sd-welcome",children:[t.jsxs("div",{className:"sd-welcome-text",children:[t.jsxs("h1",{children:["Bienvenue, ",U," "]}),t.jsx("p",{children:n&&n.totalQuizPasses>0?`Vous avez pass ${n.totalQuizPasses} quiz avec une moyenne de ${n.moyenneGenerale}%. Continuez !`:"Commencez par consulter une ressource ou passer un quiz !"})]}),t.jsxs("div",{className:"sd-welcome-badges-row",children:[r?.isPremium&&t.jsxs("span",{className:"sd-premium-badge",children:[t.jsx(jr,{size:14})," Premium"]}),b&&b.streakActuel>0&&t.jsxs("span",{className:"sd-streak-badge",children:[" ",b.streakActuel," jour",b.streakActuel>1?"s":""]})]})]}),t.jsxs("div",{className:"sd-stats-grid",children:[t.jsxs("div",{className:"sd-stat-card",children:[t.jsx("div",{className:"sd-stat-icon",style:{background:"#eff6ff",color:"#3b82f6"},children:t.jsx(xn,{size:22})}),t.jsxs("div",{className:"sd-stat-content",children:[t.jsx("span",{className:"sd-stat-value",children:n?.totalQuizPasses||0}),t.jsx("span",{className:"sd-stat-label",children:"Quiz passs"})]})]}),t.jsxs("div",{className:"sd-stat-card",children:[t.jsx("div",{className:"sd-stat-icon",style:{background:"#f0fdf4",color:"#10b981"},children:t.jsx(Fv,{size:22})}),t.jsxs("div",{className:"sd-stat-content",children:[t.jsxs("span",{className:"sd-stat-value",style:{color:ao(n?.moyenneGenerale||0)},children:[n?.moyenneGenerale||0,"%"]}),t.jsx("span",{className:"sd-stat-label",children:"Moyenne gnrale"})]})]}),t.jsxs("div",{className:"sd-stat-card",children:[t.jsx("div",{className:"sd-stat-icon",style:{background:"#fef3c7",color:"#d97706"},children:t.jsx(co,{size:22})}),t.jsxs("div",{className:"sd-stat-content",children:[t.jsx("span",{className:"sd-stat-value",children:b?.totalRessourcesVues||0}),t.jsx("span",{className:"sd-stat-label",children:"Ressources vues"})]})]}),t.jsxs("div",{className:"sd-stat-card",children:[t.jsx("div",{className:"sd-stat-icon",style:{background:"#fef2f2",color:"#ef4444"},children:t.jsx(AA,{size:22})}),t.jsxs("div",{className:"sd-stat-content",children:[t.jsxs("span",{className:"sd-stat-value",children:[b?.streakActuel||0," "]}),t.jsx("span",{className:"sd-stat-label",children:"Jours conscutifs"})]})]}),t.jsxs("div",{className:"sd-stat-card",children:[t.jsx("div",{className:"sd-stat-icon",style:{background:"#fefce8",color:"#f59e0b"},children:t.jsx(zA,{size:22})}),t.jsxs("div",{className:"sd-stat-content",children:[t.jsxs("span",{className:"sd-stat-value",children:[n?.meilleurScore||0,"%"]}),t.jsx("span",{className:"sd-stat-label",children:"Meilleur score"})]})]}),t.jsxs("div",{className:"sd-stat-card",children:[t.jsx("div",{className:"sd-stat-icon",style:{background:"#f0f9ff",color:"#0ea5e9"},children:t.jsx(ns,{size:22})}),t.jsxs("div",{className:"sd-stat-content",children:[t.jsxs("span",{className:"sd-stat-value",children:[b?.disciplinesCompletees||0,"/",b?.disciplinesCommencees||0]}),t.jsx("span",{className:"sd-stat-label",children:"Disciplines compltes"})]})]})]}),t.jsxs("div",{className:"sd-chart-card",style:{marginBottom:"1.5rem"},children:[t.jsx("h3",{className:"sd-section-title",children:" Code Parent"}),t.jsx("p",{style:{color:"#6b7280",fontSize:"0.9rem",marginBottom:"1rem"},children:"Partagez ce code avec vos parents pour qu'ils puissent suivre votre progression."}),k?t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[t.jsx("span",{style:{fontFamily:"monospace",fontSize:"1.4rem",fontWeight:700,letterSpacing:"0.1em",background:"#eff6ff",color:"#2563eb",padding:"0.75rem 1.5rem",borderRadius:"12px",border:"2px dashed #93c5fd",userSelect:"all"},children:k}),t.jsx("button",{className:"sd-btn",onClick:X,style:{display:"inline-flex",alignItems:"center",gap:"0.4rem",background:F?"#10b981":"#f3f4f6",color:F?"#fff":"#374151",border:"none",padding:"0.6rem 1rem",borderRadius:"8px",cursor:"pointer",fontWeight:500,transition:"all 0.2s"},children:F?" Copi !":" Copier"})]}):t.jsx("button",{className:"sd-btn sd-btn-primary",onClick:ee,disabled:D,style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:D?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"admin-spinner",style:{width:"16px",height:"16px"}})," Gnration..."]}):t.jsx(t.Fragment,{children:" Gnrer mon code"})})]}),t.jsx("div",{className:"sd-chart-card",style:{marginBottom:"1.5rem"},children:t.jsx(KZ,{})}),M.length>0&&t.jsxs("div",{className:"sd-chart-card",style:{marginBottom:"1.5rem"},children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(Fd,{size:18})," Travaux  faire"]}),t.jsx("ul",{className:"sd-travaux-liste",style:{listStyle:"none",padding:0,margin:0},children:M.map(T=>t.jsxs("li",{className:"sd-travaux-item",style:{padding:"0.75rem 1rem",background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"8px",marginBottom:"0.5rem"},children:[t.jsx("strong",{children:T.titre}),T.description&&t.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",margin:"0.25rem 0 0"},children:T.description}),t.jsxs("span",{style:{fontSize:"0.8rem",color:"#2563eb",marginTop:"0.25rem",display:"block"},children:[" ",T.dateEcheance.toLocaleDateString("fr-FR"),"  ",T.groupeNom]})]},T.id))})]}),t.jsxs("div",{className:"sd-chart-card",style:{marginBottom:"1.5rem"},children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(xn,{size:18})," Cours en ligne"]}),t.jsx("p",{style:{color:"#6b7280",fontSize:"0.9rem",marginBottom:"1rem"},children:"Des cours complets du programme sngalais, accessibles partout."}),t.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.75rem",alignItems:"center"},children:[t.jsxs("button",{className:"sd-btn sd-btn-primary",onClick:()=>e("/cours"),style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx(so,{size:16})," Accder aux cours"]}),r?.isPremium&&So(r.subscriptionPlan)&&t.jsxs("button",{className:"sd-btn",onClick:()=>e("/premium/mes-cours"),style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"#f0fdf4",color:"#15803d",border:"1px solid #86efac"},children:[t.jsx(jr,{size:16})," Choisir mes cours"]})]}),!r?.isPremium&&t.jsxs("div",{style:{marginTop:"1.25rem",padding:"1rem",background:"#eff6ff",borderRadius:"12px",border:"1px solid #93c5fd"},children:[t.jsx("p",{style:{fontWeight:600,color:"#1e40af",marginBottom:"0.5rem"},children:"Passer Premium"}),t.jsx("p",{style:{fontSize:"0.875rem",color:"#3b82f6",marginBottom:"0.75rem"},children:"Dbloquez tous les cours premium et accdez aux quiz illimits."}),t.jsxs("button",{className:"sd-btn sd-btn-primary",onClick:()=>e("/premium"),style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx(jr,{size:16})," Dcouvrir les formules"]})]})]}),t.jsxs("div",{className:"sd-tabs",children:[t.jsxs("button",{className:`sd-tab ${A==="overview"?"active":""}`,onClick:()=>z("overview"),children:[t.jsx(Us,{size:16})," Vue d'ensemble"]}),t.jsxs("button",{className:`sd-tab ${A==="progression"?"active":""}`,onClick:()=>z("progression"),children:[t.jsx(Ic,{size:16})," Progression"]}),t.jsxs("button",{className:`sd-tab ${A==="history"?"active":""}`,onClick:()=>z("history"),children:[t.jsx(Fd,{size:16})," Historique"]}),t.jsxs("button",{className:`sd-tab ${A==="badges"?"active":""}`,onClick:()=>z("badges"),children:[t.jsx(ns,{size:16})," Badges (",L.length,"/",I,")"]})]}),A==="overview"&&t.jsxs("div",{className:"sd-overview",children:[u.length>1&&t.jsxs("div",{className:"sd-chart-card",children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(Ic,{size:18})," volution de vos scores"]}),t.jsx("div",{className:"sd-chart-container",children:t.jsx(Rw,{width:"100%",height:280,children:t.jsxs(YX,{data:u,children:[t.jsx(kb,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),t.jsx(Tb,{dataKey:"date",tick:{fontSize:12,fill:"#6b7280"},tickLine:!1}),t.jsx(Ib,{domain:[0,100],tick:{fontSize:12,fill:"#6b7280"},tickLine:!1,unit:"%"}),t.jsx(G2,{formatter:T=>[`${T}%`,"Score"],labelFormatter:T=>`Date : ${T}`,contentStyle:{borderRadius:"8px",border:"1px solid #e5e7eb",boxShadow:"0 4px 6px rgba(0,0,0,0.07)"}}),t.jsx(XP,{type:"monotone",dataKey:"score",stroke:"#3b82f6",strokeWidth:2.5,dot:{r:4,fill:"#3b82f6",stroke:"#fff",strokeWidth:2},activeDot:{r:6}})]})})})]}),l.length>0&&t.jsxs("div",{className:"sd-chart-card",children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(Us,{size:18})," Moyennes par discipline"]}),t.jsx("div",{className:"sd-chart-container",children:t.jsx(Rw,{width:"100%",height:280,children:t.jsxs(WX,{data:l,layout:"vertical",children:[t.jsx(kb,{strokeDasharray:"3 3",stroke:"#e5e7eb",horizontal:!1}),t.jsx(Tb,{type:"number",domain:[0,100],tick:{fontSize:12,fill:"#6b7280"},unit:"%"}),t.jsx(Ib,{type:"category",dataKey:"disciplineNom",width:120,tick:{fontSize:12,fill:"#374151"}}),t.jsx(G2,{formatter:T=>[`${T}%`,"Moyenne"],contentStyle:{borderRadius:"8px",border:"1px solid #e5e7eb",boxShadow:"0 4px 6px rgba(0,0,0,0.07)"}}),t.jsx(rM,{dataKey:"moyenne",radius:[0,6,6,0],barSize:24,children:l.map((T,Z)=>t.jsx(bj,{fill:ao(T.moyenne)},Z))})]})})})]}),h.length>0&&t.jsxs("div",{className:"sd-chart-card",children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(so,{size:18})," Quiz disponibles"]}),t.jsx("div",{className:"sd-quiz-grid",children:h.slice(0,6).map(T=>{const Z=T.isPremium&&!r?.isPremium;return t.jsxs("div",{className:`sd-quiz-card ${Z?"locked":""}`,onClick:()=>!Z&&e(`/quiz/${T.id}`),children:[T.isPremium&&t.jsxs("span",{className:"sd-quiz-badge-premium",children:[Z?t.jsx(Nm,{size:10}):t.jsx(jr,{size:10})," Premium"]}),t.jsx("h4",{className:"sd-quiz-title",children:T.titre}),t.jsxs("div",{className:"sd-quiz-meta",children:[t.jsxs("span",{children:[t.jsx(xn,{size:12})," ",T.questions.length," questions"]}),t.jsxs("span",{children:[t.jsx(po,{size:12})," ",T.duree," min"]})]}),!Z&&t.jsxs("button",{className:"sd-quiz-play-btn",children:[t.jsx(so,{size:14})," Commencer"]}),Z&&t.jsxs("button",{className:"sd-quiz-unlock-btn",onClick:H=>{H.stopPropagation(),e("/premium")},children:[t.jsx(Nm,{size:14})," Dbloquer"]})]},T.id)})})]}),n&&n.totalQuizPasses===0&&(!b||b.totalRessourcesVues===0)&&t.jsxs("div",{className:"sd-empty-state",children:[t.jsx(Fv,{size:48}),t.jsx("h3",{children:"Commencez votre parcours !"}),t.jsx("p",{children:"Consultez une ressource ou passez un quiz pour voir votre progression."}),h.length>0&&t.jsxs("button",{className:"sd-btn sd-btn-primary",onClick:()=>e(`/quiz/${h[0].id}`),children:[t.jsx(so,{size:18})," Passer un quiz"]})]})]}),A==="progression"&&t.jsxs("div",{className:"sd-progression",children:[t.jsxs("div",{className:"sd-chart-card sd-prog-summary",children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(Ic,{size:18})," Avancement global"]}),t.jsx(nA,{pourcentage:b?.pourcentageMoyen||0,label:"Progression moyenne",size:"lg",showCheck:!0}),t.jsxs("div",{className:"sd-prog-stats-row",children:[t.jsxs("div",{className:"sd-prog-stat-item",children:[t.jsx("span",{className:"sd-prog-stat-number",children:b?.totalRessourcesVues||0}),t.jsx("span",{className:"sd-prog-stat-text",children:"Ressources consultes"})]}),t.jsxs("div",{className:"sd-prog-stat-item",children:[t.jsx("span",{className:"sd-prog-stat-number",children:b?.totalQuizReussis||0}),t.jsx("span",{className:"sd-prog-stat-text",children:"Quiz russis"})]}),t.jsxs("div",{className:"sd-prog-stat-item",children:[t.jsx("span",{className:"sd-prog-stat-number",children:b?.disciplinesCommencees||0}),t.jsx("span",{className:"sd-prog-stat-text",children:"Disciplines"})]}),t.jsxs("div",{className:"sd-prog-stat-item",children:[t.jsxs("span",{className:"sd-prog-stat-number",children:[" ",b?.streakActuel||0]}),t.jsxs("span",{className:"sd-prog-stat-text",children:["Streak (max: ",b?.meilleurStreak||0,")"]})]})]})]}),b&&b.parDiscipline.length>0?t.jsxs("div",{className:"sd-chart-card",children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(Us,{size:18})," Par discipline"]}),t.jsx("div",{className:"sd-prog-disciplines",children:b.parDiscipline.map(T=>t.jsxs("div",{className:"sd-prog-disc-card",children:[t.jsxs("div",{className:"sd-prog-disc-header",children:[t.jsx("span",{className:"sd-prog-disc-name",children:T.disciplineNom}),T.pourcentage>=100&&t.jsx("span",{className:"sd-prog-complete-tag",children:" Complt"})]}),t.jsx(nA,{pourcentage:T.pourcentage,size:"md",showPercent:!0}),t.jsxs("div",{className:"sd-prog-disc-details",children:[t.jsxs("span",{children:[t.jsx(co,{size:12})," ",T.ressourcesVues.length,"/",T.totalRessources," ressources"]}),t.jsxs("span",{children:[t.jsx(Ht,{size:12})," ",T.quizReussis.length,"/",T.totalQuiz," quiz russis"]})]})]},T.disciplineId))})]}):t.jsxs("div",{className:"sd-empty-state",children:[t.jsx(co,{size:48}),t.jsx("h3",{children:"Aucune progression enregistre"}),t.jsx("p",{children:"Consultez des ressources ou passez des quiz pour voir votre avancement ici."})]}),l.length>0&&t.jsxs("div",{className:"sd-chart-card",children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(Fv,{size:18})," Performance quiz par discipline"]}),t.jsx("div",{className:"sd-disc-list",children:l.map(T=>t.jsxs("div",{className:"sd-disc-card",children:[t.jsxs("div",{className:"sd-disc-header",children:[t.jsx("span",{className:"sd-disc-name",children:T.disciplineNom}),t.jsxs("span",{className:"sd-disc-tendance",children:[T.tendance==="up"&&t.jsx(Ic,{size:16,className:"tendance-up"}),T.tendance==="down"&&t.jsx(H3,{size:16,className:"tendance-down"}),T.tendance==="stable"&&t.jsx(V3,{size:16,className:"tendance-stable"})]})]}),t.jsxs("div",{className:"sd-disc-stats",children:[t.jsxs("div",{className:"sd-disc-stat",children:[t.jsxs("span",{className:"sd-disc-stat-value",style:{color:ao(T.moyenne)},children:[T.moyenne,"%"]}),t.jsx("span",{className:"sd-disc-stat-label",children:"Moyenne"})]}),t.jsxs("div",{className:"sd-disc-stat",children:[t.jsx("span",{className:"sd-disc-stat-value",children:T.nombreQuiz}),t.jsx("span",{className:"sd-disc-stat-label",children:"Quiz"})]}),t.jsxs("div",{className:"sd-disc-stat",children:[t.jsxs("span",{className:"sd-disc-stat-value",children:[T.meilleurScore,"%"]}),t.jsx("span",{className:"sd-disc-stat-label",children:"Meilleur"})]}),t.jsxs("div",{className:"sd-disc-stat",children:[t.jsxs("span",{className:"sd-disc-stat-value",children:[T.quizReussis,"/",T.nombreQuiz]}),t.jsx("span",{className:"sd-disc-stat-label",children:"Russis"})]})]}),t.jsx("div",{className:"sd-disc-bar",children:t.jsx("div",{className:"sd-disc-bar-fill",style:{width:`${T.moyenne}%`,background:ao(T.moyenne)}})})]},T.disciplineId))})]})]}),A==="history"&&t.jsx("div",{className:"sd-history",children:m.length===0?t.jsxs("div",{className:"sd-empty-state",children:[t.jsx(Fd,{size:48}),t.jsx("h3",{children:"Aucun quiz pass"}),t.jsx("p",{children:"Votre historique apparatra ici aprs avoir pass des quiz."})]}):t.jsx("div",{className:"sd-history-list",children:m.map(T=>{const Z=T.datePassage?.toDate?T.datePassage.toDate():new Date(T.datePassage);return t.jsxs("div",{className:`sd-history-item ${T.reussi?"success":"fail"}`,children:[t.jsx("div",{className:`sd-history-icon ${T.reussi?"success":"fail"}`,children:T.reussi?t.jsx(Ht,{size:20}):t.jsx(qx,{size:20})}),t.jsxs("div",{className:"sd-history-content",children:[t.jsxs("div",{className:"sd-history-top",children:[t.jsx("span",{className:"sd-history-title",children:T.quizTitre}),t.jsx("span",{className:"sd-history-discipline",children:T.disciplineNom})]}),t.jsxs("div",{className:"sd-history-meta",children:[t.jsxs("span",{children:[t.jsx(Fd,{size:12}),Z.toLocaleDateString("fr-SN",{day:"2-digit",month:"long",year:"numeric"})]}),t.jsxs("span",{children:[t.jsx(po,{size:12})," ",az(T.tempsEcoule)]}),t.jsxs("span",{children:[t.jsx(Ht,{size:12})," ",T.bonnesReponses,"/",T.nombreQuestions]})]})]}),t.jsxs("div",{className:"sd-history-score",style:{color:ao(T.pourcentage)},children:[t.jsxs("span",{className:"sd-history-score-value",children:[T.pourcentage,"%"]}),t.jsx("span",{className:"sd-history-score-label",children:iz(T.pourcentage)})]})]},T.id)})})}),A==="badges"&&t.jsxs("div",{className:"sd-badges",children:[t.jsxs("div",{className:"sd-badges-summary",children:[t.jsxs("div",{className:"sd-badges-circle",children:[t.jsx("span",{className:"sd-badges-count",children:L.length}),t.jsxs("span",{className:"sd-badges-total",children:["/ ",I]})]}),t.jsx("p",{children:"badges obtenus"}),t.jsx("div",{className:"sd-badges-progress",children:t.jsx("div",{className:"sd-badges-progress-fill",style:{width:`${L.length/I*100}%`}})})]}),t.jsx("div",{className:"sd-badges-filters",children:[{key:"all",label:"Tous"},{key:"ressources",label:" Ressources"},{key:"quiz",label:" Quiz"},{key:"performance",label:" Performance"},{key:"discipline",label:" Disciplines"},{key:"streak",label:" Streak"}].map(T=>t.jsx("button",{className:`sd-badge-filter-btn ${w===T.key?"active":""}`,onClick:()=>C(T.key),children:T.label},T.key))}),t.jsx("div",{className:"sd-badges-grid",children:B.map(T=>t.jsxs("div",{className:`sd-badge-card ${T.obtenu?"obtained":"locked"}`,children:[t.jsx("span",{className:"sd-badge-icon",children:T.icone}),t.jsx("h4",{className:"sd-badge-name",children:T.nom}),t.jsx("p",{className:"sd-badge-description",children:T.description}),t.jsx("span",{className:"sd-badge-condition",children:T.condition}),T.obtenu&&t.jsx("span",{className:"sd-badge-obtained-tag",children:" Obtenu"}),t.jsx("span",{className:"sd-badge-category",children:T.categorie})]},T.id))}),B.length===0&&t.jsxs("div",{className:"sd-empty-state",style:{marginTop:"1rem"},children:[t.jsx(Yb,{size:36}),t.jsx("h3",{children:"Aucun badge dans cette catgorie"}),t.jsx("p",{children:"Essayez un autre filtre."})]})]})]})},ZZ=()=>{const{currentUser:e}=Xe(),r=tt(),[n,a]=g.useState(null),[l,o]=g.useState(!0),[u,d]=g.useState(null),m=["L","M","M","J","V","S","D"],p=g.useCallback(async()=>{if(e?.uid)try{o(!0),d(null);const S=await Oj(e.uid);a(S)}catch(S){console.error("Erreur chargement suivi:",S),d("Impossible de charger ton suivi. Vrifie ta connexion et ressaie.")}finally{o(!1)}},[e?.uid]);g.useEffect(()=>{p()},[p]);const h=(()=>{const S=new Date().getDay();return S===0?6:S-1})();if(l)return t.jsx("div",{className:"suivi-page",children:t.jsx("div",{className:"suivi-container",children:t.jsxs("div",{className:"suivi-loading",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{className:"suivi-loading-text",children:"Analyse de ta progression en cours..."})]})})});if(u)return t.jsx("div",{className:"suivi-page",children:t.jsx("div",{className:"suivi-container",children:t.jsxs("div",{className:"suivi-error",children:[t.jsx("p",{className:"suivi-error-title",children:" Erreur de chargement"}),t.jsx("p",{className:"suivi-error-text",children:u}),t.jsx("button",{className:"suivi-btn-retry",onClick:p,children:" Ressayer"})]})})});if(!n)return null;const{lacunes:v,recommandations:b,streak:x,objectifs:j,scoreGlobal:_}=n,w=2*Math.PI*40,C=w-_/100*w,E=_>=60?"#10b981":_>=30?"#f59e0b":"#ef4444";return t.jsx("div",{className:"suivi-page",children:t.jsxs("div",{className:"suivi-container",children:[t.jsx("div",{className:"suivi-header",children:t.jsxs("div",{className:"suivi-header-content",children:[t.jsxs("div",{children:[t.jsx("h1",{children:" Mes points  amliorer"}),t.jsx("p",{className:"suivi-motivation",children:oZ(_)})]}),t.jsxs("div",{className:"score-global-circle",children:[t.jsxs("svg",{className:"score-circle-svg",viewBox:"0 0 100 100",children:[t.jsx("circle",{className:"score-circle-bg",cx:"50",cy:"50",r:"40"}),t.jsx("circle",{className:"score-circle-progress",cx:"50",cy:"50",r:"40",stroke:E,strokeDasharray:w,strokeDashoffset:C}),t.jsx("text",{className:"score-circle-text",x:"50",y:"50",children:_})]}),t.jsx("span",{className:"score-global-label",children:"Score global"})]})]})}),t.jsxs("div",{className:"streak-card",children:[t.jsxs("div",{className:"streak-header",children:[t.jsx("span",{className:"streak-flamme",children:x.streakActuel>0?"":""}),t.jsxs("div",{children:[t.jsx("div",{className:"streak-nombre",children:x.streakActuel}),t.jsx("div",{className:"streak-label",children:x.streakActuel<=1?"jour conscutif":"jours conscutifs"})]})]}),t.jsx("div",{className:"streak-semaine",children:m.map((S,A)=>t.jsxs("div",{className:"streak-jour",children:[t.jsx("span",{className:"streak-jour-label",children:S}),t.jsx("div",{className:`streak-jour-indicateur ${x.semaineCourante[A]?"actif":"inactif"} ${A===h?"aujourd-hui":""}`,children:x.semaineCourante[A]?"":""})]},A))}),t.jsxs("div",{className:"streak-stats",children:[t.jsxs("div",{className:"streak-stat",children:[t.jsx("span",{className:"streak-stat-icon",children:""}),t.jsx("span",{className:"streak-stat-value",children:x.meilleurStreak}),t.jsx("span",{className:"streak-stat-label",children:"record"})]}),t.jsxs("div",{className:"streak-stat",children:[t.jsx("span",{className:"streak-stat-icon",children:""}),t.jsx("span",{className:"streak-stat-value",children:x.totalJoursActifs}),t.jsx("span",{className:"streak-stat-label",children:"jours actifs au total"})]}),x.dernierJourActif&&t.jsxs("div",{className:"streak-stat",children:[t.jsx("span",{className:"streak-stat-icon",children:""}),t.jsxs("span",{className:"streak-stat-label",children:["Dernier quiz : ",new Date(x.dernierJourActif).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})]})]})]})]}),t.jsxs("h2",{className:"suivi-section-title",children:[" Objectifs de la semaine",t.jsx("span",{className:"suivi-section-badge",children:j.length})]}),j.length>0?t.jsx("div",{className:"objectifs-grid",children:j.map(S=>{const A=cZ(S);return t.jsxs("div",{className:`objectif-card ${S.statut==="atteint"?"atteint":""}`,children:[t.jsxs("div",{className:"objectif-header",children:[t.jsx("span",{className:"objectif-titre",children:S.titre}),S.recompense&&t.jsx("span",{className:"objectif-recompense",children:S.recompense})]}),t.jsx("p",{className:"objectif-description",children:S.description}),t.jsxs("div",{className:"objectif-progress",children:[t.jsxs("div",{className:"objectif-progress-labels",children:[t.jsxs("span",{className:"objectif-progress-value",children:[S.progression," / ",S.cible]}),t.jsxs("span",{className:"objectif-progress-cible",children:[A,"%"]})]}),t.jsx("div",{className:"objectif-progress-track",children:t.jsx("div",{className:`objectif-progress-fill ${S.statut==="atteint"?"atteint":""}`,style:{width:`${A}%`}})})]}),t.jsx("p",{className:`objectif-statut ${S.statut}`,children:S.statut==="atteint"?" Objectif atteint !":S.statut==="en_cours"?" En cours...":" Non commenc"})]},S.id)})}):t.jsxs("div",{className:"suivi-empty",children:[t.jsx("div",{className:"suivi-empty-icon",children:""}),t.jsx("p",{className:"suivi-empty-title",children:"Pas encore d'objectifs"}),t.jsx("p",{className:"suivi-empty-text",children:"Passe ton premier quiz pour dbloquer tes objectifs hebdomadaires !"})]}),t.jsxs("h2",{className:"suivi-section-title",children:[" Points faibles dtects",v.length>0&&t.jsx("span",{className:"suivi-section-badge",children:v.length})]}),v.length>0?t.jsx("div",{className:"lacunes-grid",children:v.map(S=>t.jsxs("div",{className:`lacune-card ${S.niveauUrgence}`,children:[t.jsxs("div",{className:"lacune-card-header",children:[t.jsx("span",{className:"lacune-discipline",children:S.disciplineNom}),t.jsx("span",{className:`lacune-badge ${S.niveauUrgence}`,children:hM(S.niveauUrgence)})]}),t.jsxs("div",{className:"lacune-score-bar",children:[t.jsxs("div",{className:"lacune-score-labels",children:[t.jsxs("span",{className:"lacune-score-value",style:{color:_f(S.niveauUrgence)},children:[S.moyenne,"/20"]}),t.jsx("span",{className:"lacune-score-objectif",children:"Objectif : 14/20"})]}),t.jsx("div",{className:"lacune-progress-track",children:t.jsx("div",{className:`lacune-progress-fill ${S.niveauUrgence}`,style:{width:`${S.moyenne/20*100}%`}})})]}),t.jsxs("div",{className:"lacune-details",children:[t.jsxs("span",{className:"lacune-detail-tag",children:[vM(S.tendance)," ",S.tendance]}),t.jsxs("span",{className:"lacune-detail-tag",children:[" ",S.nombreQuiz," quiz"]}),t.jsxs("span",{className:"lacune-detail-tag",children:["Dernier : ",S.scoreDetails.dernierScore,"/20"]})]})]},S.id))}):t.jsxs("div",{className:"suivi-empty",children:[t.jsx("div",{className:"suivi-empty-icon",children:""}),t.jsx("p",{className:"suivi-empty-title",children:"Aucune lacune dtecte !"}),t.jsx("p",{className:"suivi-empty-text",children:_>0?"Toutes tes moyennes sont au-dessus de 14/20. Bravo, continue !":"Passe des quiz pour que l'analyse puisse commencer."}),t.jsx("button",{className:"suivi-cta-btn",onClick:()=>r("/disciplines"),style:{marginTop:"1rem"},children:" Voir les disciplines"})]}),b.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("h2",{className:"suivi-section-title",children:[" Recommandations personnalises",t.jsx("span",{className:"suivi-section-badge",children:b.length})]}),t.jsx("div",{className:"recommandations-list",children:b.map(S=>t.jsxs("div",{className:"recommandation-card",children:[t.jsx("div",{className:"recommandation-priorite",children:S.priorite}),t.jsxs("div",{className:"recommandation-content",children:[t.jsx("p",{className:"recommandation-titre",children:S.titre}),t.jsx("p",{className:"recommandation-description",children:S.description}),t.jsx("span",{className:"recommandation-discipline-tag",children:S.disciplineNom})]})]},S.id))})]}),t.jsx("div",{style:{textAlign:"center",marginTop:"1rem",marginBottom:"2rem"},children:t.jsx("button",{className:"suivi-cta-btn",onClick:()=>r("/disciplines"),children:" Passer un quiz maintenant"})})]})})},JZ=()=>{const e=new Date,r=e.getFullYear(),a=e.getMonth()>=9?r:r-1,l=[];for(let o=-1;o<=3;o++){const u=a+o;l.push(`${u}-${u+1}`)}return l},aA=JZ(),Tc=()=>{const e=new Date,r=e.getFullYear(),a=e.getMonth()>=9?r:r-1;return`${a}-${a+1}`},iA=ci.map(e=>({value:e.valeur,label:e.label})),eJ=({onSelectGroupe:e})=>{const{currentUser:r}=Xe(),[n,a]=g.useState([]),[l,o]=g.useState(new Map),[u,d]=g.useState([]),[m,p]=g.useState(!0),[h,v]=g.useState(null),[b,x]=g.useState(!1),[j,_]=g.useState(!1),[w,C]=g.useState(null),[E,S]=g.useState(null),[A,z]=g.useState(null),[k,P]=g.useState(!1),[D,$]=g.useState(null),[F,Y]=g.useState({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:yr[0],anneeScolaire:Tc()}),[M,K]=g.useState({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:yr[0],anneeScolaire:Tc()}),[ee,X]=g.useState("actif");g.useEffect(()=>{(async()=>{try{const ae=await ls.getAll();d(ae.map(Ce=>({id:Ce.id,nom:Ce.nom,classe:Ce.classe||""})))}catch(ae){console.warn(" Impossible de charger les disciplines:",ae)}})()},[]);const L=g.useCallback(async()=>{if(r?.uid)try{p(!0),v(null);const R=await _M(r.uid);a(R);const ae=new Map;for(const Ce of R)if(Ce.statut==="actif")try{const ke=await Mj(Ce.id);ae.set(Ce.id,ke)}catch{console.warn(`Stats indisponibles pour ${Ce.nom}`)}o(ae)}catch(R){console.error("Erreur chargement groupes:",R),v("Impossible de charger vos groupes. Vrifiez votre connexion.")}finally{p(!1)}},[r?.uid]);g.useEffect(()=>{L()},[L]);const I=(R,ae=!1)=>{const Ce=u.find(Ke=>Ke.id===R),ke=Ce?`${Ce.nom}${Ce.classe?` (${Ce.classe})`:""}`:"";ae?K(Ke=>({...Ke,matiereId:R,matiereNom:ke})):Y(Ke=>({...Ke,matiereId:R,matiereNom:ke}))},U=async R=>{if(R.preventDefault(),!(!r?.uid||!F.nom.trim()||!F.matiereId))try{_(!0),await DZ(r.uid,r.displayName||r.email||"Professeur",F),Y({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:yr[0],anneeScolaire:Tc()}),x(!1),$("Groupe cr avec succs !"),setTimeout(()=>$(null),3e3),await L()}catch(ae){v(ae.message||"Erreur lors de la cration du groupe.")}finally{_(!1)}},B=R=>{z(R);const ae=uo(R.classeNiveau)||yr[0];K({nom:R.nom,description:R.description||"",matiereId:R.matiereId,matiereNom:R.matiereNom,classeNiveau:ae,anneeScolaire:R.anneeScolaire}),x(!1)},T=()=>{z(null),K({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:yr[0],anneeScolaire:Tc()})},Z=async R=>{if(R.preventDefault(),!(!A||!M.nom.trim()||!M.matiereId))try{P(!0),await Dj(A.id,{nom:M.nom.trim(),description:M.description?.trim()||"",matiereId:M.matiereId,matiereNom:M.matiereNom,classeNiveau:M.classeNiveau,anneeScolaire:M.anneeScolaire}),z(null),$("Groupe modifi avec succs !"),setTimeout(()=>$(null),3e3),await L()}catch(ae){v(ae.message||"Erreur lors de la modification du groupe.")}finally{P(!1)}},H=async R=>{try{await navigator.clipboard.writeText(R),C(R),setTimeout(()=>C(null),2e3)}catch{const ae=document.createElement("textarea");ae.value=R,document.body.appendChild(ae),ae.select(),document.execCommand("copy"),document.body.removeChild(ae),C(R),setTimeout(()=>C(null),2e3)}},ce=async R=>{try{await MZ(R),S(null),await L()}catch(ae){v(ae.message)}},xe=async R=>{try{await TZ(R),await L()}catch(ae){v(ae.message)}},fe=async R=>{try{await qZ(R),await L()}catch(ae){v(ae.message)}},G=async R=>{try{await RZ(R),await L()}catch(ae){v(ae.message)}},ve=(R,ae)=>{Y(Ce=>({...Ce,[R]:ae}))},De=(R,ae)=>{K(Ce=>({...Ce,[R]:ae}))},de=n.filter(R=>ee==="tous"?!0:R.statut===ee),we=(R,ae,Ce)=>t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:R,children:"Discipline / Matire *"}),t.jsxs("select",{id:R,value:ae,onChange:ke=>Ce(ke.target.value),className:"prof-select",required:!0,children:[t.jsx("option",{value:"",children:" Slectionner une discipline "}),u.map(ke=>t.jsxs("option",{value:ke.id,children:[ke.nom,ke.classe?` (${ke.classe})`:""]},ke.id))]}),u.length===0&&t.jsx("small",{style:{color:"#f59e0b",marginTop:"0.25rem",display:"block"},children:" Aucune discipline trouve. Crez des disciplines dans l'espace admin."})]});return m?t.jsxs("div",{className:"prof-loading",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement de vos groupes-classes..."})]}):t.jsxs("div",{className:"groupe-manager",children:[t.jsxs("div",{className:"groupe-manager-header",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"groupe-manager-titre",children:"Mes groupes-classes"}),t.jsxs("p",{className:"groupe-manager-subtitle",children:[n.length," groupe",n.length!==1?"s":"","  Anne ",Tc()]})]}),t.jsx("button",{className:"prof-btn prof-btn-primary",onClick:()=>{x(!b),A&&T()},children:b?" Annuler":" Nouveau groupe"})]}),h&&t.jsxs("div",{className:"prof-alert prof-alert-error",children:[t.jsx("span",{children:""})," ",h,t.jsx("button",{onClick:()=>v(null),className:"prof-alert-close",children:""})]}),D&&t.jsxs("div",{className:"prof-alert prof-alert-success",children:[t.jsx("span",{children:""})," ",D,t.jsx("button",{onClick:()=>$(null),className:"prof-alert-close",children:""})]}),b&&t.jsxs("div",{className:"groupe-form-container",children:[t.jsx("h3",{children:"Crer un nouveau groupe-classe"}),t.jsxs("form",{onSubmit:U,className:"groupe-form",children:[t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"groupe-nom",children:"Nom du groupe *"}),t.jsx("input",{id:"groupe-nom",type:"text",placeholder:"Ex: 3me A - Maths 2025",value:F.nom,onChange:R=>ve("nom",R.target.value),required:!0,className:"prof-input",maxLength:60})]}),t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"groupe-desc",children:"Description (optionnelle)"}),t.jsx("input",{id:"groupe-desc",type:"text",placeholder:"Ex: Cours du mardi et jeudi matin",value:F.description||"",onChange:R=>ve("description",R.target.value),className:"prof-input",maxLength:120})]}),t.jsxs("div",{className:"prof-form-row",children:[t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"groupe-niveau",children:"Niveau de classe *"}),t.jsx("select",{id:"groupe-niveau",value:F.classeNiveau,onChange:R=>ve("classeNiveau",R.target.value),className:"prof-select",children:iA.map(R=>t.jsx("option",{value:R.value,children:R.label},R.value))})]}),t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"groupe-annee",children:"Anne scolaire *"}),t.jsx("select",{id:"groupe-annee",value:F.anneeScolaire,onChange:R=>ve("anneeScolaire",R.target.value),className:"prof-select",children:aA.map(R=>t.jsx("option",{value:R,children:R},R))})]})]}),we("groupe-discipline",F.matiereId,R=>I(R,!1)),t.jsx("div",{className:"prof-form-actions",children:t.jsx("button",{type:"submit",className:"prof-btn prof-btn-primary",disabled:j||!F.nom.trim()||!F.matiereId,children:j?" Cration...":" Crer le groupe"})})]})]}),A&&t.jsxs("div",{className:"groupe-form-container",style:{borderLeft:"4px solid #f59e0b"},children:[t.jsxs("h3",{children:[" Modifier le groupe : ",A.nom]}),t.jsxs("form",{onSubmit:Z,className:"groupe-form",children:[t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"edit-groupe-nom",children:"Nom du groupe *"}),t.jsx("input",{id:"edit-groupe-nom",type:"text",value:M.nom,onChange:R=>De("nom",R.target.value),required:!0,className:"prof-input",maxLength:60})]}),t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"edit-groupe-desc",children:"Description (optionnelle)"}),t.jsx("input",{id:"edit-groupe-desc",type:"text",value:M.description||"",onChange:R=>De("description",R.target.value),className:"prof-input",maxLength:120})]}),t.jsxs("div",{className:"prof-form-row",children:[t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"edit-groupe-niveau",children:"Niveau de classe *"}),t.jsx("select",{id:"edit-groupe-niveau",value:M.classeNiveau,onChange:R=>De("classeNiveau",R.target.value),className:"prof-select",children:iA.map(R=>t.jsx("option",{value:R.value,children:R.label},R.value))})]}),t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"edit-groupe-annee",children:"Anne scolaire *"}),t.jsx("select",{id:"edit-groupe-annee",value:M.anneeScolaire,onChange:R=>De("anneeScolaire",R.target.value),className:"prof-select",children:aA.map(R=>t.jsx("option",{value:R,children:R},R))})]})]}),we("edit-groupe-discipline",M.matiereId,R=>I(R,!0)),t.jsxs("div",{className:"prof-form-actions",style:{display:"flex",gap:"0.75rem"},children:[t.jsx("button",{type:"submit",className:"prof-btn prof-btn-primary",disabled:k||!M.nom.trim()||!M.matiereId,children:k?" Enregistrement...":" Enregistrer"}),t.jsx("button",{type:"button",className:"prof-btn prof-btn-secondary",onClick:T,disabled:k,children:" Annuler"})]})]})]}),t.jsxs("div",{className:"groupe-filtres",children:[t.jsxs("button",{className:`prof-filtre-btn ${ee==="actif"?"active":""}`,onClick:()=>X("actif"),children:["Actifs (",n.filter(R=>R.statut==="actif").length,")"]}),t.jsxs("button",{className:`prof-filtre-btn ${ee==="archive"?"active":""}`,onClick:()=>X("archive"),children:["Archivs (",n.filter(R=>R.statut==="archive").length,")"]}),t.jsxs("button",{className:`prof-filtre-btn ${ee==="tous"?"active":""}`,onClick:()=>X("tous"),children:["Tous (",n.length,")"]})]}),de.length===0?t.jsxs("div",{className:"prof-empty-state",children:[t.jsx("div",{className:"prof-empty-icon",children:""}),t.jsx("h3",{children:ee==="archive"?"Aucun groupe archiv":"Aucun groupe-classe cr"}),t.jsx("p",{children:ee==="archive"?"Vos groupes archivs apparatront ici.":"Crez votre premier groupe-classe pour commencer  suivre vos lves."}),ee!=="archive"&&t.jsx("button",{className:"prof-btn prof-btn-primary",onClick:()=>x(!0),children:" Crer mon premier groupe"})]}):t.jsx("div",{className:"groupe-grid",children:de.map(R=>{const ae=l.get(R.id),Ce=A?.id===R.id;return t.jsxs("div",{className:`groupe-card ${R.statut==="archive"?"groupe-card-archive":""} ${Ce?"groupe-card-editing":""}`,children:[t.jsxs("div",{className:"groupe-card-header",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"groupe-card-titre",children:R.nom}),t.jsx("span",{className:"groupe-card-matiere",children:R.matiereNom})]}),t.jsx("span",{className:`groupe-badge groupe-badge-${R.statut}`,children:R.statut==="actif"?" Actif":" Archiv"})]}),R.description&&t.jsx("p",{style:{color:"#6b7280",fontSize:"0.85rem",margin:"0.25rem 0 0.5rem"},children:R.description}),t.jsxs("div",{className:"groupe-card-infos",children:[t.jsxs("span",{children:[" ",R.classeNiveau]}),t.jsxs("span",{children:[" ",R.anneeScolaire]}),t.jsxs("span",{children:[" ",R.nombreInscrits," lve",R.nombreInscrits!==1?"s":""]})]}),t.jsxs("div",{className:"groupe-card-code",children:[t.jsx("span",{className:"groupe-code-label",children:"Code d'invitation :"}),t.jsxs("div",{className:"groupe-code-box",children:[t.jsx("code",{className:"groupe-code-value",children:R.codeInvitation}),t.jsx("button",{className:"prof-btn-icon",onClick:ke=>{ke.stopPropagation(),H(R.codeInvitation)},title:"Copier le code",children:w===R.codeInvitation?"":""}),R.statut==="actif"&&t.jsx("button",{className:"prof-btn-icon",onClick:ke=>{ke.stopPropagation(),G(R.id)},title:"Rgnrer le code",children:""})]})]}),ae&&ae.nombreEleves>0&&t.jsxs("div",{className:"groupe-card-stats",children:[t.jsxs("div",{className:"groupe-stat-item",children:[t.jsx("span",{className:"groupe-stat-value",children:ae.moyenneClasse}),t.jsx("span",{className:"groupe-stat-label",children:"Moyenne"})]}),t.jsxs("div",{className:"groupe-stat-item",children:[t.jsxs("span",{className:"groupe-stat-value",children:[ae.tauxReussite,"%"]}),t.jsx("span",{className:"groupe-stat-label",children:"Russite"})]}),t.jsxs("div",{className:"groupe-stat-item",children:[t.jsx("span",{className:"groupe-stat-value",children:ae.elevesEnDifficulte}),t.jsx("span",{className:"groupe-stat-label",children:"En difficult"})]})]}),t.jsxs("div",{className:"groupe-card-actions",children:[R.statut==="actif"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"prof-btn prof-btn-primary prof-btn-sm",onClick:()=>e(R),children:" Voir dtails"}),t.jsx("button",{className:"prof-btn prof-btn-warning prof-btn-sm",onClick:()=>B(R),style:{background:"#fef3c7",color:"#92400e",border:"1px solid #fbbf24"},children:" Modifier"}),t.jsx("button",{className:"prof-btn prof-btn-secondary prof-btn-sm",onClick:()=>xe(R.id),children:" Archiver"})]}),R.statut==="archive"&&t.jsx("button",{className:"prof-btn prof-btn-primary prof-btn-sm",onClick:()=>fe(R.id),children:" Restaurer"}),E===R.id?t.jsxs("div",{className:"groupe-confirm-suppression",children:[t.jsx("span",{children:"Confirmer ?"}),t.jsx("button",{className:"prof-btn prof-btn-danger prof-btn-sm",onClick:()=>ce(R.id),children:"Oui, supprimer"}),t.jsx("button",{className:"prof-btn prof-btn-secondary prof-btn-sm",onClick:()=>S(null),children:"Non"})]}):t.jsx("button",{className:"prof-btn prof-btn-danger prof-btn-sm",onClick:()=>S(R.id),children:" Supprimer"})]})]},R.id)})})]})},Tj="absences_groupe";function tJ(e){return e instanceof Ee?e.toDate():e instanceof Date?e:e&&typeof e=="object"&&"seconds"in e?new Ee(e.seconds,e.nanoseconds||0).toDate():new Date(e)}function SM(e,r){return`${e}_${r}`}async function rJ(e,r,n,a){const l=je(V,Tj,SM(e,r));await rl(l,{groupeId:e,date:r,eleveIdsAbsents:n,profId:a,updatedAt:Ee.now()})}async function nJ(e,r){const n=je(V,Tj,SM(e,r)),a=await pt(n);return a.exists()?a.data().eleveIdsAbsents||[]:[]}async function aJ(e,r,n){const a=ze(_e(V,Tj),Se("groupeId","==",e),Se("date",">=",r),Se("date","<=",n),Qe("date","asc"));return(await Ae(a)).docs.map(o=>({id:o.id,...o.data(),updatedAt:tJ(o.data().updatedAt)}))}async function iJ(e,r,n,a,l){const o=je(V,"groupes_prof",e,"observations",r);await rl(o,{eleveId:r,eleveNom:n,groupeId:e,texte:a,profId:l,updatedAt:Ee.now()})}async function sJ(e,r){const n=je(V,"groupes_prof",e,"observations",r),a=await pt(n);return a.exists()&&a.data().texte||""}function lJ({groupeId:e,statsEleves:r,periode:n}){const[a,l]=g.useState({}),[o,u]=g.useState(!0);if(g.useEffect(()=>{let m=!1;const p=new Date;let h,v;if(n==="jour")h=v=p.toISOString().slice(0,10);else if(n==="semaine"){const b=new Date(p);b.setDate(b.getDate()-7),h=b.toISOString().slice(0,10),v=p.toISOString().slice(0,10)}else{const b=new Date(p);b.setMonth(b.getMonth()-1),h=b.toISOString().slice(0,10),v=p.toISOString().slice(0,10)}return(async()=>{try{const b=await aJ(e,h,v),x={};r.forEach(j=>{x[j.eleveId]=0}),b.forEach(j=>{(j.eleveIdsAbsents||[]).forEach(_=>{x[_]!==void 0&&x[_]++})}),m||l(x)}finally{m||u(!1)}})(),()=>{m=!0}},[e,r,n]),o)return t.jsx("p",{className:"text-muted",children:"Chargement..."});const d=[...r].sort((m,p)=>(a[p.eleveId]||0)-(a[m.eleveId]||0));return t.jsxs("table",{className:"groupe-eleves-table groupe-appel-suivi-table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"lve"}),t.jsxs("th",{children:["Absences (",n,")"]})]})}),t.jsx("tbody",{children:d.map(m=>t.jsxs("tr",{children:[t.jsx("td",{children:m.eleveNom}),t.jsx("td",{className:a[m.eleveId]>0?"prof-note-critique":"",children:a[m.eleveId]||0})]},m.eleveId))})]})}const oJ=({groupe:e,onRetour:r})=>{const{currentUser:n}=Xe(),[a,l]=g.useState(null),[o,u]=g.useState([]),[d,m]=g.useState([]),[p,h]=g.useState([]),[v,b]=g.useState(null),[x,j]=g.useState([]),[_,w]=g.useState({}),[C,E]=g.useState(()=>new Date().toISOString().slice(0,10)),[S,A]=g.useState([]),[z,k]=g.useState(!1),[P,D]=g.useState("semaine"),[$,F]=g.useState(""),[Y,M]=g.useState(""),[K,ee]=g.useState(""),[X,L]=g.useState(!1),[I,U]=g.useState(!0),[B,T]=g.useState(null),[Z,H]=g.useState("apercu"),[ce,xe]=g.useState("moyenne_desc"),[fe,G]=g.useState(null),[ve,De]=g.useState(""),[de,we]=g.useState(null),[R,ae]=g.useState(null),[Ce,ke]=g.useState(!1),[Ke,et]=g.useState(null),rt=g.useCallback(async()=>{try{U(!0),T(null);const[se,Oe,dt]=await Promise.all([Mj(e.id),$Z(e.id),UZ(e.matiereId)]);l(se),u(Oe),h(dt);const te=FZ(Oe,e.nom);m(te)}catch(se){console.error("Erreur chargement dtail groupe:",se),T("Impossible de charger les donnes du groupe.")}finally{U(!1)}},[e.id,e.matiereId,e.nom]);g.useEffect(()=>{rt()},[rt]),g.useEffect(()=>{Z==="appel"&&nJ(e.id,C).then(A).catch(()=>A([]))},[Z,e.id,C]),g.useEffect(()=>{Z==="travaux"&&rA(e.id).then(j).catch(()=>j([]))},[Z,e.id]),g.useEffect(()=>{if(!fe){De("");return}sJ(e.id,fe).then(se=>{De(se),w(Oe=>({...Oe,[fe]:se}))}).catch(()=>De(""))},[e.id,fe]);const Yt=async se=>{try{ke(!0),ae(se);const Oe=await BZ(e.id,se);b(Oe)}catch(Oe){console.error("Erreur analyse quiz:",Oe)}finally{ke(!1)}},mr=()=>{const se=GZ(o,e.nom),Oe=`PedaClic_${e.nom.replace(/\s+/g,"_")}_${new Date().toISOString().slice(0,10)}`;HZ(se,Oe)},fr=async se=>{try{et(se);const dt=(await wp(e.id)).find(te=>te.eleveId===se);dt&&(await LZ(dt.id,e.id),await rt())}catch(Oe){T(Oe.message)}finally{et(null)}},$r=async()=>{if(n?.uid)try{k(!0),await rJ(e.id,C,S,n.uid)}catch(se){T(se.message)}finally{k(!1)}},he=async()=>{if(!fe||!n?.uid)return;const se=o.find(Oe=>Oe.eleveId===fe);if(se)try{we(fe),await iJ(e.id,fe,se.eleveNom,ve,n.uid),w(Oe=>({...Oe,[fe]:ve}))}catch(Oe){T(Oe.message)}finally{we(null)}},Pe=async()=>{if(!n?.uid||!$.trim())return;const se=K?new Date(K):new Date(Date.now()+10080*60*1e3);try{L(!0),await VZ({groupeId:e.id,groupeNom:e.nom,titre:$.trim(),description:Y.trim()||void 0,dateEcheance:se,matiere:e.matiereNom,profId:n.uid}),F(""),M(""),ee("");const Oe=await rA(e.id);j(Oe)}catch(Oe){T(Oe.message)}finally{L(!1)}},Ie=async se=>{try{await QZ(se),j(Oe=>Oe.filter(dt=>dt.id!==se))}catch(Oe){T(Oe?.message)}},Ye=[...o].sort((se,Oe)=>{switch(ce){case"moyenne_desc":return Oe.moyenne-se.moyenne;case"moyenne_asc":return se.moyenne-Oe.moyenne;case"nom":return se.eleveNom.localeCompare(Oe.eleveNom);case"streak":return Oe.streak.actuel-se.streak.actuel;case"quiz_count":return Oe.totalQuiz-se.totalQuiz;default:return 0}}),nt=se=>se>=16?"prof-note-excellent":se>=12?"prof-note-bien":se>=10?"prof-note-passable":se>=8?"prof-note-insuffisant":"prof-note-critique",qt=se=>{switch(se){case"hausse":return"";case"baisse":return"";default:return""}},Kt=se=>{switch(se){case"difficulte":return"";case"inactivite":return"";case"baisse":return"";case"felicitation":return"";default:return""}};return I?t.jsxs("div",{className:"prof-loading",children:[t.jsx("div",{className:"spinner"}),t.jsxs("p",{children:['Chargement des donnes de "',e.nom,'"...']})]}):t.jsxs("div",{className:"groupe-detail",children:[t.jsxs("div",{className:"groupe-detail-header",children:[t.jsx("button",{className:"prof-btn prof-btn-secondary",onClick:r,children:" Retour aux groupes"}),t.jsxs("div",{className:"groupe-detail-titre-section",children:[t.jsx("h2",{className:"groupe-detail-titre",children:e.nom}),t.jsxs("p",{className:"groupe-detail-subtitle",children:[e.matiereNom,"  ",e.classeNiveau,"  ",e.anneeScolaire]})]}),t.jsx("button",{className:"prof-btn prof-btn-secondary",onClick:mr,children:" Export CSV"})]}),B&&t.jsxs("div",{className:"prof-alert prof-alert-error",children:[" ",B,t.jsx("button",{onClick:()=>T(null),className:"prof-alert-close",children:""})]}),t.jsx("div",{className:"groupe-detail-onglets",children:[{id:"apercu",label:" Aperu",count:null},{id:"eleves",label:" lves",count:o.length},{id:"appel",label:" Appel",count:null},{id:"travaux",label:" Travaux",count:x.length},{id:"quiz",label:" Quiz",count:p.length},{id:"alertes",label:" Alertes",count:d.length}].map(se=>t.jsxs("button",{className:`groupe-onglet ${Z===se.id?"active":""}`,onClick:()=>H(se.id),children:[se.label,se.count!==null&&se.count>0&&t.jsx("span",{className:"groupe-onglet-badge",children:se.count})]},se.id))}),Z==="apercu"&&a&&t.jsxs("div",{className:"groupe-apercu",children:[t.jsxs("div",{className:"groupe-stats-grid",children:[t.jsxs("div",{className:"groupe-stat-card",children:[t.jsx("div",{className:"groupe-stat-card-icon",children:""}),t.jsxs("div",{className:"groupe-stat-card-content",children:[t.jsxs("span",{className:`groupe-stat-card-value ${nt(a.moyenneClasse)}`,children:[a.moyenneClasse,"/20"]}),t.jsx("span",{className:"groupe-stat-card-label",children:"Moyenne classe"})]})]}),t.jsxs("div",{className:"groupe-stat-card",children:[t.jsx("div",{className:"groupe-stat-card-icon",children:""}),t.jsxs("div",{className:"groupe-stat-card-content",children:[t.jsxs("span",{className:"groupe-stat-card-value",children:[a.tauxReussite,"%"]}),t.jsx("span",{className:"groupe-stat-card-label",children:"Taux de russite"})]})]}),t.jsxs("div",{className:"groupe-stat-card",children:[t.jsx("div",{className:"groupe-stat-card-icon",children:""}),t.jsxs("div",{className:"groupe-stat-card-content",children:[t.jsx("span",{className:"groupe-stat-card-value",children:a.nombreEleves}),t.jsx("span",{className:"groupe-stat-card-label",children:"lves inscrits"})]})]}),t.jsxs("div",{className:"groupe-stat-card",children:[t.jsx("div",{className:"groupe-stat-card-icon",children:""}),t.jsxs("div",{className:"groupe-stat-card-content",children:[t.jsx("span",{className:"groupe-stat-card-value",children:a.totalQuizPasses}),t.jsx("span",{className:"groupe-stat-card-label",children:"Quiz passs"})]})]}),t.jsxs("div",{className:"groupe-stat-card",children:[t.jsx("div",{className:"groupe-stat-card-icon",children:""}),t.jsxs("div",{className:"groupe-stat-card-content",children:[t.jsxs("span",{className:"groupe-stat-card-value",children:[a.tauxParticipation,"%"]}),t.jsx("span",{className:"groupe-stat-card-label",children:"Participation"})]})]}),t.jsxs("div",{className:"groupe-stat-card",children:[t.jsx("div",{className:"groupe-stat-card-icon",children:""}),t.jsxs("div",{className:"groupe-stat-card-content",children:[t.jsx("span",{className:`groupe-stat-card-value ${a.elevesEnDifficulte>0?"prof-note-critique":"prof-note-excellent"}`,children:a.elevesEnDifficulte}),t.jsx("span",{className:"groupe-stat-card-label",children:"En difficult"})]})]})]}),t.jsx("div",{className:"groupe-apercu-notes",children:t.jsxs("div",{className:"groupe-note-range",children:[t.jsx("span",{className:"groupe-note-range-label",children:"Plage des notes :"}),t.jsxs("span",{className:"prof-note-critique",children:[a.pireNote,"/20"]}),t.jsx("div",{className:"groupe-note-barre",children:t.jsx("div",{className:"groupe-note-barre-fill",style:{left:`${a.pireNote/20*100}%`,width:`${(a.meilleureNote-a.pireNote)/20*100}%`}})}),t.jsxs("span",{className:"prof-note-excellent",children:[a.meilleureNote,"/20"]})]})}),o.length>=3&&t.jsxs("div",{className:"groupe-apercu-classement",children:[t.jsxs("div",{className:"groupe-classement-section",children:[t.jsx("h4",{children:" Top 3"}),o.slice(0,3).map((se,Oe)=>t.jsxs("div",{className:"groupe-classement-item",children:[t.jsx("span",{className:"groupe-classement-rang",children:Oe===0?"":Oe===1?"":""}),t.jsx("span",{className:"groupe-classement-nom",children:se.eleveNom}),t.jsxs("span",{className:`groupe-classement-note ${nt(se.moyenne)}`,children:[se.moyenne,"/20"]})]},se.eleveId))]}),t.jsxs("div",{className:"groupe-classement-section",children:[t.jsx("h4",{children:"  surveiller"}),o.filter(se=>se.moyenne<8&&se.totalQuiz>0).slice(0,3).map(se=>t.jsxs("div",{className:"groupe-classement-item",children:[t.jsx("span",{className:"groupe-classement-rang",children:""}),t.jsx("span",{className:"groupe-classement-nom",children:se.eleveNom}),t.jsxs("span",{className:`groupe-classement-note ${nt(se.moyenne)}`,children:[se.moyenne,"/20"]})]},se.eleveId)),o.filter(se=>se.moyenne<8&&se.totalQuiz>0).length===0&&t.jsx("p",{className:"groupe-classement-vide",children:"Aucun lve en difficult "})]})]})]}),Z==="eleves"&&t.jsxs("div",{className:"groupe-eleves",children:[t.jsxs("div",{className:"groupe-eleves-toolbar",children:[t.jsx("label",{htmlFor:"tri-eleves",children:"Trier par :"}),t.jsxs("select",{id:"tri-eleves",value:ce,onChange:se=>xe(se.target.value),className:"prof-select prof-select-sm",children:[t.jsx("option",{value:"moyenne_desc",children:"Moyenne ()"}),t.jsx("option",{value:"moyenne_asc",children:"Moyenne ()"}),t.jsx("option",{value:"nom",children:"Nom (A-Z)"}),t.jsx("option",{value:"streak",children:"Streak ()"}),t.jsx("option",{value:"quiz_count",children:"Quiz passs ()"})]}),t.jsxs("span",{className:"groupe-eleves-count",children:[o.length," lve",o.length!==1?"s":""]})]}),o.length===0?t.jsxs("div",{className:"prof-empty-state",children:[t.jsx("div",{className:"prof-empty-icon",children:""}),t.jsx("h3",{children:"Aucun lve inscrit"}),t.jsxs("p",{children:["Partagez le code ",t.jsx("strong",{children:e.codeInvitation}),"  vos lves."]})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"groupe-eleves-table-wrapper",children:t.jsxs("table",{className:"groupe-eleves-table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"#"}),t.jsx("th",{children:"lve"}),t.jsx("th",{children:"Moyenne"}),t.jsx("th",{children:"Quiz"}),t.jsx("th",{children:"Russite"}),t.jsx("th",{children:"Streak"}),t.jsx("th",{children:"Tendance"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:Ye.map((se,Oe)=>t.jsxs("tr",{className:`${fe===se.eleveId?"groupe-eleve-row-active":""}`,children:[t.jsx("td",{className:"groupe-eleve-rang",children:Oe+1}),t.jsx("td",{className:"groupe-eleve-nom-cell",children:t.jsxs("div",{children:[t.jsx("strong",{children:se.eleveNom}),t.jsx("span",{className:"groupe-eleve-email",children:se.eleveEmail})]})}),t.jsx("td",{children:t.jsxs("span",{className:`groupe-note-badge ${nt(se.moyenne)}`,children:[se.moyenne,"/20"]})}),t.jsx("td",{children:se.totalQuiz}),t.jsxs("td",{children:[se.tauxReussite,"%"]}),t.jsx("td",{children:t.jsxs("span",{className:"groupe-streak",children:[" ",se.streak.actuel,"j"]})}),t.jsxs("td",{children:[qt(se.tendance)," ",se.tendance]}),t.jsxs("td",{className:"groupe-eleve-actions",children:[t.jsx("button",{className:"prof-btn-icon",onClick:()=>G(fe===se.eleveId?null:se.eleveId),title:"Voir dtails",children:fe===se.eleveId?"":""}),t.jsx("button",{className:"prof-btn-icon prof-btn-icon-danger",onClick:()=>fr(se.eleveId),disabled:Ke===se.eleveId,title:"Retirer du groupe",children:Ke===se.eleveId?"":""})]})]},se.eleveId))})]})}),fe&&(()=>{const se=o.find(Oe=>Oe.eleveId===fe);return se?t.jsxs("div",{className:"groupe-eleve-detail",children:[t.jsxs("div",{className:"groupe-eleve-detail-header",children:[t.jsxs("h3",{children:[" Dtail  ",se.eleveNom]}),t.jsx("button",{className:"prof-btn-icon",onClick:()=>G(null),children:""})]}),t.jsxs("div",{className:"groupe-eleve-detail-grid",children:[t.jsxs("div",{className:"groupe-eleve-detail-card",children:[t.jsx("h4",{children:"Score global"}),t.jsx("div",{className:"groupe-eleve-score-circle",children:t.jsxs("span",{className:nt(se.scoreGlobal/5),children:[se.scoreGlobal,"/100"]})})]}),t.jsxs("div",{className:"groupe-eleve-detail-card",children:[t.jsx("h4",{children:" Streak"}),t.jsxs("p",{children:["Actuel : ",t.jsxs("strong",{children:[se.streak.actuel," jour",se.streak.actuel!==1?"s":""]})]}),t.jsxs("p",{children:["Meilleur : ",se.streak.meilleur," jours"]})]}),t.jsxs("div",{className:"groupe-eleve-detail-card groupe-eleve-detail-card-wide",children:[t.jsx("h4",{children:" Lacunes dtectes"}),se.lacunes.length===0?t.jsx("p",{className:"text-muted",children:"Aucune lacune dtecte "}):t.jsx("ul",{className:"groupe-lacunes-liste",children:se.lacunes.map((Oe,dt)=>t.jsxs("li",{className:`groupe-lacune-item groupe-lacune-${Oe.niveauUrgence}`,children:[t.jsxs("span",{className:"groupe-lacune-nom",children:[Oe.disciplineNom,Oe.chapitre&&`  ${Oe.chapitre}`]}),t.jsxs("span",{className:"groupe-lacune-moyenne",children:[Oe.moyenne,"/20"]}),t.jsx("span",{className:`groupe-lacune-badge groupe-lacune-badge-${Oe.niveauUrgence}`,children:Oe.niveauUrgence})]},dt))})]}),t.jsxs("div",{className:"groupe-eleve-detail-card groupe-eleve-detail-card-wide",children:[t.jsx("h4",{children:" Observations"}),t.jsx("textarea",{className:"prof-textarea",rows:3,placeholder:"Notes sur cet lve...",value:ve,onChange:Oe=>De(Oe.target.value)}),t.jsx("button",{className:"prof-btn prof-btn-primary prof-btn-sm",onClick:he,disabled:de===se.eleveId,children:de===se.eleveId?"Enregistrement...":" Enregistrer"})]})]})]}):null})()]})]}),Z==="appel"&&t.jsxs("div",{className:"groupe-appel",children:[t.jsxs("div",{className:"groupe-appel-header",children:[t.jsx("label",{htmlFor:"date-appel",children:"Date de l'appel :"}),t.jsx("input",{id:"date-appel",type:"date",value:C,onChange:se=>E(se.target.value),className:"prof-input prof-input-sm"})]}),o.length===0?t.jsx("div",{className:"prof-empty-state",children:t.jsx("p",{children:"Aucun lve inscrit. Partagez le code pour inviter des lves."})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"groupe-appel-liste",children:[t.jsx("h4",{children:" Marquer les absents"}),o.map(se=>t.jsxs("label",{className:"groupe-appel-item",children:[t.jsx("input",{type:"checkbox",checked:S.includes(se.eleveId),onChange:Oe=>{Oe.target.checked?A(dt=>[...dt,se.eleveId]):A(dt=>dt.filter(te=>te!==se.eleveId))}}),t.jsx("span",{className:S.includes(se.eleveId)?"groupe-appel-absent":"",children:se.eleveNom})]},se.eleveId))]}),t.jsx("div",{className:"groupe-appel-actions",children:t.jsx("button",{className:"prof-btn prof-btn-primary",onClick:$r,disabled:z,children:z?"Enregistrement...":" Enregistrer les absences"})}),t.jsxs("div",{className:"groupe-appel-suivi",children:[t.jsx("h4",{children:" Suivi des absences"}),t.jsx("div",{className:"groupe-appel-suivi-btns",children:["jour","semaine","mois"].map(se=>t.jsx("button",{className:`prof-btn prof-btn-sm prof-btn-secondary ${P===se?"active":""}`,onClick:()=>D(se),children:se==="jour"?"Jour":se==="semaine"?"Semaine":"Mois"},se))}),t.jsx(lJ,{groupeId:e.id,statsEleves:o,periode:P})]})]})]}),Z==="travaux"&&t.jsxs("div",{className:"groupe-travaux",children:[t.jsxs("div",{className:"groupe-travaux-form",children:[t.jsx("h4",{children:" Nouveau travail"}),t.jsx("input",{type:"text",className:"prof-input",placeholder:"Titre du travail",value:$,onChange:se=>F(se.target.value)}),t.jsx("textarea",{className:"prof-textarea",rows:2,placeholder:"Description (optionnel)",value:Y,onChange:se=>M(se.target.value)}),t.jsxs("div",{className:"groupe-travaux-echeance",children:[t.jsx("label",{children:"chance :"}),t.jsx("input",{type:"date",className:"prof-input prof-input-sm",value:K,onChange:se=>ee(se.target.value)})]}),t.jsx("button",{className:"prof-btn prof-btn-primary",onClick:Pe,disabled:X||!$.trim(),children:X?"Ajout...":"Ajouter le travail"})]}),t.jsxs("div",{className:"groupe-travaux-liste",children:[t.jsx("h4",{children:" Travaux en cours"}),x.length===0?t.jsx("p",{className:"text-muted",children:"Aucun travail  faire pour l'instant."}):t.jsx("ul",{className:"groupe-travaux-items",children:x.map(se=>t.jsxs("li",{className:"groupe-travaux-item",children:[t.jsxs("div",{children:[t.jsx("strong",{children:se.titre}),se.description&&t.jsx("p",{className:"groupe-travaux-desc",children:se.description}),t.jsxs("span",{className:"groupe-travaux-date",children:[" ",se.dateEcheance instanceof Date?se.dateEcheance.toLocaleDateString("fr-FR"):new Date(se.dateEcheance).toLocaleDateString("fr-FR")]})]}),t.jsx("button",{className:"prof-btn-icon prof-btn-icon-danger",onClick:()=>Ie(se.id),title:"Supprimer",children:""})]},se.id))})]})]}),Z==="quiz"&&t.jsxs("div",{className:"groupe-quiz",children:[t.jsxs("div",{className:"groupe-quiz-selector",children:[t.jsx("label",{htmlFor:"select-quiz",children:"Slectionner un quiz  analyser :"}),t.jsxs("select",{id:"select-quiz",value:R||"",onChange:se=>{se.target.value&&Yt(se.target.value)},className:"prof-select",children:[t.jsx("option",{value:"",children:" Choisir un quiz "}),p.map(se=>t.jsx("option",{value:se.id,children:se.titre},se.id))]})]}),!R&&t.jsxs("div",{className:"prof-empty-state",children:[t.jsx("div",{className:"prof-empty-icon",children:""}),t.jsx("h3",{children:"Analyse par quiz"}),t.jsx("p",{children:"Slectionnez un quiz pour voir les statistiques dtailles et les questions les plus rates."})]}),Ce&&t.jsxs("div",{className:"prof-loading",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Analyse en cours..."})]}),v&&!Ce&&t.jsxs("div",{className:"groupe-quiz-resultats",children:[t.jsxs("div",{className:"groupe-quiz-stats-header",children:[t.jsx("h3",{children:v.quizTitre}),t.jsxs("div",{className:"groupe-quiz-stats-grid",children:[t.jsxs("div",{className:"groupe-stat-mini",children:[t.jsx("span",{className:"groupe-stat-mini-value",children:v.totalPassages}),t.jsx("span",{className:"groupe-stat-mini-label",children:"Passages"})]}),t.jsxs("div",{className:"groupe-stat-mini",children:[t.jsxs("span",{className:`groupe-stat-mini-value ${nt(v.moyenneScore)}`,children:[v.moyenneScore,"/20"]}),t.jsx("span",{className:"groupe-stat-mini-label",children:"Moyenne"})]}),t.jsxs("div",{className:"groupe-stat-mini",children:[t.jsxs("span",{className:"groupe-stat-mini-value",children:[v.tauxReussite,"%"]}),t.jsx("span",{className:"groupe-stat-mini-label",children:"Russite"})]}),t.jsxs("div",{className:"groupe-stat-mini",children:[t.jsxs("span",{className:"groupe-stat-mini-value",children:[Math.floor(v.tempsEcouleMoyen/60),"min"]}),t.jsx("span",{className:"groupe-stat-mini-label",children:"Temps moyen"})]})]})]}),t.jsxs("div",{className:"groupe-quiz-questions",children:[t.jsx("h4",{children:" Questions les plus rates"}),v.questionsRatees.filter(se=>se.tauxEchec>30).map((se,Oe)=>t.jsxs("div",{className:"groupe-quiz-question-card",children:[t.jsxs("div",{className:"groupe-quiz-question-header",children:[t.jsxs("span",{className:"groupe-quiz-question-num",children:["Q",se.questionIndex+1]}),t.jsxs("span",{className:"groupe-quiz-question-echec",children:[se.tauxEchec,"% d'chec"]})]}),t.jsx("p",{className:"groupe-quiz-question-texte",children:se.questionTexte}),t.jsx("div",{className:"groupe-quiz-question-reponse",children:t.jsxs("span",{className:"groupe-quiz-bonne-reponse",children:[" Bonne rponse : ",se.reponseCorrecte]})}),se.reponsesFrequentes.length>0&&t.jsxs("div",{className:"groupe-quiz-mauvaises-reponses",children:[t.jsx("span",{children:"Erreurs frquentes :"}),se.reponsesFrequentes.slice(0,2).map((dt,te)=>t.jsxs("span",{className:"groupe-quiz-mauvaise-reponse",children:[" ",dt.reponse," (",dt.nombre," lve",dt.nombre>1?"s":"",")"]},te))]})]},Oe)),v.questionsRatees.filter(se=>se.tauxEchec>30).length===0&&t.jsx("p",{className:"text-muted",children:"Toutes les questions ont un taux de russite suprieur  70% "})]})]})]}),Z==="alertes"&&t.jsx("div",{className:"groupe-alertes",children:d.length===0?t.jsxs("div",{className:"prof-empty-state",children:[t.jsx("div",{className:"prof-empty-icon",children:""}),t.jsx("h3",{children:"Aucune alerte"}),t.jsx("p",{children:"Tous vos lves se portent bien ! Les alertes apparatront ici quand un lve aura besoin d'attention."})]}):t.jsx("div",{className:"groupe-alertes-liste",children:d.map(se=>t.jsxs("div",{className:`groupe-alerte-card groupe-alerte-${se.niveauUrgence}`,children:[t.jsxs("div",{className:"groupe-alerte-header",children:[t.jsx("span",{className:"groupe-alerte-emoji",children:Kt(se.type)}),t.jsx("span",{className:"groupe-alerte-eleve",children:se.eleveNom}),t.jsx("span",{className:`groupe-alerte-badge groupe-alerte-badge-${se.niveauUrgence}`,children:se.niveauUrgence})]}),t.jsx("p",{className:"groupe-alerte-message",children:se.message}),t.jsx("button",{className:"prof-btn prof-btn-secondary prof-btn-sm",onClick:()=>{H("eleves"),G(se.eleveId)},children:" Voir dtail"})]},se.id))})})]})},cJ=()=>{const{currentUser:e}=Xe(),r=tt(),[n,a]=g.useState("overview"),[l,o]=g.useState(null),[u,d]=g.useState(0),[m,p]=g.useState(0),[h,v]=g.useState(0),[b,x]=g.useState(0),[j,_]=g.useState([]),[w,C]=g.useState(!0),E=g.useCallback(async()=>{if(e?.uid)try{C(!0);const k=(await _M(e.uid)).filter(M=>M.statut==="actif");d(k.length);let P=0,D=0,$=0,F=0;const Y=[];for(const M of k)try{const K=await Mj(M.id);P+=K.nombreEleves,K.nombreEleves>0&&(D+=K.moyenneClasse,$++),F+=K.elevesEnDifficulte,Y.push({...M,stats:K})}catch{Y.push({...M})}p(P),v($>0?Math.round(D/$*10)/10:0),x(F),_(Y)}catch(z){console.error("Erreur chargement rsum prof:",z)}finally{C(!1)}},[e?.uid]);g.useEffect(()=>{E()},[E]);const S=z=>{o(z),a("detail")},A=()=>{o(null),a("groupes"),E()};return w?t.jsxs("div",{className:"prof-loading",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement de votre espace professeur..."})]}):t.jsxs("div",{className:"prof-dashboard",children:[t.jsxs("header",{className:"prof-dashboard-header",style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[t.jsxs("div",{children:[t.jsx("h1",{className:"prof-dashboard-titre",children:"Tableau de bord Professeur"}),t.jsxs("p",{className:"prof-dashboard-subtitle",children:["Bienvenue, ",e?.displayName||"Professeur"," ",e?.isPremium&&t.jsxs("span",{style:{marginLeft:"0.5rem",display:"inline-flex",alignItems:"center",gap:"0.25rem"},children:[t.jsx(jr,{size:14,style:{color:"#f59e0b"}})," Premium"]})]})]}),e?.isPremium&&So(e.subscriptionPlan)&&t.jsx("button",{className:"prof-btn prof-btn-secondary",onClick:()=>r("/premium/mes-cours"),style:{fontSize:"0.875rem"},children:" Choisir mes cours"})]}),n!=="detail"&&t.jsxs("nav",{className:"prof-nav",children:[t.jsx("button",{className:`prof-nav-btn ${n==="overview"?"active":""}`,onClick:()=>a("overview"),children:" Vue d'ensemble"}),t.jsx("button",{className:`prof-nav-btn ${n==="groupes"?"active":""}`,onClick:()=>a("groupes"),children:" Mes groupes-classes"}),t.jsx("button",{className:"prof-nav-btn",onClick:()=>r("/prof/cahiers"),children:" Cahier de textes"}),t.jsx("button",{className:"prof-nav-btn",onClick:()=>r("/prof/sequences"),children:" Squences pdagogiques"}),t.jsx("button",{className:"prof-nav-btn",onClick:()=>r("/prof/cours"),children:" Cours en ligne"})]}),n==="overview"&&t.jsxs("div",{className:"prof-overview",children:[t.jsxs("div",{className:"prof-overview-cards",children:[t.jsxs("div",{className:"prof-overview-card prof-overview-card-clickable",onClick:()=>a("groupes"),children:[t.jsx("div",{className:"prof-overview-card-icon",children:""}),t.jsxs("div",{className:"prof-overview-card-content",children:[t.jsx("span",{className:"prof-overview-card-value",children:u}),t.jsxs("span",{className:"prof-overview-card-label",children:["Groupe",u!==1?"s":""," actif",u!==1?"s":""]})]})]}),t.jsxs("div",{className:"prof-overview-card",children:[t.jsx("div",{className:"prof-overview-card-icon",children:""}),t.jsxs("div",{className:"prof-overview-card-content",children:[t.jsx("span",{className:"prof-overview-card-value",children:m}),t.jsxs("span",{className:"prof-overview-card-label",children:["lve",m!==1?"s":""," inscrit",m!==1?"s":""]})]})]}),t.jsxs("div",{className:"prof-overview-card",children:[t.jsx("div",{className:"prof-overview-card-icon",children:""}),t.jsxs("div",{className:"prof-overview-card-content",children:[t.jsxs("span",{className:"prof-overview-card-value",children:[h,"/20"]}),t.jsx("span",{className:"prof-overview-card-label",children:"Moyenne gnrale"})]})]}),t.jsxs("div",{className:"prof-overview-card",children:[t.jsx("div",{className:"prof-overview-card-icon",children:""}),t.jsxs("div",{className:"prof-overview-card-content",children:[t.jsx("span",{className:`prof-overview-card-value ${b>0?"prof-note-critique":""}`,children:b}),t.jsxs("span",{className:"prof-overview-card-label",children:["lve",b!==1?"s":""," en difficult"]})]})]})]}),!e?.isPremium&&t.jsxs("div",{className:"prof-premium-apercu",style:{marginBottom:"2rem",padding:"1.5rem",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",borderRadius:"16px",border:"1px solid #93c5fd"},children:[t.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:700,color:"#1e40af",marginBottom:"0.5rem"},children:" Premium Pro  Outils pdagogiques"}),t.jsx("p",{style:{color:"#3b82f6",fontSize:"0.9375rem",marginBottom:"1.25rem"},children:"Cahier de textes, Gnrateur de contenus IA, Cours en ligne, Mdiathque"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(160px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[{icone:"",titre:"Cahier de textes",path:"/prof/cahiers"},{icone:"",titre:"Gnrateur IA",path:"/generateur"},{icone:"",titre:"Cours en ligne",path:"/prof/cours"},{icone:"",titre:"Mdiathque",path:"/mediatheque"},{icone:"",titre:"Squences",path:"/prof/sequences"}].map(z=>t.jsxs("div",{onClick:()=>r("/premium"),role:"button",tabIndex:0,onKeyDown:k=>k.key==="Enter"&&r("/premium"),style:{padding:"1rem",background:"rgba(255,255,255,0.8)",borderRadius:"12px",border:"2px dashed #93c5fd",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"0.5rem"},children:[t.jsx("span",{style:{fontSize:"1.5rem"},children:z.icone}),t.jsx("span",{style:{fontWeight:600,fontSize:"0.875rem",color:"#1e40af",textAlign:"center"},children:z.titre}),t.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.25rem",fontSize:"0.75rem",color:"#64748b"},children:[t.jsx(Nm,{size:12})," Premium Pro"]})]},z.path))}),t.jsxs("button",{className:"prof-btn prof-btn-primary",onClick:()=>r("/premium"),style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx(jr,{size:18})," Choisir une formule Premium"]})]}),j.length===0?t.jsxs("div",{className:"prof-empty-state",children:[t.jsx("div",{className:"prof-empty-icon",children:""}),t.jsx("h3",{children:"Bienvenue sur votre espace Professeur !"}),t.jsx("p",{children:"Crez votre premier groupe-classe pour commencer  suivre vos lves."}),t.jsx("button",{className:"prof-btn prof-btn-primary",onClick:()=>a("groupes"),children:" Crer un groupe-classe"})]}):t.jsxs("div",{className:"prof-overview-groupes",children:[t.jsx("h2",{children:"Mes groupes"}),t.jsx("div",{className:"prof-overview-groupes-grid",children:j.map(z=>t.jsxs("div",{className:"prof-overview-groupe-card",onClick:()=>S(z),children:[t.jsxs("div",{className:"prof-overview-groupe-header",children:[t.jsx("h3",{children:z.nom}),t.jsx("span",{className:"prof-overview-groupe-matiere",children:z.matiereNom})]}),z.stats&&t.jsxs("div",{className:"prof-overview-groupe-stats",children:[t.jsxs("div",{children:[t.jsx("span",{className:"prof-overview-groupe-stat-value",children:z.stats.nombreEleves}),t.jsx("span",{className:"prof-overview-groupe-stat-label",children:"lves"})]}),t.jsxs("div",{children:[t.jsxs("span",{className:"prof-overview-groupe-stat-value",children:[z.stats.moyenneClasse,"/20"]}),t.jsx("span",{className:"prof-overview-groupe-stat-label",children:"Moyenne"})]}),t.jsxs("div",{children:[t.jsxs("span",{className:"prof-overview-groupe-stat-value",children:[z.stats.tauxReussite,"%"]}),t.jsx("span",{className:"prof-overview-groupe-stat-label",children:"Russite"})]})]}),t.jsx("span",{className:"prof-overview-groupe-arrow",children:""})]},z.id))})]})]}),n==="groupes"&&t.jsx(eJ,{onSelectGroupe:S}),n==="detail"&&l&&t.jsx(oJ,{groupe:l,onRetour:A})]})},xi="cahiers_textes",sa="entrees_cahier",uJ="groupes_prof",dJ="ebooks";async function mJ(e,r){const n=[Se("profId","==",e),Qe("updatedAt","desc")],a=ze(_e(V,xi),...n);return(await Ae(a)).docs.map(o=>({groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...o.data(),id:o.id}))}const wM=e=>mJ(e);async function fJ(){const e=ze(_e(V,xi),Qe("updatedAt","desc"),$t(100));return(await Ae(e)).docs.map(n=>({groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...n.data(),id:n.id}))}function pJ(e,r,n,a){const l=[Se("profId","==",e),Qe("updatedAt","desc")];r&&l.splice(1,0,Se("anneeScolaire","==",r));const o=ze(_e(V,xi),...l);return kf(o,u=>{n(u.docs.map(d=>({groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...d.data(),id:d.id})))},a)}async function CM(e){const r=await pt(je(V,xi,e));return r.exists()?{groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...r.data(),id:r.id}:null}const EM=e=>_J(e);async function hJ(e){const r=await pt(je(V,sa,e));return r.exists()?{id:r.id,...r.data()}:null}async function vJ(e,r,n,a){const l=`${Date.now()}_${n.name}`,o=`cahiers/${e}/${r}/${l}`,u=cr(ar,o),d=uu(u,n);return new Promise((m,p)=>{d.on("state_changed",h=>{},p,async()=>{const h=await In(d.snapshot.ref);m({id:l,nom:n.name,url:h,type:n.type,taille:n.size,mimeType:n.type,uploadedAt:new Date().toISOString()})})})}async function sA(e,r,n){await Ve(je(V,sa,e),{piecesJointes:Vb(...n),updatedAt:Ee.now()})}async function gJ(e,r,n){const a=r.find(l=>l.url===n);try{a?.id&&await Ls(cr(ar,`cahiers/${a.id}`))}catch{}a&&await Ve(je(V,sa,e),{piecesJointes:b3(a),updatedAt:Ee.now()})}async function xJ(e,r){const n=Ee.now(),a=r.titre?.trim()||`${r.matiere} ${r.classe} ${r.anneeScolaire}`;return(await Ot(_e(V,xi),{profId:e,titre:a,matiere:r.matiere,classe:r.classe,anneeScolaire:r.anneeScolaire,description:r.description||"",couleur:r.couleur,nombreSeancesPrevu:r.nombreSeancesPrevu,nombreSeancesRealise:0,isArchived:!1,groupeIds:r.groupeIds??[],groupeNoms:r.groupeNoms??[],isPartage:r.isPartage??!1,createdAt:n,updatedAt:n})).id}async function Nf(e,r){const n={...r};if("matiere"in r&&"classe"in r&&!("id"in r)){const a=r;a.titre?.trim()||(n.titre=`${a.matiere} ${a.classe} ${a.anneeScolaire}`)}await Ve(je(V,xi,e),{...n,updatedAt:Ee.now()})}async function bJ(e){await Ir(je(V,xi,e))}async function AM(e,r){await Ve(je(V,xi,e),{isArchived:r,updatedAt:Ee.now()})}async function yJ(e){const r=await pt(je(V,xi,e));if(!r.exists())return null;const n=r.data();return n.isPartage?{id:r.id,...n}:null}async function zM(e){const r=ze(_e(V,uJ),Se("profId","==",e),Qe("nom","asc"));return(await Ae(r)).docs.map(a=>({id:a.id,...a.data()}))}async function jJ(){return(await Ae(_e(V,dJ))).docs.map(r=>({id:r.id,...r.data()}))}async function _J(e){const r=ze(_e(V,sa),Se("cahierId","==",e),Qe("ordre","asc"));return(await Ae(r)).docs.map(a=>({id:a.id,...a.data()}))}const NJ=async(e,r,n)=>{const a=Ee.fromDate(new Date(r,n,1)),l=Ee.fromDate(new Date(r,n+1,0,23,59,59)),o=ze(_e(V,sa),Se("cahierId","==",e),Se("date",">=",a),Se("date","<=",l),Qe("date","asc"));return(await Ae(o)).docs.map(d=>({id:d.id,...d.data()}))},SJ=async(e,r)=>{const n=[Se("profId","==",e),Se("isMarqueEvaluation","==",!0),Qe("date","desc")];r&&n.unshift(Se("cahierId","==",r));const a=ze(_e(V,sa),...n);return(await Ae(a)).docs.map(o=>({id:o.id,...o.data()}))},wJ=async e=>{const n=(await Ae(ze(_e(V,sa),Se("cahierId","==",e)))).docs.map(u=>u.data()),a=n.length,l={realise:0,planifie:0,annule:0,reporte:0},o={};for(const u of n){const d=u.statut;d in l&&l[d]++,u.typeContenu&&(o[u.typeContenu]=(o[u.typeContenu]??0)+1)}return{total:a,...l,parType:o,tauxRealisation:a>0?Math.round(l.realise/a*100):0}};async function CJ(e){const r=ze(_e(V,sa),Se("cahierId","==",e),Se("statut","==","realise"),Qe("date","desc"));return(await Ae(r)).docs.map(a=>({id:a.id,...a.data()}))}async function EJ(e,r,n){const a=Ee.now();let l;if(typeof e=="string"){const u=n;l={cahierId:e,profId:r,date:Ee.fromDate(new Date(u.date)),heureDebut:u.heureDebut||"",heureFin:u.heureFin||"",chapitre:u.chapitre,typeContenu:u.typeContenu,contenu:u.contenu,objectifs:u.objectifs||"",competences:u.competences||[],statut:u.statut,motifAnnulation:u.motifAnnulation||"",dateReport:u.dateReport?Ee.fromDate(new Date(u.dateReport)):null,notesPrivees:u.notesPrivees||"",isMarqueEvaluation:u.isMarqueEvaluation,typeEvaluation:u.typeEvaluation||null,dateEvaluationPrevue:u.dateEvaluationPrevue?Ee.fromDate(new Date(u.dateEvaluationPrevue)):null,statutEvaluation:u.statutEvaluation,ordre:Date.now(),piecesJointes:[],liens:[],ebooksLies:[],contenuIA:[]}}else l={liens:[],ebooksLies:[],piecesJointes:[],contenuIA:[],...e};return(await Ot(_e(V,sa),{...l,createdAt:a,updatedAt:a})).id}async function Gc(e,r,n){let a;if(typeof r=="string"&&n){const l=n;a={date:Ee.fromDate(new Date(l.date)),heureDebut:l.heureDebut||"",heureFin:l.heureFin||"",chapitre:l.chapitre,typeContenu:l.typeContenu,contenu:l.contenu,objectifs:l.objectifs||"",competences:l.competences||[],statut:l.statut,motifAnnulation:l.motifAnnulation||"",dateReport:l.dateReport?Ee.fromDate(new Date(l.dateReport)):null,notesPrivees:l.notesPrivees||"",isMarqueEvaluation:l.isMarqueEvaluation,typeEvaluation:l.typeEvaluation||null,dateEvaluationPrevue:l.dateEvaluationPrevue?Ee.fromDate(new Date(l.dateEvaluationPrevue)):null,statutEvaluation:l.statutEvaluation}}else a={...r};await Ve(je(V,sa,e),{...a,updatedAt:Ee.now()})}async function AJ(e){await Ir(je(V,sa,e))}const lA=()=>({classe:"3me",matiere:"Mathmatiques",anneeScolaire:"2025-2026",titre:"",description:"",couleur:"#2563eb",nombreSeancesPrevu:30,groupeIds:[],groupeNoms:[],isPartage:!1}),zJ=()=>{const{currentUser:e}=Xe(),r=tt(),[n]=wA(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,m]=g.useState("2025-2026"),[p,h]=g.useState("actif"),[v,b]=g.useState(!1),[x,j]=g.useState(null),[_,w]=g.useState(lA()),[C,E]=g.useState(!1),[S,A]=g.useState(""),{matieres:z,loading:k}=_n(),[P,D]=g.useState([]),[$,F]=g.useState([]);if(!e?.isPremium&&e?.role!=="admin")return t.jsx("div",{className:"cahier-textes-page",children:t.jsxs("div",{className:"premium-gate",children:[t.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),t.jsx("h2",{children:"Cahier de Textes Numrique"}),t.jsxs("p",{children:["Cette fonctionnalit est rserve aux enseignants Premium.",t.jsx("br",{}),"Passez au Premium pour organiser, planifier et suivre votre enseignement."]}),t.jsx("button",{className:"btn-primary",onClick:()=>r("/premium"),children:" Passer au Premium  2 000 FCFA/mois"})]})});g.useEffect(()=>{if(!e?.uid)return;u(!0);const B=pJ(e.uid,d||void 0,T=>{l(T),u(!1)},T=>{console.error("Erreur chargement cahiers:",T),u(!1)});return()=>B()},[e?.uid,d]),g.useEffect(()=>{if(!e?.uid)return;zM(e.uid).then(D).catch(H=>console.error("Erreur chargement groupes:",H));const B=n.get("groupeId"),T=n.get("groupeNom"),Z=n.get("classe");B&&T&&(F([B]),w(H=>({...H,classe:Z||H.classe,groupeIds:[B],groupeNoms:[T]})),j(null),A(""),b(!0))},[e?.uid]);const Y=()=>{j(null),w(lA()),F([]),A(""),b(!0)},M=(B,T)=>{T.stopPropagation(),j(B),F(B.groupeIds??[]),w({classe:B.classe,matiere:B.matiere,anneeScolaire:B.anneeScolaire,titre:B.titre,description:B.description||"",couleur:B.couleur,nombreSeancesPrevu:B.nombreSeancesPrevu,groupeIds:B.groupeIds??[],groupeNoms:B.groupeNoms??[],isPartage:B.isPartage??!1}),A(""),b(!0)},K=B=>{F(T=>{const Z=T.includes(B)?T.filter(ce=>ce!==B):[...T,B],H=Z.map(ce=>P.find(xe=>xe.id===ce)?.nom??"").filter(Boolean);return w(ce=>({...ce,groupeIds:Z,groupeNoms:H})),Z})},ee=async B=>{if(B.preventDefault(),!!e?.uid){E(!0),A("");try{x?await Nf(x.id,_):await xJ(e.uid,_),b(!1)}catch(T){const Z=T instanceof Error?T.message:String(T);A("Erreur : "+Z)}finally{E(!1)}}},X=async(B,T)=>{if(T.stopPropagation(),!!confirm(`Supprimer le cahier "${B.titre}" et toutes ses entres ?`))try{await bJ(B.id),l(Z=>Z.filter(H=>H.id!==B.id))}catch{alert("Erreur lors de la suppression.")}},L=async(B,T)=>{T.stopPropagation();const Z=!(B.isArchived??!1);try{await AM(B.id,Z),l(H=>H.map(ce=>ce.id===B.id?{...ce,isArchived:Z}:ce))}catch{alert("Erreur lors de l'opration.")}},I=a.filter(B=>{const T=B.isArchived??!1;return p==="actif"?!T:p==="archive"?T:!0}),U=B=>B.nombreSeancesPrevu>0?Math.min(100,Math.round(B.nombreSeancesRealise/B.nombreSeancesPrevu*100)):0;return t.jsxs("div",{className:"cahier-textes-page",children:[t.jsxs("div",{className:"cahier-page-header",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"cahier-page-title",children:" Cahier de Textes"}),t.jsx("p",{className:"cahier-page-subtitle",children:"Organisez et planifiez votre enseignement"})]}),t.jsx("button",{className:"btn-primary",onClick:Y,children:"+ Nouveau cahier"})]}),t.jsxs("div",{className:"cahier-filtres",children:[t.jsx("label",{style:{fontSize:"0.85rem",color:"#6b7280",fontWeight:600},children:"Anne scolaire :"}),t.jsxs("select",{className:"filtre-select",value:d,onChange:B=>m(B.target.value),children:[t.jsx("option",{value:"",children:"Toutes les annes"}),K1.map(B=>t.jsx("option",{value:B,children:B},B))]}),t.jsxs("div",{className:"cahier-filtres-archive",style:{display:"flex",gap:"0.5rem",alignItems:"center",marginLeft:"1.5rem"},children:[t.jsxs("button",{type:"button",className:`filtre-btn ${p==="actif"?"active":""}`,onClick:()=>h("actif"),children:["Actifs (",a.filter(B=>!(B.isArchived??!1)).length,")"]}),t.jsxs("button",{type:"button",className:`filtre-btn ${p==="archive"?"active":""}`,onClick:()=>h("archive"),children:["Archivs (",a.filter(B=>B.isArchived??!1).length,")"]}),t.jsxs("button",{type:"button",className:`filtre-btn ${p==="tous"?"active":""}`,onClick:()=>h("tous"),children:["Tous (",a.length,")"]})]})]}),o?t.jsx("div",{className:"loading-spinner",children:t.jsx("div",{className:"spinner-circle"})}):I.length===0?t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{style:{fontSize:"3rem",opacity:.3,marginBottom:"0.75rem"},children:""}),t.jsx("h3",{children:p==="archive"?"Aucun cahier archiv":"Aucun cahier pour "+(d||"cette priode")}),t.jsx("p",{children:p==="archive"?"Vos cahiers archivs apparatront ici.":"Crez votre premier cahier de textes pour commencer  planifier votre enseignement."}),t.jsx("button",{className:"btn-primary",onClick:Y,style:{marginTop:"1rem"},children:"+ Crer mon premier cahier"})]}):t.jsx("div",{className:"cahiers-grid",children:I.map(B=>{const T=U(B),Z=B.isArchived??!1;return t.jsxs("div",{className:`cahier-card ${Z?"cahier-card-archived":""}`,onClick:()=>r(`/prof/cahiers/${B.id}`),children:[t.jsx("div",{style:{height:4,background:B.couleur,borderRadius:"12px 12px 0 0"}}),t.jsx("div",{className:"cahier-card-header",children:t.jsxs("div",{style:{flex:1},children:[t.jsx("h3",{className:"cahier-card-titre",children:B.titre}),t.jsxs("div",{className:"cahier-card-meta",children:[t.jsx("span",{className:"badge-classe",title:"Classe lie",children:B.classe}),t.jsx("span",{className:"badge-matiere",children:B.matiere}),t.jsx("span",{className:"badge-annee",children:B.anneeScolaire}),Z&&t.jsx("span",{className:"badge-archive",children:" Archiv"})]}),(B.groupeIds?.length??0)>0&&t.jsxs("span",{className:`badge-partage ${B.isPartage?"actif":""}`,style:{marginTop:6,display:"inline-flex"},children:[B.isPartage?" Partag avec":" Li "," ",B.groupeIds.length," groupe",B.groupeIds.length>1?"s":""]})]})}),t.jsxs("div",{className:"cahier-card-body",children:[B.description&&t.jsxs("p",{style:{fontSize:"0.82rem",color:"#6b7280",margin:"0 0 0.75rem",lineHeight:1.5},children:[B.description.substring(0,80),B.description.length>80?"...":""]}),t.jsxs("div",{className:"progression-bar-wrap",children:[t.jsxs("div",{className:"progression-label",children:[t.jsx("span",{children:"Progression"}),t.jsxs("span",{style:{fontWeight:700,color:B.couleur},children:[T,"%"]})]}),t.jsx("div",{className:"progression-bar-bg",children:t.jsx("div",{className:"progression-bar-fill",style:{width:`${T}%`,background:B.couleur}})}),t.jsxs("div",{style:{fontSize:"0.72rem",color:"#9ca3af",marginTop:"0.3rem"},children:[B.nombreSeancesRealise," / ",B.nombreSeancesPrevu," sances ralises"]})]})]}),t.jsxs("div",{className:"cahier-card-footer",children:[t.jsxs("span",{style:{fontSize:"0.75rem",color:"#9ca3af"},children:["Mis  jour le ",B.updatedAt?.toDate().toLocaleDateString("fr-FR")||""]}),t.jsxs("div",{className:"cahier-actions",children:[t.jsx("button",{className:"btn-icon",onClick:H=>L(B,H),title:Z?"Restaurer":"Archiver",children:Z?"":""}),t.jsx("button",{className:"btn-icon",onClick:H=>M(B,H),title:"Modifier",children:""}),t.jsx("button",{className:"btn-icon",onClick:H=>X(B,H),title:"Supprimer",style:{color:"#ef4444"},children:""})]})]})]},B.id)})}),v&&t.jsx("div",{className:"modal-overlay",onClick:()=>b(!1),children:t.jsxs("div",{className:"modal-content",onClick:B=>B.stopPropagation(),children:[t.jsxs("h2",{className:"modal-title",children:[" ",x?"Modifier le cahier":"Nouveau cahier de textes"]}),t.jsxs("form",{onSubmit:ee,children:[t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Classe *"}),t.jsx("select",{className:"form-select",value:_.classe,onChange:B=>w(T=>({...T,classe:B.target.value})),required:!0,children:yr.map(B=>t.jsx("option",{value:B,children:B},B))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Matire *"}),t.jsxs("select",{className:"form-select",value:_.matiere,onChange:B=>w(T=>({...T,matiere:B.target.value})),required:!0,disabled:k,children:[t.jsx("option",{value:"",children:k?"Chargement":" Slectionner "}),z.map(B=>t.jsx("option",{value:B.valeur,children:B.label},B.valeur)),_.matiere&&!z.find(B=>B.valeur===_.matiere)&&t.jsx("option",{value:_.matiere,children:_.matiere})]})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Anne scolaire *"}),t.jsx("select",{className:"form-select",value:_.anneeScolaire,onChange:B=>w(T=>({...T,anneeScolaire:B.target.value})),children:K1.map(B=>t.jsx("option",{value:B,children:B},B))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Titre personnalis"}),t.jsx("input",{className:"form-input",placeholder:`Ex: Maths 3me A - ${_.anneeScolaire}`,value:_.titre,onChange:B=>w(T=>({...T,titre:B.target.value}))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Nombre de sances prvues"}),t.jsx("input",{type:"number",className:"form-input",min:"1",max:"200",value:_.nombreSeancesPrevu,onChange:B=>w(T=>({...T,nombreSeancesPrevu:Number(B.target.value)}))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Description / Objectifs (optionnel)"}),t.jsx("textarea",{className:"form-textarea",placeholder:"Objectifs gnraux, groupe classe, notes...",value:_.description,onChange:B=>w(T=>({...T,description:B.target.value})),rows:2})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Couleur du cahier"}),t.jsx("div",{className:"couleur-picker",children:R5.map(B=>t.jsx("div",{className:`couleur-option ${_.couleur===B?"selected":""}`,style:{background:B},onClick:()=>w(T=>({...T,couleur:B})),title:B},B))})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{className:"form-label",children:["Groupes classes lis"," ",t.jsx("span",{style:{fontWeight:400,color:"#9ca3af"},children:"(optionnel)"})]}),P.length===0?t.jsxs("p",{style:{fontSize:"0.82rem",color:"#9ca3af",margin:0},children:["Aucun groupe cr."," ",t.jsx("button",{type:"button",style:{background:"none",border:"none",color:"#2563eb",cursor:"pointer",padding:0,fontSize:"0.82rem"},onClick:()=>r("/prof/groupes"),children:"Crer un groupe "})]}):t.jsx("div",{className:"groupe-selector",children:P.map(B=>{const T=$.includes(B.id);return t.jsxs("div",{className:`groupe-option ${T?"selected":""}`,onClick:()=>K(B.id),children:[t.jsx("input",{type:"checkbox",checked:T,readOnly:!0,tabIndex:-1}),t.jsxs("span",{children:[t.jsx("strong",{children:B.nom}),"  ",B.classe," (",B.anneeScolaire,")"]})]},B.id)})}),$.length>0&&t.jsx("div",{className:"groupes-tags",children:$.map(B=>{const T=P.find(Z=>Z.id===B);return T?t.jsxs("span",{className:"groupe-tag",children:[T.nom,t.jsx("button",{type:"button",onClick:()=>K(B),"aria-label":`Retirer ${T.nom}`,children:""})]},B):null})}),$.length>0&&t.jsxs("label",{className:"toggle-partage",style:{marginTop:10},children:[t.jsx("input",{type:"checkbox",checked:_.isPartage??!1,onChange:B=>w(T=>({...T,isPartage:B.target.checked}))}),t.jsx("span",{children:" Rendre visible aux lves des groupes lis"})]})]}),S&&t.jsx("div",{style:{color:"#dc2626",fontSize:"0.85rem",marginBottom:"0.75rem",background:"#fee2e2",padding:"0.5rem 0.75rem",borderRadius:8},children:S}),t.jsxs("div",{className:"modal-footer",children:[t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>b(!1),children:"Annuler"}),t.jsx("button",{type:"submit",className:"btn-primary",disabled:C,children:C?"Enregistrement...":x?"Mettre  jour":"Crer le cahier"})]})]})]})})]})},kJ=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],OJ=["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],DJ=(e,r,n)=>{const a=new Date(e,r,1),l=new Date(e,r+1,0);let o=a.getDay()-1;o<0&&(o=6);const u=new Date,d=[];for(let p=o-1;p>=0;p--){const h=new Date(e,r,-p);d.push({date:h,isCurrentMonth:!1,isToday:!1,entrees:[]})}for(let p=1;p<=l.getDate();p++){const h=new Date(e,r,p),v=h.toDateString()===u.toDateString(),b=n.filter(x=>{const j=x.date.toDate();return j.getFullYear()===e&&j.getMonth()===r&&j.getDate()===p});d.push({date:h,isCurrentMonth:!0,isToday:v,entrees:b})}let m=1;for(;d.length<42;){const p=new Date(e,r+1,m++);d.push({date:p,isCurrentMonth:!1,isToday:!1,entrees:[]})}return d},PJ=({cahierId:e})=>{const r=tt(),n=new Date,[a,l]=g.useState(n.getFullYear()),[o,u]=g.useState(n.getMonth()),[d,m]=g.useState([]),[p,h]=g.useState(!1),[v,b]=g.useState(null),[x,j]=g.useState({x:0,y:0});g.useEffect(()=>{(async()=>{h(!0);try{const A=await NJ(e,a,o);m(A)}catch(A){console.error("Erreur chargement entres calendrier:",A)}finally{h(!1)}})()},[e,a,o]);const _=DJ(a,o,d),w=()=>{o===0?(l(S=>S-1),u(11)):u(S=>S-1)},C=()=>{o===11?(l(S=>S+1),u(0)):u(S=>S+1)},E=(S,A)=>{if(!S.isCurrentMonth||S.entrees.length===0)return;const z=A.target.getBoundingClientRect();j({x:z.left,y:z.bottom+window.scrollY+8}),b(S)};return t.jsxs("div",{className:"cahier-calendar",onClick:()=>b(null),children:[t.jsxs("div",{className:"calendar-nav",children:[t.jsx("button",{className:"calendar-nav-btn",onClick:w,"aria-label":"Mois prcdent",children:""}),t.jsxs("span",{className:"calendar-nav-title",children:[OJ[o]," ",a,p&&" ..."]}),t.jsx("button",{className:"calendar-nav-btn",onClick:C,"aria-label":"Mois suivant",children:""})]}),t.jsx("div",{className:"calendar-weekdays",children:kJ.map(S=>t.jsx("div",{className:"calendar-weekday",children:S},S))}),t.jsx("div",{className:"calendar-grid",onClick:S=>S.stopPropagation(),children:_.map((S,A)=>t.jsxs("div",{className:`calendar-day ${S.isCurrentMonth?"":"other-month"} ${S.isToday?"today":""} ${v?.date.toDateString()===S.date.toDateString()?"selected":""}`,onClick:z=>E(S,z),children:[t.jsx("div",{className:"calendar-day-num",children:S.date.getDate()}),t.jsxs("div",{className:"calendar-day-events",children:[S.entrees.slice(0,3).map(z=>{const k=Zi[z.typeContenu];return t.jsxs("div",{className:"calendar-event-dot",style:{background:k.color},title:z.chapitre,children:[k.emoji," ",z.chapitre.substring(0,12)]},z.id)}),S.entrees.length>3&&t.jsxs("div",{className:"calendar-more",children:["+",S.entrees.length-3]})]})]},A))}),t.jsx("div",{className:"calendar-legend",children:Object.entries(Zi).slice(0,5).map(([S,A])=>t.jsxs("div",{className:"legend-item",children:[t.jsx("div",{className:"legend-dot",style:{background:A.color}}),A.label]},S))}),v&&v.entrees.length>0&&t.jsxs("div",{className:"calendar-day-popup",style:{top:x.y,left:Math.min(x.x,window.innerWidth-300)},onClick:S=>S.stopPropagation(),children:[t.jsxs("div",{className:"calendar-day-popup-title",children:[" ",v.date.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"})]}),v.entrees.map(S=>{const A=Zi[S.typeContenu];return t.jsxs("div",{className:"calendar-popup-entree",onClick:()=>r(`/prof/cahiers/${e}/modifier/${S.id}`),children:[t.jsx("span",{className:"calendar-popup-entree-type",children:A.emoji}),t.jsxs("div",{className:"calendar-popup-entree-info",children:[t.jsx("div",{className:"calendar-popup-entree-chapitre",children:S.chapitre}),S.heureDebut&&t.jsxs("div",{className:"calendar-popup-entree-heure",children:[S.heureDebut,S.heureFin?`  ${S.heureFin}`:""]})]})]},S.id)})]})]})},Ep="rappels_prof",MJ=async(e,r)=>(await Ot(_e(V,Ep),{profId:e,titre:r.titre,description:r.description||"",typeRappel:r.typeRappel,dateRappel:Ee.fromDate(new Date(r.dateRappel)),recurrence:r.recurrence,priorite:r.priorite,cahierId:r.cahierId||null,isLu:!1,isDone:!1,createdAt:Ee.now()})).id,TJ=async e=>{const r=ze(_e(V,Ep),Se("profId","==",e),Se("isDone","==",!1),Qe("dateRappel","asc"));return(await Ae(r)).docs.map(a=>({id:a.id,...a.data()}))},qJ=async(e,r)=>{await Ve(je(V,Ep,e),{isDone:r,isLu:r})},RJ=async e=>{await Ir(je(V,Ep,e))},oA=()=>({titre:"",description:"",typeRappel:"personnalise",dateRappel:new Date(Date.now()+36e5).toISOString().slice(0,16),recurrence:"unique",priorite:"normale"}),um=({profId:e,cahierId:r})=>{const[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(!1),[m,p]=g.useState(oA()),[h,v]=g.useState(!1),b=async()=>{try{o(!0);const S=await TJ(e);a(S)}catch(S){console.error("Erreur rappels:",S)}finally{o(!1)}};g.useEffect(()=>{b()},[e]);const x=async S=>{if(S.preventDefault(),!!m.titre.trim()){v(!0);try{await MJ(e,{...m,cahierId:r}),d(!1),p(oA()),await b()}catch(A){console.error("Erreur cration rappel:",A)}finally{v(!1)}}},j=async S=>{await qJ(S,!0),a(A=>A.filter(z=>z.id!==S))},_=async S=>{confirm("Supprimer ce rappel ?")&&(await RJ(S),a(A=>A.filter(z=>z.id!==S)))},w=new Date,C=n.filter(S=>S.dateRappel.toDate()<=w),E=n.filter(S=>S.dateRappel.toDate()>w);return t.jsxs("div",{style:{background:"white",borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",overflow:"hidden"},children:[t.jsxs("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid #f3f4f6",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("span",{style:{fontSize:"1.1rem"},children:""}),t.jsx("span",{style:{fontWeight:700,fontSize:"0.95rem",color:"#1f2937"},children:"Rappels"}),C.length>0&&t.jsx("span",{style:{background:"#dc2626",color:"white",borderRadius:20,padding:"1px 7px",fontSize:"0.7rem",fontWeight:700},children:C.length})]}),t.jsx("button",{className:"btn-primary",style:{padding:"0.35rem 0.75rem",fontSize:"0.8rem"},onClick:()=>d(S=>!S),children:"+ Ajouter"})]}),u&&t.jsxs("form",{onSubmit:x,style:{padding:"1rem 1.25rem",borderBottom:"1px solid #f3f4f6",background:"#f9fafb"},children:[t.jsx("div",{className:"form-group",children:t.jsx("input",{className:"form-input",placeholder:"Titre du rappel *",value:m.titre,onChange:S=>p(A=>({...A,titre:S.target.value})),required:!0})}),t.jsx("div",{className:"form-group",children:t.jsx("select",{className:"form-select",value:m.typeRappel,onChange:S=>p(A=>({...A,typeRappel:S.target.value})),children:Object.entries(BA).map(([S,A])=>t.jsxs("option",{value:S,children:[A.emoji," ",A.label]},S))})}),t.jsx("div",{className:"form-group",children:t.jsx("input",{type:"datetime-local",className:"form-input",value:m.dateRappel,onChange:S=>p(A=>({...A,dateRappel:S.target.value})),required:!0})}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsxs("select",{className:"form-select",value:m.priorite,onChange:S=>p(A=>({...A,priorite:S.target.value})),children:[t.jsx("option",{value:"normale",children:"Normale"}),t.jsx("option",{value:"urgente",children:" Urgente"})]}),t.jsxs("select",{className:"form-select",value:m.recurrence,onChange:S=>p(A=>({...A,recurrence:S.target.value})),children:[t.jsx("option",{value:"unique",children:"Une fois"}),t.jsx("option",{value:"hebdomadaire",children:"Hebdo"})]})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.75rem"},children:[t.jsx("button",{type:"submit",className:"btn-primary",disabled:h,style:{flex:1},children:h?"...":"Enregistrer"}),t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>d(!1),children:"Annuler"})]})]}),t.jsx("div",{style:{padding:"0.75rem 1.25rem"},children:l?t.jsx("div",{style:{textAlign:"center",color:"#9ca3af",padding:"1rem",fontSize:"0.85rem"},children:"Chargement..."}):n.length===0?t.jsxs("div",{style:{textAlign:"center",color:"#9ca3af",padding:"1rem",fontSize:"0.85rem"},children:[t.jsx("div",{children:""}),t.jsx("div",{children:"Aucun rappel actif"})]}):t.jsxs(t.Fragment,{children:[C.length>0&&t.jsxs("div",{style:{marginBottom:"0.75rem"},children:[t.jsx("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"#dc2626",textTransform:"uppercase",marginBottom:"0.4rem"},children:" En retard"}),C.map(S=>t.jsx(cA,{rappel:S,onDone:j,onDelete:_},S.id))]}),E.length>0&&t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"#6b7280",textTransform:"uppercase",marginBottom:"0.4rem"},children:" venir"}),E.slice(0,5).map(S=>t.jsx(cA,{rappel:S,onDone:j,onDelete:_},S.id))]})]})})]})},cA=({rappel:e,onDone:r,onDelete:n})=>{const a=BA[e.typeRappel],l=e.dateRappel.toDate(),o=e.priorite==="urgente",u=l<=new Date;return t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem",padding:"0.5rem 0",borderBottom:"1px solid #f9fafb"},children:[t.jsx("button",{onClick:()=>r(e.id),style:{width:20,height:20,border:`2px solid ${o?"#dc2626":"#d1d5db"}`,borderRadius:4,background:"white",cursor:"pointer",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",marginTop:2},title:"Marquer termin"}),t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsxs("div",{style:{fontSize:"0.82rem",fontWeight:600,color:u?"#dc2626":"#1f2937",display:"flex",alignItems:"center",gap:"0.3rem"},children:[a.emoji," ",e.titre,o&&t.jsx("span",{style:{fontSize:"0.65rem",color:"#dc2626"},children:""})]}),t.jsxs("div",{style:{fontSize:"0.72rem",color:"#9ca3af",marginTop:2},children:[l.toLocaleDateString("fr-FR",{day:"numeric",month:"short"}),"  ",l.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]}),t.jsx("button",{onClick:()=>n(e.id),style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af",fontSize:"0.9rem",flexShrink:0},title:"Supprimer",children:""})]})},IJ=({profId:e,cahierId:r})=>{const n=tt(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,m]=g.useState("tous");g.useEffect(()=>{(async()=>{u(!0);try{const x=await SJ(e,r);l(x)}catch(x){console.error("Erreur signets:",x)}finally{u(!1)}})()},[e,r]);const p=async(b,x)=>{try{await Gc(b.id,{statutEvaluation:x}),l(j=>j.map(_=>_.id===b.id?{..._,statutEvaluation:x}:_))}catch(j){console.error("Erreur mise  jour statut:",j)}},h=d==="tous"?a:a.filter(b=>b.statutEvaluation===d),v=[{value:"tous",label:"Tous",color:"#6b7280"},{value:"a_evaluer",label:" valuer",color:"#d97706"},{value:"evaluation_creee",label:"Cre",color:"#2563eb"},{value:"evaluation_terminee",label:"Termine",color:"#059669"}];return t.jsxs("div",{children:[t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem",flexWrap:"wrap",gap:"0.5rem"},children:t.jsxs("h3",{style:{fontSize:"1.1rem",fontWeight:700,color:"#1f2937",margin:0},children:[" Signets d'valuation (",a.length,")"]})}),t.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.25rem",flexWrap:"wrap"},children:v.map(b=>t.jsx("button",{onClick:()=>m(b.value),style:{padding:"0.3rem 0.85rem",borderRadius:20,border:`1.5px solid ${d===b.value?b.color:"#e5e7eb"}`,background:d===b.value?b.color:"white",color:d===b.value?"white":"#4b5563",fontSize:"0.8rem",fontWeight:600,cursor:"pointer",transition:"all 0.15s"},children:b.label},b.value))}),o?t.jsx("div",{style:{textAlign:"center",color:"#9ca3af",padding:"2rem"},children:"Chargement..."}):h.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"2.5rem",color:"#9ca3af"},children:[t.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:""}),t.jsx("div",{style:{fontWeight:600,color:"#6b7280",marginBottom:"0.25rem"},children:"Aucun signet trouv"}),t.jsx("div",{style:{fontSize:"0.85rem"},children:"Marquez des entres pour valuation depuis l'diteur de sance."})]}):t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:h.map(b=>{const x=Zi[b.typeContenu];return Uc[b.statut],t.jsxs("div",{style:{background:"white",borderRadius:10,boxShadow:"0 2px 8px rgba(0,0,0,0.07)",padding:"1rem",borderLeft:"4px solid #f59e0b"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:"0.5rem",marginBottom:"0.5rem"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"0.9rem",fontWeight:700,color:"#1f2937"},children:b.chapitre}),t.jsx("div",{style:{fontSize:"0.78rem",color:"#9ca3af",marginTop:"0.15rem"},children:b.date.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})})]}),t.jsx("button",{onClick:()=>n(`/prof/cahiers/${r}/modifier/${b.id}`),style:{background:"none",border:"none",cursor:"pointer",color:"#2563eb",fontSize:"0.8rem",fontWeight:600,whiteSpace:"nowrap"},children:" Modifier"})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.75rem"},children:[t.jsxs("span",{style:{padding:"0.15rem 0.6rem",borderRadius:20,fontSize:"0.72rem",fontWeight:600,background:x.color+"22",color:x.color},children:[x.emoji," ",x.label]}),b.typeEvaluation&&t.jsxs("span",{style:{padding:"0.15rem 0.6rem",borderRadius:20,fontSize:"0.72rem",fontWeight:600,background:"#fef3c7",color:"#92400e"},children:[" ",$A[b.typeEvaluation]]}),b.dateEvaluationPrevue&&t.jsxs("span",{style:{padding:"0.15rem 0.6rem",borderRadius:20,fontSize:"0.72rem",background:"#f3f4f6",color:"#4b5563"},children:[" ",b.dateEvaluationPrevue.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"short"})]})]}),t.jsx("div",{style:{display:"flex",gap:"0.4rem",flexWrap:"wrap"},children:["a_evaluer","evaluation_creee","evaluation_terminee"].map(j=>{const _=b.statutEvaluation===j,w={a_evaluer:" valuer",evaluation_creee:"Cre",evaluation_terminee:" Termine"},C={a_evaluer:"#d97706",evaluation_creee:"#2563eb",evaluation_terminee:"#059669"};return t.jsx("button",{onClick:()=>p(b,j),style:{padding:"0.25rem 0.7rem",borderRadius:20,border:`1.5px solid ${_?C[j]:"#e5e7eb"}`,background:_?C[j]:"white",color:_?"white":"#6b7280",fontSize:"0.72rem",fontWeight:600,cursor:"pointer"},children:w[j]},j)})})]},b.id)})})]})},LJ=({cahier:e})=>{const[r,n]=g.useState(null),[a,l]=g.useState(!0);g.useEffect(()=>{(async()=>{try{const d=await wJ(e.id);n(d)}catch{}finally{l(!1)}})()},[e.id]);const o=e.nombreSeancesPrevu>0?Math.min(100,Math.round(e.nombreSeancesRealise/e.nombreSeancesPrevu*100)):0;return a?t.jsx("div",{style:{padding:"1rem",textAlign:"center",color:"#9ca3af",fontSize:"0.85rem"},children:"Chargement des stats..."}):r?t.jsxs("div",{style:{background:"white",borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",padding:"1.25rem"},children:[t.jsx("div",{style:{fontWeight:700,fontSize:"0.95rem",color:"#1f2937",marginBottom:"1.25rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:" Statistiques du cahier"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem",marginBottom:"1.25rem"},children:[t.jsx(dm,{value:r.total,label:"Sances total",color:"#2563eb",bg:"#dbeafe"}),t.jsx(dm,{value:r.realise,label:"Ralises",color:"#059669",bg:"#d1fae5"}),t.jsx(dm,{value:r.planifie,label:"Planifies",color:"#d97706",bg:"#fef3c7"}),t.jsx(dm,{value:`${r.tauxRealisation}%`,label:"Taux de ralisation",color:"#7c3aed",bg:"#ede9fe"})]}),t.jsxs("div",{style:{marginBottom:"1.25rem"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.4rem"},children:[t.jsx("span",{children:"Progression du programme"}),t.jsxs("span",{style:{fontWeight:700,color:e.couleur},children:[o,"%"]})]}),t.jsx("div",{style:{height:8,background:"#e5e7eb",borderRadius:10,overflow:"hidden"},children:t.jsx("div",{style:{height:"100%",width:`${o}%`,background:e.couleur,borderRadius:10,transition:"width 0.5s ease"}})}),t.jsxs("div",{style:{fontSize:"0.75rem",color:"#9ca3af",marginTop:"0.3rem"},children:[e.nombreSeancesRealise," / ",e.nombreSeancesPrevu," sances prvues"]})]}),Object.keys(r.parType).length>0&&t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"0.78rem",fontWeight:700,color:"#9ca3af",textTransform:"uppercase",marginBottom:"0.6rem"},children:"Rpartition par type"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.4rem"},children:Object.entries(r.parType).sort((u,d)=>d[1]-u[1]).map(([u,d])=>{const m=Zi[u];if(!m)return null;const p=r.total>0?Math.round(d/r.total*100):0;return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.78rem",color:"#4b5563",marginBottom:"0.2rem"},children:[t.jsxs("span",{children:[m.emoji," ",m.label]}),t.jsxs("span",{style:{fontWeight:600},children:[d," (",p,"%)"]})]}),t.jsx("div",{style:{height:4,background:"#f3f4f6",borderRadius:10,overflow:"hidden"},children:t.jsx("div",{style:{height:"100%",width:`${p}%`,background:m.color,borderRadius:10}})})]},u)})})]})]}):null},dm=({value:e,label:r,color:n,bg:a})=>t.jsxs("div",{style:{background:a,borderRadius:10,padding:"0.75rem",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800,color:n},children:e}),t.jsx("div",{style:{fontSize:"0.72rem",color:"#6b7280",marginTop:"0.15rem"},children:r})]});function uA(e){const r=new Date(e),n=r.getDay(),a=n===0?-6:1-n;return r.setDate(r.getDate()+a),r.setHours(0,0,0,0),r}function $J(e){const r=new Date(e);return r.setDate(r.getDate()+6),r}function dA(e){const r=new Date(e),n=$J(r),a={day:"numeric",month:"short"};return`${r.toLocaleDateString("fr-FR",a)}  ${n.toLocaleDateString("fr-FR",a)}`}function mA(e){const[r,n]=e.split("-");return new Date(Number(r),Number(n)-1).toLocaleDateString("fr-FR",{month:"long",year:"numeric"})}const BJ=()=>{const{cahierId:e}=jn(),{currentUser:r}=Xe(),n=tt(),[a,l]=g.useState(null),[o,u]=g.useState([]),[d,m]=g.useState(!0),[p,h]=g.useState(!0),[v,b]=g.useState("liste"),[x,j]=g.useState("tous"),[_,w]=g.useState("tous"),[C,E]=g.useState("tous"),[S,A]=g.useState(null),[z,k]=g.useState("asc"),[P,D]=g.useState(!0),[$,F]=g.useState(!1);g.useEffect(()=>{pt(je(V,"settings","platform")).then(T=>{if(T.exists()){const Z=T.data();D(Z.cahierPdfExport!==!1)}}).catch(()=>{})},[]),g.useEffect(()=>{if(!e)return;(async()=>{m(!0);try{const Z=await CM(e);if(!Z){n("/prof/cahiers");return}l(Z)}finally{m(!1)}})()},[e,n]);const Y=g.useCallback(async()=>{if(e){h(!0);try{const T=await EM(e);u(T)}finally{h(!1)}}},[e]);g.useEffect(()=>{Y()},[Y]);const M=async T=>{if(confirm(`Supprimer la sance "${T.chapitre}" ?`))try{await AJ(T.id);const Z=o.filter(ce=>ce.id!==T.id);u(Z);const H=Z.filter(ce=>ce.statut==="realise").length;await Nf(e,{nombreSeancesRealise:H}),l(ce=>ce&&{...ce,nombreSeancesRealise:H})}catch{alert("Erreur lors de la suppression.")}},K=async(T,Z)=>{try{await Gc(T.id,{statut:Z});const H=o.map(xe=>xe.id===T.id?{...xe,statut:Z}:xe);u(H);const ce=H.filter(xe=>xe.statut==="realise").length;await Nf(e,{nombreSeancesRealise:ce}),l(xe=>xe&&{...xe,nombreSeancesRealise:ce})}catch{alert("Erreur mise  jour statut.")}},ee=g.useCallback(()=>{F(!0),setTimeout(()=>{window.print(),F(!1)},100)},[]),X=g.useMemo(()=>Array.from(new Set(o.map(T=>{const Z=T.date.toDate();return`${Z.getFullYear()}-${String(Z.getMonth()+1).padStart(2,"0")}`}))).sort(),[o]),L=g.useMemo(()=>{const T=C==="tous"?o:o.filter(H=>{const ce=H.date.toDate();return`${ce.getFullYear()}-${String(ce.getMonth()+1).padStart(2,"0")}`===C}),Z=new Map;return T.forEach(H=>{const xe=uA(H.date.toDate()).toISOString().slice(0,10);Z.set(xe,(Z.get(xe)||0)+1)}),Array.from(Z.entries()).sort(([H],[ce])=>H.localeCompare(ce)).map(([H,ce])=>({start:H,count:ce}))},[o,C]),I=g.useMemo(()=>{const T=new Map;return o.forEach(Z=>{const H=Z.date.toDate(),ce=`${H.getFullYear()}-${String(H.getMonth()+1).padStart(2,"0")}`;T.set(ce,(T.get(ce)||0)+1)}),T},[o]),U=g.useMemo(()=>o.filter(T=>{const Z=T.date.toDate(),H=x==="tous"||T.statut===x,ce=_==="tous"||T.typeContenu===_;let xe=!0;C!=="tous"&&(xe=`${Z.getFullYear()}-${String(Z.getMonth()+1).padStart(2,"0")}`===C);let fe=!0;return S&&(fe=uA(Z).toISOString().slice(0,10)===S),H&&ce&&xe&&fe}).sort((T,Z)=>{const H=T.date.toMillis()-Z.date.toMillis();return z==="asc"?H:-H}),[o,x,_,C,S,z]);if(d)return t.jsx("div",{className:"loading-spinner",children:t.jsx("div",{className:"spinner-circle"})});if(!a)return null;const B=a.nombreSeancesPrevu>0?Math.round(o.filter(T=>T.statut==="realise").length/a.nombreSeancesPrevu*100):0;return t.jsxs("div",{className:"cahier-detail-page",id:"cahier-detail-print-zone",children:[t.jsxs("div",{className:"cahier-detail-header",children:[t.jsx("button",{className:"btn-retour no-print",onClick:()=>n("/prof/cahiers"),title:"Retour  la liste",children:" Retour"}),t.jsx("div",{className:"cahier-detail-couleur-barre",style:{background:a.couleur}}),t.jsxs("div",{className:"cahier-detail-info",children:[t.jsx("h1",{className:"cahier-detail-titre",children:a.titre}),t.jsxs("div",{className:"cahier-detail-badges",children:[t.jsxs("span",{className:"badge-classe",title:"Classe lie",children:[" ",a.classe]}),t.jsx("span",{className:"badge-matiere",children:a.matiere}),t.jsx("span",{className:"badge-annee",children:a.anneeScolaire}),a.isPartage&&t.jsx("span",{className:"badge-partage",children:" Partag"}),(a.isArchived??!1)&&t.jsx("span",{className:"badge-archive",children:" Archiv"})]}),a.description&&t.jsx("p",{className:"cahier-detail-description",children:a.description}),t.jsxs("div",{className:"cahier-detail-progression",children:[t.jsx("div",{className:"progression-bar-bg",style:{width:200},children:t.jsx("div",{className:"progression-bar-fill",style:{width:`${B}%`,background:a.couleur}})}),t.jsxs("span",{className:"progression-pct",children:[o.filter(T=>T.statut==="realise").length," / ",a.nombreSeancesPrevu," sances (",B,"%)"]})]})]}),t.jsxs("div",{className:"cahier-detail-actions no-print",children:[t.jsx("button",{className:"btn-secondary",onClick:async()=>{const T=!(a.isArchived??!1);try{await AM(a.id,T),l(Z=>Z?{...Z,isArchived:T}:null)}catch{alert("Erreur lors de l'opration.")}},title:a.isArchived??!1?"Restaurer le cahier":"Archiver le cahier",children:a.isArchived??!1?" Restaurer":" Archiver"}),P&&t.jsxs("button",{className:"btn-pdf",onClick:ee,disabled:$,title:"Tlcharger en PDF",children:[$?"":""," PDF"]}),t.jsx("button",{className:"btn-primary",onClick:()=>n(`/prof/cahiers/${e}/nouvelle`),children:"+ Nouvelle sance"})]})]}),t.jsx("div",{className:"view-tabs no-print",children:[{id:"liste",label:" Liste"},{id:"calendrier",label:" Calendrier"},{id:"signets",label:" Signets"},{id:"stats",label:" Statistiques"}].map(T=>t.jsx("button",{className:`view-tab ${v===T.id?"active":""}`,onClick:()=>b(T.id),children:T.label},T.id))}),v==="calendrier"&&t.jsxs("div",{className:"cahier-detail-layout",children:[t.jsx("div",{children:t.jsx(PJ,{cahierId:a.id})}),t.jsx("div",{children:t.jsx(um,{profId:r.uid,cahierId:a.id})})]}),v==="signets"&&t.jsxs("div",{className:"cahier-detail-layout",children:[t.jsx(IJ,{profId:r.uid,cahierId:a.id}),t.jsx(um,{profId:r.uid,cahierId:a.id})]}),v==="stats"&&t.jsxs("div",{className:"cahier-detail-layout",children:[t.jsx(LJ,{cahier:{...a,nombreSeancesRealise:o.filter(T=>T.statut==="realise").length}}),t.jsx(um,{profId:r.uid,cahierId:a.id})]}),v==="liste"&&t.jsxs("div",{className:"cahier-three-col-layout",children:[t.jsxs("aside",{className:"cahier-nav-sidebar no-print",children:[t.jsxs("div",{className:"nav-sidebar-header",children:[t.jsx("span",{className:"nav-sidebar-icon",children:""}),t.jsx("span",{className:"nav-sidebar-title",children:"Navigation"})]}),t.jsxs("button",{className:`nav-month-item ${C==="tous"?"active":""}`,onClick:()=>{E("tous"),A(null)},children:[t.jsx("span",{children:"Tout afficher"}),t.jsx("span",{className:"nav-count-badge",children:o.length})]}),X.length>0&&t.jsx("div",{className:"nav-months-list",children:X.map(T=>t.jsxs("button",{className:`nav-month-item ${C===T?"active":""}`,onClick:()=>{E(T),A(null)},children:[t.jsx("span",{className:"nav-month-label",children:mA(T)}),t.jsx("span",{className:"nav-count-badge",children:I.get(T)||0})]},T))}),C!=="tous"&&L.length>0&&t.jsxs("div",{className:"nav-weeks-section",children:[t.jsx("div",{className:"nav-weeks-header",children:"Semaines"}),t.jsxs("button",{className:`nav-week-item ${S===null?"active":""}`,onClick:()=>A(null),children:[t.jsx("span",{children:"Tout le mois"}),t.jsx("span",{className:"nav-count-badge nav-count-badge--sm",children:I.get(C)||0})]}),L.map(T=>t.jsxs("button",{className:`nav-week-item ${S===T.start?"active":""}`,onClick:()=>A(T.start),children:[t.jsx("span",{className:"nav-week-label",children:dA(T.start)}),t.jsx("span",{className:"nav-count-badge nav-count-badge--sm",children:T.count})]},T.start))]}),o.length===0&&t.jsx("p",{className:"nav-sidebar-empty",children:"Aucune sance pour l'instant"})]}),t.jsxs("div",{className:"cahier-content-col",children:[t.jsxs("div",{className:"entrees-controls no-print",children:[t.jsx("div",{className:"entrees-statut-filters",children:["tous","realise","planifie","annule","reporte"].map(T=>{const Z=T==="tous"?null:Uc[T];return t.jsx("button",{className:`statut-chip ${x===T?"active":""}`,style:x===T&&Z?{borderColor:Z.color,background:Z.bg,color:Z.color}:{},onClick:()=>j(T),children:T==="tous"?"Tous":Z?.label},T)})}),t.jsxs("div",{className:"entrees-right-controls",children:[t.jsxs("select",{className:"filtre-select",value:_,onChange:T=>w(T.target.value),children:[t.jsx("option",{value:"tous",children:"Tous types"}),Object.entries(Zi).map(([T,Z])=>t.jsxs("option",{value:T,children:[Z.emoji," ",Z.label]},T))]}),t.jsx("button",{className:"btn-sort",onClick:()=>k(T=>T==="asc"?"desc":"asc"),title:z==="asc"?"Ordre croissant (cliquer pour inverser)":"Ordre dcroissant (cliquer pour inverser)",children:z==="asc"?" Plus ancien":" Plus rcent"})]})]}),(C!=="tous"||S||x!=="tous"||_!=="tous")&&t.jsxs("div",{className:"filtre-actif-bar no-print",children:[t.jsxs("span",{className:"filtre-actif-label",children:[U.length," sance",U.length!==1?"s":"",S?`  Semaine du ${dA(S)}`:"",C!=="tous"&&!S?`  ${mA(C)}`:""]}),t.jsx("button",{className:"filtre-actif-reset",onClick:()=>{j("tous"),w("tous"),E("tous"),A(null)},children:" Rinitialiser"})]}),p&&U.length===0?t.jsx("div",{className:"loading-spinner",children:t.jsx("div",{className:"spinner-circle"})}):U.length===0?t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{style:{fontSize:"2.5rem",opacity:.3,marginBottom:"0.5rem"},children:""}),t.jsx("h3",{children:x!=="tous"||_!=="tous"||C!=="tous"?"Aucune sance correspondant aux filtres":"Aucune sance pour l'instant"}),x==="tous"&&_==="tous"&&C==="tous"&&t.jsx("button",{className:"btn-primary",onClick:()=>n(`/prof/cahiers/${e}/nouvelle`),style:{marginTop:"1rem"},children:"+ Ajouter la premire sance"})]}):t.jsx("div",{className:"entrees-list",children:U.map((T,Z)=>{const H=Zi[T.typeContenu],ce=Uc[T.statut],xe=T.date.toDate();return t.jsxs("div",{className:"entree-card",style:{borderLeftColor:H.color},onClick:()=>n(`/prof/cahiers/${e}/modifier/${T.id}`),children:[t.jsx("div",{className:"entree-num",children:t.jsx("span",{style:{background:H.color},children:z==="asc"?Z+1:U.length-Z})}),t.jsxs("div",{className:"entree-card-inner",children:[t.jsxs("div",{className:"entree-card-top",children:[t.jsxs("div",{className:"entree-card-gauche",children:[t.jsxs("div",{className:"entree-date",children:[" ",xe.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),T.heureDebut&&t.jsxs("span",{className:"entree-heure",children:[" ",T.heureDebut,T.heureFin?`  ${T.heureFin}`:""]})]}),t.jsx("h3",{className:"entree-chapitre",children:T.chapitre}),t.jsxs("div",{className:"entree-badges",children:[t.jsxs("span",{className:"entree-type-badge",style:{background:H.color},children:[H.emoji," ",H.label]}),t.jsx("span",{className:"entree-statut-badge",style:{background:ce.bg,color:ce.color},children:ce.label}),T.isMarqueEvaluation&&t.jsx("span",{className:"signet-badge",children:" valuation"}),T.piecesJointes&&T.piecesJointes.length>0&&t.jsxs("span",{className:"badge-pj",children:[" ",T.piecesJointes.length]})]})]}),t.jsxs("div",{className:"entree-actions no-print",children:[t.jsx("button",{className:"btn-icon",onClick:fe=>{fe.stopPropagation(),n(`/prof/cahiers/${e}/modifier/${T.id}`)},title:"Modifier",children:""}),t.jsx("button",{className:"btn-icon btn-icon--danger",onClick:fe=>{fe.stopPropagation(),M(T)},title:"Supprimer",children:""})]})]}),T.contenu&&t.jsx("div",{className:"entree-contenu-preview",dangerouslySetInnerHTML:{__html:T.contenu}}),T.objectifs&&t.jsxs("div",{className:"entree-objectifs",children:[" ",t.jsx("em",{children:T.objectifs})]}),t.jsxs("div",{className:"entree-card-footer no-print",children:[t.jsx("div",{className:"entree-statuts-rapides",children:["realise","planifie","annule"].map(fe=>{const G=Uc[fe],ve=T.statut===fe;return t.jsx("button",{className:`statut-quick-btn ${ve?"active":""}`,style:ve?{borderColor:G.color,background:G.bg,color:G.color}:{},onClick:De=>{De.stopPropagation(),K(T,fe)},children:G.label},fe)})}),T.notesPrivees&&t.jsx("span",{className:"entree-has-notes",title:"Contient des notes prives",children:" Notes prives"})]})]})]},T.id)})})]}),t.jsx("div",{className:"cahier-sidebar-right no-print",children:t.jsx(um,{profId:r.uid,cahierId:a.id})})]})]})};function UJ(e){return{video:"",article:"",exercice:"",autre:""}[e]??""}function FJ(e){const r=/(?:youtube\.com\/watch\?v=|youtu\.be\/)([A-Za-z0-9_\-]{11})/,n=e.match(r);return n?n[1]:null}const GJ=({onAjouter:e,onAnnuler:r})=>{const[n,a]=g.useState(""),[l,o]=g.useState(""),[u,d]=g.useState("article"),[m,p]=g.useState(""),[h,v]=g.useState("");function b(j){o(j),(j.includes("youtube.com")||j.includes("youtu.be"))&&d("video")}function x(){if(!n.trim()){v("Le titre est requis.");return}if(!l.trim()||!l.startsWith("http://")&&!l.startsWith("https://")){v("Entrez une URL valide commenant par https://");return}const j={id:String(Date.now()),titre:n.trim(),url:l.trim(),type:u,description:m.trim()||void 0};e(j)}return t.jsxs("div",{className:"lien-form",children:[t.jsx("input",{type:"text",placeholder:"Titre du lien *",value:n,onChange:j=>a(j.target.value),"aria-label":"Titre du lien"}),t.jsx("input",{type:"url",placeholder:"https://... *",value:l,onChange:j=>b(j.target.value),"aria-label":"URL du lien"}),t.jsxs("select",{value:u,onChange:j=>d(j.target.value),"aria-label":"Type de lien",children:[t.jsx("option",{value:"article",children:" Article"}),t.jsx("option",{value:"video",children:" Vido"}),t.jsx("option",{value:"exercice",children:" Exercice"}),t.jsx("option",{value:"autre",children:" Autre"})]}),t.jsx("textarea",{placeholder:"Description (optionnelle)",value:m,onChange:j=>p(j.target.value),rows:2,"aria-label":"Description du lien"}),h&&t.jsx("p",{style:{color:"#dc2626",fontSize:"0.8rem",margin:0},children:h}),t.jsxs("div",{className:"lien-form-actions",children:[t.jsx("button",{className:"btn-secondary",onClick:r,type:"button",children:"Annuler"}),t.jsx("button",{className:"btn-pedaclic",onClick:x,type:"button",children:" Ajouter"})]})]})},HJ=({videoId:e})=>t.jsx("div",{className:"youtube-embed",children:t.jsx("iframe",{src:`https://www.youtube.com/embed/${e}`,title:"Vido YouTube",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy"})}),kM=({liens:e,onChange:r,readonly:n=!1})=>{const[a,l]=g.useState(!1);function o(d){r([...e,d]),l(!1)}function u(d){r(e.filter(m=>m.id!==d))}return t.jsxs("section",{className:"liens-section","aria-label":"Liens externes",children:[t.jsx("h4",{children:" Liens et ressources"}),e.length>0&&t.jsx("div",{className:"liens-liste",children:e.map(d=>{const m=FJ(d.url);return t.jsxs("div",{className:"lien-card",children:[t.jsx("span",{className:"lien-icone","aria-hidden":"true",children:UJ(d.type)}),t.jsxs("div",{className:"lien-infos",children:[t.jsx("a",{href:d.url,target:"_blank",rel:"noopener noreferrer",className:"lien-titre",title:d.url,children:d.titre}),d.description&&t.jsx("p",{className:"lien-description",children:d.description}),m&&t.jsx(HJ,{videoId:m})]}),!n&&t.jsx("button",{className:"lien-suppr",onClick:()=>u(d.id),title:"Supprimer ce lien",type:"button","aria-label":`Supprimer le lien ${d.titre}`,children:""})]},d.id)})}),e.length===0&&!n&&t.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 12px"},children:"Aucun lien ajout. Ajoutez des ressources pour enrichir cette sance."}),!n&&t.jsx(t.Fragment,{children:a?t.jsx(GJ,{onAjouter:o,onAnnuler:()=>l(!1)}):t.jsx("button",{className:"btn-secondary",onClick:()=>l(!0),type:"button",children:" Ajouter un lien"})})]})},VJ=({selectedIds:e,onSelect:r,onFermer:n})=>{const[a,l]=g.useState(""),[o,u]=g.useState([]),[d,m]=g.useState(!0),[p,h]=g.useState("");g.useEffect(()=>{async function x(){try{const j=await jJ();u(j)}catch{h("Impossible de charger la bibliothque.")}finally{m(!1)}}x()},[]);const v=g.useMemo(()=>{const x=a.toLowerCase().trim();return x?o.filter(j=>j.titre.toLowerCase().includes(x)||j.auteur.toLowerCase().includes(x)||j.categorie.toLowerCase().includes(x)):o},[o,a]);function b(x){x.target===x.currentTarget&&n()}return t.jsx("div",{className:"ebook-selector-overlay",onClick:b,role:"dialog","aria-modal":"true","aria-label":"Slectionner un ebook",children:t.jsxs("div",{className:"ebook-selector-panel",children:[t.jsxs("div",{className:"ebook-selector-header",children:[t.jsx("h3",{children:" Bibliothque PedaClic"}),t.jsx("button",{onClick:n,"aria-label":"Fermer",style:{background:"none",border:"none",fontSize:"1.3rem",cursor:"pointer",color:"#6b7280"},type:"button",children:""})]}),t.jsx("div",{className:"ebook-search",children:t.jsx("input",{type:"search",placeholder:" Rechercher par titre, auteur ou catgorie...",value:a,onChange:x=>l(x.target.value),autoFocus:!0,"aria-label":"Recherche ebook"})}),t.jsxs("div",{className:"ebook-liste",children:[d&&t.jsx("p",{style:{color:"#6b7280",textAlign:"center"},children:" Chargement de la bibliothque"}),p&&t.jsx("p",{style:{color:"#dc2626",textAlign:"center"},children:p}),!d&&!p&&v.length===0&&t.jsx("p",{style:{color:"#9ca3af",textAlign:"center"},children:"Aucun ebook ne correspond  votre recherche."}),!d&&v.map(x=>{const j=e.includes(x.id);return t.jsxs("button",{type:"button",className:`ebook-item ${j?"selected":""}`,onClick:()=>!j&&r(x),disabled:j,"aria-pressed":j,"aria-label":`${j?"Dj li : ":""}${x.titre}`,children:[x.couvertureUrl?t.jsx("img",{src:x.couvertureUrl,alt:`Couverture de ${x.titre}`,loading:"lazy"}):t.jsx("div",{style:{width:36,height:48,background:"#e5e7eb",borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.2rem",flexShrink:0},"aria-hidden":"true",children:""}),t.jsxs("div",{className:"ebook-item-info",children:[t.jsx("div",{className:"ebook-item-titre",children:x.titre}),t.jsxs("div",{className:"ebook-item-meta",children:[x.auteur,"  ",x.categorie]}),j&&t.jsx("div",{style:{fontSize:"0.75rem",color:"#2563eb",marginTop:2},children:" Dj li  cette sance"})]})]},x.id)})]})]})})},OM=({ebooksLies:e,onChange:r,readonly:n=!1})=>{const[a,l]=g.useState(!1),o=e.map(m=>m.ebookId);function u(m){const p={ebookId:m.id,titre:m.titre,categorie:m.categorie,auteur:m.auteur};r([...e,p]),l(!1)}function d(m){r(e.filter(p=>p.ebookId!==m))}return t.jsxs("section",{"aria-label":"Ebooks lis  la sance",style:{marginTop:16},children:[t.jsx("h4",{style:{fontSize:"0.95rem",fontWeight:600,color:"#111827",margin:"0 0 8px"},children:" Ebooks de la bibliothque"}),e.length>0&&t.jsx("div",{className:"ebooks-lies",children:e.map(m=>t.jsxs("span",{className:"ebook-chip",children:[t.jsxs("a",{href:`/bibliotheque/${m.ebookId}`,className:"ebook-chip",style:{textDecoration:"none"},title:`Lire : ${m.titre}`,children:[" ",m.titre]}),!n&&t.jsx("button",{onClick:()=>d(m.ebookId),title:`Retirer ${m.titre}`,type:"button","aria-label":`Retirer l'ebook ${m.titre}`,children:""})]},m.ebookId))}),e.length===0&&!n&&t.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 8px"},children:"Aucun ebook li. Associez un ebook de la bibliothque  cette sance."}),!n&&t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>l(!0),style:{marginTop:8},children:" Choisir dans la bibliothque"}),a&&t.jsx(VJ,{selectedIds:o,onSelect:u,onFermer:()=>l(!1)})]})},DM="https://api.pedaclic.sn",QJ=12e4,YJ=1,xr={cours_complet:"Cours complet",fiche_revision:"Fiche de rvision",exercices_corriges:"Exercices corrigs",quiz_auto:"Quiz auto-gnr",sujet_examen:"Sujet type examen",evaluation_personnalisee:"valuation personnalise"},KJ={cours_complet:"Un cours structur avec introduction, dveloppement et conclusion adapt au programme sngalais.",fiche_revision:"Synthse des points cls pour rviser efficacement avant un examen.",exercices_corriges:"Srie d'exercices progressifs avec corrections dtailles tape par tape.",quiz_auto:"10 questions QCM avec 4 options, corrections et explications. Sauvegard directement comme quiz jouable.",sujet_examen:"Sujet conforme au format officiel BFEM ou BAC avec barme.",evaluation_personnalisee:"valuation sur mesure avec barme /20 et corrig-type."},Ka={cours_complet:"",fiche_revision:"",exercices_corriges:"",quiz_auto:"",sujet_examen:"",evaluation_personnalisee:""};async function WJ(e,r,n=QJ){const a=new AbortController,l=setTimeout(()=>a.abort(),n);try{const o=await fetch(e,{...r,signal:a.signal});return clearTimeout(l),o}catch(o){throw clearTimeout(l),o.name==="AbortError"?new Error(`La gnration a pris trop de temps (>${n/1e3}s). Le serveur est peut-tre surcharg. Veuillez ressayer dans quelques instants.`):o}}async function PM(e,r=YJ){try{return await e()}catch(n){if(r<=0)throw n;return console.warn(`[aiGeneratorService] chec, nouvelle tentative dans 3s... (${r} restante(s))`),await new Promise(a=>setTimeout(a,3e3)),PM(e,r-1)}}async function fA(){try{(await fetch(`${DM}/api/health`,{method:"GET"})).ok&&console.log("[aiGeneratorService] Ping Railway OK")}catch{}}async function XJ(e){const r=JSON.stringify(e),n={method:"POST",headers:{"Content-Type":"application/json"},body:r},a=await PM(()=>WJ(`${DM}/api/generate`,n)).catch(o=>{throw console.error("[aiGeneratorService] Erreur gnration:",o),o instanceof TypeError&&o.message.includes("fetch")?new Error("Impossible de contacter le serveur. Vrifiez votre connexion internet."):o});if(!a.ok){const u=(await a.json().catch(()=>({}))).error||`Erreur serveur (${a.status})`;throw new Error(u)}const l=await a.json();if(!l.success)throw new Error(l.error||"La gnration a chou.");return l}async function ZJ(e,r,n,a){try{const l=await Ot(_e(V,"generated_content"),{userId:e,type:r.type,discipline:r.discipline,disciplineId:a,classe:r.classe,chapitre:r.chapitre,content:n,options:r.options||null,createdAt:Ee.now()});return console.log("[aiGeneratorService] Contenu sauvegard:",l.id),l.id}catch(l){throw console.error("[aiGeneratorService] Erreur sauvegarde contenu:",l),new Error("Erreur lors de la sauvegarde du contenu gnr.")}}async function JJ(e,r,n,a){try{const l=n.map((d,m)=>({id:`q_${Date.now()}_${m}`,question:d.question,options:d.options,reponseCorrecte:d.reponseCorrecte,explication:d.explication||"",difficulte:d.difficulte||"moyen",points:d.points||2})),o={disciplineId:a,titre:`Quiz IA  ${r.chapitre}`,description:`Quiz auto-gnr pour ${r.discipline} (${r.classe})  Chapitre : ${r.chapitre}`,questions:l,duree:15,isPremium:!0,noteMinimale:10,auteurId:e,source:"ia_generator",createdAt:Ee.now()},u=await Ot(_e(V,"quizzes"),o);return console.log("[aiGeneratorService] Quiz sauvegard:",u.id),u.id}catch(l){throw console.error("[aiGeneratorService] Erreur sauvegarde quiz:",l),new Error("Erreur lors de la sauvegarde du quiz gnr.")}}async function Bb(e,r=20){try{const n=ze(_e(V,"generated_content"),Se("userId","==",e),Qe("createdAt","desc")),a=await Ae(n),l=[];return a.forEach(o=>{l.length<r&&l.push({id:o.id,...o.data()})}),l}catch(n){throw console.error("[aiGeneratorService] Erreur chargement historique:",n),new Error("Erreur lors du chargement de l'historique.")}}async function eee(e){try{await Ir(je(V,"generated_content",e)),console.log("[aiGeneratorService] Contenu supprim:",e)}catch(r){throw console.error("[aiGeneratorService] Erreur suppression:",r),new Error("Erreur lors de la suppression du contenu.")}}const tee=({userId:e,selectedIds:r,onSelect:n,onFermer:a})=>{const[l,o]=g.useState(""),[u,d]=g.useState([]),[m,p]=g.useState(!0),[h,v]=g.useState("");g.useEffect(()=>{async function j(){try{const _=await Bb(e,50);d(_)}catch{v("Impossible de charger les contenus gnrs.")}finally{p(!1)}}j()},[e]);const b=g.useMemo(()=>{const j=l.toLowerCase().trim();return j?u.filter(_=>_.chapitre.toLowerCase().includes(j)||_.discipline.toLowerCase().includes(j)||_.classe.toLowerCase().includes(j)||xr[_.type]?.toLowerCase().includes(j)):u},[u,l]);function x(j){j.target===j.currentTarget&&a()}return t.jsx("div",{className:"ebook-selector-overlay",onClick:x,role:"dialog","aria-modal":"true","aria-label":"Slectionner un contenu IA",children:t.jsxs("div",{className:"ebook-selector-panel",children:[t.jsxs("div",{className:"ebook-selector-header",children:[t.jsx("h3",{children:" Contenus gnrs par l'IA"}),t.jsx("button",{onClick:a,"aria-label":"Fermer",type:"button",style:{background:"none",border:"none",fontSize:"1.3rem",cursor:"pointer",color:"#6b7280"},children:""})]}),t.jsx("div",{className:"ebook-search",children:t.jsx("input",{type:"search",placeholder:" Rechercher par chapitre, discipline ou classe",value:l,onChange:j=>o(j.target.value),autoFocus:!0,"aria-label":"Recherche contenu IA"})}),t.jsxs("div",{className:"ebook-liste",children:[m&&t.jsx("p",{style:{color:"#6b7280",textAlign:"center"},children:" Chargement"}),h&&t.jsx("p",{style:{color:"#dc2626",textAlign:"center"},children:h}),!m&&!h&&b.length===0&&t.jsx("p",{style:{color:"#9ca3af",textAlign:"center"},children:"Aucun contenu ne correspond  votre recherche."}),!m&&b.map(j=>{const _=j.id?r.includes(j.id):!1,w=j.createdAt?.toDate?j.createdAt.toDate().toLocaleDateString("fr-FR"):"";return t.jsxs("button",{type:"button",className:`ebook-item ${_?"selected":""}`,onClick:()=>!_&&n(j),disabled:_,"aria-pressed":_,children:[t.jsx("div",{style:{width:36,height:48,background:"#eff6ff",borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.4rem",flexShrink:0},"aria-hidden":"true",children:Ka[j.type]}),t.jsxs("div",{className:"ebook-item-info",children:[t.jsx("div",{className:"ebook-item-titre",children:j.chapitre}),t.jsxs("div",{className:"ebook-item-meta",children:[xr[j.type],"  ",j.discipline,"  ",j.classe,w&&`  ${w}`]}),_&&t.jsx("div",{style:{fontSize:"0.75rem",color:"#2563eb",marginTop:2},children:" Dj li  cette sance"})]})]},j.id)})]})]})})},ree=({userId:e,contenuIA:r,onChange:n,readonly:a=!1})=>{const[l,o]=g.useState(!1),u=r.map(p=>p.contenuId);function d(p){if(!p.id)return;const h={contenuId:p.id,type:p.type,discipline:p.discipline,classe:p.classe,chapitre:p.chapitre,createdAt:p.createdAt?.toDate?p.createdAt.toDate().toISOString():void 0};n([...r,h]),o(!1)}function m(p){n(r.filter(h=>h.contenuId!==p))}return t.jsxs("section",{"aria-label":"Contenus IA lis  la sance",style:{marginTop:16},children:[t.jsx("h4",{style:{fontSize:"0.95rem",fontWeight:600,color:"#111827",margin:"0 0 8px"},children:" Contenus gnrs par l'IA"}),r.length>0&&t.jsx("div",{className:"ebooks-lies",children:r.map(p=>t.jsxs("span",{className:"ebook-chip ebook-chip--ia",children:[t.jsxs("span",{title:`${p.discipline}  ${p.classe}  ${p.chapitre}`,children:[Ka[p.type]??""," ",p.chapitre]}),!a&&t.jsx("button",{onClick:()=>m(p.contenuId),title:`Retirer : ${p.chapitre}`,type:"button","aria-label":`Retirer le contenu ${p.chapitre}`,children:""})]},p.contenuId))}),r.length===0&&!a&&t.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 8px"},children:"Aucun contenu IA li. Associez un contenu gnr  cette sance."}),!a&&t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>o(!0),style:{marginTop:8},children:" Choisir un contenu IA"}),l&&t.jsx(tee,{userId:e,selectedIds:u,onSelect:d,onFermer:()=>o(!1)})]})},nee=()=>({date:new Date().toISOString().slice(0,10),heureDebut:"",heureFin:"",chapitre:"",typeContenu:"cours",contenu:"",objectifs:"",competences:[],statut:"realise",motifAnnulation:"",dateReport:"",notesPrivees:"",isMarqueEvaluation:!1,typeEvaluation:"",dateEvaluationPrevue:"",statutEvaluation:"a_evaluer"}),pA=()=>{const{cahierId:e,entreeId:r}=jn(),{currentUser:n}=Xe(),a=tt(),[l,o]=g.useState(null),[u,d]=g.useState(null),[m,p]=g.useState(nee()),[h,v]=g.useState([]),[b,x]=g.useState(!0),[j,_]=g.useState(!1),[w,C]=g.useState(!1),[E,S]=g.useState(""),[A,z]=g.useState([]),[k,P]=g.useState([]),[D,$]=g.useState([]),F=!!r;g.useEffect(()=>{if(!e)return;(async()=>{x(!0);try{const L=await CM(e);if(!L){a("/prof/cahiers");return}if(o(L),F&&r){const I=await hJ(r);I&&(d(I),v(I.piecesJointes||[]),z(I.liens??[]),P(I.ebooksLies??[]),$(I.contenuIA??[]),p({date:I.date.toDate().toISOString().slice(0,10),heureDebut:I.heureDebut||"",heureFin:I.heureFin||"",chapitre:I.chapitre,typeContenu:I.typeContenu,contenu:I.contenu,objectifs:I.objectifs||"",competences:I.competences||[],statut:I.statut,motifAnnulation:I.motifAnnulation||"",dateReport:I.dateReport?I.dateReport.toDate().toISOString().slice(0,10):"",notesPrivees:I.notesPrivees||"",isMarqueEvaluation:I.isMarqueEvaluation,typeEvaluation:I.typeEvaluation||"",dateEvaluationPrevue:I.dateEvaluationPrevue?I.dateEvaluationPrevue.toDate().toISOString().slice(0,10):"",statutEvaluation:I.statutEvaluation||"a_evaluer"}))}}finally{x(!1)}})()},[e,r]);const Y=X=>{p(L=>({...L,competences:L.competences.includes(X)?L.competences.filter(I=>I!==X):[...L.competences,X]}))},M=async X=>{if(!X.target.files?.length||!n?.uid||!e)return;const L=X.target.files[0];if(L.size>10*1024*1024){alert("Fichier trop volumineux (max 10 Mo)");return}C(!0);try{const I=await vJ(n.uid,e,L),U=[...h,I];v(U),F&&r&&u&&await sA(r,h,[I])}catch{alert("Erreur upload fichier.")}finally{C(!1),X.target.value=""}},K=async X=>{if(!r){v(L=>L.filter(I=>I.url!==X));return}try{await gJ(r,h,X),v(L=>L.filter(I=>I.url!==X))}catch{alert("Erreur suppression fichier.")}},ee=async X=>{if(X.preventDefault(),!m.chapitre.trim()){S("Le chapitre est obligatoire.");return}if(!m.date){S("La date est obligatoire.");return}if(!(!n?.uid||!e)){_(!0),S("");try{if(F&&r)await Gc(r,e,m),await Gc(r,{liens:A,ebooksLies:k,contenuIA:D});else{const U=await EJ(e,n.uid,m);h.length>0&&await sA(U,[],h),(A.length>0||k.length>0||D.length>0)&&await Gc(U,{liens:A,ebooksLies:k,contenuIA:D})}const I=(await EM(e)).filter(U=>U.statut==="realise").length;await Nf(e,{nombreSeancesRealise:I}),a(`/prof/cahiers/${e}`)}catch(L){const I=L instanceof Error?L.message:String(L);S("Erreur : "+I)}finally{_(!1)}}};return b?t.jsx("div",{className:"loading-spinner",children:t.jsx("div",{className:"spinner-circle"})}):l?t.jsxs("div",{className:"entree-editor-page",children:[t.jsxs("div",{className:"editor-header",children:[t.jsx("button",{onClick:()=>a(`/prof/cahiers/${e}`),style:{background:"none",border:"none",cursor:"pointer",color:"#6b7280",fontSize:"1.2rem"},children:""}),t.jsxs("div",{children:[t.jsx("h1",{style:{fontSize:"1.4rem",fontWeight:700,color:"#1f2937",margin:"0 0 0.2rem"},children:F?" Modifier la sance":" Nouvelle sance"}),t.jsxs("div",{style:{fontSize:"0.85rem",color:"#6b7280"},children:[l.titre,"  ",l.classe,"  ",l.matiere]})]})]}),t.jsxs("form",{onSubmit:ee,children:[t.jsxs("div",{className:"editor-card",children:[t.jsx("div",{className:"editor-section-title",children:" Informations de la sance"}),t.jsxs("div",{className:"form-row",style:{gridTemplateColumns:"1.5fr 1fr 1fr"},children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Date *"}),t.jsx("input",{type:"date",className:"form-input",value:m.date,onChange:X=>p(L=>({...L,date:X.target.value})),required:!0})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Heure dbut"}),t.jsx("input",{type:"time",className:"form-input",value:m.heureDebut,onChange:X=>p(L=>({...L,heureDebut:X.target.value}))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Heure fin"}),t.jsx("input",{type:"time",className:"form-input",value:m.heureFin,onChange:X=>p(L=>({...L,heureFin:X.target.value}))})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Chapitre / Titre de la sance *"}),t.jsx("input",{className:"form-input",placeholder:"Ex: Chapitre 3  Les fonctions affines",value:m.chapitre,onChange:X=>p(L=>({...L,chapitre:X.target.value})),required:!0})]}),t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Type de sance"}),t.jsx("select",{className:"form-select",value:m.typeContenu,onChange:X=>p(L=>({...L,typeContenu:X.target.value})),children:Object.entries(Zi).map(([X,L])=>t.jsxs("option",{value:X,children:[L.emoji," ",L.label]},X))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Statut"}),t.jsx("select",{className:"form-select",value:m.statut,onChange:X=>p(L=>({...L,statut:X.target.value})),children:Object.entries(Uc).map(([X,L])=>t.jsx("option",{value:X,children:L.label},X))})]})]}),m.statut==="annule"&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Motif d'annulation"}),t.jsx("input",{className:"form-input",placeholder:"Ex: Grve enseignants, sortie scolaire...",value:m.motifAnnulation,onChange:X=>p(L=>({...L,motifAnnulation:X.target.value}))})]}),m.statut==="reporte"&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Nouvelle date (report)"}),t.jsx("input",{type:"date",className:"form-input",value:m.dateReport,onChange:X=>p(L=>({...L,dateReport:X.target.value}))})]})]}),t.jsxs("div",{className:"editor-card",children:[t.jsx("div",{className:"editor-section-title",children:" Contenu de la sance"}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Contenu (mise en forme riche)"}),t.jsx(ja,{value:m.contenu,onChange:X=>p(L=>({...L,contenu:X})),placeholder:"Dcrivez le contenu enseign, les exemples traits, les formules vues...",minHeight:220,maxHeight:600})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Objectifs pdagogiques"}),t.jsx("textarea",{className:"form-textarea",placeholder:"Ex: L'lve sera capable de rsoudre une quation du second degr...",value:m.objectifs,onChange:X=>p(L=>({...L,objectifs:X.target.value})),rows:2})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Comptences vises"}),t.jsx("div",{className:"competences-container",children:I5.map(X=>t.jsx("button",{type:"button",className:`competence-tag ${m.competences.includes(X)?"selected":""}`,onClick:()=>Y(X),children:X},X))})]})]}),t.jsxs("div",{className:"editor-card",children:[t.jsx("div",{className:"editor-section-title",children:" Signet d'valuation"}),t.jsxs("div",{className:"signet-section",children:[t.jsxs("div",{className:"signet-toggle",onClick:()=>p(X=>({...X,isMarqueEvaluation:!X.isMarqueEvaluation})),children:[t.jsx("div",{className:`toggle-switch ${m.isMarqueEvaluation?"on":""}`}),t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem",color:"#1f2937"},children:"Marquer pour valuation"}),t.jsx("div",{style:{fontSize:"0.78rem",color:"#6b7280"},children:"Ce contenu sera valu ultrieurement"})]})]}),m.isMarqueEvaluation&&t.jsx("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Type d'valuation"}),t.jsxs("select",{className:"form-select",value:m.typeEvaluation,onChange:X=>p(L=>({...L,typeEvaluation:X.target.value})),children:[t.jsx("option",{value:"",children:"Choisir..."}),Object.entries($A).map(([X,L])=>t.jsx("option",{value:X,children:L},X))]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Date prvue d'valuation"}),t.jsx("input",{type:"date",className:"form-input",value:m.dateEvaluationPrevue,onChange:X=>p(L=>({...L,dateEvaluationPrevue:X.target.value}))})]})]})})]})]}),t.jsxs("div",{className:"editor-card",children:[t.jsx("div",{className:"editor-section-title",children:" Pices jointes"}),h.length>0&&t.jsx("div",{className:"pieces-jointes-list",children:h.map(X=>t.jsxs("div",{className:"piece-jointe-item",children:[t.jsx("span",{children:""}),t.jsx("a",{href:X.url,target:"_blank",rel:"noopener noreferrer",children:X.nom}),t.jsxs("span",{style:{color:"#9ca3af",fontSize:"0.75rem"},children:["(",Math.round((X.taille??0)/1024)," Ko)"]}),t.jsx("button",{type:"button",onClick:()=>K(X.url),style:{background:"none",border:"none",cursor:"pointer",color:"#ef4444",marginLeft:"auto"},children:""})]},X.url))}),t.jsxs("label",{className:"upload-zone",children:[w?"Envoi en cours...":" Cliquer pour ajouter un fichier (PDF, image  max 10 Mo)",t.jsx("input",{type:"file",style:{display:"none"},accept:".pdf,.jpg,.jpeg,.png,.doc,.docx,.ppt,.pptx",onChange:M,disabled:w})]})]}),t.jsxs("div",{className:"editor-card",children:[t.jsx("div",{className:"editor-section-title",children:" Ressources enrichies"}),t.jsx("p",{style:{fontSize:"0.82rem",color:"#6b7280",margin:"0 0 4px"},children:"Ajoutez des liens ou des ebooks pour enrichir cette sance."}),t.jsx(kM,{liens:A,onChange:z}),t.jsx(OM,{ebooksLies:k,onChange:P}),t.jsx(ree,{userId:n.uid,contenuIA:D,onChange:$})]}),t.jsxs("div",{className:"editor-card",children:[t.jsx("div",{className:"editor-section-title",children:" Notes prives"}),t.jsx("textarea",{className:"form-textarea",placeholder:"Notes personnelles (non visibles par l'administration)...",value:m.notesPrivees,onChange:X=>p(L=>({...L,notesPrivees:X.target.value})),rows:3}),t.jsx("div",{style:{fontSize:"0.75rem",color:"#9ca3af",marginTop:"0.25rem"},children:"Ces notes sont uniquement visibles par vous."})]}),E&&t.jsx("div",{style:{color:"#dc2626",background:"#fee2e2",padding:"0.75rem 1rem",borderRadius:8,marginBottom:"1rem",fontSize:"0.85rem"},children:E}),t.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end",paddingBottom:"2rem"},children:[t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>a(`/prof/cahiers/${e}`),children:"Annuler"}),t.jsx("button",{type:"submit",className:"btn-primary",disabled:j,style:{minWidth:160},children:j?"Enregistrement...":F?" Mettre  jour":" Enregistrer la sance"})]})]})]}):null},aee=50*1024*1024,iee="image/jpeg,image/png,image/gif,image/webp,audio/mpeg,audio/wav,audio/ogg,video/mp4";function see(e){return e.startsWith("image/")?"image":e.startsWith("audio/")?"audio":e.startsWith("video/")?"video":"autre"}function MM(e){return e<1024?`${e} o`:e<1024*1024?`${(e/1024).toFixed(1)} Ko`:`${(e/1024/1024).toFixed(1)} Mo`}const lee=({src:e,alt:r,onFermer:n})=>t.jsx("div",{className:"image-fullscreen-overlay",onClick:n,role:"dialog","aria-modal":"true","aria-label":"Image en plein cran",children:t.jsx("img",{src:e,alt:r})}),oee=({pj:e,onSupprimer:r,readonly:n=!1})=>{const[a,l]=g.useState(!1);return t.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,overflow:"hidden",marginBottom:10,background:"#fff"},children:[e.type==="image"&&t.jsxs(t.Fragment,{children:[t.jsx("img",{src:e.url,alt:e.nom,className:"media-image",onClick:()=>l(!0),style:{maxWidth:"100%",display:"block"},loading:"lazy"}),a&&t.jsx(lee,{src:e.url,alt:e.nom,onFermer:()=>l(!1)})]}),e.type==="audio"&&t.jsx("div",{className:"media-player",children:t.jsxs("audio",{controls:!0,preload:"metadata",children:[t.jsx("source",{src:e.url,type:e.mimeType}),"Votre navigateur ne supporte pas la lecture audio."]})}),e.type==="video"&&t.jsx("div",{className:"media-player",children:t.jsxs("video",{controls:!0,preload:"none",playsInline:!0,children:[t.jsx("source",{src:e.url,type:e.mimeType}),"Votre navigateur ne supporte pas la lecture vido."]})}),(e.type==="pdf"||e.type==="autre")&&t.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center",gap:8,padding:"10px 14px",textDecoration:"none",color:"#2563eb"},children:[" ",e.nom]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 12px",background:"#f9fafb",borderTop:"1px solid #f3f4f6"},children:[t.jsxs("span",{style:{fontSize:"0.78rem",color:"#6b7280",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[e.nom,e.taille&&`  ${MM(e.taille)}`]}),!n&&r&&t.jsx("button",{type:"button",onClick:()=>r(e.id),title:"Supprimer ce fichier",style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af",fontSize:"1rem",padding:"0 4px"},"aria-label":`Supprimer ${e.nom}`,children:""})]})]})},cee=({piecesJointes:e,entreeId:r,profId:n,onChange:a,readonly:l=!1})=>{const o=g.useRef(null),[u,d]=g.useState(null),[m,p]=g.useState("");async function h(b){const x=b.target.files?.[0];if(!x)return;if(x.size>aee){p(`Fichier trop volumineux (max 50 Mo). Ce fichier fait ${MM(x.size)}.`);return}p("");const j=`${Date.now()}_${x.name}`,_=`cahiers/${n}/${r}/${j}`,w=cr(ar,_),C=uu(w,x);C.on("state_changed",E=>{const S=Math.round(E.bytesTransferred/E.totalBytes*100);d(S)},E=>{p(`Erreur d'envoi : ${E.message}`),d(null)},async()=>{const E=await In(C.snapshot.ref),S=see(x.type),A={id:String(Date.now()),nom:x.name,url:E,type:S,taille:x.size,mimeType:x.type};a([...e,A]),d(null),o.current&&(o.current.value="")})}function v(b){a(e.filter(x=>x.id!==b))}return t.jsxs("section",{"aria-label":"Fichiers mdias",style:{marginTop:20},children:[t.jsx("h4",{style:{fontSize:"0.95rem",fontWeight:600,color:"#111827",margin:"0 0 12px"},children:" Fichiers mdias"}),e.map(b=>t.jsx(oee,{pj:b,onSupprimer:v,readonly:l},b.id)),e.length===0&&!l&&t.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 12px"},children:"Aucun fichier ajout. Formats accepts : images, audio, vido (max 50 Mo)."}),!l&&t.jsxs(t.Fragment,{children:[u!==null&&t.jsxs("div",{style:{marginBottom:12},children:[t.jsx("div",{style:{height:8,background:"#e5e7eb",borderRadius:9999,overflow:"hidden"},children:t.jsx("div",{style:{height:"100%",width:`${u}%`,background:"#2563eb",transition:"width 0.3s ease"},role:"progressbar","aria-valuenow":u,"aria-valuemin":0,"aria-valuemax":100})}),t.jsxs("p",{style:{fontSize:"0.8rem",color:"#6b7280",margin:"4px 0 0"},children:["Envoi en cours ",u,"%"]})]}),m&&t.jsxs("p",{style:{fontSize:"0.8rem",color:"#dc2626",margin:"0 0 8px"},children:[" ",m]}),t.jsx("input",{ref:o,type:"file",accept:iee,onChange:h,style:{display:"none"},"aria-label":"Choisir un fichier mdia"}),t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>o.current?.click(),disabled:u!==null,children:" Ajouter un fichier (image / audio / vido)"}),t.jsx("p",{style:{fontSize:"0.75rem",color:"#9ca3af",marginTop:6},children:"Max 50 Mo  JPG, PNG, GIF, WebP, MP3, WAV, OGG, MP4"})]})]})};function uee(e){return e.toDate().toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}const dee=()=>{const{cahierId:e}=jn(),r=tt(),[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState(!0),[m,p]=g.useState(""),[h,v]=g.useState(null);g.useEffect(()=>{async function x(){if(e){d(!0);try{const j=await yJ(e);if(!j){p("Ce cahier n'est pas accessible ou n'existe pas.");return}a(j);const _=await CJ(e);o(_)}catch{p("Une erreur est survenue lors du chargement.")}finally{d(!1)}}}x()},[e]);function b(x){v(j=>j===x?null:x)}return u?t.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"#6b7280"},children:[t.jsx("div",{style:{fontSize:"2rem"},children:""}),t.jsx("p",{children:"Chargement du cahier de textes"})]}):m||!n?t.jsxs("div",{style:{textAlign:"center",padding:"60px 20px"},children:[t.jsx("div",{style:{fontSize:"2.5rem"},children:""}),t.jsx("p",{style:{color:"#dc2626",fontWeight:600},children:m||"Accs non autoris"}),t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>r(-1),style:{marginTop:12},children:" Retour"})]}):t.jsxs("main",{style:{maxWidth:760,margin:"0 auto",padding:"20px 16px"},children:[t.jsxs("header",{className:"eleve-cahier-header",children:[t.jsx("button",{type:"button",onClick:()=>r(-1),style:{background:"rgba(255,255,255,0.2)",border:"none",color:"#fff",cursor:"pointer",borderRadius:8,padding:"4px 10px",fontSize:"0.85rem",marginBottom:10,display:"inline-flex",alignItems:"center",gap:4},children:" Retour"}),t.jsx("h1",{children:n.titre}),t.jsxs("p",{children:[n.matiere,"  ",n.classe,"  ",n.anneeScolaire]}),t.jsx("span",{className:"badge-lecture-seule",children:" Lecture seule  Sances ralises"})]}),n.description&&t.jsx("div",{style:{background:"#f0f9ff",border:"1px solid #bae6fd",borderRadius:10,padding:14,marginBottom:20,fontSize:"0.9rem",color:"#0c4a6e"},children:n.description}),t.jsx("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:16},children:l.length===0?"Aucune sance ralise pour l'instant.":`${l.length} sance${l.length>1?"s":""} ralise${l.length>1?"s":""}`}),l.length===0&&t.jsxs("div",{className:"eleve-vide",children:[t.jsx("span",{className:"emoji",children:""}),t.jsx("p",{children:"Votre professeur n'a pas encore enregistr de sance ralise."}),t.jsx("p",{style:{fontSize:"0.8rem"},children:"Revenez plus tard !"})]}),l.map(x=>{const j=h===x.id,_=(x.piecesJointes?.length??0)>0,w=(x.liens?.length??0)>0,C=(x.ebooksLies?.length??0)>0;return t.jsxs("article",{className:"seance-card-eleve",children:[t.jsxs("button",{type:"button",onClick:()=>b(x.id),style:{width:"100%",background:"none",border:"none",cursor:"pointer",textAlign:"left",padding:0},"aria-expanded":j,"aria-controls":`seance-corps-${x.id}`,children:[t.jsxs("div",{className:"seance-card-eleve-date",children:[" ",uee(x.date),x.heureDebut?`  ${x.heureDebut}${x.heureFin?`  ${x.heureFin}`:""}`:""]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("h3",{style:{margin:0},children:x.chapitre}),t.jsx("span",{style:{fontSize:"1.1rem",transition:"transform 0.2s",transform:j?"rotate(180deg)":"rotate(0)",display:"inline-block"},"aria-hidden":"true",children:""})]}),t.jsxs("div",{style:{display:"flex",gap:6,marginTop:6,flexWrap:"wrap"},children:[w&&t.jsx("span",{style:{fontSize:"0.72rem",background:"#eff6ff",color:"#2563eb",padding:"2px 8px",borderRadius:9999},children:" Ressources"}),C&&t.jsx("span",{style:{fontSize:"0.72rem",background:"#fef3c7",color:"#92400e",padding:"2px 8px",borderRadius:9999},children:" Ebooks"}),_&&t.jsx("span",{style:{fontSize:"0.72rem",background:"#f0fdf4",color:"#16a34a",padding:"2px 8px",borderRadius:9999},children:" Mdias"})]})]}),j&&t.jsxs("div",{id:`seance-corps-${x.id}`,style:{marginTop:14,borderTop:"1px solid #f3f4f6",paddingTop:14},children:[x.objectifs&&t.jsxs("div",{style:{background:"#f0fdf4",border:"1px solid #bbf7d0",borderRadius:8,padding:10,fontSize:"0.875rem",color:"#166534",marginBottom:12},children:[t.jsx("strong",{children:" Objectifs :"})," ",x.objectifs]}),t.jsx("div",{className:"seance-card-eleve-contenu",children:x.contenu}),w&&t.jsx(kM,{liens:x.liens??[],onChange:()=>{},readonly:!0}),C&&t.jsx(OM,{ebooksLies:x.ebooksLies??[],onChange:()=>{},readonly:!0}),_&&t.jsx(cee,{piecesJointes:x.piecesJointes??[],entreeId:x.id,profId:"",onChange:()=>{},readonly:!0})]})]},x.id)})]})},us="sequences_pedagogiques",mee="entrees_cahier";function TM(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function Ap(e){return e.filter(r=>r.estEvaluation&&r.typeEvaluation).map(r=>({id:r.id,titre:r.titre,type:r.typeEvaluation,seanceNumero:r.numero,noteMax:r.noteMax??20,coefficient:r.coefficient??1,datePrevue:r.datePrevue}))}async function fee(e){const r=ze(_e(V,us),Se("profId","==",e),Qe("updatedAt","desc"));return(await Ae(r)).docs.map(a=>({id:a.id,...a.data()}))}async function cu(e){const r=await pt(je(V,us,e));return r.exists()?{id:r.id,...r.data()}:null}async function pee(e,r){const n=Ee.now(),a=r.seances.map(u=>({...u,id:u.id||TM(),exporterVersCahier:u.exporterVersCahier??!0,entreesCahierIds:u.entreesCahierIds??[]})),l=Ap(a);return(await Ot(_e(V,us),{...r,profId:e,seances:a,evaluationsPrevues:l,statut:r.statut??"brouillon",genereeParIA:r.genereeParIA??!1,competences:r.competences??[],createdAt:n,updatedAt:n})).id}async function hee(e,r){const n={...r,updatedAt:Ee.now()};r.seances&&(n.evaluationsPrevues=Ap(r.seances)),await Ve(je(V,us,e),n)}async function vee(e,r){await Ve(je(V,us,e),{statut:r,updatedAt:Ee.now()})}async function qM(e){await Ir(je(V,us,e))}async function gee(e,r){const n=await cu(e);if(!n)throw new Error(`Squence ${e} introuvable`);const a=Ee.now(),l=n.seances.map(u=>({...u,id:TM(),exporterVersCahier:!0,entreesCahierIds:[],datePrevue:void 0}));return(await Ot(_e(V,us),{titre:`[Copie] ${n.titre}`,description:n.description,niveau:n.niveau,matiere:n.matiere,theme:n.theme,competences:n.competences,objectifGeneral:n.objectifGeneral,prerequis:n.prerequis,nombreSeances:n.nombreSeances,dureeSeanceMinutes:n.dureeSeanceMinutes,trimestre:n.trimestre,seances:l,evaluationsPrevues:Ap(l),genereeParIA:n.genereeParIA,profId:r,statut:"brouillon",groupeClasseId:void 0,groupeClasseNom:void 0,cahierDeTextesId:void 0,cahierDeTextesNom:void 0,createdAt:a,updatedAt:a})).id}async function xee(e){const{sequenceId:r,cahierDeTextesId:n,profId:a,datesParSeance:l}=e,o=await cu(r);if(!o)throw new Error(`Squence ${r} introuvable`);const u=Ee.now(),d=[],m=[],p=Object.keys(l),h=[...o.seances];for(const v of p){const b=h.findIndex(_=>_.id===v);if(b===-1){m.push(v);continue}const x=h[b],j=l[v];try{const _={cahierId:n,profId:a,date:j,chapitre:x.titre,typeContenu:"cours",contenu:x.contenu,objectifs:x.objectifSpecifique,statut:"planifie",notesPrivees:x.ressources.length>0?`Ressources : ${x.ressources.join(" | ")}`:void 0,isMarqueEvaluation:!1,ordre:b,liens:[],ebooksLies:[],piecesJointes:[]},w=await Ot(_e(V,mee),{..._,createdAt:u,updatedAt:u});d.push(w.id),h[b]={...x,exporterVersCahier:!1,entreesCahierIds:[...x.entreesCahierIds??[],w.id]}}catch(_){console.error(`[exporterVersCahier] Erreur sance ${v}:`,_),m.push(v)}}return d.length>0&&await Ve(je(V,us,r),{seances:h,evaluationsPrevues:Ap(h),cahierDeTextesId:n,cahierDeTextesNom:o.cahierDeTextesNom??"",exporteAt:u,updatedAt:u}),{nbExportees:d.length,idsEntrees:d,erreurs:m}}function bee(e,r){return e.filter(n=>{if(r.matiere&&n.matiere!==r.matiere||r.niveau&&n.niveau!==r.niveau||r.statut&&n.statut!==r.statut||r.groupeClasseId&&n.groupeClasseId!==r.groupeClasseId)return!1;if(r.recherche){const a=r.recherche.toLowerCase();if(!(n.titre.toLowerCase().includes(a)||n.matiere.toLowerCase().includes(a)||n.theme.toLowerCase().includes(a)||n.description.toLowerCase().includes(a)))return!1}return!0})}const Sf={cours:"Cours",td:"TD",tp:"TP",evaluation:"valuation",revision:"Rvision",projet:"Projet",correction:"Correction"},qj={formative:"Formative",sommative:"Sommative",diagnostique:"Diagnostique",devoir:"Devoir sur table",composition:"Composition (BFEM/BAC)",interrogation:"Interrogation"},zp={brouillon:{label:"Brouillon",couleur:"#6b7280"},active:{label:"En cours",couleur:"#2563eb"},terminee:{label:"Termine",couleur:"#16a34a"},archivee:{label:"Archive",couleur:"#9ca3af"}},yee=[{valeur:"6eme",label:"6me"},{valeur:"5eme",label:"5me"},{valeur:"4eme",label:"4me"},{valeur:"3eme",label:"3me"},{valeur:"2nde",label:"2nde"},{valeur:"1ere",label:"1re"},{valeur:"terminale",label:"Terminale"}],wf=[30,45,55,60,90,120],jee=({statut:e})=>{const{label:r}=zp[e];return t.jsxs("span",{className:`statut-badge statut-badge--${e}`,children:[t.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:"currentColor",display:"inline-block"}}),r]})},_ee=({sequence:e,onView:r,onEdit:n,onDuplicate:a,onDelete:l})=>{const o=e.seances.filter(u=>u.estEvaluation).length;return t.jsxs("article",{className:"sequence-card",onClick:r,role:"button",tabIndex:0,onKeyDown:u=>u.key==="Enter"&&r(),children:[t.jsxs("div",{className:"sequence-card__badges",children:[t.jsx(jee,{statut:e.statut}),e.genereeParIA&&t.jsx("span",{className:"badge-ia",children:" IA"})]}),t.jsx("h3",{className:"sequence-card__title",children:e.titre}),t.jsxs("div",{className:"sequence-card__meta",children:[t.jsx("span",{className:"sequence-card__meta-chip",children:e.matiere}),t.jsx("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:e.niveau}),e.trimestre&&t.jsxs("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:["T",e.trimestre]})]}),e.description&&t.jsx("p",{className:"sequence-card__desc",children:e.description}),t.jsxs("div",{className:"sequence-card__footer",children:[t.jsxs("span",{className:"sequence-card__seances-count",children:[" ",e.seances.length," sance",e.seances.length>1?"s":"",o>0&&`   ${o} val.`]}),e.groupeClasseNom&&t.jsxs("span",{className:"sequence-card__groupe",children:[" ",e.groupeClasseNom]})]}),t.jsxs("div",{className:"sequence-card__actions",onClick:u=>u.stopPropagation(),children:[t.jsx("button",{className:"sequence-card__action-btn",onClick:n,title:"Modifier","aria-label":"Modifier la squence",children:""}),t.jsx("button",{className:"sequence-card__action-btn",onClick:a,title:"Dupliquer","aria-label":"Dupliquer la squence",children:""}),t.jsx("button",{className:"sequence-card__action-btn sequence-card__action-btn--danger",onClick:l,title:"Supprimer","aria-label":"Supprimer la squence",children:""})]})]})},Nee=()=>{const e=tt(),{currentUser:r}=Xe(),{matieres:n}=_n(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,m]=g.useState(null),[p,h]=g.useState(null),[v,b]=g.useState({matiere:"",niveau:"",statut:"",recherche:""}),x=g.useCallback(async()=>{if(r?.uid){u(!0),m(null);try{const S=await fee(r.uid);l(S)}catch(S){console.error("[SequencesPage] Chargement:",S),m("Impossible de charger vos squences. Vrifiez votre connexion.")}finally{u(!1)}}},[r?.uid]);if(g.useEffect(()=>{x()},[x]),!r?.isPremium&&r?.role!=="admin")return t.jsxs("div",{className:"premium-gate",children:[t.jsx("span",{className:"premium-gate__icon",children:""}),t.jsx("h2",{className:"premium-gate__title",children:"Fonctionnalit Premium"}),t.jsx("p",{className:"premium-gate__text",children:"Le Gnrateur de Squences Pdagogiques est rserv aux enseignants Premium. Passez  Premium pour crer des squences structures et les exporter vers votre Cahier de Textes."}),t.jsx("button",{className:"btn-primary",onClick:()=>e("/prof/premium"),children:" Passer  Premium  2 000 FCFA/mois"})]});const j=bee(a,v),_=n.length>0?n.map(S=>S.valeur):[...new Set(a.map(S=>S.matiere))].sort(),w=async S=>{if(window.confirm(`Supprimer la squence "${S.titre}" ?

Cette action est irrversible.`)){h(S.id);try{await qM(S.id),l(z=>z.filter(k=>k.id!==S.id))}catch(z){console.error("[SequencesPage] Suppression:",z),m("Erreur lors de la suppression. Ressayez.")}finally{h(null)}}},C=async S=>{if(r?.uid){h(S.id);try{const A=await gee(S.id,r.uid);e(`/prof/sequences/${A}/modifier`)}catch(A){console.error("[SequencesPage] Duplication:",A),m("Erreur lors de la duplication. Ressayez."),h(null)}}},E={total:a.length,active:a.filter(S=>S.statut==="active").length,terminee:a.filter(S=>S.statut==="terminee").length,ia:a.filter(S=>S.genereeParIA).length};return t.jsxs("div",{className:"sequences-page",children:[t.jsxs("div",{className:"sequences-page__header",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"sequences-page__title",children:" Squences Pdagogiques"}),t.jsxs("p",{className:"sequences-page__subtitle",children:[E.total," squence",E.total>1?"s":"",E.active>0&&`  ${E.active} en cours`,E.ia>0&&`  ${E.ia} assiste${E.ia>1?"s":""} par IA`]})]}),t.jsx("button",{className:"sequences-page__btn-new",onClick:()=>e("/prof/sequences/nouvelle"),children:"+ Nouvelle squence"})]}),d&&t.jsxs("div",{className:"error-banner",role:"alert",children:[" ",d,t.jsx("button",{onClick:x,style:{marginLeft:"auto",background:"none",border:"none",cursor:"pointer",color:"#dc2626",fontWeight:600},children:"Ressayer"})]}),t.jsxs("div",{className:"sequences-filters",role:"search",children:[t.jsx("input",{type:"search",className:"sequences-filters__search",placeholder:" Rechercher une squence...",value:v.recherche??"",onChange:S=>b(A=>({...A,recherche:S.target.value})),"aria-label":"Rechercher une squence"}),t.jsxs("select",{className:"sequences-filters__select",value:v.matiere??"",onChange:S=>b(A=>({...A,matiere:S.target.value})),"aria-label":"Filtrer par matire",children:[t.jsx("option",{value:"",children:"Toutes les matires"}),_.map(S=>t.jsx("option",{value:S,children:S},S))]}),t.jsxs("select",{className:"sequences-filters__select",value:v.niveau??"",onChange:S=>b(A=>({...A,niveau:S.target.value})),"aria-label":"Filtrer par niveau",children:[t.jsx("option",{value:"",children:"Tous les niveaux"}),yr.map(S=>t.jsx("option",{value:S,children:S},S))]}),t.jsxs("select",{className:"sequences-filters__select",value:v.statut??"",onChange:S=>b(A=>({...A,statut:S.target.value})),"aria-label":"Filtrer par statut",children:[t.jsx("option",{value:"",children:"Tous les statuts"}),Object.entries(zp).map(([S,{label:A}])=>t.jsx("option",{value:S,children:A},S))]})]}),o?t.jsx("div",{className:"sequences-grid",children:[1,2,3].map(S=>t.jsxs("div",{className:"sequence-card",style:{minHeight:180},children:[t.jsx("div",{className:"skeleton",style:{height:20,width:"40%",marginBottom:10}}),t.jsx("div",{className:"skeleton",style:{height:22,width:"80%",marginBottom:8}}),t.jsx("div",{className:"skeleton",style:{height:14,width:"60%"}})]},S))}):t.jsx("div",{className:"sequences-grid",role:"list",children:j.length===0?t.jsxs("div",{className:"sequences-empty",children:[t.jsx("span",{className:"sequences-empty__icon",children:""}),t.jsx("p",{className:"sequences-empty__text",children:a.length===0?"Aucune squence pour l'instant":"Aucune squence ne correspond  vos filtres"}),t.jsx("p",{className:"sequences-empty__hint",children:a.length===0?'Cliquez sur "+ Nouvelle squence" pour commencer':"Modifiez ou effacez les filtres pour voir plus de rsultats"})]}):j.map(S=>t.jsx("div",{role:"listitem",style:{opacity:p===S.id?.6:1},children:t.jsx(_ee,{sequence:S,onView:()=>e(`/prof/sequences/${S.id}`),onEdit:()=>e(`/prof/sequences/${S.id}/modifier`),onDuplicate:()=>C(S),onDelete:()=>w(S)})},S.id))})]})},Ub="usageRessourcesTotal";async function See(e){try{const r=await pt(je(V,"users",e));return r.exists()?r.data()[Ub]??0:0}catch{return 0}}async function Rj(e){const r=je(V,"users",e),a=(await pt(r)).data()?.[Ub]??0;await Ve(r,{[Ub]:a+1,updatedAt:kt()})}async function Cf(e,r){const n=await See(e),a=F5(r);return{autorise:a===null||n<a,usage:n,limite:a}}const wee="https://votre-app.railway.app",Cee=["cours","td","tp","evaluation","revision","projet","correction"],Eee=["formative","sommative","diagnostique","devoir","composition","interrogation"];function Aee(e){return Cee.includes(e)?e:"cours"}function zee(e){if(e)return Eee.includes(e)?e:"formative"}function kee(e){if(!e||typeof e!="object")throw new Error("Rponse IA invalide : non-objet");if(!Array.isArray(e.seances)||e.seances.length===0)throw new Error("Rponse IA invalide : tableau seances absent ou vide");const r=e.seances.map((n,a)=>({numero:Number(n.numero)||a+1,titre:String(n.titre??`Sance ${a+1}`),dureeMinutes:Number(n.dureeMinutes)||55,objectifSpecifique:String(n.objectifSpecifique??""),contenu:String(n.contenu??""),ressources:Array.isArray(n.ressources)?n.ressources.map(String):[],typeActivite:Aee(String(n.typeActivite??"cours")),estEvaluation:!!n.estEvaluation,typeEvaluation:zee(n.typeEvaluation),noteMax:typeof n.noteMax=="number"?n.noteMax:void 0,coefficient:typeof n.coefficient=="number"?n.coefficient:void 0}));return{titre:String(e.titre??""),description:String(e.description??""),objectifGeneral:String(e.objectifGeneral??""),prerequis:String(e.prerequis??""),competences:Array.isArray(e.competences)?e.competences.map(String):[],seances:r}}function Oee(){return`Tu es un expert en ingnierie pdagogique pour le systme ducatif sngalais 
(programme du Ministre de l'ducation Nationale du Sngal).

Tu gnres des squences pdagogiques structures pour des professeurs du secondaire 
(collges et lyces sngalais, niveaux 6me  Terminale).

RPONDRE UNIQUEMENT EN JSON valide. Aucun texte avant ou aprs le JSON.
Aucune balise markdown, aucun \`\`\`json.

Structure JSON attendue :
{
  "titre": "string",
  "description": "string (2-3 phrases contextuelles)",
  "objectifGeneral": "string (formulation en termes de comptences, verbes d'action)",
  "prerequis": "string (connaissances ncessaires avant cette squence)",
  "competences": ["string", "string", ...],
  "seances": [
    {
      "numero": 1,
      "titre": "string",
      "dureeMinutes": 55,
      "objectifSpecifique": "string (verbe d'action + contenu)",
      "contenu": "string (droulement dtaill de la sance)",
      "ressources": ["string", ...],
      "typeActivite": "cours|td|tp|evaluation|revision|projet|correction",
      "estEvaluation": false,
      "typeEvaluation": null,
      "noteMax": null,
      "coefficient": null
    }
  ]
}

Rgles :
- Respecte les programmes officiels sngalais
- Les trimestres au Sngal : 1er (Oct-Dc), 2me (Jan-Mars), 3me (Avr-Juin)
- Inclure des sances de rvision avant les valuations
- Pour les valuations (estEvaluation=true), prciser typeEvaluation
- Les contenus doivent tre adapts aux ralits sngalaises (exemples locaux)
- Note maximale habituelle : 20 (systme franais)
- Niveaux  fort enjeu : 3me (BFEM), Terminale (BAC)
- Langue : franais`}async function Dee(e){const r=`
Gnre une squence pdagogique complte pour :
- Matire : ${e.matiere}
- Niveau : ${e.niveau}
- Thme/Chapitre : ${e.theme}
- Nombre de sances : ${e.nombreSeances}
- Dure par sance : ${e.dureeSeanceMinutes} minutes
${e.trimestre?`- Trimestre : ${e.trimestre}me trimestre`:""}
${e.instructionsSupplementaires?`- Instructions supplmentaires : ${e.instructionsSupplementaires}`:""}

Distribue intelligemment les sances : cours  TD/TP  rvision  valuation.
Assure-toi que les objectifs spcifiques sont progressifs et mesurables.
  `.trim();let n;try{n=await fetch(`${wee}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({systemPrompt:Oee(),userPrompt:r,maxTokens:4e3})})}catch{throw new Error("Impossible de contacter le serveur IA. Vrifiez votre connexion Internet.")}if(!n.ok){const d=await n.text().catch(()=>"Erreur inconnue");throw new Error(`Erreur serveur IA (${n.status}) : ${d}`)}const a=await n.json(),l=a.content??a.result??a.text??"";if(!l)throw new Error("Rponse IA vide  le serveur a renvoy un contenu vide.");const o=l.replace(/^```json\s*/i,"").replace(/^```\s*/,"").replace(/```\s*$/,"").trim();let u;try{u=JSON.parse(o)}catch{throw new Error(`Rponse IA non parsable : ${o.substring(0,200)}...`)}return kee(u)}function RM(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function Pee(e){return{id:RM(),numero:e,titre:"",dureeMinutes:55,objectifSpecifique:"",contenu:"",ressources:[],typeActivite:"cours",estEvaluation:!1,exporterVersCahier:!0,entreesCahierIds:[]}}const Mee=({seance:e,onChange:r,onDelete:n,onMoveUp:a,onMoveDown:l,isFirst:o,isLast:u})=>{const[d,m]=g.useState(e.titre===""),[p,h]=g.useState(""),v=j=>r({...e,...j}),b=()=>{const j=p.trim();j&&(v({ressources:[...e.ressources,j]}),h(""))},x=j=>v({ressources:e.ressources.filter((_,w)=>w!==j)});return t.jsxs("div",{className:"seance-card",children:[t.jsxs("div",{className:"seance-card__header",onClick:()=>m(j=>!j),children:[t.jsx("div",{className:`seance-card__numero${e.estEvaluation?" seance-card__numero--eval":""}`,children:e.numero}),t.jsx("span",{className:"seance-card__header-title",children:e.titre||`Sance ${e.numero} (sans titre)`}),t.jsxs("div",{className:"seance-card__header-badges",children:[t.jsx("span",{className:`type-activite-badge type-activite-badge--${e.typeActivite}`,children:Sf[e.typeActivite]}),t.jsxs("span",{style:{fontSize:"0.75rem",color:"#64748b"},children:[e.dureeMinutes,"min"]})]}),t.jsx("span",{className:`seance-card__toggle-icon${d?" seance-card__toggle-icon--open":""}`,children:""})]}),d&&t.jsxs("div",{className:"seance-card__body",children:[t.jsxs("div",{className:"editor-form-grid",children:[t.jsxs("div",{className:"form-group editor-form-grid--full",children:[t.jsxs("label",{children:["Titre de la sance ",t.jsx("span",{className:"required",children:"*"})]}),t.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Introduction aux vecteurs",value:e.titre,onChange:j=>v({titre:j.target.value})})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Type d'activit"}),t.jsx("select",{className:"form-control",value:e.typeActivite,onChange:j=>v({typeActivite:j.target.value,estEvaluation:j.target.value==="evaluation"?!0:e.estEvaluation}),children:Object.entries(Sf).map(([j,_])=>t.jsx("option",{value:j,children:_},j))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Dure (minutes)"}),t.jsxs("select",{className:"form-control",value:e.dureeMinutes,onChange:j=>v({dureeMinutes:Number(j.target.value)}),children:[wf.map(j=>t.jsxs("option",{value:j,children:[j," min"]},j)),t.jsx("option",{value:e.dureeMinutes,children:wf.includes(e.dureeMinutes)?null:`${e.dureeMinutes} min (personnalis)`})]})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Objectif spcifique"}),t.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Ex : L'lve sera capable de calculer le module d'un vecteur",value:e.objectifSpecifique,onChange:j=>v({objectifSpecifique:j.target.value}),rows:2})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Contenu / Droulement"}),t.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Dcrivez le droulement de la sance : activits, tapes, mthodes...",value:e.contenu,onChange:j=>v({contenu:j.target.value}),rows:4})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Supports / Ressources"}),e.ressources.length>0&&t.jsx("div",{className:"timeline-card__ressources",style:{marginBottom:6},children:e.ressources.map((j,_)=>t.jsxs("span",{className:"ressource-chip",style:{cursor:"pointer"},onClick:()=>x(_),title:"Cliquer pour supprimer",children:[j," "]},_))}),t.jsxs("div",{className:"competence-input-row",children:[t.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Manuel p.42, GeoGebra, Calculatrice...",value:p,onChange:j=>h(j.target.value),onKeyDown:j=>j.key==="Enter"&&(j.preventDefault(),b())}),t.jsx("button",{type:"button",className:"btn-add-competence",onClick:b,children:"+ Ajouter"})]})]}),t.jsx("div",{className:"form-group",children:t.jsxs("label",{style:{flexDirection:"row",alignItems:"center",display:"flex",gap:8},children:[t.jsx("input",{type:"checkbox",checked:e.estEvaluation,onChange:j=>v({estEvaluation:j.target.checked,typeEvaluation:j.target.checked?e.typeEvaluation??"formative":void 0}),style:{width:16,height:16,accentColor:"#2563eb"}}),"Cette sance est une valuation"]})}),e.estEvaluation&&t.jsxs("div",{className:"editor-form-grid",style:{background:"#fef2f2",padding:12,borderRadius:8,border:"1px solid #fecaca"},children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Type d'valuation"}),t.jsx("select",{className:"form-control",value:e.typeEvaluation??"formative",onChange:j=>v({typeEvaluation:j.target.value}),children:Object.entries(qj).map(([j,_])=>t.jsx("option",{value:j,children:_},j))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Note maximale"}),t.jsx("input",{type:"number",className:"form-control",min:1,max:100,value:e.noteMax??20,onChange:j=>v({noteMax:Number(j.target.value)})})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Coefficient"}),t.jsx("input",{type:"number",className:"form-control",min:1,max:10,step:.5,value:e.coefficient??1,onChange:j=>v({coefficient:Number(j.target.value)})})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{style:{flexDirection:"row",alignItems:"center",display:"flex",gap:8},children:[t.jsx("input",{type:"checkbox",checked:e.exporterVersCahier,onChange:j=>v({exporterVersCahier:j.target.checked}),style:{width:16,height:16,accentColor:"#2563eb"}}),"Inclure dans l'export vers le Cahier de Textes"]}),e.entreesCahierIds&&e.entreesCahierIds.length>0&&t.jsxs("span",{className:"export-seance-row__exported",style:{marginTop:4},children:[" Dj exporte (",e.entreesCahierIds.length," entre",e.entreesCahierIds.length>1?"s":"",")"]})]}),t.jsxs("div",{className:"seance-card__actions",children:[t.jsx("button",{type:"button",className:"btn-seance-action btn-secondary",onClick:a,disabled:o,title:"Monter",children:""}),t.jsx("button",{type:"button",className:"btn-seance-action btn-secondary",onClick:l,disabled:u,title:"Descendre",children:""}),t.jsx("button",{type:"button",className:"btn-seance-action btn-seance-action--delete",onClick:n,children:" Supprimer cette sance"})]})]})]})},Tee=({onSequenceGeneree:e,defaultMatiere:r,defaultNiveau:n,matieres:a})=>{const[l,o]=g.useState(r??""),[u,d]=g.useState(n??""),[m,p]=g.useState(""),[h,v]=g.useState(8),[b,x]=g.useState(55),[j,_]=g.useState(1),[w,C]=g.useState(""),[E,S]=g.useState(!1),[A,z]=g.useState({type:"idle",message:""}),k=async()=>{if(!l||!u||!m){z({type:"error",message:"Veuillez remplir la matire, le niveau et le thme."});return}S(!0),z({type:"loading",message:"L'IA gnre votre squence... (30-45 secondes)"});try{const P=await Dee({matiere:l,niveau:u,theme:m,nombreSeances:h,dureeSeanceMinutes:b,trimestre:j,instructionsSupplementaires:w||void 0}),D=P.seances.map($=>({...$,ressources:$.ressources??[]}));e({titre:P.titre,description:P.description,objectifGeneral:P.objectifGeneral,prerequis:P.prerequis,competences:P.competences,seances:D}),z({type:"success",message:` Squence gnre avec ${D.length} sances ! Vrifiez et compltez les informations.`})}catch(P){const D=P instanceof Error?P.message:"Erreur inconnue";z({type:"error",message:`Erreur IA : ${D}`})}finally{S(!1)}};return t.jsxs("div",{className:"ia-panel",children:[t.jsx("h3",{className:"ia-panel__title",children:" Gnration assiste par IA"}),t.jsx("p",{className:"ia-panel__subtitle",children:"Dcrivez votre squence et Claude gnre la structure complte"}),t.jsxs("div",{className:"ia-panel__form-grid",children:[t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{children:["Matire ",t.jsx("span",{className:"required",children:"*"})]}),t.jsxs("select",{className:"form-control",value:l,onChange:P=>o(P.target.value),children:[t.jsx("option",{value:"",children:"Slectionner..."}),a.map(P=>t.jsx("option",{value:P,children:P},P))]})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{children:["Niveau ",t.jsx("span",{className:"required",children:"*"})]}),t.jsxs("select",{className:"form-control",value:u,onChange:P=>d(P.target.value),children:[t.jsx("option",{value:"",children:"Slectionner..."}),yr.map(P=>t.jsx("option",{value:P,children:P},P))]})]}),t.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[t.jsxs("label",{children:["Thme / Chapitre ",t.jsx("span",{className:"required",children:"*"})]}),t.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Les fonctions affines, La photosynthse, La Rvolution franaise...",value:m,onChange:P=>p(P.target.value)})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Nombre de sances"}),t.jsx("input",{type:"number",className:"form-control",min:2,max:25,value:h,onChange:P=>v(Number(P.target.value))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Dure par sance"}),t.jsx("select",{className:"form-control",value:b,onChange:P=>x(Number(P.target.value)),children:wf.map(P=>t.jsxs("option",{value:P,children:[P," min"]},P))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Trimestre"}),t.jsxs("select",{className:"form-control",value:j,onChange:P=>_(Number(P.target.value)),children:[t.jsx("option",{value:1,children:"1er trimestre (OctDc)"}),t.jsx("option",{value:2,children:"2me trimestre (JanMars)"}),t.jsx("option",{value:3,children:"3me trimestre (AvrJuin)"})]})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Instructions supplmentaires (optionnel)"}),t.jsx("textarea",{className:"ia-panel__instructions",placeholder:"Ex : Insister sur la rsolution graphique, Inclure un TP sur GeoGebra, Prvoir une sance de remdiation...",value:w,onChange:P=>C(P.target.value),rows:2})]}),t.jsxs("button",{type:"button",className:"ia-panel__btn-generate",onClick:k,disabled:E,children:[E?t.jsx("span",{className:"spinner"}):"",E?"Gnration en cours...":"Gnrer avec l'IA"]}),A.type!=="idle"&&t.jsxs("div",{className:`ia-panel__status ia-panel__status--${A.type}`,children:[A.type==="loading"&&t.jsx("span",{className:"spinner spinner--blue"}),A.message]})]})},hA=()=>{const e=tt(),{id:r}=jn(),{currentUser:n}=Xe(),{matieres:a}=_n(),l=!!r,[o,u]=g.useState({titre:"",description:"",niveau:"",matiere:"",theme:"",competences:[],objectifGeneral:"",prerequis:"",nombreSeances:6,dureeSeanceMinutes:55,seances:[],evaluationsPrevues:[],statut:"brouillon",genereeParIA:!1,trimestre:void 0,groupeClasseId:void 0,groupeClasseNom:void 0,cahierDeTextesId:void 0,cahierDeTextesNom:void 0}),[d,m]=g.useState([]),[p,h]=g.useState([]),[v,b]=g.useState([]),[x,j]=g.useState(l),[_,w]=g.useState(!1),[C,E]=g.useState(null),[S,A]=g.useState(null),[z,k]=g.useState(""),[P,D]=g.useState(!l);g.useEffect(()=>{(async()=>{if(!n?.uid)return;const[B,T]=await Promise.all([wM(n.uid).catch(()=>[]),zM(n.uid).catch(()=>[])]);if(h(B),b(T),l&&r){j(!0);try{const Z=await cu(r);if(!Z){E("Squence introuvable.");return}if(Z.profId!==n.uid){E("Accs non autoris.");return}u({titre:Z.titre,description:Z.description,niveau:Z.niveau,matiere:Z.matiere,theme:Z.theme,competences:Z.competences,objectifGeneral:Z.objectifGeneral,prerequis:Z.prerequis,nombreSeances:Z.nombreSeances,dureeSeanceMinutes:Z.dureeSeanceMinutes,statut:Z.statut,genereeParIA:Z.genereeParIA,trimestre:Z.trimestre,groupeClasseId:Z.groupeClasseId,groupeClasseNom:Z.groupeClasseNom,cahierDeTextesId:Z.cahierDeTextesId,cahierDeTextesNom:Z.cahierDeTextesNom}),m(Z.seances)}catch{E("Erreur de chargement. Ressayez.")}finally{j(!1)}}})()},[n?.uid,r,l]);const $=()=>{m(U=>[...U,Pee(U.length+1)])},F=(U,B)=>{m(T=>T.map((Z,H)=>H===U?B:Z))},Y=U=>{m(B=>B.filter((T,Z)=>Z!==U).map((T,Z)=>({...T,numero:Z+1})))},M=U=>{U!==0&&m(B=>{const T=[...B];return[T[U-1],T[U]]=[T[U],T[U-1]],T.map((Z,H)=>({...Z,numero:H+1}))})},K=U=>{m(B=>{if(U===B.length-1)return B;const T=[...B];return[T[U],T[U+1]]=[T[U+1],T[U]],T.map((Z,H)=>({...Z,numero:H+1}))})},ee=()=>{const U=z.trim();U&&(u(B=>({...B,competences:[...B.competences??[],U]})),k(""))},X=U=>{u(B=>({...B,competences:(B.competences??[]).filter((T,Z)=>Z!==U)}))},L=U=>{u(T=>({...T,titre:U.titre,description:U.description,objectifGeneral:U.objectifGeneral,prerequis:U.prerequis,competences:U.competences,genereeParIA:!0}));const B=U.seances.map(T=>({...T,id:RM(),exporterVersCahier:!0,entreesCahierIds:[]}));m(B),D(!1),window.scrollTo({top:0,behavior:"smooth"})},I=async()=>{if(!n?.uid)return;if(!o.titre?.trim()){E("Le titre est obligatoire.");return}if(!o.matiere?.trim()){E("La matire est obligatoire.");return}if(!o.niveau?.trim()){E("Le niveau est obligatoire.");return}const U=d.find(H=>!H.titre.trim());if(U){E(`La sance n${U.numero} n'a pas de titre.`);return}w(!0),E(null);const B=v.find(H=>H.id===o.groupeClasseId),T=p.find(H=>H.id===o.cahierDeTextesId),Z={titre:o.titre.trim(),description:o.description?.trim()??"",niveau:o.niveau,matiere:o.matiere.trim(),theme:o.theme?.trim()??"",competences:o.competences??[],objectifGeneral:o.objectifGeneral?.trim()??"",prerequis:o.prerequis?.trim()??"",nombreSeances:d.length,dureeSeanceMinutes:o.dureeSeanceMinutes??55,statut:o.statut??"brouillon",genereeParIA:o.genereeParIA??!1,trimestre:o.trimestre??null,seances:d,evaluationsPrevues:[],groupeClasseId:o.groupeClasseId||null,groupeClasseNom:B?.nom||o.groupeClasseNom||null,cahierDeTextesId:o.cahierDeTextesId||null,cahierDeTextesNom:T?.titre||o.cahierDeTextesNom||null};try{if(l&&r)await hee(r,Z),A("Squence mise  jour avec succs !"),setTimeout(()=>e(`/prof/sequences/${r}`),1200);else{const{autorise:H,usage:ce,limite:xe}=await Cf(n.uid,n.subscriptionPlan);if(!H&&xe!==null){E(`Limite de ${xe} ressources atteinte (${ce}/${xe}). Passez  Premium Pro pour un accs illimit.`),w(!1);return}const fe=await pee(n.uid,Z);await Rj(n.uid),A("Squence cre avec succs !"),setTimeout(()=>e(`/prof/sequences/${fe}`),1200)}}catch(H){console.error("[SequenceEditorPage] Sauvegarde:",H),E("Erreur lors de la sauvegarde. Ressayez.")}finally{w(!1)}};return x?t.jsxs("div",{className:"sequence-editor",children:[t.jsx("div",{className:"skeleton",style:{height:30,width:"50%",marginBottom:20}}),t.jsx("div",{className:"skeleton",style:{height:200,borderRadius:12}})]}):t.jsxs("div",{className:"sequence-editor",children:[t.jsxs("div",{className:"sequence-editor__header",children:[t.jsxs("p",{className:"sequence-editor__breadcrumb",children:[t.jsx("a",{onClick:()=>e("/prof/sequences"),style:{cursor:"pointer"},children:" Squences"})," / ",l?"Modifier":"Nouvelle squence"]}),t.jsx("h1",{className:"sequence-editor__title",children:l?" Modifier la squence":" Nouvelle squence"})]}),C&&t.jsxs("div",{className:"error-banner",role:"alert",children:[" ",C]}),S&&t.jsxs("div",{className:"success-banner",role:"status",children:[" ",S]}),t.jsx("div",{style:{marginBottom:8},children:t.jsx("button",{type:"button",className:"btn-secondary",style:{marginBottom:12},onClick:()=>D(U=>!U),children:P?" Masquer":" Gnrer avec l'IA"})}),P&&t.jsx(Tee,{onSequenceGeneree:L,defaultMatiere:o.matiere,defaultNiveau:o.niveau,matieres:a.map(U=>U.valeur)}),t.jsxs("section",{className:"editor-section",children:[t.jsx("h2",{className:"editor-section__title",children:" Informations gnrales"}),t.jsxs("div",{className:"editor-form-grid",children:[t.jsxs("div",{className:"form-group editor-form-grid--full",children:[t.jsxs("label",{children:["Titre de la squence ",t.jsx("span",{className:"required",children:"*"})]}),t.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Les fonctions affines  Terminale S",value:o.titre??"",onChange:U=>u(B=>({...B,titre:U.target.value})),required:!0})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{children:["Matire ",t.jsx("span",{className:"required",children:"*"})]}),t.jsxs("select",{className:"form-control",value:o.matiere??"",onChange:U=>u(B=>({...B,matiere:U.target.value})),children:[t.jsx("option",{value:"",children:"Slectionner..."}),a.map(U=>t.jsx("option",{value:U.valeur,children:U.label},U.valeur))]})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{children:["Niveau ",t.jsx("span",{className:"required",children:"*"})]}),t.jsxs("select",{className:"form-control",value:o.niveau??"",onChange:U=>u(B=>({...B,niveau:U.target.value})),children:[t.jsx("option",{value:"",children:"Slectionner..."}),yr.map(U=>t.jsx("option",{value:U,children:U},U))]})]}),t.jsxs("div",{className:"form-group editor-form-grid--full",children:[t.jsx("label",{children:"Thme / Chapitre du programme"}),t.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Chapitre 4  Les vecteurs du plan",value:o.theme??"",onChange:U=>u(B=>({...B,theme:U.target.value}))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Trimestre"}),t.jsxs("select",{className:"form-control",value:o.trimestre??"",onChange:U=>u(B=>({...B,trimestre:U.target.value?Number(U.target.value):void 0})),children:[t.jsx("option",{value:"",children:"Non prcis"}),t.jsx("option",{value:"1",children:"1er trimestre (OctDc)"}),t.jsx("option",{value:"2",children:"2me trimestre (JanMars)"}),t.jsx("option",{value:"3",children:"3me trimestre (AvrJuin)"})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Dure standard d'une sance"}),t.jsx("select",{className:"form-control",value:o.dureeSeanceMinutes??55,onChange:U=>u(B=>({...B,dureeSeanceMinutes:Number(U.target.value)})),children:wf.map(U=>t.jsxs("option",{value:U,children:[U," minutes"]},U))})]}),t.jsxs("div",{className:"form-group editor-form-grid--full",children:[t.jsx("label",{children:"Description / Contexte"}),t.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Contexte de la squence dans le programme, niveau de la classe, prrequis globaux...",value:o.description??"",onChange:U=>u(B=>({...B,description:U.target.value})),rows:3})]}),t.jsxs("div",{className:"form-group editor-form-grid--full",children:[t.jsx("label",{children:"Objectif gnral"}),t.jsx("textarea",{className:"form-control form-control--textarea",placeholder:" la fin de cette squence, les lves seront capables de...",value:o.objectifGeneral??"",onChange:U=>u(B=>({...B,objectifGeneral:U.target.value})),rows:2})]}),t.jsxs("div",{className:"form-group editor-form-grid--full",children:[t.jsx("label",{children:"Prrequis"}),t.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Connaissances ncessaires avant cette squence...",value:o.prerequis??"",onChange:U=>u(B=>({...B,prerequis:U.target.value})),rows:2})]})]}),t.jsxs("div",{className:"form-group",style:{marginTop:14},children:[t.jsx("label",{children:"Comptences vises"}),t.jsx("div",{className:"competences-list",children:(o.competences??[]).map((U,B)=>t.jsxs("span",{className:"competence-tag",children:[U,t.jsx("button",{type:"button",className:"competence-tag__remove",onClick:()=>X(B),"aria-label":"Supprimer la comptence",children:""})]},B))}),t.jsxs("div",{className:"competence-input-row",children:[t.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Rsoudre une quation du second degr",value:z,onChange:U=>k(U.target.value),onKeyDown:U=>U.key==="Enter"&&(U.preventDefault(),ee())}),t.jsx("button",{type:"button",className:"btn-add-competence",onClick:ee,children:"+ Ajouter"})]})]})]}),t.jsxs("section",{className:"editor-section",children:[t.jsx("h2",{className:"editor-section__title",children:" Liens optionnels"}),t.jsxs("div",{className:"editor-form-grid",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Groupe-classe"}),t.jsxs("select",{className:"form-control",value:o.groupeClasseId??"",onChange:U=>u(B=>({...B,groupeClasseId:U.target.value||void 0})),children:[t.jsx("option",{value:"",children:"Aucun groupe"}),v.map(U=>t.jsxs("option",{value:U.id,children:[U.nom,"  ",U.classe]},U.id))]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Cahier de Textes"}),t.jsxs("select",{className:"form-control",value:o.cahierDeTextesId??"",onChange:U=>u(B=>({...B,cahierDeTextesId:U.target.value||void 0})),children:[t.jsx("option",{value:"",children:" Aucun cahier "}),p.filter(U=>o.matiere&&o.niveau?U.matiere===o.matiere&&U.classe===o.niveau:o.matiere?U.matiere===o.matiere:o.niveau?U.classe===o.niveau:!0).map(U=>t.jsxs("option",{value:U.id,children:[U.titre,"  ",U.classe,"  ",U.anneeScolaire]},U.id))]}),o.niveau&&o.matiere&&p.filter(U=>U.classe===o.niveau&&U.matiere===o.matiere).length===0&&t.jsxs("p",{style:{fontSize:"0.8rem",color:"#f59e0b",marginTop:6},children:[" Aucun cahier pour ",o.matiere,"  ",o.niveau,"."," ",t.jsx("a",{href:"/prof/cahiers",style:{color:"#2563eb",textDecoration:"underline"},children:"Crer un cahier"})]}),(!o.niveau||!o.matiere)&&p.length>0&&t.jsx("p",{style:{fontSize:"0.8rem",color:"#94a3b8",marginTop:6},children:" Slectionnez la matire et le niveau pour filtrer les cahiers."})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Statut"}),t.jsxs("select",{className:"form-control",value:o.statut??"brouillon",onChange:U=>u(B=>({...B,statut:U.target.value})),children:[t.jsx("option",{value:"brouillon",children:"Brouillon"}),t.jsx("option",{value:"active",children:"En cours"}),t.jsx("option",{value:"terminee",children:"Termine"}),t.jsx("option",{value:"archivee",children:"Archive"})]})]})]})]}),t.jsxs("section",{className:"editor-section",children:[t.jsxs("div",{className:"seances-editor__header",children:[t.jsx("h2",{className:"editor-section__title",style:{margin:0},children:" Sances"}),t.jsxs("span",{className:"seances-editor__count",children:[d.length," sance",d.length>1?"s":"",d.filter(U=>U.estEvaluation).length>0&&`  ${d.filter(U=>U.estEvaluation).length} val.`]})]}),t.jsx("div",{className:"seances-list",children:d.length===0?t.jsx("p",{style:{color:"#94a3b8",fontSize:"0.875rem",textAlign:"center",padding:"20px 0"},children:"Aucune sance. Utilisez le bouton ci-dessous ou gnrez avec l'IA."}):d.map((U,B)=>t.jsx(Mee,{seance:U,onChange:T=>F(B,T),onDelete:()=>Y(B),onMoveUp:()=>M(B),onMoveDown:()=>K(B),isFirst:B===0,isLast:B===d.length-1},U.id))}),t.jsx("button",{type:"button",className:"btn-add-seance",style:{marginTop:14},onClick:$,children:"+ Ajouter une sance"})]}),t.jsxs("div",{style:{position:"sticky",bottom:16,display:"flex",justifyContent:"flex-end",gap:10,background:"rgba(248,250,252,0.95)",backdropFilter:"blur(6px)",padding:"12px 0",zIndex:10},children:[t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>e("/prof/sequences"),disabled:_,children:"Annuler"}),t.jsx("button",{type:"button",className:"btn-primary",onClick:I,disabled:_,children:_?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner"})," Enregistrement..."]}):l?" Mettre  jour":" Crer la squence"})]})]})},qee=({statut:e})=>{const{label:r}=zp[e];return t.jsxs("span",{className:`statut-badge statut-badge--${e}`,children:[t.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:"currentColor",display:"inline-block"}}),r]})},Ree=({sequence:e,cahiers:r,profId:n,onClose:a,onSuccess:l})=>{const[o,u]=g.useState(e.cahierDeTextesId??(r.length===1?r[0].id:"")),[d,m]=g.useState(()=>{const C=new Date().toISOString().split("T")[0],E={};return e.seances.forEach(S=>{E[S.id]=C}),E}),[p,h]=g.useState(()=>{const C={};return e.seances.forEach(E=>{C[E.id]=E.exporterVersCahier&&(!E.entreesCahierIds||E.entreesCahierIds.length===0)}),C}),[v,b]=g.useState(!1),[x,j]=g.useState(null),_=Object.values(p).filter(Boolean).length,w=async()=>{if(!o){j("Veuillez slectionner un Cahier de Textes.");return}if(_===0){j("Slectionnez au moins une sance  exporter.");return}b(!0),j(null);const C={};e.seances.filter(E=>p[E.id]).forEach(E=>{const S=d[E.id];if(S){const A=Ee.fromDate(new Date(S+"T08:00:00"));C[E.id]=A}});try{const E=await xee({sequenceId:e.id,cahierDeTextesId:o,profId:n,datesParSeance:C});E.erreurs.length>0&&j(`${E.erreurs.length} sance(s) n'ont pas pu tre exportes.`),l(E.nbExportees)}catch(E){const S=E instanceof Error?E.message:"Erreur inconnue";j(`Erreur d'export : ${S}`)}finally{b(!1)}};return g.useEffect(()=>{const C=E=>{E.key==="Escape"&&a()};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[a]),t.jsx("div",{className:"export-modal__overlay",onClick:C=>C.target===C.currentTarget&&a(),children:t.jsxs("div",{className:"export-modal",role:"dialog","aria-modal":"true","aria-labelledby":"export-modal-title",children:[t.jsxs("div",{className:"export-modal__header",children:[t.jsx("h2",{className:"export-modal__title",id:"export-modal-title",children:" Exporter vers le Cahier de Textes"}),t.jsx("button",{className:"export-modal__close",onClick:a,"aria-label":"Fermer",children:""})]}),t.jsxs("div",{className:"export-modal__body",children:[t.jsxs("div",{className:"form-group",style:{marginBottom:16},children:[t.jsxs("label",{style:{fontWeight:600,marginBottom:6,display:"block"},children:["Cahier de Textes cible ",t.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.length===0?t.jsx("p",{style:{color:"#dc2626",fontSize:"0.875rem"},children:"Aucun Cahier de Textes trouv. Crez-en un d'abord."}):t.jsxs("select",{className:"form-control",value:o,onChange:C=>u(C.target.value),children:[t.jsx("option",{value:"",children:"Slectionner un cahier..."}),r.map(C=>t.jsxs("option",{value:C.id,children:[C.titre,"  ",C.classe," (",C.anneeScolaire,")"]},C.id))]})]}),t.jsx("p",{style:{fontSize:"0.8125rem",color:"#64748b",marginBottom:12},children:"Slectionnez les sances  exporter et assignez leur une date. Chaque sance deviendra une entre dans le Cahier de Textes."}),e.seances.map(C=>{const E=(C.entreesCahierIds?.length??0)>0;return t.jsxs("div",{className:"export-seance-row",children:[t.jsx("input",{type:"checkbox",className:"export-seance-row__check",checked:!!p[C.id],onChange:S=>h(A=>({...A,[C.id]:S.target.checked})),id:`export-${C.id}`,"aria-label":`Exporter la sance ${C.numero}`}),t.jsxs("div",{className:"export-seance-row__info",children:[t.jsx("label",{htmlFor:`export-${C.id}`,style:{cursor:"pointer"},children:t.jsxs("div",{className:"export-seance-row__titre",children:[C.numero,". ",C.titre||`Sance ${C.numero}`]})}),t.jsxs("div",{className:"export-seance-row__type",children:[Sf[C.typeActivite],"  ",C.dureeMinutes,"min",E&&t.jsx("span",{className:"export-seance-row__exported",style:{marginLeft:6},children:" Dj exporte"})]})]}),t.jsx("input",{type:"date",className:"export-seance-row__date",value:d[C.id]??"",onChange:S=>m(A=>({...A,[C.id]:S.target.value})),disabled:!p[C.id],"aria-label":`Date pour la sance ${C.numero}`})]},C.id)}),x&&t.jsxs("div",{className:"error-banner",style:{marginTop:12},children:[" ",x]})]}),t.jsxs("div",{className:"export-modal__footer",children:[t.jsx("button",{type:"button",className:"btn-secondary",onClick:a,disabled:v,children:"Annuler"}),t.jsx("button",{type:"button",className:"btn-success",onClick:w,disabled:v||_===0||!o,children:v?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner"})," Export en cours..."]}):` Exporter ${_} sance${_>1?"s":""}`})]})]})})},Iee=()=>{const e=tt(),{id:r}=jn(),{currentUser:n}=Xe(),[a,l]=g.useState(null),[o,u]=g.useState([]),[d,m]=g.useState(!0),[p,h]=g.useState(null),[v,b]=g.useState(null),[x,j]=g.useState("seances"),[_,w]=g.useState(!1);g.useEffect(()=>{(async()=>{if(!(!n?.uid||!r)){m(!0);try{const[k,P]=await Promise.all([cu(r),wM(n.uid)]);if(!k){h("Squence introuvable.");return}if(k.profId!==n.uid){h("Accs non autoris.");return}l(k),u(P)}catch{h("Erreur de chargement.")}finally{m(!1)}}})()},[n?.uid,r]);const C=async()=>{if(!(!a||!window.confirm(`Supprimer "${a.titre}" ?
Cette action est irrversible.`)))try{await qM(a.id),e("/prof/sequences")}catch{h("Erreur lors de la suppression.")}},E=async z=>{if(a)try{await vee(a.id,z),l(k=>k?{...k,statut:z}:null)}catch{h("Erreur de mise  jour du statut.")}},S=z=>{w(!1),b(` ${z} sance${z>1?"s":""} exporte${z>1?"s":""} vers le Cahier de Textes !`),r&&cu(r).then(k=>k&&l(k)).catch(()=>null),setTimeout(()=>b(null),5e3)};if(d)return t.jsxs("div",{className:"sequence-detail",children:[t.jsx("div",{className:"skeleton",style:{height:28,width:"50%",marginBottom:20}}),t.jsx("div",{className:"skeleton",style:{height:180,borderRadius:12,marginBottom:20}}),t.jsx("div",{className:"skeleton",style:{height:400,borderRadius:12}})]});if(p||!a)return t.jsxs("div",{className:"sequence-detail",children:[t.jsxs("div",{className:"error-banner",children:[" ",p??"Squence introuvable."]}),t.jsx("button",{className:"btn-secondary",onClick:()=>e("/prof/sequences"),children:" Retour"})]});const A=yee.find(z=>z.valeur===a.niveau)?.label??a.niveau;return t.jsxs("div",{className:"sequence-detail",children:[_&&t.jsx(Ree,{sequence:a,cahiers:o,profId:n.uid,onClose:()=>w(!1),onSuccess:S}),p&&t.jsxs("div",{className:"error-banner",role:"alert",children:[" ",p]}),v&&t.jsx("div",{className:"success-banner",role:"status",children:v}),t.jsxs("div",{className:"sequence-detail__header",children:[t.jsxs("p",{style:{fontSize:"0.8125rem",color:"#64748b",marginBottom:8},children:[t.jsx("a",{onClick:()=>e("/prof/sequences"),style:{color:"#2563eb",cursor:"pointer",fontWeight:500},children:" Squences"})," / ",a.titre]}),t.jsxs("div",{className:"sequence-detail__header-top",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"sequence-detail__title",children:a.titre}),t.jsxs("div",{className:"sequence-detail__meta",style:{marginTop:8},children:[t.jsx(qee,{statut:a.statut}),a.genereeParIA&&t.jsx("span",{className:"badge-ia",children:" IA"}),t.jsx("span",{className:"sequence-card__meta-chip",children:a.matiere}),t.jsx("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:A}),a.trimestre&&t.jsxs("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:["T",a.trimestre]}),a.groupeClasseNom&&t.jsxs("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:[" ",a.groupeClasseNom]})]})]}),t.jsxs("div",{className:"sequence-detail__actions",children:[t.jsx("select",{className:"form-control",style:{width:"auto",fontSize:"0.8rem"},value:a.statut,onChange:z=>E(z.target.value),"aria-label":"Changer le statut",children:Object.entries(zp).map(([z,{label:k}])=>t.jsx("option",{value:z,children:k},z))}),t.jsx("button",{className:"btn-success",onClick:()=>w(!0),title:"Exporter les sances vers le Cahier de Textes",children:" Exporter"}),t.jsx("button",{className:"btn-secondary",onClick:()=>e(`/prof/sequences/${a.id}/modifier`),children:" Modifier"}),t.jsx("button",{className:"btn-danger",onClick:C,children:""})]})]}),a.objectifGeneral&&t.jsxs("div",{className:"sequence-detail__objectif",children:[t.jsx("strong",{children:" Objectif :"})," ",a.objectifGeneral]}),t.jsxs("div",{style:{display:"flex",gap:16,marginTop:12,flexWrap:"wrap",fontSize:"0.8125rem",color:"#64748b"},children:[t.jsxs("span",{children:[" ",a.seances.length," sances"]}),t.jsxs("span",{children:[" ",a.evaluationsPrevues.length," valuation",a.evaluationsPrevues.length>1?"s":""]}),t.jsxs("span",{children:[" ",a.seances.reduce((z,k)=>z+k.dureeMinutes,0)," min total"]}),a.cahierDeTextesNom&&t.jsxs("span",{children:[" ",a.cahierDeTextesNom]}),a.exporteAt&&t.jsxs("span",{children:[" Export le ",a.exporteAt.toDate().toLocaleDateString("fr-FR")]})]})]}),t.jsxs("div",{className:"sequence-tabs",role:"tablist",children:[t.jsxs("button",{role:"tab",className:`sequence-tab${x==="seances"?" sequence-tab--active":""}`,onClick:()=>j("seances"),"aria-selected":x==="seances",children:[" Sances (",a.seances.length,")"]}),t.jsxs("button",{role:"tab",className:`sequence-tab${x==="evaluations"?" sequence-tab--active":""}`,onClick:()=>j("evaluations"),"aria-selected":x==="evaluations",children:[" valuations (",a.evaluationsPrevues.length,")"]}),t.jsx("button",{role:"tab",className:`sequence-tab${x==="infos"?" sequence-tab--active":""}`,onClick:()=>j("infos"),"aria-selected":x==="infos",children:" Dtails"})]}),x==="seances"&&t.jsx("div",{role:"tabpanel",children:a.seances.length===0?t.jsxs("div",{className:"sequences-empty",children:[t.jsx("span",{className:"sequences-empty__icon",children:""}),t.jsx("p",{className:"sequences-empty__text",children:"Aucune sance planifie"}),t.jsx("button",{className:"btn-primary",onClick:()=>e(`/prof/sequences/${a.id}/modifier`),children:" Ajouter des sances"})]}):t.jsx("div",{className:"sequence-timeline",children:a.seances.map(z=>t.jsx(Lee,{seance:z},z.id))})}),x==="evaluations"&&t.jsxs("div",{role:"tabpanel",className:"evaluations-panel",children:[t.jsx("h3",{className:"evaluations-panel__title",children:" valuations prvues"}),a.evaluationsPrevues.length===0?t.jsx("p",{style:{color:"#94a3b8",fontSize:"0.875rem"},children:'Aucune valuation marque dans cette squence. Modifiez une sance et cochez "Cette sance est une valuation".'}):a.evaluationsPrevues.map(z=>t.jsxs("div",{className:"evaluation-row",children:[t.jsxs("div",{className:"evaluation-row__numero",children:["S",z.seanceNumero]}),t.jsxs("div",{className:"evaluation-row__info",children:[t.jsx("div",{className:"evaluation-row__titre",children:z.titre}),t.jsxs("div",{className:"evaluation-row__type",children:[qj[z.type],z.datePrevue&&`  ${z.datePrevue.toDate().toLocaleDateString("fr-FR")}`]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"evaluation-row__note",children:["/",z.noteMax]}),t.jsxs("div",{className:"evaluation-row__coeff",children:["Coeff. ",z.coefficient]})]})]},z.id))]}),x==="infos"&&t.jsx("div",{role:"tabpanel",children:t.jsxs("div",{className:"editor-section",children:[a.competences.length>0&&t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:700,color:"#374151",marginBottom:8},children:"Comptences vises"}),t.jsx("div",{className:"competences-list",children:a.competences.map((z,k)=>t.jsx("span",{className:"competence-tag",children:z},k))})]}),a.prerequis&&t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:700,color:"#374151",marginBottom:6},children:"Prrequis"}),t.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",lineHeight:1.6},children:a.prerequis})]}),a.description&&t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:700,color:"#374151",marginBottom:6},children:"Description"}),t.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",lineHeight:1.6},children:a.description})]}),t.jsxs("div",{style:{borderTop:"1px solid #f1f5f9",paddingTop:12,fontSize:"0.8rem",color:"#94a3b8"},children:[t.jsxs("p",{children:["Cre le ",a.createdAt.toDate().toLocaleDateString("fr-FR")]}),t.jsxs("p",{children:["Modifie le ",a.updatedAt.toDate().toLocaleDateString("fr-FR")]}),a.genereeParIA&&t.jsx("p",{children:" Gnre avec l'IA Claude"})]})]})})]})},Lee=({seance:e})=>{const[r,n]=g.useState(!1),a=(e.entreesCahierIds?.length??0)>0;return t.jsx("div",{className:`timeline-item${e.estEvaluation?" timeline-item--eval":""}`,children:t.jsxs("div",{className:"timeline-card",children:[t.jsxs("div",{className:"timeline-card__header",onClick:()=>n(l=>!l),style:{cursor:"pointer"},children:[t.jsxs("h3",{className:"timeline-card__title",children:[e.numero,". ",e.titre||`Sance ${e.numero}`]}),t.jsxs("div",{className:"timeline-card__meta",children:[t.jsx("span",{className:`type-activite-badge type-activite-badge--${e.typeActivite}`,children:Sf[e.typeActivite]}),t.jsxs("span",{className:"timeline-card__duree",children:[e.dureeMinutes,"min"]}),a&&t.jsx("span",{className:"export-seance-row__exported",children:" Exporte"}),t.jsx("span",{style:{color:"#94a3b8",fontSize:"0.7rem"},children:r?"":""})]})]}),e.objectifSpecifique&&t.jsxs("p",{className:"timeline-card__objectif",children:[" ",e.objectifSpecifique]}),r&&t.jsxs(t.Fragment,{children:[e.contenu&&t.jsx("p",{className:"timeline-card__contenu",style:{marginTop:8},children:e.contenu}),e.ressources.length>0&&t.jsx("div",{className:"timeline-card__ressources",children:e.ressources.map((l,o)=>t.jsx("span",{className:"ressource-chip",children:l},o))}),e.estEvaluation&&e.typeEvaluation&&t.jsxs("div",{style:{marginTop:10,padding:"8px 12px",background:"#fef2f2",borderRadius:6,fontSize:"0.8rem",color:"#dc2626"},children:[" ",qj[e.typeEvaluation],e.noteMax&&`  /${e.noteMax}`,e.coefficient&&`  Coeff. ${e.coefficient}`]})]})]})})},Fb={texte:{label:"Texte",emoji:"",description:"Paragraphe format"},image:{label:"Image",emoji:"",description:"Image avec lgende"},video:{label:"Vido",emoji:"",description:"Vido YouTube"},encadre:{label:"Encadr",emoji:"",description:"Dfinition, remarque, astuce..."},quiz:{label:"Quiz",emoji:"",description:"Question  choix multiple"},exercice:{label:"Exercice",emoji:"",description:"Problme avec correction"}},IM={definition:{label:"Dfinition",emoji:"",bg:"#eff6ff",border:"#2563eb",color:"#1d4ed8"},remarque:{label:"Remarque",emoji:"",bg:"#fefce8",border:"#ca8a04",color:"#854d0e"},attention:{label:"Attention",emoji:"",bg:"#fef2f2",border:"#dc2626",color:"#991b1b"},astuce:{label:"Astuce",emoji:"",bg:"#f0fdf4",border:"#16a34a",color:"#15803d"},exemple:{label:"Exemple",emoji:"",bg:"#f8fafc",border:"#64748b",color:"#475569"}},$ee={brouillon:{label:"Brouillon",couleur:"#6b7280",bg:"#f3f4f6"},publie:{label:"Publi",couleur:"#16a34a",bg:"#f0fdf4"},archive:{label:"Archiv",couleur:"#9ca3af",bg:"#f9fafb"}};function Bee({cours:e,onClick:r}){const n=e.dureeEstimee>=60?`${Math.floor(e.dureeEstimee/60)}h${e.dureeEstimee%60>0?e.dureeEstimee%60:""}`:`${e.dureeEstimee} min`,a=ci.find(l=>l.valeur===e.niveau)?.label??e.niveau;return t.jsxs("article",{className:"cours-card",onClick:r,role:"button",tabIndex:0,onKeyDown:l=>l.key==="Enter"&&r(),"aria-label":`Cours : ${e.titre}`,children:[t.jsxs("div",{className:"cours-card__cover",children:[e.couvertureUrl?t.jsx("img",{src:e.couvertureUrl,alt:e.titre,loading:"lazy"}):t.jsx("div",{className:"cours-card__cover-placeholder",children:t.jsx("span",{children:e.matiere.charAt(0)})}),e.isPremium&&t.jsx("span",{className:"cours-card__badge cours-card__badge--premium",children:" Premium"}),!e.isPremium&&t.jsx("span",{className:"cours-card__badge cours-card__badge--gratuit",children:" Gratuit"})]}),t.jsxs("div",{className:"cours-card__body",children:[t.jsxs("div",{className:"cours-card__meta",children:[t.jsx("span",{className:"cours-card__matiere",children:e.matiere}),t.jsx("span",{className:"cours-card__niveau",children:a})]}),t.jsx("h3",{className:"cours-card__titre",children:e.titre}),t.jsx("p",{className:"cours-card__description",children:e.description}),t.jsxs("div",{className:"cours-card__footer",children:[t.jsxs("span",{className:"cours-card__prof",children:[" ",e.profNom]}),t.jsxs("div",{className:"cours-card__stats",children:[t.jsxs("span",{children:[" ",e.nombreSections," section",e.nombreSections>1?"s":""]}),t.jsxs("span",{children:[" ",n]}),t.jsxs("span",{children:[" ",e.nombreInscrits]})]})]})]})]})}function Uee(){const e=tt(),{currentUser:r}=Xe(),{matieres:n}=_n(),a=r?.subscriptionPlan,l=r?.isPremium&&a&&So(a),[o,u]=g.useState([]),[d,m]=g.useState([]),[p,h]=g.useState(!0),[v,b]=g.useState(null),[x,j]=g.useState({matiere:"",niveau:"",recherche:"",isPremium:""});g.useEffect(()=>{_()},[r?.role]);async function _(){h(!0),b(null);try{let S=await VA();r?.role!=="prof"&&r?.role!=="admin"&&(S=S.filter(A=>!A.reservedPro)),u(S),m(S)}catch(S){console.error("[CoursPage] Erreur chargement :",S),b("Impossible de charger les cours. Vrifiez votre connexion.")}finally{h(!1)}}const w=g.useCallback(S=>{j(S);let A=[...o];if(S.matiere&&(A=A.filter(z=>z.matiere===S.matiere)),S.niveau&&(A=A.filter(z=>z.niveau===S.niveau)),S.isPremium!==""&&S.isPremium!==void 0&&(A=A.filter(z=>z.isPremium===S.isPremium)),S.recherche){const z=S.recherche.toLowerCase();A=A.filter(k=>k.titre.toLowerCase().includes(z)||k.description.toLowerCase().includes(z)||k.matiere.toLowerCase().includes(z)||k.tags.some(P=>P.toLowerCase().includes(z)))}m(A)},[o]),C=()=>{j({matiere:"",niveau:"",recherche:"",isPremium:""}),m(o)},E=!!(x.matiere||x.niveau||x.recherche||x.isPremium!=="");return t.jsxs("div",{className:"cours-catalogue",children:[t.jsx("section",{className:"cours-catalogue__hero","aria-label":"Introduction aux cours",children:t.jsxs("div",{className:"cours-catalogue__hero-content",children:[t.jsx("h1",{className:"cours-catalogue__hero-titre",children:" Cours en ligne"}),t.jsx("p",{className:"cours-catalogue__hero-sous-titre",children:"Des cours complets du programme sngalais  de la 6me au Bac. Crs par vos professeurs, accessibles partout, mme hors-ligne."}),l&&t.jsx("button",{className:"btn-primary",onClick:()=>e("/premium/mes-cours"),style:{marginTop:"1rem"},children:" Choisir mes cours"}),t.jsxs("div",{className:"cours-catalogue__hero-stats","aria-label":"Statistiques de la plateforme",children:[t.jsxs("div",{className:"cours-catalogue__stat",children:[t.jsx("span",{className:"cours-catalogue__stat-val",children:o.length}),t.jsx("span",{className:"cours-catalogue__stat-label",children:"Cours disponibles"})]}),t.jsxs("div",{className:"cours-catalogue__stat",children:[t.jsx("span",{className:"cours-catalogue__stat-val",children:o.filter(S=>!S.isPremium).length}),t.jsx("span",{className:"cours-catalogue__stat-label",children:"Cours gratuits"})]}),t.jsxs("div",{className:"cours-catalogue__stat",children:[t.jsx("span",{className:"cours-catalogue__stat-val",children:[...new Set(o.map(S=>S.matiere))].length}),t.jsx("span",{className:"cours-catalogue__stat-label",children:"Matires"})]})]})]})}),t.jsx("section",{className:"cours-catalogue__filtres","aria-label":"Filtres de recherche",children:t.jsxs("div",{className:"cours-catalogue__filtres-inner",children:[t.jsxs("div",{className:"cours-catalogue__search",children:[t.jsx("span",{className:"cours-catalogue__search-icon","aria-hidden":"true",children:""}),t.jsx("input",{type:"search",placeholder:"Rechercher un cours, une matire, un tag...",value:x.recherche,onChange:S=>w({...x,recherche:S.target.value}),className:"cours-catalogue__search-input","aria-label":"Rechercher dans les cours"})]}),t.jsxs("select",{value:x.matiere,onChange:S=>w({...x,matiere:S.target.value}),className:"cours-catalogue__select","aria-label":"Filtrer par matire",children:[t.jsx("option",{value:"",children:"Toutes les matires"}),n.map(S=>t.jsx("option",{value:S.valeur,children:S.label},S.valeur))]}),t.jsxs("select",{value:x.niveau,onChange:S=>w({...x,niveau:S.target.value}),className:"cours-catalogue__select","aria-label":"Filtrer par niveau",children:[t.jsx("option",{value:"",children:"Tous les niveaux"}),yr.map(S=>t.jsx("option",{value:S,children:S},S))]}),t.jsxs("select",{value:String(x.isPremium),onChange:S=>{const A=S.target.value===""?"":S.target.value==="true";w({...x,isPremium:A})},className:"cours-catalogue__select","aria-label":"Filtrer par accs",children:[t.jsx("option",{value:"",children:"Tous les accs"}),t.jsx("option",{value:"false",children:" Gratuits"}),t.jsx("option",{value:"true",children:" Premium"})]}),E&&t.jsx("button",{className:"btn-secondary btn--sm",onClick:C,"aria-label":"Effacer les filtres",children:" Effacer les filtres"})]})}),t.jsxs("main",{className:"cours-catalogue__contenu",children:[v&&t.jsxs("div",{className:"error-banner",role:"alert",children:[" ",v,t.jsx("button",{className:"btn-link",onClick:_,children:"Ressayer"})]}),p&&t.jsx("div",{className:"cours-catalogue__grille","aria-busy":"true","aria-label":"Chargement des cours",children:[1,2,3,4,5,6].map(S=>t.jsxs("div",{className:"cours-card cours-card--skeleton",children:[t.jsx("div",{className:"skeleton cours-card__cover"}),t.jsxs("div",{className:"cours-card__body",children:[t.jsx("div",{className:"skeleton",style:{height:16,width:"60%",marginBottom:8}}),t.jsx("div",{className:"skeleton",style:{height:20,marginBottom:8}}),t.jsx("div",{className:"skeleton",style:{height:14,width:"80%"}})]})]},S))}),!p&&d.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"cours-catalogue__compteur","aria-live":"polite",children:[d.length," cours trouv",d.length>1?"s":"",E&&" pour ces critres"]}),t.jsx("div",{className:"cours-catalogue__grille",children:d.map(S=>t.jsx(Bee,{cours:S,onClick:()=>e(`/cours/${S.id}`)},S.id))})]}),!p&&d.length===0&&!v&&t.jsxs("div",{className:"cours-catalogue__vide",role:"status",children:[t.jsx("span",{"aria-hidden":"true",children:""}),t.jsx("h3",{children:"Aucun cours trouv"}),t.jsx("p",{children:E?"Essayez de modifier ou supprimer vos filtres.":"Les cours seront disponibles bientt. Revenez dans quelques jours !"}),E&&t.jsx("button",{className:"btn-secondary",onClick:C,children:"Afficher tous les cours"})]})]})]})}const tl="progression_cours";async function vA(e,r){const n=ze(_e(V,tl),Se("userId","==",e),Se("coursId","==",r)),a=await Ae(n);if(a.empty)return null;const l=a.docs[0];return{id:l.id,...l.data()}}async function Fee(e){const r=ze(_e(V,tl),Se("coursId","==",e));return(await Ae(r)).docs.map(a=>({id:a.id,...a.data()}))}async function Gee(e,r){const n=Ee.now(),a=await Ot(_e(V,tl),{userId:e,coursId:r,sectionsLues:[],reponsesQuiz:[],pourcentageProgression:0,scoreQuiz:0,tentativesQuiz:0,debutLe:n,dernierAcces:n,estTermine:!1});return await iR(r),a.id}async function Hee(e,r,n){const a=await pt(je(V,tl,e));if(!a.exists())return;const l=a.data();if(l.sectionsLues.includes(r))return;const o=[...l.sectionsLues,r],u=Math.round(o.length/n*100),d=o.length>=n;await Ve(je(V,tl,e),{sectionsLues:Vb(r),pourcentageProgression:u,estTermine:d,dernierAcces:Ee.now()})}async function Vee(e,r){const n=await pt(je(V,tl,e));if(!n.exists())return;const a=n.data(),l=a.reponsesQuiz??[];if(l.some(p=>p.blocId===r.blocId))return;const u=[...l,r],d=u.filter(p=>p.estCorrecte).length,m=u.length>0?Math.round(d/u.length*100):0;await Ve(je(V,tl,e),{reponsesQuiz:Vb(r),scoreQuiz:m,tentativesQuiz:a.tentativesQuiz+1,dernierAcces:Ee.now()})}function Qee(e){if(e.length===0)return{nombreInscrits:0,nombreTermines:0,tauxCompletion:0,progressionMoyenne:0,scoreMoyen:0};const r=e.filter(l=>l.estTermine).length,n=Math.round(e.reduce((l,o)=>l+o.pourcentageProgression,0)/e.length),a=Math.round(e.reduce((l,o)=>l+o.scoreQuiz,0)/e.length);return{nombreInscrits:e.length,nombreTermines:r,tauxCompletion:Math.round(r/e.length*100),progressionMoyenne:n,scoreMoyen:a}}function Yee({bloc:e}){const r=e.contenu.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/^- (.+)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)/gs,"<ul>$1</ul>").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br/>");return t.jsx("div",{className:"bloc-texte",dangerouslySetInnerHTML:{__html:`<p>${r}</p>`}})}function Kee({bloc:e}){return t.jsxs("figure",{className:"bloc-image",children:[t.jsx("img",{src:e.url,alt:e.alt,loading:"lazy"}),e.legende&&t.jsx("figcaption",{children:e.legende})]})}function Wee({bloc:e}){const r=Y5(e.urlYoutube);return r?t.jsxs("div",{className:"bloc-video",children:[e.titre&&t.jsxs("h4",{className:"bloc-video__titre",children:[" ",e.titre]}),e.description&&t.jsx("p",{className:"bloc-video__description",children:e.description}),t.jsx("div",{className:"bloc-video__embed",children:t.jsx("iframe",{src:`https://www.youtube.com/embed/${r}`,title:e.titre||"Vido pdagogique",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy"})})]}):null}function Xee({bloc:e}){const r=IM[e.variante];return t.jsxs("div",{className:"bloc-encadre",style:{background:r.bg,borderLeftColor:r.border,color:r.color},children:[t.jsxs("p",{className:"bloc-encadre__titre",children:[r.emoji," ",e.titre]}),t.jsx("p",{className:"bloc-encadre__contenu",children:e.contenu})]})}function Zee({bloc:e,onReponse:r,reponseExistante:n}){const[a,l]=g.useState(n??null),o=a!==null;function u(d,m){o||(l(d),r(d,m))}return t.jsxs("div",{className:"bloc-quiz",children:[t.jsxs("p",{className:"bloc-quiz__question",children:[" ",e.question]}),t.jsx("div",{className:"bloc-quiz__options",children:e.options.map(d=>{let m="";return o&&(d.id===a?m=d.estCorrecte?"correct":"incorrect":d.estCorrecte&&(m="attendu")),t.jsxs("button",{className:`bloc-quiz__option bloc-quiz__option--${m||"neutre"}`,onClick:()=>u(d.id,d.estCorrecte),disabled:o,"aria-pressed":d.id===a,children:[m==="correct"&&" ",m==="incorrect"&&" ",m==="attendu"&&" ",d.texte]},d.id)})}),o&&e.explication&&t.jsxs("div",{className:"bloc-quiz__explication",children:[" ",t.jsx("strong",{children:"Explication :"})," ",e.explication]})]})}function Jee({bloc:e}){const[r,n]=g.useState(!1),a={facile:"#16a34a",moyen:"#ca8a04",difficile:"#dc2626"};return t.jsxs("div",{className:"bloc-exercice",children:[t.jsxs("div",{className:"bloc-exercice__header",children:[t.jsx("span",{className:"bloc-exercice__titre",children:" Exercice"}),t.jsxs("span",{className:"bloc-exercice__difficulte",style:{color:a[e.difficulte]},children:[e.difficulte.charAt(0).toUpperCase()+e.difficulte.slice(1),e.points&&`  ${e.points} pt${e.points>1?"s":""}`]})]}),t.jsx("p",{className:"bloc-exercice__enonce",children:e.enonce}),r?t.jsxs("div",{className:"bloc-exercice__correction",children:[t.jsx("p",{className:"bloc-exercice__correction-titre",children:" Correction"}),t.jsx("p",{children:e.correction})]}):t.jsx("button",{className:"btn-secondary btn--sm",onClick:()=>n(!0),children:" Voir la correction"})]})}function ete({bloc:e,isPremiumVerrou:r,onReponseQuiz:n,reponseExistante:a}){if(r)return t.jsxs("div",{className:"bloc-premium-verrou","aria-label":"Contenu Premium",children:[t.jsx("span",{children:""}),t.jsx("p",{children:"Ce contenu est rserv aux abonns Premium."})]});switch(e.type){case"texte":return t.jsx(Yee,{bloc:e});case"image":return t.jsx(Kee,{bloc:e});case"video":return t.jsx(Wee,{bloc:e});case"encadre":return t.jsx(Xee,{bloc:e});case"quiz":return t.jsx(Zee,{bloc:e,reponseExistante:a,onReponse:(l,o)=>n(e.id,l,o)});case"exercice":return t.jsx(Jee,{bloc:e});default:return null}}function tte(){const{coursId:e}=jn(),r=tt(),{currentUser:n}=Xe(),a=n?.isPremium??!1,l=a&&lR(e||"",a,n?.subscriptionPlan,n?.coursChoisis??[]),[o,u]=g.useState(null),[d,m]=g.useState([]),[p,h]=g.useState(null),[v,b]=g.useState(null),[x,j]=g.useState(!0),[_,w]=g.useState(null),C=g.useRef(null);g.useEffect(()=>{e&&E()},[e,n]);async function E(){if(e){j(!0),w(null);try{const[F,Y]=await Promise.all([QA(e),YA(e)]);if(!F||F.statut!=="publie"){w("Ce cours n'est pas disponible."),j(!1);return}if(u(F),m(Y),Y.length>0&&b(Y[0].id),n){let M=await vA(n.uid,e);M||(await Gee(n.uid,e),M=await vA(n.uid,e)),h(M)}}catch(F){console.error("[CoursDetailPage] Erreur chargement :",F),w("Erreur de chargement. Vrifiez votre connexion.")}finally{j(!1)}}}function S(F){const Y=F.blocs.filter(X=>X.type==="quiz");if(Y.length===0)return!0;const M=p?.reponsesQuiz.filter(X=>Y.some(L=>L.id===X.blocId))??[];return M.length<Y.length?!1:M.filter(X=>X.estCorrecte).length/Y.length*100>=60}async function A(F){if(!n||!p||!o||p.sectionsLues.includes(F))return;const Y=d.find(M=>M.id===F);if(Y&&!S(Y)){w("Russissez les quiz de cette section (60% minimum) pour continuer.");return}try{await Hee(p.id,F,o.nombreSections),h(M=>M?{...M,sectionsLues:[...M.sectionsLues,F],pourcentageProgression:Math.round((M.sectionsLues.length+1)/o.nombreSections*100)}:null)}catch(M){console.error("[CoursDetailPage] Erreur marquer section :",M)}}async function z(F,Y,M){if(!(!n||!p))try{await Vee(p.id,{blocId:F,optionChoisieId:Y,estCorrecte:M,reponduAt:Ee.now()})}catch(K){console.error("[CoursDetailPage] Erreur enregistrement quiz :",K)}}function k(F){return!!(F.estGratuite||F.ordre===1||!o?.isPremium||l)}if(x)return t.jsxs("div",{className:"cours-detail__loading","aria-busy":"true",children:[t.jsx("div",{className:"spinner spinner--blue"}),t.jsx("p",{children:"Chargement du cours..."})]});if(_||!o)return t.jsxs("div",{className:"cours-detail__erreur",role:"alert",children:[t.jsx("span",{"aria-hidden":"true",children:""}),t.jsx("p",{children:_??"Cours introuvable."}),t.jsx("button",{className:"btn-secondary",onClick:()=>r("/cours"),children:" Retour au catalogue"})]});const P=ci.find(F=>F.valeur===o.niveau)?.label??o.niveau,D=d.find(F=>F.id===v),$=D?k(D):!1;return t.jsxs("div",{className:"cours-detail",children:[t.jsxs("header",{className:"cours-detail__header",children:[t.jsxs("p",{className:"cours-detail__breadcrumb",children:[t.jsx("button",{className:"btn-link",onClick:()=>r("/cours"),children:" Cours"})," / ",t.jsx("span",{children:o.matiere})," / ",t.jsx("span",{children:o.titre})]}),t.jsxs("div",{className:"cours-detail__header-grid",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"cours-detail__badges",children:[t.jsx("span",{className:"badge badge--matiere",children:o.matiere}),t.jsx("span",{className:"badge badge--niveau",children:P}),o.isPremium?t.jsx("span",{className:"badge badge--premium",children:" Premium"}):t.jsx("span",{className:"badge badge--gratuit",children:" Gratuit"})]}),t.jsx("h1",{className:"cours-detail__titre",children:o.titre}),t.jsx("p",{className:"cours-detail__description",children:o.description}),t.jsxs("p",{className:"cours-detail__prof",children:[" Cours de ",t.jsx("strong",{children:o.profNom})]}),o.objectifs.length>0&&t.jsxs("div",{className:"cours-detail__objectifs",children:[t.jsx("h3",{children:" Objectifs du cours"}),t.jsx("ul",{children:o.objectifs.map((F,Y)=>t.jsx("li",{children:F},Y))})]})]}),n&&p&&t.jsxs("div",{className:"cours-detail__progression-card",children:[t.jsx("h3",{children:" Ma progression"}),t.jsx("div",{className:"progression-bar",children:t.jsx("div",{className:"progression-bar__fill",style:{width:`${p.pourcentageProgression}%`},role:"progressbar","aria-valuenow":p.pourcentageProgression,"aria-valuemin":0,"aria-valuemax":100})}),t.jsxs("p",{className:"progression-bar__label",children:[p.pourcentageProgression,"%  ",p.sectionsLues.length,"/",o.nombreSections," section",o.nombreSections>1?"s":""," lue",p.sectionsLues.length>1?"s":""]}),p.scoreQuiz>0&&t.jsxs("p",{className:"progression-bar__score",children:[" Score quiz : ",t.jsxs("strong",{children:[p.scoreQuiz,"%"]})]}),p.estTermine&&t.jsx("div",{className:"cours-detail__termine-badge",children:" Cours termin !"})]})]})]}),t.jsxs("div",{className:"cours-detail__layout",children:[t.jsxs("nav",{className:"cours-detail__sidebar","aria-label":"Sections du cours",children:[t.jsx("h2",{className:"cours-detail__sidebar-titre",children:" Sections"}),t.jsx("ol",{className:"cours-detail__sections-liste",children:d.map(F=>{const Y=p?.sectionsLues.includes(F.id)??!1,M=F.id===v,K=k(F);return t.jsx("li",{children:t.jsxs("button",{className:["cours-detail__section-btn",M?"cours-detail__section-btn--active":"",Y?"cours-detail__section-btn--lue":"",K?"":"cours-detail__section-btn--verrou"].join(" "),onClick:()=>b(F.id),"aria-current":M?"true":void 0,children:[t.jsx("span",{className:"cours-detail__section-icone","aria-hidden":"true",children:K?Y?"":`${F.ordre}.`:""}),t.jsx("span",{className:"cours-detail__section-nom",children:F.titre}),t.jsxs("span",{className:"cours-detail__section-duree",children:[F.dureeEstimee," min"]})]})},F.id)})})]}),t.jsx("main",{className:"cours-detail__contenu",ref:C,"aria-live":"polite",children:D?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"cours-detail__section-header",children:[t.jsxs("h2",{className:"cours-detail__section-titre",children:[D.ordre,". ",D.titre]}),t.jsxs("span",{className:"cours-detail__section-duree-label",children:[" ",D.dureeEstimee," min de lecture"]})]}),$?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"cours-detail__blocs",children:D.blocs.sort((F,Y)=>F.ordre-Y.ordre).map(F=>{const Y=F.isPremium&&!a&&!D.estGratuite,M=p?.reponsesQuiz.find(K=>K.blocId===F.id)?.optionChoisieId;return t.jsx("div",{className:`cours-detail__bloc cours-detail__bloc--${F.type}`,children:t.jsx(ete,{bloc:F,isPremiumVerrou:Y,onReponseQuiz:z,reponseExistante:M})},F.id)})}),n&&!p?.sectionsLues.includes(D.id)&&t.jsx("div",{className:"cours-detail__action-lu",children:t.jsx("button",{className:"btn-primary",onClick:()=>A(D.id),children:" Marquer cette section comme lue"})}),t.jsxs("div",{className:"cours-detail__nav-sections",children:[!S(D)&&D.blocs.some(F=>F.type==="quiz")&&t.jsx("p",{className:"cours-detail__quiz-requis",role:"alert",children:" Russissez les quiz de cette section (60% minimum) pour passer  la suite."}),D.ordre>1&&t.jsx("button",{className:"btn-secondary",onClick:()=>{const F=d.find(Y=>Y.ordre===D.ordre-1);F&&b(F.id)},children:" Section prcdente"}),D.ordre<d.length&&t.jsx("button",{className:"btn-primary",onClick:()=>{if(!S(D)&&D.blocs.some(Y=>Y.type==="quiz"))return;const F=d.find(Y=>Y.ordre===D.ordre+1);F&&b(F.id)},children:"Section suivante "})]})]}):t.jsxs("div",{className:"cours-detail__premium-gate",children:[t.jsx("span",{className:"cours-detail__premium-gate-icon","aria-hidden":"true",children:""}),t.jsx("h3",{children:"Contenu Premium"}),t.jsxs("p",{children:["Cette section ncessite un abonnement Premium PedaClic.",t.jsx("br",{}),"Formules  partir de ",t.jsx("strong",{children:"1 000 FCFA/mois"})," (1 cours) jusqu' l'accs illimit (ds 10 000 FCFA / 3 mois)."]}),n?t.jsxs("div",{className:"cours-detail__premium-gate-actions",children:[t.jsx("button",{className:"btn-primary",onClick:()=>r("/premium"),children:" Dcouvrir les formules"}),n.isPremium&&t.jsx("button",{className:"btn-secondary",onClick:()=>r("/premium/mes-cours"),children:" Choisir mes cours"})]}):t.jsx("button",{className:"btn-primary",onClick:()=>r("/connexion"),children:"Se connecter pour accder"})]})]}):t.jsx("div",{className:"cours-detail__vide-section",role:"status",children:t.jsx("p",{children:"Slectionnez une section dans le menu de gauche pour commencer."})})})]})]})}const rte=["image/jpeg","image/png","image/gif","image/webp"],nte=".jpg,.jpeg,.png,.gif,.webp",LM=({storagePath:e,existingUrl:r,onUploadComplete:n,onUploadStart:a,onUploadError:l,placeholder:o="Glissez une image ici ou cliquez pour parcourir",disabled:u=!1,maxSizeMo:d=5})=>{const[m,p]=g.useState({status:"idle",progress:0,errorMessage:null,previewUrl:r||null}),[h,v]=g.useState(!1),b=g.useRef(null),x=g.useCallback(F=>{if(!rte.includes(F.type))return`Type non support : ${F.type}. Utilisez JPG, PNG, GIF ou WebP.`;const Y=F.size/(1024*1024);return Y>d?`Fichier trop lourd : ${Y.toFixed(1)} Mo (max ${d} Mo).`:null},[d]),j=F=>{const Y=Date.now(),M=F.split(".").pop()?.toLowerCase()||"jpg";return`${F.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9_-]/g,"_").slice(0,30)}_${Y}.${M}`},_=g.useCallback(async F=>{const Y=x(F);if(Y){p(I=>({...I,status:"error",errorMessage:Y})),l?.(Y);return}const M=URL.createObjectURL(F);p({status:"uploading",progress:0,errorMessage:null,previewUrl:M}),a?.();const K=j(F.name),ee=`${e}/${K}`,X=cr(ar,ee),L=uu(X,F,{contentType:F.type,customMetadata:{uploadedBy:"pedaclic-prof",originalName:F.name}});L.on("state_changed",I=>{const U=Math.round(I.bytesTransferred/I.totalBytes*100);p(B=>({...B,progress:U}))},I=>{URL.revokeObjectURL(M);const U=`Erreur upload : ${I.message}`;p(B=>({...B,status:"error",errorMessage:U,previewUrl:r||null})),l?.(U)},async()=>{URL.revokeObjectURL(M);try{const I=await In(L.snapshot.ref);p({status:"success",progress:100,errorMessage:null,previewUrl:I}),n(I)}catch{const U="Impossible de rcuprer l'URL de tlchargement.";p(B=>({...B,status:"error",errorMessage:U})),l?.(U)}})},[e,r,x,a,n,l]),w=F=>{const Y=F.target.files?.[0];Y&&_(Y),F.target.value=""},C=F=>{F.preventDefault(),u||v(!0)},E=F=>{F.preventDefault(),v(!1)},S=F=>{if(F.preventDefault(),v(!1),u)return;const Y=F.dataTransfer.files?.[0];Y&&_(Y)},A=async()=>{m.previewUrl&&(p({status:"idle",progress:0,errorMessage:null,previewUrl:null}),n(""))},{status:z,progress:k,errorMessage:P,previewUrl:D}=m,$=z==="uploading";return t.jsxs("div",{className:`image-uploader ${h?"image-uploader--drag-over":""} ${u?"image-uploader--disabled":""}`,children:[D&&t.jsxs("div",{className:"image-uploader__preview",children:[t.jsx("img",{src:D,alt:"Aperu",className:"image-uploader__preview-img"}),$&&t.jsx("div",{className:"image-uploader__overlay",children:t.jsx("div",{className:"image-uploader__spinner"})}),!$&&!u&&t.jsx("button",{type:"button",className:"image-uploader__remove-btn",onClick:A,title:"Supprimer l'image","aria-label":"Supprimer l'image",children:""})]}),!D&&t.jsxs("div",{className:"image-uploader__dropzone",onDragOver:C,onDragLeave:E,onDrop:S,onClick:()=>!u&&b.current?.click(),role:"button",tabIndex:u?-1:0,"aria-label":"Zone d'upload d'image",onKeyDown:F=>{(F.key==="Enter"||F.key===" ")&&!u&&b.current?.click()},children:[t.jsx("span",{className:"image-uploader__icon","aria-hidden":"true",children:""}),t.jsx("p",{className:"image-uploader__text",children:o}),t.jsxs("p",{className:"image-uploader__subtext",children:["JPG, PNG, GIF, WebP  max ",d," Mo"]}),t.jsx("button",{type:"button",className:"image-uploader__browse-btn",disabled:u,tabIndex:-1,"aria-hidden":"true",children:"Parcourir"})]}),$&&t.jsxs("div",{className:"image-uploader__progress",role:"progressbar","aria-valuenow":k,"aria-valuemin":0,"aria-valuemax":100,children:[t.jsx("div",{className:"image-uploader__progress-bar",style:{width:`${k}%`}}),t.jsxs("span",{className:"image-uploader__progress-text",children:["Upload en cours ",k,"%"]})]}),z==="success"&&t.jsx("p",{className:"image-uploader__success",children:" Image uploade avec succs"}),P&&t.jsxs("p",{className:"image-uploader__error",role:"alert",children:[" ",P]}),t.jsx("input",{ref:b,type:"file",accept:nte,onChange:w,disabled:u||$,style:{display:"none"},"aria-hidden":"true"})]})},ym=()=>crypto.randomUUID();function ate(e,r){const n={id:ym(),type:e,ordre:r,isPremium:!1};switch(e){case"texte":return{...n,type:"texte",contenu:""};case"image":return{...n,type:"image",url:"",alt:"",legende:""};case"video":return{...n,type:"video",urlYoutube:"",titre:"",description:""};case"encadre":return{...n,type:"encadre",variante:"definition",titre:"Dfinition",contenu:""};case"quiz":return{...n,type:"quiz",question:"",options:[{id:ym(),texte:"",estCorrecte:!0},{id:ym(),texte:"",estCorrecte:!1}],explication:""};case"exercice":return{...n,type:"exercice",enonce:"",correction:"",difficulte:"moyen"}}}function ite({bloc:e,index:r,total:n,onUpdate:a,onDelete:l,onMoveUp:o,onMoveDown:u,isDragging:d,onDragStart:m,onDragOver:p,onDrop:h,onDragEnd:v,dragOverIndex:b,storageBasePath:x,onBlocUploadStart:j,onBlocUploadEnd:_}){const w=Fb[e.type],C=b===r;function E(){switch(e.type){case"texte":return t.jsx("textarea",{className:"editor-bloc__textarea",placeholder:"Texte du paragraphe (Markdown : **gras**, *italique*, - liste)",value:e.contenu,onChange:S=>a({...e,contenu:S.target.value}),rows:4});case"image":return t.jsxs("div",{className:"editor-bloc__form-grid",children:[t.jsx(LM,{storagePath:`${x}/bloc-${r}`,existingUrl:e.url,placeholder:"Glissez l'image ici ou cliquez",onUploadStart:()=>j(r),onUploadComplete:S=>{a({...e,url:S}),_(r)},onUploadError:()=>_(r),maxSizeMo:5}),t.jsx("input",{type:"text",placeholder:"Texte alternatif (accessibilit)",value:e.alt,onChange:S=>a({...e,alt:S.target.value}),className:"editor-bloc__input"}),t.jsx("input",{type:"text",placeholder:"Lgende (optionnelle)",value:e.legende??"",onChange:S=>a({...e,legende:S.target.value}),className:"editor-bloc__input"})]});case"video":return t.jsxs("div",{className:"editor-bloc__form-grid",children:[t.jsx("input",{type:"url",placeholder:"URL YouTube (ex: https://www.youtube.com/watch?v=...)",value:e.urlYoutube,onChange:S=>a({...e,urlYoutube:S.target.value}),className:"editor-bloc__input"}),t.jsx("input",{type:"text",placeholder:"Titre de la vido",value:e.titre,onChange:S=>a({...e,titre:S.target.value}),className:"editor-bloc__input"}),t.jsx("input",{type:"text",placeholder:"Description courte (optionnelle)",value:e.description??"",onChange:S=>a({...e,description:S.target.value}),className:"editor-bloc__input"})]});case"encadre":return t.jsxs("div",{className:"editor-bloc__form-grid",children:[t.jsx("select",{value:e.variante,onChange:S=>a({...e,variante:S.target.value}),className:"editor-bloc__select",children:Object.entries(IM).map(([S,A])=>t.jsxs("option",{value:S,children:[A.emoji," ",A.label]},S))}),t.jsx("input",{type:"text",placeholder:"Titre de l'encadr",value:e.titre,onChange:S=>a({...e,titre:S.target.value}),className:"editor-bloc__input"}),t.jsx("textarea",{placeholder:"Contenu de l'encadr",value:e.contenu,onChange:S=>a({...e,contenu:S.target.value}),className:"editor-bloc__textarea",rows:3})]});case"quiz":{const S=e;return t.jsxs("div",{className:"editor-bloc__form-grid",children:[t.jsx("input",{type:"text",placeholder:"Question",value:S.question,onChange:A=>a({...S,question:A.target.value}),className:"editor-bloc__input"}),t.jsxs("div",{className:"editor-bloc__quiz-options",children:[S.options.map((A,z)=>t.jsxs("div",{className:"editor-bloc__quiz-option",children:[t.jsx("input",{type:"radio",name:`quiz-correct-${e.id}`,checked:A.estCorrecte,onChange:()=>a({...S,options:S.options.map((k,P)=>({...k,estCorrecte:P===z}))}),title:"Marquer comme bonne rponse"}),t.jsx("input",{type:"text",placeholder:`Option ${z+1}`,value:A.texte,onChange:k=>a({...S,options:S.options.map((P,D)=>D===z?{...P,texte:k.target.value}:P)}),className:"editor-bloc__input"}),S.options.length>2&&t.jsx("button",{type:"button",className:"btn-icon btn-icon--danger",onClick:()=>a({...S,options:S.options.filter((k,P)=>P!==z)}),title:"Supprimer cette option",children:""})]},A.id)),S.options.length<4&&t.jsx("button",{type:"button",className:"btn-link",onClick:()=>a({...S,options:[...S.options,{id:ym(),texte:"",estCorrecte:!1}]}),children:"+ Ajouter une option"})]}),t.jsx("input",{type:"text",placeholder:"Explication aprs rponse (optionnelle)",value:S.explication??"",onChange:A=>a({...S,explication:A.target.value}),className:"editor-bloc__input"})]})}case"exercice":return t.jsxs("div",{className:"editor-bloc__form-grid",children:[t.jsx("textarea",{placeholder:"nonc de l'exercice",value:e.enonce,onChange:S=>a({...e,enonce:S.target.value}),className:"editor-bloc__textarea",rows:3}),t.jsx("textarea",{placeholder:"Correction (masque pour l'lve jusqu'au clic)",value:e.correction,onChange:S=>a({...e,correction:S.target.value}),className:"editor-bloc__textarea editor-bloc__textarea--correction",rows:3}),t.jsxs("div",{className:"editor-bloc__row",children:[t.jsxs("select",{value:e.difficulte,onChange:S=>a({...e,difficulte:S.target.value}),className:"editor-bloc__select",children:[t.jsx("option",{value:"facile",children:"Facile"}),t.jsx("option",{value:"moyen",children:"Moyen"}),t.jsx("option",{value:"difficile",children:"Difficile"})]}),t.jsx("input",{type:"number",placeholder:"Points (opt.)",value:e.points??"",onChange:S=>a({...e,points:Number(S.target.value)||void 0}),className:"editor-bloc__input editor-bloc__input--sm",min:1})]})]});default:return null}}return t.jsxs("div",{className:["editor-bloc",d?"editor-bloc--dragging":"",C?"editor-bloc--drag-over":""].join(" "),draggable:!0,onDragStart:S=>m(S,r),onDragOver:S=>p(S,r),onDrop:S=>h(S,r),onDragEnd:v,children:[t.jsxs("div",{className:"editor-bloc__header",children:[t.jsx("span",{className:"editor-bloc__drag-handle",title:"Dplacer","aria-hidden":"true",children:""}),t.jsxs("span",{className:"editor-bloc__type-label",children:[w.emoji," ",w.label]}),t.jsxs("label",{className:"editor-bloc__premium-toggle",title:"Rserver aux abonns Premium",children:[t.jsx("input",{type:"checkbox",checked:e.isPremium,onChange:S=>a({...e,isPremium:S.target.checked})}),t.jsx("span",{children:" Premium"})]}),t.jsxs("div",{className:"editor-bloc__actions",children:[t.jsx("button",{type:"button",className:"btn-icon",onClick:o,disabled:r===0,title:"Monter","aria-label":"Monter ce bloc",children:""}),t.jsx("button",{type:"button",className:"btn-icon",onClick:u,disabled:r===n-1,title:"Descendre","aria-label":"Descendre ce bloc",children:""}),t.jsx("button",{type:"button",className:"btn-icon btn-icon--danger",onClick:l,title:"Supprimer ce bloc","aria-label":"Supprimer ce bloc",children:""})]})]}),t.jsx("div",{className:"editor-bloc__form",children:E()})]})}function gA(){const{coursId:e}=jn(),r=tt(),{currentUser:n}=Xe(),a=!!e,{matieres:l}=_n(),[o]=g.useState(()=>je(_e(V,"cours_en_ligne")).id),u=`cours-images/${a?e:o}`,[d,m]=g.useState({titre:"",description:"",matiere:"Mathmatiques",niveau:"3me",classe:"",isPremium:!1,statut:"brouillon",couvertureUrl:"",dureeEstimee:0,objectifs:[""],prerequis:"",tags:[],cahierTextesId:""}),[p,h]=g.useState([]),[v,b]=g.useState(null),[x,j]=g.useState([]),[_,w]=g.useState(""),C=g.useRef(null),[E,S]=g.useState(null),A=g.useRef(null),[z,k]=g.useState(null),[P,D]=g.useState(null),[$,F]=g.useState(!1),[Y,M]=g.useState(!1),[K,ee]=g.useState(null),[X,L]=g.useState(null),[I,U]=g.useState("infos"),[B,T]=g.useState([]),[Z,H]=g.useState(!1),[ce,xe]=g.useState({});Z||Object.values(ce).some(Boolean),g.useEffect(()=>{a&&e&&fe(e)},[e]),g.useEffect(()=>{n?.role==="admin"&&fJ().then(W=>T(W.map(ie=>({id:ie.id,titre:ie.titre})))).catch(()=>{})},[n?.role]);async function fe(W){F(!0);try{const[ie,Ne]=await Promise.all([QA(W),YA(W)]);ie&&m({titre:ie.titre,description:ie.description,matiere:ie.matiere,niveau:ie.niveau,classe:ie.classe??"",cahierTextesId:ie.cahierTextesId??"",isPremium:ie.isPremium,statut:ie.statut,couvertureUrl:ie.couvertureUrl??"",dureeEstimee:ie.dureeEstimee,objectifs:ie.objectifs.length>0?ie.objectifs:[""],prerequis:ie.prerequis??"",tags:ie.tags}),h(Ne),Ne.length>0&&(b(Ne[0].id),j(Ne[0].blocs),w(Ne[0].titre))}catch{ee("Erreur de chargement du cours.")}finally{F(!1)}}g.useEffect(()=>{if(!v)return;const W=p.find(ie=>ie.id===v);W&&(j([...W.blocs].sort((ie,Ne)=>ie.ordre-Ne.ordre)),w(W.titre))},[v]);const G=(W,ie)=>m(Ne=>({...Ne,[W]:ie})),ve=(W,ie)=>{const Ne=[...d.objectifs];Ne[W]=ie,G("objectifs",Ne)},De=()=>G("objectifs",[...d.objectifs,""]),de=W=>G("objectifs",d.objectifs.filter((ie,Ne)=>Ne!==W)),[we,R]=g.useState(""),ae=()=>{const W=we.trim();W&&!d.tags.includes(W)&&G("tags",[...d.tags,W]),R("")},Ce=W=>G("tags",d.tags.filter(ie=>ie!==W));async function ke(W=!1){if(n){if(!d.titre.trim()){ee("Le titre du cours est obligatoire.");return}M(!0),ee(null);try{const ie={...d,objectifs:d.objectifs.filter(Ne=>Ne.trim()),statut:W?"publie":d.statut,cahierTextesId:d.cahierTextesId?.trim()||void 0};if(a&&e)await Z5(e,ie),W&&await Ix(e),Ke(W?" Cours publi !":" Cours sauvegard.");else{const Ne=n.displayName??"Professeur",We=await X5(n.uid,Ne,ie);W&&await Ix(We),Ke(" Cours cr ! Ajoutez maintenant vos sections."),r(`/prof/cours/${We}/modifier`)}}catch(ie){console.error("[CoursEditorPage] Erreur sauvegarde :",ie),ee("Erreur lors de la sauvegarde. Ressayez.")}finally{M(!1)}}}function Ke(W){L(W),setTimeout(()=>L(null),4e3)}async function et(){if(!e){ee("Sauvegardez d'abord le cours pour ajouter des sections.");return}const W=p.length+1,ie=`Section ${W}`;try{const Ne=await tR(e,{titre:ie,ordre:W,blocs:[],dureeEstimee:0,estGratuite:W===1}),We=Ee.now(),Dt={id:Ne,coursId:e,titre:ie,ordre:W,blocs:[],dureeEstimee:0,estGratuite:W===1,createdAt:We,updatedAt:We};h(Kr=>[...Kr,Dt]),b(Ne),j([]),w(ie)}catch{ee("Erreur lors de la cration de la section.")}}async function rt(W){if(e&&confirm("Supprimer cette section et tous ses blocs ?"))try{await rR(W,e);const ie=p.filter(Ne=>Ne.id!==W).map((Ne,We)=>({...Ne,ordre:We+1}));h(ie),v===W&&b(ie[0]?.id??null)}catch{ee("Erreur lors de la suppression.")}}async function Yt(){if(v)try{await X1(v,{titre:_}),h(W=>W.map(ie=>ie.id===v?{...ie,titre:_}:ie))}catch{ee("Erreur lors de la mise  jour du titre.")}}function mr(W,ie){C.current=ie,W.dataTransfer.effectAllowed="move"}function fr(W,ie){W.preventDefault(),W.dataTransfer.dropEffect="move",S(ie)}async function $r(W,ie){W.preventDefault(),S(null);const Ne=C.current;if(Ne===null||Ne===ie)return;const We=[...p],[Dt]=We.splice(Ne,1);We.splice(ie,0,Dt);const Kr=We.map((Tr,la)=>({...Tr,ordre:la+1}));h(Kr);try{await nR(Kr.map(Tr=>({id:Tr.id,ordre:Tr.ordre})))}catch{ee("Erreur lors du rordonnancement. Rechargez la page.")}C.current=null}function he(W){const ie=ate(W,x.length),Ne=[...x,ie];j(Ne),Kt(Ne)}function Pe(W,ie){const Ne=x.map((We,Dt)=>Dt===W?ie:We);j(Ne),Kt(Ne)}function Ie(W){const ie=x.filter((Ne,We)=>We!==W);j(ie),Kt(ie)}function Ye(W){if(W===0)return;const ie=[...x];[ie[W-1],ie[W]]=[ie[W],ie[W-1]],j(ie),Kt(ie)}function nt(W){if(W===x.length-1)return;const ie=[...x];[ie[W],ie[W+1]]=[ie[W+1],ie[W]],j(ie),Kt(ie)}const qt=g.useRef(null);function Kt(W){v&&(qt.current&&clearTimeout(qt.current),qt.current=setTimeout(async()=>{try{await aR(v,W),h(ie=>ie.map(Ne=>Ne.id===v?{...Ne,blocs:W}:Ne))}catch(ie){console.error("[CoursEditorPage] Erreur sauvegarde blocs :",ie)}},1500))}function se(W,ie){A.current=ie,D(ie),W.dataTransfer.effectAllowed="move"}function Oe(W,ie){W.preventDefault(),W.dataTransfer.dropEffect="move",k(ie)}function dt(W,ie){W.preventDefault(),k(null),D(null);const Ne=A.current;if(Ne===null||Ne===ie)return;const We=[...x],[Dt]=We.splice(Ne,1);We.splice(ie,0,Dt);const Kr=We.map((Tr,la)=>({...Tr,ordre:la}));j(Kr),Kt(Kr),A.current=null}function te(){k(null),D(null),A.current=null}return $?t.jsxs("div",{className:"cours-editor__loading","aria-busy":"true",children:[t.jsx("div",{className:"spinner spinner--blue"}),t.jsx("p",{children:"Chargement de l'diteur..."})]}):t.jsxs("div",{className:"cours-editor",children:[t.jsxs("header",{className:"cours-editor__header",children:[t.jsxs("p",{className:"cours-editor__breadcrumb",children:[t.jsx("button",{className:"btn-link",onClick:()=>r("/prof/cours"),children:" Mes cours"})," / ",a?"Modifier le cours":"Nouveau cours"]}),t.jsxs("div",{className:"cours-editor__header-actions",children:[t.jsx("h1",{className:"cours-editor__titre",children:a?" Modifier le cours":" Nouveau cours"}),t.jsxs("div",{className:"cours-editor__btn-group",children:[t.jsx("button",{className:"btn-secondary",onClick:()=>r("/prof/cours"),disabled:Y,children:"Annuler"}),t.jsx("button",{className:"btn-secondary",onClick:()=>ke(!1),disabled:Y,children:Y?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner"})," Sauvegarde..."]}):" Sauvegarder"}),t.jsx("button",{className:"btn-primary",onClick:()=>ke(!0),disabled:Y||d.statut==="publie",children:d.statut==="publie"?" Publi":" Publier"})]})]}),K&&t.jsxs("div",{className:"error-banner",role:"alert",children:[" ",K]}),X&&t.jsx("div",{className:"success-banner",role:"status",children:X})]}),t.jsxs("div",{className:"cours-editor__tabs",role:"tablist",children:[t.jsx("button",{className:`cours-editor__tab ${I==="infos"?"cours-editor__tab--active":""}`,onClick:()=>U("infos"),role:"tab","aria-selected":I==="infos",children:" Informations du cours"}),t.jsxs("button",{className:`cours-editor__tab ${I==="sections"?"cours-editor__tab--active":""}`,onClick:()=>U("sections"),role:"tab","aria-selected":I==="sections",disabled:!a&&!e,children:[" Sections et contenu ",p.length>0&&`(${p.length})`]})]}),I==="infos"&&t.jsxs("section",{className:"cours-editor__form","aria-label":"Informations du cours",children:[t.jsxs("div",{className:"cours-editor__card",children:[t.jsx("h2",{className:"cours-editor__card-titre",children:" Informations gnrales"}),t.jsxs("div",{className:"cours-editor__form-grid",children:[t.jsxs("div",{className:"cours-editor__field cours-editor__field--full",children:[t.jsx("label",{htmlFor:"titre",children:"Titre du cours *"}),t.jsx("input",{id:"titre",type:"text",value:d.titre,onChange:W=>G("titre",W.target.value),placeholder:"Ex : Les fonctions affines  Terminale S",className:"cours-editor__input",required:!0})]}),t.jsxs("div",{className:"cours-editor__field cours-editor__field--full",children:[t.jsx("label",{htmlFor:"description",children:"Description *"}),t.jsx("textarea",{id:"description",value:d.description,onChange:W=>G("description",W.target.value),placeholder:"Description courte affiche dans le catalogue",className:"cours-editor__textarea",rows:3})]}),t.jsxs("div",{className:"cours-editor__field",children:[t.jsx("label",{htmlFor:"matiere",children:"Matire *"}),t.jsx("select",{id:"matiere",value:d.matiere,onChange:W=>G("matiere",W.target.value),className:"cours-editor__select",children:l.map(W=>t.jsx("option",{value:W.valeur,children:W.label},W.valeur))})]}),t.jsxs("div",{className:"cours-editor__field",children:[t.jsx("label",{htmlFor:"niveau",children:"Niveau *"}),t.jsx("select",{id:"niveau",value:d.niveau,onChange:W=>G("niveau",W.target.value),className:"cours-editor__select",children:yr.map(W=>t.jsx("option",{value:W,children:W},W))})]}),t.jsxs("div",{className:"cours-editor__field",children:[t.jsx("label",{htmlFor:"classe",children:"Classe (optionnelle)"}),t.jsx("input",{id:"classe",type:"text",value:d.classe??"",onChange:W=>G("classe",W.target.value),placeholder:"Ex : 3me A, TS, L2",className:"cours-editor__input"})]}),n?.role==="admin"&&B.length>0&&t.jsxs("div",{className:"cours-editor__field cours-editor__field--full",children:[t.jsx("label",{htmlFor:"cahierTextesId",children:" Lier  un cahier de textes"}),t.jsxs("select",{id:"cahierTextesId",value:d.cahierTextesId??"",onChange:W=>G("cahierTextesId",W.target.value),className:"cours-editor__select",children:[t.jsx("option",{value:"",children:" Aucun "}),B.map(W=>t.jsx("option",{value:W.id,children:W.titre},W.id))]}),t.jsx("span",{className:"cours-editor__label-hint",children:"Si le cahier n'existe pas, crez-le d'abord dans Cahier de Textes."})]}),t.jsxs("div",{className:"cours-editor__field",children:[t.jsxs("label",{htmlFor:"couverture",children:[" Image de couverture",t.jsx("span",{className:"cours-editor__label-hint",children:"(JPG, PNG, WebP  max 5 Mo)"})]}),t.jsx(LM,{storagePath:`${u}/couverture`,existingUrl:d.couvertureUrl,placeholder:"Glissez l'image de couverture ici ou cliquez",disabled:Y,onUploadStart:()=>H(!0),onUploadComplete:W=>{G("couvertureUrl",W),H(!1)},onUploadError:W=>{console.error("[Phase 25] Erreur couverture:",W),H(!1)},maxSizeMo:5}),Z&&t.jsx("p",{className:"cours-editor__upload-hint",children:" Upload en cours, patientez avant d'enregistrer"})]}),t.jsx("div",{className:"cours-editor__field cours-editor__field--full",children:t.jsxs("label",{className:"cours-editor__toggle-label",children:[t.jsx("input",{type:"checkbox",checked:d.isPremium,onChange:W=>G("isPremium",W.target.checked)}),t.jsx("span",{children:" Cours Premium  Les sections (sauf la 1re) ncessitent un abonnement"})]})})]})]}),t.jsxs("div",{className:"cours-editor__card",children:[t.jsx("h2",{className:"cours-editor__card-titre",children:" Objectifs pdagogiques"}),d.objectifs.map((W,ie)=>t.jsxs("div",{className:"cours-editor__objectif-row",children:[t.jsx("input",{type:"text",value:W,onChange:Ne=>ve(ie,Ne.target.value),placeholder:`Objectif ${ie+1} (ex : Savoir calculer une drive)`,className:"cours-editor__input"}),d.objectifs.length>1&&t.jsx("button",{type:"button",className:"btn-icon btn-icon--danger",onClick:()=>de(ie),title:"Supprimer cet objectif",children:""})]},ie)),t.jsx("button",{type:"button",className:"btn-link",onClick:De,children:"+ Ajouter un objectif"})]}),t.jsxs("div",{className:"cours-editor__card",children:[t.jsx("h2",{className:"cours-editor__card-titre",children:" Prrequis et tags"}),t.jsxs("div",{className:"cours-editor__field",children:[t.jsx("label",{htmlFor:"prerequis",children:"Prrequis conseills"}),t.jsx("input",{id:"prerequis",type:"text",value:d.prerequis??"",onChange:W=>G("prerequis",W.target.value),placeholder:"Ex : Matriser les quations du 2nd degr",className:"cours-editor__input"})]}),t.jsxs("div",{className:"cours-editor__field",children:[t.jsx("label",{children:"Tags (aide  la recherche)"}),t.jsxs("div",{className:"cours-editor__tags-wrapper",children:[d.tags.map(W=>t.jsxs("span",{className:"cours-editor__tag",children:[W,t.jsx("button",{type:"button",onClick:()=>Ce(W),"aria-label":`Supprimer le tag ${W}`,children:""})]},W)),t.jsxs("div",{className:"cours-editor__tag-input-row",children:[t.jsx("input",{type:"text",value:we,onChange:W=>R(W.target.value),onKeyDown:W=>W.key==="Enter"&&(W.preventDefault(),ae()),placeholder:"Ajouter un tag...",className:"cours-editor__input cours-editor__input--sm"}),t.jsx("button",{type:"button",className:"btn-secondary btn--sm",onClick:ae,children:"+ Tag"})]})]})]})]})]}),I==="sections"&&t.jsx("section",{className:"cours-editor__sections","aria-label":"diteur de sections",children:a?t.jsxs("div",{className:"cours-editor__sections-layout",children:[t.jsxs("aside",{className:"cours-editor__sections-sidebar",children:[t.jsxs("div",{className:"cours-editor__sections-sidebar-header",children:[t.jsx("h2",{children:" Sections"}),t.jsx("button",{className:"btn-primary btn--sm",onClick:et,children:"+ Ajouter"})]}),p.length===0?t.jsx("p",{className:"cours-editor__sections-empty-hint",children:'Aucune section. Cliquez sur "+ Ajouter" pour commencer.'}):t.jsx("ol",{className:"cours-editor__sections-liste",children:p.map((W,ie)=>t.jsxs("li",{className:["cours-editor__section-item",W.id===v?"cours-editor__section-item--active":"",E===ie?"cours-editor__section-item--drag-over":""].join(" "),draggable:!0,onDragStart:Ne=>mr(Ne,ie),onDragOver:Ne=>fr(Ne,ie),onDrop:Ne=>$r(Ne,ie),onDragEnd:()=>S(null),children:[t.jsx("span",{className:"cours-editor__section-drag","aria-hidden":"true",children:""}),t.jsxs("button",{className:"cours-editor__section-btn",onClick:()=>b(W.id),"aria-current":W.id===v?"true":void 0,children:[t.jsx("span",{className:"cours-editor__section-ordre",children:W.ordre}),t.jsxs("span",{className:"cours-editor__section-nom",children:[W.titre,W.estGratuite&&t.jsx("span",{className:"cours-editor__section-gratuite",title:"Section gratuite",children:"G"})]}),t.jsxs("span",{className:"cours-editor__section-blocs-count",children:[W.blocs.length," bloc",W.blocs.length>1?"s":""]})]}),t.jsx("button",{className:"btn-icon btn-icon--danger btn-icon--xs",onClick:()=>rt(W.id),title:"Supprimer cette section","aria-label":`Supprimer la section ${W.titre}`,children:""})]},W.id))})]}),v?t.jsxs("div",{className:"cours-editor__section-content",children:[t.jsxs("div",{className:"cours-editor__section-titre-row",children:[t.jsx("input",{type:"text",value:_,onChange:W=>w(W.target.value),onBlur:Yt,className:"cours-editor__section-titre-input",placeholder:"Titre de la section","aria-label":"Titre de la section"}),t.jsxs("label",{className:"cours-editor__toggle-label",children:[t.jsx("input",{type:"checkbox",checked:p.find(W=>W.id===v)?.estGratuite??!1,onChange:async W=>{try{await X1(v,{estGratuite:W.target.checked}),h(ie=>ie.map(Ne=>Ne.id===v?{...Ne,estGratuite:W.target.checked}:Ne))}catch{}}}),t.jsx("span",{children:"Gratuite"})]})]}),t.jsxs("div",{className:"cours-editor__palette","aria-label":"Ajouter un bloc",children:[t.jsx("span",{className:"cours-editor__palette-label",children:"Ajouter un bloc :"}),Object.keys(Fb).map(W=>{const ie=Fb[W];return t.jsxs("button",{className:"cours-editor__palette-btn",onClick:()=>he(W),title:ie.description,children:[ie.emoji," ",ie.label]},W)})]}),x.length===0?t.jsxs("div",{className:"cours-editor__blocs-empty",children:[t.jsx("p",{children:" Aucun bloc dans cette section."}),t.jsx("p",{children:"Utilisez la palette ci-dessus pour ajouter du contenu."})]}):t.jsx("div",{className:"cours-editor__blocs-liste","aria-label":"Blocs de la section",children:x.map((W,ie)=>t.jsx(ite,{bloc:W,index:ie,total:x.length,onUpdate:Ne=>Pe(ie,Ne),onDelete:()=>Ie(ie),onMoveUp:()=>Ye(ie),onMoveDown:()=>nt(ie),isDragging:P===ie,onDragStart:se,onDragOver:Oe,onDrop:dt,onDragEnd:te,dragOverIndex:z,storageBasePath:`${u}/section-${v}`,onBlocUploadStart:Ne=>{const We=`${v}-${Ne}`;xe(Dt=>({...Dt,[We]:!0}))},onBlocUploadEnd:Ne=>{const We=`${v}-${Ne}`;xe(Dt=>({...Dt,[We]:!1}))}},W.id))})]}):t.jsx("div",{className:"cours-editor__section-content-empty",children:t.jsx("p",{children:"Slectionnez ou crez une section pour commencer  diter."})})]}):t.jsxs("div",{className:"cours-editor__sections-empty",children:[t.jsx("p",{children:"Sauvegardez d'abord les informations du cours pour ajouter des sections."}),t.jsx("button",{className:"btn-primary",onClick:()=>U("infos"),children:" Revenir aux informations"})]})})]})}function ste({cours:e,onModifier:r,onPublier:n,onArchiver:a,onSupprimer:l,onVoirStats:o}){const u=$ee[e.statut],d=ci.find(m=>m.valeur===e.niveau)?.label??e.niveau;return t.jsxs("article",{className:"prof-cours-card",children:[t.jsxs("div",{className:"prof-cours-card__header",children:[t.jsxs("div",{className:"prof-cours-card__header-left",children:[t.jsx("span",{className:"prof-cours-card__statut",style:{color:u.couleur,background:u.bg},children:u.label}),e.isPremium&&t.jsx("span",{className:"badge badge--premium",children:" Premium"})]}),t.jsxs("div",{className:"prof-cours-card__actions",children:[t.jsx("button",{className:"btn-icon",onClick:r,title:"Modifier","aria-label":`Modifier ${e.titre}`,children:""}),e.statut==="brouillon"&&t.jsx("button",{className:"btn-icon btn-icon--success",onClick:n,title:"Publier","aria-label":`Publier ${e.titre}`,children:""}),e.statut==="publie"&&t.jsx("button",{className:"btn-icon",onClick:a,title:"Archiver","aria-label":`Archiver ${e.titre}`,children:""}),t.jsx("button",{className:"btn-icon btn-icon--info",onClick:o,title:"Voir les statistiques","aria-label":`Statistiques de ${e.titre}`,children:""}),t.jsx("button",{className:"btn-icon btn-icon--danger",onClick:l,title:"Supprimer","aria-label":`Supprimer ${e.titre}`,children:""})]})]}),t.jsxs("div",{className:"prof-cours-card__body",children:[t.jsx("h3",{className:"prof-cours-card__titre",children:e.titre}),t.jsx("p",{className:"prof-cours-card__description",children:e.description}),t.jsxs("div",{className:"prof-cours-card__meta",children:[t.jsx("span",{className:"badge badge--matiere",children:e.matiere}),t.jsx("span",{className:"badge badge--niveau",children:d}),e.classe&&t.jsx("span",{className:"badge badge--classe",children:e.classe})]})]}),t.jsxs("div",{className:"prof-cours-card__footer",children:[t.jsxs("span",{title:"Sections",children:[" ",e.nombreSections," section",e.nombreSections>1?"s":""]}),t.jsxs("span",{title:"Dure estime",children:[" ",e.dureeEstimee," min"]}),t.jsxs("span",{title:"lves inscrits",children:[" ",e.nombreInscrits," lve",e.nombreInscrits>1?"s":""]})]})]})}function lte({cours:e,onClose:r}){const[n,a]=g.useState(null),[l,o]=g.useState(!0);g.useEffect(()=>{u()},[e.id]);async function u(){try{const d=await Fee(e.id);a(Qee(d))}catch(d){console.error("[StatsModal] Erreur :",d)}finally{o(!1)}}return t.jsx("div",{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":`Statistiques du cours : ${e.titre}`,onClick:d=>{d.target===d.currentTarget&&r()},children:t.jsxs("div",{className:"modal-content",children:[t.jsxs("div",{className:"modal-header",children:[t.jsxs("h2",{children:[" Statistiques  ",e.titre]}),t.jsx("button",{className:"btn-icon",onClick:r,"aria-label":"Fermer",children:""})]}),t.jsx("div",{className:"modal-body",children:l?t.jsxs("div",{className:"modal-loading",children:[t.jsx("div",{className:"spinner spinner--blue"}),t.jsx("p",{children:"Chargement des statistiques..."})]}):n?t.jsxs("div",{className:"stats-grid",children:[t.jsxs("div",{className:"stats-card",children:[t.jsx("span",{className:"stats-card__val",children:n.nombreInscrits}),t.jsx("span",{className:"stats-card__label",children:"lves inscrits"})]}),t.jsxs("div",{className:"stats-card stats-card--success",children:[t.jsx("span",{className:"stats-card__val",children:n.nombreTermines}),t.jsx("span",{className:"stats-card__label",children:"Cours termins"})]}),t.jsxs("div",{className:"stats-card stats-card--info",children:[t.jsxs("span",{className:"stats-card__val",children:[n.tauxCompletion,"%"]}),t.jsx("span",{className:"stats-card__label",children:"Taux de compltion"})]}),t.jsxs("div",{className:"stats-card",children:[t.jsxs("span",{className:"stats-card__val",children:[n.progressionMoyenne,"%"]}),t.jsx("span",{className:"stats-card__label",children:"Progression moyenne"})]}),t.jsxs("div",{className:"stats-card stats-card--primary",children:[t.jsxs("span",{className:"stats-card__val",children:[n.scoreMoyen,"%"]}),t.jsx("span",{className:"stats-card__label",children:"Score moyen aux quiz"})]}),t.jsxs("div",{className:"stats-progress-bar-wrapper",children:[t.jsx("label",{children:"Progression globale des lves"}),t.jsx("div",{className:"progression-bar",children:t.jsx("div",{className:"progression-bar__fill",style:{width:`${n.progressionMoyenne}%`}})})]})]}):t.jsx("p",{className:"modal-vide",children:"Aucune donne disponible pour ce cours."})})]})})}function ote(){const e=tt(),{currentUser:r}=Xe(),[n,a]=g.useState([]),[l,o]=g.useState([]),[u,d]=g.useState(!0),[m,p]=g.useState(null),[h,v]=g.useState(null),[b,x]=g.useState(""),[j,_]=g.useState(null);g.useEffect(()=>{r&&w()},[r]);async function w(){if(r){d(!0),p(null);try{const k=r.role==="admin"?await W5():await K5(r.uid);a(k),o(k)}catch{p("Impossible de charger les cours.")}finally{d(!1)}}}function C(k){x(k),o(k?n.filter(P=>P.statut===k):n)}async function E(k){if(confirm("Publier ce cours dans le catalogue ?"))try{await Ix(k),a(P=>P.map(D=>D.id===k?{...D,statut:"publie"}:D)),o(P=>P.map(D=>D.id===k?{...D,statut:"publie"}:D)),z(" Cours publi dans le catalogue !")}catch{p("Erreur lors de la publication.")}}async function S(k){if(confirm("Archiver ce cours ? Il ne sera plus visible dans le catalogue."))try{await J5(k),a(P=>P.map(D=>D.id===k?{...D,statut:"archive"}:D)),o(P=>P.map(D=>D.id===k?{...D,statut:"archive"}:D)),z(" Cours archiv.")}catch{p("Erreur lors de l'archivage.")}}async function A(k,P){if(confirm(`Supprimer dfinitivement le cours "${P}" et tout son contenu ? Cette action est irrversible.`))try{await eR(k);const D=n.filter($=>$.id!==k);a(D),o(D.filter($=>!b||$.statut===b)),z(" Cours supprim.")}catch{p("Erreur lors de la suppression.")}}function z(k){v(k),setTimeout(()=>v(null),4e3)}return t.jsxs("div",{className:"prof-cours-page",children:[t.jsxs("header",{className:"prof-cours-page__header",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"prof-cours-page__titre",children:" Mes cours en ligne"}),t.jsx("p",{className:"prof-cours-page__sous-titre",children:r?.role==="admin"?"Grez tous les cours de la plateforme. Seul l'admin peut crer des cours.":"Consultez les cours publis par vos collgues."})]}),r?.role==="admin"&&t.jsx("button",{className:"btn-primary",onClick:()=>e("/prof/cours/nouveau"),children:" Crer un cours"})]}),m&&t.jsxs("div",{className:"error-banner",role:"alert",children:[" ",m]}),h&&t.jsx("div",{className:"success-banner",role:"status",children:h}),!u&&n.length>0&&t.jsxs("div",{className:"prof-cours-page__stats","aria-label":"Rsum de mes cours",children:[t.jsxs("div",{className:"prof-cours-page__stat",children:[t.jsx("span",{className:"prof-cours-page__stat-val",children:n.length}),t.jsx("span",{children:"Total"})]}),t.jsxs("div",{className:"prof-cours-page__stat",children:[t.jsx("span",{className:"prof-cours-page__stat-val",style:{color:"#16a34a"},children:n.filter(k=>k.statut==="publie").length}),t.jsx("span",{children:"Publis"})]}),t.jsxs("div",{className:"prof-cours-page__stat",children:[t.jsx("span",{className:"prof-cours-page__stat-val",style:{color:"#ca8a04"},children:n.filter(k=>k.statut==="brouillon").length}),t.jsx("span",{children:"Brouillons"})]}),t.jsxs("div",{className:"prof-cours-page__stat",children:[t.jsx("span",{className:"prof-cours-page__stat-val",style:{color:"#2563eb"},children:n.reduce((k,P)=>k+P.nombreInscrits,0)}),t.jsx("span",{children:"lves inscrits"})]})]}),!u&&n.length>0&&t.jsx("div",{className:"prof-cours-page__filtres",role:"tablist","aria-label":"Filtrer par statut",children:[{val:"",label:`Tous (${n.length})`},{val:"publie",label:`Publis (${n.filter(k=>k.statut==="publie").length})`},{val:"brouillon",label:`Brouillons (${n.filter(k=>k.statut==="brouillon").length})`},{val:"archive",label:`Archivs (${n.filter(k=>k.statut==="archive").length})`}].map(k=>t.jsx("button",{className:`prof-cours-page__filtre-btn ${b===k.val?"prof-cours-page__filtre-btn--active":""}`,onClick:()=>C(k.val),role:"tab","aria-selected":b===k.val,children:k.label},k.val))}),t.jsxs("main",{className:"prof-cours-page__grille",children:[u&&t.jsx("div",{className:"prof-cours-page__grille-inner","aria-busy":"true",children:[1,2,3].map(k=>t.jsxs("div",{className:"prof-cours-card prof-cours-card--skeleton",children:[t.jsx("div",{className:"skeleton",style:{height:20,marginBottom:12}}),t.jsx("div",{className:"skeleton",style:{height:16,width:"60%",marginBottom:8}}),t.jsx("div",{className:"skeleton",style:{height:14,width:"80%"}})]},k))}),!u&&l.length>0&&t.jsx("div",{className:"prof-cours-page__grille-inner",children:l.map(k=>t.jsx(ste,{cours:k,onModifier:()=>e(`/prof/cours/${k.id}/modifier`),onPublier:()=>E(k.id),onArchiver:()=>S(k.id),onSupprimer:()=>A(k.id,k.titre),onVoirStats:()=>_(k)},k.id))}),!u&&l.length===0&&t.jsxs("div",{className:"prof-cours-page__vide",role:"status",children:[t.jsx("span",{"aria-hidden":"true",children:""}),t.jsx("h3",{children:n.length===0&&r?.role==="admin"?"Aucun cours sur la plateforme.":"Aucun cours dans cette catgorie."}),n.length===0&&r?.role==="admin"&&t.jsx("button",{className:"btn-primary",onClick:()=>e("/prof/cours/nouveau"),children:" Crer mon premier cours"})]})]}),j&&t.jsx(lte,{cours:j,onClose:()=>_(null)})]})}const ts={manuel:"Manuels scolaires",annale:"Annales corriges",guide:"Guides de rvision",litterature:"Culture gnrale & Littrature",fiche:"Fiches de lectures"},rs={manuel:"",annale:"",guide:"",litterature:"",fiche:""},bi="ebooks";async function cte(){try{const e=ze(_e(V,bi),Se("isActive","==",!0),Qe("ordre","asc"));return(await Ae(e)).docs.map(n=>({id:n.id,...n.data(),createdAt:n.data().createdAt?.toDate()||new Date,updatedAt:n.data().updatedAt?.toDate()||null}))}catch(e){throw console.error(" Erreur rcupration ebooks:",e),e}}async function ute(){try{const e=ze(_e(V,bi),Qe("ordre","asc"));return(await Ae(e)).docs.map(n=>({id:n.id,...n.data(),createdAt:n.data().createdAt?.toDate()||new Date,updatedAt:n.data().updatedAt?.toDate()||null}))}catch(e){throw console.error(" Erreur rcupration ebooks admin:",e),e}}async function dte(e){try{const r=await pt(je(V,bi,e));return r.exists()?{id:r.id,...r.data(),createdAt:r.data().createdAt?.toDate()||new Date,updatedAt:r.data().updatedAt?.toDate()||null}:null}catch(r){throw console.error(" Erreur rcupration ebook:",r),r}}function mte(e,r){let n=[...e];if(r.categorie&&r.categorie!=="all"&&(n=n.filter(a=>a.categorie===r.categorie)),r.niveau&&r.niveau!=="all"&&(n=n.filter(a=>a.niveau===r.niveau)),r.classe&&r.classe!=="all"){const a=uo(r.classe);n=n.filter(l=>l.classe==="all"?!0:uo(l.classe)===a)}if(r.matiere&&(n=n.filter(a=>a.matiere?.toLowerCase().includes(r.matiere.toLowerCase()))),r.recherche){const a=r.recherche.toLowerCase();n=n.filter(l=>l.titre.toLowerCase().includes(a)||l.auteur.toLowerCase().includes(a)||l.description.toLowerCase().includes(a)||l.tags?.some(o=>o.toLowerCase().includes(a)))}return n}async function fte(e,r,n,a,l){try{const o=cr(ar,`ebooks/pdf/${Date.now()}_${r.name}`);await $s(o,r);const u=await In(o);let d="";if(n){const v=cr(ar,`ebooks/covers/${Date.now()}_${n.name}`);await $s(v,n),d=await In(v)}let m="";if(a){const v=cr(ar,`ebooks/previews/${Date.now()}_${a.name}`);await $s(v,a),m=await In(v)}const p={...e,fichierURL:u,couvertureURL:d,aperuURL:m,tailleFichier:r.size,nombreTelechargements:0,nombreVues:0,uploadedBy:l||"admin",createdAt:kt(),updatedAt:kt()},h=await Ot(_e(V,bi),p);return console.log(` Ebook ajout : ${e.titre} (ID: ${h.id})`),h.id}catch(o){throw console.error(" Erreur ajout ebook:",o),o}}async function pte(e,r,n,a,l){try{const o={...r,updatedAt:kt()};if(n){const u=cr(ar,`ebooks/pdf/${Date.now()}_${n.name}`);await $s(u,n),o.fichierURL=await In(u),o.tailleFichier=n.size}if(a){const u=cr(ar,`ebooks/covers/${Date.now()}_${a.name}`);await $s(u,a),o.couvertureURL=await In(u)}if(l){const u=cr(ar,`ebooks/previews/${Date.now()}_${l.name}`);await $s(u,l),o.aperuURL=await In(u)}await Ve(je(V,bi,e),o),console.log(` Ebook mis  jour : ${e}`)}catch(o){throw console.error(" Erreur mise  jour ebook:",o),o}}async function hte(e){try{const r=await dte(e);if(!r)throw new Error("Ebook introuvable");try{if(r.fichierURL){const n=cr(ar,r.fichierURL);await Ls(n)}if(r.couvertureURL){const n=cr(ar,r.couvertureURL);await Ls(n)}if(r.aperuURL){const n=cr(ar,r.aperuURL);await Ls(n)}}catch{console.warn(" Fichiers Storage non supprims (peut-tre dj supprims)")}await Ir(je(V,bi,e)),console.log(` Ebook supprim : ${e}`)}catch(r){throw console.error(" Erreur suppression ebook:",r),r}}async function vte(e,r){try{await Ve(je(V,bi,e),{isActive:r,updatedAt:kt()})}catch(n){throw console.error(" Erreur toggle ebook:",n),n}}async function gte(e){try{await Ve(je(V,bi,e),{nombreVues:ss(1)})}catch(r){console.error(" Erreur incrment vues:",r)}}async function xte(e){try{await Ve(je(V,bi,e),{nombreTelechargements:ss(1)})}catch(r){console.error(" Erreur incrment tlchargements:",r)}}function bte(e){const r={totalEbooks:e.length,totalTelechargements:0,totalVues:0,parCategorie:{manuel:0,annale:0,guide:0,litterature:0,fiche:0},ebooksActifs:0};return e.forEach(n=>{r.totalTelechargements+=n.nombreTelechargements||0,r.totalVues+=n.nombreVues||0,r.parCategorie[n.categorie]=(r.parCategorie[n.categorie]||0)+1,n.isActive&&r.ebooksActifs++}),r}function Hc(e){return e<1024?`${e} o`:e<1024*1024?`${(e/1024).toFixed(1)} Ko`:`${(e/(1024*1024)).toFixed(1)} Mo`}const yte=["Mathmatiques","Physique-Chimie","SVT","Franais","Anglais","Histoire-Gographie","Philosophie","conomie","Comptabilit","ducation civique","Arabe","Espagnol","Informatique"],xA="Ce contenu est rserv aux utilisateurs Premium.",jte=({isPremium:e,onReadEbook:r})=>{const{matieres:n}=_n(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,m]=g.useState(null),[p,h]=g.useState({categorie:"all",niveau:"all",classe:"all",matiere:"",recherche:""}),[v,b]=g.useState("grid");g.useEffect(()=>{x()},[]);const x=async()=>{try{u(!0),m(null);const S=await cte();l(S)}catch(S){m(e?"Erreur lors du chargement de la bibliothque":xA),console.error(S)}finally{u(!1)}},j=g.useMemo(()=>mte(a,p),[a,p]),_=g.useMemo(()=>{const S={all:a.length};return a.forEach(A=>{S[A.categorie]=(S[A.categorie]||0)+1}),S},[a]),w=g.useMemo(()=>{const S=n.map(k=>k.valeur),A=[...new Set(a.map(k=>k.matiere).filter(Boolean))],z=[...new Set([...S,...A])].sort((k,P)=>k.localeCompare(P,"fr"));return z.length?z:yte},[n,a]),C=(S,A)=>{h(z=>({...z,[S]:A}))},E=()=>{h({categorie:"all",niveau:"all",classe:"all",matiere:"",recherche:""})};if(o)return t.jsx("div",{className:"ebook-library",children:t.jsxs("div",{className:"ebook-loading",children:[t.jsx("div",{className:"loading-spinner"}),t.jsx("p",{children:"Chargement de la bibliothque..."})]})});if(d){const S=d===xA;return t.jsx("div",{className:"ebook-library",children:t.jsxs("div",{className:"ebook-error",children:[t.jsxs("p",{children:[" ",d]}),S?t.jsx("a",{href:"/premium",className:"btn-retry",children:"Passer  Premium"}):t.jsx("button",{onClick:x,className:"btn-retry",children:"Ressayer"})]})})}return t.jsxs("div",{className:"ebook-library",children:[t.jsxs("div",{className:"ebook-library-header",children:[t.jsxs("div",{className:"ebook-header-content",children:[t.jsx("h1",{children:" Bibliothque PedaClic"}),t.jsxs("p",{className:"ebook-subtitle",children:["Manuels, annales, fiches de rvision et bien plus encore",!e&&t.jsx("span",{className:"preview-badge",children:"Aperu gratuit disponible"})]})]}),t.jsxs("div",{className:"ebook-search-bar",children:[t.jsx("input",{type:"text",placeholder:"Rechercher un ebook (titre, auteur, mot-cl)...",value:p.recherche||"",onChange:S=>C("recherche",S.target.value),className:"search-input"}),t.jsx("span",{className:"search-icon",children:""})]})]}),t.jsxs("div",{className:"ebook-categories",children:[t.jsxs("button",{className:`category-tab ${p.categorie==="all"?"active":""}`,onClick:()=>C("categorie","all"),children:[" Tous",t.jsx("span",{className:"category-count",children:_.all||0})]}),Object.keys(ts).map(S=>t.jsxs("button",{className:`category-tab ${p.categorie===S?"active":""}`,onClick:()=>C("categorie",S),children:[rs[S]," ",ts[S],t.jsx("span",{className:"category-count",children:_[S]||0})]},S))]}),t.jsxs("div",{className:"ebook-filters",children:[t.jsxs("select",{value:p.niveau||"all",onChange:S=>C("niveau",S.target.value),className:"filter-select",children:[t.jsx("option",{value:"all",children:"Tous les niveaux"}),t.jsx("option",{value:"college",children:"Collge"}),t.jsx("option",{value:"lycee",children:"Lyce"})]}),t.jsxs("select",{value:p.classe||"all",onChange:S=>C("classe",S.target.value),className:"filter-select",children:[t.jsx("option",{value:"all",children:"Toutes les classes"}),yr.map(S=>t.jsx("option",{value:S,children:S},S))]}),t.jsxs("select",{value:p.matiere||"",onChange:S=>C("matiere",S.target.value),className:"filter-select",children:[t.jsx("option",{value:"",children:"Toutes les matires"}),w.map(S=>t.jsx("option",{value:S,children:S},S))]}),t.jsxs("div",{className:"view-toggle",children:[t.jsx("button",{className:v==="grid"?"active":"",onClick:()=>b("grid"),title:"Vue grille",children:""}),t.jsx("button",{className:v==="list"?"active":"",onClick:()=>b("list"),title:"Vue liste",children:""})]}),(p.categorie!=="all"||p.niveau!=="all"||p.classe!=="all"||p.matiere||p.recherche)&&t.jsx("button",{onClick:E,className:"btn-reset-filters",children:" Rinitialiser"})]}),t.jsx("div",{className:"ebook-results-info",children:t.jsxs("span",{children:[j.length," ebook",j.length>1?"s":""," trouv",j.length>1?"s":""]})}),j.length===0?t.jsxs("div",{className:"ebook-empty",children:[t.jsx("p",{children:" Aucun ebook trouv avec ces filtres."}),t.jsx("button",{onClick:E,className:"btn-reset-filters",children:"Voir tous les ebooks"})]}):t.jsx("div",{className:`ebook-grid ${v==="list"?"list-view":""}`,children:j.map(S=>t.jsx(_te,{ebook:S,isPremium:e,onRead:()=>r(S),viewMode:v},S.id))}),!e&&j.length>0&&t.jsx("div",{className:"ebook-premium-banner",children:t.jsxs("div",{className:"premium-banner-content",children:[t.jsx("h3",{children:" Accdez  tous les ebooks en illimit"}),t.jsx("p",{children:"Abonnez-vous  PedaClic Premium pour lire et tlcharger tous les manuels, annales et fiches de rvision sans limite."}),t.jsx("a",{href:"/premium",className:"btn-premium",children:"S'abonner  2 000 FCFA/mois"})]})})]})},_te=({ebook:e,isPremium:r,onRead:n,viewMode:a})=>t.jsxs("div",{className:`ebook-card ${a==="list"?"ebook-card-list":""}`,children:[t.jsxs("div",{className:"ebook-cover",onClick:n,children:[e.couvertureURL?t.jsx("img",{src:e.couvertureURL,alt:e.titre,loading:"lazy"}):t.jsxs("div",{className:"ebook-cover-placeholder",children:[t.jsx("span",{className:"cover-icon",children:rs[e.categorie]}),t.jsx("span",{className:"cover-title",children:e.titre})]}),!r&&t.jsx("div",{className:"ebook-badge-premium",children:t.jsx("span",{children:" Premium"})}),t.jsx("div",{className:"ebook-badge-category",children:ts[e.categorie]})]}),t.jsxs("div",{className:"ebook-info",children:[t.jsx("h3",{className:"ebook-title",onClick:n,children:e.titre}),t.jsx("p",{className:"ebook-author",children:e.auteur}),t.jsx("p",{className:"ebook-description",children:e.description}),t.jsxs("div",{className:"ebook-meta",children:[e.classe!=="all"&&t.jsx("span",{className:"meta-tag",children:e.classe}),e.matiere&&t.jsx("span",{className:"meta-tag",children:e.matiere}),t.jsxs("span",{className:"meta-pages",children:[e.nombrePages," pages"]}),t.jsx("span",{className:"meta-size",children:Hc(e.tailleFichier)})]}),t.jsxs("div",{className:"ebook-actions",children:[t.jsx("button",{className:"btn-read",onClick:n,children:r?" Lire":` Aperu (${e.pagesApercu} pages)`}),r&&t.jsx("a",{href:e.fichierURL,target:"_blank",rel:"noopener noreferrer",className:"btn-download",download:!0,children:" Tlcharger"})]})]})]}),Nte=({ebook:e,isPremium:r,onBack:n,onGoPremium:a})=>{const[l,o]=g.useState(!0),[u,d]=g.useState("info");g.useEffect(()=>{gte(e.id)},[e.id]);const m=()=>r?e.fichierURL:e.aperuURL?e.aperuURL:null,p=async()=>{if(!r){a();return}await xte(e.id),window.open(e.fichierURL,"_blank")},h=()=>{o(!1)};return t.jsxs("div",{className:"ebook-viewer",children:[t.jsxs("div",{className:"viewer-navbar",children:[t.jsx("button",{onClick:n,className:"btn-back",children:" Retour  la bibliothque"}),t.jsxs("div",{className:"viewer-title-bar",children:[t.jsxs("span",{className:"viewer-category",children:[rs[e.categorie]," ",ts[e.categorie]]}),t.jsx("h2",{className:"viewer-title",children:e.titre})]}),t.jsxs("div",{className:"viewer-actions-bar",children:[t.jsx("button",{className:`btn-tab ${u==="info"?"active":""}`,onClick:()=>d("info"),children:" Dtails"}),t.jsxs("button",{className:`btn-tab ${u==="read"?"active":""}`,onClick:()=>d("read"),children:[" ",r?"Lire":"Aperu"]})]})]}),u==="info"&&t.jsx("div",{className:"viewer-info-panel",children:t.jsxs("div",{className:"info-layout",children:[t.jsxs("div",{className:"info-cover-column",children:[e.couvertureURL?t.jsx("img",{src:e.couvertureURL,alt:e.titre,className:"info-cover-image"}):t.jsxs("div",{className:"info-cover-placeholder",children:[t.jsx("span",{children:rs[e.categorie]}),t.jsx("span",{children:e.titre})]}),t.jsxs("div",{className:"info-actions",children:[t.jsxs("button",{className:"btn-action-read",onClick:()=>d("read"),children:[" ",r?"Lire le document":`Aperu (${e.pagesApercu} pages)`]}),r?t.jsx("button",{className:"btn-action-download",onClick:p,children:" Tlcharger le PDF"}):t.jsx("button",{className:"btn-action-premium",onClick:a,children:" Accs complet  Passer Premium"})]})]}),t.jsxs("div",{className:"info-details-column",children:[t.jsx("h1",{className:"info-title",children:e.titre}),t.jsxs("p",{className:"info-author",children:["par ",e.auteur]}),t.jsxs("div",{className:"info-description",children:[t.jsx("h3",{children:"Description"}),t.jsx("p",{children:e.description})]}),t.jsxs("div",{className:"info-metadata",children:[t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Catgorie"}),t.jsxs("span",{className:"metadata-value",children:[rs[e.categorie]," ",ts[e.categorie]]})]}),t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Niveau"}),t.jsx("span",{className:"metadata-value",children:e.niveau==="college"?"Collge":"Lyce"})]}),e.classe!=="all"&&t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Classe"}),t.jsx("span",{className:"metadata-value",children:e.classe})]}),e.matiere&&t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Matire"}),t.jsx("span",{className:"metadata-value",children:e.matiere})]}),t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Pages"}),t.jsx("span",{className:"metadata-value",children:e.nombrePages})]}),t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Taille"}),t.jsx("span",{className:"metadata-value",children:Hc(e.tailleFichier)})]}),e.annee&&t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Anne"}),t.jsx("span",{className:"metadata-value",children:e.annee})]}),e.editeur&&t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"diteur"}),t.jsx("span",{className:"metadata-value",children:e.editeur})]})]}),t.jsxs("div",{className:"info-stats",children:[t.jsxs("span",{children:[" ",e.nombreVues," vue",e.nombreVues>1?"s":""]}),t.jsxs("span",{children:[" ",e.nombreTelechargements," tlchargement",e.nombreTelechargements>1?"s":""]})]}),e.tags&&e.tags.length>0&&t.jsx("div",{className:"info-tags",children:e.tags.map((v,b)=>t.jsx("span",{className:"info-tag",children:v},b))})]})]})}),u==="read"&&t.jsx("div",{className:"viewer-read-panel",children:m()?t.jsxs(t.Fragment,{children:[l&&t.jsxs("div",{className:"viewer-loading",children:[t.jsx("div",{className:"loading-spinner"}),t.jsx("p",{children:"Chargement du document..."})]}),t.jsx("iframe",{src:`${m()}#toolbar=1&navpanes=0`,className:"pdf-iframe",title:e.titre,onLoad:h,style:{display:l?"none":"block"}}),!r&&t.jsx("div",{className:"viewer-premium-overlay",children:t.jsxs("div",{className:"overlay-content",children:[t.jsx("div",{className:"overlay-lock",children:""}),t.jsxs("h3",{children:["Aperu limit  ",e.pagesApercu," pages"]}),t.jsxs("p",{children:["Pour lire l'intgralit de ce document (",e.nombrePages," pages) et le tlcharger, passez  PedaClic Premium."]}),t.jsx("button",{onClick:a,className:"btn-overlay-premium",children:"Passer Premium  2 000 FCFA/mois"}),t.jsx("button",{onClick:n,className:"btn-overlay-back",children:"Retour  la bibliothque"})]})})]}):t.jsx("div",{className:"viewer-no-preview",children:t.jsxs("div",{className:"no-preview-content",children:[t.jsx("div",{className:"overlay-lock",children:""}),t.jsx("h3",{children:"Document rserv aux abonns Premium"}),t.jsxs("p",{children:["Ce document de ",e.nombrePages," pages est accessible uniquement avec un abonnement PedaClic Premium."]}),t.jsx("button",{onClick:a,className:"btn-overlay-premium",children:"Passer Premium  2 000 FCFA/mois"}),t.jsx("button",{onClick:n,className:"btn-overlay-back",children:"Retour  la bibliothque"})]})})})]})},Ste=()=>{const{currentUser:e}=Xe(),r=tt(),[n,a]=g.useState(null),l=d=>{a(d)},o=()=>{a(null)},u=()=>{r("/premium")};return n?t.jsx(Nte,{ebook:n,isPremium:e?.isPremium||!1,onBack:o,onGoPremium:u}):t.jsx(jte,{isPremium:e?.isPremium||!1,onReadEbook:l})},wte=()=>{_n();const[e,r]=g.useState([]),[n,a]=g.useState(!0),[l,o]=g.useState(null),[u,d]=g.useState(null),[m,p]=g.useState(!1),[h,v]=g.useState(null),[b,x]=g.useState(K()),[j,_]=g.useState(!1),[w,C]=g.useState(null),[E,S]=g.useState(null),[A,z]=g.useState(null),[k,P]=g.useState(null),D=g.useRef(null),$=g.useRef(null),F=g.useRef(null),[Y,M]=g.useState(null);function K(){return{titre:"",auteur:"",description:"",categorie:"manuel",niveau:"college",classe:"all",matiere:"",nombrePages:0,pagesApercu:5,annee:"",editeur:"",isbn:"",tags:[],ordre:0,isActive:!0}}g.useEffect(()=>{ee()},[]);const ee=async()=>{try{a(!0),o(null);const H=await ute();r(H),d(bte(H))}catch(H){o("Erreur lors du chargement des ebooks"),console.error(H)}finally{a(!1)}},X=H=>{const{name:ce,value:xe,type:fe}=H.target;x(fe==="number"?G=>({...G,[ce]:parseInt(xe)||0}):fe==="checkbox"?G=>({...G,[ce]:H.target.checked}):G=>({...G,[ce]:xe}))},L=H=>{const ce=H.target.value.split(",").map(xe=>xe.trim()).filter(Boolean);x(xe=>({...xe,tags:ce}))},I=async H=>{if(H.preventDefault(),!b.titre.trim()){o("Le titre est obligatoire");return}if(!h&&!E){o("Le fichier PDF est obligatoire");return}try{_(!0),o(null),h?(await pte(h.id,b,E,A,k),C(` Ebook "${b.titre}" modifi avec succs`)):(await fte(b,E,A,k),C(` Ebook "${b.titre}" ajout avec succs`)),Z(),await ee(),setTimeout(()=>C(null),4e3)}catch(ce){o(ce.message||"Erreur lors de la sauvegarde")}finally{_(!1)}},U=H=>{v(H),x({titre:H.titre,auteur:H.auteur,description:H.description,categorie:H.categorie,niveau:H.niveau,classe:H.classe,matiere:H.matiere||"",nombrePages:H.nombrePages,pagesApercu:H.pagesApercu,annee:H.annee||"",editeur:H.editeur||"",isbn:H.isbn||"",tags:H.tags||[],ordre:H.ordre,isActive:H.isActive}),p(!0),window.scrollTo({top:0,behavior:"smooth"})},B=async H=>{try{await hte(H),M(null),C(" Ebook supprim avec succs"),await ee(),setTimeout(()=>C(null),4e3)}catch(ce){o(ce.message||"Erreur lors de la suppression")}},T=async(H,ce)=>{try{await vte(H,!ce),await ee()}catch(xe){o(xe.message)}},Z=()=>{x(K()),v(null),S(null),z(null),P(null),p(!1),D.current&&(D.current.value=""),$.current&&($.current.value=""),F.current&&(F.current.value="")};return n?t.jsx("div",{className:"admin-ebooks",children:t.jsxs("div",{className:"admin-loading",children:[t.jsx("div",{className:"loading-spinner"}),t.jsx("p",{children:"Chargement des ebooks..."})]})}):t.jsxs("div",{className:"admin-ebooks",children:[t.jsxs("div",{className:"admin-ebooks-header",children:[t.jsx("h1",{children:" Gestion de la Bibliothque"}),t.jsx("button",{className:"btn-add-ebook",onClick:()=>{Z(),p(!m)},children:m?" Fermer":"+ Ajouter un ebook"})]}),l&&t.jsxs("div",{className:"admin-alert error",children:[" ",l]}),w&&t.jsx("div",{className:"admin-alert success",children:w}),u&&t.jsxs("div",{className:"admin-stats-grid",children:[t.jsxs("div",{className:"stat-card",children:[t.jsx("span",{className:"stat-number",children:u.totalEbooks}),t.jsx("span",{className:"stat-label",children:"Total ebooks"})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("span",{className:"stat-number",children:u.ebooksActifs}),t.jsx("span",{className:"stat-label",children:"Actifs"})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("span",{className:"stat-number",children:u.totalVues}),t.jsx("span",{className:"stat-label",children:"Vues totales"})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("span",{className:"stat-number",children:u.totalTelechargements}),t.jsx("span",{className:"stat-label",children:"Tlchargements"})]})]}),m&&t.jsxs("div",{className:"admin-ebook-form-container",children:[t.jsx("h2",{children:h?" Modifier l'ebook":" Ajouter un ebook"}),t.jsxs("form",{onSubmit:I,className:"admin-ebook-form",children:[t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"titre",children:"Titre *"}),t.jsx("input",{id:"titre",name:"titre",type:"text",value:b.titre,onChange:X,placeholder:"Ex: Mathmatiques 3me - Programme complet",required:!0})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"auteur",children:"Auteur(s) *"}),t.jsx("input",{id:"auteur",name:"auteur",type:"text",value:b.auteur,onChange:X,placeholder:"Ex: Pr. Diallo Moussa",required:!0})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"description",children:"Description *"}),t.jsx("textarea",{id:"description",name:"description",value:b.description,onChange:X,placeholder:"Dcrivez le contenu de cet ebook...",rows:3,required:!0})]}),t.jsxs("div",{className:"form-row form-row-3",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"categorie",children:"Catgorie *"}),t.jsx("select",{id:"categorie",name:"categorie",value:b.categorie,onChange:X,children:Object.keys(ts).map(H=>t.jsxs("option",{value:H,children:[rs[H]," ",ts[H]]},H))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"niveau",children:"Niveau *"}),t.jsxs("select",{id:"niveau",name:"niveau",value:b.niveau,onChange:X,children:[t.jsx("option",{value:"college",children:"Collge"}),t.jsx("option",{value:"lycee",children:"Lyce"})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"classe",children:"Classe"}),t.jsxs("select",{id:"classe",name:"classe",value:b.classe,onChange:X,children:[t.jsx("option",{value:"all",children:"Toutes les classes"}),yr.map(H=>t.jsx("option",{value:H,children:H},H))]})]})]}),t.jsxs("div",{className:"form-row form-row-3",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"matiere",children:"Matire"}),t.jsxs("select",{id:"matiere",name:"matiere",value:b.matiere,onChange:X,children:[t.jsx("option",{value:"",children:"-- Slectionner --"}),matieresOptions.map(H=>t.jsx("option",{value:H,children:H},H))]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"annee",children:"Anne"}),t.jsx("input",{id:"annee",name:"annee",type:"text",value:b.annee,onChange:X,placeholder:"Ex: 2024-2025"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"editeur",children:"diteur"}),t.jsx("input",{id:"editeur",name:"editeur",type:"text",value:b.editeur,onChange:X,placeholder:"Ex: INEADE"})]})]}),t.jsxs("div",{className:"form-row form-row-3",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"nombrePages",children:"Nombre de pages *"}),t.jsx("input",{id:"nombrePages",name:"nombrePages",type:"number",value:b.nombrePages,onChange:X,min:"1",required:!0})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"pagesApercu",children:"Pages en aperu gratuit"}),t.jsx("input",{id:"pagesApercu",name:"pagesApercu",type:"number",value:b.pagesApercu,onChange:X,min:"1",max:"20"}),t.jsx("small",{children:"Nombre de pages visibles sans Premium (1-20)"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"ordre",children:"Ordre d'affichage"}),t.jsx("input",{id:"ordre",name:"ordre",type:"number",value:b.ordre,onChange:X,min:"0"})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"tags",children:"Tags (spars par des virgules)"}),t.jsx("input",{id:"tags",type:"text",value:b.tags?.join(", ")||"",onChange:L,placeholder:"Ex: BFEM, annales, mathmatiques, gomtrie"})]}),t.jsxs("div",{className:"form-files-section",children:[t.jsx("h3",{children:" Fichiers"}),t.jsxs("div",{className:"form-group file-group",children:[t.jsxs("label",{children:["Fichier PDF complet ",!h&&"*",h&&t.jsx("small",{children:"(laisser vide pour garder l'actuel)"})]}),t.jsx("input",{ref:D,type:"file",accept:".pdf",onChange:H=>S(H.target.files?.[0]||null),className:"file-input"}),E&&t.jsxs("span",{className:"file-info",children:[" ",E.name," (",Hc(E.size),")"]})]}),t.jsxs("div",{className:"form-group file-group",children:[t.jsxs("label",{children:["Image de couverture",t.jsx("small",{children:"(JPG, PNG  recommand : 400560px)"})]}),t.jsx("input",{ref:$,type:"file",accept:"image/*",onChange:H=>z(H.target.files?.[0]||null),className:"file-input"}),A&&t.jsxs("span",{className:"file-info",children:[" ",A.name," (",Hc(A.size),")"]})]}),t.jsxs("div",{className:"form-group file-group",children:[t.jsxs("label",{children:["PDF Aperu (premires pages uniquement)",t.jsx("small",{children:"(optionnel  sinon le PDF complet est affich aux non-Premium)"})]}),t.jsx("input",{ref:F,type:"file",accept:".pdf",onChange:H=>P(H.target.files?.[0]||null),className:"file-input"}),k&&t.jsxs("span",{className:"file-info",children:[" ",k.name," (",Hc(k.size),")"]})]})]}),t.jsx("div",{className:"form-group checkbox-group",children:t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",name:"isActive",checked:b.isActive,onChange:X}),"Ebook actif (visible dans la bibliothque)"]})}),t.jsxs("div",{className:"form-actions",children:[t.jsx("button",{type:"submit",className:"btn-save",disabled:j,children:j?" Enregistrement...":h?" Modifier l'ebook":" Ajouter l'ebook"}),t.jsx("button",{type:"button",className:"btn-cancel",onClick:Z,children:"Annuler"})]})]})]}),t.jsxs("div",{className:"admin-ebooks-list",children:[t.jsxs("h2",{children:[" Liste des ebooks (",e.length,")"]}),e.length===0?t.jsxs("div",{className:"admin-empty",children:[t.jsx("p",{children:"Aucun ebook pour le moment."}),t.jsx("button",{className:"btn-add-ebook",onClick:()=>p(!0),children:"+ Ajouter le premier ebook"})]}):t.jsx("div",{className:"admin-ebooks-table-wrapper",children:t.jsxs("table",{className:"admin-ebooks-table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Couverture"}),t.jsx("th",{children:"Titre / Auteur"}),t.jsx("th",{children:"Catgorie"}),t.jsx("th",{children:"Classe"}),t.jsx("th",{children:"Pages"}),t.jsx("th",{children:"Vues / DL"}),t.jsx("th",{children:"Statut"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:e.map(H=>t.jsxs("tr",{className:H.isActive?"":"row-inactive",children:[t.jsx("td",{className:"td-cover",children:H.couvertureURL?t.jsx("img",{src:H.couvertureURL,alt:"",className:"mini-cover"}):t.jsx("div",{className:"mini-cover-placeholder",children:rs[H.categorie]})}),t.jsxs("td",{className:"td-title",children:[t.jsx("strong",{children:H.titre}),t.jsx("span",{className:"td-author",children:H.auteur})]}),t.jsx("td",{children:t.jsxs("span",{className:"badge-category",children:[rs[H.categorie]," ",ts[H.categorie]]})}),t.jsx("td",{children:H.classe==="all"?"Toutes":H.classe}),t.jsx("td",{children:H.nombrePages}),t.jsx("td",{children:t.jsxs("span",{className:"td-stats",children:[" ",H.nombreVues,t.jsx("br",{})," ",H.nombreTelechargements]})}),t.jsx("td",{children:t.jsx("button",{className:`btn-status ${H.isActive?"active":"inactive"}`,onClick:()=>T(H.id,H.isActive),title:H.isActive?"Dsactiver":"Activer",children:H.isActive?" Actif":" Inactif"})}),t.jsxs("td",{className:"td-actions",children:[t.jsx("button",{className:"btn-edit",onClick:()=>U(H),title:"Modifier",children:""}),Y===H.id?t.jsxs("div",{className:"delete-confirm",children:[t.jsx("span",{children:"Supprimer ?"}),t.jsx("button",{className:"btn-confirm-yes",onClick:()=>B(H.id),children:"Oui"}),t.jsx("button",{className:"btn-confirm-no",onClick:()=>M(null),children:"Non"})]}):t.jsx("button",{className:"btn-delete",onClick:()=>M(H.id),title:"Supprimer",children:""})]})]},H.id))})]})})]})]})},Fn="mediatheque",$M="mediatheque_vues";async function bA(e={},r=50){let n=ze(_e(V,Fn),Se("statut","==","publie"),Qe("createdAt","desc"),$t(r));e.type&&e.type!=="all"&&(n=ze(_e(V,Fn),Se("statut","==","publie"),Se("type","==",e.type),Qe("createdAt","desc"),$t(r)));let l=(await Ae(n)).docs.map(o=>({id:o.id,...o.data()}));if(e.discipline&&(l=l.filter(o=>o.discipline===e.discipline)),e.niveau&&(l=l.filter(o=>o.niveau===e.niveau)),e.acces==="gratuit"?l=l.filter(o=>!o.isPremium):e.acces==="premium"&&(l=l.filter(o=>o.isPremium)),e.recherche?.trim()){const o=e.recherche.toLowerCase().trim();l=l.filter(u=>u.titre.toLowerCase().includes(o)||u.description.toLowerCase().includes(o)||(u.tags??[]).some(d=>d.toLowerCase().includes(o)))}return l}async function Cte(e){const r=ze(_e(V,Fn),Se("auteurId","==",e),Qe("createdAt","desc"));return(await Ae(r)).docs.map(a=>({id:a.id,...a.data()}))}async function Ete(){const e=ze(_e(V,Fn),Qe("createdAt","desc"));return(await Ae(e)).docs.map(n=>({id:n.id,...n.data()}))}async function BM(e){const r=await pt(je(V,Fn,e));return r.exists()?{id:r.id,...r.data()}:null}async function Ate(e,r,n=4){const a=ze(_e(V,Fn),Se("statut","==","publie"),Se("discipline","==",r),Qe("vues","desc"),$t(n+1));return(await Ae(a)).docs.map(o=>({id:o.id,...o.data()})).filter(o=>o.id!==e).slice(0,n)}async function zte(e,r,n){const a=Ee.now();return(await Ot(_e(V,Fn),{...e,auteurId:r,auteurNom:n,vues:0,tags:e.tags??[],statut:e.statut??"brouillon",createdAt:a,updatedAt:a})).id}async function Vc(e,r){await Ve(je(V,Fn,e),{...r,updatedAt:Ee.now()})}async function kte(e,r){await Ve(je(V,Fn,e),{statut:r,updatedAt:Ee.now()})}async function Ote(e,r){await Ve(je(V,Fn,e),{isPremium:r,updatedAt:Ee.now()})}async function Dte(e){if(await Ir(je(V,Fn,e.id)),e.url.includes("firebasestorage"))try{const r=cr(ar,yA(e.url));await Ls(r)}catch{console.warn("[Mdiathque] Fichier principal introuvable en Storage, ignor.")}if(e.thumbnailUrl?.includes("firebasestorage"))try{const r=cr(ar,yA(e.thumbnailUrl));await Ls(r)}catch{console.warn("[Mdiathque] Vignette introuvable en Storage, ignore.")}}async function Pte(e,r,n,a,l){const o=new Date().getFullYear();let u,d;switch(n){case"video":u=`mediatheque/videos/${a}/${r}`,d="video.mp4";break;case"audio":u=`mediatheque/audios/${a}/${r}`,d="audio.mp3";break;case"podcast":u=`mediatheque/audios/${a}/${r}`,d="podcast.mp3";break;case"webinaire":u=`mediatheque/webinaires/${o}/${r}`,d="enregistrement.mp4";break}const m=cr(ar,`${u}/${d}`),p=uu(m,e,{contentType:e.type,customMetadata:{mediaId:r,discipline:a}});return new Promise((h,v)=>{p.on("state_changed",b=>{const x=Math.round(b.bytesTransferred/b.totalBytes*100);l?.(x)},b=>{console.error("[Mdiathque] Erreur upload :",b),v(new Error(`chec de l'upload : ${b.message}`))},async()=>{const b=await In(p.snapshot.ref);h(b)})})}async function UM(e,r){const n=e.name.split(".").pop()?.toLowerCase()??"jpg",a=cr(ar,`mediatheque/thumbnails/${r}/thumb.${n}`),l=uu(a,e,{contentType:e.type});return new Promise((o,u)=>{l.on("state_changed",()=>{},u,async()=>{const d=await In(l.snapshot.ref);o(d)})})}async function Mte(e){await Ve(je(V,Fn,e),{vues:ss(1)})}async function Tte(e,r,n,a,l){const o=`${e}_${r}`,u=l>0&&n/l>=.8;await rl(je(V,$M,o),{mediaId:r,userId:e,dureeVisionnee:n,positionReprise:a,estTermine:u,vueAt:Ee.now()},{merge:!0})}async function qte(e,r){const n=`${e}_${r}`,a=await pt(je(V,$M,n));return a.exists()?{id:a.id,...a.data()}:null}function yA(e){try{const n=new URL(e).pathname.match(/\/o\/(.+)$/);if(n)return decodeURIComponent(n[1])}catch{}return""}const ya={video:{label:"Vido",emoji:"",couleur:"#2563eb",bg:"#eff6ff",accept:"video/*"},audio:{label:"Audio",emoji:"",couleur:"#7c3aed",bg:"#f5f3ff",accept:"audio/*"},podcast:{label:"Podcast",emoji:"",couleur:"#059669",bg:"#ecfdf5",accept:"audio/*"},webinaire:{label:"Webinaire",emoji:"",couleur:"#d97706",bg:"#fffbeb",accept:"video/*"}},Ef={publie:{label:"Publi",couleur:"#16a34a",bg:"#f0fdf4"},brouillon:{label:"Brouillon",couleur:"#6b7280",bg:"#f3f4f6"},planifiee:{label:"Planifi",couleur:"#2563eb",bg:"#eff6ff"},archive:{label:"Archiv",couleur:"#9ca3af",bg:"#f9fafb"}},Gb=30;function Af(e){const r=Math.floor(e/3600),n=Math.floor(e%3600/60),a=Math.floor(e%60);return r>0?`${r}:${String(n).padStart(2,"0")}:${String(a).padStart(2,"0")}`:`${n}:${String(a).padStart(2,"0")}`}function Rte({media:e,isPremium:r,onClick:n,isAdmin:a,onEdit:l,onDelete:o,onTogglePremium:u,onSetStatut:d}){const m=ya[e.type],p=!e.isPremium||r;return t.jsxs("article",{className:`media-card ${a?"media-card--admin":""}`,onClick:a?void 0:n,role:a?void 0:"button",tabIndex:a?void 0:0,onKeyDown:a?void 0:(h=>h.key==="Enter"&&n()),"aria-label":a?void 0:`Lire : ${e.titre}`,children:[t.jsxs("div",{className:"media-card__vignette",children:[e.thumbnailUrl?t.jsx("img",{src:e.thumbnailUrl,alt:e.titre,className:"media-card__image",loading:"lazy"}):t.jsx("div",{className:"media-card__vignette-default",children:t.jsx("span",{children:m.emoji})}),e.duree>0&&t.jsx("span",{className:"media-card__duree",children:Af(e.duree)}),e.isPremium?t.jsx("span",{className:"media-card__badge-premium",children:" Premium"}):t.jsx("span",{className:"media-card__badge-gratuit",children:" Gratuit"}),e.isPremium&&!p&&t.jsx("div",{className:"media-card__apercu-overlay",children:" Aperu 30 secondes"}),t.jsx("div",{className:"media-card__play","aria-hidden":"true",children:t.jsx("div",{className:"media-card__play-icone",children:""})})]}),a&&l&&o&&u&&d&&t.jsxs("div",{className:"media-card__admin-actions",onClick:h=>h.stopPropagation(),children:[t.jsx("button",{type:"button",className:"media-card__admin-btn media-card__admin-btn--edit",onClick:()=>l(e),title:"Modifier",children:""}),t.jsx("button",{type:"button",className:`media-card__admin-btn ${e.isPremium?"media-card__admin-btn--premium":""}`,onClick:()=>u(e),title:e.isPremium?"Passer en gratuit":"Passer en Premium",children:e.isPremium?"":""}),t.jsx("select",{className:"media-card__admin-select",value:e.statut,onChange:h=>d(e,h.target.value),onClick:h=>h.stopPropagation(),title:"Statut",children:Object.entries(Ef).map(([h,v])=>t.jsx("option",{value:h,children:v.label},h))}),t.jsx("button",{type:"button",className:"media-card__admin-btn media-card__admin-btn--view",onClick:()=>n(),title:"Voir",children:""}),t.jsx("button",{type:"button",className:"media-card__admin-btn media-card__admin-btn--delete",onClick:()=>o(e),title:"Supprimer",children:""})]}),t.jsxs("div",{className:"media-card__corps",onClick:a?()=>n():void 0,style:a?{cursor:"pointer"}:void 0,children:[t.jsxs("span",{className:"media-card__type",style:{backgroundColor:m.bg,color:m.couleur},children:[m.emoji," ",m.label]}),t.jsx("h3",{className:"media-card__titre",children:e.titre}),t.jsxs("p",{className:"media-card__auteur",children:["Par ",e.auteurNom]}),t.jsxs("div",{className:"media-card__footer",children:[t.jsxs("div",{className:"media-card__meta",children:[t.jsx("span",{className:"media-card__discipline",children:e.discipline}),t.jsxs("span",{className:"media-card__classe",children:[e.niveau," ",e.classe?` ${e.classe}`:""]})]}),t.jsxs("span",{className:"media-card__vues",children:[" ",e.vues.toLocaleString("fr-SN")]})]})]})]})}function Ite(){const{currentUser:e}=Xe(),r=tt(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[m,p]=g.useState({type:"all",discipline:"",niveau:"",recherche:"",acces:"all",statut:""}),[h,v]=g.useState(null),[b,x]=g.useState(!1),[j,_]=g.useState(null),{matieres:w}=_n(),C=g.useMemo(()=>{const M=n.length,K=n.filter(L=>L.type==="video").length,ee=n.filter(L=>L.type==="audio"||L.type==="podcast").length,X=n.filter(L=>L.type==="webinaire").length;return{total:M,videos:K,audios:ee,webs:X}},[n]),E=g.useMemo(()=>n.filter(M=>{if(m.type!=="all"&&M.type!==m.type||m.discipline&&M.discipline!==m.discipline||m.niveau&&M.niveau!==m.niveau||m.acces==="gratuit"&&M.isPremium||m.acces==="premium"&&!M.isPremium||m.statut&&M.statut!==m.statut)return!1;if(m.recherche.trim()){const K=m.recherche.toLowerCase().trim();return M.titre.toLowerCase().includes(K)||M.description.toLowerCase().includes(K)||M.discipline.toLowerCase().includes(K)||(M.tags??[]).some(ee=>ee.toLowerCase().includes(K))}return!0}),[n,m]);g.useEffect(()=>{async function M(){try{o(!0),d(null);let K;if(e?.role==="admin")K=await Ete();else if(e?.role==="prof"){const[ee,X]=await Promise.all([bA(),Cte(e.uid)]),L=new Set(ee.map(U=>U.id)),I=X.filter(U=>!L.has(U.id));K=[...ee,...I]}else K=await bA();a(K)}catch(K){console.error("[Mdiathque] Erreur chargement :",K),d("Impossible de charger la mdiathque. Vrifiez votre connexion.")}finally{o(!1)}}M()},[e]);const S=(M,K)=>{p(ee=>({...ee,[M]:K}))},A=()=>{p({type:"all",discipline:"",niveau:"",recherche:"",acces:"all",statut:""})},z=M=>{r(`/mediatheque/${M}`)},k=e?.role==="admin",P=M=>{r(`/mediatheque/${M.id}/modifier`)},D=M=>{v(M)},$=async()=>{if(h){x(!0);try{await Dte(h),a(M=>M.filter(K=>K.id!==h.id)),_("Contenu supprim."),setTimeout(()=>_(null),2e3)}catch(M){console.error("[Mdiathque] Erreur suppression:",M),_("Erreur lors de la suppression.")}finally{x(!1),v(null)}}},F=async M=>{try{await Ote(M.id,!M.isPremium),a(K=>K.map(ee=>ee.id===M.id?{...ee,isPremium:!ee.isPremium}:ee)),_(M.isPremium?"Pass en gratuit":"Pass en Premium"),setTimeout(()=>_(null),2e3)}catch{_("Erreur")}},Y=async(M,K)=>{try{await kte(M.id,K),a(ee=>ee.map(X=>X.id===M.id?{...X,statut:K}:X)),_(`Statut : ${Ef[K].label}`),setTimeout(()=>_(null),2e3)}catch{_("Erreur")}};return t.jsxs("div",{className:"mediatheque-page",children:[t.jsxs("section",{className:"mediatheque-hero","aria-label":"En-tte mdiathque",children:[t.jsx("h1",{className:"mediatheque-hero__titre",children:" Mdiathque PedaClic"}),t.jsx("p",{className:"mediatheque-hero__sous-titre",children:"Cours en vido, podcasts pdagogiques et webinaires  L'cole en un clic"}),t.jsxs("div",{className:"mediatheque-hero__stats","aria-label":"Statistiques des contenus",children:[t.jsxs("div",{className:"mediatheque-hero__stat",children:[t.jsx("span",{className:"mediatheque-hero__stat-nombre",children:C.total}),t.jsx("span",{className:"mediatheque-hero__stat-label",children:"Contenus"})]}),t.jsxs("div",{className:"mediatheque-hero__stat",children:[t.jsx("span",{className:"mediatheque-hero__stat-nombre",children:C.videos}),t.jsx("span",{className:"mediatheque-hero__stat-label",children:"Vidos"})]}),t.jsxs("div",{className:"mediatheque-hero__stat",children:[t.jsx("span",{className:"mediatheque-hero__stat-nombre",children:C.audios}),t.jsx("span",{className:"mediatheque-hero__stat-label",children:"Audio"})]}),t.jsxs("div",{className:"mediatheque-hero__stat",children:[t.jsx("span",{className:"mediatheque-hero__stat-nombre",children:C.webs}),t.jsx("span",{className:"mediatheque-hero__stat-label",children:"Webinaires"})]})]})]}),t.jsxs("nav",{className:"mediatheque-filtres","aria-label":"Filtres de la mdiathque",children:[t.jsxs("div",{className:"mediatheque-filtres__ligne",children:[t.jsxs("div",{className:"mediatheque-filtres__recherche",children:[t.jsx("span",{className:"mediatheque-filtres__recherche-icone","aria-hidden":!0,children:""}),t.jsx("input",{type:"search",className:"mediatheque-filtres__recherche-input",placeholder:"Rechercher un cours, une matire, un tag...",value:m.recherche,onChange:M=>S("recherche",M.target.value),"aria-label":"Rechercher dans la mdiathque"})]}),t.jsxs("select",{className:"mediatheque-filtres__select",value:m.discipline,onChange:M=>S("discipline",M.target.value),"aria-label":"Filtrer par discipline",children:[t.jsx("option",{value:"",children:"Toutes les matires"}),w.map(M=>t.jsx("option",{value:M.valeur,children:M.label},M.valeur))]}),t.jsxs("select",{className:"mediatheque-filtres__select",value:m.niveau,onChange:M=>S("niveau",M.target.value),"aria-label":"Filtrer par niveau",children:[t.jsx("option",{value:"",children:"Tous les niveaux"}),yr.map(M=>t.jsx("option",{value:M,children:M},M))]}),t.jsxs("select",{className:"mediatheque-filtres__select",value:m.acces,onChange:M=>S("acces",M.target.value),"aria-label":"Filtrer par type d'accs",children:[t.jsx("option",{value:"all",children:"Tout l'accs"}),t.jsx("option",{value:"gratuit",children:" Gratuit"}),t.jsx("option",{value:"premium",children:" Premium"})]}),k&&t.jsxs("select",{className:"mediatheque-filtres__select",value:m.statut||"",onChange:M=>p(K=>({...K,statut:M.target.value})),"aria-label":"Filtrer par statut",children:[t.jsx("option",{value:"",children:"Tous les statuts"}),Object.entries(Ef).map(([M,K])=>t.jsx("option",{value:M,children:K.label},M))]}),(e?.role==="admin"||e?.role==="prof")&&t.jsx("button",{className:"btn-principal",onClick:()=>r("/mediatheque/ajouter"),"aria-label":"Ajouter un nouveau contenu",children:"+ Ajouter"})]}),t.jsxs("div",{className:"mediatheque-filtres__types",role:"group","aria-label":"Filtrer par type",children:[t.jsx("button",{className:`mediatheque-filtres__type-btn${m.type==="all"?" mediatheque-filtres__type-btn--actif":""}`,onClick:()=>S("type","all"),"aria-pressed":m.type==="all",children:" Tous"}),Object.entries(ya).map(([M,K])=>t.jsxs("button",{className:`mediatheque-filtres__type-btn${m.type===M?" mediatheque-filtres__type-btn--actif":""}`,onClick:()=>S("type",M),"aria-pressed":m.type===M,children:[K.emoji," ",K.label]},M))]})]}),t.jsxs("main",{className:"mediatheque-contenu",children:[t.jsxs("div",{className:"mediatheque-catalogue__header",children:[t.jsx("h2",{className:"mediatheque-catalogue__titre",children:m.type==="all"?"Tous les contenus":ya[m.type]?.label??"Contenus"}),!l&&t.jsxs("span",{className:"mediatheque-catalogue__compteur",children:[E.length," rsultat",E.length!==1?"s":""]})]}),l&&t.jsxs("div",{className:"mediatheque-chargement",role:"status","aria-live":"polite",children:[t.jsx("div",{className:"mediatheque-spinner","aria-hidden":"true"}),t.jsx("p",{children:"Chargement de la mdiathque..."})]}),!l&&u&&t.jsxs("div",{className:"mediatheque-vide",role:"alert",children:[t.jsx("span",{className:"mediatheque-vide__emoji",children:""}),t.jsx("h3",{className:"mediatheque-vide__titre",children:"Erreur de chargement"}),t.jsx("p",{className:"mediatheque-vide__message",children:u}),t.jsx("button",{className:"btn-principal",onClick:()=>window.location.reload(),children:" Ressayer"})]}),!l&&!u&&E.length===0&&t.jsxs("div",{className:"mediatheque-vide",role:"status",children:[t.jsx("span",{className:"mediatheque-vide__emoji",children:""}),t.jsx("h3",{className:"mediatheque-vide__titre",children:"Aucun contenu trouv"}),t.jsx("p",{className:"mediatheque-vide__message",children:n.length===0?"La mdiathque ne contient pas encore de contenus publis.":"Aucun contenu ne correspond  vos critres de recherche."}),(m.type!=="all"||m.discipline||m.niveau||m.recherche||m.acces!=="all"||m.statut)&&t.jsx("button",{className:"btn-secondaire",onClick:A,children:"Rinitialiser les filtres"})]}),!l&&!u&&E.length>0&&t.jsx("div",{className:"mediatheque-grille",role:"list","aria-label":"Liste des contenus multimdias",children:E.map(M=>t.jsx("div",{role:"listitem",children:t.jsx(Rte,{media:M,isPremium:e?.isPremium??!1,onClick:()=>z(M.id),isAdmin:k,onEdit:k?P:void 0,onDelete:k?D:void 0,onTogglePremium:k?F:void 0,onSetStatut:k?Y:void 0})},M.id))}),j&&t.jsx("div",{className:"mediatheque-toast",role:"status",children:j}),h&&t.jsx("div",{className:"mediatheque-modal-overlay",onClick:()=>v(null),children:t.jsxs("div",{className:"mediatheque-modal",onClick:M=>M.stopPropagation(),children:[t.jsx("h3",{children:"Supprimer ce contenu ?"}),t.jsxs("p",{children:[" ",h.titre,"  sera dfinitivement supprim."]}),t.jsxs("div",{className:"mediatheque-modal__actions",children:[t.jsx("button",{type:"button",className:"btn-secondaire",onClick:()=>v(null),children:"Annuler"}),t.jsx("button",{type:"button",className:"btn-principal",style:{background:"#dc2626"},onClick:$,disabled:b,children:b?"Suppression":"Supprimer"})]})]})})]})]})}function Lte(e){if(!e)return null;try{const r=new URL(e);if(r.hostname==="youtu.be")return r.pathname.slice(1).split("?")[0]||null;if(r.hostname.includes("youtube.com")){const n=r.searchParams.get("v");if(n)return n;const a=r.pathname.split("/").filter(Boolean),l=a.findIndex(o=>o==="embed"||o==="shorts");if(l!==-1&&a[l+1])return a[l+1]}}catch{}return null}function $te(e,r=0){const n=new URLSearchParams({rel:"0",modestbranding:"1",enablejsapi:"0",origin:window.location.origin,...r>5?{start:String(Math.floor(r))}:{}});return`https://www.youtube-nocookie.com/embed/${e}?${n.toString()}`}function Bte({url:e,mimeType:r,titre:n,thumbnailUrl:a,aAccesPremium:l,positionInitiale:o,onTempsChange:u,onAperuTermine:d}){const m=g.useRef(null),p=g.useRef(null),[h,v]=g.useState(!1),[b,x]=g.useState(o>5),[j,_]=g.useState(null),w=Lte(e),C=w!==null,E=C?$te(w,o):null;g.useEffect(()=>{if(v(!1),_(null),p.current&&clearInterval(p.current),C&&!l){let D=0;p.current=setInterval(()=>{D+=1,u(D),D>=Gb&&(clearInterval(p.current),v(!0),d())},1e3)}return()=>{p.current&&clearInterval(p.current)}},[e,l,C,u,d]);const S=()=>{if(!m.current)return;const D=m.current.currentTime;u(D),!l&&D>=Gb&&(m.current.pause(),v(!0),d())},A=()=>{const D=m.current;let $="Impossible de charger la vido.";if(!e||e.trim()==="")$="Aucune URL vido configure pour ce contenu.";else if(D?.error)switch(D.error.code){case MediaError.MEDIA_ERR_NETWORK:$="Erreur rseau  vrifiez votre connexion.";break;case MediaError.MEDIA_ERR_DECODE:$="Format vido non support par ce navigateur.";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:$="Fichier introuvable ou format non support.";break;default:$=`Erreur de lecture (code ${D.error.code}).`}_($)},z=()=>{m.current&&(m.current.currentTime=o,m.current.play().catch(console.warn),x(!1))},k=()=>{m.current&&(m.current.currentTime=0,m.current.play().catch(console.warn),x(!1))},P=r||"video/mp4";return t.jsxs("div",{className:"media-player",children:[t.jsxs("div",{className:"media-player__video-wrapper",children:[C&&!h&&E&&t.jsx("iframe",{src:E,title:n,className:"media-player__video",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,style:{border:"none"},"aria-label":`Lecteur YouTube : ${n}`}),!C&&!j&&t.jsxs("video",{ref:m,className:"media-player__video",controls:!0,preload:"metadata",poster:a,onTimeUpdate:S,onError:A,playsInline:!0,"aria-label":`Lecteur vido : ${n}`,children:[e&&e.trim()!==""&&t.jsx("source",{src:e,type:P}),t.jsx("p",{children:"Votre navigateur ne supporte pas la lecture vido HTML5."})]}),!C&&j&&t.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#0f172a",color:"white",gap:"0.75rem",padding:"2rem",textAlign:"center"},role:"alert",children:[t.jsx("span",{style:{fontSize:"2.5rem"},children:""}),t.jsx("p",{style:{margin:0,fontWeight:700},children:"Vido indisponible"}),t.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7,maxWidth:300},children:j}),t.jsx("button",{type:"button",style:{marginTop:"0.5rem",background:"#2563eb",color:"white",border:"none",padding:"0.5rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem"},onClick:()=>{_(null),m.current&&m.current.load()},children:" Ressayer"})]}),!C&&!j&&(!e||e.trim()==="")&&t.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#0f172a",color:"rgba(255,255,255,0.5)",gap:"0.5rem"},children:[t.jsx("span",{style:{fontSize:"3rem"},children:""}),t.jsx("p",{style:{margin:0,fontSize:"0.9rem"},children:"Aucun fichier vido configur"})]}),h&&t.jsxs("div",{className:"media-player__overlay-premium",role:"dialog","aria-modal":!0,children:[t.jsx("div",{style:{fontSize:"3rem"},children:""}),t.jsx("h3",{children:"Aperu termin"}),t.jsx("p",{children:"Abonnez-vous  PedaClic Premium pour accder  la totalit de ce contenu et  toute la mdiathque."}),t.jsx($e,{to:"/premium",className:"btn-premium-overlay",children:" Devenir Premium  2 000 FCFA/mois"})]})]}),!C&&b&&o>5&&t.jsxs("div",{className:"media-player__reprise",role:"complementary",children:[t.jsxs("span",{className:"media-player__reprise-texte",children:[" Reprendre  ",Af(o)]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{type:"button",className:"btn-secondaire",style:{fontSize:"0.8rem",padding:"0.3rem 0.75rem"},onClick:k,children:"Depuis le dbut"}),t.jsx("button",{type:"button",className:"media-player__reprise-btn",onClick:z,children:"Reprendre"})]})]}),t.jsx("div",{className:"media-player__progression-barre","aria-hidden":"true",title:"Progression de visionnage",children:t.jsx("div",{className:"media-player__progression-rempli",style:{width:m.current?.duration?`${o/m.current.duration*100}%`:"0%"}})})]})}function Ute({url:e,titre:r,thumbnailUrl:n,typeMedia:a,aAccesPremium:l,positionInitiale:o,onTempsChange:u,onAperuTermine:d}){const m=g.useRef(null),[p,h]=g.useState(!1),v=()=>{if(!m.current)return;const j=m.current.currentTime;u(j),!l&&j>=Gb&&(m.current.pause(),h(!0),d())},b=()=>{m.current&&o>5&&(m.current.currentTime=o)},x=ya[a];return t.jsxs("div",{className:"media-player",style:{position:"relative"},children:[t.jsxs("div",{className:"media-player__audio-wrapper",children:[n?t.jsx("img",{src:n,alt:r,className:"media-player__audio-art"}):t.jsx("div",{className:"media-player__audio-art-placeholder",children:x.emoji}),t.jsx("p",{className:"media-player__audio-titre",children:r}),t.jsxs("audio",{ref:m,className:"media-player__audio",controls:!0,preload:"metadata",onLoadedMetadata:b,onTimeUpdate:v,"aria-label":`Lecteur audio : ${r}`,children:[e&&e.trim()!==""&&t.jsx("source",{src:e,type:"audio/mpeg"}),t.jsx("p",{children:"Votre navigateur ne supporte pas la lecture audio."})]})]}),p&&t.jsxs("div",{className:"media-player__overlay-premium",role:"dialog",children:[t.jsx("div",{style:{fontSize:"3rem"},children:""}),t.jsx("h3",{children:"Aperu termin"}),t.jsx("p",{children:"Accdez  la totalit de cet audio avec PedaClic Premium."}),t.jsx($e,{to:"/premium",className:"btn-premium-overlay",children:" Devenir Premium  2 000 FCFA/mois"})]})]})}function Fte(){const{mediaId:e}=jn(),{currentUser:r}=Xe(),n=tt(),[a,l]=g.useState(null),[o,u]=g.useState([]),[d,m]=g.useState(null),[p,h]=g.useState(!0),[v,b]=g.useState(null),x=g.useRef(0),j=g.useRef(null),w=r?.role==="admin"||r?.role==="prof"||!a?.isPremium||(r?.isPremium??!1);g.useEffect(()=>{if(!e)return;async function A(){try{h(!0),b(null);const z=await BM(e);if(!z){b("Ce contenu est introuvable ou a t supprim.");return}l(z);const[k,P]=await Promise.all([Ate(e,z.discipline),r?qte(r.uid,e):Promise.resolve(null)]);u(k),m(P),P?.positionReprise&&(x.current=P.positionReprise),await Mte(e)}catch(z){console.error("[MediaDetail] Erreur chargement :",z),b("Impossible de charger ce contenu. Ressayez plus tard.")}finally{h(!1)}}return A(),()=>{j.current&&clearInterval(j.current)}},[e,r]),g.useEffect(()=>{if(!(!r||!a))return j.current=setInterval(async()=>{x.current>0&&await Tte(r.uid,a.id,x.current,x.current,a.duree)},3e4),()=>{j.current&&clearInterval(j.current)}},[r,a]);const C=g.useCallback(A=>{x.current=A},[]),E=g.useCallback(()=>{},[]);if(p)return t.jsx("div",{className:"media-detail-page",children:t.jsxs("div",{className:"mediatheque-chargement",role:"status",children:[t.jsx("div",{className:"mediatheque-spinner"}),t.jsx("p",{children:"Chargement du contenu..."})]})});if(v||!a)return t.jsxs("div",{className:"media-detail-page",children:[t.jsx("div",{className:"media-detail-header",children:t.jsx("button",{type:"button",className:"media-detail-retour",onClick:()=>n("/mediatheque"),children:" Retour  la mdiathque"})}),t.jsxs("div",{className:"mediatheque-vide",role:"alert",children:[t.jsx("span",{className:"mediatheque-vide__emoji",children:""}),t.jsx("h3",{className:"mediatheque-vide__titre",children:"Contenu introuvable"}),t.jsx("p",{className:"mediatheque-vide__message",children:v}),t.jsx("button",{type:"button",className:"btn-principal",onClick:()=>n("/mediatheque"),children:" Retour  la mdiathque"})]})]});const S=ya[a.type];return t.jsxs("div",{className:"media-detail-page",children:[t.jsxs("header",{className:"media-detail-header",children:[t.jsx("button",{type:"button",className:"media-detail-retour",onClick:()=>n("/mediatheque"),"aria-label":"Retourner au catalogue",children:" Mdiathque"}),t.jsxs("span",{style:{fontSize:"0.8rem",padding:"0.25rem 0.75rem",borderRadius:"4px",backgroundColor:S.bg,color:S.couleur,fontWeight:600},children:[S.emoji," ",S.label]}),a.isPremium&&t.jsx("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.6rem",borderRadius:"4px",backgroundColor:"#fffbeb",color:"#d97706",fontWeight:700},children:" Premium"})]}),t.jsxs("div",{className:"media-detail-layout",children:[t.jsxs("div",{children:[a.type==="video"||a.type==="webinaire"?t.jsx(Bte,{url:a.url,mimeType:a.mimeType,titre:a.titre,thumbnailUrl:a.thumbnailUrl,aAccesPremium:w,positionInitiale:d?.positionReprise??0,onTempsChange:C,onAperuTermine:E}):t.jsx(Ute,{url:a.url,titre:a.titre,thumbnailUrl:a.thumbnailUrl,typeMedia:a.type,aAccesPremium:w,positionInitiale:d?.positionReprise??0,onTempsChange:C,onAperuTermine:E}),t.jsxs("div",{className:"media-detail-infos",children:[t.jsx("h1",{className:"media-detail-infos__titre",children:a.titre}),t.jsxs("div",{className:"media-detail-infos__meta",children:[t.jsxs("span",{className:"media-detail-infos__meta-item",children:[" ",a.auteurNom]}),t.jsxs("span",{className:"media-detail-infos__meta-item",children:[" ",a.discipline]}),t.jsxs("span",{className:"media-detail-infos__meta-item",children:[" ",a.niveau,a.classe?`  ${a.classe}`:""]}),t.jsxs("span",{className:"media-detail-infos__meta-item",children:[" ",Af(a.duree)]}),t.jsxs("span",{className:"media-detail-infos__meta-item",children:[" ",a.vues.toLocaleString("fr-SN")," vue",a.vues!==1?"s":""]}),a.taille>0&&t.jsxs("span",{className:"media-detail-infos__meta-item",children:[" ",(a.taille/(1024*1024)).toFixed(1)," Mo"]})]}),t.jsx("p",{className:"media-detail-infos__description",children:a.description}),(a.tags??[]).length>0&&t.jsx("div",{className:"media-detail-infos__tags",children:(a.tags??[]).map(A=>t.jsxs("span",{className:"media-detail-infos__tag",children:["#",A]},A))})]})]}),t.jsxs("aside",{className:"media-detail-sidebar","aria-label":"Informations complmentaires",children:[a.isPremium&&!w&&t.jsxs("div",{className:"media-sidebar-premium",children:[t.jsx("p",{className:"media-sidebar-premium__titre",children:" Dbloquez tout le contenu"}),t.jsx("p",{className:"media-sidebar-premium__prix",children:"2 000 FCFA"}),t.jsx("p",{className:"media-sidebar-premium__prix-annuel",children:"ou 20 000 FCFA / an (2 mois offerts)"}),t.jsx($e,{to:"/premium",className:"btn-abonnement",children:"S'abonner  Premium"}),t.jsxs("ul",{className:"media-sidebar-premium__avantages",children:[t.jsx("li",{children:"Vidos et audios illimits"}),t.jsx("li",{children:"Tous les cours en ligne"}),t.jsx("li",{children:"Quiz et exercices premium"}),t.jsx("li",{children:"Tlchargement pour mode hors-ligne"})]})]}),o.length>0&&t.jsxs("div",{className:"media-sidebar-similaires",children:[t.jsx("h2",{className:"media-sidebar-similaires__titre",children:" Contenus similaires"}),t.jsx("div",{className:"media-sidebar-similaires__liste",children:o.map(A=>t.jsxs($e,{to:`/mediatheque/${A.id}`,className:"media-similaire-item","aria-label":`Voir : ${A.titre}`,children:[t.jsx("div",{className:"media-similaire-item__vignette",children:A.thumbnailUrl?t.jsx("img",{src:A.thumbnailUrl,alt:A.titre,loading:"lazy"}):t.jsx("span",{className:"media-similaire-item__vignette-emoji",children:ya[A.type].emoji})}),t.jsxs("div",{className:"media-similaire-item__infos",children:[t.jsx("p",{className:"media-similaire-item__titre",children:A.titre}),t.jsxs("div",{className:"media-similaire-item__meta",children:[t.jsx("span",{children:ya[A.type].label}),t.jsx("span",{children:""}),t.jsx("span",{children:Af(A.duree)}),A.isPremium&&t.jsx("span",{children:" "})]})]})]},A.id))})]}),t.jsxs("div",{style:{background:"#f0fdf4",border:"1px solid #bbf7d0",borderRadius:"8px",padding:"0.875rem",fontSize:"0.8rem",color:"#166534"},children:[t.jsx("strong",{children:" Connexion lente ?"}),t.jsx("br",{}),"Le lecteur s'adapte automatiquement  votre dbit. En cas de problme, rechargez la page ou essayez en Wi-Fi."]})]})]})]})}const Gte={video:"video/mp4",audio:"audio/mpeg",podcast:"audio/mpeg",webinaire:"video/mp4"};function Hte(){const{currentUser:e}=Xe(),r=tt(),{matieres:n}=_n(),[a,l]=g.useState(!1),[o,u]=g.useState(null),[d,m]=g.useState(0),[p,h]=g.useState({titre:"",description:"",type:"video",url:"",urlBasse:"",thumbnailUrl:"",duree:0,taille:0,mimeType:"video/mp4",discipline:"",classe:"",niveau:"",tags:"",isPremium:!1,statut:"brouillon"}),[v,b]=g.useState(null),[x,j]=g.useState(null),_=C=>{const{name:E,value:S,type:A}=C.target;h(z=>({...z,[E]:A==="checkbox"?C.target.checked:S}))},w=async C=>{if(C.preventDefault(),!!e){l(!0),u(null);try{const E=p.discipline?p.discipline.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"_"):"general",S=p.tags?p.tags.split(/[,;]/).map(D=>D.trim()).filter(Boolean):[],A={titre:p.titre.trim(),description:p.description.trim(),type:p.type,url:p.url.trim(),urlBasse:p.urlBasse?.trim()||"",thumbnailUrl:p.thumbnailUrl?.trim()||"",duree:Number(p.duree)||0,taille:p.taille||0,mimeType:p.mimeType||Gte[p.type],discipline:p.discipline||"Non spcifi",disciplineId:E,classe:p.classe||"",niveau:p.niveau||"",tags:S,isPremium:p.isPremium,statut:p.statut};if(!A.titre)throw new Error("Le titre est obligatoire.");if(!p.url.trim()&&!v)throw new Error("Indiquez une URL ou slectionnez un fichier.");const z=v?"upload://pending":p.url.trim(),k={...A,url:z};let P=await zte(k,e.uid,e.displayName||e.email||"Auteur");if(v){m(10);const D=await Pte(v,P,p.type,E,$=>m(10+Math.round($*.7)));await Vc(P,{url:D,mimeType:v.type}),A.taille===0&&await Vc(P,{taille:v.size})}if(x){m(85);const D=await UM(x,P);await Vc(P,{thumbnailUrl:D})}m(100),r(`/mediatheque/${P}`)}catch(E){console.error("[MediaAjout] Erreur:",E),u(E instanceof Error?E.message:"Erreur lors de l'enregistrement.")}finally{l(!1),m(0)}}};return t.jsxs("div",{className:"media-detail-page",children:[t.jsxs("header",{className:"media-detail-header",children:[t.jsx("button",{className:"media-detail-retour",onClick:()=>r("/mediatheque"),type:"button",children:" Mdiathque"}),t.jsx("span",{style:{fontSize:"1rem",fontWeight:700},children:" Ajouter un contenu"})]}),t.jsxs("div",{className:"media-form",style:{maxWidth:700,margin:"2rem auto"},children:[t.jsx("h1",{className:"media-form__titre",children:"Nouveau mdia"}),t.jsxs("form",{onSubmit:w,children:[o&&t.jsx("div",{style:{background:"#fef2f2",color:"#b91c1c",padding:"0.75rem",borderRadius:8,marginBottom:"1rem"},children:o}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsxs("label",{className:"media-form__label",children:["Type ",t.jsx("span",{children:"*"})]}),t.jsx("select",{name:"type",value:p.type,onChange:_,className:"media-form__select",required:!0,children:Object.entries(ya).map(([C,E])=>t.jsxs("option",{value:C,children:[E.emoji," ",E.label]},C))})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsxs("label",{className:"media-form__label",children:["Titre ",t.jsx("span",{children:"*"})]}),t.jsx("input",{name:"titre",value:p.titre,onChange:_,className:"media-form__input",placeholder:"Ex: Introduction aux fonctions affines",required:!0})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Description"}),t.jsx("textarea",{name:"description",value:p.description,onChange:_,className:"media-form__textarea",placeholder:"Description courte du contenu",rows:3})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"URL du fichier (vido/audio)"}),t.jsx("input",{name:"url",type:"url",value:p.url,onChange:_,className:"media-form__input",placeholder:"https://exemple.com/video.mp4",disabled:!!v}),t.jsx("p",{className:"media-form__upload-texte",style:{marginTop:"0.5rem"},children:"Ou utilisez l'upload ci-dessous pour un fichier local."})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Fichier mdia (optionnel)"}),t.jsxs("div",{className:`media-form__upload-zone ${v?"media-form__upload-zone--active":""}`,onClick:()=>document.getElementById("fichier-media")?.click(),children:[t.jsx("input",{id:"fichier-media",type:"file",accept:ya[p.type].accept,onChange:C=>{const E=C.target.files?.[0];b(E||null),E&&h(S=>({...S,url:E.name}))},style:{display:"none"}}),t.jsx("span",{className:"media-form__upload-icone",children:""}),t.jsx("p",{className:"media-form__upload-texte",children:v?t.jsx("strong",{children:v.name}):"Cliquez pour slectionner un fichier"})]})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Vignette (optionnel)"}),t.jsxs("div",{className:`media-form__upload-zone ${x?"media-form__upload-zone--active":""}`,onClick:()=>document.getElementById("fichier-thumb")?.click(),children:[t.jsx("input",{id:"fichier-thumb",type:"file",accept:"image/*",onChange:C=>j(C.target.files?.[0]||null),style:{display:"none"}}),t.jsx("span",{className:"media-form__upload-icone",children:""}),t.jsx("p",{className:"media-form__upload-texte",children:x?t.jsx("strong",{children:x.name}):"Cliquez pour une vignette"})]})]}),t.jsxs("div",{className:"media-form__grille-2",children:[t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Dure (secondes)"}),t.jsx("input",{name:"duree",type:"number",value:p.duree||"",onChange:_,className:"media-form__input",placeholder:"Ex: 600",min:0})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Discipline"}),t.jsxs("select",{name:"discipline",value:p.discipline,onChange:_,className:"media-form__select",children:[t.jsx("option",{value:"",children:"Toutes"}),n.map(C=>t.jsx("option",{value:C.valeur,children:C.label},C.valeur))]})]})]}),t.jsxs("div",{className:"media-form__grille-2",children:[t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Niveau"}),t.jsxs("select",{name:"niveau",value:p.niveau,onChange:_,className:"media-form__select",children:[t.jsx("option",{value:"",children:"Tous"}),yr.map(C=>t.jsx("option",{value:C,children:C},C))]})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Classe"}),t.jsx("input",{name:"classe",value:p.classe,onChange:_,className:"media-form__input",placeholder:"Ex: 3me / 2nde"})]})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Tags (spars par virgule)"}),t.jsx("input",{name:"tags",value:p.tags,onChange:_,className:"media-form__input",placeholder:"fonctions affines, algbre, BFEM"})]}),t.jsxs("div",{className:"media-form__grille-2",children:[t.jsx("div",{className:"media-form__groupe",children:t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[t.jsx("input",{name:"isPremium",type:"checkbox",checked:p.isPremium,onChange:_}),"Contenu Premium (aperu 30s)"]})}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Statut"}),t.jsxs("select",{name:"statut",value:p.statut,onChange:_,className:"media-form__select",children:[t.jsx("option",{value:"publie",children:"Publi"}),t.jsx("option",{value:"brouillon",children:"Brouillon"}),t.jsx("option",{value:"planifiee",children:"Planifi"}),t.jsx("option",{value:"archive",children:"Archiv"})]})]})]}),d>0&&d<100&&t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("div",{className:"media-form__progress",children:t.jsx("div",{className:"media-form__progress-bar",style:{width:`${d}%`}})}),t.jsxs("p",{className:"media-form__progress-texte",children:["Upload en cours ",d,"%"]})]}),t.jsxs("div",{className:"media-form__actions",children:[t.jsx("button",{type:"button",className:"btn-secondaire",onClick:()=>r("/mediatheque"),children:"Annuler"}),t.jsx("button",{type:"submit",className:"btn-principal",disabled:a||!p.url.trim()&&!v,children:a?"Enregistrement":"Enregistrer"})]})]})]})]})}const jA={video:"video/mp4",audio:"audio/mpeg",podcast:"audio/mpeg",webinaire:"video/mp4"};function Vte(){const{mediaId:e}=jn(),{currentUser:r}=Xe(),n=tt(),{matieres:a}=_n(),[l,o]=g.useState(!0),[u,d]=g.useState(!1),[m,p]=g.useState(null),[h,v]=g.useState(0),[b,x]=g.useState({titre:"",description:"",type:"video",url:"",urlBasse:"",thumbnailUrl:"",duree:0,taille:0,mimeType:"video/mp4",discipline:"",classe:"",niveau:"",tags:"",isPremium:!1,statut:"brouillon"}),[j,_]=g.useState(null);g.useEffect(()=>{if(!e)return;let E=!1;async function S(){try{const A=await BM(e);if(E||!A){p(A?null:"Contenu introuvable.");return}x({titre:A.titre||"",description:A.description||"",type:A.type||"video",url:A.url||"",urlBasse:A.urlBasse||"",thumbnailUrl:A.thumbnailUrl||"",duree:A.duree||0,taille:A.taille||0,mimeType:A.mimeType||jA[A.type||"video"],discipline:A.discipline||"",classe:A.classe||"",niveau:A.niveau||"",tags:(A.tags||[]).join(", "),isPremium:A.isPremium??!1,statut:A.statut||"brouillon"})}catch{E||p("Erreur lors du chargement.")}finally{E||o(!1)}}return S(),()=>{E=!0}},[e]);const w=E=>{const{name:S,value:A,type:z}=E.target;x(k=>({...k,[S]:z==="checkbox"?E.target.checked:A}))},C=async E=>{if(E.preventDefault(),!(!r||!e)){d(!0),p(null);try{const S=b.discipline?b.discipline.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"_"):"general",A=b.tags?b.tags.split(/[,;]/).map(z=>z.trim()).filter(Boolean):[];if(await Vc(e,{titre:b.titre.trim(),description:b.description.trim(),type:b.type,url:b.url.trim(),urlBasse:b.urlBasse?.trim()||"",duree:Number(b.duree)||0,taille:b.taille||0,mimeType:b.mimeType||jA[b.type],discipline:b.discipline||"Non spcifi",disciplineId:S,classe:b.classe||"",niveau:b.niveau||"",tags:A,isPremium:b.isPremium,statut:b.statut}),j){v(50);const z=await UM(j,e);await Vc(e,{thumbnailUrl:z})}v(100),n(`/mediatheque/${e}`)}catch(S){console.error("[MediaEdit] Erreur:",S),p(S instanceof Error?S.message:"Erreur lors de l'enregistrement.")}finally{d(!1),v(0)}}};return l?t.jsx("div",{className:"media-detail-page",children:t.jsxs("div",{className:"mediatheque-chargement",style:{padding:"4rem 2rem"},children:[t.jsx("div",{className:"mediatheque-spinner"}),t.jsx("p",{children:"Chargement"})]})}):t.jsxs("div",{className:"media-detail-page",children:[t.jsxs("header",{className:"media-detail-header",children:[t.jsx("button",{className:"media-detail-retour",onClick:()=>n("/mediatheque"),type:"button",children:" Mdiathque"}),t.jsx("span",{style:{fontSize:"1rem",fontWeight:700},children:" Modifier le contenu"})]}),t.jsxs("div",{className:"media-form",style:{maxWidth:700,margin:"2rem auto"},children:[t.jsx("h1",{className:"media-form__titre",children:"Modifier le mdia"}),t.jsxs("form",{onSubmit:C,children:[m&&t.jsx("div",{style:{background:"#fef2f2",color:"#b91c1c",padding:"0.75rem",borderRadius:8,marginBottom:"1rem"},children:m}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Type"}),t.jsx("select",{name:"type",value:b.type,onChange:w,className:"media-form__select",children:Object.entries(ya).map(([E,S])=>t.jsxs("option",{value:E,children:[S.emoji," ",S.label]},E))})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsxs("label",{className:"media-form__label",children:["Titre ",t.jsx("span",{children:"*"})]}),t.jsx("input",{name:"titre",value:b.titre,onChange:w,className:"media-form__input",required:!0})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Description"}),t.jsx("textarea",{name:"description",value:b.description,onChange:w,className:"media-form__textarea",rows:3})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"URL du fichier (vido/audio)"}),t.jsx("input",{name:"url",type:"url",value:b.url,onChange:w,className:"media-form__input"})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Vignette"}),t.jsxs("div",{className:`media-form__upload-zone ${j?"media-form__upload-zone--active":""}`,onClick:()=>document.getElementById("fichier-thumb-edit")?.click(),children:[t.jsx("input",{id:"fichier-thumb-edit",type:"file",accept:"image/*",onChange:E=>_(E.target.files?.[0]||null),style:{display:"none"}}),t.jsx("span",{className:"media-form__upload-icone",children:""}),t.jsx("p",{className:"media-form__upload-texte",children:j?t.jsx("strong",{children:j.name}):b.thumbnailUrl?"Remplacer la vignette":"Ajouter une vignette"})]})]}),t.jsxs("div",{className:"media-form__grille-2",children:[t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Dure (secondes)"}),t.jsx("input",{name:"duree",type:"number",value:b.duree||"",onChange:w,className:"media-form__input",min:0})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Discipline"}),t.jsxs("select",{name:"discipline",value:b.discipline,onChange:w,className:"media-form__select",children:[t.jsx("option",{value:"",children:"Toutes"}),a.map(E=>t.jsx("option",{value:E.valeur,children:E.label},E.valeur))]})]})]}),t.jsxs("div",{className:"media-form__grille-2",children:[t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Niveau"}),t.jsxs("select",{name:"niveau",value:b.niveau,onChange:w,className:"media-form__select",children:[t.jsx("option",{value:"",children:"Tous"}),yr.map(E=>t.jsx("option",{value:E,children:E},E))]})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Classe"}),t.jsx("input",{name:"classe",value:b.classe,onChange:w,className:"media-form__input",placeholder:"Ex: 3me"})]})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Tags (spars par virgule)"}),t.jsx("input",{name:"tags",value:b.tags,onChange:w,className:"media-form__input"})]}),t.jsxs("div",{className:"media-form__grille-2",children:[t.jsx("div",{className:"media-form__groupe",children:t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[t.jsx("input",{name:"isPremium",type:"checkbox",checked:b.isPremium,onChange:w}),"Contenu Premium (aperu 30s)"]})}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Statut"}),t.jsx("select",{name:"statut",value:b.statut,onChange:w,className:"media-form__select",children:Object.entries(Ef).map(([E,S])=>t.jsx("option",{value:E,children:S.label},E))})]})]}),h>0&&h<100&&t.jsx("div",{className:"media-form__groupe",children:t.jsx("div",{className:"media-form__progress",children:t.jsx("div",{className:"media-form__progress-bar",style:{width:`${h}%`}})})}),t.jsxs("div",{className:"media-form__actions",children:[t.jsx("button",{type:"button",className:"btn-secondaire",onClick:()=>n("/mediatheque"),children:"Annuler"}),t.jsx("button",{type:"submit",className:"btn-principal",disabled:u,children:u?"Enregistrement":"Enregistrer"})]})]})]})]})}function Qte(e){return e.toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}const Yte=({notif:e,onLire:r,onArchiver:n,onSupprimer:a,onNavigate:l})=>{const o=Sm[e.type],u=e.statut==="non_lue";return t.jsxs("article",{className:`notif-page__item ${u?"notif-page__item--unread":""}`,"aria-label":`Notification : ${e.titre}`,children:[t.jsx("div",{className:"notif-page__item-icon",style:{background:o.couleur+"20",color:o.couleur},"aria-hidden":"true",children:o.icone}),t.jsxs("div",{className:"notif-page__item-body",children:[t.jsxs("div",{className:"notif-page__item-header",children:[t.jsx("h3",{className:"notif-page__item-titre",children:e.titre}),u&&t.jsx("span",{className:"notif-page__item-badge",children:"Nouvelle"})]}),t.jsx("p",{className:"notif-page__item-message",children:e.message}),t.jsxs("div",{className:"notif-page__item-meta",children:[e.emetteurNom&&t.jsxs("span",{className:"notif-page__item-emetteur",children:["De : ",e.emetteurNom]}),t.jsx("span",{className:"notif-page__item-date",children:Qte(e.createdAt)}),t.jsx("span",{className:"notif-page__item-type",style:{color:o.couleur},children:Wb[e.type]})]}),e.lienAction&&t.jsx("button",{className:"notif-page__item-action-btn",onClick:()=>l(e),children:e.labelAction||"Voir "})]}),t.jsxs("div",{className:"notif-page__item-actions",children:[u&&t.jsx("button",{className:"notif-page__action-btn notif-page__action-btn--read",onClick:()=>r(e.id),title:"Marquer comme lu","aria-label":"Marquer comme lu",children:""}),e.statut!=="archivee"&&t.jsx("button",{className:"notif-page__action-btn notif-page__action-btn--archive",onClick:()=>n(e.id),title:"Archiver","aria-label":"Archiver la notification",children:""}),t.jsx("button",{className:"notif-page__action-btn notif-page__action-btn--delete",onClick:()=>a(e.id),title:"Supprimer","aria-label":"Supprimer la notification",children:""})]})]})},Kte=()=>{const{currentUser:e}=Xe(),r=tt(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[m,p]=g.useState("toutes"),[h,v]=g.useState("tous"),[b,x]=g.useState(!1),j=g.useCallback(async()=>{if(e){o(!0),d(null);try{const k=await f5(e.uid,{includeArchived:m==="archivee",limitCount:100});a(k)}catch(k){d("Impossible de charger les notifications."),console.error("[Phase 26] Erreur chargement notifications:",k)}finally{o(!1)}}},[e,m]);g.useEffect(()=>{j()},[j]);const _=n.filter(k=>{const P=m==="toutes"||k.statut===m,D=h==="tous"||k.type===h;return P&&D}),w=n.filter(k=>k.statut==="non_lue").length,C=async k=>{await Rx(k),a(P=>P.map(D=>D.id===k?{...D,statut:"lue",luAt:new Date}:D))},E=async k=>{await h5(k),a(P=>P.map(D=>D.id===k?{...D,statut:"archivee"}:D))},S=async k=>{window.confirm("Supprimer cette notification ?")&&(await v5(k),a(P=>P.filter(D=>D.id!==k)))},A=async k=>{k.statut==="non_lue"&&await Rx(k.id),k.lienAction&&r(k.lienAction)},z=async()=>{if(!(!e||b)){x(!0);try{await PA(e.uid),a(k=>k.map(P=>P.statut==="non_lue"?{...P,statut:"lue",luAt:new Date}:P))}finally{x(!1)}}};return t.jsxs("div",{className:"notif-page",children:[t.jsxs("div",{className:"notif-page__header",children:[t.jsxs("div",{className:"notif-page__header-left",children:[t.jsx("h1",{className:"notif-page__title",children:" Notifications"}),w>0&&t.jsxs("span",{className:"notif-page__unread-count",children:[w," non ",w>1?"lues":"lue"]})]}),w>0&&t.jsx("button",{className:"notif-page__mark-all-btn",onClick:z,disabled:b,children:b?"En cours":" Tout marquer comme lu"})]}),t.jsxs("div",{className:"notif-page__filters",children:[t.jsxs("div",{className:"notif-page__filter-group",children:[t.jsx("label",{className:"notif-page__filter-label",children:"Statut"}),t.jsx("div",{className:"notif-page__filter-tabs",children:["toutes","non_lue","lue","archivee"].map(k=>t.jsx("button",{className:`notif-page__filter-tab ${m===k?"notif-page__filter-tab--active":""}`,onClick:()=>p(k),children:k==="toutes"?"Toutes":k==="non_lue"?" Non lues":k==="lue"?" Lues":" Archives"},k))})]}),t.jsxs("div",{className:"notif-page__filter-group",children:[t.jsx("label",{className:"notif-page__filter-label",children:"Type"}),t.jsxs("select",{className:"notif-page__filter-select",value:h,onChange:k=>v(k.target.value),children:[t.jsx("option",{value:"tous",children:"Tous les types"}),Object.entries(Wb).map(([k,P])=>t.jsx("option",{value:k,children:P},k))]})]})]}),l?t.jsx("div",{className:"notif-page__loading",children:[1,2,3].map(k=>t.jsx("div",{className:"notif-page__skeleton"},k))}):u?t.jsxs("div",{className:"notif-page__error",children:[t.jsxs("p",{children:[" ",u]}),t.jsx("button",{onClick:j,className:"notif-page__retry-btn",children:"Ressayer"})]}):_.length===0?t.jsxs("div",{className:"notif-page__empty",children:[t.jsx("span",{className:"notif-page__empty-icon",children:""}),t.jsx("p",{className:"notif-page__empty-title",children:"Aucune notification"}),t.jsx("p",{className:"notif-page__empty-sub",children:m==="non_lue"?"Vous tes  jour, aucune notification non lue.":"Aucune notification correspondant  vos filtres."})]}):t.jsx("div",{className:"notif-page__list",children:_.map(k=>t.jsx(Yte,{notif:k,onLire:C,onArchiver:E,onSupprimer:S,onNavigate:A},k.id))})]})},_A={type:"annonce",titre:"",message:"",lienAction:"",labelAction:"",modeDestinataire:"role",destinataireEmail:"",destinataireId:"",groupeId:"",roleDestinataire:"eleve",canal:"les_deux"},NA=()=>{const{currentUser:e}=Xe(),r=tt(),[n,a]=g.useState(_A),[l,o]=g.useState([]),[u,d]=g.useState("idle"),[m,p]=g.useState(null),[h,v]=g.useState(0);g.useEffect(()=>{if(!e)return;const E=e.role==="admin"?ze(_e(V,"groupes_prof")):ze(_e(V,"groupes_prof"),Se("profId","==",e.uid));Ae(E).then(S=>{o(S.docs.map(A=>({id:A.id,nom:A.data().nom,classe:A.data().classe,nombreInscrits:A.data().nombreInscrits??0})))})},[e]);const b=(C,E)=>{a(S=>({...S,[C]:E}))},x=C=>{const E=Sm[C];a(S=>({...S,type:C,titre:E.titreDefaut,message:E.messageDefaut}))},j=()=>!(!n.titre.trim()||!n.message.trim()||n.modeDestinataire==="individuel"&&!n.destinataireEmail.trim()||n.modeDestinataire==="groupe"&&!n.groupeId),_=async()=>{if(!(!e||!j())){d("sending"),p(null);try{const C={type:n.type,titre:n.titre,message:n.message,lienAction:n.lienAction||void 0,labelAction:n.labelAction||void 0,emetteurId:e.uid,emetteurNom:e.displayName||e.email||"PedaClic",canal:n.canal};if(n.modeDestinataire==="individuel")await u5({...C,destinataireId:n.destinataireId||n.destinataireEmail,destinataireRole:"eleve",emailDestinataire:n.canal!=="in_app"?n.destinataireEmail:void 0,emailDestinatairNom:n.destinataireEmail}),v(1);else if(n.modeDestinataire==="groupe"){const E=await d5(n.groupeId,{...C,destinataireRole:"eleve"});v(E)}else{const E=await m5(n.roleDestinataire,C);v(E)}d("success")}catch(C){p(C instanceof Error?C.message:"Erreur inconnue"),d("error")}}},w=()=>{a(_A),d("idle"),p(null),v(0)};return u==="success"?t.jsx("div",{className:"notif-composer notif-composer--success",children:t.jsxs("div",{className:"notif-composer__success-card",children:[t.jsx("span",{className:"notif-composer__success-icon",children:""}),t.jsx("h2",{children:"Notification envoye !"}),t.jsxs("p",{children:[t.jsx("strong",{children:h})," destinataire",h>1?"s":""," notifi",h>1?"s":"","."]}),t.jsxs("div",{className:"notif-composer__success-actions",children:[t.jsx("button",{className:"notif-composer__btn notif-composer__btn--primary",onClick:w,children:" Nouvelle notification"}),t.jsx("button",{className:"notif-composer__btn notif-composer__btn--secondary",onClick:()=>r(-1),children:" Retour"})]})]})}):t.jsxs("div",{className:"notif-composer",children:[t.jsxs("div",{className:"notif-composer__header",children:[t.jsx("button",{className:"notif-composer__back-btn",onClick:()=>r(-1),children:" Retour"}),t.jsx("h1",{className:"notif-composer__title",children:" Envoyer une notification"})]}),t.jsxs("div",{className:"notif-composer__form",children:[t.jsxs("section",{className:"notif-composer__section",children:[t.jsx("h2",{className:"notif-composer__section-title",children:"1. Type de notification"}),t.jsx("div",{className:"notif-composer__type-grid",children:Object.entries(Wb).filter(([C])=>!["bienvenue","nouveau_abonnement","resultat_quiz"].includes(C)).map(([C,E])=>{const S=Sm[C];return t.jsxs("button",{className:`notif-composer__type-card ${n.type===C?"notif-composer__type-card--active":""}`,onClick:()=>x(C),style:n.type===C?{borderColor:S.couleur,background:S.couleur+"12"}:{},children:[t.jsx("span",{className:"notif-composer__type-icon",children:S.icone}),t.jsx("span",{className:"notif-composer__type-label",children:E})]},C)})})]}),t.jsxs("section",{className:"notif-composer__section",children:[t.jsx("h2",{className:"notif-composer__section-title",children:"2. Destinataires"}),t.jsx("div",{className:"notif-composer__mode-tabs",children:[{value:"role",label:" Par rle"},{value:"groupe",label:" Groupe-classe"},{value:"individuel",label:" Individuel"}].map(({value:C,label:E})=>t.jsx("button",{className:`notif-composer__mode-tab ${n.modeDestinataire===C?"notif-composer__mode-tab--active":""}`,onClick:()=>b("modeDestinataire",C),children:E},C))}),n.modeDestinataire==="role"&&t.jsxs("div",{className:"notif-composer__field",children:[t.jsx("label",{className:"notif-composer__label",children:"Envoyer  :"}),t.jsx("div",{className:"notif-composer__role-grid",children:Object.entries(g5).map(([C,E])=>t.jsx("button",{className:`notif-composer__role-card ${n.roleDestinataire===C?"notif-composer__role-card--active":""}`,onClick:()=>b("roleDestinataire",C),children:E},C))})]}),n.modeDestinataire==="groupe"&&t.jsxs("div",{className:"notif-composer__field",children:[t.jsx("label",{className:"notif-composer__label",children:"Groupe-classe :"}),l.length===0?t.jsx("p",{className:"notif-composer__hint",children:"Aucun groupe-classe disponible."}):t.jsxs("select",{className:"notif-composer__select",value:n.groupeId,onChange:C=>b("groupeId",C.target.value),children:[t.jsx("option",{value:"",children:" Choisir un groupe "}),l.map(C=>t.jsxs("option",{value:C.id,children:[C.nom,"  ",C.classe," (",C.nombreInscrits," lves)"]},C.id))]})]}),n.modeDestinataire==="individuel"&&t.jsxs("div",{className:"notif-composer__field",children:[t.jsx("label",{className:"notif-composer__label",children:"Email du destinataire :"}),t.jsx("input",{type:"email",className:"notif-composer__input",placeholder:"eleve@exemple.sn",value:n.destinataireEmail,onChange:C=>b("destinataireEmail",C.target.value)}),t.jsx("p",{className:"notif-composer__hint",children:"L'utilisateur doit tre inscrit sur PedaClic."})]})]}),t.jsxs("section",{className:"notif-composer__section",children:[t.jsx("h2",{className:"notif-composer__section-title",children:"3. Contenu"}),t.jsxs("div",{className:"notif-composer__field",children:[t.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-titre",children:["Titre ",t.jsx("span",{className:"notif-composer__required",children:"*"})]}),t.jsx("input",{id:"notif-titre",type:"text",className:"notif-composer__input",placeholder:"Ex : Nouveau devoir de mathmatiques",value:n.titre,onChange:C=>b("titre",C.target.value),maxLength:100}),t.jsxs("span",{className:"notif-composer__char-count",children:[n.titre.length,"/100"]})]}),t.jsxs("div",{className:"notif-composer__field",children:[t.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-message",children:["Message ",t.jsx("span",{className:"notif-composer__required",children:"*"})]}),t.jsx("textarea",{id:"notif-message",className:"notif-composer__textarea",placeholder:"Rdigez votre message ici",value:n.message,onChange:C=>b("message",C.target.value),rows:4,maxLength:500}),t.jsxs("span",{className:"notif-composer__char-count",children:[n.message.length,"/500"]})]}),t.jsxs("div",{className:"notif-composer__field-row",children:[t.jsxs("div",{className:"notif-composer__field",children:[t.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-lien",children:["Lien d'action ",t.jsx("span",{className:"notif-composer__optional",children:"(optionnel)"})]}),t.jsx("input",{id:"notif-lien",type:"text",className:"notif-composer__input",placeholder:"/cours/abc123",value:n.lienAction,onChange:C=>b("lienAction",C.target.value)})]}),t.jsxs("div",{className:"notif-composer__field",children:[t.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-label",children:["Texte du bouton ",t.jsx("span",{className:"notif-composer__optional",children:"(optionnel)"})]}),t.jsx("input",{id:"notif-label",type:"text",className:"notif-composer__input",placeholder:"Voir le cours",value:n.labelAction,onChange:C=>b("labelAction",C.target.value)})]})]})]}),t.jsxs("section",{className:"notif-composer__section",children:[t.jsx("h2",{className:"notif-composer__section-title",children:"4. Canal d'envoi"}),t.jsx("div",{className:"notif-composer__canal-grid",children:[{value:"in_app",label:" In-app seulement",desc:"Cloche dans l'interface"},{value:"email",label:" Email seulement",desc:"Via Resend"},{value:"les_deux",label:" In-app + Email",desc:"Les deux canaux"}].map(({value:C,label:E,desc:S})=>t.jsxs("button",{className:`notif-composer__canal-card ${n.canal===C?"notif-composer__canal-card--active":""}`,onClick:()=>b("canal",C),children:[t.jsx("span",{className:"notif-composer__canal-label",children:E}),t.jsx("span",{className:"notif-composer__canal-desc",children:S})]},C))}),(n.canal==="email"||n.canal==="les_deux")&&n.modeDestinataire!=="individuel"&&t.jsx("p",{className:"notif-composer__canal-warning",children:" Pour l'envoi par email en mode groupe/rle, assurez-vous que Railway est bien dploy et que la cl API Resend est configure."})]}),u==="error"&&m&&t.jsxs("div",{className:"notif-composer__error",children:[" ",m]}),t.jsxs("div",{className:"notif-composer__footer",children:[t.jsx("button",{className:"notif-composer__btn notif-composer__btn--secondary",onClick:()=>r(-1),disabled:u==="sending",children:"Annuler"}),t.jsx("button",{className:"notif-composer__btn notif-composer__btn--primary",onClick:_,disabled:!j()||u==="sending",children:u==="sending"?" Envoi en cours":" Envoyer la notification"})]})]})]})},Wte=()=>{const{currentUser:e}=Xe(),r=e?.uid||"",n=e?.displayName||"Parent",[a,l]=g.useState([]),[o,u]=g.useState(null),[d,m]=g.useState(null),[p,h]=g.useState(!0),[v,b]=g.useState(!1),[x,j]=g.useState(null),[_,w]=g.useState(!1),[C,E]=g.useState(""),[S,A]=g.useState(!1),[z,k]=g.useState(null),[P,D]=g.useState(null),[$,F]=g.useState("apercu"),[Y,M]=g.useState([]);g.useEffect(()=>{K()},[r]),g.useEffect(()=>{o&&ee(o)},[o]);const K=async()=>{try{h(!0),j(null);const I=await xZ(r);l(I),I.length===1&&u(I[0].enfantId)}catch(I){j("Erreur lors du chargement des enfants."),console.error(I)}finally{h(!1)}},ee=async I=>{try{b(!0),j(null);const[U,B]=await Promise.all([yZ(r,I),Pj(I)]);m(U);const T=B.map(H=>H.id),Z=await YZ(T);M(Z.map(H=>({id:H.id,titre:H.titre,description:H.description,dateEcheance:H.dateEcheance instanceof Date?H.dateEcheance:new Date(H.dateEcheance),groupeNom:H.groupeNom})))}catch(U){j(U.message||"Erreur lors du chargement du suivi."),m(null),M([])}finally{b(!1)}},X=async I=>{if(I.preventDefault(),k(null),D(null),!C.trim()){k("Veuillez saisir le code d'invitation.");return}try{A(!0);const U=await gZ(r,C);D(`${U.enfantNom} a t ajout avec succs !`),E(""),w(!1),await K(),u(U.enfantId)}catch(U){k(U.message||"Erreur lors de la liaison.")}finally{A(!1)}},L=async I=>{if(window.confirm(`tes-vous sr de vouloir retirer ${I.enfantNom} de votre suivi ? Cette action est irrversible.`))try{await bZ(I.id,r),o===I.enfantId&&(u(null),m(null)),await K()}catch(B){j(B.message||"Erreur lors de la suppression.")}};return p?t.jsxs("div",{className:"parent-loading",children:[t.jsx("div",{className:"parent-spinner"}),t.jsx("p",{children:"Chargement de votre espace parent..."})]}):t.jsxs("div",{className:"parent-dashboard",children:[t.jsxs("header",{className:"parent-header",children:[t.jsxs("div",{className:"parent-header-info",children:[t.jsx("h1",{className:"parent-titre",children:" Espace Parent"}),t.jsxs("p",{className:"parent-bienvenue",children:["Bienvenue, ",t.jsx("strong",{children:n}),"  Suivez la progression de vos enfants"]})]}),t.jsx("button",{className:"parent-btn parent-btn-primary",onClick:()=>{w(!_),k(null),D(null)},children:" Ajouter un enfant"})]}),x&&t.jsxs("div",{className:"parent-alerte parent-alerte-erreur",children:[t.jsxs("span",{children:[" ",x]}),t.jsx("button",{onClick:()=>j(null),children:""})]}),P&&t.jsxs("div",{className:"parent-alerte parent-alerte-succes",children:[t.jsxs("span",{children:[" ",P]}),t.jsx("button",{onClick:()=>D(null),children:""})]}),_&&t.jsxs("div",{className:"parent-form-liaison",children:[t.jsx("h3",{children:" Lier un enfant  votre compte"}),t.jsx("p",{className:"parent-form-aide",children:"Demandez le code d'invitation  votre enfant. Il peut le trouver dans son profil sur PedaClic (format: PEDA-XXXX-XXXX)."}),t.jsxs("form",{onSubmit:X,className:"parent-form",children:[t.jsxs("div",{className:"parent-form-group",children:[t.jsx("label",{htmlFor:"code-invitation",children:"Code d'invitation"}),t.jsx("input",{id:"code-invitation",type:"text",placeholder:"PEDA-XXXX-XXXX",value:C,onChange:I=>E(I.target.value.toUpperCase()),maxLength:14,disabled:S,className:"parent-input"})]}),z&&t.jsxs("p",{className:"parent-form-erreur",children:[" ",z]}),t.jsxs("div",{className:"parent-form-actions",children:[t.jsx("button",{type:"submit",className:"parent-btn parent-btn-primary",disabled:S,children:S?"Vrification...":" Valider"}),t.jsx("button",{type:"button",className:"parent-btn parent-btn-secondary",onClick:()=>w(!1),children:"Annuler"})]})]})]}),a.length===0?t.jsxs("div",{className:"parent-empty-state",children:[t.jsx("div",{className:"parent-empty-icon",children:""}),t.jsx("h2",{children:"Aucun enfant li"}),t.jsx("p",{children:"Cliquez sur  Ajouter un enfant  et saisissez le code d'invitation de votre enfant pour commencer  suivre sa progression."}),t.jsx("button",{className:"parent-btn parent-btn-primary",onClick:()=>w(!0),children:" Ajouter mon premier enfant"})]}):t.jsxs("div",{className:"parent-content",children:[t.jsxs("aside",{className:"parent-sidebar",children:[t.jsx("h3",{className:"parent-sidebar-titre",children:"Mes enfants"}),t.jsx("ul",{className:"parent-enfants-liste",children:a.map(I=>t.jsxs("li",{className:`parent-enfant-card ${o===I.enfantId?"parent-enfant-actif":""}`,onClick:()=>u(I.enfantId),children:[t.jsx("div",{className:"parent-enfant-avatar",children:I.enfantNom.charAt(0).toUpperCase()}),t.jsxs("div",{className:"parent-enfant-info",children:[t.jsx("span",{className:"parent-enfant-nom",children:I.enfantNom}),I.enfantClasse&&t.jsx("span",{className:"parent-enfant-classe",children:I.enfantClasse})]}),t.jsx("button",{className:"parent-enfant-supprimer",onClick:U=>{U.stopPropagation(),L(I)},title:"Retirer cet enfant",children:""})]},I.id))})]}),t.jsx("main",{className:"parent-main",children:o?v?t.jsxs("div",{className:"parent-loading",children:[t.jsx("div",{className:"parent-spinner"}),t.jsx("p",{children:"Chargement du suivi..."})]}):d?t.jsxs("div",{className:"parent-dashboard-detail",children:[t.jsxs("div",{className:"parent-enfant-header",children:[t.jsxs("div",{className:"parent-enfant-header-info",children:[t.jsx("h2",{children:d.enfant.nom}),d.enfant.classe&&t.jsx("span",{className:"parent-badge",children:d.enfant.classe}),d.enfant.derniereConnexion&&t.jsxs("span",{className:"parent-derniere-connexion",children:["Dernire connexion : ",Px(d.enfant.derniereConnexion)]})]}),t.jsx("p",{className:"parent-message-motivation",children:CZ(d.scoreGlobal)})]}),t.jsxs("div",{className:"parent-indicateurs",children:[t.jsxs("div",{className:"parent-card parent-card-score",children:[t.jsx("div",{className:"parent-card-icon",children:""}),t.jsxs("div",{className:"parent-card-content",children:[t.jsx("span",{className:"parent-card-label",children:"Score Global"}),t.jsxs("span",{className:`parent-card-value parent-score-${d.scoreGlobal>=60?"bon":d.scoreGlobal>=40?"moyen":"bas"}`,children:[d.scoreGlobal,"/100"]})]})]}),t.jsxs("div",{className:"parent-card parent-card-streak",children:[t.jsx("div",{className:"parent-card-icon",children:""}),t.jsxs("div",{className:"parent-card-content",children:[t.jsx("span",{className:"parent-card-label",children:"Streak"}),t.jsxs("span",{className:"parent-card-value",children:[d.streak.actuel," jour",d.streak.actuel>1?"s":""]})]})]}),t.jsxs("div",{className:"parent-card parent-card-lacunes",children:[t.jsx("div",{className:"parent-card-icon",children:""}),t.jsxs("div",{className:"parent-card-content",children:[t.jsx("span",{className:"parent-card-label",children:"Lacunes"}),t.jsxs("span",{className:"parent-card-value",children:[d.lacunes.length," matire",d.lacunes.length>1?"s":""]})]})]}),t.jsxs("div",{className:"parent-card parent-card-objectifs",children:[t.jsx("div",{className:"parent-card-icon",children:""}),t.jsxs("div",{className:"parent-card-content",children:[t.jsx("span",{className:"parent-card-label",children:"Objectifs"}),t.jsxs("span",{className:"parent-card-value",children:[d.objectifs.filter(I=>I.statut==="atteint").length,"/",d.objectifs.length]})]})]})]}),t.jsxs("div",{className:"parent-section parent-section-semaine",children:[t.jsx("h3",{children:" Activit de la semaine"}),t.jsx("div",{className:"parent-semaine-jours",children:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"].map((I,U)=>t.jsxs("div",{className:`parent-jour ${d.streak.semaineCourante[U]?"parent-jour-actif":"parent-jour-inactif"}`,children:[t.jsx("span",{className:"parent-jour-label",children:I}),t.jsx("span",{className:"parent-jour-icon",children:d.streak.semaineCourante[U]?"":""})]},I))})]}),t.jsxs("div",{className:"parent-onglets",children:[t.jsx("button",{className:`parent-onglet ${$==="apercu"?"parent-onglet-actif":""}`,onClick:()=>F("apercu"),children:" Aperu"}),t.jsxs("button",{className:`parent-onglet ${$==="lacunes"?"parent-onglet-actif":""}`,onClick:()=>F("lacunes"),children:[" Lacunes (",d.lacunes.length,")"]}),t.jsxs("button",{className:`parent-onglet ${$==="alertes"?"parent-onglet-actif":""}`,onClick:()=>F("alertes"),children:[" Alertes (",d.alertes.length,")"]}),t.jsxs("button",{className:`parent-onglet ${$==="travaux"?"parent-onglet-actif":""}`,onClick:()=>F("travaux"),children:[" Travaux (",Y.length,")"]}),t.jsx("button",{className:`parent-onglet ${$==="resume"?"parent-onglet-actif":""}`,onClick:()=>F("resume"),children:" Rsum"})]}),t.jsxs("div",{className:"parent-onglet-contenu",children:[$==="apercu"&&t.jsxs("div",{className:"parent-tab-apercu",children:[t.jsxs("div",{className:"parent-section",children:[t.jsx("h3",{children:" Derniers quiz passs"}),d.derniersQuiz.length===0?t.jsx("p",{className:"parent-vide",children:"Aucun quiz pass rcemment."}):t.jsx("div",{className:"parent-quiz-liste",children:d.derniersQuiz.map((I,U)=>t.jsxs("div",{className:`parent-quiz-item ${I.reussi?"parent-quiz-reussi":"parent-quiz-echoue"}`,children:[t.jsxs("div",{className:"parent-quiz-info",children:[t.jsx("span",{className:"parent-quiz-discipline",children:I.disciplineNom}),t.jsx("span",{className:"parent-quiz-titre",children:I.quizTitre})]}),t.jsxs("div",{className:"parent-quiz-score",children:[t.jsxs("span",{className:`parent-quiz-note ${I.reussi?"note-ok":"note-ko"}`,children:[I.noteSur20,"/20"]}),t.jsx("span",{className:"parent-quiz-statut",children:I.reussi?" Russi":" chou"})]}),t.jsx("span",{className:"parent-quiz-date",children:Px(I.datePassage)})]},U))})]}),t.jsxs("div",{className:"parent-section",children:[t.jsx("h3",{children:" Objectifs de la semaine"}),d.objectifs.length===0?t.jsx("p",{className:"parent-vide",children:"Aucun objectif cette semaine."}):t.jsx("div",{className:"parent-objectifs-liste",children:d.objectifs.map((I,U)=>t.jsxs("div",{className:"parent-objectif-item",children:[t.jsxs("div",{className:"parent-objectif-header",children:[t.jsx("span",{className:"parent-objectif-titre",children:I.titre}),t.jsx("span",{className:`parent-objectif-statut parent-statut-${I.statut}`,children:I.statut==="atteint"?" Atteint":I.statut==="en_cours"?" En cours":I.statut==="echoue"?" chou":" Non commenc"})]}),t.jsx("div",{className:"parent-progress-bar",children:t.jsx("div",{className:`parent-progress-fill parent-progress-${I.statut}`,style:{width:`${Math.min(I.progression/I.cible*100,100)}%`}})}),t.jsxs("span",{className:"parent-objectif-detail",children:[I.progression,"/",I.cible]})]},U))})]})]}),$==="lacunes"&&t.jsx("div",{className:"parent-tab-lacunes",children:d.lacunes.length===0?t.jsxs("div",{className:"parent-vide-section",children:[t.jsx("span",{className:"parent-vide-icon",children:""}),t.jsx("p",{children:"Aucune lacune dtecte ! Votre enfant est sur la bonne voie."})]}):t.jsx("div",{className:"parent-lacunes-liste",children:d.lacunes.map((I,U)=>t.jsxs("div",{className:"parent-lacune-item",style:{borderLeftColor:_f(I.niveauUrgence)},children:[t.jsxs("div",{className:"parent-lacune-header",children:[t.jsx("span",{className:"parent-lacune-discipline",children:I.disciplineNom}),t.jsx("span",{className:"parent-lacune-badge",style:{backgroundColor:_f(I.niveauUrgence),color:"#fff"},children:hM(I.niveauUrgence)})]}),t.jsxs("div",{className:"parent-lacune-details",children:[t.jsxs("span",{className:"parent-lacune-moyenne",children:["Moyenne : ",t.jsxs("strong",{children:[I.moyenne,"/20"]})]}),t.jsxs("span",{className:"parent-lacune-tendance",children:["Tendance : ",vM(I.tendance)," ",I.tendance==="hausse"?"En hausse":I.tendance==="baisse"?"En baisse":"Stable"]})]}),t.jsx("p",{className:"parent-lacune-conseil",children:I.niveauUrgence==="critique"?" Intervention recommande : discutez avec votre enfant et envisagez un soutien scolaire.":I.niveauUrgence==="important"?" Encouragez votre enfant  rviser cette matire rgulirement.":" Quelques rvisions suffiront pour consolider les acquis."})]},U))})}),$==="alertes"&&t.jsx("div",{className:"parent-tab-alertes",children:d.alertes.length===0?t.jsxs("div",{className:"parent-vide-section",children:[t.jsx("span",{className:"parent-vide-icon",children:""}),t.jsx("p",{children:"Aucune alerte pour le moment. Tout va bien !"})]}):t.jsx("div",{className:"parent-alertes-liste",children:d.alertes.map((I,U)=>t.jsxs("div",{className:`parent-alerte-item parent-alerte-${I.niveau}`,children:[t.jsxs("div",{className:"parent-alerte-header",children:[t.jsx("span",{className:"parent-alerte-titre",children:I.titre}),t.jsx("span",{className:"parent-alerte-badge",style:{backgroundColor:SZ(I.niveau),color:"#fff"},children:wZ(I.type)})]}),t.jsx("p",{className:"parent-alerte-message",children:I.message}),t.jsx("span",{className:"parent-alerte-date",children:Px(I.dateCreation)})]},U))})}),$==="travaux"&&t.jsx("div",{className:"parent-tab-travaux",children:Y.length===0?t.jsxs("div",{className:"parent-vide-section",children:[t.jsx("span",{className:"parent-vide-icon",children:""}),t.jsx("p",{children:"Aucun travail  faire pour le moment."})]}):t.jsx("div",{className:"parent-travaux-liste",children:Y.map(I=>t.jsxs("div",{className:"parent-travaux-item",children:[t.jsx("strong",{children:I.titre}),I.description&&t.jsx("p",{className:"parent-travaux-desc",children:I.description}),t.jsxs("span",{className:"parent-travaux-echeance",children:[" chance : ",I.dateEcheance.toLocaleDateString("fr-FR"),"  ",I.groupeNom]})]},I.id))})}),$==="resume"&&d.resume&&t.jsxs("div",{className:"parent-tab-resume",children:[t.jsxs("div",{className:"parent-resume-header",children:[t.jsxs("h3",{children:[" Rsum : ",d.resume.semaine]}),t.jsxs("span",{className:"parent-resume-evolution",children:["Score : ",d.resume.scoreGlobal,"/100"," ",tA(d.resume.evolutionScore)]})]}),t.jsxs("div",{className:"parent-resume-stats",children:[t.jsxs("div",{className:"parent-resume-stat",children:[t.jsx("span",{className:"parent-resume-stat-value",children:d.resume.nombreQuizSemaine}),t.jsx("span",{className:"parent-resume-stat-label",children:"Quiz passs"})]}),t.jsxs("div",{className:"parent-resume-stat",children:[t.jsxs("span",{className:"parent-resume-stat-value",children:[d.resume.joursActifsSemaine,"/7"]}),t.jsx("span",{className:"parent-resume-stat-label",children:"Jours actifs"})]}),t.jsxs("div",{className:"parent-resume-stat",children:[t.jsxs("span",{className:"parent-resume-stat-value",children:[d.resume.tempsEstimeMinutes," min"]}),t.jsx("span",{className:"parent-resume-stat-label",children:"Temps d'tude"})]}),t.jsxs("div",{className:"parent-resume-stat",children:[t.jsxs("span",{className:"parent-resume-stat-value",children:[d.resume.objectifsAtteints,"/",d.resume.objectifsTotal]}),t.jsx("span",{className:"parent-resume-stat-label",children:"Objectifs atteints"})]})]}),d.resume.evolutionDisciplines.length>0&&t.jsxs("div",{className:"parent-section",children:[t.jsx("h4",{children:" volution par matire"}),t.jsx("div",{className:"parent-evolution-liste",children:d.resume.evolutionDisciplines.map((I,U)=>t.jsxs("div",{className:"parent-evolution-item",children:[t.jsx("span",{className:"parent-evolution-discipline",children:I.disciplineNom}),t.jsxs("div",{className:"parent-evolution-scores",children:[t.jsxs("span",{className:"parent-evolution-prec",children:[I.moyenneSemainePrecedente,"/20"]}),t.jsx("span",{className:"parent-evolution-fleche",children:tA(I.evolution)}),t.jsxs("span",{className:"parent-evolution-courante",children:[I.moyenneSemaineCourante,"/20"]}),t.jsxs("span",{className:`parent-evolution-ecart ${I.ecart>0?"ecart-positif":I.ecart<0?"ecart-negatif":""}`,children:["(",I.ecart>0?"+":"",I.ecart,")"]})]})]},U))})]}),d.resume.disciplinesEnDifficulte.length>0&&t.jsxs("div",{className:"parent-section parent-section-warning",children:[t.jsx("h4",{children:" Matires ncessitant une attention"}),t.jsx("ul",{className:"parent-disciplines-difficulte",children:d.resume.disciplinesEnDifficulte.map((I,U)=>t.jsx("li",{children:I},U))})]})]}),$==="resume"&&!d.resume&&t.jsxs("div",{className:"parent-vide-section",children:[t.jsx("span",{className:"parent-vide-icon",children:""}),t.jsx("p",{children:"Le rsum sera disponible une fois que votre enfant aura pass des quiz."})]})]})]}):t.jsxs("div",{className:"parent-erreur-dashboard",children:[t.jsx("p",{children:" Impossible de charger le suivi. Veuillez ressayer."}),t.jsx("button",{className:"parent-btn parent-btn-primary",onClick:()=>o&&ee(o),children:" Ressayer"})]}):t.jsx("div",{className:"parent-select-enfant",children:t.jsx("p",{children:" Slectionnez un enfant dans la liste pour voir son suivi."})})})]})]})},Ij="compiled_ebooks";async function Xte(e,r,n,a){return(await Ot(_e(V,Ij),{userId:e,titre:r,description:n,sections:a,createdAt:Ee.now()})).id}async function SA(e,r=30){const n=ze(_e(V,Ij),Se("userId","==",e),Qe("createdAt","desc")),a=await Ae(n),l=[];return a.forEach(o=>{l.length<r&&l.push({id:o.id,...o.data()})}),l}async function Zte(e){await Ir(je(V,Ij,e))}const Jte=({userId:e,subscriptionPlan:r,history:n,onClose:a,onSaved:l,markdownToHtml:o})=>{const[u,d]=g.useState("select"),[m,p]=g.useState([]),[h,v]=g.useState(""),[b,x]=g.useState(""),[j,_]=g.useState(!1),[w,C]=g.useState(!1),[E,S]=g.useState(""),A=n.filter(M=>M.type!=="quiz_auto"&&M.content);function z(M){p(K=>K.some(X=>X.id===M.id)?K.filter(X=>X.id!==M.id):[...K,M])}function k(M){M!==0&&p(K=>{const ee=[...K];return[ee[M-1],ee[M]]=[ee[M],ee[M-1]],ee})}function P(M){p(K=>{if(M===K.length-1)return K;const ee=[...K];return[ee[M],ee[M+1]]=[ee[M+1],ee[M]],ee})}const D=g.useCallback((M=!1)=>{const K=m.map((ee,X)=>`
      <section class="ebook-section">
        <div class="section-header">
          <span class="section-num">${X+1}</span>
          <div class="section-meta">
            <h2 class="section-title">${ee.chapitre}</h2>
            <p class="section-subtitle">
              ${xr[ee.type]} &nbsp;&nbsp;
              ${ee.discipline} &nbsp;&nbsp; Classe : ${ee.classe}
            </p>
          </div>
        </div>
        <div class="section-body">${o(ee.content||"")}</div>
      </section>`).join('<div class="page-break"></div>');return`<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>${h||"Ebook PedaClic"}</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Georgia', serif;
      font-size: 12pt;
      line-height: 1.75;
      color: #1a1a2e;
      background: #fff;
      padding: ${M?"0":"2rem"};
      max-width: 860px;
      margin: auto;
    }
    /*  Couverture  */
    .cover {
      min-height: ${M?"100vh":"280px"};
      background: linear-gradient(135deg, #1a56db 0%, #7c3aed 100%);
      border-radius: ${M?"0":"12px"};
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 3rem 2rem;
      color: #fff;
      margin-bottom: 2.5rem;
    }
    .cover-logo { font-size: 3rem; margin-bottom: 1rem; }
    .cover-title { font-size: 2rem; font-weight: 700; line-height: 1.2; margin-bottom: 0.75rem; }
    .cover-desc { font-size: 1rem; opacity: 0.85; max-width: 480px; }
    .cover-meta { margin-top: 1.5rem; font-size: 0.85rem; opacity: 0.7; }
    /*  Sommaire  */
    .toc {
      background: #f8faff;
      border: 1px solid #dbeafe;
      border-radius: 10px;
      padding: 1.5rem 2rem;
      margin-bottom: 2.5rem;
    }
    .toc h2 { font-size: 1.1rem; color: #1a56db; margin-bottom: 1rem; }
    .toc ol { padding-left: 1.25rem; }
    .toc li { padding: 0.3rem 0; font-size: 0.95rem; color: #374151; }
    .toc li span { color: #6b7280; font-size: 0.85rem; margin-left: 0.5rem; }
    /*  Sections  */
    .ebook-section { margin-bottom: 2.5rem; }
    .section-header {
      display: flex;
      gap: 1rem;
      align-items: flex-start;
      background: #eff6ff;
      border-left: 4px solid #1a56db;
      padding: 1rem 1.25rem;
      border-radius: 0 8px 8px 0;
      margin-bottom: 1.25rem;
    }
    .section-num {
      background: #1a56db;
      color: #fff;
      width: 32px; height: 32px;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-weight: 700; font-size: 0.9rem;
      flex-shrink: 0;
    }
    .section-title { font-size: 1.3rem; font-weight: 700; color: #1e3a8a; }
    .section-subtitle { font-size: 0.82rem; color: #6b7280; margin-top: 2px; }
    .section-body { padding: 0 0.5rem; }
    .section-body h1, .section-body h2 { color: #1a56db; margin: 1rem 0 0.5rem; }
    .section-body h3 { color: #4f46e5; margin: 0.75rem 0 0.4rem; }
    .section-body p { margin-bottom: 0.6rem; }
    .section-body ul, .section-body ol { margin: 0.4rem 0 0.8rem 1.5rem; }
    .section-body li { margin-bottom: 0.3rem; }
    .section-body strong { font-weight: 700; color: #111827; }
    .section-body em { font-style: italic; color: #374151; }
    .section-body code {
      font-family: 'Courier New', monospace;
      background: #f3f4f6;
      padding: 1px 5px;
      border-radius: 3px;
      font-size: 0.9em;
    }
    .section-body pre {
      background: #f3f4f6;
      padding: 0.75rem 1rem;
      border-radius: 6px;
      overflow-x: auto;
      margin: 0.8rem 0;
    }
    .section-body hr { border: none; border-top: 1px solid #e5e7eb; margin: 1rem 0; }
    /*  Sauts de page  */
    .page-break { page-break-after: always; break-after: page; height: 0; }
    /*  Pied de page  */
    .ebook-footer {
      margin-top: 3rem;
      text-align: center;
      font-size: 0.8rem;
      color: #9ca3af;
      border-top: 1px solid #e5e7eb;
      padding-top: 1rem;
    }
    @media print {
      body { padding: 0; max-width: none; }
      .cover { border-radius: 0; }
      @page { margin: 2cm; }
    }
  </style>
</head>
<body>
  <div class="cover">
    <div class="cover-logo"></div>
    <h1 class="cover-title">${h||"Ebook PedaClic"}</h1>
    ${b?`<p class="cover-desc">${b}</p>`:""}
    <p class="cover-meta">
      Gnr par PedaClic &nbsp;&nbsp;
      ${new Date().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}
    </p>
  </div>

  <div class="toc">
    <h2> Table des matires</h2>
    <ol>
      ${m.map(ee=>`<li>${ee.chapitre} <span> ${ee.discipline}  ${ee.classe}</span></li>`).join("")}
    </ol>
  </div>

  ${K}

  <div class="ebook-footer">
    PedaClic  L'cole en un clic &nbsp;&nbsp; www.pedaclic.sn
  </div>

  ${M?"<script>window.onload = () => window.print();<\/script>":""}
</body>
</html>`},[m,h,b,o]);function $(){const M=window.open("","_blank","width=920,height=720");M&&(M.document.write(D(!0)),M.document.close())}function F(){const M=D(!1),K=`
<html xmlns:o="urn:schemas-microsoft-com:office:office"
      xmlns:w="urn:schemas-microsoft-com:office:word"
      xmlns="http://www.w3.org/TR/REC-html40">
<head><meta charset="utf-8"><title>${h}</title></head>
<body>${M}</body></html>`,ee=new Blob(["\uFEFF",K],{type:"application/msword;charset=utf-8"}),X=URL.createObjectURL(ee),L=document.createElement("a");L.href=X;const I=(h||"ebook_pedaclic").replace(/[^\w\u00C0-\u017E\s-]/g,"").replace(/\s+/g,"_").slice(0,60);L.download=`${I}.doc`,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(X)}async function Y(){if(!h.trim()){S("Veuillez donner un titre  l'ebook.");return}const{autorise:M,usage:K,limite:ee}=await Cf(e,r);if(!M&&ee!==null){S(`Limite de ${ee} ressources atteinte (${K}/${ee}). Passez  Premium Pro pour un accs illimit.`);return}_(!0),S("");try{const X=m.map(L=>({contenuId:L.id,type:L.type,discipline:L.discipline,classe:L.classe,chapitre:L.chapitre,content:L.content}));await Xte(e,h,b,X),await Rj(e),C(!0),l()}catch{S("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{_(!1)}}return u==="select"?t.jsx("div",{className:"ai-generator__modal-overlay",onClick:M=>{M.target===M.currentTarget&&a()},children:t.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:M=>M.stopPropagation(),children:[t.jsxs("div",{className:"ai-generator__modal-header",children:[t.jsxs("div",{className:"ai-generator__modal-title-block",children:[t.jsx("h2",{children:" Compiler un Ebook"}),t.jsx("span",{className:"ai-generator__modal-subtitle",children:"tape 1 / 3  Slectionner les chapitres  inclure"})]}),t.jsx("button",{className:"ai-generator__modal-close",onClick:a,children:""})]}),t.jsx("div",{className:"ai-generator__modal-body",children:A.length===0?t.jsx("p",{className:"ai-generator__empty",children:"Aucun contenu textuel sauvegard. Gnrez d'abord des cours, exercices ou sujets."}):t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"ebook-compiler__hint",children:"Cochez les chapitres  inclure dans l'ebook. Vous pourrez les rordonner ensuite."}),t.jsx("div",{className:"ebook-compiler__list",children:A.map(M=>{const K=m.some(ee=>ee.id===M.id);return t.jsxs("label",{className:`ebook-compiler__item ${K?"ebook-compiler__item--selected":""}`,children:[t.jsx("input",{type:"checkbox",checked:K,onChange:()=>z(M),className:"ebook-compiler__checkbox"}),t.jsx("div",{className:"ebook-compiler__item-icon",children:Ka[M.type]}),t.jsxs("div",{className:"ebook-compiler__item-info",children:[t.jsx("div",{className:"ebook-compiler__item-title",children:M.chapitre}),t.jsxs("div",{className:"ebook-compiler__item-meta",children:[xr[M.type],"  ",M.discipline,"  ",M.classe]})]}),K&&t.jsx("span",{className:"ebook-compiler__badge",children:""})]},M.id)})})]})}),t.jsxs("div",{className:"ai-generator__modal-footer",children:[t.jsx("button",{className:"btn btn--outline",onClick:a,children:"Annuler"}),t.jsx("button",{className:"btn btn--primary",onClick:()=>d("configure"),disabled:m.length===0,children:m.length===0?"Slectionnez au moins 1 chapitre":`Suivant  (${m.length} chapitre${m.length>1?"s":""})`})]})]})}):u==="configure"?t.jsx("div",{className:"ai-generator__modal-overlay",onClick:M=>{M.target===M.currentTarget&&a()},children:t.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:M=>M.stopPropagation(),children:[t.jsxs("div",{className:"ai-generator__modal-header",children:[t.jsxs("div",{className:"ai-generator__modal-title-block",children:[t.jsx("h2",{children:" Compiler un Ebook"}),t.jsx("span",{className:"ai-generator__modal-subtitle",children:"tape 2 / 3  Titre et ordre des chapitres"})]}),t.jsx("button",{className:"ai-generator__modal-close",onClick:a,children:""})]}),t.jsxs("div",{className:"ai-generator__modal-body",children:[t.jsxs("div",{className:"ebook-compiler__field",children:[t.jsx("label",{className:"ebook-compiler__label",children:"Titre de l'ebook *"}),t.jsx("input",{className:"ebook-compiler__input",type:"text",placeholder:"Ex : Cours de Mathmatiques  3me",value:h,onChange:M=>v(M.target.value),autoFocus:!0})]}),t.jsxs("div",{className:"ebook-compiler__field",children:[t.jsx("label",{className:"ebook-compiler__label",children:"Description (optionnel)"}),t.jsx("textarea",{className:"ebook-compiler__textarea",rows:2,placeholder:"Ex : Recueil de cours et exercices pour la classe de 3me",value:b,onChange:M=>x(M.target.value)})]}),t.jsxs("div",{className:"ebook-compiler__order-label",children:["Ordre des chapitres ",t.jsx("span",{children:"(glisser les flches pour rordonner)"})]}),t.jsx("div",{className:"ebook-compiler__order-list",children:m.map((M,K)=>t.jsxs("div",{className:"ebook-compiler__order-item",children:[t.jsx("span",{className:"ebook-compiler__order-num",children:K+1}),t.jsx("span",{className:"ebook-compiler__order-icon",children:Ka[M.type]}),t.jsxs("div",{className:"ebook-compiler__order-info",children:[t.jsx("div",{className:"ebook-compiler__order-title",children:M.chapitre}),t.jsxs("div",{className:"ebook-compiler__order-meta",children:[M.discipline,"  ",M.classe]})]}),t.jsxs("div",{className:"ebook-compiler__order-btns",children:[t.jsx("button",{type:"button",onClick:()=>k(K),disabled:K===0,title:"Monter",children:""}),t.jsx("button",{type:"button",onClick:()=>P(K),disabled:K===m.length-1,title:"Descendre",children:""})]})]},M.id))})]}),t.jsxs("div",{className:"ai-generator__modal-footer",children:[t.jsx("button",{className:"btn btn--outline",onClick:()=>d("select"),children:" Retour"}),t.jsx("button",{className:"btn btn--primary",onClick:()=>{if(!h.trim()){S("Titre requis.");return}S(""),d("preview")},children:"Aperu "})]}),E&&t.jsx("p",{className:"ebook-compiler__error",children:E})]})}):t.jsx("div",{className:"ai-generator__modal-overlay",onClick:M=>{M.target===M.currentTarget&&a()},children:t.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:M=>M.stopPropagation(),children:[t.jsxs("div",{className:"ai-generator__modal-header",children:[t.jsxs("div",{className:"ai-generator__modal-title-block",children:[t.jsxs("h2",{children:[" ",h]}),t.jsx("span",{className:"ai-generator__modal-subtitle",children:"tape 3 / 3  Aperu et tlchargement"})]}),t.jsxs("div",{className:"ai-generator__modal-header-actions",children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:$,title:"Enregistrer en PDF",children:" PDF"}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:F,title:"Tlcharger en Word",children:" Word"}),t.jsx("button",{className:"ai-generator__modal-close",onClick:a,children:""})]})]}),t.jsxs("div",{className:"ai-generator__modal-body",children:[t.jsxs("div",{className:"ebook-compiler__cover-preview",children:[t.jsx("span",{children:""}),t.jsxs("div",{children:[t.jsx("div",{className:"ebook-compiler__cover-title",children:h}),b&&t.jsx("div",{className:"ebook-compiler__cover-desc",children:b}),t.jsxs("div",{className:"ebook-compiler__cover-meta",children:[m.length," chapitre",m.length>1?"s":"","  PedaClic"]})]})]}),t.jsxs("div",{className:"ebook-compiler__toc",children:[t.jsx("div",{className:"ebook-compiler__toc-title",children:" Sommaire"}),t.jsx("ol",{children:m.map((M,K)=>t.jsxs("li",{children:[t.jsxs("span",{children:[K+1,". ",M.chapitre]}),t.jsxs("span",{className:"ebook-compiler__toc-meta",children:[M.discipline,"  ",M.classe]})]},M.id))})]}),w?t.jsx("div",{className:"ebook-compiler__success",children:" Ebook sauvegard avec succs dans votre bibliothque IA !"}):t.jsxs("div",{className:"ebook-compiler__save-row",children:[t.jsx("button",{className:"btn btn--primary btn--lg",onClick:Y,disabled:j,children:j?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner spinner--sm"})," Sauvegarde"]}):" Sauvegarder dans PedaClic"}),t.jsx("p",{className:"ebook-compiler__save-hint",children:"L'ebook sera accessible depuis votre Bibliothque."})]}),E&&t.jsx("p",{className:"ebook-compiler__error",children:E})]}),t.jsxs("div",{className:"ai-generator__modal-footer",children:[t.jsx("button",{className:"btn btn--outline",onClick:()=>d("configure"),children:" Modifier"}),t.jsx("button",{className:"btn btn--outline",onClick:a,children:"Fermer"})]})]})})},ere=[30,45,60,90,120],tre=()=>{const{currentUser:e}=Xe(),[r,n]=g.useState(1),[a,l]=g.useState([]),[o,u]=g.useState(null),[d,m]=g.useState(""),[p,h]=g.useState(""),[v,b]=g.useState(""),[x,j]=g.useState(null),[_,w]=g.useState({}),[C,E]=g.useState(!1),[S,A]=g.useState(null),[z,k]=g.useState(null),[P,D]=g.useState(!1),[$,F]=g.useState(!1),[Y,M]=g.useState(null),[K,ee]=g.useState(null),[X,L]=g.useState(!1),[I,U]=g.useState([]),[B,T]=g.useState(!1),[Z,H]=g.useState(null),[ce,xe]=g.useState(!1),[fe,G]=g.useState(!1),[ve,De]=g.useState([]),[de,we]=g.useState(!1),[R,ae]=g.useState(!0),Ce=g.useMemo(()=>{const te=new Map;return a.forEach(W=>{te.has(W.nom)||te.set(W.nom,W)}),Array.from(te.values())},[a]);g.useEffect(()=>{(async()=>{try{ae(!0);const W=ze(_e(V,"disciplines"),Qe("nom")),ie=await Ae(W),Ne=[];ie.forEach(We=>{const Dt=We.data();Dt.nom&&Dt.nom.trim()&&Ne.push({id:We.id,nom:Dt.nom||"",classe:Dt.classe||"",niveau:Dt.niveau||""})}),l(Ne)}catch(W){console.error("[AIGenerator] Erreur chargement disciplines:",W),k("Impossible de charger les disciplines.")}finally{ae(!1)}})()},[]),g.useEffect(()=>{e?.uid&&Cf(e.uid,e.subscriptionPlan).then(({usage:te,limite:W})=>ee({usage:te,limite:W}))},[e?.uid,e?.subscriptionPlan]);const ke=te=>{u(te),k(null)},Ke=()=>{const te=[];if(o||te.push("discipline"),d||te.push("classe"),(!p||p<1)&&te.push("dure de la leon"),te.length>0){k(`Champs requis manquants : ${te.join(", ")}`);return}n(2),k(null)},et=()=>{if(!v.trim()){k("Veuillez saisir le titre du chapitre.");return}n(3),k(null)},rt=te=>{j(te),n(4),k(null)},Yt=()=>{r>1&&(n(te=>te-1),k(null),r===5&&(A(null),F(!1),M(null)))},mr=()=>{n(1),u(null),m(""),h(""),b(""),j(null),w({}),A(null),k(null),F(!1),M(null)},fr=async()=>{if(!o||!x||!v.trim()||!d){k("Paramtres incomplets. Veuillez reprendre depuis le dbut.");return}E(!0),k(null);try{const te={..._,duree:typeof p=="number"?p:void 0},W={type:x,discipline:o.nom,classe:d,chapitre:v.trim(),options:Object.keys(te).length>0?te:void 0},ie=await XJ(W);A(ie),n(5)}catch(te){const W=te instanceof Error?te.message:"Erreur inconnue";k(W)}finally{E(!1)}},$r=async()=>{if(!e||!S||!o||!x)return;const{autorise:te,usage:W,limite:ie}=await Cf(e.uid,e.subscriptionPlan);if(!te&&ie!==null){k(`Vous avez atteint la limite de ${ie} ressources (${W}/${ie} utilises). Passez  Premium Pro (abonnement annuel ou 9 mois) pour un accs illimit.`);return}D(!0),k(null);try{let Ne;const Dt=a.find(Tr=>Tr.nom===o.nom&&Tr.classe===d)?.id||o.id,Kr={type:x,discipline:o.nom,classe:d,chapitre:v.trim(),options:{..._,duree:typeof p=="number"?p:void 0}};S.type==="quiz"&&S.data.questions?Ne=await JJ(e.uid,Kr,S.data.questions,Dt):Ne=await ZJ(e.uid,Kr,S.data.content||"",Dt),M(Ne),F(!0),await Rj(e.uid);try{const Tr=await Bb(e.uid);U(Tr)}catch{}}catch(Ne){const We=Ne instanceof Error?Ne.message:"Erreur de sauvegarde";k(We)}finally{D(!1)}},he=async()=>{if(e){T(!0);try{const te=await Bb(e.uid);U(te),L(!0)}catch(te){console.error("[AIGenerator] Erreur historique:",te)}finally{T(!1)}}},Pe=te=>te.replace(/[^\w\u00C0-\u017E\s-]/g,"").trim().replace(/\s+/g,"_").slice(0,60)||"contenu_pedaclic",Ie=(te,W)=>{const ie=URL.createObjectURL(te),Ne=document.createElement("a");Ne.href=ie,Ne.download=W,document.body.appendChild(Ne),Ne.click(),document.body.removeChild(Ne),URL.revokeObjectURL(ie)},Ye=(te,W)=>{const ie=dt(te),Ne=`
<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office"
      xmlns:w="urn:schemas-microsoft-com:office:word"
      xmlns="http://www.w3.org/TR/REC-html40">
<head>
  <meta charset="utf-8">
  <title>${W}</title>
  <!--[if gte mso 9]><xml><w:WordDocument><w:View>Print</w:View><w:Zoom>100</w:Zoom></w:WordDocument></xml><![endif]-->
  <style>
    body { font-family: Arial, sans-serif; font-size: 12pt; line-height: 1.6; margin: 2cm; color: #1a1a1a; }
    h1 { font-size: 18pt; color: #1a56db; margin-bottom: 12pt; }
    h2 { font-size: 15pt; color: #1a56db; margin-top: 18pt; margin-bottom: 8pt; }
    h3 { font-size: 13pt; color: #333; margin-top: 14pt; }
    p  { margin-bottom: 8pt; }
    ul, ol { margin-left: 1cm; margin-bottom: 8pt; }
    li { margin-bottom: 4pt; }
    strong { font-weight: bold; }
    em { font-style: italic; }
    code { font-family: Courier New; background: #f5f5f5; padding: 1pt 3pt; }
    pre  { font-family: Courier New; background: #f5f5f5; padding: 8pt; margin: 8pt 0; }
    hr { border: none; border-top: 1px solid #ccc; margin: 12pt 0; }
  </style>
</head>
<body>
  <h1>${W}</h1>
  ${ie}
</body>
</html>`,We=new Blob(["\uFEFF",Ne],{type:"application/msword;charset=utf-8"});Ie(We,`${Pe(W)}.doc`)},nt=(te,W)=>{const ie=dt(te),Ne=window.open("","_blank","width=900,height=700");Ne&&(Ne.document.write(`
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>${W}</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: Arial, sans-serif; font-size: 12pt; line-height: 1.7; color: #1a1a1a; padding: 2cm; max-width: 800px; margin: auto; }
    h1 { font-size: 20pt; color: #1a56db; margin-bottom: 14pt; padding-bottom: 6pt; border-bottom: 2px solid #1a56db; }
    h2 { font-size: 15pt; color: #1a56db; margin: 18pt 0 8pt; }
    h3 { font-size: 13pt; color: #333; margin: 14pt 0 6pt; }
    p  { margin-bottom: 8pt; }
    ul, ol { margin: 6pt 0 8pt 1.5cm; }
    li { margin-bottom: 4pt; }
    strong { font-weight: bold; }
    em { font-style: italic; }
    code { font-family: Courier New, monospace; background: #f5f5f5; padding: 1pt 4pt; border-radius: 3pt; font-size: 10pt; }
    pre  { font-family: Courier New, monospace; background: #f5f5f5; padding: 10pt; margin: 8pt 0; border-radius: 4pt; font-size: 10pt; white-space: pre-wrap; }
    hr { border: none; border-top: 1px solid #ddd; margin: 14pt 0; }
    .header-meta { font-size: 9pt; color: #888; margin-bottom: 18pt; }
    @media print {
      body { padding: 0; }
      @page { margin: 2cm; }
    }
  </style>
</head>
<body>
  <h1>${W}</h1>
  <p class="header-meta">PedaClic  Gnr le ${new Date().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}</p>
  ${ie}
  <script>window.onload = () => { window.print(); };<\/script>
</body>
</html>`),Ne.document.close())},qt=async te=>{if(window.confirm("Supprimer ce contenu gnr ?"))try{await eee(te),U(W=>W.filter(ie=>ie.id!==te))}catch(W){console.error("[AIGenerator] Erreur suppression:",W)}},Kt=async()=>{if(e){we(!0);try{const te=await SA(e.uid);De(te),G(!0)}catch(te){console.error("[AIGenerator] Erreur chargement ebooks:",te)}finally{we(!1)}}},se=async te=>{if(window.confirm("Supprimer cet ebook ?"))try{await Zte(te),De(W=>W.filter(ie=>ie.id!==te))}catch(W){console.error("[AIGenerator] Erreur suppression ebook:",W)}},Oe=te=>{const W=te.sections.map((ie,Ne)=>`# ${Ne+1}. ${ie.chapitre}

**${xr[ie.type]}**  ${ie.discipline}  ${ie.classe}

${ie.content}`).join(`

---

`);H({id:te.id,userId:te.userId,type:"cours_complet",discipline:"Ebook compil",disciplineId:"",classe:"",chapitre:te.titre,content:W,createdAt:te.createdAt}),G(!1)},dt=g.useCallback(te=>{if(!te)return"";let W=te.replace(/^### (.+)$/gm,"<h3>$1</h3>").replace(/^## (.+)$/gm,"<h2>$1</h2>").replace(/^# (.+)$/gm,"<h1>$1</h1>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/^- (.+)$/gm,"<li>$1</li>").replace(/^\d+\. (.+)$/gm,"<li>$1</li>").replace(/^---$/gm,"<hr />").replace(/```(\w*)\n([\s\S]*?)```/g,"<pre><code>$2</code></pre>").replace(/`(.+?)`/g,"<code>$1</code>").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br />");return W=W.replace(/(<li>.*?<\/li>(\s*<br \/>)?)+/g,ie=>"<ul>"+ie.replace(/<br \/>/g,"")+"</ul>"),`<p>${W}</p>`},[]);return e?e.isPremium?t.jsxs("div",{className:"ai-generator",children:[t.jsxs("div",{className:"ai-generator__header",children:[t.jsx("h1",{className:"ai-generator__title",children:" Gnrateur de Contenu IA"}),t.jsx("p",{className:"ai-generator__subtitle",children:"Crez des cours, exercices, quiz et sujets d'examen adapts au programme sngalais"}),K&&K.limite!==null&&t.jsxs("p",{className:"ai-generator__quota",style:{fontSize:"0.875rem",color:"#6b7280",marginTop:"0.25rem"},children:["Ressources utilises : ",K.usage," / ",K.limite]}),t.jsxs("div",{className:"ai-generator__header-actions",children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:he,disabled:B,children:B?" Chargement...":" Historique"}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>{he(),xe(!0)},title:"Compiler plusieurs contenus en un ebook",children:" Compiler un Ebook"}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:Kt,disabled:de,title:"Voir mes ebooks compils",children:de?"...":" Mes Ebooks"}),r>1&&t.jsx("button",{className:"btn btn--outline btn--sm",onClick:mr,children:" Recommencer"})]})]}),t.jsx("div",{className:"ai-generator__steps",children:[1,2,3,4,5].map(te=>t.jsxs("div",{className:`ai-generator__step-indicator ${te===r?"ai-generator__step-indicator--active":""} ${te<r?"ai-generator__step-indicator--done":""}`,children:[t.jsx("span",{className:"ai-generator__step-number",children:te<r?"":te}),t.jsxs("span",{className:"ai-generator__step-label",children:[te===1&&"Paramtres",te===2&&"Chapitre",te===3&&"Type",te===4&&"Options",te===5&&"Rsultat"]})]},te))}),z&&t.jsxs("div",{className:"ai-generator__error",children:[t.jsx("span",{className:"ai-generator__error-icon",children:""}),z,t.jsx("button",{className:"ai-generator__error-close",onClick:()=>k(null),children:""})]}),t.jsxs("div",{className:"ai-generator__content",children:[r===1&&t.jsxs("div",{className:"ai-generator__step-content",children:[t.jsx("h2",{className:"ai-generator__step-title",children:" Paramtres de la leon"}),t.jsxs("div",{className:"ai-generator__field",children:[t.jsxs("label",{className:"ai-generator__label",children:["Discipline ",t.jsx("span",{className:"ai-generator__required",children:"*"})]}),R?t.jsxs("div",{className:"ai-generator__loading",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement des disciplines..."})]}):Ce.length===0?t.jsx("div",{className:"ai-generator__empty",children:t.jsx("p",{children:"Aucune discipline disponible."})}):t.jsx("div",{className:"ai-generator__discipline-grid",children:Ce.map(te=>t.jsx("button",{className:`ai-generator__discipline-card ${o?.nom===te.nom?"ai-generator__discipline-card--selected":""}`,onClick:()=>ke(te),children:t.jsx("span",{className:"ai-generator__discipline-name",children:te.nom})},te.id))})]}),t.jsxs("div",{className:"ai-generator__field",children:[t.jsxs("label",{className:"ai-generator__label",children:["Classe ",t.jsx("span",{className:"ai-generator__required",children:"*"})]}),t.jsx("div",{className:"ai-generator__classe-grid",children:yr.map(te=>t.jsx("button",{className:`ai-generator__classe-btn ${d===te?"ai-generator__classe-btn--selected":""}`,onClick:()=>{m(te),k(null)},children:te},te))})]}),t.jsxs("div",{className:"ai-generator__field",children:[t.jsxs("label",{htmlFor:"dureeCours",className:"ai-generator__label",children:["Dure de la leon (minutes) ",t.jsx("span",{className:"ai-generator__required",children:"*"})]}),t.jsxs("div",{className:"ai-generator__duree-group",children:[t.jsx("div",{className:"ai-generator__duree-presets",children:ere.map(te=>t.jsxs("button",{className:`ai-generator__duree-btn ${p===te?"ai-generator__duree-btn--selected":""}`,onClick:()=>{h(te),k(null)},children:[te," min"]},te))}),t.jsx("input",{id:"dureeCours",type:"number",className:"ai-generator__input ai-generator__input--small",min:"15",max:"300",step:"5",value:p,onChange:te=>{const W=parseInt(te.target.value);h(isNaN(W)?"":W),k(null)},placeholder:"Autre dure..."})]})]}),t.jsxs("div",{className:"ai-generator__nav",children:[t.jsx("div",{})," ",t.jsx("button",{className:"btn btn--primary",onClick:Ke,disabled:!o||!d||!p,children:"Continuer "})]})]}),r===2&&t.jsxs("div",{className:"ai-generator__step-content",children:[t.jsx("h2",{className:"ai-generator__step-title",children:" Prcisez le chapitre"}),t.jsxs("div",{className:"ai-generator__recap",children:[t.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),t.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),t.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),t.jsx("span",{className:"ai-generator__recap-value",children:d}),t.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),t.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]})]}),t.jsxs("div",{className:"ai-generator__field",children:[t.jsx("label",{htmlFor:"chapitre",className:"ai-generator__label",children:"Titre du chapitre ou du thme"}),t.jsx("input",{id:"chapitre",type:"text",className:"ai-generator__input",placeholder:"Ex: Les fonctions affines, Le rcit autobiographique, La tectonique des plaques...",value:v,onChange:te=>b(te.target.value),onKeyDown:te=>te.key==="Enter"&&et(),autoFocus:!0})]}),t.jsxs("div",{className:"ai-generator__nav",children:[t.jsx("button",{className:"btn btn--outline",onClick:Yt,children:" Retour"}),t.jsx("button",{className:"btn btn--primary",onClick:et,disabled:!v.trim(),children:"Continuer "})]})]}),r===3&&t.jsxs("div",{className:"ai-generator__step-content",children:[t.jsx("h2",{className:"ai-generator__step-title",children:" Quel type de contenu ?"}),t.jsxs("div",{className:"ai-generator__recap",children:[t.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),t.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),t.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),t.jsx("span",{className:"ai-generator__recap-value",children:d}),t.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),t.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]}),t.jsx("span",{className:"ai-generator__recap-label",children:"Chapitre :"}),t.jsx("span",{className:"ai-generator__recap-value",children:v})]}),t.jsx("div",{className:"ai-generator__type-grid",children:Object.keys(xr).map(te=>t.jsxs("button",{className:"ai-generator__type-card",onClick:()=>rt(te),children:[t.jsx("span",{className:"ai-generator__type-icon",children:Ka[te]}),t.jsx("span",{className:"ai-generator__type-name",children:xr[te]}),t.jsx("span",{className:"ai-generator__type-desc",children:KJ[te]})]},te))}),t.jsx("div",{className:"ai-generator__nav",children:t.jsx("button",{className:"btn btn--outline",onClick:Yt,children:" Retour"})})]}),r===4&&t.jsxs("div",{className:"ai-generator__step-content",children:[t.jsx("h2",{className:"ai-generator__step-title",children:" Options de gnration"}),t.jsxs("div",{className:"ai-generator__recap",children:[t.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),t.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),t.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),t.jsx("span",{className:"ai-generator__recap-value",children:d}),t.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),t.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]}),t.jsx("span",{className:"ai-generator__recap-label",children:"Chapitre :"}),t.jsx("span",{className:"ai-generator__recap-value",children:v}),t.jsx("span",{className:"ai-generator__recap-label",children:"Type :"}),t.jsxs("span",{className:"ai-generator__recap-value",children:[x&&Ka[x]," ",x&&xr[x]]})]}),t.jsxs("div",{className:"ai-generator__options",children:[t.jsxs("div",{className:"ai-generator__field",children:[t.jsx("label",{className:"ai-generator__label",children:"Niveau de difficult"}),t.jsx("div",{className:"ai-generator__radio-group",children:["facile","moyen","difficile"].map(te=>t.jsxs("label",{className:"ai-generator__radio",children:[t.jsx("input",{type:"radio",name:"difficulte",value:te,checked:_.difficulte===te,onChange:()=>w(W=>({...W,difficulte:te}))}),t.jsxs("span",{className:"ai-generator__radio-label",children:[te==="facile"&&" Facile",te==="moyen"&&" Moyen",te==="difficile"&&" Difficile"]})]},te))})]}),x==="sujet_examen"&&t.jsxs("div",{className:"ai-generator__field",children:[t.jsx("label",{className:"ai-generator__label",children:"Type d'examen"}),t.jsx("div",{className:"ai-generator__radio-group",children:["BFEM","BAC"].map(te=>t.jsxs("label",{className:"ai-generator__radio",children:[t.jsx("input",{type:"radio",name:"typeExamen",value:te,checked:_.typeExamen===te,onChange:()=>w(W=>({...W,typeExamen:te}))}),t.jsx("span",{className:"ai-generator__radio-label",children:te})]},te))})]}),t.jsxs("div",{className:"ai-generator__field",children:[t.jsx("label",{htmlFor:"objectifs",className:"ai-generator__label",children:"Objectifs pdagogiques (optionnel)"}),t.jsx("textarea",{id:"objectifs",className:"ai-generator__textarea",rows:3,placeholder:"Ex: L'lve doit tre capable de rsoudre une quation du 1er degr...",value:_.objectifs||"",onChange:te=>w(W=>({...W,objectifs:te.target.value||void 0}))})]}),t.jsxs("div",{className:"ai-generator__field",children:[t.jsx("label",{htmlFor:"consignes",className:"ai-generator__label",children:"Consignes spciales (optionnel)"}),t.jsx("textarea",{id:"consignes",className:"ai-generator__textarea",rows:2,placeholder:"Ex: Inclure un exercice sur les statistiques, utiliser des exemples avec le football...",value:_.consignesSpeciales||"",onChange:te=>w(W=>({...W,consignesSpeciales:te.target.value||void 0}))})]})]}),t.jsxs("div",{className:"ai-generator__nav",children:[t.jsx("button",{className:"btn btn--outline",onClick:Yt,children:" Retour"}),t.jsx("button",{className:"btn btn--primary btn--lg",onClick:fr,disabled:C,children:C?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner spinner--sm"}),"Gnration en cours..."]}):" Gnrer le contenu"})]}),C&&t.jsxs("div",{className:"ai-generator__generating",children:[t.jsxs("div",{className:"ai-generator__generating-animation",children:[t.jsx("span",{children:""}),t.jsx("span",{children:""}),t.jsx("span",{children:""})]}),t.jsxs("p",{children:["L'IA rdige votre"," ",x&&xr[x].toLowerCase(),"..."]}),t.jsx("p",{className:"ai-generator__generating-hint",children:"Cela peut prendre 15  30 secondes."})]})]}),r===5&&S&&t.jsxs("div",{className:"ai-generator__step-content",children:[t.jsx("h2",{className:"ai-generator__step-title",children:" Contenu gnr"}),t.jsxs("div",{className:"ai-generator__recap ai-generator__recap--success",children:[t.jsx("span",{className:"ai-generator__recap-label",children:"Type :"}),t.jsxs("span",{className:"ai-generator__recap-value",children:[x&&Ka[x]," ",x&&xr[x]]}),t.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),t.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),t.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),t.jsx("span",{className:"ai-generator__recap-value",children:d}),t.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),t.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]}),t.jsx("span",{className:"ai-generator__recap-label",children:"Chapitre :"}),t.jsx("span",{className:"ai-generator__recap-value",children:v})]}),t.jsxs("div",{className:"ai-generator__preview",children:[t.jsxs("div",{className:"ai-generator__preview-header",children:[t.jsx("h3",{children:"Prvisualisation"}),t.jsxs("div",{className:"ai-generator__preview-actions",children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>{const te=S.type==="quiz"?JSON.stringify(S.data.questions,null,2):S.data.content||"";navigator.clipboard.writeText(te),alert("Contenu copi dans le presse-papier !")},children:" Copier"}),S.type!=="quiz"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>nt(S.data.content||"",`${xr[x]}  ${o?.nom} ${d}`),title:"Tlcharger en PDF (via impression)",children:" PDF"}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Ye(S.data.content||"",`${xr[x]}  ${o?.nom} ${d}`),title:"Tlcharger en Word (.doc)",children:" Word"})]})]})]}),t.jsx("div",{className:"ai-generator__preview-body",children:S.type==="quiz"&&S.data.questions?t.jsxs("div",{className:"ai-generator__quiz-preview",children:[t.jsxs("p",{className:"ai-generator__quiz-count",children:[S.data.questions.length," questions gnres"]}),S.data.questions.map((te,W)=>t.jsxs("div",{className:"ai-generator__quiz-item",children:[t.jsxs("div",{className:"ai-generator__quiz-question",children:[t.jsxs("strong",{children:["Q",W+1,"."]})," ",te.question,t.jsx("span",{className:`ai-generator__quiz-badge ai-generator__quiz-badge--${te.difficulte}`,children:te.difficulte})]}),t.jsx("div",{className:"ai-generator__quiz-options",children:te.options.map((ie,Ne)=>t.jsxs("div",{className:`ai-generator__quiz-option ${Ne===te.reponseCorrecte?"ai-generator__quiz-option--correct":""}`,children:[t.jsx("span",{className:"ai-generator__quiz-option-letter",children:String.fromCharCode(65+Ne)}),ie,Ne===te.reponseCorrecte&&" "]},Ne))}),te.explication&&t.jsxs("div",{className:"ai-generator__quiz-explanation",children:[" ",te.explication]})]},W))]}):t.jsx("div",{className:"ai-generator__markdown-preview",dangerouslySetInnerHTML:{__html:dt(S.data.content||"")}})})]}),t.jsxs("div",{className:"ai-generator__actions",children:[$?t.jsxs("div",{className:"ai-generator__save-success",children:[t.jsx("span",{children:" Sauvegard avec succs !"}),S.type==="quiz"&&Y&&t.jsx($e,{to:`/quiz/${Y}`,className:"btn btn--outline btn--sm",children:" Voir le quiz"})]}):t.jsx("button",{className:"btn btn--primary btn--lg",onClick:$r,disabled:P,children:P?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner spinner--sm"}),"Sauvegarde..."]}):t.jsx(t.Fragment,{children:" Sauvegarder dans PedaClic"})}),t.jsx("button",{className:"btn btn--outline",onClick:mr,children:" Nouvelle gnration"})]})]})]}),Z&&t.jsx("div",{className:"ai-generator__modal-overlay",onClick:()=>H(null),children:t.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:te=>te.stopPropagation(),children:[t.jsxs("div",{className:"ai-generator__modal-header",children:[t.jsxs("div",{className:"ai-generator__modal-title-block",children:[t.jsxs("h2",{children:[Ka[Z.type]," ",xr[Z.type]]}),t.jsxs("span",{className:"ai-generator__modal-subtitle",children:[Z.discipline," (",Z.classe,")  ",Z.chapitre]})]}),t.jsxs("div",{className:"ai-generator__modal-header-actions",children:[Z.type!=="quiz_auto"&&Z.content&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>nt(Z.content,`${xr[Z.type]}  ${Z.discipline} ${Z.classe}`),title:"Enregistrer en PDF",children:" PDF"}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Ye(Z.content,`${xr[Z.type]}  ${Z.discipline} ${Z.classe}`),title:"Tlcharger en Word",children:" Word"})]}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:async()=>{H(null),await he()},title:"Retour  l'historique",children:" Historique"}),t.jsx("button",{className:"ai-generator__modal-close",onClick:()=>H(null),children:""})]})]}),t.jsx("div",{className:"ai-generator__modal-body",children:t.jsx("div",{className:"ai-generator__markdown-preview",dangerouslySetInnerHTML:{__html:dt(Z.content||"")}})})]})}),ce&&t.jsx(Jte,{userId:e.uid,subscriptionPlan:e?.subscriptionPlan,history:I,markdownToHtml:dt,onClose:()=>xe(!1),onSaved:async()=>{const te=await SA(e.uid);De(te)}}),fe&&t.jsx("div",{className:"ai-generator__modal-overlay",onClick:()=>G(!1),children:t.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:te=>te.stopPropagation(),children:[t.jsxs("div",{className:"ai-generator__modal-header",children:[t.jsx("h2",{children:" Mes Ebooks compils"}),t.jsxs("div",{className:"ai-generator__modal-header-actions",children:[t.jsx("button",{className:"btn btn--primary btn--sm",onClick:()=>{G(!1),xe(!0)},children:"+ Nouvel ebook"}),t.jsx("button",{className:"ai-generator__modal-close",onClick:()=>G(!1),children:""})]})]}),t.jsx("div",{className:"ai-generator__modal-body",children:ve.length===0?t.jsx("p",{className:"ai-generator__empty",children:`Vous n'avez pas encore compil d'ebook. Cliquez sur "Compiler un Ebook" pour commencer.`}):t.jsx("div",{className:"ebook-compiler__my-list",children:ve.map(te=>t.jsxs("div",{className:"ebook-compiler__my-item",children:[t.jsx("div",{className:"ebook-compiler__my-cover",children:""}),t.jsxs("div",{className:"ebook-compiler__my-info",children:[t.jsx("div",{className:"ebook-compiler__my-title",children:te.titre}),te.description&&t.jsx("div",{className:"ebook-compiler__my-desc",children:te.description}),t.jsxs("div",{className:"ebook-compiler__my-meta",children:[te.sections.length," chapitre",te.sections.length>1?"s":""," "," ",te.createdAt?.toDate?te.createdAt.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}):""]})]}),t.jsxs("div",{className:"ai-generator__history-actions",children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Oe(te),title:"Lire l'ebook",children:" Lire"}),t.jsx("button",{className:"btn btn--danger btn--sm",onClick:()=>te.id&&se(te.id),title:"Supprimer",children:""})]})]},te.id))})})]})}),X&&t.jsx("div",{className:"ai-generator__modal-overlay",onClick:()=>L(!1),children:t.jsxs("div",{className:"ai-generator__modal",onClick:te=>te.stopPropagation(),children:[t.jsxs("div",{className:"ai-generator__modal-header",children:[t.jsx("h2",{children:" Historique des gnrations"}),t.jsx("button",{className:"ai-generator__modal-close",onClick:()=>L(!1),children:""})]}),t.jsx("div",{className:"ai-generator__modal-body",children:I.length===0?t.jsx("p",{className:"ai-generator__empty",children:"Aucun contenu gnr pour le moment."}):t.jsx("div",{className:"ai-generator__history-list",children:I.map(te=>t.jsxs("div",{className:"ai-generator__history-item",children:[t.jsxs("div",{className:"ai-generator__history-info",children:[t.jsxs("span",{className:"ai-generator__history-type",children:[Ka[te.type]," ",xr[te.type]]}),t.jsxs("span",{className:"ai-generator__history-details",children:[te.discipline," (",te.classe,")  ",te.chapitre]}),t.jsx("span",{className:"ai-generator__history-date",children:te.createdAt?.toDate?te.createdAt.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Date inconnue"})]}),t.jsxs("div",{className:"ai-generator__history-actions",children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>{H(te),L(!1)},title:"Lire le contenu",children:" Lire"}),te.type!=="quiz_auto"&&te.content&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>nt(te.content,`${xr[te.type]}  ${te.discipline} ${te.classe}`),title:"PDF",children:""}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Ye(te.content,`${xr[te.type]}  ${te.discipline} ${te.classe}`),title:"Word",children:""})]}),t.jsx("button",{className:"btn btn--danger btn--sm",onClick:()=>te.id&&qt(te.id),title:"Supprimer",children:""})]})]},te.id))})})]})})]}):t.jsx("div",{className:"ai-generator",children:t.jsxs("div",{className:"ai-generator__gate",children:[t.jsx("div",{className:"ai-generator__gate-icon",children:""}),t.jsx("h2",{children:"Fonctionnalit Premium"}),t.jsx("p",{children:"Le gnrateur de contenu IA est rserv aux abonns Premium. Gnrez des cours, des exercices, des quiz et des sujets d'examen adapts au programme sngalais en un clic !"}),t.jsxs("div",{className:"ai-generator__gate-price",children:[t.jsx("span",{className:"price",children:"2 000 FCFA"}),t.jsx("span",{className:"period",children:"/mois"})]}),t.jsx($e,{to:"/premium",className:"btn btn--primary btn--lg",children:"Devenir Premium"})]})}):t.jsx("div",{className:"ai-generator",children:t.jsxs("div",{className:"ai-generator__gate",children:[t.jsx("div",{className:"ai-generator__gate-icon",children:""}),t.jsx("h2",{children:"Connexion requise"}),t.jsx("p",{children:"Vous devez tre connect pour accder au gnrateur de contenu IA."}),t.jsx($e,{to:"/connexion",className:"btn btn--primary",children:"Se connecter"})]})})},rre=()=>{const[e,r]=g.useState(null),[n,a]=g.useState(!1),[l,o]=g.useState(!1),[u,d]=g.useState(!1),m=()=>/iPhone|iPad|iPod/.test(navigator.userAgent)&&!window.MSStream,p=()=>window.matchMedia("(display-mode: standalone)").matches||navigator.standalone===!0,h=g.useCallback(()=>{try{return parseInt(localStorage.getItem("pedaclic_visit_count")||"0",10)}catch{return 0}},[]),v=g.useCallback(()=>{try{const _=h()+1;localStorage.setItem("pedaclic_visit_count",_.toString())}catch{}},[h]),b=()=>{try{const _=localStorage.getItem("pedaclic_install_dismissed_at");if(!_)return!1;const w=720*60*60*1e3;return Date.now()-parseInt(_,10)<w}catch{return!1}};g.useEffect(()=>{if(p()||b())return;v();const _=C=>{C.preventDefault(),r(C),h()>=1&&a(!0)};window.addEventListener("beforeinstallprompt",_),m()&&h()>=1&&(o(!0),a(!0));const w=()=>{a(!1),r(null)};return window.addEventListener("appinstalled",w),()=>{window.removeEventListener("beforeinstallprompt",_),window.removeEventListener("appinstalled",w)}},[h,v]);const x=async()=>{if(e){d(!0);try{await e.prompt();const{outcome:_}=await e.userChoice;_==="accepted"&&a(!1)}catch(_){console.error("Erreur installation PWA:",_)}finally{d(!1),r(null)}}},j=()=>{a(!1);try{localStorage.setItem("pedaclic_install_dismissed_at",Date.now().toString()),localStorage.removeItem("pedaclic_install_dismissed")}catch{}};return n?t.jsx("div",{className:"install-prompt",children:t.jsxs("div",{className:"install-prompt__container",children:[t.jsxs("div",{className:"install-prompt__content",children:[t.jsx("div",{className:"install-prompt__icon",children:t.jsx(EA,{size:24})}),t.jsxs("div",{className:"install-prompt__text",children:[t.jsx("h3",{className:"install-prompt__title",children:"Installer PedaClic"}),t.jsx("p",{className:"install-prompt__description",children:l?"Accde  tes cours mme sans connexion !":"Installe l'app pour un accs rapide, mme hors-ligne !"})]})]}),t.jsxs("div",{className:"install-prompt__actions",children:[!l&&e&&t.jsx("button",{className:"install-prompt__btn install-prompt__btn--primary",onClick:x,disabled:u,children:u?"Installation...":"Installer"}),l&&t.jsx("div",{className:"install-prompt__ios",children:t.jsxs("p",{className:"install-prompt__ios-text",children:["Appuie sur ",t.jsx(Q3,{size:16,className:"install-prompt__ios-icon"})," puis",t.jsxs("span",{className:"install-prompt__ios-highlight",children:[t.jsx(Rc,{size:14})," Sur l'cran d'accueil"]})]})}),t.jsx("button",{className:"install-prompt__btn install-prompt__btn--close",onClick:j,"aria-label":"Fermer la bannire d'installation",children:t.jsx(Xi,{size:20})})]})]})}):null};function nre(){const[e,r]=g.useState(typeof navigator<"u"?navigator.onLine:!0);return g.useEffect(()=>{const n=()=>r(!0),a=()=>r(!1);return window.addEventListener("online",n),window.addEventListener("offline",a),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",a)}},[]),e}const are=()=>{const e=nre(),[r,n]=g.useState(!1),[a,l]=g.useState(!1);return g.useEffect(()=>{if(!e)l(!0),n(!1);else if(a){n(!0);const o=setTimeout(()=>{n(!1),l(!1)},3e3);return()=>clearTimeout(o)}},[e,a]),e&&!r?null:t.jsx("div",{className:`network-indicator ${e?"network-indicator--online":"network-indicator--offline"}`,children:t.jsx("div",{className:"network-indicator__content",children:e?t.jsxs(t.Fragment,{children:[t.jsx(Y3,{size:14}),t.jsx("span",{children:"Connexion rtablie"})]}):t.jsxs(t.Fragment,{children:[t.jsx(K3,{size:14}),t.jsx("span",{children:"Pas de connexion  mode hors-ligne"})]})})})},ire=()=>(g.useEffect(()=>{fA();const e=setInterval(fA,600*1e3);return()=>clearInterval(e)},[]),t.jsxs(s5,{children:[t.jsx(rre,{}),t.jsx(are,{}),t.jsxs(n3,{children:[t.jsx(Le,{path:"/",element:t.jsx(ct,{children:t.jsx(_5,{})})}),t.jsx(Le,{path:"/disciplines",element:t.jsx(ct,{children:t.jsx(N5,{})})}),t.jsx(Le,{path:"/disciplines/:id",element:t.jsx(ct,{children:t.jsx(A5,{})})}),t.jsx(Le,{path:"/quiz-gratuits",element:t.jsx(ct,{children:t.jsx(xI,{})})}),t.jsx(Le,{path:"/ebooks",element:t.jsx(ct,{children:t.jsx(Ste,{})})}),t.jsx(Le,{path:"/mediatheque",element:t.jsx(ct,{children:t.jsx(Ite,{})})}),t.jsx(Le,{path:"/mediatheque/ajouter",element:t.jsx(Hi,{allowedRoles:["admin","prof"],children:t.jsx(ct,{children:t.jsx(Hte,{})})})}),t.jsx(Le,{path:"/mediatheque/:mediaId/modifier",element:t.jsx(Hi,{allowedRoles:["admin","prof"],children:t.jsx(ct,{children:t.jsx(Vte,{})})})}),t.jsx(Le,{path:"/mediatheque/:mediaId",element:t.jsx(ct,{children:t.jsx(Fte,{})})}),t.jsx(Le,{path:"/cours",element:t.jsx(ct,{children:t.jsx(Uee,{})})}),t.jsx(Le,{path:"/cours/:coursId",element:t.jsx(ct,{children:t.jsx(tte,{})})}),t.jsx(Le,{path:"/connexion",element:t.jsx(z5,{})}),t.jsx(Le,{path:"/inscription",element:t.jsx(k5,{})}),t.jsx(Le,{path:"/mot-de-passe-oublie",element:t.jsx(O5,{})}),t.jsx(Le,{path:"/premium/confirmation",element:t.jsx(cR,{})}),t.jsx(Le,{path:"/premium/mes-cours",element:t.jsx(ct,{children:t.jsx(oR,{})})}),t.jsx(Le,{path:"/premium",element:t.jsx(ct,{children:t.jsx(Q5,{})})}),t.jsx(Le,{path:"/quizzes",element:t.jsx(Hi,{allowedRoles:["eleve","prof","admin"],children:t.jsx(ct,{children:t.jsx(oI,{})})})}),t.jsx(Le,{path:"/quiz/:quizId",element:t.jsx(ct,{children:t.jsx(DI,{})})}),t.jsx(Le,{path:"/quiz-avance/:quizId",element:t.jsx(ct,{children:t.jsx(iI,{})})}),t.jsx(Le,{path:"/generateur",element:t.jsx(ct,{children:t.jsx(tre,{})})}),t.jsx(Le,{path:"/eleve/dashboard",element:t.jsx(ct,{children:t.jsx(XZ,{})})}),t.jsx(Le,{path:"/eleve/suivi",element:t.jsx(ct,{children:t.jsx(ZZ,{})})}),t.jsx(Le,{path:"/eleve/cahiers/:cahierId",element:t.jsx(Hi,{allowedRoles:["eleve","admin"],children:t.jsx(ct,{children:t.jsx(dee,{})})})}),t.jsx(Le,{path:"/parent/dashboard",element:t.jsx(Hi,{allowedRoles:["parent","admin"],children:t.jsx(ct,{children:t.jsx(Wte,{})})})}),t.jsx(Le,{path:"/prof/dashboard",element:t.jsx(Xn,{children:t.jsx(ct,{children:t.jsx(cJ,{})})})}),t.jsx(Le,{path:"/prof/cahiers",element:t.jsx(Xn,{children:t.jsx(ct,{children:t.jsx(zJ,{})})})}),t.jsx(Le,{path:"/prof/cahiers/:cahierId",element:t.jsx(Xn,{children:t.jsx(ct,{children:t.jsx(BJ,{})})})}),t.jsx(Le,{path:"/prof/cahiers/:cahierId/nouvelle",element:t.jsx(Xn,{children:t.jsx(ct,{children:t.jsx(pA,{})})})}),t.jsx(Le,{path:"/prof/cahiers/:cahierId/modifier/:entreeId",element:t.jsx(Xn,{children:t.jsx(ct,{children:t.jsx(pA,{})})})}),t.jsx(Le,{path:"/prof/sequences",element:t.jsx(Xn,{children:t.jsx(ct,{children:t.jsx(Nee,{})})})}),t.jsx(Le,{path:"/prof/sequences/nouvelle",element:t.jsx(Xn,{children:t.jsx(ct,{children:t.jsx(hA,{})})})}),t.jsx(Le,{path:"/prof/sequences/:id",element:t.jsx(Xn,{children:t.jsx(ct,{children:t.jsx(Iee,{})})})}),t.jsx(Le,{path:"/prof/sequences/:id/modifier",element:t.jsx(Xn,{children:t.jsx(ct,{children:t.jsx(hA,{})})})}),t.jsx(Le,{path:"/prof/cours",element:t.jsx(Xn,{children:t.jsx(ct,{children:t.jsx(ote,{})})})}),t.jsx(Le,{path:"/prof/cours/nouveau",element:t.jsx(Ur,{children:t.jsx(ct,{children:t.jsx(gA,{})})})}),t.jsx(Le,{path:"/prof/cours/:coursId/modifier",element:t.jsx(Ur,{children:t.jsx(ct,{children:t.jsx(gA,{})})})}),t.jsx(Le,{path:"/admin",element:t.jsx(Ur,{children:t.jsx(hn,{children:t.jsx(mR,{})})})}),t.jsx(Le,{path:"/admin/disciplines",element:t.jsx(Ur,{children:t.jsx(hn,{children:t.jsx(fR,{})})})}),t.jsx(Le,{path:"/admin/chapitres",element:t.jsx(Ur,{children:t.jsx(hn,{children:t.jsx(pR,{})})})}),t.jsx(Le,{path:"/admin/ressources",element:t.jsx(Ur,{children:t.jsx(hn,{children:t.jsx(hR,{})})})}),t.jsx(Le,{path:"/admin/quiz",element:t.jsx(Ur,{children:t.jsx(hn,{children:t.jsx(jR,{})})})}),t.jsx(Le,{path:"/admin/quiz/nouveau",element:t.jsx(Ur,{children:t.jsx(hn,{children:t.jsx(rS,{})})})}),t.jsx(Le,{path:"/admin/quiz/modifier/:quizId",element:t.jsx(Ur,{children:t.jsx(hn,{children:t.jsx(rS,{})})})}),t.jsx(Le,{path:"/admin/quiz-avance",element:t.jsx(Ur,{children:t.jsx(hn,{children:t.jsx(ZR,{})})})}),t.jsx(Le,{path:"/admin/utilisateurs",element:t.jsx(Ur,{children:t.jsx(hn,{children:t.jsx(zR,{})})})}),t.jsx(Le,{path:"/admin/resultats",element:t.jsx(Ur,{children:t.jsx(hn,{children:t.jsx(kR,{})})})}),t.jsx(Le,{path:"/admin/settings",element:t.jsx(Ur,{children:t.jsx(hn,{children:t.jsx(OR,{})})})}),t.jsx(Le,{path:"/admin/ebooks",element:t.jsx(Ur,{children:t.jsx(hn,{children:t.jsx(wte,{})})})}),t.jsx(Le,{path:"/admin/premium",element:t.jsx(Ud,{to:"/admin/utilisateurs?filter=premium",replace:!0})}),t.jsx(Le,{path:"/notifications",element:t.jsx(Hi,{allowedRoles:["eleve","prof","admin","parent"],children:t.jsx(ct,{children:t.jsx(Kte,{})})})}),t.jsx(Le,{path:"/prof/notifications/nouvelle",element:t.jsx(Xn,{children:t.jsx(ct,{children:t.jsx(NA,{})})})}),t.jsx(Le,{path:"/admin/notifications/nouvelle",element:t.jsx(Ur,{children:t.jsx(hn,{children:t.jsx(NA,{})})})}),t.jsx(Le,{path:"/cahiers",element:t.jsx(Ud,{to:"/prof/cahiers",replace:!0})}),t.jsx(Le,{path:"/sequences",element:t.jsx(Ud,{to:"/prof/sequences",replace:!0})}),t.jsx(Le,{path:"*",element:t.jsx(Ud,{to:"/",replace:!0})})]})]})),FM=document.getElementById("root");if(!FM)throw new Error("L'lment #root n'existe pas");const sre=n5.createRoot(FM);sre.render(t.jsx(a3.StrictMode,{children:t.jsx(i3,{children:t.jsx(ire,{})})}));
//# sourceMappingURL=index-DbD9Pp0k.js.map
