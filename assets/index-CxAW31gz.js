import{a as vf,b as Aq,g as ni,r as g,u as lt,c as Ob,L as Fe,d as Jn,e as aA,f as iA,R as zq,h as kq,i as Be,N as Pd,j as Oq,B as Dq}from"./vendor-react-BMsfgiGx.js";import{i as Mq,g as Pq,a as Tq,p as qq,b as Rq,c as Iq,o as Lq,d as Ne,u as Qe,s as Ot,e as $q,f as Bq,h as Uq,G as Fq,j as Gq,k as Hq,l as Dt,m as gf,w as Se,n as Ve,q as ar,r as Ee,t as je,v as Ce,x as Mn,T as Oe,y as rn,z as xf,A as qt,B as Lr,C as Pc,D as Ms,E as pa,F as Ks,H as Db,I as Qq,J as Mb}from"./vendor-firebase-LntcAirY.js";import{H as jx,B as vn,G as Ps,S as Zr,L as g1,a as Vq,C as Ts,b as Ac,D as sA,c as mm,U as Yq,d as Kq,e as x1,X as Gi,M as Wq,f as nm,g as Xq,P as Zq,h as Jq,i as e3,F as t3,j as Pb,k as am,l as r3,m as n3,T as a3,I as i3,n as s3,Y as l3,A as ws,o as Jl,p as Ut,Z as lA,q as oA,r as so,s as Wi,t as fm,u as zc,v as cA,w as Tb,x as Nx,E as no,y as o3,z as b1,J as c3,K as u3,N as d3,R as m3,O as f3,Q as p3,V as kc,W as _x,_ as Av,$ as h3,a0 as v3,a1 as Sx,a2 as zv,a3 as kv,a4 as g3,a5 as x3,a6 as b3,a7 as y3,a8 as j3}from"./vendor-icons-Dx3xUbaS.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}})();var Ov={exports:{}},hc={};var y1;function N3(){if(y1)return hc;y1=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(a,l,o){var u=null;if(o!==void 0&&(u=""+o),l.key!==void 0&&(u=""+l.key),"key"in l){o={};for(var d in l)d!=="key"&&(o[d]=l[d])}else o=l;return l=o.ref,{$$typeof:e,type:a,key:u,ref:l!==void 0?l:null,props:o}}return hc.Fragment=t,hc.jsx=n,hc.jsxs=n,hc}var j1;function _3(){return j1||(j1=1,Ov.exports=N3()),Ov.exports}var r=_3(),Dv={exports:{}},vc={},Mv={exports:{}},Pv={};var N1;function S3(){return N1||(N1=1,(function(e){function t(q,F){var R=q.length;q.push(F);e:for(;0<R;){var W=R-1>>>1,I=q[W];if(0<l(I,F))q[W]=F,q[R]=I,R=W;else break e}}function n(q){return q.length===0?null:q[0]}function a(q){if(q.length===0)return null;var F=q[0],R=q.pop();if(R!==F){q[0]=R;e:for(var W=0,I=q.length,re=I>>>1;W<re;){var V=2*(W+1)-1,oe=q[V],xe=V+1,ve=q[xe];if(0>l(oe,R))xe<I&&0>l(ve,oe)?(q[W]=ve,q[xe]=R,W=xe):(q[W]=oe,q[V]=R,W=V);else if(xe<I&&0>l(ve,R))q[W]=ve,q[xe]=R,W=xe;else break e}}return F}function l(q,F){var R=q.sortIndex-F.sortIndex;return R!==0?R:q.id-F.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var f=[],p=[],h=1,v=null,b=3,x=!1,j=!1,N=!1,w=!1,C=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function A(q){for(var F=n(p);F!==null;){if(F.callback===null)a(p);else if(F.startTime<=q)a(p),F.sortIndex=F.expirationTime,t(f,F);else break;F=n(p)}}function O(q){if(N=!1,A(q),!j)if(n(f)!==null)j=!0,k||(k=!0,B());else{var F=n(p);F!==null&&P(O,F.startTime-q)}}var k=!1,M=-1,D=5,$=-1;function U(){return w?!0:!(e.unstable_now()-$<D)}function L(){if(w=!1,k){var q=e.unstable_now();$=q;var F=!0;try{e:{j=!1,N&&(N=!1,E(M),M=-1),x=!0;var R=b;try{t:{for(A(q),v=n(f);v!==null&&!(v.expirationTime>q&&U());){var W=v.callback;if(typeof W=="function"){v.callback=null,b=v.priorityLevel;var I=W(v.expirationTime<=q);if(q=e.unstable_now(),typeof I=="function"){v.callback=I,A(q),F=!0;break t}v===n(f)&&a(f),A(q)}else a(f);v=n(f)}if(v!==null)F=!0;else{var re=n(p);re!==null&&P(O,re.startTime-q),F=!1}}break e}finally{v=null,b=R,x=!1}F=void 0}}finally{F?B():k=!1}}}var B;if(typeof S=="function")B=function(){S(L)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,se=ee.port2;ee.port1.onmessage=L,B=function(){se.postMessage(null)}}else B=function(){C(L,0)};function P(q,F){M=C(function(){q(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(q){switch(b){case 1:case 2:case 3:var F=3;break;default:F=b}var R=b;b=F;try{return q()}finally{b=R}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(q,F){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var R=b;b=q;try{return F()}finally{b=R}},e.unstable_scheduleCallback=function(q,F,R){var W=e.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?W+R:W):R=W,q){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=R+I,q={id:h++,callback:F,priorityLevel:q,startTime:R,expirationTime:I,sortIndex:-1},R>W?(q.sortIndex=R,t(p,q),n(f)===null&&q===n(p)&&(N?(E(M),M=-1):N=!0,P(O,R-W))):(q.sortIndex=I,t(f,q),j||x||(j=!0,k||(k=!0,B()))),q},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(q){var F=b;return function(){var R=b;b=F;try{return q.apply(this,arguments)}finally{b=R}}}})(Pv)),Pv}var _1;function w3(){return _1||(_1=1,Mv.exports=S3()),Mv.exports}var S1;function C3(){if(S1)return vc;S1=1;var e=w3(),t=vf(),n=Aq();function a(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function u(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function d(i){if(i.tag===31){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function f(i){if(o(i)!==i)throw Error(a(188))}function p(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(a(188));return s!==i?null:i}for(var c=i,m=s;;){var y=c.return;if(y===null)break;var _=y.alternate;if(_===null){if(m=y.return,m!==null){c=m;continue}break}if(y.child===_.child){for(_=y.child;_;){if(_===c)return f(y),i;if(_===m)return f(y),s;_=_.sibling}throw Error(a(188))}if(c.return!==m.return)c=y,m=_;else{for(var z=!1,T=y.child;T;){if(T===c){z=!0,c=y,m=_;break}if(T===m){z=!0,m=y,c=_;break}T=T.sibling}if(!z){for(T=_.child;T;){if(T===c){z=!0,c=_,m=y;break}if(T===m){z=!0,m=_,c=y;break}T=T.sibling}if(!z)throw Error(a(189))}}if(c.alternate!==m)throw Error(a(190))}if(c.tag!==3)throw Error(a(188));return c.stateNode.current===c?i:s}function h(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=h(i),s!==null)return s;i=i.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),E=Symbol.for("react.consumer"),S=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),$=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function B(i){return i===null||typeof i!="object"?null:(i=L&&i[L]||i["@@iterator"],typeof i=="function"?i:null)}var ee=Symbol.for("react.client.reference");function se(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===ee?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case N:return"Fragment";case C:return"Profiler";case w:return"StrictMode";case O:return"Suspense";case k:return"SuspenseList";case $:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case j:return"Portal";case S:return i.displayName||"Context";case E:return(i._context.displayName||"Context")+".Consumer";case A:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case M:return s=i.displayName||null,s!==null?s:se(i.type)||"Memo";case D:s=i._payload,i=i._init;try{return se(i(s))}catch{}}return null}var P=Array.isArray,q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R={pending:!1,data:null,method:null,action:null},W=[],I=-1;function re(i){return{current:i}}function V(i){0>I||(i.current=W[I],W[I]=null,I--)}function oe(i,s){I++,W[I]=i.current,i.current=s}var xe=re(null),ve=re(null),H=re(null),he=re(null);function Pe(i,s){switch(oe(H,s),oe(ve,i),oe(xe,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?$_(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=$_(s),i=B_(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}V(xe),oe(xe,i)}function ue(){V(xe),V(ve),V(H)}function X(i){i.memoizedState!==null&&oe(he,i);var s=xe.current,c=B_(s,i.type);s!==c&&(oe(ve,i),oe(xe,c))}function Q(i){ve.current===i&&(V(xe),V(ve)),he.current===i&&(V(he),dc._currentValue=R)}var me,we;function qe(i){if(me===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);me=s&&s[1]||"",we=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+me+i+we}var We=!1;function Je(i,s){if(!i||We)return"";We=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(s){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(fe){var le=fe}Reflect.construct(i,[],ye)}else{try{ye.call()}catch(fe){le=fe}i.call(ye.prototype)}}else{try{throw Error()}catch(fe){le=fe}(ye=i())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(fe){if(fe&&le&&typeof fe.stack=="string")return[fe.stack,le.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=m.DetermineComponentFrameRoot(),z=_[0],T=_[1];if(z&&T){var G=z.split(`
`),ie=T.split(`
`);for(y=m=0;m<G.length&&!G[m].includes("DetermineComponentFrameRoot");)m++;for(;y<ie.length&&!ie[y].includes("DetermineComponentFrameRoot");)y++;if(m===G.length||y===ie.length)for(m=G.length-1,y=ie.length-1;1<=m&&0<=y&&G[m]!==ie[y];)y--;for(;1<=m&&0<=y;m--,y--)if(G[m]!==ie[y]){if(m!==1||y!==1)do if(m--,y--,0>y||G[m]!==ie[y]){var ge=`
`+G[m].replace(" at new "," at ");return i.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",i.displayName)),ge}while(1<=m&&0<=y);break}}}finally{We=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?qe(c):""}function at(i,s){switch(i.tag){case 26:case 27:case 5:return qe(i.type);case 16:return qe("Lazy");case 13:return i.child!==s&&s!==null?qe("Suspense Fallback"):qe("Suspense");case 19:return qe("SuspenseList");case 0:case 15:return Je(i.type,!1);case 11:return Je(i.type.render,!1);case 1:return Je(i.type,!0);case 31:return qe("Activity");default:return""}}function br(i){try{var s="",c=null;do s+=at(i,c),c=i,i=i.return;while(i);return s}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var Pr=Object.prototype.hasOwnProperty,lr=e.unstable_scheduleCallback,an=e.unstable_cancelCallback,pe=e.unstable_shouldYield,Ae=e.unstable_requestPaint,Re=e.unstable_now,He=e.unstable_getCurrentPriorityLevel,xt=e.unstable_ImmediatePriority,It=e.unstable_UserBlockingPriority,tr=e.unstable_NormalPriority,Gr=e.unstable_LowPriority,J=e.unstable_IdlePriority,Me=e.log,ot=e.unstable_setDisableYieldValue,Z=null,ce=null;function _e(i){if(typeof Me=="function"&&ot(i),ce&&typeof ce.setStrictMode=="function")try{ce.setStrictMode(Z,i)}catch{}}var Xe=Math.clz32?Math.clz32:Bn,Ar=Math.log,$n=Math.LN2;function Bn(i){return i>>>=0,i===0?32:31-(Ar(i)/$n|0)|0}var ra=256,il=262144,sl=4194304;function Na(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function na(i,s,c){var m=i.pendingLanes;if(m===0)return 0;var y=0,_=i.suspendedLanes,z=i.pingedLanes;i=i.warmLanes;var T=m&134217727;return T!==0?(m=T&~_,m!==0?y=Na(m):(z&=T,z!==0?y=Na(z):c||(c=T&~i,c!==0&&(y=Na(c))))):(T=m&~_,T!==0?y=Na(T):z!==0?y=Na(z):c||(c=m&~i,c!==0&&(y=Na(c)))),y===0?0:s!==0&&s!==y&&(s&_)===0&&(_=y&-y,c=s&-s,_>=c||_===32&&(c&4194048)!==0)?s:y}function as(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function ne(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $e(){var i=sl;return sl<<=1,(sl&62914560)===0&&(sl=4194304),i}function St(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function zr(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function wo(i,s,c,m,y,_){var z=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var T=i.entanglements,G=i.expirationTimes,ie=i.hiddenUpdates;for(c=z&~c;0<c;){var ge=31-Xe(c),ye=1<<ge;T[ge]=0,G[ge]=-1;var le=ie[ge];if(le!==null)for(ie[ge]=null,ge=0;ge<le.length;ge++){var fe=le[ge];fe!==null&&(fe.lane&=-536870913)}c&=~ye}m!==0&&is(i,m,0),_!==0&&y===0&&i.tag!==0&&(i.suspendedLanes|=_&~(z&~s))}function is(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var m=31-Xe(s);i.entangledLanes|=s,i.entanglements[m]=i.entanglements[m]|1073741824|c&261930}function _j(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var m=31-Xe(c),y=1<<m;y&s|i[m]&s&&(i[m]|=s),c&=~y}}function Sj(i,s){var c=s&-s;return c=(c&42)!==0?1:gp(c),(c&(i.suspendedLanes|s))!==0?0:c}function gp(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function xp(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function wj(){var i=F.p;return i!==0?i:(i=window.event,i===void 0?32:u1(i.type))}function Cj(i,s){var c=F.p;try{return F.p=i,s()}finally{F.p=c}}var fi=Math.random().toString(36).slice(2),yr="__reactFiber$"+fi,Hr="__reactProps$"+fi,ll="__reactContainer$"+fi,bp="__reactEvents$"+fi,gP="__reactListeners$"+fi,xP="__reactHandles$"+fi,Ej="__reactResources$"+fi,Co="__reactMarker$"+fi;function yp(i){delete i[yr],delete i[Hr],delete i[bp],delete i[gP],delete i[xP]}function ol(i){var s=i[yr];if(s)return s;for(var c=i.parentNode;c;){if(s=c[ll]||c[yr]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=Y_(i);i!==null;){if(c=i[yr])return c;i=Y_(i)}return s}i=c,c=i.parentNode}return null}function cl(i){if(i=i[yr]||i[ll]){var s=i.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return i}return null}function Eo(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(a(33))}function ul(i){var s=i[Ej];return s||(s=i[Ej]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function or(i){i[Co]=!0}var Aj=new Set,zj={};function ss(i,s){dl(i,s),dl(i+"Capture",s)}function dl(i,s){for(zj[i]=s,i=0;i<s.length;i++)Aj.add(s[i])}var bP=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),kj={},Oj={};function yP(i){return Pr.call(Oj,i)?!0:Pr.call(kj,i)?!1:bP.test(i)?Oj[i]=!0:(kj[i]=!0,!1)}function Nu(i,s,c){if(yP(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var m=s.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function _u(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function _a(i,s,c,m){if(m===null)i.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+m)}}function bn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Dj(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function jP(i,s,c){var m=Object.getOwnPropertyDescriptor(i.constructor.prototype,s);if(!i.hasOwnProperty(s)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var y=m.get,_=m.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return y.call(this)},set:function(z){c=""+z,_.call(this,z)}}),Object.defineProperty(i,s,{enumerable:m.enumerable}),{getValue:function(){return c},setValue:function(z){c=""+z},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function jp(i){if(!i._valueTracker){var s=Dj(i)?"checked":"value";i._valueTracker=jP(i,s,""+i[s])}}function Mj(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),m="";return i&&(m=Dj(i)?i.checked?"true":"false":i.value),i=m,i!==c?(s.setValue(i),!0):!1}function Su(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var NP=/[\n"\\]/g;function yn(i){return i.replace(NP,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Np(i,s,c,m,y,_,z,T){i.name="",z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?i.type=z:i.removeAttribute("type"),s!=null?z==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+bn(s)):i.value!==""+bn(s)&&(i.value=""+bn(s)):z!=="submit"&&z!=="reset"||i.removeAttribute("value"),s!=null?_p(i,z,bn(s)):c!=null?_p(i,z,bn(c)):m!=null&&i.removeAttribute("value"),y==null&&_!=null&&(i.defaultChecked=!!_),y!=null&&(i.checked=y&&typeof y!="function"&&typeof y!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?i.name=""+bn(T):i.removeAttribute("name")}function Pj(i,s,c,m,y,_,z,T){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(i.type=_),s!=null||c!=null){if(!(_!=="submit"&&_!=="reset"||s!=null)){jp(i);return}c=c!=null?""+bn(c):"",s=s!=null?""+bn(s):c,T||s===i.value||(i.value=s),i.defaultValue=s}m=m??y,m=typeof m!="function"&&typeof m!="symbol"&&!!m,i.checked=T?i.checked:!!m,i.defaultChecked=!!m,z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(i.name=z),jp(i)}function _p(i,s,c){s==="number"&&Su(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function ml(i,s,c,m){if(i=i.options,s){s={};for(var y=0;y<c.length;y++)s["$"+c[y]]=!0;for(c=0;c<i.length;c++)y=s.hasOwnProperty("$"+i[c].value),i[c].selected!==y&&(i[c].selected=y),y&&m&&(i[c].defaultSelected=!0)}else{for(c=""+bn(c),s=null,y=0;y<i.length;y++){if(i[y].value===c){i[y].selected=!0,m&&(i[y].defaultSelected=!0);return}s!==null||i[y].disabled||(s=i[y])}s!==null&&(s.selected=!0)}}function Tj(i,s,c){if(s!=null&&(s=""+bn(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+bn(c):""}function qj(i,s,c,m){if(s==null){if(m!=null){if(c!=null)throw Error(a(92));if(P(m)){if(1<m.length)throw Error(a(93));m=m[0]}c=m}c==null&&(c=""),s=c}c=bn(s),i.defaultValue=c,m=i.textContent,m===c&&m!==""&&m!==null&&(i.value=m),jp(i)}function fl(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var _P=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Rj(i,s,c){var m=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?m?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":m?i.setProperty(s,c):typeof c!="number"||c===0||_P.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function Ij(i,s,c){if(s!=null&&typeof s!="object")throw Error(a(62));if(i=i.style,c!=null){for(var m in c)!c.hasOwnProperty(m)||s!=null&&s.hasOwnProperty(m)||(m.indexOf("--")===0?i.setProperty(m,""):m==="float"?i.cssFloat="":i[m]="");for(var y in s)m=s[y],s.hasOwnProperty(y)&&c[y]!==m&&Rj(i,y,m)}else for(var _ in s)s.hasOwnProperty(_)&&Rj(i,_,s[_])}function Sp(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var SP=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),wP=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wu(i){return wP.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function Sa(){}var wp=null;function Cp(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var pl=null,hl=null;function Lj(i){var s=cl(i);if(s&&(i=s.stateNode)){var c=i[Hr]||null;e:switch(i=s.stateNode,s.type){case"input":if(Np(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+yn(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var m=c[s];if(m!==i&&m.form===i.form){var y=m[Hr]||null;if(!y)throw Error(a(90));Np(m,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(s=0;s<c.length;s++)m=c[s],m.form===i.form&&Mj(m)}break e;case"textarea":Tj(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&ml(i,!!c.multiple,s,!1)}}}var Ep=!1;function $j(i,s,c){if(Ep)return i(s,c);Ep=!0;try{var m=i(s);return m}finally{if(Ep=!1,(pl!==null||hl!==null)&&(md(),pl&&(s=pl,i=hl,hl=pl=null,Lj(s),i)))for(s=0;s<i.length;s++)Lj(i[s])}}function Ao(i,s){var c=i.stateNode;if(c===null)return null;var m=c[Hr]||null;if(m===null)return null;c=m[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(i=i.type,m=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!m;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(a(231,s,typeof c));return c}var wa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ap=!1;if(wa)try{var zo={};Object.defineProperty(zo,"passive",{get:function(){Ap=!0}}),window.addEventListener("test",zo,zo),window.removeEventListener("test",zo,zo)}catch{Ap=!1}var pi=null,zp=null,Cu=null;function Bj(){if(Cu)return Cu;var i,s=zp,c=s.length,m,y="value"in pi?pi.value:pi.textContent,_=y.length;for(i=0;i<c&&s[i]===y[i];i++);var z=c-i;for(m=1;m<=z&&s[c-m]===y[_-m];m++);return Cu=y.slice(i,1<m?1-m:void 0)}function Eu(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Au(){return!0}function Uj(){return!1}function Qr(i){function s(c,m,y,_,z){this._reactName=c,this._targetInst=y,this.type=m,this.nativeEvent=_,this.target=z,this.currentTarget=null;for(var T in i)i.hasOwnProperty(T)&&(c=i[T],this[T]=c?c(_):_[T]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?Au:Uj,this.isPropagationStopped=Uj,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Au)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Au)},persist:function(){},isPersistent:Au}),s}var ls={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zu=Qr(ls),ko=v({},ls,{view:0,detail:0}),CP=Qr(ko),kp,Op,Oo,ku=v({},ko,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mp,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Oo&&(Oo&&i.type==="mousemove"?(kp=i.screenX-Oo.screenX,Op=i.screenY-Oo.screenY):Op=kp=0,Oo=i),kp)},movementY:function(i){return"movementY"in i?i.movementY:Op}}),Fj=Qr(ku),EP=v({},ku,{dataTransfer:0}),AP=Qr(EP),zP=v({},ko,{relatedTarget:0}),Dp=Qr(zP),kP=v({},ls,{animationName:0,elapsedTime:0,pseudoElement:0}),OP=Qr(kP),DP=v({},ls,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),MP=Qr(DP),PP=v({},ls,{data:0}),Gj=Qr(PP),TP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},RP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function IP(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=RP[i])?!!s[i]:!1}function Mp(){return IP}var LP=v({},ko,{key:function(i){if(i.key){var s=TP[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Eu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?qP[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mp,charCode:function(i){return i.type==="keypress"?Eu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Eu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),$P=Qr(LP),BP=v({},ku,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hj=Qr(BP),UP=v({},ko,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mp}),FP=Qr(UP),GP=v({},ls,{propertyName:0,elapsedTime:0,pseudoElement:0}),HP=Qr(GP),QP=v({},ku,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),VP=Qr(QP),YP=v({},ls,{newState:0,oldState:0}),KP=Qr(YP),WP=[9,13,27,32],Pp=wa&&"CompositionEvent"in window,Do=null;wa&&"documentMode"in document&&(Do=document.documentMode);var XP=wa&&"TextEvent"in window&&!Do,Qj=wa&&(!Pp||Do&&8<Do&&11>=Do),Vj=" ",Yj=!1;function Kj(i,s){switch(i){case"keyup":return WP.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wj(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var vl=!1;function ZP(i,s){switch(i){case"compositionend":return Wj(s);case"keypress":return s.which!==32?null:(Yj=!0,Vj);case"textInput":return i=s.data,i===Vj&&Yj?null:i;default:return null}}function JP(i,s){if(vl)return i==="compositionend"||!Pp&&Kj(i,s)?(i=Bj(),Cu=zp=pi=null,vl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Qj&&s.locale!=="ko"?null:s.data;default:return null}}var eT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xj(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!eT[i.type]:s==="textarea"}function Zj(i,s,c,m){pl?hl?hl.push(m):hl=[m]:pl=m,s=bd(s,"onChange"),0<s.length&&(c=new zu("onChange","change",null,c,m),i.push({event:c,listeners:s}))}var Mo=null,Po=null;function tT(i){P_(i,0)}function Ou(i){var s=Eo(i);if(Mj(s))return i}function Jj(i,s){if(i==="change")return s}var e0=!1;if(wa){var Tp;if(wa){var qp="oninput"in document;if(!qp){var t0=document.createElement("div");t0.setAttribute("oninput","return;"),qp=typeof t0.oninput=="function"}Tp=qp}else Tp=!1;e0=Tp&&(!document.documentMode||9<document.documentMode)}function r0(){Mo&&(Mo.detachEvent("onpropertychange",n0),Po=Mo=null)}function n0(i){if(i.propertyName==="value"&&Ou(Po)){var s=[];Zj(s,Po,i,Cp(i)),$j(tT,s)}}function rT(i,s,c){i==="focusin"?(r0(),Mo=s,Po=c,Mo.attachEvent("onpropertychange",n0)):i==="focusout"&&r0()}function nT(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Ou(Po)}function aT(i,s){if(i==="click")return Ou(s)}function iT(i,s){if(i==="input"||i==="change")return Ou(s)}function sT(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var sn=typeof Object.is=="function"?Object.is:sT;function To(i,s){if(sn(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),m=Object.keys(s);if(c.length!==m.length)return!1;for(m=0;m<c.length;m++){var y=c[m];if(!Pr.call(s,y)||!sn(i[y],s[y]))return!1}return!0}function a0(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function i0(i,s){var c=a0(i);i=0;for(var m;c;){if(c.nodeType===3){if(m=i+c.textContent.length,i<=s&&m>=s)return{node:c,offset:s-i};i=m}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=a0(c)}}function s0(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?s0(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function l0(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Su(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=Su(i.document)}return s}function Rp(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var lT=wa&&"documentMode"in document&&11>=document.documentMode,gl=null,Ip=null,qo=null,Lp=!1;function o0(i,s,c){var m=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Lp||gl==null||gl!==Su(m)||(m=gl,"selectionStart"in m&&Rp(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),qo&&To(qo,m)||(qo=m,m=bd(Ip,"onSelect"),0<m.length&&(s=new zu("onSelect","select",null,s,c),i.push({event:s,listeners:m}),s.target=gl)))}function os(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var xl={animationend:os("Animation","AnimationEnd"),animationiteration:os("Animation","AnimationIteration"),animationstart:os("Animation","AnimationStart"),transitionrun:os("Transition","TransitionRun"),transitionstart:os("Transition","TransitionStart"),transitioncancel:os("Transition","TransitionCancel"),transitionend:os("Transition","TransitionEnd")},$p={},c0={};wa&&(c0=document.createElement("div").style,"AnimationEvent"in window||(delete xl.animationend.animation,delete xl.animationiteration.animation,delete xl.animationstart.animation),"TransitionEvent"in window||delete xl.transitionend.transition);function cs(i){if($p[i])return $p[i];if(!xl[i])return i;var s=xl[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in c0)return $p[i]=s[c];return i}var u0=cs("animationend"),d0=cs("animationiteration"),m0=cs("animationstart"),oT=cs("transitionrun"),cT=cs("transitionstart"),uT=cs("transitioncancel"),f0=cs("transitionend"),p0=new Map,Bp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Bp.push("scrollEnd");function Un(i,s){p0.set(i,s),ss(s,[i])}var Du=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},jn=[],bl=0,Up=0;function Mu(){for(var i=bl,s=Up=bl=0;s<i;){var c=jn[s];jn[s++]=null;var m=jn[s];jn[s++]=null;var y=jn[s];jn[s++]=null;var _=jn[s];if(jn[s++]=null,m!==null&&y!==null){var z=m.pending;z===null?y.next=y:(y.next=z.next,z.next=y),m.pending=y}_!==0&&h0(c,y,_)}}function Pu(i,s,c,m){jn[bl++]=i,jn[bl++]=s,jn[bl++]=c,jn[bl++]=m,Up|=m,i.lanes|=m,i=i.alternate,i!==null&&(i.lanes|=m)}function Fp(i,s,c,m){return Pu(i,s,c,m),Tu(i)}function us(i,s){return Pu(i,null,null,s),Tu(i)}function h0(i,s,c){i.lanes|=c;var m=i.alternate;m!==null&&(m.lanes|=c);for(var y=!1,_=i.return;_!==null;)_.childLanes|=c,m=_.alternate,m!==null&&(m.childLanes|=c),_.tag===22&&(i=_.stateNode,i===null||i._visibility&1||(y=!0)),i=_,_=_.return;return i.tag===3?(_=i.stateNode,y&&s!==null&&(y=31-Xe(c),i=_.hiddenUpdates,m=i[y],m===null?i[y]=[s]:m.push(s),s.lane=c|536870912),_):null}function Tu(i){if(50<ac)throw ac=0,Zh=null,Error(a(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var yl={};function dT(i,s,c,m){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ln(i,s,c,m){return new dT(i,s,c,m)}function Gp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ca(i,s){var c=i.alternate;return c===null?(c=ln(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function v0(i,s){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function qu(i,s,c,m,y,_){var z=0;if(m=i,typeof i=="function")Gp(i)&&(z=1);else if(typeof i=="string")z=vq(i,c,xe.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case $:return i=ln(31,c,s,y),i.elementType=$,i.lanes=_,i;case N:return ds(c.children,y,_,s);case w:z=8,y|=24;break;case C:return i=ln(12,c,s,y|2),i.elementType=C,i.lanes=_,i;case O:return i=ln(13,c,s,y),i.elementType=O,i.lanes=_,i;case k:return i=ln(19,c,s,y),i.elementType=k,i.lanes=_,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case S:z=10;break e;case E:z=9;break e;case A:z=11;break e;case M:z=14;break e;case D:z=16,m=null;break e}z=29,c=Error(a(130,i===null?"null":typeof i,"")),m=null}return s=ln(z,c,s,y),s.elementType=i,s.type=m,s.lanes=_,s}function ds(i,s,c,m){return i=ln(7,i,m,s),i.lanes=c,i}function Hp(i,s,c){return i=ln(6,i,null,s),i.lanes=c,i}function g0(i){var s=ln(18,null,null,0);return s.stateNode=i,s}function Qp(i,s,c){return s=ln(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var x0=new WeakMap;function Nn(i,s){if(typeof i=="object"&&i!==null){var c=x0.get(i);return c!==void 0?c:(s={value:i,source:s,stack:br(s)},x0.set(i,s),s)}return{value:i,source:s,stack:br(s)}}var jl=[],Nl=0,Ru=null,Ro=0,_n=[],Sn=0,hi=null,aa=1,ia="";function Ea(i,s){jl[Nl++]=Ro,jl[Nl++]=Ru,Ru=i,Ro=s}function b0(i,s,c){_n[Sn++]=aa,_n[Sn++]=ia,_n[Sn++]=hi,hi=i;var m=aa;i=ia;var y=32-Xe(m)-1;m&=~(1<<y),c+=1;var _=32-Xe(s)+y;if(30<_){var z=y-y%5;_=(m&(1<<z)-1).toString(32),m>>=z,y-=z,aa=1<<32-Xe(s)+y|c<<y|m,ia=_+i}else aa=1<<_|c<<y|m,ia=i}function Vp(i){i.return!==null&&(Ea(i,1),b0(i,1,0))}function Yp(i){for(;i===Ru;)Ru=jl[--Nl],jl[Nl]=null,Ro=jl[--Nl],jl[Nl]=null;for(;i===hi;)hi=_n[--Sn],_n[Sn]=null,ia=_n[--Sn],_n[Sn]=null,aa=_n[--Sn],_n[Sn]=null}function y0(i,s){_n[Sn++]=aa,_n[Sn++]=ia,_n[Sn++]=hi,aa=s.id,ia=s.overflow,hi=i}var jr=null,At=null,it=!1,vi=null,wn=!1,Kp=Error(a(519));function gi(i){var s=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Io(Nn(s,i)),Kp}function j0(i){var s=i.stateNode,c=i.type,m=i.memoizedProps;switch(s[yr]=i,s[Hr]=m,c){case"dialog":tt("cancel",s),tt("close",s);break;case"iframe":case"object":case"embed":tt("load",s);break;case"video":case"audio":for(c=0;c<sc.length;c++)tt(sc[c],s);break;case"source":tt("error",s);break;case"img":case"image":case"link":tt("error",s),tt("load",s);break;case"details":tt("toggle",s);break;case"input":tt("invalid",s),Pj(s,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":tt("invalid",s);break;case"textarea":tt("invalid",s),qj(s,m.value,m.defaultValue,m.children)}c=m.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||m.suppressHydrationWarning===!0||I_(s.textContent,c)?(m.popover!=null&&(tt("beforetoggle",s),tt("toggle",s)),m.onScroll!=null&&tt("scroll",s),m.onScrollEnd!=null&&tt("scrollend",s),m.onClick!=null&&(s.onclick=Sa),s=!0):s=!1,s||gi(i,!0)}function N0(i){for(jr=i.return;jr;)switch(jr.tag){case 5:case 31:case 13:wn=!1;return;case 27:case 3:wn=!0;return;default:jr=jr.return}}function _l(i){if(i!==jr)return!1;if(!it)return N0(i),it=!0,!1;var s=i.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||fv(i.type,i.memoizedProps)),c=!c),c&&At&&gi(i),N0(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));At=V_(i)}else if(s===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));At=V_(i)}else s===27?(s=At,Oi(i.type)?(i=xv,xv=null,At=i):At=s):At=jr?En(i.stateNode.nextSibling):null;return!0}function ms(){At=jr=null,it=!1}function Wp(){var i=vi;return i!==null&&(Wr===null?Wr=i:Wr.push.apply(Wr,i),vi=null),i}function Io(i){vi===null?vi=[i]:vi.push(i)}var Xp=re(null),fs=null,Aa=null;function xi(i,s,c){oe(Xp,s._currentValue),s._currentValue=c}function za(i){i._currentValue=Xp.current,V(Xp)}function Zp(i,s,c){for(;i!==null;){var m=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,m!==null&&(m.childLanes|=s)):m!==null&&(m.childLanes&s)!==s&&(m.childLanes|=s),i===c)break;i=i.return}}function Jp(i,s,c,m){var y=i.child;for(y!==null&&(y.return=i);y!==null;){var _=y.dependencies;if(_!==null){var z=y.child;_=_.firstContext;e:for(;_!==null;){var T=_;_=y;for(var G=0;G<s.length;G++)if(T.context===s[G]){_.lanes|=c,T=_.alternate,T!==null&&(T.lanes|=c),Zp(_.return,c,i),m||(z=null);break e}_=T.next}}else if(y.tag===18){if(z=y.return,z===null)throw Error(a(341));z.lanes|=c,_=z.alternate,_!==null&&(_.lanes|=c),Zp(z,c,i),z=null}else z=y.child;if(z!==null)z.return=y;else for(z=y;z!==null;){if(z===i){z=null;break}if(y=z.sibling,y!==null){y.return=z.return,z=y;break}z=z.return}y=z}}function Sl(i,s,c,m){i=null;for(var y=s,_=!1;y!==null;){if(!_){if((y.flags&524288)!==0)_=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var z=y.alternate;if(z===null)throw Error(a(387));if(z=z.memoizedProps,z!==null){var T=y.type;sn(y.pendingProps.value,z.value)||(i!==null?i.push(T):i=[T])}}else if(y===he.current){if(z=y.alternate,z===null)throw Error(a(387));z.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(i!==null?i.push(dc):i=[dc])}y=y.return}i!==null&&Jp(s,i,c,m),s.flags|=262144}function Iu(i){for(i=i.firstContext;i!==null;){if(!sn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ps(i){fs=i,Aa=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Nr(i){return _0(fs,i)}function Lu(i,s){return fs===null&&ps(i),_0(i,s)}function _0(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Aa===null){if(i===null)throw Error(a(308));Aa=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Aa=Aa.next=s;return c}var mT=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,m){i.push(m)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},fT=e.unstable_scheduleCallback,pT=e.unstable_NormalPriority,Yt={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function eh(){return{controller:new mT,data:new Map,refCount:0}}function Lo(i){i.refCount--,i.refCount===0&&fT(pT,function(){i.controller.abort()})}var $o=null,th=0,wl=0,Cl=null;function hT(i,s){if($o===null){var c=$o=[];th=0,wl=av(),Cl={status:"pending",value:void 0,then:function(m){c.push(m)}}}return th++,s.then(S0,S0),s}function S0(){if(--th===0&&$o!==null){Cl!==null&&(Cl.status="fulfilled");var i=$o;$o=null,wl=0,Cl=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function vT(i,s){var c=[],m={status:"pending",value:null,reason:null,then:function(y){c.push(y)}};return i.then(function(){m.status="fulfilled",m.value=s;for(var y=0;y<c.length;y++)(0,c[y])(s)},function(y){for(m.status="rejected",m.reason=y,y=0;y<c.length;y++)(0,c[y])(void 0)}),m}var w0=q.S;q.S=function(i,s){o_=Re(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&hT(i,s),w0!==null&&w0(i,s)};var hs=re(null);function rh(){var i=hs.current;return i!==null?i:wt.pooledCache}function $u(i,s){s===null?oe(hs,hs.current):oe(hs,s.pool)}function C0(){var i=rh();return i===null?null:{parent:Yt._currentValue,pool:i}}var El=Error(a(460)),nh=Error(a(474)),Bu=Error(a(542)),Uu={then:function(){}};function E0(i){return i=i.status,i==="fulfilled"||i==="rejected"}function A0(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(Sa,Sa),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,k0(i),i;default:if(typeof s.status=="string")s.then(Sa,Sa);else{if(i=wt,i!==null&&100<i.shellSuspendCounter)throw Error(a(482));i=s,i.status="pending",i.then(function(m){if(s.status==="pending"){var y=s;y.status="fulfilled",y.value=m}},function(m){if(s.status==="pending"){var y=s;y.status="rejected",y.reason=m}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,k0(i),i}throw gs=s,El}}function vs(i){try{var s=i._init;return s(i._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(gs=c,El):c}}var gs=null;function z0(){if(gs===null)throw Error(a(459));var i=gs;return gs=null,i}function k0(i){if(i===El||i===Bu)throw Error(a(483))}var Al=null,Bo=0;function Fu(i){var s=Bo;return Bo+=1,Al===null&&(Al=[]),A0(Al,i,s)}function Uo(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Gu(i,s){throw s.$$typeof===b?Error(a(525)):(i=Object.prototype.toString.call(s),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function O0(i){function s(te,Y){if(i){var ae=te.deletions;ae===null?(te.deletions=[Y],te.flags|=16):ae.push(Y)}}function c(te,Y){if(!i)return null;for(;Y!==null;)s(te,Y),Y=Y.sibling;return null}function m(te){for(var Y=new Map;te!==null;)te.key!==null?Y.set(te.key,te):Y.set(te.index,te),te=te.sibling;return Y}function y(te,Y){return te=Ca(te,Y),te.index=0,te.sibling=null,te}function _(te,Y,ae){return te.index=ae,i?(ae=te.alternate,ae!==null?(ae=ae.index,ae<Y?(te.flags|=67108866,Y):ae):(te.flags|=67108866,Y)):(te.flags|=1048576,Y)}function z(te){return i&&te.alternate===null&&(te.flags|=67108866),te}function T(te,Y,ae,be){return Y===null||Y.tag!==6?(Y=Hp(ae,te.mode,be),Y.return=te,Y):(Y=y(Y,ae),Y.return=te,Y)}function G(te,Y,ae,be){var Le=ae.type;return Le===N?ge(te,Y,ae.props.children,be,ae.key):Y!==null&&(Y.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===D&&vs(Le)===Y.type)?(Y=y(Y,ae.props),Uo(Y,ae),Y.return=te,Y):(Y=qu(ae.type,ae.key,ae.props,null,te.mode,be),Uo(Y,ae),Y.return=te,Y)}function ie(te,Y,ae,be){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==ae.containerInfo||Y.stateNode.implementation!==ae.implementation?(Y=Qp(ae,te.mode,be),Y.return=te,Y):(Y=y(Y,ae.children||[]),Y.return=te,Y)}function ge(te,Y,ae,be,Le){return Y===null||Y.tag!==7?(Y=ds(ae,te.mode,be,Le),Y.return=te,Y):(Y=y(Y,ae),Y.return=te,Y)}function ye(te,Y,ae){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Y=Hp(""+Y,te.mode,ae),Y.return=te,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case x:return ae=qu(Y.type,Y.key,Y.props,null,te.mode,ae),Uo(ae,Y),ae.return=te,ae;case j:return Y=Qp(Y,te.mode,ae),Y.return=te,Y;case D:return Y=vs(Y),ye(te,Y,ae)}if(P(Y)||B(Y))return Y=ds(Y,te.mode,ae,null),Y.return=te,Y;if(typeof Y.then=="function")return ye(te,Fu(Y),ae);if(Y.$$typeof===S)return ye(te,Lu(te,Y),ae);Gu(te,Y)}return null}function le(te,Y,ae,be){var Le=Y!==null?Y.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return Le!==null?null:T(te,Y,""+ae,be);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case x:return ae.key===Le?G(te,Y,ae,be):null;case j:return ae.key===Le?ie(te,Y,ae,be):null;case D:return ae=vs(ae),le(te,Y,ae,be)}if(P(ae)||B(ae))return Le!==null?null:ge(te,Y,ae,be,null);if(typeof ae.then=="function")return le(te,Y,Fu(ae),be);if(ae.$$typeof===S)return le(te,Y,Lu(te,ae),be);Gu(te,ae)}return null}function fe(te,Y,ae,be,Le){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return te=te.get(ae)||null,T(Y,te,""+be,Le);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case x:return te=te.get(be.key===null?ae:be.key)||null,G(Y,te,be,Le);case j:return te=te.get(be.key===null?ae:be.key)||null,ie(Y,te,be,Le);case D:return be=vs(be),fe(te,Y,ae,be,Le)}if(P(be)||B(be))return te=te.get(ae)||null,ge(Y,te,be,Le,null);if(typeof be.then=="function")return fe(te,Y,ae,Fu(be),Le);if(be.$$typeof===S)return fe(te,Y,ae,Lu(Y,be),Le);Gu(Y,be)}return null}function ke(te,Y,ae,be){for(var Le=null,ct=null,Te=Y,Ke=Y=0,nt=null;Te!==null&&Ke<ae.length;Ke++){Te.index>Ke?(nt=Te,Te=null):nt=Te.sibling;var ut=le(te,Te,ae[Ke],be);if(ut===null){Te===null&&(Te=nt);break}i&&Te&&ut.alternate===null&&s(te,Te),Y=_(ut,Y,Ke),ct===null?Le=ut:ct.sibling=ut,ct=ut,Te=nt}if(Ke===ae.length)return c(te,Te),it&&Ea(te,Ke),Le;if(Te===null){for(;Ke<ae.length;Ke++)Te=ye(te,ae[Ke],be),Te!==null&&(Y=_(Te,Y,Ke),ct===null?Le=Te:ct.sibling=Te,ct=Te);return it&&Ea(te,Ke),Le}for(Te=m(Te);Ke<ae.length;Ke++)nt=fe(Te,te,Ke,ae[Ke],be),nt!==null&&(i&&nt.alternate!==null&&Te.delete(nt.key===null?Ke:nt.key),Y=_(nt,Y,Ke),ct===null?Le=nt:ct.sibling=nt,ct=nt);return i&&Te.forEach(function(qi){return s(te,qi)}),it&&Ea(te,Ke),Le}function Ge(te,Y,ae,be){if(ae==null)throw Error(a(151));for(var Le=null,ct=null,Te=Y,Ke=Y=0,nt=null,ut=ae.next();Te!==null&&!ut.done;Ke++,ut=ae.next()){Te.index>Ke?(nt=Te,Te=null):nt=Te.sibling;var qi=le(te,Te,ut.value,be);if(qi===null){Te===null&&(Te=nt);break}i&&Te&&qi.alternate===null&&s(te,Te),Y=_(qi,Y,Ke),ct===null?Le=qi:ct.sibling=qi,ct=qi,Te=nt}if(ut.done)return c(te,Te),it&&Ea(te,Ke),Le;if(Te===null){for(;!ut.done;Ke++,ut=ae.next())ut=ye(te,ut.value,be),ut!==null&&(Y=_(ut,Y,Ke),ct===null?Le=ut:ct.sibling=ut,ct=ut);return it&&Ea(te,Ke),Le}for(Te=m(Te);!ut.done;Ke++,ut=ae.next())ut=fe(Te,te,Ke,ut.value,be),ut!==null&&(i&&ut.alternate!==null&&Te.delete(ut.key===null?Ke:ut.key),Y=_(ut,Y,Ke),ct===null?Le=ut:ct.sibling=ut,ct=ut);return i&&Te.forEach(function(Eq){return s(te,Eq)}),it&&Ea(te,Ke),Le}function jt(te,Y,ae,be){if(typeof ae=="object"&&ae!==null&&ae.type===N&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case x:e:{for(var Le=ae.key;Y!==null;){if(Y.key===Le){if(Le=ae.type,Le===N){if(Y.tag===7){c(te,Y.sibling),be=y(Y,ae.props.children),be.return=te,te=be;break e}}else if(Y.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===D&&vs(Le)===Y.type){c(te,Y.sibling),be=y(Y,ae.props),Uo(be,ae),be.return=te,te=be;break e}c(te,Y);break}else s(te,Y);Y=Y.sibling}ae.type===N?(be=ds(ae.props.children,te.mode,be,ae.key),be.return=te,te=be):(be=qu(ae.type,ae.key,ae.props,null,te.mode,be),Uo(be,ae),be.return=te,te=be)}return z(te);case j:e:{for(Le=ae.key;Y!==null;){if(Y.key===Le)if(Y.tag===4&&Y.stateNode.containerInfo===ae.containerInfo&&Y.stateNode.implementation===ae.implementation){c(te,Y.sibling),be=y(Y,ae.children||[]),be.return=te,te=be;break e}else{c(te,Y);break}else s(te,Y);Y=Y.sibling}be=Qp(ae,te.mode,be),be.return=te,te=be}return z(te);case D:return ae=vs(ae),jt(te,Y,ae,be)}if(P(ae))return ke(te,Y,ae,be);if(B(ae)){if(Le=B(ae),typeof Le!="function")throw Error(a(150));return ae=Le.call(ae),Ge(te,Y,ae,be)}if(typeof ae.then=="function")return jt(te,Y,Fu(ae),be);if(ae.$$typeof===S)return jt(te,Y,Lu(te,ae),be);Gu(te,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint"?(ae=""+ae,Y!==null&&Y.tag===6?(c(te,Y.sibling),be=y(Y,ae),be.return=te,te=be):(c(te,Y),be=Hp(ae,te.mode,be),be.return=te,te=be),z(te)):c(te,Y)}return function(te,Y,ae,be){try{Bo=0;var Le=jt(te,Y,ae,be);return Al=null,Le}catch(Te){if(Te===El||Te===Bu)throw Te;var ct=ln(29,Te,null,te.mode);return ct.lanes=be,ct.return=te,ct}}}var xs=O0(!0),D0=O0(!1),bi=!1;function ah(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ih(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function yi(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function ji(i,s,c){var m=i.updateQueue;if(m===null)return null;if(m=m.shared,(mt&2)!==0){var y=m.pending;return y===null?s.next=s:(s.next=y.next,y.next=s),m.pending=s,s=Tu(i),h0(i,null,c),s}return Pu(i,m,s,c),Tu(i)}function Fo(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var m=s.lanes;m&=i.pendingLanes,c|=m,s.lanes=c,_j(i,c)}}function sh(i,s){var c=i.updateQueue,m=i.alternate;if(m!==null&&(m=m.updateQueue,c===m)){var y=null,_=null;if(c=c.firstBaseUpdate,c!==null){do{var z={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};_===null?y=_=z:_=_.next=z,c=c.next}while(c!==null);_===null?y=_=s:_=_.next=s}else y=_=s;c={baseState:m.baseState,firstBaseUpdate:y,lastBaseUpdate:_,shared:m.shared,callbacks:m.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var lh=!1;function Go(){if(lh){var i=Cl;if(i!==null)throw i}}function Ho(i,s,c,m){lh=!1;var y=i.updateQueue;bi=!1;var _=y.firstBaseUpdate,z=y.lastBaseUpdate,T=y.shared.pending;if(T!==null){y.shared.pending=null;var G=T,ie=G.next;G.next=null,z===null?_=ie:z.next=ie,z=G;var ge=i.alternate;ge!==null&&(ge=ge.updateQueue,T=ge.lastBaseUpdate,T!==z&&(T===null?ge.firstBaseUpdate=ie:T.next=ie,ge.lastBaseUpdate=G))}if(_!==null){var ye=y.baseState;z=0,ge=ie=G=null,T=_;do{var le=T.lane&-536870913,fe=le!==T.lane;if(fe?(rt&le)===le:(m&le)===le){le!==0&&le===wl&&(lh=!0),ge!==null&&(ge=ge.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var ke=i,Ge=T;le=s;var jt=c;switch(Ge.tag){case 1:if(ke=Ge.payload,typeof ke=="function"){ye=ke.call(jt,ye,le);break e}ye=ke;break e;case 3:ke.flags=ke.flags&-65537|128;case 0:if(ke=Ge.payload,le=typeof ke=="function"?ke.call(jt,ye,le):ke,le==null)break e;ye=v({},ye,le);break e;case 2:bi=!0}}le=T.callback,le!==null&&(i.flags|=64,fe&&(i.flags|=8192),fe=y.callbacks,fe===null?y.callbacks=[le]:fe.push(le))}else fe={lane:le,tag:T.tag,payload:T.payload,callback:T.callback,next:null},ge===null?(ie=ge=fe,G=ye):ge=ge.next=fe,z|=le;if(T=T.next,T===null){if(T=y.shared.pending,T===null)break;fe=T,T=fe.next,fe.next=null,y.lastBaseUpdate=fe,y.shared.pending=null}}while(!0);ge===null&&(G=ye),y.baseState=G,y.firstBaseUpdate=ie,y.lastBaseUpdate=ge,_===null&&(y.shared.lanes=0),Ci|=z,i.lanes=z,i.memoizedState=ye}}function M0(i,s){if(typeof i!="function")throw Error(a(191,i));i.call(s)}function P0(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)M0(c[i],s)}var zl=re(null),Hu=re(0);function T0(i,s){i=Ia,oe(Hu,i),oe(zl,s),Ia=i|s.baseLanes}function oh(){oe(Hu,Ia),oe(zl,zl.current)}function ch(){Ia=Hu.current,V(zl),V(Hu)}var on=re(null),Cn=null;function Ni(i){var s=i.alternate;oe(Ht,Ht.current&1),oe(on,i),Cn===null&&(s===null||zl.current!==null||s.memoizedState!==null)&&(Cn=i)}function uh(i){oe(Ht,Ht.current),oe(on,i),Cn===null&&(Cn=i)}function q0(i){i.tag===22?(oe(Ht,Ht.current),oe(on,i),Cn===null&&(Cn=i)):_i()}function _i(){oe(Ht,Ht.current),oe(on,on.current)}function cn(i){V(on),Cn===i&&(Cn=null),V(Ht)}var Ht=re(0);function Qu(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||vv(c)||gv(c)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var ka=0,Ye=null,bt=null,Kt=null,Vu=!1,kl=!1,bs=!1,Yu=0,Qo=0,Ol=null,gT=0;function Lt(){throw Error(a(321))}function dh(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!sn(i[c],s[c]))return!1;return!0}function mh(i,s,c,m,y,_){return ka=_,Ye=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,q.H=i===null||i.memoizedState===null?bN:Eh,bs=!1,_=c(m,y),bs=!1,kl&&(_=I0(s,c,m,y)),R0(i),_}function R0(i){q.H=Ko;var s=bt!==null&&bt.next!==null;if(ka=0,Kt=bt=Ye=null,Vu=!1,Qo=0,Ol=null,s)throw Error(a(300));i===null||Wt||(i=i.dependencies,i!==null&&Iu(i)&&(Wt=!0))}function I0(i,s,c,m){Ye=i;var y=0;do{if(kl&&(Ol=null),Qo=0,kl=!1,25<=y)throw Error(a(301));if(y+=1,Kt=bt=null,i.updateQueue!=null){var _=i.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}q.H=yN,_=s(c,m)}while(kl);return _}function xT(){var i=q.H,s=i.useState()[0];return s=typeof s.then=="function"?Vo(s):s,i=i.useState()[0],(bt!==null?bt.memoizedState:null)!==i&&(Ye.flags|=1024),s}function fh(){var i=Yu!==0;return Yu=0,i}function ph(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function hh(i){if(Vu){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Vu=!1}ka=0,Kt=bt=Ye=null,kl=!1,Qo=Yu=0,Ol=null}function Tr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kt===null?Ye.memoizedState=Kt=i:Kt=Kt.next=i,Kt}function Qt(){if(bt===null){var i=Ye.alternate;i=i!==null?i.memoizedState:null}else i=bt.next;var s=Kt===null?Ye.memoizedState:Kt.next;if(s!==null)Kt=s,bt=i;else{if(i===null)throw Ye.alternate===null?Error(a(467)):Error(a(310));bt=i,i={memoizedState:bt.memoizedState,baseState:bt.baseState,baseQueue:bt.baseQueue,queue:bt.queue,next:null},Kt===null?Ye.memoizedState=Kt=i:Kt=Kt.next=i}return Kt}function Ku(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Vo(i){var s=Qo;return Qo+=1,Ol===null&&(Ol=[]),i=A0(Ol,i,s),s=Ye,(Kt===null?s.memoizedState:Kt.next)===null&&(s=s.alternate,q.H=s===null||s.memoizedState===null?bN:Eh),i}function Wu(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Vo(i);if(i.$$typeof===S)return Nr(i)}throw Error(a(438,String(i)))}function vh(i){var s=null,c=Ye.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var m=Ye.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(s={data:m.data.map(function(y){return y.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=Ku(),Ye.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),m=0;m<i;m++)c[m]=U;return s.index++,c}function Oa(i,s){return typeof s=="function"?s(i):s}function Xu(i){var s=Qt();return gh(s,bt,i)}function gh(i,s,c){var m=i.queue;if(m===null)throw Error(a(311));m.lastRenderedReducer=c;var y=i.baseQueue,_=m.pending;if(_!==null){if(y!==null){var z=y.next;y.next=_.next,_.next=z}s.baseQueue=y=_,m.pending=null}if(_=i.baseState,y===null)i.memoizedState=_;else{s=y.next;var T=z=null,G=null,ie=s,ge=!1;do{var ye=ie.lane&-536870913;if(ye!==ie.lane?(rt&ye)===ye:(ka&ye)===ye){var le=ie.revertLane;if(le===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),ye===wl&&(ge=!0);else if((ka&le)===le){ie=ie.next,le===wl&&(ge=!0);continue}else ye={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},G===null?(T=G=ye,z=_):G=G.next=ye,Ye.lanes|=le,Ci|=le;ye=ie.action,bs&&c(_,ye),_=ie.hasEagerState?ie.eagerState:c(_,ye)}else le={lane:ye,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},G===null?(T=G=le,z=_):G=G.next=le,Ye.lanes|=ye,Ci|=ye;ie=ie.next}while(ie!==null&&ie!==s);if(G===null?z=_:G.next=T,!sn(_,i.memoizedState)&&(Wt=!0,ge&&(c=Cl,c!==null)))throw c;i.memoizedState=_,i.baseState=z,i.baseQueue=G,m.lastRenderedState=_}return y===null&&(m.lanes=0),[i.memoizedState,m.dispatch]}function xh(i){var s=Qt(),c=s.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=i;var m=c.dispatch,y=c.pending,_=s.memoizedState;if(y!==null){c.pending=null;var z=y=y.next;do _=i(_,z.action),z=z.next;while(z!==y);sn(_,s.memoizedState)||(Wt=!0),s.memoizedState=_,s.baseQueue===null&&(s.baseState=_),c.lastRenderedState=_}return[_,m]}function L0(i,s,c){var m=Ye,y=Qt(),_=it;if(_){if(c===void 0)throw Error(a(407));c=c()}else c=s();var z=!sn((bt||y).memoizedState,c);if(z&&(y.memoizedState=c,Wt=!0),y=y.queue,jh(U0.bind(null,m,y,i),[i]),y.getSnapshot!==s||z||Kt!==null&&Kt.memoizedState.tag&1){if(m.flags|=2048,Dl(9,{destroy:void 0},B0.bind(null,m,y,c,s),null),wt===null)throw Error(a(349));_||(ka&127)!==0||$0(m,s,c)}return c}function $0(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=Ye.updateQueue,s===null?(s=Ku(),Ye.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function B0(i,s,c,m){s.value=c,s.getSnapshot=m,F0(s)&&G0(i)}function U0(i,s,c){return c(function(){F0(s)&&G0(i)})}function F0(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!sn(i,c)}catch{return!0}}function G0(i){var s=us(i,2);s!==null&&Xr(s,i,2)}function bh(i){var s=Tr();if(typeof i=="function"){var c=i;if(i=c(),bs){_e(!0);try{c()}finally{_e(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Oa,lastRenderedState:i},s}function H0(i,s,c,m){return i.baseState=c,gh(i,bt,typeof m=="function"?m:Oa)}function bT(i,s,c,m,y){if(ed(i))throw Error(a(485));if(i=s.action,i!==null){var _={payload:y,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(z){_.listeners.push(z)}};q.T!==null?c(!0):_.isTransition=!1,m(_),c=s.pending,c===null?(_.next=s.pending=_,Q0(s,_)):(_.next=c.next,s.pending=c.next=_)}}function Q0(i,s){var c=s.action,m=s.payload,y=i.state;if(s.isTransition){var _=q.T,z={};q.T=z;try{var T=c(y,m),G=q.S;G!==null&&G(z,T),V0(i,s,T)}catch(ie){yh(i,s,ie)}finally{_!==null&&z.types!==null&&(_.types=z.types),q.T=_}}else try{_=c(y,m),V0(i,s,_)}catch(ie){yh(i,s,ie)}}function V0(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(m){Y0(i,s,m)},function(m){return yh(i,s,m)}):Y0(i,s,c)}function Y0(i,s,c){s.status="fulfilled",s.value=c,K0(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,Q0(i,c)))}function yh(i,s,c){var m=i.pending;if(i.pending=null,m!==null){m=m.next;do s.status="rejected",s.reason=c,K0(s),s=s.next;while(s!==m)}i.action=null}function K0(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function W0(i,s){return s}function X0(i,s){if(it){var c=wt.formState;if(c!==null){e:{var m=Ye;if(it){if(At){t:{for(var y=At,_=wn;y.nodeType!==8;){if(!_){y=null;break t}if(y=En(y.nextSibling),y===null){y=null;break t}}_=y.data,y=_==="F!"||_==="F"?y:null}if(y){At=En(y.nextSibling),m=y.data==="F!";break e}}gi(m)}m=!1}m&&(s=c[0])}}return c=Tr(),c.memoizedState=c.baseState=s,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:W0,lastRenderedState:s},c.queue=m,c=vN.bind(null,Ye,m),m.dispatch=c,m=bh(!1),_=Ch.bind(null,Ye,!1,m.queue),m=Tr(),y={state:s,dispatch:null,action:i,pending:null},m.queue=y,c=bT.bind(null,Ye,y,_,c),y.dispatch=c,m.memoizedState=i,[s,c,!1]}function Z0(i){var s=Qt();return J0(s,bt,i)}function J0(i,s,c){if(s=gh(i,s,W0)[0],i=Xu(Oa)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var m=Vo(s)}catch(z){throw z===El?Bu:z}else m=s;s=Qt();var y=s.queue,_=y.dispatch;return c!==s.memoizedState&&(Ye.flags|=2048,Dl(9,{destroy:void 0},yT.bind(null,y,c),null)),[m,_,i]}function yT(i,s){i.action=s}function eN(i){var s=Qt(),c=bt;if(c!==null)return J0(s,c,i);Qt(),s=s.memoizedState,c=Qt();var m=c.queue.dispatch;return c.memoizedState=i,[s,m,!1]}function Dl(i,s,c,m){return i={tag:i,create:c,deps:m,inst:s,next:null},s=Ye.updateQueue,s===null&&(s=Ku(),Ye.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(m=c.next,c.next=i,i.next=m,s.lastEffect=i),i}function tN(){return Qt().memoizedState}function Zu(i,s,c,m){var y=Tr();Ye.flags|=i,y.memoizedState=Dl(1|s,{destroy:void 0},c,m===void 0?null:m)}function Ju(i,s,c,m){var y=Qt();m=m===void 0?null:m;var _=y.memoizedState.inst;bt!==null&&m!==null&&dh(m,bt.memoizedState.deps)?y.memoizedState=Dl(s,_,c,m):(Ye.flags|=i,y.memoizedState=Dl(1|s,_,c,m))}function rN(i,s){Zu(8390656,8,i,s)}function jh(i,s){Ju(2048,8,i,s)}function jT(i){Ye.flags|=4;var s=Ye.updateQueue;if(s===null)s=Ku(),Ye.updateQueue=s,s.events=[i];else{var c=s.events;c===null?s.events=[i]:c.push(i)}}function nN(i){var s=Qt().memoizedState;return jT({ref:s,nextImpl:i}),function(){if((mt&2)!==0)throw Error(a(440));return s.impl.apply(void 0,arguments)}}function aN(i,s){return Ju(4,2,i,s)}function iN(i,s){return Ju(4,4,i,s)}function sN(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function lN(i,s,c){c=c!=null?c.concat([i]):null,Ju(4,4,sN.bind(null,s,i),c)}function Nh(){}function oN(i,s){var c=Qt();s=s===void 0?null:s;var m=c.memoizedState;return s!==null&&dh(s,m[1])?m[0]:(c.memoizedState=[i,s],i)}function cN(i,s){var c=Qt();s=s===void 0?null:s;var m=c.memoizedState;if(s!==null&&dh(s,m[1]))return m[0];if(m=i(),bs){_e(!0);try{i()}finally{_e(!1)}}return c.memoizedState=[m,s],m}function _h(i,s,c){return c===void 0||(ka&1073741824)!==0&&(rt&261930)===0?i.memoizedState=s:(i.memoizedState=c,i=u_(),Ye.lanes|=i,Ci|=i,c)}function uN(i,s,c,m){return sn(c,s)?c:zl.current!==null?(i=_h(i,c,m),sn(i,s)||(Wt=!0),i):(ka&42)===0||(ka&1073741824)!==0&&(rt&261930)===0?(Wt=!0,i.memoizedState=c):(i=u_(),Ye.lanes|=i,Ci|=i,s)}function dN(i,s,c,m,y){var _=F.p;F.p=_!==0&&8>_?_:8;var z=q.T,T={};q.T=T,Ch(i,!1,s,c);try{var G=y(),ie=q.S;if(ie!==null&&ie(T,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var ge=vT(G,m);Yo(i,s,ge,mn(i))}else Yo(i,s,m,mn(i))}catch(ye){Yo(i,s,{then:function(){},status:"rejected",reason:ye},mn())}finally{F.p=_,z!==null&&T.types!==null&&(z.types=T.types),q.T=z}}function NT(){}function Sh(i,s,c,m){if(i.tag!==5)throw Error(a(476));var y=mN(i).queue;dN(i,y,s,R,c===null?NT:function(){return fN(i),c(m)})}function mN(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:R,baseState:R,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Oa,lastRenderedState:R},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Oa,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function fN(i){var s=mN(i);s.next===null&&(s=i.alternate.memoizedState),Yo(i,s.next.queue,{},mn())}function wh(){return Nr(dc)}function pN(){return Qt().memoizedState}function hN(){return Qt().memoizedState}function _T(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=mn();i=yi(c);var m=ji(s,i,c);m!==null&&(Xr(m,s,c),Fo(m,s,c)),s={cache:eh()},i.payload=s;return}s=s.return}}function ST(i,s,c){var m=mn();c={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},ed(i)?gN(s,c):(c=Fp(i,s,c,m),c!==null&&(Xr(c,i,m),xN(c,s,m)))}function vN(i,s,c){var m=mn();Yo(i,s,c,m)}function Yo(i,s,c,m){var y={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(ed(i))gN(s,y);else{var _=i.alternate;if(i.lanes===0&&(_===null||_.lanes===0)&&(_=s.lastRenderedReducer,_!==null))try{var z=s.lastRenderedState,T=_(z,c);if(y.hasEagerState=!0,y.eagerState=T,sn(T,z))return Pu(i,s,y,0),wt===null&&Mu(),!1}catch{}if(c=Fp(i,s,y,m),c!==null)return Xr(c,i,m),xN(c,s,m),!0}return!1}function Ch(i,s,c,m){if(m={lane:2,revertLane:av(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},ed(i)){if(s)throw Error(a(479))}else s=Fp(i,c,m,2),s!==null&&Xr(s,i,2)}function ed(i){var s=i.alternate;return i===Ye||s!==null&&s===Ye}function gN(i,s){kl=Vu=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function xN(i,s,c){if((c&4194048)!==0){var m=s.lanes;m&=i.pendingLanes,c|=m,s.lanes=c,_j(i,c)}}var Ko={readContext:Nr,use:Wu,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useLayoutEffect:Lt,useInsertionEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useSyncExternalStore:Lt,useId:Lt,useHostTransitionStatus:Lt,useFormState:Lt,useActionState:Lt,useOptimistic:Lt,useMemoCache:Lt,useCacheRefresh:Lt};Ko.useEffectEvent=Lt;var bN={readContext:Nr,use:Wu,useCallback:function(i,s){return Tr().memoizedState=[i,s===void 0?null:s],i},useContext:Nr,useEffect:rN,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,Zu(4194308,4,sN.bind(null,s,i),c)},useLayoutEffect:function(i,s){return Zu(4194308,4,i,s)},useInsertionEffect:function(i,s){Zu(4,2,i,s)},useMemo:function(i,s){var c=Tr();s=s===void 0?null:s;var m=i();if(bs){_e(!0);try{i()}finally{_e(!1)}}return c.memoizedState=[m,s],m},useReducer:function(i,s,c){var m=Tr();if(c!==void 0){var y=c(s);if(bs){_e(!0);try{c(s)}finally{_e(!1)}}}else y=s;return m.memoizedState=m.baseState=y,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:y},m.queue=i,i=i.dispatch=ST.bind(null,Ye,i),[m.memoizedState,i]},useRef:function(i){var s=Tr();return i={current:i},s.memoizedState=i},useState:function(i){i=bh(i);var s=i.queue,c=vN.bind(null,Ye,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:Nh,useDeferredValue:function(i,s){var c=Tr();return _h(c,i,s)},useTransition:function(){var i=bh(!1);return i=dN.bind(null,Ye,i.queue,!0,!1),Tr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var m=Ye,y=Tr();if(it){if(c===void 0)throw Error(a(407));c=c()}else{if(c=s(),wt===null)throw Error(a(349));(rt&127)!==0||$0(m,s,c)}y.memoizedState=c;var _={value:c,getSnapshot:s};return y.queue=_,rN(U0.bind(null,m,_,i),[i]),m.flags|=2048,Dl(9,{destroy:void 0},B0.bind(null,m,_,c,s),null),c},useId:function(){var i=Tr(),s=wt.identifierPrefix;if(it){var c=ia,m=aa;c=(m&~(1<<32-Xe(m)-1)).toString(32)+c,s="_"+s+"R_"+c,c=Yu++,0<c&&(s+="H"+c.toString(32)),s+="_"}else c=gT++,s="_"+s+"r_"+c.toString(32)+"_";return i.memoizedState=s},useHostTransitionStatus:wh,useFormState:X0,useActionState:X0,useOptimistic:function(i){var s=Tr();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=Ch.bind(null,Ye,!0,c),c.dispatch=s,[i,s]},useMemoCache:vh,useCacheRefresh:function(){return Tr().memoizedState=_T.bind(null,Ye)},useEffectEvent:function(i){var s=Tr(),c={impl:i};return s.memoizedState=c,function(){if((mt&2)!==0)throw Error(a(440));return c.impl.apply(void 0,arguments)}}},Eh={readContext:Nr,use:Wu,useCallback:oN,useContext:Nr,useEffect:jh,useImperativeHandle:lN,useInsertionEffect:aN,useLayoutEffect:iN,useMemo:cN,useReducer:Xu,useRef:tN,useState:function(){return Xu(Oa)},useDebugValue:Nh,useDeferredValue:function(i,s){var c=Qt();return uN(c,bt.memoizedState,i,s)},useTransition:function(){var i=Xu(Oa)[0],s=Qt().memoizedState;return[typeof i=="boolean"?i:Vo(i),s]},useSyncExternalStore:L0,useId:pN,useHostTransitionStatus:wh,useFormState:Z0,useActionState:Z0,useOptimistic:function(i,s){var c=Qt();return H0(c,bt,i,s)},useMemoCache:vh,useCacheRefresh:hN};Eh.useEffectEvent=nN;var yN={readContext:Nr,use:Wu,useCallback:oN,useContext:Nr,useEffect:jh,useImperativeHandle:lN,useInsertionEffect:aN,useLayoutEffect:iN,useMemo:cN,useReducer:xh,useRef:tN,useState:function(){return xh(Oa)},useDebugValue:Nh,useDeferredValue:function(i,s){var c=Qt();return bt===null?_h(c,i,s):uN(c,bt.memoizedState,i,s)},useTransition:function(){var i=xh(Oa)[0],s=Qt().memoizedState;return[typeof i=="boolean"?i:Vo(i),s]},useSyncExternalStore:L0,useId:pN,useHostTransitionStatus:wh,useFormState:eN,useActionState:eN,useOptimistic:function(i,s){var c=Qt();return bt!==null?H0(c,bt,i,s):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:vh,useCacheRefresh:hN};yN.useEffectEvent=nN;function Ah(i,s,c,m){s=i.memoizedState,c=c(m,s),c=c==null?s:v({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var zh={enqueueSetState:function(i,s,c){i=i._reactInternals;var m=mn(),y=yi(m);y.payload=s,c!=null&&(y.callback=c),s=ji(i,y,m),s!==null&&(Xr(s,i,m),Fo(s,i,m))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var m=mn(),y=yi(m);y.tag=1,y.payload=s,c!=null&&(y.callback=c),s=ji(i,y,m),s!==null&&(Xr(s,i,m),Fo(s,i,m))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=mn(),m=yi(c);m.tag=2,s!=null&&(m.callback=s),s=ji(i,m,c),s!==null&&(Xr(s,i,c),Fo(s,i,c))}};function jN(i,s,c,m,y,_,z){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(m,_,z):s.prototype&&s.prototype.isPureReactComponent?!To(c,m)||!To(y,_):!0}function NN(i,s,c,m){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,m),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,m),s.state!==i&&zh.enqueueReplaceState(s,s.state,null)}function ys(i,s){var c=s;if("ref"in s){c={};for(var m in s)m!=="ref"&&(c[m]=s[m])}if(i=i.defaultProps){c===s&&(c=v({},c));for(var y in i)c[y]===void 0&&(c[y]=i[y])}return c}function _N(i){Du(i)}function SN(i){console.error(i)}function wN(i){Du(i)}function td(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(m){setTimeout(function(){throw m})}}function CN(i,s,c){try{var m=i.onCaughtError;m(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function kh(i,s,c){return c=yi(c),c.tag=3,c.payload={element:null},c.callback=function(){td(i,s)},c}function EN(i){return i=yi(i),i.tag=3,i}function AN(i,s,c,m){var y=c.type.getDerivedStateFromError;if(typeof y=="function"){var _=m.value;i.payload=function(){return y(_)},i.callback=function(){CN(s,c,m)}}var z=c.stateNode;z!==null&&typeof z.componentDidCatch=="function"&&(i.callback=function(){CN(s,c,m),typeof y!="function"&&(Ei===null?Ei=new Set([this]):Ei.add(this));var T=m.stack;this.componentDidCatch(m.value,{componentStack:T!==null?T:""})})}function wT(i,s,c,m,y){if(c.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(s=c.alternate,s!==null&&Sl(s,c,y,!0),c=on.current,c!==null){switch(c.tag){case 31:case 13:return Cn===null?fd():c.alternate===null&&$t===0&&($t=3),c.flags&=-257,c.flags|=65536,c.lanes=y,m===Uu?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([m]):s.add(m),tv(i,m,y)),!1;case 22:return c.flags|=65536,m===Uu?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([m])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([m]):c.add(m)),tv(i,m,y)),!1}throw Error(a(435,c.tag))}return tv(i,m,y),fd(),!1}if(it)return s=on.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=y,m!==Kp&&(i=Error(a(422),{cause:m}),Io(Nn(i,c)))):(m!==Kp&&(s=Error(a(423),{cause:m}),Io(Nn(s,c))),i=i.current.alternate,i.flags|=65536,y&=-y,i.lanes|=y,m=Nn(m,c),y=kh(i.stateNode,m,y),sh(i,y),$t!==4&&($t=2)),!1;var _=Error(a(520),{cause:m});if(_=Nn(_,c),nc===null?nc=[_]:nc.push(_),$t!==4&&($t=2),s===null)return!0;m=Nn(m,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=y&-y,c.lanes|=i,i=kh(c.stateNode,m,i),sh(c,i),!1;case 1:if(s=c.type,_=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Ei===null||!Ei.has(_))))return c.flags|=65536,y&=-y,c.lanes|=y,y=EN(y),AN(y,i,c,m),sh(c,y),!1}c=c.return}while(c!==null);return!1}var Oh=Error(a(461)),Wt=!1;function _r(i,s,c,m){s.child=i===null?D0(s,null,c,m):xs(s,i.child,c,m)}function zN(i,s,c,m,y){c=c.render;var _=s.ref;if("ref"in m){var z={};for(var T in m)T!=="ref"&&(z[T]=m[T])}else z=m;return ps(s),m=mh(i,s,c,z,_,y),T=fh(),i!==null&&!Wt?(ph(i,s,y),Da(i,s,y)):(it&&T&&Vp(s),s.flags|=1,_r(i,s,m,y),s.child)}function kN(i,s,c,m,y){if(i===null){var _=c.type;return typeof _=="function"&&!Gp(_)&&_.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=_,ON(i,s,_,m,y)):(i=qu(c.type,null,m,s,s.mode,y),i.ref=s.ref,i.return=s,s.child=i)}if(_=i.child,!Lh(i,y)){var z=_.memoizedProps;if(c=c.compare,c=c!==null?c:To,c(z,m)&&i.ref===s.ref)return Da(i,s,y)}return s.flags|=1,i=Ca(_,m),i.ref=s.ref,i.return=s,s.child=i}function ON(i,s,c,m,y){if(i!==null){var _=i.memoizedProps;if(To(_,m)&&i.ref===s.ref)if(Wt=!1,s.pendingProps=m=_,Lh(i,y))(i.flags&131072)!==0&&(Wt=!0);else return s.lanes=i.lanes,Da(i,s,y)}return Dh(i,s,c,m,y)}function DN(i,s,c,m){var y=m.children,_=i!==null?i.memoizedState:null;if(i===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((s.flags&128)!==0){if(_=_!==null?_.baseLanes|c:c,i!==null){for(m=s.child=i.child,y=0;m!==null;)y=y|m.lanes|m.childLanes,m=m.sibling;m=y&~_}else m=0,s.child=null;return MN(i,s,_,c,m)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&$u(s,_!==null?_.cachePool:null),_!==null?T0(s,_):oh(),q0(s);else return m=s.lanes=536870912,MN(i,s,_!==null?_.baseLanes|c:c,c,m)}else _!==null?($u(s,_.cachePool),T0(s,_),_i(),s.memoizedState=null):(i!==null&&$u(s,null),oh(),_i());return _r(i,s,y,c),s.child}function Wo(i,s){return i!==null&&i.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function MN(i,s,c,m,y){var _=rh();return _=_===null?null:{parent:Yt._currentValue,pool:_},s.memoizedState={baseLanes:c,cachePool:_},i!==null&&$u(s,null),oh(),q0(s),i!==null&&Sl(i,s,m,!0),s.childLanes=y,null}function rd(i,s){return s=ad({mode:s.mode,children:s.children},i.mode),s.ref=i.ref,i.child=s,s.return=i,s}function PN(i,s,c){return xs(s,i.child,null,c),i=rd(s,s.pendingProps),i.flags|=2,cn(s),s.memoizedState=null,i}function CT(i,s,c){var m=s.pendingProps,y=(s.flags&128)!==0;if(s.flags&=-129,i===null){if(it){if(m.mode==="hidden")return i=rd(s,m),s.lanes=536870912,Wo(null,i);if(uh(s),(i=At)?(i=Q_(i,wn),i=i!==null&&i.data==="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:hi!==null?{id:aa,overflow:ia}:null,retryLane:536870912,hydrationErrors:null},c=g0(i),c.return=s,s.child=c,jr=s,At=null)):i=null,i===null)throw gi(s);return s.lanes=536870912,null}return rd(s,m)}var _=i.memoizedState;if(_!==null){var z=_.dehydrated;if(uh(s),y)if(s.flags&256)s.flags&=-257,s=PN(i,s,c);else if(s.memoizedState!==null)s.child=i.child,s.flags|=128,s=null;else throw Error(a(558));else if(Wt||Sl(i,s,c,!1),y=(c&i.childLanes)!==0,Wt||y){if(m=wt,m!==null&&(z=Sj(m,c),z!==0&&z!==_.retryLane))throw _.retryLane=z,us(i,z),Xr(m,i,z),Oh;fd(),s=PN(i,s,c)}else i=_.treeContext,At=En(z.nextSibling),jr=s,it=!0,vi=null,wn=!1,i!==null&&y0(s,i),s=rd(s,m),s.flags|=4096;return s}return i=Ca(i.child,{mode:m.mode,children:m.children}),i.ref=s.ref,s.child=i,i.return=s,i}function nd(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(a(284));(i===null||i.ref!==c)&&(s.flags|=4194816)}}function Dh(i,s,c,m,y){return ps(s),c=mh(i,s,c,m,void 0,y),m=fh(),i!==null&&!Wt?(ph(i,s,y),Da(i,s,y)):(it&&m&&Vp(s),s.flags|=1,_r(i,s,c,y),s.child)}function TN(i,s,c,m,y,_){return ps(s),s.updateQueue=null,c=I0(s,m,c,y),R0(i),m=fh(),i!==null&&!Wt?(ph(i,s,_),Da(i,s,_)):(it&&m&&Vp(s),s.flags|=1,_r(i,s,c,_),s.child)}function qN(i,s,c,m,y){if(ps(s),s.stateNode===null){var _=yl,z=c.contextType;typeof z=="object"&&z!==null&&(_=Nr(z)),_=new c(m,_),s.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=zh,s.stateNode=_,_._reactInternals=s,_=s.stateNode,_.props=m,_.state=s.memoizedState,_.refs={},ah(s),z=c.contextType,_.context=typeof z=="object"&&z!==null?Nr(z):yl,_.state=s.memoizedState,z=c.getDerivedStateFromProps,typeof z=="function"&&(Ah(s,c,z,m),_.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(z=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),z!==_.state&&zh.enqueueReplaceState(_,_.state,null),Ho(s,m,_,y),Go(),_.state=s.memoizedState),typeof _.componentDidMount=="function"&&(s.flags|=4194308),m=!0}else if(i===null){_=s.stateNode;var T=s.memoizedProps,G=ys(c,T);_.props=G;var ie=_.context,ge=c.contextType;z=yl,typeof ge=="object"&&ge!==null&&(z=Nr(ge));var ye=c.getDerivedStateFromProps;ge=typeof ye=="function"||typeof _.getSnapshotBeforeUpdate=="function",T=s.pendingProps!==T,ge||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(T||ie!==z)&&NN(s,_,m,z),bi=!1;var le=s.memoizedState;_.state=le,Ho(s,m,_,y),Go(),ie=s.memoizedState,T||le!==ie||bi?(typeof ye=="function"&&(Ah(s,c,ye,m),ie=s.memoizedState),(G=bi||jN(s,c,G,m,le,ie,z))?(ge||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(s.flags|=4194308)):(typeof _.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=m,s.memoizedState=ie),_.props=m,_.state=ie,_.context=z,m=G):(typeof _.componentDidMount=="function"&&(s.flags|=4194308),m=!1)}else{_=s.stateNode,ih(i,s),z=s.memoizedProps,ge=ys(c,z),_.props=ge,ye=s.pendingProps,le=_.context,ie=c.contextType,G=yl,typeof ie=="object"&&ie!==null&&(G=Nr(ie)),T=c.getDerivedStateFromProps,(ie=typeof T=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(z!==ye||le!==G)&&NN(s,_,m,G),bi=!1,le=s.memoizedState,_.state=le,Ho(s,m,_,y),Go();var fe=s.memoizedState;z!==ye||le!==fe||bi||i!==null&&i.dependencies!==null&&Iu(i.dependencies)?(typeof T=="function"&&(Ah(s,c,T,m),fe=s.memoizedState),(ge=bi||jN(s,c,ge,m,le,fe,G)||i!==null&&i.dependencies!==null&&Iu(i.dependencies))?(ie||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(m,fe,G),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(m,fe,G)),typeof _.componentDidUpdate=="function"&&(s.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof _.componentDidUpdate!="function"||z===i.memoizedProps&&le===i.memoizedState||(s.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||z===i.memoizedProps&&le===i.memoizedState||(s.flags|=1024),s.memoizedProps=m,s.memoizedState=fe),_.props=m,_.state=fe,_.context=G,m=ge):(typeof _.componentDidUpdate!="function"||z===i.memoizedProps&&le===i.memoizedState||(s.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||z===i.memoizedProps&&le===i.memoizedState||(s.flags|=1024),m=!1)}return _=m,nd(i,s),m=(s.flags&128)!==0,_||m?(_=s.stateNode,c=m&&typeof c.getDerivedStateFromError!="function"?null:_.render(),s.flags|=1,i!==null&&m?(s.child=xs(s,i.child,null,y),s.child=xs(s,null,c,y)):_r(i,s,c,y),s.memoizedState=_.state,i=s.child):i=Da(i,s,y),i}function RN(i,s,c,m){return ms(),s.flags|=256,_r(i,s,c,m),s.child}var Mh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ph(i){return{baseLanes:i,cachePool:C0()}}function Th(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=dn),i}function IN(i,s,c){var m=s.pendingProps,y=!1,_=(s.flags&128)!==0,z;if((z=_)||(z=i!==null&&i.memoizedState===null?!1:(Ht.current&2)!==0),z&&(y=!0,s.flags&=-129),z=(s.flags&32)!==0,s.flags&=-33,i===null){if(it){if(y?Ni(s):_i(),(i=At)?(i=Q_(i,wn),i=i!==null&&i.data!=="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:hi!==null?{id:aa,overflow:ia}:null,retryLane:536870912,hydrationErrors:null},c=g0(i),c.return=s,s.child=c,jr=s,At=null)):i=null,i===null)throw gi(s);return gv(i)?s.lanes=32:s.lanes=536870912,null}var T=m.children;return m=m.fallback,y?(_i(),y=s.mode,T=ad({mode:"hidden",children:T},y),m=ds(m,y,c,null),T.return=s,m.return=s,T.sibling=m,s.child=T,m=s.child,m.memoizedState=Ph(c),m.childLanes=Th(i,z,c),s.memoizedState=Mh,Wo(null,m)):(Ni(s),qh(s,T))}var G=i.memoizedState;if(G!==null&&(T=G.dehydrated,T!==null)){if(_)s.flags&256?(Ni(s),s.flags&=-257,s=Rh(i,s,c)):s.memoizedState!==null?(_i(),s.child=i.child,s.flags|=128,s=null):(_i(),T=m.fallback,y=s.mode,m=ad({mode:"visible",children:m.children},y),T=ds(T,y,c,null),T.flags|=2,m.return=s,T.return=s,m.sibling=T,s.child=m,xs(s,i.child,null,c),m=s.child,m.memoizedState=Ph(c),m.childLanes=Th(i,z,c),s.memoizedState=Mh,s=Wo(null,m));else if(Ni(s),gv(T)){if(z=T.nextSibling&&T.nextSibling.dataset,z)var ie=z.dgst;z=ie,m=Error(a(419)),m.stack="",m.digest=z,Io({value:m,source:null,stack:null}),s=Rh(i,s,c)}else if(Wt||Sl(i,s,c,!1),z=(c&i.childLanes)!==0,Wt||z){if(z=wt,z!==null&&(m=Sj(z,c),m!==0&&m!==G.retryLane))throw G.retryLane=m,us(i,m),Xr(z,i,m),Oh;vv(T)||fd(),s=Rh(i,s,c)}else vv(T)?(s.flags|=192,s.child=i.child,s=null):(i=G.treeContext,At=En(T.nextSibling),jr=s,it=!0,vi=null,wn=!1,i!==null&&y0(s,i),s=qh(s,m.children),s.flags|=4096);return s}return y?(_i(),T=m.fallback,y=s.mode,G=i.child,ie=G.sibling,m=Ca(G,{mode:"hidden",children:m.children}),m.subtreeFlags=G.subtreeFlags&65011712,ie!==null?T=Ca(ie,T):(T=ds(T,y,c,null),T.flags|=2),T.return=s,m.return=s,m.sibling=T,s.child=m,Wo(null,m),m=s.child,T=i.child.memoizedState,T===null?T=Ph(c):(y=T.cachePool,y!==null?(G=Yt._currentValue,y=y.parent!==G?{parent:G,pool:G}:y):y=C0(),T={baseLanes:T.baseLanes|c,cachePool:y}),m.memoizedState=T,m.childLanes=Th(i,z,c),s.memoizedState=Mh,Wo(i.child,m)):(Ni(s),c=i.child,i=c.sibling,c=Ca(c,{mode:"visible",children:m.children}),c.return=s,c.sibling=null,i!==null&&(z=s.deletions,z===null?(s.deletions=[i],s.flags|=16):z.push(i)),s.child=c,s.memoizedState=null,c)}function qh(i,s){return s=ad({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function ad(i,s){return i=ln(22,i,null,s),i.lanes=0,i}function Rh(i,s,c){return xs(s,i.child,null,c),i=qh(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function LN(i,s,c){i.lanes|=s;var m=i.alternate;m!==null&&(m.lanes|=s),Zp(i.return,s,c)}function Ih(i,s,c,m,y,_){var z=i.memoizedState;z===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:m,tail:c,tailMode:y,treeForkCount:_}:(z.isBackwards=s,z.rendering=null,z.renderingStartTime=0,z.last=m,z.tail=c,z.tailMode=y,z.treeForkCount=_)}function $N(i,s,c){var m=s.pendingProps,y=m.revealOrder,_=m.tail;m=m.children;var z=Ht.current,T=(z&2)!==0;if(T?(z=z&1|2,s.flags|=128):z&=1,oe(Ht,z),_r(i,s,m,c),m=it?Ro:0,!T&&i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&LN(i,c,s);else if(i.tag===19)LN(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(y){case"forwards":for(c=s.child,y=null;c!==null;)i=c.alternate,i!==null&&Qu(i)===null&&(y=c),c=c.sibling;c=y,c===null?(y=s.child,s.child=null):(y=c.sibling,c.sibling=null),Ih(s,!1,y,c,_,m);break;case"backwards":case"unstable_legacy-backwards":for(c=null,y=s.child,s.child=null;y!==null;){if(i=y.alternate,i!==null&&Qu(i)===null){s.child=y;break}i=y.sibling,y.sibling=c,c=y,y=i}Ih(s,!0,c,null,_,m);break;case"together":Ih(s,!1,null,null,void 0,m);break;default:s.memoizedState=null}return s.child}function Da(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),Ci|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(Sl(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(a(153));if(s.child!==null){for(i=s.child,c=Ca(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=Ca(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function Lh(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Iu(i)))}function ET(i,s,c){switch(s.tag){case 3:Pe(s,s.stateNode.containerInfo),xi(s,Yt,i.memoizedState.cache),ms();break;case 27:case 5:X(s);break;case 4:Pe(s,s.stateNode.containerInfo);break;case 10:xi(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,uh(s),null;break;case 13:var m=s.memoizedState;if(m!==null)return m.dehydrated!==null?(Ni(s),s.flags|=128,null):(c&s.child.childLanes)!==0?IN(i,s,c):(Ni(s),i=Da(i,s,c),i!==null?i.sibling:null);Ni(s);break;case 19:var y=(i.flags&128)!==0;if(m=(c&s.childLanes)!==0,m||(Sl(i,s,c,!1),m=(c&s.childLanes)!==0),y){if(m)return $N(i,s,c);s.flags|=128}if(y=s.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),oe(Ht,Ht.current),m)break;return null;case 22:return s.lanes=0,DN(i,s,c,s.pendingProps);case 24:xi(s,Yt,i.memoizedState.cache)}return Da(i,s,c)}function BN(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)Wt=!0;else{if(!Lh(i,c)&&(s.flags&128)===0)return Wt=!1,ET(i,s,c);Wt=(i.flags&131072)!==0}else Wt=!1,it&&(s.flags&1048576)!==0&&b0(s,Ro,s.index);switch(s.lanes=0,s.tag){case 16:e:{var m=s.pendingProps;if(i=vs(s.elementType),s.type=i,typeof i=="function")Gp(i)?(m=ys(i,m),s.tag=1,s=qN(null,s,i,m,c)):(s.tag=0,s=Dh(null,s,i,m,c));else{if(i!=null){var y=i.$$typeof;if(y===A){s.tag=11,s=zN(null,s,i,m,c);break e}else if(y===M){s.tag=14,s=kN(null,s,i,m,c);break e}}throw s=se(i)||i,Error(a(306,s,""))}}return s;case 0:return Dh(i,s,s.type,s.pendingProps,c);case 1:return m=s.type,y=ys(m,s.pendingProps),qN(i,s,m,y,c);case 3:e:{if(Pe(s,s.stateNode.containerInfo),i===null)throw Error(a(387));m=s.pendingProps;var _=s.memoizedState;y=_.element,ih(i,s),Ho(s,m,null,c);var z=s.memoizedState;if(m=z.cache,xi(s,Yt,m),m!==_.cache&&Jp(s,[Yt],c,!0),Go(),m=z.element,_.isDehydrated)if(_={element:m,isDehydrated:!1,cache:z.cache},s.updateQueue.baseState=_,s.memoizedState=_,s.flags&256){s=RN(i,s,m,c);break e}else if(m!==y){y=Nn(Error(a(424)),s),Io(y),s=RN(i,s,m,c);break e}else for(i=s.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,At=En(i.firstChild),jr=s,it=!0,vi=null,wn=!0,c=D0(s,null,m,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(ms(),m===y){s=Da(i,s,c);break e}_r(i,s,m,c)}s=s.child}return s;case 26:return nd(i,s),i===null?(c=Z_(s.type,null,s.pendingProps,null))?s.memoizedState=c:it||(c=s.type,i=s.pendingProps,m=yd(H.current).createElement(c),m[yr]=s,m[Hr]=i,Sr(m,c,i),or(m),s.stateNode=m):s.memoizedState=Z_(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return X(s),i===null&&it&&(m=s.stateNode=K_(s.type,s.pendingProps,H.current),jr=s,wn=!0,y=At,Oi(s.type)?(xv=y,At=En(m.firstChild)):At=y),_r(i,s,s.pendingProps.children,c),nd(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&it&&((y=m=At)&&(m=nq(m,s.type,s.pendingProps,wn),m!==null?(s.stateNode=m,jr=s,At=En(m.firstChild),wn=!1,y=!0):y=!1),y||gi(s)),X(s),y=s.type,_=s.pendingProps,z=i!==null?i.memoizedProps:null,m=_.children,fv(y,_)?m=null:z!==null&&fv(y,z)&&(s.flags|=32),s.memoizedState!==null&&(y=mh(i,s,xT,null,null,c),dc._currentValue=y),nd(i,s),_r(i,s,m,c),s.child;case 6:return i===null&&it&&((i=c=At)&&(c=aq(c,s.pendingProps,wn),c!==null?(s.stateNode=c,jr=s,At=null,i=!0):i=!1),i||gi(s)),null;case 13:return IN(i,s,c);case 4:return Pe(s,s.stateNode.containerInfo),m=s.pendingProps,i===null?s.child=xs(s,null,m,c):_r(i,s,m,c),s.child;case 11:return zN(i,s,s.type,s.pendingProps,c);case 7:return _r(i,s,s.pendingProps,c),s.child;case 8:return _r(i,s,s.pendingProps.children,c),s.child;case 12:return _r(i,s,s.pendingProps.children,c),s.child;case 10:return m=s.pendingProps,xi(s,s.type,m.value),_r(i,s,m.children,c),s.child;case 9:return y=s.type._context,m=s.pendingProps.children,ps(s),y=Nr(y),m=m(y),s.flags|=1,_r(i,s,m,c),s.child;case 14:return kN(i,s,s.type,s.pendingProps,c);case 15:return ON(i,s,s.type,s.pendingProps,c);case 19:return $N(i,s,c);case 31:return CT(i,s,c);case 22:return DN(i,s,c,s.pendingProps);case 24:return ps(s),m=Nr(Yt),i===null?(y=rh(),y===null&&(y=wt,_=eh(),y.pooledCache=_,_.refCount++,_!==null&&(y.pooledCacheLanes|=c),y=_),s.memoizedState={parent:m,cache:y},ah(s),xi(s,Yt,y)):((i.lanes&c)!==0&&(ih(i,s),Ho(s,null,null,c),Go()),y=i.memoizedState,_=s.memoizedState,y.parent!==m?(y={parent:m,cache:m},s.memoizedState=y,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=y),xi(s,Yt,m)):(m=_.cache,xi(s,Yt,m),m!==y.cache&&Jp(s,[Yt],c,!0))),_r(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(a(156,s.tag))}function Ma(i){i.flags|=4}function $h(i,s,c,m,y){if((s=(i.mode&32)!==0)&&(s=!1),s){if(i.flags|=16777216,(y&335544128)===y)if(i.stateNode.complete)i.flags|=8192;else if(p_())i.flags|=8192;else throw gs=Uu,nh}else i.flags&=-16777217}function UN(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!n1(s))if(p_())i.flags|=8192;else throw gs=Uu,nh}function id(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?$e():536870912,i.lanes|=s,ql|=s)}function Xo(i,s){if(!it)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:m.sibling=null}}function zt(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,m=0;if(s)for(var y=i.child;y!==null;)c|=y.lanes|y.childLanes,m|=y.subtreeFlags&65011712,m|=y.flags&65011712,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)c|=y.lanes|y.childLanes,m|=y.subtreeFlags,m|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=m,i.childLanes=c,s}function AT(i,s,c){var m=s.pendingProps;switch(Yp(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zt(s),null;case 1:return zt(s),null;case 3:return c=s.stateNode,m=null,i!==null&&(m=i.memoizedState.cache),s.memoizedState.cache!==m&&(s.flags|=2048),za(Yt),ue(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(_l(s)?Ma(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Wp())),zt(s),null;case 26:var y=s.type,_=s.memoizedState;return i===null?(Ma(s),_!==null?(zt(s),UN(s,_)):(zt(s),$h(s,y,null,m,c))):_?_!==i.memoizedState?(Ma(s),zt(s),UN(s,_)):(zt(s),s.flags&=-16777217):(i=i.memoizedProps,i!==m&&Ma(s),zt(s),$h(s,y,i,m,c)),null;case 27:if(Q(s),c=H.current,y=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==m&&Ma(s);else{if(!m){if(s.stateNode===null)throw Error(a(166));return zt(s),null}i=xe.current,_l(s)?j0(s):(i=K_(y,m,c),s.stateNode=i,Ma(s))}return zt(s),null;case 5:if(Q(s),y=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==m&&Ma(s);else{if(!m){if(s.stateNode===null)throw Error(a(166));return zt(s),null}if(_=xe.current,_l(s))j0(s);else{var z=yd(H.current);switch(_){case 1:_=z.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:_=z.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":_=z.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":_=z.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":_=z.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof m.is=="string"?z.createElement("select",{is:m.is}):z.createElement("select"),m.multiple?_.multiple=!0:m.size&&(_.size=m.size);break;default:_=typeof m.is=="string"?z.createElement(y,{is:m.is}):z.createElement(y)}}_[yr]=s,_[Hr]=m;e:for(z=s.child;z!==null;){if(z.tag===5||z.tag===6)_.appendChild(z.stateNode);else if(z.tag!==4&&z.tag!==27&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===s)break e;for(;z.sibling===null;){if(z.return===null||z.return===s)break e;z=z.return}z.sibling.return=z.return,z=z.sibling}s.stateNode=_;e:switch(Sr(_,y,m),y){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&Ma(s)}}return zt(s),$h(s,s.type,i===null?null:i.memoizedProps,s.pendingProps,c),null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==m&&Ma(s);else{if(typeof m!="string"&&s.stateNode===null)throw Error(a(166));if(i=H.current,_l(s)){if(i=s.stateNode,c=s.memoizedProps,m=null,y=jr,y!==null)switch(y.tag){case 27:case 5:m=y.memoizedProps}i[yr]=s,i=!!(i.nodeValue===c||m!==null&&m.suppressHydrationWarning===!0||I_(i.nodeValue,c)),i||gi(s,!0)}else i=yd(i).createTextNode(m),i[yr]=s,s.stateNode=i}return zt(s),null;case 31:if(c=s.memoizedState,i===null||i.memoizedState!==null){if(m=_l(s),c!==null){if(i===null){if(!m)throw Error(a(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(557));i[yr]=s}else ms(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;zt(s),i=!1}else c=Wp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=c),i=!0;if(!i)return s.flags&256?(cn(s),s):(cn(s),null);if((s.flags&128)!==0)throw Error(a(558))}return zt(s),null;case 13:if(m=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(y=_l(s),m!==null&&m.dehydrated!==null){if(i===null){if(!y)throw Error(a(318));if(y=s.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(a(317));y[yr]=s}else ms(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;zt(s),y=!1}else y=Wp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=y),y=!0;if(!y)return s.flags&256?(cn(s),s):(cn(s),null)}return cn(s),(s.flags&128)!==0?(s.lanes=c,s):(c=m!==null,i=i!==null&&i.memoizedState!==null,c&&(m=s.child,y=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(y=m.alternate.memoizedState.cachePool.pool),_=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(_=m.memoizedState.cachePool.pool),_!==y&&(m.flags|=2048)),c!==i&&c&&(s.child.flags|=8192),id(s,s.updateQueue),zt(s),null);case 4:return ue(),i===null&&ov(s.stateNode.containerInfo),zt(s),null;case 10:return za(s.type),zt(s),null;case 19:if(V(Ht),m=s.memoizedState,m===null)return zt(s),null;if(y=(s.flags&128)!==0,_=m.rendering,_===null)if(y)Xo(m,!1);else{if($t!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(_=Qu(i),_!==null){for(s.flags|=128,Xo(m,!1),i=_.updateQueue,s.updateQueue=i,id(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)v0(c,i),c=c.sibling;return oe(Ht,Ht.current&1|2),it&&Ea(s,m.treeForkCount),s.child}i=i.sibling}m.tail!==null&&Re()>ud&&(s.flags|=128,y=!0,Xo(m,!1),s.lanes=4194304)}else{if(!y)if(i=Qu(_),i!==null){if(s.flags|=128,y=!0,i=i.updateQueue,s.updateQueue=i,id(s,i),Xo(m,!0),m.tail===null&&m.tailMode==="hidden"&&!_.alternate&&!it)return zt(s),null}else 2*Re()-m.renderingStartTime>ud&&c!==536870912&&(s.flags|=128,y=!0,Xo(m,!1),s.lanes=4194304);m.isBackwards?(_.sibling=s.child,s.child=_):(i=m.last,i!==null?i.sibling=_:s.child=_,m.last=_)}return m.tail!==null?(i=m.tail,m.rendering=i,m.tail=i.sibling,m.renderingStartTime=Re(),i.sibling=null,c=Ht.current,oe(Ht,y?c&1|2:c&1),it&&Ea(s,m.treeForkCount),i):(zt(s),null);case 22:case 23:return cn(s),ch(),m=s.memoizedState!==null,i!==null?i.memoizedState!==null!==m&&(s.flags|=8192):m&&(s.flags|=8192),m?(c&536870912)!==0&&(s.flags&128)===0&&(zt(s),s.subtreeFlags&6&&(s.flags|=8192)):zt(s),c=s.updateQueue,c!==null&&id(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),m=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(m=s.memoizedState.cachePool.pool),m!==c&&(s.flags|=2048),i!==null&&V(hs),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),za(Yt),zt(s),null;case 25:return null;case 30:return null}throw Error(a(156,s.tag))}function zT(i,s){switch(Yp(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return za(Yt),ue(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Q(s),null;case 31:if(s.memoizedState!==null){if(cn(s),s.alternate===null)throw Error(a(340));ms()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 13:if(cn(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(a(340));ms()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return V(Ht),null;case 4:return ue(),null;case 10:return za(s.type),null;case 22:case 23:return cn(s),ch(),i!==null&&V(hs),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return za(Yt),null;case 25:return null;default:return null}}function FN(i,s){switch(Yp(s),s.tag){case 3:za(Yt),ue();break;case 26:case 27:case 5:Q(s);break;case 4:ue();break;case 31:s.memoizedState!==null&&cn(s);break;case 13:cn(s);break;case 19:V(Ht);break;case 10:za(s.type);break;case 22:case 23:cn(s),ch(),i!==null&&V(hs);break;case 24:za(Yt)}}function Zo(i,s){try{var c=s.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var y=m.next;c=y;do{if((c.tag&i)===i){m=void 0;var _=c.create,z=c.inst;m=_(),z.destroy=m}c=c.next}while(c!==y)}}catch(T){ht(s,s.return,T)}}function Si(i,s,c){try{var m=s.updateQueue,y=m!==null?m.lastEffect:null;if(y!==null){var _=y.next;m=_;do{if((m.tag&i)===i){var z=m.inst,T=z.destroy;if(T!==void 0){z.destroy=void 0,y=s;var G=c,ie=T;try{ie()}catch(ge){ht(y,G,ge)}}}m=m.next}while(m!==_)}}catch(ge){ht(s,s.return,ge)}}function GN(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{P0(s,c)}catch(m){ht(i,i.return,m)}}}function HN(i,s,c){c.props=ys(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(m){ht(i,s,m)}}function Jo(i,s){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var m=i.stateNode;break;case 30:m=i.stateNode;break;default:m=i.stateNode}typeof c=="function"?i.refCleanup=c(m):c.current=m}}catch(y){ht(i,s,y)}}function sa(i,s){var c=i.ref,m=i.refCleanup;if(c!==null)if(typeof m=="function")try{m()}catch(y){ht(i,s,y)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(y){ht(i,s,y)}else c.current=null}function QN(i){var s=i.type,c=i.memoizedProps,m=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&m.focus();break e;case"img":c.src?m.src=c.src:c.srcSet&&(m.srcset=c.srcSet)}}catch(y){ht(i,i.return,y)}}function Bh(i,s,c){try{var m=i.stateNode;XT(m,i.type,c,s),m[Hr]=s}catch(y){ht(i,i.return,y)}}function VN(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Oi(i.type)||i.tag===4}function Uh(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||VN(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Oi(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Fh(i,s,c){var m=i.tag;if(m===5||m===6)i=i.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(i),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=Sa));else if(m!==4&&(m===27&&Oi(i.type)&&(c=i.stateNode,s=null),i=i.child,i!==null))for(Fh(i,s,c),i=i.sibling;i!==null;)Fh(i,s,c),i=i.sibling}function sd(i,s,c){var m=i.tag;if(m===5||m===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(m!==4&&(m===27&&Oi(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(sd(i,s,c),i=i.sibling;i!==null;)sd(i,s,c),i=i.sibling}function YN(i){var s=i.stateNode,c=i.memoizedProps;try{for(var m=i.type,y=s.attributes;y.length;)s.removeAttributeNode(y[0]);Sr(s,m,c),s[yr]=i,s[Hr]=c}catch(_){ht(i,i.return,_)}}var Pa=!1,Xt=!1,Gh=!1,KN=typeof WeakSet=="function"?WeakSet:Set,cr=null;function kT(i,s){if(i=i.containerInfo,dv=Ed,i=l0(i),Rp(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var m=c.getSelection&&c.getSelection();if(m&&m.rangeCount!==0){c=m.anchorNode;var y=m.anchorOffset,_=m.focusNode;m=m.focusOffset;try{c.nodeType,_.nodeType}catch{c=null;break e}var z=0,T=-1,G=-1,ie=0,ge=0,ye=i,le=null;t:for(;;){for(var fe;ye!==c||y!==0&&ye.nodeType!==3||(T=z+y),ye!==_||m!==0&&ye.nodeType!==3||(G=z+m),ye.nodeType===3&&(z+=ye.nodeValue.length),(fe=ye.firstChild)!==null;)le=ye,ye=fe;for(;;){if(ye===i)break t;if(le===c&&++ie===y&&(T=z),le===_&&++ge===m&&(G=z),(fe=ye.nextSibling)!==null)break;ye=le,le=ye.parentNode}ye=fe}c=T===-1||G===-1?null:{start:T,end:G}}else c=null}c=c||{start:0,end:0}}else c=null;for(mv={focusedElem:i,selectionRange:c},Ed=!1,cr=s;cr!==null;)if(s=cr,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,cr=i;else for(;cr!==null;){switch(s=cr,_=s.alternate,i=s.flags,s.tag){case 0:if((i&4)!==0&&(i=s.updateQueue,i=i!==null?i.events:null,i!==null))for(c=0;c<i.length;c++)y=i[c],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&_!==null){i=void 0,c=s,y=_.memoizedProps,_=_.memoizedState,m=c.stateNode;try{var ke=ys(c.type,y);i=m.getSnapshotBeforeUpdate(ke,_),m.__reactInternalSnapshotBeforeUpdate=i}catch(Ge){ht(c,c.return,Ge)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)hv(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":hv(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(a(163))}if(i=s.sibling,i!==null){i.return=s.return,cr=i;break}cr=s.return}}function WN(i,s,c){var m=c.flags;switch(c.tag){case 0:case 11:case 15:qa(i,c),m&4&&Zo(5,c);break;case 1:if(qa(i,c),m&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(z){ht(c,c.return,z)}else{var y=ys(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(y,s,i.__reactInternalSnapshotBeforeUpdate)}catch(z){ht(c,c.return,z)}}m&64&&GN(c),m&512&&Jo(c,c.return);break;case 3:if(qa(i,c),m&64&&(i=c.updateQueue,i!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{P0(i,s)}catch(z){ht(c,c.return,z)}}break;case 27:s===null&&m&4&&YN(c);case 26:case 5:qa(i,c),s===null&&m&4&&QN(c),m&512&&Jo(c,c.return);break;case 12:qa(i,c);break;case 31:qa(i,c),m&4&&JN(i,c);break;case 13:qa(i,c),m&4&&e_(i,c),m&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=LT.bind(null,c),iq(i,c))));break;case 22:if(m=c.memoizedState!==null||Pa,!m){s=s!==null&&s.memoizedState!==null||Xt,y=Pa;var _=Xt;Pa=m,(Xt=s)&&!_?Ra(i,c,(c.subtreeFlags&8772)!==0):qa(i,c),Pa=y,Xt=_}break;case 30:break;default:qa(i,c)}}function XN(i){var s=i.alternate;s!==null&&(i.alternate=null,XN(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&yp(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Mt=null,Vr=!1;function Ta(i,s,c){for(c=c.child;c!==null;)ZN(i,s,c),c=c.sibling}function ZN(i,s,c){if(ce&&typeof ce.onCommitFiberUnmount=="function")try{ce.onCommitFiberUnmount(Z,c)}catch{}switch(c.tag){case 26:Xt||sa(c,s),Ta(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Xt||sa(c,s);var m=Mt,y=Vr;Oi(c.type)&&(Mt=c.stateNode,Vr=!1),Ta(i,s,c),oc(c.stateNode),Mt=m,Vr=y;break;case 5:Xt||sa(c,s);case 6:if(m=Mt,y=Vr,Mt=null,Ta(i,s,c),Mt=m,Vr=y,Mt!==null)if(Vr)try{(Mt.nodeType===9?Mt.body:Mt.nodeName==="HTML"?Mt.ownerDocument.body:Mt).removeChild(c.stateNode)}catch(_){ht(c,s,_)}else try{Mt.removeChild(c.stateNode)}catch(_){ht(c,s,_)}break;case 18:Mt!==null&&(Vr?(i=Mt,G_(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),Gl(i)):G_(Mt,c.stateNode));break;case 4:m=Mt,y=Vr,Mt=c.stateNode.containerInfo,Vr=!0,Ta(i,s,c),Mt=m,Vr=y;break;case 0:case 11:case 14:case 15:Si(2,c,s),Xt||Si(4,c,s),Ta(i,s,c);break;case 1:Xt||(sa(c,s),m=c.stateNode,typeof m.componentWillUnmount=="function"&&HN(c,s,m)),Ta(i,s,c);break;case 21:Ta(i,s,c);break;case 22:Xt=(m=Xt)||c.memoizedState!==null,Ta(i,s,c),Xt=m;break;default:Ta(i,s,c)}}function JN(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Gl(i)}catch(c){ht(s,s.return,c)}}}function e_(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Gl(i)}catch(c){ht(s,s.return,c)}}function OT(i){switch(i.tag){case 31:case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new KN),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new KN),s;default:throw Error(a(435,i.tag))}}function ld(i,s){var c=OT(i);s.forEach(function(m){if(!c.has(m)){c.add(m);var y=$T.bind(null,i,m);m.then(y,y)}})}function Yr(i,s){var c=s.deletions;if(c!==null)for(var m=0;m<c.length;m++){var y=c[m],_=i,z=s,T=z;e:for(;T!==null;){switch(T.tag){case 27:if(Oi(T.type)){Mt=T.stateNode,Vr=!1;break e}break;case 5:Mt=T.stateNode,Vr=!1;break e;case 3:case 4:Mt=T.stateNode.containerInfo,Vr=!0;break e}T=T.return}if(Mt===null)throw Error(a(160));ZN(_,z,y),Mt=null,Vr=!1,_=y.alternate,_!==null&&(_.return=null),y.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)t_(s,i),s=s.sibling}var Fn=null;function t_(i,s){var c=i.alternate,m=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Yr(s,i),Kr(i),m&4&&(Si(3,i,i.return),Zo(3,i),Si(5,i,i.return));break;case 1:Yr(s,i),Kr(i),m&512&&(Xt||c===null||sa(c,c.return)),m&64&&Pa&&(i=i.updateQueue,i!==null&&(m=i.callbacks,m!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?m:c.concat(m))));break;case 26:var y=Fn;if(Yr(s,i),Kr(i),m&512&&(Xt||c===null||sa(c,c.return)),m&4){var _=c!==null?c.memoizedState:null;if(m=i.memoizedState,c===null)if(m===null)if(i.stateNode===null){e:{m=i.type,c=i.memoizedProps,y=y.ownerDocument||y;t:switch(m){case"title":_=y.getElementsByTagName("title")[0],(!_||_[Co]||_[yr]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=y.createElement(m),y.head.insertBefore(_,y.querySelector("head > title"))),Sr(_,m,c),_[yr]=i,or(_),m=_;break e;case"link":var z=t1("link","href",y).get(m+(c.href||""));if(z){for(var T=0;T<z.length;T++)if(_=z[T],_.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&_.getAttribute("rel")===(c.rel==null?null:c.rel)&&_.getAttribute("title")===(c.title==null?null:c.title)&&_.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){z.splice(T,1);break t}}_=y.createElement(m),Sr(_,m,c),y.head.appendChild(_);break;case"meta":if(z=t1("meta","content",y).get(m+(c.content||""))){for(T=0;T<z.length;T++)if(_=z[T],_.getAttribute("content")===(c.content==null?null:""+c.content)&&_.getAttribute("name")===(c.name==null?null:c.name)&&_.getAttribute("property")===(c.property==null?null:c.property)&&_.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&_.getAttribute("charset")===(c.charSet==null?null:c.charSet)){z.splice(T,1);break t}}_=y.createElement(m),Sr(_,m,c),y.head.appendChild(_);break;default:throw Error(a(468,m))}_[yr]=i,or(_),m=_}i.stateNode=m}else r1(y,i.type,i.stateNode);else i.stateNode=e1(y,m,i.memoizedProps);else _!==m?(_===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):_.count--,m===null?r1(y,i.type,i.stateNode):e1(y,m,i.memoizedProps)):m===null&&i.stateNode!==null&&Bh(i,i.memoizedProps,c.memoizedProps)}break;case 27:Yr(s,i),Kr(i),m&512&&(Xt||c===null||sa(c,c.return)),c!==null&&m&4&&Bh(i,i.memoizedProps,c.memoizedProps);break;case 5:if(Yr(s,i),Kr(i),m&512&&(Xt||c===null||sa(c,c.return)),i.flags&32){y=i.stateNode;try{fl(y,"")}catch(ke){ht(i,i.return,ke)}}m&4&&i.stateNode!=null&&(y=i.memoizedProps,Bh(i,y,c!==null?c.memoizedProps:y)),m&1024&&(Gh=!0);break;case 6:if(Yr(s,i),Kr(i),m&4){if(i.stateNode===null)throw Error(a(162));m=i.memoizedProps,c=i.stateNode;try{c.nodeValue=m}catch(ke){ht(i,i.return,ke)}}break;case 3:if(_d=null,y=Fn,Fn=jd(s.containerInfo),Yr(s,i),Fn=y,Kr(i),m&4&&c!==null&&c.memoizedState.isDehydrated)try{Gl(s.containerInfo)}catch(ke){ht(i,i.return,ke)}Gh&&(Gh=!1,r_(i));break;case 4:m=Fn,Fn=jd(i.stateNode.containerInfo),Yr(s,i),Kr(i),Fn=m;break;case 12:Yr(s,i),Kr(i);break;case 31:Yr(s,i),Kr(i),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,ld(i,m)));break;case 13:Yr(s,i),Kr(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(cd=Re()),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,ld(i,m)));break;case 22:y=i.memoizedState!==null;var G=c!==null&&c.memoizedState!==null,ie=Pa,ge=Xt;if(Pa=ie||y,Xt=ge||G,Yr(s,i),Xt=ge,Pa=ie,Kr(i),m&8192)e:for(s=i.stateNode,s._visibility=y?s._visibility&-2:s._visibility|1,y&&(c===null||G||Pa||Xt||js(i)),c=null,s=i;;){if(s.tag===5||s.tag===26){if(c===null){G=c=s;try{if(_=G.stateNode,y)z=_.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none";else{T=G.stateNode;var ye=G.memoizedProps.style,le=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;T.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(ke){ht(G,G.return,ke)}}}else if(s.tag===6){if(c===null){G=s;try{G.stateNode.nodeValue=y?"":G.memoizedProps}catch(ke){ht(G,G.return,ke)}}}else if(s.tag===18){if(c===null){G=s;try{var fe=G.stateNode;y?H_(fe,!0):H_(G.stateNode,!1)}catch(ke){ht(G,G.return,ke)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}m&4&&(m=i.updateQueue,m!==null&&(c=m.retryQueue,c!==null&&(m.retryQueue=null,ld(i,c))));break;case 19:Yr(s,i),Kr(i),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,ld(i,m)));break;case 30:break;case 21:break;default:Yr(s,i),Kr(i)}}function Kr(i){var s=i.flags;if(s&2){try{for(var c,m=i.return;m!==null;){if(VN(m)){c=m;break}m=m.return}if(c==null)throw Error(a(160));switch(c.tag){case 27:var y=c.stateNode,_=Uh(i);sd(i,_,y);break;case 5:var z=c.stateNode;c.flags&32&&(fl(z,""),c.flags&=-33);var T=Uh(i);sd(i,T,z);break;case 3:case 4:var G=c.stateNode.containerInfo,ie=Uh(i);Fh(i,ie,G);break;default:throw Error(a(161))}}catch(ge){ht(i,i.return,ge)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function r_(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;r_(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function qa(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)WN(i,s.alternate,s),s=s.sibling}function js(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:Si(4,s,s.return),js(s);break;case 1:sa(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&HN(s,s.return,c),js(s);break;case 27:oc(s.stateNode);case 26:case 5:sa(s,s.return),js(s);break;case 22:s.memoizedState===null&&js(s);break;case 30:js(s);break;default:js(s)}i=i.sibling}}function Ra(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var m=s.alternate,y=i,_=s,z=_.flags;switch(_.tag){case 0:case 11:case 15:Ra(y,_,c),Zo(4,_);break;case 1:if(Ra(y,_,c),m=_,y=m.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(ie){ht(m,m.return,ie)}if(m=_,y=m.updateQueue,y!==null){var T=m.stateNode;try{var G=y.shared.hiddenCallbacks;if(G!==null)for(y.shared.hiddenCallbacks=null,y=0;y<G.length;y++)M0(G[y],T)}catch(ie){ht(m,m.return,ie)}}c&&z&64&&GN(_),Jo(_,_.return);break;case 27:YN(_);case 26:case 5:Ra(y,_,c),c&&m===null&&z&4&&QN(_),Jo(_,_.return);break;case 12:Ra(y,_,c);break;case 31:Ra(y,_,c),c&&z&4&&JN(y,_);break;case 13:Ra(y,_,c),c&&z&4&&e_(y,_);break;case 22:_.memoizedState===null&&Ra(y,_,c),Jo(_,_.return);break;case 30:break;default:Ra(y,_,c)}s=s.sibling}}function Hh(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Lo(c))}function Qh(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Lo(i))}function Gn(i,s,c,m){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)n_(i,s,c,m),s=s.sibling}function n_(i,s,c,m){var y=s.flags;switch(s.tag){case 0:case 11:case 15:Gn(i,s,c,m),y&2048&&Zo(9,s);break;case 1:Gn(i,s,c,m);break;case 3:Gn(i,s,c,m),y&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Lo(i)));break;case 12:if(y&2048){Gn(i,s,c,m),i=s.stateNode;try{var _=s.memoizedProps,z=_.id,T=_.onPostCommit;typeof T=="function"&&T(z,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(G){ht(s,s.return,G)}}else Gn(i,s,c,m);break;case 31:Gn(i,s,c,m);break;case 13:Gn(i,s,c,m);break;case 23:break;case 22:_=s.stateNode,z=s.alternate,s.memoizedState!==null?_._visibility&2?Gn(i,s,c,m):ec(i,s):_._visibility&2?Gn(i,s,c,m):(_._visibility|=2,Ml(i,s,c,m,(s.subtreeFlags&10256)!==0||!1)),y&2048&&Hh(z,s);break;case 24:Gn(i,s,c,m),y&2048&&Qh(s.alternate,s);break;default:Gn(i,s,c,m)}}function Ml(i,s,c,m,y){for(y=y&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var _=i,z=s,T=c,G=m,ie=z.flags;switch(z.tag){case 0:case 11:case 15:Ml(_,z,T,G,y),Zo(8,z);break;case 23:break;case 22:var ge=z.stateNode;z.memoizedState!==null?ge._visibility&2?Ml(_,z,T,G,y):ec(_,z):(ge._visibility|=2,Ml(_,z,T,G,y)),y&&ie&2048&&Hh(z.alternate,z);break;case 24:Ml(_,z,T,G,y),y&&ie&2048&&Qh(z.alternate,z);break;default:Ml(_,z,T,G,y)}s=s.sibling}}function ec(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,m=s,y=m.flags;switch(m.tag){case 22:ec(c,m),y&2048&&Hh(m.alternate,m);break;case 24:ec(c,m),y&2048&&Qh(m.alternate,m);break;default:ec(c,m)}s=s.sibling}}var tc=8192;function Pl(i,s,c){if(i.subtreeFlags&tc)for(i=i.child;i!==null;)a_(i,s,c),i=i.sibling}function a_(i,s,c){switch(i.tag){case 26:Pl(i,s,c),i.flags&tc&&i.memoizedState!==null&&gq(c,Fn,i.memoizedState,i.memoizedProps);break;case 5:Pl(i,s,c);break;case 3:case 4:var m=Fn;Fn=jd(i.stateNode.containerInfo),Pl(i,s,c),Fn=m;break;case 22:i.memoizedState===null&&(m=i.alternate,m!==null&&m.memoizedState!==null?(m=tc,tc=16777216,Pl(i,s,c),tc=m):Pl(i,s,c));break;default:Pl(i,s,c)}}function i_(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function rc(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var m=s[c];cr=m,l_(m,i)}i_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)s_(i),i=i.sibling}function s_(i){switch(i.tag){case 0:case 11:case 15:rc(i),i.flags&2048&&Si(9,i,i.return);break;case 3:rc(i);break;case 12:rc(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,od(i)):rc(i);break;default:rc(i)}}function od(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var m=s[c];cr=m,l_(m,i)}i_(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:Si(8,s,s.return),od(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,od(s));break;default:od(s)}i=i.sibling}}function l_(i,s){for(;cr!==null;){var c=cr;switch(c.tag){case 0:case 11:case 15:Si(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var m=c.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Lo(c.memoizedState.cache)}if(m=c.child,m!==null)m.return=c,cr=m;else e:for(c=i;cr!==null;){m=cr;var y=m.sibling,_=m.return;if(XN(m),m===c){cr=null;break e}if(y!==null){y.return=_,cr=y;break e}cr=_}}}var DT={getCacheForType:function(i){var s=Nr(Yt),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c},cacheSignal:function(){return Nr(Yt).controller.signal}},MT=typeof WeakMap=="function"?WeakMap:Map,mt=0,wt=null,et=null,rt=0,pt=0,un=null,wi=!1,Tl=!1,Vh=!1,Ia=0,$t=0,Ci=0,Ns=0,Yh=0,dn=0,ql=0,nc=null,Wr=null,Kh=!1,cd=0,o_=0,ud=1/0,dd=null,Ei=null,rr=0,Ai=null,Rl=null,La=0,Wh=0,Xh=null,c_=null,ac=0,Zh=null;function mn(){return(mt&2)!==0&&rt!==0?rt&-rt:q.T!==null?av():wj()}function u_(){if(dn===0)if((rt&536870912)===0||it){var i=il;il<<=1,(il&3932160)===0&&(il=262144),dn=i}else dn=536870912;return i=on.current,i!==null&&(i.flags|=32),dn}function Xr(i,s,c){(i===wt&&(pt===2||pt===9)||i.cancelPendingCommit!==null)&&(Il(i,0),zi(i,rt,dn,!1)),zr(i,c),((mt&2)===0||i!==wt)&&(i===wt&&((mt&2)===0&&(Ns|=c),$t===4&&zi(i,rt,dn,!1)),la(i))}function d_(i,s,c){if((mt&6)!==0)throw Error(a(327));var m=!c&&(s&127)===0&&(s&i.expiredLanes)===0||as(i,s),y=m?qT(i,s):ev(i,s,!0),_=m;do{if(y===0){Tl&&!m&&zi(i,s,0,!1);break}else{if(c=i.current.alternate,_&&!PT(c)){y=ev(i,s,!1),_=!1;continue}if(y===2){if(_=s,i.errorRecoveryDisabledLanes&_)var z=0;else z=i.pendingLanes&-536870913,z=z!==0?z:z&536870912?536870912:0;if(z!==0){s=z;e:{var T=i;y=nc;var G=T.current.memoizedState.isDehydrated;if(G&&(Il(T,z).flags|=256),z=ev(T,z,!1),z!==2){if(Vh&&!G){T.errorRecoveryDisabledLanes|=_,Ns|=_,y=4;break e}_=Wr,Wr=y,_!==null&&(Wr===null?Wr=_:Wr.push.apply(Wr,_))}y=z}if(_=!1,y!==2)continue}}if(y===1){Il(i,0),zi(i,s,0,!0);break}e:{switch(m=i,_=y,_){case 0:case 1:throw Error(a(345));case 4:if((s&4194048)!==s)break;case 6:zi(m,s,dn,!wi);break e;case 2:Wr=null;break;case 3:case 5:break;default:throw Error(a(329))}if((s&62914560)===s&&(y=cd+300-Re(),10<y)){if(zi(m,s,dn,!wi),na(m,0,!0)!==0)break e;La=s,m.timeoutHandle=U_(m_.bind(null,m,c,Wr,dd,Kh,s,dn,Ns,ql,wi,_,"Throttled",-0,0),y);break e}m_(m,c,Wr,dd,Kh,s,dn,Ns,ql,wi,_,null,-0,0)}}break}while(!0);la(i)}function m_(i,s,c,m,y,_,z,T,G,ie,ge,ye,le,fe){if(i.timeoutHandle=-1,ye=s.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Sa},a_(s,_,ye);var ke=(_&62914560)===_?cd-Re():(_&4194048)===_?o_-Re():0;if(ke=xq(ye,ke),ke!==null){La=_,i.cancelPendingCommit=ke(y_.bind(null,i,s,_,c,m,y,z,T,G,ge,ye,null,le,fe)),zi(i,_,z,!ie);return}}y_(i,s,_,c,m,y,z,T,G)}function PT(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var m=0;m<c.length;m++){var y=c[m],_=y.getSnapshot;y=y.value;try{if(!sn(_(),y))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function zi(i,s,c,m){s&=~Yh,s&=~Ns,i.suspendedLanes|=s,i.pingedLanes&=~s,m&&(i.warmLanes|=s),m=i.expirationTimes;for(var y=s;0<y;){var _=31-Xe(y),z=1<<_;m[_]=-1,y&=~z}c!==0&&is(i,c,s)}function md(){return(mt&6)===0?(ic(0),!1):!0}function Jh(){if(et!==null){if(pt===0)var i=et.return;else i=et,Aa=fs=null,hh(i),Al=null,Bo=0,i=et;for(;i!==null;)FN(i.alternate,i),i=i.return;et=null}}function Il(i,s){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,eq(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),La=0,Jh(),wt=i,et=c=Ca(i.current,null),rt=s,pt=0,un=null,wi=!1,Tl=as(i,s),Vh=!1,ql=dn=Yh=Ns=Ci=$t=0,Wr=nc=null,Kh=!1,(s&8)!==0&&(s|=s&32);var m=i.entangledLanes;if(m!==0)for(i=i.entanglements,m&=s;0<m;){var y=31-Xe(m),_=1<<y;s|=i[y],m&=~_}return Ia=s,Mu(),c}function f_(i,s){Ye=null,q.H=Ko,s===El||s===Bu?(s=z0(),pt=3):s===nh?(s=z0(),pt=4):pt=s===Oh?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,un=s,et===null&&($t=1,td(i,Nn(s,i.current)))}function p_(){var i=on.current;return i===null?!0:(rt&4194048)===rt?Cn===null:(rt&62914560)===rt||(rt&536870912)!==0?i===Cn:!1}function h_(){var i=q.H;return q.H=Ko,i===null?Ko:i}function v_(){var i=q.A;return q.A=DT,i}function fd(){$t=4,wi||(rt&4194048)!==rt&&on.current!==null||(Tl=!0),(Ci&134217727)===0&&(Ns&134217727)===0||wt===null||zi(wt,rt,dn,!1)}function ev(i,s,c){var m=mt;mt|=2;var y=h_(),_=v_();(wt!==i||rt!==s)&&(dd=null,Il(i,s)),s=!1;var z=$t;e:do try{if(pt!==0&&et!==null){var T=et,G=un;switch(pt){case 8:Jh(),z=6;break e;case 3:case 2:case 9:case 6:on.current===null&&(s=!0);var ie=pt;if(pt=0,un=null,Ll(i,T,G,ie),c&&Tl){z=0;break e}break;default:ie=pt,pt=0,un=null,Ll(i,T,G,ie)}}TT(),z=$t;break}catch(ge){f_(i,ge)}while(!0);return s&&i.shellSuspendCounter++,Aa=fs=null,mt=m,q.H=y,q.A=_,et===null&&(wt=null,rt=0,Mu()),z}function TT(){for(;et!==null;)g_(et)}function qT(i,s){var c=mt;mt|=2;var m=h_(),y=v_();wt!==i||rt!==s?(dd=null,ud=Re()+500,Il(i,s)):Tl=as(i,s);e:do try{if(pt!==0&&et!==null){s=et;var _=un;t:switch(pt){case 1:pt=0,un=null,Ll(i,s,_,1);break;case 2:case 9:if(E0(_)){pt=0,un=null,x_(s);break}s=function(){pt!==2&&pt!==9||wt!==i||(pt=7),la(i)},_.then(s,s);break e;case 3:pt=7;break e;case 4:pt=5;break e;case 7:E0(_)?(pt=0,un=null,x_(s)):(pt=0,un=null,Ll(i,s,_,7));break;case 5:var z=null;switch(et.tag){case 26:z=et.memoizedState;case 5:case 27:var T=et;if(z?n1(z):T.stateNode.complete){pt=0,un=null;var G=T.sibling;if(G!==null)et=G;else{var ie=T.return;ie!==null?(et=ie,pd(ie)):et=null}break t}}pt=0,un=null,Ll(i,s,_,5);break;case 6:pt=0,un=null,Ll(i,s,_,6);break;case 8:Jh(),$t=6;break e;default:throw Error(a(462))}}RT();break}catch(ge){f_(i,ge)}while(!0);return Aa=fs=null,q.H=m,q.A=y,mt=c,et!==null?0:(wt=null,rt=0,Mu(),$t)}function RT(){for(;et!==null&&!pe();)g_(et)}function g_(i){var s=BN(i.alternate,i,Ia);i.memoizedProps=i.pendingProps,s===null?pd(i):et=s}function x_(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=TN(c,s,s.pendingProps,s.type,void 0,rt);break;case 11:s=TN(c,s,s.pendingProps,s.type.render,s.ref,rt);break;case 5:hh(s);default:FN(c,s),s=et=v0(s,Ia),s=BN(c,s,Ia)}i.memoizedProps=i.pendingProps,s===null?pd(i):et=s}function Ll(i,s,c,m){Aa=fs=null,hh(s),Al=null,Bo=0;var y=s.return;try{if(wT(i,y,s,c,rt)){$t=1,td(i,Nn(c,i.current)),et=null;return}}catch(_){if(y!==null)throw et=y,_;$t=1,td(i,Nn(c,i.current)),et=null;return}s.flags&32768?(it||m===1?i=!0:Tl||(rt&536870912)!==0?i=!1:(wi=i=!0,(m===2||m===9||m===3||m===6)&&(m=on.current,m!==null&&m.tag===13&&(m.flags|=16384))),b_(s,i)):pd(s)}function pd(i){var s=i;do{if((s.flags&32768)!==0){b_(s,wi);return}i=s.return;var c=AT(s.alternate,s,Ia);if(c!==null){et=c;return}if(s=s.sibling,s!==null){et=s;return}et=s=i}while(s!==null);$t===0&&($t=5)}function b_(i,s){do{var c=zT(i.alternate,i);if(c!==null){c.flags&=32767,et=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){et=i;return}et=i=c}while(i!==null);$t=6,et=null}function y_(i,s,c,m,y,_,z,T,G){i.cancelPendingCommit=null;do hd();while(rr!==0);if((mt&6)!==0)throw Error(a(327));if(s!==null){if(s===i.current)throw Error(a(177));if(_=s.lanes|s.childLanes,_|=Up,wo(i,c,_,z,T,G),i===wt&&(et=wt=null,rt=0),Rl=s,Ai=i,La=c,Wh=_,Xh=y,c_=m,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,BT(tr,function(){return w_(),null})):(i.callbackNode=null,i.callbackPriority=0),m=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||m){m=q.T,q.T=null,y=F.p,F.p=2,z=mt,mt|=4;try{kT(i,s,c)}finally{mt=z,F.p=y,q.T=m}}rr=1,j_(),N_(),__()}}function j_(){if(rr===1){rr=0;var i=Ai,s=Rl,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=q.T,q.T=null;var m=F.p;F.p=2;var y=mt;mt|=4;try{t_(s,i);var _=mv,z=l0(i.containerInfo),T=_.focusedElem,G=_.selectionRange;if(z!==T&&T&&T.ownerDocument&&s0(T.ownerDocument.documentElement,T)){if(G!==null&&Rp(T)){var ie=G.start,ge=G.end;if(ge===void 0&&(ge=ie),"selectionStart"in T)T.selectionStart=ie,T.selectionEnd=Math.min(ge,T.value.length);else{var ye=T.ownerDocument||document,le=ye&&ye.defaultView||window;if(le.getSelection){var fe=le.getSelection(),ke=T.textContent.length,Ge=Math.min(G.start,ke),jt=G.end===void 0?Ge:Math.min(G.end,ke);!fe.extend&&Ge>jt&&(z=jt,jt=Ge,Ge=z);var te=i0(T,Ge),Y=i0(T,jt);if(te&&Y&&(fe.rangeCount!==1||fe.anchorNode!==te.node||fe.anchorOffset!==te.offset||fe.focusNode!==Y.node||fe.focusOffset!==Y.offset)){var ae=ye.createRange();ae.setStart(te.node,te.offset),fe.removeAllRanges(),Ge>jt?(fe.addRange(ae),fe.extend(Y.node,Y.offset)):(ae.setEnd(Y.node,Y.offset),fe.addRange(ae))}}}}for(ye=[],fe=T;fe=fe.parentNode;)fe.nodeType===1&&ye.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<ye.length;T++){var be=ye[T];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}Ed=!!dv,mv=dv=null}finally{mt=y,F.p=m,q.T=c}}i.current=s,rr=2}}function N_(){if(rr===2){rr=0;var i=Ai,s=Rl,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=q.T,q.T=null;var m=F.p;F.p=2;var y=mt;mt|=4;try{WN(i,s.alternate,s)}finally{mt=y,F.p=m,q.T=c}}rr=3}}function __(){if(rr===4||rr===3){rr=0,Ae();var i=Ai,s=Rl,c=La,m=c_;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?rr=5:(rr=0,Rl=Ai=null,S_(i,i.pendingLanes));var y=i.pendingLanes;if(y===0&&(Ei=null),xp(c),s=s.stateNode,ce&&typeof ce.onCommitFiberRoot=="function")try{ce.onCommitFiberRoot(Z,s,void 0,(s.current.flags&128)===128)}catch{}if(m!==null){s=q.T,y=F.p,F.p=2,q.T=null;try{for(var _=i.onRecoverableError,z=0;z<m.length;z++){var T=m[z];_(T.value,{componentStack:T.stack})}}finally{q.T=s,F.p=y}}(La&3)!==0&&hd(),la(i),y=i.pendingLanes,(c&261930)!==0&&(y&42)!==0?i===Zh?ac++:(ac=0,Zh=i):ac=0,ic(0)}}function S_(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Lo(s)))}function hd(){return j_(),N_(),__(),w_()}function w_(){if(rr!==5)return!1;var i=Ai,s=Wh;Wh=0;var c=xp(La),m=q.T,y=F.p;try{F.p=32>c?32:c,q.T=null,c=Xh,Xh=null;var _=Ai,z=La;if(rr=0,Rl=Ai=null,La=0,(mt&6)!==0)throw Error(a(331));var T=mt;if(mt|=4,s_(_.current),n_(_,_.current,z,c),mt=T,ic(0,!1),ce&&typeof ce.onPostCommitFiberRoot=="function")try{ce.onPostCommitFiberRoot(Z,_)}catch{}return!0}finally{F.p=y,q.T=m,S_(i,s)}}function C_(i,s,c){s=Nn(c,s),s=kh(i.stateNode,s,2),i=ji(i,s,2),i!==null&&(zr(i,2),la(i))}function ht(i,s,c){if(i.tag===3)C_(i,i,c);else for(;s!==null;){if(s.tag===3){C_(s,i,c);break}else if(s.tag===1){var m=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Ei===null||!Ei.has(m))){i=Nn(c,i),c=EN(2),m=ji(s,c,2),m!==null&&(AN(c,m,s,i),zr(m,2),la(m));break}}s=s.return}}function tv(i,s,c){var m=i.pingCache;if(m===null){m=i.pingCache=new MT;var y=new Set;m.set(s,y)}else y=m.get(s),y===void 0&&(y=new Set,m.set(s,y));y.has(c)||(Vh=!0,y.add(c),i=IT.bind(null,i,s,c),s.then(i,i))}function IT(i,s,c){var m=i.pingCache;m!==null&&m.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,wt===i&&(rt&c)===c&&($t===4||$t===3&&(rt&62914560)===rt&&300>Re()-cd?(mt&2)===0&&Il(i,0):Yh|=c,ql===rt&&(ql=0)),la(i)}function E_(i,s){s===0&&(s=$e()),i=us(i,s),i!==null&&(zr(i,s),la(i))}function LT(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),E_(i,c)}function $T(i,s){var c=0;switch(i.tag){case 31:case 13:var m=i.stateNode,y=i.memoizedState;y!==null&&(c=y.retryLane);break;case 19:m=i.stateNode;break;case 22:m=i.stateNode._retryCache;break;default:throw Error(a(314))}m!==null&&m.delete(s),E_(i,c)}function BT(i,s){return lr(i,s)}var vd=null,$l=null,rv=!1,gd=!1,nv=!1,ki=0;function la(i){i!==$l&&i.next===null&&($l===null?vd=$l=i:$l=$l.next=i),gd=!0,rv||(rv=!0,FT())}function ic(i,s){if(!nv&&gd){nv=!0;do for(var c=!1,m=vd;m!==null;){if(i!==0){var y=m.pendingLanes;if(y===0)var _=0;else{var z=m.suspendedLanes,T=m.pingedLanes;_=(1<<31-Xe(42|i)+1)-1,_&=y&~(z&~T),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(c=!0,O_(m,_))}else _=rt,_=na(m,m===wt?_:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(_&3)===0||as(m,_)||(c=!0,O_(m,_));m=m.next}while(c);nv=!1}}function UT(){A_()}function A_(){gd=rv=!1;var i=0;ki!==0&&JT()&&(i=ki);for(var s=Re(),c=null,m=vd;m!==null;){var y=m.next,_=z_(m,s);_===0?(m.next=null,c===null?vd=y:c.next=y,y===null&&($l=c)):(c=m,(i!==0||(_&3)!==0)&&(gd=!0)),m=y}rr!==0&&rr!==5||ic(i),ki!==0&&(ki=0)}function z_(i,s){for(var c=i.suspendedLanes,m=i.pingedLanes,y=i.expirationTimes,_=i.pendingLanes&-62914561;0<_;){var z=31-Xe(_),T=1<<z,G=y[z];G===-1?((T&c)===0||(T&m)!==0)&&(y[z]=ne(T,s)):G<=s&&(i.expiredLanes|=T),_&=~T}if(s=wt,c=rt,c=na(i,i===s?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),m=i.callbackNode,c===0||i===s&&(pt===2||pt===9)||i.cancelPendingCommit!==null)return m!==null&&m!==null&&an(m),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||as(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(m!==null&&an(m),xp(c)){case 2:case 8:c=It;break;case 32:c=tr;break;case 268435456:c=J;break;default:c=tr}return m=k_.bind(null,i),c=lr(c,m),i.callbackPriority=s,i.callbackNode=c,s}return m!==null&&m!==null&&an(m),i.callbackPriority=2,i.callbackNode=null,2}function k_(i,s){if(rr!==0&&rr!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(hd()&&i.callbackNode!==c)return null;var m=rt;return m=na(i,i===wt?m:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),m===0?null:(d_(i,m,s),z_(i,Re()),i.callbackNode!=null&&i.callbackNode===c?k_.bind(null,i):null)}function O_(i,s){if(hd())return null;d_(i,s,!0)}function FT(){tq(function(){(mt&6)!==0?lr(xt,UT):A_()})}function av(){if(ki===0){var i=wl;i===0&&(i=ra,ra<<=1,(ra&261888)===0&&(ra=256)),ki=i}return ki}function D_(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:wu(""+i)}function M_(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function GT(i,s,c,m,y){if(s==="submit"&&c&&c.stateNode===y){var _=D_((y[Hr]||null).action),z=m.submitter;z&&(s=(s=z[Hr]||null)?D_(s.formAction):z.getAttribute("formAction"),s!==null&&(_=s,z=null));var T=new zu("action","action",null,m,y);i.push({event:T,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(ki!==0){var G=z?M_(y,z):new FormData(y);Sh(c,{pending:!0,data:G,method:y.method,action:_},null,G)}}else typeof _=="function"&&(T.preventDefault(),G=z?M_(y,z):new FormData(y),Sh(c,{pending:!0,data:G,method:y.method,action:_},_,G))},currentTarget:y}]})}}for(var iv=0;iv<Bp.length;iv++){var sv=Bp[iv],HT=sv.toLowerCase(),QT=sv[0].toUpperCase()+sv.slice(1);Un(HT,"on"+QT)}Un(u0,"onAnimationEnd"),Un(d0,"onAnimationIteration"),Un(m0,"onAnimationStart"),Un("dblclick","onDoubleClick"),Un("focusin","onFocus"),Un("focusout","onBlur"),Un(oT,"onTransitionRun"),Un(cT,"onTransitionStart"),Un(uT,"onTransitionCancel"),Un(f0,"onTransitionEnd"),dl("onMouseEnter",["mouseout","mouseover"]),dl("onMouseLeave",["mouseout","mouseover"]),dl("onPointerEnter",["pointerout","pointerover"]),dl("onPointerLeave",["pointerout","pointerover"]),ss("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ss("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ss("onBeforeInput",["compositionend","keypress","textInput","paste"]),ss("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ss("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ss("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(sc));function P_(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var m=i[c],y=m.event;m=m.listeners;e:{var _=void 0;if(s)for(var z=m.length-1;0<=z;z--){var T=m[z],G=T.instance,ie=T.currentTarget;if(T=T.listener,G!==_&&y.isPropagationStopped())break e;_=T,y.currentTarget=ie;try{_(y)}catch(ge){Du(ge)}y.currentTarget=null,_=G}else for(z=0;z<m.length;z++){if(T=m[z],G=T.instance,ie=T.currentTarget,T=T.listener,G!==_&&y.isPropagationStopped())break e;_=T,y.currentTarget=ie;try{_(y)}catch(ge){Du(ge)}y.currentTarget=null,_=G}}}}function tt(i,s){var c=s[bp];c===void 0&&(c=s[bp]=new Set);var m=i+"__bubble";c.has(m)||(T_(s,i,2,!1),c.add(m))}function lv(i,s,c){var m=0;s&&(m|=4),T_(c,i,m,s)}var xd="_reactListening"+Math.random().toString(36).slice(2);function ov(i){if(!i[xd]){i[xd]=!0,Aj.forEach(function(c){c!=="selectionchange"&&(VT.has(c)||lv(c,!1,i),lv(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[xd]||(s[xd]=!0,lv("selectionchange",!1,s))}}function T_(i,s,c,m){switch(u1(s)){case 2:var y=jq;break;case 8:y=Nq;break;default:y=_v}c=y.bind(null,s,c,i),y=void 0,!Ap||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(y=!0),m?y!==void 0?i.addEventListener(s,c,{capture:!0,passive:y}):i.addEventListener(s,c,!0):y!==void 0?i.addEventListener(s,c,{passive:y}):i.addEventListener(s,c,!1)}function cv(i,s,c,m,y){var _=m;if((s&1)===0&&(s&2)===0&&m!==null)e:for(;;){if(m===null)return;var z=m.tag;if(z===3||z===4){var T=m.stateNode.containerInfo;if(T===y)break;if(z===4)for(z=m.return;z!==null;){var G=z.tag;if((G===3||G===4)&&z.stateNode.containerInfo===y)return;z=z.return}for(;T!==null;){if(z=ol(T),z===null)return;if(G=z.tag,G===5||G===6||G===26||G===27){m=_=z;continue e}T=T.parentNode}}m=m.return}$j(function(){var ie=_,ge=Cp(c),ye=[];e:{var le=p0.get(i);if(le!==void 0){var fe=zu,ke=i;switch(i){case"keypress":if(Eu(c)===0)break e;case"keydown":case"keyup":fe=$P;break;case"focusin":ke="focus",fe=Dp;break;case"focusout":ke="blur",fe=Dp;break;case"beforeblur":case"afterblur":fe=Dp;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=Fj;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=AP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=FP;break;case u0:case d0:case m0:fe=OP;break;case f0:fe=HP;break;case"scroll":case"scrollend":fe=CP;break;case"wheel":fe=VP;break;case"copy":case"cut":case"paste":fe=MP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=Hj;break;case"toggle":case"beforetoggle":fe=KP}var Ge=(s&4)!==0,jt=!Ge&&(i==="scroll"||i==="scrollend"),te=Ge?le!==null?le+"Capture":null:le;Ge=[];for(var Y=ie,ae;Y!==null;){var be=Y;if(ae=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||ae===null||te===null||(be=Ao(Y,te),be!=null&&Ge.push(lc(Y,be,ae))),jt)break;Y=Y.return}0<Ge.length&&(le=new fe(le,ke,null,c,ge),ye.push({event:le,listeners:Ge}))}}if((s&7)===0){e:{if(le=i==="mouseover"||i==="pointerover",fe=i==="mouseout"||i==="pointerout",le&&c!==wp&&(ke=c.relatedTarget||c.fromElement)&&(ol(ke)||ke[ll]))break e;if((fe||le)&&(le=ge.window===ge?ge:(le=ge.ownerDocument)?le.defaultView||le.parentWindow:window,fe?(ke=c.relatedTarget||c.toElement,fe=ie,ke=ke?ol(ke):null,ke!==null&&(jt=o(ke),Ge=ke.tag,ke!==jt||Ge!==5&&Ge!==27&&Ge!==6)&&(ke=null)):(fe=null,ke=ie),fe!==ke)){if(Ge=Fj,be="onMouseLeave",te="onMouseEnter",Y="mouse",(i==="pointerout"||i==="pointerover")&&(Ge=Hj,be="onPointerLeave",te="onPointerEnter",Y="pointer"),jt=fe==null?le:Eo(fe),ae=ke==null?le:Eo(ke),le=new Ge(be,Y+"leave",fe,c,ge),le.target=jt,le.relatedTarget=ae,be=null,ol(ge)===ie&&(Ge=new Ge(te,Y+"enter",ke,c,ge),Ge.target=ae,Ge.relatedTarget=jt,be=Ge),jt=be,fe&&ke)t:{for(Ge=YT,te=fe,Y=ke,ae=0,be=te;be;be=Ge(be))ae++;be=0;for(var Le=Y;Le;Le=Ge(Le))be++;for(;0<ae-be;)te=Ge(te),ae--;for(;0<be-ae;)Y=Ge(Y),be--;for(;ae--;){if(te===Y||Y!==null&&te===Y.alternate){Ge=te;break t}te=Ge(te),Y=Ge(Y)}Ge=null}else Ge=null;fe!==null&&q_(ye,le,fe,Ge,!1),ke!==null&&jt!==null&&q_(ye,jt,ke,Ge,!0)}}e:{if(le=ie?Eo(ie):window,fe=le.nodeName&&le.nodeName.toLowerCase(),fe==="select"||fe==="input"&&le.type==="file")var ct=Jj;else if(Xj(le))if(e0)ct=iT;else{ct=nT;var Te=rT}else fe=le.nodeName,!fe||fe.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?ie&&Sp(ie.elementType)&&(ct=Jj):ct=aT;if(ct&&(ct=ct(i,ie))){Zj(ye,ct,c,ge);break e}Te&&Te(i,le,ie),i==="focusout"&&ie&&le.type==="number"&&ie.memoizedProps.value!=null&&_p(le,"number",le.value)}switch(Te=ie?Eo(ie):window,i){case"focusin":(Xj(Te)||Te.contentEditable==="true")&&(gl=Te,Ip=ie,qo=null);break;case"focusout":qo=Ip=gl=null;break;case"mousedown":Lp=!0;break;case"contextmenu":case"mouseup":case"dragend":Lp=!1,o0(ye,c,ge);break;case"selectionchange":if(lT)break;case"keydown":case"keyup":o0(ye,c,ge)}var Ke;if(Pp)e:{switch(i){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else vl?Kj(i,c)&&(nt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(nt="onCompositionStart");nt&&(Qj&&c.locale!=="ko"&&(vl||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&vl&&(Ke=Bj()):(pi=ge,zp="value"in pi?pi.value:pi.textContent,vl=!0)),Te=bd(ie,nt),0<Te.length&&(nt=new Gj(nt,i,null,c,ge),ye.push({event:nt,listeners:Te}),Ke?nt.data=Ke:(Ke=Wj(c),Ke!==null&&(nt.data=Ke)))),(Ke=XP?ZP(i,c):JP(i,c))&&(nt=bd(ie,"onBeforeInput"),0<nt.length&&(Te=new Gj("onBeforeInput","beforeinput",null,c,ge),ye.push({event:Te,listeners:nt}),Te.data=Ke)),GT(ye,i,ie,c,ge)}P_(ye,s)})}function lc(i,s,c){return{instance:i,listener:s,currentTarget:c}}function bd(i,s){for(var c=s+"Capture",m=[];i!==null;){var y=i,_=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||_===null||(y=Ao(i,c),y!=null&&m.unshift(lc(i,y,_)),y=Ao(i,s),y!=null&&m.push(lc(i,y,_))),i.tag===3)return m;i=i.return}return[]}function YT(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function q_(i,s,c,m,y){for(var _=s._reactName,z=[];c!==null&&c!==m;){var T=c,G=T.alternate,ie=T.stateNode;if(T=T.tag,G!==null&&G===m)break;T!==5&&T!==26&&T!==27||ie===null||(G=ie,y?(ie=Ao(c,_),ie!=null&&z.unshift(lc(c,ie,G))):y||(ie=Ao(c,_),ie!=null&&z.push(lc(c,ie,G)))),c=c.return}z.length!==0&&i.push({event:s,listeners:z})}var KT=/\r\n?/g,WT=/\u0000|\uFFFD/g;function R_(i){return(typeof i=="string"?i:""+i).replace(KT,`
`).replace(WT,"")}function I_(i,s){return s=R_(s),R_(i)===s}function yt(i,s,c,m,y,_){switch(c){case"children":typeof m=="string"?s==="body"||s==="textarea"&&m===""||fl(i,m):(typeof m=="number"||typeof m=="bigint")&&s!=="body"&&fl(i,""+m);break;case"className":_u(i,"class",m);break;case"tabIndex":_u(i,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":_u(i,c,m);break;case"style":Ij(i,m,_);break;case"data":if(s!=="object"){_u(i,"data",m);break}case"src":case"href":if(m===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){i.removeAttribute(c);break}m=wu(""+m),i.setAttribute(c,m);break;case"action":case"formAction":if(typeof m=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(c==="formAction"?(s!=="input"&&yt(i,s,"name",y.name,y,null),yt(i,s,"formEncType",y.formEncType,y,null),yt(i,s,"formMethod",y.formMethod,y,null),yt(i,s,"formTarget",y.formTarget,y,null)):(yt(i,s,"encType",y.encType,y,null),yt(i,s,"method",y.method,y,null),yt(i,s,"target",y.target,y,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){i.removeAttribute(c);break}m=wu(""+m),i.setAttribute(c,m);break;case"onClick":m!=null&&(i.onclick=Sa);break;case"onScroll":m!=null&&tt("scroll",i);break;case"onScrollEnd":m!=null&&tt("scrollend",i);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(a(61));if(c=m.__html,c!=null){if(y.children!=null)throw Error(a(60));i.innerHTML=c}}break;case"multiple":i.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":i.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){i.removeAttribute("xlink:href");break}c=wu(""+m),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(c,""+m):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":m===!0?i.setAttribute(c,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(c,m):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?i.setAttribute(c,m):i.removeAttribute(c);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?i.removeAttribute(c):i.setAttribute(c,m);break;case"popover":tt("beforetoggle",i),tt("toggle",i),Nu(i,"popover",m);break;case"xlinkActuate":_a(i,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":_a(i,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":_a(i,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":_a(i,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":_a(i,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":_a(i,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":_a(i,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":_a(i,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":_a(i,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":Nu(i,"is",m);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=SP.get(c)||c,Nu(i,c,m))}}function uv(i,s,c,m,y,_){switch(c){case"style":Ij(i,m,_);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(a(61));if(c=m.__html,c!=null){if(y.children!=null)throw Error(a(60));i.innerHTML=c}}break;case"children":typeof m=="string"?fl(i,m):(typeof m=="number"||typeof m=="bigint")&&fl(i,""+m);break;case"onScroll":m!=null&&tt("scroll",i);break;case"onScrollEnd":m!=null&&tt("scrollend",i);break;case"onClick":m!=null&&(i.onclick=Sa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zj.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(y=c.endsWith("Capture"),s=c.slice(2,y?c.length-7:void 0),_=i[Hr]||null,_=_!=null?_[c]:null,typeof _=="function"&&i.removeEventListener(s,_,y),typeof m=="function")){typeof _!="function"&&_!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,m,y);break e}c in i?i[c]=m:m===!0?i.setAttribute(c,""):Nu(i,c,m)}}}function Sr(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":tt("error",i),tt("load",i);var m=!1,y=!1,_;for(_ in c)if(c.hasOwnProperty(_)){var z=c[_];if(z!=null)switch(_){case"src":m=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:yt(i,s,_,z,c,null)}}y&&yt(i,s,"srcSet",c.srcSet,c,null),m&&yt(i,s,"src",c.src,c,null);return;case"input":tt("invalid",i);var T=_=z=y=null,G=null,ie=null;for(m in c)if(c.hasOwnProperty(m)){var ge=c[m];if(ge!=null)switch(m){case"name":y=ge;break;case"type":z=ge;break;case"checked":G=ge;break;case"defaultChecked":ie=ge;break;case"value":_=ge;break;case"defaultValue":T=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(a(137,s));break;default:yt(i,s,m,ge,c,null)}}Pj(i,_,T,G,ie,z,y,!1);return;case"select":tt("invalid",i),m=z=_=null;for(y in c)if(c.hasOwnProperty(y)&&(T=c[y],T!=null))switch(y){case"value":_=T;break;case"defaultValue":z=T;break;case"multiple":m=T;default:yt(i,s,y,T,c,null)}s=_,c=z,i.multiple=!!m,s!=null?ml(i,!!m,s,!1):c!=null&&ml(i,!!m,c,!0);return;case"textarea":tt("invalid",i),_=y=m=null;for(z in c)if(c.hasOwnProperty(z)&&(T=c[z],T!=null))switch(z){case"value":m=T;break;case"defaultValue":y=T;break;case"children":_=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(a(91));break;default:yt(i,s,z,T,c,null)}qj(i,m,y,_);return;case"option":for(G in c)c.hasOwnProperty(G)&&(m=c[G],m!=null)&&(G==="selected"?i.selected=m&&typeof m!="function"&&typeof m!="symbol":yt(i,s,G,m,c,null));return;case"dialog":tt("beforetoggle",i),tt("toggle",i),tt("cancel",i),tt("close",i);break;case"iframe":case"object":tt("load",i);break;case"video":case"audio":for(m=0;m<sc.length;m++)tt(sc[m],i);break;case"image":tt("error",i),tt("load",i);break;case"details":tt("toggle",i);break;case"embed":case"source":case"link":tt("error",i),tt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in c)if(c.hasOwnProperty(ie)&&(m=c[ie],m!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:yt(i,s,ie,m,c,null)}return;default:if(Sp(s)){for(ge in c)c.hasOwnProperty(ge)&&(m=c[ge],m!==void 0&&uv(i,s,ge,m,c,void 0));return}}for(T in c)c.hasOwnProperty(T)&&(m=c[T],m!=null&&yt(i,s,T,m,c,null))}function XT(i,s,c,m){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,_=null,z=null,T=null,G=null,ie=null,ge=null;for(fe in c){var ye=c[fe];if(c.hasOwnProperty(fe)&&ye!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":G=ye;default:m.hasOwnProperty(fe)||yt(i,s,fe,null,m,ye)}}for(var le in m){var fe=m[le];if(ye=c[le],m.hasOwnProperty(le)&&(fe!=null||ye!=null))switch(le){case"type":_=fe;break;case"name":y=fe;break;case"checked":ie=fe;break;case"defaultChecked":ge=fe;break;case"value":z=fe;break;case"defaultValue":T=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(a(137,s));break;default:fe!==ye&&yt(i,s,le,fe,m,ye)}}Np(i,z,T,G,ie,ge,_,y);return;case"select":fe=z=T=le=null;for(_ in c)if(G=c[_],c.hasOwnProperty(_)&&G!=null)switch(_){case"value":break;case"multiple":fe=G;default:m.hasOwnProperty(_)||yt(i,s,_,null,m,G)}for(y in m)if(_=m[y],G=c[y],m.hasOwnProperty(y)&&(_!=null||G!=null))switch(y){case"value":le=_;break;case"defaultValue":T=_;break;case"multiple":z=_;default:_!==G&&yt(i,s,y,_,m,G)}s=T,c=z,m=fe,le!=null?ml(i,!!c,le,!1):!!m!=!!c&&(s!=null?ml(i,!!c,s,!0):ml(i,!!c,c?[]:"",!1));return;case"textarea":fe=le=null;for(T in c)if(y=c[T],c.hasOwnProperty(T)&&y!=null&&!m.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:yt(i,s,T,null,m,y)}for(z in m)if(y=m[z],_=c[z],m.hasOwnProperty(z)&&(y!=null||_!=null))switch(z){case"value":le=y;break;case"defaultValue":fe=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(a(91));break;default:y!==_&&yt(i,s,z,y,m,_)}Tj(i,le,fe);return;case"option":for(var ke in c)le=c[ke],c.hasOwnProperty(ke)&&le!=null&&!m.hasOwnProperty(ke)&&(ke==="selected"?i.selected=!1:yt(i,s,ke,null,m,le));for(G in m)le=m[G],fe=c[G],m.hasOwnProperty(G)&&le!==fe&&(le!=null||fe!=null)&&(G==="selected"?i.selected=le&&typeof le!="function"&&typeof le!="symbol":yt(i,s,G,le,m,fe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ge in c)le=c[Ge],c.hasOwnProperty(Ge)&&le!=null&&!m.hasOwnProperty(Ge)&&yt(i,s,Ge,null,m,le);for(ie in m)if(le=m[ie],fe=c[ie],m.hasOwnProperty(ie)&&le!==fe&&(le!=null||fe!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(a(137,s));break;default:yt(i,s,ie,le,m,fe)}return;default:if(Sp(s)){for(var jt in c)le=c[jt],c.hasOwnProperty(jt)&&le!==void 0&&!m.hasOwnProperty(jt)&&uv(i,s,jt,void 0,m,le);for(ge in m)le=m[ge],fe=c[ge],!m.hasOwnProperty(ge)||le===fe||le===void 0&&fe===void 0||uv(i,s,ge,le,m,fe);return}}for(var te in c)le=c[te],c.hasOwnProperty(te)&&le!=null&&!m.hasOwnProperty(te)&&yt(i,s,te,null,m,le);for(ye in m)le=m[ye],fe=c[ye],!m.hasOwnProperty(ye)||le===fe||le==null&&fe==null||yt(i,s,ye,le,m,fe)}function L_(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ZT(){if(typeof performance.getEntriesByType=="function"){for(var i=0,s=0,c=performance.getEntriesByType("resource"),m=0;m<c.length;m++){var y=c[m],_=y.transferSize,z=y.initiatorType,T=y.duration;if(_&&T&&L_(z)){for(z=0,T=y.responseEnd,m+=1;m<c.length;m++){var G=c[m],ie=G.startTime;if(ie>T)break;var ge=G.transferSize,ye=G.initiatorType;ge&&L_(ye)&&(G=G.responseEnd,z+=ge*(G<T?1:(T-ie)/(G-ie)))}if(--m,s+=8*(_+z)/(y.duration/1e3),i++,10<i)break}}if(0<i)return s/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var dv=null,mv=null;function yd(i){return i.nodeType===9?i:i.ownerDocument}function $_(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function B_(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function fv(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var pv=null;function JT(){var i=window.event;return i&&i.type==="popstate"?i===pv?!1:(pv=i,!0):(pv=null,!1)}var U_=typeof setTimeout=="function"?setTimeout:void 0,eq=typeof clearTimeout=="function"?clearTimeout:void 0,F_=typeof Promise=="function"?Promise:void 0,tq=typeof queueMicrotask=="function"?queueMicrotask:typeof F_<"u"?function(i){return F_.resolve(null).then(i).catch(rq)}:U_;function rq(i){setTimeout(function(){throw i})}function Oi(i){return i==="head"}function G_(i,s){var c=s,m=0;do{var y=c.nextSibling;if(i.removeChild(c),y&&y.nodeType===8)if(c=y.data,c==="/$"||c==="/&"){if(m===0){i.removeChild(y),Gl(s);return}m--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")m++;else if(c==="html")oc(i.ownerDocument.documentElement);else if(c==="head"){c=i.ownerDocument.head,oc(c);for(var _=c.firstChild;_;){var z=_.nextSibling,T=_.nodeName;_[Co]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&_.rel.toLowerCase()==="stylesheet"||c.removeChild(_),_=z}}else c==="body"&&oc(i.ownerDocument.body);c=y}while(c);Gl(s)}function H_(i,s){var c=i;i=0;do{var m=c.nextSibling;if(c.nodeType===1?s?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(s?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(i===0)break;i--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||i++;c=m}while(c)}function hv(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":hv(c),yp(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function nq(i,s,c,m){for(;i.nodeType===1;){var y=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!m&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(m){if(!i[Co])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(_=i.getAttribute("rel"),_==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(_!==y.rel||i.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||i.getAttribute("title")!==(y.title==null?null:y.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(_=i.getAttribute("src"),(_!==(y.src==null?null:y.src)||i.getAttribute("type")!==(y.type==null?null:y.type)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&_&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var _=y.name==null?null:""+y.name;if(y.type==="hidden"&&i.getAttribute("name")===_)return i}else return i;if(i=En(i.nextSibling),i===null)break}return null}function aq(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=En(i.nextSibling),i===null))return null;return i}function Q_(i,s){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!s||(i=En(i.nextSibling),i===null))return null;return i}function vv(i){return i.data==="$?"||i.data==="$~"}function gv(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function iq(i,s){var c=i.ownerDocument;if(i.data==="$~")i._reactRetry=s;else if(i.data!=="$?"||c.readyState!=="loading")s();else{var m=function(){s(),c.removeEventListener("DOMContentLoaded",m)};c.addEventListener("DOMContentLoaded",m),i._reactRetry=m}}function En(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return i}var xv=null;function V_(i){i=i.nextSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"||c==="/&"){if(s===0)return En(i.nextSibling);s--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||s++}i=i.nextSibling}return null}function Y_(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(s===0)return i;s--}else c!=="/$"&&c!=="/&"||s++}i=i.previousSibling}return null}function K_(i,s,c){switch(s=yd(c),i){case"html":if(i=s.documentElement,!i)throw Error(a(452));return i;case"head":if(i=s.head,!i)throw Error(a(453));return i;case"body":if(i=s.body,!i)throw Error(a(454));return i;default:throw Error(a(451))}}function oc(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);yp(i)}var An=new Map,W_=new Set;function jd(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var $a=F.d;F.d={f:sq,r:lq,D:oq,C:cq,L:uq,m:dq,X:fq,S:mq,M:pq};function sq(){var i=$a.f(),s=md();return i||s}function lq(i){var s=cl(i);s!==null&&s.tag===5&&s.type==="form"?fN(s):$a.r(i)}var Bl=typeof document>"u"?null:document;function X_(i,s,c){var m=Bl;if(m&&typeof s=="string"&&s){var y=yn(s);y='link[rel="'+i+'"][href="'+y+'"]',typeof c=="string"&&(y+='[crossorigin="'+c+'"]'),W_.has(y)||(W_.add(y),i={rel:i,crossOrigin:c,href:s},m.querySelector(y)===null&&(s=m.createElement("link"),Sr(s,"link",i),or(s),m.head.appendChild(s)))}}function oq(i){$a.D(i),X_("dns-prefetch",i,null)}function cq(i,s){$a.C(i,s),X_("preconnect",i,s)}function uq(i,s,c){$a.L(i,s,c);var m=Bl;if(m&&i&&s){var y='link[rel="preload"][as="'+yn(s)+'"]';s==="image"&&c&&c.imageSrcSet?(y+='[imagesrcset="'+yn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(y+='[imagesizes="'+yn(c.imageSizes)+'"]')):y+='[href="'+yn(i)+'"]';var _=y;switch(s){case"style":_=Ul(i);break;case"script":_=Fl(i)}An.has(_)||(i=v({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),An.set(_,i),m.querySelector(y)!==null||s==="style"&&m.querySelector(cc(_))||s==="script"&&m.querySelector(uc(_))||(s=m.createElement("link"),Sr(s,"link",i),or(s),m.head.appendChild(s)))}}function dq(i,s){$a.m(i,s);var c=Bl;if(c&&i){var m=s&&typeof s.as=="string"?s.as:"script",y='link[rel="modulepreload"][as="'+yn(m)+'"][href="'+yn(i)+'"]',_=y;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=Fl(i)}if(!An.has(_)&&(i=v({rel:"modulepreload",href:i},s),An.set(_,i),c.querySelector(y)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(uc(_)))return}m=c.createElement("link"),Sr(m,"link",i),or(m),c.head.appendChild(m)}}}function mq(i,s,c){$a.S(i,s,c);var m=Bl;if(m&&i){var y=ul(m).hoistableStyles,_=Ul(i);s=s||"default";var z=y.get(_);if(!z){var T={loading:0,preload:null};if(z=m.querySelector(cc(_)))T.loading=5;else{i=v({rel:"stylesheet",href:i,"data-precedence":s},c),(c=An.get(_))&&bv(i,c);var G=z=m.createElement("link");or(G),Sr(G,"link",i),G._p=new Promise(function(ie,ge){G.onload=ie,G.onerror=ge}),G.addEventListener("load",function(){T.loading|=1}),G.addEventListener("error",function(){T.loading|=2}),T.loading|=4,Nd(z,s,m)}z={type:"stylesheet",instance:z,count:1,state:T},y.set(_,z)}}}function fq(i,s){$a.X(i,s);var c=Bl;if(c&&i){var m=ul(c).hoistableScripts,y=Fl(i),_=m.get(y);_||(_=c.querySelector(uc(y)),_||(i=v({src:i,async:!0},s),(s=An.get(y))&&yv(i,s),_=c.createElement("script"),or(_),Sr(_,"link",i),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},m.set(y,_))}}function pq(i,s){$a.M(i,s);var c=Bl;if(c&&i){var m=ul(c).hoistableScripts,y=Fl(i),_=m.get(y);_||(_=c.querySelector(uc(y)),_||(i=v({src:i,async:!0,type:"module"},s),(s=An.get(y))&&yv(i,s),_=c.createElement("script"),or(_),Sr(_,"link",i),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},m.set(y,_))}}function Z_(i,s,c,m){var y=(y=H.current)?jd(y):null;if(!y)throw Error(a(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Ul(c.href),c=ul(y).hoistableStyles,m=c.get(s),m||(m={type:"style",instance:null,count:0,state:null},c.set(s,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Ul(c.href);var _=ul(y).hoistableStyles,z=_.get(i);if(z||(y=y.ownerDocument||y,z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(i,z),(_=y.querySelector(cc(i)))&&!_._p&&(z.instance=_,z.state.loading=5),An.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},An.set(i,c),_||hq(y,i,c,z.state))),s&&m===null)throw Error(a(528,""));return z}if(s&&m!==null)throw Error(a(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Fl(c),c=ul(y).hoistableScripts,m=c.get(s),m||(m={type:"script",instance:null,count:0,state:null},c.set(s,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,i))}}function Ul(i){return'href="'+yn(i)+'"'}function cc(i){return'link[rel="stylesheet"]['+i+"]"}function J_(i){return v({},i,{"data-precedence":i.precedence,precedence:null})}function hq(i,s,c,m){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?m.loading=1:(s=i.createElement("link"),m.preload=s,s.addEventListener("load",function(){return m.loading|=1}),s.addEventListener("error",function(){return m.loading|=2}),Sr(s,"link",c),or(s),i.head.appendChild(s))}function Fl(i){return'[src="'+yn(i)+'"]'}function uc(i){return"script[async]"+i}function e1(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var m=i.querySelector('style[data-href~="'+yn(c.href)+'"]');if(m)return s.instance=m,or(m),m;var y=v({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return m=(i.ownerDocument||i).createElement("style"),or(m),Sr(m,"style",y),Nd(m,c.precedence,i),s.instance=m;case"stylesheet":y=Ul(c.href);var _=i.querySelector(cc(y));if(_)return s.state.loading|=4,s.instance=_,or(_),_;m=J_(c),(y=An.get(y))&&bv(m,y),_=(i.ownerDocument||i).createElement("link"),or(_);var z=_;return z._p=new Promise(function(T,G){z.onload=T,z.onerror=G}),Sr(_,"link",m),s.state.loading|=4,Nd(_,c.precedence,i),s.instance=_;case"script":return _=Fl(c.src),(y=i.querySelector(uc(_)))?(s.instance=y,or(y),y):(m=c,(y=An.get(_))&&(m=v({},c),yv(m,y)),i=i.ownerDocument||i,y=i.createElement("script"),or(y),Sr(y,"link",m),i.head.appendChild(y),s.instance=y);case"void":return null;default:throw Error(a(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(m=s.instance,s.state.loading|=4,Nd(m,c.precedence,i));return s.instance}function Nd(i,s,c){for(var m=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=m.length?m[m.length-1]:null,_=y,z=0;z<m.length;z++){var T=m[z];if(T.dataset.precedence===s)_=T;else if(_!==y)break}_?_.parentNode.insertBefore(i,_.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function bv(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function yv(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var _d=null;function t1(i,s,c){if(_d===null){var m=new Map,y=_d=new Map;y.set(c,m)}else y=_d,m=y.get(c),m||(m=new Map,y.set(c,m));if(m.has(i))return m;for(m.set(i,null),c=c.getElementsByTagName(i),y=0;y<c.length;y++){var _=c[y];if(!(_[Co]||_[yr]||i==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var z=_.getAttribute(s)||"";z=i+z;var T=m.get(z);T?T.push(_):m.set(z,[_])}}return m}function r1(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function vq(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(i=s.disabled,typeof s.precedence=="string"&&i==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function n1(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function gq(i,s,c,m){if(c.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var y=Ul(m.href),_=s.querySelector(cc(y));if(_){s=_._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(i.count++,i=Sd.bind(i),s.then(i,i)),c.state.loading|=4,c.instance=_,or(_);return}_=s.ownerDocument||s,m=J_(m),(y=An.get(y))&&bv(m,y),_=_.createElement("link"),or(_);var z=_;z._p=new Promise(function(T,G){z.onload=T,z.onerror=G}),Sr(_,"link",m),c.instance=_}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(i.count++,c=Sd.bind(i),s.addEventListener("load",c),s.addEventListener("error",c))}}var jv=0;function xq(i,s){return i.stylesheets&&i.count===0&&Cd(i,i.stylesheets),0<i.count||0<i.imgCount?function(c){var m=setTimeout(function(){if(i.stylesheets&&Cd(i,i.stylesheets),i.unsuspend){var _=i.unsuspend;i.unsuspend=null,_()}},6e4+s);0<i.imgBytes&&jv===0&&(jv=62500*ZT());var y=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Cd(i,i.stylesheets),i.unsuspend)){var _=i.unsuspend;i.unsuspend=null,_()}},(i.imgBytes>jv?50:800)+s);return i.unsuspend=c,function(){i.unsuspend=null,clearTimeout(m),clearTimeout(y)}}:null}function Sd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Cd(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var wd=null;function Cd(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,wd=new Map,s.forEach(bq,i),wd=null,Sd.call(i))}function bq(i,s){if(!(s.state.loading&4)){var c=wd.get(i);if(c)var m=c.get(null);else{c=new Map,wd.set(i,c);for(var y=i.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<y.length;_++){var z=y[_];(z.nodeName==="LINK"||z.getAttribute("media")!=="not all")&&(c.set(z.dataset.precedence,z),m=z)}m&&c.set(null,m)}y=s.instance,z=y.getAttribute("data-precedence"),_=c.get(z)||m,_===m&&c.set(null,y),c.set(z,y),this.count++,m=Sd.bind(this),y.addEventListener("load",m),y.addEventListener("error",m),_?_.parentNode.insertBefore(y,_.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(y,i.firstChild)),s.state.loading|=4}}var dc={$$typeof:S,Provider:null,Consumer:null,_currentValue:R,_currentValue2:R,_threadCount:0};function yq(i,s,c,m,y,_,z,T,G){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=St(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=St(0),this.hiddenUpdates=St(null),this.identifierPrefix=m,this.onUncaughtError=y,this.onCaughtError=_,this.onRecoverableError=z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function a1(i,s,c,m,y,_,z,T,G,ie,ge,ye){return i=new yq(i,s,c,z,G,ie,ge,ye,T),s=1,_===!0&&(s|=24),_=ln(3,null,null,s),i.current=_,_.stateNode=i,s=eh(),s.refCount++,i.pooledCache=s,s.refCount++,_.memoizedState={element:m,isDehydrated:c,cache:s},ah(_),i}function i1(i){return i?(i=yl,i):yl}function s1(i,s,c,m,y,_){y=i1(y),m.context===null?m.context=y:m.pendingContext=y,m=yi(s),m.payload={element:c},_=_===void 0?null:_,_!==null&&(m.callback=_),c=ji(i,m,s),c!==null&&(Xr(c,i,s),Fo(c,i,s))}function l1(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function Nv(i,s){l1(i,s),(i=i.alternate)&&l1(i,s)}function o1(i){if(i.tag===13||i.tag===31){var s=us(i,67108864);s!==null&&Xr(s,i,67108864),Nv(i,67108864)}}function c1(i){if(i.tag===13||i.tag===31){var s=mn();s=gp(s);var c=us(i,s);c!==null&&Xr(c,i,s),Nv(i,s)}}var Ed=!0;function jq(i,s,c,m){var y=q.T;q.T=null;var _=F.p;try{F.p=2,_v(i,s,c,m)}finally{F.p=_,q.T=y}}function Nq(i,s,c,m){var y=q.T;q.T=null;var _=F.p;try{F.p=8,_v(i,s,c,m)}finally{F.p=_,q.T=y}}function _v(i,s,c,m){if(Ed){var y=Sv(m);if(y===null)cv(i,s,m,Ad,c),d1(i,m);else if(Sq(y,i,s,c,m))m.stopPropagation();else if(d1(i,m),s&4&&-1<_q.indexOf(i)){for(;y!==null;){var _=cl(y);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var z=Na(_.pendingLanes);if(z!==0){var T=_;for(T.pendingLanes|=2,T.entangledLanes|=2;z;){var G=1<<31-Xe(z);T.entanglements[1]|=G,z&=~G}la(_),(mt&6)===0&&(ud=Re()+500,ic(0))}}break;case 31:case 13:T=us(_,2),T!==null&&Xr(T,_,2),md(),Nv(_,2)}if(_=Sv(m),_===null&&cv(i,s,m,Ad,c),_===y)break;y=_}y!==null&&m.stopPropagation()}else cv(i,s,m,null,c)}}function Sv(i){return i=Cp(i),wv(i)}var Ad=null;function wv(i){if(Ad=null,i=ol(i),i!==null){var s=o(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=u(s),i!==null)return i;i=null}else if(c===31){if(i=d(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Ad=i,null}function u1(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(He()){case xt:return 2;case It:return 8;case tr:case Gr:return 32;case J:return 268435456;default:return 32}default:return 32}}var Cv=!1,Di=null,Mi=null,Pi=null,mc=new Map,fc=new Map,Ti=[],_q="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function d1(i,s){switch(i){case"focusin":case"focusout":Di=null;break;case"dragenter":case"dragleave":Mi=null;break;case"mouseover":case"mouseout":Pi=null;break;case"pointerover":case"pointerout":mc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":fc.delete(s.pointerId)}}function pc(i,s,c,m,y,_){return i===null||i.nativeEvent!==_?(i={blockedOn:s,domEventName:c,eventSystemFlags:m,nativeEvent:_,targetContainers:[y]},s!==null&&(s=cl(s),s!==null&&o1(s)),i):(i.eventSystemFlags|=m,s=i.targetContainers,y!==null&&s.indexOf(y)===-1&&s.push(y),i)}function Sq(i,s,c,m,y){switch(s){case"focusin":return Di=pc(Di,i,s,c,m,y),!0;case"dragenter":return Mi=pc(Mi,i,s,c,m,y),!0;case"mouseover":return Pi=pc(Pi,i,s,c,m,y),!0;case"pointerover":var _=y.pointerId;return mc.set(_,pc(mc.get(_)||null,i,s,c,m,y)),!0;case"gotpointercapture":return _=y.pointerId,fc.set(_,pc(fc.get(_)||null,i,s,c,m,y)),!0}return!1}function m1(i){var s=ol(i.target);if(s!==null){var c=o(s);if(c!==null){if(s=c.tag,s===13){if(s=u(c),s!==null){i.blockedOn=s,Cj(i.priority,function(){c1(c)});return}}else if(s===31){if(s=d(c),s!==null){i.blockedOn=s,Cj(i.priority,function(){c1(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function zd(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=Sv(i.nativeEvent);if(c===null){c=i.nativeEvent;var m=new c.constructor(c.type,c);wp=m,c.target.dispatchEvent(m),wp=null}else return s=cl(c),s!==null&&o1(s),i.blockedOn=c,!1;s.shift()}return!0}function f1(i,s,c){zd(i)&&c.delete(s)}function wq(){Cv=!1,Di!==null&&zd(Di)&&(Di=null),Mi!==null&&zd(Mi)&&(Mi=null),Pi!==null&&zd(Pi)&&(Pi=null),mc.forEach(f1),fc.forEach(f1)}function kd(i,s){i.blockedOn===s&&(i.blockedOn=null,Cv||(Cv=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,wq)))}var Od=null;function p1(i){Od!==i&&(Od=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Od===i&&(Od=null);for(var s=0;s<i.length;s+=3){var c=i[s],m=i[s+1],y=i[s+2];if(typeof m!="function"){if(wv(m||c)===null)continue;break}var _=cl(c);_!==null&&(i.splice(s,3),s-=3,Sh(_,{pending:!0,data:y,method:c.method,action:m},m,y))}}))}function Gl(i){function s(G){return kd(G,i)}Di!==null&&kd(Di,i),Mi!==null&&kd(Mi,i),Pi!==null&&kd(Pi,i),mc.forEach(s),fc.forEach(s);for(var c=0;c<Ti.length;c++){var m=Ti[c];m.blockedOn===i&&(m.blockedOn=null)}for(;0<Ti.length&&(c=Ti[0],c.blockedOn===null);)m1(c),c.blockedOn===null&&Ti.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(m=0;m<c.length;m+=3){var y=c[m],_=c[m+1],z=y[Hr]||null;if(typeof _=="function")z||p1(c);else if(z){var T=null;if(_&&_.hasAttribute("formAction")){if(y=_,z=_[Hr]||null)T=z.formAction;else if(wv(y)!==null)continue}else T=z.action;typeof T=="function"?c[m+1]=T:(c.splice(m,3),m-=3),p1(c)}}}function h1(){function i(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(z){return y=z})},focusReset:"manual",scroll:"manual"})}function s(){y!==null&&(y(),y=null),m||setTimeout(c,20)}function c(){if(!m&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,y=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(c,100),function(){m=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),y!==null&&(y(),y=null)}}}function Ev(i){this._internalRoot=i}Dd.prototype.render=Ev.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(a(409));var c=s.current,m=mn();s1(c,m,i,s,null,null)},Dd.prototype.unmount=Ev.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;s1(i.current,2,null,i,null,null),md(),s[ll]=null}};function Dd(i){this._internalRoot=i}Dd.prototype.unstable_scheduleHydration=function(i){if(i){var s=wj();i={blockedOn:null,target:i,priority:s};for(var c=0;c<Ti.length&&s!==0&&s<Ti[c].priority;c++);Ti.splice(c,0,i),c===0&&m1(i)}};var v1=t.version;if(v1!=="19.2.4")throw Error(a(527,v1,"19.2.4"));F.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=p(s),i=i!==null?h(i):null,i=i===null?null:i.stateNode,i};var Cq={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Md=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Md.isDisabled&&Md.supportsFiber)try{Z=Md.inject(Cq),ce=Md}catch{}}return vc.createRoot=function(i,s){if(!l(i))throw Error(a(299));var c=!1,m="",y=_N,_=SN,z=wN;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(m=s.identifierPrefix),s.onUncaughtError!==void 0&&(y=s.onUncaughtError),s.onCaughtError!==void 0&&(_=s.onCaughtError),s.onRecoverableError!==void 0&&(z=s.onRecoverableError)),s=a1(i,1,!1,null,null,c,m,null,y,_,z,h1),i[ll]=s.current,ov(i),new Ev(s)},vc.hydrateRoot=function(i,s,c){if(!l(i))throw Error(a(299));var m=!1,y="",_=_N,z=SN,T=wN,G=null;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onUncaughtError!==void 0&&(_=c.onUncaughtError),c.onCaughtError!==void 0&&(z=c.onCaughtError),c.onRecoverableError!==void 0&&(T=c.onRecoverableError),c.formState!==void 0&&(G=c.formState)),s=a1(i,1,!0,s,c??null,m,y,G,_,z,T,h1),s.context=i1(null),c=s.current,m=mn(),m=gp(m),y=yi(m),y.callback=null,ji(c,y,m),c=m,s.current.lanes=c,zr(s,c),la(s),i[ll]=s.current,ov(i),new Dd(s)},vc.version="19.2.4",vc}var w1;function E3(){if(w1)return Dv.exports;w1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Dv.exports=C3(),Dv.exports}var A3=E3();const z3=ni(A3),k3={apiKey:"AIzaSyDgk_1graNBFkIURTJnyLZTZ1nyxi7slUo",authDomain:"pedaclic.firebaseapp.com",projectId:"pedaclic",storageBucket:"pedaclic.firebasestorage.app",messagingSenderId:"863649621890",appId:"1:863649621890:web:6ab56a8c8db111e3a9119b"},qb=Mq(k3),Wl=Pq(qb),K=Tq(qb,{localCache:qq({tabManager:Iq()})}),Dr=Rq(qb),O3=Object.freeze(Object.defineProperty({__proto__:null,auth:Wl,db:K,storage:Dr},Symbol.toStringTag,{value:"Module"})),C1={"auth/email-already-in-use":"Cette adresse email est dj utilise.","auth/invalid-email":"Adresse email invalide.","auth/operation-not-allowed":"Opration non autorise.","auth/weak-password":"Le mot de passe doit contenir au moins 6 caractres.","auth/user-disabled":"Ce compte a t dsactiv.","auth/user-not-found":"Aucun compte associ  cette adresse email.","auth/wrong-password":"Mot de passe incorrect.","auth/too-many-requests":"Trop de tentatives. Veuillez ressayer plus tard.","auth/network-request-failed":"Erreur de connexion. Vrifiez votre connexion internet.",default:"Une erreur est survenue. Veuillez ressayer."},Tv=e=>C1[e]||C1.default,uA=g.createContext(null),D3=({children:e})=>{const[t,n]=g.useState(null),[a,l]=g.useState(!0),o=async x=>{try{const j=await Dt(Ne(K,"users",x));if(j.exists()){const N=j.data();return{uid:x,email:N.email,displayName:N.displayName,role:N.role,isPremium:N.isPremium||!1,subscriptionEnd:N.subscriptionEnd?.toDate()||null,subscriptionPlan:N.subscriptionPlan||void 0,coursChoisis:N.coursChoisis||[],photoURL:N.photoURL,createdAt:N.createdAt?.toDate()||new Date,lastLogin:N.lastLogin?.toDate()}}return null}catch(j){return console.error("Erreur lors de la rcupration des donnes utilisateur:",j),null}},u=async(x,j)=>{const N=Ne(K,"users",x.uid);(await Dt(N)).exists()?await Qe(N,{lastLogin:Ot()}):await gf(N,{email:x.email,displayName:x.displayName||j?.displayName||"",role:j?.role||"eleve",isPremium:!1,photoURL:x.photoURL,createdAt:Ot(),lastLogin:Ot()})},d=async(x,j)=>{try{const N=await Hq(Wl,x,j);await u(N.user)}catch(N){throw new Error(Tv(N.code))}},f=async x=>{try{if(x.password!==x.confirmPassword)throw new Error("Les mots de passe ne correspondent pas.");const j=await Bq(Wl,x.email,x.password);await Uq(j.user,{displayName:x.displayName}),await u(j.user,{displayName:x.displayName,role:x.role})}catch(j){throw j.message?j:new Error(Tv(j.code))}},p=async x=>{try{const j=new Fq;j.setCustomParameters({prompt:"select_account"});const N=await Gq(Wl,j);await u(N.user,{role:x??"eleve"})}catch(j){throw new Error(Tv(j.code))}},h=async()=>{try{await $q(Wl),n(null)}catch{throw new Error("Erreur lors de la dconnexion.")}},v=async x=>{if(!t)throw new Error("Aucun utilisateur connect.");try{const j=Ne(K,"users",t.uid);await Qe(j,{...x,updatedAt:Ot()}),n(N=>N?{...N,...x}:null)}catch{throw new Error("Erreur lors de la mise  jour du profil.")}};g.useEffect(()=>{const x=Lq(Wl,async j=>{if(j){const N=await o(j.uid);n(N)}else n(null);l(!1)});return()=>x()},[]);const b={currentUser:t,loading:a,login:d,loginWithGoogle:p,register:f,logout:h,updateProfile:v};return r.jsx(uA.Provider,{value:b,children:a?r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement..."})]}):e})},Ze=()=>{const e=g.useContext(uA);if(!e)throw new Error("useAuth doit tre utilis  l'intrieur d'un AuthProvider");return e},eo=({children:e,allowedRoles:t,requirePremium:n=!1})=>{const{currentUser:a,loading:l}=Ze();return l?r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Vrification des autorisations..."})]}):a?t&&!t.includes(a.role)?r.jsxs("div",{className:"error-container",children:[r.jsx("h2",{children:"Accs non autoris"}),r.jsx("p",{children:"Vous n'avez pas les permissions ncessaires pour accder  cette page."}),r.jsx("a",{href:"/",className:"btn btn-primary",children:"Retour  l'accueil"})]}):n&&!a.isPremium?r.jsxs("div",{className:"error-container premium-required",children:[r.jsx("h2",{children:"Contenu Premium"}),r.jsx("p",{children:"Cette ressource est rserve aux abonns Premium."}),r.jsxs("div",{className:"premium-cta",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Ds 10 000 FCFA / 3 mois"}),"  Accs illimit"]}),r.jsx("a",{href:"/premium",className:"btn btn-premium",children:"Devenir Premium"})]})]}):r.jsx(r.Fragment,{children:e}):r.jsxs("div",{className:"error-container",children:[r.jsx("h2",{children:"Accs refus"}),r.jsx("p",{children:"Vous devez tre connect pour accder  cette page."}),r.jsx("a",{href:"/connexion",className:"btn btn-primary",children:"Se connecter"})]})},qr=({children:e})=>r.jsx(eo,{allowedRoles:["admin"],children:e}),Hn=({children:e})=>r.jsx(eo,{allowedRoles:["admin","prof"],children:e}),M3="http://localhost:3001",ja="notifications";function dA(e,t){return{id:e,destinataireId:t.destinataireId,destinataireRole:t.destinataireRole,type:t.type,titre:t.titre,message:t.message,lienAction:t.lienAction,labelAction:t.labelAction,emetteurId:t.emetteurId,emetteurNom:t.emetteurNom,entiteId:t.entiteId,entiteType:t.entiteType,statut:t.statut,canal:t.canal,emailEnvoye:t.emailEnvoye,emailErreur:t.emailErreur,createdAt:t.createdAt?.toDate()??new Date,luAt:t.luAt?.toDate()??void 0}}async function P3(e){return(await qt(je(K,ja),{destinataireId:e.destinataireId,destinataireRole:e.destinataireRole,type:e.type,titre:e.titre,message:e.message,lienAction:e.lienAction??null,labelAction:e.labelAction??null,emetteurId:e.emetteurId??null,emetteurNom:e.emetteurNom??null,entiteId:e.entiteId??null,entiteType:e.entiteType??null,statut:"non_lue",canal:e.canal,emailEnvoye:!1,createdAt:Oe.now()})).id}async function T3(e){try{const t=await fetch(`${M3}/api/notifications/send-email`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const a=await t.text();return{success:!1,error:`HTTP ${t.status}: ${a}`}}return await t.json()}catch(t){return{success:!1,error:t instanceof Error?t.message:"Erreur rseau inconnue"}}}async function q3(e){const t=await P3(e);let n=!1,a;if((e.canal==="email"||e.canal==="les_deux")&&e.emailDestinataire){const l=await T3({to:e.emailDestinataire,toName:e.emailDestinatairNom,type:e.type,titre:e.titre,message:e.message,lienAction:e.lienAction,labelAction:e.labelAction,emetteurNom:e.emetteurNom});n=l.success,a=l.error,await Qe(Ne(K,ja,t),{emailEnvoye:n,emailErreur:a??null})}return{notifId:t,emailEnvoye:n,emailErreur:a}}async function R3(e,t){const n=Ee(je(K,"inscriptions_groupe"),Se("groupeId","==",e),Se("statut","==","actif")),a=await Ce(n);let l=0;const o=Mn(K);return a.docs.forEach(u=>{const d=u.data().eleveId,f=Ne(je(K,ja));o.set(f,{destinataireId:d,destinataireRole:"eleve",type:t.type,titre:t.titre,message:t.message,lienAction:t.lienAction??null,labelAction:t.labelAction??null,emetteurId:t.emetteurId??null,emetteurNom:t.emetteurNom??null,entiteId:t.entiteId??null,entiteType:t.entiteType??null,statut:"non_lue",canal:t.canal,emailEnvoye:!1,createdAt:Oe.now()}),l++}),await o.commit(),l}async function I3(e,t){const n=e==="tous"?Ee(je(K,"users"),ar(500)):Ee(je(K,"users"),Se("role","==",e),ar(500)),a=await Ce(n);let l=0;const o=Mn(K);return a.docs.forEach(u=>{const d=u.data(),f=Ne(je(K,ja));o.set(f,{destinataireId:u.id,destinataireRole:d.role??e,type:t.type,titre:t.titre,message:t.message,lienAction:t.lienAction??null,labelAction:t.labelAction??null,emetteurId:t.emetteurId??null,emetteurNom:t.emetteurNom??null,entiteId:t.entiteId??null,entiteType:t.entiteType??null,statut:"non_lue",canal:t.canal,emailEnvoye:!1,createdAt:Oe.now()}),l++}),await o.commit(),l}async function L3(e,t={}){const{includeArchived:n=!1,limitCount:a=50}=t,l=[Se("destinataireId","==",e),Ve("createdAt","desc"),ar(a)];n||l.splice(1,0,Se("statut","!=","archivee"));const o=Ee(je(K,ja),...l);return(await Ce(o)).docs.map(d=>dA(d.id,d.data()))}function $3(e,t){const n=Ee(je(K,ja),Se("destinataireId","==",e),Se("statut","==","non_lue"),Ve("createdAt","desc"),ar(20));return xf(n,a=>{const l=a.docs.map(o=>dA(o.id,o.data()));t(l)})}async function wx(e){await Qe(Ne(K,ja,e),{statut:"lue",luAt:Oe.now()})}async function mA(e){const t=Ee(je(K,ja),Se("destinataireId","==",e),Se("statut","==","non_lue")),n=await Ce(t),a=Mn(K);n.docs.forEach(l=>{a.update(l.ref,{statut:"lue",luAt:Oe.now()})}),await a.commit()}async function B3(e){await Qe(Ne(K,ja,e),{statut:"archivee"})}async function U3(e){await rn(Ne(K,ja,e))}const pm={nouveau_cours:{titreDefaut:"Nouveau cours disponible",messageDefaut:"Un nouveau cours vient d'tre publi dans votre matire.",icone:"",couleur:"#2563eb"},resultat_quiz:{titreDefaut:"Rsultat de votre quiz",messageDefaut:"Votre rsultat au quiz est disponible.",icone:"",couleur:"#10b981"},rappel_echeance:{titreDefaut:"Rappel d'chance",messageDefaut:"N'oubliez pas votre examen approche.",icone:"",couleur:"#f59e0b"},message_prof:{titreDefaut:"Message de votre professeur",messageDefaut:"",icone:"",couleur:"#8b5cf6"},annonce:{titreDefaut:"Annonce importante",messageDefaut:"",icone:"",couleur:"#ef4444"},nouveau_abonnement:{titreDefaut:"Abonnement Premium activ ",messageDefaut:"Votre abonnement Premium PedaClic est maintenant actif. Profitez de tous les contenus !",icone:"",couleur:"#f59e0b"},bienvenue:{titreDefaut:"Bienvenue sur PedaClic !",messageDefaut:"Bienvenue sur PedaClic, la plateforme ducative sngalaise. Commencez votre apprentissage ds maintenant !",icone:"",couleur:"#10b981"}},Rb={nouveau_cours:" Nouveau cours",resultat_quiz:" Rsultat quiz",rappel_echeance:" Rappel chance",message_prof:" Message prof",annonce:" Annonce",nouveau_abonnement:" Abonnement",bienvenue:" Bienvenue"},F3={eleve:" lves",parent:" Parents",prof:" Professeurs",admin:" Admins",tous:" Tous les utilisateurs"};function G3(e){const n=new Date().getTime()-e.getTime(),a=Math.floor(n/6e4),l=Math.floor(a/60),o=Math.floor(l/24);return a<1?" l'instant":a<60?`Il y a ${a} min`:l<24?`Il y a ${l}h`:o===1?"Hier":o<7?`Il y a ${o} jours`:e.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})}const H3=()=>{const{currentUser:e}=Ze(),t=lt(),[n,a]=g.useState([]),[l,o]=g.useState(!1),[u,d]=g.useState(!1),f=g.useRef(null);g.useEffect(()=>{if(!e)return;const x=$3(e.uid,j=>a(j));return()=>x()},[e]),g.useEffect(()=>{function x(j){f.current&&!f.current.contains(j.target)&&o(!1)}return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const p=n.length,h=g.useCallback(async x=>{await wx(x.id),o(!1),x.lienAction&&t(x.lienAction)},[t]),v=g.useCallback(async()=>{if(!(!e||u)){d(!0);try{await mA(e.uid)}finally{d(!1)}}},[e,u]),b=()=>{o(!1),t("/notifications")};return e?r.jsxs("div",{className:"notif-bell",ref:f,children:[r.jsxs("button",{className:"notif-bell__btn",onClick:()=>o(x=>!x),"aria-label":`Notifications${p>0?`  ${p} non lues`:""}`,"aria-expanded":l,"aria-haspopup":"true",children:[r.jsx("span",{className:"notif-bell__icon","aria-hidden":"true",children:""}),p>0&&r.jsx("span",{className:"notif-bell__badge","aria-hidden":"true",children:p>99?"99+":p})]}),l&&r.jsxs("div",{className:"notif-bell__dropdown",role:"dialog","aria-label":"Notifications rcentes",children:[r.jsxs("div",{className:"notif-bell__dropdown-header",children:[r.jsxs("h3",{className:"notif-bell__dropdown-title",children:[" Notifications",p>0&&r.jsxs("span",{className:"notif-bell__dropdown-count",children:[p," nouvelles"]})]}),p>0&&r.jsx("button",{className:"notif-bell__mark-all-btn",onClick:v,disabled:u,children:u?"":"Tout lire"})]}),r.jsx("div",{className:"notif-bell__list",children:n.length===0?r.jsxs("div",{className:"notif-bell__empty",children:[r.jsx("span",{className:"notif-bell__empty-icon",children:""}),r.jsx("p",{children:"Tout est  jour !"})]}):n.slice(0,5).map(x=>{const j=pm[x.type];return r.jsxs("button",{className:`notif-bell__item ${x.statut==="non_lue"?"notif-bell__item--unread":""}`,onClick:()=>h(x),children:[r.jsx("span",{className:"notif-bell__item-icon",style:{background:j.couleur+"20",color:j.couleur},"aria-hidden":"true",children:j.icone}),r.jsxs("div",{className:"notif-bell__item-content",children:[r.jsx("p",{className:"notif-bell__item-titre",children:x.titre}),r.jsx("p",{className:"notif-bell__item-message",children:x.message}),r.jsx("p",{className:"notif-bell__item-date",children:G3(x.createdAt)})]}),x.statut==="non_lue"&&r.jsx("span",{className:"notif-bell__item-dot","aria-hidden":"true"})]},x.id)})}),r.jsx("div",{className:"notif-bell__dropdown-footer",children:r.jsx("button",{className:"notif-bell__see-all-btn",onClick:b,children:"Voir toutes les notifications "})})]})]}):null},Q3=()=>{const{currentUser:e,logout:t,loading:n}=Ze(),a=lt(),l=Ob(),[o,u]=g.useState(!1),[d,f]=g.useState(!1),[p,h]=g.useState(!1),[v,b]=g.useState(null),x=g.useRef(null),j=[{path:"/",label:"Accueil",icon:r.jsx(jx,{size:18})},{path:"/disciplines",label:"Disciplines",icon:r.jsx(vn,{size:18})},{path:"/ebooks",label:"Bibliothque",icon:r.jsx(vn,{size:18})},{path:"/quiz-gratuits",label:"Quiz",icon:r.jsx(Ps,{size:18}),requireAuth:!1},{path:"/quizzes",label:"Quiz Avancs",icon:r.jsx(Ps,{size:18}),requireAuth:!0,requirePremium:!0},{path:"/premium",label:"Premium",icon:r.jsx(Zr,{size:18}),hideIfPremium:!0},{path:e?.role==="eleve"?"/eleve/dashboard":e?.role==="prof"?"/prof/dashboard":"/admin",label:"Tableau de bord",icon:r.jsx(g1,{size:18}),requireAuth:!0},{path:"/generateur",label:"Gnrateur IA",icon:r.jsx(Vq,{size:18}),requireAuth:!0,requirePremium:!0},{path:"/parent/dashboard",label:"Espace Parent",icon:r.jsx(Ts,{size:18}),requireAuth:!0,requireRole:["parent"]}];g.useEffect(()=>{const M=D=>{x.current&&!x.current.contains(D.target)&&f(!1)};return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[]),g.useEffect(()=>{const M=$=>{$.preventDefault(),b($)},D=()=>b(null);return window.addEventListener("beforeinstallprompt",M),window.addEventListener("appinstalled",D),()=>{window.removeEventListener("beforeinstallprompt",M),window.removeEventListener("appinstalled",D)}},[]);const N=g.useCallback(async()=>{if(!v)return;await v.prompt();const{outcome:M}=await v.userChoice;M==="accepted"&&b(null)},[v]);g.useEffect(()=>{u(!1),f(!1)},[l.pathname]),g.useEffect(()=>(o?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[o]);const w=async()=>{try{h(!0),await t(),f(!1),a("/")}catch(M){console.error("Erreur lors de la dconnexion:",M)}finally{h(!1)}},C=()=>{u(!o)},E=()=>{f(!d)},S=M=>!(M.requireAuth&&!e||M.requirePremium&&e&&!e.isPremium||M.hideIfPremium&&(e?.isPremium||e?.role==="admin")||M.requireRole&&e&&!M.requireRole.includes(e.role)),A=M=>M==="/"?l.pathname==="/":l.pathname.startsWith(M),O=M=>({admin:"Administrateur",prof:"Professeur",eleve:"lve",parent:"Parent"})[M]||M,k=()=>e?e.displayName?e.displayName.split(" ").map(D=>D[0]).join("").toUpperCase().slice(0,2):e.email[0].toUpperCase():"?";return r.jsxs("header",{className:"header",children:[r.jsxs("div",{className:"header__container",children:[r.jsxs(Fe,{to:"/",className:"header__logo",children:[r.jsx(Ps,{className:"header__logo-icon",size:32}),r.jsxs("div",{className:"header__logo-text",children:[r.jsx("span",{className:"header__logo-name",children:"PedaClic"}),r.jsx("span",{className:"header__logo-tagline",children:"L'cole en un clic"})]})]}),r.jsx("nav",{className:"header__nav header__nav--desktop",children:r.jsx("ul",{className:"header__nav-list",children:j.map(M=>S(M)&&r.jsx("li",{className:"header__nav-item",children:r.jsxs(Fe,{to:M.path,className:`header__nav-link ${A(M.path)?"header__nav-link--active":""} ${M.hideIfPremium?"header__nav-link--premium-cta":""}`,children:[M.icon,r.jsx("span",{children:M.label}),M.requirePremium&&r.jsx(Ac,{size:14,className:"header__premium-badge"})]})},M.path))})}),r.jsxs("div",{className:"header__actions",children:[v&&r.jsxs("button",{className:"header__install-btn",onClick:N,title:"Installer PedaClic sur cet appareil",children:[r.jsx(sA,{size:16}),r.jsx("span",{children:"Installer"})]}),n?r.jsx("div",{className:"header__loading",children:r.jsx("div",{className:"header__spinner"})}):e?r.jsxs(r.Fragment,{children:[r.jsx(H3,{}),r.jsxs("div",{className:"header__user",ref:x,children:[e.isPremium&&r.jsxs("span",{className:"header__premium-tag",children:[r.jsx(Ac,{size:14}),"Premium"]}),r.jsxs("button",{className:"header__user-button",onClick:E,"aria-expanded":d,"aria-haspopup":"true",children:[r.jsx("div",{className:"header__avatar",children:e.photoURL?r.jsx("img",{src:e.photoURL,alt:e.displayName||"Avatar",className:"header__avatar-img"}):r.jsx("span",{className:"header__avatar-initials",children:k()})}),r.jsx("span",{className:"header__user-name",children:e.displayName||e.email.split("@")[0]}),r.jsx(mm,{size:16,className:`header__chevron ${d?"header__chevron--open":""}`})]}),d&&r.jsxs("div",{className:"header__dropdown",children:[r.jsxs("div",{className:"header__dropdown-header",children:[r.jsx("p",{className:"header__dropdown-email",children:e.email}),r.jsx("span",{className:`header__dropdown-role header__dropdown-role--${e.role}`,children:O(e.role)})]}),r.jsx("div",{className:"header__dropdown-divider"}),r.jsxs("nav",{className:"header__dropdown-nav",children:[r.jsxs(Fe,{to:e.role==="eleve"?"/eleve/dashboard":e.role==="prof"?"/prof/dashboard":"/admin",className:"header__dropdown-link",children:[r.jsx(g1,{size:18}),r.jsx("span",{children:"Tableau de bord"})]}),e.role==="eleve"&&r.jsxs(Fe,{to:"/eleve/suivi",className:"header__dropdown-link",children:[r.jsx(Ts,{size:18}),r.jsx("span",{children:"Mes points  amliorer"})]}),e.role==="parent"&&r.jsxs(Fe,{to:"/parent/dashboard",className:"header__dropdown-link",children:[r.jsx(Ts,{size:18}),r.jsx("span",{children:"Espace Parent"})]}),r.jsxs(Fe,{to:"/profil",className:"header__dropdown-link",children:[r.jsx(Yq,{size:18}),r.jsx("span",{children:"Mon profil"})]}),e.role==="admin"&&r.jsxs(Fe,{to:"/admin",className:"header__dropdown-link",children:[r.jsx(Kq,{size:18}),r.jsx("span",{children:"Administration"})]}),!e.isPremium&&r.jsxs(Fe,{to:"/premium",className:"header__dropdown-link header__dropdown-link--premium",children:[r.jsx(Ac,{size:18}),r.jsx("span",{children:"Passer Premium"})]})]}),r.jsx("div",{className:"header__dropdown-divider"}),r.jsxs("button",{className:"header__dropdown-logout",onClick:w,disabled:p,children:[r.jsx(x1,{size:18}),r.jsx("span",{children:p?"Dconnexion...":"Se dconnecter"})]})]})]})]}):r.jsxs("div",{className:"header__auth-buttons",children:[r.jsx(Fe,{to:"/connexion",className:"header__btn header__btn--outline",children:"Connexion"}),r.jsx(Fe,{to:"/inscription",className:"header__btn header__btn--primary",children:"S'inscrire"})]}),r.jsx("button",{className:"header__mobile-toggle",onClick:C,"aria-label":o?"Fermer le menu":"Ouvrir le menu","aria-expanded":o,children:o?r.jsx(Gi,{size:24}):r.jsx(Wq,{size:24})})]})]}),r.jsxs("div",{className:`header__mobile-menu ${o?"header__mobile-menu--open":""}`,children:[r.jsx("div",{className:"header__mobile-overlay",onClick:()=>u(!1)}),r.jsxs("div",{className:"header__mobile-content",children:[r.jsx("nav",{className:"header__mobile-nav",children:r.jsx("ul",{className:"header__mobile-list",children:j.map(M=>S(M)&&r.jsx("li",{className:"header__mobile-item",children:r.jsxs(Fe,{to:M.path,className:`header__mobile-link ${A(M.path)?"header__mobile-link--active":""} ${M.hideIfPremium?"header__mobile-link--premium-cta":""}`,children:[M.icon,r.jsx("span",{children:M.label}),M.requirePremium&&r.jsx(Ac,{size:14,className:"header__premium-badge"})]})},M.path))})}),!e&&r.jsxs("div",{className:"header__mobile-auth",children:[r.jsx(Fe,{to:"/connexion",className:"header__btn header__btn--outline header__btn--block",children:"Connexion"}),r.jsx(Fe,{to:"/inscription",className:"header__btn header__btn--primary header__btn--block",children:"S'inscrire"})]}),e&&r.jsxs("div",{className:"header__mobile-user",children:[r.jsxs("div",{className:"header__mobile-user-info",children:[r.jsx("div",{className:"header__avatar header__avatar--large",children:e.photoURL?r.jsx("img",{src:e.photoURL,alt:e.displayName||"Avatar",className:"header__avatar-img"}):r.jsx("span",{className:"header__avatar-initials",children:k()})}),r.jsxs("div",{className:"header__mobile-user-details",children:[r.jsx("p",{className:"header__mobile-user-name",children:e.displayName||e.email.split("@")[0]}),r.jsx("p",{className:"header__mobile-user-email",children:e.email})]})]}),r.jsxs("button",{className:"header__mobile-logout",onClick:w,disabled:p,children:[r.jsx(x1,{size:18}),r.jsx("span",{children:p?"Dconnexion...":"Se dconnecter"})]})]})]})]})]})},V3=()=>{const e=new Date().getFullYear(),{currentUser:t}=Ze(),a=[{label:"Accueil",path:"/"},{label:"Disciplines",path:"/disciplines"},{label:"Quiz Avancs",path:"/quizzes"},{label:"Tarifs",path:"/premium"},{label:"Tableau de bord",path:(()=>{if(!t)return"/connexion";switch(t.role){case"eleve":return"/eleve/dashboard";case"prof":return"/prof/dashboard";case"parent":return"/parent/dashboard";case"admin":return"/admin";default:return"/connexion"}})()}],l=[{label:"Cours en ligne",path:"/cours",badge:"Nouveau",icon:r.jsx(r3,{size:14})},{label:"Exercices corrigs",path:"/disciplines"},{label:"Annales examens",path:"/disciplines"},{label:"Fiches de rvision",path:"/disciplines"}],o=[{name:"Facebook",url:"https://facebook.com/pedaclic",icon:r.jsx(n3,{size:20})},{name:"Twitter",url:"https://twitter.com/pedaclic",icon:r.jsx(a3,{size:20})},{name:"Instagram",url:"https://instagram.com/pedaclic",icon:r.jsx(i3,{size:20})},{name:"LinkedIn",url:"https://linkedin.com/company/pedaclic",icon:r.jsx(s3,{size:20})},{name:"YouTube",url:"https://youtube.com/@pedaclic",icon:r.jsx(l3,{size:20})}];return r.jsxs("footer",{className:"footer",children:[r.jsx("div",{className:"footer__main",children:r.jsxs("div",{className:"footer__container",children:[r.jsxs("div",{className:"footer__column footer__column--about",children:[r.jsxs(Fe,{to:"/",className:"footer__logo",children:[r.jsx(Ps,{className:"footer__logo-icon",size:36}),r.jsxs("div",{className:"footer__logo-text",children:[r.jsx("span",{className:"footer__logo-name",children:"PedaClic"}),r.jsx("span",{className:"footer__logo-tagline",children:"L'cole en un clic"})]})]}),r.jsx("p",{className:"footer__description",children:"PedaClic est la plateforme ducative de rfrence au Sngal. Nous accompagnons les lves du collge au lyce avec des cours, exercices et quiz de qualit."}),r.jsxs("div",{className:"footer__stats",children:[r.jsxs("div",{className:"footer__stat",children:[r.jsx(vn,{size:18}),r.jsx("span",{children:"500+ cours"})]}),r.jsxs("div",{className:"footer__stat",children:[r.jsx(nm,{size:18}),r.jsx("span",{children:"10 000+ lves"})]})]})]}),r.jsxs("div",{className:"footer__column",children:[r.jsxs("h3",{className:"footer__title",children:[r.jsx("span",{className:"footer__title-icon",children:""}),"Plateforme"]}),r.jsx("nav",{className:"footer__nav",children:r.jsx("ul",{className:"footer__list",children:a.map((u,d)=>r.jsx("li",{className:"footer__item",children:r.jsx(Fe,{to:u.path,className:"footer__link",children:u.label})},d))})})]}),r.jsxs("div",{className:"footer__column",children:[r.jsxs("h3",{className:"footer__title",children:[r.jsx("span",{className:"footer__title-icon",children:""}),"Ressources"]}),r.jsx("nav",{className:"footer__nav",children:r.jsx("ul",{className:"footer__list",children:l.map((u,d)=>r.jsx("li",{className:"footer__item",children:r.jsxs(Fe,{to:u.path,className:`footer__link${u.badge?" footer__link--new":""}`,children:[u.icon&&r.jsx("span",{className:"footer__link-icon",children:u.icon}),u.label,u.badge&&r.jsx("span",{className:"footer__badge",children:u.badge})]})},d))})})]}),r.jsxs("div",{className:"footer__column",children:[r.jsxs("h3",{className:"footer__title",children:[r.jsx("span",{className:"footer__title-icon",children:""}),"Contact"]}),r.jsxs("div",{className:"footer__contact",children:[r.jsxs("a",{href:"mailto:contact@pedaclic.sn",className:"footer__contact-item",children:[r.jsx(Xq,{size:16,className:"footer__contact-icon"}),r.jsx("span",{children:"contact@pedaclic.sn"})]}),r.jsxs("a",{href:"tel:+221770000000",className:"footer__contact-item",children:[r.jsx(Zq,{size:16,className:"footer__contact-icon"}),r.jsx("span",{children:"+221 77 000 00 00"})]}),r.jsxs("div",{className:"footer__contact-item",children:[r.jsx(Jq,{size:16,className:"footer__contact-icon"}),r.jsx("span",{children:"Dakar, Sngal"})]})]}),r.jsxs("div",{className:"footer__social",children:[r.jsx("h4",{className:"footer__social-title",children:"Suivez-nous"}),r.jsx("div",{className:"footer__social-links",children:o.map((u,d)=>r.jsx("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",className:"footer__social-link",title:u.name,children:u.icon},d))})]})]})]})}),r.jsx("div",{className:"footer__bottom",children:r.jsxs("div",{className:"footer__container footer__bottom-content",children:[r.jsxs("p",{className:"footer__copyright",children:[" ",e," PedaClic. Tous droits rservs."]}),r.jsxs("p",{className:"footer__made-with",children:["Fait avec ",r.jsx(e3,{size:14,className:"footer__heart"})," au Sngal "]}),r.jsxs("nav",{className:"footer__legal",children:[r.jsxs(Fe,{to:"/mentions-legales",className:"footer__legal-link",children:[r.jsx(t3,{size:14})," Mentions lgales"]}),r.jsxs(Fe,{to:"/confidentialite",className:"footer__legal-link",children:[r.jsx(Pb,{size:14})," Confidentialit"]}),r.jsxs(Fe,{to:"/aide",className:"footer__legal-link",children:[r.jsx(am,{size:14})," Aide"]})]})]})})]})},ft=({children:e,hideHeader:t=!1,hideFooter:n=!1,className:a=""})=>r.jsxs("div",{className:"layout",children:[!t&&r.jsx(Q3,{}),r.jsx("main",{className:`layout__main ${t?"":"layout__main--with-header"} ${a}`,children:e}),!n&&r.jsx(V3,{})]}),Y3=()=>{const{currentUser:e}=Ze();return r.jsxs("div",{className:"home-page",children:[r.jsxs("section",{className:"home-page__hero",children:[r.jsxs("div",{className:"home-page__hero-content",children:[r.jsxs("div",{className:"home-page__hero-badge",children:[r.jsx(Zr,{size:14}),r.jsx("span",{children:"Plateforme N1 au Sngal"})]}),r.jsxs("h1",{className:"home-page__hero-title",children:["Russis tes examens avec",r.jsx("span",{className:"home-page__hero-highlight",children:" PedaClic"})]}),r.jsx("p",{className:"home-page__hero-subtitle",children:"La plateforme ducative qui accompagne les lves sngalais du collge au lyce avec des cours, exercices et quiz de qualit."}),r.jsx("div",{className:"home-page__hero-cta",children:e?r.jsxs(Fe,{to:e.role==="eleve"?"/eleve/dashboard":e.role==="prof"?"/prof/dashboard":"/admin",className:"home-page__btn home-page__btn--primary",children:["  Accder  mon espace",r.jsx(ws,{size:20})]}):r.jsxs(r.Fragment,{children:[r.jsxs(Fe,{to:"/register",className:"home-page__btn home-page__btn--primary",children:["Commencer gratuitement",r.jsx(ws,{size:20})]}),r.jsxs(Fe,{to:"/disciplines",className:"home-page__btn home-page__btn--outline",children:[r.jsx(Jl,{size:18}),"Dcouvrir les cours"]})]})}),r.jsxs("div",{className:"home-page__hero-stats",children:[r.jsxs("div",{className:"home-page__hero-stat",children:[r.jsx("strong",{children:"10 000+"}),r.jsx("span",{children:"lves inscrits"})]}),r.jsxs("div",{className:"home-page__hero-stat",children:[r.jsx("strong",{children:"500+"}),r.jsx("span",{children:"Cours disponibles"})]}),r.jsxs("div",{className:"home-page__hero-stat",children:[r.jsx("strong",{children:"95%"}),r.jsx("span",{children:"Taux de russite"})]})]})]}),r.jsx("div",{className:"home-page__hero-image",children:r.jsxs("div",{className:"home-page__hero-illustration",children:[r.jsx(Ps,{size:120}),r.jsx("div",{className:"home-page__hero-floating home-page__hero-floating--1",children:""}),r.jsx("div",{className:"home-page__hero-floating home-page__hero-floating--2",children:""}),r.jsx("div",{className:"home-page__hero-floating home-page__hero-floating--3",children:""})]})})]}),r.jsx("section",{className:"home-page__levels",children:r.jsxs("div",{className:"home-page__container",children:[r.jsx("h2",{className:"home-page__section-title",children:"Tous les niveaux, toutes les matires"}),r.jsx("p",{className:"home-page__section-subtitle",children:"Du collge au lyce, prpare tes examens avec confiance"}),r.jsxs("div",{className:"home-page__levels-grid",children:[r.jsxs(Fe,{to:"/disciplines?niveau=college",className:"home-page__level-card",children:[r.jsx("div",{className:"home-page__level-icon home-page__level-icon--college",children:""}),r.jsx("h3",{children:"Collge"}),r.jsx("p",{children:"6me  3me"}),r.jsxs("ul",{children:[r.jsxs("li",{children:[r.jsx(Ut,{size:16})," Prparation au BFEM"]}),r.jsxs("li",{children:[r.jsx(Ut,{size:16})," 9 matires disponibles"]}),r.jsxs("li",{children:[r.jsx(Ut,{size:16})," Exercices corrigs"]})]}),r.jsxs("span",{className:"home-page__level-link",children:["Voir les cours ",r.jsx(ws,{size:16})]})]}),r.jsxs(Fe,{to:"/disciplines?niveau=lycee",className:"home-page__level-card",children:[r.jsx("div",{className:"home-page__level-icon home-page__level-icon--lycee",children:""}),r.jsx("h3",{children:"Lyce"}),r.jsx("p",{children:"2nde  Terminale"}),r.jsxs("ul",{children:[r.jsxs("li",{children:[r.jsx(Ut,{size:16})," Prparation au BAC"]}),r.jsxs("li",{children:[r.jsx(Ut,{size:16})," 12 matires disponibles"]}),r.jsxs("li",{children:[r.jsx(Ut,{size:16})," Annales d'examens"]})]}),r.jsxs("span",{className:"home-page__level-link",children:["Voir les cours ",r.jsx(ws,{size:16})]})]})]})]})}),r.jsx("section",{className:"home-page__features",children:r.jsxs("div",{className:"home-page__container",children:[r.jsx("h2",{className:"home-page__section-title",children:"Pourquoi choisir PedaClic ?"}),r.jsx("p",{className:"home-page__section-subtitle",children:"Des outils modernes pour une ducation de qualit"}),r.jsxs("div",{className:"home-page__features-grid",children:[r.jsxs("div",{className:"home-page__feature-card",children:[r.jsx("div",{className:"home-page__feature-icon",children:r.jsx(vn,{size:28})}),r.jsx("h3",{children:"Cours complets"}),r.jsx("p",{children:"Des cours structurs et conformes au programme sngalais, rdigs par des enseignants expriments."})]}),r.jsxs("div",{className:"home-page__feature-card",children:[r.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--secondary",children:r.jsx(lA,{size:28})}),r.jsx("h3",{children:"Quiz interactifs"}),r.jsx("p",{children:"Testez vos connaissances avec des quiz adapts  chaque niveau et obtenez un feedback instantan."})]}),r.jsxs("div",{className:"home-page__feature-card",children:[r.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--warning",children:r.jsx(oA,{size:28})}),r.jsx("h3",{children:"Suivi de progression"}),r.jsx("p",{children:"Visualisez vos progrs et identifiez vos points faibles pour cibler vos rvisions."})]}),r.jsxs("div",{className:"home-page__feature-card",children:[r.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--success",children:r.jsx(Pb,{size:28})}),r.jsx("h3",{children:"Contenu vrifi"}),r.jsx("p",{children:"Tous nos contenus sont valids par des professeurs certifis pour garantir leur qualit."})]}),r.jsxs("div",{className:"home-page__feature-card",children:[r.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--info",children:r.jsx(so,{size:28})}),r.jsx("h3",{children:"Accessible 24/7"}),r.jsx("p",{children:"tudiez  votre rythme, o que vous soyez, sur ordinateur, tablette ou smartphone."})]}),r.jsxs("div",{className:"home-page__feature-card",children:[r.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--premium",children:r.jsx(Wi,{size:28})}),r.jsx("h3",{children:"Certificats"}),r.jsx("p",{children:"Obtenez des certificats de russite pour valoriser vos comptences acquises."})]})]})]})}),r.jsx("section",{className:"home-page__premium",children:r.jsx("div",{className:"home-page__container",children:r.jsxs("div",{className:"home-page__premium-content",children:[r.jsxs("div",{className:"home-page__premium-text",children:[r.jsx("span",{className:"home-page__premium-badge",children:" Premium"}),r.jsx("h2",{children:"Passez  la vitesse suprieure"}),r.jsxs("p",{children:["Accdez  tous les quiz, exercices corrigs et ressources exclusives pour seulement ",r.jsx("strong",{children:"2 000 FCFA/mois"}),"."]}),r.jsxs("ul",{className:"home-page__premium-features",children:[r.jsxs("li",{children:[r.jsx(Ut,{size:18})," Quiz illimits dans toutes les matires"]}),r.jsxs("li",{children:[r.jsx(Ut,{size:18})," Corrections dtailles des exercices"]}),r.jsxs("li",{children:[r.jsx(Ut,{size:18})," Annales des examens (BFEM, BAC)"]}),r.jsxs("li",{children:[r.jsx(Ut,{size:18})," Support prioritaire"]})]}),r.jsxs(Fe,{to:"/premium",className:"home-page__btn home-page__btn--premium",children:["Dcouvrir Premium",r.jsx(ws,{size:20})]})]}),r.jsx("div",{className:"home-page__premium-pricing",children:r.jsxs("div",{className:"home-page__pricing-card",children:[r.jsx("span",{className:"home-page__pricing-popular",children:"Plus populaire"}),r.jsx("h3",{children:"Accs illimit 6 mois"}),r.jsxs("div",{className:"home-page__pricing-price",children:[r.jsx("span",{className:"home-page__pricing-amount",children:"20 000"}),r.jsx("span",{className:"home-page__pricing-currency",children:"FCFA"}),r.jsx("span",{className:"home-page__pricing-period",children:"/6 mois"})]}),r.jsx("p",{className:"home-page__pricing-save",children:"conomisez 10 000 FCFA vs 23 mois"}),r.jsx(Fe,{to:"/premium",className:"home-page__btn home-page__btn--primary home-page__btn--block",children:"Choisir ce plan"})]})})]})})}),r.jsx("section",{className:"home-page__testimonials",children:r.jsxs("div",{className:"home-page__container",children:[r.jsx("h2",{className:"home-page__section-title",children:"Ce qu'en disent nos lves"}),r.jsxs("div",{className:"home-page__testimonials-grid",children:[r.jsxs("div",{className:"home-page__testimonial-card",children:[r.jsx("div",{className:"home-page__testimonial-stars",children:[1,2,3,4,5].map(t=>r.jsx(Zr,{size:16,fill:"#f59e0b",color:"#f59e0b"},t))}),r.jsx("p",{className:"home-page__testimonial-text",children:`"Grce  PedaClic, j'ai obtenu mon BFEM avec mention. Les quiz m'ont vraiment aid  me prparer !"`}),r.jsxs("div",{className:"home-page__testimonial-author",children:[r.jsx("div",{className:"home-page__testimonial-avatar",children:"FA"}),r.jsxs("div",{children:[r.jsx("strong",{children:"Fatou Adara"}),r.jsx("span",{children:"lve en 3me - Dakar"})]})]})]}),r.jsxs("div",{className:"home-page__testimonial-card",children:[r.jsx("div",{className:"home-page__testimonial-stars",children:[1,2,3,4,5].map(t=>r.jsx(Zr,{size:16,fill:"#f59e0b",color:"#f59e0b"},t))}),r.jsx("p",{className:"home-page__testimonial-text",children:`"Les cours de maths sont trs bien expliqus. J'ai enfin compris les quations du second degr !"`}),r.jsxs("div",{className:"home-page__testimonial-author",children:[r.jsx("div",{className:"home-page__testimonial-avatar",children:"MD"}),r.jsxs("div",{children:[r.jsx("strong",{children:"Moussa Diallo"}),r.jsx("span",{children:"lve en Terminale S - This"})]})]})]}),r.jsxs("div",{className:"home-page__testimonial-card",children:[r.jsx("div",{className:"home-page__testimonial-stars",children:[1,2,3,4,5].map(t=>r.jsx(Zr,{size:16,fill:"#f59e0b",color:"#f59e0b"},t))}),r.jsx("p",{className:"home-page__testimonial-text",children:`"Je recommande PedaClic  tous les parents. Ma fille a beaucoup progress depuis qu'elle l'utilise."`}),r.jsxs("div",{className:"home-page__testimonial-author",children:[r.jsx("div",{className:"home-page__testimonial-avatar",children:"AN"}),r.jsxs("div",{children:[r.jsx("strong",{children:"Aminata Ndiaye"}),r.jsx("span",{children:"Parent d'lve - Saint-Louis"})]})]})]})]})]})}),r.jsx("section",{className:"home-page__final-cta",children:r.jsxs("div",{className:"home-page__container",children:[r.jsx("h2",{children:"Prt  russir ?"}),r.jsx("p",{children:"Rejoignez les milliers d'lves qui font confiance  PedaClic"}),!e&&r.jsxs(Fe,{to:"/register",className:"home-page__btn home-page__btn--large",children:["Crer mon compte gratuit",r.jsx(ws,{size:24})]})]})})]})},fA=[{value:"6eme",label:"6me"},{value:"5eme",label:"5me"},{value:"4eme",label:"4me"},{value:"3eme",label:"3me"}],pA=[{value:"2nde",label:"2nde"},{value:"1ere",label:"1re"},{value:"Terminale",label:"Terminale"}],hA=[{value:"debutant",label:"Dbutant"},{value:"intermediaire",label:"Intermdiaire"},{value:"avance",label:"Avanc"}],vA={college:"Collge",lycee:"Lyce",formation_libre:"Formation libre"};function E1(e){switch(e){case"college":return fA;case"lycee":return pA;case"formation_libre":return hA;default:return[]}}function gA(e){return[...fA,...pA,...hA].find(n=>n.value===e)?.label||e}const A1=[{niveau:"college",icon:"",label:"Collge",color:"#2b6cb0",bgLight:"#ebf8ff"},{niveau:"lycee",icon:"",label:"Lyce",color:"#975a16",bgLight:"#fefcbf"},{niveau:"formation_libre",icon:"",label:"Formation libre",color:"#276749",bgLight:"#f0fff4"}],K3=()=>{const[e,t]=g.useState("college"),[n,a]=g.useState([]),[l,o]=g.useState(!0),u=lt();g.useEffect(()=>{const p=Ee(je(K,"disciplines"),Ve("ordre")),h=xf(p,v=>{const b=v.docs.map(x=>({id:x.id,...x.data(),createdAt:x.data().createdAt?.toDate()||new Date,updatedAt:x.data().updatedAt?.toDate()||new Date}));a(b),o(!1)});return()=>h()},[]);const d=n.filter(p=>p.niveau===e),f=A1.find(p=>p.niveau===e);return r.jsxs("div",{style:{maxWidth:"1100px",margin:"0 auto",padding:"24px"},children:[r.jsxs("div",{style:{marginBottom:"32px",textAlign:"center"},children:[r.jsx("h1",{style:{fontSize:"1.8rem",fontWeight:700,color:"#1a365d",marginBottom:"8px"},children:" Disciplines"}),r.jsx("p",{style:{color:"#718096",fontSize:"1rem"},children:"Explorez les disciplines disponibles sur PedaClic"})]}),r.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"12px",marginBottom:"32px",flexWrap:"wrap"},children:A1.map(p=>{const h=e===p.niveau;return r.jsxs("button",{onClick:()=>t(p.niveau),style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 28px",borderRadius:"12px",border:`2px solid ${h?p.color:"#e2e8f0"}`,background:h?p.bgLight:"#fff",color:h?p.color:"#718096",fontSize:"1rem",fontWeight:h?700:500,cursor:"pointer",transition:"all 0.25s ease",boxShadow:h?`0 2px 8px ${p.color}20`:"none"},children:[r.jsx("span",{style:{fontSize:"1.2rem"},children:p.icon}),p.label]},p.niveau)})}),l&&r.jsx("div",{style:{textAlign:"center",padding:"48px",color:"#a0aec0"},children:"Chargement des disciplines..."}),!l&&d.length===0&&r.jsxs("div",{style:{textAlign:"center",padding:"48px",background:"#f7fafc",borderRadius:"12px",border:"1px dashed #e2e8f0"},children:[r.jsx("p",{style:{fontSize:"2rem",marginBottom:"8px"},children:""}),r.jsxs("p",{style:{color:"#a0aec0",fontSize:"1rem"},children:["Aucune discipline disponible en ",vA[e]," pour le moment."]})]}),!l&&d.length>0&&r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:d.map(p=>r.jsxs("div",{onClick:()=>u(`/disciplines/${p.id}`),style:{background:"#fff",borderRadius:"12px",padding:"24px",border:"1px solid #e2e8f0",boxShadow:"0 2px 6px rgba(0,0,0,0.05)",cursor:"pointer",transition:"all 0.2s ease",borderTop:`3px solid ${p.couleur||f.color}`},onMouseEnter:h=>{h.currentTarget.style.transform="translateY(-2px)",h.currentTarget.style.boxShadow="0 6px 16px rgba(0,0,0,0.1)"},onMouseLeave:h=>{h.currentTarget.style.transform="translateY(0)",h.currentTarget.style.boxShadow="0 2px 6px rgba(0,0,0,0.05)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"12px"},children:[r.jsx("span",{style:{fontSize:"1.8rem"},children:p.icone||""}),r.jsx("h3",{style:{fontSize:"1.1rem",fontWeight:600,color:"#2d3748",margin:0},children:p.nom})]}),p.description&&r.jsx("p",{style:{fontSize:"0.875rem",color:"#718096",marginBottom:"12px",lineHeight:1.5},children:p.description.length>100?`${p.description.slice(0,100)}...`:p.description}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginBottom:"8px"},children:r.jsx("span",{style:{display:"inline-block",padding:"2px 10px",borderRadius:"10px",fontSize:"0.75rem",fontWeight:500,background:f.bgLight,color:f.color},children:gA(p.classe)})}),p.coefficient!==void 0&&r.jsxs("p",{style:{fontSize:"0.8rem",color:"#a0aec0"},children:["Coefficient : ",p.coefficient]})]},p.id))})]})},gc="disciplines",z1=e=>{const t=e.data();return{id:e.id,nom:t.nom,niveau:t.niveau,classe:t.classe,ordre:t.ordre,coefficient:t.coefficient,couleur:t.couleur,icone:t.icone,description:t.description,createdAt:t.createdAt?.toDate()||new Date,updatedAt:t.updatedAt?.toDate()}},Ji={async getAll(e){try{const t=[Ve("ordre","asc")];e?.niveau&&t.unshift(Se("niveau","==",e.niveau)),e?.classe&&t.unshift(Se("classe","==",e.classe));const n=Ee(je(K,gc),...t);return(await Ce(n)).docs.map(z1)}catch(t){throw console.error("Erreur lors de la rcupration des disciplines:",t),new Error("Impossible de rcuprer les disciplines")}},async getById(e){try{const t=Ne(K,gc,e),n=await Dt(t);return n.exists()?z1(n):null}catch(t){throw console.error("Erreur lors de la rcupration de la discipline:",t),new Error("Impossible de rcuprer la discipline")}},async getByNiveau(e){return this.getAll({niveau:e})},async getByClasse(e){return this.getAll({classe:e})},async create(e){try{return(await qt(je(K,gc),{...e,createdAt:Ot(),updatedAt:Ot()})).id}catch(t){throw console.error("Erreur lors de la cration de la discipline:",t),new Error("Impossible de crer la discipline")}},async update(e,t){try{const n=Ne(K,gc,e);await Qe(n,{...t,updatedAt:Ot()})}catch(n){throw console.error("Erreur lors de la mise  jour de la discipline:",n),new Error("Impossible de mettre  jour la discipline")}},async delete(e){try{const t=Ne(K,gc,e);await rn(t)}catch(t){throw console.error("Erreur lors de la suppression de la discipline:",t),new Error("Impossible de supprimer la discipline")}},async exists(e){return await this.getById(e)!==null},async countByNiveau(e){return(await this.getByNiveau(e)).length}},W3="modulepreload",X3=function(e){return"/"+e},k1={},O1=function(t,n,a){let l=Promise.resolve();if(n&&n.length>0){let f=function(p){return Promise.all(p.map(h=>Promise.resolve(h).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=u?.nonce||u?.getAttribute("nonce");l=f(n.map(p=>{if(p=X3(p),p in k1)return;k1[p]=!0;const h=p.endsWith(".css"),v=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${v}`))return;const b=document.createElement("link");if(b.rel=h?"stylesheet":W3,h||(b.as="script"),b.crossOrigin="",b.href=p,d&&b.setAttribute("nonce",d),document.head.appendChild(b),h)return new Promise((x,j)=>{b.addEventListener("load",x),b.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return l.then(u=>{for(const d of u||[])d.status==="rejected"&&o(d.reason);return t().catch(o)})},_s="ressources",Z3="ressources",D1=e=>{const t=e.data();return{id:e.id,disciplineId:t.disciplineId,titre:t.titre,type:t.type,contenu:t.contenu,description:t.description,isPremium:t.isPremium||!1,ordre:t.ordre||0,chapitre:t.chapitre,fichierURL:t.fichierURL,dureeEstimee:t.dureeEstimee,tags:t.tags||[],auteurId:t.auteurId,createdAt:t.createdAt?.toDate()||new Date,updatedAt:t.updatedAt?.toDate()}},J3=e=>{const t=Date.now(),n=e.split(".").pop();return`${e.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9]/g,"_")}_${t}.${n}`},Ba={async getAll(e,t){try{const n=[Ve("ordre","asc")];e?.disciplineId&&n.unshift(Se("disciplineId","==",e.disciplineId)),e?.chapitreId&&n.unshift(Se("chapitre","==",e.chapitreId)),e?.type&&n.unshift(Se("type","==",e.type)),e?.isPremium!==void 0&&n.unshift(Se("isPremium","==",e.isPremium)),e?.auteurId&&n.unshift(Se("auteurId","==",e.auteurId)),t&&n.push(ar(t));const a=Ee(je(K,_s),...n);return(await Ce(a)).docs.map(D1)}catch(n){throw console.error("Erreur lors de la rcupration des ressources:",n),new Error("Impossible de rcuprer les ressources")}},async getById(e){try{const t=Ne(K,_s,e),n=await Dt(t);return n.exists()?D1(n):null}catch(t){throw console.error("Erreur lors de la rcupration de la ressource:",t),new Error("Impossible de rcuprer la ressource")}},async getByDiscipline(e){return this.getAll({disciplineId:e})},async getByChapitre(e){return this.getAll({chapitreId:e})},async getByType(e){return this.getAll({type:e})},async getPremium(){return this.getAll({isPremium:!0})},async getFree(){return this.getAll({isPremium:!1})},async create(e,t){try{return(await qt(je(K,_s),{...e,auteurId:t,createdAt:Ot(),updatedAt:Ot()})).id}catch(n){throw console.error("Erreur lors de la cration de la ressource:",n),new Error("Impossible de crer la ressource")}},async update(e,t){try{const n=Ne(K,_s,e);await Qe(n,{...t,updatedAt:Ot()})}catch(n){throw console.error("Erreur lors de la mise  jour de la ressource:",n),new Error("Impossible de mettre  jour la ressource")}},async delete(e){try{const t=await this.getById(e);t?.fichierURL&&await this.deleteFile(t.fichierURL);const n=Ne(K,_s,e);await rn(n)}catch(t){throw console.error("Erreur lors de la suppression de la ressource:",t),new Error("Impossible de supprimer la ressource")}},async deleteByDiscipline(e){try{const t=await this.getByDiscipline(e),n=Mn(K);for(const a of t){a.fichierURL&&await this.deleteFile(a.fichierURL);const l=Ne(K,_s,a.id);n.delete(l)}await n.commit()}catch(t){throw console.error("Erreur lors de la suppression des ressources:",t),new Error("Impossible de supprimer les ressources")}},async uploadFile(e,t){try{const n=J3(e.name),a=`${Z3}/${t}/${n}`,l=Lr(Dr,a);return await Ms(l,e),await pa(l)}catch(n){throw console.error("Erreur lors de l'upload du fichier:",n),new Error("Impossible d'uploader le fichier")}},async deleteFile(e){try{const t=Lr(Dr,e);await Pc(t)}catch(t){console.warn("Fichier non trouv ou dj supprim:",t)}},async reorder(e,t){try{const n=Mn(K);t.forEach((a,l)=>{const o=Ne(K,_s,a);n.update(o,{ordre:l+1,updatedAt:Ot()})}),await n.commit()}catch(n){throw console.error("Erreur lors de la rorganisation des ressources:",n),new Error("Impossible de rorganiser les ressources")}},async togglePremium(e,t){await this.update(e,{isPremium:t})},async countByType(e){return(await this.getByType(e)).length},async getStats(){try{const e=await this.getAll(),t={total:e.length,premium:e.filter(n=>n.isPremium).length,gratuit:e.filter(n=>!n.isPremium).length,parType:{cours:0,exercice:0,video:0,document:0,quiz:0}};return e.forEach(n=>{t.parType[n.type]!==void 0&&t.parType[n.type]++}),t}catch(e){throw console.error("Erreur lors du calcul des statistiques:",e),new Error("Impossible de calculer les statistiques")}}},e5=()=>{const{id:e}=Jn(),t=lt(),[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState([]),[f,p]=g.useState(!0),[h,v]=g.useState(null),[b,x]=g.useState("tous"),[j,N]=g.useState(new Set),w=g.useCallback(async()=>{if(e)try{p(!0),v(null);const $=await Ji.getById(e);if(!$){v("Discipline introuvable."),p(!1);return}a($);const U=await Ba.getAll({disciplineId:e}),L=new Map,B=[];for(const se of U){const P=se.chapitre||se.chapitreId;P?(L.has(P)||L.set(P,[]),L.get(P).push(se)):B.push(se)}const ee=Array.from(L.entries()).map(([se,P])=>({chapitreNom:se,ressources:P.sort((q,F)=>q.ordre-F.ordre)})).sort((se,P)=>se.chapitreNom.localeCompare(P.chapitreNom,"fr"));o(ee),d(B),ee.length>0&&N(new Set([ee[0].chapitreNom]))}catch($){console.error("Erreur chargement discipline:",$),v("Impossible de charger les donnes. Ressayez plus tard.")}finally{p(!1)}},[e]);g.useEffect(()=>{w()},[w]);const C=$=>{N(U=>{const L=new Set(U);return L.has($)?L.delete($):L.add($),L})},E=$=>b==="tous"?$:$.filter(U=>U.type===b),S=$=>{switch($){case"cours":return"";case"exercice":return"";case"video":return"";case"document":return"";case"quiz":return"";default:return""}},A=$=>{switch($){case"cours":return"Cours";case"exercice":return"Exercice";case"video":return"Vido";case"document":return"Document";case"quiz":return"Quiz";default:return $}},O=$=>{switch($){case"cours":return"#3b82f6";case"exercice":return"#10b981";case"video":return"#f59e0b";case"document":return"#8b5cf6";case"quiz":return"#ef4444";default:return"#6b7280"}},k=$=>$==="college"?"Collge":"Lyce";if(f)return r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem 1rem",minHeight:"50vh"},children:[r.jsx("div",{style:{width:"48px",height:"48px",border:"4px solid #e5e7eb",borderTopColor:"#2563eb",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),r.jsx("p",{style:{marginTop:"1rem",color:"#6b7280"},children:"Chargement de la discipline..."}),r.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"})]});if(h||!n)return r.jsxs("div",{style:{maxWidth:"600px",margin:"3rem auto",padding:"2rem",textAlign:"center",background:"#fef2f2",borderRadius:"12px",border:"1px solid #fecaca"},children:[r.jsx("span",{style:{fontSize:"3rem"},children:""}),r.jsx("h2",{style:{color:"#991b1b",margin:"1rem 0 0.5rem"},children:h||"Discipline introuvable"}),r.jsx("p",{style:{color:"#b91c1c",marginBottom:"1.5rem"},children:"Vrifiez le lien ou retournez  la liste des disciplines."}),r.jsx("button",{onClick:()=>t("/disciplines"),style:{padding:"0.75rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:600},children:" Retour aux disciplines"})]});const M=[...l.flatMap($=>$.ressources),...u],D=[...new Set(M.map($=>$.type))];return r.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto",padding:"1.5rem 1rem"},children:[r.jsxs("nav",{style:{marginBottom:"1.5rem",fontSize:"0.875rem",color:"#6b7280"},children:[r.jsx(Fe,{to:"/",style:{color:"#2563eb",textDecoration:"none"},children:"Accueil"}),r.jsx("span",{style:{margin:"0 0.5rem"},children:"/"}),r.jsx(Fe,{to:"/disciplines",style:{color:"#2563eb",textDecoration:"none"},children:"Disciplines"}),r.jsx("span",{style:{margin:"0 0.5rem"},children:"/"}),r.jsx("span",{style:{color:"#374151"},children:n.nom})]}),r.jsxs("header",{style:{background:"linear-gradient(135deg, #1e40af 0%, #3b82f6 100%)",borderRadius:"16px",padding:"2rem",color:"#fff",marginBottom:"2rem"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.75rem"},children:[r.jsx("span",{style:{fontSize:"2.5rem"},children:n.icone||""}),r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:"1.75rem",fontWeight:700,margin:0},children:n.nom}),n.description&&r.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.9,fontSize:"0.95rem"},children:n.description})]})]}),r.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap",marginTop:"1rem"},children:[r.jsxs("span",{style:{background:"rgba(255,255,255,0.2)",padding:"0.35rem 0.75rem",borderRadius:"20px",fontSize:"0.8rem",fontWeight:600},children:[" ",k(n.niveau),"  ",n.classe]}),r.jsxs("span",{style:{background:"rgba(255,255,255,0.2)",padding:"0.35rem 0.75rem",borderRadius:"20px",fontSize:"0.8rem",fontWeight:600},children:[" ",M.length," ressource",M.length!==1?"s":""]}),n.coefficient&&r.jsxs("span",{style:{background:"rgba(255,255,255,0.2)",padding:"0.35rem 0.75rem",borderRadius:"20px",fontSize:"0.8rem",fontWeight:600},children:[" Coeff. ",n.coefficient]})]})]}),D.length>1&&r.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginBottom:"1.5rem"},children:[r.jsxs("button",{onClick:()=>x("tous"),style:{padding:"0.5rem 1rem",borderRadius:"20px",border:b==="tous"?"2px solid #2563eb":"1px solid #d1d5db",background:b==="tous"?"#2563eb":"#fff",color:b==="tous"?"#fff":"#374151",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:["Tous (",M.length,")"]}),D.map($=>{const U=M.filter(B=>B.type===$).length,L=b===$;return r.jsxs("button",{onClick:()=>x($),style:{padding:"0.5rem 1rem",borderRadius:"20px",border:L?`2px solid ${O($)}`:"1px solid #d1d5db",background:L?O($):"#fff",color:L?"#fff":"#374151",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:[S($)," ",A($)," (",U,")"]},$)})]}),l.length===0&&u.length===0?r.jsxs("div",{style:{textAlign:"center",padding:"3rem 1rem",background:"#f9fafb",borderRadius:"12px",border:"1px solid #e5e7eb"},children:[r.jsx("span",{style:{fontSize:"3rem"},children:""}),r.jsx("h3",{style:{color:"#374151",margin:"1rem 0 0.5rem"},children:"Aucune ressource disponible"}),r.jsx("p",{style:{color:"#6b7280"},children:"Les cours et exercices pour cette discipline seront bientt ajouts."})]}):r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[l.map($=>{const U=E($.ressources);if(U.length===0&&b!=="tous")return null;const L=j.has($.chapitreNom),B=b==="tous"?$.ressources:U;return r.jsxs("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e5e7eb",overflow:"hidden",transition:"box-shadow 0.2s",boxShadow:L?"0 4px 12px rgba(0,0,0,0.08)":"none"},children:[r.jsx("button",{onClick:()=>C($.chapitreNom),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1rem 1.25rem",background:L?"#f0f5ff":"#fff",border:"none",cursor:"pointer",textAlign:"left",transition:"background 0.2s"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[r.jsx("span",{style:{fontSize:"1.25rem",transform:L?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s"},children:""}),r.jsxs("div",{children:[r.jsx("span",{style:{fontWeight:700,color:"#1f2937",fontSize:"1rem"},children:$.chapitreNom}),r.jsxs("span",{style:{display:"block",fontSize:"0.75rem",color:"#6b7280",marginTop:"2px"},children:[$.ressources.length," ressource",$.ressources.length!==1?"s":""]})]})]})}),L&&r.jsx("div",{style:{padding:"0 1.25rem 1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:B.map(ee=>r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #f3f4f6",transition:"background 0.15s",cursor:"pointer"},onMouseEnter:se=>se.currentTarget.style.background="#eef2ff",onMouseLeave:se=>se.currentTarget.style.background="#f9fafb",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flex:1},children:[r.jsx("span",{style:{fontSize:"1.2rem"},children:S(ee.type)}),r.jsxs("div",{children:[r.jsx("span",{style:{fontWeight:600,color:"#1f2937",fontSize:"0.9rem"},children:ee.titre}),ee.description&&r.jsx("span",{style:{display:"block",fontSize:"0.75rem",color:"#9ca3af",marginTop:"2px"},children:ee.description})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexShrink:0},children:[r.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#fff",background:O(ee.type)},children:A(ee.type)}),ee.isPremium&&r.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#92400e",background:"#fef3c7",border:"1px solid #fde68a"},children:" Premium"}),ee.dureeEstimee&&r.jsxs("span",{style:{fontSize:"0.75rem",color:"#6b7280"},children:[" ",ee.dureeEstimee," min"]})]})]},ee.id))})]},$.chapitreNom)}),E(u).length>0&&r.jsxs("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e5e7eb",padding:"1rem 1.25rem"},children:[r.jsx("h3",{style:{fontSize:"1rem",fontWeight:700,color:"#374151",marginBottom:"0.75rem"},children:" Autres ressources"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:E(u).map($=>r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #f3f4f6"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[r.jsx("span",{style:{fontSize:"1.2rem"},children:S($.type)}),r.jsx("span",{style:{fontWeight:600,color:"#1f2937",fontSize:"0.9rem"},children:$.titre})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#fff",background:O($.type)},children:A($.type)}),$.isPremium&&r.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#92400e",background:"#fef3c7",border:"1px solid #fde68a"},children:" Premium"})]})]},$.id))})]})]}),r.jsx("div",{style:{marginTop:"2rem",textAlign:"center"},children:r.jsx(Fe,{to:"/disciplines",style:{display:"inline-block",padding:"0.75rem 1.5rem",background:"#f3f4f6",color:"#374151",borderRadius:"8px",textDecoration:"none",fontWeight:600,transition:"background 0.2s"},children:" Retour aux disciplines"})})]})},t5=()=>{const{login:e,loginWithGoogle:t}=Ze(),n=lt(),l=Ob().state?.from||"/",[o,u]=g.useState({email:"",password:""}),[d,f]=g.useState(!1),[p,h]=g.useState(!1),[v,b]=g.useState(""),[x,j]=g.useState(!1),N=S=>{const{name:A,value:O}=S.target;u(k=>({...k,[A]:O})),v&&b("")},w=()=>o.email.trim()?o.password?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email)?!0:(b("Veuillez entrer une adresse email valide."),!1):(b("Veuillez entrer votre mot de passe."),!1):(b("Veuillez entrer votre adresse email."),!1),C=async S=>{if(S.preventDefault(),!!w()){f(!0),b("");try{await e(o.email,o.password),n(l,{replace:!0})}catch(A){A instanceof Error?b(A.message):b("Une erreur est survenue lors de la connexion.")}finally{f(!1)}}},E=async()=>{h(!0),b("");try{await t(),n(l,{replace:!0})}catch(S){S instanceof Error&&b(S.message)}finally{h(!1)}};return r.jsx("div",{className:"auth-page",children:r.jsxs("div",{className:"auth-container",children:[r.jsxs("div",{className:"auth-card",children:[r.jsxs("div",{className:"auth-header",children:[r.jsxs(Fe,{to:"/",className:"auth-logo",children:[r.jsx("div",{className:"auth-logo__icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})})}),r.jsx("span",{children:"PedaClic"})]}),r.jsx("h1",{className:"auth-title",children:"Connexion"}),r.jsx("p",{className:"auth-subtitle",children:"Accdez  votre espace d'apprentissage"})]}),v&&r.jsxs("div",{className:"auth-error",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 8v4M12 16h.01"})]}),r.jsx("span",{children:v})]}),r.jsxs("form",{onSubmit:C,className:"auth-form",children:[r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"email",className:"auth-label",children:"Adresse email"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),r.jsx("input",{type:"email",id:"email",name:"email",value:o.email,onChange:N,placeholder:"exemple@email.com",className:"auth-input",autoComplete:"email",disabled:d})]})]}),r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"password",className:"auth-label",children:"Mot de passe"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",strokeWidth:"2"}),r.jsx("path",{strokeWidth:"2",d:"M7 11V7a5 5 0 0110 0v4"})]}),r.jsx("input",{type:x?"text":"password",id:"password",name:"password",value:o.password,onChange:N,placeholder:"Votre mot de passe",className:"auth-input",autoComplete:"current-password",disabled:d}),r.jsx("button",{type:"button",className:"auth-password-toggle",onClick:()=>j(!x),"aria-label":x?"Masquer le mot de passe":"Afficher le mot de passe",children:x?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),r.jsx("div",{className:"auth-forgot",children:r.jsx(Fe,{to:"/mot-de-passe-oublie",className:"auth-forgot-link",children:"Mot de passe oubli ?"})}),r.jsx("button",{type:"submit",className:"auth-button",disabled:d,children:d?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"auth-button-spinner"}),"Connexion en cours..."]}):"Se connecter"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"ou"})}),r.jsx("button",{type:"button",className:"auth-google-btn",onClick:E,disabled:d||p,children:p?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"auth-button-spinner auth-button-spinner--dark"}),"Connexion en cours"]}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"auth-google-icon",viewBox:"0 0 24 24","aria-hidden":"true",children:[r.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),r.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),r.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z"}),r.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continuer avec Google"]})}),r.jsxs("p",{className:"auth-switch",children:["Pas encore de compte ?"," ",r.jsx(Fe,{to:"/inscription",className:"auth-switch-link",children:"Crer un compte"})]})]}),r.jsxs("div",{className:"auth-welcome",children:[r.jsx("h2",{children:"Bienvenue sur PedaClic !"}),r.jsx("p",{children:"L'cole en un clic - Accdez  des milliers de cours, exercices et quiz."}),r.jsxs("ul",{className:"auth-features",children:[r.jsxs("li",{children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Cours du programme sngalais"]}),r.jsxs("li",{children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Exercices interactifs"]}),r.jsxs("li",{children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Quiz pour tester vos connaissances"]}),r.jsxs("li",{children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Suivi de progression"]})]})]})]})})},r5=()=>{const{register:e,loginWithGoogle:t}=Ze(),n=lt(),[a,l]=g.useState({email:"",password:"",confirmPassword:"",displayName:"",role:"eleve"}),[o,u]=g.useState(!1),[d,f]=g.useState(""),[p,h]=g.useState(!1),[v,b]=g.useState(!1),[x,j]=g.useState(!1),[N,w]=g.useState(!1),C=O=>{const{name:k,value:M}=O.target;l(D=>({...D,[k]:M})),d&&f("")},E=()=>a.displayName.trim()?a.displayName.trim().length<2?(f("Le nom doit contenir au moins 2 caractres."),!1):a.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)?a.password?a.password.length<6?(f("Le mot de passe doit contenir au moins 6 caractres."),!1):a.password!==a.confirmPassword?(f("Les mots de passe ne correspondent pas."),!1):x?!0:(f("Veuillez accepter les conditions d'utilisation."),!1):(f("Veuillez entrer un mot de passe."),!1):(f("Veuillez entrer une adresse email valide."),!1):(f("Veuillez entrer votre adresse email."),!1):(f("Veuillez entrer votre nom complet."),!1),S=async O=>{if(O.preventDefault(),!!E()){u(!0),f("");try{await e(a),n("/disciplines",{replace:!0})}catch(k){k instanceof Error?f(k.message):f("Une erreur est survenue lors de l'inscription.")}finally{u(!1)}}},A=async()=>{if(!x){f("Veuillez accepter les conditions d'utilisation.");return}w(!0),f("");try{await t(a.role),n("/disciplines",{replace:!0})}catch(O){O instanceof Error&&f(O.message)}finally{w(!1)}};return r.jsx("div",{className:"auth-page",children:r.jsxs("div",{className:"auth-container",children:[r.jsxs("div",{className:"auth-card auth-card--register",children:[r.jsxs("div",{className:"auth-header",children:[r.jsxs(Fe,{to:"/",className:"auth-logo",children:[r.jsx("div",{className:"auth-logo__icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})})}),r.jsx("span",{children:"PedaClic"})]}),r.jsx("h1",{className:"auth-title",children:"Crer un compte"}),r.jsx("p",{className:"auth-subtitle",children:"Rejoignez PedaClic et commencez  apprendre"})]}),d&&r.jsxs("div",{className:"auth-error",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 8v4M12 16h.01"})]}),r.jsx("span",{children:d})]}),r.jsxs("form",{onSubmit:S,className:"auth-form",children:[r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"displayName",className:"auth-label",children:"Nom complet"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),r.jsx("input",{type:"text",id:"displayName",name:"displayName",value:a.displayName,onChange:C,placeholder:"Amadou Diallo",className:"auth-input",autoComplete:"name",disabled:o})]})]}),r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"email",className:"auth-label",children:"Adresse email"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),r.jsx("input",{type:"email",id:"email",name:"email",value:a.email,onChange:C,placeholder:"exemple@email.com",className:"auth-input",autoComplete:"email",disabled:o})]})]}),r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{className:"auth-label",children:"Je suis :"}),r.jsxs("div",{className:"auth-role-selector",children:[r.jsxs("label",{className:`auth-role-option ${a.role==="eleve"?"auth-role-option--selected":""}`,children:[r.jsx("input",{type:"radio",name:"role",value:"eleve",checked:a.role==="eleve",onChange:C,className:"auth-role-input",disabled:o}),r.jsxs("div",{className:"auth-role-content",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 14l9-5-9-5-9 5 9 5z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"})]}),r.jsx("span",{children:"lve"})]})]}),r.jsxs("label",{className:`auth-role-option ${a.role==="prof"?"auth-role-option--selected":""}`,children:[r.jsx("input",{type:"radio",name:"role",value:"prof",checked:a.role==="prof",onChange:C,className:"auth-role-input",disabled:o}),r.jsxs("div",{className:"auth-role-content",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),r.jsx("span",{children:"Professeur"})]})]}),r.jsxs("label",{className:`auth-role-option ${a.role==="parent"?"auth-role-option--selected":""}`,children:[r.jsx("input",{type:"radio",name:"role",value:"parent",checked:a.role==="parent",onChange:C,className:"auth-role-input",disabled:o}),r.jsxs("div",{className:"auth-role-content",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})}),r.jsx("span",{children:"Parent d'lve"})]})]})]})]}),r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"password",className:"auth-label",children:"Mot de passe"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",strokeWidth:"2"}),r.jsx("path",{strokeWidth:"2",d:"M7 11V7a5 5 0 0110 0v4"})]}),r.jsx("input",{type:p?"text":"password",id:"password",name:"password",value:a.password,onChange:C,placeholder:"Minimum 6 caractres",className:"auth-input",autoComplete:"new-password",disabled:o}),r.jsx("button",{type:"button",className:"auth-password-toggle",onClick:()=>h(!p),"aria-label":p?"Masquer":"Afficher",children:p?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),r.jsx("p",{className:"auth-hint",children:"Au moins 6 caractres avec des lettres et des chiffres"})]}),r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"confirmPassword",className:"auth-label",children:"Confirmer le mot de passe"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),r.jsx("input",{type:v?"text":"password",id:"confirmPassword",name:"confirmPassword",value:a.confirmPassword,onChange:C,placeholder:"Retapez votre mot de passe",className:"auth-input",autoComplete:"new-password",disabled:o}),r.jsx("button",{type:"button",className:"auth-password-toggle",onClick:()=>b(!v),"aria-label":v?"Masquer":"Afficher",children:v?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),r.jsx("div",{className:"auth-checkbox-field",children:r.jsxs("label",{className:"auth-checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:x,onChange:O=>j(O.target.checked),className:"auth-checkbox",disabled:o}),r.jsx("span",{className:"auth-checkbox-custom"}),r.jsxs("span",{children:["J'accepte les"," ",r.jsx(Fe,{to:"/cgu",target:"_blank",className:"auth-link",children:"conditions d'utilisation"})," ","et la"," ",r.jsx(Fe,{to:"/confidentialite",target:"_blank",className:"auth-link",children:"politique de confidentialit"})]})]})}),r.jsx("button",{type:"submit",className:"auth-button",disabled:o,children:o?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"auth-button-spinner"}),"Cration du compte..."]}):"Crer mon compte"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"ou"})}),r.jsx("button",{type:"button",className:"auth-google-btn",onClick:A,disabled:o||N,children:N?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"auth-button-spinner auth-button-spinner--dark"}),"Cration du compte"]}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"auth-google-icon",viewBox:"0 0 24 24","aria-hidden":"true",children:[r.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),r.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),r.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z"}),r.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"S'inscrire avec Google"]})}),r.jsx("p",{className:"auth-google-hint",children:"Le rle slectionn ci-dessus sera utilis pour votre compte Google."}),r.jsxs("p",{className:"auth-switch",children:["Dj un compte ?"," ",r.jsx(Fe,{to:"/connexion",className:"auth-switch-link",children:"Se connecter"})]})]}),r.jsxs("div",{className:"auth-welcome auth-welcome--register",children:[r.jsx("h2",{children:"Rejoignez la communaut PedaClic"}),r.jsx("p",{children:"Des milliers d'lves et professeurs sngalais nous font dj confiance."}),r.jsxs("div",{className:"auth-stats",children:[r.jsxs("div",{className:"auth-stat",children:[r.jsx("span",{className:"auth-stat-number",children:"10 000+"}),r.jsx("span",{className:"auth-stat-label",children:"lves inscrits"})]}),r.jsxs("div",{className:"auth-stat",children:[r.jsx("span",{className:"auth-stat-number",children:"500+"}),r.jsx("span",{className:"auth-stat-label",children:"Cours disponibles"})]}),r.jsxs("div",{className:"auth-stat",children:[r.jsx("span",{className:"auth-stat-number",children:"95%"}),r.jsx("span",{className:"auth-stat-label",children:"Taux de satisfaction"})]})]}),r.jsxs("div",{className:"auth-testimonial",children:[r.jsx("p",{className:"auth-testimonial-text",children:`"Grce  PedaClic, j'ai amlior mes notes en mathmatiques de 4 points !"`}),r.jsx("p",{className:"auth-testimonial-author",children:" Fatou N., lve de 3me  Dakar"})]})]})]})})},n5=()=>{const e=async b=>{const{sendPasswordResetEmail:x}=await O1(async()=>{const{sendPasswordResetEmail:N}=await import("./vendor-firebase-LntcAirY.js").then(w=>w.K);return{sendPasswordResetEmail:N}},[]),{auth:j}=await O1(async()=>{const{auth:N}=await Promise.resolve().then(()=>O3);return{auth:N}},void 0);await x(j,b)},[t,n]=g.useState(""),[a,l]=g.useState(!1),[o,u]=g.useState(""),[d,f]=g.useState(!1),p=()=>t.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?!0:(u("Veuillez entrer une adresse email valide."),!1):(u("Veuillez entrer votre adresse email."),!1),h=async b=>{if(b.preventDefault(),!!p()){l(!0),u("");try{await e(t),f(!0)}catch(x){x instanceof Error?u(x.message):u("Une erreur est survenue. Veuillez ressayer.")}finally{l(!1)}}},v=()=>{f(!1),n(""),u("")};return r.jsx("div",{className:"auth-page",children:r.jsx("div",{className:"auth-container auth-container--centered",children:r.jsxs("div",{className:"auth-card auth-card--narrow",children:[r.jsx("div",{className:"auth-header",children:r.jsxs(Fe,{to:"/",className:"auth-logo",children:[r.jsx("div",{className:"auth-logo__icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})})}),r.jsx("span",{children:"PedaClic"})]})}),d?r.jsxs("div",{className:"auth-success-content",children:[r.jsx("div",{className:"auth-success-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),r.jsx("h1",{className:"auth-title",children:"Email envoy !"}),r.jsxs("p",{className:"auth-subtitle",children:["Nous avons envoy un lien de rinitialisation  ",r.jsx("strong",{children:t})]}),r.jsxs("div",{className:"auth-instructions",children:[r.jsx("p",{children:"Vrifiez votre bote de rception et cliquez sur le lien pour rinitialiser votre mot de passe."}),r.jsxs("p",{className:"auth-instructions-note",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"Si vous ne voyez pas l'email, vrifiez votre dossier spam."]})]}),r.jsxs("div",{className:"auth-success-actions",children:[r.jsx(Fe,{to:"/connexion",className:"auth-button",children:"Retour  la connexion"}),r.jsx("button",{type:"button",className:"auth-button auth-button--outline",onClick:v,children:"Renvoyer l'email"})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"auth-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),r.jsx("h1",{className:"auth-title",children:"Mot de passe oubli ?"}),r.jsx("p",{className:"auth-subtitle",children:"Pas de panique ! Entrez votre email et nous vous enverrons un lien pour rinitialiser votre mot de passe."}),o&&r.jsxs("div",{className:"auth-error",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 8v4M12 16h.01"})]}),r.jsx("span",{children:o})]}),r.jsxs("form",{onSubmit:h,className:"auth-form",children:[r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"email",className:"auth-label",children:"Adresse email"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),r.jsx("input",{type:"email",id:"email",value:t,onChange:b=>{n(b.target.value),o&&u("")},placeholder:"exemple@email.com",className:"auth-input",autoComplete:"email",disabled:a,autoFocus:!0})]})]}),r.jsx("button",{type:"submit",className:"auth-button",disabled:a,children:a?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"auth-button-spinner"}),"Envoi en cours..."]}):"Envoyer le lien"})]}),r.jsx("div",{className:"auth-back",children:r.jsxs(Fe,{to:"/connexion",className:"auth-back-link",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Retour  la connexion"]})})]})]})})})},xA="https://api.pedaclic.sn",Ri={a_la_carte_1:{label:"1 cours",montant:1e3,duree:"1 mois",description:"Choisissez 1 cours par discipline et niveau"},a_la_carte_3:{label:"3 cours",montant:2e3,duree:"1 mois",description:"Choisissez 3 cours par discipline et niveau"},a_la_carte_7:{label:"7 cours",montant:5e3,duree:"1 mois",description:"Choisissez 7 cours par discipline et niveau"},a_la_carte_tous:{label:"Tous les contenus",montant:25e3,duree:"9 mois",description:"Accs  l'intgralit du catalogue pendant 9 mois"},illimite_3m:{label:"3 mois",montant:1e4,duree:"3 mois",description:"Accs illimit aux cours, quiz et ressources pendant 3 mois"},illimite_6m:{label:"6 mois",montant:2e4,duree:"6 mois",description:"Accs illimit pendant 6 mois  conomisez 10 000 FCFA !"},illimite_1an:{label:"1 an",montant:3e4,duree:"1 an",description:"Accs illimit toute l'anne  conomisez 30 000 FCFA !"}};async function a5(e){const t=await fetch(`${xA}/api/moneroo/initiate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const a=await t.json().catch(()=>({}));throw new Error(a.error||`Erreur serveur (${t.status})`)}const n=await t.json();if(!n.success||!n.checkoutUrl)throw new Error("Rponse invalide du serveur de paiement");return n}async function i5(e){const t=await fetch(`${xA}/api/moneroo/verify/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Erreur vrification paiement (${t.status})`);return t.json()}function s5(e){window.location.href=e}function l5(){const e=new URLSearchParams(window.location.search);return{paymentId:e.get("paymentId"),paymentStatus:e.get("paymentStatus"),status:e.get("status")}}const o5=[{icone:"",titre:"Cours complets",description:"Accs illimit  tous les cours du programme sngalais 6me  Terminale"},{icone:"",titre:"Quiz illimits",description:"Tous les quiz par matire avec corrections dtailles et explications"},{icone:"",titre:"Gnrateur IA",description:"Gnration de cours, fiches de rvision et valuations par intelligence artificielle"},{icone:"",titre:"Suivi de progression",description:"Tableaux de bord analytiques pour suivre les performances en temps rel"},{icone:"",titre:"Bibliothque ebooks",description:"Accs  tous les manuels et ressources pdagogiques numriques"},{icone:"",titre:"Notifications",description:"Alertes personnalises pour devoirs, valuations et rappels scolaires"}],c5=[{nom:"Wave",couleur:"#1976D2",emoji:""},{nom:"Orange Money",couleur:"#FF6B00",emoji:""},{nom:"Free Money",couleur:"#E30613",emoji:""},{nom:"FLASH",couleur:"#6B21A8",emoji:""},{nom:"Carte Bancaire",couleur:"#059669",emoji:""}];function u5(){const e=lt(),{currentUser:t}=Ze(),[n,a]=g.useState("a_la_carte"),[l,o]=g.useState("a_la_carte_3"),[u,d]=g.useState(!1),[f,p]=g.useState(null),h=t?.isPremium===!0;async function v(){if(!t){e("/login?redirect=/premium");return}d(!0),p(null);try{const b=await a5({plan:l,userId:t.uid,userEmail:t.email||"",userFirstName:t.displayName?.split(" ")[0]||"lve",userLastName:t.displayName?.split(" ")[1]||"PedaClic"});s5(b.checkoutUrl)}catch(b){p(b instanceof Error?b.message:"Une erreur est survenue. Veuillez ressayer."),d(!1)}}return r.jsxs("div",{className:"premium-page",children:[r.jsx("header",{className:"premium-hero",children:r.jsxs("div",{className:"premium-hero__content",children:[r.jsx("span",{className:"premium-hero__badge",children:" PREMIUM"}),r.jsx("h1",{className:"premium-hero__titre",children:"Dbloque tout PedaClic"}),r.jsxs("p",{className:"premium-hero__sous-titre",children:["Accde  tous les cours, quiz et ressources du programme sngalais.",r.jsx("br",{}),"Du 6me au BAC  ",r.jsx("strong",{children:"L'cole en un clic !"})]})]})}),r.jsxs("div",{className:"premium-contenu",children:[h&&r.jsxs("section",{className:"premium-abonne",children:[r.jsx("div",{className:"premium-abonne__icone",children:""}),r.jsx("h2",{children:"Tu es dj abonn Premium !"}),r.jsx("p",{children:"Ton abonnement est actif. Profite de tous les contenus exclusifs."}),r.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/dashboard"),children:"Aller au tableau de bord"})]}),!h&&r.jsxs("section",{className:"premium-plans",children:[r.jsx("h2",{className:"premium-section__titre",children:"Choisir un abonnement"}),r.jsxs("div",{className:"premium-pricing__tabs",style:{marginBottom:"1.5rem"},children:[r.jsx("button",{type:"button",className:`premium-pricing__tab ${n==="a_la_carte"?"premium-pricing__tab--active":""}`,onClick:()=>{a("a_la_carte"),o("a_la_carte_3")},children:" Cours  la carte"}),r.jsx("button",{type:"button",className:`premium-pricing__tab ${n==="illimite"?"premium-pricing__tab--active":""}`,onClick:()=>{a("illimite"),o("illimite_6m")},children:" Accs illimit"})]}),r.jsx("div",{className:"premium-plans__grille",style:{gridTemplateColumns:n==="a_la_carte"?"repeat(auto-fit, minmax(160px, 1fr))":void 0},children:n==="a_la_carte"?r.jsx(r.Fragment,{children:["a_la_carte_1","a_la_carte_3","a_la_carte_7","a_la_carte_tous"].map(b=>r.jsxs("div",{className:`premium-plan-card ${l===b?"premium-plan-card--actif":""} ${b==="a_la_carte_3"?"premium-plan-card--populaire":""}`,onClick:()=>o(b),role:"button",tabIndex:0,onKeyDown:x=>x.key==="Enter"&&o(b),children:[b==="a_la_carte_3"&&r.jsx("div",{className:"premium-plan-card__badge-populaire",children:"Populaire"}),r.jsx("div",{className:"premium-plan-card__select",children:r.jsx("span",{className:l===b?"premium-plan-card__radio--actif":"premium-plan-card__radio"})}),r.jsxs("div",{className:"premium-plan-card__header",children:[r.jsx("span",{className:"premium-plan-card__icone",children:""}),r.jsx("h3",{className:"premium-plan-card__nom",children:Ri[b].label})]}),r.jsxs("div",{className:"premium-plan-card__prix",children:[r.jsx("span",{className:"premium-plan-card__montant",children:Ri[b].montant.toLocaleString("fr-FR")}),r.jsx("span",{className:"premium-plan-card__devise",children:"FCFA / mois"})]}),r.jsx("p",{className:"premium-plan-card__description",children:Ri[b].description})]},b))}):r.jsx(r.Fragment,{children:["illimite_3m","illimite_6m","illimite_1an"].map(b=>r.jsxs("div",{className:`premium-plan-card ${l===b?"premium-plan-card--actif":""} ${b==="illimite_6m"?"premium-plan-card--populaire":""}`,onClick:()=>o(b),role:"button",tabIndex:0,onKeyDown:x=>x.key==="Enter"&&o(b),children:[b==="illimite_6m"&&r.jsx("div",{className:"premium-plan-card__badge-populaire",children:" Meilleure offre"}),r.jsx("div",{className:"premium-plan-card__select",children:r.jsx("span",{className:l===b?"premium-plan-card__radio--actif":"premium-plan-card__radio"})}),r.jsxs("div",{className:"premium-plan-card__header",children:[r.jsx("span",{className:"premium-plan-card__icone",children:""}),r.jsx("h3",{className:"premium-plan-card__nom",children:Ri[b].label})]}),r.jsxs("div",{className:"premium-plan-card__prix",children:[r.jsx("span",{className:"premium-plan-card__montant",children:Ri[b].montant.toLocaleString("fr-FR")}),r.jsxs("span",{className:"premium-plan-card__devise",children:["FCFA / ",Ri[b].duree]})]}),b==="illimite_6m"&&r.jsx("div",{className:"premium-plan-card__economie",children:" conomisez 10 000 FCFA vs 23 mois"}),b==="illimite_1an"&&r.jsx("div",{className:"premium-plan-card__economie",children:" conomisez 30 000 FCFA vs 43 mois"}),r.jsx("p",{className:"premium-plan-card__description",children:Ri[b].description})]},b))})}),f&&r.jsxs("div",{className:"premium-erreur",role:"alert",children:[" ",f]}),r.jsxs("div",{className:"premium-paiement",children:[r.jsx("button",{className:"premium-btn premium-btn--principal",onClick:v,disabled:u,"aria-busy":u,children:u?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"premium-spinner","aria-hidden":"true"})," Redirection en cours"]}):r.jsxs(r.Fragment,{children:[" S'abonner  ",Ri[l]?.montant.toLocaleString("fr-FR")," FCFA"]})}),r.jsx("p",{className:"premium-paiement__securite",children:" Paiement 100% scuris via Moneroo"}),r.jsxs("div",{className:"premium-moyens-paiement",children:[r.jsx("p",{className:"premium-moyens-paiement__titre",children:"Moyens de paiement accepts :"}),r.jsx("div",{className:"premium-moyens-paiement__liste",children:c5.map(b=>r.jsxs("span",{className:"premium-moyen-badge",style:{borderColor:b.couleur,color:b.couleur},title:b.nom,children:[b.emoji," ",b.nom]},b.nom))})]})]})]}),r.jsxs("section",{className:"premium-avantages",children:[r.jsx("h2",{className:"premium-section__titre",children:"Ce qui est inclus"}),r.jsx("div",{className:"premium-avantages__grille",children:o5.map(b=>r.jsxs("div",{className:"premium-avantage-card",children:[r.jsx("span",{className:"premium-avantage-card__icone",children:b.icone}),r.jsxs("div",{className:"premium-avantage-card__texte",children:[r.jsx("h3",{children:b.titre}),r.jsx("p",{children:b.description})]})]},b.titre))})]}),r.jsxs("section",{className:"premium-faq",children:[r.jsx("h2",{className:"premium-section__titre",children:"Questions frquentes"}),r.jsxs("div",{className:"premium-faq__liste",children:[r.jsxs("div",{className:"premium-faq__item",children:[r.jsx("h3",{children:"Comment payer avec Wave ou Orange Money ?"}),r.jsx("p",{children:`Clique sur "S'abonner", tu seras redirig vers la page de paiement Moneroo. Choisis ton moyen de paiement prfr et suis les instructions.`})]}),r.jsxs("div",{className:"premium-faq__item",children:[r.jsx("h3",{children:"Mon accs est activ quand ?"}),r.jsx("p",{children:"L'accs Premium est activ automatiquement ds la confirmation de ton paiement, en quelques secondes."})]}),r.jsxs("div",{className:"premium-faq__item",children:[r.jsx("h3",{children:"Puis-je annuler mon abonnement ?"}),r.jsx("p",{children:"Oui. Contacte-nous via WhatsApp ou email. L'accs reste actif jusqu' la fin de la priode paye."})]}),r.jsxs("div",{className:"premium-faq__item",children:[r.jsx("h3",{children:"L'abonnement est-il renouvel automatiquement ?"}),r.jsx("p",{children:"Non. Tu recevras une notification avant l'expiration pour renouveler si tu le souhaites."})]})]})]})]})]})}const Rn="cours_en_ligne",Ws="cours_sections";function d5(e){const t=[/(?:youtube\.com\/watch\?v=)([^&\n?#]+)/,/(?:youtu\.be\/)([^&\n?#]+)/,/(?:youtube\.com\/embed\/)([^&\n?#]+)/];for(const n of t){const a=e.match(n);if(a)return a[1]}return null}async function bA(e){let t=Ee(je(K,Rn),Se("statut","==","publie"),Ve("updatedAt","desc"),ar(50));return(await Ce(t)).docs.map(l=>({id:l.id,...l.data()}))}async function yA(e){const t=await Dt(Ne(K,Rn,e));return t.exists()?{id:t.id,...t.data()}:null}async function m5(e){const t=Ee(je(K,Rn),Se("profId","==",e),Ve("updatedAt","desc"));return(await Ce(t)).docs.map(a=>({id:a.id,...a.data()}))}async function f5(){const e=Ee(je(K,Rn),Ve("updatedAt","desc"),ar(200));return(await Ce(e)).docs.map(n=>({id:n.id,...n.data()}))}async function p5(e,t,n){const a=Oe.now();return(await qt(je(K,Rn),{...n,profId:e,profNom:t,statut:n.statut??"brouillon",nombreInscrits:0,nombreSections:0,createdAt:a,updatedAt:a})).id}async function h5(e,t){await Qe(Ne(K,Rn,e),{...t,updatedAt:Oe.now()})}async function Cx(e){await Qe(Ne(K,Rn,e),{statut:"publie",publieAt:Oe.now(),updatedAt:Oe.now()})}async function v5(e){await Qe(Ne(K,Rn,e),{statut:"archive",updatedAt:Oe.now()})}async function g5(e){const t=Mn(K);(await Ce(Ee(je(K,Ws),Se("coursId","==",e)))).docs.forEach(a=>t.delete(a.ref)),t.delete(Ne(K,Rn,e)),await t.commit()}async function jA(e){const t=Ee(je(K,Ws),Se("coursId","==",e),Ve("ordre","asc"));return(await Ce(t)).docs.map(a=>({id:a.id,...a.data()}))}async function x5(e,t){const n=Mn(K),a=Oe.now(),l=Ne(je(K,Ws));return n.set(l,{...t,coursId:e,blocs:t.blocs??[],createdAt:a,updatedAt:a}),n.update(Ne(K,Rn,e),{nombreSections:Ks(1),updatedAt:a}),await n.commit(),l.id}async function M1(e,t){const n=Oe.now();let a={...t,updatedAt:n};t.blocs&&(a.dureeEstimee=NA(t.blocs)),await Qe(Ne(K,Ws,e),a)}async function b5(e,t){const n=Mn(K),a=Oe.now();n.delete(Ne(K,Ws,e)),n.update(Ne(K,Rn,t),{nombreSections:Ks(-1),updatedAt:a}),await n.commit()}async function y5(e){const t=Mn(K),n=Oe.now();e.forEach(({id:a,ordre:l})=>{t.update(Ne(K,Ws,a),{ordre:l,updatedAt:n})}),await t.commit()}async function j5(e,t){const n=t.map((a,l)=>({...a,ordre:l}));await Qe(Ne(K,Ws,e),{blocs:n,dureeEstimee:NA(n),updatedAt:Oe.now()})}function NA(e){let t=0;return e.forEach(n=>{switch(n.type){case"texte":t+=Math.max(1,Math.ceil(n.contenu.split(" ").length/200));break;case"video":t+=5;break;case"quiz":t+=2;break;case"exercice":t+=n.difficulte==="difficile"?10:n.difficulte==="moyen"?5:3;break;case"image":case"encadre":t+=1;break}}),Math.max(1,t)}async function N5(e){await Qe(Ne(K,Rn,e),{nombreInscrits:Ks(1)})}const _5=[{id:"illimite_3m",nom:"3 mois",description:"Accs illimit  tous les cours",prix:1e4,duree:"3 mois",nombreCoursMax:null,accesIllimite:!0},{id:"illimite_6m",nom:"6 mois",description:"Accs illimit  tous les cours",prix:2e4,duree:"6 mois",economie:"10 000 FCFA vs 23 mois",popular:!0,nombreCoursMax:null,accesIllimite:!0},{id:"illimite_1an",nom:"1 an",description:"Accs illimit  tous les cours",prix:3e4,duree:"12 mois",economie:"30 000 FCFA vs 43 mois",nombreCoursMax:null,accesIllimite:!0}],_A=[{id:"a_la_carte_1",nom:"1 cours",description:"Choisissez 1 cours par discipline et niveau",prix:1e3,duree:"1 mois",nombreCoursMax:1,accesIllimite:!1},{id:"a_la_carte_3",nom:"3 cours",description:"Choisissez 3 cours par discipline et niveau",prix:2e3,duree:"1 mois",nombreCoursMax:3,accesIllimite:!1},{id:"a_la_carte_7",nom:"7 cours",description:"Choisissez 7 cours par discipline et niveau",prix:5e3,duree:"1 mois",nombreCoursMax:7,accesIllimite:!1},{id:"a_la_carte_tous",nom:"Tous les contenus",description:"Accs  l'intgralit du catalogue",prix:25e3,duree:"9 mois",nombreCoursMax:null,accesIllimite:!0}],SA=[..._A,..._5];function Ib(e){return e.startsWith("a_la_carte_")}function S5(e){return SA.find(n=>n.id===e)?.nombreCoursMax??null}function w5(e){const t=SA.find(n=>n.id===e);return t?t.accesIllimite:["mensuel","annuel","illimite_3m","illimite_6m","illimite_1an"].includes(e)}async function C5(e,t){await Qe(Ne(K,"users",e),{coursChoisis:t,updatedAt:Ot()})}function E5(e,t,n,a){return t?w5(n||"illimite_6m")||!Ib(n||"illimite_6m")?!0:a.includes(e):!1}const Xs=["6me","5me","4me","3me","2nde","1re","Terminale"],P1=["2023-2024","2024-2025","2025-2026","2026-2027"],A5=["#2563eb","#7c3aed","#059669","#d97706","#dc2626","#0891b2","#db2777","#65a30d"],Hi={cours:{label:"Cours",emoji:"",color:"#3b82f6"},exercices:{label:"Exercices",emoji:"",color:"#8b5cf6"},correction:{label:"Correction",emoji:"",color:"#10b981"},devoir_surveille:{label:"Devoir surveill",emoji:"",color:"#f59e0b"},devoir_maison:{label:"Devoir  la maison",emoji:"",color:"#6366f1"},travaux_pratiques:{label:"Travaux pratiques",emoji:"",color:"#14b8a6"},evaluation:{label:"valuation",emoji:"",color:"#ef4444"},revision:{label:"Rvision",emoji:"",color:"#f97316"}},Tc={realise:{label:"Ralis",color:"#059669",bg:"#d1fae5"},planifie:{label:"Planifi",color:"#d97706",bg:"#fef3c7"},annule:{label:"Annul",color:"#dc2626",bg:"#fee2e2"},reporte:{label:"Report",color:"#2563eb",bg:"#dbeafe"}},wA={interro:"Interrogation",ds:"Devoir Surveill",examen:"Examen",oral:"Oral",autre:"Autre"},CA={devoir:{label:"Devoir  corriger",emoji:""},evaluation:{label:"valuation  prparer",emoji:""},notes:{label:"Notes  saisir",emoji:""},cours:{label:"Cours  prparer",emoji:""},personnalise:{label:"Rappel personnalis",emoji:""}},z5=["Communiquer  l'crit","Communiquer  l'oral","Raisonner et rsoudre des problmes","Chercher et s'informer","Modliser","Reprsenter","Calculer et algorithmiser","Analyser et interprter","Exprimenter et observer","Cooprer et mutualiser"],Ex={texte:{label:"Texte",emoji:"",description:"Paragraphe format"},image:{label:"Image",emoji:"",description:"Image avec lgende"},video:{label:"Vido",emoji:"",description:"Vido YouTube"},encadre:{label:"Encadr",emoji:"",description:"Dfinition, remarque, astuce..."},quiz:{label:"Quiz",emoji:"",description:"Question  choix multiple"},exercice:{label:"Exercice",emoji:"",description:"Problme avec correction"}},EA={definition:{label:"Dfinition",emoji:"",bg:"#eff6ff",border:"#2563eb",color:"#1d4ed8"},remarque:{label:"Remarque",emoji:"",bg:"#fefce8",border:"#ca8a04",color:"#854d0e"},attention:{label:"Attention",emoji:"",bg:"#fef2f2",border:"#dc2626",color:"#991b1b"},astuce:{label:"Astuce",emoji:"",bg:"#f0fdf4",border:"#16a34a",color:"#15803d"},exemple:{label:"Exemple",emoji:"",bg:"#f8fafc",border:"#64748b",color:"#475569"}},Lc=Xs.map(e=>({valeur:e,label:e==="3me"?"3me (BFEM)":e==="Terminale"?"Terminale (BAC)":e})),k5={brouillon:{label:"Brouillon",couleur:"#6b7280",bg:"#f3f4f6"},publie:{label:"Publi",couleur:"#16a34a",bg:"#f0fdf4"},archive:{label:"Archiv",couleur:"#9ca3af",bg:"#f9fafb"}},O5={"6eme":1,"6me":1,"5eme":2,"5me":2,"4eme":3,"4me":3,"3eme":4,"3me":4,"2nde":5,seconde:5,"1ere":6,"1re":6,terminale:7};function T1(e){const t=e.toLowerCase().trim();return O5[t]??99}function Zs(){const[e,t]=g.useState([]),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null);return g.useEffect(()=>{let f=!1;async function p(){o(!0),d(null);try{const h=Ee(je(K,"disciplines"),Ve("ordre")),v=await Ce(h);if(f)return;const b=new Set,x=new Set;v.forEach(w=>{const C=w.data();C.nom&&typeof C.nom=="string"&&b.add(C.nom.trim()),C.classe&&typeof C.classe=="string"&&x.add(C.classe.trim())});const j=Array.from(b).sort((w,C)=>w.localeCompare(C,"fr")).map(w=>({valeur:w,label:w})),N=Array.from(x).sort((w,C)=>{const E=T1(w),S=T1(C);return E!==S?E-S:w.localeCompare(C,"fr")}).map(w=>({valeur:w,label:w}));t(j),a(N)}catch(h){f||(console.error("[useDisciplinesOptions] Erreur Firestore :",h),d("Impossible de charger les matires/niveaux."))}finally{f||o(!1)}}return p(),()=>{f=!0}},[]),{matieres:e,niveaux:n,loading:l,error:u}}function D5(){const{currentUser:e}=Ze(),t=lt(),{matieres:n}=Zs(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,f]=g.useState(!1),[p,h]=g.useState(""),[v,b]=g.useState(""),[x,j]=g.useState(e?.coursChoisis??[]),N=e?.subscriptionPlan,w=S5(N||"a_la_carte_1"),C=Ib(N||"a_la_carte_1"),E=_A.find(M=>M.id===N);g.useEffect(()=>{S()},[]);async function S(){u(!0);try{const M=await bA();l(M)}catch{l([])}finally{u(!1)}}const A=a.filter(M=>!(p&&M.matiere!==p||v&&M.niveau!==v));function O(M){if(!w)return;x.indexOf(M)>=0?j(x.filter($=>$!==M)):x.length<w&&j([...x,M])}async function k(){if(e){f(!0);try{await C5(e.uid,x),t("/dashboard",{state:{message:"Vos cours ont t mis  jour."}})}catch{f(!1)}}}return e?.isPremium?!C||w===null?r.jsx("div",{className:"cours-catalogue",children:r.jsxs("div",{className:"cours-catalogue__hero",children:[r.jsx("h1",{children:"Accs illimit"}),r.jsx("p",{children:"Votre formule vous donne accs  tous les cours. Aucun choix  faire !"}),r.jsx(Fe,{to:"/cours",className:"btn btn--primary",children:"Voir le catalogue"})]})}):r.jsxs("div",{className:"cours-catalogue",children:[r.jsxs("section",{className:"cours-catalogue__hero",children:[r.jsx("h1",{className:"cours-catalogue__hero-titre",children:" Mes cours  la carte"}),r.jsxs("p",{className:"cours-catalogue__hero-sous-titre",children:["Choisissez jusqu' ",r.jsxs("strong",{children:[w," cours"]})," parmi le catalogue. Filtrez par discipline et niveau."]}),r.jsxs("div",{className:"premium-cours-choice__plan",children:[r.jsxs("span",{className:"badge badge--premium",children:[E?.nom,"  ",E?.prix.toLocaleString("fr-FR")," FCFA/mois"]}),r.jsxs("span",{className:"premium-cours-choice__count",children:[x.length," / ",w," cours slectionns"]})]})]}),r.jsx("section",{className:"cours-catalogue__filtres",children:r.jsxs("div",{className:"cours-catalogue__filtres-inner",children:[r.jsxs("select",{value:p,onChange:M=>h(M.target.value),className:"cours-catalogue__select","aria-label":"Filtrer par matire",children:[r.jsx("option",{value:"",children:"Toutes les matires"}),n.map(M=>r.jsx("option",{value:M.valeur,children:M.label},M.valeur))]}),r.jsxs("select",{value:v,onChange:M=>b(M.target.value),className:"cours-catalogue__select","aria-label":"Filtrer par niveau",children:[r.jsx("option",{value:"",children:"Tous les niveaux"}),Lc.map(M=>r.jsx("option",{value:M.valeur,children:M.label},M.valeur))]})]})}),r.jsx("main",{className:"cours-catalogue__contenu",children:o?r.jsx("div",{className:"cours-catalogue__grille","aria-busy":"true",children:[1,2,3,4].map(M=>r.jsxs("div",{className:"cours-card cours-card--skeleton",children:[r.jsx("div",{className:"skeleton cours-card__cover"}),r.jsxs("div",{className:"cours-card__body",children:[r.jsx("div",{className:"skeleton",style:{height:16,width:"60%",marginBottom:8}}),r.jsx("div",{className:"skeleton",style:{height:20,marginBottom:8}})]})]},M))}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"premium-cours-choice__actions",children:[r.jsx("button",{className:"btn-primary",onClick:k,disabled:d,children:d?"Enregistrement...":" Enregistrer mes choix"}),r.jsx(Fe,{to:"/cours",className:"btn-secondary",children:"Voir le catalogue"})]}),r.jsx("div",{className:"cours-catalogue__grille",children:A.map(M=>{const D=x.includes(M.id),$=x.length<(w||0)||D,U=Lc.find(L=>L.valeur===M.niveau)?.label??M.niveau;return r.jsxs("article",{className:`cours-card ${D?"cours-card--selected":""}`,onClick:()=>$&&O(M.id),role:"button",tabIndex:0,onKeyDown:L=>L.key==="Enter"&&$&&O(M.id),children:[r.jsxs("div",{className:"cours-card__cover",children:[M.couvertureUrl?r.jsx("img",{src:M.couvertureUrl,alt:M.titre,loading:"lazy"}):r.jsx("div",{className:"cours-card__cover-placeholder",children:r.jsx("span",{children:M.matiere.charAt(0)})}),r.jsx("span",{className:`cours-card__badge ${D?"cours-card__badge--premium":"cours-card__badge--gratuit"}`,children:D?" Slectionn":"Cliquer pour ajouter"})]}),r.jsxs("div",{className:"cours-card__body",children:[r.jsxs("div",{className:"cours-card__meta",children:[r.jsx("span",{className:"cours-card__matiere",children:M.matiere}),r.jsx("span",{className:"cours-card__niveau",children:U})]}),r.jsx("h3",{className:"cours-card__titre",children:M.titre}),r.jsx("p",{className:"cours-card__description",children:M.description})]})]},M.id)})}),A.length===0&&!o&&r.jsxs("div",{className:"cours-catalogue__vide",children:[r.jsx("span",{children:""}),r.jsx("h3",{children:"Aucun cours trouv"}),r.jsx("p",{children:"Modifiez vos filtres ou consultez le catalogue complet."})]})]})})]}):r.jsx("div",{className:"cours-catalogue",children:r.jsxs("div",{className:"cours-catalogue__hero",children:[r.jsx("h1",{children:"Choix des cours"}),r.jsx("p",{children:"Cette page est rserve aux abonns Premium."}),r.jsx(Fe,{to:"/premium",className:"btn btn--primary",children:"Dcouvrir Premium"})]})})}function M5(){const e=lt(),[t,n]=g.useState("chargement"),[a,l]=g.useState(null);return g.useEffect(()=>{async function o(){const{paymentId:u,paymentStatus:d}=l5();if(!u){e("/premium");return}if(d==="failed"||d==="cancelled"){n("echec"),l("Le paiement a t annul ou a chou. Aucun montant n'a t dbit.");return}try{const f=await i5(u);f.status==="success"?n("succes"):f.status==="pending"?n("attente"):(n("echec"),l("Le paiement n'a pas pu tre confirm. Contactez le support si le montant a t dbit."))}catch{n("attente")}}o()},[e]),t==="chargement"?r.jsx("div",{className:"premium-confirmation",children:r.jsxs("div",{className:"premium-confirmation__card",children:[r.jsx("div",{className:"premium-spinner premium-spinner--lg","aria-label":"Vrification en cours"}),r.jsx("h2",{children:"Vrification du paiement"}),r.jsx("p",{children:"Merci de patienter quelques secondes."})]})}):t==="succes"?r.jsx("div",{className:"premium-confirmation",children:r.jsxs("div",{className:"premium-confirmation__card premium-confirmation__card--succes",children:[r.jsx("div",{className:"premium-confirmation__icone premium-confirmation__icone--succes",children:""}),r.jsx("h1",{children:"Bienvenue dans Premium ! "}),r.jsxs("p",{className:"premium-confirmation__message",children:["Ton abonnement est activ. Tu as maintenant accs  ",r.jsx("strong",{children:"tous les cours, quiz et ressources"})," de PedaClic."]}),r.jsxs("div",{className:"premium-confirmation__actions",children:[r.jsx("button",{className:"premium-btn premium-btn--principal",onClick:()=>e("/dashboard"),children:" Accder au tableau de bord"}),r.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/cours"),children:" Voir les cours"})]})]})}):t==="attente"?r.jsx("div",{className:"premium-confirmation",children:r.jsxs("div",{className:"premium-confirmation__card premium-confirmation__card--attente",children:[r.jsx("div",{className:"premium-confirmation__icone premium-confirmation__icone--attente",children:""}),r.jsx("h1",{children:"Paiement en cours de traitement"}),r.jsx("p",{className:"premium-confirmation__message",children:"Ton paiement est en cours de vrification. Ton accs Premium sera activ automatiquement ds confirmation (gnralement moins de 5 minutes)."}),r.jsx("p",{className:"premium-confirmation__message",children:"Tu recevras une notification ds que c'est prt. Tu peux fermer cette page."}),r.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/dashboard"),children:"Aller au tableau de bord"})]})}):r.jsx("div",{className:"premium-confirmation",children:r.jsxs("div",{className:"premium-confirmation__card premium-confirmation__card--echec",children:[r.jsx("div",{className:"premium-confirmation__icone premium-confirmation__icone--echec",children:""}),r.jsx("h1",{children:"Paiement non abouti"}),r.jsx("p",{className:"premium-confirmation__message",children:a||"Une erreur est survenue lors du paiement."}),r.jsxs("div",{className:"premium-confirmation__actions",children:[r.jsx("button",{className:"premium-btn premium-btn--principal",onClick:()=>e("/premium"),children:" Ressayer"}),r.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/dashboard"),children:"Retour au tableau de bord"})]})]})})}const P5=[{title:"Principal",items:[{id:"dashboard",label:"Tableau de bord",icon:"",href:"/admin"},{id:"disciplines",label:"Disciplines",icon:"",href:"/admin/disciplines"},{id:"chapitres",label:"Chapitres",icon:"",href:"/admin/chapitres"},{id:"ressources",label:"Ressources",icon:"",href:"/admin/ressources"},{id:"cours",label:"Cours en ligne",icon:"",href:"/prof/cours"},{id:"ebooks",label:"Bibliothque Ebooks",icon:"",href:"/admin/ebooks"}]},{title:"valuation",items:[{id:"quiz",label:"Quiz",icon:"",href:"/admin/quiz"},{id:"quiz-avance",label:"Quiz Avancs",icon:"",href:"/admin/quiz-avance"},{id:"resultats",label:"Rsultats",icon:"",href:"/admin/resultats"}]},{title:"Utilisateurs",items:[{id:"utilisateurs",label:"Tous les utilisateurs",icon:"",href:"/admin/utilisateurs"},{id:"premium",label:"Abonns Premium",icon:"",href:"/admin/premium"}]},{title:"Outils IA",items:[{id:"generateur",label:"Gnrateur IA",icon:"",href:"/generateur"}]},{title:"Paramtres",items:[{id:"settings",label:"Configuration",icon:"",href:"/admin/settings"}]}],fn=({children:e,currentPage:t="dashboard"})=>{const{currentUser:n,logout:a}=Ze(),[l,o]=g.useState(!0),[u,d]=g.useState(!1),f=Ob(),p=async()=>{try{d(!0),await a(),window.location.href="/connexion"}catch(x){console.error("Erreur lors de la dconnexion:",x),d(!1)}},h=()=>n?.displayName?n.displayName.split(" ").map(x=>x[0]).join("").toUpperCase().slice(0,2):"AD",v=()=>{switch(n?.role){case"admin":return"Administrateur";case"prof":return"Professeur";case"eleve":return"lve";default:return"Utilisateur"}},b=x=>x.href==="/admin"?f.pathname==="/admin"||f.pathname==="/admin/":f.pathname.startsWith(x.href);return r.jsxs("div",{className:"admin-layout",children:[r.jsxs("aside",{className:`admin-sidebar ${l?"":"admin-sidebar--collapsed"}`,children:[r.jsx("header",{className:"admin-sidebar__header",children:r.jsxs(Fe,{to:"/",className:"admin-sidebar__logo",children:[r.jsx("div",{className:"admin-sidebar__logo-icon",children:""}),r.jsx("span",{children:"PedaClic"})]})}),r.jsx("nav",{className:"admin-sidebar__nav",children:P5.map((x,j)=>r.jsxs("div",{className:"admin-nav__section",children:[r.jsx("h3",{className:"admin-nav__title",children:x.title}),r.jsx("ul",{className:"admin-nav__list",children:x.items.map(N=>r.jsx("li",{className:"admin-nav__item",children:r.jsxs(Fe,{to:N.href,className:`admin-nav__link ${b(N)?"admin-nav__link--active":""}`,children:[r.jsx("span",{className:"admin-nav__icon",children:N.icon}),r.jsx("span",{className:"admin-nav__label",children:N.label})]})},N.id))})]},j))}),r.jsx("footer",{className:"admin-sidebar__footer",children:r.jsxs("div",{className:"admin-user",children:[r.jsx("div",{className:"admin-user__avatar",children:h()}),r.jsxs("div",{className:"admin-user__info",children:[r.jsx("div",{className:"admin-user__name",children:n?.displayName||"Administrateur"}),r.jsx("div",{className:"admin-user__role",children:v()})]}),r.jsx("button",{onClick:p,disabled:u,className:"admin-logout-btn",title:"Se dconnecter",children:u?"...":""})]})})]}),r.jsxs("main",{className:"admin-content",children:[r.jsx("button",{className:"admin-sidebar-toggle",onClick:()=>o(!l),"aria-label":"Toggle sidebar",children:""}),e]}),r.jsx("style",{children:`
        /* Bouton de dconnexion */
        .admin-logout-btn {
          width: 36px;
          height: 36px;
          border: none;
          background: rgba(255, 255, 255, 0.1);
          color: white;
          border-radius: var(--radius-md);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all var(--transition-base);
          font-size: var(--text-lg);
        }

        .admin-logout-btn:hover {
          background: rgba(255, 255, 255, 0.2);
        }

        .admin-logout-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        /* Bouton toggle sidebar (mobile) */
        .admin-sidebar-toggle {
          display: none;
          position: fixed;
          top: var(--spacing-md);
          left: var(--spacing-md);
          z-index: var(--z-fixed);
          width: 44px;
          height: 44px;
          border: none;
          background: var(--color-primary);
          color: white;
          border-radius: var(--radius-md);
          cursor: pointer;
          font-size: var(--text-xl);
        }

        @media (max-width: 768px) {
          .admin-sidebar-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
          }

          .admin-sidebar {
            transform: translateX(-100%);
            transition: transform var(--transition-base);
          }

          .admin-sidebar:not(.admin-sidebar--collapsed) {
            transform: translateX(0);
          }

          .admin-content {
            padding-top: calc(var(--spacing-xl) + 44px);
          }
        }

        /* Animation de la sidebar rduite */
        .admin-sidebar--collapsed {
          width: 80px;
        }

        .admin-sidebar--collapsed .admin-nav__label,
        .admin-sidebar--collapsed .admin-nav__title,
        .admin-sidebar--collapsed .admin-sidebar__logo span,
        .admin-sidebar--collapsed .admin-user__info {
          display: none;
        }

        .admin-sidebar--collapsed .admin-sidebar__logo {
          justify-content: center;
        }
      `})]})},Ii="chapitres",T5=e=>Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0)),qv=e=>{const t=e.data();return{id:e.id,disciplineId:t.disciplineId,numero:t.numero,titre:t.titre,description:t.description,objectifs:t.objectifs||[],dureeEstimee:t.dureeEstimee,isPremium:t.isPremium||!1,actif:t.actif!==!1,createdAt:t.createdAt?.toDate()||new Date,updatedAt:t.updatedAt?.toDate()}},Li={async getByDiscipline(e){try{const t=Ee(je(K,Ii),Se("disciplineId","==",e),Ve("numero","asc"));return(await Ce(t)).docs.map(qv)}catch(t){throw console.error("Erreur lors de la rcupration des chapitres:",t),new Error("Impossible de rcuprer les chapitres")}},async getAll(){try{const e=Ee(je(K,Ii),Ve("numero","asc"));return(await Ce(e)).docs.map(qv)}catch(e){throw console.error("Erreur lors de la rcupration des chapitres:",e),new Error("Impossible de rcuprer les chapitres")}},async getById(e){try{const t=Ne(K,Ii,e),n=await Dt(t);return n.exists()?qv(n):null}catch(t){throw console.error("Erreur lors de la rcupration du chapitre:",t),new Error("Impossible de rcuprer le chapitre")}},async create(e){try{return(await qt(je(K,Ii),{...e,actif:e.actif!==!1,createdAt:Ot(),updatedAt:Ot()})).id}catch(t){throw console.error("Erreur lors de la cration du chapitre:",t),new Error("Impossible de crer le chapitre")}},async update(e,t){try{const n=Ne(K,Ii,e),a=T5({...t,updatedAt:Ot()});await Qe(n,a)}catch(n){throw console.error("Erreur lors de la mise  jour du chapitre:",n),new Error("Impossible de mettre  jour le chapitre")}},async delete(e){try{const t=Ne(K,Ii,e);await rn(t)}catch(t){throw console.error("Erreur lors de la suppression du chapitre:",t),new Error("Impossible de supprimer le chapitre")}},async deleteByDiscipline(e){try{const t=await this.getByDiscipline(e),n=Mn(K);t.forEach(a=>{const l=Ne(K,Ii,a.id);n.delete(l)}),await n.commit()}catch(t){throw console.error("Erreur lors de la suppression des chapitres:",t),new Error("Impossible de supprimer les chapitres")}},async reorder(e,t){try{const n=Mn(K);t.forEach((a,l)=>{const o=Ne(K,Ii,a);n.update(o,{numero:l+1,updatedAt:Ot()})}),await n.commit()}catch(n){throw console.error("Erreur lors de la rorganisation des chapitres:",n),new Error("Impossible de rorganiser les chapitres")}},async toggleActive(e,t){await this.update(e,{actif:t})},async countByDiscipline(e){return(await this.getByDiscipline(e)).length},async getNextNumero(e){return await this.countByDiscipline(e)+1}},q5=()=>{const{currentUser:e}=Ze(),t=lt(),[n,a]=g.useState({totalDisciplines:0,totalChapitres:0,totalRessources:0,ressourcesPremium:0,ressourcesGratuites:0,totalCours:0,totalQuiz:0,totalQuizAvances:0,ressourcesParType:{cours:0,exercice:0,video:0,document:0,quiz:0}}),[l,o]=g.useState(!0),[u,d]=g.useState(null);return g.useEffect(()=>{(async()=>{try{o(!0),d(null);const[p,h,v,b,x,j]=await Promise.all([Ji.getAll(),Li.getAll(),Ba.getStats(),Ce(je(K,"quizzes")),Ce(je(K,"quizzes_v2")),Ce(je(K,"cours_en_ligne"))]);a({totalDisciplines:p.length,totalChapitres:h.length,totalRessources:v.total,ressourcesPremium:v.premium,ressourcesGratuites:v.gratuit,totalCours:j.size,totalQuiz:b.size,totalQuizAvances:x.size,ressourcesParType:v.parType})}catch(p){console.error("Erreur lors du chargement des statistiques:",p),d("Impossible de charger les statistiques")}finally{o(!1)}})()},[]),r.jsxs("div",{className:"admin-dashboard",children:[r.jsx("header",{className:"admin-page-header",children:r.jsxs("div",{className:"admin-page-header__info",children:[r.jsx("h1",{className:"admin-page-header__title",children:"Tableau de bord"}),r.jsxs("p",{className:"admin-page-header__subtitle",children:["Bienvenue, ",e?.displayName||"Administrateur"," ! Grez votre contenu pdagogique depuis cette interface."]})]})}),u&&r.jsxs("div",{className:"alert alert--error",children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:u})})]}),l?r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement des statistiques..."})]}):r.jsxs(r.Fragment,{children:[r.jsxs("section",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>t("/admin/disciplines"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&t("/admin/disciplines"),children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--primary",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.totalDisciplines}),r.jsx("div",{className:"stat-card__label",children:"Disciplines"})]})]}),r.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>t("/admin/chapitres"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&t("/admin/chapitres"),children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--secondary",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.totalChapitres}),r.jsx("div",{className:"stat-card__label",children:"Chapitres"})]})]}),r.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>t("/admin/ressources"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&t("/admin/ressources"),children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--info",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.totalRessources}),r.jsx("div",{className:"stat-card__label",children:"Ressources"})]})]}),r.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>t("/admin/ressources"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&t("/admin/ressources"),children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--warning",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.ressourcesPremium}),r.jsx("div",{className:"stat-card__label",children:"Ressources Premium"})]})]}),r.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>t("/prof/cours"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&t("/prof/cours"),children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--primary",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.totalCours}),r.jsx("div",{className:"stat-card__label",children:"Cours en ligne"})]})]}),r.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>t("/admin/quiz"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&t("/admin/quiz"),children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--quiz",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.totalQuiz}),r.jsx("div",{className:"stat-card__label",children:"Quiz"})]})]}),r.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>t("/admin/quiz-avance"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&t("/admin/quiz-avance"),children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--advanced",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.totalQuizAvances}),r.jsx("div",{className:"stat-card__label",children:"Quiz Avancs"})]})]})]}),r.jsxs("section",{className:"content-card",children:[r.jsx("div",{className:"content-card__header",children:r.jsx("h2",{children:"Rpartition des ressources par type"})}),r.jsx("div",{className:"content-card__body",children:r.jsxs("div",{className:"resource-type-grid",children:[r.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>t("/admin/ressources"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"resource-item__icon resource-item__icon--cours",children:""}),r.jsxs("div",{className:"resource-type-info",children:[r.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.cours}),r.jsx("span",{className:"resource-type-label",children:"Cours"})]})]}),r.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>t("/admin/ressources"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"resource-item__icon resource-item__icon--exercice",children:""}),r.jsxs("div",{className:"resource-type-info",children:[r.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.exercice}),r.jsx("span",{className:"resource-type-label",children:"Exercices"})]})]}),r.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>t("/admin/ressources"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"resource-item__icon resource-item__icon--video",children:""}),r.jsxs("div",{className:"resource-type-info",children:[r.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.video}),r.jsx("span",{className:"resource-type-label",children:"Vidos"})]})]}),r.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>t("/admin/ressources"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"resource-item__icon resource-item__icon--document",children:""}),r.jsxs("div",{className:"resource-type-info",children:[r.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.document}),r.jsx("span",{className:"resource-type-label",children:"Documents"})]})]}),r.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>t("/admin/quiz"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"resource-item__icon resource-item__icon--quiz",children:""}),r.jsxs("div",{className:"resource-type-info",children:[r.jsx("span",{className:"resource-type-value",children:n.totalQuiz+n.totalQuizAvances}),r.jsx("span",{className:"resource-type-label",children:"Quiz (tous)"})]})]})]})})]}),r.jsxs("section",{className:"content-card",style:{marginTop:"var(--spacing-xl)"},children:[r.jsx("div",{className:"content-card__header",children:r.jsx("h2",{children:"Actions rapides"})}),r.jsx("div",{className:"content-card__body",children:r.jsxs("div",{className:"quick-actions-grid",children:[r.jsxs("a",{href:"/admin/disciplines",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Grer les disciplines"}),r.jsx("p",{children:"Ajouter, modifier ou supprimer des matires"})]})]}),r.jsxs("a",{href:"/admin/chapitres",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Grer les chapitres"}),r.jsx("p",{children:"Organiser le contenu par chapitres"})]})]}),r.jsxs("a",{href:"/admin/ressources",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Grer les ressources"}),r.jsx("p",{children:"Cours, exercices, vidos et documents"})]})]}),r.jsxs("a",{href:"/admin/quiz",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Grer les quiz"}),r.jsx("p",{children:"Crer et modifier des quiz pour les lves"})]})]}),r.jsxs("a",{href:"/admin/quiz-avance",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Quiz avancs"}),r.jsx("p",{children:"Quiz interactifs avec niveaux de difficult"})]})]}),r.jsxs("a",{href:"/admin/utilisateurs",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Grer les utilisateurs"}),r.jsx("p",{children:"lves, professeurs et administrateurs"})]})]}),r.jsxs("a",{href:"/prof/cahiers",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Cahier de Textes"}),r.jsx("p",{children:"Planifier et suivre l'enseignement"})]})]}),r.jsxs("a",{href:"/prof/sequences",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Squences Pdagogiques"}),r.jsx("p",{children:"Crer et organiser des squences de cours"})]})]}),r.jsxs("a",{href:"/prof/cours",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Cours en ligne"}),r.jsx("p",{children:"Crer et grer les cours en ligne"})]})]})]})})]})]}),r.jsx("style",{children:`
        /* ====== Stat cards cliquables ====== */
        /* Curseur pointer + effet hover sur les cartes de statistiques */
        .stat-card--clickable {
          cursor: pointer;
          transition: all 0.2s ease;
        }
        .stat-card--clickable:hover {
          transform: translateY(-3px);
          box-shadow: var(--shadow-lg, 0 8px 24px rgba(0,0,0,0.12));
          border-color: var(--color-primary, #3182ce);
        }
        .stat-card--clickable:active {
          transform: translateY(-1px);
        }

        /* Icne quiz (violet) */
        .stat-card__icon--quiz {
          background: #f3e8ff;
          color: #7c3aed;
        }
        /* Icne quiz avanc (rose) */
        .stat-card__icon--advanced {
          background: #fce7f3;
          color: #db2777;
        }

        /* ====== Grille des types de ressources ====== */
        .resource-type-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
          gap: var(--spacing-lg);
        }

        .resource-type-item {
          display: flex;
          align-items: center;
          gap: var(--spacing-md);
          padding: var(--spacing-md);
          background: var(--color-bg-secondary);
          border-radius: var(--radius-lg);
        }

        /* Cartes de rpartition cliquables */
        .resource-type-item--clickable {
          cursor: pointer;
          transition: all 0.2s ease;
          border: 1px solid transparent;
        }
        .resource-type-item--clickable:hover {
          border-color: var(--color-primary, #3182ce);
          box-shadow: 0 2px 8px rgba(0,0,0,0.08);
          transform: translateY(-2px);
        }

        .resource-type-info {
          display: flex;
          flex-direction: column;
        }

        .resource-type-value {
          font-size: var(--text-2xl);
          font-weight: var(--font-bold);
          color: var(--color-text);
        }

        .resource-type-label {
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        /* ====== Actions rapides ====== */
        .quick-actions-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
          gap: var(--spacing-lg);
        }

        .quick-action-card {
          display: flex;
          align-items: flex-start;
          gap: var(--spacing-lg);
          padding: var(--spacing-lg);
          background: var(--color-bg-secondary);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-lg);
          text-decoration: none;
          color: inherit;
          transition: all var(--transition-base);
        }

        .quick-action-card:hover {
          border-color: var(--color-primary);
          box-shadow: var(--shadow-md);
          transform: translateY(-2px);
        }

        .quick-action-icon {
          font-size: 2rem;
          line-height: 1;
        }

        .quick-action-content h3 {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          margin-bottom: var(--spacing-xs);
          color: var(--color-text);
        }

        .quick-action-content p {
          font-size: var(--text-sm);
          color: var(--color-text-light);
          margin: 0;
        }

        @media (max-width: 768px) {
          .resource-type-grid,
          .quick-actions-grid {
            grid-template-columns: 1fr;
          }
        }
      `})]})},Ue={container:{maxWidth:"900px",margin:"0 auto",padding:"24px"},title:{fontSize:"1.5rem",fontWeight:700,color:"#1a365d",marginBottom:"24px"},form:{background:"#ffffff",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",marginBottom:"32px",border:"1px solid #e2e8f0"},formTitle:{fontSize:"1.1rem",fontWeight:600,color:"#2d3748",marginBottom:"20px",paddingBottom:"12px",borderBottom:"2px solid #3182ce"},formGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"16px",marginBottom:"20px"},fieldGroup:{display:"flex",flexDirection:"column",gap:"6px"},label:{fontSize:"0.875rem",fontWeight:600,color:"#4a5568"},labelOptional:{fontSize:"0.75rem",fontWeight:400,color:"#a0aec0",marginLeft:"4px"},input:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"0.95rem",outline:"none",transition:"border-color 0.2s"},select:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"0.95rem",background:"#fff",cursor:"pointer"},textarea:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"0.95rem",minHeight:"80px",resize:"vertical",fontFamily:"inherit"},btnPrimary:{padding:"12px 28px",background:"#3182ce",color:"#fff",border:"none",borderRadius:"8px",fontSize:"0.95rem",fontWeight:600,cursor:"pointer",transition:"background 0.2s"},btnSecondary:{padding:"12px 28px",background:"#e2e8f0",color:"#4a5568",border:"none",borderRadius:"8px",fontSize:"0.95rem",fontWeight:600,cursor:"pointer",marginLeft:"12px"},btnDanger:{padding:"6px 14px",background:"#fed7d7",color:"#c53030",border:"1px solid #fc8181",borderRadius:"6px",fontSize:"0.8rem",cursor:"pointer"},btnEdit:{padding:"6px 14px",background:"#ebf8ff",color:"#2b6cb0",border:"1px solid #90cdf4",borderRadius:"6px",fontSize:"0.8rem",cursor:"pointer",marginRight:"8px"},card:{background:"#fff",borderRadius:"10px",padding:"16px 20px",boxShadow:"0 1px 4px rgba(0,0,0,0.06)",border:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},badge:{display:"inline-block",padding:"3px 10px",borderRadius:"12px",fontSize:"0.75rem",fontWeight:600},badgeCollege:{background:"#ebf8ff",color:"#2b6cb0"},badgeLycee:{background:"#fefcbf",color:"#975a16"},badgeFormationLibre:{background:"#f0fff4",color:"#276749"},tabs:{display:"flex",gap:"8px",marginBottom:"20px",flexWrap:"wrap"},tab:{padding:"8px 20px",borderRadius:"8px",border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,transition:"all 0.2s"},tabActive:{background:"#3182ce",color:"#fff",borderColor:"#3182ce"}},Rv={nom:"",niveau:"college",classe:"6eme",ordre:0,coefficient:void 0,couleur:"",icone:"",description:""},R5=()=>{const[e,t]=g.useState([]),[n,a]=g.useState(Rv),[l,o]=g.useState(null),[u,d]=g.useState(!1),[f,p]=g.useState("all");g.useEffect(()=>{const E=Ee(je(K,"disciplines"),Ve("nom")),S=xf(E,A=>{const O=A.docs.map(k=>({id:k.id,...k.data(),createdAt:k.data().createdAt?.toDate()||new Date,updatedAt:k.data().updatedAt?.toDate()||new Date}));t(O)});return()=>S()},[]);const h=g.useCallback(E=>{const S=E1(E)[0]?.value||"6eme";a(A=>({...A,niveau:E,classe:S,coefficient:E==="formation_libre"?void 0:A.coefficient}))},[]),v=async E=>{if(E.preventDefault(),!!n.nom.trim()){d(!0);try{const S={nom:n.nom.trim(),niveau:n.niveau,classe:n.classe,ordre:n.ordre,...n.coefficient!==void 0&&{coefficient:n.coefficient},couleur:n.couleur||"",icone:n.icone||"",description:n.description||"",updatedAt:Oe.now()};l?await Qe(Ne(K,"disciplines",l),S):await qt(je(K,"disciplines"),{...S,createdAt:Oe.now()}),a(Rv),o(null)}catch(S){console.error("Erreur lors de la sauvegarde :",S),alert("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{d(!1)}}},b=E=>{a({nom:E.nom,niveau:E.niveau,classe:E.classe,ordre:E.ordre,coefficient:E.coefficient,couleur:E.couleur||"",icone:E.icone||"",description:E.description||""}),o(E.id)},x=async(E,S)=>{if(window.confirm(`Supprimer la discipline "${S}" ? Cette action est irrversible.`))try{await rn(Ne(K,"disciplines",E))}catch(A){console.error("Erreur lors de la suppression :",A)}},j=()=>{a(Rv),o(null)},N=E1(n.niveau),w=f==="all"?e:e.filter(E=>E.niveau===f),C=E=>({...Ue.badge,...E==="college"?Ue.badgeCollege:{},...E==="lycee"?Ue.badgeLycee:{},...E==="formation_libre"?Ue.badgeFormationLibre:{}});return r.jsxs("div",{style:Ue.container,children:[r.jsx("h2",{style:Ue.title,children:" Gestion des Disciplines"}),r.jsxs("form",{style:Ue.form,onSubmit:v,children:[r.jsx("h3",{style:Ue.formTitle,children:l?" Modifier la discipline":" Ajouter une discipline"}),r.jsxs("div",{style:Ue.formGrid,children:[r.jsxs("div",{style:Ue.fieldGroup,children:[r.jsx("label",{style:Ue.label,children:"Nom de la discipline"}),r.jsx("input",{type:"text",style:Ue.input,value:n.nom,onChange:E=>a({...n,nom:E.target.value}),placeholder:"Ex : Cuisine sngalaise, Couture, Franais...",required:!0})]}),r.jsxs("div",{style:Ue.fieldGroup,children:[r.jsx("label",{style:Ue.label,children:"Niveau"}),r.jsxs("select",{style:Ue.select,value:n.niveau,onChange:E=>h(E.target.value),children:[r.jsx("option",{value:"college",children:" Collge"}),r.jsx("option",{value:"lycee",children:" Lyce"}),r.jsx("option",{value:"formation_libre",children:" Formation libre"})]})]}),r.jsxs("div",{style:Ue.fieldGroup,children:[r.jsx("label",{style:Ue.label,children:n.niveau==="formation_libre"?"Niveau de formation":"Classe"}),r.jsx("select",{style:Ue.select,value:n.classe,onChange:E=>a({...n,classe:E.target.value}),children:N.map(({value:E,label:S})=>r.jsx("option",{value:E,children:S},E))})]}),r.jsxs("div",{style:Ue.fieldGroup,children:[r.jsx("label",{style:Ue.label,children:"Ordre d'affichage"}),r.jsx("input",{type:"number",style:Ue.input,value:n.ordre,onChange:E=>a({...n,ordre:Number(E.target.value)}),placeholder:"Ex : 1",min:"0"})]}),r.jsxs("div",{style:Ue.fieldGroup,children:[r.jsxs("label",{style:Ue.label,children:["Coefficient",n.niveau==="formation_libre"&&r.jsx("span",{style:Ue.labelOptional,children:"(optionnel)"})]}),r.jsx("input",{type:"number",style:Ue.input,value:n.coefficient??"",onChange:E=>a({...n,coefficient:E.target.value?Number(E.target.value):void 0}),placeholder:n.niveau==="formation_libre"?"Non requis":"Ex : 3",min:"1",max:"10",required:n.niveau!=="formation_libre"})]}),r.jsxs("div",{style:Ue.fieldGroup,children:[r.jsxs("label",{style:Ue.label,children:["Couleur",r.jsx("span",{style:Ue.labelOptional,children:"(optionnel)"})]}),r.jsx("input",{type:"color",style:{...Ue.input,maxWidth:"80px",padding:"4px",height:"40px"},value:n.couleur||"#3182ce",onChange:E=>a({...n,couleur:E.target.value})})]})]}),r.jsxs("div",{style:{...Ue.fieldGroup,marginBottom:"20px"},children:[r.jsxs("label",{style:Ue.label,children:["Description",r.jsx("span",{style:Ue.labelOptional,children:"(optionnel)"})]}),r.jsx("textarea",{style:Ue.textarea,value:n.description,onChange:E=>a({...n,description:E.target.value}),placeholder:"Brve description de la discipline..."})]}),r.jsxs("div",{style:{...Ue.fieldGroup,marginBottom:"20px"},children:[r.jsxs("label",{style:Ue.label,children:["Icne (emoji)",r.jsx("span",{style:Ue.labelOptional,children:"(optionnel)"})]}),r.jsx("input",{type:"text",style:{...Ue.input,maxWidth:"120px"},value:n.icone,onChange:E=>a({...n,icone:E.target.value}),placeholder:""})]}),r.jsxs("div",{children:[r.jsx("button",{type:"submit",style:Ue.btnPrimary,disabled:u,children:u?"Enregistrement...":l?"Mettre  jour":"Ajouter la discipline"}),l&&r.jsx("button",{type:"button",style:Ue.btnSecondary,onClick:j,children:"Annuler"})]})]}),r.jsxs("div",{children:[r.jsxs("h3",{style:Ue.formTitle,children:[" Disciplines existantes (",w.length,")"]}),r.jsxs("div",{style:Ue.tabs,children:[r.jsx("button",{style:{...Ue.tab,...f==="all"?Ue.tabActive:{}},onClick:()=>p("all"),children:"Toutes"}),r.jsx("button",{style:{...Ue.tab,...f==="college"?Ue.tabActive:{}},onClick:()=>p("college"),children:" Collge"}),r.jsx("button",{style:{...Ue.tab,...f==="lycee"?Ue.tabActive:{}},onClick:()=>p("lycee"),children:" Lyce"}),r.jsx("button",{style:{...Ue.tab,...f==="formation_libre"?Ue.tabActive:{}},onClick:()=>p("formation_libre"),children:" Formation libre"})]}),w.length===0?r.jsx("p",{style:{color:"#a0aec0",fontStyle:"italic",textAlign:"center",padding:"32px"},children:"Aucune discipline trouve pour ce filtre."}):w.map(E=>r.jsxs("div",{style:Ue.card,children:[r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[E.icone&&r.jsx("span",{style:{fontSize:"1.2rem"},children:E.icone}),r.jsx("strong",{style:{fontSize:"1rem",color:"#2d3748"},children:E.nom}),r.jsx("span",{style:C(E.niveau),children:vA[E.niveau]})]}),r.jsxs("div",{style:{fontSize:"0.85rem",color:"#718096"},children:[E.niveau==="formation_libre"?"Niveau":"Classe"," :"," ",gA(E.classe),E.coefficient!==void 0&&r.jsxs("span",{style:{marginLeft:"12px"},children:["| Coeff : ",E.coefficient]})]})]}),r.jsxs("div",{style:{display:"flex",gap:"4px"},children:[r.jsx("button",{style:Ue.btnEdit,onClick:()=>b(E),children:"Modifier"}),r.jsx("button",{style:Ue.btnDanger,onClick:()=>x(E.id,E.nom),children:"Supprimer"})]})]},E.id))]})]})},q1={numero:1,titre:"",description:"",objectifs:[],dureeEstimee:0,isPremium:!1,actif:!0},I5=()=>{const[e,t]=g.useState([]),[n,a]=g.useState([]),[l,o]=g.useState(""),[u,d]=g.useState(!0),[f,p]=g.useState(!1),[h,v]=g.useState(!1),[b,x]=g.useState(null),[j,N]=g.useState(null),[w,C]=g.useState(null),[E,S]=g.useState(!1),[A,O]=g.useState(!1),[k,M]=g.useState(null),[D,$]=g.useState(null),[U,L]=g.useState({...q1,disciplineId:""}),[B,ee]=g.useState({}),[se,P]=g.useState(""),q=g.useCallback(async()=>{try{d(!0);const Q=await Ji.getAll();t(Q),Q.length>0&&!l&&o(Q[0].id)}catch(Q){console.error("Erreur lors du chargement des disciplines:",Q),N("Impossible de charger les disciplines.")}finally{d(!1)}},[l]),F=g.useCallback(async()=>{if(!l){a([]);return}try{p(!0);const Q=await Li.getByDiscipline(l);a(Q)}catch(Q){console.error("Erreur lors du chargement des chapitres:",Q),N("Impossible de charger les chapitres.")}finally{p(!1)}},[l]);g.useEffect(()=>{q()},[q]),g.useEffect(()=>{F()},[F]);const R=()=>{const Q={};return U.disciplineId||(Q.disciplineId="Veuillez slectionner une discipline"),U.titre.trim()?U.titre.length<3&&(Q.titre="Le titre doit contenir au moins 3 caractres"):Q.titre="Le titre du chapitre est requis",U.numero<1&&(Q.numero="Le numro doit tre suprieur  0"),ee(Q),Object.keys(Q).length===0},W=Q=>{o(Q),N(null)},I=async()=>{const Q=await Li.getNextNumero(l);M(null),L({...q1,disciplineId:l,numero:Q}),ee({}),P(""),S(!0)},re=Q=>{M(Q),L({disciplineId:Q.disciplineId,numero:Q.numero,titre:Q.titre,description:Q.description,objectifs:Q.objectifs||[],dureeEstimee:Q.dureeEstimee,isPremium:Q.isPremium,actif:Q.actif}),ee({}),P(""),S(!0)},V=Q=>{$(Q),O(!0)},oe=()=>{S(!1),O(!1),M(null),$(null),ee({}),P("")},xe=Q=>{const{name:me,value:we,type:qe}=Q.target,We=Q.target.checked;L(Je=>({...Je,[me]:qe==="checkbox"?We:qe==="number"?Number(we):we})),B[me]&&ee(Je=>({...Je,[me]:void 0}))},ve=()=>{se.trim()&&(L(Q=>({...Q,objectifs:[...Q.objectifs||[],se.trim()]})),P(""))},H=Q=>{L(me=>({...me,objectifs:(me.objectifs||[]).filter((we,qe)=>qe!==Q)}))},he=async Q=>{if(Q.preventDefault(),!!R())try{v(!0),N(null),k?(await Li.update(k.id,U),C("Chapitre modifi avec succs !")):(await Li.create(U),C("Chapitre cr avec succs !")),oe(),await F(),setTimeout(()=>C(null),3e3)}catch(me){console.error("Erreur lors de la sauvegarde:",me),N("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{v(!1)}},Pe=async()=>{if(D)try{x(D.id),await Li.delete(D.id),C("Chapitre supprim avec succs !"),oe(),await F(),setTimeout(()=>C(null),3e3)}catch(Q){console.error("Erreur lors de la suppression:",Q),N("Erreur lors de la suppression. Veuillez ressayer.")}finally{x(null)}},ue=async Q=>{try{await Li.toggleActive(Q.id,!Q.actif),await F(),C(Q.actif?"Chapitre dsactiv":"Chapitre activ"),setTimeout(()=>C(null),2e3)}catch{N("Erreur lors de la mise  jour")}},X=Q=>{const me=e.find(we=>we.id===Q);return me?me.nom:"Non trouve"};return r.jsxs("div",{className:"chapitre-manager",children:[r.jsxs("header",{className:"admin-page-header",children:[r.jsxs("div",{className:"admin-page-header__info",children:[r.jsx("h1",{className:"admin-page-header__title",children:"Gestion des Chapitres"}),r.jsx("p",{className:"admin-page-header__subtitle",children:"Organisez le contenu pdagogique par chapitres"})]}),r.jsx("div",{className:"admin-page-header__actions",children:r.jsxs("button",{onClick:I,className:"btn btn--primary",disabled:!l||u,children:[r.jsx("span",{children:""}),"Nouveau chapitre"]})})]}),j&&r.jsxs("div",{className:"alert alert--error",children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:j})}),r.jsx("button",{onClick:()=>N(null),className:"alert__close",children:""})]}),w&&r.jsxs("div",{className:"alert alert--success",children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:w})})]}),r.jsx("div",{className:"content-card",style:{marginBottom:"var(--spacing-lg)"},children:r.jsx("div",{className:"content-card__body",children:r.jsxs("div",{className:"discipline-selector",children:[r.jsx("label",{className:"form-label",children:"Slectionner une discipline :"}),u?r.jsx("p",{className:"text-muted",children:"Chargement des disciplines..."}):e.length===0?r.jsxs("p",{className:"text-muted",children:["Aucune discipline disponible.",r.jsx("a",{href:"/admin/disciplines",children:" Crer une discipline"})]}):r.jsx("div",{className:"discipline-tabs",children:e.map(Q=>r.jsxs("button",{className:`discipline-tab ${l===Q.id?"discipline-tab--active":""}`,onClick:()=>W(Q.id),style:{"--discipline-color":Q.couleur||"#2563eb"},children:[r.jsx("span",{className:"discipline-tab__icon",children:Q.icone||""}),r.jsx("span",{className:"discipline-tab__name",children:Q.nom}),r.jsx("span",{className:"discipline-tab__class",children:Q.classe})]},Q.id))})]})})}),r.jsxs("div",{className:"admin-table-container",children:[r.jsx("div",{className:"admin-table-header",children:r.jsxs("h2",{className:"admin-table-title",children:["Chapitres ",l&&`- ${X(l)}`,n.length>0&&` (${n.length})`]})}),f?r.jsxs("div",{className:"loading-container",style:{padding:"var(--spacing-2xl)"},children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement des chapitres..."})]}):l?n.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-state__icon",children:""}),r.jsx("h3",{className:"empty-state__title",children:"Aucun chapitre"}),r.jsx("p",{className:"empty-state__message",children:"Cette discipline n'a pas encore de chapitres."}),r.jsx("button",{onClick:I,className:"btn btn--primary",children:"Crer le premier chapitre"})]}):r.jsx("div",{className:"chapitres-list",children:n.map(Q=>r.jsxs("div",{className:`chapitre-card ${Q.actif?"":"chapitre-card--inactive"}`,children:[r.jsx("div",{className:"chapitre-card__number",children:Q.numero}),r.jsxs("div",{className:"chapitre-card__content",children:[r.jsxs("h3",{className:"chapitre-card__title",children:[Q.titre,Q.isPremium&&r.jsx("span",{className:"badge badge--premium",children:"Premium"}),!Q.actif&&r.jsx("span",{className:"badge badge--warning",children:"Inactif"})]}),Q.description&&r.jsx("p",{className:"chapitre-card__description",children:Q.description}),r.jsxs("div",{className:"chapitre-card__meta",children:[Q.dureeEstimee&&r.jsxs("span",{children:[" ",Q.dureeEstimee,"h estime"]}),Q.objectifs&&Q.objectifs.length>0&&r.jsxs("span",{children:[" ",Q.objectifs.length," objectif(s)"]})]})]}),r.jsxs("div",{className:"chapitre-card__actions",children:[r.jsx("button",{onClick:()=>ue(Q),className:`table-action-btn ${Q.actif?"table-action-btn--view":"table-action-btn--edit"}`,title:Q.actif?"Dsactiver":"Activer",children:Q.actif?"":""}),r.jsx("button",{onClick:()=>re(Q),className:"table-action-btn table-action-btn--edit",title:"Modifier",children:""}),r.jsx("button",{onClick:()=>V(Q),className:"table-action-btn table-action-btn--delete",title:"Supprimer",disabled:b===Q.id,children:b===Q.id?"":""})]})]},Q.id))}):r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-state__icon",children:""}),r.jsx("h3",{className:"empty-state__title",children:"Slectionnez une discipline"}),r.jsx("p",{className:"empty-state__message",children:"Choisissez une discipline ci-dessus pour voir ses chapitres."})]})]}),E&&r.jsx("div",{className:"modal-overlay",onClick:oe,children:r.jsxs("div",{className:"modal modal--lg",onClick:Q=>Q.stopPropagation(),children:[r.jsxs("div",{className:"modal__header",children:[r.jsx("h2",{className:"modal__title",children:k?"Modifier le chapitre":"Nouveau chapitre"}),r.jsx("button",{onClick:oe,className:"modal__close",children:""})]}),r.jsxs("form",{onSubmit:he,children:[r.jsxs("div",{className:"modal__body",children:[!k&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label form-label--required",children:"Discipline"}),r.jsxs("select",{name:"disciplineId",className:`form-select ${B.disciplineId?"form-select--error":""}`,value:U.disciplineId,onChange:xe,children:[r.jsx("option",{value:"",children:"Slectionner une discipline"}),e.map(Q=>r.jsxs("option",{value:Q.id,children:[Q.icone," ",Q.nom," (",Q.classe,")"]},Q.id))]}),B.disciplineId&&r.jsx("span",{className:"form-error",children:B.disciplineId})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",style:{flex:"0 0 100px"},children:[r.jsx("label",{className:"form-label form-label--required",children:"N"}),r.jsx("input",{type:"number",name:"numero",className:`form-input ${B.numero?"form-input--error":""}`,min:"1",value:U.numero,onChange:xe}),B.numero&&r.jsx("span",{className:"form-error",children:B.numero})]}),r.jsxs("div",{className:"form-group",style:{flex:1},children:[r.jsx("label",{className:"form-label form-label--required",children:"Titre du chapitre"}),r.jsx("input",{type:"text",name:"titre",className:`form-input ${B.titre?"form-input--error":""}`,placeholder:"Ex: Les fractions, La Rvolution franaise...",value:U.titre,onChange:xe}),B.titre&&r.jsx("span",{className:"form-error",children:B.titre})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Description"}),r.jsx("textarea",{name:"description",className:"form-textarea",rows:3,placeholder:"Description du chapitre...",value:U.description||"",onChange:xe})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Objectifs pdagogiques"}),r.jsxs("div",{className:"objectifs-input",children:[r.jsx("input",{type:"text",className:"form-input",placeholder:"Ajouter un objectif...",value:se,onChange:Q=>P(Q.target.value),onKeyPress:Q=>Q.key==="Enter"&&(Q.preventDefault(),ve())}),r.jsx("button",{type:"button",onClick:ve,className:"btn btn--outline btn--sm",children:"Ajouter"})]}),U.objectifs&&U.objectifs.length>0&&r.jsx("ul",{className:"objectifs-list",children:U.objectifs.map((Q,me)=>r.jsxs("li",{className:"objectif-item",children:[r.jsxs("span",{children:[" ",Q]}),r.jsx("button",{type:"button",onClick:()=>H(me),className:"objectif-remove",children:""})]},me))})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Dure estime (heures)"}),r.jsx("input",{type:"number",name:"dureeEstimee",className:"form-input",min:"0",step:"0.5",placeholder:"Ex: 2",value:U.dureeEstimee||"",onChange:xe})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Options"}),r.jsxs("div",{className:"form-options",children:[r.jsxs("label",{className:"form-checkbox",children:[r.jsx("input",{type:"checkbox",name:"isPremium",checked:U.isPremium,onChange:xe}),r.jsx("span",{children:"Contenu Premium "})]}),r.jsxs("label",{className:"form-checkbox",children:[r.jsx("input",{type:"checkbox",name:"actif",checked:U.actif!==!1,onChange:xe}),r.jsx("span",{children:"Chapitre actif"})]})]})]})]})]}),r.jsxs("div",{className:"modal__footer",children:[r.jsx("button",{type:"button",onClick:oe,className:"btn btn--outline",disabled:h,children:"Annuler"}),r.jsx("button",{type:"submit",className:"btn btn--primary",disabled:h,children:h?"Enregistrement...":k?"Mettre  jour":"Crer le chapitre"})]})]})]})}),A&&D&&r.jsx("div",{className:"modal-overlay",onClick:oe,children:r.jsxs("div",{className:"modal",onClick:Q=>Q.stopPropagation(),children:[r.jsxs("div",{className:"modal__header",children:[r.jsx("h2",{className:"modal__title",children:"Confirmer la suppression"}),r.jsx("button",{onClick:oe,className:"modal__close",children:""})]}),r.jsxs("div",{className:"modal__body",children:[r.jsxs("p",{children:["Supprimer le chapitre ",r.jsxs("strong",{children:[D.numero,". ",D.titre]})," ?"]}),r.jsxs("div",{className:"alert alert--warning",style:{marginTop:"var(--spacing-md)"},children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:"Les ressources associes ne seront pas supprimes automatiquement."})})]})]}),r.jsxs("div",{className:"modal__footer",children:[r.jsx("button",{onClick:oe,className:"btn btn--outline",children:"Annuler"}),r.jsx("button",{onClick:Pe,className:"btn btn--danger",disabled:b!==null,children:b?"Suppression...":"Supprimer"})]})]})}),r.jsx("style",{children:`
        /* Slecteur de discipline */
        .discipline-tabs {
          display: flex;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
          margin-top: var(--spacing-md);
        }

        .discipline-tab {
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          padding: var(--spacing-sm) var(--spacing-md);
          border: 2px solid var(--color-border);
          border-radius: var(--radius-lg);
          background: white;
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .discipline-tab:hover {
          border-color: var(--discipline-color, var(--color-primary));
        }

        .discipline-tab--active {
          border-color: var(--discipline-color, var(--color-primary));
          background: color-mix(in srgb, var(--discipline-color, var(--color-primary)) 10%, white);
        }

        .discipline-tab__icon {
          font-size: var(--text-lg);
        }

        .discipline-tab__name {
          font-weight: var(--font-medium);
        }

        .discipline-tab__class {
          font-size: var(--text-xs);
          color: var(--color-text-light);
          background: var(--color-bg-secondary);
          padding: 2px 6px;
          border-radius: var(--radius-sm);
        }

        /* Liste des chapitres */
        .chapitres-list {
          display: flex;
          flex-direction: column;
          gap: var(--spacing-md);
          padding: var(--spacing-lg);
        }

        .chapitre-card {
          display: flex;
          align-items: center;
          gap: var(--spacing-lg);
          padding: var(--spacing-lg);
          background: var(--color-bg-secondary);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-lg);
          transition: all var(--transition-base);
        }

        .chapitre-card:hover {
          border-color: var(--color-primary);
          box-shadow: var(--shadow-md);
        }

        .chapitre-card--inactive {
          opacity: 0.6;
          background: var(--color-bg-tertiary);
        }

        .chapitre-card__number {
          width: 48px;
          height: 48px;
          background: var(--color-primary);
          color: white;
          border-radius: var(--radius-md);
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
          flex-shrink: 0;
        }

        .chapitre-card__content {
          flex: 1;
          min-width: 0;
        }

        .chapitre-card__title {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          margin-bottom: var(--spacing-xs);
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
        }

        .chapitre-card__description {
          font-size: var(--text-sm);
          color: var(--color-text-light);
          margin: 0 0 var(--spacing-sm);
        }

        .chapitre-card__meta {
          display: flex;
          gap: var(--spacing-lg);
          font-size: var(--text-xs);
          color: var(--color-text-lighter);
        }

        .chapitre-card__actions {
          display: flex;
          gap: var(--spacing-sm);
        }

        /* Formulaire: Ligne */
        .form-row {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: var(--spacing-lg);
        }

        @media (max-width: 600px) {
          .form-row {
            grid-template-columns: 1fr;
          }
        }

        /* Objectifs */
        .objectifs-input {
          display: flex;
          gap: var(--spacing-sm);
        }

        .objectifs-list {
          list-style: none;
          margin-top: var(--spacing-md);
        }

        .objectif-item {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: var(--spacing-sm) var(--spacing-md);
          background: var(--color-bg-secondary);
          border-radius: var(--radius-md);
          margin-bottom: var(--spacing-xs);
        }

        .objectif-remove {
          background: none;
          border: none;
          cursor: pointer;
          color: var(--color-error);
          opacity: 0.7;
        }

        .objectif-remove:hover {
          opacity: 1;
        }

        /* Options */
        .form-options {
          display: flex;
          flex-direction: column;
          gap: var(--spacing-sm);
          margin-top: var(--spacing-sm);
        }
      `})]})},Td=[{value:"cours",label:"Cours",icon:"",color:"#2563eb"},{value:"exercice",label:"Exercice",icon:"",color:"#10b981"},{value:"video",label:"Vido",icon:"",color:"#ef4444"},{value:"document",label:"Document",icon:"",color:"#f59e0b"},{value:"quiz",label:"Quiz",icon:"",color:"#8b5cf6"}],qd={cours:[".pdf",".doc",".docx",".ppt",".pptx"],exercice:[".pdf",".doc",".docx"],video:[".mp4",".webm",".mov",".avi"],document:[".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx"],quiz:[".json",".pdf"]},Iv=50,R1={titre:"",type:"cours",description:"",contenu:"",chapitre:"",ordre:1,isPremium:!1,actif:!0,tags:[],duree:void 0,urlExterne:""},L5=()=>{const{currentUser:e}=Ze(),[t,n]=g.useState([]),[a,l]=g.useState([]),[o,u]=g.useState([]),[d,f]=g.useState([]),[p,h]=g.useState(""),[v,b]=g.useState(""),[x,j]=g.useState(""),[N,w]=g.useState(""),[C,E]=g.useState(""),[S,A]=g.useState(!0),[O,k]=g.useState(!1),[M,D]=g.useState(!1),[$,U]=g.useState(!1),[L,B]=g.useState(null),[ee,se]=g.useState(!1),[P,q]=g.useState(0),[F,R]=g.useState(null),[W,I]=g.useState(null),[re,V]=g.useState(!1),[oe,xe]=g.useState(!1),[ve,H]=g.useState(!1),[he,Pe]=g.useState(null),[ue,X]=g.useState(null),[Q,me]=g.useState(null),[we,qe]=g.useState({...R1,disciplineId:""}),[We,Je]=g.useState({}),[at,br]=g.useState(null),[Pr,lr]=g.useState(null),an=g.useRef(null),[pe,Ae]=g.useState(""),Re=g.useCallback(async()=>{try{A(!0);const ne=await Ji.getAll();n(ne),ne.length>0&&!p&&h(ne[0].id)}catch(ne){console.error("Erreur lors du chargement des disciplines:",ne),R("Impossible de charger les disciplines.")}finally{A(!1)}},[p]),He=g.useCallback(async()=>{if(!p){l([]);return}try{k(!0);const ne=await Li.getByDiscipline(p);l(ne)}catch(ne){console.error("Erreur lors du chargement des chapitres:",ne)}finally{k(!1)}},[p]),xt=g.useCallback(async()=>{if(!p){u([]),f([]);return}try{D(!0);const ne=await Ba.getByDiscipline(p);u(ne),f(ne)}catch(ne){console.error("Erreur lors du chargement des ressources:",ne),R("Impossible de charger les ressources.")}finally{D(!1)}},[p]);g.useEffect(()=>{Re()},[Re]),g.useEffect(()=>{He()},[He]),g.useEffect(()=>{xt()},[xt]),g.useEffect(()=>{let ne=[...o];if(v&&(ne=ne.filter($e=>$e.chapitre===v)),x&&(ne=ne.filter($e=>$e.type===x)),N==="premium"?ne=ne.filter($e=>$e.isPremium):N==="free"&&(ne=ne.filter($e=>!$e.isPremium)),C){const $e=C.toLowerCase();ne=ne.filter(St=>St.titre.toLowerCase().includes($e)||St.description?.toLowerCase().includes($e)||St.tags?.some(zr=>zr.toLowerCase().includes($e)))}f(ne)},[o,v,x,N,C]);const It=()=>{const ne={};if(we.disciplineId||(ne.disciplineId="Veuillez slectionner une discipline"),we.titre.trim()?we.titre.length<3&&(ne.titre="Le titre doit contenir au moins 3 caractres"):ne.titre="Le titre est requis",we.type||(ne.type="Veuillez slectionner un type de ressource"),at){const $e="."+at.name.split(".").pop()?.toLowerCase(),St=qd[we.type];St.includes($e)||(ne.fichier=`Extension non autorise. Extensions acceptes : ${St.join(", ")}`),at.size/(1024*1024)>Iv&&(ne.fichier=`Le fichier est trop volumineux (max ${Iv} Mo)`)}return Je(ne),Object.keys(ne).length===0},tr=ne=>{h(ne),b(""),R(null)},Gr=()=>{Pe(null),qe({...R1,disciplineId:p}),Je({}),br(null),lr(null),Ae(""),V(!0)},J=ne=>{Pe(ne),qe({disciplineId:ne.disciplineId,titre:ne.titre,type:ne.type,description:ne.description,contenu:ne.contenu,chapitre:ne.chapitre||"",ordre:ne.ordre,isPremium:ne.isPremium,actif:ne.actif,tags:ne.tags||[],duree:ne.duree,urlExterne:ne.urlExterne||""}),Je({}),br(null),lr(ne.fichierURL||null),Ae(""),V(!0)},Me=ne=>{me(ne),H(!0)},ot=ne=>{X(ne),xe(!0)},Z=()=>{V(!1),xe(!1),H(!1),Pe(null),X(null),me(null),Je({}),br(null),lr(null),Ae("")},ce=ne=>{const{name:$e,value:St,type:zr}=ne.target,wo=ne.target.checked;qe(is=>({...is,[$e]:zr==="checkbox"?wo:zr==="number"?Number(St):St})),We[$e]&&Je(is=>({...is,[$e]:void 0}))},_e=ne=>{const $e=ne.target.files?.[0];if($e)if(br($e),Je(St=>({...St,fichier:void 0})),$e.type.startsWith("image/")||$e.type.startsWith("video/")){const St=new FileReader;St.onloadend=()=>{lr(St.result)},St.readAsDataURL($e)}else lr(null)},Xe=()=>{br(null),lr(null),an.current&&(an.current.value="")},Ar=()=>{pe.trim()&&!we.tags?.includes(pe.trim())&&(qe(ne=>({...ne,tags:[...ne.tags||[],pe.trim()]})),Ae(""))},$n=ne=>{qe($e=>({...$e,tags:($e.tags||[]).filter((St,zr)=>zr!==ne)}))},Bn=async ne=>{if(ne.preventDefault(),!!It())try{U(!0),R(null);let $e=he?.fichierURL,St=he?.fichierNom;if(at){se(!0);const wo=he?.id||`temp_${Date.now()}`;$e=await Ba.uploadFile(at,wo),St=at?.name||"fichier",se(!1)}const zr={...we,fichierURL:$e,fichierNom:St};he?(await Ba.update(he.id,zr),I("Ressource modifie avec succs !")):(await Ba.create(zr,"admin"),I("Ressource cre avec succs !")),Z(),await xt(),setTimeout(()=>I(null),3e3)}catch($e){console.error("Erreur lors de la sauvegarde:",$e),R("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{U(!1),se(!1),q(0)}},ra=async()=>{if(ue)try{B(ue.id),ue.fichierURL&&await Ba.deleteFile(ue.fichierURL),await Ba.delete(ue.id),I("Ressource supprime avec succs !"),Z(),await xt(),setTimeout(()=>I(null),3e3)}catch(ne){console.error("Erreur lors de la suppression:",ne),R("Erreur lors de la suppression. Veuillez ressayer.")}finally{B(null)}},il=async ne=>{try{await Ba.togglePremium(ne.id,!ne.isPremium),await xt(),I(ne.isPremium?"Ressource passe en gratuit":"Ressource passe en Premium"),setTimeout(()=>I(null),2e3)}catch{R("Erreur lors de la mise  jour")}},sl=ne=>{const $e=t.find(St=>St.id===ne);return $e?$e.nom:"Non trouve"},Na=ne=>{const $e=a.find(St=>St.id===ne);return $e?`${$e.numero}. ${$e.titre}`:""},na=ne=>Td.find($e=>$e.value===ne)||Td[0],as=ne=>ne<1024?ne+" o":ne<1024*1024?(ne/1024).toFixed(1)+" Ko":(ne/(1024*1024)).toFixed(1)+" Mo";return r.jsxs("div",{className:"resource-manager",children:[r.jsxs("header",{className:"admin-page-header",children:[r.jsxs("div",{className:"admin-page-header__info",children:[r.jsx("h1",{className:"admin-page-header__title",children:"Gestion des Ressources"}),r.jsx("p",{className:"admin-page-header__subtitle",children:"Grez les cours, exercices, vidos et documents pdagogiques"})]}),r.jsx("div",{className:"admin-page-header__actions",children:r.jsxs("button",{onClick:Gr,className:"btn btn--primary",disabled:!p||S,children:[r.jsx("span",{children:""}),"Nouvelle ressource"]})})]}),F&&r.jsxs("div",{className:"alert alert--error",children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:F})}),r.jsx("button",{onClick:()=>R(null),className:"alert__close",children:""})]}),W&&r.jsxs("div",{className:"alert alert--success",children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:W})})]}),r.jsx("div",{className:"content-card",style:{marginBottom:"var(--spacing-lg)"},children:r.jsx("div",{className:"content-card__body",children:r.jsxs("div",{className:"discipline-selector",children:[r.jsx("label",{className:"form-label",children:"Slectionner une discipline :"}),S?r.jsx("p",{className:"text-muted",children:"Chargement des disciplines..."}):t.length===0?r.jsxs("p",{className:"text-muted",children:["Aucune discipline disponible.",r.jsx("a",{href:"/admin/disciplines",children:" Crer une discipline"})]}):r.jsx("div",{className:"discipline-tabs",children:t.map(ne=>r.jsxs("button",{className:`discipline-tab ${p===ne.id?"discipline-tab--active":""}`,onClick:()=>tr(ne.id),style:{"--discipline-color":ne.couleur||"#2563eb"},children:[r.jsx("span",{className:"discipline-tab__icon",children:ne.icone||""}),r.jsx("span",{className:"discipline-tab__name",children:ne.nom}),r.jsx("span",{className:"discipline-tab__class",children:ne.classe})]},ne.id))})]})})}),r.jsxs("div",{className:"admin-table-container",children:[r.jsxs("div",{className:"admin-table-header",children:[r.jsxs("h2",{className:"admin-table-title",children:["Ressources ",p&&`- ${sl(p)}`,d.length>0&&` (${d.length})`]}),r.jsxs("div",{className:"admin-table-actions",children:[r.jsxs("div",{className:"search-input",children:[r.jsx("span",{className:"search-input__icon",children:""}),r.jsx("input",{type:"text",className:"search-input__field",placeholder:"Rechercher...",value:C,onChange:ne=>E(ne.target.value)})]}),r.jsxs("select",{className:"form-select form-select--sm",value:v,onChange:ne=>b(ne.target.value),disabled:O||a.length===0,children:[r.jsx("option",{value:"",children:"Tous les chapitres"}),a.map(ne=>r.jsxs("option",{value:ne.id,children:[ne.numero,". ",ne.titre]},ne.id))]}),r.jsxs("select",{className:"form-select form-select--sm",value:x,onChange:ne=>j(ne.target.value),children:[r.jsx("option",{value:"",children:"Tous les types"}),Td.map(ne=>r.jsxs("option",{value:ne.value,children:[ne.icon," ",ne.label]},ne.value))]}),r.jsxs("select",{className:"form-select form-select--sm",value:N,onChange:ne=>w(ne.target.value),children:[r.jsx("option",{value:"",children:"Tous"}),r.jsx("option",{value:"premium",children:" Premium"}),r.jsx("option",{value:"free",children:"Gratuit"})]})]})]}),M?r.jsxs("div",{className:"loading-container",style:{padding:"var(--spacing-2xl)"},children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement des ressources..."})]}):p?d.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-state__icon",children:""}),r.jsx("h3",{className:"empty-state__title",children:"Aucune ressource"}),r.jsx("p",{className:"empty-state__message",children:C||x||N||v?"Aucune ressource ne correspond aux critres de recherche.":"Cette discipline n'a pas encore de ressources."}),!C&&!x&&!N&&!v&&r.jsx("button",{onClick:Gr,className:"btn btn--primary",children:"Crer la premire ressource"})]}):r.jsx("div",{className:"resource-list",style:{padding:"var(--spacing-lg)"},children:d.map(ne=>{const $e=na(ne.type);return r.jsxs("div",{className:"resource-item",children:[r.jsx("div",{className:`resource-item__icon resource-item__icon--${ne.type}`,style:{backgroundColor:`${$e.color}15`,color:$e.color},children:$e.icon}),r.jsxs("div",{className:"resource-item__content",children:[r.jsxs("div",{className:"resource-item__title",children:[ne.titre,ne.isPremium&&r.jsx("span",{className:"badge badge--premium",children:"Premium"}),!ne.actif&&r.jsx("span",{className:"badge badge--warning",children:"Inactif"})]}),r.jsxs("div",{className:"resource-item__meta",children:[r.jsx("span",{children:$e.label}),ne.chapitre&&r.jsxs("span",{children:[" ",Na(ne.chapitre)]}),ne.duree&&r.jsxs("span",{children:[" ",ne.duree," min"]}),ne.fichierNom&&r.jsxs("span",{children:[" ",ne.fichierNom]}),ne.tags&&ne.tags.length>0&&r.jsxs("span",{children:[" ",ne.tags.join(", ")]})]})]}),r.jsxs("div",{className:"resource-item__actions",children:[r.jsx("button",{onClick:()=>il(ne),className:`table-action-btn ${ne.isPremium?"table-action-btn--warning":"table-action-btn--view"}`,title:ne.isPremium?"Passer en gratuit":"Passer en Premium",children:ne.isPremium?"":""}),(ne.fichierURL||ne.urlExterne)&&r.jsx("button",{onClick:()=>Me(ne),className:"table-action-btn table-action-btn--view",title:"Prvisualiser",children:""}),r.jsx("button",{onClick:()=>J(ne),className:"table-action-btn table-action-btn--edit",title:"Modifier",children:""}),r.jsx("button",{onClick:()=>ot(ne),className:"table-action-btn table-action-btn--delete",title:"Supprimer",disabled:L===ne.id,children:L===ne.id?"":""})]})]},ne.id)})}):r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-state__icon",children:""}),r.jsx("h3",{className:"empty-state__title",children:"Slectionnez une discipline"}),r.jsx("p",{className:"empty-state__message",children:"Choisissez une discipline ci-dessus pour voir ses ressources."})]})]}),re&&r.jsx("div",{className:"modal-overlay",onClick:Z,children:r.jsxs("div",{className:"modal modal--xl",onClick:ne=>ne.stopPropagation(),children:[r.jsxs("div",{className:"modal__header",children:[r.jsx("h2",{className:"modal__title",children:he?"Modifier la ressource":"Nouvelle ressource"}),r.jsx("button",{onClick:Z,className:"modal__close",children:""})]}),r.jsxs("form",{onSubmit:Bn,children:[r.jsxs("div",{className:"modal__body",children:[!he&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label form-label--required",children:"Discipline"}),r.jsxs("select",{name:"disciplineId",className:`form-select ${We.disciplineId?"form-select--error":""}`,value:we.disciplineId,onChange:ce,children:[r.jsx("option",{value:"",children:"Slectionner une discipline"}),t.map(ne=>r.jsxs("option",{value:ne.id,children:[ne.icone," ",ne.nom," (",ne.classe,")"]},ne.id))]}),We.disciplineId&&r.jsx("span",{className:"form-error",children:We.disciplineId})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",style:{flex:2},children:[r.jsx("label",{className:"form-label form-label--required",children:"Titre"}),r.jsx("input",{type:"text",name:"titre",className:`form-input ${We.titre?"form-input--error":""}`,placeholder:"Ex: Introduction aux fractions",value:we.titre,onChange:ce}),We.titre&&r.jsx("span",{className:"form-error",children:We.titre})]}),r.jsxs("div",{className:"form-group",style:{flex:1},children:[r.jsx("label",{className:"form-label form-label--required",children:"Type"}),r.jsx("select",{name:"type",className:`form-select ${We.type?"form-select--error":""}`,value:we.type,onChange:ce,children:Td.map(ne=>r.jsxs("option",{value:ne.value,children:[ne.icon," ",ne.label]},ne.value))}),We.type&&r.jsx("span",{className:"form-error",children:We.type})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Chapitre (optionnel)"}),r.jsxs("select",{name:"chapitreId",className:"form-select",value:we.chapitre||"",onChange:ce,disabled:O,children:[r.jsx("option",{value:"",children:"Aucun chapitre"}),a.map(ne=>r.jsxs("option",{value:ne.id,children:[ne.numero,". ",ne.titre]},ne.id))]})]}),r.jsxs("div",{className:"form-group",style:{flex:"0 0 120px"},children:[r.jsx("label",{className:"form-label",children:"Ordre"}),r.jsx("input",{type:"number",name:"ordre",className:"form-input",min:"1",value:we.ordre,onChange:ce})]}),r.jsxs("div",{className:"form-group",style:{flex:"0 0 120px"},children:[r.jsx("label",{className:"form-label",children:"Dure (min)"}),r.jsx("input",{type:"number",name:"duree",className:"form-input",min:"0",placeholder:"Ex: 30",value:we.duree||"",onChange:ce})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Description"}),r.jsx("textarea",{name:"description",className:"form-textarea",rows:3,placeholder:"Description de la ressource...",value:we.description||"",onChange:ce})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{className:"form-label",children:["Fichier",r.jsxs("span",{className:"form-helper",style:{marginLeft:"var(--spacing-sm)"},children:["(",qd[we.type].join(", ")," - max ",Iv," Mo)"]})]}),r.jsxs("div",{className:"file-upload",children:[r.jsx("input",{ref:an,type:"file",accept:qd[we.type].join(","),onChange:_e,className:"file-upload__input",id:"file-input"}),!at&&!Pr?r.jsxs("label",{htmlFor:"file-input",className:"file-upload__dropzone",children:[r.jsx("div",{className:"file-upload__icon",children:""}),r.jsx("p",{className:"file-upload__text",children:"Cliquez ou glissez un fichier ici"}),r.jsx("p",{className:"file-upload__hint",children:qd[we.type].join(", ")})]}):r.jsxs("div",{className:"file-upload__preview",children:[at?.type.startsWith("image/")&&Pr&&r.jsx("img",{src:Pr,alt:"Aperu",className:"file-preview__image"}),at?.type.startsWith("video/")&&Pr&&r.jsx("video",{src:Pr,controls:!0,className:"file-preview__video"}),!at?.type.startsWith("image/")&&!at?.type.startsWith("video/")&&r.jsx("div",{className:"file-preview__document",children:r.jsx("span",{className:"file-preview__icon",children:na(we.type).icon})}),r.jsxs("div",{className:"file-preview__info",children:[r.jsx("p",{className:"file-preview__name",children:at?.name||he?.fichierNom}),at&&r.jsx("p",{className:"file-preview__size",children:as(at.size)})]}),r.jsx("button",{type:"button",onClick:Xe,className:"file-preview__remove",children:""})]})]}),We.fichier&&r.jsx("span",{className:"form-error",children:We.fichier}),ee&&r.jsxs("div",{className:"upload-progress",children:[r.jsx("div",{className:"upload-progress__bar",style:{width:`${P}%`}}),r.jsxs("span",{className:"upload-progress__text",children:[P,"%"]})]})]}),we.type==="video"&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"URL externe (YouTube, Vimeo...)"}),r.jsx("input",{type:"url",name:"urlExterne",className:"form-input",placeholder:"https://www.youtube.com/watch?v=...",value:we.urlExterne||"",onChange:ce}),r.jsx("span",{className:"form-helper",children:"Alternative  l'upload de fichier"})]}),we.type==="cours"&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Contenu du cours"}),r.jsx("textarea",{name:"contenu",className:"form-textarea",rows:6,placeholder:"Saisissez le contenu du cours ici...",value:we.contenu||"",onChange:ce}),r.jsx("span",{className:"form-helper",children:"Optionnel si vous uploadez un fichier"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Tags"}),r.jsxs("div",{className:"tags-input",children:[r.jsx("input",{type:"text",className:"form-input",placeholder:"Ajouter un tag...",value:pe,onChange:ne=>Ae(ne.target.value),onKeyPress:ne=>ne.key==="Enter"&&(ne.preventDefault(),Ar())}),r.jsx("button",{type:"button",onClick:Ar,className:"btn btn--outline btn--sm",children:"Ajouter"})]}),we.tags&&we.tags.length>0&&r.jsx("div",{className:"tags-list",children:we.tags.map((ne,$e)=>r.jsxs("span",{className:"tag",children:[ne,r.jsx("button",{type:"button",onClick:()=>$n($e),className:"tag__remove",children:""})]},$e))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Options"}),r.jsxs("div",{className:"form-options",children:[r.jsxs("label",{className:"form-checkbox",children:[r.jsx("input",{type:"checkbox",name:"isPremium",checked:we.isPremium,onChange:ce}),r.jsx("span",{children:"Contenu Premium "})]}),r.jsxs("label",{className:"form-checkbox",children:[r.jsx("input",{type:"checkbox",name:"actif",checked:we.actif!==!1,onChange:ce}),r.jsx("span",{children:"Ressource active"})]})]})]})]}),r.jsxs("div",{className:"modal__footer",children:[r.jsx("button",{type:"button",onClick:Z,className:"btn btn--outline",disabled:$||ee,children:"Annuler"}),r.jsx("button",{type:"submit",className:"btn btn--primary",disabled:$||ee,children:$||ee?ee?`Upload ${P}%...`:"Enregistrement...":he?"Mettre  jour":"Crer la ressource"})]})]})]})}),ve&&Q&&r.jsx("div",{className:"modal-overlay",onClick:Z,children:r.jsxs("div",{className:"modal modal--xl",onClick:ne=>ne.stopPropagation(),children:[r.jsxs("div",{className:"modal__header",children:[r.jsxs("h2",{className:"modal__title",children:[na(Q.type).icon," ",Q.titre]}),r.jsx("button",{onClick:Z,className:"modal__close",children:""})]}),r.jsxs("div",{className:"modal__body",children:[Q.type==="video"&&Q.urlExterne?r.jsx("div",{className:"preview-video",children:r.jsx("iframe",{src:Q.urlExterne.replace("watch?v=","embed/"),title:Q.titre,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}):Q.fichierURL?r.jsx("div",{className:"preview-file",children:Q.fichierURL.match(/\.(jpg|jpeg|png|gif|webp)$/i)?r.jsx("img",{src:Q.fichierURL,alt:Q.titre}):Q.fichierURL.match(/\.(mp4|webm)$/i)?r.jsx("video",{src:Q.fichierURL,controls:!0}):Q.fichierURL.match(/\.pdf$/i)?r.jsx("iframe",{src:Q.fichierURL,title:Q.titre}):r.jsxs("div",{className:"preview-download",children:[r.jsx("span",{className:"preview-download__icon",children:na(Q.type).icon}),r.jsx("p",{children:Q.fichierNom}),r.jsx("a",{href:Q.fichierURL,target:"_blank",rel:"noopener noreferrer",className:"btn btn--primary",children:"Tlcharger"})]})}):Q.contenu?r.jsx("div",{className:"preview-content",children:r.jsx("p",{children:Q.contenu})}):r.jsx("div",{className:"preview-empty",children:r.jsx("p",{children:"Aucun contenu  prvisualiser"})}),r.jsxs("div",{className:"preview-info",children:[Q.description&&r.jsx("p",{className:"preview-description",children:Q.description}),r.jsxs("div",{className:"preview-meta",children:[r.jsxs("span",{children:["Type : ",na(Q.type).label]}),Q.duree&&r.jsxs("span",{children:["Dure : ",Q.duree," min"]}),Q.isPremium&&r.jsx("span",{className:"badge badge--premium",children:"Premium"})]})]})]})]})}),oe&&ue&&r.jsx("div",{className:"modal-overlay",onClick:Z,children:r.jsxs("div",{className:"modal",onClick:ne=>ne.stopPropagation(),children:[r.jsxs("div",{className:"modal__header",children:[r.jsx("h2",{className:"modal__title",children:"Confirmer la suppression"}),r.jsx("button",{onClick:Z,className:"modal__close",children:""})]}),r.jsxs("div",{className:"modal__body",children:[r.jsxs("p",{children:["Supprimer la ressource ",r.jsx("strong",{children:ue.titre})," ?"]}),ue.fichierURL&&r.jsxs("div",{className:"alert alert--warning",style:{marginTop:"var(--spacing-md)"},children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:"Le fichier associ sera galement supprim de faon permanente."})})]})]}),r.jsxs("div",{className:"modal__footer",children:[r.jsx("button",{onClick:Z,className:"btn btn--outline",children:"Annuler"}),r.jsx("button",{onClick:ra,className:"btn btn--danger",disabled:L!==null,children:L?"Suppression...":"Supprimer"})]})]})}),r.jsx("style",{children:`
        /* ==================== SLECTEUR DE DISCIPLINE ==================== */
        
        .discipline-tabs {
          display: flex;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
          margin-top: var(--spacing-md);
        }

        .discipline-tab {
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          padding: var(--spacing-sm) var(--spacing-md);
          border: 2px solid var(--color-border);
          border-radius: var(--radius-lg);
          background: white;
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .discipline-tab:hover {
          border-color: var(--discipline-color, var(--color-primary));
        }

        .discipline-tab--active {
          border-color: var(--discipline-color, var(--color-primary));
          background: color-mix(in srgb, var(--discipline-color, var(--color-primary)) 10%, white);
        }

        .discipline-tab__icon {
          font-size: var(--text-lg);
        }

        .discipline-tab__name {
          font-weight: var(--font-medium);
        }

        .discipline-tab__class {
          font-size: var(--text-xs);
          color: var(--color-text-light);
          background: var(--color-bg-secondary);
          padding: 2px 6px;
          border-radius: var(--radius-sm);
        }

        /* ==================== FORMULAIRE ==================== */
        
        .form-row {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
          gap: var(--spacing-lg);
        }

        .form-options {
          display: flex;
          flex-wrap: wrap;
          gap: var(--spacing-lg);
          margin-top: var(--spacing-sm);
        }

        .form-select--sm {
          padding: var(--spacing-sm) var(--spacing-md);
          font-size: var(--text-sm);
          min-width: 140px;
        }

        /* ==================== UPLOAD DE FICHIER ==================== */
        
        .file-upload {
          position: relative;
        }

        .file-upload__input {
          position: absolute;
          opacity: 0;
          pointer-events: none;
        }

        .file-upload__dropzone {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: var(--spacing-xl);
          border: 2px dashed var(--color-border);
          border-radius: var(--radius-lg);
          background: var(--color-bg-secondary);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .file-upload__dropzone:hover {
          border-color: var(--color-primary);
          background: rgba(37, 99, 235, 0.05);
        }

        .file-upload__icon {
          font-size: 48px;
          margin-bottom: var(--spacing-md);
        }

        .file-upload__text {
          font-weight: var(--font-medium);
          margin-bottom: var(--spacing-xs);
        }

        .file-upload__hint {
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        .file-upload__preview {
          display: flex;
          align-items: center;
          gap: var(--spacing-lg);
          padding: var(--spacing-md);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-lg);
          background: var(--color-bg-secondary);
        }

        .file-preview__image,
        .file-preview__video {
          width: 120px;
          height: 80px;
          object-fit: cover;
          border-radius: var(--radius-md);
        }

        .file-preview__document {
          width: 80px;
          height: 80px;
          background: white;
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .file-preview__icon {
          font-size: 32px;
        }

        .file-preview__info {
          flex: 1;
        }

        .file-preview__name {
          font-weight: var(--font-medium);
          margin-bottom: var(--spacing-xs);
          word-break: break-all;
        }

        .file-preview__size {
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        .file-preview__remove {
          width: 32px;
          height: 32px;
          border: none;
          background: var(--color-error);
          color: white;
          border-radius: 50%;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all var(--transition-base);
        }

        .file-preview__remove:hover {
          background: #dc2626;
          transform: scale(1.1);
        }

        /* ==================== BARRE DE PROGRESSION ==================== */
        
        .upload-progress {
          margin-top: var(--spacing-md);
          height: 8px;
          background: var(--color-bg-tertiary);
          border-radius: var(--radius-full);
          overflow: hidden;
          position: relative;
        }

        .upload-progress__bar {
          height: 100%;
          background: linear-gradient(90deg, var(--color-primary), var(--color-secondary));
          border-radius: var(--radius-full);
          transition: width var(--transition-base);
        }

        .upload-progress__text {
          position: absolute;
          right: var(--spacing-sm);
          top: 50%;
          transform: translateY(-50%);
          font-size: var(--text-xs);
          font-weight: var(--font-semibold);
          color: var(--color-text);
        }

        /* ==================== TAGS ==================== */
        
        .tags-input {
          display: flex;
          gap: var(--spacing-sm);
        }

        .tags-list {
          display: flex;
          flex-wrap: wrap;
          gap: var(--spacing-sm);
          margin-top: var(--spacing-md);
        }

        .tag {
          display: inline-flex;
          align-items: center;
          gap: var(--spacing-xs);
          padding: var(--spacing-xs) var(--spacing-sm);
          background: var(--color-bg-tertiary);
          border-radius: var(--radius-full);
          font-size: var(--text-sm);
          color: var(--color-text);
        }

        .tag__remove {
          width: 18px;
          height: 18px;
          border: none;
          background: transparent;
          color: var(--color-text-light);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          border-radius: 50%;
          transition: all var(--transition-base);
        }

        .tag__remove:hover {
          background: var(--color-error);
          color: white;
        }

        /* ==================== PRVISUALISATION ==================== */
        
        .preview-video {
          position: relative;
          padding-bottom: 56.25%;
          height: 0;
          overflow: hidden;
          border-radius: var(--radius-lg);
        }

        .preview-video iframe {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          border: none;
        }

        .preview-file {
          text-align: center;
        }

        .preview-file img,
        .preview-file video {
          max-width: 100%;
          max-height: 60vh;
          border-radius: var(--radius-lg);
        }

        .preview-file iframe {
          width: 100%;
          height: 60vh;
          border: none;
          border-radius: var(--radius-lg);
        }

        .preview-download {
          padding: var(--spacing-2xl);
          text-align: center;
        }

        .preview-download__icon {
          font-size: 64px;
          display: block;
          margin-bottom: var(--spacing-lg);
        }

        .preview-content {
          padding: var(--spacing-lg);
          background: var(--color-bg-secondary);
          border-radius: var(--radius-lg);
          white-space: pre-wrap;
        }

        .preview-empty {
          padding: var(--spacing-2xl);
          text-align: center;
          color: var(--color-text-light);
        }

        .preview-info {
          margin-top: var(--spacing-lg);
          padding-top: var(--spacing-lg);
          border-top: 1px solid var(--color-border);
        }

        .preview-description {
          color: var(--color-text-light);
          margin-bottom: var(--spacing-md);
        }

        .preview-meta {
          display: flex;
          flex-wrap: wrap;
          gap: var(--spacing-lg);
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        /* ==================== RESSOURCES - AFFICHAGE CARTE ==================== */
        
        .resource-item__title {
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
        }

        /* ==================== ACTION WARNING ==================== */
        
        .table-action-btn--warning {
          color: var(--color-warning);
        }

        /* ==================== RESPONSIVE ==================== */
        
        @media (max-width: 768px) {
          .form-row {
            grid-template-columns: 1fr;
          }

          .admin-table-actions {
            flex-direction: column;
            align-items: stretch;
          }

          .search-input__field {
            width: 100%;
          }

          .file-upload__preview {
            flex-direction: column;
            text-align: center;
          }

          .preview-meta {
            flex-direction: column;
            gap: var(--spacing-sm);
          }
        }
      `})]})},AA=je(K,"quizzes"),zA=async e=>{try{let t=Ee(AA,Ve("titre","asc"));e?.disciplineId;let a=(await Ce(t)).docs.map(l=>({id:l.id,...l.data()}));return e?.isPremium,e?.difficulte,a}catch(t){throw console.error("Erreur lors de la rcupration des quiz :",t),t}},$5=async e=>{try{const t=await Dt(Ne(K,"quizzes",e));return t.exists()?{id:t.id,...t.data()}:null}catch(t){throw console.error("Erreur lors de la rcupration du quiz :",t),t}},B5=async e=>{try{return(await qt(AA,{...e,createdAt:Oe.now(),updatedAt:Oe.now()})).id}catch(t){throw console.error("Erreur lors de la cration du quiz :",t),t}},U5=async(e,t)=>{try{await Qe(Ne(K,"quizzes",e),{...t,updatedAt:Oe.now()})}catch(n){throw console.error("Erreur lors de la mise  jour du quiz :",n),n}},F5=async e=>{try{await rn(Ne(K,"quizzes",e))}catch(t){throw console.error("Erreur lors de la suppression du quiz :",t),t}},G5=()=>`q_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,I1=()=>({id:G5(),question:"",options:["","","",""],reponseCorrecte:0,explication:"",difficulte:"moyen",points:1}),L1=e=>{const t=e.questions||[],n=t.reduce((l,o)=>l+(o.points||1),0),a={facile:t.filter(l=>l.difficulte==="facile").length,moyen:t.filter(l=>l.difficulte==="moyen").length,difficile:t.filter(l=>l.difficulte==="difficile").length};return{nombreQuestions:t.length,totalPoints:n,parDifficulte:a,duree:e.duree||0}},H5=()=>{const[e,t]=g.useState([]),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState(null),[h,v]=g.useState(""),[b,x]=g.useState(""),[j,N]=g.useState(""),[w,C]=g.useState(""),[E,S]=g.useState(!1),[A,O]=g.useState("list"),[k,M]=g.useState(null),[D,$]=g.useState({disciplineId:"",titre:"",questions:[],duree:15,isPremium:!1,noteMinimale:50}),[U,L]=g.useState(null),[B,ee]=g.useState(!1),[se,P]=g.useState(null),[q,F]=g.useState(null),[R,W]=g.useState({}),[I,re]=g.useState(!1),V=g.useCallback(async()=>{o(!0),d(null);try{const[pe,Ae]=await Promise.all([zA(),Ji.getAll()]);t(pe),a(Ae.map(Re=>({id:Re.id,nom:Re.nom||Re.name||Re.id})))}catch(pe){d("Erreur lors du chargement des donnes."),console.error(pe)}finally{o(!1)}},[]);g.useEffect(()=>{V()},[V]),g.useEffect(()=>{if(f){const pe=setTimeout(()=>p(null),4e3);return()=>clearTimeout(pe)}},[f]);const oe=e.filter(pe=>{if(h){const Ae=h.toLowerCase();if(!pe.titre.toLowerCase().includes(Ae))return!1}return!(b&&pe.disciplineId!==b||j==="true"&&!pe.isPremium||j==="false"&&pe.isPremium||w&&!pe.questions?.some(Re=>Re.difficulte===w))}),xe=()=>{M(null),$({disciplineId:"",titre:"",questions:[I1()],duree:15,isPremium:!1,noteMinimale:50}),L(null),O("form")},ve=pe=>{M(pe),$({disciplineId:pe.disciplineId,titre:pe.titre,questions:pe.questions||[],duree:pe.duree||15,isPremium:pe.isPremium||!1,noteMinimale:pe.noteMinimale||50}),L(null),O("form")},H=async()=>{if(!D.titre.trim()){d("Le titre du quiz est obligatoire.");return}if(!D.disciplineId){d("Veuillez slectionner une discipline.");return}if(D.questions.length===0){d("Le quiz doit contenir au moins une question.");return}for(let pe=0;pe<D.questions.length;pe++){const Ae=D.questions[pe];if(!Ae.question.trim()){d(`La question ${pe+1} n'a pas d'nonc.`);return}if(Ae.options.filter(He=>!He.trim()).length>0){d(`La question ${pe+1} a des options vides.`);return}}ee(!0),d(null);try{k?(await U5(k.id,D),p("Quiz mis  jour avec succs !")):(await B5(D),p("Quiz cr avec succs !")),await V(),O("list")}catch(pe){d("Erreur lors de la sauvegarde du quiz."),console.error(pe)}finally{ee(!1)}},he=async pe=>{try{await F5(pe),p("Quiz supprim avec succs."),P(null),await V()}catch(Ae){d("Erreur lors de la suppression du quiz."),console.error(Ae)}},Pe=()=>{const pe=I1();$(Ae=>({...Ae,questions:[...Ae.questions,pe]})),L(pe.id)},ue=pe=>{const Ae=D.questions.find(It=>It.id===pe);if(!Ae)return;const Re={...Ae,id:`q_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,question:`${Ae.question} (copie)`},He=D.questions.findIndex(It=>It.id===pe),xt=[...D.questions];xt.splice(He+1,0,Re),$(It=>({...It,questions:xt})),L(Re.id)},X=pe=>{$(Ae=>({...Ae,questions:Ae.questions.filter(Re=>Re.id!==pe)})),U===pe&&L(null)},Q=(pe,Ae,Re)=>{$(He=>({...He,questions:He.questions.map(xt=>xt.id===pe?{...xt,[Ae]:Re}:xt)}))},me=(pe,Ae,Re)=>{$(He=>({...He,questions:He.questions.map(xt=>xt.id===pe?{...xt,options:xt.options.map((It,tr)=>tr===Ae?Re:It)}:xt)}))},we=pe=>{F(pe),W({}),re(!1),O("preview")},qe=(pe,Ae)=>{I||W(Re=>({...Re,[pe]:Ae}))},We=()=>{re(!0)},Je=pe=>n.find(Ae=>Ae.id===pe)?.nom||pe,at=({level:pe})=>{const Ae={facile:"quiz-badge-facile",moyen:"quiz-badge-moyen",difficile:"quiz-badge-difficile"};return r.jsx("span",{className:`quiz-badge ${Ae[pe]||"quiz-badge-moyen"}`,children:pe.charAt(0).toUpperCase()+pe.slice(1)})},br=()=>r.jsxs(r.Fragment,{children:[u&&r.jsxs("div",{className:"admin-message admin-message-error",children:[r.jsx(fm,{size:18}),r.jsx("span",{children:u}),r.jsx("button",{onClick:()=>d(null),className:"admin-message-close",children:r.jsx(Gi,{size:16})})]}),f&&r.jsxs("div",{className:"admin-message admin-message-success",children:[r.jsx(Ut,{size:18}),r.jsx("span",{children:f})]})]}),Pr=()=>r.jsxs("div",{className:"quiz-manager",children:[r.jsxs("div",{className:"admin-header",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"admin-title",children:[r.jsx(vn,{size:24})," Gestion des Quiz"]}),r.jsxs("p",{className:"admin-subtitle",children:[e.length," quiz au total  ",oe.length," affich(s)"]})]}),r.jsxs("button",{className:"admin-btn admin-btn-primary",onClick:xe,children:[r.jsx(zc,{size:18})," Nouveau Quiz"]})]}),r.jsxs("div",{className:"admin-toolbar",children:[r.jsxs("div",{className:"admin-search-wrapper",children:[r.jsx(cA,{size:18,className:"admin-search-icon"}),r.jsx("input",{type:"text",className:"admin-search-input",placeholder:"Rechercher un quiz...",value:h,onChange:pe=>v(pe.target.value)})]}),r.jsxs("button",{className:`admin-btn admin-btn-outline ${E?"active":""}`,onClick:()=>S(!E),children:[r.jsx(Tb,{size:16})," Filtres",E?r.jsx(Nx,{size:14}):r.jsx(mm,{size:14})]})]}),E&&r.jsxs("div",{className:"admin-filters-panel",children:[r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Discipline"}),r.jsxs("select",{className:"admin-select",value:b,onChange:pe=>x(pe.target.value),children:[r.jsx("option",{value:"",children:"Toutes les disciplines"}),n.map(pe=>r.jsx("option",{value:pe.id,children:pe.nom},pe.id))]})]}),r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Accs"}),r.jsxs("select",{className:"admin-select",value:j,onChange:pe=>N(pe.target.value),children:[r.jsx("option",{value:"",children:"Tous"}),r.jsx("option",{value:"false",children:"Gratuit"}),r.jsx("option",{value:"true",children:"Premium"})]})]}),r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Difficult"}),r.jsxs("select",{className:"admin-select",value:w,onChange:pe=>C(pe.target.value),children:[r.jsx("option",{value:"",children:"Toutes"}),r.jsx("option",{value:"facile",children:"Facile"}),r.jsx("option",{value:"moyen",children:"Moyen"}),r.jsx("option",{value:"difficile",children:"Difficile"})]})]}),r.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{x(""),N(""),C(""),v("")},children:"Rinitialiser"})]}),l?r.jsxs("div",{className:"admin-loading",children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement des quiz..."})]}):oe.length===0?r.jsxs("div",{className:"admin-empty-state",children:[r.jsx(am,{size:48}),r.jsx("h3",{children:"Aucun quiz trouv"}),r.jsx("p",{children:e.length===0?"Crez votre premier quiz pour vos lves.":"Aucun quiz ne correspond  vos filtres."}),e.length===0&&r.jsxs("button",{className:"admin-btn admin-btn-primary",onClick:xe,children:[r.jsx(zc,{size:18})," Crer un quiz"]})]}):r.jsx("div",{className:"quiz-grid",children:oe.map(pe=>{const Ae=L1(pe);return r.jsxs("div",{className:"quiz-card",children:[r.jsxs("div",{className:"quiz-card-header",children:[r.jsxs("div",{className:"quiz-card-title-row",children:[r.jsx("h3",{className:"quiz-card-title",children:pe.titre}),pe.isPremium&&r.jsxs("span",{className:"quiz-badge quiz-badge-premium",children:[r.jsx(Zr,{size:12})," Premium"]})]}),r.jsx("span",{className:"quiz-card-discipline",children:Je(pe.disciplineId)})]}),r.jsxs("div",{className:"quiz-card-stats",children:[r.jsxs("div",{className:"quiz-stat",children:[r.jsx(am,{size:14}),r.jsxs("span",{children:[Ae.nombreQuestions," question(s)"]})]}),r.jsxs("div",{className:"quiz-stat",children:[r.jsx(Wi,{size:14}),r.jsxs("span",{children:[Ae.totalPoints," pts"]})]}),r.jsxs("div",{className:"quiz-stat",children:[r.jsx(so,{size:14}),r.jsxs("span",{children:[Ae.duree," min"]})]})]}),r.jsxs("div",{className:"quiz-card-difficulty",children:[Ae.parDifficulte.facile>0&&r.jsx(at,{level:"facile"}),Ae.parDifficulte.moyen>0&&r.jsx(at,{level:"moyen"}),Ae.parDifficulte.difficile>0&&r.jsx(at,{level:"difficile"})]}),r.jsxs("div",{className:"quiz-card-actions",children:[r.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>we(pe),title:"Prvisualiser",children:[r.jsx(no,{size:14})," Aperu"]}),r.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>ve(pe),title:"Modifier",children:[r.jsx(o3,{size:14})," Modifier"]}),se===pe.id?r.jsxs("div",{className:"quiz-delete-confirm",children:[r.jsx("button",{className:"admin-btn admin-btn-sm admin-btn-danger",onClick:()=>he(pe.id),children:"Confirmer"}),r.jsx("button",{className:"admin-btn admin-btn-sm admin-btn-ghost",onClick:()=>P(null),children:"Annuler"})]}):r.jsx("button",{className:"admin-btn admin-btn-sm admin-btn-danger-outline",onClick:()=>P(pe.id),title:"Supprimer",children:r.jsx(b1,{size:14})})]})]},pe.id)})})]}),lr=()=>r.jsxs("div",{className:"quiz-manager",children:[r.jsxs("div",{className:"admin-header",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"admin-title",children:[r.jsx(vn,{size:24}),k?"Modifier le quiz":"Nouveau quiz"]}),r.jsxs("p",{className:"admin-subtitle",children:[D.questions.length," question(s) ajoute(s)"]})]}),r.jsxs("div",{className:"admin-header-actions",children:[r.jsxs("button",{className:"admin-btn admin-btn-ghost",onClick:()=>O("list"),children:[r.jsx(Gi,{size:18})," Annuler"]}),r.jsxs("button",{className:"admin-btn admin-btn-primary",onClick:H,disabled:B,children:[r.jsx(c3,{size:18})," ",B?"Enregistrement...":"Enregistrer"]})]})]}),r.jsxs("div",{className:"admin-card quiz-form-section",children:[r.jsx("h3",{className:"quiz-form-section-title",children:"Informations gnrales"}),r.jsxs("div",{className:"quiz-form-grid",children:[r.jsxs("div",{className:"admin-form-group quiz-form-full",children:[r.jsx("label",{className:"admin-label",children:"Titre du quiz *"}),r.jsx("input",{type:"text",className:"admin-input",placeholder:"Ex : Quiz - Les Misrables, Chapitre 1",value:D.titre,onChange:pe=>$(Ae=>({...Ae,titre:pe.target.value}))})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Discipline *"}),r.jsxs("select",{className:"admin-select",value:D.disciplineId,onChange:pe=>$(Ae=>({...Ae,disciplineId:pe.target.value})),children:[r.jsx("option",{value:"",children:"-- Slectionner --"}),n.map(pe=>r.jsx("option",{value:pe.id,children:pe.nom},pe.id))]})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Dure (minutes)"}),r.jsx("input",{type:"number",className:"admin-input",min:1,max:180,value:D.duree,onChange:pe=>$(Ae=>({...Ae,duree:parseInt(pe.target.value)||15}))})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Note minimale (%)"}),r.jsx("input",{type:"number",className:"admin-input",min:0,max:100,value:D.noteMinimale,onChange:pe=>$(Ae=>({...Ae,noteMinimale:parseInt(pe.target.value)||50}))})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Accs"}),r.jsxs("div",{className:`quiz-toggle ${D.isPremium?"quiz-toggle-active":""}`,onClick:()=>$(pe=>({...pe,isPremium:!pe.isPremium})),children:[r.jsx(Zr,{size:16}),r.jsx("span",{children:D.isPremium?"Premium (2 000 FCFA/mois)":"Gratuit"})]})]})]})]}),r.jsxs("div",{className:"admin-card quiz-form-section",children:[r.jsxs("div",{className:"quiz-questions-header",children:[r.jsxs("h3",{className:"quiz-form-section-title",children:["Questions (",D.questions.length,")"]}),r.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-primary",onClick:Pe,children:[r.jsx(zc,{size:14})," Ajouter une question"]})]}),D.questions.length===0?r.jsxs("div",{className:"admin-empty-state",style:{padding:"2rem"},children:[r.jsx(am,{size:36}),r.jsx("p",{children:'Aucune question. Cliquez sur "Ajouter une question" pour commencer.'})]}):r.jsx("div",{className:"quiz-questions-list",children:D.questions.map((pe,Ae)=>r.jsxs("div",{className:`quiz-question-item ${U===pe.id?"expanded":""}`,children:[r.jsxs("div",{className:"quiz-question-header",onClick:()=>L(U===pe.id?null:pe.id),children:[r.jsxs("div",{className:"quiz-question-header-left",children:[r.jsx(u3,{size:16,className:"quiz-grip-icon"}),r.jsxs("span",{className:"quiz-question-number",children:["Q",Ae+1]}),r.jsx("span",{className:"quiz-question-preview",children:pe.question||"Question sans nonc..."})]}),r.jsxs("div",{className:"quiz-question-header-right",children:[r.jsx(at,{level:pe.difficulte||"moyen"}),r.jsxs("span",{className:"quiz-question-points",children:[pe.points," pt(s)"]}),U===pe.id?r.jsx(Nx,{size:16}):r.jsx(mm,{size:16})]})]}),U===pe.id&&r.jsxs("div",{className:"quiz-question-body",children:[r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"nonc de la question *"}),r.jsx("textarea",{className:"admin-textarea",rows:2,placeholder:"Ex : Quel est le personnage principal du roman ?",value:pe.question,onChange:Re=>Q(pe.id,"question",Re.target.value)})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Options de rponse (cliquez sur la bonne rponse)"}),r.jsx("div",{className:"quiz-options-grid",children:pe.options.map((Re,He)=>r.jsxs("div",{className:`quiz-option-item ${pe.reponseCorrecte===He?"quiz-option-correct":""}`,children:[r.jsx("button",{type:"button",className:`quiz-option-radio ${pe.reponseCorrecte===He?"active":""}`,onClick:()=>Q(pe.id,"reponseCorrecte",He),title:pe.reponseCorrecte===He?"Bonne rponse":"Marquer comme bonne rponse",children:pe.reponseCorrecte===He?r.jsx(Ut,{size:16}):r.jsx("span",{className:"quiz-option-letter",children:String.fromCharCode(65+He)})}),r.jsx("input",{type:"text",className:"admin-input",placeholder:`Option ${String.fromCharCode(65+He)}`,value:Re,onChange:xt=>me(pe.id,He,xt.target.value)})]},He))})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Explication (affiche aprs rponse)"}),r.jsx("textarea",{className:"admin-textarea",rows:2,placeholder:"Ex : Jean Valjean est le protagoniste du roman de Victor Hugo...",value:pe.explication,onChange:Re=>Q(pe.id,"explication",Re.target.value)})]}),r.jsxs("div",{className:"quiz-question-meta",children:[r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Difficult"}),r.jsxs("select",{className:"admin-select",value:pe.difficulte,onChange:Re=>Q(pe.id,"difficulte",Re.target.value),children:[r.jsx("option",{value:"facile",children:"Facile"}),r.jsx("option",{value:"moyen",children:"Moyen"}),r.jsx("option",{value:"difficile",children:"Difficile"})]})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Points"}),r.jsx("input",{type:"number",className:"admin-input",min:1,max:10,value:pe.points,onChange:Re=>Q(pe.id,"points",parseInt(Re.target.value)||1)})]})]}),r.jsxs("div",{className:"quiz-question-actions",children:[r.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>ue(pe.id),children:[r.jsx(d3,{size:14})," Dupliquer"]}),r.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-danger-outline",onClick:()=>X(pe.id),children:[r.jsx(b1,{size:14})," Supprimer"]})]})]})]},pe.id))}),D.questions.length>0&&r.jsx("div",{className:"quiz-add-question-bottom",children:r.jsxs("button",{className:"admin-btn admin-btn-outline",onClick:Pe,children:[r.jsx(zc,{size:16})," Ajouter une question"]})})]})]}),an=()=>{if(!q)return null;const pe=L1(q);let Ae=0,Re=0;return I&&q.questions.forEach(He=>{Re+=He.points||1,R[He.id]===He.reponseCorrecte&&(Ae+=He.points||1)}),r.jsxs("div",{className:"quiz-manager",children:[r.jsxs("div",{className:"admin-header",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"admin-title",children:[r.jsx(no,{size:24})," Prvisualisation : ",q.titre]}),r.jsxs("p",{className:"admin-subtitle",children:[Je(q.disciplineId),"  ",pe.nombreQuestions," questions  ",pe.duree," min"]})]}),r.jsxs("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{O("list"),F(null)},children:[r.jsx(Gi,{size:18})," Fermer"]})]}),I&&r.jsxs("div",{className:`quiz-preview-score ${Ae/Re>=(q.noteMinimale||50)/100?"success":"fail"}`,children:[r.jsx(Wi,{size:32}),r.jsxs("div",{children:[r.jsxs("h3",{children:["Score : ",Ae,"/",Re," (",Math.round(Ae/Re*100),"%)"]}),r.jsxs("p",{children:["Note minimale : ",q.noteMinimale||50,"% "," ",Ae/Re>=(q.noteMinimale||50)/100?" Russi !":" Non russi"]})]})]}),r.jsx("div",{className:"quiz-preview-questions",children:q.questions.map((He,xt)=>{const It=R[He.id],tr=It===He.reponseCorrecte;return r.jsxs("div",{className:"admin-card quiz-preview-question",children:[r.jsxs("div",{className:"quiz-preview-question-header",children:[r.jsxs("span",{className:"quiz-question-number",children:["Q",xt+1]}),r.jsx(at,{level:He.difficulte||"moyen"}),r.jsxs("span",{className:"quiz-question-points",children:[He.points," pt(s)"]})]}),r.jsx("p",{className:"quiz-preview-question-text",children:He.question}),r.jsx("div",{className:"quiz-preview-options",children:He.options.map((Gr,J)=>{let Me="quiz-preview-option";return I?J===He.reponseCorrecte?Me+=" correct":J===It&&!tr&&(Me+=" incorrect"):It===J&&(Me+=" selected"),r.jsxs("button",{className:Me,onClick:()=>qe(He.id,J),disabled:I,children:[r.jsx("span",{className:"quiz-preview-option-letter",children:String.fromCharCode(65+J)}),r.jsx("span",{children:Gr}),I&&J===He.reponseCorrecte&&r.jsx(Ut,{size:16,className:"quiz-preview-check"})]},J)})}),I&&He.explication&&r.jsxs("div",{className:"quiz-preview-explication",children:[r.jsx("strong",{children:"Explication :"})," ",He.explication]})]},He.id)})}),!I&&r.jsx("div",{className:"quiz-preview-submit",children:r.jsxs("button",{className:"admin-btn admin-btn-primary admin-btn-lg",onClick:We,disabled:Object.keys(R).length<q.questions.length,children:[r.jsx(Ut,{size:18})," Soumettre (",Object.keys(R).length,"/",q.questions.length,")"]})})]})};return r.jsxs("div",{className:"admin-container",children:[br(),A==="list"&&Pr(),A==="form"&&lr(),A==="preview"&&an()]})},kA=je(K,"users"),Q5=je(K,"quizResults"),V5=async e=>{try{let t=Ee(kA,Ve("displayName","asc"));e?.role;let a=(await Ce(t)).docs.map(l=>({uid:l.id,...l.data()}));return e?.isPremium,e?.isActive,e?.search,a}catch(t){throw console.error("Erreur lors de la rcupration des utilisateurs :",t),t}},Y5=async(e,t)=>{try{await Qe(Ne(K,"users",e),{role:t,updatedAt:Oe.now()})}catch(n){throw console.error("Erreur lors de la mise  jour du rle :",n),n}},K5=async(e,t)=>{try{const n={isPremium:t,updatedAt:Oe.now()};if(t){const a=new Date;a.setDate(a.getDate()+30),n.subscriptionEnd=Oe.fromDate(a)}else n.subscriptionEnd=null;await Qe(Ne(K,"users",e),n)}catch(n){throw console.error("Erreur lors de la mise  jour du statut Premium :",n),n}},W5=async(e,t)=>{try{await Qe(Ne(K,"users",e),{isActive:t,updatedAt:Oe.now()})}catch(n){throw console.error("Erreur lors du changement de statut du compte :",n),n}},X5=async e=>{try{const t=Ee(Q5,Se("userId","==",e)),a=(await Ce(t)).docs.map(f=>({id:f.id,...f.data()})),l=a.length,o=a.filter(f=>f.reussi).length,u=l>0?Math.round(a.reduce((f,p)=>f+p.score,0)/l):0,d=a.length>0?new Date(Math.max(...a.map(f=>{const p=f.datePassage;return p?.toDate?p.toDate().getTime():new Date(p).getTime()}))):null;return{totalQuizPasses:l,scoresMoyens:u,quizReussis:o,dernierQuiz:d}}catch(t){return console.error("Erreur lors du calcul des statistiques :",t),{totalQuizPasses:0,scoresMoyens:0,quizReussis:0,dernierQuiz:null}}},Z5=async()=>{try{const t=(await Ce(kA)).docs.map(n=>n.data());return{total:t.length,admins:t.filter(n=>n.role==="admin").length,profs:t.filter(n=>n.role==="prof").length,eleves:t.filter(n=>n.role==="eleve").length,premium:t.filter(n=>n.isPremium).length,actifs:t.filter(n=>n.isActive!==!1).length}}catch(e){throw console.error("Erreur lors du calcul des stats globales :",e),e}},J5=()=>{const[e,t]=g.useState([]),[n,a]=g.useState(null),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState(null),[h,v]=g.useState(""),[b,x]=g.useState(""),[j,N]=g.useState(""),[w,C]=g.useState(""),[E,S]=g.useState(!1),[A]=aA();g.useEffect(()=>{A.get("filter")==="premium"&&N("true")},[A]);const[O,k]=g.useState(null),[M,D]=g.useState(null),[$,U]=g.useState(!1),[L,B]=g.useState(null),[ee,se]=g.useState(null),P=g.useCallback(async()=>{o(!0),d(null);try{const[H,he]=await Promise.all([V5(),Z5()]);t(H),a(he)}catch(H){d("Erreur lors du chargement des utilisateurs."),console.error(H)}finally{o(!1)}},[]);g.useEffect(()=>{P()},[P]),g.useEffect(()=>{if(f){const H=setTimeout(()=>p(null),4e3);return()=>clearTimeout(H)}},[f]);const q=e.filter(H=>{if(h){const he=h.toLowerCase();if(!H.displayName?.toLowerCase().includes(he)&&!H.email?.toLowerCase().includes(he))return!1}return!(b&&H.role!==b||j==="true"&&!H.isPremium||j==="false"&&H.isPremium||w==="true"&&H.isActive===!1||w==="false"&&H.isActive!==!1)}),F=async H=>{k(H),U(!0);try{const he=await X5(H.uid);D(he)}catch(he){console.error("Erreur lors du chargement des statistiques :",he),D(null)}finally{U(!1)}},R=async()=>{if(ee){B(ee.userId);try{switch(ee.type){case"role":await Y5(ee.userId,ee.value),p("Rle mis  jour avec succs.");break;case"premium":await K5(ee.userId,ee.value),p(ee.value?"Statut Premium activ (30 jours).":"Statut Premium dsactiv.");break;case"active":await W5(ee.userId,ee.value),p(ee.value?"Compte ractiv.":"Compte dsactiv.");break}await P()}catch(H){d("Erreur lors de l'excution de l'action."),console.error(H)}finally{B(null),se(null)}}},W=({role:H})=>{const he={admin:{icon:r.jsx(Pb,{size:12}),className:"user-badge-admin",label:"Admin"},prof:{icon:r.jsx(Ps,{size:12}),className:"user-badge-prof",label:"Professeur"},eleve:{icon:r.jsx(vn,{size:12}),className:"user-badge-eleve",label:"lve"}},Pe=he[H]||he.eleve;return r.jsxs("span",{className:`user-badge ${Pe.className}`,children:[Pe.icon," ",Pe.label]})},I=H=>H?(H?.toDate?H.toDate():new Date(H)).toLocaleDateString("fr-SN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",re=H=>H?H.charAt(0).toUpperCase():"?",V=()=>r.jsxs(r.Fragment,{children:[u&&r.jsxs("div",{className:"admin-message admin-message-error",children:[r.jsx(fm,{size:18}),r.jsx("span",{children:u}),r.jsx("button",{onClick:()=>d(null),className:"admin-message-close",children:r.jsx(Gi,{size:16})})]}),f&&r.jsxs("div",{className:"admin-message admin-message-success",children:[r.jsx(Ut,{size:18}),r.jsx("span",{children:f})]})]}),oe=()=>{if(!n)return null;const H=[{label:"Total",value:n.total,icon:r.jsx(nm,{size:20}),color:"stat-blue"},{label:"lves",value:n.eleves,icon:r.jsx(vn,{size:20}),color:"stat-green"},{label:"Professeurs",value:n.profs,icon:r.jsx(Ps,{size:20}),color:"stat-purple"},{label:"Premium",value:n.premium,icon:r.jsx(Zr,{size:20}),color:"stat-gold"}];return r.jsx("div",{className:"user-stats-grid",children:H.map(he=>r.jsxs("div",{className:`user-stat-card ${he.color}`,children:[r.jsx("div",{className:"user-stat-icon",children:he.icon}),r.jsxs("div",{className:"user-stat-info",children:[r.jsx("span",{className:"user-stat-value",children:he.value}),r.jsx("span",{className:"user-stat-label",children:he.label})]})]},he.label))})},xe=()=>ee?r.jsx("div",{className:"admin-modal-overlay",onClick:()=>se(null),children:r.jsxs("div",{className:"admin-modal",onClick:H=>H.stopPropagation(),children:[r.jsxs("div",{className:"admin-modal-header",children:[r.jsx("h3",{children:"Confirmer l'action"}),r.jsx("button",{className:"admin-modal-close",onClick:()=>se(null),children:r.jsx(Gi,{size:20})})]}),r.jsx("div",{className:"admin-modal-body",children:r.jsx("p",{children:ee.label})}),r.jsxs("div",{className:"admin-modal-footer",children:[r.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>se(null),children:"Annuler"}),r.jsx("button",{className:"admin-btn admin-btn-primary",onClick:R,disabled:L===ee.userId,children:L===ee.userId?"En cours...":"Confirmer"})]})]})}):null,ve=()=>O?r.jsx("div",{className:"admin-modal-overlay",onClick:()=>k(null),children:r.jsxs("div",{className:"admin-modal admin-modal-lg",onClick:H=>H.stopPropagation(),children:[r.jsxs("div",{className:"admin-modal-header",children:[r.jsx("h3",{children:"Dtail de l'utilisateur"}),r.jsx("button",{className:"admin-modal-close",onClick:()=>k(null),children:r.jsx(Gi,{size:20})})]}),r.jsxs("div",{className:"admin-modal-body",children:[r.jsxs("div",{className:"user-detail-profile",children:[r.jsx("div",{className:"user-detail-avatar",children:re(O.displayName)}),r.jsxs("div",{className:"user-detail-info",children:[r.jsx("h4",{children:O.displayName||"Sans nom"}),r.jsx("p",{children:O.email}),r.jsxs("div",{className:"user-detail-badges",children:[r.jsx(W,{role:O.role}),O.isPremium&&r.jsxs("span",{className:"user-badge user-badge-premium",children:[r.jsx(Zr,{size:12})," Premium"]}),r.jsx("span",{className:`user-badge ${O.isActive!==!1?"user-badge-active":"user-badge-inactive"}`,children:O.isActive!==!1?"Actif":"Dsactiv"})]})]})]}),r.jsxs("div",{className:"user-detail-dates",children:[r.jsxs("div",{children:[r.jsx("span",{className:"user-detail-date-label",children:"Inscription"}),r.jsx("span",{children:I(O.createdAt)})]}),O.isPremium&&O.subscriptionEnd&&r.jsxs("div",{children:[r.jsx("span",{className:"user-detail-date-label",children:"Premium jusqu'au"}),r.jsx("span",{children:I(O.subscriptionEnd)})]})]}),r.jsxs("div",{className:"user-detail-stats-section",children:[r.jsxs("h4",{children:[r.jsx(Ts,{size:18})," Statistiques"]}),$?r.jsxs("div",{className:"admin-loading",style:{padding:"1rem"},children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement des statistiques..."})]}):M?r.jsxs("div",{className:"user-detail-stats-grid",children:[r.jsxs("div",{className:"user-detail-stat",children:[r.jsx(vn,{size:20}),r.jsx("span",{className:"user-detail-stat-value",children:M.totalQuizPasses}),r.jsx("span",{className:"user-detail-stat-label",children:"Quiz passs"})]}),r.jsxs("div",{className:"user-detail-stat",children:[r.jsx(kc,{size:20}),r.jsxs("span",{className:"user-detail-stat-value",children:[M.scoresMoyens,"%"]}),r.jsx("span",{className:"user-detail-stat-label",children:"Score moyen"})]}),r.jsxs("div",{className:"user-detail-stat",children:[r.jsx(Wi,{size:20}),r.jsx("span",{className:"user-detail-stat-value",children:M.quizReussis}),r.jsx("span",{className:"user-detail-stat-label",children:"Quiz russis"})]}),r.jsxs("div",{className:"user-detail-stat",children:[r.jsx(so,{size:20}),r.jsx("span",{className:"user-detail-stat-value",children:M.dernierQuiz?I(M.dernierQuiz):"Aucun"}),r.jsx("span",{className:"user-detail-stat-label",children:"Dernier quiz"})]})]}):r.jsx("p",{className:"user-detail-no-stats",children:"Aucune statistique disponible."})]})]})]})}):null;return r.jsxs("div",{className:"admin-container",children:[V(),xe(),ve(),r.jsxs("div",{className:"user-manager",children:[r.jsxs("div",{className:"admin-header",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"admin-title",children:[r.jsx(nm,{size:24})," Gestion des Utilisateurs"]}),r.jsxs("p",{className:"admin-subtitle",children:[e.length," utilisateur(s) au total  ",q.length," affich(s)"]})]}),r.jsxs("button",{className:"admin-btn admin-btn-outline",onClick:P,children:[r.jsx(m3,{size:16})," Actualiser"]})]}),oe(),r.jsxs("div",{className:"admin-toolbar",children:[r.jsxs("div",{className:"admin-search-wrapper",children:[r.jsx(cA,{size:18,className:"admin-search-icon"}),r.jsx("input",{type:"text",className:"admin-search-input",placeholder:"Rechercher par nom ou email...",value:h,onChange:H=>v(H.target.value)})]}),r.jsxs("button",{className:`admin-btn admin-btn-outline ${E?"active":""}`,onClick:()=>S(!E),children:[r.jsx(Tb,{size:16})," Filtres",E?r.jsx(Nx,{size:14}):r.jsx(mm,{size:14})]})]}),E&&r.jsxs("div",{className:"admin-filters-panel",children:[r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Rle"}),r.jsxs("select",{className:"admin-select",value:b,onChange:H=>x(H.target.value),children:[r.jsx("option",{value:"",children:"Tous les rles"}),r.jsx("option",{value:"admin",children:"Admin"}),r.jsx("option",{value:"prof",children:"Professeur"}),r.jsx("option",{value:"eleve",children:"lve"})]})]}),r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Abonnement"}),r.jsxs("select",{className:"admin-select",value:j,onChange:H=>N(H.target.value),children:[r.jsx("option",{value:"",children:"Tous"}),r.jsx("option",{value:"true",children:"Premium"}),r.jsx("option",{value:"false",children:"Gratuit"})]})]}),r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Statut"}),r.jsxs("select",{className:"admin-select",value:w,onChange:H=>C(H.target.value),children:[r.jsx("option",{value:"",children:"Tous"}),r.jsx("option",{value:"true",children:"Actifs"}),r.jsx("option",{value:"false",children:"Dsactivs"})]})]}),r.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{x(""),N(""),C(""),v("")},children:"Rinitialiser"})]}),l?r.jsxs("div",{className:"admin-loading",children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement des utilisateurs..."})]}):q.length===0?r.jsxs("div",{className:"admin-empty-state",children:[r.jsx(nm,{size:48}),r.jsx("h3",{children:"Aucun utilisateur trouv"}),r.jsx("p",{children:e.length===0?"Aucun utilisateur n'est encore inscrit.":"Aucun utilisateur ne correspond  vos filtres."})]}):r.jsx("div",{className:"user-table-wrapper",children:r.jsxs("table",{className:"user-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Utilisateur"}),r.jsx("th",{children:"Rle"}),r.jsx("th",{children:"Abonnement"}),r.jsx("th",{children:"Statut"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:q.map(H=>r.jsxs("tr",{className:H.isActive===!1?"user-row-inactive":"",children:[r.jsx("td",{children:r.jsxs("div",{className:"user-cell-info",children:[r.jsx("div",{className:"user-avatar-sm",children:re(H.displayName)}),r.jsxs("div",{children:[r.jsx("span",{className:"user-cell-name",children:H.displayName||"Sans nom"}),r.jsx("span",{className:"user-cell-email",children:H.email})]})]})}),r.jsx("td",{children:r.jsxs("select",{className:"admin-select admin-select-sm",value:H.role,onChange:he=>se({type:"role",userId:H.uid,value:he.target.value,label:`Changer le rle de "${H.displayName||H.email}" en "${he.target.value}" ?`}),children:[r.jsx("option",{value:"eleve",children:"lve"}),r.jsx("option",{value:"prof",children:"Professeur"}),r.jsx("option",{value:"admin",children:"Admin"})]})}),r.jsx("td",{children:r.jsx("button",{className:`user-premium-toggle ${H.isPremium?"active":""}`,onClick:()=>se({type:"premium",userId:H.uid,value:!H.isPremium,label:H.isPremium?`Dsactiver le statut Premium de "${H.displayName||H.email}" ?`:`Activer le statut Premium de "${H.displayName||H.email}" pour 30 jours ?`}),disabled:L===H.uid,children:H.isPremium?r.jsxs(r.Fragment,{children:[r.jsx(Ac,{size:14})," Premium"]}):r.jsxs(r.Fragment,{children:[r.jsx(Zr,{size:14})," Gratuit"]})})}),r.jsx("td",{children:r.jsx("button",{className:`user-status-toggle ${H.isActive!==!1?"active":"inactive"}`,onClick:()=>se({type:"active",userId:H.uid,value:H.isActive===!1,label:H.isActive===!1?`Ractiver le compte de "${H.displayName||H.email}" ?`:`Dsactiver le compte de "${H.displayName||H.email}" ?`}),disabled:L===H.uid,children:H.isActive!==!1?r.jsxs(r.Fragment,{children:[r.jsx(f3,{size:14})," Actif"]}):r.jsxs(r.Fragment,{children:[r.jsx(p3,{size:14})," Dsactiv"]})})}),r.jsx("td",{children:r.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>F(H),title:"Voir les statistiques",children:[r.jsx(no,{size:14})," Dtail"]})})]},H.uid))})]})})]})]})},eR=()=>{const[e,t]=g.useState([]),[n,a]=g.useState(null),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState(""),[h,v]=g.useState(""),[b,x]=g.useState(""),[j,N]=g.useState(!1),w=g.useCallback(async()=>{try{o(!0),d(null);const O=await Ce(je(K,"users")),k=new Map;O.docs.forEach(oe=>{const xe=oe.data();k.set(oe.id,{name:xe.displayName||"Sans nom",email:xe.email||""})});const M=await Ce(je(K,"quizzes")),D=new Map;M.docs.forEach(oe=>{const xe=oe.data();D.set(oe.id,{titre:xe.titre||xe.quizTitre||"Quiz sans titre",discipline:xe.disciplineNom||xe.matiereNom||""})});const $=await Ce(je(K,"quizzes_v2")),U=new Map;$.docs.forEach(oe=>{const xe=oe.data();U.set(oe.id,{titre:xe.titre||"Quiz avanc sans titre",discipline:xe.disciplineNom||""})});const L=[];try{(await Ce(Ee(je(K,"quiz_results"),Ve("datePassage","desc"),ar(200)))).docs.forEach(xe=>{const ve=xe.data(),H=k.get(ve.userId)||{name:"Inconnu",email:""},he=D.get(ve.quizId)||{titre:ve.quizTitre||"Quiz",discipline:ve.disciplineNom||""},Pe=ve.pourcentage??(ve.totalPoints>0?Math.round(ve.score/ve.totalPoints*100):ve.score>0?Math.round(ve.score/20*100):0);L.push({id:xe.id,quizId:ve.quizId||"",quizTitre:he.titre,userId:ve.userId||"",userName:H.name,userEmail:H.email,score:ve.score||0,scoreMax:ve.totalPoints||20,pourcentage:Pe,reussi:ve.reussi??Pe>=50,tempsEcoule:ve.tempsEcoule||0,datePassage:ve.datePassage?.toDate?.()||new Date,type:"classique",disciplineNom:he.discipline})})}catch(oe){console.warn("Pas de rsultats v1 ou index manquant:",oe)}const B=[];try{(await Ce(Ee(je(K,"quiz_results_v2"),Ve("datePassage","desc"),ar(200)))).docs.forEach(xe=>{const ve=xe.data(),H=k.get(ve.userId)||{name:"Inconnu",email:""},he=U.get(ve.quizId)||{titre:ve.quizTitre||"Quiz avanc",discipline:ve.disciplineNom||""},Pe=ve.scoreMax>0?Math.round(ve.score/ve.scoreMax*100):0;B.push({id:xe.id,quizId:ve.quizId||"",quizTitre:he.titre,userId:ve.userId||"",userName:H.name,userEmail:H.email,score:ve.score||0,scoreMax:ve.scoreMax||0,pourcentage:Pe,reussi:ve.reussi??Pe>=50,tempsEcoule:ve.tempsTotal||ve.tempsEcoule||0,datePassage:ve.datePassage?.toDate?.()||new Date,type:"avance",disciplineNom:he.discipline})})}catch(oe){console.warn("Pas de rsultats v2 ou index manquant:",oe)}const ee=[...L,...B].sort((oe,xe)=>xe.datePassage.getTime()-oe.datePassage.getTime());t(ee);const se=new Date,P=new Date(se.getFullYear(),se.getMonth(),se.getDate()),q=new Date(P.getTime()-10080*60*1e3),F=ee.length,R=F>0?Math.round(ee.reduce((oe,xe)=>oe+xe.pourcentage,0)/F):0,W=F>0?Math.round(ee.filter(oe=>oe.reussi).length/F*100):0,I=F>0?Math.round(ee.reduce((oe,xe)=>oe+xe.tempsEcoule,0)/F):0,re=ee.filter(oe=>oe.datePassage>=P).length,V=ee.filter(oe=>oe.datePassage>=q).length;a({totalResultats:F,moyenneGenerale:R,tauxReussite:W,tempsEcouleMoyen:I,resultatsAujourdHui:re,resultats7Jours:V})}catch(O){console.error("Erreur chargement rsultats:",O),d("Impossible de charger les rsultats. Vrifiez votre connexion.")}finally{o(!1)}},[]);g.useEffect(()=>{w()},[w]);const C=e.filter(O=>{if(f&&O.type!==f||h==="true"&&!O.reussi||h==="false"&&O.reussi)return!1;if(b){const k=b.toLowerCase();if(!O.userName.toLowerCase().includes(k)&&!O.userEmail.toLowerCase().includes(k)&&!O.quizTitre.toLowerCase().includes(k)&&!O.disciplineNom.toLowerCase().includes(k))return!1}return!0}),E=O=>{if(O<60)return`${O}s`;const k=Math.floor(O/60),M=O%60;return M>0?`${k}min ${M}s`:`${k}min`},S=O=>O.toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),A=O=>O>=80?"results-score--excellent":O>=60?"results-score--bien":O>=40?"results-score--moyen":"results-score--faible";return r.jsxs("div",{className:"results-admin",children:[r.jsxs("div",{className:"admin-page-header",children:[r.jsxs("div",{className:"admin-page-header__info",children:[r.jsx("h1",{className:"admin-page-header__title",children:" Rsultats des Quiz"}),r.jsx("p",{className:"admin-page-header__subtitle",children:"Vue d'ensemble des performances des lves"})]}),r.jsx("div",{className:"admin-page-header__actions",children:r.jsx("button",{className:"admin-btn admin-btn-secondary",onClick:w,children:" Actualiser"})})]}),n&&r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--primary",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.totalResultats}),r.jsx("div",{className:"stat-card__label",children:"Rsultats totaux"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--secondary",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsxs("div",{className:"stat-card__value",children:[n.moyenneGenerale,"%"]}),r.jsx("div",{className:"stat-card__label",children:"Moyenne gnrale"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--warning",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsxs("div",{className:"stat-card__value",children:[n.tauxReussite,"%"]}),r.jsx("div",{className:"stat-card__label",children:"Taux de russite"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--info",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.resultatsAujourdHui}),r.jsx("div",{className:"stat-card__label",children:"Aujourd'hui"})]})]})]}),r.jsxs("div",{className:"admin-toolbar",children:[r.jsxs("div",{className:"admin-search",children:[r.jsx("span",{className:"admin-search-icon",children:""}),r.jsx("input",{type:"text",className:"admin-search-input",placeholder:"Rechercher par lve, quiz ou discipline...",value:b,onChange:O=>x(O.target.value)})]}),r.jsx("button",{className:`admin-btn admin-btn-ghost ${j?"active":""}`,onClick:()=>N(!j),children:" Filtres"})]}),j&&r.jsxs("div",{className:"admin-filters-panel",children:[r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Type de quiz"}),r.jsxs("select",{className:"admin-select",value:f,onChange:O=>p(O.target.value),children:[r.jsx("option",{value:"",children:"Tous les types"}),r.jsx("option",{value:"classique",children:"Classique (v1)"}),r.jsx("option",{value:"avance",children:"Avanc (v2)"})]})]}),r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Rsultat"}),r.jsxs("select",{className:"admin-select",value:h,onChange:O=>v(O.target.value),children:[r.jsx("option",{value:"",children:"Tous"}),r.jsx("option",{value:"true",children:"Russis"}),r.jsx("option",{value:"false",children:"chous"})]})]}),r.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{p(""),v(""),x("")},children:"Rinitialiser"})]}),l?r.jsxs("div",{className:"admin-loading",children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement des rsultats..."})]}):u?r.jsxs("div",{className:"admin-error",children:[r.jsxs("p",{children:[" ",u]}),r.jsx("button",{className:"admin-btn admin-btn-primary",onClick:w,children:"Ressayer"})]}):C.length===0?r.jsxs("div",{className:"admin-empty-state",children:[r.jsx("span",{style:{fontSize:"3rem"},children:""}),r.jsx("h3",{children:"Aucun rsultat trouv"}),r.jsx("p",{children:e.length===0?"Aucun lve n'a encore pass de quiz.":"Aucun rsultat ne correspond  vos filtres."})]}):r.jsxs("div",{className:"results-table-wrapper",children:[r.jsxs("table",{className:"results-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"lve"}),r.jsx("th",{children:"Quiz"}),r.jsx("th",{children:"Type"}),r.jsx("th",{children:"Score"}),r.jsx("th",{children:"Rsultat"}),r.jsx("th",{children:"Dure"}),r.jsx("th",{children:"Date"})]})}),r.jsx("tbody",{children:C.map(O=>r.jsxs("tr",{children:[r.jsx("td",{children:r.jsxs("div",{className:"results-cell-user",children:[r.jsx("span",{className:"results-cell-name",children:O.userName}),r.jsx("span",{className:"results-cell-email",children:O.userEmail})]})}),r.jsx("td",{children:r.jsxs("div",{className:"results-cell-quiz",children:[r.jsx("span",{className:"results-cell-quiz-title",children:O.quizTitre}),O.disciplineNom&&r.jsx("span",{className:"results-cell-discipline",children:O.disciplineNom})]})}),r.jsx("td",{children:r.jsx("span",{className:`results-badge results-badge--${O.type}`,children:O.type==="classique"?" Classique":" Avanc"})}),r.jsxs("td",{children:[r.jsxs("span",{className:`results-score ${A(O.pourcentage)}`,children:[O.pourcentage,"%"]}),r.jsxs("span",{className:"results-score-detail",children:[O.score,"/",O.scoreMax]})]}),r.jsx("td",{children:r.jsx("span",{className:`results-status ${O.reussi?"results-status--success":"results-status--fail"}`,children:O.reussi?" Russi":" chou"})}),r.jsx("td",{className:"results-cell-duration",children:E(O.tempsEcoule)}),r.jsx("td",{className:"results-cell-date",children:S(O.datePassage)})]},`${O.type}-${O.id}`))})]}),r.jsx("div",{className:"results-footer",children:r.jsxs("p",{children:[C.length," rsultat",C.length>1?"s":""," affich",C.length>1?"s":"",C.length!==e.length&&` sur ${e.length} au total`]})})]})]})},Hl={siteName:"PedaClic",siteDescription:"L'cole en un clic  Plateforme ducative sngalaise",contactEmail:"contact@pedaclic.sn",contactPhone:"+221 XX XXX XX XX",premium3m:1e4,premium6m:2e4,premium1an:3e4,quizDureeDefaut:15,quizNoteMinimale:10,quizTentativesMax:3,maintenanceMode:!1,maintenanceMessage:"PedaClic est en maintenance. Nous revenons bientt !",cahierPdfExport:!0},tR=()=>{const[e,t]=g.useState(Hl),[n,a]=g.useState(Hl),[l,o]=g.useState(!0),[u,d]=g.useState(!1),[f,p]=g.useState(null),[h,v]=g.useState(null),[b,x]=g.useState(!1),j=g.useCallback(async()=>{try{o(!0),p(null);const S=Ne(K,"settings","platform"),A=await Dt(S);if(A.exists()){const O=A.data(),k={...Hl,...O};t(k),a(k)}else t(Hl),a(Hl)}catch(S){console.error("Erreur chargement paramtres:",S),p("Impossible de charger les paramtres.")}finally{o(!1)}},[]);g.useEffect(()=>{j()},[j]),g.useEffect(()=>{if(h){const S=setTimeout(()=>v(null),4e3);return()=>clearTimeout(S)}},[h]),g.useEffect(()=>{const S=JSON.stringify(e)!==JSON.stringify(n);x(S)},[e,n]);const N=(S,A)=>{t(O=>({...O,[S]:A}))},w=async()=>{try{if(d(!0),p(null),e.premium3m<0||e.premium6m<0||e.premium1an<0){p("Les tarifs ne peuvent pas tre ngatifs.");return}if(e.quizNoteMinimale<0||e.quizNoteMinimale>20){p("La note minimale doit tre entre 0 et 20.");return}const S=Ne(K,"settings","platform");await gf(S,{...e,updatedAt:Ot()}),a(e),x(!1),v("Paramtres sauvegards avec succs !")}catch(S){console.error("Erreur sauvegarde paramtres:",S),p("Impossible de sauvegarder les paramtres.")}finally{d(!1)}},C=()=>{t(n),x(!1)},E=()=>{window.confirm("Rinitialiser tous les paramtres aux valeurs par dfaut ?")&&t(Hl)};return l?r.jsxs("div",{className:"admin-loading",children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement des paramtres..."})]}):r.jsxs("div",{className:"settings-admin",children:[r.jsxs("div",{className:"admin-page-header",children:[r.jsxs("div",{className:"admin-page-header__info",children:[r.jsx("h1",{className:"admin-page-header__title",children:" Configuration"}),r.jsx("p",{className:"admin-page-header__subtitle",children:"Paramtres gnraux de la plateforme PedaClic"})]}),r.jsxs("div",{className:"admin-page-header__actions",children:[b&&r.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:C,children:"Annuler"}),r.jsx("button",{className:"admin-btn admin-btn-primary",onClick:w,disabled:!b||u,children:u?" Sauvegarde...":" Sauvegarder"})]})]}),b&&r.jsx("div",{className:"settings-unsaved-banner",children:" Vous avez des modifications non sauvegardes."}),f&&r.jsxs("div",{className:"admin-alert admin-alert--error",children:[" ",f]}),h&&r.jsxs("div",{className:"admin-alert admin-alert--success",children:[" ",h]}),r.jsxs("div",{className:"settings-section",children:[r.jsxs("div",{className:"settings-section__header",children:[r.jsx("h2",{className:"settings-section__title",children:" Informations gnrales"}),r.jsx("p",{className:"settings-section__description",children:"Informations de base de la plateforme"})]}),r.jsxs("div",{className:"settings-grid",children:[r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Nom du site"}),r.jsx("input",{type:"text",className:"admin-input",value:e.siteName,onChange:S=>N("siteName",S.target.value)})]}),r.jsxs("div",{className:"settings-field settings-field--full",children:[r.jsx("label",{className:"settings-label",children:"Description"}),r.jsx("input",{type:"text",className:"admin-input",value:e.siteDescription,onChange:S=>N("siteDescription",S.target.value)})]}),r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Email de contact"}),r.jsx("input",{type:"email",className:"admin-input",value:e.contactEmail,onChange:S=>N("contactEmail",S.target.value)})]}),r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Tlphone"}),r.jsx("input",{type:"tel",className:"admin-input",value:e.contactPhone,onChange:S=>N("contactPhone",S.target.value)})]})]})]}),r.jsxs("div",{className:"settings-section",children:[r.jsxs("div",{className:"settings-section__header",children:[r.jsx("h2",{className:"settings-section__title",children:" Tarifs Premium"}),r.jsx("p",{className:"settings-section__description",children:"Montants des abonnements en FCFA"})]}),r.jsxs("div",{className:"settings-grid",children:[r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Accs illimit 3 mois (FCFA)"}),r.jsx("input",{type:"number",className:"admin-input",value:e.premium3m,onChange:S=>N("premium3m",parseInt(S.target.value)||0),min:0,step:500})]}),r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Accs illimit 6 mois (FCFA)"}),r.jsx("input",{type:"number",className:"admin-input",value:e.premium6m,onChange:S=>N("premium6m",parseInt(S.target.value)||0),min:0,step:1e3}),r.jsxs("span",{className:"settings-hint",children:["conomie vs 23 mois : ",(e.premium3m*2-e.premium6m).toLocaleString("fr-FR")," FCFA"]})]}),r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Accs illimit 1 an (FCFA)"}),r.jsx("input",{type:"number",className:"admin-input",value:e.premium1an,onChange:S=>N("premium1an",parseInt(S.target.value)||0),min:0,step:1e3}),r.jsxs("span",{className:"settings-hint",children:["conomie vs 43 mois : ",(e.premium3m*4-e.premium1an).toLocaleString("fr-FR")," FCFA"]})]})]})]}),r.jsxs("div",{className:"settings-section",children:[r.jsxs("div",{className:"settings-section__header",children:[r.jsx("h2",{className:"settings-section__title",children:" Paramtres des Quiz"}),r.jsx("p",{className:"settings-section__description",children:"Valeurs par dfaut pour la cration de quiz"})]}),r.jsxs("div",{className:"settings-grid",children:[r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Dure par dfaut (minutes)"}),r.jsx("input",{type:"number",className:"admin-input",value:e.quizDureeDefaut,onChange:S=>N("quizDureeDefaut",parseInt(S.target.value)||0),min:1,max:120})]}),r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Note minimale pour russir (/20)"}),r.jsx("input",{type:"number",className:"admin-input",value:e.quizNoteMinimale,onChange:S=>N("quizNoteMinimale",parseInt(S.target.value)||0),min:0,max:20})]}),r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Tentatives max par quiz"}),r.jsx("input",{type:"number",className:"admin-input",value:e.quizTentativesMax,onChange:S=>N("quizTentativesMax",parseInt(S.target.value)||0),min:1,max:10}),r.jsx("span",{className:"settings-hint",children:"0 = illimit"})]})]})]}),r.jsxs("div",{className:"settings-section",children:[r.jsxs("div",{className:"settings-section__header",children:[r.jsx("h2",{className:"settings-section__title",children:" Cahier de Textes"}),r.jsx("p",{className:"settings-section__description",children:"Options des fonctionnalits du cahier de textes pour les professeurs"})]}),r.jsx("div",{className:"settings-grid",children:r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Export PDF du cahier"}),r.jsxs("div",{className:"settings-toggle-wrapper",children:[r.jsx("button",{className:`settings-toggle ${e.cahierPdfExport?"settings-toggle--active":""}`,onClick:()=>N("cahierPdfExport",!e.cahierPdfExport),children:r.jsx("span",{className:"settings-toggle__knob"})}),r.jsx("span",{className:`settings-toggle-label ${e.cahierPdfExport?"settings-toggle-label--active":""}`,children:e.cahierPdfExport?" Export PDF activ":" Export PDF dsactiv"})]}),r.jsx("span",{className:"settings-hint",children:'Affiche le bouton " PDF" dans les cahiers de textes des professeurs'})]})})]}),r.jsxs("div",{className:"settings-section",children:[r.jsxs("div",{className:"settings-section__header",children:[r.jsx("h2",{className:"settings-section__title",children:" Mode Maintenance"}),r.jsx("p",{className:"settings-section__description",children:"Activer pour bloquer l'accs au site pendant les mises  jour"})]}),r.jsxs("div",{className:"settings-grid",children:[r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Mode maintenance"}),r.jsxs("div",{className:"settings-toggle-wrapper",children:[r.jsx("button",{className:`settings-toggle ${e.maintenanceMode?"settings-toggle--active":""}`,onClick:()=>N("maintenanceMode",!e.maintenanceMode),children:r.jsx("span",{className:"settings-toggle__knob"})}),r.jsx("span",{className:`settings-toggle-label ${e.maintenanceMode?"settings-toggle-label--active":""}`,children:e.maintenanceMode?" Maintenance active":" Site en ligne"})]})]}),r.jsxs("div",{className:"settings-field settings-field--full",children:[r.jsx("label",{className:"settings-label",children:"Message affich aux visiteurs"}),r.jsx("textarea",{className:"admin-input admin-textarea",rows:3,value:e.maintenanceMessage,onChange:S=>N("maintenanceMessage",S.target.value),disabled:!e.maintenanceMode})]})]})]}),r.jsxs("div",{className:"settings-actions",children:[r.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:E,children:" Rinitialiser aux valeurs par dfaut"}),r.jsx("button",{className:"admin-btn admin-btn-primary",onClick:w,disabled:!b||u,children:u?" Sauvegarde...":" Sauvegarder les modifications"})]})]})},rR=["#000000","#1f2937","#374151","#6b7280","#dc2626","#ef4444","#f97316","#d97706","#eab308","#65a30d","#059669","#14b8a6","#2563eb","#3b82f6","#0891b2","#7c3aed","#db2777","#ec4899","#be185d","#9333ea","#ffffff","#f3f4f6","#fef3c7","#dbeafe"],nR=["#fef08a","#fde68a","#fef3c7","#bbf7d0","#d1fae5","#a7f3d0","#bfdbfe","#dbeafe","#c7d2fe","#fecaca","#fee2e2","#fde8e8","#e9d5ff","#f3e8ff","#d8b4fe","#fed7aa","#ffedd5","#fce7f3","transparent","#ffffff"],aR=["#f0fdf4","#ecfdf5","#f0f9ff","#eff6ff","#faf5ff","#fdf2f8","#fff7ed","#fffbeb","#fef2f2","#f9fafb","#f3f4f6","transparent"],iR=[{tag:"p",label:" Paragraphe"},{tag:"h1",label:"H1  Titre 1"},{tag:"h2",label:"H2  Titre 2"},{tag:"h3",label:"H3  Titre 3"},{tag:"h4",label:"H4  Titre 4"},{tag:"pre",label:"</> Code"},{tag:"blockquote",label:" Citation"}],sR=[{value:"1",label:"Trs petit"},{value:"2",label:"Petit"},{value:"3",label:"Normal"},{value:"4",label:"Grand"},{value:"5",label:"Trs grand"},{value:"6",label:"norme"}],lR=["headinglevel","fontsize","separator","bold","italic","underline","strikethrough","separator","color","highlight","blockBg","separator","alignLeft","alignCenter","alignRight","alignJustify","separator","bulletList","numberedList","indent","outdent","separator","subscript","superscript","link","clean"],va=({value:e,onChange:t,placeholder:n="Saisissez votre texte...",minHeight:a=120,maxHeight:l=500,toolbar:o=lR,disabled:u=!1,className:d=""})=>{const f=g.useRef(null),p=g.useRef(!1),[h,v]=g.useState(!1),[b,x]=g.useState(!1),[j,N]=g.useState(!1);g.useEffect(()=>{f.current&&!p.current&&f.current.innerHTML!==e&&(f.current.innerHTML=e||""),p.current=!1},[e]);const w=g.useCallback(()=>{f.current&&(p.current=!0,t(f.current.innerHTML))},[t]),C=g.useCallback((k,M)=>{f.current?.focus(),document.execCommand(k,!1,M),w()},[w]),E=g.useCallback(k=>{f.current?.focus();const M=window.getSelection();if(!M||!f.current)return;let D=M.anchorNode;for(;D&&D!==f.current;){if(D.nodeType===Node.ELEMENT_NODE){const $=D,U=$.tagName;if(["P","DIV","H1","H2","H3","H4","LI","BLOCKQUOTE","PRE"].includes(U)){$.style.backgroundColor=k==="transparent"?"":k,w();return}}D=D.parentNode}document.execCommand("hiliteColor",!1,k==="transparent"?"transparent":k),w()},[w]),S=g.useCallback(()=>{const k=prompt("URL du lien :","https://");k&&C("createLink",k)},[C]),A=g.useCallback(()=>{C("removeFormat"),C("formatBlock","p")},[C]);g.useEffect(()=>{const k=()=>{v(!1),x(!1),N(!1)};return document.addEventListener("click",k),()=>document.removeEventListener("click",k)},[]);const O=(k,M)=>{switch(k){case"separator":return r.jsx("span",{className:"rte-separator"},`sep-${M}`);case"bold":return r.jsx("button",{type:"button",className:"rte-btn",title:"Gras (Ctrl+B)",onMouseDown:D=>{D.preventDefault(),C("bold")},children:r.jsx("strong",{children:"G"})},"bold");case"italic":return r.jsx("button",{type:"button",className:"rte-btn",title:"Italique (Ctrl+I)",onMouseDown:D=>{D.preventDefault(),C("italic")},children:r.jsx("em",{children:"I"})},"italic");case"underline":return r.jsx("button",{type:"button",className:"rte-btn",title:"Soulign (Ctrl+U)",onMouseDown:D=>{D.preventDefault(),C("underline")},children:r.jsx("u",{children:"S"})},"underline");case"strikethrough":return r.jsx("button",{type:"button",className:"rte-btn",title:"Barr",onMouseDown:D=>{D.preventDefault(),C("strikeThrough")},children:r.jsx("s",{children:"R"})},"strike");case"headinglevel":return r.jsxs("select",{className:"rte-select",title:"Niveau de titre",defaultValue:"",onChange:D=>{const $=D.target.value;f.current?.focus(),document.execCommand("formatBlock",!1,$),w(),D.target.value=""},children:[r.jsx("option",{value:"",disabled:!0,children:"Titre"}),iR.map(D=>r.jsx("option",{value:D.tag,children:D.label},D.tag))]},"headinglevel");case"fontsize":return r.jsxs("select",{className:"rte-select",title:"Taille de police",defaultValue:"",onChange:D=>{const $=D.target.value;f.current?.focus(),document.execCommand("fontSize",!1,$),w(),D.target.value=""},children:[r.jsx("option",{value:"",disabled:!0,children:"Taille"}),sR.map(D=>r.jsx("option",{value:D.value,children:D.label},D.value))]},"fontsize");case"color":return r.jsxs("span",{className:"rte-dropdown-wrapper",onClick:D=>D.stopPropagation(),children:[r.jsx("button",{type:"button",className:"rte-btn",title:"Couleur du texte",onClick:()=>{v(D=>!D),x(!1),N(!1)},children:r.jsx("span",{style:{borderBottom:"3px solid #dc2626",paddingBottom:1},children:"A"})}),h&&r.jsx("div",{className:"rte-color-picker rte-color-picker--grid",children:rR.map(D=>r.jsx("button",{type:"button",className:"rte-color-swatch",style:{backgroundColor:D,border:D==="#ffffff"||D==="#f3f4f6"?"1px solid #d1d5db":"1px solid transparent"},title:D,onMouseDown:$=>{$.preventDefault(),C("foreColor",D),v(!1)}},D))})]},"color");case"highlight":return r.jsxs("span",{className:"rte-dropdown-wrapper",onClick:D=>D.stopPropagation(),children:[r.jsx("button",{type:"button",className:"rte-btn",title:"Fond de texte (surlignage)",onClick:()=>{x(D=>!D),v(!1),N(!1)},children:r.jsx("span",{style:{backgroundColor:"#fef08a",padding:"0 3px",borderRadius:2},children:"A"})}),b&&r.jsx("div",{className:"rte-color-picker rte-color-picker--grid",children:nR.map((D,$)=>r.jsx("button",{type:"button",className:"rte-color-swatch",style:{backgroundColor:D==="transparent"?"#fff":D,border:"1px solid #d1d5db"},title:D==="transparent"?"Aucun fond":D,onMouseDown:U=>{U.preventDefault(),C("hiliteColor",D==="transparent"?"transparent":D),x(!1)},children:D==="transparent"?r.jsx("span",{style:{fontSize:10,color:"#6b7280"},children:""}):null},$))})]},"highlight");case"blockBg":return r.jsxs("span",{className:"rte-dropdown-wrapper",onClick:D=>D.stopPropagation(),children:[r.jsx("button",{type:"button",className:"rte-btn",title:"Trame de fond du paragraphe",onClick:()=>{N(D=>!D),v(!1),x(!1)},children:r.jsx("span",{style:{background:"linear-gradient(135deg, #dbeafe 40%, #d1fae5 100%)",padding:"0 3px",borderRadius:2},children:""})}),j&&r.jsx("div",{className:"rte-color-picker rte-color-picker--grid",children:aR.map((D,$)=>r.jsx("button",{type:"button",className:"rte-color-swatch rte-color-swatch--block",style:{backgroundColor:D==="transparent"?"#fff":D,border:"1px solid #d1d5db"},title:D==="transparent"?"Aucun fond":"Fond de bloc",onMouseDown:U=>{U.preventDefault(),E(D),N(!1)},children:D==="transparent"?r.jsx("span",{style:{fontSize:10,color:"#6b7280"},children:""}):null},$))})]},"blockbg");case"alignLeft":return r.jsx("button",{type:"button",className:"rte-btn",title:"Aligner  gauche",onMouseDown:D=>{D.preventDefault(),C("justifyLeft")},children:r.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:r.jsx("path",{d:"M2 12.5a.5.5 0 010-1h7a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h11a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h7a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h11a.5.5 0 010 1H2z"})})},"alignL");case"alignCenter":return r.jsx("button",{type:"button",className:"rte-btn",title:"Centrer",onMouseDown:D=>{D.preventDefault(),C("justifyCenter")},children:r.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:r.jsx("path",{d:"M4 12.5a.5.5 0 010-1h8a.5.5 0 010 1H4zm-2-3a.5.5 0 010-1h12a.5.5 0 010 1H2zm2-3a.5.5 0 010-1h8a.5.5 0 010 1H4zm-2-3a.5.5 0 010-1h12a.5.5 0 010 1H2z"})})},"alignC");case"alignRight":return r.jsx("button",{type:"button",className:"rte-btn",title:"Aligner  droite",onMouseDown:D=>{D.preventDefault(),C("justifyRight")},children:r.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:r.jsx("path",{d:"M14 12.5a.5.5 0 010-1H7a.5.5 0 010 1h7zm0-3a.5.5 0 010-1H3a.5.5 0 010 1h11zm0-3a.5.5 0 010-1H7a.5.5 0 010 1h7zm0-3a.5.5 0 010-1H3a.5.5 0 010 1h11z"})})},"alignR");case"alignJustify":return r.jsx("button",{type:"button",className:"rte-btn",title:"Justifier",onMouseDown:D=>{D.preventDefault(),C("justifyFull")},children:r.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:r.jsx("path",{d:"M2 12.5a.5.5 0 010-1h12a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h12a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h12a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h12a.5.5 0 010 1H2z"})})},"alignJ");case"bulletList":return r.jsx("button",{type:"button",className:"rte-btn",title:"Liste  puces",onMouseDown:D=>{D.preventDefault(),C("insertUnorderedList")},children:""},"ul");case"numberedList":return r.jsx("button",{type:"button",className:"rte-btn",title:"Liste numrote",onMouseDown:D=>{D.preventDefault(),C("insertOrderedList")},children:"1"},"ol");case"indent":return r.jsx("button",{type:"button",className:"rte-btn",title:"Augmenter le retrait",onMouseDown:D=>{D.preventDefault(),C("indent")},children:""},"indent");case"outdent":return r.jsx("button",{type:"button",className:"rte-btn",title:"Diminuer le retrait",onMouseDown:D=>{D.preventDefault(),C("outdent")},children:""},"outdent");case"blockquote":return r.jsx("button",{type:"button",className:"rte-btn",title:"Citation",onMouseDown:D=>{D.preventDefault(),C("formatBlock","blockquote")},children:""},"blockquote");case"subscript":return r.jsxs("button",{type:"button",className:"rte-btn",title:"Indice",onMouseDown:D=>{D.preventDefault(),C("subscript")},children:["X",r.jsx("sub",{children:""})]},"sub");case"superscript":return r.jsxs("button",{type:"button",className:"rte-btn",title:"Exposant",onMouseDown:D=>{D.preventDefault(),C("superscript")},children:["X",r.jsx("sup",{children:""})]},"sup");case"link":return r.jsx("button",{type:"button",className:"rte-btn",title:"Insrer un lien",onMouseDown:D=>{D.preventDefault(),S()},children:""},"link");case"clean":return r.jsx("button",{type:"button",className:"rte-btn rte-btn-clean",title:"Effacer le formatage",onMouseDown:D=>{D.preventDefault(),A()},children:""},"clean");default:return null}};return r.jsxs("div",{className:`rte-container ${u?"rte-disabled":""} ${d}`,children:[!u&&r.jsx("div",{className:"rte-toolbar",children:o.map((k,M)=>O(k,M))}),r.jsx("div",{ref:f,className:"rte-editor",contentEditable:!u,onInput:w,onBlur:w,"data-placeholder":n,style:{minHeight:`${a}px`,maxHeight:`${l}px`},suppressContentEditableWarning:!0})]})},lo={qcm_unique:"QCM  Choix unique",qcm_multiple:"QCM  Choix multiple",drag_drop:"Glisser-Dposer",mise_en_relation:"Mise en relation",essai:"Essai / Rdaction"},hm={qcm_unique:"",qcm_multiple:"",drag_drop:"",mise_en_relation:"",essai:""},vm={qcm_unique:"#2563eb",qcm_multiple:"#7c3aed",drag_drop:"#059669",mise_en_relation:"#d97706",essai:"#dc2626"};function Zt(e="id"){return`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function oR(e,t){const n={id:Zt("q"),type:e,enonce:"",difficulte:"moyen",points:2,ordre:t};switch(e){case"qcm_unique":return{...n,typeData:{options:[{id:Zt("opt"),texte:"",isCorrect:!0},{id:Zt("opt"),texte:"",isCorrect:!1},{id:Zt("opt"),texte:"",isCorrect:!1},{id:Zt("opt"),texte:"",isCorrect:!1}]}};case"qcm_multiple":return{...n,typeData:{options:[{id:Zt("opt"),texte:"",isCorrect:!0},{id:Zt("opt"),texte:"",isCorrect:!0},{id:Zt("opt"),texte:"",isCorrect:!1},{id:Zt("opt"),texte:"",isCorrect:!1}],scoringPartiel:!0}};case"drag_drop":return{...n,typeData:{items:[{id:Zt("item"),texte:"",ordreCorrect:1},{id:Zt("item"),texte:"",ordreCorrect:2},{id:Zt("item"),texte:"",ordreCorrect:3}],consigneOrdre:"Remettez les lments dans le bon ordre"}};case"mise_en_relation":return{...n,typeData:{paires:[{id:Zt("pair"),gauche:"",droite:""},{id:Zt("pair"),gauche:"",droite:""},{id:Zt("pair"),gauche:"",droite:""}]}};case"essai":return{...n,points:5,typeData:{nombreMotsMin:50,nombreMotsMax:500,motsCles:[],correctionMode:"manuelle"}}}}const nu="quizzes_v2",cR="quiz_results_v2";async function uR(e,t){try{const n=await qt(je(K,nu),{...e,auteurId:t,createdAt:Ot(),updatedAt:Ot()});return console.log(" Quiz avanc cr :",n.id),n.id}catch(n){throw console.error(" Erreur cration quiz avanc :",n),new Error("Impossible de crer le quiz")}}async function dR(e,t){try{const n=Ne(K,nu,e);await Qe(n,{...t,updatedAt:Ot()}),console.log(" Quiz avanc mis  jour :",e)}catch(n){throw console.error(" Erreur mise  jour quiz :",n),new Error("Impossible de mettre  jour le quiz")}}async function mR(e){try{await rn(Ne(K,nu,e)),console.log(" Quiz avanc supprim :",e)}catch(t){throw console.error(" Erreur suppression quiz :",t),new Error("Impossible de supprimer le quiz")}}async function OA(e){try{const t=await Dt(Ne(K,nu,e));if(!t.exists())return null;const n=t.data();return{id:t.id,...n,createdAt:n.createdAt?.toDate()||new Date,updatedAt:n.updatedAt?.toDate()||void 0}}catch(t){throw console.error(" Erreur rcupration quiz :",t),new Error("Impossible de rcuprer le quiz")}}async function DA(){try{const e=Ee(je(K,nu),Ve("createdAt","desc"));return(await Ce(e)).docs.map(n=>{const a=n.data();return{id:n.id,...a,createdAt:a.createdAt?.toDate()||new Date,updatedAt:a.updatedAt?.toDate()||void 0}})}catch(e){throw console.error(" Erreur rcupration tous les quiz :",e),new Error("Impossible de rcuprer les quiz")}}function fR(e,t){let n=0,a=0;const l=[];for(const o of e.questions){a+=o.points;const u=t.find(v=>v.questionId===o.id);if(!u){l.push({questionId:o.id,type:o.type,pointsObtenus:0,pointsMax:o.points,isCorrect:!1});continue}let d=0,f=!1,p=!1,h=!1;switch(o.type){case"qcm_unique":{const b=o.typeData.options.find(x=>x.isCorrect);b&&u.selectedOptionId===b.id&&(d=o.points,f=!0);break}case"qcm_multiple":{const v=o.typeData,b=v.options.filter(C=>C.isCorrect).map(C=>C.id),x=v.options.filter(C=>!C.isCorrect).map(C=>C.id),j=u.selectedOptionIds||[],N=j.some(C=>x.includes(C)),w=j.filter(C=>b.includes(C)).length;!N&&w===b.length?(d=o.points,f=!0):v.scoringPartiel&&w>0&&!N&&(d=Math.round(o.points*w/b.length*100)/100,p=!0);break}case"drag_drop":{const v=o.typeData,b=u.ordrePropose||[],x=v.items.sort((N,w)=>N.ordreCorrect-w.ordreCorrect).map(N=>N.id);let j=0;for(let N=0;N<x.length;N++)b[N]===x[N]&&j++;j===x.length?(d=o.points,f=!0):j>0&&(d=Math.round(o.points*j/x.length*100)/100,p=!0);break}case"mise_en_relation":{const v=o.typeData,b=u.relationsProposees||{};let x=0;for(const j of v.paires)b[j.id]===j.id&&x++;x===v.paires.length?(d=o.points,f=!0):x>0&&(d=Math.round(o.points*x/v.paires.length*100)/100,p=!0);break}case"essai":{const v=o.typeData,b=u.texteReponse||"";if(v.correctionMode==="mots_cles"&&v.motsCles.length>0){const x=b.toLowerCase().replace(/<[^>]*>/g,"");let j=0,N=0;for(const w of v.motsCles)j+=w.poids,x.includes(w.mot.toLowerCase())&&(N+=w.poids);j>0&&(d=Math.round(o.points*N/j*100)/100,f=N===j,p=N>0&&N<j)}else h=!0;break}}n+=d,l.push({questionId:o.id,type:o.type,pointsObtenus:d,pointsMax:o.points,isCorrect:f,isPartiel:p,correctionManuelleRequise:h})}return{score:n,scoreMax:a,details:l}}async function pR(e,t,n,a){try{const{score:l,scoreMax:o,details:u}=fR(e,n),d=o>0?Math.round(l/o*20*100)/100:0,f=u.some(v=>v.correctionManuelleRequise),p={quizId:e.id,userId:t,reponses:n,score:l,scoreMax:o,note20:d,tempsEcoule:a,datePassage:new Date,reussi:d>=e.noteMinimale,correctionManuelle:f,detailsParQuestion:u},h=await qt(je(K,cR),{...p,datePassage:Ot()});return console.log(" Rsultat quiz enregistr :",h.id),{id:h.id,...p}}catch(l){throw console.error(" Erreur soumission quiz :",l),new Error("Impossible d'enregistrer le rsultat")}}const hR=({existingQuiz:e,disciplines:t,auteurId:n,onSave:a,onCancel:l})=>{const[o,u]=g.useState(e?.titre||""),[d,f]=g.useState(e?.description||""),[p,h]=g.useState(e?.disciplineId||""),[v,b]=g.useState(e?.duree||30),[x,j]=g.useState(e?.isPremium??!0),[N,w]=g.useState(e?.noteMinimale||10),[C,E]=g.useState(e?.melangerQuestions??!1),[S,A]=g.useState(e?.melangerOptions??!1),[O,k]=g.useState(e?.afficherCorrection??!0),[M,D]=g.useState(e?.tentativesMax||0),[$,U]=g.useState(e?.questions||[]),[L,B]=g.useState(null),[ee,se]=g.useState(!1),[P,q]=g.useState(null),[F,R]=g.useState(!1),W=g.useCallback(H=>{const he=oR(H,$.length+1);U(Pe=>[...Pe,he]),B($.length),R(!1)},[$.length]),I=g.useCallback(H=>{confirm("Supprimer cette question ?")&&(U(he=>he.filter((ue,X)=>X!==H).map((ue,X)=>({...ue,ordre:X+1}))),B(null))},[]),re=g.useCallback(H=>{U(he=>{const Pe=he[H],ue={...JSON.parse(JSON.stringify(Pe)),id:Zt("q"),ordre:he.length+1};return[...he,ue]})},[]),V=g.useCallback((H,he)=>{U(Pe=>{const ue=[...Pe],X=he==="up"?H-1:H+1;return X<0||X>=ue.length?Pe:([ue[H],ue[X]]=[ue[X],ue[H]],ue.map((Q,me)=>({...Q,ordre:me+1})))}),B(he==="up"?L!==null?L-1:null:L!==null?L+1:null)},[L]),oe=g.useCallback((H,he)=>{U(Pe=>Pe.map((ue,X)=>X===H?{...ue,...he}:ue))},[]),xe=async()=>{if(!o.trim()){q("Le titre est obligatoire");return}if(!p){q("Slectionnez une discipline");return}if($.length===0){q("Ajoutez au moins une question");return}for(let H=0;H<$.length;H++)if(!$[H].enonce.replace(/<[^>]*>/g,"").trim()){q(`La question ${H+1} n'a pas d'nonc`),B(H);return}q(null),se(!0);try{const H={disciplineId:p,titre:o.trim(),description:d.trim()||void 0,questions:$,duree:v,isPremium:x,noteMinimale:N,melangerQuestions:C,melangerOptions:S,afficherCorrection:O,tentativesMax:M};let he;e?.id?(await dR(e.id,H),he=e.id):he=await uR(H,n),a?.(he)}catch(H){q(H.message||"Erreur lors de la sauvegarde")}finally{se(!1)}},ve=$.reduce((H,he)=>H+he.points,0);return r.jsxs("div",{className:"quiz-editor",children:[r.jsxs("div",{className:"quiz-editor__header",children:[r.jsx("h2",{children:e?" Modifier le quiz":" Nouveau quiz avanc"}),r.jsxs("div",{className:"quiz-editor__header-actions",children:[r.jsxs("span",{className:"quiz-editor__score-badge",children:["Score total : ",ve," pts"]}),r.jsxs("span",{className:"quiz-editor__count-badge",children:[$.length," question",$.length>1?"s":""]})]})]}),P&&r.jsxs("div",{className:"quiz-editor__error",children:[" ",P,r.jsx("button",{onClick:()=>q(null),children:""})]}),r.jsxs("div",{className:"quiz-editor__section",children:[r.jsx("h3",{className:"quiz-editor__section-title",children:" Paramtres du quiz"}),r.jsxs("div",{className:"quiz-editor__grid",children:[r.jsxs("div",{className:"quiz-editor__field quiz-editor__field--full",children:[r.jsx("label",{children:"Titre du quiz *"}),r.jsx("input",{type:"text",value:o,onChange:H=>u(H.target.value),placeholder:"Ex: valuation Chapitre 3  Les fonctions",className:"quiz-editor__input"})]}),r.jsxs("div",{className:"quiz-editor__field",children:[r.jsx("label",{children:"Discipline *"}),r.jsxs("select",{value:p,onChange:H=>h(H.target.value),className:"quiz-editor__select",children:[r.jsx("option",{value:"",children:" Slectionner "}),t.map(H=>r.jsxs("option",{value:H.id,children:[H.nom," (",H.classe,")"]},H.id))]})]}),r.jsxs("div",{className:"quiz-editor__field",children:[r.jsx("label",{children:"Dure (minutes)"}),r.jsx("input",{type:"number",value:v,onChange:H=>b(Number(H.target.value)),min:1,max:180,className:"quiz-editor__input"})]}),r.jsxs("div",{className:"quiz-editor__field",children:[r.jsx("label",{children:"Note minimale (/20)"}),r.jsx("input",{type:"number",value:N,onChange:H=>w(Number(H.target.value)),min:0,max:20,className:"quiz-editor__input"})]}),r.jsxs("div",{className:"quiz-editor__field",children:[r.jsx("label",{children:"Tentatives max (0 = illimit)"}),r.jsx("input",{type:"number",value:M,onChange:H=>D(Number(H.target.value)),min:0,max:10,className:"quiz-editor__input"})]}),r.jsxs("div",{className:"quiz-editor__field quiz-editor__field--full",children:[r.jsx("label",{children:"Description (optionnel)"}),r.jsx(va,{value:d,onChange:f,placeholder:"Dcrivez le contenu et les objectifs de ce quiz...",minHeight:80,toolbar:["bold","italic","underline","color","bulletList"]})]})]}),r.jsxs("div",{className:"quiz-editor__options-row",children:[r.jsxs("label",{className:"quiz-editor__checkbox",children:[r.jsx("input",{type:"checkbox",checked:x,onChange:H=>j(H.target.checked)}),r.jsx("span",{children:" Premium"})]}),r.jsxs("label",{className:"quiz-editor__checkbox",children:[r.jsx("input",{type:"checkbox",checked:C,onChange:H=>E(H.target.checked)}),r.jsx("span",{children:" Mlanger les questions"})]}),r.jsxs("label",{className:"quiz-editor__checkbox",children:[r.jsx("input",{type:"checkbox",checked:S,onChange:H=>A(H.target.checked)}),r.jsx("span",{children:" Mlanger les options QCM"})]}),r.jsxs("label",{className:"quiz-editor__checkbox",children:[r.jsx("input",{type:"checkbox",checked:O,onChange:H=>k(H.target.checked)}),r.jsx("span",{children:" Afficher la correction"})]})]})]}),r.jsxs("div",{className:"quiz-editor__section",children:[r.jsx("h3",{className:"quiz-editor__section-title",children:" Questions"}),r.jsx("div",{className:"quiz-editor__questions-list",children:$.map((H,he)=>r.jsx(vR,{question:H,index:he,isActive:L===he,onToggle:()=>B(L===he?null:he),onUpdate:Pe=>oe(he,Pe),onDelete:()=>I(he),onDuplicate:()=>re(he),onMoveUp:()=>V(he,"up"),onMoveDown:()=>V(he,"down"),isFirst:he===0,isLast:he===$.length-1},H.id))}),r.jsxs("div",{className:"quiz-editor__add-wrapper",children:[r.jsx("button",{type:"button",className:"quiz-editor__add-btn",onClick:()=>R(!F),children:"+ Ajouter une question"}),F&&r.jsx("div",{className:"quiz-editor__add-menu",children:Object.keys(lo).map(H=>r.jsxs("button",{type:"button",className:"quiz-editor__add-menu-item",onClick:()=>W(H),children:[r.jsx("span",{className:"quiz-editor__type-badge",style:{backgroundColor:vm[H]},children:hm[H]}),r.jsx("span",{children:lo[H]})]},H))})]})]}),r.jsxs("div",{className:"quiz-editor__actions",children:[r.jsx("button",{type:"button",className:"quiz-editor__btn quiz-editor__btn--secondary",onClick:l,disabled:ee,children:"Annuler"}),r.jsx("button",{type:"button",className:"quiz-editor__btn quiz-editor__btn--primary",onClick:xe,disabled:ee||$.length===0,children:ee?" Sauvegarde...":e?" Mettre  jour":" Crer le quiz"})]})]})},vR=({question:e,index:t,isActive:n,onToggle:a,onUpdate:l,onDelete:o,onDuplicate:u,onMoveUp:d,onMoveDown:f,isFirst:p,isLast:h})=>{const v=vm[e.type],b=hm[e.type],x=lo[e.type],j=N=>{const w=N.replace(/<[^>]*>/g,"").trim();return w.length>80?w.substring(0,80)+"...":w||"(sans nonc)"};return r.jsxs("div",{className:`question-editor ${n?"question-editor--active":""}`,style:{borderLeftColor:v},children:[r.jsxs("div",{className:"question-editor__header",onClick:a,children:[r.jsxs("div",{className:"question-editor__header-left",children:[r.jsx("span",{className:"question-editor__number",children:t+1}),r.jsxs("span",{className:"question-editor__type-badge",style:{backgroundColor:v},children:[b," ",x]}),!n&&r.jsx("span",{className:"question-editor__preview",children:j(e.enonce)})]}),r.jsxs("div",{className:"question-editor__header-right",children:[r.jsxs("span",{className:"question-editor__points",children:[e.points," pts"]}),r.jsx("span",{className:"question-editor__toggle",children:n?"":""})]})]}),n&&r.jsxs("div",{className:"question-editor__body",children:[r.jsxs("div",{className:"question-editor__toolbar",children:[r.jsx("button",{type:"button",onClick:d,disabled:p,title:"Monter",children:""}),r.jsx("button",{type:"button",onClick:f,disabled:h,title:"Descendre",children:""}),r.jsx("button",{type:"button",onClick:u,title:"Dupliquer",children:""}),r.jsx("button",{type:"button",onClick:o,className:"btn-danger",title:"Supprimer",children:""})]}),r.jsxs("div",{className:"question-editor__field",children:[r.jsx("label",{children:"nonc de la question *"}),r.jsx(va,{value:e.enonce,onChange:N=>l({enonce:N}),placeholder:"Saisissez l'nonc de la question...",minHeight:100})]}),r.jsxs("div",{className:"question-editor__params",children:[r.jsxs("div",{className:"question-editor__param",children:[r.jsx("label",{children:"Difficult"}),r.jsxs("select",{value:e.difficulte,onChange:N=>l({difficulte:N.target.value}),children:[r.jsx("option",{value:"facile",children:" Facile"}),r.jsx("option",{value:"moyen",children:" Moyen"}),r.jsx("option",{value:"difficile",children:" Difficile"})]})]}),r.jsxs("div",{className:"question-editor__param",children:[r.jsx("label",{children:"Points"}),r.jsx("input",{type:"number",value:e.points,onChange:N=>l({points:Number(N.target.value)}),min:1,max:20})]})]}),r.jsxs("div",{className:"question-editor__type-specific",children:[e.type==="qcm_unique"&&r.jsx(gR,{data:e.typeData,onChange:N=>l({typeData:N})}),e.type==="qcm_multiple"&&r.jsx(xR,{data:e.typeData,onChange:N=>l({typeData:N})}),e.type==="drag_drop"&&r.jsx(bR,{data:e.typeData,onChange:N=>l({typeData:N})}),e.type==="mise_en_relation"&&r.jsx(yR,{data:e.typeData,onChange:N=>l({typeData:N})}),e.type==="essai"&&r.jsx(jR,{data:e.typeData,onChange:N=>l({typeData:N})})]}),r.jsxs("div",{className:"question-editor__field",children:[r.jsx("label",{children:"Explication (affiche aprs correction, optionnel)"}),r.jsx(va,{value:e.explication||"",onChange:N=>l({explication:N}),placeholder:"Expliquez la bonne rponse...",minHeight:60,toolbar:["bold","italic","color","link"]})]})]})]})},gR=({data:e,onChange:t})=>{const n=(o,u)=>{const d=e.options.map((f,p)=>p===o?{...f,...u}:u.isCorrect===!0?{...f,isCorrect:!1}:f);t({options:d})},a=()=>{e.options.length>=6||t({options:[...e.options,{id:Zt("opt"),texte:"",isCorrect:!1}]})},l=o=>{e.options.length<=2||t({options:e.options.filter((u,d)=>d!==o)})};return r.jsxs("div",{className:"type-editor",children:[r.jsx("label",{className:"type-editor__label",children:" Options (slectionnez la bonne rponse)"}),e.options.map((o,u)=>r.jsxs("div",{className:"type-editor__option-row",children:[r.jsx("input",{type:"radio",name:`qcm_unique_${o.id}`,checked:o.isCorrect,onChange:()=>n(u,{isCorrect:!0}),className:"type-editor__radio",title:"Bonne rponse"}),r.jsx("div",{className:"type-editor__option-text",children:r.jsx(va,{value:o.texte,onChange:d=>n(u,{texte:d}),placeholder:`Option ${u+1}...`,minHeight:40,toolbar:["bold","italic","color","subscript","superscript"]})}),o.isCorrect&&r.jsx("span",{className:"type-editor__correct-badge",children:""}),r.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.options.length<=2,title:"Supprimer cette option",children:""})]},o.id)),e.options.length<6&&r.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter une option"})]})},xR=({data:e,onChange:t})=>{const n=(o,u)=>{const d=e.options.map((f,p)=>p===o?{...f,...u}:f);t({...e,options:d})},a=()=>{e.options.length>=8||t({...e,options:[...e.options,{id:Zt("opt"),texte:"",isCorrect:!1}]})},l=o=>{e.options.length<=2||t({...e,options:e.options.filter((u,d)=>d!==o)})};return r.jsxs("div",{className:"type-editor",children:[r.jsx("label",{className:"type-editor__label",children:" Options (cochez toutes les bonnes rponses)"}),e.options.map((o,u)=>r.jsxs("div",{className:"type-editor__option-row",children:[r.jsx("input",{type:"checkbox",checked:o.isCorrect,onChange:d=>n(u,{isCorrect:d.target.checked}),className:"type-editor__checkbox",title:"Bonne rponse"}),r.jsx("div",{className:"type-editor__option-text",children:r.jsx(va,{value:o.texte,onChange:d=>n(u,{texte:d}),placeholder:`Option ${u+1}...`,minHeight:40,toolbar:["bold","italic","color","subscript","superscript"]})}),o.isCorrect&&r.jsx("span",{className:"type-editor__correct-badge",children:""}),r.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.options.length<=2,children:""})]},o.id)),e.options.length<8&&r.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter une option"}),r.jsxs("label",{className:"type-editor__sub-option",children:[r.jsx("input",{type:"checkbox",checked:e.scoringPartiel,onChange:o=>t({...e,scoringPartiel:o.target.checked})}),r.jsx("span",{children:"Accorder des points partiels (proportionnel aux bonnes rponses trouves)"})]})]})},bR=({data:e,onChange:t})=>{const n=(o,u)=>{const d=e.items.map((f,p)=>p===o?{...f,...u}:f);t({...e,items:d})},a=()=>{e.items.length>=10||t({...e,items:[...e.items,{id:Zt("item"),texte:"",ordreCorrect:e.items.length+1}]})},l=o=>{if(e.items.length<=2)return;const u=e.items.filter((d,f)=>f!==o).map((d,f)=>({...d,ordreCorrect:f+1}));t({...e,items:u})};return r.jsxs("div",{className:"type-editor",children:[r.jsx("label",{className:"type-editor__label",children:" lments  rordonner (dans l'ordre correct)"}),r.jsx("p",{className:"type-editor__hint",children:"Saisissez les lments dans l'ordre correct. Ils seront mlangs automatiquement pour l'lve."}),r.jsxs("div",{className:"type-editor__field-inline",children:[r.jsx("label",{children:"Consigne :"}),r.jsx("input",{type:"text",value:e.consigneOrdre,onChange:o=>t({...e,consigneOrdre:o.target.value}),placeholder:"Ex: Classez du plus ancien au plus rcent",className:"type-editor__input"})]}),e.items.map((o,u)=>r.jsxs("div",{className:"type-editor__drag-row",children:[r.jsx("span",{className:"type-editor__drag-number",children:u+1}),r.jsx("div",{className:"type-editor__option-text",children:r.jsx(va,{value:o.texte,onChange:d=>n(u,{texte:d}),placeholder:`lment ${u+1}...`,minHeight:40,toolbar:["bold","italic","color"]})}),r.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.items.length<=2,children:""})]},o.id)),e.items.length<10&&r.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter un lment"})]})},yR=({data:e,onChange:t})=>{const n=(o,u)=>{const d=e.paires.map((f,p)=>p===o?{...f,...u}:f);t({paires:d})},a=()=>{e.paires.length>=8||t({paires:[...e.paires,{id:Zt("pair"),gauche:"",droite:""}]})},l=o=>{e.paires.length<=2||t({paires:e.paires.filter((u,d)=>d!==o)})};return r.jsxs("div",{className:"type-editor",children:[r.jsx("label",{className:"type-editor__label",children:" Paires  relier (gauche  droite)"}),r.jsx("p",{className:"type-editor__hint",children:"Saisissez les correspondances correctes. La colonne droite sera mlange pour l'lve."}),r.jsxs("div",{className:"type-editor__relation-header",children:[r.jsx("span",{children:"Colonne A (gauche)"}),r.jsx("span",{}),r.jsx("span",{children:"Colonne B (droite)"}),r.jsx("span",{})]}),e.paires.map((o,u)=>r.jsxs("div",{className:"type-editor__relation-row",children:[r.jsx("div",{className:"type-editor__relation-cell",children:r.jsx(va,{value:o.gauche,onChange:d=>n(u,{gauche:d}),placeholder:`lment A${u+1}...`,minHeight:40,toolbar:["bold","italic","color"]})}),r.jsx("span",{className:"type-editor__relation-arrow",children:""}),r.jsx("div",{className:"type-editor__relation-cell",children:r.jsx(va,{value:o.droite,onChange:d=>n(u,{droite:d}),placeholder:`lment B${u+1}...`,minHeight:40,toolbar:["bold","italic","color"]})}),r.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.paires.length<=2,children:""})]},o.id)),e.paires.length<8&&r.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter une paire"})]})},jR=({data:e,onChange:t})=>{const n=()=>{t({...e,motsCles:[...e.motsCles,{mot:"",poids:1,obligatoire:!1}]})},a=(o,u)=>{const d=e.motsCles.map((f,p)=>p===o?{...f,...u}:f);t({...e,motsCles:d})},l=o=>{t({...e,motsCles:e.motsCles.filter((u,d)=>d!==o)})};return r.jsxs("div",{className:"type-editor",children:[r.jsx("label",{className:"type-editor__label",children:" Paramtres de l'essai"}),r.jsxs("div",{className:"type-editor__params-row",children:[r.jsxs("div",{className:"type-editor__param-inline",children:[r.jsx("label",{children:"Mots minimum :"}),r.jsx("input",{type:"number",value:e.nombreMotsMin||"",onChange:o=>t({...e,nombreMotsMin:Number(o.target.value)||void 0}),min:0,placeholder:"Ex: 50"})]}),r.jsxs("div",{className:"type-editor__param-inline",children:[r.jsx("label",{children:"Mots maximum :"}),r.jsx("input",{type:"number",value:e.nombreMotsMax||"",onChange:o=>t({...e,nombreMotsMax:Number(o.target.value)||void 0}),min:0,placeholder:"Ex: 500"})]})]}),r.jsxs("div",{className:"type-editor__field-inline",children:[r.jsx("label",{children:"Mode de correction :"}),r.jsxs("select",{value:e.correctionMode,onChange:o=>t({...e,correctionMode:o.target.value}),children:[r.jsx("option",{value:"manuelle",children:" Manuelle (par le prof)"}),r.jsx("option",{value:"mots_cles",children:" Par mots-cls (automatique)"}),r.jsx("option",{value:"semi_auto",children:" Semi-automatique (mots-cls + validation prof)"})]})]}),(e.correctionMode==="mots_cles"||e.correctionMode==="semi_auto")&&r.jsxs("div",{className:"type-editor__keywords",children:[r.jsx("label",{className:"type-editor__sub-label",children:"Mots-cls attendus"}),e.motsCles.map((o,u)=>r.jsxs("div",{className:"type-editor__keyword-row",children:[r.jsx("input",{type:"text",value:o.mot,onChange:d=>a(u,{mot:d.target.value}),placeholder:"Mot ou expression...",className:"type-editor__keyword-input"}),r.jsxs("select",{value:o.poids,onChange:d=>a(u,{poids:Number(d.target.value)}),className:"type-editor__keyword-weight",children:[r.jsx("option",{value:1,children:"Poids 1"}),r.jsx("option",{value:2,children:"Poids 2"}),r.jsx("option",{value:3,children:"Poids 3"}),r.jsx("option",{value:4,children:"Poids 4"}),r.jsx("option",{value:5,children:"Poids 5"})]}),r.jsxs("label",{className:"type-editor__keyword-required",children:[r.jsx("input",{type:"checkbox",checked:o.obligatoire,onChange:d=>a(u,{obligatoire:d.target.checked})}),r.jsx("span",{children:"Obligatoire"})]}),r.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),children:""})]},u)),r.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:n,children:"+ Ajouter un mot-cl"})]}),r.jsxs("div",{className:"type-editor__field-block",children:[r.jsx("label",{children:"Rponse modle (optionnel  pour le prof)"}),r.jsx(va,{value:e.reponseModele||"",onChange:o=>t({...e,reponseModele:o}),placeholder:"Saisissez une rponse modle...",minHeight:80})]})]})},$1=()=>{const{quizId:e}=Jn(),t=lt(),{currentUser:n}=Ze(),[a,l]=g.useState([]),[o,u]=g.useState(void 0),[d,f]=g.useState(!0),[p,h]=g.useState(null);return g.useEffect(()=>{(async()=>{try{f(!0);const b=await Ji.getAll();if(l(b.map(x=>({id:x.id,nom:x.nom,classe:x.classe||""}))),e){const x=await OA(e);x?u(x):h("Quiz introuvable")}}catch(b){console.error("Erreur chargement donnes:",b),h(b.message||"Erreur de chargement")}finally{f(!1)}})()},[e]),d?r.jsx("div",{style:{textAlign:"center",padding:"3rem"},children:r.jsx("p",{children:" Chargement..."})}):p?r.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[r.jsxs("p",{style:{color:"#dc2626"},children:[" ",p]}),r.jsx("button",{onClick:()=>t(-1),children:" Retour"})]}):r.jsx(hR,{existingQuiz:o?{...o,id:o.id}:void 0,disciplines:a,auteurId:n?.uid||"",onSave:v=>{alert(" Quiz sauvegard avec succs !"),t("/admin/quiz")},onCancel:()=>t(-1)})},NR=()=>{const e=lt(),{currentUser:t}=Ze(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState(null);g.useEffect(()=>{h()},[]);const h=async()=>{try{o(!0),d(null);const N=await DA();a(N)}catch(N){console.error("Erreur chargement quiz:",N),d("Impossible de charger les quiz")}finally{o(!1)}},v=async N=>{try{await mR(N),a(w=>w.filter(C=>C.id!==N)),p(null)}catch(w){console.error("Erreur suppression:",w),alert("Erreur lors de la suppression : "+w.message)}},b=N=>{const w={};return N.questions.forEach(C=>{w[C.type]=(w[C.type]||0)+1}),Object.entries(w).map(([C,E])=>`${E} ${lo[C]||C}`).join(", ")},x=N=>N?(N.toDate?N.toDate():new Date(N)).toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric"}):"",j=N=>N.questions.reduce((w,C)=>w+C.points,0);return r.jsxs("div",{style:{padding:"1.5rem"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",flexWrap:"wrap",gap:"1rem"},children:[r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:"1.5rem",fontWeight:700,color:"#1f2937",margin:0},children:" Quiz Avancs (Multi-types)"}),r.jsxs("p",{style:{color:"#6b7280",margin:"0.25rem 0 0",fontSize:"0.9rem"},children:[n.length," quiz cr",n.length!==1?"s":""]})]}),r.jsx("button",{onClick:()=>e("/admin/quiz/nouveau"),style:{padding:"0.7rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:" Nouveau quiz avanc"})]}),u&&r.jsxs("div",{style:{padding:"1rem",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",color:"#991b1b",marginBottom:"1rem"},children:[" ",u,r.jsx("button",{onClick:h,style:{marginLeft:"1rem",padding:"0.3rem 0.8rem",background:"#fff",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer"},children:" Ressayer"})]}),l&&r.jsx("div",{style:{textAlign:"center",padding:"3rem",color:"#6b7280"},children:" Chargement des quiz..."}),!l&&n.length===0&&!u&&r.jsxs("div",{style:{textAlign:"center",padding:"3rem",background:"#f9fafb",borderRadius:"12px",border:"1px solid #e5e7eb"},children:[r.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),r.jsx("h3",{style:{color:"#374151",marginBottom:"0.5rem"},children:"Aucun quiz avanc"}),r.jsx("p",{style:{color:"#6b7280",marginBottom:"1.5rem"},children:"Crez votre premier quiz multi-types avec l'diteur riche !"}),r.jsx("button",{onClick:()=>e("/admin/quiz/nouveau"),style:{padding:"0.7rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:" Crer un quiz"})]}),!l&&n.length>0&&r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:n.map(N=>r.jsx("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e5e7eb",padding:"1.25rem",boxShadow:"0 1px 3px rgba(0,0,0,0.04)",transition:"box-shadow 0.2s"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"1rem"},children:[r.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[r.jsx("h3",{style:{fontSize:"1.05rem",fontWeight:700,color:"#1f2937",margin:0},children:N.titre}),N.isPremium&&r.jsx("span",{style:{padding:"0.15rem 0.5rem",background:"#fef3c7",color:"#92400e",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,border:"1px solid #fde68a"},children:" Premium"})]}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.4rem",marginBottom:"0.5rem"},children:[r.jsxs("span",{style:{padding:"0.2rem 0.6rem",background:"#eff6ff",color:"#1d4ed8",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500},children:[" ",N.questions.length," question",N.questions.length!==1?"s":""]}),r.jsxs("span",{style:{padding:"0.2rem 0.6rem",background:"#f0fdf4",color:"#166534",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500},children:[" ",j(N)," pts"]}),r.jsxs("span",{style:{padding:"0.2rem 0.6rem",background:"#fdf4ff",color:"#86198f",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500},children:[" ",N.duree," min"]})]}),r.jsxs("p",{style:{fontSize:"0.8rem",color:"#6b7280",margin:0},children:["Types : ",b(N)]}),r.jsxs("p",{style:{fontSize:"0.75rem",color:"#9ca3af",margin:"0.25rem 0 0"},children:["Cr le ",x(N.createdAt)]})]}),r.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,flexWrap:"wrap"},children:[r.jsx("button",{onClick:()=>e(`/quiz-avance/${N.id}`),title:"Tester le quiz",style:{padding:"0.5rem 0.9rem",background:"#f0fdf4",color:"#166534",border:"1px solid #bbf7d0",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Tester"}),r.jsx("button",{onClick:()=>e(`/admin/quiz/modifier/${N.id}`),title:"Modifier le quiz",style:{padding:"0.5rem 0.9rem",background:"#eff6ff",color:"#1d4ed8",border:"1px solid #bfdbfe",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Modifier"}),r.jsx("button",{onClick:()=>{const w=`${window.location.origin}/quiz-avance/${N.id}`;navigator.clipboard.writeText(w).then(()=>{alert(` Lien copi !

`+w+`

Partagez ce lien aux lves.`)})},title:"Copier le lien pour les lves",style:{padding:"0.5rem 0.9rem",background:"#fdf4ff",color:"#86198f",border:"1px solid #e9d5ff",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Lien"}),f===N.id?r.jsxs("div",{style:{display:"flex",gap:"0.3rem"},children:[r.jsx("button",{onClick:()=>v(N.id),style:{padding:"0.5rem 0.7rem",background:"#dc2626",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Confirmer"}),r.jsx("button",{onClick:()=>p(null),style:{padding:"0.5rem 0.7rem",background:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontSize:"0.8rem"},children:""})]}):r.jsx("button",{onClick:()=>p(N.id),title:"Supprimer le quiz",style:{padding:"0.5rem 0.9rem",background:"#fef2f2",color:"#991b1b",border:"1px solid #fecaca",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:""})]})]})},N.id))})]})},_R=({quiz:e,userId:t,onComplete:n,onQuit:a})=>{const l=g.useMemo(()=>{let D=[...e.questions];return e.melangerQuestions&&(D=D.sort(()=>Math.random()-.5)),D},[e]),[o,u]=g.useState(0),[d,f]=g.useState(new Map),[p,h]=g.useState(e.duree*60),[v,b]=g.useState(!1),[x,j]=g.useState(null),[N,w]=g.useState(!1),C=g.useRef(Date.now());g.useEffect(()=>{if(x)return;const D=setInterval(()=>{h($=>$<=1?(clearInterval(D),k(),0):$-1)},1e3);return()=>clearInterval(D)},[x]);const E=D=>{const $=Math.floor(D/60),U=D%60;return`${$.toString().padStart(2,"0")}:${U.toString().padStart(2,"0")}`},S=l[o],A=g.useCallback((D,$)=>{f(U=>{const L=new Map(U),B=L.get(D)||{questionId:D,type:S.type};return L.set(D,{...B,...$}),L})},[S]),O=D=>{D>=0&&D<l.length&&u(D)},k=async()=>{w(!1),b(!0);try{const D=Array.from(d.values()),$=Math.round((Date.now()-C.current)/1e3),U=await pR(e,t,D,$);j(U),n?.(U)}catch(D){alert("Erreur lors de la soumission : "+D.message)}finally{b(!1)}},M=d.size;return x?r.jsx("div",{className:"quiz-player quiz-player--results",children:r.jsxs("div",{className:"quiz-results",children:[r.jsxs("div",{className:`quiz-results__header ${x.reussi?"quiz-results__header--success":"quiz-results__header--fail"}`,children:[r.jsx("div",{className:"quiz-results__emoji",children:x.reussi?"":""}),r.jsx("h2",{children:x.reussi?"Flicitations !":"Quiz termin"}),r.jsxs("div",{className:"quiz-results__score",children:[r.jsxs("span",{className:"quiz-results__note",children:[x.note20,"/20"]}),r.jsxs("span",{className:"quiz-results__detail",children:[x.score,"/",x.scoreMax," points"]})]}),r.jsxs("div",{className:"quiz-results__time",children:[" Temps : ",E(x.tempsEcoule)]}),x.correctionManuelle&&r.jsx("p",{className:"quiz-results__pending",children:" Ce quiz contient des questions  correction manuelle. Votre note finale pourra tre ajuste par le professeur."})]}),e.afficherCorrection&&r.jsxs("div",{className:"quiz-results__details",children:[r.jsx("h3",{children:" Dtail des rponses"}),l.map((D,$)=>{const U=x.detailsParQuestion.find(L=>L.questionId===D.id);return r.jsxs("div",{className:`quiz-results__question ${U?.isCorrect?"quiz-results__question--correct":U?.isPartiel?"quiz-results__question--partial":"quiz-results__question--wrong"}`,children:[r.jsxs("div",{className:"quiz-results__q-header",children:[r.jsxs("span",{children:["Q",$+1," "," ",r.jsxs("span",{style:{color:vm[D.type]},children:[hm[D.type]," ",lo[D.type]]})]}),r.jsxs("span",{className:"quiz-results__q-score",children:[U?.pointsObtenus||0,"/",U?.pointsMax||D.points," pts",U?.isCorrect&&" ",U?.isPartiel&&" ",!U?.isCorrect&&!U?.isPartiel&&" "]})]}),r.jsx("div",{className:"quiz-results__q-enonce",dangerouslySetInnerHTML:{__html:D.enonce}}),D.explication&&r.jsxs("div",{className:"quiz-results__q-explanation",children:[r.jsx("strong",{children:" Explication :"}),r.jsx("div",{dangerouslySetInnerHTML:{__html:D.explication}})]})]},D.id)})]}),r.jsx("div",{className:"quiz-results__actions",children:r.jsx("button",{className:"quiz-player__btn quiz-player__btn--primary",onClick:a,children:"Retour au tableau de bord"})})]})}):r.jsxs("div",{className:"quiz-player",children:[r.jsxs("div",{className:"quiz-player__topbar",children:[r.jsxs("div",{className:"quiz-player__info",children:[r.jsx("span",{className:"quiz-player__title",children:e.titre}),r.jsxs("span",{className:"quiz-player__progress",children:["Question ",o+1,"/",l.length]})]}),r.jsxs("div",{className:"quiz-player__topbar-right",children:[r.jsxs("span",{className:`quiz-player__timer ${p<60?"quiz-player__timer--danger":p<300?"quiz-player__timer--warning":""}`,children:[" ",E(p)]}),r.jsxs("span",{className:"quiz-player__answered",children:[M,"/",l.length," rpondue",M>1?"s":""]})]})]}),r.jsx("div",{className:"quiz-player__progress-bar",children:r.jsx("div",{className:"quiz-player__progress-fill",style:{width:`${(o+1)/l.length*100}%`}})}),r.jsxs("div",{className:"quiz-player__question-area",children:[r.jsxs("div",{className:"quiz-player__question-meta",children:[r.jsxs("span",{className:"quiz-player__type-badge",style:{backgroundColor:vm[S.type]},children:[hm[S.type]," ",lo[S.type]]}),r.jsxs("span",{className:"quiz-player__points",children:[S.points," point",S.points>1?"s":""]})]}),r.jsx("div",{className:"quiz-player__enonce",dangerouslySetInnerHTML:{__html:S.enonce}}),r.jsxs("div",{className:"quiz-player__answer-area",children:[S.type==="qcm_unique"&&r.jsx(SR,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D),melangerOptions:e.melangerOptions}),S.type==="qcm_multiple"&&r.jsx(wR,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D),melangerOptions:e.melangerOptions}),S.type==="drag_drop"&&r.jsx(CR,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D)}),S.type==="mise_en_relation"&&r.jsx(ER,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D)}),S.type==="essai"&&r.jsx(AR,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D)})]})]}),r.jsxs("div",{className:"quiz-player__nav",children:[r.jsx("button",{className:"quiz-player__btn quiz-player__btn--secondary",onClick:()=>O(o-1),disabled:o===0,children:" Prcdent"}),r.jsx("div",{className:"quiz-player__pagination",children:l.map((D,$)=>r.jsx("button",{className:`quiz-player__page-dot ${$===o?"quiz-player__page-dot--current":""} ${d.has(D.id)?"quiz-player__page-dot--answered":""}`,onClick:()=>O($),title:`Question ${$+1}`,children:$+1},D.id))}),o<l.length-1?r.jsx("button",{className:"quiz-player__btn quiz-player__btn--primary",onClick:()=>O(o+1),children:"Suivant "}):r.jsx("button",{className:"quiz-player__btn quiz-player__btn--submit",onClick:()=>w(!0),disabled:v,children:v?" Envoi...":" Soumettre le quiz"})]}),N&&r.jsx("div",{className:"quiz-player__modal-overlay",children:r.jsxs("div",{className:"quiz-player__modal",children:[r.jsx("h3",{children:"Soumettre le quiz ?"}),r.jsxs("p",{children:["Vous avez rpondu  ",r.jsx("strong",{children:M})," question",M>1?"s":""," sur"," ",r.jsx("strong",{children:l.length}),"."]}),M<l.length&&r.jsxs("p",{className:"quiz-player__modal-warning",children:[" ",l.length-M," question",l.length-M>1?"s":""," sans rponse !"]}),r.jsxs("div",{className:"quiz-player__modal-actions",children:[r.jsx("button",{className:"quiz-player__btn quiz-player__btn--secondary",onClick:()=>w(!1),children:"Continuer le quiz"}),r.jsx("button",{className:"quiz-player__btn quiz-player__btn--submit",onClick:k,children:"Confirmer la soumission"})]})]})})]})},SR=({question:e,reponse:t,onUpdate:n,melangerOptions:a})=>{const l=e.typeData,o=g.useMemo(()=>a?[...l.options].sort(()=>Math.random()-.5):l.options,[l.options,a]);return r.jsx("div",{className:"player-qcm",children:o.map(u=>r.jsxs("label",{className:`player-qcm__option ${t?.selectedOptionId===u.id?"player-qcm__option--selected":""}`,children:[r.jsx("input",{type:"radio",name:`q_${e.id}`,checked:t?.selectedOptionId===u.id,onChange:()=>n({selectedOptionId:u.id})}),r.jsx("div",{className:"player-qcm__text",dangerouslySetInnerHTML:{__html:u.texte}})]},u.id))})},wR=({question:e,reponse:t,onUpdate:n,melangerOptions:a})=>{const l=e.typeData,o=g.useMemo(()=>a?[...l.options].sort(()=>Math.random()-.5):l.options,[l.options,a]),u=t?.selectedOptionIds||[],d=f=>{const p=u.includes(f)?u.filter(h=>h!==f):[...u,f];n({selectedOptionIds:p})};return r.jsxs("div",{className:"player-qcm",children:[r.jsx("p",{className:"player-qcm__hint",children:"Plusieurs rponses possibles"}),o.map(f=>r.jsxs("label",{className:`player-qcm__option ${u.includes(f.id)?"player-qcm__option--selected":""}`,children:[r.jsx("input",{type:"checkbox",checked:u.includes(f.id),onChange:()=>d(f.id)}),r.jsx("div",{className:"player-qcm__text",dangerouslySetInnerHTML:{__html:f.texte}})]},f.id))]})},CR=({question:e,reponse:t,onUpdate:n})=>{const a=e.typeData,[l,o]=g.useState(()=>t?.ordrePropose?t.ordrePropose.map(b=>a.items.find(x=>x.id===b)).filter(Boolean):[...a.items].sort(()=>Math.random()-.5)),[u,d]=g.useState(null);g.useEffect(()=>{n({ordrePropose:l.map(b=>b.id)})},[l]);const f=b=>{d(b)},p=(b,x)=>{if(b.preventDefault(),u===null||u===x)return;const j=[...l],[N]=j.splice(u,1);j.splice(x,0,N),o(j),d(x)},h=()=>{d(null)},v=(b,x)=>{const j=x==="up"?b-1:b+1;if(j<0||j>=l.length)return;const N=[...l];[N[b],N[j]]=[N[j],N[b]],o(N)};return r.jsxs("div",{className:"player-dragdrop",children:[r.jsx("p",{className:"player-dragdrop__consigne",children:a.consigneOrdre}),r.jsx("div",{className:"player-dragdrop__list",children:l.map((b,x)=>r.jsxs("div",{className:`player-dragdrop__item ${u===x?"player-dragdrop__item--dragging":""}`,draggable:!0,onDragStart:()=>f(x),onDragOver:j=>p(j,x),onDragEnd:h,children:[r.jsx("span",{className:"player-dragdrop__handle",children:""}),r.jsx("span",{className:"player-dragdrop__number",children:x+1}),r.jsx("div",{className:"player-dragdrop__text",dangerouslySetInnerHTML:{__html:b.texte}}),r.jsxs("div",{className:"player-dragdrop__mobile-btns",children:[r.jsx("button",{type:"button",onClick:()=>v(x,"up"),disabled:x===0,children:""}),r.jsx("button",{type:"button",onClick:()=>v(x,"down"),disabled:x===l.length-1,children:""})]})]},b.id))})]})},ER=({question:e,reponse:t,onUpdate:n})=>{const a=e.typeData,l=g.useMemo(()=>[...a.paires].sort(()=>Math.random()-.5),[a.paires]),[o,u]=g.useState(t?.relationsProposees||{}),[d,f]=g.useState(null);g.useEffect(()=>{n({relationsProposees:o})},[o]);const p=x=>{f(x)},h=x=>{d&&(u(j=>({...j,[d]:x})),f(null))},v=x=>{u(j=>{const N={...j};return delete N[x],N})},b=new Set(Object.values(o));return r.jsxs("div",{className:"player-relation",children:[r.jsx("p",{className:"player-relation__hint",children:"Cliquez sur un lment  gauche puis sur son correspondant  droite"}),r.jsxs("div",{className:"player-relation__columns",children:[r.jsxs("div",{className:"player-relation__col",children:[r.jsx("h4",{className:"player-relation__col-title",children:"Colonne A"}),a.paires.map(x=>r.jsxs("div",{className:`player-relation__item player-relation__item--left ${d===x.id?"player-relation__item--selected":""} ${o[x.id]?"player-relation__item--matched":""}`,onClick:()=>{o[x.id]?v(x.id):p(x.id)},children:[r.jsx("div",{dangerouslySetInnerHTML:{__html:x.gauche}}),o[x.id]&&r.jsx("span",{className:"player-relation__linked",children:""})]},x.id))]}),r.jsxs("div",{className:"player-relation__col",children:[r.jsx("h4",{className:"player-relation__col-title",children:"Colonne B"}),l.map(x=>r.jsxs("div",{className:`player-relation__item player-relation__item--right ${b.has(x.id)?"player-relation__item--matched":""} ${d&&!b.has(x.id)?"player-relation__item--clickable":""}`,onClick:()=>{d&&!b.has(x.id)&&h(x.id)},children:[r.jsx("div",{dangerouslySetInnerHTML:{__html:x.droite}}),b.has(x.id)&&r.jsx("span",{className:"player-relation__linked",children:""})]},x.id))]})]})]})},AR=({question:e,reponse:t,onUpdate:n})=>{const a=e.typeData,[l,o]=g.useState(t?.texteReponse||""),u=l.replace(/<[^>]*>/g,"").trim().split(/\s+/).filter(Boolean).length;return g.useEffect(()=>{n({texteReponse:l})},[l]),r.jsxs("div",{className:"player-essai",children:[r.jsxs("div",{className:"player-essai__info",children:[a.nombreMotsMin&&r.jsxs("span",{className:u<a.nombreMotsMin?"player-essai__warning":"",children:["Minimum : ",a.nombreMotsMin," mots"]}),a.nombreMotsMax&&r.jsxs("span",{className:u>a.nombreMotsMax?"player-essai__warning":"",children:["Maximum : ",a.nombreMotsMax," mots"]}),r.jsxs("span",{className:"player-essai__count",children:[u," mot",u>1?"s":""]})]}),r.jsx("textarea",{className:"player-essai__textarea",value:l,onChange:d=>o(d.target.value),placeholder:"Rdigez votre rponse ici...",rows:10})]})},zR=()=>{const{quizId:e}=Jn(),t=lt(),{currentUser:n}=Ze(),[a,l]=g.useState(null),[o,u]=g.useState(!0),[d,f]=g.useState(null);return g.useEffect(()=>{(async()=>{if(!e){f("ID du quiz manquant"),u(!1);return}try{const h=await OA(e);if(!h){f("Quiz introuvable");return}if(h.isPremium&&!n?.isPremium){f("Ce quiz est rserv aux abonns Premium");return}l(h)}catch(h){console.error("Erreur chargement quiz:",h),f(h.message||"Impossible de charger le quiz")}finally{u(!1)}})()},[e,n]),o?r.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[r.jsx("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:""}),r.jsx("p",{children:"Chargement du quiz..."})]}):d?r.jsx("div",{style:{textAlign:"center",padding:"3rem",maxWidth:"500px",margin:"2rem auto"},children:r.jsxs("div",{style:{padding:"2rem",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px"},children:[r.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:""}),r.jsx("p",{style:{color:"#991b1b",fontWeight:600,marginBottom:"1rem"},children:d}),d.includes("Premium")&&r.jsx("button",{onClick:()=>t("/premium"),style:{padding:"0.6rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",marginRight:"0.5rem",fontWeight:600},children:" Devenir Premium"}),r.jsx("button",{onClick:()=>t(-1),style:{padding:"0.6rem 1.5rem",background:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:" Retour"})]})}):a?r.jsx(_R,{quiz:a,userId:n?.uid||"",onComplete:p=>{console.log(" Quiz termin  Note:",p.note20,"/20")},onQuit:()=>t("/dashboard")}):r.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[r.jsx("p",{children:"Quiz introuvable"}),r.jsx("button",{onClick:()=>t(-1),children:" Retour"})]})},kR=e=>{if(!e?.length)return{label:"",color:"#9ca3af"};const t=e.map(a=>a.difficulte),n=t.reduce((a,l)=>a+(l==="facile"?1:l==="moyen"?2:3),0)/t.length;return n<1.5?{label:"Facile",color:"#059669"}:n<2.5?{label:"Moyen",color:"#d97706"}:{label:"Difficile",color:"#dc2626"}},OR=e=>e?.reduce((t,n)=>t+(n.points??0),0)??0,DR=()=>{const e=lt(),{currentUser:t}=Ze(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(""),[f,p]=g.useState("");g.useEffect(()=>{(async()=>{try{const b=await DA();a(b)}catch{d("Impossible de charger les quiz.")}finally{o(!1)}})()},[]);const h=n.filter(v=>v.titre.toLowerCase().includes(f.toLowerCase())||(v.description??"").toLowerCase().includes(f.toLowerCase()));return r.jsxs("div",{style:{maxWidth:1100,margin:"0 auto",padding:"2rem 1rem"},children:[r.jsxs("div",{style:{marginBottom:"2rem"},children:[r.jsx("h1",{style:{fontSize:"1.8rem",fontWeight:800,color:"#1f2937",margin:"0 0 0.4rem"},children:" Quiz disponibles"}),r.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem",margin:0},children:"Testez vos connaissances avec nos quiz interactifs"})]}),r.jsx("div",{style:{marginBottom:"1.5rem"},children:r.jsx("input",{type:"text",placeholder:"Rechercher un quiz...",value:f,onChange:v=>p(v.target.value),style:{width:"100%",maxWidth:400,padding:"0.6rem 1rem",border:"1.5px solid #e5e7eb",borderRadius:10,fontSize:"0.9rem",outline:"none",boxSizing:"border-box"}})}),l&&r.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"#6b7280"},children:[r.jsx("div",{style:{width:36,height:36,border:"3px solid #e5e7eb",borderTopColor:"#2563eb",borderRadius:"50%",animation:"spin 0.8s linear infinite",margin:"0 auto 1rem"}}),"Chargement des quiz..."]}),u&&r.jsxs("div",{style:{background:"#fee2e2",color:"#dc2626",padding:"0.9rem 1.2rem",borderRadius:10,marginBottom:"1.5rem"},children:[" ",u]}),!l&&!u&&h.length===0&&r.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"#9ca3af"},children:[r.jsx("div",{style:{fontSize:"3rem",marginBottom:"0.75rem",opacity:.4},children:""}),r.jsx("p",{style:{margin:0},children:f?"Aucun quiz ne correspond  votre recherche.":"Aucun quiz disponible pour le moment."})]}),!l&&!u&&h.length>0&&r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1.25rem"},children:h.map(v=>{const b=kR(v.questions),x=OR(v.questions),j=v.questions?.length??0,N=v.isPremium,w=!N||t?.isPremium;return r.jsxs("div",{onClick:()=>w&&e(`/quiz-avance/${v.id}`),style:{background:"white",borderRadius:14,boxShadow:"0 2px 10px rgba(0,0,0,0.08)",padding:"1.25rem",cursor:w?"pointer":"default",opacity:w?1:.65,transition:"transform 0.15s, box-shadow 0.15s",border:"1.5px solid #f3f4f6",display:"flex",flexDirection:"column",gap:"0.6rem",position:"relative"},onMouseEnter:C=>{w&&(C.currentTarget.style.transform="translateY(-3px)",C.currentTarget.style.boxShadow="0 6px 20px rgba(0,0,0,0.12)")},onMouseLeave:C=>{C.currentTarget.style.transform="",C.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.08)"},children:[N&&r.jsx("span",{style:{position:"absolute",top:12,right:12,background:"#fef3c7",color:"#d97706",fontSize:"0.7rem",fontWeight:700,padding:"0.15rem 0.5rem",borderRadius:20},children:" Premium"}),r.jsx("h3",{style:{fontSize:"1.05rem",fontWeight:700,color:"#1f2937",margin:0,lineHeight:1.3,paddingRight:N?"4rem":0},children:v.titre}),v.description&&r.jsx("p",{style:{fontSize:"0.82rem",color:"#6b7280",margin:0,lineHeight:1.5,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},dangerouslySetInnerHTML:{__html:v.description}}),r.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginTop:"0.25rem"},children:[r.jsxs("span",{style:{fontSize:"0.75rem",background:"#eff6ff",color:"#2563eb",padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:600},children:[" ",j," question",j>1?"s":""]}),r.jsxs("span",{style:{fontSize:"0.75rem",background:"#f3f4f6",color:"#374151",padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:600},children:[" ",v.duree," min"]}),x>0&&r.jsxs("span",{style:{fontSize:"0.75rem",background:"#f0fdf4",color:"#059669",padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:600},children:[" ",x," pts"]}),r.jsx("span",{style:{fontSize:"0.75rem",background:"#fafafa",color:b.color,padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:700,border:`1px solid ${b.color}30`},children:b.label})]}),r.jsx("button",{disabled:!w,onClick:C=>{C.stopPropagation(),w&&e(`/quiz-avance/${v.id}`)},style:{marginTop:"auto",padding:"0.55rem 1rem",background:w?"#2563eb":"#e5e7eb",color:w?"white":"#9ca3af",border:"none",borderRadius:8,fontWeight:600,fontSize:"0.85rem",cursor:w?"pointer":"not-allowed",transition:"background 0.15s"},children:w?" Commencer le quiz":" Premium requis"})]},v.id)})}),!l&&h.length>0&&r.jsxs("p",{style:{textAlign:"center",color:"#9ca3af",fontSize:"0.8rem",marginTop:"2rem"},children:[h.length," quiz",(h.length>1,"")," disponible",h.length>1?"s":""]})]})},MR="quizzes",PR="quizzes_v2",B1=50;function TR(e){const t=e.data();return{id:e.id,titre:t.titre||"Quiz sans titre",description:t.description||"",matiere:t.matiere||t.disciplineId||"",niveau:t.niveau||"",classe:t.classe||"",nombreQuestions:Array.isArray(t.questions)?t.questions.length:0,duree:t.duree||void 0,difficulte:t.difficulte||"moyen",source:"quizzes",isPremium:!1,createdAt:t.createdAt||void 0}}function qR(e){const t=e.data();return{id:e.id,titre:t.titre||"Quiz sans titre",description:t.description||"",matiere:t.matiere||"",niveau:t.niveau||"",classe:t.classe||"",nombreQuestions:Array.isArray(t.questions)?t.questions.length:0,duree:t.dureeEstimee||void 0,difficulte:t.difficulte||"moyen",source:"quizzes_v2",isPremium:!1,createdAt:t.createdAt||void 0}}async function MA(){const[e,t]=await Promise.all([Ce(Ee(je(K,MR),Se("isPremium","==",!1),Ve("createdAt","desc"),ar(B1))),Ce(Ee(je(K,PR),Se("isPremium","==",!1),Ve("createdAt","desc"),ar(B1)))]),n=e.docs.map(TR),a=t.docs.map(qR);return[...n,...a].sort((l,o)=>{const u=l.createdAt?.toMillis()??0;return(o.createdAt?.toMillis()??0)-u})}async function RR(){return(await MA()).slice(0,3)}const IR={facile:{label:"Facile",color:"#059669",bg:"#d1fae5"},moyen:{label:"Moyen",color:"#d97706",bg:"#fef3c7"},difficile:{label:"Difficile",color:"#dc2626",bg:"#fee2e2"}},LR=({quiz:e,onJouer:t,estConnecte:n})=>{const a=IR[e.difficulte??"moyen"];return r.jsxs("div",{className:"qg-card",onClick:()=>t(e),children:[r.jsxs("div",{className:"qg-card__header",children:[r.jsx("span",{className:`qg-card__source qg-card__source--${e.source}`,children:e.source==="quizzes_v2"?" Quiz avanc":" Quiz"}),r.jsx("span",{className:"qg-card__difficulte",style:{color:a.color,background:a.bg},children:a.label})]}),r.jsx("h3",{className:"qg-card__titre",children:e.titre}),e.description&&r.jsx("p",{className:"qg-card__description",children:e.description}),r.jsxs("div",{className:"qg-card__meta",children:[e.matiere&&r.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.matiere]}),e.classe&&r.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.classe]}),r.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.nombreQuestions," question",e.nombreQuestions>1?"s":""]}),e.duree&&r.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.duree," min"]})]}),r.jsx("button",{className:"qg-card__btn",children:n?" Commencer":" Aperu"})]})},$R=()=>r.jsxs("div",{className:"qg-banniere qg-banniere--inscription",children:[r.jsx("div",{className:"qg-banniere__icone",children:""}),r.jsxs("div",{className:"qg-banniere__texte",children:[r.jsx("h3",{children:"Connectez-vous pour accder  tous les quiz gratuits"}),r.jsx("p",{children:"Crez un compte gratuitement et commencez  vous entraner ds maintenant."})]}),r.jsxs("div",{className:"qg-banniere__actions",children:[r.jsx(Fe,{to:"/inscription",className:"btn btn-primary",children:"Crer un compte gratuit"}),r.jsx(Fe,{to:"/connexion",className:"btn btn-secondary",children:"Se connecter"})]})]}),BR=()=>r.jsxs("div",{className:"qg-banniere qg-banniere--premium",children:[r.jsx("div",{className:"qg-banniere__icone",children:""}),r.jsxs("div",{className:"qg-banniere__texte",children:[r.jsx("h3",{children:"Dbloquez les Quiz Avancs Premium"}),r.jsx("p",{children:"Accdez  des centaines de quiz avancs avec corrections dtailles, suivi de progression et bien plus encore."}),r.jsxs("p",{className:"qg-banniere__prix",children:[r.jsx("strong",{children:"Ds 10 000 FCFA / 3 mois"}),"  Accs illimit"]})]}),r.jsx(Fe,{to:"/premium",className:"btn btn-premium",children:" Devenir Premium"})]}),UR=()=>{const e=lt(),{currentUser:t}=Ze(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(""),[f,p]=g.useState(""),[h,v]=g.useState(""),[b,x]=g.useState(""),{matieres:j}=Zs(),N=!!t,w=t?.isPremium??!1,C=t?.role==="prof"||t?.role==="admin";g.useEffect(()=>{(async()=>{o(!0),d("");try{const O=N?await MA():await RR();a(O)}catch(O){console.error("Erreur chargement quiz gratuits:",O),d("Impossible de charger les quiz. Veuillez ressayer.")}finally{o(!1)}})()},[N]);const E=n.filter(A=>{const O=!b||A.titre.toLowerCase().includes(b.toLowerCase())||A.matiere.toLowerCase().includes(b.toLowerCase()),k=!f||A.matiere.toLowerCase().includes(f.toLowerCase()),M=!h||(A.niveau??"").toLowerCase().includes(h.toLowerCase())||(A.classe??"").toLowerCase().includes(h.toLowerCase());return O&&k&&M}),S=A=>{if(!N){e("/connexion");return}A.source==="quizzes_v2"?e(`/quiz-avance/${A.id}`):e(`/quiz/${A.id}`)};return r.jsxs("div",{className:"qg-page",children:[r.jsxs("div",{className:"qg-hero",children:[r.jsxs("div",{className:"qg-hero__content",children:[r.jsx("h1",{className:"qg-hero__titre",children:" Quiz Gratuits"}),r.jsx("p",{className:"qg-hero__sous-titre",children:"Entranez-vous gratuitement avec nos quiz de rvision pour tous les niveaux du collge au lyce."}),r.jsxs("div",{className:"qg-hero__stats",children:[r.jsxs("span",{className:"qg-hero__stat",children:[r.jsx("strong",{children:n.length}),N?" quiz disponibles":"+ quiz"]}),r.jsxs("span",{className:"qg-hero__stat",children:[r.jsx("strong",{children:"100%"})," gratuit"]}),r.jsxs("span",{className:"qg-hero__stat",children:[r.jsx("strong",{children:"6me"}),"  ",r.jsx("strong",{children:"Terminale"})]})]})]}),(w||C)&&r.jsx(Fe,{to:"/quizzes",className:"qg-hero__lien-premium",children:" Voir les Quiz Premium "})]}),r.jsxs("div",{className:"qg-filtres",children:[r.jsx("div",{className:"qg-filtres__recherche",children:r.jsx("input",{type:"text",placeholder:" Rechercher un quiz...",value:b,onChange:A=>x(A.target.value),className:"qg-filtres__input"})}),r.jsxs("select",{value:f,onChange:A=>p(A.target.value),className:"qg-filtres__select",children:[r.jsx("option",{value:"",children:"Toutes les matires"}),j.map(A=>r.jsx("option",{value:A.valeur,children:A.label},A.valeur))]}),(f||h||b)&&r.jsx("button",{className:"qg-filtres__reset",onClick:()=>{p(""),v(""),x("")},children:" Rinitialiser"})]}),r.jsxs("div",{className:"qg-contenu",children:[l&&r.jsxs("div",{className:"qg-loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement des quiz..."})]}),!l&&u&&r.jsxs("div",{className:"qg-erreur",children:[r.jsxs("p",{children:[" ",u]}),r.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-secondary",children:"Ressayer"})]}),!l&&!u&&r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"qg-compteur",children:[E.length," quiz",E.length>1?"s":"",f?` en ${f}`:"",N?"":" (aperu  connectez-vous pour tout voir)"]}),E.length>0?r.jsx("div",{className:"qg-grille",children:E.map(A=>r.jsx(LR,{quiz:A,onJouer:S,estConnecte:N},`${A.source}-${A.id}`))}):r.jsxs("div",{className:"qg-vide",children:[r.jsx("p",{children:" Aucun quiz trouv pour ces critres."}),r.jsx("button",{onClick:()=>{p(""),x("")},className:"btn btn-secondary",children:"Voir tous les quiz"})]}),!N&&r.jsx($R,{}),N&&!w&&!C&&r.jsx(BR,{})]})]})]})},PA=je(K,"quiz_results"),Lb=je(K,"progressions"),FR=async e=>{try{const t=await qt(PA,{...e,datePassage:Oe.now()});return e.reussi&&await KR(e.userId,e.disciplineId,e.disciplineNom,e.quizId),t.id}catch(t){throw console.error("Erreur lors de la sauvegarde du rsultat :",t),t}},bf=async(e,t)=>{try{let n=Ee(PA,Se("userId","==",e),Ve("datePassage","desc"));return t&&(n=Ee(n,ar(t))),(await Ce(n)).docs.map(l=>({id:l.id,...l.data()}))}catch(n){throw console.error("Erreur rcupration historique :",n),n}},GR=async e=>{try{const t=await bf(e);if(t.length===0)return{totalQuizPasses:0,totalQuizReussis:0,moyenneGenerale:0,tempsTotal:0,meilleurScore:0,serieReussites:0,meilleureSerieReussites:0};const n=t.reduce((h,v)=>h+v.pourcentage,0),a=Math.round(n/t.length),l=Math.max(...t.map(h=>h.pourcentage)),o=t.reduce((h,v)=>h+(v.tempsEcoule||0),0),u=t.filter(h=>h.reussi).length;let d=0,f=0;for(const h of t)h.reussi?(d++,f=Math.max(f,d)):d=0;let p=0;for(const h of t)if(h.reussi)p++;else break;return{totalQuizPasses:t.length,totalQuizReussis:u,moyenneGenerale:a,tempsTotal:o,meilleurScore:l,serieReussites:p,meilleureSerieReussites:Math.max(f,p)}}catch(t){return console.error("Erreur calcul stats :",t),{totalQuizPasses:0,totalQuizReussis:0,moyenneGenerale:0,tempsTotal:0,meilleurScore:0,serieReussites:0,meilleureSerieReussites:0}}},HR=async e=>{try{const t=await bf(e);if(t.length===0)return[];const n={};for(const a of t){const l=a.disciplineId;n[l]||(n[l]=[]),n[l].push(a)}return Object.entries(n).map(([a,l])=>{const o=Math.round(l.reduce((v,b)=>v+b.pourcentage,0)/l.length),u=Math.max(...l.map(v=>v.pourcentage)),d=l[0].pourcentage,f=l.filter(v=>v.reussi).length,p=l.reduce((v,b)=>v+(b.tempsEcoule||0),0);let h="stable";if(l.length>=4){const v=l.slice(0,3),b=l.slice(3,6),x=v.reduce((N,w)=>N+w.pourcentage,0)/v.length,j=b.reduce((N,w)=>N+w.pourcentage,0)/b.length;x-j>5?h="up":j-x>5&&(h="down")}return{disciplineId:a,disciplineNom:l[0].disciplineNom||a,nombreQuiz:l.length,moyenne:o,meilleurScore:u,dernierScore:d,quizReussis:f,tempsTotal:p,tendance:h}})}catch(t){return console.error("Erreur progression par discipline :",t),[]}},QR=async(e,t)=>{try{return(await bf(e,t||20)).reverse().map(a=>({date:(a.datePassage?.toDate?a.datePassage.toDate():new Date(a.datePassage)).toLocaleDateString("fr-SN",{day:"2-digit",month:"2-digit"}),score:a.pourcentage,discipline:a.disciplineNom||a.disciplineId}))}catch(n){return console.error("Erreur donnes temporelles :",n),[]}},VR=async(e,t,n)=>{const a=`${e}_${t}`,l=Ne(Lb,a),o=await Dt(l);if(o.exists())return{...o.data()};const[u,d]=await Promise.all([U1("ressources",t),U1("quizzes",t)]),f={userId:e,disciplineId:t,disciplineNom:n,ressourcesVues:[],quizReussis:[],totalRessources:u,totalQuiz:d,pourcentage:0,dernierAcces:Oe.now(),createdAt:Oe.now(),updatedAt:Oe.now()};return await gf(l,f),f},U1=async(e,t)=>{try{const n=Ee(je(K,e),Se("disciplineId","==",t));return(await Ce(n)).size}catch{return 0}},YR=e=>{if(e.totalRessources+e.totalQuiz===0)return 0;const n=e.totalRessources>0?e.ressourcesVues.length/e.totalRessources*40:0,a=e.totalQuiz>0?e.quizReussis.length/e.totalQuiz*60:0;return e.totalRessources===0?Math.min(100,Math.round(e.quizReussis.length/e.totalQuiz*100)):e.totalQuiz===0?Math.min(100,Math.round(e.ressourcesVues.length/e.totalRessources*100)):Math.min(100,Math.round(n+a))},KR=async(e,t,n,a)=>{try{const l=`${e}_${t}`,o=Ne(Lb,l),u=await VR(e,t,n);if(u.quizReussis.includes(a))return await Qe(o,{dernierAcces:Oe.now()}),u;const d=[...u.quizReussis,a],f={...u,quizReussis:d,dernierAcces:Oe.now(),updatedAt:Oe.now(),pourcentage:0};return f.pourcentage=YR(f),await gf(o,f),f}catch(l){throw console.error("Erreur enregistrement quiz russi :",l),l}},WR=async e=>{try{const t=Ee(Lb,Se("userId","==",e));return(await Ce(t)).docs.map(a=>a.data())}catch(t){return console.error("Erreur rcupration progressions :",t),[]}},XR=async e=>{try{const t=await WR(e),n=await TA(e),a=t.reduce((d,f)=>d+f.ressourcesVues.length,0),l=t.reduce((d,f)=>d+f.quizReussis.length,0),o=t.length>0?Math.round(t.reduce((d,f)=>d+f.pourcentage,0)/t.length):0,u=t.filter(d=>d.pourcentage>=100).length;return{totalRessourcesVues:a,totalQuizReussis:l,pourcentageMoyen:o,disciplinesCommencees:t.length,disciplinesCompletees:u,streakActuel:n.streakActuel,meilleurStreak:n.meilleurStreak,parDiscipline:t}}catch(t){return console.error("Erreur progression globale :",t),{totalRessourcesVues:0,totalQuizReussis:0,pourcentageMoyen:0,disciplinesCommencees:0,disciplinesCompletees:0,streakActuel:0,meilleurStreak:0,parDiscipline:[]}}},ZR=()=>new Date().toISOString().split("T")[0],JR=()=>{const e=new Date;return e.setDate(e.getDate()-1),e.toISOString().split("T")[0]},TA=async e=>{try{const t=Ne(K,"users",e),n=await Dt(t);if(!n.exists())return{streakActuel:0,meilleurStreak:0,dernierJourAcces:""};const a=n.data();return{streakActuel:a.streakActuel||0,meilleurStreak:a.meilleurStreak||0,dernierJourAcces:a.dernierJourAcces||""}}catch(t){return console.error("Erreur rcupration streak :",t),{streakActuel:0,meilleurStreak:0,dernierJourAcces:""}}},e6=async e=>{try{const t=Ne(K,"users",e),n=await TA(e),a=ZR();if(n.dernierJourAcces===a)return n;const l=JR();let o;n.dernierJourAcces===l?o=n.streakActuel+1:o=1;const u=Math.max(n.meilleurStreak,o);return await Qe(t,{streakActuel:o,meilleurStreak:u,dernierJourAcces:a}),{streakActuel:o,meilleurStreak:u,dernierJourAcces:a}}catch(t){return console.error("Erreur mise  jour streak :",t),{streakActuel:0,meilleurStreak:0,dernierJourAcces:""}}},t6=(e,t,n)=>{const a=n?.totalRessourcesVues||0;n?.totalQuizReussis;const l=n?.disciplinesCompletees||0;n?.streakActuel;const o=n?.meilleurStreak||0,u=n?.disciplinesCommencees||0;return[{id:"premier_pas",nom:"Premier pas ",description:"Consulter votre premire ressource",icone:"",condition:"1 ressource consulte",categorie:"ressources",obtenu:a>=1},{id:"lecteur_assidu",nom:"Lecteur assidu ",description:"Consulter 10 ressources",icone:"",condition:"10 ressources consultes",categorie:"ressources",obtenu:a>=10},{id:"bibliophile",nom:"Bibliophile ",description:"Consulter 25 ressources",icone:"",condition:"25 ressources consultes",categorie:"ressources",obtenu:a>=25},{id:"savant",nom:"Savant ",description:"Consulter 50 ressources",icone:"",condition:"50 ressources consultes",categorie:"ressources",obtenu:a>=50},{id:"premier_quiz",nom:"Apprenti ",description:"Passer votre premier quiz",icone:"",condition:"1 quiz pass",categorie:"quiz",obtenu:e.totalQuizPasses>=1},{id:"challenger",nom:"Challenger ",description:"Russir 5 quiz",icone:"",condition:"5 quiz russis",categorie:"quiz",obtenu:e.totalQuizReussis>=5},{id:"dix_quiz",nom:"Dcathlon ",description:"Passer 10 quiz",icone:"",condition:"10 quiz passs",categorie:"quiz",obtenu:e.totalQuizPasses>=10},{id:"cinquante_quiz",nom:"Marathonien ",description:"Passer 50 quiz",icone:"",condition:"50 quiz passs",categorie:"quiz",obtenu:e.totalQuizPasses>=50},{id:"score_parfait",nom:"Score parfait ",description:"Obtenir 100%  un quiz",icone:"",condition:"100%  un quiz",categorie:"performance",obtenu:e.meilleurScore>=100},{id:"moyenne_80",nom:"Excellent ",description:"Moyenne gnrale de 80%+",icone:"",condition:"Moyenne  80% (min. 5 quiz)",categorie:"performance",obtenu:e.moyenneGenerale>=80&&e.totalQuizPasses>=5},{id:"serie_5",nom:"Imbattable ",description:"5 quiz russis d'affile",icone:"",condition:"Srie de 5 russites",categorie:"performance",obtenu:e.meilleureSerieReussites>=5},{id:"serie_10",nom:"Lgende ",description:"10 quiz russis d'affile",icone:"",condition:"Srie de 10 russites",categorie:"performance",obtenu:e.meilleureSerieReussites>=10},{id:"maitre",nom:"Matre ",description:"Complter 100% d'une discipline",icone:"",condition:"1 discipline  100%",categorie:"discipline",obtenu:l>=1},{id:"explorateur_teranga",nom:"Explorateur Teranga ",description:"Commencer 3 disciplines diffrentes",icone:"",condition:"3 disciplines commences",categorie:"discipline",obtenu:u>=3||t.length>=3},{id:"touche_a_tout",nom:"Touche--tout ",description:"Commencer 5 disciplines diffrentes",icone:"",condition:"5 disciplines commences",categorie:"discipline",obtenu:u>=5||t.length>=5},{id:"en_feu_3",nom:"Rgulier ",description:"3 jours de connexion conscutifs",icone:"",condition:"3 jours conscutifs",categorie:"streak",obtenu:o>=3},{id:"en_feu_7",nom:"En feu ",description:"7 jours de connexion conscutifs",icone:"",condition:"7 jours conscutifs",categorie:"streak",obtenu:o>=7},{id:"en_feu_30",nom:"Infatigable ",description:"30 jours de connexion conscutifs",icone:"",condition:"30 jours conscutifs",categorie:"streak",obtenu:o>=30},{id:"diamant",nom:"Diamant ",description:"50 ressources + 20 quiz russis",icone:"",condition:"50 ressources + 20 quiz",categorie:"performance",obtenu:a>=50&&e.totalQuizReussis>=20}]},qA=e=>{if(e<60)return`${e} s`;const t=Math.floor(e/60),n=e%60;return n>0?`${t} min ${n.toString().padStart(2,"0")} s`:`${t} min`},Xl=e=>e>=80?"#10b981":e>=60?"#3b82f6":e>=40?"#f59e0b":"#ef4444",RA=e=>e>=80?"Excellent":e>=60?"Bien":e>=40?"Passable":" amliorer",r6=()=>{const{quizId:e}=Jn(),t=lt(),{currentUser:n}=Ze(),[a,l]=g.useState(null),[o,u]=g.useState(""),[d,f]=g.useState(!0),[p,h]=g.useState(null),[v,b]=g.useState("intro"),[x,j]=g.useState(0),[N,w]=g.useState({}),[C,E]=g.useState(0),[S,A]=g.useState(0),O=g.useRef(null),[k,M]=g.useState(0),[D,$]=g.useState(0),[U,L]=g.useState(0),[B,ee]=g.useState(!1),[se,P]=g.useState(!1);g.useEffect(()=>{(async()=>{if(!e){h("ID du quiz manquant."),f(!1);return}try{const H=await $5(e);if(!H){h("Quiz introuvable."),f(!1);return}l(H),E(H.duree*60);try{const Pe=(await Ji.getAll()).find(ue=>ue.id===H.disciplineId);u(Pe?.nom||H.disciplineId)}catch{u(H.disciplineId)}}catch(H){h("Erreur lors du chargement du quiz."),console.error(H)}finally{f(!1)}})()},[e]),g.useEffect(()=>{if(v==="playing")return O.current=setInterval(()=>{E(ve=>ve<=1?(clearInterval(O.current),W(),0):ve-1),A(ve=>ve+1)},1e3),()=>{O.current&&clearInterval(O.current)}},[v]);const q=()=>{b("playing"),j(0),w({}),A(0),a&&E(a.duree*60)},F=(ve,H)=>{w(he=>({...he,[ve]:H}))},R=ve=>{a&&ve>=0&&ve<a.questions.length&&j(ve)},W=g.useCallback(async()=>{if(!a||!n||v==="review")return;O.current&&clearInterval(O.current);let ve=0,H=0,he=0;a.questions.forEach(X=>{const Q=X.points||1;H+=Q,N[X.id]===X.reponseCorrecte&&(ve+=Q,he++)});const Pe=H>0?Math.round(ve/H*100):0,ue=Pe>=(a.noteMinimale||50);M(ve),$(H),L(he),b("review"),ee(!0);try{const X={quizId:a.id,quizTitre:a.titre,disciplineId:a.disciplineId,disciplineNom:o,userId:n.uid,reponses:a.questions.map(Q=>N[Q.id]??-1),tempsEcoule:S,score:ve,totalPoints:H,pourcentage:Pe,reussi:ue,nombreQuestions:a.questions.length,bonnesReponses:he};await FR(X),P(!0)}catch(X){console.error("Erreur lors de la sauvegarde :",X)}finally{ee(!1)}},[a,n,N,S,o,v]),I=ve=>{const H=Math.floor(ve/60),he=ve%60;return`${H.toString().padStart(2,"0")}:${he.toString().padStart(2,"0")}`},re=()=>{if(!a)return"";const ve=a.duree*60,H=C/ve;return H<=.1?"timer-critical":H<=.25?"timer-warning":""},V=Object.keys(N).length;if(d)return r.jsxs("div",{className:"quiz-player-loading",children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement du quiz..."})]});if(p||!a)return r.jsxs("div",{className:"quiz-player-error",children:[r.jsx(fm,{size:48}),r.jsx("h3",{children:p||"Quiz introuvable"}),r.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>t("/eleve/dashboard"),children:[r.jsx(jx,{size:18})," Retour au tableau de bord"]})]});if(a.isPremium&&!n?.isPremium)return r.jsx("div",{className:"quiz-player-locked",children:r.jsxs("div",{className:"qp-locked-card",children:[r.jsx(_x,{size:48}),r.jsx("h3",{children:"Quiz Premium"}),r.jsx("p",{children:"Ce quiz est rserv aux abonns Premium."}),r.jsxs("p",{className:"qp-locked-price",children:[" partir de ",r.jsx("strong",{children:"2 000 FCFA/mois"})]}),r.jsxs("div",{className:"qp-locked-actions",children:[r.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>t("/premium"),children:[r.jsx(Zr,{size:18})," Devenir Premium"]}),r.jsxs("button",{className:"qp-btn qp-btn-outline",onClick:()=>t("/eleve/dashboard"),children:[r.jsx(Av,{size:18})," Retour"]})]})]})});if(v==="intro")return r.jsx("div",{className:"quiz-player-intro",children:r.jsxs("div",{className:"qp-intro-card",children:[r.jsxs("div",{className:"qp-intro-header",children:[r.jsxs("button",{className:"qp-back-btn",onClick:()=>t(-1),children:[r.jsx(Av,{size:20})," Retour"]}),a.isPremium&&r.jsxs("span",{className:"qp-badge qp-badge-premium",children:[r.jsx(Zr,{size:12})," Premium"]})]}),r.jsxs("div",{className:"qp-intro-content",children:[r.jsx("h1",{className:"qp-intro-title",children:a.titre}),r.jsx("span",{className:"qp-intro-discipline",children:o}),r.jsxs("div",{className:"qp-intro-stats",children:[r.jsxs("div",{className:"qp-intro-stat",children:[r.jsx(vn,{size:20}),r.jsxs("div",{children:[r.jsx("span",{className:"qp-intro-stat-value",children:a.questions.length}),r.jsx("span",{className:"qp-intro-stat-label",children:"Questions"})]})]}),r.jsxs("div",{className:"qp-intro-stat",children:[r.jsx(so,{size:20}),r.jsxs("div",{children:[r.jsxs("span",{className:"qp-intro-stat-value",children:[a.duree," min"]}),r.jsx("span",{className:"qp-intro-stat-label",children:"Dure"})]})]}),r.jsxs("div",{className:"qp-intro-stat",children:[r.jsx(Wi,{size:20}),r.jsxs("div",{children:[r.jsxs("span",{className:"qp-intro-stat-value",children:[a.noteMinimale||50,"%"]}),r.jsx("span",{className:"qp-intro-stat-label",children:"Note min."})]})]})]}),r.jsxs("div",{className:"qp-intro-instructions",children:[r.jsx("h3",{children:"Instructions"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Rpondez  toutes les questions dans le temps imparti"}),r.jsx("li",{children:"Chaque question a une seule bonne rponse"}),r.jsx("li",{children:"Vous pouvez naviguer entre les questions"}),r.jsx("li",{children:"Le quiz est soumis automatiquement quand le temps est coul"}),r.jsxs("li",{children:["Il faut obtenir au moins ",a.noteMinimale||50,"% pour russir"]})]})]})]}),r.jsxs("button",{className:"qp-btn qp-btn-start",onClick:q,children:[r.jsx(Jl,{size:20})," Commencer le quiz"]})]})});if(v==="playing"){const ve=a.questions[x];return r.jsxs("div",{className:"quiz-player-game",children:[r.jsxs("div",{className:"qp-game-header",children:[r.jsxs("div",{className:"qp-game-info",children:[r.jsx("span",{className:"qp-game-title",children:a.titre}),r.jsx("span",{className:"qp-game-discipline",children:o})]}),r.jsxs("div",{className:`qp-timer ${re()}`,children:[r.jsx(h3,{size:18}),r.jsx("span",{children:I(C)})]})]}),r.jsx("div",{className:"qp-progress-bar",children:r.jsx("div",{className:"qp-progress-fill",style:{width:`${(x+1)/a.questions.length*100}%`}})}),r.jsxs("div",{className:"qp-game-content",children:[r.jsxs("div",{className:"qp-question-header",children:[r.jsxs("span",{className:"qp-question-number",children:["Question ",x+1,"/",a.questions.length]}),r.jsxs("span",{className:"qp-question-points",children:[ve.points||1," pt(s)"]})]}),r.jsx("h2",{className:"qp-question-text",children:ve.question}),r.jsx("div",{className:"qp-options-list",children:ve.options.map((H,he)=>r.jsxs("button",{className:`qp-option ${N[ve.id]===he?"selected":""}`,onClick:()=>F(ve.id,he),children:[r.jsx("span",{className:"qp-option-letter",children:String.fromCharCode(65+he)}),r.jsx("span",{className:"qp-option-text",children:H}),N[ve.id]===he&&r.jsx(Ut,{size:18,className:"qp-option-check"})]},he))})]}),r.jsxs("div",{className:"qp-game-footer",children:[r.jsx("div",{className:"qp-question-indicators",children:a.questions.map((H,he)=>r.jsx("button",{className:`qp-indicator ${he===x?"active":""} ${N[H.id]!==void 0?"answered":""}`,onClick:()=>R(he),children:he+1},H.id))}),r.jsxs("div",{className:"qp-nav-buttons",children:[r.jsxs("button",{className:"qp-btn qp-btn-outline",onClick:()=>R(x-1),disabled:x===0,children:[r.jsx(Av,{size:16})," Prcdent"]}),x<a.questions.length-1?r.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>R(x+1),children:["Suivant ",r.jsx(ws,{size:16})]}):r.jsxs("button",{className:"qp-btn qp-btn-submit",onClick:W,disabled:V<a.questions.length,children:[r.jsx(Ut,{size:16}),"Soumettre (",V,"/",a.questions.length,")"]})]})]})]})}const oe=D>0?Math.round(k/D*100):0,xe=oe>=(a.noteMinimale||50);return r.jsxs("div",{className:"quiz-player-review",children:[r.jsxs("div",{className:`qp-score-card ${xe?"success":"fail"}`,children:[r.jsx("div",{className:"qp-score-icon",children:xe?r.jsx(Wi,{size:48}):r.jsx(fm,{size:48})}),r.jsx("h2",{className:"qp-score-title",children:xe?"Flicitations ! ":"Continuez vos efforts ! "}),r.jsxs("div",{className:"qp-score-circle",style:{borderColor:Xl(oe)},children:[r.jsxs("span",{className:"qp-score-value",children:[oe,"%"]}),r.jsx("span",{className:"qp-score-label",children:RA(oe)})]}),r.jsxs("div",{className:"qp-score-details",children:[r.jsxs("div",{className:"qp-score-detail",children:[r.jsxs("span",{children:[U,"/",a.questions.length]}),r.jsx("small",{children:"Bonnes rponses"})]}),r.jsxs("div",{className:"qp-score-detail",children:[r.jsxs("span",{children:[k,"/",D]}),r.jsx("small",{children:"Points"})]}),r.jsxs("div",{className:"qp-score-detail",children:[r.jsx("span",{children:qA(S)}),r.jsx("small",{children:"Temps"})]})]}),B&&r.jsx("p",{className:"qp-saving",children:"Sauvegarde en cours..."}),se&&r.jsx("p",{className:"qp-saved",children:" Rsultat sauvegard"})]}),r.jsxs("div",{className:"qp-review-actions",children:[r.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>t("/eleve/dashboard"),children:[r.jsx(jx,{size:18})," Tableau de bord"]}),r.jsxs("button",{className:"qp-btn qp-btn-outline",onClick:q,children:[r.jsx(v3,{size:18})," Recommencer"]})]}),r.jsxs("div",{className:"qp-review-questions",children:[r.jsx("h3",{className:"qp-review-title",children:"Correction dtaille"}),a.questions.map((ve,H)=>{const he=N[ve.id],Pe=he===ve.reponseCorrecte;return r.jsxs("div",{className:`qp-review-question ${Pe?"correct":"incorrect"}`,children:[r.jsxs("div",{className:"qp-review-question-header",children:[r.jsxs("span",{className:"qp-review-q-number",children:["Q",H+1]}),Pe?r.jsxs("span",{className:"qp-review-badge correct",children:[r.jsx(Ut,{size:14})," Correct"]}):r.jsxs("span",{className:"qp-review-badge incorrect",children:[r.jsx(Sx,{size:14})," Incorrect"]}),r.jsxs("span",{className:"qp-review-q-points",children:[Pe?ve.points||1:0,"/",ve.points||1," pt(s)"]})]}),r.jsx("p",{className:"qp-review-q-text",children:ve.question}),r.jsx("div",{className:"qp-review-options",children:ve.options.map((ue,X)=>{let Q="qp-review-option";return X===ve.reponseCorrecte&&(Q+=" correct-answer"),X===he&&!Pe&&(Q+=" wrong-answer"),r.jsxs("div",{className:Q,children:[r.jsx("span",{className:"qp-review-option-letter",children:String.fromCharCode(65+X)}),r.jsx("span",{children:ue}),X===ve.reponseCorrecte&&r.jsx(Ut,{size:14,className:"qp-review-check"}),X===he&&!Pe&&r.jsx(Sx,{size:14,className:"qp-review-x"})]},X)})}),ve.explication&&r.jsxs("div",{className:"qp-review-explication",children:[r.jsx("strong",{children:" Explication :"})," ",ve.explication]})]},ve.id)})]})]})};function IA(e){var t,n,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var l=e.length;for(t=0;t<l;t++)e[t]&&(n=IA(e[t]))&&(a&&(a+=" "),a+=n)}else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}function _t(){for(var e,t,n=0,a="",l=arguments.length;n<l;n++)(e=arguments[n])&&(t=IA(e))&&(a&&(a+=" "),a+=t);return a}var n6=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function $b(e){if(typeof e!="string")return!1;var t=n6;return t.includes(e)}var a6=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],i6=new Set(a6);function LA(e){return typeof e!="string"?!1:i6.has(e)}function $A(e){return typeof e=="string"&&e.startsWith("data-")}function Wn(e){if(typeof e!="object"||e===null)return{};var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(LA(n)||$A(n))&&(t[n]=e[n]);return t}function au(e){if(e==null)return null;if(g.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return Wn(t)}return typeof e=="object"&&!Array.isArray(e)?Wn(e):null}function $r(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(LA(n)||$A(n)||$b(n))&&(t[n]=e[n]);return t}function s6(e){return e==null?null:g.isValidElement(e)?$r(e.props):typeof e=="object"&&!Array.isArray(e)?$r(e):null}var l6=["children","width","height","viewBox","className","style","title","desc"];function Ax(){return Ax=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ax.apply(null,arguments)}function o6(e,t){if(e==null)return{};var n,a,l=c6(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function c6(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var BA=g.forwardRef((e,t)=>{var{children:n,width:a,height:l,viewBox:o,className:u,style:d,title:f,desc:p}=e,h=o6(e,l6),v=o||{width:a,height:l,x:0,y:0},b=_t("recharts-surface",u);return g.createElement("svg",Ax({},$r(h),{className:b,width:a,height:l,style:d,viewBox:"".concat(v.x," ").concat(v.y," ").concat(v.width," ").concat(v.height),ref:t}),g.createElement("title",null,f),g.createElement("desc",null,p),n)}),u6=["children","className"];function zx(){return zx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},zx.apply(null,arguments)}function d6(e,t){if(e==null)return{};var n,a,l=m6(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function m6(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var Pn=g.forwardRef((e,t)=>{var{children:n,className:a}=e,l=d6(e,u6),o=_t("recharts-layer",a);return g.createElement("g",zx({className:o},$r(l),{ref:t}),n)}),f6=g.createContext(null);function Et(e){return function(){return e}}const UA=Math.cos,gm=Math.sin,ea=Math.sqrt,xm=Math.PI,yf=2*xm,kx=Math.PI,Ox=2*kx,Cs=1e-6,p6=Ox-Cs;function FA(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function h6(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return FA;const n=10**t;return function(a){this._+=a[0];for(let l=1,o=a.length;l<o;++l)this._+=Math.round(arguments[l]*n)/n+a[l]}}class v6{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?FA:h6(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,a,l){this._append`Q${+t},${+n},${this._x1=+a},${this._y1=+l}`}bezierCurveTo(t,n,a,l,o,u){this._append`C${+t},${+n},${+a},${+l},${this._x1=+o},${this._y1=+u}`}arcTo(t,n,a,l,o){if(t=+t,n=+n,a=+a,l=+l,o=+o,o<0)throw new Error(`negative radius: ${o}`);let u=this._x1,d=this._y1,f=a-t,p=l-n,h=u-t,v=d-n,b=h*h+v*v;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(b>Cs)if(!(Math.abs(v*f-p*h)>Cs)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let x=a-u,j=l-d,N=f*f+p*p,w=x*x+j*j,C=Math.sqrt(N),E=Math.sqrt(b),S=o*Math.tan((kx-Math.acos((N+b-w)/(2*C*E)))/2),A=S/E,O=S/C;Math.abs(A-1)>Cs&&this._append`L${t+A*h},${n+A*v}`,this._append`A${o},${o},0,0,${+(v*x>h*j)},${this._x1=t+O*f},${this._y1=n+O*p}`}}arc(t,n,a,l,o,u){if(t=+t,n=+n,a=+a,u=!!u,a<0)throw new Error(`negative radius: ${a}`);let d=a*Math.cos(l),f=a*Math.sin(l),p=t+d,h=n+f,v=1^u,b=u?l-o:o-l;this._x1===null?this._append`M${p},${h}`:(Math.abs(this._x1-p)>Cs||Math.abs(this._y1-h)>Cs)&&this._append`L${p},${h}`,a&&(b<0&&(b=b%Ox+Ox),b>p6?this._append`A${a},${a},0,1,${v},${t-d},${n-f}A${a},${a},0,1,${v},${this._x1=p},${this._y1=h}`:b>Cs&&this._append`A${a},${a},0,${+(b>=kx)},${v},${this._x1=t+a*Math.cos(o)},${this._y1=n+a*Math.sin(o)}`)}rect(t,n,a,l){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${a=+a}v${+l}h${-a}Z`}toString(){return this._}}function Bb(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const a=Math.floor(n);if(!(a>=0))throw new RangeError(`invalid digits: ${n}`);t=a}return e},()=>new v6(t)}function Ub(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function GA(e){this._context=e}GA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function jf(e){return new GA(e)}function HA(e){return e[0]}function QA(e){return e[1]}function VA(e,t){var n=Et(!0),a=null,l=jf,o=null,u=Bb(d);e=typeof e=="function"?e:e===void 0?HA:Et(e),t=typeof t=="function"?t:t===void 0?QA:Et(t);function d(f){var p,h=(f=Ub(f)).length,v,b=!1,x;for(a==null&&(o=l(x=u())),p=0;p<=h;++p)!(p<h&&n(v=f[p],p,f))===b&&((b=!b)?o.lineStart():o.lineEnd()),b&&o.point(+e(v,p,f),+t(v,p,f));if(x)return o=null,x+""||null}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:Et(+f),d):e},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:Et(+f),d):t},d.defined=function(f){return arguments.length?(n=typeof f=="function"?f:Et(!!f),d):n},d.curve=function(f){return arguments.length?(l=f,a!=null&&(o=l(a)),d):l},d.context=function(f){return arguments.length?(f==null?a=o=null:o=l(a=f),d):a},d}function Rd(e,t,n){var a=null,l=Et(!0),o=null,u=jf,d=null,f=Bb(p);e=typeof e=="function"?e:e===void 0?HA:Et(+e),t=typeof t=="function"?t:Et(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?QA:Et(+n);function p(v){var b,x,j,N=(v=Ub(v)).length,w,C=!1,E,S=new Array(N),A=new Array(N);for(o==null&&(d=u(E=f())),b=0;b<=N;++b){if(!(b<N&&l(w=v[b],b,v))===C)if(C=!C)x=b,d.areaStart(),d.lineStart();else{for(d.lineEnd(),d.lineStart(),j=b-1;j>=x;--j)d.point(S[j],A[j]);d.lineEnd(),d.areaEnd()}C&&(S[b]=+e(w,b,v),A[b]=+t(w,b,v),d.point(a?+a(w,b,v):S[b],n?+n(w,b,v):A[b]))}if(E)return d=null,E+""||null}function h(){return VA().defined(l).curve(u).context(o)}return p.x=function(v){return arguments.length?(e=typeof v=="function"?v:Et(+v),a=null,p):e},p.x0=function(v){return arguments.length?(e=typeof v=="function"?v:Et(+v),p):e},p.x1=function(v){return arguments.length?(a=v==null?null:typeof v=="function"?v:Et(+v),p):a},p.y=function(v){return arguments.length?(t=typeof v=="function"?v:Et(+v),n=null,p):t},p.y0=function(v){return arguments.length?(t=typeof v=="function"?v:Et(+v),p):t},p.y1=function(v){return arguments.length?(n=v==null?null:typeof v=="function"?v:Et(+v),p):n},p.lineX0=p.lineY0=function(){return h().x(e).y(t)},p.lineY1=function(){return h().x(e).y(n)},p.lineX1=function(){return h().x(a).y(t)},p.defined=function(v){return arguments.length?(l=typeof v=="function"?v:Et(!!v),p):l},p.curve=function(v){return arguments.length?(u=v,o!=null&&(d=u(o)),p):u},p.context=function(v){return arguments.length?(v==null?o=d=null:d=u(o=v),p):o},p}class YA{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function g6(e){return new YA(e,!0)}function x6(e){return new YA(e,!1)}const Fb={draw(e,t){const n=ea(t/xm);e.moveTo(n,0),e.arc(0,0,n,0,yf)}},b6={draw(e,t){const n=ea(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},KA=ea(1/3),y6=KA*2,j6={draw(e,t){const n=ea(t/y6),a=n*KA;e.moveTo(0,-n),e.lineTo(a,0),e.lineTo(0,n),e.lineTo(-a,0),e.closePath()}},N6={draw(e,t){const n=ea(t),a=-n/2;e.rect(a,a,n,n)}},_6=.8908130915292852,WA=gm(xm/10)/gm(7*xm/10),S6=gm(yf/10)*WA,w6=-UA(yf/10)*WA,C6={draw(e,t){const n=ea(t*_6),a=S6*n,l=w6*n;e.moveTo(0,-n),e.lineTo(a,l);for(let o=1;o<5;++o){const u=yf*o/5,d=UA(u),f=gm(u);e.lineTo(f*n,-d*n),e.lineTo(d*a-f*l,f*a+d*l)}e.closePath()}},Lv=ea(3),E6={draw(e,t){const n=-ea(t/(Lv*3));e.moveTo(0,n*2),e.lineTo(-Lv*n,-n),e.lineTo(Lv*n,-n),e.closePath()}},zn=-.5,kn=ea(3)/2,Dx=1/ea(12),A6=(Dx/2+1)*3,z6={draw(e,t){const n=ea(t/A6),a=n/2,l=n*Dx,o=a,u=n*Dx+n,d=-o,f=u;e.moveTo(a,l),e.lineTo(o,u),e.lineTo(d,f),e.lineTo(zn*a-kn*l,kn*a+zn*l),e.lineTo(zn*o-kn*u,kn*o+zn*u),e.lineTo(zn*d-kn*f,kn*d+zn*f),e.lineTo(zn*a+kn*l,zn*l-kn*a),e.lineTo(zn*o+kn*u,zn*u-kn*o),e.lineTo(zn*d+kn*f,zn*f-kn*d),e.closePath()}};function k6(e,t){let n=null,a=Bb(l);e=typeof e=="function"?e:Et(e||Fb),t=typeof t=="function"?t:Et(t===void 0?64:+t);function l(){let o;if(n||(n=o=a()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return l.type=function(o){return arguments.length?(e=typeof o=="function"?o:Et(o),l):e},l.size=function(o){return arguments.length?(t=typeof o=="function"?o:Et(+o),l):t},l.context=function(o){return arguments.length?(n=o??null,l):n},l}function bm(){}function ym(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function XA(e){this._context=e}XA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ym(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ym(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function O6(e){return new XA(e)}function ZA(e){this._context=e}ZA.prototype={areaStart:bm,areaEnd:bm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ym(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function D6(e){return new ZA(e)}function JA(e){this._context=e}JA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,a):this._context.moveTo(n,a);break;case 3:this._point=4;default:ym(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function M6(e){return new JA(e)}function ez(e){this._context=e}ez.prototype={areaStart:bm,areaEnd:bm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function P6(e){return new ez(e)}function F1(e){return e<0?-1:1}function G1(e,t,n){var a=e._x1-e._x0,l=t-e._x1,o=(e._y1-e._y0)/(a||l<0&&-0),u=(n-e._y1)/(l||a<0&&-0),d=(o*l+u*a)/(a+l);return(F1(o)+F1(u))*Math.min(Math.abs(o),Math.abs(u),.5*Math.abs(d))||0}function H1(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function $v(e,t,n){var a=e._x0,l=e._y0,o=e._x1,u=e._y1,d=(o-a)/3;e._context.bezierCurveTo(a+d,l+d*t,o-d,u-d*n,o,u)}function jm(e){this._context=e}jm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:$v(this,this._t0,H1(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,$v(this,H1(this,n=G1(this,e,t)),n);break;default:$v(this,this._t0,n=G1(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function tz(e){this._context=new rz(e)}(tz.prototype=Object.create(jm.prototype)).point=function(e,t){jm.prototype.point.call(this,t,e)};function rz(e){this._context=e}rz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,a,l,o){this._context.bezierCurveTo(t,e,a,n,o,l)}};function T6(e){return new jm(e)}function q6(e){return new tz(e)}function nz(e){this._context=e}nz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var a=Q1(e),l=Q1(t),o=0,u=1;u<n;++o,++u)this._context.bezierCurveTo(a[0][o],l[0][o],a[1][o],l[1][o],e[u],t[u]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Q1(e){var t,n=e.length-1,a,l=new Array(n),o=new Array(n),u=new Array(n);for(l[0]=0,o[0]=2,u[0]=e[0]+2*e[1],t=1;t<n-1;++t)l[t]=1,o[t]=4,u[t]=4*e[t]+2*e[t+1];for(l[n-1]=2,o[n-1]=7,u[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)a=l[t]/o[t-1],o[t]-=a,u[t]-=a*u[t-1];for(l[n-1]=u[n-1]/o[n-1],t=n-2;t>=0;--t)l[t]=(u[t]-l[t+1])/o[t];for(o[n-1]=(e[n]+l[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-l[t+1];return[l,o]}function R6(e){return new nz(e)}function Nf(e,t){this._context=e,this._t=t}Nf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function I6(e){return new Nf(e,.5)}function L6(e){return new Nf(e,0)}function $6(e){return new Nf(e,1)}function Ls(e,t){if((u=e.length)>1)for(var n=1,a,l,o=e[t[0]],u,d=o.length;n<u;++n)for(l=o,o=e[t[n]],a=0;a<d;++a)o[a][1]+=o[a][0]=isNaN(l[a][1])?l[a][0]:l[a][1]}function Mx(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function B6(e,t){return e[t]}function U6(e){const t=[];return t.key=e,t}function F6(){var e=Et([]),t=Mx,n=Ls,a=B6;function l(o){var u=Array.from(e.apply(this,arguments),U6),d,f=u.length,p=-1,h;for(const v of o)for(d=0,++p;d<f;++d)(u[d][p]=[0,+a(v,u[d].key,p,o)]).data=v;for(d=0,h=Ub(t(u));d<f;++d)u[h[d]].index=d;return n(u,h),u}return l.keys=function(o){return arguments.length?(e=typeof o=="function"?o:Et(Array.from(o)),l):e},l.value=function(o){return arguments.length?(a=typeof o=="function"?o:Et(+o),l):a},l.order=function(o){return arguments.length?(t=o==null?Mx:typeof o=="function"?o:Et(Array.from(o)),l):t},l.offset=function(o){return arguments.length?(n=o??Ls,l):n},l}function G6(e,t){if((a=e.length)>0){for(var n,a,l=0,o=e[0].length,u;l<o;++l){for(u=n=0;n<a;++n)u+=e[n][l][1]||0;if(u)for(n=0;n<a;++n)e[n][l][1]/=u}Ls(e,t)}}function H6(e,t){if((l=e.length)>0){for(var n=0,a=e[t[0]],l,o=a.length;n<o;++n){for(var u=0,d=0;u<l;++u)d+=e[u][n][1]||0;a[n][1]+=a[n][0]=-d/2}Ls(e,t)}}function Q6(e,t){if(!(!((u=e.length)>0)||!((o=(l=e[t[0]]).length)>0))){for(var n=0,a=1,l,o,u;a<o;++a){for(var d=0,f=0,p=0;d<u;++d){for(var h=e[t[d]],v=h[a][1]||0,b=h[a-1][1]||0,x=(v-b)/2,j=0;j<d;++j){var N=e[t[j]],w=N[a][1]||0,C=N[a-1][1]||0;x+=w-C}f+=v,p+=x*v}l[a-1][1]+=l[a-1][0]=n,f&&(n-=p/f)}l[a-1][1]+=l[a-1][0]=n,Ls(e,t)}}var Bv={},Uv={},V1;function V6(){return V1||(V1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==="__proto__"}e.isUnsafeProperty=t})(Uv)),Uv}var Fv={},Y1;function az(){return Y1||(Y1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}e.isDeepKey=t})(Fv)),Fv}var Gv={},K1;function Gb(){return K1||(K1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="string"||typeof n=="symbol"?n:Object.is(n?.valueOf?.(),-0)?"-0":String(n)}e.toKey=t})(Gv)),Gv}var Hv={},Qv={},W1;function Y6(){return W1||(W1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){if(n==null)return"";if(typeof n=="string")return n;if(Array.isArray(n))return n.map(t).join(",");const a=String(n);return a==="0"&&Object.is(Number(n),-0)?"-0":a}e.toString=t})(Qv)),Qv}var X1;function Hb(){return X1||(X1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Y6(),n=Gb();function a(l){if(Array.isArray(l))return l.map(n.toKey);if(typeof l=="symbol")return[l];l=t.toString(l);const o=[],u=l.length;if(u===0)return o;let d=0,f="",p="",h=!1;for(l.charCodeAt(0)===46&&(o.push(""),d++);d<u;){const v=l[d];p?v==="\\"&&d+1<u?(d++,f+=l[d]):v===p?p="":f+=v:h?v==='"'||v==="'"?p=v:v==="]"?(h=!1,o.push(f),f=""):f+=v:v==="["?(h=!0,f&&(o.push(f),f="")):v==="."?f&&(o.push(f),f=""):f+=v,d++}return f&&o.push(f),o}e.toPath=a})(Hv)),Hv}var Z1;function Qb(){return Z1||(Z1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=V6(),n=az(),a=Gb(),l=Hb();function o(d,f,p){if(d==null)return p;switch(typeof f){case"string":{if(t.isUnsafeProperty(f))return p;const h=d[f];return h===void 0?n.isDeepKey(f)?o(d,l.toPath(f),p):p:h}case"number":case"symbol":{typeof f=="number"&&(f=a.toKey(f));const h=d[f];return h===void 0?p:h}default:{if(Array.isArray(f))return u(d,f,p);if(Object.is(f?.valueOf(),-0)?f="-0":f=String(f),t.isUnsafeProperty(f))return p;const h=d[f];return h===void 0?p:h}}}function u(d,f,p){if(f.length===0)return p;let h=d;for(let v=0;v<f.length;v++){if(h==null||t.isUnsafeProperty(f[v]))return p;h=h[f[v]]}return h===void 0?p:h}e.get=o})(Bv)),Bv}var Vv,J1;function K6(){return J1||(J1=1,Vv=Qb().get),Vv}var W6=K6();const oo=ni(W6);var X6=4;function Fi(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:X6,n=10**t,a=Math.round(e*n)/n;return Object.is(a,-0)?0:a}function Ft(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return e.reduce((l,o,u)=>{var d=n[u-1];return typeof d=="string"?l+d+o:d!==void 0?l+Fi(d)+o:l+o},"")}var Jr=e=>e===0?0:e>0?1:-1,ga=e=>typeof e=="number"&&e!=+e,$s=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,De=e=>(typeof e=="number"||e instanceof Number)&&!ga(e),xa=e=>De(e)||typeof e=="string",Z6=0,$c=e=>{var t=++Z6;return"".concat(e||"").concat(t)},Xn=function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!De(t)&&typeof t!="string")return a;var o;if($s(t)){if(n==null)return a;var u=t.indexOf("%");o=n*parseFloat(t.slice(0,u))/100}else o=+t;return ga(o)&&(o=a),l&&n!=null&&o>n&&(o=n),o},iz=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},a=0;a<t;a++)if(!n[String(e[a])])n[String(e[a])]=!0;else return!0;return!1};function Gt(e,t,n){return De(e)&&De(t)?Fi(e+n*(t-e)):t}function sz(e,t,n){if(!(!e||!e.length))return e.find(a=>a&&(typeof t=="function"?t(a):oo(a,t))===n)}var Rt=e=>e===null||typeof e>"u",iu=e=>Rt(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function en(e){return e!=null}function Js(){}var J6=["type","size","sizeType"];function Px(){return Px=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Px.apply(null,arguments)}function eS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function tS(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?eS(Object(n),!0).forEach(function(a){eI(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eS(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function eI(e,t,n){return(t=tI(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tI(e){var t=rI(e,"string");return typeof t=="symbol"?t:t+""}function rI(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nI(e,t){if(e==null)return{};var n,a,l=aI(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function aI(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var lz={symbolCircle:Fb,symbolCross:b6,symbolDiamond:j6,symbolSquare:N6,symbolStar:C6,symbolTriangle:E6,symbolWye:z6},iI=Math.PI/180,sI=e=>{var t="symbol".concat(iu(e));return lz[t]||Fb},lI=(e,t,n)=>{if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var a=18*iI;return 1.25*e*e*(Math.tan(a)-Math.tan(a*2)*Math.tan(a)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},oI=(e,t)=>{lz["symbol".concat(iu(e))]=t},oz=e=>{var{type:t="circle",size:n=64,sizeType:a="area"}=e,l=nI(e,J6),o=tS(tS({},l),{},{type:t,size:n,sizeType:a}),u="circle";typeof t=="string"&&(u=t);var d=()=>{var b=sI(u),x=k6().type(b).size(lI(n,a,u)),j=x();if(j!==null)return j},{className:f,cx:p,cy:h}=o,v=$r(o);return De(p)&&De(h)&&De(n)?g.createElement("path",Px({},v,{className:_t("recharts-symbols",f),transform:"translate(".concat(p,", ").concat(h,")"),d:d()})):null};oz.registerSymbol=oI;var cz=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,Vb=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(g.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(l=>{$b(l)&&(a[l]=(o=>n[l](n,o)))}),a},cI=(e,t,n)=>a=>(e(t,n,a),null),Yb=(e,t,n)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var a=null;return Object.keys(e).forEach(l=>{var o=e[l];$b(l)&&typeof o=="function"&&(a||(a={}),a[l]=cI(o,t,n))}),a};function rS(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function uI(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rS(Object(n),!0).forEach(function(a){dI(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rS(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function dI(e,t,n){return(t=mI(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mI(e){var t=fI(e,"string");return typeof t=="symbol"?t:t+""}function fI(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ur(e,t){var n=uI({},e),a=t,l=Object.keys(t),o=l.reduce((u,d)=>(u[d]===void 0&&a[d]!==void 0&&(u[d]=a[d]),u),n);return o}var Yv={},Kv={},nS;function pI(){return nS||(nS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a){const l=new Map;for(let o=0;o<n.length;o++){const u=n[o],d=a(u,o,n);l.has(d)||l.set(d,u)}return Array.from(l.values())}e.uniqBy=t})(Kv)),Kv}var Wv={},aS;function hI(){return aS||(aS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a){return function(...l){return n.apply(this,l.slice(0,a))}}e.ary=t})(Wv)),Wv}var Xv={},iS;function uz(){return iS||(iS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n}e.identity=t})(Xv)),Xv}var Zv={},Jv={},eg={},sS;function vI(){return sS||(sS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Number.isSafeInteger(n)&&n>=0}e.isLength=t})(eg)),eg}var lS;function Kb(){return lS||(lS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vI();function n(a){return a!=null&&typeof a!="function"&&t.isLength(a.length)}e.isArrayLike=n})(Jv)),Jv}var tg={},oS;function gI(){return oS||(oS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="object"&&n!==null}e.isObjectLike=t})(tg)),tg}var cS;function xI(){return cS||(cS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Kb(),n=gI();function a(l){return n.isObjectLike(l)&&t.isArrayLike(l)}e.isArrayLikeObject=a})(Zv)),Zv}var rg={},ng={},uS;function bI(){return uS||(uS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Qb();function n(a){return function(l){return t.get(l,a)}}e.property=n})(ng)),ng}var ag={},ig={},sg={},lg={},dS;function dz(){return dS||(dS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n!==null&&(typeof n=="object"||typeof n=="function")}e.isObject=t})(lg)),lg}var og={},mS;function mz(){return mS||(mS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null||typeof n!="object"&&typeof n!="function"}e.isPrimitive=t})(og)),og}var cg={},fS;function fz(){return fS||(fS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a){return n===a||Number.isNaN(n)&&Number.isNaN(a)}e.isEqualsSameValueZero=t})(cg)),cg}var pS;function yI(){return pS||(pS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dz(),n=mz(),a=fz();function l(h,v,b){return typeof b!="function"?l(h,v,()=>{}):o(h,v,function x(j,N,w,C,E,S){const A=b(j,N,w,C,E,S);return A!==void 0?!!A:o(j,N,x,S)},new Map)}function o(h,v,b,x){if(v===h)return!0;switch(typeof v){case"object":return u(h,v,b,x);case"function":return Object.keys(v).length>0?o(h,{...v},b,x):a.isEqualsSameValueZero(h,v);default:return t.isObject(h)?typeof v=="string"?v==="":!0:a.isEqualsSameValueZero(h,v)}}function u(h,v,b,x){if(v==null)return!0;if(Array.isArray(v))return f(h,v,b,x);if(v instanceof Map)return d(h,v,b,x);if(v instanceof Set)return p(h,v,b,x);const j=Object.keys(v);if(h==null||n.isPrimitive(h))return j.length===0;if(j.length===0)return!0;if(x?.has(v))return x.get(v)===h;x?.set(v,h);try{for(let N=0;N<j.length;N++){const w=j[N];if(!n.isPrimitive(h)&&!(w in h)||v[w]===void 0&&h[w]!==void 0||v[w]===null&&h[w]!==null||!b(h[w],v[w],w,h,v,x))return!1}return!0}finally{x?.delete(v)}}function d(h,v,b,x){if(v.size===0)return!0;if(!(h instanceof Map))return!1;for(const[j,N]of v.entries()){const w=h.get(j);if(b(w,N,j,h,v,x)===!1)return!1}return!0}function f(h,v,b,x){if(v.length===0)return!0;if(!Array.isArray(h))return!1;const j=new Set;for(let N=0;N<v.length;N++){const w=v[N];let C=!1;for(let E=0;E<h.length;E++){if(j.has(E))continue;const S=h[E];let A=!1;if(b(S,w,N,h,v,x)&&(A=!0),A){j.add(E),C=!0;break}}if(!C)return!1}return!0}function p(h,v,b,x){return v.size===0?!0:h instanceof Set?f([...h],[...v],b,x):!1}e.isMatchWith=l,e.isSetMatch=p})(sg)),sg}var hS;function pz(){return hS||(hS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yI();function n(a,l){return t.isMatchWith(a,l,()=>{})}e.isMatch=n})(ig)),ig}var ug={},dg={},mg={},vS;function jI(){return vS||(vS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Object.getOwnPropertySymbols(n).filter(a=>Object.prototype.propertyIsEnumerable.call(n,a))}e.getSymbols=t})(mg)),mg}var fg={},gS;function Wb(){return gS||(gS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}e.getTag=t})(fg)),fg}var pg={},xS;function hz(){return xS||(xS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",n="[object String]",a="[object Number]",l="[object Boolean]",o="[object Arguments]",u="[object Symbol]",d="[object Date]",f="[object Map]",p="[object Set]",h="[object Array]",v="[object Function]",b="[object ArrayBuffer]",x="[object Object]",j="[object Error]",N="[object DataView]",w="[object Uint8Array]",C="[object Uint8ClampedArray]",E="[object Uint16Array]",S="[object Uint32Array]",A="[object BigUint64Array]",O="[object Int8Array]",k="[object Int16Array]",M="[object Int32Array]",D="[object BigInt64Array]",$="[object Float32Array]",U="[object Float64Array]";e.argumentsTag=o,e.arrayBufferTag=b,e.arrayTag=h,e.bigInt64ArrayTag=D,e.bigUint64ArrayTag=A,e.booleanTag=l,e.dataViewTag=N,e.dateTag=d,e.errorTag=j,e.float32ArrayTag=$,e.float64ArrayTag=U,e.functionTag=v,e.int16ArrayTag=k,e.int32ArrayTag=M,e.int8ArrayTag=O,e.mapTag=f,e.numberTag=a,e.objectTag=x,e.regexpTag=t,e.setTag=p,e.stringTag=n,e.symbolTag=u,e.uint16ArrayTag=E,e.uint32ArrayTag=S,e.uint8ArrayTag=w,e.uint8ClampedArrayTag=C})(pg)),pg}var hg={},bS;function NI(){return bS||(bS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}e.isTypedArray=t})(hg)),hg}var yS;function vz(){return yS||(yS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jI(),n=Wb(),a=hz(),l=mz(),o=NI();function u(h,v){return d(h,void 0,h,new Map,v)}function d(h,v,b,x=new Map,j=void 0){const N=j?.(h,v,b,x);if(N!==void 0)return N;if(l.isPrimitive(h))return h;if(x.has(h))return x.get(h);if(Array.isArray(h)){const w=new Array(h.length);x.set(h,w);for(let C=0;C<h.length;C++)w[C]=d(h[C],C,b,x,j);return Object.hasOwn(h,"index")&&(w.index=h.index),Object.hasOwn(h,"input")&&(w.input=h.input),w}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const w=new RegExp(h.source,h.flags);return w.lastIndex=h.lastIndex,w}if(h instanceof Map){const w=new Map;x.set(h,w);for(const[C,E]of h)w.set(C,d(E,C,b,x,j));return w}if(h instanceof Set){const w=new Set;x.set(h,w);for(const C of h)w.add(d(C,void 0,b,x,j));return w}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(o.isTypedArray(h)){const w=new(Object.getPrototypeOf(h)).constructor(h.length);x.set(h,w);for(let C=0;C<h.length;C++)w[C]=d(h[C],C,b,x,j);return w}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const w=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return x.set(h,w),f(w,h,b,x,j),w}if(typeof File<"u"&&h instanceof File){const w=new File([h],h.name,{type:h.type});return x.set(h,w),f(w,h,b,x,j),w}if(typeof Blob<"u"&&h instanceof Blob){const w=new Blob([h],{type:h.type});return x.set(h,w),f(w,h,b,x,j),w}if(h instanceof Error){const w=new h.constructor;return x.set(h,w),w.message=h.message,w.name=h.name,w.stack=h.stack,w.cause=h.cause,f(w,h,b,x,j),w}if(h instanceof Boolean){const w=new Boolean(h.valueOf());return x.set(h,w),f(w,h,b,x,j),w}if(h instanceof Number){const w=new Number(h.valueOf());return x.set(h,w),f(w,h,b,x,j),w}if(h instanceof String){const w=new String(h.valueOf());return x.set(h,w),f(w,h,b,x,j),w}if(typeof h=="object"&&p(h)){const w=Object.create(Object.getPrototypeOf(h));return x.set(h,w),f(w,h,b,x,j),w}return h}function f(h,v,b=h,x,j){const N=[...Object.keys(v),...t.getSymbols(v)];for(let w=0;w<N.length;w++){const C=N[w],E=Object.getOwnPropertyDescriptor(h,C);(E==null||E.writable)&&(h[C]=d(v[C],C,b,x,j))}}function p(h){switch(n.getTag(h)){case a.argumentsTag:case a.arrayTag:case a.arrayBufferTag:case a.dataViewTag:case a.booleanTag:case a.dateTag:case a.float32ArrayTag:case a.float64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.mapTag:case a.numberTag:case a.objectTag:case a.regexpTag:case a.setTag:case a.stringTag:case a.symbolTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=u,e.cloneDeepWithImpl=d,e.copyProperties=f})(dg)),dg}var jS;function _I(){return jS||(jS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vz();function n(a){return t.cloneDeepWithImpl(a,void 0,a,new Map,void 0)}e.cloneDeep=n})(ug)),ug}var NS;function SI(){return NS||(NS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pz(),n=_I();function a(l){return l=n.cloneDeep(l),o=>t.isMatch(o,l)}e.matches=a})(ag)),ag}var vg={},gg={},xg={},_S;function wI(){return _S||(_S=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vz(),n=Wb(),a=hz();function l(o,u){return t.cloneDeepWith(o,(d,f,p,h)=>{const v=u?.(d,f,p,h);if(v!==void 0)return v;if(typeof o=="object"){if(n.getTag(o)===a.objectTag&&typeof o.constructor!="function"){const b={};return h.set(o,b),t.copyProperties(b,o,p,h),b}switch(Object.prototype.toString.call(o)){case a.numberTag:case a.stringTag:case a.booleanTag:{const b=new o.constructor(o?.valueOf());return t.copyProperties(b,o),b}case a.argumentsTag:{const b={};return t.copyProperties(b,o),b.length=o.length,b[Symbol.iterator]=o[Symbol.iterator],b}default:return}}})}e.cloneDeepWith=l})(xg)),xg}var SS;function CI(){return SS||(SS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wI();function n(a){return t.cloneDeepWith(a)}e.cloneDeep=n})(gg)),gg}var bg={},yg={},wS;function gz(){return wS||(wS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function n(a,l=Number.MAX_SAFE_INTEGER){switch(typeof a){case"number":return Number.isInteger(a)&&a>=0&&a<l;case"symbol":return!1;case"string":return t.test(a)}}e.isIndex=n})(yg)),yg}var jg={},CS;function EI(){return CS||(CS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Wb();function n(a){return a!==null&&typeof a=="object"&&t.getTag(a)==="[object Arguments]"}e.isArguments=n})(jg)),jg}var ES;function AI(){return ES||(ES=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=az(),n=gz(),a=EI(),l=Hb();function o(u,d){let f;if(Array.isArray(d)?f=d:typeof d=="string"&&t.isDeepKey(d)&&u?.[d]==null?f=l.toPath(d):f=[d],f.length===0)return!1;let p=u;for(let h=0;h<f.length;h++){const v=f[h];if((p==null||!Object.hasOwn(p,v))&&!((Array.isArray(p)||a.isArguments(p))&&n.isIndex(v)&&v<p.length))return!1;p=p[v]}return!0}e.has=o})(bg)),bg}var AS;function zI(){return AS||(AS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pz(),n=Gb(),a=CI(),l=Qb(),o=AI();function u(d,f){switch(typeof d){case"object":{Object.is(d?.valueOf(),-0)&&(d="-0");break}case"number":{d=n.toKey(d);break}}return f=a.cloneDeep(f),function(p){const h=l.get(p,d);return h===void 0?o.has(p,d):f===void 0?h===void 0:t.isMatch(h,f)}}e.matchesProperty=u})(vg)),vg}var zS;function kI(){return zS||(zS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uz(),n=bI(),a=SI(),l=zI();function o(u){if(u==null)return t.identity;switch(typeof u){case"function":return u;case"object":return Array.isArray(u)&&u.length===2?l.matchesProperty(u[0],u[1]):a.matches(u);case"string":case"symbol":case"number":return n.property(u)}}e.iteratee=o})(rg)),rg}var kS;function OI(){return kS||(kS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pI(),n=hI(),a=uz(),l=xI(),o=kI();function u(d,f=a.identity){return l.isArrayLikeObject(d)?t.uniqBy(Array.from(d),n.ary(o.iteratee(f),1)):[]}e.uniqBy=u})(Yv)),Yv}var Ng,OS;function DI(){return OS||(OS=1,Ng=OI().uniqBy),Ng}var MI=DI();const DS=ni(MI);function PI(e,t,n){return t===!0?DS(e,n):typeof t=="function"?DS(e,t):e}var _g={exports:{}},Sg={},wg={exports:{}},Cg={};var MS;function TI(){if(MS)return Cg;MS=1;var e=vf();function t(v,b){return v===b&&(v!==0||1/v===1/b)||v!==v&&b!==b}var n=typeof Object.is=="function"?Object.is:t,a=e.useState,l=e.useEffect,o=e.useLayoutEffect,u=e.useDebugValue;function d(v,b){var x=b(),j=a({inst:{value:x,getSnapshot:b}}),N=j[0].inst,w=j[1];return o(function(){N.value=x,N.getSnapshot=b,f(N)&&w({inst:N})},[v,x,b]),l(function(){return f(N)&&w({inst:N}),v(function(){f(N)&&w({inst:N})})},[v]),u(x),x}function f(v){var b=v.getSnapshot;v=v.value;try{var x=b();return!n(v,x)}catch{return!0}}function p(v,b){return b()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:d;return Cg.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,Cg}var PS;function qI(){return PS||(PS=1,wg.exports=TI()),wg.exports}var TS;function RI(){if(TS)return Sg;TS=1;var e=vf(),t=qI();function n(p,h){return p===h&&(p!==0||1/p===1/h)||p!==p&&h!==h}var a=typeof Object.is=="function"?Object.is:n,l=t.useSyncExternalStore,o=e.useRef,u=e.useEffect,d=e.useMemo,f=e.useDebugValue;return Sg.useSyncExternalStoreWithSelector=function(p,h,v,b,x){var j=o(null);if(j.current===null){var N={hasValue:!1,value:null};j.current=N}else N=j.current;j=d(function(){function C(k){if(!E){if(E=!0,S=k,k=b(k),x!==void 0&&N.hasValue){var M=N.value;if(x(M,k))return A=M}return A=k}if(M=A,a(S,k))return M;var D=b(k);return x!==void 0&&x(M,D)?(S=k,M):(S=k,A=D)}var E=!1,S,A,O=v===void 0?null:v;return[function(){return C(h())},O===null?void 0:function(){return C(O())}]},[h,v,b,x]);var w=l(p,j[0],j[1]);return u(function(){N.hasValue=!0,N.value=w},[w]),f(w),w},Sg}var qS;function II(){return qS||(qS=1,_g.exports=RI()),_g.exports}var LI=II(),Xb=g.createContext(null),$I=e=>e,Vt=()=>{var e=g.useContext(Xb);return e?e.store.dispatch:$I},im=()=>{},BI=()=>im,UI=(e,t)=>e===t;function Ie(e){var t=g.useContext(Xb),n=g.useMemo(()=>t?a=>{if(a!=null)return e(a)}:im,[t,e]);return LI.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:BI,t?t.store.getState:im,t?t.store.getState:im,n,UI)}function FI(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function GI(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function HI(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(n=>typeof n=="function")){const n=e.map(a=>typeof a=="function"?`function ${a.name||"unnamed"}()`:typeof a).join(", ");throw new TypeError(`${t}[${n}]`)}}var RS=e=>Array.isArray(e)?e:[e];function QI(e){const t=Array.isArray(e[0])?e[0]:e;return HI(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function VI(e,t){const n=[],{length:a}=e;for(let l=0;l<a;l++)n.push(e[l].apply(null,t));return n}var YI=class{constructor(e){this.value=e}deref(){return this.value}},KI=typeof WeakRef<"u"?WeakRef:YI,WI=0,IS=1;function Id(){return{s:WI,v:void 0,o:null,p:null}}function xz(e,t={}){let n=Id();const{resultEqualityCheck:a}=t;let l,o=0;function u(){let d=n;const{length:f}=arguments;for(let v=0,b=f;v<b;v++){const x=arguments[v];if(typeof x=="function"||typeof x=="object"&&x!==null){let j=d.o;j===null&&(d.o=j=new WeakMap);const N=j.get(x);N===void 0?(d=Id(),j.set(x,d)):d=N}else{let j=d.p;j===null&&(d.p=j=new Map);const N=j.get(x);N===void 0?(d=Id(),j.set(x,d)):d=N}}const p=d;let h;if(d.s===IS)h=d.v;else if(h=e.apply(null,arguments),o++,a){const v=l?.deref?.()??l;v!=null&&a(v,h)&&(h=v,o!==0&&o--),l=typeof h=="object"&&h!==null||typeof h=="function"?new KI(h):h}return p.s=IS,p.v=h,h}return u.clearCache=()=>{n=Id(),u.resetResultsCount()},u.resultsCount=()=>o,u.resetResultsCount=()=>{o=0},u}function XI(e,...t){const n=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,a=(...l)=>{let o=0,u=0,d,f={},p=l.pop();typeof p=="object"&&(f=p,p=l.pop()),FI(p,`createSelector expects an output function after the inputs, but received: [${typeof p}]`);const h={...n,...f},{memoize:v,memoizeOptions:b=[],argsMemoize:x=xz,argsMemoizeOptions:j=[]}=h,N=RS(b),w=RS(j),C=QI(l),E=v(function(){return o++,p.apply(null,arguments)},...N),S=x(function(){u++;const O=VI(C,arguments);return d=E.apply(null,O),d},...w);return Object.assign(S,{resultFunc:p,memoizedResultFunc:E,dependencies:C,dependencyRecomputations:()=>u,resetDependencyRecomputations:()=>{u=0},lastResult:()=>d,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:v,argsMemoize:x})};return Object.assign(a,{withTypes:()=>a}),a}var de=XI(xz),ZI=Object.assign((e,t=de)=>{GI(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const n=Object.keys(e),a=n.map(o=>e[o]);return t(a,(...o)=>o.reduce((u,d,f)=>(u[n[f]]=d,u),{}))},{withTypes:()=>ZI}),Eg={},Ag={},zg={},LS;function JI(){return LS||(LS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(a){return typeof a=="symbol"?1:a===null?2:a===void 0?3:a!==a?4:0}const n=(a,l,o)=>{if(a!==l){const u=t(a),d=t(l);if(u===d&&u===0){if(a<l)return o==="desc"?1:-1;if(a>l)return o==="desc"?-1:1}return o==="desc"?d-u:u-d}return 0};e.compareValues=n})(zg)),zg}var kg={},Og={},$S;function bz(){return $S||($S=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"||n instanceof Symbol}e.isSymbol=t})(Og)),Og}var BS;function e4(){return BS||(BS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bz(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function l(o,u){return Array.isArray(o)?!1:typeof o=="number"||typeof o=="boolean"||o==null||t.isSymbol(o)?!0:typeof o=="string"&&(a.test(o)||!n.test(o))||u!=null&&Object.hasOwn(u,o)}e.isKey=l})(kg)),kg}var US;function t4(){return US||(US=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=JI(),n=e4(),a=Hb();function l(o,u,d,f){if(o==null)return[];d=f?void 0:d,Array.isArray(o)||(o=Object.values(o)),Array.isArray(u)||(u=u==null?[null]:[u]),u.length===0&&(u=[null]),Array.isArray(d)||(d=d==null?[]:[d]),d=d.map(x=>String(x));const p=(x,j)=>{let N=x;for(let w=0;w<j.length&&N!=null;++w)N=N[j[w]];return N},h=(x,j)=>j==null||x==null?j:typeof x=="object"&&"key"in x?Object.hasOwn(j,x.key)?j[x.key]:p(j,x.path):typeof x=="function"?x(j):Array.isArray(x)?p(j,x):typeof j=="object"?j[x]:j,v=u.map(x=>(Array.isArray(x)&&x.length===1&&(x=x[0]),x==null||typeof x=="function"||Array.isArray(x)||n.isKey(x)?x:{key:x,path:a.toPath(x)}));return o.map(x=>({original:x,criteria:v.map(j=>h(j,x))})).slice().sort((x,j)=>{for(let N=0;N<v.length;N++){const w=t.compareValues(x.criteria[N],j.criteria[N],d[N]);if(w!==0)return w}return 0}).map(x=>x.original)}e.orderBy=l})(Ag)),Ag}var Dg={},FS;function r4(){return FS||(FS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a=1){const l=[],o=Math.floor(a),u=(d,f)=>{for(let p=0;p<d.length;p++){const h=d[p];Array.isArray(h)&&f<o?u(h,f+1):l.push(h)}};return u(n,0),l}e.flatten=t})(Dg)),Dg}var Mg={},GS;function yz(){return GS||(GS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gz(),n=Kb(),a=dz(),l=fz();function o(u,d,f){return a.isObject(f)&&(typeof d=="number"&&n.isArrayLike(f)&&t.isIndex(d)&&d<f.length||typeof d=="string"&&d in f)?l.isEqualsSameValueZero(f[d],u):!1}e.isIterateeCall=o})(Mg)),Mg}var HS;function n4(){return HS||(HS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=t4(),n=r4(),a=yz();function l(o,...u){const d=u.length;return d>1&&a.isIterateeCall(o,u[0],u[1])?u=[]:d>2&&a.isIterateeCall(u[0],u[1],u[2])&&(u=[u[0]]),t.orderBy(o,n.flatten(u),["asc"])}e.sortBy=l})(Eg)),Eg}var Pg,QS;function a4(){return QS||(QS=1,Pg=n4().sortBy),Pg}var i4=a4();const _f=ni(i4);var jz=e=>e.legend.settings,s4=e=>e.legend.size,l4=e=>e.legend.payload;de([l4,jz],(e,t)=>{var{itemSorter:n}=t,a=e.flat(1);return n?_f(a,n):a});var Ld=1;function o4(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,n]=g.useState({height:0,left:0,top:0,width:0}),a=g.useCallback(l=>{if(l!=null){var o=l.getBoundingClientRect(),u={height:o.height,left:o.left,top:o.top,width:o.width};(Math.abs(u.height-t.height)>Ld||Math.abs(u.left-t.left)>Ld||Math.abs(u.top-t.top)>Ld||Math.abs(u.width-t.width)>Ld)&&n({height:u.height,left:u.left,top:u.top,width:u.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,a]}function wr(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var c4=typeof Symbol=="function"&&Symbol.observable||"@@observable",VS=c4,Tg=()=>Math.random().toString(36).substring(7).split("").join("."),u4={INIT:`@@redux/INIT${Tg()}`,REPLACE:`@@redux/REPLACE${Tg()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Tg()}`},Nm=u4;function Zb(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Nz(e,t,n){if(typeof e!="function")throw new Error(wr(2));if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(wr(0));if(typeof t=="function"&&typeof n>"u"&&(n=t,t=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(wr(1));return n(Nz)(e,t)}let a=e,l=t,o=new Map,u=o,d=0,f=!1;function p(){u===o&&(u=new Map,o.forEach((w,C)=>{u.set(C,w)}))}function h(){if(f)throw new Error(wr(3));return l}function v(w){if(typeof w!="function")throw new Error(wr(4));if(f)throw new Error(wr(5));let C=!0;p();const E=d++;return u.set(E,w),function(){if(C){if(f)throw new Error(wr(6));C=!1,p(),u.delete(E),o=null}}}function b(w){if(!Zb(w))throw new Error(wr(7));if(typeof w.type>"u")throw new Error(wr(8));if(typeof w.type!="string")throw new Error(wr(17));if(f)throw new Error(wr(9));try{f=!0,l=a(l,w)}finally{f=!1}return(o=u).forEach(E=>{E()}),w}function x(w){if(typeof w!="function")throw new Error(wr(10));a=w,b({type:Nm.REPLACE})}function j(){const w=v;return{subscribe(C){if(typeof C!="object"||C===null)throw new Error(wr(11));function E(){const A=C;A.next&&A.next(h())}return E(),{unsubscribe:w(E)}},[VS](){return this}}}return b({type:Nm.INIT}),{dispatch:b,subscribe:v,getState:h,replaceReducer:x,[VS]:j}}function d4(e){Object.keys(e).forEach(t=>{const n=e[t];if(typeof n(void 0,{type:Nm.INIT})>"u")throw new Error(wr(12));if(typeof n(void 0,{type:Nm.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(wr(13))})}function _z(e){const t=Object.keys(e),n={};for(let o=0;o<t.length;o++){const u=t[o];typeof e[u]=="function"&&(n[u]=e[u])}const a=Object.keys(n);let l;try{d4(n)}catch(o){l=o}return function(u={},d){if(l)throw l;let f=!1;const p={};for(let h=0;h<a.length;h++){const v=a[h],b=n[v],x=u[v],j=b(x,d);if(typeof j>"u")throw d&&d.type,new Error(wr(14));p[v]=j,f=f||j!==x}return f=f||a.length!==Object.keys(u).length,f?p:u}}function _m(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,n)=>(...a)=>t(n(...a)))}function m4(...e){return t=>(n,a)=>{const l=t(n,a);let o=()=>{throw new Error(wr(15))};const u={getState:l.getState,dispatch:(f,...p)=>o(f,...p)},d=e.map(f=>f(u));return o=_m(...d)(l.dispatch),{...l,dispatch:o}}}function Sz(e){return Zb(e)&&"type"in e&&typeof e.type=="string"}var wz=Symbol.for("immer-nothing"),YS=Symbol.for("immer-draftable"),Br=Symbol.for("immer-state");function Qn(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var hn=Object,co=hn.getPrototypeOf,Sm="constructor",Sf="prototype",Tx="configurable",wm="enumerable",sm="writable",Bc="value",Wa=e=>!!e&&!!e[Br];function Zn(e){return e?Cz(e)||Cf(e)||!!e[YS]||!!e[Sm]?.[YS]||Ef(e)||Af(e):!1}var f4=hn[Sf][Sm].toString(),KS=new WeakMap;function Cz(e){if(!e||!Jb(e))return!1;const t=co(e);if(t===null||t===hn[Sf])return!0;const n=hn.hasOwnProperty.call(t,Sm)&&t[Sm];if(n===Object)return!0;if(!Zl(n))return!1;let a=KS.get(n);return a===void 0&&(a=Function.toString.call(n),KS.set(n,a)),a===f4}function wf(e,t,n=!0){su(e)===0?(n?Reflect.ownKeys(e):hn.keys(e)).forEach(l=>{t(l,e[l],e)}):e.forEach((a,l)=>t(l,a,e))}function su(e){const t=e[Br];return t?t.type_:Cf(e)?1:Ef(e)?2:Af(e)?3:0}var WS=(e,t,n=su(e))=>n===2?e.has(t):hn[Sf].hasOwnProperty.call(e,t),qx=(e,t,n=su(e))=>n===2?e.get(t):e[t],Cm=(e,t,n,a=su(e))=>{a===2?e.set(t,n):a===3?e.add(n):e[t]=n};function p4(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var Cf=Array.isArray,Ef=e=>e instanceof Map,Af=e=>e instanceof Set,Jb=e=>typeof e=="object",Zl=e=>typeof e=="function",qg=e=>typeof e=="boolean";function h4(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var Ua=e=>e.copy_||e.base_,ey=e=>e.modified_?e.copy_:e.base_;function Rx(e,t){if(Ef(e))return new Map(e);if(Af(e))return new Set(e);if(Cf(e))return Array[Sf].slice.call(e);const n=Cz(e);if(t===!0||t==="class_only"&&!n){const a=hn.getOwnPropertyDescriptors(e);delete a[Br];let l=Reflect.ownKeys(a);for(let o=0;o<l.length;o++){const u=l[o],d=a[u];d[sm]===!1&&(d[sm]=!0,d[Tx]=!0),(d.get||d.set)&&(a[u]={[Tx]:!0,[sm]:!0,[wm]:d[wm],[Bc]:e[u]})}return hn.create(co(e),a)}else{const a=co(e);if(a!==null&&n)return{...e};const l=hn.create(a);return hn.assign(l,e)}}function ty(e,t=!1){return zf(e)||Wa(e)||!Zn(e)||(su(e)>1&&hn.defineProperties(e,{set:$d,add:$d,clear:$d,delete:$d}),hn.freeze(e),t&&wf(e,(n,a)=>{ty(a,!0)},!1)),e}function v4(){Qn(2)}var $d={[Bc]:v4};function zf(e){return e===null||!Jb(e)?!0:hn.isFrozen(e)}var Em="MapSet",Ix="Patches",XS="ArrayMethods",Ez={};function Bs(e){const t=Ez[e];return t||Qn(0,e),t}var ZS=e=>!!Ez[e],Uc,Az=()=>Uc,g4=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:ZS(Em)?Bs(Em):void 0,arrayMethodsPlugin_:ZS(XS)?Bs(XS):void 0});function JS(e,t){t&&(e.patchPlugin_=Bs(Ix),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Lx(e){$x(e),e.drafts_.forEach(x4),e.drafts_=null}function $x(e){e===Uc&&(Uc=e.parent_)}var ew=e=>Uc=g4(Uc,e);function x4(e){const t=e[Br];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function tw(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];if(e!==void 0&&e!==n){n[Br].modified_&&(Lx(t),Qn(4)),Zn(e)&&(e=rw(t,e));const{patchPlugin_:l}=t;l&&l.generateReplacementPatches_(n[Br].base_,e,t)}else e=rw(t,n);return b4(t,e,!0),Lx(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==wz?e:void 0}function rw(e,t){if(zf(t))return t;const n=t[Br];if(!n)return Am(t,e.handledSet_,e);if(!kf(n,e))return t;if(!n.modified_)return n.base_;if(!n.finalized_){const{callbacks_:a}=n;if(a)for(;a.length>0;)a.pop()(e);Oz(n,e)}return n.copy_}function b4(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&ty(t,n)}function zz(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var kf=(e,t)=>e.scope_===t,y4=[];function kz(e,t,n,a){const l=Ua(e),o=e.type_;if(a!==void 0&&qx(l,a,o)===t){Cm(l,a,n,o);return}if(!e.draftLocations_){const d=e.draftLocations_=new Map;wf(l,(f,p)=>{if(Wa(p)){const h=d.get(p)||[];h.push(f),d.set(p,h)}})}const u=e.draftLocations_.get(t)??y4;for(const d of u)Cm(l,d,n,o)}function j4(e,t,n){e.callbacks_.push(function(l){const o=t;if(!o||!kf(o,l))return;l.mapSetPlugin_?.fixSetContents(o);const u=ey(o);kz(e,o.draft_??o,u,n),Oz(o,l)})}function Oz(e,t){if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){const{patchPlugin_:a}=t;if(a){const l=a.getPath(e);l&&a.generatePatches_(e,l,t)}zz(e)}}function N4(e,t,n){const{scope_:a}=e;if(Wa(n)){const l=n[Br];kf(l,a)&&l.callbacks_.push(function(){lm(e);const u=ey(l);kz(e,n,u,t)})}else Zn(n)&&e.callbacks_.push(function(){const o=Ua(e);e.type_===3?o.has(n)&&Am(n,a.handledSet_,a):qx(o,t,e.type_)===n&&a.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&Am(qx(e.copy_,t,e.type_),a.handledSet_,a)})}function Am(e,t,n){return!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||Wa(e)||t.has(e)||!Zn(e)||zf(e)||(t.add(e),wf(e,(a,l)=>{if(Wa(l)){const o=l[Br];if(kf(o,n)){const u=ey(o);Cm(e,a,u,e.type_),zz(o)}}else Zn(l)&&Am(l,t,n)})),e}function _4(e,t){const n=Cf(e),a={type_:n?1:0,scope_:t?t.scope_:Az(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let l=a,o=zm;n&&(l=[a],o=Fc);const{revoke:u,proxy:d}=Proxy.revocable(l,o);return a.draft_=d,a.revoke_=u,[d,a]}var zm={get(e,t){if(t===Br)return e;let n=e.scope_.arrayMethodsPlugin_;const a=e.type_===1&&typeof t=="string";if(a&&n?.isArrayOperationMethod(t))return n.createMethodInterceptor(e,t);const l=Ua(e);if(!WS(l,t,e.type_))return S4(e,l,t);const o=l[t];if(e.finalized_||!Zn(o)||a&&e.operationMethod&&n?.isMutatingArrayMethod(e.operationMethod)&&h4(t))return o;if(o===Rg(e.base_,t)){lm(e);const u=e.type_===1?+t:t,d=Ux(e.scope_,o,e,u);return e.copy_[u]=d}return o},has(e,t){return t in Ua(e)},ownKeys(e){return Reflect.ownKeys(Ua(e))},set(e,t,n){const a=Dz(Ua(e),t);if(a?.set)return a.set.call(e.draft_,n),!0;if(!e.modified_){const l=Rg(Ua(e),t),o=l?.[Br];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_.set(t,!1),!0;if(p4(n,l)&&(n!==void 0||WS(e.base_,t,e.type_)))return!0;lm(e),Bx(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_.set(t,!0),N4(e,t,n)),!0},deleteProperty(e,t){return lm(e),Rg(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),Bx(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=Ua(e),a=Reflect.getOwnPropertyDescriptor(n,t);return a&&{[sm]:!0,[Tx]:e.type_!==1||t!=="length",[wm]:a[wm],[Bc]:n[t]}},defineProperty(){Qn(11)},getPrototypeOf(e){return co(e.base_)},setPrototypeOf(){Qn(12)}},Fc={};for(let e in zm){let t=zm[e];Fc[e]=function(){const n=arguments;return n[0]=n[0][0],t.apply(this,n)}}Fc.deleteProperty=function(e,t){return Fc.set.call(this,e,t,void 0)};Fc.set=function(e,t,n){return zm.set.call(this,e[0],t,n,e[0])};function Rg(e,t){const n=e[Br];return(n?Ua(n):e)[t]}function S4(e,t,n){const a=Dz(t,n);return a?Bc in a?a[Bc]:a.get?.call(e.draft_):void 0}function Dz(e,t){if(!(t in e))return;let n=co(e);for(;n;){const a=Object.getOwnPropertyDescriptor(n,t);if(a)return a;n=co(n)}}function Bx(e){e.modified_||(e.modified_=!0,e.parent_&&Bx(e.parent_))}function lm(e){e.copy_||(e.assigned_=new Map,e.copy_=Rx(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var w4=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(n,a,l)=>{if(Zl(n)&&!Zl(a)){const u=a;a=n;const d=this;return function(p=u,...h){return d.produce(p,v=>a.call(this,v,...h))}}Zl(a)||Qn(6),l!==void 0&&!Zl(l)&&Qn(7);let o;if(Zn(n)){const u=ew(this),d=Ux(u,n,void 0);let f=!0;try{o=a(d),f=!1}finally{f?Lx(u):$x(u)}return JS(u,l),tw(o,u)}else if(!n||!Jb(n)){if(o=a(n),o===void 0&&(o=n),o===wz&&(o=void 0),this.autoFreeze_&&ty(o,!0),l){const u=[],d=[];Bs(Ix).generateReplacementPatches_(n,o,{patches_:u,inversePatches_:d}),l(u,d)}return o}else Qn(1,n)},this.produceWithPatches=(n,a)=>{if(Zl(n))return(d,...f)=>this.produceWithPatches(d,p=>n(p,...f));let l,o;return[this.produce(n,a,(d,f)=>{l=d,o=f}),l,o]},qg(t?.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),qg(t?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),qg(t?.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Zn(t)||Qn(8),Wa(t)&&(t=Kn(t));const n=ew(this),a=Ux(n,t,void 0);return a[Br].isManual_=!0,$x(n),a}finishDraft(t,n){const a=t&&t[Br];(!a||!a.isManual_)&&Qn(9);const{scope_:l}=a;return JS(l,n),tw(void 0,l)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,n){let a;for(a=n.length-1;a>=0;a--){const o=n[a];if(o.path.length===0&&o.op==="replace"){t=o.value;break}}a>-1&&(n=n.slice(a+1));const l=Bs(Ix).applyPatches_;return Wa(t)?l(t,n):this.produce(t,o=>l(o,n))}};function Ux(e,t,n,a){const[l,o]=Ef(t)?Bs(Em).proxyMap_(t,n):Af(t)?Bs(Em).proxySet_(t,n):_4(t,n);return(n?.scope_??Az()).drafts_.push(l),o.callbacks_=n?.callbacks_??[],o.key_=a,n&&a!==void 0?j4(n,o,a):o.callbacks_.push(function(f){f.mapSetPlugin_?.fixSetContents(o);const{patchPlugin_:p}=f;o.modified_&&p&&p.generatePatches_(o,[],f)}),l}function Kn(e){return Wa(e)||Qn(10,e),Mz(e)}function Mz(e){if(!Zn(e)||zf(e))return e;const t=e[Br];let n,a=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Rx(e,t.scope_.immer_.useStrictShallowCopy_),a=t.scope_.immer_.shouldUseStrictIteration()}else n=Rx(e,!0);return wf(n,(l,o)=>{Cm(n,l,Mz(o))},a),t&&(t.finalized_=!1),n}var C4=new w4,Pz=C4.produce;function Tz(e){return({dispatch:n,getState:a})=>l=>o=>typeof o=="function"?o(n,a,e):l(o)}var E4=Tz(),A4=Tz,z4=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?_m:_m.apply(null,arguments)};function Tn(e,t){function n(...a){if(t){let l=t(...a);if(!l)throw new Error(gn(0));return{type:e,payload:l.payload,..."meta"in l&&{meta:l.meta},..."error"in l&&{error:l.error}}}return{type:e,payload:a[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=a=>Sz(a)&&a.type===e,n}var qz=class Oc extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Oc.prototype)}static get[Symbol.species](){return Oc}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Oc(...t[0].concat(this)):new Oc(...t.concat(this))}};function nw(e){return Zn(e)?Pz(e,()=>{}):e}function Bd(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}function k4(e){return typeof e=="boolean"}var O4=()=>function(t){const{thunk:n=!0,immutableCheck:a=!0,serializableCheck:l=!0,actionCreatorCheck:o=!0}=t??{};let u=new qz;return n&&(k4(n)?u.push(E4):u.push(A4(n.extraArgument))),u},Rz="RTK_autoBatch",Pt=()=>e=>({payload:e,meta:{[Rz]:!0}}),aw=e=>t=>{setTimeout(t,e)},Iz=(e={type:"raf"})=>t=>(...n)=>{const a=t(...n);let l=!0,o=!1,u=!1;const d=new Set,f=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:aw(10):e.type==="callback"?e.queueNotification:aw(e.timeout),p=()=>{u=!1,o&&(o=!1,d.forEach(h=>h()))};return Object.assign({},a,{subscribe(h){const v=()=>l&&h(),b=a.subscribe(v);return d.add(h),()=>{b(),d.delete(h)}},dispatch(h){try{return l=!h?.meta?.[Rz],o=!l,o&&(u||(u=!0,f(p))),a.dispatch(h)}finally{l=!0}}})},D4=e=>function(n){const{autoBatch:a=!0}=n??{};let l=new qz(e);return a&&l.push(Iz(typeof a=="object"?a:void 0)),l};function M4(e){const t=O4(),{reducer:n=void 0,middleware:a,devTools:l=!0,preloadedState:o=void 0,enhancers:u=void 0}=e||{};let d;if(typeof n=="function")d=n;else if(Zb(n))d=_z(n);else throw new Error(gn(1));let f;typeof a=="function"?f=a(t):f=t();let p=_m;l&&(p=z4({trace:!1,...typeof l=="object"&&l}));const h=m4(...f),v=D4(h);let b=typeof u=="function"?u(v):v();const x=p(...b);return Nz(d,o,x)}function Lz(e){const t={},n=[];let a;const l={addCase(o,u){const d=typeof o=="string"?o:o.type;if(!d)throw new Error(gn(28));if(d in t)throw new Error(gn(29));return t[d]=u,l},addAsyncThunk(o,u){return u.pending&&(t[o.pending.type]=u.pending),u.rejected&&(t[o.rejected.type]=u.rejected),u.fulfilled&&(t[o.fulfilled.type]=u.fulfilled),u.settled&&n.push({matcher:o.settled,reducer:u.settled}),l},addMatcher(o,u){return n.push({matcher:o,reducer:u}),l},addDefaultCase(o){return a=o,l}};return e(l),[t,n,a]}function P4(e){return typeof e=="function"}function T4(e,t){let[n,a,l]=Lz(t),o;if(P4(e))o=()=>nw(e());else{const d=nw(e);o=()=>d}function u(d=o(),f){let p=[n[f.type],...a.filter(({matcher:h})=>h(f)).map(({reducer:h})=>h)];return p.filter(h=>!!h).length===0&&(p=[l]),p.reduce((h,v)=>{if(v)if(Wa(h)){const x=v(h,f);return x===void 0?h:x}else{if(Zn(h))return Pz(h,b=>v(b,f));{const b=v(h,f);if(b===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return b}}return h},d)}return u.getInitialState=o,u}var q4="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",R4=(e=21)=>{let t="",n=e;for(;n--;)t+=q4[Math.random()*64|0];return t},I4=Symbol.for("rtk-slice-createasyncthunk");function L4(e,t){return`${e}/${t}`}function $4({creators:e}={}){const t=e?.asyncThunk?.[I4];return function(a){const{name:l,reducerPath:o=l}=a;if(!l)throw new Error(gn(11));const u=(typeof a.reducers=="function"?a.reducers(U4()):a.reducers)||{},d=Object.keys(u),f={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},p={addCase(S,A){const O=typeof S=="string"?S:S.type;if(!O)throw new Error(gn(12));if(O in f.sliceCaseReducersByType)throw new Error(gn(13));return f.sliceCaseReducersByType[O]=A,p},addMatcher(S,A){return f.sliceMatchers.push({matcher:S,reducer:A}),p},exposeAction(S,A){return f.actionCreators[S]=A,p},exposeCaseReducer(S,A){return f.sliceCaseReducersByName[S]=A,p}};d.forEach(S=>{const A=u[S],O={reducerName:S,type:L4(l,S),createNotation:typeof a.reducers=="function"};G4(A)?Q4(O,A,p,t):F4(O,A,p)});function h(){const[S={},A=[],O=void 0]=typeof a.extraReducers=="function"?Lz(a.extraReducers):[a.extraReducers],k={...S,...f.sliceCaseReducersByType};return T4(a.initialState,M=>{for(let D in k)M.addCase(D,k[D]);for(let D of f.sliceMatchers)M.addMatcher(D.matcher,D.reducer);for(let D of A)M.addMatcher(D.matcher,D.reducer);O&&M.addDefaultCase(O)})}const v=S=>S,b=new Map,x=new WeakMap;let j;function N(S,A){return j||(j=h()),j(S,A)}function w(){return j||(j=h()),j.getInitialState()}function C(S,A=!1){function O(M){let D=M[S];return typeof D>"u"&&A&&(D=Bd(x,O,w)),D}function k(M=v){const D=Bd(b,A,()=>new WeakMap);return Bd(D,M,()=>{const $={};for(const[U,L]of Object.entries(a.selectors??{}))$[U]=B4(L,M,()=>Bd(x,M,w),A);return $})}return{reducerPath:S,getSelectors:k,get selectors(){return k(O)},selectSlice:O}}const E={name:l,reducer:N,actions:f.actionCreators,caseReducers:f.sliceCaseReducersByName,getInitialState:w,...C(o),injectInto(S,{reducerPath:A,...O}={}){const k=A??o;return S.inject({reducerPath:k,reducer:N},O),{...E,...C(k,!0)}}};return E}}function B4(e,t,n,a){function l(o,...u){let d=t(o);return typeof d>"u"&&a&&(d=n()),e(d,...u)}return l.unwrapped=e,l}var nn=$4();function U4(){function e(t,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...n}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...n){return t(...n)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:n}},asyncThunk:e}}function F4({type:e,reducerName:t,createNotation:n},a,l){let o,u;if("reducer"in a){if(n&&!H4(a))throw new Error(gn(17));o=a.reducer,u=a.prepare}else o=a;l.addCase(e,o).exposeCaseReducer(t,o).exposeAction(t,u?Tn(e,u):Tn(e))}function G4(e){return e._reducerDefinitionType==="asyncThunk"}function H4(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Q4({type:e,reducerName:t},n,a,l){if(!l)throw new Error(gn(18));const{payloadCreator:o,fulfilled:u,pending:d,rejected:f,settled:p,options:h}=n,v=l(e,o,h);a.exposeAction(t,v),u&&a.addCase(v.fulfilled,u),d&&a.addCase(v.pending,d),f&&a.addCase(v.rejected,f),p&&a.addMatcher(v.settled,p),a.exposeCaseReducer(t,{fulfilled:u||Ud,pending:d||Ud,rejected:f||Ud,settled:p||Ud})}function Ud(){}var V4="task",$z="listener",Bz="completed",ry="cancelled",Y4=`task-${ry}`,K4=`task-${Bz}`,Fx=`${$z}-${ry}`,W4=`${$z}-${Bz}`,Of=class{constructor(e){this.code=e,this.message=`${V4} ${ry} (reason: ${e})`}name="TaskAbortError";message},ny=(e,t)=>{if(typeof e!="function")throw new TypeError(gn(32))},km=()=>{},Uz=(e,t=km)=>(e.catch(t),e),Fz=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),qs=e=>{if(e.aborted)throw new Of(e.reason)};function Gz(e,t){let n=km;return new Promise((a,l)=>{const o=()=>l(new Of(e.reason));if(e.aborted){o();return}n=Fz(e,o),t.finally(()=>n()).then(a,l)}).finally(()=>{n=km})}var X4=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof Of?"cancelled":"rejected",error:n}}finally{t?.()}},Om=e=>t=>Uz(Gz(e,t).then(n=>(qs(e),n))),Hz=e=>{const t=Om(e);return n=>t(new Promise(a=>setTimeout(a,n)))},{assign:ao}=Object,iw={},Df="listenerMiddleware",Z4=(e,t)=>{const n=a=>Fz(e,()=>a.abort(e.reason));return(a,l)=>{ny(a);const o=new AbortController;n(o);const u=X4(async()=>{qs(e),qs(o.signal);const d=await a({pause:Om(o.signal),delay:Hz(o.signal),signal:o.signal});return qs(o.signal),d},()=>o.abort(K4));return l?.autoJoin&&t.push(u.catch(km)),{result:Om(e)(u),cancel(){o.abort(Y4)}}}},J4=(e,t)=>{const n=async(a,l)=>{qs(t);let o=()=>{};const d=[new Promise((f,p)=>{let h=e({predicate:a,effect:(v,b)=>{b.unsubscribe(),f([v,b.getState(),b.getOriginalState()])}});o=()=>{h(),p()}})];l!=null&&d.push(new Promise(f=>setTimeout(f,l,null)));try{const f=await Gz(t,Promise.race(d));return qs(t),f}finally{o()}};return(a,l)=>Uz(n(a,l))},Qz=e=>{let{type:t,actionCreator:n,matcher:a,predicate:l,effect:o}=e;if(t)l=Tn(t).match;else if(n)t=n.type,l=n.match;else if(a)l=a;else if(!l)throw new Error(gn(21));return ny(o),{predicate:l,type:t,effect:o}},Vz=ao(e=>{const{type:t,predicate:n,effect:a}=Qz(e);return{id:R4(),effect:a,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(gn(22))}}},{withTypes:()=>Vz}),sw=(e,t)=>{const{type:n,effect:a,predicate:l}=Qz(t);return Array.from(e.values()).find(o=>(typeof n=="string"?o.type===n:o.predicate===l)&&o.effect===a)},Gx=e=>{e.pending.forEach(t=>{t.abort(Fx)})},eL=(e,t)=>()=>{for(const n of t.keys())Gx(n);e.clear()},lw=(e,t,n)=>{try{e(t,n)}catch(a){setTimeout(()=>{throw a},0)}},Yz=ao(Tn(`${Df}/add`),{withTypes:()=>Yz}),tL=Tn(`${Df}/removeAll`),Kz=ao(Tn(`${Df}/remove`),{withTypes:()=>Kz}),rL=(...e)=>{console.error(`${Df}/error`,...e)},lu=(e={})=>{const t=new Map,n=new Map,a=x=>{const j=n.get(x)??0;n.set(x,j+1)},l=x=>{const j=n.get(x)??1;j===1?n.delete(x):n.set(x,j-1)},{extra:o,onError:u=rL}=e;ny(u);const d=x=>(x.unsubscribe=()=>t.delete(x.id),t.set(x.id,x),j=>{x.unsubscribe(),j?.cancelActive&&Gx(x)}),f=x=>{const j=sw(t,x)??Vz(x);return d(j)};ao(f,{withTypes:()=>f});const p=x=>{const j=sw(t,x);return j&&(j.unsubscribe(),x.cancelActive&&Gx(j)),!!j};ao(p,{withTypes:()=>p});const h=async(x,j,N,w)=>{const C=new AbortController,E=J4(f,C.signal),S=[];try{x.pending.add(C),a(x),await Promise.resolve(x.effect(j,ao({},N,{getOriginalState:w,condition:(A,O)=>E(A,O).then(Boolean),take:E,delay:Hz(C.signal),pause:Om(C.signal),extra:o,signal:C.signal,fork:Z4(C.signal,S),unsubscribe:x.unsubscribe,subscribe:()=>{t.set(x.id,x)},cancelActiveListeners:()=>{x.pending.forEach((A,O,k)=>{A!==C&&(A.abort(Fx),k.delete(A))})},cancel:()=>{C.abort(Fx),x.pending.delete(C)},throwIfCancelled:()=>{qs(C.signal)}})))}catch(A){A instanceof Of||lw(u,A,{raisedBy:"effect"})}finally{await Promise.all(S),C.abort(W4),l(x),x.pending.delete(C)}},v=eL(t,n);return{middleware:x=>j=>N=>{if(!Sz(N))return j(N);if(Yz.match(N))return f(N.payload);if(tL.match(N)){v();return}if(Kz.match(N))return p(N.payload);let w=x.getState();const C=()=>{if(w===iw)throw new Error(gn(23));return w};let E;try{if(E=j(N),t.size>0){const S=x.getState(),A=Array.from(t.values());for(const O of A){let k=!1;try{k=O.predicate(N,S,w)}catch(M){k=!1,lw(u,M,{raisedBy:"predicate"})}k&&h(O,N,x,C)}}}finally{w=iw}return E},startListening:f,stopListening:p,clearListeners:v}};function gn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var nL={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},Wz=nn({name:"chartLayout",initialState:nL,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var n,a,l,o;e.margin.top=(n=t.payload.top)!==null&&n!==void 0?n:0,e.margin.right=(a=t.payload.right)!==null&&a!==void 0?a:0,e.margin.bottom=(l=t.payload.bottom)!==null&&l!==void 0?l:0,e.margin.left=(o=t.payload.left)!==null&&o!==void 0?o:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:aL,setLayout:iL,setChartSize:sL,setScale:lL}=Wz.actions,oL=Wz.reducer;function Xz(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function st(e){return Number.isFinite(e)}function ba(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function ow(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function to(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ow(Object(n),!0).forEach(function(a){cL(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ow(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function cL(e,t,n){return(t=uL(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uL(e){var t=dL(e,"string");return typeof t=="symbol"?t:t+""}function dL(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jt(e,t,n){return Rt(e)||Rt(t)?n:xa(t)?oo(e,t,n):typeof t=="function"?t(e):n}var mL=(e,t,n)=>{if(t&&n){var{width:a,height:l}=n,{align:o,verticalAlign:u,layout:d}=t;if((d==="vertical"||d==="horizontal"&&u==="middle")&&o!=="center"&&De(e[o]))return to(to({},e),{},{[o]:e[o]+(a||0)});if((d==="horizontal"||d==="vertical"&&o==="center")&&u!=="middle"&&De(e[u]))return to(to({},e),{},{[u]:e[u]+(l||0)})}return e},ai=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",Zz=(e,t,n,a)=>{if(a)return e.map(d=>d.coordinate);var l,o,u=e.map(d=>(d.coordinate===t&&(l=!0),d.coordinate===n&&(o=!0),d.coordinate));return l||u.push(t),o||u.push(n),u},Jz=(e,t,n)=>{if(!e)return null;var{duplicateDomain:a,type:l,range:o,scale:u,realScaleType:d,isCategorical:f,categoricalDomain:p,tickCount:h,ticks:v,niceTicks:b,axisType:x}=e;if(!u)return null;var j=d==="scaleBand"&&u.bandwidth?u.bandwidth()/2:2,N=l==="category"&&u.bandwidth?u.bandwidth()/j:0;if(N=x==="angleAxis"&&o&&o.length>=2?Jr(o[0]-o[1])*2*N:N,v||b){var w=(v||b||[]).map((C,E)=>{var S=a?a.indexOf(C):C,A=u.map(S);return st(A)?{coordinate:A+N,value:C,offset:N,index:E}:null}).filter(en);return w}return f&&p?p.map((C,E)=>{var S=u.map(C);return st(S)?{coordinate:S+N,value:C,index:E,offset:N}:null}).filter(en):u.ticks&&h!=null?u.ticks(h).map((C,E)=>{var S=u.map(C);return st(S)?{coordinate:S+N,value:C,index:E,offset:N}:null}).filter(en):u.domain().map((C,E)=>{var S=u.map(C);return st(S)?{coordinate:S+N,value:a?a[C]:C,index:E,offset:N}:null}).filter(en)},fL=(e,t)=>{if(!t||t.length!==2||!De(t[0])||!De(t[1]))return e;var n=Math.min(t[0],t[1]),a=Math.max(t[0],t[1]),l=[e[0],e[1]];return(!De(e[0])||e[0]<n)&&(l[0]=n),(!De(e[1])||e[1]>a)&&(l[1]=a),l[0]>a&&(l[0]=a),l[1]<n&&(l[1]=n),l},pL=e=>{var t,n=e.length;if(!(n<=0)){var a=(t=e[0])===null||t===void 0?void 0:t.length;if(!(a==null||a<=0))for(var l=0;l<a;++l)for(var o=0,u=0,d=0;d<n;++d){var f=e[d],p=f?.[l];if(p!=null){var h=p[1],v=p[0],b=ga(h)?v:h;b>=0?(p[0]=o,o+=b,p[1]=o):(p[0]=u,u+=b,p[1]=u)}}}},hL=e=>{var t,n=e.length;if(!(n<=0)){var a=(t=e[0])===null||t===void 0?void 0:t.length;if(!(a==null||a<=0))for(var l=0;l<a;++l)for(var o=0,u=0;u<n;++u){var d=e[u],f=d?.[l];if(f!=null){var p=ga(f[1])?f[0]:f[1];p>=0?(f[0]=o,o+=p,f[1]=o):(f[0]=0,f[1]=0)}}}},vL={sign:pL,expand:G6,none:Ls,silhouette:H6,wiggle:Q6,positive:hL},gL=(e,t,n)=>{var a,l=(a=vL[n])!==null&&a!==void 0?a:Ls,o=F6().keys(t).value((d,f)=>Number(Jt(d,f,0))).order(Mx).offset(l),u=o(e);return u.forEach((d,f)=>{d.forEach((p,h)=>{var v=Jt(e[h],t[f],0);Array.isArray(v)&&v.length===2&&De(v[0])&&De(v[1])&&(p[0]=v[0],p[1]=v[1])})}),u};function xL(e){return e==null?void 0:String(e)}function cw(e){var{axis:t,ticks:n,bandSize:a,entry:l,index:o,dataKey:u}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Rt(l[t.dataKey])){var d=sz(n,"value",l[t.dataKey]);if(d)return d.coordinate+a/2}return n!=null&&n[o]?n[o].coordinate+a/2:null}var f=Jt(l,Rt(u)?t.dataKey:u),p=t.scale.map(f);return De(p)?p:null}var uw=e=>{var{axis:t,ticks:n,offset:a,bandSize:l,entry:o,index:u}=e;if(t.type==="category")return n[u]?n[u].coordinate+a:null;var d=Jt(o,t.dataKey,t.scale.domain()[u]);if(Rt(d))return null;var f=t.scale.map(d);return De(f)?f-l/2+a:null},bL=e=>{var{numericAxis:t}=e,n=t.scale.domain();if(t.type==="number"){var a=Math.min(n[0],n[1]),l=Math.max(n[0],n[1]);return a<=0&&l>=0?0:l<0?l:a}return n[0]},yL=e=>{var t=e.flat(2).filter(De);return[Math.min(...t),Math.max(...t)]},jL=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],NL=(e,t,n)=>{if(e!=null)return jL(Object.keys(e).reduce((a,l)=>{var o=e[l];if(!o)return a;var{stackedData:u}=o,d=u.reduce((f,p)=>{var h=Xz(p,t,n),v=yL(h);return!st(v[0])||!st(v[1])?f:[Math.min(f[0],v[0]),Math.max(f[1],v[1])]},[1/0,-1/0]);return[Math.min(d[0],a[0]),Math.max(d[1],a[1])]},[1/0,-1/0]))},dw=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,mw=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,uo=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var a=e.scale.bandwidth();if(!n||a>0)return a}if(e&&t&&t.length>=2){for(var l=_f(t,h=>h.coordinate),o=1/0,u=1,d=l.length;u<d;u++){var f=l[u],p=l[u-1];o=Math.min((f?.coordinate||0)-(p?.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0};function fw(e){var{tooltipEntrySettings:t,dataKey:n,payload:a,value:l,name:o}=e;return to(to({},t),{},{dataKey:n,payload:a,value:l,name:o})}function Mf(e,t){if(e)return String(e);if(typeof t=="string")return t}var _L=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},SL=(e,t)=>t==="centric"?e.angle:e.radius,ii=e=>e.layout.width,si=e=>e.layout.height,wL=e=>e.layout.scale,ek=e=>e.layout.margin,Pf=de(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Tf=de(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),CL="data-recharts-item-index",EL="data-recharts-item-id",ou=60;function pw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Fd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pw(Object(n),!0).forEach(function(a){AL(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function AL(e,t,n){return(t=zL(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zL(e){var t=kL(e,"string");return typeof t=="symbol"?t:t+""}function kL(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OL=e=>e.brush.height;function DL(e){var t=Tf(e);return t.reduce((n,a)=>{if(a.orientation==="left"&&!a.mirror&&!a.hide){var l=typeof a.width=="number"?a.width:ou;return n+l}return n},0)}function ML(e){var t=Tf(e);return t.reduce((n,a)=>{if(a.orientation==="right"&&!a.mirror&&!a.hide){var l=typeof a.width=="number"?a.width:ou;return n+l}return n},0)}function PL(e){var t=Pf(e);return t.reduce((n,a)=>a.orientation==="top"&&!a.mirror&&!a.hide?n+a.height:n,0)}function TL(e){var t=Pf(e);return t.reduce((n,a)=>a.orientation==="bottom"&&!a.mirror&&!a.hide?n+a.height:n,0)}var hr=de([ii,si,ek,OL,DL,ML,PL,TL,jz,s4],(e,t,n,a,l,o,u,d,f,p)=>{var h={left:(n.left||0)+l,right:(n.right||0)+o},v={top:(n.top||0)+u,bottom:(n.bottom||0)+d},b=Fd(Fd({},v),h),x=b.bottom;b.bottom+=a,b=mL(b,f,p);var j=e-b.left-b.right,N=t-b.top-b.bottom;return Fd(Fd({brushBottom:x},b),{},{width:Math.max(j,0),height:Math.max(N,0)})}),qL=de(hr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),ay=de(ii,si,(e,t)=>({x:0,y:0,width:e,height:t})),RL=g.createContext(null),Mr=()=>g.useContext(RL)!=null,qf=e=>e.brush,Rf=de([qf,hr,ek],(e,t,n)=>({height:e.height,x:De(e.x)?e.x:t.left,y:De(e.y)?e.y:t.top+t.height+t.brushBottom-(n?.bottom||0),width:De(e.width)?e.width:t.width})),Ig={},Lg={},$g={},hw;function IL(){return hw||(hw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a,{signal:l,edges:o}={}){let u,d=null;const f=o!=null&&o.includes("leading"),p=o==null||o.includes("trailing"),h=()=>{d!==null&&(n.apply(u,d),u=void 0,d=null)},v=()=>{p&&h(),N()};let b=null;const x=()=>{b!=null&&clearTimeout(b),b=setTimeout(()=>{b=null,v()},a)},j=()=>{b!==null&&(clearTimeout(b),b=null)},N=()=>{j(),u=void 0,d=null},w=()=>{h()},C=function(...E){if(l?.aborted)return;u=this,d=E;const S=b==null;x(),f&&S&&h()};return C.schedule=x,C.cancel=N,C.flush=w,l?.addEventListener("abort",N,{once:!0}),C}e.debounce=t})($g)),$g}var vw;function LL(){return vw||(vw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=IL();function n(a,l=0,o={}){typeof o!="object"&&(o={});const{leading:u=!1,trailing:d=!0,maxWait:f}=o,p=Array(2);u&&(p[0]="leading"),d&&(p[1]="trailing");let h,v=null;const b=t.debounce(function(...N){h=a.apply(this,N),v=null},l,{edges:p}),x=function(...N){return f!=null&&(v===null&&(v=Date.now()),Date.now()-v>=f)?(h=a.apply(this,N),v=Date.now(),b.cancel(),b.schedule(),h):(b.apply(this,N),h)},j=()=>(b.flush(),h);return x.cancel=b.cancel,x.flush=j,x}e.debounce=n})(Lg)),Lg}var gw;function $L(){return gw||(gw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LL();function n(a,l=0,o={}){const{leading:u=!0,trailing:d=!0}=o;return t.debounce(a,l,{leading:u,maxWait:l,trailing:d})}e.throttle=n})(Ig)),Ig}var Bg,xw;function BL(){return xw||(xw=1,Bg=$L().throttle),Bg}var UL=BL();const FL=ni(UL);var Dm=function(t,n){for(var a=arguments.length,l=new Array(a>2?a-2:0),o=2;o<a;o++)l[o-2]=arguments[o];if(typeof console<"u"&&console.warn&&(n===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(n===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=0;console.warn(n.replace(/%s/g,()=>l[u++]))}},ma={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},tk=(e,t,n)=>{var{width:a=ma.width,height:l=ma.height,aspect:o,maxHeight:u}=n,d=$s(a)?e:Number(a),f=$s(l)?t:Number(l);return o&&o>0&&(d?f=d/o:f&&(d=f*o),u&&f!=null&&f>u&&(f=u)),{calculatedWidth:d,calculatedHeight:f}},GL={width:0,height:0,overflow:"visible"},HL={width:0,overflowX:"visible"},QL={height:0,overflowY:"visible"},VL={},YL=e=>{var{width:t,height:n}=e,a=$s(t),l=$s(n);return a&&l?GL:a?HL:l?QL:VL};function KL(e){var{width:t,height:n,aspect:a}=e,l=t,o=n;return l===void 0&&o===void 0?(l=ma.width,o=ma.height):l===void 0?l=a&&a>0?void 0:ma.width:o===void 0&&(o=a&&a>0?void 0:ma.height),{width:l,height:o}}function Hx(){return Hx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Hx.apply(null,arguments)}function bw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function yw(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bw(Object(n),!0).forEach(function(a){WL(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function WL(e,t,n){return(t=XL(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XL(e){var t=ZL(e,"string");return typeof t=="symbol"?t:t+""}function ZL(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rk=g.createContext(ma.initialDimension);function JL(e){return ba(e.width)&&ba(e.height)}function nk(e){var{children:t,width:n,height:a}=e,l=g.useMemo(()=>({width:n,height:a}),[n,a]);return JL(l)?g.createElement(rk.Provider,{value:l},t):null}var iy=()=>g.useContext(rk),e8=g.forwardRef((e,t)=>{var{aspect:n,initialDimension:a=ma.initialDimension,width:l,height:o,minWidth:u=ma.minWidth,minHeight:d,maxHeight:f,children:p,debounce:h=ma.debounce,id:v,className:b,onResize:x,style:j={}}=e,N=g.useRef(null),w=g.useRef();w.current=x,g.useImperativeHandle(t,()=>N.current);var[C,E]=g.useState({containerWidth:a.width,containerHeight:a.height}),S=g.useCallback((D,$)=>{E(U=>{var L=Math.round(D),B=Math.round($);return U.containerWidth===L&&U.containerHeight===B?U:{containerWidth:L,containerHeight:B}})},[]);g.useEffect(()=>{if(N.current==null||typeof ResizeObserver>"u")return Js;var D=B=>{var ee,se=B[0];if(se!=null){var{width:P,height:q}=se.contentRect;S(P,q),(ee=w.current)===null||ee===void 0||ee.call(w,P,q)}};h>0&&(D=FL(D,h,{trailing:!0,leading:!1}));var $=new ResizeObserver(D),{width:U,height:L}=N.current.getBoundingClientRect();return S(U,L),$.observe(N.current),()=>{$.disconnect()}},[S,h]);var{containerWidth:A,containerHeight:O}=C;Dm(!n||n>0,"The aspect(%s) must be greater than zero.",n);var{calculatedWidth:k,calculatedHeight:M}=tk(A,O,{width:l,height:o,aspect:n,maxHeight:f});return Dm(k!=null&&k>0||M!=null&&M>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,k,M,l,o,u,d,n),g.createElement("div",{id:v?"".concat(v):void 0,className:_t("recharts-responsive-container",b),style:yw(yw({},j),{},{width:l,height:o,minWidth:u,minHeight:d,maxHeight:f}),ref:N},g.createElement("div",{style:YL({width:l,height:o})},g.createElement(nk,{width:k,height:M},p)))}),jw=g.forwardRef((e,t)=>{var n=iy();if(ba(n.width)&&ba(n.height))return e.children;var{width:a,height:l}=KL({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:o,calculatedHeight:u}=tk(void 0,void 0,{width:a,height:l,aspect:e.aspect,maxHeight:e.maxHeight});return De(o)&&De(u)?g.createElement(nk,{width:o,height:u},e.children):g.createElement(e8,Hx({},e,{width:a,height:l,ref:t}))});function sy(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var If=()=>{var e,t=Mr(),n=Ie(qL),a=Ie(Rf),l=(e=Ie(qf))===null||e===void 0?void 0:e.padding;return!t||!a||!l?n:{width:a.width-l.left-l.right,height:a.height-l.top-l.bottom,x:l.left,y:l.top}},t8={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},ak=()=>{var e;return(e=Ie(hr))!==null&&e!==void 0?e:t8},ik=()=>Ie(ii),sk=()=>Ie(si),gt=e=>e.layout.layoutType,el=()=>Ie(gt),lk=()=>{var e=el();if(e==="horizontal"||e==="vertical")return e},ok=e=>{var t=e.layout.layoutType;if(t==="centric"||t==="radial")return t},r8=()=>{var e=el();return e!==void 0},cu=e=>{var t=Vt(),n=Mr(),{width:a,height:l}=e,o=iy(),u=a,d=l;return o&&(u=o.width>0?o.width:a,d=o.height>0?o.height:l),g.useEffect(()=>{!n&&ba(u)&&ba(d)&&t(sL({width:u,height:d}))},[t,n,u,d]),null},ck=Symbol.for("immer-nothing"),Nw=Symbol.for("immer-draftable"),xn=Symbol.for("immer-state");function Vn(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Gc=Object.getPrototypeOf;function mo(e){return!!e&&!!e[xn]}function Us(e){return e?uk(e)||Array.isArray(e)||!!e[Nw]||!!e.constructor?.[Nw]||uu(e)||$f(e):!1}var n8=Object.prototype.constructor.toString(),_w=new WeakMap;function uk(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let a=_w.get(n);return a===void 0&&(a=Function.toString.call(n),_w.set(n,a)),a===n8}function Mm(e,t,n=!0){Lf(e)===0?(n?Reflect.ownKeys(e):Object.keys(e)).forEach(l=>{t(l,e[l],e)}):e.forEach((a,l)=>t(l,a,e))}function Lf(e){const t=e[xn];return t?t.type_:Array.isArray(e)?1:uu(e)?2:$f(e)?3:0}function Qx(e,t){return Lf(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function dk(e,t,n){const a=Lf(e);a===2?e.set(t,n):a===3?e.add(n):e[t]=n}function a8(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function uu(e){return e instanceof Map}function $f(e){return e instanceof Set}function Es(e){return e.copy_||e.base_}function Vx(e,t){if(uu(e))return new Map(e);if($f(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=uk(e);if(t===!0||t==="class_only"&&!n){const a=Object.getOwnPropertyDescriptors(e);delete a[xn];let l=Reflect.ownKeys(a);for(let o=0;o<l.length;o++){const u=l[o],d=a[u];d.writable===!1&&(d.writable=!0,d.configurable=!0),(d.get||d.set)&&(a[u]={configurable:!0,writable:!0,enumerable:d.enumerable,value:e[u]})}return Object.create(Gc(e),a)}else{const a=Gc(e);if(a!==null&&n)return{...e};const l=Object.create(a);return Object.assign(l,e)}}function ly(e,t=!1){return Bf(e)||mo(e)||!Us(e)||(Lf(e)>1&&Object.defineProperties(e,{set:Gd,add:Gd,clear:Gd,delete:Gd}),Object.freeze(e),t&&Object.values(e).forEach(n=>ly(n,!0))),e}function i8(){Vn(2)}var Gd={value:i8};function Bf(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var s8={};function Fs(e){const t=s8[e];return t||Vn(0,e),t}var Hc;function mk(){return Hc}function l8(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Sw(e,t){t&&(Fs("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Yx(e){Kx(e),e.drafts_.forEach(o8),e.drafts_=null}function Kx(e){e===Hc&&(Hc=e.parent_)}function ww(e){return Hc=l8(Hc,e)}function o8(e){const t=e[xn];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Cw(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[xn].modified_&&(Yx(t),Vn(4)),Us(e)&&(e=Pm(t,e),t.parent_||Tm(t,e)),t.patches_&&Fs("Patches").generateReplacementPatches_(n[xn].base_,e,t.patches_,t.inversePatches_)):e=Pm(t,n,[]),Yx(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==ck?e:void 0}function Pm(e,t,n){if(Bf(t))return t;const a=e.immer_.shouldUseStrictIteration(),l=t[xn];if(!l)return Mm(t,(o,u)=>Ew(e,l,t,o,u,n),a),t;if(l.scope_!==e)return t;if(!l.modified_)return Tm(e,l.base_,!0),l.base_;if(!l.finalized_){l.finalized_=!0,l.scope_.unfinalizedDrafts_--;const o=l.copy_;let u=o,d=!1;l.type_===3&&(u=new Set(o),o.clear(),d=!0),Mm(u,(f,p)=>Ew(e,l,o,f,p,n,d),a),Tm(e,o,!1),n&&e.patches_&&Fs("Patches").generatePatches_(l,n,e.patches_,e.inversePatches_)}return l.copy_}function Ew(e,t,n,a,l,o,u){if(l==null||typeof l!="object"&&!u)return;const d=Bf(l);if(!(d&&!u)){if(mo(l)){const f=o&&t&&t.type_!==3&&!Qx(t.assigned_,a)?o.concat(a):void 0,p=Pm(e,l,f);if(dk(n,a,p),mo(p))e.canAutoFreeze_=!1;else return}else u&&n.add(l);if(Us(l)&&!d){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[a]===l&&d)return;Pm(e,l),(!t||!t.scope_.parent_)&&typeof a!="symbol"&&(uu(n)?n.has(a):Object.prototype.propertyIsEnumerable.call(n,a))&&Tm(e,l)}}}function Tm(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&ly(t,n)}function c8(e,t){const n=Array.isArray(e),a={type_:n?1:0,scope_:t?t.scope_:mk(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let l=a,o=oy;n&&(l=[a],o=Qc);const{revoke:u,proxy:d}=Proxy.revocable(l,o);return a.draft_=d,a.revoke_=u,d}var oy={get(e,t){if(t===xn)return e;const n=Es(e);if(!Qx(n,t))return u8(e,n,t);const a=n[t];return e.finalized_||!Us(a)?a:a===Ug(e.base_,t)?(Fg(e),e.copy_[t]=Xx(a,e)):a},has(e,t){return t in Es(e)},ownKeys(e){return Reflect.ownKeys(Es(e))},set(e,t,n){const a=fk(Es(e),t);if(a?.set)return a.set.call(e.draft_,n),!0;if(!e.modified_){const l=Ug(Es(e),t),o=l?.[xn];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(a8(n,l)&&(n!==void 0||Qx(e.base_,t)))return!0;Fg(e),Wx(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Ug(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Fg(e),Wx(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=Es(e),a=Reflect.getOwnPropertyDescriptor(n,t);return a&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:a.enumerable,value:n[t]}},defineProperty(){Vn(11)},getPrototypeOf(e){return Gc(e.base_)},setPrototypeOf(){Vn(12)}},Qc={};Mm(oy,(e,t)=>{Qc[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Qc.deleteProperty=function(e,t){return Qc.set.call(this,e,t,void 0)};Qc.set=function(e,t,n){return oy.set.call(this,e[0],t,n,e[0])};function Ug(e,t){const n=e[xn];return(n?Es(n):e)[t]}function u8(e,t,n){const a=fk(t,n);return a?"value"in a?a.value:a.get?.call(e.draft_):void 0}function fk(e,t){if(!(t in e))return;let n=Gc(e);for(;n;){const a=Object.getOwnPropertyDescriptor(n,t);if(a)return a;n=Gc(n)}}function Wx(e){e.modified_||(e.modified_=!0,e.parent_&&Wx(e.parent_))}function Fg(e){e.copy_||(e.copy_=Vx(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var d8=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,n,a)=>{if(typeof t=="function"&&typeof n!="function"){const o=n;n=t;const u=this;return function(f=o,...p){return u.produce(f,h=>n.call(this,h,...p))}}typeof n!="function"&&Vn(6),a!==void 0&&typeof a!="function"&&Vn(7);let l;if(Us(t)){const o=ww(this),u=Xx(t,void 0);let d=!0;try{l=n(u),d=!1}finally{d?Yx(o):Kx(o)}return Sw(o,a),Cw(l,o)}else if(!t||typeof t!="object"){if(l=n(t),l===void 0&&(l=t),l===ck&&(l=void 0),this.autoFreeze_&&ly(l,!0),a){const o=[],u=[];Fs("Patches").generateReplacementPatches_(t,l,o,u),a(o,u)}return l}else Vn(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(u,...d)=>this.produceWithPatches(u,f=>t(f,...d));let a,l;return[this.produce(t,n,(u,d)=>{a=u,l=d}),a,l]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Us(e)||Vn(8),mo(e)&&(e=m8(e));const t=ww(this),n=Xx(e,void 0);return n[xn].isManual_=!0,Kx(t),n}finishDraft(e,t){const n=e&&e[xn];(!n||!n.isManual_)&&Vn(9);const{scope_:a}=n;return Sw(a,t),Cw(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const l=t[n];if(l.path.length===0&&l.op==="replace"){e=l.value;break}}n>-1&&(t=t.slice(n+1));const a=Fs("Patches").applyPatches_;return mo(e)?a(e,t):this.produce(e,l=>a(l,t))}};function Xx(e,t){const n=uu(e)?Fs("MapSet").proxyMap_(e,t):$f(e)?Fs("MapSet").proxySet_(e,t):c8(e,t);return(t?t.scope_:mk()).drafts_.push(n),n}function m8(e){return mo(e)||Vn(10,e),pk(e)}function pk(e){if(!Us(e)||Bf(e))return e;const t=e[xn];let n,a=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Vx(e,t.scope_.immer_.useStrictShallowCopy_),a=t.scope_.immer_.shouldUseStrictIteration()}else n=Vx(e,!0);return Mm(n,(l,o)=>{dk(n,l,pk(o))},a),t&&(t.finalized_=!1),n}var f8=new d8;f8.produce;var p8={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},hk=nn({name:"legend",initialState:p8,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Pt()},replaceLegendPayload:{reducer(e,t){var{prev:n,next:a}=t.payload,l=Kn(e).payload.indexOf(n);l>-1&&(e.payload[l]=a)},prepare:Pt()},removeLegendPayload:{reducer(e,t){var n=Kn(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)},prepare:Pt()}}}),{setLegendSize:rte,setLegendSettings:nte,addLegendPayload:h8,replaceLegendPayload:v8,removeLegendPayload:g8}=hk.actions,x8=hk.reducer;function Zx(){return Zx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Zx.apply(null,arguments)}function Aw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function xc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Aw(Object(n),!0).forEach(function(a){b8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Aw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function b8(e,t,n){return(t=y8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y8(e){var t=j8(e,"string");return typeof t=="symbol"?t:t+""}function j8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function N8(e){return Array.isArray(e)&&xa(e[0])&&xa(e[1])?e.join(" ~ "):e}var Ql={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},_8=e=>{var{separator:t=Ql.separator,contentStyle:n,itemStyle:a,labelStyle:l=Ql.labelStyle,payload:o,formatter:u,itemSorter:d,wrapperClassName:f,labelClassName:p,label:h,labelFormatter:v,accessibilityLayer:b=Ql.accessibilityLayer}=e,x=()=>{if(o&&o.length){var O={padding:0,margin:0},k=(d?_f(o,d):o).map((M,D)=>{if(M.type==="none")return null;var $=M.formatter||u||N8,{value:U,name:L}=M,B=U,ee=L;if($){var se=$(U,L,M,D,o);if(Array.isArray(se))[B,ee]=se;else if(se!=null)B=se;else return null}var P=xc(xc({},Ql.itemStyle),{},{color:M.color||Ql.itemStyle.color},a);return g.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(D),style:P},xa(ee)?g.createElement("span",{className:"recharts-tooltip-item-name"},ee):null,xa(ee)?g.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,g.createElement("span",{className:"recharts-tooltip-item-value"},B),g.createElement("span",{className:"recharts-tooltip-item-unit"},M.unit||""))});return g.createElement("ul",{className:"recharts-tooltip-item-list",style:O},k)}return null},j=xc(xc({},Ql.contentStyle),n),N=xc({margin:0},l),w=!Rt(h),C=w?h:"",E=_t("recharts-default-tooltip",f),S=_t("recharts-tooltip-label",p);w&&v&&o!==void 0&&o!==null&&(C=v(h,o));var A=b?{role:"status","aria-live":"assertive"}:{};return g.createElement("div",Zx({className:E,style:j},A),g.createElement("p",{className:S,style:N},g.isValidElement(C)?C:"".concat(C)),x())},bc="recharts-tooltip-wrapper",S8={visibility:"hidden"};function w8(e){var{coordinate:t,translateX:n,translateY:a}=e;return _t(bc,{["".concat(bc,"-right")]:De(n)&&t&&De(t.x)&&n>=t.x,["".concat(bc,"-left")]:De(n)&&t&&De(t.x)&&n<t.x,["".concat(bc,"-bottom")]:De(a)&&t&&De(t.y)&&a>=t.y,["".concat(bc,"-top")]:De(a)&&t&&De(t.y)&&a<t.y})}function zw(e){var{allowEscapeViewBox:t,coordinate:n,key:a,offset:l,position:o,reverseDirection:u,tooltipDimension:d,viewBox:f,viewBoxDimension:p}=e;if(o&&De(o[a]))return o[a];var h=n[a]-d-(l>0?l:0),v=n[a]+l;if(t[a])return u[a]?h:v;var b=f[a];if(b==null)return 0;if(u[a]){var x=h,j=b;return x<j?Math.max(v,b):Math.max(h,b)}if(p==null)return 0;var N=v+d,w=b+p;return N>w?Math.max(h,b):Math.max(v,b)}function C8(e){var{translateX:t,translateY:n,useTranslate3d:a}=e;return{transform:a?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function E8(e){var{allowEscapeViewBox:t,coordinate:n,offsetTop:a,offsetLeft:l,position:o,reverseDirection:u,tooltipBox:d,useTranslate3d:f,viewBox:p}=e,h,v,b;return d.height>0&&d.width>0&&n?(v=zw({allowEscapeViewBox:t,coordinate:n,key:"x",offset:l,position:o,reverseDirection:u,tooltipDimension:d.width,viewBox:p,viewBoxDimension:p.width}),b=zw({allowEscapeViewBox:t,coordinate:n,key:"y",offset:a,position:o,reverseDirection:u,tooltipDimension:d.height,viewBox:p,viewBoxDimension:p.height}),h=C8({translateX:v,translateY:b,useTranslate3d:f})):h=S8,{cssProperties:h,cssClasses:w8({translateX:v,translateY:b,coordinate:n})}}function kw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Hd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kw(Object(n),!0).forEach(function(a){Jx(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Jx(e,t,n){return(t=A8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A8(e){var t=z8(e,"string");return typeof t=="symbol"?t:t+""}function z8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class k8 extends g.PureComponent{constructor(){super(...arguments),Jx(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Jx(this,"handleKeyDown",t=>{if(t.key==="Escape"){var n,a,l,o;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==null&&n!==void 0?n:0,y:(l=(o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==null&&l!==void 0?l:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,n;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:n,animationDuration:a,animationEasing:l,children:o,coordinate:u,hasPayload:d,isAnimationActive:f,offset:p,position:h,reverseDirection:v,useTranslate3d:b,viewBox:x,wrapperStyle:j,lastBoundingBox:N,innerRef:w,hasPortalFromProps:C}=this.props,E=typeof p=="number"?p:p.x,S=typeof p=="number"?p:p.y,{cssClasses:A,cssProperties:O}=E8({allowEscapeViewBox:n,coordinate:u,offsetLeft:E,offsetTop:S,position:h,reverseDirection:v,tooltipBox:{height:N.height,width:N.width},useTranslate3d:b,viewBox:x}),k=C?{}:Hd(Hd({transition:f&&t?"transform ".concat(a,"ms ").concat(l):void 0},O),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&d?"visible":"hidden",position:"absolute",top:0,left:0}),M=Hd(Hd({},k),{},{visibility:!this.state.dismissed&&t&&d?"visible":"hidden"},j);return g.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:A,style:M,ref:w},o)}}var vk=()=>{var e;return(e=Ie(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function eb(){return eb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},eb.apply(null,arguments)}function Ow(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Dw(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ow(Object(n),!0).forEach(function(a){O8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ow(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function O8(e,t,n){return(t=D8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D8(e){var t=M8(e,"string");return typeof t=="symbol"?t:t+""}function M8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mw={curveBasisClosed:D6,curveBasisOpen:M6,curveBasis:O6,curveBumpX:g6,curveBumpY:x6,curveLinearClosed:P6,curveLinear:jf,curveMonotoneX:T6,curveMonotoneY:q6,curveNatural:R6,curveStep:I6,curveStepAfter:$6,curveStepBefore:L6},qm=e=>st(e.x)&&st(e.y),Pw=e=>e.base!=null&&qm(e.base)&&qm(e),yc=e=>e.x,jc=e=>e.y,P8=(e,t)=>{if(typeof e=="function")return e;var n="curve".concat(iu(e));if((n==="curveMonotone"||n==="curveBump")&&t){var a=Mw["".concat(n).concat(t==="vertical"?"Y":"X")];if(a)return a}return Mw[n]||jf},Tw={connectNulls:!1,type:"linear"},T8=e=>{var{type:t=Tw.type,points:n=[],baseLine:a,layout:l,connectNulls:o=Tw.connectNulls}=e,u=P8(t,l),d=o?n.filter(qm):n;if(Array.isArray(a)){var f,p=n.map((j,N)=>Dw(Dw({},j),{},{base:a[N]}));l==="vertical"?f=Rd().y(jc).x1(yc).x0(j=>j.base.x):f=Rd().x(yc).y1(jc).y0(j=>j.base.y);var h=f.defined(Pw).curve(u),v=o?p.filter(Pw):p;return h(v)}var b;l==="vertical"&&De(a)?b=Rd().y(jc).x1(yc).x0(a):De(a)?b=Rd().x(yc).y1(jc).y0(a):b=VA().x(yc).y(jc);var x=b.defined(qm).curve(u);return x(d)},gk=e=>{var{className:t,points:n,path:a,pathRef:l}=e,o=el();if((!n||!n.length)&&!a)return null;var u={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||o,connectNulls:e.connectNulls},d=n&&n.length?T8(u):a;return g.createElement("path",eb({},Wn(e),Vb(e),{className:_t("recharts-curve",t),d:d===null?void 0:d,ref:l}))},q8=["x","y","top","left","width","height","className"];function tb(){return tb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},tb.apply(null,arguments)}function qw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function R8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qw(Object(n),!0).forEach(function(a){I8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function I8(e,t,n){return(t=L8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L8(e){var t=$8(e,"string");return typeof t=="symbol"?t:t+""}function $8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function B8(e,t){if(e==null)return{};var n,a,l=U8(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function U8(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var F8=(e,t,n,a,l,o)=>"M".concat(e,",").concat(l,"v").concat(a,"M").concat(o,",").concat(t,"h").concat(n),G8=e=>{var{x:t=0,y:n=0,top:a=0,left:l=0,width:o=0,height:u=0,className:d}=e,f=B8(e,q8),p=R8({x:t,y:n,top:a,left:l,width:o,height:u},f);return!De(t)||!De(n)||!De(o)||!De(u)||!De(a)||!De(l)?null:g.createElement("path",tb({},$r(p),{className:_t("recharts-cross",d),d:F8(t,n,o,u,a,l)}))};function H8(e,t,n,a){var l=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-l:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-l,width:e==="horizontal"?a:n.width-1,height:e==="horizontal"?n.height-1:a}}function Rw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Iw(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Rw(Object(n),!0).forEach(function(a){Q8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Q8(e,t,n){return(t=V8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V8(e){var t=Y8(e,"string");return typeof t=="symbol"?t:t+""}function Y8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K8=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),xk=(e,t,n)=>e.map(a=>"".concat(K8(a)," ").concat(t,"ms ").concat(n)).join(","),W8=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((n,a)=>n.filter(l=>a.includes(l))),Vc=(e,t)=>Object.keys(t).reduce((n,a)=>Iw(Iw({},n),{},{[a]:e(a,t[a])}),{});function Lw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function nr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Lw(Object(n),!0).forEach(function(a){X8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function X8(e,t,n){return(t=Z8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Z8(e){var t=J8(e,"string");return typeof t=="symbol"?t:t+""}function J8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rm=(e,t,n)=>e+(t-e)*n,rb=e=>{var{from:t,to:n}=e;return t!==n},bk=(e,t,n)=>{var a=Vc((l,o)=>{if(rb(o)){var[u,d]=e(o.from,o.to,o.velocity);return nr(nr({},o),{},{from:u,velocity:d})}return o},t);return n<1?Vc((l,o)=>rb(o)&&a[l]!=null?nr(nr({},o),{},{velocity:Rm(o.velocity,a[l].velocity,n),from:Rm(o.from,a[l].from,n)}):o,t):bk(e,a,n-1)};function e$(e,t,n,a,l,o){var u,d=a.reduce((b,x)=>nr(nr({},b),{},{[x]:{from:e[x],velocity:0,to:t[x]}}),{}),f=()=>Vc((b,x)=>x.from,d),p=()=>!Object.values(d).filter(rb).length,h=null,v=b=>{u||(u=b);var x=b-u,j=x/n.dt;d=bk(n,d,j),l(nr(nr(nr({},e),t),f())),u=b,p()||(h=o.setTimeout(v))};return()=>(h=o.setTimeout(v),()=>{var b;(b=h)===null||b===void 0||b()})}function t$(e,t,n,a,l,o,u){var d=null,f=l.reduce((v,b)=>{var x=e[b],j=t[b];return x==null||j==null?v:nr(nr({},v),{},{[b]:[x,j]})},{}),p,h=v=>{p||(p=v);var b=(v-p)/a,x=Vc((N,w)=>Rm(...w,n(b)),f);if(o(nr(nr(nr({},e),t),x)),b<1)d=u.setTimeout(h);else{var j=Vc((N,w)=>Rm(...w,n(1)),f);o(nr(nr(nr({},e),t),j))}};return()=>(d=u.setTimeout(h),()=>{var v;(v=d)===null||v===void 0||v()})}const r$=(e,t,n,a,l,o)=>{var u=W8(e,t);return n==null?()=>(l(nr(nr({},e),t)),()=>{}):n.isStepper===!0?e$(e,t,n,u,l,o):t$(e,t,n,a,u,l,o)};var Im=1e-4,yk=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],jk=(e,t)=>e.map((n,a)=>n*t**a).reduce((n,a)=>n+a),$w=(e,t)=>n=>{var a=yk(e,t);return jk(a,n)},n$=(e,t)=>n=>{var a=yk(e,t),l=[...a.map((o,u)=>o*u).slice(1),0];return jk(l,n)},a$=e=>{var t,n=e.split("(");if(n.length!==2||n[0]!=="cubic-bezier")return null;var a=(t=n[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(a==null||a.length!==4)return null;var l=a.map(o=>parseFloat(o));return[l[0],l[1],l[2],l[3]]},i$=function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];if(n.length===1)switch(n[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var l=a$(n[0]);if(l)return l}}return n.length===4?n:[0,0,1,1]},s$=(e,t,n,a)=>{var l=$w(e,n),o=$w(t,a),u=n$(e,n),d=p=>p>1?1:p<0?0:p,f=p=>{for(var h=p>1?1:p,v=h,b=0;b<8;++b){var x=l(v)-h,j=u(v);if(Math.abs(x-h)<Im||j<Im)return o(v);v=d(v-x/j)}return o(v)};return f.isStepper=!1,f},Bw=function(){return s$(...i$(...arguments))},l$=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:a=8,dt:l=17}=t,o=(u,d,f)=>{var p=-(u-d)*n,h=f*a,v=f+(p-h)*l/1e3,b=f*l/1e3+u;return Math.abs(b-d)<Im&&Math.abs(v)<Im?[d,0]:[b,v]};return o.isStepper=!0,o.dt=l,o},o$=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Bw(e);case"spring":return l$();default:if(e.split("(")[0]==="cubic-bezier")return Bw(e)}return typeof e=="function"?e:null};function c$(e){var t,n=()=>null,a=!1,l=null,o=u=>{if(!a){if(Array.isArray(u)){if(!u.length)return;var d=u,[f,...p]=d;if(typeof f=="number"){l=e.setTimeout(o.bind(null,p),f);return}o(f),l=e.setTimeout(o.bind(null,p));return}typeof u=="string"&&(t=u,n(t)),typeof u=="object"&&(t=u,n(t)),typeof u=="function"&&u()}};return{stop:()=>{a=!0},start:u=>{a=!1,l&&(l(),l=null),o(u)},subscribe:u=>(n=u,()=>{n=()=>null}),getTimeoutController:()=>e}}class u${setTimeout(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=performance.now(),l=null,o=u=>{u-a>=n?t(u):typeof requestAnimationFrame=="function"&&(l=requestAnimationFrame(o))};return l=requestAnimationFrame(o),()=>{l!=null&&cancelAnimationFrame(l)}}}function d$(){return c$(new u$)}var m$=g.createContext(d$);function f$(e,t){var n=g.useContext(m$);return g.useMemo(()=>t??n(e),[e,t,n])}var p$=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Uf={isSsr:p$()},h$={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},Uw={t:0},Gg={t:1};function Ff(e){var t=Ur(e,h$),{isActive:n,canBegin:a,duration:l,easing:o,begin:u,onAnimationEnd:d,onAnimationStart:f,children:p}=t,h=n==="auto"?!Uf.isSsr:n,v=f$(t.animationId,t.animationManager),[b,x]=g.useState(h?Uw:Gg),j=g.useRef(null);return g.useEffect(()=>{h||x(Gg)},[h]),g.useEffect(()=>{if(!h||!a)return Js;var N=r$(Uw,Gg,o$(o),l,x,v.getTimeoutController()),w=()=>{j.current=N()};return v.start([f,u,w,l,d]),()=>{v.stop(),j.current&&j.current(),d()}},[h,a,l,o,u,f,d,v]),p(b.t)}function Gf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=g.useRef($c(t)),a=g.useRef(e);return a.current!==e&&(n.current=$c(t),a.current=e),n.current}var v$=["radius"],g$=["radius"],Fw,Gw,Hw,Qw,Vw,Yw,Kw,Ww,Xw,Zw;function Jw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function eC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Jw(Object(n),!0).forEach(function(a){x$(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function x$(e,t,n){return(t=b$(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b$(e){var t=y$(e,"string");return typeof t=="symbol"?t:t+""}function y$(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lm(){return Lm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Lm.apply(null,arguments)}function tC(e,t){if(e==null)return{};var n,a,l=j$(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function j$(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function oa(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var rC=(e,t,n,a,l)=>{var o=Fi(n),u=Fi(a),d=Math.min(Math.abs(o)/2,Math.abs(u)/2),f=u>=0?1:-1,p=o>=0?1:-1,h=u>=0&&o>=0||u<0&&o<0?1:0,v;if(d>0&&Array.isArray(l)){for(var b=[0,0,0,0],x=0,j=4;x<j;x++){var N,w=(N=l[x])!==null&&N!==void 0?N:0;b[x]=w>d?d:w}v=Ft(Fw||(Fw=oa(["M",",",""])),e,t+f*b[0]),b[0]>0&&(v+=Ft(Gw||(Gw=oa(["A ",",",",0,0,",",",",",""])),b[0],b[0],h,e+p*b[0],t)),v+=Ft(Hw||(Hw=oa(["L ",",",""])),e+n-p*b[1],t),b[1]>0&&(v+=Ft(Qw||(Qw=oa(["A ",",",",0,0,",`,
        `,",",""])),b[1],b[1],h,e+n,t+f*b[1])),v+=Ft(Vw||(Vw=oa(["L ",",",""])),e+n,t+a-f*b[2]),b[2]>0&&(v+=Ft(Yw||(Yw=oa(["A ",",",",0,0,",`,
        `,",",""])),b[2],b[2],h,e+n-p*b[2],t+a)),v+=Ft(Kw||(Kw=oa(["L ",",",""])),e+p*b[3],t+a),b[3]>0&&(v+=Ft(Ww||(Ww=oa(["A ",",",",0,0,",`,
        `,",",""])),b[3],b[3],h,e,t+a-f*b[3])),v+="Z"}else if(d>0&&l===+l&&l>0){var C=Math.min(d,l);v=Ft(Xw||(Xw=oa(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+f*C,C,C,h,e+p*C,t,e+n-p*C,t,C,C,h,e+n,t+f*C,e+n,t+a-f*C,C,C,h,e+n-p*C,t+a,e+p*C,t+a,C,C,h,e,t+a-f*C)}else v=Ft(Zw||(Zw=oa(["M ",","," h "," v "," h "," Z"])),e,t,n,a,-n);return v},nC={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Nk=e=>{var t=Ur(e,nC),n=g.useRef(null),[a,l]=g.useState(-1);g.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var F=n.current.getTotalLength();F&&l(F)}catch{}},[]);var{x:o,y:u,width:d,height:f,radius:p,className:h}=t,{animationEasing:v,animationDuration:b,animationBegin:x,isAnimationActive:j,isUpdateAnimationActive:N}=t,w=g.useRef(d),C=g.useRef(f),E=g.useRef(o),S=g.useRef(u),A=g.useMemo(()=>({x:o,y:u,width:d,height:f,radius:p}),[o,u,d,f,p]),O=Gf(A,"rectangle-");if(o!==+o||u!==+u||d!==+d||f!==+f||d===0||f===0)return null;var k=_t("recharts-rectangle",h);if(!N){var M=$r(t),{radius:D}=M,$=tC(M,v$);return g.createElement("path",Lm({},$,{x:Fi(o),y:Fi(u),width:Fi(d),height:Fi(f),radius:typeof p=="number"?p:void 0,className:k,d:rC(o,u,d,f,p)}))}var U=w.current,L=C.current,B=E.current,ee=S.current,se="0px ".concat(a===-1?1:a,"px"),P="".concat(a,"px 0px"),q=xk(["strokeDasharray"],b,typeof v=="string"?v:nC.animationEasing);return g.createElement(Ff,{animationId:O,key:O,canBegin:a>0,duration:b,easing:v,isActive:N,begin:x},F=>{var R=Gt(U,d,F),W=Gt(L,f,F),I=Gt(B,o,F),re=Gt(ee,u,F);n.current&&(w.current=R,C.current=W,E.current=I,S.current=re);var V;j?F>0?V={transition:q,strokeDasharray:P}:V={strokeDasharray:se}:V={strokeDasharray:P};var oe=$r(t),{radius:xe}=oe,ve=tC(oe,g$);return g.createElement("path",Lm({},ve,{radius:typeof p=="number"?p:void 0,className:k,d:rC(I,re,R,W,p),ref:n,style:eC(eC({},V),t.style)}))})};function aC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function iC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aC(Object(n),!0).forEach(function(a){N$(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aC(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function N$(e,t,n){return(t=_$(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _$(e){var t=S$(e,"string");return typeof t=="symbol"?t:t+""}function S$(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $m=Math.PI/180,w$=e=>e*180/Math.PI,Er=(e,t,n,a)=>({x:e+Math.cos(-$m*a)*n,y:t+Math.sin(-$m*a)*n}),C$=function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(a.left||0)-(a.right||0)),Math.abs(n-(a.top||0)-(a.bottom||0)))/2},E$=(e,t)=>{var{x:n,y:a}=e,{x:l,y:o}=t;return Math.sqrt((n-l)**2+(a-o)**2)},A$=(e,t)=>{var{x:n,y:a}=e,{cx:l,cy:o}=t,u=E$({x:n,y:a},{x:l,y:o});if(u<=0)return{radius:u,angle:0};var d=(n-l)/u,f=Math.acos(d);return a>o&&(f=2*Math.PI-f),{radius:u,angle:w$(f),angleInRadian:f}},z$=e=>{var{startAngle:t,endAngle:n}=e,a=Math.floor(t/360),l=Math.floor(n/360),o=Math.min(a,l);return{startAngle:t-o*360,endAngle:n-o*360}},k$=(e,t)=>{var{startAngle:n,endAngle:a}=t,l=Math.floor(n/360),o=Math.floor(a/360),u=Math.min(l,o);return e+u*360},O$=(e,t)=>{var{chartX:n,chartY:a}=e,{radius:l,angle:o}=A$({x:n,y:a},t),{innerRadius:u,outerRadius:d}=t;if(l<u||l>d||l===0)return null;var{startAngle:f,endAngle:p}=z$(t),h=o,v;if(f<=p){for(;h>p;)h-=360;for(;h<f;)h+=360;v=h>=f&&h<=p}else{for(;h>f;)h-=360;for(;h<p;)h+=360;v=h>=p&&h<=f}return v?iC(iC({},t),{},{radius:l,angle:k$(h,t)}):null};function _k(e){var{cx:t,cy:n,radius:a,startAngle:l,endAngle:o}=e,u=Er(t,n,a,l),d=Er(t,n,a,o);return{points:[u,d],cx:t,cy:n,radius:a,startAngle:l,endAngle:o}}var sC,lC,oC,cC,uC,dC,mC;function nb(){return nb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},nb.apply(null,arguments)}function zs(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var D$=(e,t)=>{var n=Jr(t-e),a=Math.min(Math.abs(t-e),359.999);return n*a},Qd=e=>{var{cx:t,cy:n,radius:a,angle:l,sign:o,isExternal:u,cornerRadius:d,cornerIsExternal:f}=e,p=d*(u?1:-1)+a,h=Math.asin(d/p)/$m,v=f?l:l+o*h,b=Er(t,n,p,v),x=Er(t,n,a,v),j=f?l-o*h:l,N=Er(t,n,p*Math.cos(h*$m),j);return{center:b,circleTangency:x,lineTangency:N,theta:h}},Sk=e=>{var{cx:t,cy:n,innerRadius:a,outerRadius:l,startAngle:o,endAngle:u}=e,d=D$(o,u),f=o+d,p=Er(t,n,l,o),h=Er(t,n,l,f),v=Ft(sC||(sC=zs(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),p.x,p.y,l,l,+(Math.abs(d)>180),+(o>f),h.x,h.y);if(a>0){var b=Er(t,n,a,o),x=Er(t,n,a,f);v+=Ft(lC||(lC=zs(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),x.x,x.y,a,a,+(Math.abs(d)>180),+(o<=f),b.x,b.y)}else v+=Ft(oC||(oC=zs(["L ",","," Z"])),t,n);return v},M$=e=>{var{cx:t,cy:n,innerRadius:a,outerRadius:l,cornerRadius:o,forceCornerRadius:u,cornerIsExternal:d,startAngle:f,endAngle:p}=e,h=Jr(p-f),{circleTangency:v,lineTangency:b,theta:x}=Qd({cx:t,cy:n,radius:l,angle:f,sign:h,cornerRadius:o,cornerIsExternal:d}),{circleTangency:j,lineTangency:N,theta:w}=Qd({cx:t,cy:n,radius:l,angle:p,sign:-h,cornerRadius:o,cornerIsExternal:d}),C=d?Math.abs(f-p):Math.abs(f-p)-x-w;if(C<0)return u?Ft(cC||(cC=zs(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),b.x,b.y,o,o,o*2,o,o,-o*2):Sk({cx:t,cy:n,innerRadius:a,outerRadius:l,startAngle:f,endAngle:p});var E=Ft(uC||(uC=zs(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),b.x,b.y,o,o,+(h<0),v.x,v.y,l,l,+(C>180),+(h<0),j.x,j.y,o,o,+(h<0),N.x,N.y);if(a>0){var{circleTangency:S,lineTangency:A,theta:O}=Qd({cx:t,cy:n,radius:a,angle:f,sign:h,isExternal:!0,cornerRadius:o,cornerIsExternal:d}),{circleTangency:k,lineTangency:M,theta:D}=Qd({cx:t,cy:n,radius:a,angle:p,sign:-h,isExternal:!0,cornerRadius:o,cornerIsExternal:d}),$=d?Math.abs(f-p):Math.abs(f-p)-O-D;if($<0&&o===0)return"".concat(E,"L").concat(t,",").concat(n,"Z");E+=Ft(dC||(dC=zs(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),M.x,M.y,o,o,+(h<0),k.x,k.y,a,a,+($>180),+(h>0),S.x,S.y,o,o,+(h<0),A.x,A.y)}else E+=Ft(mC||(mC=zs(["L",",","Z"])),t,n);return E},P$={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},wk=e=>{var t=Ur(e,P$),{cx:n,cy:a,innerRadius:l,outerRadius:o,cornerRadius:u,forceCornerRadius:d,cornerIsExternal:f,startAngle:p,endAngle:h,className:v}=t;if(o<l||p===h)return null;var b=_t("recharts-sector",v),x=o-l,j=Xn(u,x,0,!0),N;return j>0&&Math.abs(p-h)<360?N=M$({cx:n,cy:a,innerRadius:l,outerRadius:o,cornerRadius:Math.min(j,x/2),forceCornerRadius:d,cornerIsExternal:f,startAngle:p,endAngle:h}):N=Sk({cx:n,cy:a,innerRadius:l,outerRadius:o,startAngle:p,endAngle:h}),g.createElement("path",nb({},$r(t),{className:b,d:N}))};function T$(e,t,n){if(e==="horizontal")return[{x:t.x,y:n.top},{x:t.x,y:n.top+n.height}];if(e==="vertical")return[{x:n.left,y:t.y},{x:n.left+n.width,y:t.y}];if(cz(t)){if(e==="centric"){var{cx:a,cy:l,innerRadius:o,outerRadius:u,angle:d}=t,f=Er(a,l,o,d),p=Er(a,l,u,d);return[{x:f.x,y:f.y},{x:p.x,y:p.y}]}return _k(t)}}var Hg={},Qg={},Vg={},fC;function q$(){return fC||(fC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bz();function n(a){return t.isSymbol(a)?NaN:Number(a)}e.toNumber=n})(Vg)),Vg}var pC;function R$(){return pC||(pC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=q$();function n(a){return a?(a=t.toNumber(a),a===1/0||a===-1/0?(a<0?-1:1)*Number.MAX_VALUE:a===a?a:0):a===0?a:0}e.toFinite=n})(Qg)),Qg}var hC;function I$(){return hC||(hC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yz(),n=R$();function a(l,o,u){u&&typeof u!="number"&&t.isIterateeCall(l,o,u)&&(o=u=void 0),l=n.toFinite(l),o===void 0?(o=l,l=0):o=n.toFinite(o),u=u===void 0?l<o?1:-1:n.toFinite(u);const d=Math.max(Math.ceil((o-l)/(u||1)),0),f=new Array(d);for(let p=0;p<d;p++)f[p]=l,l+=u;return f}e.range=a})(Hg)),Hg}var Yg,vC;function L$(){return vC||(vC=1,Yg=I$().range),Yg}var $$=L$();const Ck=ni($$);function Qi(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function B$(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function cy(e){let t,n,a;e.length!==2?(t=Qi,n=(d,f)=>Qi(e(d),f),a=(d,f)=>e(d)-f):(t=e===Qi||e===B$?e:U$,n=e,a=e);function l(d,f,p=0,h=d.length){if(p<h){if(t(f,f)!==0)return h;do{const v=p+h>>>1;n(d[v],f)<0?p=v+1:h=v}while(p<h)}return p}function o(d,f,p=0,h=d.length){if(p<h){if(t(f,f)!==0)return h;do{const v=p+h>>>1;n(d[v],f)<=0?p=v+1:h=v}while(p<h)}return p}function u(d,f,p=0,h=d.length){const v=l(d,f,p,h-1);return v>p&&a(d[v-1],f)>-a(d[v],f)?v-1:v}return{left:l,center:u,right:o}}function U$(){return 0}function Ek(e){return e===null?NaN:+e}function*F$(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const G$=cy(Qi),du=G$.right;cy(Ek).center;class gC extends Map{constructor(t,n=V$){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[a,l]of t)this.set(a,l)}get(t){return super.get(xC(this,t))}has(t){return super.has(xC(this,t))}set(t,n){return super.set(H$(this,t),n)}delete(t){return super.delete(Q$(this,t))}}function xC({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):n}function H$({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):(e.set(a,n),n)}function Q$({_intern:e,_key:t},n){const a=t(n);return e.has(a)&&(n=e.get(a),e.delete(a)),n}function V$(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Y$(e=Qi){if(e===Qi)return Ak;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const a=e(t,n);return a||a===0?a:(e(n,n)===0)-(e(t,t)===0)}}function Ak(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const K$=Math.sqrt(50),W$=Math.sqrt(10),X$=Math.sqrt(2);function Bm(e,t,n){const a=(t-e)/Math.max(0,n),l=Math.floor(Math.log10(a)),o=a/Math.pow(10,l),u=o>=K$?10:o>=W$?5:o>=X$?2:1;let d,f,p;return l<0?(p=Math.pow(10,-l)/u,d=Math.round(e*p),f=Math.round(t*p),d/p<e&&++d,f/p>t&&--f,p=-p):(p=Math.pow(10,l)*u,d=Math.round(e/p),f=Math.round(t/p),d*p<e&&++d,f*p>t&&--f),f<d&&.5<=n&&n<2?Bm(e,t,n*2):[d,f,p]}function ab(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const a=t<e,[l,o,u]=a?Bm(t,e,n):Bm(e,t,n);if(!(o>=l))return[];const d=o-l+1,f=new Array(d);if(a)if(u<0)for(let p=0;p<d;++p)f[p]=(o-p)/-u;else for(let p=0;p<d;++p)f[p]=(o-p)*u;else if(u<0)for(let p=0;p<d;++p)f[p]=(l+p)/-u;else for(let p=0;p<d;++p)f[p]=(l+p)*u;return f}function ib(e,t,n){return t=+t,e=+e,n=+n,Bm(e,t,n)[2]}function sb(e,t,n){t=+t,e=+e,n=+n;const a=t<e,l=a?ib(t,e,n):ib(e,t,n);return(a?-1:1)*(l<0?1/-l:l)}function bC(e,t){let n;for(const a of e)a!=null&&(n<a||n===void 0&&a>=a)&&(n=a);return n}function yC(e,t){let n;for(const a of e)a!=null&&(n>a||n===void 0&&a>=a)&&(n=a);return n}function zk(e,t,n=0,a=1/0,l){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),a=Math.floor(Math.min(e.length-1,a)),!(n<=t&&t<=a))return e;for(l=l===void 0?Ak:Y$(l);a>n;){if(a-n>600){const f=a-n+1,p=t-n+1,h=Math.log(f),v=.5*Math.exp(2*h/3),b=.5*Math.sqrt(h*v*(f-v)/f)*(p-f/2<0?-1:1),x=Math.max(n,Math.floor(t-p*v/f+b)),j=Math.min(a,Math.floor(t+(f-p)*v/f+b));zk(e,t,x,j,l)}const o=e[t];let u=n,d=a;for(Nc(e,n,t),l(e[a],o)>0&&Nc(e,n,a);u<d;){for(Nc(e,u,d),++u,--d;l(e[u],o)<0;)++u;for(;l(e[d],o)>0;)--d}l(e[n],o)===0?Nc(e,n,d):(++d,Nc(e,d,a)),d<=t&&(n=d+1),t<=d&&(a=d-1)}return e}function Nc(e,t,n){const a=e[t];e[t]=e[n],e[n]=a}function Z$(e,t,n){if(e=Float64Array.from(F$(e)),!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return yC(e);if(t>=1)return bC(e);var a,l=(a-1)*t,o=Math.floor(l),u=bC(zk(e,o).subarray(0,o+1)),d=yC(e.subarray(o+1));return u+(d-u)*(l-o)}}function J$(e,t,n=Ek){if(!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return+n(e[0],0,e);if(t>=1)return+n(e[a-1],a-1,e);var a,l=(a-1)*t,o=Math.floor(l),u=+n(e[o],o,e),d=+n(e[o+1],o+1,e);return u+(d-u)*(l-o)}}function e7(e,t,n){e=+e,t=+t,n=(l=arguments.length)<2?(t=e,e=0,1):l<3?1:+n;for(var a=-1,l=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(l);++a<l;)o[a]=e+a*n;return o}function In(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function li(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const lb=Symbol("implicit");function uy(){var e=new gC,t=[],n=[],a=lb;function l(o){let u=e.get(o);if(u===void 0){if(a!==lb)return a;e.set(o,u=t.push(o)-1)}return n[u%n.length]}return l.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new gC;for(const u of o)e.has(u)||e.set(u,t.push(u)-1);return l},l.range=function(o){return arguments.length?(n=Array.from(o),l):n.slice()},l.unknown=function(o){return arguments.length?(a=o,l):a},l.copy=function(){return uy(t,n).unknown(a)},In.apply(l,arguments),l}function dy(){var e=uy().unknown(void 0),t=e.domain,n=e.range,a=0,l=1,o,u,d=!1,f=0,p=0,h=.5;delete e.unknown;function v(){var b=t().length,x=l<a,j=x?l:a,N=x?a:l;o=(N-j)/Math.max(1,b-f+p*2),d&&(o=Math.floor(o)),j+=(N-j-o*(b-f))*h,u=o*(1-f),d&&(j=Math.round(j),u=Math.round(u));var w=e7(b).map(function(C){return j+o*C});return n(x?w.reverse():w)}return e.domain=function(b){return arguments.length?(t(b),v()):t()},e.range=function(b){return arguments.length?([a,l]=b,a=+a,l=+l,v()):[a,l]},e.rangeRound=function(b){return[a,l]=b,a=+a,l=+l,d=!0,v()},e.bandwidth=function(){return u},e.step=function(){return o},e.round=function(b){return arguments.length?(d=!!b,v()):d},e.padding=function(b){return arguments.length?(f=Math.min(1,p=+b),v()):f},e.paddingInner=function(b){return arguments.length?(f=Math.min(1,b),v()):f},e.paddingOuter=function(b){return arguments.length?(p=+b,v()):p},e.align=function(b){return arguments.length?(h=Math.max(0,Math.min(1,b)),v()):h},e.copy=function(){return dy(t(),[a,l]).round(d).paddingInner(f).paddingOuter(p).align(h)},In.apply(v(),arguments)}function kk(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return kk(t())},e}function t7(){return kk(dy.apply(null,arguments).paddingInner(1))}function my(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ok(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function mu(){}var Yc=.7,Um=1/Yc,io="\\s*([+-]?\\d+)\\s*",Kc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ha="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",r7=/^#([0-9a-f]{3,8})$/,n7=new RegExp(`^rgb\\(${io},${io},${io}\\)$`),a7=new RegExp(`^rgb\\(${ha},${ha},${ha}\\)$`),i7=new RegExp(`^rgba\\(${io},${io},${io},${Kc}\\)$`),s7=new RegExp(`^rgba\\(${ha},${ha},${ha},${Kc}\\)$`),l7=new RegExp(`^hsl\\(${Kc},${ha},${ha}\\)$`),o7=new RegExp(`^hsla\\(${Kc},${ha},${ha},${Kc}\\)$`),jC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};my(mu,Wc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:NC,formatHex:NC,formatHex8:c7,formatHsl:u7,formatRgb:_C,toString:_C});function NC(){return this.rgb().formatHex()}function c7(){return this.rgb().formatHex8()}function u7(){return Dk(this).formatHsl()}function _C(){return this.rgb().formatRgb()}function Wc(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=r7.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?SC(t):n===3?new tn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Vd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Vd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=n7.exec(e))?new tn(t[1],t[2],t[3],1):(t=a7.exec(e))?new tn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=i7.exec(e))?Vd(t[1],t[2],t[3],t[4]):(t=s7.exec(e))?Vd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=l7.exec(e))?EC(t[1],t[2]/100,t[3]/100,1):(t=o7.exec(e))?EC(t[1],t[2]/100,t[3]/100,t[4]):jC.hasOwnProperty(e)?SC(jC[e]):e==="transparent"?new tn(NaN,NaN,NaN,0):null}function SC(e){return new tn(e>>16&255,e>>8&255,e&255,1)}function Vd(e,t,n,a){return a<=0&&(e=t=n=NaN),new tn(e,t,n,a)}function d7(e){return e instanceof mu||(e=Wc(e)),e?(e=e.rgb(),new tn(e.r,e.g,e.b,e.opacity)):new tn}function ob(e,t,n,a){return arguments.length===1?d7(e):new tn(e,t,n,a??1)}function tn(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}my(tn,ob,Ok(mu,{brighter(e){return e=e==null?Um:Math.pow(Um,e),new tn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Yc:Math.pow(Yc,e),new tn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new tn(Rs(this.r),Rs(this.g),Rs(this.b),Fm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:wC,formatHex:wC,formatHex8:m7,formatRgb:CC,toString:CC}));function wC(){return`#${ks(this.r)}${ks(this.g)}${ks(this.b)}`}function m7(){return`#${ks(this.r)}${ks(this.g)}${ks(this.b)}${ks((isNaN(this.opacity)?1:this.opacity)*255)}`}function CC(){const e=Fm(this.opacity);return`${e===1?"rgb(":"rgba("}${Rs(this.r)}, ${Rs(this.g)}, ${Rs(this.b)}${e===1?")":`, ${e})`}`}function Fm(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Rs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ks(e){return e=Rs(e),(e<16?"0":"")+e.toString(16)}function EC(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Yn(e,t,n,a)}function Dk(e){if(e instanceof Yn)return new Yn(e.h,e.s,e.l,e.opacity);if(e instanceof mu||(e=Wc(e)),!e)return new Yn;if(e instanceof Yn)return e;e=e.rgb();var t=e.r/255,n=e.g/255,a=e.b/255,l=Math.min(t,n,a),o=Math.max(t,n,a),u=NaN,d=o-l,f=(o+l)/2;return d?(t===o?u=(n-a)/d+(n<a)*6:n===o?u=(a-t)/d+2:u=(t-n)/d+4,d/=f<.5?o+l:2-o-l,u*=60):d=f>0&&f<1?0:u,new Yn(u,d,f,e.opacity)}function f7(e,t,n,a){return arguments.length===1?Dk(e):new Yn(e,t,n,a??1)}function Yn(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}my(Yn,f7,Ok(mu,{brighter(e){return e=e==null?Um:Math.pow(Um,e),new Yn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Yc:Math.pow(Yc,e),new Yn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,l=2*n-a;return new tn(Kg(e>=240?e-240:e+120,l,a),Kg(e,l,a),Kg(e<120?e+240:e-120,l,a),this.opacity)},clamp(){return new Yn(AC(this.h),Yd(this.s),Yd(this.l),Fm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Fm(this.opacity);return`${e===1?"hsl(":"hsla("}${AC(this.h)}, ${Yd(this.s)*100}%, ${Yd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function AC(e){return e=(e||0)%360,e<0?e+360:e}function Yd(e){return Math.max(0,Math.min(1,e||0))}function Kg(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const fy=e=>()=>e;function p7(e,t){return function(n){return e+n*t}}function h7(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(a){return Math.pow(e+a*t,n)}}function v7(e){return(e=+e)==1?Mk:function(t,n){return n-t?h7(t,n,e):fy(isNaN(t)?n:t)}}function Mk(e,t){var n=t-e;return n?p7(e,n):fy(isNaN(e)?t:e)}const zC=(function e(t){var n=v7(t);function a(l,o){var u=n((l=ob(l)).r,(o=ob(o)).r),d=n(l.g,o.g),f=n(l.b,o.b),p=Mk(l.opacity,o.opacity);return function(h){return l.r=u(h),l.g=d(h),l.b=f(h),l.opacity=p(h),l+""}}return a.gamma=e,a})(1);function g7(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,a=t.slice(),l;return function(o){for(l=0;l<n;++l)a[l]=e[l]*(1-o)+t[l]*o;return a}}function x7(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function b7(e,t){var n=t?t.length:0,a=e?Math.min(n,e.length):0,l=new Array(a),o=new Array(n),u;for(u=0;u<a;++u)l[u]=vo(e[u],t[u]);for(;u<n;++u)o[u]=t[u];return function(d){for(u=0;u<a;++u)o[u]=l[u](d);return o}}function y7(e,t){var n=new Date;return e=+e,t=+t,function(a){return n.setTime(e*(1-a)+t*a),n}}function Gm(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function j7(e,t){var n={},a={},l;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(l in t)l in e?n[l]=vo(e[l],t[l]):a[l]=t[l];return function(o){for(l in n)a[l]=n[l](o);return a}}var cb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Wg=new RegExp(cb.source,"g");function N7(e){return function(){return e}}function _7(e){return function(t){return e(t)+""}}function S7(e,t){var n=cb.lastIndex=Wg.lastIndex=0,a,l,o,u=-1,d=[],f=[];for(e=e+"",t=t+"";(a=cb.exec(e))&&(l=Wg.exec(t));)(o=l.index)>n&&(o=t.slice(n,o),d[u]?d[u]+=o:d[++u]=o),(a=a[0])===(l=l[0])?d[u]?d[u]+=l:d[++u]=l:(d[++u]=null,f.push({i:u,x:Gm(a,l)})),n=Wg.lastIndex;return n<t.length&&(o=t.slice(n),d[u]?d[u]+=o:d[++u]=o),d.length<2?f[0]?_7(f[0].x):N7(t):(t=f.length,function(p){for(var h=0,v;h<t;++h)d[(v=f[h]).i]=v.x(p);return d.join("")})}function vo(e,t){var n=typeof t,a;return t==null||n==="boolean"?fy(t):(n==="number"?Gm:n==="string"?(a=Wc(t))?(t=a,zC):S7:t instanceof Wc?zC:t instanceof Date?y7:x7(t)?g7:Array.isArray(t)?b7:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?j7:Gm)(e,t)}function py(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function w7(e,t){t===void 0&&(t=e,e=vo);for(var n=0,a=t.length-1,l=t[0],o=new Array(a<0?0:a);n<a;)o[n]=e(l,l=t[++n]);return function(u){var d=Math.max(0,Math.min(a-1,Math.floor(u*=a)));return o[d](u-d)}}function C7(e){return function(){return e}}function Hm(e){return+e}var kC=[0,1];function Ir(e){return e}function ub(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:C7(isNaN(t)?NaN:.5)}function E7(e,t){var n;return e>t&&(n=e,e=t,t=n),function(a){return Math.max(e,Math.min(t,a))}}function A7(e,t,n){var a=e[0],l=e[1],o=t[0],u=t[1];return l<a?(a=ub(l,a),o=n(u,o)):(a=ub(a,l),o=n(o,u)),function(d){return o(a(d))}}function z7(e,t,n){var a=Math.min(e.length,t.length)-1,l=new Array(a),o=new Array(a),u=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++u<a;)l[u]=ub(e[u],e[u+1]),o[u]=n(t[u],t[u+1]);return function(d){var f=du(e,d,1,a)-1;return o[f](l[f](d))}}function fu(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Hf(){var e=kC,t=kC,n=vo,a,l,o,u=Ir,d,f,p;function h(){var b=Math.min(e.length,t.length);return u!==Ir&&(u=E7(e[0],e[b-1])),d=b>2?z7:A7,f=p=null,v}function v(b){return b==null||isNaN(b=+b)?o:(f||(f=d(e.map(a),t,n)))(a(u(b)))}return v.invert=function(b){return u(l((p||(p=d(t,e.map(a),Gm)))(b)))},v.domain=function(b){return arguments.length?(e=Array.from(b,Hm),h()):e.slice()},v.range=function(b){return arguments.length?(t=Array.from(b),h()):t.slice()},v.rangeRound=function(b){return t=Array.from(b),n=py,h()},v.clamp=function(b){return arguments.length?(u=b?!0:Ir,h()):u!==Ir},v.interpolate=function(b){return arguments.length?(n=b,h()):n},v.unknown=function(b){return arguments.length?(o=b,v):o},function(b,x){return a=b,l=x,h()}}function hy(){return Hf()(Ir,Ir)}function k7(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Qm(e,t){if(!isFinite(e)||e===0)return null;var n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),a=e.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+e.slice(n+1)]}function fo(e){return e=Qm(Math.abs(e)),e?e[1]:NaN}function O7(e,t){return function(n,a){for(var l=n.length,o=[],u=0,d=e[0],f=0;l>0&&d>0&&(f+d+1>a&&(d=Math.max(1,a-f)),o.push(n.substring(l-=d,l+d)),!((f+=d+1)>a));)d=e[u=(u+1)%e.length];return o.reverse().join(t)}}function D7(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var M7=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Xc(e){if(!(t=M7.exec(e)))throw new Error("invalid format: "+e);var t;return new vy({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Xc.prototype=vy.prototype;function vy(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}vy.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function P7(e){e:for(var t=e.length,n=1,a=-1,l;n<t;++n)switch(e[n]){case".":a=l=n;break;case"0":a===0&&(a=n),l=n;break;default:if(!+e[n])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(l+1):e}var Vm;function T7(e,t){var n=Qm(e,t);if(!n)return Vm=void 0,e.toPrecision(t);var a=n[0],l=n[1],o=l-(Vm=Math.max(-8,Math.min(8,Math.floor(l/3)))*3)+1,u=a.length;return o===u?a:o>u?a+new Array(o-u+1).join("0"):o>0?a.slice(0,o)+"."+a.slice(o):"0."+new Array(1-o).join("0")+Qm(e,Math.max(0,t+o-1))[0]}function OC(e,t){var n=Qm(e,t);if(!n)return e+"";var a=n[0],l=n[1];return l<0?"0."+new Array(-l).join("0")+a:a.length>l+1?a.slice(0,l+1)+"."+a.slice(l+1):a+new Array(l-a.length+2).join("0")}const DC={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:k7,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>OC(e*100,t),r:OC,s:T7,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function MC(e){return e}var PC=Array.prototype.map,TC=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function q7(e){var t=e.grouping===void 0||e.thousands===void 0?MC:O7(PC.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",l=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?MC:D7(PC.call(e.numerals,String)),u=e.percent===void 0?"%":e.percent+"",d=e.minus===void 0?"":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function p(v,b){v=Xc(v);var x=v.fill,j=v.align,N=v.sign,w=v.symbol,C=v.zero,E=v.width,S=v.comma,A=v.precision,O=v.trim,k=v.type;k==="n"?(S=!0,k="g"):DC[k]||(A===void 0&&(A=12),O=!0,k="g"),(C||x==="0"&&j==="=")&&(C=!0,x="0",j="=");var M=(b&&b.prefix!==void 0?b.prefix:"")+(w==="$"?n:w==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():""),D=(w==="$"?a:/[%p]/.test(k)?u:"")+(b&&b.suffix!==void 0?b.suffix:""),$=DC[k],U=/[defgprs%]/.test(k);A=A===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function L(B){var ee=M,se=D,P,q,F;if(k==="c")se=$(B)+se,B="";else{B=+B;var R=B<0||1/B<0;if(B=isNaN(B)?f:$(Math.abs(B),A),O&&(B=P7(B)),R&&+B==0&&N!=="+"&&(R=!1),ee=(R?N==="("?N:d:N==="-"||N==="("?"":N)+ee,se=(k==="s"&&!isNaN(B)&&Vm!==void 0?TC[8+Vm/3]:"")+se+(R&&N==="("?")":""),U){for(P=-1,q=B.length;++P<q;)if(F=B.charCodeAt(P),48>F||F>57){se=(F===46?l+B.slice(P+1):B.slice(P))+se,B=B.slice(0,P);break}}}S&&!C&&(B=t(B,1/0));var W=ee.length+B.length+se.length,I=W<E?new Array(E-W+1).join(x):"";switch(S&&C&&(B=t(I+B,I.length?E-se.length:1/0),I=""),j){case"<":B=ee+B+se+I;break;case"=":B=ee+I+B+se;break;case"^":B=I.slice(0,W=I.length>>1)+ee+B+se+I.slice(W);break;default:B=I+ee+B+se;break}return o(B)}return L.toString=function(){return v+""},L}function h(v,b){var x=Math.max(-8,Math.min(8,Math.floor(fo(b)/3)))*3,j=Math.pow(10,-x),N=p((v=Xc(v),v.type="f",v),{suffix:TC[8+x/3]});return function(w){return N(j*w)}}return{format:p,formatPrefix:h}}var Kd,gy,Pk;R7({thousands:",",grouping:[3],currency:["$",""]});function R7(e){return Kd=q7(e),gy=Kd.format,Pk=Kd.formatPrefix,Kd}function I7(e){return Math.max(0,-fo(Math.abs(e)))}function L7(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(fo(t)/3)))*3-fo(Math.abs(e)))}function $7(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,fo(t)-fo(e))+1}function Tk(e,t,n,a){var l=sb(e,t,n),o;switch(a=Xc(a??",f"),a.type){case"s":{var u=Math.max(Math.abs(e),Math.abs(t));return a.precision==null&&!isNaN(o=L7(l,u))&&(a.precision=o),Pk(a,u)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(o=$7(l,Math.max(Math.abs(e),Math.abs(t))))&&(a.precision=o-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(o=I7(l))&&(a.precision=o-(a.type==="%")*2);break}}return gy(a)}function es(e){var t=e.domain;return e.ticks=function(n){var a=t();return ab(a[0],a[a.length-1],n??10)},e.tickFormat=function(n,a){var l=t();return Tk(l[0],l[l.length-1],n??10,a)},e.nice=function(n){n==null&&(n=10);var a=t(),l=0,o=a.length-1,u=a[l],d=a[o],f,p,h=10;for(d<u&&(p=u,u=d,d=p,p=l,l=o,o=p);h-- >0;){if(p=ib(u,d,n),p===f)return a[l]=u,a[o]=d,t(a);if(p>0)u=Math.floor(u/p)*p,d=Math.ceil(d/p)*p;else if(p<0)u=Math.ceil(u*p)/p,d=Math.floor(d*p)/p;else break;f=p}return e},e}function qk(){var e=hy();return e.copy=function(){return fu(e,qk())},In.apply(e,arguments),es(e)}function Rk(e){var t;function n(a){return a==null||isNaN(a=+a)?t:a}return n.invert=n,n.domain=n.range=function(a){return arguments.length?(e=Array.from(a,Hm),n):e.slice()},n.unknown=function(a){return arguments.length?(t=a,n):t},n.copy=function(){return Rk(e).unknown(t)},e=arguments.length?Array.from(e,Hm):[0,1],es(n)}function Ik(e,t){e=e.slice();var n=0,a=e.length-1,l=e[n],o=e[a],u;return o<l&&(u=n,n=a,a=u,u=l,l=o,o=u),e[n]=t.floor(l),e[a]=t.ceil(o),e}function qC(e){return Math.log(e)}function RC(e){return Math.exp(e)}function B7(e){return-Math.log(-e)}function U7(e){return-Math.exp(-e)}function F7(e){return isFinite(e)?+("1e"+e):e<0?0:e}function G7(e){return e===10?F7:e===Math.E?Math.exp:t=>Math.pow(e,t)}function H7(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function IC(e){return(t,n)=>-e(-t,n)}function xy(e){const t=e(qC,RC),n=t.domain;let a=10,l,o;function u(){return l=H7(a),o=G7(a),n()[0]<0?(l=IC(l),o=IC(o),e(B7,U7)):e(qC,RC),t}return t.base=function(d){return arguments.length?(a=+d,u()):a},t.domain=function(d){return arguments.length?(n(d),u()):n()},t.ticks=d=>{const f=n();let p=f[0],h=f[f.length-1];const v=h<p;v&&([p,h]=[h,p]);let b=l(p),x=l(h),j,N;const w=d==null?10:+d;let C=[];if(!(a%1)&&x-b<w){if(b=Math.floor(b),x=Math.ceil(x),p>0){for(;b<=x;++b)for(j=1;j<a;++j)if(N=b<0?j/o(-b):j*o(b),!(N<p)){if(N>h)break;C.push(N)}}else for(;b<=x;++b)for(j=a-1;j>=1;--j)if(N=b>0?j/o(-b):j*o(b),!(N<p)){if(N>h)break;C.push(N)}C.length*2<w&&(C=ab(p,h,w))}else C=ab(b,x,Math.min(x-b,w)).map(o);return v?C.reverse():C},t.tickFormat=(d,f)=>{if(d==null&&(d=10),f==null&&(f=a===10?"s":","),typeof f!="function"&&(!(a%1)&&(f=Xc(f)).precision==null&&(f.trim=!0),f=gy(f)),d===1/0)return f;const p=Math.max(1,a*d/t.ticks().length);return h=>{let v=h/o(Math.round(l(h)));return v*a<a-.5&&(v*=a),v<=p?f(h):""}},t.nice=()=>n(Ik(n(),{floor:d=>o(Math.floor(l(d))),ceil:d=>o(Math.ceil(l(d)))})),t}function Lk(){const e=xy(Hf()).domain([1,10]);return e.copy=()=>fu(e,Lk()).base(e.base()),In.apply(e,arguments),e}function LC(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function $C(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function by(e){var t=1,n=e(LC(t),$C(t));return n.constant=function(a){return arguments.length?e(LC(t=+a),$C(t)):t},es(n)}function $k(){var e=by(Hf());return e.copy=function(){return fu(e,$k()).constant(e.constant())},In.apply(e,arguments)}function BC(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Q7(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function V7(e){return e<0?-e*e:e*e}function yy(e){var t=e(Ir,Ir),n=1;function a(){return n===1?e(Ir,Ir):n===.5?e(Q7,V7):e(BC(n),BC(1/n))}return t.exponent=function(l){return arguments.length?(n=+l,a()):n},es(t)}function jy(){var e=yy(Hf());return e.copy=function(){return fu(e,jy()).exponent(e.exponent())},In.apply(e,arguments),e}function Y7(){return jy.apply(null,arguments).exponent(.5)}function UC(e){return Math.sign(e)*e*e}function K7(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function Bk(){var e=hy(),t=[0,1],n=!1,a;function l(o){var u=K7(e(o));return isNaN(u)?a:n?Math.round(u):u}return l.invert=function(o){return e.invert(UC(o))},l.domain=function(o){return arguments.length?(e.domain(o),l):e.domain()},l.range=function(o){return arguments.length?(e.range((t=Array.from(o,Hm)).map(UC)),l):t.slice()},l.rangeRound=function(o){return l.range(o).round(!0)},l.round=function(o){return arguments.length?(n=!!o,l):n},l.clamp=function(o){return arguments.length?(e.clamp(o),l):e.clamp()},l.unknown=function(o){return arguments.length?(a=o,l):a},l.copy=function(){return Bk(e.domain(),t).round(n).clamp(e.clamp()).unknown(a)},In.apply(l,arguments),es(l)}function Uk(){var e=[],t=[],n=[],a;function l(){var u=0,d=Math.max(1,t.length);for(n=new Array(d-1);++u<d;)n[u-1]=J$(e,u/d);return o}function o(u){return u==null||isNaN(u=+u)?a:t[du(n,u)]}return o.invertExtent=function(u){var d=t.indexOf(u);return d<0?[NaN,NaN]:[d>0?n[d-1]:e[0],d<n.length?n[d]:e[e.length-1]]},o.domain=function(u){if(!arguments.length)return e.slice();e=[];for(let d of u)d!=null&&!isNaN(d=+d)&&e.push(d);return e.sort(Qi),l()},o.range=function(u){return arguments.length?(t=Array.from(u),l()):t.slice()},o.unknown=function(u){return arguments.length?(a=u,o):a},o.quantiles=function(){return n.slice()},o.copy=function(){return Uk().domain(e).range(t).unknown(a)},In.apply(o,arguments)}function Fk(){var e=0,t=1,n=1,a=[.5],l=[0,1],o;function u(f){return f!=null&&f<=f?l[du(a,f,0,n)]:o}function d(){var f=-1;for(a=new Array(n);++f<n;)a[f]=((f+1)*t-(f-n)*e)/(n+1);return u}return u.domain=function(f){return arguments.length?([e,t]=f,e=+e,t=+t,d()):[e,t]},u.range=function(f){return arguments.length?(n=(l=Array.from(f)).length-1,d()):l.slice()},u.invertExtent=function(f){var p=l.indexOf(f);return p<0?[NaN,NaN]:p<1?[e,a[0]]:p>=n?[a[n-1],t]:[a[p-1],a[p]]},u.unknown=function(f){return arguments.length&&(o=f),u},u.thresholds=function(){return a.slice()},u.copy=function(){return Fk().domain([e,t]).range(l).unknown(o)},In.apply(es(u),arguments)}function Gk(){var e=[.5],t=[0,1],n,a=1;function l(o){return o!=null&&o<=o?t[du(e,o,0,a)]:n}return l.domain=function(o){return arguments.length?(e=Array.from(o),a=Math.min(e.length,t.length-1),l):e.slice()},l.range=function(o){return arguments.length?(t=Array.from(o),a=Math.min(e.length,t.length-1),l):t.slice()},l.invertExtent=function(o){var u=t.indexOf(o);return[e[u-1],e[u]]},l.unknown=function(o){return arguments.length?(n=o,l):n},l.copy=function(){return Gk().domain(e).range(t).unknown(n)},In.apply(l,arguments)}const Xg=new Date,Zg=new Date;function ir(e,t,n,a){function l(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return l.floor=o=>(e(o=new Date(+o)),o),l.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),l.round=o=>{const u=l(o),d=l.ceil(o);return o-u<d-o?u:d},l.offset=(o,u)=>(t(o=new Date(+o),u==null?1:Math.floor(u)),o),l.range=(o,u,d)=>{const f=[];if(o=l.ceil(o),d=d==null?1:Math.floor(d),!(o<u)||!(d>0))return f;let p;do f.push(p=new Date(+o)),t(o,d),e(o);while(p<o&&o<u);return f},l.filter=o=>ir(u=>{if(u>=u)for(;e(u),!o(u);)u.setTime(u-1)},(u,d)=>{if(u>=u)if(d<0)for(;++d<=0;)for(;t(u,-1),!o(u););else for(;--d>=0;)for(;t(u,1),!o(u););}),n&&(l.count=(o,u)=>(Xg.setTime(+o),Zg.setTime(+u),e(Xg),e(Zg),Math.floor(n(Xg,Zg))),l.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?l.filter(a?u=>a(u)%o===0:u=>l.count(0,u)%o===0):l)),l}const Ym=ir(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Ym.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ir(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Ym);Ym.range;const Ha=1e3,Dn=Ha*60,Qa=Dn*60,Xa=Qa*24,Ny=Xa*7,FC=Xa*30,Jg=Xa*365,Os=ir(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ha)},(e,t)=>(t-e)/Ha,e=>e.getUTCSeconds());Os.range;const _y=ir(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ha)},(e,t)=>{e.setTime(+e+t*Dn)},(e,t)=>(t-e)/Dn,e=>e.getMinutes());_y.range;const Sy=ir(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Dn)},(e,t)=>(t-e)/Dn,e=>e.getUTCMinutes());Sy.range;const wy=ir(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ha-e.getMinutes()*Dn)},(e,t)=>{e.setTime(+e+t*Qa)},(e,t)=>(t-e)/Qa,e=>e.getHours());wy.range;const Cy=ir(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Qa)},(e,t)=>(t-e)/Qa,e=>e.getUTCHours());Cy.range;const pu=ir(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Dn)/Xa,e=>e.getDate()-1);pu.range;const Qf=ir(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Xa,e=>e.getUTCDate()-1);Qf.range;const Hk=ir(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Xa,e=>Math.floor(e/Xa));Hk.range;function tl(e){return ir(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Dn)/Ny)}const Vf=tl(0),Km=tl(1),W7=tl(2),X7=tl(3),po=tl(4),Z7=tl(5),J7=tl(6);Vf.range;Km.range;W7.range;X7.range;po.range;Z7.range;J7.range;function rl(e){return ir(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/Ny)}const Yf=rl(0),Wm=rl(1),eB=rl(2),tB=rl(3),ho=rl(4),rB=rl(5),nB=rl(6);Yf.range;Wm.range;eB.range;tB.range;ho.range;rB.range;nB.range;const Ey=ir(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Ey.range;const Ay=ir(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Ay.range;const Za=ir(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Za.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ir(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Za.range;const Ja=ir(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Ja.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ir(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Ja.range;function Qk(e,t,n,a,l,o){const u=[[Os,1,Ha],[Os,5,5*Ha],[Os,15,15*Ha],[Os,30,30*Ha],[o,1,Dn],[o,5,5*Dn],[o,15,15*Dn],[o,30,30*Dn],[l,1,Qa],[l,3,3*Qa],[l,6,6*Qa],[l,12,12*Qa],[a,1,Xa],[a,2,2*Xa],[n,1,Ny],[t,1,FC],[t,3,3*FC],[e,1,Jg]];function d(p,h,v){const b=h<p;b&&([p,h]=[h,p]);const x=v&&typeof v.range=="function"?v:f(p,h,v),j=x?x.range(p,+h+1):[];return b?j.reverse():j}function f(p,h,v){const b=Math.abs(h-p)/v,x=cy(([,,w])=>w).right(u,b);if(x===u.length)return e.every(sb(p/Jg,h/Jg,v));if(x===0)return Ym.every(Math.max(sb(p,h,v),1));const[j,N]=u[b/u[x-1][2]<u[x][2]/b?x-1:x];return j.every(N)}return[d,f]}const[aB,iB]=Qk(Ja,Ay,Yf,Hk,Cy,Sy),[sB,lB]=Qk(Za,Ey,Vf,pu,wy,_y);function ex(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function tx(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function _c(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function oB(e){var t=e.dateTime,n=e.date,a=e.time,l=e.periods,o=e.days,u=e.shortDays,d=e.months,f=e.shortMonths,p=Sc(l),h=wc(l),v=Sc(o),b=wc(o),x=Sc(u),j=wc(u),N=Sc(d),w=wc(d),C=Sc(f),E=wc(f),S={a:F,A:R,b:W,B:I,c:null,d:KC,e:KC,f:OB,g:BB,G:FB,H:AB,I:zB,j:kB,L:Vk,m:DB,M:MB,p:re,q:V,Q:ZC,s:JC,S:PB,u:TB,U:qB,V:RB,w:IB,W:LB,x:null,X:null,y:$B,Y:UB,Z:GB,"%":XC},A={a:oe,A:xe,b:ve,B:H,c:null,d:WC,e:WC,f:YB,g:a9,G:s9,H:HB,I:QB,j:VB,L:Kk,m:KB,M:WB,p:he,q:Pe,Q:ZC,s:JC,S:XB,u:ZB,U:JB,V:e9,w:t9,W:r9,x:null,X:null,y:n9,Y:i9,Z:l9,"%":XC},O={a:U,A:L,b:B,B:ee,c:se,d:VC,e:VC,f:SB,g:QC,G:HC,H:YC,I:YC,j:yB,L:_B,m:bB,M:jB,p:$,q:xB,Q:CB,s:EB,S:NB,u:fB,U:pB,V:hB,w:mB,W:vB,x:P,X:q,y:QC,Y:HC,Z:gB,"%":wB};S.x=k(n,S),S.X=k(a,S),S.c=k(t,S),A.x=k(n,A),A.X=k(a,A),A.c=k(t,A);function k(ue,X){return function(Q){var me=[],we=-1,qe=0,We=ue.length,Je,at,br;for(Q instanceof Date||(Q=new Date(+Q));++we<We;)ue.charCodeAt(we)===37&&(me.push(ue.slice(qe,we)),(at=GC[Je=ue.charAt(++we)])!=null?Je=ue.charAt(++we):at=Je==="e"?" ":"0",(br=X[Je])&&(Je=br(Q,at)),me.push(Je),qe=we+1);return me.push(ue.slice(qe,we)),me.join("")}}function M(ue,X){return function(Q){var me=_c(1900,void 0,1),we=D(me,ue,Q+="",0),qe,We;if(we!=Q.length)return null;if("Q"in me)return new Date(me.Q);if("s"in me)return new Date(me.s*1e3+("L"in me?me.L:0));if(X&&!("Z"in me)&&(me.Z=0),"p"in me&&(me.H=me.H%12+me.p*12),me.m===void 0&&(me.m="q"in me?me.q:0),"V"in me){if(me.V<1||me.V>53)return null;"w"in me||(me.w=1),"Z"in me?(qe=tx(_c(me.y,0,1)),We=qe.getUTCDay(),qe=We>4||We===0?Wm.ceil(qe):Wm(qe),qe=Qf.offset(qe,(me.V-1)*7),me.y=qe.getUTCFullYear(),me.m=qe.getUTCMonth(),me.d=qe.getUTCDate()+(me.w+6)%7):(qe=ex(_c(me.y,0,1)),We=qe.getDay(),qe=We>4||We===0?Km.ceil(qe):Km(qe),qe=pu.offset(qe,(me.V-1)*7),me.y=qe.getFullYear(),me.m=qe.getMonth(),me.d=qe.getDate()+(me.w+6)%7)}else("W"in me||"U"in me)&&("w"in me||(me.w="u"in me?me.u%7:"W"in me?1:0),We="Z"in me?tx(_c(me.y,0,1)).getUTCDay():ex(_c(me.y,0,1)).getDay(),me.m=0,me.d="W"in me?(me.w+6)%7+me.W*7-(We+5)%7:me.w+me.U*7-(We+6)%7);return"Z"in me?(me.H+=me.Z/100|0,me.M+=me.Z%100,tx(me)):ex(me)}}function D(ue,X,Q,me){for(var we=0,qe=X.length,We=Q.length,Je,at;we<qe;){if(me>=We)return-1;if(Je=X.charCodeAt(we++),Je===37){if(Je=X.charAt(we++),at=O[Je in GC?X.charAt(we++):Je],!at||(me=at(ue,Q,me))<0)return-1}else if(Je!=Q.charCodeAt(me++))return-1}return me}function $(ue,X,Q){var me=p.exec(X.slice(Q));return me?(ue.p=h.get(me[0].toLowerCase()),Q+me[0].length):-1}function U(ue,X,Q){var me=x.exec(X.slice(Q));return me?(ue.w=j.get(me[0].toLowerCase()),Q+me[0].length):-1}function L(ue,X,Q){var me=v.exec(X.slice(Q));return me?(ue.w=b.get(me[0].toLowerCase()),Q+me[0].length):-1}function B(ue,X,Q){var me=C.exec(X.slice(Q));return me?(ue.m=E.get(me[0].toLowerCase()),Q+me[0].length):-1}function ee(ue,X,Q){var me=N.exec(X.slice(Q));return me?(ue.m=w.get(me[0].toLowerCase()),Q+me[0].length):-1}function se(ue,X,Q){return D(ue,t,X,Q)}function P(ue,X,Q){return D(ue,n,X,Q)}function q(ue,X,Q){return D(ue,a,X,Q)}function F(ue){return u[ue.getDay()]}function R(ue){return o[ue.getDay()]}function W(ue){return f[ue.getMonth()]}function I(ue){return d[ue.getMonth()]}function re(ue){return l[+(ue.getHours()>=12)]}function V(ue){return 1+~~(ue.getMonth()/3)}function oe(ue){return u[ue.getUTCDay()]}function xe(ue){return o[ue.getUTCDay()]}function ve(ue){return f[ue.getUTCMonth()]}function H(ue){return d[ue.getUTCMonth()]}function he(ue){return l[+(ue.getUTCHours()>=12)]}function Pe(ue){return 1+~~(ue.getUTCMonth()/3)}return{format:function(ue){var X=k(ue+="",S);return X.toString=function(){return ue},X},parse:function(ue){var X=M(ue+="",!1);return X.toString=function(){return ue},X},utcFormat:function(ue){var X=k(ue+="",A);return X.toString=function(){return ue},X},utcParse:function(ue){var X=M(ue+="",!0);return X.toString=function(){return ue},X}}}var GC={"-":"",_:" ",0:"0"},vr=/^\s*\d+/,cB=/^%/,uB=/[\\^$*+?|[\]().{}]/g;function dt(e,t,n){var a=e<0?"-":"",l=(a?-e:e)+"",o=l.length;return a+(o<n?new Array(n-o+1).join(t)+l:l)}function dB(e){return e.replace(uB,"\\$&")}function Sc(e){return new RegExp("^(?:"+e.map(dB).join("|")+")","i")}function wc(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function mB(e,t,n){var a=vr.exec(t.slice(n,n+1));return a?(e.w=+a[0],n+a[0].length):-1}function fB(e,t,n){var a=vr.exec(t.slice(n,n+1));return a?(e.u=+a[0],n+a[0].length):-1}function pB(e,t,n){var a=vr.exec(t.slice(n,n+2));return a?(e.U=+a[0],n+a[0].length):-1}function hB(e,t,n){var a=vr.exec(t.slice(n,n+2));return a?(e.V=+a[0],n+a[0].length):-1}function vB(e,t,n){var a=vr.exec(t.slice(n,n+2));return a?(e.W=+a[0],n+a[0].length):-1}function HC(e,t,n){var a=vr.exec(t.slice(n,n+4));return a?(e.y=+a[0],n+a[0].length):-1}function QC(e,t,n){var a=vr.exec(t.slice(n,n+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function gB(e,t,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function xB(e,t,n){var a=vr.exec(t.slice(n,n+1));return a?(e.q=a[0]*3-3,n+a[0].length):-1}function bB(e,t,n){var a=vr.exec(t.slice(n,n+2));return a?(e.m=a[0]-1,n+a[0].length):-1}function VC(e,t,n){var a=vr.exec(t.slice(n,n+2));return a?(e.d=+a[0],n+a[0].length):-1}function yB(e,t,n){var a=vr.exec(t.slice(n,n+3));return a?(e.m=0,e.d=+a[0],n+a[0].length):-1}function YC(e,t,n){var a=vr.exec(t.slice(n,n+2));return a?(e.H=+a[0],n+a[0].length):-1}function jB(e,t,n){var a=vr.exec(t.slice(n,n+2));return a?(e.M=+a[0],n+a[0].length):-1}function NB(e,t,n){var a=vr.exec(t.slice(n,n+2));return a?(e.S=+a[0],n+a[0].length):-1}function _B(e,t,n){var a=vr.exec(t.slice(n,n+3));return a?(e.L=+a[0],n+a[0].length):-1}function SB(e,t,n){var a=vr.exec(t.slice(n,n+6));return a?(e.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function wB(e,t,n){var a=cB.exec(t.slice(n,n+1));return a?n+a[0].length:-1}function CB(e,t,n){var a=vr.exec(t.slice(n));return a?(e.Q=+a[0],n+a[0].length):-1}function EB(e,t,n){var a=vr.exec(t.slice(n));return a?(e.s=+a[0],n+a[0].length):-1}function KC(e,t){return dt(e.getDate(),t,2)}function AB(e,t){return dt(e.getHours(),t,2)}function zB(e,t){return dt(e.getHours()%12||12,t,2)}function kB(e,t){return dt(1+pu.count(Za(e),e),t,3)}function Vk(e,t){return dt(e.getMilliseconds(),t,3)}function OB(e,t){return Vk(e,t)+"000"}function DB(e,t){return dt(e.getMonth()+1,t,2)}function MB(e,t){return dt(e.getMinutes(),t,2)}function PB(e,t){return dt(e.getSeconds(),t,2)}function TB(e){var t=e.getDay();return t===0?7:t}function qB(e,t){return dt(Vf.count(Za(e)-1,e),t,2)}function Yk(e){var t=e.getDay();return t>=4||t===0?po(e):po.ceil(e)}function RB(e,t){return e=Yk(e),dt(po.count(Za(e),e)+(Za(e).getDay()===4),t,2)}function IB(e){return e.getDay()}function LB(e,t){return dt(Km.count(Za(e)-1,e),t,2)}function $B(e,t){return dt(e.getFullYear()%100,t,2)}function BB(e,t){return e=Yk(e),dt(e.getFullYear()%100,t,2)}function UB(e,t){return dt(e.getFullYear()%1e4,t,4)}function FB(e,t){var n=e.getDay();return e=n>=4||n===0?po(e):po.ceil(e),dt(e.getFullYear()%1e4,t,4)}function GB(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+dt(t/60|0,"0",2)+dt(t%60,"0",2)}function WC(e,t){return dt(e.getUTCDate(),t,2)}function HB(e,t){return dt(e.getUTCHours(),t,2)}function QB(e,t){return dt(e.getUTCHours()%12||12,t,2)}function VB(e,t){return dt(1+Qf.count(Ja(e),e),t,3)}function Kk(e,t){return dt(e.getUTCMilliseconds(),t,3)}function YB(e,t){return Kk(e,t)+"000"}function KB(e,t){return dt(e.getUTCMonth()+1,t,2)}function WB(e,t){return dt(e.getUTCMinutes(),t,2)}function XB(e,t){return dt(e.getUTCSeconds(),t,2)}function ZB(e){var t=e.getUTCDay();return t===0?7:t}function JB(e,t){return dt(Yf.count(Ja(e)-1,e),t,2)}function Wk(e){var t=e.getUTCDay();return t>=4||t===0?ho(e):ho.ceil(e)}function e9(e,t){return e=Wk(e),dt(ho.count(Ja(e),e)+(Ja(e).getUTCDay()===4),t,2)}function t9(e){return e.getUTCDay()}function r9(e,t){return dt(Wm.count(Ja(e)-1,e),t,2)}function n9(e,t){return dt(e.getUTCFullYear()%100,t,2)}function a9(e,t){return e=Wk(e),dt(e.getUTCFullYear()%100,t,2)}function i9(e,t){return dt(e.getUTCFullYear()%1e4,t,4)}function s9(e,t){var n=e.getUTCDay();return e=n>=4||n===0?ho(e):ho.ceil(e),dt(e.getUTCFullYear()%1e4,t,4)}function l9(){return"+0000"}function XC(){return"%"}function ZC(e){return+e}function JC(e){return Math.floor(+e/1e3)}var Vl,Xk,Zk;o9({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function o9(e){return Vl=oB(e),Xk=Vl.format,Vl.parse,Zk=Vl.utcFormat,Vl.utcParse,Vl}function c9(e){return new Date(e)}function u9(e){return e instanceof Date?+e:+new Date(+e)}function zy(e,t,n,a,l,o,u,d,f,p){var h=hy(),v=h.invert,b=h.domain,x=p(".%L"),j=p(":%S"),N=p("%I:%M"),w=p("%I %p"),C=p("%a %d"),E=p("%b %d"),S=p("%B"),A=p("%Y");function O(k){return(f(k)<k?x:d(k)<k?j:u(k)<k?N:o(k)<k?w:a(k)<k?l(k)<k?C:E:n(k)<k?S:A)(k)}return h.invert=function(k){return new Date(v(k))},h.domain=function(k){return arguments.length?b(Array.from(k,u9)):b().map(c9)},h.ticks=function(k){var M=b();return e(M[0],M[M.length-1],k??10)},h.tickFormat=function(k,M){return M==null?O:p(M)},h.nice=function(k){var M=b();return(!k||typeof k.range!="function")&&(k=t(M[0],M[M.length-1],k??10)),k?b(Ik(M,k)):h},h.copy=function(){return fu(h,zy(e,t,n,a,l,o,u,d,f,p))},h}function d9(){return In.apply(zy(sB,lB,Za,Ey,Vf,pu,wy,_y,Os,Xk).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function m9(){return In.apply(zy(aB,iB,Ja,Ay,Yf,Qf,Cy,Sy,Os,Zk).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Kf(){var e=0,t=1,n,a,l,o,u=Ir,d=!1,f;function p(v){return v==null||isNaN(v=+v)?f:u(l===0?.5:(v=(o(v)-n)*l,d?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t]=v,n=o(e=+e),a=o(t=+t),l=n===a?0:1/(a-n),p):[e,t]},p.clamp=function(v){return arguments.length?(d=!!v,p):d},p.interpolator=function(v){return arguments.length?(u=v,p):u};function h(v){return function(b){var x,j;return arguments.length?([x,j]=b,u=v(x,j),p):[u(0),u(1)]}}return p.range=h(vo),p.rangeRound=h(py),p.unknown=function(v){return arguments.length?(f=v,p):f},function(v){return o=v,n=v(e),a=v(t),l=n===a?0:1/(a-n),p}}function ts(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Jk(){var e=es(Kf()(Ir));return e.copy=function(){return ts(e,Jk())},li.apply(e,arguments)}function eO(){var e=xy(Kf()).domain([1,10]);return e.copy=function(){return ts(e,eO()).base(e.base())},li.apply(e,arguments)}function tO(){var e=by(Kf());return e.copy=function(){return ts(e,tO()).constant(e.constant())},li.apply(e,arguments)}function ky(){var e=yy(Kf());return e.copy=function(){return ts(e,ky()).exponent(e.exponent())},li.apply(e,arguments)}function f9(){return ky.apply(null,arguments).exponent(.5)}function rO(){var e=[],t=Ir;function n(a){if(a!=null&&!isNaN(a=+a))return t((du(e,a,1)-1)/(e.length-1))}return n.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let l of a)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Qi),n},n.interpolator=function(a){return arguments.length?(t=a,n):t},n.range=function(){return e.map((a,l)=>t(l/(e.length-1)))},n.quantiles=function(a){return Array.from({length:a+1},(l,o)=>Z$(e,o/a))},n.copy=function(){return rO(t).domain(e)},li.apply(n,arguments)}function Wf(){var e=0,t=.5,n=1,a=1,l,o,u,d,f,p=Ir,h,v=!1,b;function x(N){return isNaN(N=+N)?b:(N=.5+((N=+h(N))-o)*(a*N<a*o?d:f),p(v?Math.max(0,Math.min(1,N)):N))}x.domain=function(N){return arguments.length?([e,t,n]=N,l=h(e=+e),o=h(t=+t),u=h(n=+n),d=l===o?0:.5/(o-l),f=o===u?0:.5/(u-o),a=o<l?-1:1,x):[e,t,n]},x.clamp=function(N){return arguments.length?(v=!!N,x):v},x.interpolator=function(N){return arguments.length?(p=N,x):p};function j(N){return function(w){var C,E,S;return arguments.length?([C,E,S]=w,p=w7(N,[C,E,S]),x):[p(0),p(.5),p(1)]}}return x.range=j(vo),x.rangeRound=j(py),x.unknown=function(N){return arguments.length?(b=N,x):b},function(N){return h=N,l=N(e),o=N(t),u=N(n),d=l===o?0:.5/(o-l),f=o===u?0:.5/(u-o),a=o<l?-1:1,x}}function nO(){var e=es(Wf()(Ir));return e.copy=function(){return ts(e,nO())},li.apply(e,arguments)}function aO(){var e=xy(Wf()).domain([.1,1,10]);return e.copy=function(){return ts(e,aO()).base(e.base())},li.apply(e,arguments)}function iO(){var e=by(Wf());return e.copy=function(){return ts(e,iO()).constant(e.constant())},li.apply(e,arguments)}function Oy(){var e=yy(Wf());return e.copy=function(){return ts(e,Oy()).exponent(e.exponent())},li.apply(e,arguments)}function p9(){return Oy.apply(null,arguments).exponent(.5)}const Dc=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:dy,scaleDiverging:nO,scaleDivergingLog:aO,scaleDivergingPow:Oy,scaleDivergingSqrt:p9,scaleDivergingSymlog:iO,scaleIdentity:Rk,scaleImplicit:lb,scaleLinear:qk,scaleLog:Lk,scaleOrdinal:uy,scalePoint:t7,scalePow:jy,scaleQuantile:Uk,scaleQuantize:Fk,scaleRadial:Bk,scaleSequential:Jk,scaleSequentialLog:eO,scaleSequentialPow:ky,scaleSequentialQuantile:rO,scaleSequentialSqrt:f9,scaleSequentialSymlog:tO,scaleSqrt:Y7,scaleSymlog:$k,scaleThreshold:Gk,scaleTime:d9,scaleUtc:m9,tickFormat:Tk},Symbol.toStringTag,{value:"Module"}));var oi=e=>e.chartData,sO=de([oi],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Dy=(e,t,n,a)=>a?sO(e):oi(e),h9=(e,t,n)=>n?sO(e):oi(e);function ei(e){if(Array.isArray(e)&&e.length===2){var[t,n]=e;if(st(t)&&st(n))return!0}return!1}function e2(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function lO(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[n,a]=e,l,o;if(st(n))l=n;else if(typeof n=="function")return;if(st(a))o=a;else if(typeof a=="function")return;var u=[l,o];if(ei(u))return u}}function v9(e,t,n){if(!(!n&&t==null)){if(typeof e=="function"&&t!=null)try{var a=e(t,n);if(ei(a))return e2(a,t,n)}catch{}if(Array.isArray(e)&&e.length===2){var[l,o]=e,u,d;if(l==="auto")t!=null&&(u=Math.min(...t));else if(De(l))u=l;else if(typeof l=="function")try{t!=null&&(u=l(t?.[0]))}catch{}else if(typeof l=="string"&&dw.test(l)){var f=dw.exec(l);if(f==null||f[1]==null||t==null)u=void 0;else{var p=+f[1];u=t[0]-p}}else u=t?.[0];if(o==="auto")t!=null&&(d=Math.max(...t));else if(De(o))d=o;else if(typeof o=="function")try{t!=null&&(d=o(t?.[1]))}catch{}else if(typeof o=="string"&&mw.test(o)){var h=mw.exec(o);if(h==null||h[1]==null||t==null)d=void 0;else{var v=+h[1];d=t[1]+v}}else d=t?.[1];var b=[u,d];if(ei(b))return t==null?b:e2(b,t,n)}}}var go=1e9,g9={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Py,Tt=!0,qn="[DecimalError] ",Is=qn+"Invalid argument: ",My=qn+"Exponent out of range: ",xo=Math.floor,As=Math.pow,x9=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,pn,fr=1e7,kt=7,oO=9007199254740991,Xm=xo(oO/kt),ze={};ze.absoluteValue=ze.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ze.comparedTo=ze.cmp=function(e){var t,n,a,l,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(a=o.d.length,l=e.d.length,t=0,n=a<l?a:l;t<n;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return a===l?0:a>l^o.s<0?1:-1};ze.decimalPlaces=ze.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*kt;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};ze.dividedBy=ze.div=function(e){return Ya(this,new this.constructor(e))};ze.dividedToIntegerBy=ze.idiv=function(e){var t=this,n=t.constructor;return Ct(Ya(t,new n(e),0,1),n.precision)};ze.equals=ze.eq=function(e){return!this.cmp(e)};ze.exponent=function(){return er(this)};ze.greaterThan=ze.gt=function(e){return this.cmp(e)>0};ze.greaterThanOrEqualTo=ze.gte=function(e){return this.cmp(e)>=0};ze.isInteger=ze.isint=function(){return this.e>this.d.length-2};ze.isNegative=ze.isneg=function(){return this.s<0};ze.isPositive=ze.ispos=function(){return this.s>0};ze.isZero=function(){return this.s===0};ze.lessThan=ze.lt=function(e){return this.cmp(e)<0};ze.lessThanOrEqualTo=ze.lte=function(e){return this.cmp(e)<1};ze.logarithm=ze.log=function(e){var t,n=this,a=n.constructor,l=a.precision,o=l+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(pn))throw Error(qn+"NaN");if(n.s<1)throw Error(qn+(n.s?"NaN":"-Infinity"));return n.eq(pn)?new a(0):(Tt=!1,t=Ya(Zc(n,o),Zc(e,o),o),Tt=!0,Ct(t,l))};ze.minus=ze.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?dO(t,e):cO(t,(e.s=-e.s,e))};ze.modulo=ze.mod=function(e){var t,n=this,a=n.constructor,l=a.precision;if(e=new a(e),!e.s)throw Error(qn+"NaN");return n.s?(Tt=!1,t=Ya(n,e,0,1).times(e),Tt=!0,n.minus(t)):Ct(new a(n),l)};ze.naturalExponential=ze.exp=function(){return uO(this)};ze.naturalLogarithm=ze.ln=function(){return Zc(this)};ze.negated=ze.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ze.plus=ze.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?cO(t,e):dO(t,(e.s=-e.s,e))};ze.precision=ze.sd=function(e){var t,n,a,l=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Is+e);if(t=er(l)+1,a=l.d.length-1,n=a*kt+1,a=l.d[a],a){for(;a%10==0;a/=10)n--;for(a=l.d[0];a>=10;a/=10)n++}return e&&t>n?t:n};ze.squareRoot=ze.sqrt=function(){var e,t,n,a,l,o,u,d=this,f=d.constructor;if(d.s<1){if(!d.s)return new f(0);throw Error(qn+"NaN")}for(e=er(d),Tt=!1,l=Math.sqrt(+d),l==0||l==1/0?(t=fa(d.d),(t.length+e)%2==0&&(t+="0"),l=Math.sqrt(t),e=xo((e+1)/2)-(e<0||e%2),l==1/0?t="5e"+e:(t=l.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),a=new f(t)):a=new f(l.toString()),n=f.precision,l=u=n+3;;)if(o=a,a=o.plus(Ya(d,o,u+2)).times(.5),fa(o.d).slice(0,u)===(t=fa(a.d)).slice(0,u)){if(t=t.slice(u-3,u+1),l==u&&t=="4999"){if(Ct(o,n+1,0),o.times(o).eq(d)){a=o;break}}else if(t!="9999")break;u+=4}return Tt=!0,Ct(a,n)};ze.times=ze.mul=function(e){var t,n,a,l,o,u,d,f,p,h=this,v=h.constructor,b=h.d,x=(e=new v(e)).d;if(!h.s||!e.s)return new v(0);for(e.s*=h.s,n=h.e+e.e,f=b.length,p=x.length,f<p&&(o=b,b=x,x=o,u=f,f=p,p=u),o=[],u=f+p,a=u;a--;)o.push(0);for(a=p;--a>=0;){for(t=0,l=f+a;l>a;)d=o[l]+x[a]*b[l-a-1]+t,o[l--]=d%fr|0,t=d/fr|0;o[l]=(o[l]+t)%fr|0}for(;!o[--u];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,Tt?Ct(e,v.precision):e};ze.toDecimalPlaces=ze.todp=function(e,t){var n=this,a=n.constructor;return n=new a(n),e===void 0?n:(ya(e,0,go),t===void 0?t=a.rounding:ya(t,0,8),Ct(n,e+er(n)+1,t))};ze.toExponential=function(e,t){var n,a=this,l=a.constructor;return e===void 0?n=Gs(a,!0):(ya(e,0,go),t===void 0?t=l.rounding:ya(t,0,8),a=Ct(new l(a),e+1,t),n=Gs(a,!0,e+1)),n};ze.toFixed=function(e,t){var n,a,l=this,o=l.constructor;return e===void 0?Gs(l):(ya(e,0,go),t===void 0?t=o.rounding:ya(t,0,8),a=Ct(new o(l),e+er(l)+1,t),n=Gs(a.abs(),!1,e+er(a)+1),l.isneg()&&!l.isZero()?"-"+n:n)};ze.toInteger=ze.toint=function(){var e=this,t=e.constructor;return Ct(new t(e),er(e)+1,t.rounding)};ze.toNumber=function(){return+this};ze.toPower=ze.pow=function(e){var t,n,a,l,o,u,d=this,f=d.constructor,p=12,h=+(e=new f(e));if(!e.s)return new f(pn);if(d=new f(d),!d.s){if(e.s<1)throw Error(qn+"Infinity");return d}if(d.eq(pn))return d;if(a=f.precision,e.eq(pn))return Ct(d,a);if(t=e.e,n=e.d.length-1,u=t>=n,o=d.s,u){if((n=h<0?-h:h)<=oO){for(l=new f(pn),t=Math.ceil(a/kt+4),Tt=!1;n%2&&(l=l.times(d),r2(l.d,t)),n=xo(n/2),n!==0;)d=d.times(d),r2(d.d,t);return Tt=!0,e.s<0?new f(pn).div(l):Ct(l,a)}}else if(o<0)throw Error(qn+"NaN");return o=o<0&&e.d[Math.max(t,n)]&1?-1:1,d.s=1,Tt=!1,l=e.times(Zc(d,a+p)),Tt=!0,l=uO(l),l.s=o,l};ze.toPrecision=function(e,t){var n,a,l=this,o=l.constructor;return e===void 0?(n=er(l),a=Gs(l,n<=o.toExpNeg||n>=o.toExpPos)):(ya(e,1,go),t===void 0?t=o.rounding:ya(t,0,8),l=Ct(new o(l),e,t),n=er(l),a=Gs(l,e<=n||n<=o.toExpNeg,e)),a};ze.toSignificantDigits=ze.tosd=function(e,t){var n=this,a=n.constructor;return e===void 0?(e=a.precision,t=a.rounding):(ya(e,1,go),t===void 0?t=a.rounding:ya(t,0,8)),Ct(new a(n),e,t)};ze.toString=ze.valueOf=ze.val=ze.toJSON=ze[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=er(e),n=e.constructor;return Gs(e,t<=n.toExpNeg||t>=n.toExpPos)};function cO(e,t){var n,a,l,o,u,d,f,p,h=e.constructor,v=h.precision;if(!e.s||!t.s)return t.s||(t=new h(e)),Tt?Ct(t,v):t;if(f=e.d,p=t.d,u=e.e,l=t.e,f=f.slice(),o=u-l,o){for(o<0?(a=f,o=-o,d=p.length):(a=p,l=u,d=f.length),u=Math.ceil(v/kt),d=u>d?u+1:d+1,o>d&&(o=d,a.length=1),a.reverse();o--;)a.push(0);a.reverse()}for(d=f.length,o=p.length,d-o<0&&(o=d,a=p,p=f,f=a),n=0;o;)n=(f[--o]=f[o]+p[o]+n)/fr|0,f[o]%=fr;for(n&&(f.unshift(n),++l),d=f.length;f[--d]==0;)f.pop();return t.d=f,t.e=l,Tt?Ct(t,v):t}function ya(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Is+e)}function fa(e){var t,n,a,l=e.length-1,o="",u=e[0];if(l>0){for(o+=u,t=1;t<l;t++)a=e[t]+"",n=kt-a.length,n&&(o+=$i(n)),o+=a;u=e[t],a=u+"",n=kt-a.length,n&&(o+=$i(n))}else if(u===0)return"0";for(;u%10===0;)u/=10;return o+u}var Ya=(function(){function e(a,l){var o,u=0,d=a.length;for(a=a.slice();d--;)o=a[d]*l+u,a[d]=o%fr|0,u=o/fr|0;return u&&a.unshift(u),a}function t(a,l,o,u){var d,f;if(o!=u)f=o>u?1:-1;else for(d=f=0;d<o;d++)if(a[d]!=l[d]){f=a[d]>l[d]?1:-1;break}return f}function n(a,l,o){for(var u=0;o--;)a[o]-=u,u=a[o]<l[o]?1:0,a[o]=u*fr+a[o]-l[o];for(;!a[0]&&a.length>1;)a.shift()}return function(a,l,o,u){var d,f,p,h,v,b,x,j,N,w,C,E,S,A,O,k,M,D,$=a.constructor,U=a.s==l.s?1:-1,L=a.d,B=l.d;if(!a.s)return new $(a);if(!l.s)throw Error(qn+"Division by zero");for(f=a.e-l.e,M=B.length,O=L.length,x=new $(U),j=x.d=[],p=0;B[p]==(L[p]||0);)++p;if(B[p]>(L[p]||0)&&--f,o==null?E=o=$.precision:u?E=o+(er(a)-er(l))+1:E=o,E<0)return new $(0);if(E=E/kt+2|0,p=0,M==1)for(h=0,B=B[0],E++;(p<O||h)&&E--;p++)S=h*fr+(L[p]||0),j[p]=S/B|0,h=S%B|0;else{for(h=fr/(B[0]+1)|0,h>1&&(B=e(B,h),L=e(L,h),M=B.length,O=L.length),A=M,N=L.slice(0,M),w=N.length;w<M;)N[w++]=0;D=B.slice(),D.unshift(0),k=B[0],B[1]>=fr/2&&++k;do h=0,d=t(B,N,M,w),d<0?(C=N[0],M!=w&&(C=C*fr+(N[1]||0)),h=C/k|0,h>1?(h>=fr&&(h=fr-1),v=e(B,h),b=v.length,w=N.length,d=t(v,N,b,w),d==1&&(h--,n(v,M<b?D:B,b))):(h==0&&(d=h=1),v=B.slice()),b=v.length,b<w&&v.unshift(0),n(N,v,w),d==-1&&(w=N.length,d=t(B,N,M,w),d<1&&(h++,n(N,M<w?D:B,w))),w=N.length):d===0&&(h++,N=[0]),j[p++]=h,d&&N[0]?N[w++]=L[A]||0:(N=[L[A]],w=1);while((A++<O||N[0]!==void 0)&&E--)}return j[0]||j.shift(),x.e=f,Ct(x,u?o+er(x)+1:o)}})();function uO(e,t){var n,a,l,o,u,d,f=0,p=0,h=e.constructor,v=h.precision;if(er(e)>16)throw Error(My+er(e));if(!e.s)return new h(pn);for(Tt=!1,d=v,u=new h(.03125);e.abs().gte(.1);)e=e.times(u),p+=5;for(a=Math.log(As(2,p))/Math.LN10*2+5|0,d+=a,n=l=o=new h(pn),h.precision=d;;){if(l=Ct(l.times(e),d),n=n.times(++f),u=o.plus(Ya(l,n,d)),fa(u.d).slice(0,d)===fa(o.d).slice(0,d)){for(;p--;)o=Ct(o.times(o),d);return h.precision=v,t==null?(Tt=!0,Ct(o,v)):o}o=u}}function er(e){for(var t=e.e*kt,n=e.d[0];n>=10;n/=10)t++;return t}function rx(e,t,n){if(t>e.LN10.sd())throw Tt=!0,n&&(e.precision=n),Error(qn+"LN10 precision limit exceeded");return Ct(new e(e.LN10),t)}function $i(e){for(var t="";e--;)t+="0";return t}function Zc(e,t){var n,a,l,o,u,d,f,p,h,v=1,b=10,x=e,j=x.d,N=x.constructor,w=N.precision;if(x.s<1)throw Error(qn+(x.s?"NaN":"-Infinity"));if(x.eq(pn))return new N(0);if(t==null?(Tt=!1,p=w):p=t,x.eq(10))return t==null&&(Tt=!0),rx(N,p);if(p+=b,N.precision=p,n=fa(j),a=n.charAt(0),o=er(x),Math.abs(o)<15e14){for(;a<7&&a!=1||a==1&&n.charAt(1)>3;)x=x.times(e),n=fa(x.d),a=n.charAt(0),v++;o=er(x),a>1?(x=new N("0."+n),o++):x=new N(a+"."+n.slice(1))}else return f=rx(N,p+2,w).times(o+""),x=Zc(new N(a+"."+n.slice(1)),p-b).plus(f),N.precision=w,t==null?(Tt=!0,Ct(x,w)):x;for(d=u=x=Ya(x.minus(pn),x.plus(pn),p),h=Ct(x.times(x),p),l=3;;){if(u=Ct(u.times(h),p),f=d.plus(Ya(u,new N(l),p)),fa(f.d).slice(0,p)===fa(d.d).slice(0,p))return d=d.times(2),o!==0&&(d=d.plus(rx(N,p+2,w).times(o+""))),d=Ya(d,new N(v),p),N.precision=w,t==null?(Tt=!0,Ct(d,w)):d;d=f,l+=2}}function t2(e,t){var n,a,l;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(n<0&&(n=a),n+=+t.slice(a+1),t=t.substring(0,a)):n<0&&(n=t.length),a=0;t.charCodeAt(a)===48;)++a;for(l=t.length;t.charCodeAt(l-1)===48;)--l;if(t=t.slice(a,l),t){if(l-=a,n=n-a-1,e.e=xo(n/kt),e.d=[],a=(n+1)%kt,n<0&&(a+=kt),a<l){for(a&&e.d.push(+t.slice(0,a)),l-=kt;a<l;)e.d.push(+t.slice(a,a+=kt));t=t.slice(a),a=kt-t.length}else a-=l;for(;a--;)t+="0";if(e.d.push(+t),Tt&&(e.e>Xm||e.e<-Xm))throw Error(My+n)}else e.s=0,e.e=0,e.d=[0];return e}function Ct(e,t,n){var a,l,o,u,d,f,p,h,v=e.d;for(u=1,o=v[0];o>=10;o/=10)u++;if(a=t-u,a<0)a+=kt,l=t,p=v[h=0];else{if(h=Math.ceil((a+1)/kt),o=v.length,h>=o)return e;for(p=o=v[h],u=1;o>=10;o/=10)u++;a%=kt,l=a-kt+u}if(n!==void 0&&(o=As(10,u-l-1),d=p/o%10|0,f=t<0||v[h+1]!==void 0||p%o,f=n<4?(d||f)&&(n==0||n==(e.s<0?3:2)):d>5||d==5&&(n==4||f||n==6&&(a>0?l>0?p/As(10,u-l):0:v[h-1])%10&1||n==(e.s<0?8:7))),t<1||!v[0])return f?(o=er(e),v.length=1,t=t-o-1,v[0]=As(10,(kt-t%kt)%kt),e.e=xo(-t/kt)||0):(v.length=1,v[0]=e.e=e.s=0),e;if(a==0?(v.length=h,o=1,h--):(v.length=h+1,o=As(10,kt-a),v[h]=l>0?(p/As(10,u-l)%As(10,l)|0)*o:0),f)for(;;)if(h==0){(v[0]+=o)==fr&&(v[0]=1,++e.e);break}else{if(v[h]+=o,v[h]!=fr)break;v[h--]=0,o=1}for(a=v.length;v[--a]===0;)v.pop();if(Tt&&(e.e>Xm||e.e<-Xm))throw Error(My+er(e));return e}function dO(e,t){var n,a,l,o,u,d,f,p,h,v,b=e.constructor,x=b.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new b(e),Tt?Ct(t,x):t;if(f=e.d,v=t.d,a=t.e,p=e.e,f=f.slice(),u=p-a,u){for(h=u<0,h?(n=f,u=-u,d=v.length):(n=v,a=p,d=f.length),l=Math.max(Math.ceil(x/kt),d)+2,u>l&&(u=l,n.length=1),n.reverse(),l=u;l--;)n.push(0);n.reverse()}else{for(l=f.length,d=v.length,h=l<d,h&&(d=l),l=0;l<d;l++)if(f[l]!=v[l]){h=f[l]<v[l];break}u=0}for(h&&(n=f,f=v,v=n,t.s=-t.s),d=f.length,l=v.length-d;l>0;--l)f[d++]=0;for(l=v.length;l>u;){if(f[--l]<v[l]){for(o=l;o&&f[--o]===0;)f[o]=fr-1;--f[o],f[l]+=fr}f[l]-=v[l]}for(;f[--d]===0;)f.pop();for(;f[0]===0;f.shift())--a;return f[0]?(t.d=f,t.e=a,Tt?Ct(t,x):t):new b(0)}function Gs(e,t,n){var a,l=er(e),o=fa(e.d),u=o.length;return t?(n&&(a=n-u)>0?o=o.charAt(0)+"."+o.slice(1)+$i(a):u>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(l<0?"e":"e+")+l):l<0?(o="0."+$i(-l-1)+o,n&&(a=n-u)>0&&(o+=$i(a))):l>=u?(o+=$i(l+1-u),n&&(a=n-l-1)>0&&(o=o+"."+$i(a))):((a=l+1)<u&&(o=o.slice(0,a)+"."+o.slice(a)),n&&(a=n-u)>0&&(l+1===u&&(o+="."),o+=$i(a))),e.s<0?"-"+o:o}function r2(e,t){if(e.length>t)return e.length=t,!0}function mO(e){var t,n,a;function l(o){var u=this;if(!(u instanceof l))return new l(o);if(u.constructor=l,o instanceof l){u.s=o.s,u.e=o.e,u.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(Is+o);if(o>0)u.s=1;else if(o<0)o=-o,u.s=-1;else{u.s=0,u.e=0,u.d=[0];return}if(o===~~o&&o<1e7){u.e=0,u.d=[o];return}return t2(u,o.toString())}else if(typeof o!="string")throw Error(Is+o);if(o.charCodeAt(0)===45?(o=o.slice(1),u.s=-1):u.s=1,x9.test(o))t2(u,o);else throw Error(Is+o)}if(l.prototype=ze,l.ROUND_UP=0,l.ROUND_DOWN=1,l.ROUND_CEIL=2,l.ROUND_FLOOR=3,l.ROUND_HALF_UP=4,l.ROUND_HALF_DOWN=5,l.ROUND_HALF_EVEN=6,l.ROUND_HALF_CEIL=7,l.ROUND_HALF_FLOOR=8,l.clone=mO,l.config=l.set=b9,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<a.length;)e.hasOwnProperty(n=a[t++])||(e[n]=this[n]);return l.config(e),l}function b9(e){if(!e||typeof e!="object")throw Error(qn+"Object expected");var t,n,a,l=["precision",1,go,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<l.length;t+=3)if((a=e[n=l[t]])!==void 0)if(xo(a)===a&&a>=l[t+1]&&a<=l[t+2])this[n]=a;else throw Error(Is+n+": "+a);if((a=e[n="LN10"])!==void 0)if(a==Math.LN10)this[n]=new this(a);else throw Error(Is+n+": "+a);return this}var Py=mO(g9);pn=new Py(1);const vt=Py;function fO(e){var t;return e===0?t=1:t=Math.floor(new vt(e).abs().log(10).toNumber())+1,t}function pO(e,t,n){for(var a=new vt(e),l=0,o=[];a.lt(t)&&l<1e5;)o.push(a.toNumber()),a=a.add(n),l++;return o}var hO=e=>{var[t,n]=e,[a,l]=[t,n];return t>n&&([a,l]=[n,t]),[a,l]},vO=(e,t,n)=>{if(e.lte(0))return new vt(0);var a=fO(e.toNumber()),l=new vt(10).pow(a),o=e.div(l),u=a!==1?.05:.1,d=new vt(Math.ceil(o.div(u).toNumber())).add(n).mul(u),f=d.mul(l);return t?new vt(f.toNumber()):new vt(Math.ceil(f.toNumber()))},y9=(e,t,n)=>{var a=new vt(1),l=new vt(e);if(!l.isint()&&n){var o=Math.abs(e);o<1?(a=new vt(10).pow(fO(e)-1),l=new vt(Math.floor(l.div(a).toNumber())).mul(a)):o>1&&(l=new vt(Math.floor(e)))}else e===0?l=new vt(Math.floor((t-1)/2)):n||(l=new vt(Math.floor(e)));for(var u=Math.floor((t-1)/2),d=[],f=0;f<t;f++)d.push(l.add(new vt(f-u).mul(a)).toNumber());return d},gO=function(t,n,a,l){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-t)/(a-1)))return{step:new vt(0),tickMin:new vt(0),tickMax:new vt(0)};var u=vO(new vt(n).sub(t).div(a-1),l,o),d;t<=0&&n>=0?d=new vt(0):(d=new vt(t).add(n).div(2),d=d.sub(new vt(d).mod(u)));var f=Math.ceil(d.sub(t).div(u).toNumber()),p=Math.ceil(new vt(n).sub(d).div(u).toNumber()),h=f+p+1;return h>a?gO(t,n,a,l,o+1):(h<a&&(p=n>0?p+(a-h):p,f=n>0?f:f+(a-h)),{step:u,tickMin:d.sub(new vt(f).mul(u)),tickMax:d.add(new vt(p).mul(u))})},j9=function(t){var[n,a]=t,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,u=Math.max(l,2),[d,f]=hO([n,a]);if(d===-1/0||f===1/0){var p=f===1/0?[d,...Array(l-1).fill(1/0)]:[...Array(l-1).fill(-1/0),f];return n>a?p.reverse():p}if(d===f)return y9(d,l,o);var{step:h,tickMin:v,tickMax:b}=gO(d,f,u,o,0),x=pO(v,b.add(new vt(.1).mul(h)),h);return n>a?x.reverse():x},N9=function(t,n){var[a,l]=t,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[u,d]=hO([a,l]);if(u===-1/0||d===1/0)return[a,l];if(u===d)return[u];var f=Math.max(n,2),p=vO(new vt(d).sub(u).div(f-1),o,0),h=[...pO(new vt(u),new vt(d),p),d];return o===!1&&(h=h.map(v=>Math.round(v))),a>l?h.reverse():h},xO=e=>e.rootProps.maxBarSize,_9=e=>e.rootProps.barGap,bO=e=>e.rootProps.barCategoryGap,S9=e=>e.rootProps.barSize,Xf=e=>e.rootProps.stackOffset,yO=e=>e.rootProps.reverseStackOrder,Ty=e=>e.options.chartName,qy=e=>e.rootProps.syncId,jO=e=>e.rootProps.syncMethod,Ry=e=>e.options.eventEmitter,pr={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Ss={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},ca={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},Zf=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};function Jf(e,t,n){if(n!=="auto")return n;if(e!=null)return ai(e,t)?"category":"number"}function n2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Zm(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?n2(Object(n),!0).forEach(function(a){w9(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):n2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function w9(e,t,n){return(t=C9(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C9(e){var t=E9(e,"string");return typeof t=="symbol"?t:t+""}function E9(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var a2={allowDataOverflow:Ss.allowDataOverflow,allowDecimals:Ss.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ss.angleAxisId,includeHidden:!1,name:void 0,reversed:Ss.reversed,scale:Ss.scale,tick:Ss.tick,tickCount:void 0,ticks:void 0,type:Ss.type,unit:void 0},i2={allowDataOverflow:ca.allowDataOverflow,allowDecimals:ca.allowDecimals,allowDuplicatedCategory:ca.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ca.radiusAxisId,includeHidden:ca.includeHidden,name:void 0,reversed:ca.reversed,scale:ca.scale,tick:ca.tick,tickCount:ca.tickCount,ticks:void 0,type:ca.type,unit:void 0},A9=(e,t)=>{if(t!=null)return e.polarAxis.angleAxis[t]},Iy=de([A9,ok],(e,t)=>{var n;if(e!=null)return e;var a=(n=Jf(t,"angleAxis",a2.type))!==null&&n!==void 0?n:"category";return Zm(Zm({},a2),{},{type:a})}),z9=(e,t)=>e.polarAxis.radiusAxis[t],Ly=de([z9,ok],(e,t)=>{var n;if(e!=null)return e;var a=(n=Jf(t,"radiusAxis",i2.type))!==null&&n!==void 0?n:"category";return Zm(Zm({},i2),{},{type:a})}),ep=e=>e.polarOptions,$y=de([ii,si,hr],C$),NO=de([ep,$y],(e,t)=>{if(e!=null)return Xn(e.innerRadius,t,0)}),_O=de([ep,$y],(e,t)=>{if(e!=null)return Xn(e.outerRadius,t,t*.8)}),k9=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]},SO=de([ep],k9);de([Iy,SO],Zf);var wO=de([$y,NO,_O],(e,t,n)=>{if(!(e==null||t==null||n==null))return[t,n]});de([Ly,wO],Zf);var CO=de([gt,ep,NO,_O,ii,si],(e,t,n,a,l,o)=>{if(!(e!=="centric"&&e!=="radial"||t==null||n==null||a==null)){var{cx:u,cy:d,startAngle:f,endAngle:p}=t;return{cx:Xn(u,l,l/2),cy:Xn(d,o,o/2),innerRadius:n,outerRadius:a,startAngle:f,endAngle:p,clockWise:!1}}}),gr=(e,t)=>t,tp=(e,t,n)=>n;function By(e){return e?.id}function EO(e,t,n){var{chartData:a=[]}=t,{allowDuplicatedCategory:l,dataKey:o}=n,u=new Map;return e.forEach(d=>{var f,p=(f=d.data)!==null&&f!==void 0?f:a;if(!(p==null||p.length===0)){var h=By(d);p.forEach((v,b)=>{var x=o==null||l?b:String(Jt(v,o,null)),j=Jt(v,d.dataKey,0),N;u.has(x)?N=u.get(x):N={},Object.assign(N,{[h]:j}),u.set(x,N)})}}),Array.from(u.values())}function rp(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var np=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function ap(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function O9(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}var xr=e=>{var t=gt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},bo=e=>e.tooltip.settings.axisId;function D9(e){if(e in Dc)return Dc[e]();var t="scale".concat(iu(e));if(t in Dc)return Dc[t]()}function s2(e){var t=e.ticks,n=e.bandwidth,a=e.range(),l=[Math.min(...a),Math.max(...a)];return{domain:()=>e.domain(),range:(function(o){function u(){return o.apply(this,arguments)}return u.toString=function(){return o.toString()},u})(()=>l),rangeMin:()=>l[0],rangeMax:()=>l[1],isInRange(o){var u=l[0],d=l[1];return u<=d?o>=u&&o<=d:o>=d&&o<=u},bandwidth:n?()=>n.call(e):void 0,ticks:t?o=>t.call(e,o):void 0,map:(o,u)=>{var d=e(o);if(d!=null){if(e.bandwidth&&u!==null&&u!==void 0&&u.position){var f=e.bandwidth();switch(u.position){case"middle":d+=f/2;break;case"end":d+=f;break}}return d}}}}function l2(e,t,n){if(typeof e=="function")return s2(e.copy().domain(t).range(n));if(e!=null){var a=D9(e);if(a!=null)return a.domain(t).range(n),s2(a)}}var M9=(e,t)=>{if(t!=null)switch(e){case"linear":{if(!ei(t)){for(var n,a,l=0;l<t.length;l++){var o=t[l];st(o)&&((n===void 0||o<n)&&(n=o),(a===void 0||o>a)&&(a=o))}return n!==void 0&&a!==void 0?[n,a]:void 0}return t}default:return t}};function o2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Jm(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?o2(Object(n),!0).forEach(function(a){P9(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function P9(e,t,n){return(t=T9(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T9(e){var t=q9(e,"string");return typeof t=="symbol"?t:t+""}function q9(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var db=[0,"auto"],ur={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},AO=(e,t)=>e.cartesianAxis.xAxis[t],ci=(e,t)=>{var n=AO(e,t);return n??ur},dr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:db,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:ou},zO=(e,t)=>e.cartesianAxis.yAxis[t],ui=(e,t)=>{var n=zO(e,t);return n??dr},R9={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Uy=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return n??R9},Fr=(e,t,n)=>{switch(t){case"xAxis":return ci(e,n);case"yAxis":return ui(e,n);case"zAxis":return Uy(e,n);case"angleAxis":return Iy(e,n);case"radiusAxis":return Ly(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},I9=(e,t,n)=>{switch(t){case"xAxis":return ci(e,n);case"yAxis":return ui(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},hu=(e,t,n)=>{switch(t){case"xAxis":return ci(e,n);case"yAxis":return ui(e,n);case"angleAxis":return Iy(e,n);case"radiusAxis":return Ly(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},kO=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function OO(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var ip=e=>e.graphicalItems.cartesianItems,L9=de([gr,tp],OO),DO=(e,t,n)=>e.filter(n).filter(a=>t?.includeHidden===!0?!0:!a.hide),vu=de([ip,Fr,L9],DO,{memoizeOptions:{resultEqualityCheck:ap}}),MO=de([vu],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(rp)),PO=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),$9=de([vu],PO),TO=e=>e.map(t=>t.data).filter(Boolean).flat(1),B9=de([vu],TO,{memoizeOptions:{resultEqualityCheck:ap}}),qO=(e,t)=>{var{chartData:n=[],dataStartIndex:a,dataEndIndex:l}=t;return e.length>0?e:n.slice(a,l+1)},Fy=de([B9,Dy],qO),RO=(e,t,n)=>t?.dataKey!=null?e.map(a=>({value:Jt(a,t.dataKey)})):n.length>0?n.map(a=>a.dataKey).flatMap(a=>e.map(l=>({value:Jt(l,a)}))):e.map(a=>({value:a})),sp=de([Fy,Fr,vu],RO);function IO(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function om(e){if(xa(e)||e instanceof Date){var t=Number(e);if(st(t))return t}}function c2(e){if(Array.isArray(e)){var t=[om(e[0]),om(e[1])];return ei(t)?t:void 0}var n=om(e);if(n!=null)return[n,n]}function ti(e){return e.map(om).filter(en)}function U9(e,t,n){return!n||typeof t!="number"||ga(t)?[]:n.length?ti(n.flatMap(a=>{var l=Jt(e,a.dataKey),o,u;if(Array.isArray(l)?[o,u]=l:o=u=l,!(!st(o)||!st(u)))return[t-o,t+u]})):[]}var sr=e=>{var t=xr(e),n=bo(e);return hu(e,t,n)},gu=de([sr],e=>e?.dataKey),F9=de([MO,Dy,sr],EO),LO=(e,t,n,a)=>{var l={},o=t.reduce((u,d)=>{if(d.stackId==null)return u;var f=u[d.stackId];return f==null&&(f=[]),f.push(d),u[d.stackId]=f,u},l);return Object.fromEntries(Object.entries(o).map(u=>{var[d,f]=u,p=a?[...f].reverse():f,h=p.map(By);return[d,{stackedData:gL(e,h,n),graphicalItems:p}]}))},mb=de([F9,MO,Xf,yO],LO),$O=(e,t,n,a)=>{var{dataStartIndex:l,dataEndIndex:o}=t;if(a==null&&n!=="zAxis"){var u=NL(e,l,o);if(!(u!=null&&u[0]===0&&u[1]===0))return u}},G9=de([Fr],e=>e.allowDataOverflow),Gy=e=>{var t;if(e==null||!("domain"in e))return db;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var n=ti(e.ticks);return[Math.min(...n),Math.max(...n)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:db},BO=de([Fr],Gy),UO=de([BO,G9],lO),H9=de([mb,oi,gr,UO],$O,{memoizeOptions:{resultEqualityCheck:np}}),Hy=e=>e.errorBars,Q9=(e,t,n)=>e.flatMap(a=>t[a.id]).filter(Boolean).filter(a=>IO(n,a)),ef=function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];var l=n.filter(Boolean);if(l.length!==0){var o=l.flat(),u=Math.min(...o),d=Math.max(...o);return[u,d]}},FO=(e,t,n,a,l)=>{var o,u;if(n.length>0&&e.forEach(d=>{n.forEach(f=>{var p,h,v=(p=a[f.id])===null||p===void 0?void 0:p.filter(C=>IO(l,C)),b=Jt(d,(h=t.dataKey)!==null&&h!==void 0?h:f.dataKey),x=U9(d,b,v);if(x.length>=2){var j=Math.min(...x),N=Math.max(...x);(o==null||j<o)&&(o=j),(u==null||N>u)&&(u=N)}var w=c2(b);w!=null&&(o=o==null?w[0]:Math.min(o,w[0]),u=u==null?w[1]:Math.max(u,w[1]))})}),t?.dataKey!=null&&e.forEach(d=>{var f=c2(Jt(d,t.dataKey));f!=null&&(o=o==null?f[0]:Math.min(o,f[0]),u=u==null?f[1]:Math.max(u,f[1]))}),st(o)&&st(u))return[o,u]},V9=de([Fy,Fr,$9,Hy,gr],FO,{memoizeOptions:{resultEqualityCheck:np}});function Y9(e){var{value:t}=e;if(xa(t)||t instanceof Date)return t}var K9=(e,t,n)=>{var a=e.map(Y9).filter(l=>l!=null);return n&&(t.dataKey==null||t.allowDuplicatedCategory&&iz(a))?Ck(0,e.length):t.allowDuplicatedCategory?a:Array.from(new Set(a))},GO=e=>e.referenceElements.dots,yo=(e,t,n)=>e.filter(a=>a.ifOverflow==="extendDomain").filter(a=>t==="xAxis"?a.xAxisId===n:a.yAxisId===n),W9=de([GO,gr,tp],yo),HO=e=>e.referenceElements.areas,X9=de([HO,gr,tp],yo),QO=e=>e.referenceElements.lines,Z9=de([QO,gr,tp],yo),VO=(e,t)=>{if(e!=null){var n=ti(e.map(a=>t==="xAxis"?a.x:a.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},J9=de(W9,gr,VO),YO=(e,t)=>{if(e!=null){var n=ti(e.flatMap(a=>[t==="xAxis"?a.x1:a.y1,t==="xAxis"?a.x2:a.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},eU=de([X9,gr],YO);function tU(e){var t;if(e.x!=null)return ti([e.x]);var n=(t=e.segment)===null||t===void 0?void 0:t.map(a=>a.x);return n==null||n.length===0?[]:ti(n)}function rU(e){var t;if(e.y!=null)return ti([e.y]);var n=(t=e.segment)===null||t===void 0?void 0:t.map(a=>a.y);return n==null||n.length===0?[]:ti(n)}var KO=(e,t)=>{if(e!=null){var n=e.flatMap(a=>t==="xAxis"?tU(a):rU(a));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},nU=de([Z9,gr],KO),aU=de(J9,nU,eU,(e,t,n)=>ef(e,n,t)),WO=(e,t,n,a,l,o,u,d)=>{if(n!=null)return n;var f=u==="vertical"&&d==="xAxis"||u==="horizontal"&&d==="yAxis",p=f?ef(a,o,l):ef(o,l);return v9(t,p,e.allowDataOverflow)},iU=de([Fr,BO,UO,H9,V9,aU,gt,gr],WO,{memoizeOptions:{resultEqualityCheck:np}}),sU=[0,1],XO=(e,t,n,a,l,o,u)=>{if(!((e==null||n==null||n.length===0)&&u===void 0)){var{dataKey:d,type:f}=e,p=ai(t,o);if(p&&d==null){var h;return Ck(0,(h=n?.length)!==null&&h!==void 0?h:0)}return f==="category"?K9(a,e,p):l==="expand"?sU:u}},Qy=de([Fr,gt,Fy,sp,Xf,gr,iU],XO);function lU(e){return e in Dc}var ZO=(e,t,n)=>{if(e!=null){var{scale:a,type:l}=e;if(a==="auto")return l==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!t)?"point":l==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(iu(a));return lU(o)?o:"point"}}},jo=de([Fr,kO,Ty],ZO);function Vy(e,t,n,a){if(!(n==null||a==null))return typeof e.scale=="function"?l2(e.scale,n,a):l2(t,n,a)}var JO=(e,t,n)=>{var a=Gy(t);if(!(n!=="auto"&&n!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(a)&&(a[0]==="auto"||a[1]==="auto")&&ei(e))return j9(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&ei(e))return N9(e,t.tickCount,t.allowDecimals)}},Yy=de([Qy,hu,jo],JO),eD=(e,t,n,a)=>{if(a!=="angleAxis"&&e?.type==="number"&&ei(t)&&Array.isArray(n)&&n.length>0){var l,o,u=t[0],d=(l=n[0])!==null&&l!==void 0?l:0,f=t[1],p=(o=n[n.length-1])!==null&&o!==void 0?o:0;return[Math.min(u,d),Math.max(f,p)]}return t},oU=de([Fr,Qy,Yy,gr],eD),cU=de(sp,Fr,(e,t)=>{if(!(!t||t.type!=="number")){var n=1/0,a=Array.from(ti(e.map(v=>v.value))).sort((v,b)=>v-b),l=a[0],o=a[a.length-1];if(l==null||o==null)return 1/0;var u=o-l;if(u===0)return 1/0;for(var d=0;d<a.length-1;d++){var f=a[d],p=a[d+1];if(!(f==null||p==null)){var h=p-f;n=Math.min(n,h)}}return n/u}}),tD=de(cU,gt,bO,hr,(e,t,n,a,l)=>l,(e,t,n,a,l)=>{if(!st(e))return 0;var o=t==="vertical"?a.height:a.width;if(l==="gap")return e*o/2;if(l==="no-gap"){var u=Xn(n,e*o),d=e*o/2;return d-u-(d-u)/o*u}return 0}),uU=(e,t,n)=>{var a=ci(e,t);return a==null||typeof a.padding!="string"?0:tD(e,"xAxis",t,n,a.padding)},dU=(e,t,n)=>{var a=ui(e,t);return a==null||typeof a.padding!="string"?0:tD(e,"yAxis",t,n,a.padding)},mU=de(ci,uU,(e,t)=>{var n,a;if(e==null)return{left:0,right:0};var{padding:l}=e;return typeof l=="string"?{left:t,right:t}:{left:((n=l.left)!==null&&n!==void 0?n:0)+t,right:((a=l.right)!==null&&a!==void 0?a:0)+t}}),fU=de(ui,dU,(e,t)=>{var n,a;if(e==null)return{top:0,bottom:0};var{padding:l}=e;return typeof l=="string"?{top:t,bottom:t}:{top:((n=l.top)!==null&&n!==void 0?n:0)+t,bottom:((a=l.bottom)!==null&&a!==void 0?a:0)+t}}),pU=de([hr,mU,Rf,qf,(e,t,n)=>n],(e,t,n,a,l)=>{var{padding:o}=a;return l?[o.left,n.width-o.right]:[e.left+t.left,e.left+e.width-t.right]}),hU=de([hr,gt,fU,Rf,qf,(e,t,n)=>n],(e,t,n,a,l,o)=>{var{padding:u}=l;return o?[a.height-u.bottom,u.top]:t==="horizontal"?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),xu=(e,t,n,a)=>{var l;switch(t){case"xAxis":return pU(e,n,a);case"yAxis":return hU(e,n,a);case"zAxis":return(l=Uy(e,n))===null||l===void 0?void 0:l.range;case"angleAxis":return SO(e);case"radiusAxis":return wO(e,n);default:return}},rD=de([Fr,xu],Zf),vU=de([jo,oU],M9),lp=de([Fr,jo,vU,rD],Vy);de([vu,Hy,gr],Q9);function nD(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var op=(e,t)=>t,cp=(e,t,n)=>n,gU=de(Pf,op,cp,(e,t,n)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===n).sort(nD)),xU=de(Tf,op,cp,(e,t,n)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===n).sort(nD)),aD=(e,t)=>({width:e.width,height:t.height}),bU=(e,t)=>{var n=typeof t.width=="number"?t.width:ou;return{width:n,height:e.height}},iD=de(hr,ci,aD),yU=(e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}},jU=(e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}},NU=de(si,hr,gU,op,cp,(e,t,n,a,l)=>{var o={},u;return n.forEach(d=>{var f=aD(t,d);u==null&&(u=yU(t,a,e));var p=a==="top"&&!l||a==="bottom"&&l;o[d.id]=u-Number(p)*f.height,u+=(p?-1:1)*f.height}),o}),_U=de(ii,hr,xU,op,cp,(e,t,n,a,l)=>{var o={},u;return n.forEach(d=>{var f=bU(t,d);u==null&&(u=jU(t,a,e));var p=a==="left"&&!l||a==="right"&&l;o[d.id]=u-Number(p)*f.width,u+=(p?-1:1)*f.width}),o}),SU=(e,t)=>{var n=ci(e,t);if(n!=null)return NU(e,n.orientation,n.mirror)},wU=de([hr,ci,SU,(e,t)=>t],(e,t,n,a)=>{if(t!=null){var l=n?.[a];return l==null?{x:e.left,y:0}:{x:e.left,y:l}}}),CU=(e,t)=>{var n=ui(e,t);if(n!=null)return _U(e,n.orientation,n.mirror)},EU=de([hr,ui,CU,(e,t)=>t],(e,t,n,a)=>{if(t!=null){var l=n?.[a];return l==null?{x:0,y:e.top}:{x:l,y:e.top}}}),sD=de(hr,ui,(e,t)=>{var n=typeof t.width=="number"?t.width:ou;return{width:n,height:e.height}}),u2=(e,t,n)=>{switch(t){case"xAxis":return iD(e,n).width;case"yAxis":return sD(e,n).height;default:return}},lD=(e,t,n,a)=>{if(n!=null){var{allowDuplicatedCategory:l,type:o,dataKey:u}=n,d=ai(e,a),f=t.map(p=>p.value);if(u&&d&&o==="category"&&l&&iz(f))return f}},Ky=de([gt,sp,Fr,gr],lD),oD=(e,t,n,a)=>{if(!(n==null||n.dataKey==null)){var{type:l,scale:o}=n,u=ai(e,a);if(u&&(l==="number"||o!=="auto"))return t.map(d=>d.value)}},Wy=de([gt,sp,hu,gr],oD),d2=de([gt,I9,jo,lp,Ky,Wy,xu,Yy,gr],(e,t,n,a,l,o,u,d,f)=>{if(t!=null){var p=ai(e,f);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:f,categoricalDomain:o,duplicateDomain:l,isCategorical:p,niceTicks:d,range:u,realScaleType:n,scale:a}}}),AU=(e,t,n,a,l,o,u,d,f)=>{if(!(t==null||a==null)){var p=ai(e,f),{type:h,ticks:v,tickCount:b}=t,x=n==="scaleBand"&&typeof a.bandwidth=="function"?a.bandwidth()/2:2,j=h==="category"&&a.bandwidth?a.bandwidth()/x:0;j=f==="angleAxis"&&o!=null&&o.length>=2?Jr(o[0]-o[1])*2*j:j;var N=v||l;return N?N.map((w,C)=>{var E=u?u.indexOf(w):w,S=a.map(E);return st(S)?{index:C,coordinate:S+j,value:w,offset:j}:null}).filter(en):p&&d?d.map((w,C)=>{var E=a.map(w);return st(E)?{coordinate:E+j,value:w,index:C,offset:j}:null}).filter(en):a.ticks?a.ticks(b).map((w,C)=>{var E=a.map(w);return st(E)?{coordinate:E+j,value:w,index:C,offset:j}:null}).filter(en):a.domain().map((w,C)=>{var E=a.map(w);return st(E)?{coordinate:E+j,value:u?u[w]:w,index:C,offset:j}:null}).filter(en)}},cD=de([gt,hu,jo,lp,Yy,xu,Ky,Wy,gr],AU),zU=(e,t,n,a,l,o,u)=>{if(!(t==null||n==null||a==null||a[0]===a[1])){var d=ai(e,u),{tickCount:f}=t,p=0;return p=u==="angleAxis"&&a?.length>=2?Jr(a[0]-a[1])*2*p:p,d&&o?o.map((h,v)=>{var b=n.map(h);return st(b)?{coordinate:b+p,value:h,index:v,offset:p}:null}).filter(en):n.ticks?n.ticks(f).map((h,v)=>{var b=n.map(h);return st(b)?{coordinate:b+p,value:h,index:v,offset:p}:null}).filter(en):n.domain().map((h,v)=>{var b=n.map(h);return st(b)?{coordinate:b+p,value:l?l[h]:h,index:v,offset:p}:null}).filter(en)}},Xi=de([gt,hu,lp,xu,Ky,Wy,gr],zU),Zi=de(Fr,lp,(e,t)=>{if(!(e==null||t==null))return Jm(Jm({},e),{},{scale:t})}),kU=de([Fr,jo,Qy,rD],Vy);de((e,t,n)=>Uy(e,n),kU,(e,t)=>{if(!(e==null||t==null))return Jm(Jm({},e),{},{scale:t})});var OU=de([gt,Pf,Tf],(e,t,n)=>{switch(e){case"horizontal":return t.some(a=>a.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(a=>a.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),uD=e=>e.options.defaultTooltipEventType,dD=e=>e.options.validateTooltipEventTypes;function mD(e,t,n){if(e==null)return t;var a=e?"axis":"item";return n==null?t:n.includes(a)?a:t}function Xy(e,t){var n=uD(e),a=dD(e);return mD(t,n,a)}function DU(e){return Ie(t=>Xy(t,e))}var fD=(e,t)=>{var n,a=Number(t);if(!(ga(a)||t==null))return a>=0?e==null||(n=e[a])===null||n===void 0?void 0:n.value:void 0},MU=e=>e.tooltip.settings,Ui={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},PU={itemInteraction:{click:Ui,hover:Ui},axisInteraction:{click:Ui,hover:Ui},keyboardInteraction:Ui,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},pD=nn({name:"tooltip",initialState:PU,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Pt()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:n,next:a}=t.payload,l=Kn(e).tooltipItemPayloads.indexOf(n);l>-1&&(e.tooltipItemPayloads[l]=a)},prepare:Pt()},removeTooltipEntrySettings:{reducer(e,t){var n=Kn(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},prepare:Pt()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:TU,replaceTooltipEntrySettings:qU,removeTooltipEntrySettings:RU,setTooltipSettingsState:IU,setActiveMouseOverItemIndex:hD,mouseLeaveItem:LU,mouseLeaveChart:vD,setActiveClickItemIndex:$U,setMouseOverAxisIndex:gD,setMouseClickAxisIndex:BU,setSyncInteraction:fb,setKeyboardInteraction:pb}=pD.actions,UU=pD.reducer;function m2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Wd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?m2(Object(n),!0).forEach(function(a){FU(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function FU(e,t,n){return(t=GU(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GU(e){var t=HU(e,"string");return typeof t=="symbol"?t:t+""}function HU(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QU(e,t,n){return t==="axis"?n==="click"?e.axisInteraction.click:e.axisInteraction.hover:n==="click"?e.itemInteraction.click:e.itemInteraction.hover}function VU(e){return e.index!=null}var xD=(e,t,n,a)=>{if(t==null)return Ui;var l=QU(e,t,n);if(l==null)return Ui;if(l.active)return l;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var o=e.settings.active===!0;if(VU(l)){if(o)return Wd(Wd({},l),{},{active:!0})}else if(a!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:a,graphicalItemId:void 0};return Wd(Wd({},Ui),{},{coordinate:l.coordinate})};function YU(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var n=Number(e);return Number.isFinite(n)?n:void 0}function KU(e,t){var n=YU(e),a=t[0],l=t[1];if(n===void 0)return!1;var o=Math.min(a,l),u=Math.max(a,l);return n>=o&&n<=u}function WU(e,t,n){if(n==null||t==null)return!0;var a=Jt(e,t);return a==null||!ei(n)?!0:KU(a,n)}var Zy=(e,t,n,a)=>{var l=e?.index;if(l==null)return null;var o=Number(l);if(!st(o))return l;var u=0,d=1/0;t.length>0&&(d=t.length-1);var f=Math.max(u,Math.min(o,d)),p=t[f];return p==null||WU(p,n,a)?String(f):null},bD=(e,t,n,a,l,o,u)=>{if(o!=null){var d=u[0],f=d?.getPosition(o);if(f!=null)return f;var p=l?.[Number(o)];if(p)return n==="horizontal"?{x:p.coordinate,y:(a.top+t)/2}:{x:(a.left+e)/2,y:p.coordinate}}},yD=(e,t,n,a)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var l;if(n==="hover"?l=e.itemInteraction.hover.graphicalItemId:l=e.itemInteraction.click.graphicalItemId,l==null&&a!=null){var o=e.tooltipItemPayloads[0];return o!=null?[o]:[]}return e.tooltipItemPayloads.filter(u=>{var d;return((d=u.settings)===null||d===void 0?void 0:d.graphicalItemId)===l})},jD=e=>e.options.tooltipPayloadSearcher,No=e=>e.tooltip;function f2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function p2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f2(Object(n),!0).forEach(function(a){XU(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function XU(e,t,n){return(t=ZU(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZU(e){var t=JU(e,"string");return typeof t=="symbol"?t:t+""}function JU(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eF(e,t){return e??t}var ND=(e,t,n,a,l,o,u)=>{if(!(t==null||o==null)){var{chartData:d,computedData:f,dataStartIndex:p,dataEndIndex:h}=n,v=[];return e.reduce((b,x)=>{var j,{dataDefinedOnItem:N,settings:w}=x,C=eF(N,d),E=Array.isArray(C)?Xz(C,p,h):C,S=(j=w?.dataKey)!==null&&j!==void 0?j:a,A=w?.nameKey,O;if(a&&Array.isArray(E)&&!Array.isArray(E[0])&&u==="axis"?O=sz(E,a,l):O=o(E,t,f,A),Array.isArray(O))O.forEach(M=>{var D=p2(p2({},w),{},{name:M.name,unit:M.unit,color:void 0,fill:void 0});b.push(fw({tooltipEntrySettings:D,dataKey:M.dataKey,payload:M.payload,value:Jt(M.payload,M.dataKey),name:M.name}))});else{var k;b.push(fw({tooltipEntrySettings:w,dataKey:S,payload:O,value:Jt(O,S),name:(k=Jt(O,A))!==null&&k!==void 0?k:w?.name}))}return b},v)}},Jy=de([sr,kO,Ty],ZO),tF=de([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),rF=de([xr,bo],OO),_o=de([tF,sr,rF],DO,{memoizeOptions:{resultEqualityCheck:ap}}),nF=de([_o],e=>e.filter(rp)),aF=de([_o],TO,{memoizeOptions:{resultEqualityCheck:ap}}),So=de([aF,oi],qO),iF=de([nF,oi,sr],EO),ej=de([So,sr,_o],RO),_D=de([sr],Gy),sF=de([sr],e=>e.allowDataOverflow),SD=de([_D,sF],lO),lF=de([_o],e=>e.filter(rp)),oF=de([iF,lF,Xf,yO],LO),cF=de([oF,oi,xr,SD],$O),uF=de([_o],PO),dF=de([So,sr,uF,Hy,xr],FO,{memoizeOptions:{resultEqualityCheck:np}}),mF=de([GO,xr,bo],yo),fF=de([mF,xr],VO),pF=de([HO,xr,bo],yo),hF=de([pF,xr],YO),vF=de([QO,xr,bo],yo),gF=de([vF,xr],KO),xF=de([fF,gF,hF],ef),bF=de([sr,_D,SD,cF,dF,xF,gt,xr],WO),bu=de([sr,gt,So,ej,Xf,xr,bF],XO),yF=de([bu,sr,Jy],JO),jF=de([sr,bu,yF,xr],eD),wD=e=>{var t=xr(e),n=bo(e),a=!1;return xu(e,t,n,a)},CD=de([sr,wD],Zf),ED=de([sr,Jy,jF,CD],Vy),NF=de([gt,ej,sr,xr],lD),_F=de([gt,ej,sr,xr],oD),SF=(e,t,n,a,l,o,u,d)=>{if(t){var{type:f}=t,p=ai(e,d);if(a){var h=n==="scaleBand"&&a.bandwidth?a.bandwidth()/2:2,v=f==="category"&&a.bandwidth?a.bandwidth()/h:0;return v=d==="angleAxis"&&l!=null&&l?.length>=2?Jr(l[0]-l[1])*2*v:v,p&&u?u.map((b,x)=>{var j=a.map(b);return st(j)?{coordinate:j+v,value:b,index:x,offset:v}:null}).filter(en):a.domain().map((b,x)=>{var j=a.map(b);return st(j)?{coordinate:j+v,value:o?o[b]:b,index:x,offset:v}:null}).filter(en)}}},di=de([gt,sr,Jy,ED,wD,NF,_F,xr],SF),tj=de([uD,dD,MU],(e,t,n)=>mD(n.shared,e,t)),AD=e=>e.tooltip.settings.trigger,rj=e=>e.tooltip.settings.defaultIndex,yu=de([No,tj,AD,rj],xD),Hs=de([yu,So,gu,bu],Zy),zD=de([di,Hs],fD),kD=de([yu],e=>{if(e)return e.dataKey});de([yu],e=>{if(e)return e.graphicalItemId});var OD=de([No,tj,AD,rj],yD),wF=de([ii,si,gt,hr,di,rj,OD],bD),CF=de([yu,wF],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),EF=de([yu],e=>{var t;return(t=e?.active)!==null&&t!==void 0?t:!1}),AF=de([OD,Hs,oi,gu,zD,jD,tj],ND),zF=de([AF],e=>{if(e!=null){var t=e.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(t))}});function h2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function v2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?h2(Object(n),!0).forEach(function(a){kF(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function kF(e,t,n){return(t=OF(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OF(e){var t=DF(e,"string");return typeof t=="symbol"?t:t+""}function DF(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MF=()=>Ie(sr),PF=()=>{var e=MF(),t=Ie(di),n=Ie(ED);return uo(!e||!n?void 0:v2(v2({},e),{},{scale:n}),t)};function g2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Yl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?g2(Object(n),!0).forEach(function(a){TF(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function TF(e,t,n){return(t=qF(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qF(e){var t=RF(e,"string");return typeof t=="symbol"?t:t+""}function RF(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IF=(e,t,n,a)=>{var l=t.find(o=>o&&o.index===n);if(l){if(e==="horizontal")return{x:l.coordinate,y:a.chartY};if(e==="vertical")return{x:a.chartX,y:l.coordinate}}return{x:0,y:0}},LF=(e,t,n,a)=>{var l=t.find(p=>p&&p.index===n);if(l){if(e==="centric"){var o=l.coordinate,{radius:u}=a;return Yl(Yl(Yl({},a),Er(a.cx,a.cy,u,o)),{},{angle:o,radius:u})}var d=l.coordinate,{angle:f}=a;return Yl(Yl(Yl({},a),Er(a.cx,a.cy,d,f)),{},{angle:f,radius:d})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function $F(e,t){var{chartX:n,chartY:a}=e;return n>=t.left&&n<=t.left+t.width&&a>=t.top&&a<=t.top+t.height}var DD=(e,t,n,a,l)=>{var o,u=(o=t?.length)!==null&&o!==void 0?o:0;if(u<=1||e==null)return 0;if(a==="angleAxis"&&l!=null&&Math.abs(Math.abs(l[1]-l[0])-360)<=1e-6)for(var d=0;d<u;d++){var f,p,h,v,b,x=d>0?(f=n[d-1])===null||f===void 0?void 0:f.coordinate:(p=n[u-1])===null||p===void 0?void 0:p.coordinate,j=(h=n[d])===null||h===void 0?void 0:h.coordinate,N=d>=u-1?(v=n[0])===null||v===void 0?void 0:v.coordinate:(b=n[d+1])===null||b===void 0?void 0:b.coordinate,w=void 0;if(!(x==null||j==null||N==null))if(Jr(j-x)!==Jr(N-j)){var C=[];if(Jr(N-j)===Jr(l[1]-l[0])){w=N;var E=j+l[1]-l[0];C[0]=Math.min(E,(E+x)/2),C[1]=Math.max(E,(E+x)/2)}else{w=x;var S=N+l[1]-l[0];C[0]=Math.min(j,(S+j)/2),C[1]=Math.max(j,(S+j)/2)}var A=[Math.min(j,(w+j)/2),Math.max(j,(w+j)/2)];if(e>A[0]&&e<=A[1]||e>=C[0]&&e<=C[1]){var O;return(O=n[d])===null||O===void 0?void 0:O.index}}else{var k=Math.min(x,N),M=Math.max(x,N);if(e>(k+j)/2&&e<=(M+j)/2){var D;return(D=n[d])===null||D===void 0?void 0:D.index}}}else if(t)for(var $=0;$<u;$++){var U=t[$];if(U!=null){var L=t[$+1],B=t[$-1];if($===0&&L!=null&&e<=(U.coordinate+L.coordinate)/2||$===u-1&&B!=null&&e>(U.coordinate+B.coordinate)/2||$>0&&$<u-1&&B!=null&&L!=null&&e>(U.coordinate+B.coordinate)/2&&e<=(U.coordinate+L.coordinate)/2)return U.index}}return-1},BF=()=>Ie(Ty),nj=(e,t)=>t,MD=(e,t,n)=>n,aj=(e,t,n,a)=>a,UF=de(di,e=>_f(e,t=>t.coordinate)),ij=de([No,nj,MD,aj],xD),sj=de([ij,So,gu,bu],Zy),FF=(e,t,n)=>{if(t!=null){var a=No(e);return t==="axis"?n==="hover"?a.axisInteraction.hover.dataKey:a.axisInteraction.click.dataKey:n==="hover"?a.itemInteraction.hover.dataKey:a.itemInteraction.click.dataKey}},PD=de([No,nj,MD,aj],yD),tf=de([ii,si,gt,hr,di,aj,PD],bD),GF=de([ij,tf],(e,t)=>{var n;return(n=e.coordinate)!==null&&n!==void 0?n:t}),TD=de([di,sj],fD),HF=de([PD,sj,oi,gu,TD,jD,nj],ND),QF=de([ij,sj],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),VF=(e,t,n,a,l,o,u)=>{if(!(!e||!n||!a||!l)&&$F(e,u)){var d=_L(e,t),f=DD(d,o,l,n,a),p=IF(t,l,f,e);return{activeIndex:String(f),activeCoordinate:p}}},YF=(e,t,n,a,l,o,u)=>{if(!(!e||!a||!l||!o||!n)){var d=O$(e,n);if(d){var f=SL(d,t),p=DD(f,u,o,a,l),h=LF(t,o,p,d);return{activeIndex:String(p),activeCoordinate:h}}}},KF=(e,t,n,a,l,o,u,d)=>{if(!(!e||!t||!a||!l||!o))return t==="horizontal"||t==="vertical"?VF(e,t,a,l,o,u,d):YF(e,t,n,a,l,o,u)},WF=de(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,n)=>n,(e,t,n)=>{if(t!=null){var a=e[t];if(a!=null)return n?a.panoramaElement:a.element}}),XF=de(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(a=>parseInt(a,10)).concat(Object.values(pr)),n=Array.from(new Set(t));return n.sort((a,l)=>a-l)},{memoizeOptions:{resultEqualityCheck:O9}});function x2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function b2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?x2(Object(n),!0).forEach(function(a){ZF(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function ZF(e,t,n){return(t=JF(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JF(e){var t=eG(e,"string");return typeof t=="symbol"?t:t+""}function eG(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tG={},rG={zIndexMap:Object.values(pr).reduce((e,t)=>b2(b2({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),tG)},nG=new Set(Object.values(pr));function aG(e){return nG.has(e)}var qD=nn({name:"zIndex",initialState:rG,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]?e.zIndexMap[n].consumers+=1:e.zIndexMap[n]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Pt()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(e.zIndexMap[n].consumers-=1,e.zIndexMap[n].consumers<=0&&!aG(n)&&delete e.zIndexMap[n])},prepare:Pt()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:n,element:a,isPanorama:l}=t.payload;e.zIndexMap[n]?l?e.zIndexMap[n].panoramaElement=a:e.zIndexMap[n].element=a:e.zIndexMap[n]={consumers:0,element:l?void 0:a,panoramaElement:l?a:void 0}},prepare:Pt()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(t.payload.isPanorama?e.zIndexMap[n].panoramaElement=void 0:e.zIndexMap[n].element=void 0)},prepare:Pt()}}}),{registerZIndexPortal:iG,unregisterZIndexPortal:sG,registerZIndexPortalElement:lG,unregisterZIndexPortalElement:oG}=qD.actions,cG=qD.reducer;function Ln(e){var{zIndex:t,children:n}=e,a=r8(),l=a&&t!==void 0&&t!==0,o=Mr(),u=Vt();g.useLayoutEffect(()=>l?(u(iG({zIndex:t})),()=>{u(sG({zIndex:t}))}):Js,[u,t,l]);var d=Ie(f=>WF(f,t,o));return l?d?iA.createPortal(n,d):null:n}function hb(){return hb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},hb.apply(null,arguments)}function y2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Xd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?y2(Object(n),!0).forEach(function(a){uG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function uG(e,t,n){return(t=dG(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dG(e){var t=mG(e,"string");return typeof t=="symbol"?t:t+""}function mG(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fG(e){var{cursor:t,cursorComp:n,cursorProps:a}=e;return g.isValidElement(t)?g.cloneElement(t,a):g.createElement(n,a)}function pG(e){var t,{coordinate:n,payload:a,index:l,offset:o,tooltipAxisBandSize:u,layout:d,cursor:f,tooltipEventType:p,chartName:h}=e,v=n,b=a,x=l;if(!f||!v||h!=="ScatterChart"&&p!=="axis")return null;var j,N,w;if(h==="ScatterChart")j=v,N=G8,w=pr.cursorLine;else if(h==="BarChart")j=H8(d,v,o,u),N=Nk,w=pr.cursorRectangle;else if(d==="radial"&&cz(v)){var{cx:C,cy:E,radius:S,startAngle:A,endAngle:O}=_k(v);j={cx:C,cy:E,startAngle:A,endAngle:O,innerRadius:S,outerRadius:S},N=wk,w=pr.cursorLine}else j={points:T$(d,v,o)},N=gk,w=pr.cursorLine;var k=typeof f=="object"&&"className"in f?f.className:void 0,M=Xd(Xd(Xd(Xd({stroke:"#ccc",pointerEvents:"none"},o),j),au(f)),{},{payload:b,payloadIndex:x,className:_t("recharts-tooltip-cursor",k)});return g.createElement(Ln,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:w},g.createElement(fG,{cursor:f,cursorComp:N,cursorProps:M}))}function hG(e){var t=PF(),n=ak(),a=el(),l=BF();return t==null||n==null||a==null||l==null?null:g.createElement(pG,hb({},e,{offset:n,layout:a,tooltipAxisBandSize:t,chartName:l}))}var RD=g.createContext(null),vG=()=>g.useContext(RD),nx={exports:{}},j2;function gG(){return j2||(j2=1,(function(e){var t=Object.prototype.hasOwnProperty,n="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(n=!1));function l(f,p,h){this.fn=f,this.context=p,this.once=h||!1}function o(f,p,h,v,b){if(typeof h!="function")throw new TypeError("The listener must be a function");var x=new l(h,v||f,b),j=n?n+p:p;return f._events[j]?f._events[j].fn?f._events[j]=[f._events[j],x]:f._events[j].push(x):(f._events[j]=x,f._eventsCount++),f}function u(f,p){--f._eventsCount===0?f._events=new a:delete f._events[p]}function d(){this._events=new a,this._eventsCount=0}d.prototype.eventNames=function(){var p=[],h,v;if(this._eventsCount===0)return p;for(v in h=this._events)t.call(h,v)&&p.push(n?v.slice(1):v);return Object.getOwnPropertySymbols?p.concat(Object.getOwnPropertySymbols(h)):p},d.prototype.listeners=function(p){var h=n?n+p:p,v=this._events[h];if(!v)return[];if(v.fn)return[v.fn];for(var b=0,x=v.length,j=new Array(x);b<x;b++)j[b]=v[b].fn;return j},d.prototype.listenerCount=function(p){var h=n?n+p:p,v=this._events[h];return v?v.fn?1:v.length:0},d.prototype.emit=function(p,h,v,b,x,j){var N=n?n+p:p;if(!this._events[N])return!1;var w=this._events[N],C=arguments.length,E,S;if(w.fn){switch(w.once&&this.removeListener(p,w.fn,void 0,!0),C){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,h),!0;case 3:return w.fn.call(w.context,h,v),!0;case 4:return w.fn.call(w.context,h,v,b),!0;case 5:return w.fn.call(w.context,h,v,b,x),!0;case 6:return w.fn.call(w.context,h,v,b,x,j),!0}for(S=1,E=new Array(C-1);S<C;S++)E[S-1]=arguments[S];w.fn.apply(w.context,E)}else{var A=w.length,O;for(S=0;S<A;S++)switch(w[S].once&&this.removeListener(p,w[S].fn,void 0,!0),C){case 1:w[S].fn.call(w[S].context);break;case 2:w[S].fn.call(w[S].context,h);break;case 3:w[S].fn.call(w[S].context,h,v);break;case 4:w[S].fn.call(w[S].context,h,v,b);break;default:if(!E)for(O=1,E=new Array(C-1);O<C;O++)E[O-1]=arguments[O];w[S].fn.apply(w[S].context,E)}}return!0},d.prototype.on=function(p,h,v){return o(this,p,h,v,!1)},d.prototype.once=function(p,h,v){return o(this,p,h,v,!0)},d.prototype.removeListener=function(p,h,v,b){var x=n?n+p:p;if(!this._events[x])return this;if(!h)return u(this,x),this;var j=this._events[x];if(j.fn)j.fn===h&&(!b||j.once)&&(!v||j.context===v)&&u(this,x);else{for(var N=0,w=[],C=j.length;N<C;N++)(j[N].fn!==h||b&&!j[N].once||v&&j[N].context!==v)&&w.push(j[N]);w.length?this._events[x]=w.length===1?w[0]:w:u(this,x)}return this},d.prototype.removeAllListeners=function(p){var h;return p?(h=n?n+p:p,this._events[h]&&u(this,h)):(this._events=new a,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=n,d.EventEmitter=d,e.exports=d})(nx)),nx.exports}var xG=gG();const bG=ni(xG);var Jc=new bG,vb="recharts.syncEvent.tooltip",N2="recharts.syncEvent.brush",ID=(e,t)=>{if(t&&Array.isArray(e)){var n=Number.parseInt(t,10);if(!ga(n))return e[n]}},yG={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},LD=nn({name:"options",initialState:yG,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),jG=LD.reducer,{createEventEmitter:NG}=LD.actions;function _G(e){return e.tooltip.syncInteraction}var SG={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},$D=nn({name:"chartData",initialState:SG,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:a}=t.payload;n!=null&&(e.dataStartIndex=n),a!=null&&(e.dataEndIndex=a)}}}),{setChartData:_2,setDataStartEndIndexes:wG,setComputedData:ate}=$D.actions,CG=$D.reducer,EG=["x","y"];function S2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Kl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?S2(Object(n),!0).forEach(function(a){AG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function AG(e,t,n){return(t=zG(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zG(e){var t=kG(e,"string");return typeof t=="symbol"?t:t+""}function kG(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function OG(e,t){if(e==null)return{};var n,a,l=DG(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function DG(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function MG(){var e=Ie(qy),t=Ie(Ry),n=Vt(),a=Ie(jO),l=Ie(di),o=el(),u=If(),d=Ie(f=>f.rootProps.className);g.useEffect(()=>{if(e==null)return Js;var f=(p,h,v)=>{if(t!==v&&e===p){if(a==="index"){var b;if(u&&h!==null&&h!==void 0&&(b=h.payload)!==null&&b!==void 0&&b.coordinate&&h.payload.sourceViewBox){var x=h.payload.coordinate,{x:j,y:N}=x,w=OG(x,EG),{x:C,y:E,width:S,height:A}=h.payload.sourceViewBox,O=Kl(Kl({},w),{},{x:u.x+(S?(j-C)/S:0)*u.width,y:u.y+(A?(N-E)/A:0)*u.height});n(Kl(Kl({},h),{},{payload:Kl(Kl({},h.payload),{},{coordinate:O})}))}else n(h);return}if(l!=null){var k;if(typeof a=="function"){var M={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},D=a(l,M);k=l[D]}else a==="value"&&(k=l.find(q=>String(q.value)===h.payload.label));var{coordinate:$}=h.payload;if(k==null||h.payload.active===!1||$==null||u==null){n(fb({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:U,y:L}=$,B=Math.min(U,u.x+u.width),ee=Math.min(L,u.y+u.height),se={x:o==="horizontal"?k.coordinate:B,y:o==="horizontal"?ee:k.coordinate},P=fb({active:h.payload.active,coordinate:se,dataKey:h.payload.dataKey,index:String(k.index),label:h.payload.label,sourceViewBox:h.payload.sourceViewBox,graphicalItemId:h.payload.graphicalItemId});n(P)}}};return Jc.on(vb,f),()=>{Jc.off(vb,f)}},[d,n,t,e,a,l,o,u])}function PG(){var e=Ie(qy),t=Ie(Ry),n=Vt();g.useEffect(()=>{if(e==null)return Js;var a=(l,o,u)=>{t!==u&&e===l&&n(wG(o))};return Jc.on(N2,a),()=>{Jc.off(N2,a)}},[n,t,e])}function TG(){var e=Vt();g.useEffect(()=>{e(NG())},[e]),MG(),PG()}function qG(e,t,n,a,l,o){var u=Ie(x=>FF(x,e,t)),d=Ie(Ry),f=Ie(qy),p=Ie(jO),h=Ie(_G),v=h?.active,b=If();g.useEffect(()=>{if(!v&&f!=null&&d!=null){var x=fb({active:o,coordinate:n,dataKey:u,index:l,label:typeof a=="number"?String(a):a,sourceViewBox:b,graphicalItemId:void 0});Jc.emit(vb,f,x,d)}},[v,n,u,l,a,d,f,p,o,b])}function w2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function C2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?w2(Object(n),!0).forEach(function(a){RG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function RG(e,t,n){return(t=IG(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IG(e){var t=LG(e,"string");return typeof t=="symbol"?t:t+""}function LG(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $G(e){return e.dataKey}function BG(e,t){return g.isValidElement(e)?g.cloneElement(e,t):typeof e=="function"?g.createElement(e,t):g.createElement(_8,t)}var E2=[],UG={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function A2(e){var t,n,a=Ur(e,UG),{active:l,allowEscapeViewBox:o,animationDuration:u,animationEasing:d,content:f,filterNull:p,isAnimationActive:h,offset:v,payloadUniqBy:b,position:x,reverseDirection:j,useTranslate3d:N,wrapperStyle:w,cursor:C,shared:E,trigger:S,defaultIndex:A,portal:O,axisId:k}=a,M=Vt(),D=typeof A=="number"?String(A):A;g.useEffect(()=>{M(IU({shared:E,trigger:S,axisId:k,active:l,defaultIndex:D}))},[M,E,S,k,l,D]);var $=If(),U=vk(),L=DU(E),{activeIndex:B,isActive:ee}=(t=Ie(he=>QF(he,L,S,D)))!==null&&t!==void 0?t:{},se=Ie(he=>HF(he,L,S,D)),P=Ie(he=>TD(he,L,S,D)),q=Ie(he=>GF(he,L,S,D)),F=se,R=vG(),W=(n=l??ee)!==null&&n!==void 0?n:!1,[I,re]=o4([F,W]),V=L==="axis"?P:void 0;qG(L,S,q,V,B,W);var oe=O??R;if(oe==null||$==null||L==null)return null;var xe=F??E2;W||(xe=E2),p&&xe.length&&(xe=PI(xe.filter(he=>he.value!=null&&(he.hide!==!0||a.includeHidden)),b,$G));var ve=xe.length>0,H=g.createElement(k8,{allowEscapeViewBox:o,animationDuration:u,animationEasing:d,isAnimationActive:h,active:W,coordinate:q,hasPayload:ve,offset:v,position:x,reverseDirection:j,useTranslate3d:N,viewBox:$,wrapperStyle:w,lastBoundingBox:I,innerRef:re,hasPortalFromProps:!!O},BG(f,C2(C2({},a),{},{payload:xe,label:V,active:W,activeIndex:B,coordinate:q,accessibilityLayer:U})));return g.createElement(g.Fragment,null,iA.createPortal(H,oe),W&&g.createElement(hG,{cursor:C,tooltipEventType:L,coordinate:q,payload:xe,index:B}))}var lj=e=>null;lj.displayName="Cell";function FG(e,t,n){return(t=GG(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GG(e){var t=HG(e,"string");return typeof t=="symbol"?t:t+""}function HG(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class QG{constructor(t){FG(this,"cache",new Map),this.maxSize=t}get(t){var n=this.cache.get(t);return n!==void 0&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var a=this.cache.keys().next().value;a!=null&&this.cache.delete(a)}this.cache.set(t,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function z2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function VG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?z2(Object(n),!0).forEach(function(a){YG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function YG(e,t,n){return(t=KG(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KG(e){var t=WG(e,"string");return typeof t=="symbol"?t:t+""}function WG(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XG={cacheSize:2e3,enableCache:!0},BD=VG({},XG),k2=new QG(BD.cacheSize),ZG={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},O2="recharts_measurement_span";function JG(e,t){var n=t.fontSize||"",a=t.fontFamily||"",l=t.fontWeight||"",o=t.fontStyle||"",u=t.letterSpacing||"",d=t.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(a,"|").concat(l,"|").concat(o,"|").concat(u,"|").concat(d)}var D2=(e,t)=>{try{var n=document.getElementById(O2);n||(n=document.createElement("span"),n.setAttribute("id",O2),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,ZG,t),n.textContent="".concat(e);var a=n.getBoundingClientRect();return{width:a.width,height:a.height}}catch{return{width:0,height:0}}},qc=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Uf.isSsr)return{width:0,height:0};if(!BD.enableCache)return D2(t,n);var a=JG(t,n),l=k2.get(a);if(l)return l;var o=D2(t,n);return k2.set(a,o),o},UD;function eH(e,t,n){return(t=tH(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tH(e){var t=rH(e,"string");return typeof t=="symbol"?t:t+""}function rH(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M2=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,P2=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,nH=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,aH=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,iH={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},sH=["cm","mm","pt","pc","in","Q","px"];function lH(e){return sH.includes(e)}var ro="NaN";function oH(e,t){return e*iH[t]}class Cr{static parse(t){var n,[,a,l]=(n=aH.exec(t))!==null&&n!==void 0?n:[];return a==null?Cr.NaN:new Cr(parseFloat(a),l??"")}constructor(t,n){this.num=t,this.unit=n,this.num=t,this.unit=n,ga(t)&&(this.unit=""),n!==""&&!nH.test(n)&&(this.num=NaN,this.unit=""),lH(n)&&(this.num=oH(t,n),this.unit="px")}add(t){return this.unit!==t.unit?new Cr(NaN,""):new Cr(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Cr(NaN,""):new Cr(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Cr(NaN,""):new Cr(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Cr(NaN,""):new Cr(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ga(this.num)}}UD=Cr;eH(Cr,"NaN",new UD(NaN,""));function FD(e){if(e==null||e.includes(ro))return ro;for(var t=e;t.includes("*")||t.includes("/");){var n,[,a,l,o]=(n=M2.exec(t))!==null&&n!==void 0?n:[],u=Cr.parse(a??""),d=Cr.parse(o??""),f=l==="*"?u.multiply(d):u.divide(d);if(f.isNaN())return ro;t=t.replace(M2,f.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var p,[,h,v,b]=(p=P2.exec(t))!==null&&p!==void 0?p:[],x=Cr.parse(h??""),j=Cr.parse(b??""),N=v==="+"?x.add(j):x.subtract(j);if(N.isNaN())return ro;t=t.replace(P2,N.toString())}return t}var T2=/\(([^()]*)\)/;function cH(e){for(var t=e,n;(n=T2.exec(t))!=null;){var[,a]=n;t=t.replace(T2,FD(a))}return t}function uH(e){var t=e.replace(/\s+/g,"");return t=cH(t),t=FD(t),t}function dH(e){try{return uH(e)}catch{return ro}}function ax(e){var t=dH(e.slice(5,-1));return t===ro?"":t}var mH=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],fH=["dx","dy","angle","className","breakAll"];function gb(){return gb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},gb.apply(null,arguments)}function q2(e,t){if(e==null)return{};var n,a,l=pH(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function pH(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var GD=/[ \f\n\r\t\v\u2028\u2029]+/,HD=e=>{var{children:t,breakAll:n,style:a}=e;try{var l=[];Rt(t)||(n?l=t.toString().split(""):l=t.toString().split(GD));var o=l.map(d=>({word:d,width:qc(d,a).width})),u=n?0:qc("",a).width;return{wordsWithComputedWidth:o,spaceWidth:u}}catch{return null}};function hH(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var QD=(e,t,n,a)=>e.reduce((l,o)=>{var{word:u,width:d}=o,f=l[l.length-1];if(f&&d!=null&&(t==null||a||f.width+d+n<Number(t)))f.words.push(u),f.width+=d+n;else{var p={words:[u],width:d};l.push(p)}return l},[]),VD=e=>e.reduce((t,n)=>t.width>n.width?t:n),vH="",R2=(e,t,n,a,l,o,u,d)=>{var f=e.slice(0,t),p=HD({breakAll:n,style:a,children:f+vH});if(!p)return[!1,[]];var h=QD(p.wordsWithComputedWidth,o,u,d),v=h.length>l||VD(h).width>Number(o);return[v,h]},gH=(e,t,n,a,l)=>{var{maxLines:o,children:u,style:d,breakAll:f}=e,p=De(o),h=String(u),v=QD(t,a,n,l);if(!p||l)return v;var b=v.length>o||VD(v).width>Number(a);if(!b)return v;for(var x=0,j=h.length-1,N=0,w;x<=j&&N<=h.length-1;){var C=Math.floor((x+j)/2),E=C-1,[S,A]=R2(h,E,f,d,o,a,n,l),[O]=R2(h,C,f,d,o,a,n,l);if(!S&&!O&&(x=C+1),S&&O&&(j=C-1),!S&&O){w=A;break}N++}return w||v},I2=e=>{var t=Rt(e)?[]:e.toString().split(GD);return[{words:t,width:void 0}]},xH=e=>{var{width:t,scaleToFit:n,children:a,style:l,breakAll:o,maxLines:u}=e;if((t||n)&&!Uf.isSsr){var d,f,p=HD({breakAll:o,children:a,style:l});if(p){var{wordsWithComputedWidth:h,spaceWidth:v}=p;d=h,f=v}else return I2(a);return gH({breakAll:o,children:a,maxLines:u,style:l},d,f,t,!!n)}return I2(a)},YD="#808080",bH={angle:0,breakAll:!1,capHeight:"0.71em",fill:YD,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},oj=g.forwardRef((e,t)=>{var n=Ur(e,bH),{x:a,y:l,lineHeight:o,capHeight:u,fill:d,scaleToFit:f,textAnchor:p,verticalAnchor:h}=n,v=q2(n,mH),b=g.useMemo(()=>xH({breakAll:v.breakAll,children:v.children,maxLines:v.maxLines,scaleToFit:f,style:v.style,width:v.width}),[v.breakAll,v.children,v.maxLines,f,v.style,v.width]),{dx:x,dy:j,angle:N,className:w,breakAll:C}=v,E=q2(v,fH);if(!xa(a)||!xa(l)||b.length===0)return null;var S=Number(a)+(De(x)?x:0),A=Number(l)+(De(j)?j:0);if(!st(S)||!st(A))return null;var O;switch(h){case"start":O=ax("calc(".concat(u,")"));break;case"middle":O=ax("calc(".concat((b.length-1)/2," * -").concat(o," + (").concat(u," / 2))"));break;default:O=ax("calc(".concat(b.length-1," * -").concat(o,")"));break}var k=[],M=b[0];if(f&&M!=null){var D=M.width,{width:$}=v;k.push("scale(".concat(De($)&&De(D)?$/D:1,")"))}return N&&k.push("rotate(".concat(N,", ").concat(S,", ").concat(A,")")),k.length&&(E.transform=k.join(" ")),g.createElement("text",gb({},$r(E),{ref:t,x:S,y:A,className:_t("recharts-text",w),textAnchor:p,fill:d.includes("url")?YD:d}),b.map((U,L)=>{var B=U.words.join(C?"":" ");return g.createElement("tspan",{x:S,dy:L===0?O:o,key:"".concat(B,"-").concat(L)},B)}))});oj.displayName="Text";function L2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function ua(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?L2(Object(n),!0).forEach(function(a){yH(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function yH(e,t,n){return(t=jH(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jH(e){var t=NH(e,"string");return typeof t=="symbol"?t:t+""}function NH(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _H=e=>{var{viewBox:t,position:n,offset:a=0,parentViewBox:l}=e,{x:o,y:u,height:d,upperWidth:f,lowerWidth:p}=sy(t),h=o,v=o+(f-p)/2,b=(h+v)/2,x=(f+p)/2,j=h+f/2,N=d>=0?1:-1,w=N*a,C=N>0?"end":"start",E=N>0?"start":"end",S=f>=0?1:-1,A=S*a,O=S>0?"end":"start",k=S>0?"start":"end",M=l;if(n==="top"){var D={x:h+f/2,y:u-w,horizontalAnchor:"middle",verticalAnchor:C};return M&&(D.height=Math.max(u-M.y,0),D.width=f),D}if(n==="bottom"){var $={x:v+p/2,y:u+d+w,horizontalAnchor:"middle",verticalAnchor:E};return M&&($.height=Math.max(M.y+M.height-(u+d),0),$.width=p),$}if(n==="left"){var U={x:b-A,y:u+d/2,horizontalAnchor:O,verticalAnchor:"middle"};return M&&(U.width=Math.max(U.x-M.x,0),U.height=d),U}if(n==="right"){var L={x:b+x+A,y:u+d/2,horizontalAnchor:k,verticalAnchor:"middle"};return M&&(L.width=Math.max(M.x+M.width-L.x,0),L.height=d),L}var B=M?{width:x,height:d}:{};return n==="insideLeft"?ua({x:b+A,y:u+d/2,horizontalAnchor:k,verticalAnchor:"middle"},B):n==="insideRight"?ua({x:b+x-A,y:u+d/2,horizontalAnchor:O,verticalAnchor:"middle"},B):n==="insideTop"?ua({x:h+f/2,y:u+w,horizontalAnchor:"middle",verticalAnchor:E},B):n==="insideBottom"?ua({x:v+p/2,y:u+d-w,horizontalAnchor:"middle",verticalAnchor:C},B):n==="insideTopLeft"?ua({x:h+A,y:u+w,horizontalAnchor:k,verticalAnchor:E},B):n==="insideTopRight"?ua({x:h+f-A,y:u+w,horizontalAnchor:O,verticalAnchor:E},B):n==="insideBottomLeft"?ua({x:v+A,y:u+d-w,horizontalAnchor:k,verticalAnchor:C},B):n==="insideBottomRight"?ua({x:v+p-A,y:u+d-w,horizontalAnchor:O,verticalAnchor:C},B):n&&typeof n=="object"&&(De(n.x)||$s(n.x))&&(De(n.y)||$s(n.y))?ua({x:o+Xn(n.x,x),y:u+Xn(n.y,d),horizontalAnchor:"end",verticalAnchor:"end"},B):ua({x:j,y:u+d/2,horizontalAnchor:"middle",verticalAnchor:"middle"},B)},SH=["labelRef"],wH=["content"];function $2(e,t){if(e==null)return{};var n,a,l=CH(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function CH(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function B2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Mc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?B2(Object(n),!0).forEach(function(a){EH(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function EH(e,t,n){return(t=AH(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AH(e){var t=zH(e,"string");return typeof t=="symbol"?t:t+""}function zH(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fa(){return Fa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Fa.apply(null,arguments)}var KD=g.createContext(null),kH=e=>{var{x:t,y:n,upperWidth:a,lowerWidth:l,width:o,height:u,children:d}=e,f=g.useMemo(()=>({x:t,y:n,upperWidth:a,lowerWidth:l,width:o,height:u}),[t,n,a,l,o,u]);return g.createElement(KD.Provider,{value:f},d)},WD=()=>{var e=g.useContext(KD),t=If();return e||(t?sy(t):void 0)},OH=g.createContext(null),DH=()=>{var e=g.useContext(OH),t=Ie(CO);return e||t},MH=e=>{var{value:t,formatter:n}=e,a=Rt(e.children)?t:e.children;return typeof n=="function"?n(a):a},cj=e=>e!=null&&typeof e=="function",PH=(e,t)=>{var n=Jr(t-e),a=Math.min(Math.abs(t-e),360);return n*a},TH=(e,t,n,a,l)=>{var{offset:o,className:u}=e,{cx:d,cy:f,innerRadius:p,outerRadius:h,startAngle:v,endAngle:b,clockWise:x}=l,j=(p+h)/2,N=PH(v,b),w=N>=0?1:-1,C,E;switch(t){case"insideStart":C=v+w*o,E=x;break;case"insideEnd":C=b-w*o,E=!x;break;case"end":C=b+w*o,E=x;break;default:throw new Error("Unsupported position ".concat(t))}E=N<=0?E:!E;var S=Er(d,f,j,C),A=Er(d,f,j,C+(E?1:-1)*359),O="M".concat(S.x,",").concat(S.y,`
    A`).concat(j,",").concat(j,",0,1,").concat(E?0:1,`,
    `).concat(A.x,",").concat(A.y),k=Rt(e.id)?$c("recharts-radial-line-"):e.id;return g.createElement("text",Fa({},a,{dominantBaseline:"central",className:_t("recharts-radial-bar-label",u)}),g.createElement("defs",null,g.createElement("path",{id:k,d:O})),g.createElement("textPath",{xlinkHref:"#".concat(k)},n))},qH=(e,t,n)=>{var{cx:a,cy:l,innerRadius:o,outerRadius:u,startAngle:d,endAngle:f}=e,p=(d+f)/2;if(n==="outside"){var{x:h,y:v}=Er(a,l,u+t,p);return{x:h,y:v,textAnchor:h>=a?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"end"};var b=(o+u)/2,{x,y:j}=Er(a,l,b,p);return{x,y:j,textAnchor:"middle",verticalAnchor:"middle"}},cm=e=>e!=null&&"cx"in e&&De(e.cx),RH={angle:0,offset:5,zIndex:pr.label,position:"middle",textBreakAll:!1};function IH(e){if(!cm(e))return e;var{cx:t,cy:n,outerRadius:a}=e,l=a*2;return{x:t-a,y:n-a,width:l,upperWidth:l,lowerWidth:l,height:l}}function Bi(e){var t=Ur(e,RH),{viewBox:n,parentViewBox:a,position:l,value:o,children:u,content:d,className:f="",textBreakAll:p,labelRef:h}=t,v=DH(),b=WD(),x=l==="center"?b:v??b,j,N,w;n==null?j=x:cm(n)?j=n:j=sy(n);var C=IH(j);if(!j||Rt(o)&&Rt(u)&&!g.isValidElement(d)&&typeof d!="function")return null;var E=Mc(Mc({},t),{},{viewBox:j});if(g.isValidElement(d)){var{labelRef:S}=E,A=$2(E,SH);return g.cloneElement(d,A)}if(typeof d=="function"){var{content:O}=E,k=$2(E,wH);if(N=g.createElement(d,k),g.isValidElement(N))return N}else N=MH(t);var M=$r(t);if(cm(j)){if(l==="insideStart"||l==="insideEnd"||l==="end")return TH(t,l,N,M,j);w=qH(j,t.offset,t.position)}else{if(!C)return null;var D=_H({viewBox:C,position:l,offset:t.offset,parentViewBox:cm(a)?void 0:a});w=Mc(Mc({x:D.x,y:D.y,textAnchor:D.horizontalAnchor,verticalAnchor:D.verticalAnchor},D.width!==void 0?{width:D.width}:{}),D.height!==void 0?{height:D.height}:{})}return g.createElement(Ln,{zIndex:t.zIndex},g.createElement(oj,Fa({ref:h,className:_t("recharts-label",f)},M,w,{textAnchor:hH(M.textAnchor)?M.textAnchor:w.textAnchor,breakAll:p}),N))}Bi.displayName="Label";var LH=(e,t,n)=>{if(!e)return null;var a={viewBox:t,labelRef:n};return e===!0?g.createElement(Bi,Fa({key:"label-implicit"},a)):xa(e)?g.createElement(Bi,Fa({key:"label-implicit",value:e},a)):g.isValidElement(e)?e.type===Bi?g.cloneElement(e,Mc({key:"label-implicit"},a)):g.createElement(Bi,Fa({key:"label-implicit",content:e},a)):cj(e)?g.createElement(Bi,Fa({key:"label-implicit",content:e},a)):e&&typeof e=="object"?g.createElement(Bi,Fa({},e,{key:"label-implicit"},a)):null};function $H(e){var{label:t,labelRef:n}=e,a=WD();return LH(t,a,n)||null}var ix={},sx={},U2;function BH(){return U2||(U2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n[n.length-1]}e.last=t})(sx)),sx}var lx={},F2;function UH(){return F2||(F2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Array.isArray(n)?n:Array.from(n)}e.toArray=t})(lx)),lx}var G2;function FH(){return G2||(G2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BH(),n=UH(),a=Kb();function l(o){if(a.isArrayLike(o))return t.last(n.toArray(o))}e.last=l})(ix)),ix}var ox,H2;function GH(){return H2||(H2=1,ox=FH().last),ox}var HH=GH();const QH=ni(HH);var VH=["valueAccessor"],YH=["dataKey","clockWise","id","textBreakAll","zIndex"];function rf(){return rf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},rf.apply(null,arguments)}function Q2(e,t){if(e==null)return{};var n,a,l=KH(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function KH(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var WH=e=>Array.isArray(e.value)?QH(e.value):e.value,XD=g.createContext(void 0),ZD=XD.Provider,JD=g.createContext(void 0);JD.Provider;function XH(){return g.useContext(XD)}function ZH(){return g.useContext(JD)}function um(e){var{valueAccessor:t=WH}=e,n=Q2(e,VH),{dataKey:a,clockWise:l,id:o,textBreakAll:u,zIndex:d}=n,f=Q2(n,YH),p=XH(),h=ZH(),v=p||h;return!v||!v.length?null:g.createElement(Ln,{zIndex:d??pr.label},g.createElement(Pn,{className:"recharts-label-list"},v.map((b,x)=>{var j,N=Rt(a)?t(b,x):Jt(b.payload,a),w=Rt(o)?{}:{id:"".concat(o,"-").concat(x)};return g.createElement(Bi,rf({key:"label-".concat(x)},$r(b),f,w,{fill:(j=n.fill)!==null&&j!==void 0?j:b.fill,parentViewBox:b.parentViewBox,value:N,textBreakAll:u,viewBox:b.viewBox,index:x,zIndex:0}))})))}um.displayName="LabelList";function eM(e){var{label:t}=e;return t?t===!0?g.createElement(um,{key:"labelList-implicit"}):g.isValidElement(t)||cj(t)?g.createElement(um,{key:"labelList-implicit",content:t}):typeof t=="object"?g.createElement(um,rf({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function xb(){return xb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},xb.apply(null,arguments)}var tM=e=>{var{cx:t,cy:n,r:a,className:l}=e,o=_t("recharts-dot",l);return De(t)&&De(n)&&De(a)?g.createElement("circle",xb({},Wn(e),Vb(e),{className:o,cx:t,cy:n,r:a})):null},JH={radiusAxis:{},angleAxis:{}},rM=nn({name:"polarAxis",initialState:JH,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:ite,removeRadiusAxis:ste,addAngleAxis:lte,removeAngleAxis:ote}=rM.actions,eQ=rM.reducer;function tQ(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var cx={exports:{}},Nt={};var V2;function rQ(){if(V2)return Nt;V2=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),b=Symbol.for("react.view_transition"),x=Symbol.for("react.client.reference");function j(N){if(typeof N=="object"&&N!==null){var w=N.$$typeof;switch(w){case e:switch(N=N.type,N){case n:case l:case a:case f:case p:case b:return N;default:switch(N=N&&N.$$typeof,N){case u:case d:case v:case h:return N;case o:return N;default:return w}}case t:return w}}}return Nt.ContextConsumer=o,Nt.ContextProvider=u,Nt.Element=e,Nt.ForwardRef=d,Nt.Fragment=n,Nt.Lazy=v,Nt.Memo=h,Nt.Portal=t,Nt.Profiler=l,Nt.StrictMode=a,Nt.Suspense=f,Nt.SuspenseList=p,Nt.isContextConsumer=function(N){return j(N)===o},Nt.isContextProvider=function(N){return j(N)===u},Nt.isElement=function(N){return typeof N=="object"&&N!==null&&N.$$typeof===e},Nt.isForwardRef=function(N){return j(N)===d},Nt.isFragment=function(N){return j(N)===n},Nt.isLazy=function(N){return j(N)===v},Nt.isMemo=function(N){return j(N)===h},Nt.isPortal=function(N){return j(N)===t},Nt.isProfiler=function(N){return j(N)===l},Nt.isStrictMode=function(N){return j(N)===a},Nt.isSuspense=function(N){return j(N)===f},Nt.isSuspenseList=function(N){return j(N)===p},Nt.isValidElementType=function(N){return typeof N=="string"||typeof N=="function"||N===n||N===l||N===a||N===f||N===p||typeof N=="object"&&N!==null&&(N.$$typeof===v||N.$$typeof===h||N.$$typeof===u||N.$$typeof===o||N.$$typeof===d||N.$$typeof===x||N.getModuleId!==void 0)},Nt.typeOf=j,Nt}var Y2;function nQ(){return Y2||(Y2=1,cx.exports=rQ()),cx.exports}var aQ=nQ(),K2=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",W2=null,ux=null,nM=e=>{if(e===W2&&Array.isArray(ux))return ux;var t=[];return g.Children.forEach(e,n=>{Rt(n)||(aQ.isFragment(n)?t=t.concat(nM(n.props.children)):t.push(n))}),ux=t,W2=e,t};function iQ(e,t){var n=[],a=[];return Array.isArray(t)?a=t.map(l=>K2(l)):a=[K2(t)],nM(e).forEach(l=>{var o=oo(l,"type.displayName")||oo(l,"type.name");o&&a.indexOf(o)!==-1&&n.push(l)}),n}var aM=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,dx={},X2;function sQ(){return X2||(X2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const l=n[Symbol.toStringTag];return l==null||!Object.getOwnPropertyDescriptor(n,Symbol.toStringTag)?.writable?!1:n.toString()===`[object ${l}]`}let a=n;for(;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(n)===a}e.isPlainObject=t})(dx)),dx}var mx,Z2;function lQ(){return Z2||(Z2=1,mx=sQ().isPlainObject),mx}var oQ=lQ();const cQ=ni(oQ);var J2,eE,tE,rE,nE;function aE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function iE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aE(Object(n),!0).forEach(function(a){uQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function uQ(e,t,n){return(t=dQ(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dQ(e){var t=mQ(e,"string");return typeof t=="symbol"?t:t+""}function mQ(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nf(){return nf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},nf.apply(null,arguments)}function Cc(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var sE=(e,t,n,a,l)=>{var o=n-a,u;return u=Ft(J2||(J2=Cc(["M ",",",""])),e,t),u+=Ft(eE||(eE=Cc(["L ",",",""])),e+n,t),u+=Ft(tE||(tE=Cc(["L ",",",""])),e+n-o/2,t+l),u+=Ft(rE||(rE=Cc(["L ",",",""])),e+n-o/2-a,t+l),u+=Ft(nE||(nE=Cc(["L ",","," Z"])),e,t),u},fQ={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},pQ=e=>{var t=Ur(e,fQ),{x:n,y:a,upperWidth:l,lowerWidth:o,height:u,className:d}=t,{animationEasing:f,animationDuration:p,animationBegin:h,isUpdateAnimationActive:v}=t,b=g.useRef(null),[x,j]=g.useState(-1),N=g.useRef(l),w=g.useRef(o),C=g.useRef(u),E=g.useRef(n),S=g.useRef(a),A=Gf(e,"trapezoid-");if(g.useEffect(()=>{if(b.current&&b.current.getTotalLength)try{var se=b.current.getTotalLength();se&&j(se)}catch{}},[]),n!==+n||a!==+a||l!==+l||o!==+o||u!==+u||l===0&&o===0||u===0)return null;var O=_t("recharts-trapezoid",d);if(!v)return g.createElement("g",null,g.createElement("path",nf({},$r(t),{className:O,d:sE(n,a,l,o,u)})));var k=N.current,M=w.current,D=C.current,$=E.current,U=S.current,L="0px ".concat(x===-1?1:x,"px"),B="".concat(x,"px 0px"),ee=xk(["strokeDasharray"],p,f);return g.createElement(Ff,{animationId:A,key:A,canBegin:x>0,duration:p,easing:f,isActive:v,begin:h},se=>{var P=Gt(k,l,se),q=Gt(M,o,se),F=Gt(D,u,se),R=Gt($,n,se),W=Gt(U,a,se);b.current&&(N.current=P,w.current=q,C.current=F,E.current=R,S.current=W);var I=se>0?{transition:ee,strokeDasharray:B}:{strokeDasharray:L};return g.createElement("path",nf({},$r(t),{className:O,d:sE(R,W,P,q,F),ref:b,style:iE(iE({},I),t.style)}))})},hQ=["option","shapeType","activeClassName"];function vQ(e,t){if(e==null)return{};var n,a,l=gQ(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function gQ(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function lE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function af(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lE(Object(n),!0).forEach(function(a){xQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function xQ(e,t,n){return(t=bQ(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bQ(e){var t=yQ(e,"string");return typeof t=="symbol"?t:t+""}function yQ(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jQ(e,t){return af(af({},t),e)}function NQ(e,t){return e==="symbols"}function oE(e){var{shapeType:t,elementProps:n}=e;switch(t){case"rectangle":return g.createElement(Nk,n);case"trapezoid":return g.createElement(pQ,n);case"sector":return g.createElement(wk,n);case"symbols":if(NQ(t))return g.createElement(oz,n);break;case"curve":return g.createElement(gk,n);default:return null}}function _Q(e){return g.isValidElement(e)?e.props:e}function iM(e){var{option:t,shapeType:n,activeClassName:a="recharts-active-shape"}=e,l=vQ(e,hQ),o;if(g.isValidElement(t))o=g.cloneElement(t,af(af({},l),_Q(t)));else if(typeof t=="function")o=t(l,l.index);else if(cQ(t)&&typeof t!="boolean"){var u=jQ(t,l);o=g.createElement(oE,{shapeType:n,elementProps:u})}else{var d=l;o=g.createElement(oE,{shapeType:n,elementProps:d})}return l.isActive?g.createElement(Pn,{className:a},o):o}var sM=(e,t,n)=>{var a=Vt();return(l,o)=>u=>{e?.(l,o,u),a(hD({activeIndex:String(o),activeDataKey:t,activeCoordinate:l.tooltipPosition,activeGraphicalItemId:n}))}},lM=e=>{var t=Vt();return(n,a)=>l=>{e?.(n,a,l),t(LU())}},oM=(e,t,n)=>{var a=Vt();return(l,o)=>u=>{e?.(l,o,u),a($U({activeIndex:String(o),activeDataKey:t,activeCoordinate:l.tooltipPosition,activeGraphicalItemId:n}))}};function cM(e){var{tooltipEntrySettings:t}=e,n=Vt(),a=Mr(),l=g.useRef(null);return g.useLayoutEffect(()=>{a||(l.current===null?n(TU(t)):l.current!==t&&n(qU({prev:l.current,next:t})),l.current=t)},[t,n,a]),g.useLayoutEffect(()=>()=>{l.current&&(n(RU(l.current)),l.current=null)},[n]),null}function uM(e){var{legendPayload:t}=e,n=Vt(),a=Mr(),l=g.useRef(null);return g.useLayoutEffect(()=>{a||(l.current===null?n(h8(t)):l.current!==t&&n(v8({prev:l.current,next:t})),l.current=t)},[n,a,t]),g.useLayoutEffect(()=>()=>{l.current&&(n(g8(l.current)),l.current=null)},[n]),null}var fx,SQ=()=>{var[e]=g.useState(()=>$c("uid-"));return e},wQ=(fx=zq.useId)!==null&&fx!==void 0?fx:SQ;function CQ(e,t){var n=wQ();return t||(e?"".concat(e,"-").concat(n):n)}var EQ=g.createContext(void 0),dM=e=>{var{id:t,type:n,children:a}=e,l=CQ("recharts-".concat(n),t);return g.createElement(EQ.Provider,{value:l},a(l))},AQ={cartesianItems:[],polarItems:[]},mM=nn({name:"graphicalItems",initialState:AQ,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Pt()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:n,next:a}=t.payload,l=Kn(e).cartesianItems.indexOf(n);l>-1&&(e.cartesianItems[l]=a)},prepare:Pt()},removeCartesianGraphicalItem:{reducer(e,t){var n=Kn(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},prepare:Pt()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Pt()},removePolarGraphicalItem:{reducer(e,t){var n=Kn(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)},prepare:Pt()}}}),{addCartesianGraphicalItem:zQ,replaceCartesianGraphicalItem:kQ,removeCartesianGraphicalItem:OQ,addPolarGraphicalItem:cte,removePolarGraphicalItem:ute}=mM.actions,DQ=mM.reducer,MQ=e=>{var t=Vt(),n=g.useRef(null);return g.useLayoutEffect(()=>{n.current===null?t(zQ(e)):n.current!==e&&t(kQ({prev:n.current,next:e})),n.current=e},[t,e]),g.useLayoutEffect(()=>()=>{n.current&&(t(OQ(n.current)),n.current=null)},[t]),null},fM=g.memo(MQ),PQ=["points"];function cE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function px(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cE(Object(n),!0).forEach(function(a){TQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function TQ(e,t,n){return(t=qQ(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qQ(e){var t=RQ(e,"string");return typeof t=="symbol"?t:t+""}function RQ(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sf(){return sf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},sf.apply(null,arguments)}function IQ(e,t){if(e==null)return{};var n,a,l=LQ(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function LQ(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function $Q(e){var{option:t,dotProps:n,className:a}=e;if(g.isValidElement(t))return g.cloneElement(t,n);if(typeof t=="function")return t(n);var l=_t(a,typeof t!="boolean"?t.className:""),o=n??{},{points:u}=o,d=IQ(o,PQ);return g.createElement(tM,sf({},d,{className:l}))}function BQ(e,t){return e==null?!1:t?!0:e.length===1}function UQ(e){var{points:t,dot:n,className:a,dotClassName:l,dataKey:o,baseProps:u,needClip:d,clipPathId:f,zIndex:p=pr.scatter}=e;if(!BQ(t,n))return null;var h=aM(n),v=s6(n),b=t.map((j,N)=>{var w,C,E=px(px(px({r:3},u),v),{},{index:N,cx:(w=j.x)!==null&&w!==void 0?w:void 0,cy:(C=j.y)!==null&&C!==void 0?C:void 0,dataKey:o,value:j.value,payload:j.payload,points:t});return g.createElement($Q,{key:"dot-".concat(N),option:n,dotProps:E,className:l})}),x={};return d&&f!=null&&(x.clipPath="url(#clipPath-".concat(h?"":"dots-").concat(f,")")),g.createElement(Ln,{zIndex:p},g.createElement(Pn,sf({className:a},x),b))}function uE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function dE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uE(Object(n),!0).forEach(function(a){FQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function FQ(e,t,n){return(t=GQ(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GQ(e){var t=HQ(e,"string");return typeof t=="symbol"?t:t+""}function HQ(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pM=0,QQ={xAxis:{},yAxis:{},zAxis:{}},hM=nn({name:"cartesianAxis",initialState:QQ,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Pt()},replaceXAxis:{reducer(e,t){var{prev:n,next:a}=t.payload;e.xAxis[n.id]!==void 0&&(n.id!==a.id&&delete e.xAxis[n.id],e.xAxis[a.id]=a)},prepare:Pt()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Pt()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Pt()},replaceYAxis:{reducer(e,t){var{prev:n,next:a}=t.payload;e.yAxis[n.id]!==void 0&&(n.id!==a.id&&delete e.yAxis[n.id],e.yAxis[a.id]=a)},prepare:Pt()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Pt()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Pt()},replaceZAxis:{reducer(e,t){var{prev:n,next:a}=t.payload;e.zAxis[n.id]!==void 0&&(n.id!==a.id&&delete e.zAxis[n.id],e.zAxis[a.id]=a)},prepare:Pt()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Pt()},updateYAxisWidth(e,t){var{id:n,width:a}=t.payload,l=e.yAxis[n];if(l){var o,u=l.widthHistory||[];if(u.length===3&&u[0]===u[2]&&a===u[1]&&a!==l.width&&Math.abs(a-((o=u[0])!==null&&o!==void 0?o:0))<=1)return;var d=[...u,a].slice(-3);e.yAxis[n]=dE(dE({},l),{},{width:a,widthHistory:d})}}}}),{addXAxis:VQ,replaceXAxis:YQ,removeXAxis:KQ,addYAxis:WQ,replaceYAxis:XQ,removeYAxis:ZQ,addZAxis:dte,replaceZAxis:mte,removeZAxis:fte,updateYAxisWidth:JQ}=hM.actions,eV=hM.reducer,tV=de([hr],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),rV=de([tV,ii,si],(e,t,n)=>{if(!(!e||t==null||n==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),uj=()=>Ie(rV),nV=()=>Ie(zF);function mE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function hx(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mE(Object(n),!0).forEach(function(a){aV(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function aV(e,t,n){return(t=iV(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function iV(e){var t=sV(e,"string");return typeof t=="symbol"?t:t+""}function sV(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lV=e=>{var{point:t,childIndex:n,mainColor:a,activeDot:l,dataKey:o,clipPath:u}=e;if(l===!1||t.x==null||t.y==null)return null;var d={index:n,dataKey:o,cx:t.x,cy:t.y,r:4,fill:a??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},f=hx(hx(hx({},d),au(l)),Vb(l)),p;return g.isValidElement(l)?p=g.cloneElement(l,f):typeof l=="function"?p=l(f):p=g.createElement(tM,f),g.createElement(Pn,{className:"recharts-active-dot",clipPath:u},p)};function oV(e){var{points:t,mainColor:n,activeDot:a,itemDataKey:l,clipPath:o,zIndex:u=pr.activeDot}=e,d=Ie(Hs),f=nV();if(t==null||f==null)return null;var p=t.find(h=>f.includes(h.payload));return Rt(p)?null:g.createElement(Ln,{zIndex:u},g.createElement(lV,{point:p,childIndex:Number(d),mainColor:n,dataKey:l,activeDot:a,clipPath:o}))}var fE=(e,t,n)=>{var a=n??e;if(!Rt(a))return Xn(a,t,0)},cV=(e,t,n)=>{var a={},l=e.filter(rp),o=e.filter(p=>p.stackId==null),u=l.reduce((p,h)=>{var v=p[h.stackId];return v==null&&(v=[]),v.push(h),p[h.stackId]=v,p},a),d=Object.entries(u).map(p=>{var h,[v,b]=p,x=b.map(N=>N.dataKey),j=fE(t,n,(h=b[0])===null||h===void 0?void 0:h.barSize);return{stackId:v,dataKeys:x,barSize:j}}),f=o.map(p=>{var h=[p.dataKey].filter(b=>b!=null),v=fE(t,n,p.barSize);return{stackId:void 0,dataKeys:h,barSize:v}});return[...d,...f]};function pE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Zd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pE(Object(n),!0).forEach(function(a){uV(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function uV(e,t,n){return(t=dV(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dV(e){var t=mV(e,"string");return typeof t=="symbol"?t:t+""}function mV(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fV(e,t,n,a,l){var o,u=a.length;if(!(u<1)){var d=Xn(e,n,0,!0),f,p=[];if(st((o=a[0])===null||o===void 0?void 0:o.barSize)){var h=!1,v=n/u,b=a.reduce((E,S)=>E+(S.barSize||0),0);b+=(u-1)*d,b>=n&&(b-=(u-1)*d,d=0),b>=n&&v>0&&(h=!0,v*=.9,b=u*v);var x=(n-b)/2>>0,j={offset:x-d,size:0};f=a.reduce((E,S)=>{var A,O={stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:j.offset+j.size+d,size:h?v:(A=S.barSize)!==null&&A!==void 0?A:0}},k=[...E,O];return j=O.position,k},p)}else{var N=Xn(t,n,0,!0);n-2*N-(u-1)*d<=0&&(d=0);var w=(n-2*N-(u-1)*d)/u;w>1&&(w>>=0);var C=st(l)?Math.min(w,l):w;f=a.reduce((E,S,A)=>[...E,{stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:N+(w+d)*A+(w-C)/2,size:C}}],p)}return f}}var pV=(e,t,n,a,l,o,u)=>{var d=Rt(u)?t:u,f=fV(n,a,l!==o?l:o,e,d);return l!==o&&f!=null&&(f=f.map(p=>Zd(Zd({},p),{},{position:Zd(Zd({},p.position),{},{offset:p.position.offset-l/2})}))),f},hV=(e,t)=>{var n=By(t);if(!(!e||n==null||t==null)){var{stackId:a}=t;if(a!=null){var l=e[a];if(l){var{stackedData:o}=l;if(o)return o.find(u=>u.key===n)}}}},vV=(e,t)=>{if(!(e==null||t==null)){var n=e.find(a=>a.stackId===t.stackId&&t.dataKey!=null&&a.dataKeys.includes(t.dataKey));if(n!=null)return n.position}};function gV(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&st(e.zIndex)?e.zIndex:t}var xV=e=>{var{chartData:t}=e,n=Vt(),a=Mr();return g.useEffect(()=>a?()=>{}:(n(_2(t)),()=>{n(_2(void 0))}),[t,n,a]),null},hE={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},vM=nn({name:"brush",initialState:hE,reducers:{setBrushSettings(e,t){return t.payload==null?hE:t.payload}}}),{setBrushSettings:pte}=vM.actions,bV=vM.reducer;function yV(e){return(e%180+180)%180}var jV=function(t){var{width:n,height:a}=t,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=yV(l),u=o*Math.PI/180,d=Math.atan(a/n),f=u>d&&u<Math.PI-d?a/Math.sin(u):n/Math.cos(u);return Math.abs(f)},NV={dots:[],areas:[],lines:[]},gM=nn({name:"referenceElements",initialState:NV,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=Kn(e).dots.findIndex(a=>a===t.payload);n!==-1&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=Kn(e).areas.findIndex(a=>a===t.payload);n!==-1&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=Kn(e).lines.findIndex(a=>a===t.payload);n!==-1&&e.lines.splice(n,1)}}}),{addDot:hte,removeDot:vte,addArea:gte,removeArea:xte,addLine:bte,removeLine:yte}=gM.actions,_V=gM.reducer,SV=g.createContext(void 0),wV=e=>{var{children:t}=e,[n]=g.useState("".concat($c("recharts"),"-clip")),a=uj();if(a==null)return null;var{x:l,y:o,width:u,height:d}=a;return g.createElement(SV.Provider,{value:n},g.createElement("defs",null,g.createElement("clipPath",{id:n},g.createElement("rect",{x:l,y:o,height:d,width:u}))),t)};function xM(e,t){if(t<1)return[];if(t===1)return e;for(var n=[],a=0;a<e.length;a+=t){var l=e[a];l!==void 0&&n.push(l)}return n}function CV(e,t,n){var a={width:e.width+t.width,height:e.height+t.height};return jV(a,n)}function EV(e,t,n){var a=n==="width",{x:l,y:o,width:u,height:d}=e;return t===1?{start:a?l:o,end:a?l+u:o+d}:{start:a?l+u:o+d,end:a?l:o}}function eu(e,t,n,a,l){if(e*t<e*a||e*t>e*l)return!1;var o=n();return e*(t-e*o/2-a)>=0&&e*(t+e*o/2-l)<=0}function AV(e,t){return xM(e,t+1)}function zV(e,t,n,a,l){for(var o=(a||[]).slice(),{start:u,end:d}=t,f=0,p=1,h=u,v=function(){var j=a?.[f];if(j===void 0)return{v:xM(a,p)};var N=f,w,C=()=>(w===void 0&&(w=n(j,N)),w),E=j.coordinate,S=f===0||eu(e,E,C,h,d);S||(f=0,h=u,p+=1),S&&(h=E+e*(C()/2+l),f+=p)},b;p<=o.length;)if(b=v(),b)return b.v;return[]}function kV(e,t,n,a,l){var o=(a||[]).slice(),u=o.length;if(u===0)return[];for(var{start:d,end:f}=t,p=1;p<=u;p++){for(var h=(u-1)%p,v=d,b=!0,x=function(){var A=a[N];if(A==null)return 0;var O=N,k,M=()=>(k===void 0&&(k=n(A,O)),k),D=A.coordinate,$=N===h||eu(e,D,M,v,f);if(!$)return b=!1,1;$&&(v=D+e*(M()/2+l))},j,N=h;N<u&&(j=x(),!(j!==0&&j===1));N+=p);if(b){for(var w=[],C=h;C<u;C+=p){var E=a[C];E!=null&&w.push(E)}return w}}return[]}function vE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function kr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?vE(Object(n),!0).forEach(function(a){OV(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function OV(e,t,n){return(t=DV(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DV(e){var t=MV(e,"string");return typeof t=="symbol"?t:t+""}function MV(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PV(e,t,n,a,l){for(var o=(a||[]).slice(),u=o.length,{start:d}=t,{end:f}=t,p=function(b){var x=o[b];if(x==null)return 1;var j=x,N,w=()=>(N===void 0&&(N=n(x,b)),N);if(b===u-1){var C=e*(j.coordinate+e*w()/2-f);o[b]=j=kr(kr({},j),{},{tickCoord:C>0?j.coordinate-C*e:j.coordinate})}else o[b]=j=kr(kr({},j),{},{tickCoord:j.coordinate});if(j.tickCoord!=null){var E=eu(e,j.tickCoord,w,d,f);E&&(f=j.tickCoord-e*(w()/2+l),o[b]=kr(kr({},j),{},{isShow:!0}))}},h=u-1;h>=0;h--)p(h);return o}function TV(e,t,n,a,l,o){var u=(a||[]).slice(),d=u.length,{start:f,end:p}=t;if(o){var h=a[d-1];if(h!=null){var v=n(h,d-1),b=e*(h.coordinate+e*v/2-p);if(u[d-1]=h=kr(kr({},h),{},{tickCoord:b>0?h.coordinate-b*e:h.coordinate}),h.tickCoord!=null){var x=eu(e,h.tickCoord,()=>v,f,p);x&&(p=h.tickCoord-e*(v/2+l),u[d-1]=kr(kr({},h),{},{isShow:!0}))}}}for(var j=o?d-1:d,N=function(E){var S=u[E];if(S==null)return 1;var A=S,O,k=()=>(O===void 0&&(O=n(S,E)),O);if(E===0){var M=e*(A.coordinate-e*k()/2-f);u[E]=A=kr(kr({},A),{},{tickCoord:M<0?A.coordinate-M*e:A.coordinate})}else u[E]=A=kr(kr({},A),{},{tickCoord:A.coordinate});if(A.tickCoord!=null){var D=eu(e,A.tickCoord,k,f,p);D&&(f=A.tickCoord+e*(k()/2+l),u[E]=kr(kr({},A),{},{isShow:!0}))}},w=0;w<j;w++)N(w);return u}function dj(e,t,n){var{tick:a,ticks:l,viewBox:o,minTickGap:u,orientation:d,interval:f,tickFormatter:p,unit:h,angle:v}=e;if(!l||!l.length||!a)return[];if(De(f)||Uf.isSsr){var b;return(b=AV(l,De(f)?f:0))!==null&&b!==void 0?b:[]}var x=[],j=d==="top"||d==="bottom"?"width":"height",N=h&&j==="width"?qc(h,{fontSize:t,letterSpacing:n}):{width:0,height:0},w=(O,k)=>{var M=typeof p=="function"?p(O.value,k):O.value;return j==="width"?CV(qc(M,{fontSize:t,letterSpacing:n}),N,v):qc(M,{fontSize:t,letterSpacing:n})[j]},C=l[0],E=l[1],S=l.length>=2&&C!=null&&E!=null?Jr(E.coordinate-C.coordinate):1,A=EV(o,S,j);return f==="equidistantPreserveStart"?zV(S,A,w,l,u):f==="equidistantPreserveEnd"?kV(S,A,w,l,u):(f==="preserveStart"||f==="preserveStartEnd"?x=TV(S,A,w,l,u,f==="preserveStartEnd"):x=PV(S,A,w,l,u),x.filter(O=>O.isShow))}var qV=e=>{var{ticks:t,label:n,labelGapWithTick:a=5,tickSize:l=0,tickMargin:o=0}=e,u=0;if(t){Array.from(t).forEach(h=>{if(h){var v=h.getBoundingClientRect();v.width>u&&(u=v.width)}});var d=n?n.getBoundingClientRect().width:0,f=l+o,p=u+f+d+(n?a:0);return Math.round(p)}return 0},RV=["axisLine","width","height","className","hide","ticks","axisType"];function IV(e,t){if(e==null)return{};var n,a,l=LV(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function LV(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function Qs(){return Qs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Qs.apply(null,arguments)}function gE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Bt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gE(Object(n),!0).forEach(function(a){$V(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function $V(e,t,n){return(t=BV(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BV(e){var t=UV(e,"string");return typeof t=="symbol"?t:t+""}function UV(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ka={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:pr.axis};function FV(e){var{x:t,y:n,width:a,height:l,orientation:o,mirror:u,axisLine:d,otherSvgProps:f}=e;if(!d)return null;var p=Bt(Bt(Bt({},f),Wn(d)),{},{fill:"none"});if(o==="top"||o==="bottom"){var h=+(o==="top"&&!u||o==="bottom"&&u);p=Bt(Bt({},p),{},{x1:t,y1:n+h*l,x2:t+a,y2:n+h*l})}else{var v=+(o==="left"&&!u||o==="right"&&u);p=Bt(Bt({},p),{},{x1:t+v*a,y1:n,x2:t+v*a,y2:n+l})}return g.createElement("line",Qs({},p,{className:_t("recharts-cartesian-axis-line",oo(d,"className"))}))}function GV(e,t,n,a,l,o,u,d,f){var p,h,v,b,x,j,N=d?-1:1,w=e.tickSize||u,C=De(e.tickCoord)?e.tickCoord:e.coordinate;switch(o){case"top":p=h=e.coordinate,b=n+ +!d*l,v=b-N*w,j=v-N*f,x=C;break;case"left":v=b=e.coordinate,h=t+ +!d*a,p=h-N*w,x=p-N*f,j=C;break;case"right":v=b=e.coordinate,h=t+ +d*a,p=h+N*w,x=p+N*f,j=C;break;default:p=h=e.coordinate,b=n+ +d*l,v=b+N*w,j=v+N*f,x=C;break}return{line:{x1:p,y1:v,x2:h,y2:b},tick:{x,y:j}}}function HV(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function QV(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function VV(e){var{option:t,tickProps:n,value:a}=e,l,o=_t(n.className,"recharts-cartesian-axis-tick-value");if(g.isValidElement(t))l=g.cloneElement(t,Bt(Bt({},n),{},{className:o}));else if(typeof t=="function")l=t(Bt(Bt({},n),{},{className:o}));else{var u="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(u=_t(u,tQ(t))),l=g.createElement(oj,Qs({},n,{className:u}),a)}return l}var YV=g.forwardRef((e,t)=>{var{ticks:n=[],tick:a,tickLine:l,stroke:o,tickFormatter:u,unit:d,padding:f,tickTextProps:p,orientation:h,mirror:v,x:b,y:x,width:j,height:N,tickSize:w,tickMargin:C,fontSize:E,letterSpacing:S,getTicksConfig:A,events:O,axisType:k}=e,M=dj(Bt(Bt({},A),{},{ticks:n}),E,S),D=HV(h,v),$=QV(h,v),U=Wn(A),L=au(a),B={};typeof l=="object"&&(B=l);var ee=Bt(Bt({},U),{},{fill:"none"},B),se=M.map(F=>Bt({entry:F},GV(F,b,x,j,N,h,w,v,C))),P=se.map(F=>{var{entry:R,line:W}=F;return g.createElement(Pn,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(R.value,"-").concat(R.coordinate,"-").concat(R.tickCoord)},l&&g.createElement("line",Qs({},ee,W,{className:_t("recharts-cartesian-axis-tick-line",oo(l,"className"))})))}),q=se.map((F,R)=>{var W,I,{entry:re,tick:V}=F,oe=Bt(Bt(Bt(Bt({verticalAnchor:$},U),{},{textAnchor:D,stroke:"none",fill:o},V),{},{index:R,payload:re,visibleTicksCount:M.length,tickFormatter:u,padding:f},p),{},{angle:(W=(I=p?.angle)!==null&&I!==void 0?I:U.angle)!==null&&W!==void 0?W:0}),xe=Bt(Bt({},oe),L);return g.createElement(Pn,Qs({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(re.value,"-").concat(re.coordinate,"-").concat(re.tickCoord)},Yb(O,re,R)),a&&g.createElement(VV,{option:a,tickProps:xe,value:"".concat(typeof u=="function"?u(re.value,R):re.value).concat(d||"")}))});return g.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(k,"-ticks")},q.length>0&&g.createElement(Ln,{zIndex:pr.label},g.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(k,"-tick-labels"),ref:t},q)),P.length>0&&g.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(k,"-tick-lines")},P))}),KV=g.forwardRef((e,t)=>{var{axisLine:n,width:a,height:l,className:o,hide:u,ticks:d,axisType:f}=e,p=IV(e,RV),[h,v]=g.useState(""),[b,x]=g.useState(""),j=g.useRef(null);g.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var w;return qV({ticks:j.current,label:(w=e.labelRef)===null||w===void 0?void 0:w.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var N=g.useCallback(w=>{if(w){var C=w.getElementsByClassName("recharts-cartesian-axis-tick-value");j.current=C;var E=C[0];if(E){var S=window.getComputedStyle(E),A=S.fontSize,O=S.letterSpacing;(A!==h||O!==b)&&(v(A),x(O))}}},[h,b]);return u||a!=null&&a<=0||l!=null&&l<=0?null:g.createElement(Ln,{zIndex:e.zIndex},g.createElement(Pn,{className:_t("recharts-cartesian-axis",o)},g.createElement(FV,{x:e.x,y:e.y,width:a,height:l,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:Wn(e)}),g.createElement(YV,{ref:N,axisType:f,events:p,fontSize:h,getTicksConfig:e,height:e.height,letterSpacing:b,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:d,unit:e.unit,width:e.width,x:e.x,y:e.y}),g.createElement(kH,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},g.createElement($H,{label:e.label,labelRef:e.labelRef}),e.children)))}),mj=g.forwardRef((e,t)=>{var n=Ur(e,Ka);return g.createElement(KV,Qs({},n,{ref:t}))});mj.displayName="CartesianAxis";var WV=["x1","y1","x2","y2","key"],XV=["offset"],ZV=["xAxisId","yAxisId"],JV=["xAxisId","yAxisId"];function xE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Or(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xE(Object(n),!0).forEach(function(a){eY(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function eY(e,t,n){return(t=tY(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tY(e){var t=rY(e,"string");return typeof t=="symbol"?t:t+""}function rY(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ds(){return Ds=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ds.apply(null,arguments)}function lf(e,t){if(e==null)return{};var n,a,l=nY(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function nY(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var aY=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:n,x:a,y:l,width:o,height:u,ry:d}=e;return g.createElement("rect",{x:a,y:l,ry:d,width:o,height:u,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function bM(e){var{option:t,lineItemProps:n}=e,a;if(g.isValidElement(t))a=g.cloneElement(t,n);else if(typeof t=="function")a=t(n);else{var l,{x1:o,y1:u,x2:d,y2:f,key:p}=n,h=lf(n,WV),v=(l=Wn(h))!==null&&l!==void 0?l:{},{offset:b}=v,x=lf(v,XV);a=g.createElement("line",Ds({},x,{x1:o,y1:u,x2:d,y2:f,fill:"none",key:p}))}return a}function iY(e){var{x:t,width:n,horizontal:a=!0,horizontalPoints:l}=e;if(!a||!l||!l.length)return null;var{xAxisId:o,yAxisId:u}=e,d=lf(e,ZV),f=l.map((p,h)=>{var v=Or(Or({},d),{},{x1:t,y1:p,x2:t+n,y2:p,key:"line-".concat(h),index:h});return g.createElement(bM,{key:"line-".concat(h),option:a,lineItemProps:v})});return g.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function sY(e){var{y:t,height:n,vertical:a=!0,verticalPoints:l}=e;if(!a||!l||!l.length)return null;var{xAxisId:o,yAxisId:u}=e,d=lf(e,JV),f=l.map((p,h)=>{var v=Or(Or({},d),{},{x1:p,y1:t,x2:p,y2:t+n,key:"line-".concat(h),index:h});return g.createElement(bM,{option:a,lineItemProps:v,key:"line-".concat(h)})});return g.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function lY(e){var{horizontalFill:t,fillOpacity:n,x:a,y:l,width:o,height:u,horizontalPoints:d,horizontal:f=!0}=e;if(!f||!t||!t.length||d==null)return null;var p=d.map(v=>Math.round(v+l-l)).sort((v,b)=>v-b);l!==p[0]&&p.unshift(0);var h=p.map((v,b)=>{var x=p[b+1],j=x==null,N=j?l+u-v:x-v;if(N<=0)return null;var w=b%t.length;return g.createElement("rect",{key:"react-".concat(b),y:v,x:a,height:N,width:o,stroke:"none",fill:t[w],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return g.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function oY(e){var{vertical:t=!0,verticalFill:n,fillOpacity:a,x:l,y:o,width:u,height:d,verticalPoints:f}=e;if(!t||!n||!n.length)return null;var p=f.map(v=>Math.round(v+l-l)).sort((v,b)=>v-b);l!==p[0]&&p.unshift(0);var h=p.map((v,b)=>{var x=p[b+1],j=x==null,N=j?l+u-v:x-v;if(N<=0)return null;var w=b%n.length;return g.createElement("rect",{key:"react-".concat(b),x:v,y:o,width:N,height:d,stroke:"none",fill:n[w],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return g.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var cY=(e,t)=>{var{xAxis:n,width:a,height:l,offset:o}=e;return Zz(dj(Or(Or(Or({},Ka),n),{},{ticks:Jz(n),viewBox:{x:0,y:0,width:a,height:l}})),o.left,o.left+o.width,t)},uY=(e,t)=>{var{yAxis:n,width:a,height:l,offset:o}=e;return Zz(dj(Or(Or(Or({},Ka),n),{},{ticks:Jz(n),viewBox:{x:0,y:0,width:a,height:l}})),o.top,o.top+o.height,t)},dY={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:pr.grid};function bb(e){var t=ik(),n=sk(),a=ak(),l=Or(Or({},Ur(e,dY)),{},{x:De(e.x)?e.x:a.left,y:De(e.y)?e.y:a.top,width:De(e.width)?e.width:a.width,height:De(e.height)?e.height:a.height}),{xAxisId:o,yAxisId:u,x:d,y:f,width:p,height:h,syncWithTicks:v,horizontalValues:b,verticalValues:x}=l,j=Mr(),N=Ie($=>d2($,"xAxis",o,j)),w=Ie($=>d2($,"yAxis",u,j));if(!ba(p)||!ba(h)||!De(d)||!De(f))return null;var C=l.verticalCoordinatesGenerator||cY,E=l.horizontalCoordinatesGenerator||uY,{horizontalPoints:S,verticalPoints:A}=l;if((!S||!S.length)&&typeof E=="function"){var O=b&&b.length,k=E({yAxis:w?Or(Or({},w),{},{ticks:O?b:w.ticks}):void 0,width:t??p,height:n??h,offset:a},O?!0:v);Dm(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof k,"]")),Array.isArray(k)&&(S=k)}if((!A||!A.length)&&typeof C=="function"){var M=x&&x.length,D=C({xAxis:N?Or(Or({},N),{},{ticks:M?x:N.ticks}):void 0,width:t??p,height:n??h,offset:a},M?!0:v);Dm(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(A=D)}return g.createElement(Ln,{zIndex:l.zIndex},g.createElement("g",{className:"recharts-cartesian-grid"},g.createElement(aY,{fill:l.fill,fillOpacity:l.fillOpacity,x:l.x,y:l.y,width:l.width,height:l.height,ry:l.ry}),g.createElement(lY,Ds({},l,{horizontalPoints:S})),g.createElement(oY,Ds({},l,{verticalPoints:A})),g.createElement(iY,Ds({},l,{offset:a,horizontalPoints:S,xAxis:N,yAxis:w})),g.createElement(sY,Ds({},l,{offset:a,verticalPoints:A,xAxis:N,yAxis:w}))))}bb.displayName="CartesianGrid";var mY={},yM=nn({name:"errorBars",initialState:mY,reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:a}=t.payload;e[n]||(e[n]=[]),e[n].push(a)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:a,next:l}=t.payload;e[n]&&(e[n]=e[n].map(o=>o.dataKey===a.dataKey&&o.direction===a.direction?l:o))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:a}=t.payload;e[n]&&(e[n]=e[n].filter(l=>l.dataKey!==a.dataKey||l.direction!==a.direction))}}}),{addErrorBar:jte,replaceErrorBar:Nte,removeErrorBar:_te}=yM.actions,fY=yM.reducer,pY=["children"];function hY(e,t){if(e==null)return{};var n,a,l=vY(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function vY(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var gY={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},xY=g.createContext(gY);function jM(e){var{children:t}=e,n=hY(e,pY);return g.createElement(xY.Provider,{value:n},t)}function fj(e,t){var n,a,l=Ie(p=>ci(p,e)),o=Ie(p=>ui(p,t)),u=(n=l?.allowDataOverflow)!==null&&n!==void 0?n:ur.allowDataOverflow,d=(a=o?.allowDataOverflow)!==null&&a!==void 0?a:dr.allowDataOverflow,f=u||d;return{needClip:f,needClipX:u,needClipY:d}}function NM(e){var{xAxisId:t,yAxisId:n,clipPathId:a}=e,l=uj(),{needClipX:o,needClipY:u,needClip:d}=fj(t,n);if(!d||!l)return null;var{x:f,y:p,width:h,height:v}=l;return g.createElement("clipPath",{id:"clipPath-".concat(a)},g.createElement("rect",{x:o?f:f-h/2,y:u?p:p-v/2,width:o?h:h*2,height:u?v:v*2}))}var _M=(e,t,n,a)=>Zi(e,"xAxis",t,a),SM=(e,t,n,a)=>Xi(e,"xAxis",t,a),wM=(e,t,n,a)=>Zi(e,"yAxis",n,a),CM=(e,t,n,a)=>Xi(e,"yAxis",n,a),bY=de([gt,_M,wM,SM,CM],(e,t,n,a,l)=>ai(e,"xAxis")?uo(t,a,!1):uo(n,l,!1)),yY=(e,t,n,a,l)=>l;function jY(e){return e.type==="line"}var NY=de([ip,yY],(e,t)=>e.filter(jY).find(n=>n.id===t)),_Y=de([gt,_M,wM,SM,CM,NY,bY,Dy],(e,t,n,a,l,o,u,d)=>{var{chartData:f,dataStartIndex:p,dataEndIndex:h}=d;if(!(o==null||t==null||n==null||a==null||l==null||a.length===0||l.length===0||u==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:v,data:b}=o,x;if(b!=null&&b.length>0?x=b:x=f?.slice(p,h+1),x!=null)return uK({layout:e,xAxis:t,yAxis:n,xAxisTicks:a,yAxisTicks:l,dataKey:v,bandSize:u,displayedData:x})}});function SY(e){var t=au(e),n=3,a=2;if(t!=null){var{r:l,strokeWidth:o}=t,u=Number(l),d=Number(o);return(Number.isNaN(u)||u<0)&&(u=n),(Number.isNaN(d)||d<0)&&(d=a),{r:u,strokeWidth:d}}return{r:n,strokeWidth:a}}var vx={exports:{}},gx={};var bE;function wY(){if(bE)return gx;bE=1;var e=vf();function t(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var n=typeof Object.is=="function"?Object.is:t,a=e.useSyncExternalStore,l=e.useRef,o=e.useEffect,u=e.useMemo,d=e.useDebugValue;return gx.useSyncExternalStoreWithSelector=function(f,p,h,v,b){var x=l(null);if(x.current===null){var j={hasValue:!1,value:null};x.current=j}else j=x.current;x=u(function(){function w(O){if(!C){if(C=!0,E=O,O=v(O),b!==void 0&&j.hasValue){var k=j.value;if(b(k,O))return S=k}return S=O}if(k=S,n(E,O))return k;var M=v(O);return b!==void 0&&b(k,M)?(E=O,k):(E=O,S=M)}var C=!1,E,S,A=h===void 0?null:h;return[function(){return w(p())},A===null?void 0:function(){return w(A())}]},[p,h,v,b]);var N=a(f,x[0],x[1]);return o(function(){j.hasValue=!0,j.value=N},[N]),d(N),N},gx}var yE;function CY(){return yE||(yE=1,vx.exports=wY()),vx.exports}CY();function EY(e){e()}function AY(){let e=null,t=null;return{clear(){e=null,t=null},notify(){EY(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){const n=[];let a=e;for(;a;)n.push(a),a=a.next;return n},subscribe(n){let a=!0;const l=t={callback:n,next:null,prev:t};return l.prev?l.prev.next=l:e=l,function(){!a||e===null||(a=!1,l.next?l.next.prev=l.prev:t=l.prev,l.prev?l.prev.next=l.next:e=l.next)}}}}var jE={notify(){},get:()=>[]};function zY(e,t){let n,a=jE,l=0,o=!1;function u(N){h();const w=a.subscribe(N);let C=!1;return()=>{C||(C=!0,w(),v())}}function d(){a.notify()}function f(){j.onStateChange&&j.onStateChange()}function p(){return o}function h(){l++,n||(n=e.subscribe(f),a=AY())}function v(){l--,n&&l===0&&(n(),n=void 0,a.clear(),a=jE)}function b(){o||(o=!0,h())}function x(){o&&(o=!1,v())}const j={addNestedSub:u,notifyNestedSubs:d,handleChangeWrapper:f,isSubscribed:p,trySubscribe:b,tryUnsubscribe:x,getListeners:()=>a};return j}var kY=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",OY=kY(),DY=()=>typeof navigator<"u"&&navigator.product==="ReactNative",MY=DY(),PY=()=>OY||MY?g.useLayoutEffect:g.useEffect,TY=PY();function NE(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function qY(e,t){if(NE(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(let l=0;l<n.length;l++)if(!Object.prototype.hasOwnProperty.call(t,n[l])||!NE(e[n[l]],t[n[l]]))return!1;return!0}var RY=Symbol.for("react-redux-context"),IY=typeof globalThis<"u"?globalThis:{};function LY(){if(!g.createContext)return{};const e=IY[RY]??=new Map;let t=e.get(g.createContext);return t||(t=g.createContext(null),e.set(g.createContext,t)),t}var $Y=LY();function BY(e){const{children:t,context:n,serverState:a,store:l}=e,o=g.useMemo(()=>{const f=zY(l);return{store:l,subscription:f,getServerState:a?()=>a:void 0}},[l,a]),u=g.useMemo(()=>l.getState(),[l]);TY(()=>{const{subscription:f}=o;return f.onStateChange=f.notifyNestedSubs,f.trySubscribe(),u!==l.getState()&&f.notifyNestedSubs(),()=>{f.tryUnsubscribe(),f.onStateChange=void 0}},[o,u]);const d=n||$Y;return g.createElement(d.Provider,{value:o},t)}var UY=BY,FY=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function GY(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function up(e,t){var n=new Set([...Object.keys(e),...Object.keys(t)]);for(var a of n)if(FY.has(a)){if(e[a]==null&&t[a]==null)continue;if(!qY(e[a],t[a]))return!1}else if(!GY(e[a],t[a]))return!1;return!0}var HY=["id"],QY=["type","layout","connectNulls","needClip","shape"],VY=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function tu(){return tu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},tu.apply(null,arguments)}function _E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function da(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_E(Object(n),!0).forEach(function(a){YY(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_E(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function YY(e,t,n){return(t=KY(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KY(e){var t=WY(e,"string");return typeof t=="symbol"?t:t+""}function WY(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pj(e,t){if(e==null)return{};var n,a,l=XY(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function XY(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var ZY=e=>{var{dataKey:t,name:n,stroke:a,legendType:l,hide:o}=e;return[{inactive:o,dataKey:t,type:l,color:a,value:Mf(n,t),payload:e}]},JY=g.memo(e=>{var{dataKey:t,data:n,stroke:a,strokeWidth:l,fill:o,name:u,hide:d,unit:f,tooltipType:p,id:h}=e,v={dataDefinedOnItem:n,getPosition:Js,settings:{stroke:a,strokeWidth:l,fill:o,dataKey:t,nameKey:void 0,name:Mf(u,t),hide:d,type:p,color:a,unit:f,graphicalItemId:h}};return g.createElement(cM,{tooltipEntrySettings:v})}),EM=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function eK(e,t){for(var n=e.length%2!==0?[...e,0]:e,a=[],l=0;l<t;++l)a=[...a,...n];return a}var tK=(e,t,n)=>{var a=n.reduce((x,j)=>x+j);if(!a)return EM(t,e);for(var l=Math.floor(e/a),o=e%a,u=t-e,d=[],f=0,p=0;f<n.length;p+=(h=n[f])!==null&&h!==void 0?h:0,++f){var h,v=n[f];if(v!=null&&p+v>o){d=[...n.slice(0,f),o-p];break}}var b=d.length%2===0?[0,u]:[u];return[...eK(n,l),...d,...b].map(x=>"".concat(x,"px")).join(", ")};function rK(e){var{clipPathId:t,points:n,props:a}=e,{dot:l,dataKey:o,needClip:u}=a,{id:d}=a,f=pj(a,HY),p=Wn(f);return g.createElement(UQ,{points:n,dot:l,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:o,baseProps:p,needClip:u,clipPathId:t})}function nK(e){var{showLabels:t,children:n,points:a}=e,l=g.useMemo(()=>a?.map(o=>{var u,d,f={x:(u=o.x)!==null&&u!==void 0?u:0,y:(d=o.y)!==null&&d!==void 0?d:0,width:0,lowerWidth:0,upperWidth:0,height:0};return da(da({},f),{},{value:o.value,payload:o.payload,viewBox:f,parentViewBox:void 0,fill:void 0})}),[a]);return g.createElement(ZD,{value:t?l:void 0},n)}function SE(e){var{clipPathId:t,pathRef:n,points:a,strokeDasharray:l,props:o}=e,{type:u,layout:d,connectNulls:f,needClip:p,shape:h}=o,v=pj(o,QY),b=da(da({},$r(v)),{},{fill:"none",className:"recharts-line-curve",clipPath:p?"url(#clipPath-".concat(t,")"):void 0,points:a,type:u,layout:d,connectNulls:f,strokeDasharray:l??o.strokeDasharray});return g.createElement(g.Fragment,null,a?.length>1&&g.createElement(iM,tu({shapeType:"curve",option:h},b,{pathRef:n})),g.createElement(rK,{points:a,clipPathId:t,props:o}))}function aK(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function iK(e){var{clipPathId:t,props:n,pathRef:a,previousPointsRef:l,longestAnimatedLengthRef:o}=e,{points:u,strokeDasharray:d,isAnimationActive:f,animationBegin:p,animationDuration:h,animationEasing:v,animateNewValues:b,width:x,height:j,onAnimationEnd:N,onAnimationStart:w}=n,C=l.current,E=Gf(u,"recharts-line-"),S=g.useRef(E),[A,O]=g.useState(!1),k=!A,M=g.useCallback(()=>{typeof N=="function"&&N(),O(!1)},[N]),D=g.useCallback(()=>{typeof w=="function"&&w(),O(!0)},[w]),$=aK(a.current),U=g.useRef(0);S.current!==E&&(U.current=o.current,S.current=E);var L=U.current;return g.createElement(nK,{points:u,showLabels:k},n.children,g.createElement(Ff,{animationId:E,begin:p,duration:h,isActive:f,easing:v,onAnimationEnd:M,onAnimationStart:D,key:E},B=>{var ee=Gt(L,$+L,B),se=Math.min(ee,$),P;if(f)if(d){var q="".concat(d).split(/[,\s]+/gim).map(W=>parseFloat(W));P=tK(se,$,q)}else P=EM($,se);else P=d==null?void 0:String(d);if(B>0&&$>0&&(l.current=u,o.current=Math.max(o.current,se)),C){var F=C.length/u.length,R=B===1?u:u.map((W,I)=>{var re=Math.floor(I*F);if(C[re]){var V=C[re];return da(da({},W),{},{x:Gt(V.x,W.x,B),y:Gt(V.y,W.y,B)})}return b?da(da({},W),{},{x:Gt(x*2,W.x,B),y:Gt(j/2,W.y,B)}):da(da({},W),{},{x:W.x,y:W.y})});return l.current=R,g.createElement(SE,{props:n,points:R,clipPathId:t,pathRef:a,strokeDasharray:P})}return g.createElement(SE,{props:n,points:u,clipPathId:t,pathRef:a,strokeDasharray:P})}),g.createElement(eM,{label:n.label}))}function sK(e){var{clipPathId:t,props:n}=e,a=g.useRef(null),l=g.useRef(0),o=g.useRef(null);return g.createElement(iK,{props:n,clipPathId:t,previousPointsRef:a,longestAnimatedLengthRef:l,pathRef:o})}var lK=(e,t)=>{var n,a;return{x:(n=e.x)!==null&&n!==void 0?n:void 0,y:(a=e.y)!==null&&a!==void 0?a:void 0,value:e.value,errorVal:Jt(e.payload,t)}};class oK extends g.Component{render(){var{hide:t,dot:n,points:a,className:l,xAxisId:o,yAxisId:u,top:d,left:f,width:p,height:h,id:v,needClip:b,zIndex:x}=this.props;if(t)return null;var j=_t("recharts-line",l),N=v,{r:w,strokeWidth:C}=SY(n),E=aM(n),S=w*2+C,A=b?"url(#clipPath-".concat(E?"":"dots-").concat(N,")"):void 0;return g.createElement(Ln,{zIndex:x},g.createElement(Pn,{className:j},b&&g.createElement("defs",null,g.createElement(NM,{clipPathId:N,xAxisId:o,yAxisId:u}),!E&&g.createElement("clipPath",{id:"clipPath-dots-".concat(N)},g.createElement("rect",{x:f-S/2,y:d-S/2,width:p+S,height:h+S}))),g.createElement(jM,{xAxisId:o,yAxisId:u,data:a,dataPointFormatter:lK,errorBarOffset:0},g.createElement(sK,{props:this.props,clipPathId:N}))),g.createElement(oV,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:A}))}}var AM={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:pr.line,type:"linear"};function cK(e){var t=Ur(e,AM),{activeDot:n,animateNewValues:a,animationBegin:l,animationDuration:o,animationEasing:u,connectNulls:d,dot:f,hide:p,isAnimationActive:h,label:v,legendType:b,xAxisId:x,yAxisId:j,id:N}=t,w=pj(t,VY),{needClip:C}=fj(x,j),E=uj(),S=el(),A=Mr(),O=Ie(U=>_Y(U,x,j,A,N));if(S!=="horizontal"&&S!=="vertical"||O==null||E==null)return null;var{height:k,width:M,x:D,y:$}=E;return g.createElement(oK,tu({},w,{id:N,connectNulls:d,dot:f,activeDot:n,animateNewValues:a,animationBegin:l,animationDuration:o,animationEasing:u,isAnimationActive:h,hide:p,label:v,legendType:b,xAxisId:x,yAxisId:j,points:O,layout:S,height:k,width:M,left:D,top:$,needClip:C}))}function uK(e){var{layout:t,xAxis:n,yAxis:a,xAxisTicks:l,yAxisTicks:o,dataKey:u,bandSize:d,displayedData:f}=e;return f.map((p,h)=>{var v=Jt(p,u);if(t==="horizontal"){var b=cw({axis:n,ticks:l,bandSize:d,entry:p,index:h}),x=Rt(v)?null:a.scale.map(v);return{x:b,y:x??null,value:v,payload:p}}var j=Rt(v)?null:n.scale.map(v),N=cw({axis:a,ticks:o,bandSize:d,entry:p,index:h});return j==null||N==null?null:{x:j,y:N,value:v,payload:p}}).filter(Boolean)}function dK(e){var t=Ur(e,AM),n=Mr();return g.createElement(dM,{id:t.id,type:"line"},a=>g.createElement(g.Fragment,null,g.createElement(uM,{legendPayload:ZY(t)}),g.createElement(JY,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:a}),g.createElement(fM,{type:"line",id:a,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:n}),g.createElement(cK,tu({},t,{id:a}))))}var zM=g.memo(dK,up);zM.displayName="Line";function nl(e,t){var n,a;return(n=(a=e.graphicalItems.cartesianItems.find(l=>l.id===t))===null||a===void 0?void 0:a.xAxisId)!==null&&n!==void 0?n:pM}function al(e,t){var n,a;return(n=(a=e.graphicalItems.cartesianItems.find(l=>l.id===t))===null||a===void 0?void 0:a.yAxisId)!==null&&n!==void 0?n:pM}var mK="Invariant failed";function fK(e,t){throw new Error(mK)}function yb(){return yb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},yb.apply(null,arguments)}function of(e){return g.createElement(iM,yb({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var pK=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a,l)=>{if(De(t))return t;var o=De(a)||Rt(a);return o?t(a,l):(o||fK(),n)}},hK=(e,t,n)=>n,vK=(e,t)=>t,ju=de([ip,vK],(e,t)=>e.filter(n=>n.type==="bar").find(n=>n.id===t)),gK=de([ju],e=>e?.maxBarSize),xK=(e,t,n,a)=>a,bK=de([gt,ip,nl,al,hK],(e,t,n,a,l)=>t.filter(o=>e==="horizontal"?o.xAxisId===n:o.yAxisId===a).filter(o=>o.isPanorama===l).filter(o=>o.hide===!1).filter(o=>o.type==="bar")),yK=(e,t,n)=>{var a=gt(e),l=nl(e,t),o=al(e,t);if(!(l==null||o==null))return a==="horizontal"?mb(e,"yAxis",o,n):mb(e,"xAxis",l,n)},jK=(e,t)=>{var n=gt(e),a=nl(e,t),l=al(e,t);if(!(a==null||l==null))return n==="horizontal"?u2(e,"xAxis",a):u2(e,"yAxis",l)},NK=de([bK,S9,jK],cV),_K=(e,t,n)=>{var a,l,o=ju(e,t);if(o==null)return 0;var u=nl(e,t),d=al(e,t);if(u==null||d==null)return 0;var f=gt(e),p=xO(e),{maxBarSize:h}=o,v=Rt(h)?p:h,b,x;return f==="horizontal"?(b=Zi(e,"xAxis",u,n),x=Xi(e,"xAxis",u,n)):(b=Zi(e,"yAxis",d,n),x=Xi(e,"yAxis",d,n)),(a=(l=uo(b,x,!0))!==null&&l!==void 0?l:v)!==null&&a!==void 0?a:0},kM=(e,t,n)=>{var a=gt(e),l=nl(e,t),o=al(e,t);if(!(l==null||o==null)){var u,d;return a==="horizontal"?(u=Zi(e,"xAxis",l,n),d=Xi(e,"xAxis",l,n)):(u=Zi(e,"yAxis",o,n),d=Xi(e,"yAxis",o,n)),uo(u,d)}},SK=de([NK,xO,_9,bO,_K,kM,gK],pV),wK=(e,t,n)=>{var a=nl(e,t);if(a!=null)return Zi(e,"xAxis",a,n)},CK=(e,t,n)=>{var a=al(e,t);if(a!=null)return Zi(e,"yAxis",a,n)},EK=(e,t,n)=>{var a=nl(e,t);if(a!=null)return Xi(e,"xAxis",a,n)},AK=(e,t,n)=>{var a=al(e,t);if(a!=null)return Xi(e,"yAxis",a,n)},zK=de([SK,ju],vV),kK=de([yK,ju],hV),OK=de([hr,ay,wK,CK,EK,AK,zK,gt,h9,kM,kK,ju,xK],(e,t,n,a,l,o,u,d,f,p,h,v,b)=>{var{chartData:x,dataStartIndex:j,dataEndIndex:N}=f;if(!(v==null||u==null||t==null||d!=="horizontal"&&d!=="vertical"||n==null||a==null||l==null||o==null||p==null)){var{data:w}=v,C;if(w!=null&&w.length>0?C=w:C=x?.slice(j,N+1),C!=null)return iW({layout:d,barSettings:v,pos:u,parentViewBox:t,bandSize:p,xAxis:n,yAxis:a,xAxisTicks:l,yAxisTicks:o,stackedData:h,displayedData:C,offset:e,cells:b,dataStartIndex:j})}}),DK=["index"];function jb(){return jb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},jb.apply(null,arguments)}function MK(e,t){if(e==null)return{};var n,a,l=PK(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function PK(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var OM=g.createContext(void 0),TK=e=>{var t=g.useContext(OM);if(t!=null)return t.stackId;if(e!=null)return xL(e)},qK=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),RK=e=>{var t=g.useContext(OM);if(t!=null){var{stackId:n}=t;return"url(#".concat(qK(n,e),")")}},DM=e=>{var{index:t}=e,n=MK(e,DK),a=RK(t);return g.createElement(Pn,jb({className:"recharts-bar-stack-layer",clipPath:a},n))},IK=["onMouseEnter","onMouseLeave","onClick"],LK=["value","background","tooltipPosition"],$K=["id"],BK=["onMouseEnter","onClick","onMouseLeave"];function ri(){return ri=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ri.apply(null,arguments)}function wE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Rr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wE(Object(n),!0).forEach(function(a){UK(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function UK(e,t,n){return(t=FK(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FK(e){var t=GK(e,"string");return typeof t=="symbol"?t:t+""}function GK(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cf(e,t){if(e==null)return{};var n,a,l=HK(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function HK(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var QK=e=>{var{dataKey:t,name:n,fill:a,legendType:l,hide:o}=e;return[{inactive:o,dataKey:t,type:l,color:a,value:Mf(n,t),payload:e}]},VK=g.memo(e=>{var{dataKey:t,stroke:n,strokeWidth:a,fill:l,name:o,hide:u,unit:d,tooltipType:f,id:p}=e,h={dataDefinedOnItem:void 0,getPosition:Js,settings:{stroke:n,strokeWidth:a,fill:l,dataKey:t,nameKey:void 0,name:Mf(o,t),hide:u,type:f,color:l,unit:d,graphicalItemId:p}};return g.createElement(cM,{tooltipEntrySettings:h})});function YK(e){var t=Ie(Hs),{data:n,dataKey:a,background:l,allOtherBarProps:o}=e,{onMouseEnter:u,onMouseLeave:d,onClick:f}=o,p=cf(o,IK),h=sM(u,a,o.id),v=lM(d),b=oM(f,a,o.id);if(!l||n==null)return null;var x=au(l);return g.createElement(Ln,{zIndex:gV(l,pr.barBackground)},n.map((j,N)=>{var{value:w,background:C,tooltipPosition:E}=j,S=cf(j,LK);if(!C)return null;var A=h(j,N),O=v(j,N),k=b(j,N),M=Rr(Rr(Rr(Rr(Rr({option:l,isActive:String(N)===t},S),{},{fill:"#eee"},C),x),Yb(p,j,N)),{},{onMouseEnter:A,onMouseLeave:O,onClick:k,dataKey:a,index:N,className:"recharts-bar-background-rectangle"});return g.createElement(of,ri({key:"background-bar-".concat(N)},M))}))}function KK(e){var{showLabels:t,children:n,rects:a}=e,l=a?.map(o=>{var u={x:o.x,y:o.y,width:o.width,lowerWidth:o.width,upperWidth:o.width,height:o.height};return Rr(Rr({},u),{},{value:o.value,payload:o.payload,parentViewBox:o.parentViewBox,viewBox:u,fill:o.fill})});return g.createElement(ZD,{value:t?l:void 0},n)}function WK(e){var{shape:t,activeBar:n,baseProps:a,entry:l,index:o,dataKey:u}=e,d=Ie(Hs),f=Ie(kD),p=n&&String(o)===d&&(f==null||u===f),h=p?n:t;return p?g.createElement(Ln,{zIndex:pr.activeBar},g.createElement(DM,{index:o},g.createElement(of,ri({},a,{name:String(a.name)},l,{isActive:p,option:h,index:o,dataKey:u})))):g.createElement(of,ri({},a,{name:String(a.name)},l,{isActive:p,option:h,index:o,dataKey:u}))}function XK(e){var{shape:t,baseProps:n,entry:a,index:l,dataKey:o}=e;return g.createElement(of,ri({},n,{name:String(n.name)},a,{isActive:!1,option:t,index:l,dataKey:o}))}function ZK(e){var t,{data:n,props:a}=e,l=(t=Wn(a))!==null&&t!==void 0?t:{},{id:o}=l,u=cf(l,$K),{shape:d,dataKey:f,activeBar:p}=a,{onMouseEnter:h,onClick:v,onMouseLeave:b}=a,x=cf(a,BK),j=sM(h,f,o),N=lM(b),w=oM(v,f,o);return n?g.createElement(g.Fragment,null,n.map((C,E)=>g.createElement(DM,ri({index:E,key:"rectangle-".concat(C?.x,"-").concat(C?.y,"-").concat(C?.value,"-").concat(E),className:"recharts-bar-rectangle"},Yb(x,C,E),{onMouseEnter:j(C,E),onMouseLeave:N(C,E),onClick:w(C,E)}),p?g.createElement(WK,{shape:d,activeBar:p,baseProps:u,entry:C,index:E,dataKey:f}):g.createElement(XK,{shape:d,baseProps:u,entry:C,index:E,dataKey:f})))):null}function JK(e){var{props:t,previousRectanglesRef:n}=e,{data:a,layout:l,isAnimationActive:o,animationBegin:u,animationDuration:d,animationEasing:f,onAnimationEnd:p,onAnimationStart:h}=t,v=n.current,b=Gf(t,"recharts-bar-"),[x,j]=g.useState(!1),N=!x,w=g.useCallback(()=>{typeof p=="function"&&p(),j(!1)},[p]),C=g.useCallback(()=>{typeof h=="function"&&h(),j(!0)},[h]);return g.createElement(KK,{showLabels:N,rects:a},g.createElement(Ff,{animationId:b,begin:u,duration:d,isActive:o,easing:f,onAnimationEnd:w,onAnimationStart:C,key:b},E=>{var S=E===1?a:a?.map((A,O)=>{var k=v&&v[O];if(k)return Rr(Rr({},A),{},{x:Gt(k.x,A.x,E),y:Gt(k.y,A.y,E),width:Gt(k.width,A.width,E),height:Gt(k.height,A.height,E)});if(l==="horizontal"){var M=Gt(0,A.height,E),D=Gt(A.stackedBarStart,A.y,E);return Rr(Rr({},A),{},{y:D,height:M})}var $=Gt(0,A.width,E),U=Gt(A.stackedBarStart,A.x,E);return Rr(Rr({},A),{},{width:$,x:U})});return E>0&&(n.current=S??null),S==null?null:g.createElement(Pn,null,g.createElement(ZK,{props:t,data:S}))}),g.createElement(eM,{label:t.label}),t.children)}function eW(e){var t=g.useRef(null);return g.createElement(JK,{previousRectanglesRef:t,props:e})}var MM=0,tW=(e,t)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:Jt(e,t)}};class rW extends g.PureComponent{render(){var{hide:t,data:n,dataKey:a,className:l,xAxisId:o,yAxisId:u,needClip:d,background:f,id:p}=this.props;if(t||n==null)return null;var h=_t("recharts-bar",l),v=p;return g.createElement(Pn,{className:h,id:p},d&&g.createElement("defs",null,g.createElement(NM,{clipPathId:v,xAxisId:o,yAxisId:u})),g.createElement(Pn,{className:"recharts-bar-rectangles",clipPath:d?"url(#clipPath-".concat(v,")"):void 0},g.createElement(YK,{data:n,dataKey:a,background:f,allOtherBarProps:this.props}),g.createElement(eW,this.props)))}}var nW={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:MM,xAxisId:0,yAxisId:0,zIndex:pr.bar};function aW(e){var{xAxisId:t,yAxisId:n,hide:a,legendType:l,minPointSize:o,activeBar:u,animationBegin:d,animationDuration:f,animationEasing:p,isAnimationActive:h}=e,{needClip:v}=fj(t,n),b=el(),x=Mr(),j=iQ(e.children,lj),N=Ie(E=>OK(E,e.id,x,j));if(b!=="vertical"&&b!=="horizontal")return null;var w,C=N?.[0];return C==null||C.height==null||C.width==null?w=0:w=b==="vertical"?C.height/2:C.width/2,g.createElement(jM,{xAxisId:t,yAxisId:n,data:N,dataPointFormatter:tW,errorBarOffset:w},g.createElement(rW,ri({},e,{layout:b,needClip:v,data:N,xAxisId:t,yAxisId:n,hide:a,legendType:l,minPointSize:o,activeBar:u,animationBegin:d,animationDuration:f,animationEasing:p,isAnimationActive:h})))}function iW(e){var{layout:t,barSettings:{dataKey:n,minPointSize:a},pos:l,bandSize:o,xAxis:u,yAxis:d,xAxisTicks:f,yAxisTicks:p,stackedData:h,displayedData:v,offset:b,cells:x,parentViewBox:j,dataStartIndex:N}=e,w=t==="horizontal"?d:u,C=h?w.scale.domain():null,E=bL({numericAxis:w}),S=w.scale.map(E);return v.map((A,O)=>{var k,M,D,$,U,L;if(h){var B=h[O+N];if(B==null)return null;k=fL(B,C)}else k=Jt(A,n),Array.isArray(k)||(k=[E,k]);var ee=pK(a,MM)(k[1],O);if(t==="horizontal"){var se,P=d.scale.map(k[0]),q=d.scale.map(k[1]);if(P==null||q==null)return null;M=uw({axis:u,ticks:f,bandSize:o,offset:l.offset,entry:A,index:O}),D=(se=q??P)!==null&&se!==void 0?se:void 0,$=l.size;var F=P-q;if(U=ga(F)?0:F,L={x:M,y:b.top,width:$,height:b.height},Math.abs(ee)>0&&Math.abs(U)<Math.abs(ee)){var R=Jr(U||ee)*(Math.abs(ee)-Math.abs(U));D-=R,U+=R}}else{var W=u.scale.map(k[0]),I=u.scale.map(k[1]);if(W==null||I==null)return null;if(M=W,D=uw({axis:d,ticks:p,bandSize:o,offset:l.offset,entry:A,index:O}),$=I-W,U=l.size,L={x:b.left,y:D,width:b.width,height:U},Math.abs(ee)>0&&Math.abs($)<Math.abs(ee)){var re=Jr($||ee)*(Math.abs(ee)-Math.abs($));$+=re}}if(M==null||D==null||$==null||U==null)return null;var V=Rr(Rr({},A),{},{stackedBarStart:S,x:M,y:D,width:$,height:U,value:h?k:k[1],payload:A,background:L,tooltipPosition:{x:M+$/2,y:D+U/2},parentViewBox:j},x&&x[O]&&x[O].props);return V}).filter(Boolean)}function sW(e){var t=Ur(e,nW),n=TK(t.stackId),a=Mr();return g.createElement(dM,{id:t.id,type:"bar"},l=>g.createElement(g.Fragment,null,g.createElement(uM,{legendPayload:QK(t)}),g.createElement(VK,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:l}),g.createElement(fM,{type:"bar",id:l,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:n,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:a}),g.createElement(Ln,{zIndex:t.zIndex},g.createElement(aW,ri({},t,{id:l})))))}var PM=g.memo(sW,up);PM.displayName="Bar";var lW=["domain","range"],oW=["domain","range"];function CE(e,t){if(e==null)return{};var n,a,l=cW(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function cW(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function EE(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function TM(e,t){if(e===t)return!0;var{domain:n,range:a}=e,l=CE(e,lW),{domain:o,range:u}=t,d=CE(t,oW);return!EE(n,o)||!EE(a,u)?!1:up(l,d)}var uW=["type"],dW=["dangerouslySetInnerHTML","ticks","scale"],mW=["id","scale"];function Nb(){return Nb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Nb.apply(null,arguments)}function AE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function zE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AE(Object(n),!0).forEach(function(a){fW(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function fW(e,t,n){return(t=pW(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pW(e){var t=hW(e,"string");return typeof t=="symbol"?t:t+""}function hW(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _b(e,t){if(e==null)return{};var n,a,l=vW(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function vW(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function gW(e){var t=Vt(),n=g.useRef(null),a=lk(),{type:l}=e,o=_b(e,uW),u=Jf(a,"xAxis",l),d=g.useMemo(()=>{if(u!=null)return zE(zE({},o),{},{type:u})},[o,u]);return g.useLayoutEffect(()=>{d!=null&&(n.current===null?t(VQ(d)):n.current!==d&&t(YQ({prev:n.current,next:d})),n.current=d)},[d,t]),g.useLayoutEffect(()=>()=>{n.current&&(t(KQ(n.current)),n.current=null)},[t]),null}var xW=e=>{var{xAxisId:t,className:n}=e,a=Ie(ay),l=Mr(),o="xAxis",u=Ie(C=>cD(C,o,t,l)),d=Ie(C=>iD(C,t)),f=Ie(C=>wU(C,t)),p=Ie(C=>AO(C,t));if(d==null||f==null||p==null)return null;var{dangerouslySetInnerHTML:h,ticks:v,scale:b}=e,x=_b(e,dW),{id:j,scale:N}=p,w=_b(p,mW);return g.createElement(mj,Nb({},x,w,{x:f.x,y:f.y,width:d.width,height:d.height,className:_t("recharts-".concat(o," ").concat(o),n),viewBox:a,ticks:u,axisType:o}))},bW={allowDataOverflow:ur.allowDataOverflow,allowDecimals:ur.allowDecimals,allowDuplicatedCategory:ur.allowDuplicatedCategory,angle:ur.angle,axisLine:Ka.axisLine,height:ur.height,hide:!1,includeHidden:ur.includeHidden,interval:ur.interval,label:!1,minTickGap:ur.minTickGap,mirror:ur.mirror,orientation:ur.orientation,padding:ur.padding,reversed:ur.reversed,scale:ur.scale,tick:ur.tick,tickCount:ur.tickCount,tickLine:Ka.tickLine,tickSize:Ka.tickSize,type:ur.type,xAxisId:0},yW=e=>{var t=Ur(e,bW);return g.createElement(g.Fragment,null,g.createElement(gW,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),g.createElement(xW,t))},Sb=g.memo(yW,TM);Sb.displayName="XAxis";var jW=["type"],NW=["dangerouslySetInnerHTML","ticks","scale"],_W=["id","scale"];function wb(){return wb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},wb.apply(null,arguments)}function kE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function OE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kE(Object(n),!0).forEach(function(a){SW(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function SW(e,t,n){return(t=wW(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wW(e){var t=CW(e,"string");return typeof t=="symbol"?t:t+""}function CW(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cb(e,t){if(e==null)return{};var n,a,l=EW(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function EW(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function AW(e){var t=Vt(),n=g.useRef(null),a=lk(),{type:l}=e,o=Cb(e,jW),u=Jf(a,"yAxis",l),d=g.useMemo(()=>{if(u!=null)return OE(OE({},o),{},{type:u})},[u,o]);return g.useLayoutEffect(()=>{d!=null&&(n.current===null?t(WQ(d)):n.current!==d&&t(XQ({prev:n.current,next:d})),n.current=d)},[d,t]),g.useLayoutEffect(()=>()=>{n.current&&(t(ZQ(n.current)),n.current=null)},[t]),null}function zW(e){var{yAxisId:t,className:n,width:a,label:l}=e,o=g.useRef(null),u=g.useRef(null),d=Ie(ay),f=Mr(),p=Vt(),h="yAxis",v=Ie(k=>sD(k,t)),b=Ie(k=>EU(k,t)),x=Ie(k=>cD(k,h,t,f)),j=Ie(k=>zO(k,t));if(g.useLayoutEffect(()=>{if(!(a!=="auto"||!v||cj(l)||g.isValidElement(l)||j==null)){var k=o.current;if(k){var M=k.getCalculatedWidth();Math.round(v.width)!==Math.round(M)&&p(JQ({id:t,width:M}))}}},[x,v,p,l,t,a,j]),v==null||b==null||j==null)return null;var{dangerouslySetInnerHTML:N,ticks:w,scale:C}=e,E=Cb(e,NW),{id:S,scale:A}=j,O=Cb(j,_W);return g.createElement(mj,wb({},E,O,{ref:o,labelRef:u,x:b.x,y:b.y,tickTextProps:a==="auto"?{width:void 0}:{width:a},width:v.width,height:v.height,className:_t("recharts-".concat(h," ").concat(h),n),viewBox:d,ticks:x,axisType:h}))}var kW={allowDataOverflow:dr.allowDataOverflow,allowDecimals:dr.allowDecimals,allowDuplicatedCategory:dr.allowDuplicatedCategory,angle:dr.angle,axisLine:Ka.axisLine,hide:!1,includeHidden:dr.includeHidden,interval:dr.interval,label:!1,minTickGap:dr.minTickGap,mirror:dr.mirror,orientation:dr.orientation,padding:dr.padding,reversed:dr.reversed,scale:dr.scale,tick:dr.tick,tickCount:dr.tickCount,tickLine:Ka.tickLine,tickSize:Ka.tickSize,type:dr.type,width:dr.width,yAxisId:0},OW=e=>{var t=Ur(e,kW);return g.createElement(g.Fragment,null,g.createElement(AW,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),g.createElement(zW,t))},Eb=g.memo(OW,TM);Eb.displayName="YAxis";var DW=(e,t)=>t,hj=de([DW,gt,CO,xr,CD,di,UF,hr],KF),vj=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,a=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/a)}},qM=Tn("mouseClick"),RM=lu();RM.startListening({actionCreator:qM,effect:(e,t)=>{var n=e.payload,a=hj(t.getState(),vj(n));a?.activeIndex!=null&&t.dispatch(BU({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}});var Ab=Tn("mouseMove"),IM=lu(),Jd=null;IM.startListening({actionCreator:Ab,effect:(e,t)=>{var n=e.payload;Jd!==null&&cancelAnimationFrame(Jd);var a=vj(n);Jd=requestAnimationFrame(()=>{var l=t.getState(),o=Xy(l,l.tooltip.settings.shared);if(o==="axis"){var u=hj(l,a);u?.activeIndex!=null?t.dispatch(gD({activeIndex:u.activeIndex,activeDataKey:void 0,activeCoordinate:u.activeCoordinate})):t.dispatch(vD())}Jd=null})}});function MW(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var DE={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},LM=nn({name:"rootProps",initialState:DE,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(n=t.payload.barGap)!==null&&n!==void 0?n:DE.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),PW=LM.reducer,{updateOptions:TW}=LM.actions,qW=null,RW={updatePolarOptions:(e,t)=>t.payload},$M=nn({name:"polarOptions",initialState:qW,reducers:RW}),{updatePolarOptions:Ste}=$M.actions,IW=$M.reducer,BM=Tn("keyDown"),UM=Tn("focus"),gj=lu();gj.startListening({actionCreator:BM,effect:(e,t)=>{var n=t.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:l}=n.tooltip,o=e.payload;if(!(o!=="ArrowRight"&&o!=="ArrowLeft"&&o!=="Enter")){var u=Zy(l,So(n),gu(n),bu(n)),d=u==null?-1:Number(u);if(!(!Number.isFinite(d)||d<0)){var f=di(n);if(o==="Enter"){var p=tf(n,"axis","hover",String(l.index));t.dispatch(pb({active:!l.active,activeIndex:l.index,activeCoordinate:p}));return}var h=OU(n),v=h==="left-to-right"?1:-1,b=o==="ArrowRight"?1:-1,x=d+b*v;if(!(f==null||x>=f.length||x<0)){var j=tf(n,"axis","hover",String(x));t.dispatch(pb({active:!0,activeIndex:x.toString(),activeCoordinate:j}))}}}}}});gj.startListening({actionCreator:UM,effect:(e,t)=>{var n=t.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:l}=n.tooltip;if(!l.active&&l.index==null){var o="0",u=tf(n,"axis","hover",String(o));t.dispatch(pb({active:!0,activeIndex:o,activeCoordinate:u}))}}}});var On=Tn("externalEvent"),FM=lu(),xx=new Map;FM.startListening({actionCreator:On,effect:(e,t)=>{var{handler:n,reactEvent:a}=e.payload;if(n!=null){a.persist();var l=a.type,o=xx.get(l);o!==void 0&&cancelAnimationFrame(o);var u=requestAnimationFrame(()=>{try{var d=t.getState(),f={activeCoordinate:CF(d),activeDataKey:kD(d),activeIndex:Hs(d),activeLabel:zD(d),activeTooltipIndex:Hs(d),isTooltipActive:EF(d)};n(f,a)}finally{xx.delete(l)}});xx.set(l,u)}}});var LW=de([No],e=>e.tooltipItemPayloads),$W=de([LW,(e,t)=>t,(e,t,n)=>n],(e,t,n)=>{if(t!=null){var a=e.find(o=>o.settings.graphicalItemId===n);if(a!=null){var{getPosition:l}=a;if(l!=null)return l(t)}}}),GM=Tn("touchMove"),HM=lu();HM.startListening({actionCreator:GM,effect:(e,t)=>{var n=e.payload;if(!(n.touches==null||n.touches.length===0)){var a=t.getState(),l=Xy(a,a.tooltip.settings.shared);if(l==="axis"){var o=n.touches[0];if(o==null)return;var u=hj(a,vj({clientX:o.clientX,clientY:o.clientY,currentTarget:n.currentTarget}));u?.activeIndex!=null&&t.dispatch(gD({activeIndex:u.activeIndex,activeDataKey:void 0,activeCoordinate:u.activeCoordinate}))}else if(l==="item"){var d,f=n.touches[0];if(document.elementFromPoint==null||f==null)return;var p=document.elementFromPoint(f.clientX,f.clientY);if(!p||!p.getAttribute)return;var h=p.getAttribute(CL),v=(d=p.getAttribute(EL))!==null&&d!==void 0?d:void 0,b=_o(a).find(N=>N.id===v);if(h==null||b==null||v==null)return;var{dataKey:x}=b,j=$W(a,h,v);t.dispatch(hD({activeDataKey:x,activeIndex:h,activeCoordinate:j,activeGraphicalItemId:v}))}}}});var BW=_z({brush:bV,cartesianAxis:eV,chartData:CG,errorBars:fY,graphicalItems:DQ,layout:oL,legend:x8,options:jG,polarAxis:eQ,polarOptions:IW,referenceElements:_V,rootProps:PW,tooltip:UU,zIndex:cG}),UW=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return M4({reducer:BW,preloadedState:t,middleware:a=>{var l;return a({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((l="es6")!==null&&l!==void 0?l:"")}).concat([RM.middleware,IM.middleware,gj.middleware,FM.middleware,HM.middleware])},enhancers:a=>{var l=a;return typeof a=="function"&&(l=a()),l.concat(Iz({type:"raf"}))},devTools:{serialize:{replacer:MW},name:"recharts-".concat(n)}})};function FW(e){var{preloadedState:t,children:n,reduxStoreName:a}=e,l=Mr(),o=g.useRef(null);if(l)return n;o.current==null&&(o.current=UW(t,a));var u=Xb;return g.createElement(UY,{context:u,store:o.current},n)}function GW(e){var{layout:t,margin:n}=e,a=Vt(),l=Mr();return g.useEffect(()=>{l||(a(iL(t)),a(aL(n)))},[a,l,t,n]),null}var HW=g.memo(GW,up);function QW(e){var t=Vt();return g.useEffect(()=>{t(TW(e))},[t,e]),null}function ME(e){var{zIndex:t,isPanorama:n}=e,a=g.useRef(null),l=Vt();return g.useLayoutEffect(()=>(a.current&&l(lG({zIndex:t,element:a.current,isPanorama:n})),()=>{l(oG({zIndex:t,isPanorama:n}))}),[l,t,n]),g.createElement("g",{tabIndex:-1,ref:a})}function PE(e){var{children:t,isPanorama:n}=e,a=Ie(XF);if(!a||a.length===0)return t;var l=a.filter(u=>u<0),o=a.filter(u=>u>0);return g.createElement(g.Fragment,null,l.map(u=>g.createElement(ME,{key:u,zIndex:u,isPanorama:n})),t,o.map(u=>g.createElement(ME,{key:u,zIndex:u,isPanorama:n})))}var VW=["children"];function YW(e,t){if(e==null)return{};var n,a,l=KW(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function KW(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function uf(){return uf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},uf.apply(null,arguments)}var WW={width:"100%",height:"100%",display:"block"},XW=g.forwardRef((e,t)=>{var n=ik(),a=sk(),l=vk();if(!ba(n)||!ba(a))return null;var{children:o,otherAttributes:u,title:d,desc:f}=e,p,h;return u!=null&&(typeof u.tabIndex=="number"?p=u.tabIndex:p=l?0:void 0,typeof u.role=="string"?h=u.role:h=l?"application":void 0),g.createElement(BA,uf({},u,{title:d,desc:f,role:h,tabIndex:p,width:n,height:a,style:WW,ref:t}),o)}),ZW=e=>{var{children:t}=e,n=Ie(Rf);if(!n)return null;var{width:a,height:l,y:o,x:u}=n;return g.createElement(BA,{width:a,height:l,x:u,y:o},t)},TE=g.forwardRef((e,t)=>{var{children:n}=e,a=YW(e,VW),l=Mr();return l?g.createElement(ZW,null,g.createElement(PE,{isPanorama:!0},n)):g.createElement(XW,uf({ref:t},a),g.createElement(PE,{isPanorama:!1},n))});function JW(){var e=Vt(),[t,n]=g.useState(null),a=Ie(wL);return g.useEffect(()=>{if(t!=null){var l=t.getBoundingClientRect(),o=l.width/t.offsetWidth;st(o)&&o!==a&&e(lL(o))}},[t,e,a]),n}function qE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function eX(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qE(Object(n),!0).forEach(function(a){tX(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function tX(e,t,n){return(t=rX(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rX(e){var t=nX(e,"string");return typeof t=="symbol"?t:t+""}function nX(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vi(){return Vi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Vi.apply(null,arguments)}var aX=()=>(TG(),null);function df(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var iX=g.forwardRef((e,t)=>{var n,a,l=g.useRef(null),[o,u]=g.useState({containerWidth:df((n=e.style)===null||n===void 0?void 0:n.width),containerHeight:df((a=e.style)===null||a===void 0?void 0:a.height)}),d=g.useCallback((p,h)=>{u(v=>{var b=Math.round(p),x=Math.round(h);return v.containerWidth===b&&v.containerHeight===x?v:{containerWidth:b,containerHeight:x}})},[]),f=g.useCallback(p=>{if(typeof t=="function"&&t(p),p!=null&&typeof ResizeObserver<"u"){var{width:h,height:v}=p.getBoundingClientRect();d(h,v);var b=j=>{var N=j[0];if(N!=null){var{width:w,height:C}=N.contentRect;d(w,C)}},x=new ResizeObserver(b);x.observe(p),l.current=x}},[t,d]);return g.useEffect(()=>()=>{var p=l.current;p?.disconnect()},[d]),g.createElement(g.Fragment,null,g.createElement(cu,{width:o.containerWidth,height:o.containerHeight}),g.createElement("div",Vi({ref:f},e)))}),sX=g.forwardRef((e,t)=>{var{width:n,height:a}=e,[l,o]=g.useState({containerWidth:df(n),containerHeight:df(a)}),u=g.useCallback((f,p)=>{o(h=>{var v=Math.round(f),b=Math.round(p);return h.containerWidth===v&&h.containerHeight===b?h:{containerWidth:v,containerHeight:b}})},[]),d=g.useCallback(f=>{if(typeof t=="function"&&t(f),f!=null){var{width:p,height:h}=f.getBoundingClientRect();u(p,h)}},[t,u]);return g.createElement(g.Fragment,null,g.createElement(cu,{width:l.containerWidth,height:l.containerHeight}),g.createElement("div",Vi({ref:d},e)))}),lX=g.forwardRef((e,t)=>{var{width:n,height:a}=e;return g.createElement(g.Fragment,null,g.createElement(cu,{width:n,height:a}),g.createElement("div",Vi({ref:t},e)))}),oX=g.forwardRef((e,t)=>{var{width:n,height:a}=e;return typeof n=="string"||typeof a=="string"?g.createElement(sX,Vi({},e,{ref:t})):typeof n=="number"&&typeof a=="number"?g.createElement(lX,Vi({},e,{width:n,height:a,ref:t})):g.createElement(g.Fragment,null,g.createElement(cu,{width:n,height:a}),g.createElement("div",Vi({ref:t},e)))});function cX(e){return e?iX:oX}var uX=g.forwardRef((e,t)=>{var{children:n,className:a,height:l,onClick:o,onContextMenu:u,onDoubleClick:d,onMouseDown:f,onMouseEnter:p,onMouseLeave:h,onMouseMove:v,onMouseUp:b,onTouchEnd:x,onTouchMove:j,onTouchStart:N,style:w,width:C,responsive:E,dispatchTouchEvents:S=!0}=e,A=g.useRef(null),O=Vt(),[k,M]=g.useState(null),[D,$]=g.useState(null),U=JW(),L=iy(),B=L?.width>0?L.width:C,ee=L?.height>0?L.height:l,se=g.useCallback(ue=>{U(ue),typeof t=="function"&&t(ue),M(ue),$(ue),ue!=null&&(A.current=ue)},[U,t,M,$]),P=g.useCallback(ue=>{O(qM(ue)),O(On({handler:o,reactEvent:ue}))},[O,o]),q=g.useCallback(ue=>{O(Ab(ue)),O(On({handler:p,reactEvent:ue}))},[O,p]),F=g.useCallback(ue=>{O(vD()),O(On({handler:h,reactEvent:ue}))},[O,h]),R=g.useCallback(ue=>{O(Ab(ue)),O(On({handler:v,reactEvent:ue}))},[O,v]),W=g.useCallback(()=>{O(UM())},[O]),I=g.useCallback(ue=>{O(BM(ue.key))},[O]),re=g.useCallback(ue=>{O(On({handler:u,reactEvent:ue}))},[O,u]),V=g.useCallback(ue=>{O(On({handler:d,reactEvent:ue}))},[O,d]),oe=g.useCallback(ue=>{O(On({handler:f,reactEvent:ue}))},[O,f]),xe=g.useCallback(ue=>{O(On({handler:b,reactEvent:ue}))},[O,b]),ve=g.useCallback(ue=>{O(On({handler:N,reactEvent:ue}))},[O,N]),H=g.useCallback(ue=>{S&&O(GM(ue)),O(On({handler:j,reactEvent:ue}))},[O,S,j]),he=g.useCallback(ue=>{O(On({handler:x,reactEvent:ue}))},[O,x]),Pe=cX(E);return g.createElement(RD.Provider,{value:k},g.createElement(f6.Provider,{value:D},g.createElement(Pe,{width:B??w?.width,height:ee??w?.height,className:_t("recharts-wrapper",a),style:eX({position:"relative",cursor:"default",width:B,height:ee},w),onClick:P,onContextMenu:re,onDoubleClick:V,onFocus:W,onKeyDown:I,onMouseDown:oe,onMouseEnter:q,onMouseLeave:F,onMouseMove:R,onMouseUp:xe,onTouchEnd:he,onTouchMove:H,onTouchStart:ve,ref:se},g.createElement(aX,null),n)))}),dX=["width","height","responsive","children","className","style","compact","title","desc"];function mX(e,t){if(e==null)return{};var n,a,l=fX(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function fX(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var pX=g.forwardRef((e,t)=>{var{width:n,height:a,responsive:l,children:o,className:u,style:d,compact:f,title:p,desc:h}=e,v=mX(e,dX),b=Wn(v);return f?g.createElement(g.Fragment,null,g.createElement(cu,{width:n,height:a}),g.createElement(TE,{otherAttributes:b,title:p,desc:h},o)):g.createElement(uX,{className:u,style:d,width:n,height:a,responsive:l??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},g.createElement(TE,{otherAttributes:b,title:p,desc:h,ref:t},g.createElement(wV,null,o)))});function zb(){return zb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},zb.apply(null,arguments)}var hX={top:5,right:5,bottom:5,left:5},vX={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:hX,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},QM=g.forwardRef(function(t,n){var a,l=Ur(t.categoricalChartProps,vX),{chartName:o,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,categoricalChartProps:p}=t,h={chartName:o,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,eventEmitter:void 0};return g.createElement(FW,{preloadedState:{options:h},reduxStoreName:(a=p.id)!==null&&a!==void 0?a:o},g.createElement(xV,{chartData:p.data}),g.createElement(HW,{layout:l.layout,margin:l.margin}),g.createElement(QW,{baseValue:l.baseValue,accessibilityLayer:l.accessibilityLayer,barCategoryGap:l.barCategoryGap,maxBarSize:l.maxBarSize,stackOffset:l.stackOffset,barGap:l.barGap,barSize:l.barSize,syncId:l.syncId,syncMethod:l.syncMethod,className:l.className,reverseStackOrder:l.reverseStackOrder}),g.createElement(pX,zb({},l,{ref:n})))}),gX=["axis"],xX=g.forwardRef((e,t)=>g.createElement(QM,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:gX,tooltipPayloadSearcher:ID,categoricalChartProps:e,ref:t})),bX=["axis","item"],yX=g.forwardRef((e,t)=>g.createElement(QM,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:bX,tooltipPayloadSearcher:ID,categoricalChartProps:e,ref:t}));const jX=8,NX=12,_X=14,SX=1;function xj(e){return e instanceof Oe?e.toDate():e instanceof Date?e:e?.seconds?new Date(e.seconds*1e3):new Date(e)}function RE(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function dp(){const e=new Date,t=e.getDay(),n=t===0?-6:1-t,a=new Date(e);return a.setDate(e.getDate()+n),a.setHours(0,0,0,0),a}function wX(){const e=dp(),t=new Date(e);return t.setDate(e.getDate()+6),t.setHours(23,59,59,999),t}function bx(e,t){return Math.floor(Math.abs(t.getTime()-e.getTime())/864e5)}async function mp(e){try{const t=Ee(je(K,"quiz_results"),Se("userId","==",e),Ve("datePassage","desc"));return(await Ce(t)).docs.map(a=>({id:a.id,...a.data()}))}catch(t){return console.error("Erreur rcupration rsultats lve:",t),[]}}async function CX(e){try{const t=await mp(e);if(t.length===0)return[];const n=new Map;t.forEach(o=>{const u=o.disciplineId;n.has(u)||n.set(u,[]),n.get(u).push(o)});const a=[];n.forEach((o,u)=>{if(o.length<SX)return;const d=o.map(w=>w.pourcentage/100*20),f=d.reduce((w,C)=>w+C,0)/d.length;if(f>=_X)return;let p="stable";if(d.length>=3){const w=d.slice(0,2),C=d.slice(2,4),E=w.reduce((O,k)=>O+k,0)/w.length,S=C.reduce((O,k)=>O+k,0)/C.length,A=E-S;A>1.5?p="hausse":A<-1.5&&(p="baisse")}let h="modere";f<jX?h="critique":f<NX&&(h="important");const v=d[0],b=Math.max(...d),x=Math.min(...d),j=xj(o[0].datePassage),N=o[0].disciplineNom||"Discipline inconnue";a.push({id:`lacune_${u}`,disciplineId:u,disciplineNom:N,moyenne:Math.round(f*10)/10,nombreQuiz:o.length,tendance:p,niveauUrgence:h,dernierQuizDate:j,scoreDetails:{dernierScore:Math.round(v*10)/10,meilleurScore:Math.round(b*10)/10,pireScore:Math.round(x*10)/10}})});const l={critique:0,important:1,modere:2};return a.sort((o,u)=>{const d=l[o.niveauUrgence]-l[u.niveauUrgence];return d!==0?d:o.moyenne-u.moyenne}),a}catch(t){return console.error("Erreur dtection lacunes:",t),[]}}function EX(e){const t=[];let n=1;return e.forEach(a=>{const{id:l,disciplineNom:o,niveauUrgence:u,moyenne:d,tendance:f}=a;switch(u){case"critique":t.push({id:`reco_cours_${l}`,lacuneId:l,type:"revoir_cours",titre:` Revoir les cours de ${o}`,description:`Ta moyenne est de ${d}/20 en ${o}. Il est important de reprendre les bases. Consulte les cours disponibles et prends des notes.`,disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date}),t.push({id:`reco_quiz_${l}`,lacuneId:l,type:"refaire_quiz",titre:` Refaire les quiz de ${o}`,description:"Aprs avoir rvis, refais les quiz pour vrifier ta comprhension. Vise au moins 12/20 !",disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date});break;case"important":t.push({id:`reco_exercice_${l}`,lacuneId:l,type:"exercice_cible",titre:` Exercices cibls en ${o}`,description:`Avec ${d}/20 de moyenne, concentre-toi sur les exercices pratiques. ${f==="hausse"?"Tu progresses, continue !":"Un effort supplmentaire est ncessaire."}`,disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date}),t.push({id:`reco_cours2_${l}`,lacuneId:l,type:"revoir_cours",titre:` Rviser les points cls en ${o}`,description:"Identifie les concepts qui te posent problme et revois-les attentivement.",disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date});break;case"modere":t.push({id:`reco_consolider_${l}`,lacuneId:l,type:"refaire_quiz",titre:` Consolider tes acquis en ${o}`,description:`Tu es proche du niveau attendu (${d}/20). Un quiz supplmentaire devrait suffire pour atteindre 14/20 !`,disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date});break}}),t}async function AX(e){try{const t=await mp(e);if(t.length===0)return{userId:e,streakActuel:0,meilleurStreak:0,dernierJourActif:null,totalJoursActifs:0,semaineCourante:[!1,!1,!1,!1,!1,!1,!1],historiqueHebdo:[]};const n=new Set;t.forEach(N=>{const w=xj(N.datePassage),C=`${w.getFullYear()}-${w.getMonth()}-${w.getDate()}`;n.add(C)});const a=Array.from(n).map(N=>{const[w,C,E]=N.split("-").map(Number);return new Date(w,C,E)}).sort((N,w)=>w.getTime()-N.getTime()),l=a.length,o=a[0];let u=0;const d=new Date;d.setHours(0,0,0,0);const f=a[0];if(bx(f,d)<=1){u=1;for(let N=1;N<a.length&&bx(a[N],a[N-1])===1;N++)u++}let h=0,v=1;for(let N=1;N<a.length;N++)bx(a[N],a[N-1])===1?v++:(h=Math.max(h,v),v=1);h=Math.max(h,v,u);const b=dp(),x=[];for(let N=0;N<7;N++){const w=new Date(b);w.setDate(b.getDate()+N);const C=a.some(E=>RE(E,w));x.push(C)}const j=[];for(let N=0;N<4;N++){const w=new Date(b);w.setDate(b.getDate()-N*7);let C=0;for(let S=0;S<7;S++){const A=new Date(w);A.setDate(w.getDate()+S),a.some(O=>RE(O,A))&&C++}const E=Math.ceil((w.getDate()+new Date(w.getFullYear(),w.getMonth(),1).getDay())/7);j.push({semaine:N===0?"Cette sem.":`Sem. -${N}`,joursActifs:C})}return{userId:e,streakActuel:u,meilleurStreak:h,dernierJourActif:o,totalJoursActifs:l,semaineCourante:x,historiqueHebdo:j.reverse()}}catch(t){return console.error("Erreur calcul streak:",t),{userId:e,streakActuel:0,meilleurStreak:0,dernierJourActif:null,totalJoursActifs:0,semaineCourante:[!1,!1,!1,!1,!1,!1,!1],historiqueHebdo:[]}}}function zX(e,t,n){const a=[],l=dp(),o=wX(),u=t.length>2?5:3;if(a.push({id:`obj_quiz_${e}_${l.getTime()}`,userId:e,titre:`Passer ${u} quiz cette semaine`,description:`Entrane-toi en passant au moins ${u} quiz pour progresser dans tes matires.`,type:"quiz_count",cible:u,progression:0,statut:"en_cours",dateDebut:l,dateFin:o,recompense:' Badge "Travailleur"'}),t.length>0){const f=t[0],p=Math.min(f.moyenne+3,14);a.push({id:`obj_score_${e}_${l.getTime()}`,userId:e,titre:`Atteindre ${Math.round(p)}/20 en ${f.disciplineNom}`,description:`Ta moyenne actuelle est de ${f.moyenne}/20. Vise ${Math.round(p)}/20 lors de ton prochain quiz !`,type:"score_min",cible:Math.round(p),progression:Math.round(f.moyenne),statut:"en_cours",disciplineId:f.disciplineId,disciplineNom:f.disciplineNom,dateDebut:l,dateFin:o,recompense:' Badge "En progrs"'})}const d=n.streakActuel>=5?7:n.streakActuel+2;return a.push({id:`obj_streak_${e}_${l.getTime()}`,userId:e,titre:`Maintenir un streak de ${d} jours`,description:`Tu es actuellement  ${n.streakActuel} jour(s) conscutif(s). Continue !`,type:"streak",cible:d,progression:n.streakActuel,statut:n.streakActuel>=d?"atteint":"en_cours",dateDebut:l,dateFin:o,recompense:' Badge "Flamme"'}),a}function kX(e,t,n,a){let l=0;if(a.length>0){const v=a.reduce((b,x)=>b+x.pourcentage/100*20,0)/a.length;l=Math.min(v/20*100,100)}let o=100;const u=e.filter(v=>v.niveauUrgence==="critique").length,d=e.filter(v=>v.niveauUrgence==="important").length;o-=u*25,o-=d*15,o=Math.max(o,0);const f=Math.min(t.streakActuel/7*100,100);let p=0;n.length>0&&(p=n.filter(b=>b.statut==="atteint").length/n.length*100);const h=l*.4+o*.25+f*.2+p*.15;return Math.round(Math.min(Math.max(h,0),100))}function OX(e,t,n){const a=dp(),l=t.filter(o=>xj(o.datePassage)>=a);return e.map(o=>{const u={...o};switch(o.type){case"quiz_count":u.progression=l.length;break;case"score_min":if(o.disciplineId){const d=l.filter(f=>f.disciplineId===o.disciplineId);if(d.length>0){const f=Math.max(...d.map(p=>p.pourcentage));u.progression=Math.round(f/100*20)}}break;case"streak":u.progression=n.streakActuel;break}return u.progression>=u.cible&&(u.statut="atteint"),u})}async function bj(e){try{const t=await CX(e),n=EX(t),a=await AX(e);let l=zX(e,t,a);const o=await mp(e);l=OX(l,o,a);const u=kX(t,a,l,o);return{lacunes:t,recommandations:n,streak:a,objectifs:l,scoreGlobal:u}}catch(t){return console.error("Erreur suivi complet:",t),{lacunes:[],recommandations:[],streak:{userId:e,streakActuel:0,meilleurStreak:0,dernierJourActif:null,totalJoursActifs:0,semaineCourante:[!1,!1,!1,!1,!1,!1,!1],historiqueHebdo:[]},objectifs:[],scoreGlobal:0}}}function mf(e){switch(e){case"critique":return"#ef4444";case"important":return"#f59e0b";case"modere":return"#eab308";case"info":return"#10b981";default:return"#6b7280"}}function VM(e){switch(e){case"critique":return"Critique";case"important":return"Important";case"modere":return"Modr";case"info":return"Info";default:return"Inconnu"}}function YM(e){switch(e){case"hausse":return"";case"baisse":return"";case"stable":return"";default:return""}}function DX(e){return e>=80?"Excellent travail ! Continue comme a, tu es sur la bonne voie ! ":e>=60?"Bon travail ! Quelques efforts supplmentaires et tu seras au top ! ":e>=40?"Tu peux faire mieux ! Suis les recommandations pour progresser. ":e>=20?"Courage ! Chaque effort compte. Commence par les recommandations prioritaires. ":"C'est le moment de se lancer ! Passe ton premier quiz pour commencer. "}function MX(e){return e.cible===0?0:Math.min(Math.round(e.progression/e.cible*100),100)}const PX="PEDA",TX=4,qX=5,RX=40,KM=5;function Va(e){return e instanceof Oe?e.toDate():e instanceof Date?e:e?.seconds?new Date(e.seconds*1e3):new Date(e)}function WM(e){const t=new Date,n=t.getDay(),a=n===0?-6:1-n,l=new Date(t);return l.setDate(t.getDate()+a),l.setHours(0,0,0,0),l}function IX(e){const t=WM(),n=new Date(t);return n.setDate(t.getDate()+6),n.setHours(23,59,59,999),n}function IE(e){const t=["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"];return`${e.getDate()} ${t[e.getMonth()]}`}function XM(e,t){return Math.floor(Math.abs(t.getTime()-e.getTime())/864e5)}async function LX(e){try{const t="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let n="",a="";for(let u=0;u<TX;u++)n+=t.charAt(Math.floor(Math.random()*t.length)),a+=t.charAt(Math.floor(Math.random()*t.length));const l=`${PX}-${n}-${a}`,o=Ne(K,"users",e);return await Qe(o,{codeParent:l,codeParentGenere:new Date}),l}catch(t){throw console.error("Erreur gnration code invitation:",t),new Error("Impossible de gnrer le code d'invitation")}}async function $X(e){try{const t=Ne(K,"users",e),n=await Dt(t);if(!n.exists())throw new Error("lve introuvable");const a=n.data();return a.codeParent?a.codeParent:await LX(e)}catch(t){throw console.error("Erreur rcupration code invitation:",t),new Error("Impossible de rcuprer le code d'invitation")}}async function BX(e,t){try{const n=t.trim().toUpperCase(),a=je(K,"users"),l=Ee(a,Se("codeParent","==",n),Se("role","==","eleve"),ar(1)),o=await Ce(l);if(o.empty)throw new Error("Code d'invitation invalide. Vrifiez le code et ressayez.");const u=o.docs[0],d=u.data(),f=u.id,p=je(K,"liens_parent_enfant"),h=Ee(p,Se("parentId","==",e),Se("enfantId","==",f),Se("statut","==","actif"),ar(1));if(!(await Ce(h)).empty)throw new Error("Cet enfant est dj li  votre compte.");const b={parentId:e,enfantId:f,enfantNom:d.displayName||d.email,enfantEmail:d.email,enfantClasse:d.classe||void 0,codeInvitation:n,statut:"actif",dateCreation:new Date};return{id:(await qt(p,b)).id,...b}}catch(n){throw console.error("Erreur liaison parent-enfant:",n),n}}async function UX(e){try{const t=je(K,"liens_parent_enfant"),n=Ee(t,Se("parentId","==",e),Se("statut","==","actif"),Ve("dateCreation","desc"));return(await Ce(n)).docs.map(l=>({id:l.id,...l.data(),dateCreation:Va(l.data().dateCreation),dateDerniereConsultation:l.data().dateDerniereConsultation?Va(l.data().dateDerniereConsultation):void 0}))}catch(t){return console.error("Erreur rcupration enfants lis:",t),[]}}async function FX(e,t){try{const n=Ne(K,"liens_parent_enfant",e),a=await Dt(n);if(!a.exists())throw new Error("Lien introuvable");if(a.data().parentId!==t)throw new Error("Action non autorise");await Qe(n,{statut:"revoque",dateRevocation:new Date})}catch(n){throw console.error("Erreur rvocation lien:",n),n}}async function GX(e,t){try{const n=je(K,"liens_parent_enfant"),a=Ee(n,Se("parentId","==",e),Se("enfantId","==",t),Se("statut","==","actif"),ar(1)),l=await Ce(a);if(l.empty)throw new Error("Vous n'tes pas autoris  consulter le suivi de cet enfant.");const o=Ne(K,"users",t),u=await Dt(o);if(!u.exists())throw new Error("Profil de l'enfant introuvable.");const d=u.data(),f=await bj(t),p=await mp(t),h=p.slice(0,KM).map(j=>({quizTitre:j.quizTitre||"Quiz",disciplineNom:j.disciplineNom||"Discipline",pourcentage:j.pourcentage,noteSur20:Math.round(j.pourcentage/100*20*10)/10,reussi:j.reussi,datePassage:Va(j.datePassage)})),v=await HX(e,t,d.displayName||d.email,f.lacunes,f.streak,f.scoreGlobal,p),b=QX(t,d.displayName||d.email,f,p),x=l.docs[0];return await Qe(Ne(K,"liens_parent_enfant",x.id),{dateDerniereConsultation:new Date}),{enfant:{id:t,nom:d.displayName||d.email,email:d.email,classe:d.classe||void 0,derniereConnexion:d.lastLogin?Va(d.lastLogin):void 0},scoreGlobal:f.scoreGlobal,streak:{actuel:f.streak.streakActuel,meilleur:f.streak.meilleurStreak,semaineCourante:f.streak.semaineCourante},lacunes:f.lacunes.map(j=>({disciplineNom:j.disciplineNom,moyenne:j.moyenne,niveauUrgence:j.niveauUrgence,tendance:j.tendance})),objectifs:f.objectifs.map(j=>({titre:j.titre,progression:j.progression,cible:j.cible,statut:j.statut})),derniersQuiz:h,resume:b,alertes:v}}catch(n){throw console.error("Erreur dashboard parent:",n),n}}async function HX(e,t,n,a,l,o,u){const d=[],f=new Date;if(a.filter(h=>h.niveauUrgence==="critique").forEach(h=>{d.push({id:`alerte_parent_lacune_${h.id}`,parentId:e,enfantId:t,enfantNom:n,type:"lacune_critique",niveau:"critique",titre:` Alerte critique en ${h.disciplineNom}`,message:`${n} a une moyenne de ${h.moyenne}/20 en ${h.disciplineNom}. Un suivi rapproch est recommand.`,lue:!1,dateCreation:f})}),l.dernierJourActif){const h=XM(Va(l.dernierJourActif),f);h>=qX&&d.push({id:`alerte_parent_inactif_${t}`,parentId:e,enfantId:t,enfantNom:n,type:"inactivite",niveau:"important",titre:` ${n} est inactif`,message:`${n} n'a pas utilis PedaClic depuis ${h} jours. Un petit encouragement pourrait aider !`,lue:!1,dateCreation:f})}else u.length===0&&d.push({id:`alerte_parent_jamais_actif_${t}`,parentId:e,enfantId:t,enfantNom:n,type:"inactivite",niveau:"modere",titre:` ${n} n'a pas encore commenc`,message:`${n} n'a pas encore pass de quiz sur PedaClic. Encouragez-le  commencer !`,lue:!1,dateCreation:f});o<RX&&u.length>0&&d.push({id:`alerte_parent_score_${t}`,parentId:e,enfantId:t,enfantNom:n,type:"score_bas",niveau:"important",titre:` Score global bas : ${o}/100`,message:`Le score de sant global de ${n} est de ${o}/100. Des efforts supplmentaires sont ncessaires dans plusieurs matires.`,lue:!1,dateCreation:f}),a.filter(h=>h.tendance==="hausse").forEach(h=>{d.push({id:`alerte_parent_progression_${h.id}`,parentId:e,enfantId:t,enfantNom:n,type:"progression",niveau:"info",titre:` Progression en ${h.disciplineNom}`,message:`Bonne nouvelle ! ${n} montre une tendance  la hausse en ${h.disciplineNom}.`,lue:!1,dateCreation:f})}),l.streakActuel>=5&&d.push({id:`alerte_parent_streak_${t}`,parentId:e,enfantId:t,enfantNom:n,type:"objectif_atteint",niveau:"info",titre:` Streak de ${l.streakActuel} jours !`,message:`Flicitations ! ${n} maintient un streak de ${l.streakActuel} jours conscutifs de travail.`,lue:!1,dateCreation:f});const p={critique:0,important:1,modere:2,info:3};return d.sort((h,v)=>p[h.niveau]-p[v.niveau]),d}function QX(e,t,n,a){const l=WM(),o=IX(),u=new Date(l);u.setDate(u.getDate()-7);const d=new Date(o);d.setDate(d.getDate()-7);const f=a.filter(A=>{const O=Va(A.datePassage);return O>=l&&O<=o}),p=a.filter(A=>{const O=Va(A.datePassage);return O>=u&&O<=d}),h=f.slice(0,KM).map(A=>({quizTitre:A.quizTitre||"Quiz",disciplineNom:A.disciplineNom||"Discipline",pourcentage:A.pourcentage,noteSur20:Math.round(A.pourcentage/100*20*10)/10,reussi:A.reussi,datePassage:Va(A.datePassage)})),v=VX(f,p),b=new Set;f.forEach(A=>{const O=Va(A.datePassage);b.add(`${O.getFullYear()}-${O.getMonth()}-${O.getDate()}`)});const x=f.reduce((A,O)=>A+(O.tempsEcoule||5),0);let j=0;if(p.length>0){const A=p.reduce((O,k)=>O+k.pourcentage,0)/p.length;j=Math.round(A)}let N="stable";const w=n.scoreGlobal-j;w>5?N="hausse":w<-5&&(N="baisse");const C=n.lacunes.filter(A=>A.niveauUrgence==="critique"||A.niveauUrgence==="important").map(A=>A.disciplineNom),E=n.objectifs.filter(A=>A.statut==="atteint").length,S=`${IE(l)} - ${IE(o)} ${o.getFullYear()}`;return{enfantId:e,enfantNom:t,semaine:S,dateDebut:l,dateFin:o,scoreGlobal:n.scoreGlobal,scoreGlobalPrecedent:j,evolutionScore:N,nombreQuizSemaine:f.length,tempsEstimeMinutes:Math.round(x),joursActifsSemaine:b.size,streakActuel:n.streak.streakActuel,derniersQuiz:h,evolutionDisciplines:v,lacunesCritiques:n.lacunes.filter(A=>A.niveauUrgence==="critique").length,lacunesImportantes:n.lacunes.filter(A=>A.niveauUrgence==="important").length,disciplinesEnDifficulte:C,objectifsAtteints:E,objectifsTotal:n.objectifs.length}}function VX(e,t){const n=new Map;e.forEach(o=>{n.has(o.disciplineId)||n.set(o.disciplineId,{scores:[],nom:o.disciplineNom||"Discipline"}),n.get(o.disciplineId).scores.push(o.pourcentage)});const a=new Map;t.forEach(o=>{a.has(o.disciplineId)||a.set(o.disciplineId,[]),a.get(o.disciplineId).push(o.pourcentage)});const l=[];return n.forEach((o,u)=>{const d=o.scores.reduce((j,N)=>j+N,0)/o.scores.length,f=a.get(u)||[],p=f.length>0?f.reduce((j,N)=>j+N,0)/f.length:d,h=Math.round(d/100*20*10)/10,v=Math.round(p/100*20*10)/10,b=Math.round((h-v)*10)/10;let x="stable";b>1?x="hausse":b<-1&&(x="baisse"),l.push({disciplineNom:o.nom,disciplineId:u,moyenneSemainePrecedente:v,moyenneSemaineCourante:h,evolution:x,ecart:b})}),l}function YX(e){return mf(e)}function KX(e){return{lacune_critique:"Lacune critique",inactivite:"Inactivit",streak_perdu:"Streak perdu",objectif_atteint:"Objectif atteint",progression:"Progression",score_bas:"Score bas",nouveau_quiz:"Nouveau quiz"}[e]||"Alerte"}function LE(e){switch(e){case"hausse":return"";case"baisse":return"";case"stable":return"";default:return""}}function WX(e){return e>=80?"Votre enfant fait un excellent travail ! Continuez  l'encourager. ":e>=60?"De bons rsultats ! Quelques efforts supplmentaires et ce sera parfait. ":e>=40?"Des progrs sont possibles. Encouragez votre enfant  suivre les recommandations. ":e>=20?"Votre enfant a besoin de soutien. Un suivi rgulier est recommand. ":"Il est temps de commencer ! Encouragez votre enfant  passer ses premiers quiz. "}function yx(e){const n=XM(e,new Date);return n===0?"Aujourd'hui":n===1?"Hier":n<7?`Il y a ${n} jours`:n<30?`Il y a ${Math.floor(n/7)} semaine(s)`:`Il y a ${Math.floor(n/30)} mois`}const XX="PROF",ZX=4,em="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",ZM=8,JX=7,eZ=16;function Vs(e){return e instanceof Oe?e.toDate():e instanceof Date?e:e?.seconds?new Oe(e.seconds,e.nanoseconds||0).toDate():new Date(e)}function tZ(e,t){return Math.floor(Math.abs(t.getTime()-e.getTime())/864e5)}async function JM(){let e=0;const t=10;for(;e<t;){let n="",a="";for(let d=0;d<ZX;d++)n+=em.charAt(Math.floor(Math.random()*em.length)),a+=em.charAt(Math.floor(Math.random()*em.length));const l=`${XX}-${n}-${a}`,o=Ee(je(K,"groupes_prof"),Se("codeInvitation","==",l),ar(1));if((await Ce(o)).empty)return l;e++}throw new Error("Impossible de gnrer un code unique aprs plusieurs tentatives")}async function rZ(e,t,n){try{const a=await JM(),l={profId:e,profNom:t,nom:n.nom.trim(),description:n.description?.trim()||"",matiereId:n.matiereId,matiereNom:n.matiereNom,classeNiveau:n.classeNiveau,codeInvitation:a,nombreInscrits:0,statut:"actif",anneeScolaire:n.anneeScolaire,dateCreation:new Date,dateMiseAJour:new Date},o=await qt(je(K,"groupes_prof"),l);return console.log(` Groupe "${n.nom}" cr avec code: ${a}`),{id:o.id,...l}}catch(a){throw console.error(" Erreur cration groupe:",a),new Error("Impossible de crer le groupe. Ressayez.")}}async function eP(e){try{const t=Ee(je(K,"groupes_prof"),Se("profId","==",e),Ve("dateCreation","desc"));return(await Ce(t)).docs.map(a=>({id:a.id,...a.data(),dateCreation:Vs(a.data().dateCreation),dateMiseAJour:a.data().dateMiseAJour?Vs(a.data().dateMiseAJour):void 0}))}catch(t){throw console.error(" Erreur rcupration groupes:",t),new Error("Impossible de charger vos groupes.")}}async function nZ(e){try{const t=await Dt(Ne(K,"groupes_prof",e));if(!t.exists())return null;const n=t.data();return{id:t.id,...n,dateCreation:Vs(n.dateCreation),dateMiseAJour:n.dateMiseAJour?Vs(n.dateMiseAJour):void 0}}catch(t){return console.error(" Erreur rcupration groupe:",t),null}}async function tP(e,t){try{const n=Ne(K,"groupes_prof",e);await Qe(n,{...t,dateMiseAJour:new Date}),console.log(` Groupe ${e} mis  jour`)}catch(n){throw console.error(" Erreur modification groupe:",n),new Error("Impossible de modifier le groupe.")}}async function aZ(e){try{const t=Mn(K),n=Ee(je(K,"inscriptions_groupe"),Se("groupeId","==",e));(await Ce(n)).docs.forEach(l=>t.delete(l.ref)),t.delete(Ne(K,"groupes_prof",e)),await t.commit(),console.log(` Groupe ${e} et ses inscriptions supprims`)}catch(t){throw console.error(" Erreur suppression groupe:",t),new Error("Impossible de supprimer le groupe.")}}async function iZ(e){await tP(e,{statut:"archive"})}async function sZ(e){try{const t=await JM();return await Qe(Ne(K,"groupes_prof",e),{codeInvitation:t,dateMiseAJour:new Date}),console.log(` Nouveau code pour groupe ${e}: ${t}`),t}catch(t){throw console.error(" Erreur rgnration code:",t),new Error("Impossible de rgnrer le code.")}}async function lZ(e,t,n,a){try{const l=a.trim().toUpperCase(),o=Ee(je(K,"groupes_prof"),Se("codeInvitation","==",l),ar(1)),u=await Ce(o);if(u.empty)throw new Error("Code d'invitation invalide. Vrifiez le code et ressayez.");const d=u.docs[0],f=d.data();if(f.statut!=="actif")throw new Error("Ce groupe n'accepte plus de nouvelles inscriptions.");const p=Ee(je(K,"inscriptions_groupe"),Se("groupeId","==",d.id),Se("eleveId","==",e),Se("statut","==","actif"),ar(1));if(!(await Ce(p)).empty)throw new Error("Tu es dj inscrit(e) dans ce groupe.");const v={groupeId:d.id,eleveId:e,eleveNom:t,eleveEmail:n,statut:"actif",dateInscription:new Date},b=await qt(je(K,"inscriptions_groupe"),v);return await Qe(Ne(K,"groupes_prof",d.id),{nombreInscrits:Ks(1),dateMiseAJour:new Date}),console.log(` lve ${t} inscrit au groupe "${f.nom}"`),{id:b.id,...v}}catch(l){throw console.error(" Erreur inscription groupe:",l),l}}async function fp(e,t="actif"){try{const n=Ee(je(K,"inscriptions_groupe"),Se("groupeId","==",e),Se("statut","==",t),Ve("dateInscription","asc"));return(await Ce(n)).docs.map(l=>({id:l.id,...l.data(),dateInscription:Vs(l.data().dateInscription),dateRetrait:l.data().dateRetrait?Vs(l.data().dateRetrait):void 0}))}catch(n){throw console.error(" Erreur rcupration lves groupe:",n),new Error("Impossible de charger les lves du groupe.")}}async function oZ(e){try{const t=Ee(je(K,"inscriptions_groupe"),Se("eleveId","==",e),Se("statut","==","actif")),n=await Ce(t);if(n.empty)return[];const a=[];for(const l of n.docs){const o=l.data().groupeId,u=await nZ(o);u&&u.statut==="actif"&&a.push(u)}return a}catch(t){return console.error(" Erreur rcupration groupes lve:",t),[]}}async function cZ(e,t){try{await Qe(Ne(K,"inscriptions_groupe",e),{statut:"retire",dateRetrait:new Date}),await Qe(Ne(K,"groupes_prof",t),{nombreInscrits:Ks(-1),dateMiseAJour:new Date}),console.log(" lve retir du groupe")}catch(n){throw console.error(" Erreur retrait lve:",n),new Error("Impossible de retirer l'lve du groupe.")}}async function yj(e){try{const n=(await fp(e)).map(b=>b.eleveId);if(n.length===0)return{groupeId:e,nombreEleves:0,moyenneClasse:0,tauxReussite:0,tauxParticipation:0,totalQuizPasses:0,elevesEnDifficulte:0,meilleureNote:0,pireNote:0,derniereMiseAJour:new Date};const a=[],l=[];for(let b=0;b<n.length;b+=10)l.push(n.slice(b,b+10));for(const b of l){const x=Ee(je(K,"quiz_results"),Se("userId","in",b));(await Ce(x)).docs.forEach(N=>a.push({id:N.id,...N.data()}))}const o=new Map;for(const b of a){const x=b.userId;o.has(x)||o.set(x,{total:0,somme:0,reussis:0});const j=o.get(x);j.total++,j.somme+=b.score||0,(b.score||0)>=10&&j.reussis++}let u=0,d=0,f=0,p=0,h=20,v=0;for(const[,b]of o){const x=b.total>0?b.somme/b.total:0;u+=x,d++,v+=b.total,x<ZM&&f++,x>p&&(p=x),x<h&&(h=x)}return d===0&&(h=0),{groupeId:e,nombreEleves:n.length,moyenneClasse:d>0?Math.round(u/d*10)/10:0,tauxReussite:v>0?Math.round(Array.from(o.values()).reduce((b,x)=>b+x.reussis,0)/v*100):0,tauxParticipation:Math.round(d/n.length*100),totalQuizPasses:v,elevesEnDifficulte:f,meilleureNote:Math.round(p*10)/10,pireNote:Math.round(h*10)/10,derniereMiseAJour:new Date}}catch(t){throw console.error(" Erreur calcul stats groupe:",t),new Error("Impossible de calculer les statistiques du groupe.")}}async function uZ(e){try{const t=await fp(e);if(t.length===0)return[];const n=[];for(const a of t)try{const l=await bj(a.eleveId),o=Ee(je(K,"quiz_results"),Se("userId","==",a.eleveId),Ve("datePassage","desc")),d=(await Ce(o)).docs.map(x=>x.data());let f=0,p=0,h;if(d.length>0){const x=d.reduce((j,N)=>j+(N.score||0),0);f=Math.round(x/d.length*10)/10,p=Math.round(d.filter(j=>(j.score||0)>=10).length/d.length*100),h=Vs(d[0].datePassage)}let v="stable";if(d.length>=4){const x=d.slice(0,Math.ceil(d.length/2)),j=d.slice(Math.ceil(d.length/2)),N=x.reduce((C,E)=>C+(E.score||0),0)/x.length,w=j.reduce((C,E)=>C+(E.score||0),0)/j.length;N-w>1?v="hausse":w-N>1&&(v="baisse")}const b=l.lacunes.map(x=>({disciplineNom:x.disciplineNom,chapitre:x.chapitre,moyenne:x.moyenne,niveauUrgence:x.niveauUrgence}));n.push({eleveId:a.eleveId,eleveNom:a.eleveNom,eleveEmail:a.eleveEmail,moyenne:f,totalQuiz:d.length,tauxReussite:p,scoreGlobal:l.scoreGlobal,streak:{actuel:l.streak.streakActuel,meilleur:l.streak.meilleurStreak},lacunes:b,dernierQuiz:h,tendance:v})}catch(l){console.warn(` Suivi incomplet pour lve ${a.eleveNom}:`,l),n.push({eleveId:a.eleveId,eleveNom:a.eleveNom,eleveEmail:a.eleveEmail,moyenne:0,totalQuiz:0,tauxReussite:0,scoreGlobal:0,streak:{actuel:0,meilleur:0},lacunes:[],tendance:"stable"})}return n.sort((a,l)=>l.moyenne-a.moyenne),n}catch(t){throw console.error(" Erreur stats lves groupe:",t),new Error("Impossible de charger les statistiques des lves.")}}async function dZ(e,t,n){try{const l=(await fp(e)).map(x=>x.eleveId);if(l.length===0)return null;let o=null,u="quiz_results";if(n!=="quizzes_v2"){if(n!=="quizzes"){const x=await Dt(Ne(K,"quizzes_v2",t));if(x.exists())o=x.data(),u="quiz_results_v2";else{const j=await Dt(Ne(K,"quizzes",t));j.exists()&&(o=j.data(),u="quiz_results")}}}if(!o)return null;const d=[],f=[];for(let x=0;x<l.length;x+=10)f.push(l.slice(x,x+10));for(const x of f){const j=Ee(je(K,u),Se("quizId","==",t),Se("userId","in",x));(await Ce(j)).docs.forEach(w=>d.push(w.data()))}if(d.length===0)return null;const p=u==="quiz_results_v2",h=d.map(x=>p?x.note20||(x.scoreMax>0?x.score/x.scoreMax*20:0):x.score||0),v=d.map(x=>x.tempsEcoule||0),b=[];if(p&&o.questions)for(let x=0;x<o.questions.length;x++){const j=o.questions[x];let N=0,w=0;for(const S of d){const A=S.detailsParQuestion?.find(O=>O.questionId===j.id);A&&(w++,A.isCorrect||N++)}const C=w>0?Math.round(N/w*100):0,E=j.enonce?.replace(/<[^>]*>/g,"").trim()||`Question ${x+1}`;b.push({questionIndex:x,questionTexte:E,tauxEchec:C,reponseCorrecte:"Voir correction dtaille",reponsesFrequentes:[]})}else if(o.questions)for(let x=0;x<o.questions.length;x++){const j=o.questions[x];let N=0;const w=new Map;for(const S of d){const A=S.reponses?.[x];A!==void 0&&(w.set(A,(w.get(A)||0)+1),A!==j.reponseCorrecte&&N++)}const C=Math.round(N/d.length*100),E=Array.from(w.entries()).filter(([S])=>S!==j.reponseCorrecte).map(([S,A])=>({reponse:j.options?.[S]||`Option ${S+1}`,nombre:A})).sort((S,A)=>A.nombre-S.nombre);b.push({questionIndex:x,questionTexte:j.question,tauxEchec:C,reponseCorrecte:j.options?.[j.reponseCorrecte]||"N/A",reponsesFrequentes:E})}return b.sort((x,j)=>j.tauxEchec-x.tauxEchec),{quizId:t,quizTitre:o.titre||"Quiz sans titre",disciplineNom:o.disciplineNom||o.matiereNom||"",totalPassages:d.length,moyenneScore:Math.round(h.reduce((x,j)=>x+j,0)/h.length*10)/10,tauxReussite:Math.round(h.filter(x=>x>=10).length/h.length*100),tempsEcouleMoyen:Math.round(v.reduce((x,j)=>x+j,0)/v.length),questionsRatees:b}}catch(a){return console.error(" Erreur analyse quiz groupe:",a),null}}async function mZ(e){try{const t=[];try{const n=Ee(je(K,"quizzes"),Se("disciplineId","==",e),Ve("createdAt","desc"));(await Ce(n)).docs.forEach(l=>{t.push({id:l.id,titre:l.data().titre||"Quiz sans titre",source:"quizzes"})})}catch(n){console.warn(" Recherche quizzes choue (index manquant ?):",n)}try{const n=Ee(je(K,"quizzes_v2"),Se("disciplineId","==",e),Ve("createdAt","desc"));(await Ce(n)).docs.forEach(l=>{t.push({id:l.id,titre:l.data().titre||"Quiz avanc sans titre",source:"quizzes_v2"})})}catch(n){console.warn(" Recherche quizzes_v2 choue (index manquant ?):",n)}return console.log(` ${t.length} quiz trouv(s) pour discipline ${e}`),t}catch(t){return console.error(" Erreur rcupration quiz par matire:",t),[]}}function fZ(e,t){const n=[],a=new Date;for(const o of e){if(o.totalQuiz>0&&o.moyenne<ZM&&n.push({id:`diff-${o.eleveId}`,type:"difficulte",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:t,message:`${o.eleveNom} a une moyenne de ${o.moyenne}/20. Lacunes : ${o.lacunes.map(u=>u.disciplineNom).join(", ")||"non dtectes"}.`,niveauUrgence:o.moyenne<5?"critique":"important",dateCreation:a}),o.dernierQuiz){const u=tZ(o.dernierQuiz,a);u>=JX&&n.push({id:`inact-${o.eleveId}`,type:"inactivite",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:t,message:`${o.eleveNom} n'a pas fait de quiz depuis ${u} jours.`,niveauUrgence:u>=14?"important":"info",dateCreation:a})}else o.totalQuiz===0&&n.push({id:`inact-${o.eleveId}`,type:"inactivite",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:t,message:`${o.eleveNom} n'a encore pass aucun quiz.`,niveauUrgence:"info",dateCreation:a});o.tendance==="baisse"&&o.totalQuiz>=4&&n.push({id:`baisse-${o.eleveId}`,type:"baisse",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:t,message:`${o.eleveNom} est en baisse de rsultats (tendance ngative).`,niveauUrgence:"important",dateCreation:a}),o.moyenne>=eZ&&o.totalQuiz>=3&&n.push({id:`felicite-${o.eleveId}`,type:"felicitation",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:t,message:`${o.eleveNom} excelle avec ${o.moyenne}/20 ! `,niveauUrgence:"info",dateCreation:a})}const l={critique:0,important:1,info:2};return n.sort((o,u)=>l[o.niveauUrgence]-l[u.niveauUrgence]),n}function pZ(e,t){const n=["Nom","Email","Moyenne (/20)","Quiz passs","Taux russite (%)","Streak (jours)","Lacunes principales","Tendance"],a=e.map(o=>{const u=o.lacunes.map(d=>`${d.disciplineNom} (${d.moyenne}/20)`).join(" | ")||"Aucune";return[`"${o.eleveNom}"`,`"${o.eleveEmail}"`,o.moyenne.toString(),o.totalQuiz.toString(),o.tauxReussite.toString(),o.streak.actuel.toString(),`"${u}"`,o.tendance].join(",")});return"\uFEFF"+[n.join(","),...a].join(`
`)}function hZ(e,t){const n=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(n),l=document.createElement("a");l.href=a,l.download=`${t}.csv`,l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)}const vZ=()=>{const{currentUser:e}=Ze(),[t,n]=g.useState([]),[a,l]=g.useState(!1),[o,u]=g.useState(""),[d,f]=g.useState(!0),[p,h]=g.useState(!1),[v,b]=g.useState(null),[x,j]=g.useState(null),N=g.useCallback(async()=>{if(e?.uid)try{f(!0);const C=await oZ(e.uid);n(C)}catch(C){console.error("Erreur chargement groupes:",C)}finally{f(!1)}},[e?.uid]);g.useEffect(()=>{N()},[N]);const w=async C=>{if(C.preventDefault(),!(!e?.uid||!o.trim()))try{h(!0),b(null),j(null),await lZ(e.uid,e.displayName||e.email||"lve",e.email||"",o),j("Tu as rejoint le groupe avec succs ! "),u(""),l(!1),await N(),setTimeout(()=>j(null),5e3)}catch(E){b(E.message||"Impossible de rejoindre le groupe.")}finally{h(!1)}};return r.jsxs("div",{className:"rejoindre-groupe-section",children:[r.jsxs("div",{className:"rejoindre-groupe-header",children:[r.jsx("h3",{children:" Mes groupes-classes"}),r.jsx("button",{className:"prof-btn prof-btn-primary prof-btn-sm",onClick:()=>l(!a),children:a?" Annuler":" Rejoindre un groupe"})]}),v&&r.jsxs("div",{className:"prof-alert prof-alert-error",children:[" ",v,r.jsx("button",{onClick:()=>b(null),className:"prof-alert-close",children:""})]}),x&&r.jsx("div",{className:"prof-alert",style:{background:"#d1fae5",border:"1px solid #a7f3d0",color:"#065f46"},children:x}),a&&r.jsxs("div",{className:"groupe-form-container",style:{marginBottom:"1rem"},children:[r.jsx("p",{style:{marginBottom:"0.75rem",color:"#6b7280",fontSize:"0.875rem"},children:"Saisis le code donn par ton professeur (format: PROF-XXXX-XXXX)"}),r.jsxs("form",{onSubmit:w,style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[r.jsx("input",{type:"text",placeholder:"PROF-XXXX-XXXX",value:o,onChange:C=>u(C.target.value.toUpperCase()),maxLength:14,disabled:p,className:"prof-input",style:{flex:1,maxWidth:"280px",fontFamily:"monospace",letterSpacing:"2px"}}),r.jsx("button",{type:"submit",className:"prof-btn prof-btn-primary",disabled:p||o.length<14,children:p?" Vrification...":" Rejoindre"})]})]}),d?r.jsx("p",{style:{color:"#9ca3af",textAlign:"center",padding:"1rem"},children:"Chargement..."}):t.length===0?r.jsxs("div",{style:{textAlign:"center",padding:"2rem",color:"#9ca3af"},children:[r.jsx("p",{children:"Tu n'es inscrit(e) dans aucun groupe-classe."}),r.jsx("p",{style:{fontSize:"0.875rem"},children:"Demande  ton professeur un code d'invitation pour rejoindre son groupe."})]}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:t.map(C=>r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#1f2937"},children:C.nom}),r.jsxs("span",{style:{display:"block",fontSize:"0.75rem",color:"#9ca3af"},children:[C.matiereNom,"  Prof: ",C.profNom]})]}),r.jsx("span",{style:{fontSize:"0.875rem",color:"#10b981",fontWeight:600},children:" Inscrit(e)"})]},C.id))})]})},gZ=e=>e>=80?"#10b981":e>=60?"#3b82f6":e>=40?"#f59e0b":e>0?"#ef4444":"#d1d5db",$E=({pourcentage:e,label:t,size:n="md",showPercent:a=!0,color:l,showCheck:o=!0,className:u=""})=>{const[d,f]=g.useState(0);g.useEffect(()=>{const x=setTimeout(()=>{f(Math.min(100,Math.max(0,e)))},100);return()=>clearTimeout(x)},[e]);const h={sm:"4px",md:"8px",lg:"12px"}[n],v=l||gZ(e),b=e>=100;return r.jsxs("div",{className:`progress-bar-wrapper ${u}`,children:[(t||a)&&r.jsxs("div",{className:"progress-bar-header",children:[t&&r.jsx("span",{className:"progress-bar-label",children:t}),a&&r.jsxs("span",{className:"progress-bar-percent",style:{color:v},children:[b&&o?" ":"",e,"%"]})]}),r.jsx("div",{className:"progress-bar-track",style:{height:h},children:r.jsx("div",{className:"progress-bar-fill",style:{width:`${d}%`,backgroundColor:v,height:"100%"}})})]})},xZ=()=>{const e=lt(),{currentUser:t}=Ze(),[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState([]),[f,p]=g.useState([]),[h,v]=g.useState([]),[b,x]=g.useState(null),[j,N]=g.useState([]),[w,C]=g.useState("all"),[E,S]=g.useState(!0),[A,O]=g.useState("overview"),[k,M]=g.useState(null),[D,$]=g.useState(!1),[U,L]=g.useState(!1),B=async()=>{if(t){$(!0);try{const R=await $X(t.uid);M(R)}catch(R){console.error("Erreur gnration code parent :",R)}finally{$(!1)}}},ee=()=>{k&&(navigator.clipboard.writeText(k),L(!0),setTimeout(()=>L(!1),2e3))};if(g.useEffect(()=>{(async()=>{if(t){S(!0);try{await e6(t.uid);const[W,I,re,V,oe,xe]=await Promise.all([GR(t.uid),HR(t.uid),QR(t.uid,20),bf(t.uid,10),zA().catch(()=>[]),XR(t.uid)]);a(W),o(I),d(re),p(V),v(oe),x(xe);const ve=t6(W,I,xe);N(ve)}catch(W){console.error("Erreur chargement dashboard :",W)}finally{S(!1)}}})()},[t]),E)return r.jsxs("div",{className:"sd-loading",children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement de votre tableau de bord..."})]});const se=j.filter(R=>R.obtenu),P=j.length,q=t?.displayName||t?.email?.split("@")[0]||"lve",F=w==="all"?j:j.filter(R=>R.categorie===w);return r.jsxs("div",{className:"student-dashboard",children:[r.jsxs("div",{className:"sd-welcome",children:[r.jsxs("div",{className:"sd-welcome-text",children:[r.jsxs("h1",{children:["Bienvenue, ",q," "]}),r.jsx("p",{children:n&&n.totalQuizPasses>0?`Vous avez pass ${n.totalQuizPasses} quiz avec une moyenne de ${n.moyenneGenerale}%. Continuez !`:"Commencez par consulter une ressource ou passer un quiz !"})]}),r.jsxs("div",{className:"sd-welcome-badges-row",children:[t?.isPremium&&r.jsxs("span",{className:"sd-premium-badge",children:[r.jsx(Zr,{size:14})," Premium"]}),b&&b.streakActuel>0&&r.jsxs("span",{className:"sd-streak-badge",children:[" ",b.streakActuel," jour",b.streakActuel>1?"s":""]})]})]}),r.jsxs("div",{className:"sd-stats-grid",children:[r.jsxs("div",{className:"sd-stat-card",children:[r.jsx("div",{className:"sd-stat-icon",style:{background:"#eff6ff",color:"#3b82f6"},children:r.jsx(vn,{size:22})}),r.jsxs("div",{className:"sd-stat-content",children:[r.jsx("span",{className:"sd-stat-value",children:n?.totalQuizPasses||0}),r.jsx("span",{className:"sd-stat-label",children:"Quiz passs"})]})]}),r.jsxs("div",{className:"sd-stat-card",children:[r.jsx("div",{className:"sd-stat-icon",style:{background:"#f0fdf4",color:"#10b981"},children:r.jsx(zv,{size:22})}),r.jsxs("div",{className:"sd-stat-content",children:[r.jsxs("span",{className:"sd-stat-value",style:{color:Xl(n?.moyenneGenerale||0)},children:[n?.moyenneGenerale||0,"%"]}),r.jsx("span",{className:"sd-stat-label",children:"Moyenne gnrale"})]})]}),r.jsxs("div",{className:"sd-stat-card",children:[r.jsx("div",{className:"sd-stat-icon",style:{background:"#fef3c7",color:"#d97706"},children:r.jsx(no,{size:22})}),r.jsxs("div",{className:"sd-stat-content",children:[r.jsx("span",{className:"sd-stat-value",children:b?.totalRessourcesVues||0}),r.jsx("span",{className:"sd-stat-label",children:"Ressources vues"})]})]}),r.jsxs("div",{className:"sd-stat-card",children:[r.jsx("div",{className:"sd-stat-icon",style:{background:"#fef2f2",color:"#ef4444"},children:r.jsx(lA,{size:22})}),r.jsxs("div",{className:"sd-stat-content",children:[r.jsxs("span",{className:"sd-stat-value",children:[b?.streakActuel||0," "]}),r.jsx("span",{className:"sd-stat-label",children:"Jours conscutifs"})]})]}),r.jsxs("div",{className:"sd-stat-card",children:[r.jsx("div",{className:"sd-stat-icon",style:{background:"#fefce8",color:"#f59e0b"},children:r.jsx(oA,{size:22})}),r.jsxs("div",{className:"sd-stat-content",children:[r.jsxs("span",{className:"sd-stat-value",children:[n?.meilleurScore||0,"%"]}),r.jsx("span",{className:"sd-stat-label",children:"Meilleur score"})]})]}),r.jsxs("div",{className:"sd-stat-card",children:[r.jsx("div",{className:"sd-stat-icon",style:{background:"#f0f9ff",color:"#0ea5e9"},children:r.jsx(Wi,{size:22})}),r.jsxs("div",{className:"sd-stat-content",children:[r.jsxs("span",{className:"sd-stat-value",children:[b?.disciplinesCompletees||0,"/",b?.disciplinesCommencees||0]}),r.jsx("span",{className:"sd-stat-label",children:"Disciplines compltes"})]})]})]}),r.jsxs("div",{className:"sd-chart-card",style:{marginBottom:"1.5rem"},children:[r.jsx("h3",{className:"sd-section-title",children:" Code Parent"}),r.jsx("p",{style:{color:"#6b7280",fontSize:"0.9rem",marginBottom:"1rem"},children:"Partagez ce code avec vos parents pour qu'ils puissent suivre votre progression."}),k?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[r.jsx("span",{style:{fontFamily:"monospace",fontSize:"1.4rem",fontWeight:700,letterSpacing:"0.1em",background:"#eff6ff",color:"#2563eb",padding:"0.75rem 1.5rem",borderRadius:"12px",border:"2px dashed #93c5fd",userSelect:"all"},children:k}),r.jsx("button",{className:"sd-btn",onClick:ee,style:{display:"inline-flex",alignItems:"center",gap:"0.4rem",background:U?"#10b981":"#f3f4f6",color:U?"#fff":"#374151",border:"none",padding:"0.6rem 1rem",borderRadius:"8px",cursor:"pointer",fontWeight:500,transition:"all 0.2s"},children:U?" Copi !":" Copier"})]}):r.jsx("button",{className:"sd-btn sd-btn-primary",onClick:B,disabled:D,style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:D?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"admin-spinner",style:{width:"16px",height:"16px"}})," Gnration..."]}):r.jsx(r.Fragment,{children:" Gnrer mon code"})})]}),r.jsx("div",{className:"sd-chart-card",style:{marginBottom:"1.5rem"},children:r.jsx(vZ,{})}),r.jsxs("div",{className:"sd-chart-card",style:{marginBottom:"1.5rem"},children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(vn,{size:18})," Cours en ligne"]}),r.jsx("p",{style:{color:"#6b7280",fontSize:"0.9rem",marginBottom:"1rem"},children:"Des cours complets du programme sngalais, accessibles partout."}),r.jsxs("button",{className:"sd-btn sd-btn-primary",onClick:()=>e("/cours"),style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[r.jsx(Jl,{size:16})," Accder aux cours"]})]}),r.jsxs("div",{className:"sd-tabs",children:[r.jsxs("button",{className:`sd-tab ${A==="overview"?"active":""}`,onClick:()=>O("overview"),children:[r.jsx(Ts,{size:16})," Vue d'ensemble"]}),r.jsxs("button",{className:`sd-tab ${A==="progression"?"active":""}`,onClick:()=>O("progression"),children:[r.jsx(kc,{size:16})," Progression"]}),r.jsxs("button",{className:`sd-tab ${A==="history"?"active":""}`,onClick:()=>O("history"),children:[r.jsx(kv,{size:16})," Historique"]}),r.jsxs("button",{className:`sd-tab ${A==="badges"?"active":""}`,onClick:()=>O("badges"),children:[r.jsx(Wi,{size:16})," Badges (",se.length,"/",P,")"]})]}),A==="overview"&&r.jsxs("div",{className:"sd-overview",children:[u.length>1&&r.jsxs("div",{className:"sd-chart-card",children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(kc,{size:18})," volution de vos scores"]}),r.jsx("div",{className:"sd-chart-container",children:r.jsx(jw,{width:"100%",height:280,children:r.jsxs(xX,{data:u,children:[r.jsx(bb,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),r.jsx(Sb,{dataKey:"date",tick:{fontSize:12,fill:"#6b7280"},tickLine:!1}),r.jsx(Eb,{domain:[0,100],tick:{fontSize:12,fill:"#6b7280"},tickLine:!1,unit:"%"}),r.jsx(A2,{formatter:R=>[`${R}%`,"Score"],labelFormatter:R=>`Date : ${R}`,contentStyle:{borderRadius:"8px",border:"1px solid #e5e7eb",boxShadow:"0 4px 6px rgba(0,0,0,0.07)"}}),r.jsx(zM,{type:"monotone",dataKey:"score",stroke:"#3b82f6",strokeWidth:2.5,dot:{r:4,fill:"#3b82f6",stroke:"#fff",strokeWidth:2},activeDot:{r:6}})]})})})]}),l.length>0&&r.jsxs("div",{className:"sd-chart-card",children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(Ts,{size:18})," Moyennes par discipline"]}),r.jsx("div",{className:"sd-chart-container",children:r.jsx(jw,{width:"100%",height:280,children:r.jsxs(yX,{data:l,layout:"vertical",children:[r.jsx(bb,{strokeDasharray:"3 3",stroke:"#e5e7eb",horizontal:!1}),r.jsx(Sb,{type:"number",domain:[0,100],tick:{fontSize:12,fill:"#6b7280"},unit:"%"}),r.jsx(Eb,{type:"category",dataKey:"disciplineNom",width:120,tick:{fontSize:12,fill:"#374151"}}),r.jsx(A2,{formatter:R=>[`${R}%`,"Moyenne"],contentStyle:{borderRadius:"8px",border:"1px solid #e5e7eb",boxShadow:"0 4px 6px rgba(0,0,0,0.07)"}}),r.jsx(PM,{dataKey:"moyenne",radius:[0,6,6,0],barSize:24,children:l.map((R,W)=>r.jsx(lj,{fill:Xl(R.moyenne)},W))})]})})})]}),h.length>0&&r.jsxs("div",{className:"sd-chart-card",children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(Jl,{size:18})," Quiz disponibles"]}),r.jsx("div",{className:"sd-quiz-grid",children:h.slice(0,6).map(R=>{const W=R.isPremium&&!t?.isPremium;return r.jsxs("div",{className:`sd-quiz-card ${W?"locked":""}`,onClick:()=>!W&&e(`/quiz/${R.id}`),children:[R.isPremium&&r.jsxs("span",{className:"sd-quiz-badge-premium",children:[W?r.jsx(_x,{size:10}):r.jsx(Zr,{size:10})," Premium"]}),r.jsx("h4",{className:"sd-quiz-title",children:R.titre}),r.jsxs("div",{className:"sd-quiz-meta",children:[r.jsxs("span",{children:[r.jsx(vn,{size:12})," ",R.questions.length," questions"]}),r.jsxs("span",{children:[r.jsx(so,{size:12})," ",R.duree," min"]})]}),!W&&r.jsxs("button",{className:"sd-quiz-play-btn",children:[r.jsx(Jl,{size:14})," Commencer"]}),W&&r.jsxs("button",{className:"sd-quiz-unlock-btn",onClick:I=>{I.stopPropagation(),e("/premium")},children:[r.jsx(_x,{size:14})," Dbloquer"]})]},R.id)})})]}),n&&n.totalQuizPasses===0&&(!b||b.totalRessourcesVues===0)&&r.jsxs("div",{className:"sd-empty-state",children:[r.jsx(zv,{size:48}),r.jsx("h3",{children:"Commencez votre parcours !"}),r.jsx("p",{children:"Consultez une ressource ou passez un quiz pour voir votre progression."}),h.length>0&&r.jsxs("button",{className:"sd-btn sd-btn-primary",onClick:()=>e(`/quiz/${h[0].id}`),children:[r.jsx(Jl,{size:18})," Passer un quiz"]})]})]}),A==="progression"&&r.jsxs("div",{className:"sd-progression",children:[r.jsxs("div",{className:"sd-chart-card sd-prog-summary",children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(kc,{size:18})," Avancement global"]}),r.jsx($E,{pourcentage:b?.pourcentageMoyen||0,label:"Progression moyenne",size:"lg",showCheck:!0}),r.jsxs("div",{className:"sd-prog-stats-row",children:[r.jsxs("div",{className:"sd-prog-stat-item",children:[r.jsx("span",{className:"sd-prog-stat-number",children:b?.totalRessourcesVues||0}),r.jsx("span",{className:"sd-prog-stat-text",children:"Ressources consultes"})]}),r.jsxs("div",{className:"sd-prog-stat-item",children:[r.jsx("span",{className:"sd-prog-stat-number",children:b?.totalQuizReussis||0}),r.jsx("span",{className:"sd-prog-stat-text",children:"Quiz russis"})]}),r.jsxs("div",{className:"sd-prog-stat-item",children:[r.jsx("span",{className:"sd-prog-stat-number",children:b?.disciplinesCommencees||0}),r.jsx("span",{className:"sd-prog-stat-text",children:"Disciplines"})]}),r.jsxs("div",{className:"sd-prog-stat-item",children:[r.jsxs("span",{className:"sd-prog-stat-number",children:[" ",b?.streakActuel||0]}),r.jsxs("span",{className:"sd-prog-stat-text",children:["Streak (max: ",b?.meilleurStreak||0,")"]})]})]})]}),b&&b.parDiscipline.length>0?r.jsxs("div",{className:"sd-chart-card",children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(Ts,{size:18})," Par discipline"]}),r.jsx("div",{className:"sd-prog-disciplines",children:b.parDiscipline.map(R=>r.jsxs("div",{className:"sd-prog-disc-card",children:[r.jsxs("div",{className:"sd-prog-disc-header",children:[r.jsx("span",{className:"sd-prog-disc-name",children:R.disciplineNom}),R.pourcentage>=100&&r.jsx("span",{className:"sd-prog-complete-tag",children:" Complt"})]}),r.jsx($E,{pourcentage:R.pourcentage,size:"md",showPercent:!0}),r.jsxs("div",{className:"sd-prog-disc-details",children:[r.jsxs("span",{children:[r.jsx(no,{size:12})," ",R.ressourcesVues.length,"/",R.totalRessources," ressources"]}),r.jsxs("span",{children:[r.jsx(Ut,{size:12})," ",R.quizReussis.length,"/",R.totalQuiz," quiz russis"]})]})]},R.disciplineId))})]}):r.jsxs("div",{className:"sd-empty-state",children:[r.jsx(no,{size:48}),r.jsx("h3",{children:"Aucune progression enregistre"}),r.jsx("p",{children:"Consultez des ressources ou passez des quiz pour voir votre avancement ici."})]}),l.length>0&&r.jsxs("div",{className:"sd-chart-card",children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(zv,{size:18})," Performance quiz par discipline"]}),r.jsx("div",{className:"sd-disc-list",children:l.map(R=>r.jsxs("div",{className:"sd-disc-card",children:[r.jsxs("div",{className:"sd-disc-header",children:[r.jsx("span",{className:"sd-disc-name",children:R.disciplineNom}),r.jsxs("span",{className:"sd-disc-tendance",children:[R.tendance==="up"&&r.jsx(kc,{size:16,className:"tendance-up"}),R.tendance==="down"&&r.jsx(g3,{size:16,className:"tendance-down"}),R.tendance==="stable"&&r.jsx(x3,{size:16,className:"tendance-stable"})]})]}),r.jsxs("div",{className:"sd-disc-stats",children:[r.jsxs("div",{className:"sd-disc-stat",children:[r.jsxs("span",{className:"sd-disc-stat-value",style:{color:Xl(R.moyenne)},children:[R.moyenne,"%"]}),r.jsx("span",{className:"sd-disc-stat-label",children:"Moyenne"})]}),r.jsxs("div",{className:"sd-disc-stat",children:[r.jsx("span",{className:"sd-disc-stat-value",children:R.nombreQuiz}),r.jsx("span",{className:"sd-disc-stat-label",children:"Quiz"})]}),r.jsxs("div",{className:"sd-disc-stat",children:[r.jsxs("span",{className:"sd-disc-stat-value",children:[R.meilleurScore,"%"]}),r.jsx("span",{className:"sd-disc-stat-label",children:"Meilleur"})]}),r.jsxs("div",{className:"sd-disc-stat",children:[r.jsxs("span",{className:"sd-disc-stat-value",children:[R.quizReussis,"/",R.nombreQuiz]}),r.jsx("span",{className:"sd-disc-stat-label",children:"Russis"})]})]}),r.jsx("div",{className:"sd-disc-bar",children:r.jsx("div",{className:"sd-disc-bar-fill",style:{width:`${R.moyenne}%`,background:Xl(R.moyenne)}})})]},R.disciplineId))})]})]}),A==="history"&&r.jsx("div",{className:"sd-history",children:f.length===0?r.jsxs("div",{className:"sd-empty-state",children:[r.jsx(kv,{size:48}),r.jsx("h3",{children:"Aucun quiz pass"}),r.jsx("p",{children:"Votre historique apparatra ici aprs avoir pass des quiz."})]}):r.jsx("div",{className:"sd-history-list",children:f.map(R=>{const W=R.datePassage?.toDate?R.datePassage.toDate():new Date(R.datePassage);return r.jsxs("div",{className:`sd-history-item ${R.reussi?"success":"fail"}`,children:[r.jsx("div",{className:`sd-history-icon ${R.reussi?"success":"fail"}`,children:R.reussi?r.jsx(Ut,{size:20}):r.jsx(Sx,{size:20})}),r.jsxs("div",{className:"sd-history-content",children:[r.jsxs("div",{className:"sd-history-top",children:[r.jsx("span",{className:"sd-history-title",children:R.quizTitre}),r.jsx("span",{className:"sd-history-discipline",children:R.disciplineNom})]}),r.jsxs("div",{className:"sd-history-meta",children:[r.jsxs("span",{children:[r.jsx(kv,{size:12}),W.toLocaleDateString("fr-SN",{day:"2-digit",month:"long",year:"numeric"})]}),r.jsxs("span",{children:[r.jsx(so,{size:12})," ",qA(R.tempsEcoule)]}),r.jsxs("span",{children:[r.jsx(Ut,{size:12})," ",R.bonnesReponses,"/",R.nombreQuestions]})]})]}),r.jsxs("div",{className:"sd-history-score",style:{color:Xl(R.pourcentage)},children:[r.jsxs("span",{className:"sd-history-score-value",children:[R.pourcentage,"%"]}),r.jsx("span",{className:"sd-history-score-label",children:RA(R.pourcentage)})]})]},R.id)})})}),A==="badges"&&r.jsxs("div",{className:"sd-badges",children:[r.jsxs("div",{className:"sd-badges-summary",children:[r.jsxs("div",{className:"sd-badges-circle",children:[r.jsx("span",{className:"sd-badges-count",children:se.length}),r.jsxs("span",{className:"sd-badges-total",children:["/ ",P]})]}),r.jsx("p",{children:"badges obtenus"}),r.jsx("div",{className:"sd-badges-progress",children:r.jsx("div",{className:"sd-badges-progress-fill",style:{width:`${se.length/P*100}%`}})})]}),r.jsx("div",{className:"sd-badges-filters",children:[{key:"all",label:"Tous"},{key:"ressources",label:" Ressources"},{key:"quiz",label:" Quiz"},{key:"performance",label:" Performance"},{key:"discipline",label:" Disciplines"},{key:"streak",label:" Streak"}].map(R=>r.jsx("button",{className:`sd-badge-filter-btn ${w===R.key?"active":""}`,onClick:()=>C(R.key),children:R.label},R.key))}),r.jsx("div",{className:"sd-badges-grid",children:F.map(R=>r.jsxs("div",{className:`sd-badge-card ${R.obtenu?"obtained":"locked"}`,children:[r.jsx("span",{className:"sd-badge-icon",children:R.icone}),r.jsx("h4",{className:"sd-badge-name",children:R.nom}),r.jsx("p",{className:"sd-badge-description",children:R.description}),r.jsx("span",{className:"sd-badge-condition",children:R.condition}),R.obtenu&&r.jsx("span",{className:"sd-badge-obtained-tag",children:" Obtenu"}),r.jsx("span",{className:"sd-badge-category",children:R.categorie})]},R.id))}),F.length===0&&r.jsxs("div",{className:"sd-empty-state",style:{marginTop:"1rem"},children:[r.jsx(Tb,{size:36}),r.jsx("h3",{children:"Aucun badge dans cette catgorie"}),r.jsx("p",{children:"Essayez un autre filtre."})]})]})]})},bZ=()=>{const{currentUser:e}=Ze(),t=lt(),[n,a]=g.useState(null),[l,o]=g.useState(!0),[u,d]=g.useState(null),f=["L","M","M","J","V","S","D"],p=g.useCallback(async()=>{if(e?.uid)try{o(!0),d(null);const S=await bj(e.uid);a(S)}catch(S){console.error("Erreur chargement suivi:",S),d("Impossible de charger ton suivi. Vrifie ta connexion et ressaie.")}finally{o(!1)}},[e?.uid]);g.useEffect(()=>{p()},[p]);const h=(()=>{const S=new Date().getDay();return S===0?6:S-1})();if(l)return r.jsx("div",{className:"suivi-page",children:r.jsx("div",{className:"suivi-container",children:r.jsxs("div",{className:"suivi-loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{className:"suivi-loading-text",children:"Analyse de ta progression en cours..."})]})})});if(u)return r.jsx("div",{className:"suivi-page",children:r.jsx("div",{className:"suivi-container",children:r.jsxs("div",{className:"suivi-error",children:[r.jsx("p",{className:"suivi-error-title",children:" Erreur de chargement"}),r.jsx("p",{className:"suivi-error-text",children:u}),r.jsx("button",{className:"suivi-btn-retry",onClick:p,children:" Ressayer"})]})})});if(!n)return null;const{lacunes:v,recommandations:b,streak:x,objectifs:j,scoreGlobal:N}=n,w=2*Math.PI*40,C=w-N/100*w,E=N>=60?"#10b981":N>=30?"#f59e0b":"#ef4444";return r.jsx("div",{className:"suivi-page",children:r.jsxs("div",{className:"suivi-container",children:[r.jsx("div",{className:"suivi-header",children:r.jsxs("div",{className:"suivi-header-content",children:[r.jsxs("div",{children:[r.jsx("h1",{children:" Mes points  amliorer"}),r.jsx("p",{className:"suivi-motivation",children:DX(N)})]}),r.jsxs("div",{className:"score-global-circle",children:[r.jsxs("svg",{className:"score-circle-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"score-circle-bg",cx:"50",cy:"50",r:"40"}),r.jsx("circle",{className:"score-circle-progress",cx:"50",cy:"50",r:"40",stroke:E,strokeDasharray:w,strokeDashoffset:C}),r.jsx("text",{className:"score-circle-text",x:"50",y:"50",children:N})]}),r.jsx("span",{className:"score-global-label",children:"Score global"})]})]})}),r.jsxs("div",{className:"streak-card",children:[r.jsxs("div",{className:"streak-header",children:[r.jsx("span",{className:"streak-flamme",children:x.streakActuel>0?"":""}),r.jsxs("div",{children:[r.jsx("div",{className:"streak-nombre",children:x.streakActuel}),r.jsx("div",{className:"streak-label",children:x.streakActuel<=1?"jour conscutif":"jours conscutifs"})]})]}),r.jsx("div",{className:"streak-semaine",children:f.map((S,A)=>r.jsxs("div",{className:"streak-jour",children:[r.jsx("span",{className:"streak-jour-label",children:S}),r.jsx("div",{className:`streak-jour-indicateur ${x.semaineCourante[A]?"actif":"inactif"} ${A===h?"aujourd-hui":""}`,children:x.semaineCourante[A]?"":""})]},A))}),r.jsxs("div",{className:"streak-stats",children:[r.jsxs("div",{className:"streak-stat",children:[r.jsx("span",{className:"streak-stat-icon",children:""}),r.jsx("span",{className:"streak-stat-value",children:x.meilleurStreak}),r.jsx("span",{className:"streak-stat-label",children:"record"})]}),r.jsxs("div",{className:"streak-stat",children:[r.jsx("span",{className:"streak-stat-icon",children:""}),r.jsx("span",{className:"streak-stat-value",children:x.totalJoursActifs}),r.jsx("span",{className:"streak-stat-label",children:"jours actifs au total"})]}),x.dernierJourActif&&r.jsxs("div",{className:"streak-stat",children:[r.jsx("span",{className:"streak-stat-icon",children:""}),r.jsxs("span",{className:"streak-stat-label",children:["Dernier quiz : ",new Date(x.dernierJourActif).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})]})]})]})]}),r.jsxs("h2",{className:"suivi-section-title",children:[" Objectifs de la semaine",r.jsx("span",{className:"suivi-section-badge",children:j.length})]}),j.length>0?r.jsx("div",{className:"objectifs-grid",children:j.map(S=>{const A=MX(S);return r.jsxs("div",{className:`objectif-card ${S.statut==="atteint"?"atteint":""}`,children:[r.jsxs("div",{className:"objectif-header",children:[r.jsx("span",{className:"objectif-titre",children:S.titre}),S.recompense&&r.jsx("span",{className:"objectif-recompense",children:S.recompense})]}),r.jsx("p",{className:"objectif-description",children:S.description}),r.jsxs("div",{className:"objectif-progress",children:[r.jsxs("div",{className:"objectif-progress-labels",children:[r.jsxs("span",{className:"objectif-progress-value",children:[S.progression," / ",S.cible]}),r.jsxs("span",{className:"objectif-progress-cible",children:[A,"%"]})]}),r.jsx("div",{className:"objectif-progress-track",children:r.jsx("div",{className:`objectif-progress-fill ${S.statut==="atteint"?"atteint":""}`,style:{width:`${A}%`}})})]}),r.jsx("p",{className:`objectif-statut ${S.statut}`,children:S.statut==="atteint"?" Objectif atteint !":S.statut==="en_cours"?" En cours...":" Non commenc"})]},S.id)})}):r.jsxs("div",{className:"suivi-empty",children:[r.jsx("div",{className:"suivi-empty-icon",children:""}),r.jsx("p",{className:"suivi-empty-title",children:"Pas encore d'objectifs"}),r.jsx("p",{className:"suivi-empty-text",children:"Passe ton premier quiz pour dbloquer tes objectifs hebdomadaires !"})]}),r.jsxs("h2",{className:"suivi-section-title",children:[" Points faibles dtects",v.length>0&&r.jsx("span",{className:"suivi-section-badge",children:v.length})]}),v.length>0?r.jsx("div",{className:"lacunes-grid",children:v.map(S=>r.jsxs("div",{className:`lacune-card ${S.niveauUrgence}`,children:[r.jsxs("div",{className:"lacune-card-header",children:[r.jsx("span",{className:"lacune-discipline",children:S.disciplineNom}),r.jsx("span",{className:`lacune-badge ${S.niveauUrgence}`,children:VM(S.niveauUrgence)})]}),r.jsxs("div",{className:"lacune-score-bar",children:[r.jsxs("div",{className:"lacune-score-labels",children:[r.jsxs("span",{className:"lacune-score-value",style:{color:mf(S.niveauUrgence)},children:[S.moyenne,"/20"]}),r.jsx("span",{className:"lacune-score-objectif",children:"Objectif : 14/20"})]}),r.jsx("div",{className:"lacune-progress-track",children:r.jsx("div",{className:`lacune-progress-fill ${S.niveauUrgence}`,style:{width:`${S.moyenne/20*100}%`}})})]}),r.jsxs("div",{className:"lacune-details",children:[r.jsxs("span",{className:"lacune-detail-tag",children:[YM(S.tendance)," ",S.tendance]}),r.jsxs("span",{className:"lacune-detail-tag",children:[" ",S.nombreQuiz," quiz"]}),r.jsxs("span",{className:"lacune-detail-tag",children:["Dernier : ",S.scoreDetails.dernierScore,"/20"]})]})]},S.id))}):r.jsxs("div",{className:"suivi-empty",children:[r.jsx("div",{className:"suivi-empty-icon",children:""}),r.jsx("p",{className:"suivi-empty-title",children:"Aucune lacune dtecte !"}),r.jsx("p",{className:"suivi-empty-text",children:N>0?"Toutes tes moyennes sont au-dessus de 14/20. Bravo, continue !":"Passe des quiz pour que l'analyse puisse commencer."}),r.jsx("button",{className:"suivi-cta-btn",onClick:()=>t("/disciplines"),style:{marginTop:"1rem"},children:" Voir les disciplines"})]}),b.length>0&&r.jsxs(r.Fragment,{children:[r.jsxs("h2",{className:"suivi-section-title",children:[" Recommandations personnalises",r.jsx("span",{className:"suivi-section-badge",children:b.length})]}),r.jsx("div",{className:"recommandations-list",children:b.map(S=>r.jsxs("div",{className:"recommandation-card",children:[r.jsx("div",{className:"recommandation-priorite",children:S.priorite}),r.jsxs("div",{className:"recommandation-content",children:[r.jsx("p",{className:"recommandation-titre",children:S.titre}),r.jsx("p",{className:"recommandation-description",children:S.description}),r.jsx("span",{className:"recommandation-discipline-tag",children:S.disciplineNom})]})]},S.id))})]}),r.jsx("div",{style:{textAlign:"center",marginTop:"1rem",marginBottom:"2rem"},children:r.jsx("button",{className:"suivi-cta-btn",onClick:()=>t("/disciplines"),children:" Passer un quiz maintenant"})})]})})},yZ=()=>{const e=new Date,t=e.getFullYear(),a=e.getMonth()>=9?t:t-1,l=[];for(let o=-1;o<=3;o++){const u=a+o;l.push(`${u}-${u+1}`)}return l},BE=yZ(),Ec=()=>{const e=new Date,t=e.getFullYear(),a=e.getMonth()>=9?t:t-1;return`${a}-${a+1}`},UE=[{value:"6eme",label:"6me"},{value:"5eme",label:"5me"},{value:"4eme",label:"4me"},{value:"3eme",label:"3me"},{value:"2nde",label:"2nde"},{value:"1ere",label:"1re"},{value:"Terminale",label:"Terminale"}],jZ=({onSelectGroupe:e})=>{const{currentUser:t}=Ze(),[n,a]=g.useState([]),[l,o]=g.useState(new Map),[u,d]=g.useState([]),[f,p]=g.useState(!0),[h,v]=g.useState(null),[b,x]=g.useState(!1),[j,N]=g.useState(!1),[w,C]=g.useState(null),[E,S]=g.useState(null),[A,O]=g.useState(null),[k,M]=g.useState(!1),[D,$]=g.useState(null),[U,L]=g.useState({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:"6eme",anneeScolaire:Ec()}),[B,ee]=g.useState({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:"6eme",anneeScolaire:Ec()}),[se,P]=g.useState("actif");g.useEffect(()=>{(async()=>{try{const Q=await Ji.getAll();d(Q.map(me=>({id:me.id,nom:me.nom,classe:me.classe||""})))}catch(Q){console.warn(" Impossible de charger les disciplines:",Q)}})()},[]);const q=g.useCallback(async()=>{if(t?.uid)try{p(!0),v(null);const X=await eP(t.uid);a(X);const Q=new Map;for(const me of X)if(me.statut==="actif")try{const we=await yj(me.id);Q.set(me.id,we)}catch{console.warn(`Stats indisponibles pour ${me.nom}`)}o(Q)}catch(X){console.error("Erreur chargement groupes:",X),v("Impossible de charger vos groupes. Vrifiez votre connexion.")}finally{p(!1)}},[t?.uid]);g.useEffect(()=>{q()},[q]);const F=(X,Q=!1)=>{const me=u.find(qe=>qe.id===X),we=me?`${me.nom}${me.classe?` (${me.classe})`:""}`:"";Q?ee(qe=>({...qe,matiereId:X,matiereNom:we})):L(qe=>({...qe,matiereId:X,matiereNom:we}))},R=async X=>{if(X.preventDefault(),!(!t?.uid||!U.nom.trim()||!U.matiereId))try{N(!0),await rZ(t.uid,t.displayName||t.email||"Professeur",U),L({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:"6eme",anneeScolaire:Ec()}),x(!1),$("Groupe cr avec succs !"),setTimeout(()=>$(null),3e3),await q()}catch(Q){v(Q.message||"Erreur lors de la cration du groupe.")}finally{N(!1)}},W=X=>{O(X),ee({nom:X.nom,description:X.description||"",matiereId:X.matiereId,matiereNom:X.matiereNom,classeNiveau:X.classeNiveau,anneeScolaire:X.anneeScolaire}),x(!1)},I=()=>{O(null),ee({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:"6eme",anneeScolaire:Ec()})},re=async X=>{if(X.preventDefault(),!(!A||!B.nom.trim()||!B.matiereId))try{M(!0),await tP(A.id,{nom:B.nom.trim(),description:B.description?.trim()||"",matiereId:B.matiereId,matiereNom:B.matiereNom,classeNiveau:B.classeNiveau,anneeScolaire:B.anneeScolaire}),O(null),$("Groupe modifi avec succs !"),setTimeout(()=>$(null),3e3),await q()}catch(Q){v(Q.message||"Erreur lors de la modification du groupe.")}finally{M(!1)}},V=async X=>{try{await navigator.clipboard.writeText(X),C(X),setTimeout(()=>C(null),2e3)}catch{const Q=document.createElement("textarea");Q.value=X,document.body.appendChild(Q),Q.select(),document.execCommand("copy"),document.body.removeChild(Q),C(X),setTimeout(()=>C(null),2e3)}},oe=async X=>{try{await aZ(X),S(null),await q()}catch(Q){v(Q.message)}},xe=async X=>{try{await iZ(X),await q()}catch(Q){v(Q.message)}},ve=async X=>{try{await sZ(X),await q()}catch(Q){v(Q.message)}},H=(X,Q)=>{L(me=>({...me,[X]:Q}))},he=(X,Q)=>{ee(me=>({...me,[X]:Q}))},Pe=n.filter(X=>se==="tous"?!0:X.statut===se),ue=(X,Q,me)=>r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:X,children:"Discipline / Matire *"}),r.jsxs("select",{id:X,value:Q,onChange:we=>me(we.target.value),className:"prof-select",required:!0,children:[r.jsx("option",{value:"",children:" Slectionner une discipline "}),u.map(we=>r.jsxs("option",{value:we.id,children:[we.nom,we.classe?` (${we.classe})`:""]},we.id))]}),u.length===0&&r.jsx("small",{style:{color:"#f59e0b",marginTop:"0.25rem",display:"block"},children:" Aucune discipline trouve. Crez des disciplines dans l'espace admin."})]});return f?r.jsxs("div",{className:"prof-loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement de vos groupes-classes..."})]}):r.jsxs("div",{className:"groupe-manager",children:[r.jsxs("div",{className:"groupe-manager-header",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"groupe-manager-titre",children:"Mes groupes-classes"}),r.jsxs("p",{className:"groupe-manager-subtitle",children:[n.length," groupe",n.length!==1?"s":"","  Anne ",Ec()]})]}),r.jsx("button",{className:"prof-btn prof-btn-primary",onClick:()=>{x(!b),A&&I()},children:b?" Annuler":" Nouveau groupe"})]}),h&&r.jsxs("div",{className:"prof-alert prof-alert-error",children:[r.jsx("span",{children:""})," ",h,r.jsx("button",{onClick:()=>v(null),className:"prof-alert-close",children:""})]}),D&&r.jsxs("div",{className:"prof-alert prof-alert-success",children:[r.jsx("span",{children:""})," ",D,r.jsx("button",{onClick:()=>$(null),className:"prof-alert-close",children:""})]}),b&&r.jsxs("div",{className:"groupe-form-container",children:[r.jsx("h3",{children:"Crer un nouveau groupe-classe"}),r.jsxs("form",{onSubmit:R,className:"groupe-form",children:[r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"groupe-nom",children:"Nom du groupe *"}),r.jsx("input",{id:"groupe-nom",type:"text",placeholder:"Ex: 3me A - Maths 2025",value:U.nom,onChange:X=>H("nom",X.target.value),required:!0,className:"prof-input",maxLength:60})]}),r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"groupe-desc",children:"Description (optionnelle)"}),r.jsx("input",{id:"groupe-desc",type:"text",placeholder:"Ex: Cours du mardi et jeudi matin",value:U.description||"",onChange:X=>H("description",X.target.value),className:"prof-input",maxLength:120})]}),r.jsxs("div",{className:"prof-form-row",children:[r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"groupe-niveau",children:"Niveau de classe *"}),r.jsx("select",{id:"groupe-niveau",value:U.classeNiveau,onChange:X=>H("classeNiveau",X.target.value),className:"prof-select",children:UE.map(X=>r.jsx("option",{value:X.value,children:X.label},X.value))})]}),r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"groupe-annee",children:"Anne scolaire *"}),r.jsx("select",{id:"groupe-annee",value:U.anneeScolaire,onChange:X=>H("anneeScolaire",X.target.value),className:"prof-select",children:BE.map(X=>r.jsx("option",{value:X,children:X},X))})]})]}),ue("groupe-discipline",U.matiereId,X=>F(X,!1)),r.jsx("div",{className:"prof-form-actions",children:r.jsx("button",{type:"submit",className:"prof-btn prof-btn-primary",disabled:j||!U.nom.trim()||!U.matiereId,children:j?" Cration...":" Crer le groupe"})})]})]}),A&&r.jsxs("div",{className:"groupe-form-container",style:{borderLeft:"4px solid #f59e0b"},children:[r.jsxs("h3",{children:[" Modifier le groupe : ",A.nom]}),r.jsxs("form",{onSubmit:re,className:"groupe-form",children:[r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"edit-groupe-nom",children:"Nom du groupe *"}),r.jsx("input",{id:"edit-groupe-nom",type:"text",value:B.nom,onChange:X=>he("nom",X.target.value),required:!0,className:"prof-input",maxLength:60})]}),r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"edit-groupe-desc",children:"Description (optionnelle)"}),r.jsx("input",{id:"edit-groupe-desc",type:"text",value:B.description||"",onChange:X=>he("description",X.target.value),className:"prof-input",maxLength:120})]}),r.jsxs("div",{className:"prof-form-row",children:[r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"edit-groupe-niveau",children:"Niveau de classe *"}),r.jsx("select",{id:"edit-groupe-niveau",value:B.classeNiveau,onChange:X=>he("classeNiveau",X.target.value),className:"prof-select",children:UE.map(X=>r.jsx("option",{value:X.value,children:X.label},X.value))})]}),r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"edit-groupe-annee",children:"Anne scolaire *"}),r.jsx("select",{id:"edit-groupe-annee",value:B.anneeScolaire,onChange:X=>he("anneeScolaire",X.target.value),className:"prof-select",children:BE.map(X=>r.jsx("option",{value:X,children:X},X))})]})]}),ue("edit-groupe-discipline",B.matiereId,X=>F(X,!0)),r.jsxs("div",{className:"prof-form-actions",style:{display:"flex",gap:"0.75rem"},children:[r.jsx("button",{type:"submit",className:"prof-btn prof-btn-primary",disabled:k||!B.nom.trim()||!B.matiereId,children:k?" Enregistrement...":" Enregistrer"}),r.jsx("button",{type:"button",className:"prof-btn prof-btn-secondary",onClick:I,disabled:k,children:" Annuler"})]})]})]}),r.jsxs("div",{className:"groupe-filtres",children:[r.jsxs("button",{className:`prof-filtre-btn ${se==="actif"?"active":""}`,onClick:()=>P("actif"),children:["Actifs (",n.filter(X=>X.statut==="actif").length,")"]}),r.jsxs("button",{className:`prof-filtre-btn ${se==="archive"?"active":""}`,onClick:()=>P("archive"),children:["Archivs (",n.filter(X=>X.statut==="archive").length,")"]}),r.jsxs("button",{className:`prof-filtre-btn ${se==="tous"?"active":""}`,onClick:()=>P("tous"),children:["Tous (",n.length,")"]})]}),Pe.length===0?r.jsxs("div",{className:"prof-empty-state",children:[r.jsx("div",{className:"prof-empty-icon",children:""}),r.jsx("h3",{children:se==="archive"?"Aucun groupe archiv":"Aucun groupe-classe cr"}),r.jsx("p",{children:se==="archive"?"Vos groupes archivs apparatront ici.":"Crez votre premier groupe-classe pour commencer  suivre vos lves."}),se!=="archive"&&r.jsx("button",{className:"prof-btn prof-btn-primary",onClick:()=>x(!0),children:" Crer mon premier groupe"})]}):r.jsx("div",{className:"groupe-grid",children:Pe.map(X=>{const Q=l.get(X.id),me=A?.id===X.id;return r.jsxs("div",{className:`groupe-card ${X.statut==="archive"?"groupe-card-archive":""} ${me?"groupe-card-editing":""}`,children:[r.jsxs("div",{className:"groupe-card-header",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"groupe-card-titre",children:X.nom}),r.jsx("span",{className:"groupe-card-matiere",children:X.matiereNom})]}),r.jsx("span",{className:`groupe-badge groupe-badge-${X.statut}`,children:X.statut==="actif"?" Actif":" Archiv"})]}),X.description&&r.jsx("p",{style:{color:"#6b7280",fontSize:"0.85rem",margin:"0.25rem 0 0.5rem"},children:X.description}),r.jsxs("div",{className:"groupe-card-infos",children:[r.jsxs("span",{children:[" ",X.classeNiveau]}),r.jsxs("span",{children:[" ",X.anneeScolaire]}),r.jsxs("span",{children:[" ",X.nombreInscrits," lve",X.nombreInscrits!==1?"s":""]})]}),r.jsxs("div",{className:"groupe-card-code",children:[r.jsx("span",{className:"groupe-code-label",children:"Code d'invitation :"}),r.jsxs("div",{className:"groupe-code-box",children:[r.jsx("code",{className:"groupe-code-value",children:X.codeInvitation}),r.jsx("button",{className:"prof-btn-icon",onClick:we=>{we.stopPropagation(),V(X.codeInvitation)},title:"Copier le code",children:w===X.codeInvitation?"":""}),X.statut==="actif"&&r.jsx("button",{className:"prof-btn-icon",onClick:we=>{we.stopPropagation(),ve(X.id)},title:"Rgnrer le code",children:""})]})]}),Q&&Q.nombreEleves>0&&r.jsxs("div",{className:"groupe-card-stats",children:[r.jsxs("div",{className:"groupe-stat-item",children:[r.jsx("span",{className:"groupe-stat-value",children:Q.moyenneClasse}),r.jsx("span",{className:"groupe-stat-label",children:"Moyenne"})]}),r.jsxs("div",{className:"groupe-stat-item",children:[r.jsxs("span",{className:"groupe-stat-value",children:[Q.tauxReussite,"%"]}),r.jsx("span",{className:"groupe-stat-label",children:"Russite"})]}),r.jsxs("div",{className:"groupe-stat-item",children:[r.jsx("span",{className:"groupe-stat-value",children:Q.elevesEnDifficulte}),r.jsx("span",{className:"groupe-stat-label",children:"En difficult"})]})]}),r.jsxs("div",{className:"groupe-card-actions",children:[X.statut==="actif"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"prof-btn prof-btn-primary prof-btn-sm",onClick:()=>e(X),children:" Voir dtails"}),r.jsx("button",{className:"prof-btn prof-btn-warning prof-btn-sm",onClick:()=>W(X),style:{background:"#fef3c7",color:"#92400e",border:"1px solid #fbbf24"},children:" Modifier"}),r.jsx("button",{className:"prof-btn prof-btn-secondary prof-btn-sm",onClick:()=>xe(X.id),children:" Archiver"})]}),E===X.id?r.jsxs("div",{className:"groupe-confirm-suppression",children:[r.jsx("span",{children:"Confirmer ?"}),r.jsx("button",{className:"prof-btn prof-btn-danger prof-btn-sm",onClick:()=>oe(X.id),children:"Oui, supprimer"}),r.jsx("button",{className:"prof-btn prof-btn-secondary prof-btn-sm",onClick:()=>S(null),children:"Non"})]}):r.jsx("button",{className:"prof-btn prof-btn-danger prof-btn-sm",onClick:()=>S(X.id),children:" Supprimer"})]})]},X.id)})})]})},NZ=({groupe:e,onRetour:t})=>{const[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState([]),[f,p]=g.useState([]),[h,v]=g.useState(null),[b,x]=g.useState(!0),[j,N]=g.useState(null),[w,C]=g.useState("apercu"),[E,S]=g.useState("moyenne_desc"),[A,O]=g.useState(null),[k,M]=g.useState(null),[D,$]=g.useState(!1),[U,L]=g.useState(null),B=g.useCallback(async()=>{try{x(!0),N(null);const[I,re,V]=await Promise.all([yj(e.id),uZ(e.id),mZ(e.matiereId)]);a(I),o(re),p(V);const oe=fZ(re,e.nom);d(oe)}catch(I){console.error("Erreur chargement dtail groupe:",I),N("Impossible de charger les donnes du groupe.")}finally{x(!1)}},[e.id,e.matiereId,e.nom]);g.useEffect(()=>{B()},[B]);const ee=async I=>{try{$(!0),M(I);const re=await dZ(e.id,I);v(re)}catch(re){console.error("Erreur analyse quiz:",re)}finally{$(!1)}},se=()=>{const I=pZ(l,e.nom),re=`PedaClic_${e.nom.replace(/\s+/g,"_")}_${new Date().toISOString().slice(0,10)}`;hZ(I,re)},P=async I=>{try{L(I);const V=(await fp(e.id)).find(oe=>oe.eleveId===I);V&&(await cZ(V.id,e.id),await B())}catch(re){N(re.message)}finally{L(null)}},q=[...l].sort((I,re)=>{switch(E){case"moyenne_desc":return re.moyenne-I.moyenne;case"moyenne_asc":return I.moyenne-re.moyenne;case"nom":return I.eleveNom.localeCompare(re.eleveNom);case"streak":return re.streak.actuel-I.streak.actuel;case"quiz_count":return re.totalQuiz-I.totalQuiz;default:return 0}}),F=I=>I>=16?"prof-note-excellent":I>=12?"prof-note-bien":I>=10?"prof-note-passable":I>=8?"prof-note-insuffisant":"prof-note-critique",R=I=>{switch(I){case"hausse":return"";case"baisse":return"";default:return""}},W=I=>{switch(I){case"difficulte":return"";case"inactivite":return"";case"baisse":return"";case"felicitation":return"";default:return""}};return b?r.jsxs("div",{className:"prof-loading",children:[r.jsx("div",{className:"spinner"}),r.jsxs("p",{children:['Chargement des donnes de "',e.nom,'"...']})]}):r.jsxs("div",{className:"groupe-detail",children:[r.jsxs("div",{className:"groupe-detail-header",children:[r.jsx("button",{className:"prof-btn prof-btn-secondary",onClick:t,children:" Retour aux groupes"}),r.jsxs("div",{className:"groupe-detail-titre-section",children:[r.jsx("h2",{className:"groupe-detail-titre",children:e.nom}),r.jsxs("p",{className:"groupe-detail-subtitle",children:[e.matiereNom,"  ",e.classeNiveau,"  ",e.anneeScolaire]})]}),r.jsx("button",{className:"prof-btn prof-btn-secondary",onClick:se,children:" Export CSV"})]}),j&&r.jsxs("div",{className:"prof-alert prof-alert-error",children:[" ",j,r.jsx("button",{onClick:()=>N(null),className:"prof-alert-close",children:""})]}),r.jsx("div",{className:"groupe-detail-onglets",children:[{id:"apercu",label:" Aperu",count:null},{id:"eleves",label:" lves",count:l.length},{id:"quiz",label:" Quiz",count:f.length},{id:"alertes",label:" Alertes",count:u.length}].map(I=>r.jsxs("button",{className:`groupe-onglet ${w===I.id?"active":""}`,onClick:()=>C(I.id),children:[I.label,I.count!==null&&I.count>0&&r.jsx("span",{className:"groupe-onglet-badge",children:I.count})]},I.id))}),w==="apercu"&&n&&r.jsxs("div",{className:"groupe-apercu",children:[r.jsxs("div",{className:"groupe-stats-grid",children:[r.jsxs("div",{className:"groupe-stat-card",children:[r.jsx("div",{className:"groupe-stat-card-icon",children:""}),r.jsxs("div",{className:"groupe-stat-card-content",children:[r.jsxs("span",{className:`groupe-stat-card-value ${F(n.moyenneClasse)}`,children:[n.moyenneClasse,"/20"]}),r.jsx("span",{className:"groupe-stat-card-label",children:"Moyenne classe"})]})]}),r.jsxs("div",{className:"groupe-stat-card",children:[r.jsx("div",{className:"groupe-stat-card-icon",children:""}),r.jsxs("div",{className:"groupe-stat-card-content",children:[r.jsxs("span",{className:"groupe-stat-card-value",children:[n.tauxReussite,"%"]}),r.jsx("span",{className:"groupe-stat-card-label",children:"Taux de russite"})]})]}),r.jsxs("div",{className:"groupe-stat-card",children:[r.jsx("div",{className:"groupe-stat-card-icon",children:""}),r.jsxs("div",{className:"groupe-stat-card-content",children:[r.jsx("span",{className:"groupe-stat-card-value",children:n.nombreEleves}),r.jsx("span",{className:"groupe-stat-card-label",children:"lves inscrits"})]})]}),r.jsxs("div",{className:"groupe-stat-card",children:[r.jsx("div",{className:"groupe-stat-card-icon",children:""}),r.jsxs("div",{className:"groupe-stat-card-content",children:[r.jsx("span",{className:"groupe-stat-card-value",children:n.totalQuizPasses}),r.jsx("span",{className:"groupe-stat-card-label",children:"Quiz passs"})]})]}),r.jsxs("div",{className:"groupe-stat-card",children:[r.jsx("div",{className:"groupe-stat-card-icon",children:""}),r.jsxs("div",{className:"groupe-stat-card-content",children:[r.jsxs("span",{className:"groupe-stat-card-value",children:[n.tauxParticipation,"%"]}),r.jsx("span",{className:"groupe-stat-card-label",children:"Participation"})]})]}),r.jsxs("div",{className:"groupe-stat-card",children:[r.jsx("div",{className:"groupe-stat-card-icon",children:""}),r.jsxs("div",{className:"groupe-stat-card-content",children:[r.jsx("span",{className:`groupe-stat-card-value ${n.elevesEnDifficulte>0?"prof-note-critique":"prof-note-excellent"}`,children:n.elevesEnDifficulte}),r.jsx("span",{className:"groupe-stat-card-label",children:"En difficult"})]})]})]}),r.jsx("div",{className:"groupe-apercu-notes",children:r.jsxs("div",{className:"groupe-note-range",children:[r.jsx("span",{className:"groupe-note-range-label",children:"Plage des notes :"}),r.jsxs("span",{className:"prof-note-critique",children:[n.pireNote,"/20"]}),r.jsx("div",{className:"groupe-note-barre",children:r.jsx("div",{className:"groupe-note-barre-fill",style:{left:`${n.pireNote/20*100}%`,width:`${(n.meilleureNote-n.pireNote)/20*100}%`}})}),r.jsxs("span",{className:"prof-note-excellent",children:[n.meilleureNote,"/20"]})]})}),l.length>=3&&r.jsxs("div",{className:"groupe-apercu-classement",children:[r.jsxs("div",{className:"groupe-classement-section",children:[r.jsx("h4",{children:" Top 3"}),l.slice(0,3).map((I,re)=>r.jsxs("div",{className:"groupe-classement-item",children:[r.jsx("span",{className:"groupe-classement-rang",children:re===0?"":re===1?"":""}),r.jsx("span",{className:"groupe-classement-nom",children:I.eleveNom}),r.jsxs("span",{className:`groupe-classement-note ${F(I.moyenne)}`,children:[I.moyenne,"/20"]})]},I.eleveId))]}),r.jsxs("div",{className:"groupe-classement-section",children:[r.jsx("h4",{children:"  surveiller"}),l.filter(I=>I.moyenne<8&&I.totalQuiz>0).slice(0,3).map(I=>r.jsxs("div",{className:"groupe-classement-item",children:[r.jsx("span",{className:"groupe-classement-rang",children:""}),r.jsx("span",{className:"groupe-classement-nom",children:I.eleveNom}),r.jsxs("span",{className:`groupe-classement-note ${F(I.moyenne)}`,children:[I.moyenne,"/20"]})]},I.eleveId)),l.filter(I=>I.moyenne<8&&I.totalQuiz>0).length===0&&r.jsx("p",{className:"groupe-classement-vide",children:"Aucun lve en difficult "})]})]})]}),w==="eleves"&&r.jsxs("div",{className:"groupe-eleves",children:[r.jsxs("div",{className:"groupe-eleves-toolbar",children:[r.jsx("label",{htmlFor:"tri-eleves",children:"Trier par :"}),r.jsxs("select",{id:"tri-eleves",value:E,onChange:I=>S(I.target.value),className:"prof-select prof-select-sm",children:[r.jsx("option",{value:"moyenne_desc",children:"Moyenne ()"}),r.jsx("option",{value:"moyenne_asc",children:"Moyenne ()"}),r.jsx("option",{value:"nom",children:"Nom (A-Z)"}),r.jsx("option",{value:"streak",children:"Streak ()"}),r.jsx("option",{value:"quiz_count",children:"Quiz passs ()"})]}),r.jsxs("span",{className:"groupe-eleves-count",children:[l.length," lve",l.length!==1?"s":""]})]}),l.length===0?r.jsxs("div",{className:"prof-empty-state",children:[r.jsx("div",{className:"prof-empty-icon",children:""}),r.jsx("h3",{children:"Aucun lve inscrit"}),r.jsxs("p",{children:["Partagez le code ",r.jsx("strong",{children:e.codeInvitation}),"  vos lves."]})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"groupe-eleves-table-wrapper",children:r.jsxs("table",{className:"groupe-eleves-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"#"}),r.jsx("th",{children:"lve"}),r.jsx("th",{children:"Moyenne"}),r.jsx("th",{children:"Quiz"}),r.jsx("th",{children:"Russite"}),r.jsx("th",{children:"Streak"}),r.jsx("th",{children:"Tendance"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:q.map((I,re)=>r.jsxs("tr",{className:`${A===I.eleveId?"groupe-eleve-row-active":""}`,children:[r.jsx("td",{className:"groupe-eleve-rang",children:re+1}),r.jsx("td",{className:"groupe-eleve-nom-cell",children:r.jsxs("div",{children:[r.jsx("strong",{children:I.eleveNom}),r.jsx("span",{className:"groupe-eleve-email",children:I.eleveEmail})]})}),r.jsx("td",{children:r.jsxs("span",{className:`groupe-note-badge ${F(I.moyenne)}`,children:[I.moyenne,"/20"]})}),r.jsx("td",{children:I.totalQuiz}),r.jsxs("td",{children:[I.tauxReussite,"%"]}),r.jsx("td",{children:r.jsxs("span",{className:"groupe-streak",children:[" ",I.streak.actuel,"j"]})}),r.jsxs("td",{children:[R(I.tendance)," ",I.tendance]}),r.jsxs("td",{className:"groupe-eleve-actions",children:[r.jsx("button",{className:"prof-btn-icon",onClick:()=>O(A===I.eleveId?null:I.eleveId),title:"Voir dtails",children:A===I.eleveId?"":""}),r.jsx("button",{className:"prof-btn-icon prof-btn-icon-danger",onClick:()=>P(I.eleveId),disabled:U===I.eleveId,title:"Retirer du groupe",children:U===I.eleveId?"":""})]})]},I.eleveId))})]})}),A&&(()=>{const I=l.find(re=>re.eleveId===A);return I?r.jsxs("div",{className:"groupe-eleve-detail",children:[r.jsxs("div",{className:"groupe-eleve-detail-header",children:[r.jsxs("h3",{children:[" Dtail  ",I.eleveNom]}),r.jsx("button",{className:"prof-btn-icon",onClick:()=>O(null),children:""})]}),r.jsxs("div",{className:"groupe-eleve-detail-grid",children:[r.jsxs("div",{className:"groupe-eleve-detail-card",children:[r.jsx("h4",{children:"Score global"}),r.jsx("div",{className:"groupe-eleve-score-circle",children:r.jsxs("span",{className:F(I.scoreGlobal/5),children:[I.scoreGlobal,"/100"]})})]}),r.jsxs("div",{className:"groupe-eleve-detail-card",children:[r.jsx("h4",{children:" Streak"}),r.jsxs("p",{children:["Actuel : ",r.jsxs("strong",{children:[I.streak.actuel," jour",I.streak.actuel!==1?"s":""]})]}),r.jsxs("p",{children:["Meilleur : ",I.streak.meilleur," jours"]})]}),r.jsxs("div",{className:"groupe-eleve-detail-card groupe-eleve-detail-card-wide",children:[r.jsx("h4",{children:" Lacunes dtectes"}),I.lacunes.length===0?r.jsx("p",{className:"text-muted",children:"Aucune lacune dtecte "}):r.jsx("ul",{className:"groupe-lacunes-liste",children:I.lacunes.map((re,V)=>r.jsxs("li",{className:`groupe-lacune-item groupe-lacune-${re.niveauUrgence}`,children:[r.jsxs("span",{className:"groupe-lacune-nom",children:[re.disciplineNom,re.chapitre&&`  ${re.chapitre}`]}),r.jsxs("span",{className:"groupe-lacune-moyenne",children:[re.moyenne,"/20"]}),r.jsx("span",{className:`groupe-lacune-badge groupe-lacune-badge-${re.niveauUrgence}`,children:re.niveauUrgence})]},V))})]})]})]}):null})()]})]}),w==="quiz"&&r.jsxs("div",{className:"groupe-quiz",children:[r.jsxs("div",{className:"groupe-quiz-selector",children:[r.jsx("label",{htmlFor:"select-quiz",children:"Slectionner un quiz  analyser :"}),r.jsxs("select",{id:"select-quiz",value:k||"",onChange:I=>{I.target.value&&ee(I.target.value)},className:"prof-select",children:[r.jsx("option",{value:"",children:" Choisir un quiz "}),f.map(I=>r.jsx("option",{value:I.id,children:I.titre},I.id))]})]}),!k&&r.jsxs("div",{className:"prof-empty-state",children:[r.jsx("div",{className:"prof-empty-icon",children:""}),r.jsx("h3",{children:"Analyse par quiz"}),r.jsx("p",{children:"Slectionnez un quiz pour voir les statistiques dtailles et les questions les plus rates."})]}),D&&r.jsxs("div",{className:"prof-loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Analyse en cours..."})]}),h&&!D&&r.jsxs("div",{className:"groupe-quiz-resultats",children:[r.jsxs("div",{className:"groupe-quiz-stats-header",children:[r.jsx("h3",{children:h.quizTitre}),r.jsxs("div",{className:"groupe-quiz-stats-grid",children:[r.jsxs("div",{className:"groupe-stat-mini",children:[r.jsx("span",{className:"groupe-stat-mini-value",children:h.totalPassages}),r.jsx("span",{className:"groupe-stat-mini-label",children:"Passages"})]}),r.jsxs("div",{className:"groupe-stat-mini",children:[r.jsxs("span",{className:`groupe-stat-mini-value ${F(h.moyenneScore)}`,children:[h.moyenneScore,"/20"]}),r.jsx("span",{className:"groupe-stat-mini-label",children:"Moyenne"})]}),r.jsxs("div",{className:"groupe-stat-mini",children:[r.jsxs("span",{className:"groupe-stat-mini-value",children:[h.tauxReussite,"%"]}),r.jsx("span",{className:"groupe-stat-mini-label",children:"Russite"})]}),r.jsxs("div",{className:"groupe-stat-mini",children:[r.jsxs("span",{className:"groupe-stat-mini-value",children:[Math.floor(h.tempsEcouleMoyen/60),"min"]}),r.jsx("span",{className:"groupe-stat-mini-label",children:"Temps moyen"})]})]})]}),r.jsxs("div",{className:"groupe-quiz-questions",children:[r.jsx("h4",{children:" Questions les plus rates"}),h.questionsRatees.filter(I=>I.tauxEchec>30).map((I,re)=>r.jsxs("div",{className:"groupe-quiz-question-card",children:[r.jsxs("div",{className:"groupe-quiz-question-header",children:[r.jsxs("span",{className:"groupe-quiz-question-num",children:["Q",I.questionIndex+1]}),r.jsxs("span",{className:"groupe-quiz-question-echec",children:[I.tauxEchec,"% d'chec"]})]}),r.jsx("p",{className:"groupe-quiz-question-texte",children:I.questionTexte}),r.jsx("div",{className:"groupe-quiz-question-reponse",children:r.jsxs("span",{className:"groupe-quiz-bonne-reponse",children:[" Bonne rponse : ",I.reponseCorrecte]})}),I.reponsesFrequentes.length>0&&r.jsxs("div",{className:"groupe-quiz-mauvaises-reponses",children:[r.jsx("span",{children:"Erreurs frquentes :"}),I.reponsesFrequentes.slice(0,2).map((V,oe)=>r.jsxs("span",{className:"groupe-quiz-mauvaise-reponse",children:[" ",V.reponse," (",V.nombre," lve",V.nombre>1?"s":"",")"]},oe))]})]},re)),h.questionsRatees.filter(I=>I.tauxEchec>30).length===0&&r.jsx("p",{className:"text-muted",children:"Toutes les questions ont un taux de russite suprieur  70% "})]})]})]}),w==="alertes"&&r.jsx("div",{className:"groupe-alertes",children:u.length===0?r.jsxs("div",{className:"prof-empty-state",children:[r.jsx("div",{className:"prof-empty-icon",children:""}),r.jsx("h3",{children:"Aucune alerte"}),r.jsx("p",{children:"Tous vos lves se portent bien ! Les alertes apparatront ici quand un lve aura besoin d'attention."})]}):r.jsx("div",{className:"groupe-alertes-liste",children:u.map(I=>r.jsxs("div",{className:`groupe-alerte-card groupe-alerte-${I.niveauUrgence}`,children:[r.jsxs("div",{className:"groupe-alerte-header",children:[r.jsx("span",{className:"groupe-alerte-emoji",children:W(I.type)}),r.jsx("span",{className:"groupe-alerte-eleve",children:I.eleveNom}),r.jsx("span",{className:`groupe-alerte-badge groupe-alerte-badge-${I.niveauUrgence}`,children:I.niveauUrgence})]}),r.jsx("p",{className:"groupe-alerte-message",children:I.message}),r.jsx("button",{className:"prof-btn prof-btn-secondary prof-btn-sm",onClick:()=>{C("eleves"),O(I.eleveId)},children:" Voir dtail"})]},I.id))})})]})},_Z=()=>{const{currentUser:e}=Ze(),t=lt(),[n,a]=g.useState("overview"),[l,o]=g.useState(null),[u,d]=g.useState(0),[f,p]=g.useState(0),[h,v]=g.useState(0),[b,x]=g.useState(0),[j,N]=g.useState([]),[w,C]=g.useState(!0),E=g.useCallback(async()=>{if(e?.uid)try{C(!0);const k=(await eP(e.uid)).filter(B=>B.statut==="actif");d(k.length);let M=0,D=0,$=0,U=0;const L=[];for(const B of k)try{const ee=await yj(B.id);M+=ee.nombreEleves,ee.nombreEleves>0&&(D+=ee.moyenneClasse,$++),U+=ee.elevesEnDifficulte,L.push({...B,stats:ee})}catch{L.push({...B})}p(M),v($>0?Math.round(D/$*10)/10:0),x(U),N(L)}catch(O){console.error("Erreur chargement rsum prof:",O)}finally{C(!1)}},[e?.uid]);g.useEffect(()=>{E()},[E]);const S=O=>{o(O),a("detail")},A=()=>{o(null),a("groupes"),E()};return w?r.jsxs("div",{className:"prof-loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement de votre espace professeur..."})]}):r.jsxs("div",{className:"prof-dashboard",children:[r.jsx("header",{className:"prof-dashboard-header",children:r.jsxs("div",{children:[r.jsx("h1",{className:"prof-dashboard-titre",children:"Tableau de bord Professeur"}),r.jsxs("p",{className:"prof-dashboard-subtitle",children:["Bienvenue, ",e?.displayName||"Professeur"," "]})]})}),n!=="detail"&&r.jsxs("nav",{className:"prof-nav",children:[r.jsx("button",{className:`prof-nav-btn ${n==="overview"?"active":""}`,onClick:()=>a("overview"),children:" Vue d'ensemble"}),r.jsx("button",{className:`prof-nav-btn ${n==="groupes"?"active":""}`,onClick:()=>a("groupes"),children:" Mes groupes-classes"}),r.jsx("button",{className:"prof-nav-btn",onClick:()=>t("/prof/cahiers"),children:" Cahier de textes"}),r.jsx("button",{className:"prof-nav-btn",onClick:()=>t("/prof/sequences"),children:" Squences pdagogiques"}),r.jsx("button",{className:"prof-nav-btn",onClick:()=>t("/prof/cours"),children:" Cours en ligne"})]}),n==="overview"&&r.jsxs("div",{className:"prof-overview",children:[r.jsxs("div",{className:"prof-overview-cards",children:[r.jsxs("div",{className:"prof-overview-card prof-overview-card-clickable",onClick:()=>a("groupes"),children:[r.jsx("div",{className:"prof-overview-card-icon",children:""}),r.jsxs("div",{className:"prof-overview-card-content",children:[r.jsx("span",{className:"prof-overview-card-value",children:u}),r.jsxs("span",{className:"prof-overview-card-label",children:["Groupe",u!==1?"s":""," actif",u!==1?"s":""]})]})]}),r.jsxs("div",{className:"prof-overview-card",children:[r.jsx("div",{className:"prof-overview-card-icon",children:""}),r.jsxs("div",{className:"prof-overview-card-content",children:[r.jsx("span",{className:"prof-overview-card-value",children:f}),r.jsxs("span",{className:"prof-overview-card-label",children:["lve",f!==1?"s":""," inscrit",f!==1?"s":""]})]})]}),r.jsxs("div",{className:"prof-overview-card",children:[r.jsx("div",{className:"prof-overview-card-icon",children:""}),r.jsxs("div",{className:"prof-overview-card-content",children:[r.jsxs("span",{className:"prof-overview-card-value",children:[h,"/20"]}),r.jsx("span",{className:"prof-overview-card-label",children:"Moyenne gnrale"})]})]}),r.jsxs("div",{className:"prof-overview-card",children:[r.jsx("div",{className:"prof-overview-card-icon",children:""}),r.jsxs("div",{className:"prof-overview-card-content",children:[r.jsx("span",{className:`prof-overview-card-value ${b>0?"prof-note-critique":""}`,children:b}),r.jsxs("span",{className:"prof-overview-card-label",children:["lve",b!==1?"s":""," en difficult"]})]})]})]}),j.length===0?r.jsxs("div",{className:"prof-empty-state",children:[r.jsx("div",{className:"prof-empty-icon",children:""}),r.jsx("h3",{children:"Bienvenue sur votre espace Professeur !"}),r.jsx("p",{children:"Crez votre premier groupe-classe pour commencer  suivre vos lves."}),r.jsx("button",{className:"prof-btn prof-btn-primary",onClick:()=>a("groupes"),children:" Crer un groupe-classe"})]}):r.jsxs("div",{className:"prof-overview-groupes",children:[r.jsx("h2",{children:"Mes groupes"}),r.jsx("div",{className:"prof-overview-groupes-grid",children:j.map(O=>r.jsxs("div",{className:"prof-overview-groupe-card",onClick:()=>S(O),children:[r.jsxs("div",{className:"prof-overview-groupe-header",children:[r.jsx("h3",{children:O.nom}),r.jsx("span",{className:"prof-overview-groupe-matiere",children:O.matiereNom})]}),O.stats&&r.jsxs("div",{className:"prof-overview-groupe-stats",children:[r.jsxs("div",{children:[r.jsx("span",{className:"prof-overview-groupe-stat-value",children:O.stats.nombreEleves}),r.jsx("span",{className:"prof-overview-groupe-stat-label",children:"lves"})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"prof-overview-groupe-stat-value",children:[O.stats.moyenneClasse,"/20"]}),r.jsx("span",{className:"prof-overview-groupe-stat-label",children:"Moyenne"})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"prof-overview-groupe-stat-value",children:[O.stats.tauxReussite,"%"]}),r.jsx("span",{className:"prof-overview-groupe-stat-label",children:"Russite"})]})]}),r.jsx("span",{className:"prof-overview-groupe-arrow",children:""})]},O.id))})]})]}),n==="groupes"&&r.jsx(jZ,{onSelectGroupe:S}),n==="detail"&&l&&r.jsx(NZ,{groupe:l,onRetour:A})]})},rs="cahiers_textes",ta="entrees_cahier",SZ="groupes_prof",wZ="ebooks";async function CZ(e,t){const n=[Se("profId","==",e),Ve("updatedAt","desc")],a=Ee(je(K,rs),...n);return(await Ce(a)).docs.map(o=>({groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...o.data(),id:o.id}))}const rP=e=>CZ(e);async function EZ(){const e=Ee(je(K,rs),Ve("updatedAt","desc"),ar(100));return(await Ce(e)).docs.map(n=>({groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...n.data(),id:n.id}))}function AZ(e,t,n,a){const l=[Se("profId","==",e),Ve("updatedAt","desc")];t&&l.splice(1,0,Se("anneeScolaire","==",t));const o=Ee(je(K,rs),...l);return xf(o,u=>{n(u.docs.map(d=>({groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...d.data(),id:d.id})))},a)}async function nP(e){const t=await Dt(Ne(K,rs,e));return t.exists()?{groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...t.data(),id:t.id}:null}const aP=e=>qZ(e);async function zZ(e){const t=await Dt(Ne(K,ta,e));return t.exists()?{id:t.id,...t.data()}:null}async function kZ(e,t,n,a){const l=`${Date.now()}_${n.name}`,o=`cahiers/${e}/${t}/${l}`,u=Lr(Dr,o),d=Mb(u,n);return new Promise((f,p)=>{d.on("state_changed",h=>{},p,async()=>{const h=await pa(d.snapshot.ref);f({id:l,nom:n.name,url:h,type:n.type,taille:n.size,mimeType:n.type,uploadedAt:new Date().toISOString()})})})}async function FE(e,t,n){await Qe(Ne(K,ta,e),{piecesJointes:Db(...n),updatedAt:Oe.now()})}async function OZ(e,t,n){const a=t.find(l=>l.url===n);try{a?.id&&await Pc(Lr(Dr,`cahiers/${a.id}`))}catch{}a&&await Qe(Ne(K,ta,e),{piecesJointes:Qq(a),updatedAt:Oe.now()})}async function DZ(e,t){const n=Oe.now(),a=t.titre?.trim()||`${t.matiere} ${t.classe} ${t.anneeScolaire}`;return(await qt(je(K,rs),{profId:e,titre:a,matiere:t.matiere,classe:t.classe,anneeScolaire:t.anneeScolaire,description:t.description||"",couleur:t.couleur,nombreSeancesPrevu:t.nombreSeancesPrevu,nombreSeancesRealise:0,isArchived:!1,groupeIds:t.groupeIds??[],groupeNoms:t.groupeNoms??[],isPartage:t.isPartage??!1,createdAt:n,updatedAt:n})).id}async function ff(e,t){const n={...t};if("matiere"in t&&"classe"in t&&!("id"in t)){const a=t;a.titre?.trim()||(n.titre=`${a.matiere} ${a.classe} ${a.anneeScolaire}`)}await Qe(Ne(K,rs,e),{...n,updatedAt:Oe.now()})}async function MZ(e){await rn(Ne(K,rs,e))}async function PZ(e){const t=await Dt(Ne(K,rs,e));if(!t.exists())return null;const n=t.data();return n.isPartage?{id:t.id,...n}:null}async function iP(e){const t=Ee(je(K,SZ),Se("profId","==",e),Ve("nom","asc"));return(await Ce(t)).docs.map(a=>({id:a.id,...a.data()}))}async function TZ(){return(await Ce(je(K,wZ))).docs.map(t=>({id:t.id,...t.data()}))}async function qZ(e){const t=Ee(je(K,ta),Se("cahierId","==",e),Ve("ordre","asc"));return(await Ce(t)).docs.map(a=>({id:a.id,...a.data()}))}const RZ=async(e,t,n)=>{const a=Oe.fromDate(new Date(t,n,1)),l=Oe.fromDate(new Date(t,n+1,0,23,59,59)),o=Ee(je(K,ta),Se("cahierId","==",e),Se("date",">=",a),Se("date","<=",l),Ve("date","asc"));return(await Ce(o)).docs.map(d=>({id:d.id,...d.data()}))},IZ=async(e,t)=>{const n=[Se("profId","==",e),Se("isMarqueEvaluation","==",!0),Ve("date","desc")];t&&n.unshift(Se("cahierId","==",t));const a=Ee(je(K,ta),...n);return(await Ce(a)).docs.map(o=>({id:o.id,...o.data()}))},LZ=async e=>{const n=(await Ce(Ee(je(K,ta),Se("cahierId","==",e)))).docs.map(u=>u.data()),a=n.length,l={realise:0,planifie:0,annule:0,reporte:0},o={};for(const u of n){const d=u.statut;d in l&&l[d]++,u.typeContenu&&(o[u.typeContenu]=(o[u.typeContenu]??0)+1)}return{total:a,...l,parType:o,tauxRealisation:a>0?Math.round(l.realise/a*100):0}};async function $Z(e){const t=Ee(je(K,ta),Se("cahierId","==",e),Se("statut","==","realise"),Ve("date","desc"));return(await Ce(t)).docs.map(a=>({id:a.id,...a.data()}))}async function BZ(e,t,n){const a=Oe.now();let l;if(typeof e=="string"){const u=n;l={cahierId:e,profId:t,date:Oe.fromDate(new Date(u.date)),heureDebut:u.heureDebut||"",heureFin:u.heureFin||"",chapitre:u.chapitre,typeContenu:u.typeContenu,contenu:u.contenu,objectifs:u.objectifs||"",competences:u.competences||[],statut:u.statut,motifAnnulation:u.motifAnnulation||"",dateReport:u.dateReport?Oe.fromDate(new Date(u.dateReport)):null,notesPrivees:u.notesPrivees||"",isMarqueEvaluation:u.isMarqueEvaluation,typeEvaluation:u.typeEvaluation||null,dateEvaluationPrevue:u.dateEvaluationPrevue?Oe.fromDate(new Date(u.dateEvaluationPrevue)):null,statutEvaluation:u.statutEvaluation,ordre:Date.now(),piecesJointes:[],liens:[],ebooksLies:[],contenuIA:[]}}else l={liens:[],ebooksLies:[],piecesJointes:[],contenuIA:[],...e};return(await qt(je(K,ta),{...l,createdAt:a,updatedAt:a})).id}async function Rc(e,t,n){let a;if(typeof t=="string"&&n){const l=n;a={date:Oe.fromDate(new Date(l.date)),heureDebut:l.heureDebut||"",heureFin:l.heureFin||"",chapitre:l.chapitre,typeContenu:l.typeContenu,contenu:l.contenu,objectifs:l.objectifs||"",competences:l.competences||[],statut:l.statut,motifAnnulation:l.motifAnnulation||"",dateReport:l.dateReport?Oe.fromDate(new Date(l.dateReport)):null,notesPrivees:l.notesPrivees||"",isMarqueEvaluation:l.isMarqueEvaluation,typeEvaluation:l.typeEvaluation||null,dateEvaluationPrevue:l.dateEvaluationPrevue?Oe.fromDate(new Date(l.dateEvaluationPrevue)):null,statutEvaluation:l.statutEvaluation}}else a={...t};await Qe(Ne(K,ta,e),{...a,updatedAt:Oe.now()})}async function UZ(e){await rn(Ne(K,ta,e))}const GE=()=>({classe:"3me",matiere:"Mathmatiques",anneeScolaire:"2025-2026",titre:"",description:"",couleur:"#2563eb",nombreSeancesPrevu:30,groupeIds:[],groupeNoms:[],isPartage:!1}),FZ=()=>{const{currentUser:e}=Ze(),t=lt(),[n]=aA(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,f]=g.useState("2025-2026"),[p,h]=g.useState(!1),[v,b]=g.useState(null),[x,j]=g.useState(GE()),[N,w]=g.useState(!1),[C,E]=g.useState(""),{matieres:S,loading:A}=Zs(),[O,k]=g.useState([]),[M,D]=g.useState([]);if(!e?.isPremium&&e?.role!=="admin")return r.jsx("div",{className:"cahier-textes-page",children:r.jsxs("div",{className:"premium-gate",children:[r.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),r.jsx("h2",{children:"Cahier de Textes Numrique"}),r.jsxs("p",{children:["Cette fonctionnalit est rserve aux enseignants Premium.",r.jsx("br",{}),"Passez au Premium pour organiser, planifier et suivre votre enseignement."]}),r.jsx("button",{className:"btn-primary",onClick:()=>t("/premium"),children:" Passer au Premium  2 000 FCFA/mois"})]})});g.useEffect(()=>{if(!e?.uid)return;u(!0);const P=AZ(e.uid,d||void 0,q=>{l(q),u(!1)},q=>{console.error("Erreur chargement cahiers:",q),u(!1)});return()=>P()},[e?.uid,d]),g.useEffect(()=>{if(!e?.uid)return;iP(e.uid).then(k).catch(R=>console.error("Erreur chargement groupes:",R));const P=n.get("groupeId"),q=n.get("groupeNom"),F=n.get("classe");P&&q&&(D([P]),j(R=>({...R,classe:F||R.classe,groupeIds:[P],groupeNoms:[q]})),b(null),E(""),h(!0))},[e?.uid]);const $=()=>{b(null),j(GE()),D([]),E(""),h(!0)},U=(P,q)=>{q.stopPropagation(),b(P),D(P.groupeIds??[]),j({classe:P.classe,matiere:P.matiere,anneeScolaire:P.anneeScolaire,titre:P.titre,description:P.description||"",couleur:P.couleur,nombreSeancesPrevu:P.nombreSeancesPrevu,groupeIds:P.groupeIds??[],groupeNoms:P.groupeNoms??[],isPartage:P.isPartage??!1}),E(""),h(!0)},L=P=>{D(q=>{const F=q.includes(P)?q.filter(W=>W!==P):[...q,P],R=F.map(W=>O.find(I=>I.id===W)?.nom??"").filter(Boolean);return j(W=>({...W,groupeIds:F,groupeNoms:R})),F})},B=async P=>{if(P.preventDefault(),!!e?.uid){w(!0),E("");try{v?await ff(v.id,x):await DZ(e.uid,x),h(!1)}catch(q){const F=q instanceof Error?q.message:String(q);E("Erreur : "+F)}finally{w(!1)}}},ee=async(P,q)=>{if(q.stopPropagation(),!!confirm(`Supprimer le cahier "${P.titre}" et toutes ses entres ?`))try{await MZ(P.id),l(F=>F.filter(R=>R.id!==P.id))}catch{alert("Erreur lors de la suppression.")}},se=P=>P.nombreSeancesPrevu>0?Math.min(100,Math.round(P.nombreSeancesRealise/P.nombreSeancesPrevu*100)):0;return r.jsxs("div",{className:"cahier-textes-page",children:[r.jsxs("div",{className:"cahier-page-header",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"cahier-page-title",children:" Cahier de Textes"}),r.jsx("p",{className:"cahier-page-subtitle",children:"Organisez et planifiez votre enseignement"})]}),r.jsx("button",{className:"btn-primary",onClick:$,children:"+ Nouveau cahier"})]}),r.jsxs("div",{className:"cahier-filtres",children:[r.jsx("label",{style:{fontSize:"0.85rem",color:"#6b7280",fontWeight:600},children:"Anne scolaire :"}),r.jsxs("select",{className:"filtre-select",value:d,onChange:P=>f(P.target.value),children:[r.jsx("option",{value:"",children:"Toutes les annes"}),P1.map(P=>r.jsx("option",{value:P,children:P},P))]})]}),o?r.jsx("div",{className:"loading-spinner",children:r.jsx("div",{className:"spinner-circle"})}):a.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{style:{fontSize:"3rem",opacity:.3,marginBottom:"0.75rem"},children:""}),r.jsxs("h3",{children:["Aucun cahier pour ",d||"cette priode"]}),r.jsx("p",{children:"Crez votre premier cahier de textes pour commencer  planifier votre enseignement."}),r.jsx("button",{className:"btn-primary",onClick:$,style:{marginTop:"1rem"},children:"+ Crer mon premier cahier"})]}):r.jsx("div",{className:"cahiers-grid",children:a.map(P=>{const q=se(P);return r.jsxs("div",{className:"cahier-card",onClick:()=>t(`/prof/cahiers/${P.id}`),children:[r.jsx("div",{style:{height:4,background:P.couleur,borderRadius:"12px 12px 0 0"}}),r.jsx("div",{className:"cahier-card-header",children:r.jsxs("div",{style:{flex:1},children:[r.jsx("h3",{className:"cahier-card-titre",children:P.titre}),r.jsxs("div",{className:"cahier-card-meta",children:[r.jsx("span",{className:"badge-classe",children:P.classe}),r.jsx("span",{className:"badge-matiere",children:P.matiere}),r.jsx("span",{className:"badge-annee",children:P.anneeScolaire})]}),(P.groupeIds?.length??0)>0&&r.jsxs("span",{className:`badge-partage ${P.isPartage?"actif":""}`,style:{marginTop:6,display:"inline-flex"},children:[P.isPartage?" Partag avec":" Li "," ",P.groupeIds.length," groupe",P.groupeIds.length>1?"s":""]})]})}),r.jsxs("div",{className:"cahier-card-body",children:[P.description&&r.jsxs("p",{style:{fontSize:"0.82rem",color:"#6b7280",margin:"0 0 0.75rem",lineHeight:1.5},children:[P.description.substring(0,80),P.description.length>80?"...":""]}),r.jsxs("div",{className:"progression-bar-wrap",children:[r.jsxs("div",{className:"progression-label",children:[r.jsx("span",{children:"Progression"}),r.jsxs("span",{style:{fontWeight:700,color:P.couleur},children:[q,"%"]})]}),r.jsx("div",{className:"progression-bar-bg",children:r.jsx("div",{className:"progression-bar-fill",style:{width:`${q}%`,background:P.couleur}})}),r.jsxs("div",{style:{fontSize:"0.72rem",color:"#9ca3af",marginTop:"0.3rem"},children:[P.nombreSeancesRealise," / ",P.nombreSeancesPrevu," sances ralises"]})]})]}),r.jsxs("div",{className:"cahier-card-footer",children:[r.jsxs("span",{style:{fontSize:"0.75rem",color:"#9ca3af"},children:["Mis  jour le ",P.updatedAt?.toDate().toLocaleDateString("fr-FR")||""]}),r.jsxs("div",{className:"cahier-actions",children:[r.jsx("button",{className:"btn-icon",onClick:F=>U(P,F),title:"Modifier",children:""}),r.jsx("button",{className:"btn-icon",onClick:F=>ee(P,F),title:"Supprimer",style:{color:"#ef4444"},children:""})]})]})]},P.id)})}),p&&r.jsx("div",{className:"modal-overlay",onClick:()=>h(!1),children:r.jsxs("div",{className:"modal-content",onClick:P=>P.stopPropagation(),children:[r.jsxs("h2",{className:"modal-title",children:[" ",v?"Modifier le cahier":"Nouveau cahier de textes"]}),r.jsxs("form",{onSubmit:B,children:[r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Classe *"}),r.jsx("select",{className:"form-select",value:x.classe,onChange:P=>j(q=>({...q,classe:P.target.value})),required:!0,children:Xs.map(P=>r.jsx("option",{value:P,children:P},P))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Matire *"}),r.jsxs("select",{className:"form-select",value:x.matiere,onChange:P=>j(q=>({...q,matiere:P.target.value})),required:!0,disabled:A,children:[r.jsx("option",{value:"",children:A?"Chargement":" Slectionner "}),S.map(P=>r.jsx("option",{value:P.valeur,children:P.label},P.valeur)),x.matiere&&!S.find(P=>P.valeur===x.matiere)&&r.jsx("option",{value:x.matiere,children:x.matiere})]})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Anne scolaire *"}),r.jsx("select",{className:"form-select",value:x.anneeScolaire,onChange:P=>j(q=>({...q,anneeScolaire:P.target.value})),children:P1.map(P=>r.jsx("option",{value:P,children:P},P))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Titre personnalis"}),r.jsx("input",{className:"form-input",placeholder:`Ex: Maths 3me A - ${x.anneeScolaire}`,value:x.titre,onChange:P=>j(q=>({...q,titre:P.target.value}))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Nombre de sances prvues"}),r.jsx("input",{type:"number",className:"form-input",min:"1",max:"200",value:x.nombreSeancesPrevu,onChange:P=>j(q=>({...q,nombreSeancesPrevu:Number(P.target.value)}))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Description / Objectifs (optionnel)"}),r.jsx("textarea",{className:"form-textarea",placeholder:"Objectifs gnraux, groupe classe, notes...",value:x.description,onChange:P=>j(q=>({...q,description:P.target.value})),rows:2})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Couleur du cahier"}),r.jsx("div",{className:"couleur-picker",children:A5.map(P=>r.jsx("div",{className:`couleur-option ${x.couleur===P?"selected":""}`,style:{background:P},onClick:()=>j(q=>({...q,couleur:P})),title:P},P))})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{className:"form-label",children:["Groupes classes lis"," ",r.jsx("span",{style:{fontWeight:400,color:"#9ca3af"},children:"(optionnel)"})]}),O.length===0?r.jsxs("p",{style:{fontSize:"0.82rem",color:"#9ca3af",margin:0},children:["Aucun groupe cr."," ",r.jsx("button",{type:"button",style:{background:"none",border:"none",color:"#2563eb",cursor:"pointer",padding:0,fontSize:"0.82rem"},onClick:()=>t("/prof/groupes"),children:"Crer un groupe "})]}):r.jsx("div",{className:"groupe-selector",children:O.map(P=>{const q=M.includes(P.id);return r.jsxs("div",{className:`groupe-option ${q?"selected":""}`,onClick:()=>L(P.id),children:[r.jsx("input",{type:"checkbox",checked:q,readOnly:!0,tabIndex:-1}),r.jsxs("span",{children:[r.jsx("strong",{children:P.nom}),"  ",P.classe," (",P.anneeScolaire,")"]})]},P.id)})}),M.length>0&&r.jsx("div",{className:"groupes-tags",children:M.map(P=>{const q=O.find(F=>F.id===P);return q?r.jsxs("span",{className:"groupe-tag",children:[q.nom,r.jsx("button",{type:"button",onClick:()=>L(P),"aria-label":`Retirer ${q.nom}`,children:""})]},P):null})}),M.length>0&&r.jsxs("label",{className:"toggle-partage",style:{marginTop:10},children:[r.jsx("input",{type:"checkbox",checked:x.isPartage??!1,onChange:P=>j(q=>({...q,isPartage:P.target.checked}))}),r.jsx("span",{children:" Rendre visible aux lves des groupes lis"})]})]}),C&&r.jsx("div",{style:{color:"#dc2626",fontSize:"0.85rem",marginBottom:"0.75rem",background:"#fee2e2",padding:"0.5rem 0.75rem",borderRadius:8},children:C}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>h(!1),children:"Annuler"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:N,children:N?"Enregistrement...":v?"Mettre  jour":"Crer le cahier"})]})]})]})})]})},GZ=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],HZ=["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],QZ=(e,t,n)=>{const a=new Date(e,t,1),l=new Date(e,t+1,0);let o=a.getDay()-1;o<0&&(o=6);const u=new Date,d=[];for(let p=o-1;p>=0;p--){const h=new Date(e,t,-p);d.push({date:h,isCurrentMonth:!1,isToday:!1,entrees:[]})}for(let p=1;p<=l.getDate();p++){const h=new Date(e,t,p),v=h.toDateString()===u.toDateString(),b=n.filter(x=>{const j=x.date.toDate();return j.getFullYear()===e&&j.getMonth()===t&&j.getDate()===p});d.push({date:h,isCurrentMonth:!0,isToday:v,entrees:b})}let f=1;for(;d.length<42;){const p=new Date(e,t+1,f++);d.push({date:p,isCurrentMonth:!1,isToday:!1,entrees:[]})}return d},VZ=({cahierId:e})=>{const t=lt(),n=new Date,[a,l]=g.useState(n.getFullYear()),[o,u]=g.useState(n.getMonth()),[d,f]=g.useState([]),[p,h]=g.useState(!1),[v,b]=g.useState(null),[x,j]=g.useState({x:0,y:0});g.useEffect(()=>{(async()=>{h(!0);try{const A=await RZ(e,a,o);f(A)}catch(A){console.error("Erreur chargement entres calendrier:",A)}finally{h(!1)}})()},[e,a,o]);const N=QZ(a,o,d),w=()=>{o===0?(l(S=>S-1),u(11)):u(S=>S-1)},C=()=>{o===11?(l(S=>S+1),u(0)):u(S=>S+1)},E=(S,A)=>{if(!S.isCurrentMonth||S.entrees.length===0)return;const O=A.target.getBoundingClientRect();j({x:O.left,y:O.bottom+window.scrollY+8}),b(S)};return r.jsxs("div",{className:"cahier-calendar",onClick:()=>b(null),children:[r.jsxs("div",{className:"calendar-nav",children:[r.jsx("button",{className:"calendar-nav-btn",onClick:w,"aria-label":"Mois prcdent",children:""}),r.jsxs("span",{className:"calendar-nav-title",children:[HZ[o]," ",a,p&&" ..."]}),r.jsx("button",{className:"calendar-nav-btn",onClick:C,"aria-label":"Mois suivant",children:""})]}),r.jsx("div",{className:"calendar-weekdays",children:GZ.map(S=>r.jsx("div",{className:"calendar-weekday",children:S},S))}),r.jsx("div",{className:"calendar-grid",onClick:S=>S.stopPropagation(),children:N.map((S,A)=>r.jsxs("div",{className:`calendar-day ${S.isCurrentMonth?"":"other-month"} ${S.isToday?"today":""} ${v?.date.toDateString()===S.date.toDateString()?"selected":""}`,onClick:O=>E(S,O),children:[r.jsx("div",{className:"calendar-day-num",children:S.date.getDate()}),r.jsxs("div",{className:"calendar-day-events",children:[S.entrees.slice(0,3).map(O=>{const k=Hi[O.typeContenu];return r.jsxs("div",{className:"calendar-event-dot",style:{background:k.color},title:O.chapitre,children:[k.emoji," ",O.chapitre.substring(0,12)]},O.id)}),S.entrees.length>3&&r.jsxs("div",{className:"calendar-more",children:["+",S.entrees.length-3]})]})]},A))}),r.jsx("div",{className:"calendar-legend",children:Object.entries(Hi).slice(0,5).map(([S,A])=>r.jsxs("div",{className:"legend-item",children:[r.jsx("div",{className:"legend-dot",style:{background:A.color}}),A.label]},S))}),v&&v.entrees.length>0&&r.jsxs("div",{className:"calendar-day-popup",style:{top:x.y,left:Math.min(x.x,window.innerWidth-300)},onClick:S=>S.stopPropagation(),children:[r.jsxs("div",{className:"calendar-day-popup-title",children:[" ",v.date.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"})]}),v.entrees.map(S=>{const A=Hi[S.typeContenu];return r.jsxs("div",{className:"calendar-popup-entree",onClick:()=>t(`/prof/cahiers/${e}/modifier/${S.id}`),children:[r.jsx("span",{className:"calendar-popup-entree-type",children:A.emoji}),r.jsxs("div",{className:"calendar-popup-entree-info",children:[r.jsx("div",{className:"calendar-popup-entree-chapitre",children:S.chapitre}),S.heureDebut&&r.jsxs("div",{className:"calendar-popup-entree-heure",children:[S.heureDebut,S.heureFin?`  ${S.heureFin}`:""]})]})]},S.id)})]})]})},pp="rappels_prof",YZ=async(e,t)=>(await qt(je(K,pp),{profId:e,titre:t.titre,description:t.description||"",typeRappel:t.typeRappel,dateRappel:Oe.fromDate(new Date(t.dateRappel)),recurrence:t.recurrence,priorite:t.priorite,cahierId:t.cahierId||null,isLu:!1,isDone:!1,createdAt:Oe.now()})).id,KZ=async e=>{const t=Ee(je(K,pp),Se("profId","==",e),Se("isDone","==",!1),Ve("dateRappel","asc"));return(await Ce(t)).docs.map(a=>({id:a.id,...a.data()}))},WZ=async(e,t)=>{await Qe(Ne(K,pp,e),{isDone:t,isLu:t})},XZ=async e=>{await rn(Ne(K,pp,e))},HE=()=>({titre:"",description:"",typeRappel:"personnalise",dateRappel:new Date(Date.now()+36e5).toISOString().slice(0,16),recurrence:"unique",priorite:"normale"}),tm=({profId:e,cahierId:t})=>{const[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(!1),[f,p]=g.useState(HE()),[h,v]=g.useState(!1),b=async()=>{try{o(!0);const S=await KZ(e);a(S)}catch(S){console.error("Erreur rappels:",S)}finally{o(!1)}};g.useEffect(()=>{b()},[e]);const x=async S=>{if(S.preventDefault(),!!f.titre.trim()){v(!0);try{await YZ(e,{...f,cahierId:t}),d(!1),p(HE()),await b()}catch(A){console.error("Erreur cration rappel:",A)}finally{v(!1)}}},j=async S=>{await WZ(S,!0),a(A=>A.filter(O=>O.id!==S))},N=async S=>{confirm("Supprimer ce rappel ?")&&(await XZ(S),a(A=>A.filter(O=>O.id!==S)))},w=new Date,C=n.filter(S=>S.dateRappel.toDate()<=w),E=n.filter(S=>S.dateRappel.toDate()>w);return r.jsxs("div",{style:{background:"white",borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",overflow:"hidden"},children:[r.jsxs("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid #f3f4f6",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.jsx("span",{style:{fontSize:"1.1rem"},children:""}),r.jsx("span",{style:{fontWeight:700,fontSize:"0.95rem",color:"#1f2937"},children:"Rappels"}),C.length>0&&r.jsx("span",{style:{background:"#dc2626",color:"white",borderRadius:20,padding:"1px 7px",fontSize:"0.7rem",fontWeight:700},children:C.length})]}),r.jsx("button",{className:"btn-primary",style:{padding:"0.35rem 0.75rem",fontSize:"0.8rem"},onClick:()=>d(S=>!S),children:"+ Ajouter"})]}),u&&r.jsxs("form",{onSubmit:x,style:{padding:"1rem 1.25rem",borderBottom:"1px solid #f3f4f6",background:"#f9fafb"},children:[r.jsx("div",{className:"form-group",children:r.jsx("input",{className:"form-input",placeholder:"Titre du rappel *",value:f.titre,onChange:S=>p(A=>({...A,titre:S.target.value})),required:!0})}),r.jsx("div",{className:"form-group",children:r.jsx("select",{className:"form-select",value:f.typeRappel,onChange:S=>p(A=>({...A,typeRappel:S.target.value})),children:Object.entries(CA).map(([S,A])=>r.jsxs("option",{value:S,children:[A.emoji," ",A.label]},S))})}),r.jsx("div",{className:"form-group",children:r.jsx("input",{type:"datetime-local",className:"form-input",value:f.dateRappel,onChange:S=>p(A=>({...A,dateRappel:S.target.value})),required:!0})}),r.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[r.jsxs("select",{className:"form-select",value:f.priorite,onChange:S=>p(A=>({...A,priorite:S.target.value})),children:[r.jsx("option",{value:"normale",children:"Normale"}),r.jsx("option",{value:"urgente",children:" Urgente"})]}),r.jsxs("select",{className:"form-select",value:f.recurrence,onChange:S=>p(A=>({...A,recurrence:S.target.value})),children:[r.jsx("option",{value:"unique",children:"Une fois"}),r.jsx("option",{value:"hebdomadaire",children:"Hebdo"})]})]}),r.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.75rem"},children:[r.jsx("button",{type:"submit",className:"btn-primary",disabled:h,style:{flex:1},children:h?"...":"Enregistrer"}),r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>d(!1),children:"Annuler"})]})]}),r.jsx("div",{style:{padding:"0.75rem 1.25rem"},children:l?r.jsx("div",{style:{textAlign:"center",color:"#9ca3af",padding:"1rem",fontSize:"0.85rem"},children:"Chargement..."}):n.length===0?r.jsxs("div",{style:{textAlign:"center",color:"#9ca3af",padding:"1rem",fontSize:"0.85rem"},children:[r.jsx("div",{children:""}),r.jsx("div",{children:"Aucun rappel actif"})]}):r.jsxs(r.Fragment,{children:[C.length>0&&r.jsxs("div",{style:{marginBottom:"0.75rem"},children:[r.jsx("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"#dc2626",textTransform:"uppercase",marginBottom:"0.4rem"},children:" En retard"}),C.map(S=>r.jsx(QE,{rappel:S,onDone:j,onDelete:N},S.id))]}),E.length>0&&r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"#6b7280",textTransform:"uppercase",marginBottom:"0.4rem"},children:" venir"}),E.slice(0,5).map(S=>r.jsx(QE,{rappel:S,onDone:j,onDelete:N},S.id))]})]})})]})},QE=({rappel:e,onDone:t,onDelete:n})=>{const a=CA[e.typeRappel],l=e.dateRappel.toDate(),o=e.priorite==="urgente",u=l<=new Date;return r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem",padding:"0.5rem 0",borderBottom:"1px solid #f9fafb"},children:[r.jsx("button",{onClick:()=>t(e.id),style:{width:20,height:20,border:`2px solid ${o?"#dc2626":"#d1d5db"}`,borderRadius:4,background:"white",cursor:"pointer",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",marginTop:2},title:"Marquer termin"}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsxs("div",{style:{fontSize:"0.82rem",fontWeight:600,color:u?"#dc2626":"#1f2937",display:"flex",alignItems:"center",gap:"0.3rem"},children:[a.emoji," ",e.titre,o&&r.jsx("span",{style:{fontSize:"0.65rem",color:"#dc2626"},children:""})]}),r.jsxs("div",{style:{fontSize:"0.72rem",color:"#9ca3af",marginTop:2},children:[l.toLocaleDateString("fr-FR",{day:"numeric",month:"short"}),"  ",l.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]}),r.jsx("button",{onClick:()=>n(e.id),style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af",fontSize:"0.9rem",flexShrink:0},title:"Supprimer",children:""})]})},ZZ=({profId:e,cahierId:t})=>{const n=lt(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,f]=g.useState("tous");g.useEffect(()=>{(async()=>{u(!0);try{const x=await IZ(e,t);l(x)}catch(x){console.error("Erreur signets:",x)}finally{u(!1)}})()},[e,t]);const p=async(b,x)=>{try{await Rc(b.id,{statutEvaluation:x}),l(j=>j.map(N=>N.id===b.id?{...N,statutEvaluation:x}:N))}catch(j){console.error("Erreur mise  jour statut:",j)}},h=d==="tous"?a:a.filter(b=>b.statutEvaluation===d),v=[{value:"tous",label:"Tous",color:"#6b7280"},{value:"a_evaluer",label:" valuer",color:"#d97706"},{value:"evaluation_creee",label:"Cre",color:"#2563eb"},{value:"evaluation_terminee",label:"Termine",color:"#059669"}];return r.jsxs("div",{children:[r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem",flexWrap:"wrap",gap:"0.5rem"},children:r.jsxs("h3",{style:{fontSize:"1.1rem",fontWeight:700,color:"#1f2937",margin:0},children:[" Signets d'valuation (",a.length,")"]})}),r.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.25rem",flexWrap:"wrap"},children:v.map(b=>r.jsx("button",{onClick:()=>f(b.value),style:{padding:"0.3rem 0.85rem",borderRadius:20,border:`1.5px solid ${d===b.value?b.color:"#e5e7eb"}`,background:d===b.value?b.color:"white",color:d===b.value?"white":"#4b5563",fontSize:"0.8rem",fontWeight:600,cursor:"pointer",transition:"all 0.15s"},children:b.label},b.value))}),o?r.jsx("div",{style:{textAlign:"center",color:"#9ca3af",padding:"2rem"},children:"Chargement..."}):h.length===0?r.jsxs("div",{style:{textAlign:"center",padding:"2.5rem",color:"#9ca3af"},children:[r.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:""}),r.jsx("div",{style:{fontWeight:600,color:"#6b7280",marginBottom:"0.25rem"},children:"Aucun signet trouv"}),r.jsx("div",{style:{fontSize:"0.85rem"},children:"Marquez des entres pour valuation depuis l'diteur de sance."})]}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:h.map(b=>{const x=Hi[b.typeContenu];return Tc[b.statut],r.jsxs("div",{style:{background:"white",borderRadius:10,boxShadow:"0 2px 8px rgba(0,0,0,0.07)",padding:"1rem",borderLeft:"4px solid #f59e0b"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:"0.5rem",marginBottom:"0.5rem"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"0.9rem",fontWeight:700,color:"#1f2937"},children:b.chapitre}),r.jsx("div",{style:{fontSize:"0.78rem",color:"#9ca3af",marginTop:"0.15rem"},children:b.date.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})})]}),r.jsx("button",{onClick:()=>n(`/prof/cahiers/${t}/modifier/${b.id}`),style:{background:"none",border:"none",cursor:"pointer",color:"#2563eb",fontSize:"0.8rem",fontWeight:600,whiteSpace:"nowrap"},children:" Modifier"})]}),r.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.75rem"},children:[r.jsxs("span",{style:{padding:"0.15rem 0.6rem",borderRadius:20,fontSize:"0.72rem",fontWeight:600,background:x.color+"22",color:x.color},children:[x.emoji," ",x.label]}),b.typeEvaluation&&r.jsxs("span",{style:{padding:"0.15rem 0.6rem",borderRadius:20,fontSize:"0.72rem",fontWeight:600,background:"#fef3c7",color:"#92400e"},children:[" ",wA[b.typeEvaluation]]}),b.dateEvaluationPrevue&&r.jsxs("span",{style:{padding:"0.15rem 0.6rem",borderRadius:20,fontSize:"0.72rem",background:"#f3f4f6",color:"#4b5563"},children:[" ",b.dateEvaluationPrevue.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"short"})]})]}),r.jsx("div",{style:{display:"flex",gap:"0.4rem",flexWrap:"wrap"},children:["a_evaluer","evaluation_creee","evaluation_terminee"].map(j=>{const N=b.statutEvaluation===j,w={a_evaluer:" valuer",evaluation_creee:"Cre",evaluation_terminee:" Termine"},C={a_evaluer:"#d97706",evaluation_creee:"#2563eb",evaluation_terminee:"#059669"};return r.jsx("button",{onClick:()=>p(b,j),style:{padding:"0.25rem 0.7rem",borderRadius:20,border:`1.5px solid ${N?C[j]:"#e5e7eb"}`,background:N?C[j]:"white",color:N?"white":"#6b7280",fontSize:"0.72rem",fontWeight:600,cursor:"pointer"},children:w[j]},j)})})]},b.id)})})]})},JZ=({cahier:e})=>{const[t,n]=g.useState(null),[a,l]=g.useState(!0);g.useEffect(()=>{(async()=>{try{const d=await LZ(e.id);n(d)}catch{}finally{l(!1)}})()},[e.id]);const o=e.nombreSeancesPrevu>0?Math.min(100,Math.round(e.nombreSeancesRealise/e.nombreSeancesPrevu*100)):0;return a?r.jsx("div",{style:{padding:"1rem",textAlign:"center",color:"#9ca3af",fontSize:"0.85rem"},children:"Chargement des stats..."}):t?r.jsxs("div",{style:{background:"white",borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",padding:"1.25rem"},children:[r.jsx("div",{style:{fontWeight:700,fontSize:"0.95rem",color:"#1f2937",marginBottom:"1.25rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:" Statistiques du cahier"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem",marginBottom:"1.25rem"},children:[r.jsx(rm,{value:t.total,label:"Sances total",color:"#2563eb",bg:"#dbeafe"}),r.jsx(rm,{value:t.realise,label:"Ralises",color:"#059669",bg:"#d1fae5"}),r.jsx(rm,{value:t.planifie,label:"Planifies",color:"#d97706",bg:"#fef3c7"}),r.jsx(rm,{value:`${t.tauxRealisation}%`,label:"Taux de ralisation",color:"#7c3aed",bg:"#ede9fe"})]}),r.jsxs("div",{style:{marginBottom:"1.25rem"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.4rem"},children:[r.jsx("span",{children:"Progression du programme"}),r.jsxs("span",{style:{fontWeight:700,color:e.couleur},children:[o,"%"]})]}),r.jsx("div",{style:{height:8,background:"#e5e7eb",borderRadius:10,overflow:"hidden"},children:r.jsx("div",{style:{height:"100%",width:`${o}%`,background:e.couleur,borderRadius:10,transition:"width 0.5s ease"}})}),r.jsxs("div",{style:{fontSize:"0.75rem",color:"#9ca3af",marginTop:"0.3rem"},children:[e.nombreSeancesRealise," / ",e.nombreSeancesPrevu," sances prvues"]})]}),Object.keys(t.parType).length>0&&r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"0.78rem",fontWeight:700,color:"#9ca3af",textTransform:"uppercase",marginBottom:"0.6rem"},children:"Rpartition par type"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.4rem"},children:Object.entries(t.parType).sort((u,d)=>d[1]-u[1]).map(([u,d])=>{const f=Hi[u];if(!f)return null;const p=t.total>0?Math.round(d/t.total*100):0;return r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.78rem",color:"#4b5563",marginBottom:"0.2rem"},children:[r.jsxs("span",{children:[f.emoji," ",f.label]}),r.jsxs("span",{style:{fontWeight:600},children:[d," (",p,"%)"]})]}),r.jsx("div",{style:{height:4,background:"#f3f4f6",borderRadius:10,overflow:"hidden"},children:r.jsx("div",{style:{height:"100%",width:`${p}%`,background:f.color,borderRadius:10}})})]},u)})})]})]}):null},rm=({value:e,label:t,color:n,bg:a})=>r.jsxs("div",{style:{background:a,borderRadius:10,padding:"0.75rem",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800,color:n},children:e}),r.jsx("div",{style:{fontSize:"0.72rem",color:"#6b7280",marginTop:"0.15rem"},children:t})]});function VE(e){const t=new Date(e),n=t.getDay(),a=n===0?-6:1-n;return t.setDate(t.getDate()+a),t.setHours(0,0,0,0),t}function eJ(e){const t=new Date(e);return t.setDate(t.getDate()+6),t}function YE(e){const t=new Date(e),n=eJ(t),a={day:"numeric",month:"short"};return`${t.toLocaleDateString("fr-FR",a)}  ${n.toLocaleDateString("fr-FR",a)}`}function KE(e){const[t,n]=e.split("-");return new Date(Number(t),Number(n)-1).toLocaleDateString("fr-FR",{month:"long",year:"numeric"})}const tJ=()=>{const{cahierId:e}=Jn(),{currentUser:t}=Ze(),n=lt(),[a,l]=g.useState(null),[o,u]=g.useState([]),[d,f]=g.useState(!0),[p,h]=g.useState(!0),[v,b]=g.useState("liste"),[x,j]=g.useState("tous"),[N,w]=g.useState("tous"),[C,E]=g.useState("tous"),[S,A]=g.useState(null),[O,k]=g.useState("asc"),[M,D]=g.useState(!0),[$,U]=g.useState(!1);g.useEffect(()=>{Dt(Ne(K,"settings","platform")).then(I=>{if(I.exists()){const re=I.data();D(re.cahierPdfExport!==!1)}}).catch(()=>{})},[]),g.useEffect(()=>{if(!e)return;(async()=>{f(!0);try{const re=await nP(e);if(!re){n("/prof/cahiers");return}l(re)}finally{f(!1)}})()},[e,n]);const L=g.useCallback(async()=>{if(e){h(!0);try{const I=await aP(e);u(I)}finally{h(!1)}}},[e]);g.useEffect(()=>{L()},[L]);const B=async I=>{if(confirm(`Supprimer la sance "${I.chapitre}" ?`))try{await UZ(I.id);const re=o.filter(oe=>oe.id!==I.id);u(re);const V=re.filter(oe=>oe.statut==="realise").length;await ff(e,{nombreSeancesRealise:V}),l(oe=>oe&&{...oe,nombreSeancesRealise:V})}catch{alert("Erreur lors de la suppression.")}},ee=async(I,re)=>{try{await Rc(I.id,{statut:re});const V=o.map(xe=>xe.id===I.id?{...xe,statut:re}:xe);u(V);const oe=V.filter(xe=>xe.statut==="realise").length;await ff(e,{nombreSeancesRealise:oe}),l(xe=>xe&&{...xe,nombreSeancesRealise:oe})}catch{alert("Erreur mise  jour statut.")}},se=g.useCallback(()=>{U(!0),setTimeout(()=>{window.print(),U(!1)},100)},[]),P=g.useMemo(()=>Array.from(new Set(o.map(I=>{const re=I.date.toDate();return`${re.getFullYear()}-${String(re.getMonth()+1).padStart(2,"0")}`}))).sort(),[o]),q=g.useMemo(()=>{const I=C==="tous"?o:o.filter(V=>{const oe=V.date.toDate();return`${oe.getFullYear()}-${String(oe.getMonth()+1).padStart(2,"0")}`===C}),re=new Map;return I.forEach(V=>{const xe=VE(V.date.toDate()).toISOString().slice(0,10);re.set(xe,(re.get(xe)||0)+1)}),Array.from(re.entries()).sort(([V],[oe])=>V.localeCompare(oe)).map(([V,oe])=>({start:V,count:oe}))},[o,C]),F=g.useMemo(()=>{const I=new Map;return o.forEach(re=>{const V=re.date.toDate(),oe=`${V.getFullYear()}-${String(V.getMonth()+1).padStart(2,"0")}`;I.set(oe,(I.get(oe)||0)+1)}),I},[o]),R=g.useMemo(()=>o.filter(I=>{const re=I.date.toDate(),V=x==="tous"||I.statut===x,oe=N==="tous"||I.typeContenu===N;let xe=!0;C!=="tous"&&(xe=`${re.getFullYear()}-${String(re.getMonth()+1).padStart(2,"0")}`===C);let ve=!0;return S&&(ve=VE(re).toISOString().slice(0,10)===S),V&&oe&&xe&&ve}).sort((I,re)=>{const V=I.date.toMillis()-re.date.toMillis();return O==="asc"?V:-V}),[o,x,N,C,S,O]);if(d)return r.jsx("div",{className:"loading-spinner",children:r.jsx("div",{className:"spinner-circle"})});if(!a)return null;const W=a.nombreSeancesPrevu>0?Math.round(o.filter(I=>I.statut==="realise").length/a.nombreSeancesPrevu*100):0;return r.jsxs("div",{className:"cahier-detail-page",id:"cahier-detail-print-zone",children:[r.jsxs("div",{className:"cahier-detail-header",children:[r.jsx("button",{className:"btn-retour no-print",onClick:()=>n("/prof/cahiers"),title:"Retour  la liste",children:" Retour"}),r.jsx("div",{className:"cahier-detail-couleur-barre",style:{background:a.couleur}}),r.jsxs("div",{className:"cahier-detail-info",children:[r.jsx("h1",{className:"cahier-detail-titre",children:a.titre}),r.jsxs("div",{className:"cahier-detail-badges",children:[r.jsx("span",{className:"badge-classe",children:a.classe}),r.jsx("span",{className:"badge-matiere",children:a.matiere}),r.jsx("span",{className:"badge-annee",children:a.anneeScolaire}),a.isPartage&&r.jsx("span",{className:"badge-partage",children:" Partag"})]}),a.description&&r.jsx("p",{className:"cahier-detail-description",children:a.description}),r.jsxs("div",{className:"cahier-detail-progression",children:[r.jsx("div",{className:"progression-bar-bg",style:{width:200},children:r.jsx("div",{className:"progression-bar-fill",style:{width:`${W}%`,background:a.couleur}})}),r.jsxs("span",{className:"progression-pct",children:[o.filter(I=>I.statut==="realise").length," / ",a.nombreSeancesPrevu," sances (",W,"%)"]})]})]}),r.jsxs("div",{className:"cahier-detail-actions no-print",children:[M&&r.jsxs("button",{className:"btn-pdf",onClick:se,disabled:$,title:"Tlcharger en PDF",children:[$?"":""," PDF"]}),r.jsx("button",{className:"btn-primary",onClick:()=>n(`/prof/cahiers/${e}/nouvelle`),children:"+ Nouvelle sance"})]})]}),r.jsx("div",{className:"view-tabs no-print",children:[{id:"liste",label:" Liste"},{id:"calendrier",label:" Calendrier"},{id:"signets",label:" Signets"},{id:"stats",label:" Statistiques"}].map(I=>r.jsx("button",{className:`view-tab ${v===I.id?"active":""}`,onClick:()=>b(I.id),children:I.label},I.id))}),v==="calendrier"&&r.jsxs("div",{className:"cahier-detail-layout",children:[r.jsx("div",{children:r.jsx(VZ,{cahierId:a.id})}),r.jsx("div",{children:r.jsx(tm,{profId:t.uid,cahierId:a.id})})]}),v==="signets"&&r.jsxs("div",{className:"cahier-detail-layout",children:[r.jsx(ZZ,{profId:t.uid,cahierId:a.id}),r.jsx(tm,{profId:t.uid,cahierId:a.id})]}),v==="stats"&&r.jsxs("div",{className:"cahier-detail-layout",children:[r.jsx(JZ,{cahier:{...a,nombreSeancesRealise:o.filter(I=>I.statut==="realise").length}}),r.jsx(tm,{profId:t.uid,cahierId:a.id})]}),v==="liste"&&r.jsxs("div",{className:"cahier-three-col-layout",children:[r.jsxs("aside",{className:"cahier-nav-sidebar no-print",children:[r.jsxs("div",{className:"nav-sidebar-header",children:[r.jsx("span",{className:"nav-sidebar-icon",children:""}),r.jsx("span",{className:"nav-sidebar-title",children:"Navigation"})]}),r.jsxs("button",{className:`nav-month-item ${C==="tous"?"active":""}`,onClick:()=>{E("tous"),A(null)},children:[r.jsx("span",{children:"Tout afficher"}),r.jsx("span",{className:"nav-count-badge",children:o.length})]}),P.length>0&&r.jsx("div",{className:"nav-months-list",children:P.map(I=>r.jsxs("button",{className:`nav-month-item ${C===I?"active":""}`,onClick:()=>{E(I),A(null)},children:[r.jsx("span",{className:"nav-month-label",children:KE(I)}),r.jsx("span",{className:"nav-count-badge",children:F.get(I)||0})]},I))}),C!=="tous"&&q.length>0&&r.jsxs("div",{className:"nav-weeks-section",children:[r.jsx("div",{className:"nav-weeks-header",children:"Semaines"}),r.jsxs("button",{className:`nav-week-item ${S===null?"active":""}`,onClick:()=>A(null),children:[r.jsx("span",{children:"Tout le mois"}),r.jsx("span",{className:"nav-count-badge nav-count-badge--sm",children:F.get(C)||0})]}),q.map(I=>r.jsxs("button",{className:`nav-week-item ${S===I.start?"active":""}`,onClick:()=>A(I.start),children:[r.jsx("span",{className:"nav-week-label",children:YE(I.start)}),r.jsx("span",{className:"nav-count-badge nav-count-badge--sm",children:I.count})]},I.start))]}),o.length===0&&r.jsx("p",{className:"nav-sidebar-empty",children:"Aucune sance pour l'instant"})]}),r.jsxs("div",{className:"cahier-content-col",children:[r.jsxs("div",{className:"entrees-controls no-print",children:[r.jsx("div",{className:"entrees-statut-filters",children:["tous","realise","planifie","annule","reporte"].map(I=>{const re=I==="tous"?null:Tc[I];return r.jsx("button",{className:`statut-chip ${x===I?"active":""}`,style:x===I&&re?{borderColor:re.color,background:re.bg,color:re.color}:{},onClick:()=>j(I),children:I==="tous"?"Tous":re?.label},I)})}),r.jsxs("div",{className:"entrees-right-controls",children:[r.jsxs("select",{className:"filtre-select",value:N,onChange:I=>w(I.target.value),children:[r.jsx("option",{value:"tous",children:"Tous types"}),Object.entries(Hi).map(([I,re])=>r.jsxs("option",{value:I,children:[re.emoji," ",re.label]},I))]}),r.jsx("button",{className:"btn-sort",onClick:()=>k(I=>I==="asc"?"desc":"asc"),title:O==="asc"?"Ordre croissant (cliquer pour inverser)":"Ordre dcroissant (cliquer pour inverser)",children:O==="asc"?" Plus ancien":" Plus rcent"})]})]}),(C!=="tous"||S||x!=="tous"||N!=="tous")&&r.jsxs("div",{className:"filtre-actif-bar no-print",children:[r.jsxs("span",{className:"filtre-actif-label",children:[R.length," sance",R.length!==1?"s":"",S?`  Semaine du ${YE(S)}`:"",C!=="tous"&&!S?`  ${KE(C)}`:""]}),r.jsx("button",{className:"filtre-actif-reset",onClick:()=>{j("tous"),w("tous"),E("tous"),A(null)},children:" Rinitialiser"})]}),p&&R.length===0?r.jsx("div",{className:"loading-spinner",children:r.jsx("div",{className:"spinner-circle"})}):R.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{style:{fontSize:"2.5rem",opacity:.3,marginBottom:"0.5rem"},children:""}),r.jsx("h3",{children:x!=="tous"||N!=="tous"||C!=="tous"?"Aucune sance correspondant aux filtres":"Aucune sance pour l'instant"}),x==="tous"&&N==="tous"&&C==="tous"&&r.jsx("button",{className:"btn-primary",onClick:()=>n(`/prof/cahiers/${e}/nouvelle`),style:{marginTop:"1rem"},children:"+ Ajouter la premire sance"})]}):r.jsx("div",{className:"entrees-list",children:R.map((I,re)=>{const V=Hi[I.typeContenu],oe=Tc[I.statut],xe=I.date.toDate();return r.jsxs("div",{className:"entree-card",style:{borderLeftColor:V.color},onClick:()=>n(`/prof/cahiers/${e}/modifier/${I.id}`),children:[r.jsx("div",{className:"entree-num",children:r.jsx("span",{style:{background:V.color},children:O==="asc"?re+1:R.length-re})}),r.jsxs("div",{className:"entree-card-inner",children:[r.jsxs("div",{className:"entree-card-top",children:[r.jsxs("div",{className:"entree-card-gauche",children:[r.jsxs("div",{className:"entree-date",children:[" ",xe.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),I.heureDebut&&r.jsxs("span",{className:"entree-heure",children:[" ",I.heureDebut,I.heureFin?`  ${I.heureFin}`:""]})]}),r.jsx("h3",{className:"entree-chapitre",children:I.chapitre}),r.jsxs("div",{className:"entree-badges",children:[r.jsxs("span",{className:"entree-type-badge",style:{background:V.color},children:[V.emoji," ",V.label]}),r.jsx("span",{className:"entree-statut-badge",style:{background:oe.bg,color:oe.color},children:oe.label}),I.isMarqueEvaluation&&r.jsx("span",{className:"signet-badge",children:" valuation"}),I.piecesJointes&&I.piecesJointes.length>0&&r.jsxs("span",{className:"badge-pj",children:[" ",I.piecesJointes.length]})]})]}),r.jsxs("div",{className:"entree-actions no-print",children:[r.jsx("button",{className:"btn-icon",onClick:ve=>{ve.stopPropagation(),n(`/prof/cahiers/${e}/modifier/${I.id}`)},title:"Modifier",children:""}),r.jsx("button",{className:"btn-icon btn-icon--danger",onClick:ve=>{ve.stopPropagation(),B(I)},title:"Supprimer",children:""})]})]}),I.contenu&&r.jsx("div",{className:"entree-contenu-preview",dangerouslySetInnerHTML:{__html:I.contenu}}),I.objectifs&&r.jsxs("div",{className:"entree-objectifs",children:[" ",r.jsx("em",{children:I.objectifs})]}),r.jsxs("div",{className:"entree-card-footer no-print",children:[r.jsx("div",{className:"entree-statuts-rapides",children:["realise","planifie","annule"].map(ve=>{const H=Tc[ve],he=I.statut===ve;return r.jsx("button",{className:`statut-quick-btn ${he?"active":""}`,style:he?{borderColor:H.color,background:H.bg,color:H.color}:{},onClick:Pe=>{Pe.stopPropagation(),ee(I,ve)},children:H.label},ve)})}),I.notesPrivees&&r.jsx("span",{className:"entree-has-notes",title:"Contient des notes prives",children:" Notes prives"})]})]})]},I.id)})})]}),r.jsx("div",{className:"cahier-sidebar-right no-print",children:r.jsx(tm,{profId:t.uid,cahierId:a.id})})]})]})};function rJ(e){return{video:"",article:"",exercice:"",autre:""}[e]??""}function nJ(e){const t=/(?:youtube\.com\/watch\?v=|youtu\.be\/)([A-Za-z0-9_\-]{11})/,n=e.match(t);return n?n[1]:null}const aJ=({onAjouter:e,onAnnuler:t})=>{const[n,a]=g.useState(""),[l,o]=g.useState(""),[u,d]=g.useState("article"),[f,p]=g.useState(""),[h,v]=g.useState("");function b(j){o(j),(j.includes("youtube.com")||j.includes("youtu.be"))&&d("video")}function x(){if(!n.trim()){v("Le titre est requis.");return}if(!l.trim()||!l.startsWith("http://")&&!l.startsWith("https://")){v("Entrez une URL valide commenant par https://");return}const j={id:String(Date.now()),titre:n.trim(),url:l.trim(),type:u,description:f.trim()||void 0};e(j)}return r.jsxs("div",{className:"lien-form",children:[r.jsx("input",{type:"text",placeholder:"Titre du lien *",value:n,onChange:j=>a(j.target.value),"aria-label":"Titre du lien"}),r.jsx("input",{type:"url",placeholder:"https://... *",value:l,onChange:j=>b(j.target.value),"aria-label":"URL du lien"}),r.jsxs("select",{value:u,onChange:j=>d(j.target.value),"aria-label":"Type de lien",children:[r.jsx("option",{value:"article",children:" Article"}),r.jsx("option",{value:"video",children:" Vido"}),r.jsx("option",{value:"exercice",children:" Exercice"}),r.jsx("option",{value:"autre",children:" Autre"})]}),r.jsx("textarea",{placeholder:"Description (optionnelle)",value:f,onChange:j=>p(j.target.value),rows:2,"aria-label":"Description du lien"}),h&&r.jsx("p",{style:{color:"#dc2626",fontSize:"0.8rem",margin:0},children:h}),r.jsxs("div",{className:"lien-form-actions",children:[r.jsx("button",{className:"btn-secondary",onClick:t,type:"button",children:"Annuler"}),r.jsx("button",{className:"btn-pedaclic",onClick:x,type:"button",children:" Ajouter"})]})]})},iJ=({videoId:e})=>r.jsx("div",{className:"youtube-embed",children:r.jsx("iframe",{src:`https://www.youtube.com/embed/${e}`,title:"Vido YouTube",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy"})}),sP=({liens:e,onChange:t,readonly:n=!1})=>{const[a,l]=g.useState(!1);function o(d){t([...e,d]),l(!1)}function u(d){t(e.filter(f=>f.id!==d))}return r.jsxs("section",{className:"liens-section","aria-label":"Liens externes",children:[r.jsx("h4",{children:" Liens et ressources"}),e.length>0&&r.jsx("div",{className:"liens-liste",children:e.map(d=>{const f=nJ(d.url);return r.jsxs("div",{className:"lien-card",children:[r.jsx("span",{className:"lien-icone","aria-hidden":"true",children:rJ(d.type)}),r.jsxs("div",{className:"lien-infos",children:[r.jsx("a",{href:d.url,target:"_blank",rel:"noopener noreferrer",className:"lien-titre",title:d.url,children:d.titre}),d.description&&r.jsx("p",{className:"lien-description",children:d.description}),f&&r.jsx(iJ,{videoId:f})]}),!n&&r.jsx("button",{className:"lien-suppr",onClick:()=>u(d.id),title:"Supprimer ce lien",type:"button","aria-label":`Supprimer le lien ${d.titre}`,children:""})]},d.id)})}),e.length===0&&!n&&r.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 12px"},children:"Aucun lien ajout. Ajoutez des ressources pour enrichir cette sance."}),!n&&r.jsx(r.Fragment,{children:a?r.jsx(aJ,{onAjouter:o,onAnnuler:()=>l(!1)}):r.jsx("button",{className:"btn-secondary",onClick:()=>l(!0),type:"button",children:" Ajouter un lien"})})]})},sJ=({selectedIds:e,onSelect:t,onFermer:n})=>{const[a,l]=g.useState(""),[o,u]=g.useState([]),[d,f]=g.useState(!0),[p,h]=g.useState("");g.useEffect(()=>{async function x(){try{const j=await TZ();u(j)}catch{h("Impossible de charger la bibliothque.")}finally{f(!1)}}x()},[]);const v=g.useMemo(()=>{const x=a.toLowerCase().trim();return x?o.filter(j=>j.titre.toLowerCase().includes(x)||j.auteur.toLowerCase().includes(x)||j.categorie.toLowerCase().includes(x)):o},[o,a]);function b(x){x.target===x.currentTarget&&n()}return r.jsx("div",{className:"ebook-selector-overlay",onClick:b,role:"dialog","aria-modal":"true","aria-label":"Slectionner un ebook",children:r.jsxs("div",{className:"ebook-selector-panel",children:[r.jsxs("div",{className:"ebook-selector-header",children:[r.jsx("h3",{children:" Bibliothque PedaClic"}),r.jsx("button",{onClick:n,"aria-label":"Fermer",style:{background:"none",border:"none",fontSize:"1.3rem",cursor:"pointer",color:"#6b7280"},type:"button",children:""})]}),r.jsx("div",{className:"ebook-search",children:r.jsx("input",{type:"search",placeholder:" Rechercher par titre, auteur ou catgorie...",value:a,onChange:x=>l(x.target.value),autoFocus:!0,"aria-label":"Recherche ebook"})}),r.jsxs("div",{className:"ebook-liste",children:[d&&r.jsx("p",{style:{color:"#6b7280",textAlign:"center"},children:" Chargement de la bibliothque"}),p&&r.jsx("p",{style:{color:"#dc2626",textAlign:"center"},children:p}),!d&&!p&&v.length===0&&r.jsx("p",{style:{color:"#9ca3af",textAlign:"center"},children:"Aucun ebook ne correspond  votre recherche."}),!d&&v.map(x=>{const j=e.includes(x.id);return r.jsxs("button",{type:"button",className:`ebook-item ${j?"selected":""}`,onClick:()=>!j&&t(x),disabled:j,"aria-pressed":j,"aria-label":`${j?"Dj li : ":""}${x.titre}`,children:[x.couvertureUrl?r.jsx("img",{src:x.couvertureUrl,alt:`Couverture de ${x.titre}`,loading:"lazy"}):r.jsx("div",{style:{width:36,height:48,background:"#e5e7eb",borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.2rem",flexShrink:0},"aria-hidden":"true",children:""}),r.jsxs("div",{className:"ebook-item-info",children:[r.jsx("div",{className:"ebook-item-titre",children:x.titre}),r.jsxs("div",{className:"ebook-item-meta",children:[x.auteur,"  ",x.categorie]}),j&&r.jsx("div",{style:{fontSize:"0.75rem",color:"#2563eb",marginTop:2},children:" Dj li  cette sance"})]})]},x.id)})]})]})})},lP=({ebooksLies:e,onChange:t,readonly:n=!1})=>{const[a,l]=g.useState(!1),o=e.map(f=>f.ebookId);function u(f){const p={ebookId:f.id,titre:f.titre,categorie:f.categorie,auteur:f.auteur};t([...e,p]),l(!1)}function d(f){t(e.filter(p=>p.ebookId!==f))}return r.jsxs("section",{"aria-label":"Ebooks lis  la sance",style:{marginTop:16},children:[r.jsx("h4",{style:{fontSize:"0.95rem",fontWeight:600,color:"#111827",margin:"0 0 8px"},children:" Ebooks de la bibliothque"}),e.length>0&&r.jsx("div",{className:"ebooks-lies",children:e.map(f=>r.jsxs("span",{className:"ebook-chip",children:[r.jsxs("a",{href:`/bibliotheque/${f.ebookId}`,className:"ebook-chip",style:{textDecoration:"none"},title:`Lire : ${f.titre}`,children:[" ",f.titre]}),!n&&r.jsx("button",{onClick:()=>d(f.ebookId),title:`Retirer ${f.titre}`,type:"button","aria-label":`Retirer l'ebook ${f.titre}`,children:""})]},f.ebookId))}),e.length===0&&!n&&r.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 8px"},children:"Aucun ebook li. Associez un ebook de la bibliothque  cette sance."}),!n&&r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>l(!0),style:{marginTop:8},children:" Choisir dans la bibliothque"}),a&&r.jsx(sJ,{selectedIds:o,onSelect:u,onFermer:()=>l(!1)})]})},oP="https://api.pedaclic.sn",lJ=12e4,oJ=1,mr={cours_complet:"Cours complet",fiche_revision:"Fiche de rvision",exercices_corriges:"Exercices corrigs",quiz_auto:"Quiz auto-gnr",sujet_examen:"Sujet type examen",evaluation_personnalisee:"valuation personnalise"},cJ={cours_complet:"Un cours structur avec introduction, dveloppement et conclusion adapt au programme sngalais.",fiche_revision:"Synthse des points cls pour rviser efficacement avant un examen.",exercices_corriges:"Srie d'exercices progressifs avec corrections dtailles tape par tape.",quiz_auto:"10 questions QCM avec 4 options, corrections et explications. Sauvegard directement comme quiz jouable.",sujet_examen:"Sujet conforme au format officiel BFEM ou BAC avec barme.",evaluation_personnalisee:"valuation sur mesure avec barme /20 et corrig-type."},Ga={cours_complet:"",fiche_revision:"",exercices_corriges:"",quiz_auto:"",sujet_examen:"",evaluation_personnalisee:""};async function uJ(e,t,n=lJ){const a=new AbortController,l=setTimeout(()=>a.abort(),n);try{const o=await fetch(e,{...t,signal:a.signal});return clearTimeout(l),o}catch(o){throw clearTimeout(l),o.name==="AbortError"?new Error(`La gnration a pris trop de temps (>${n/1e3}s). Le serveur est peut-tre surcharg. Veuillez ressayer dans quelques instants.`):o}}async function cP(e,t=oJ){try{return await e()}catch(n){if(t<=0)throw n;return console.warn(`[aiGeneratorService] chec, nouvelle tentative dans 3s... (${t} restante(s))`),await new Promise(a=>setTimeout(a,3e3)),cP(e,t-1)}}async function WE(){try{(await fetch(`${oP}/api/health`,{method:"GET"})).ok&&console.log("[aiGeneratorService] Ping Railway OK")}catch{}}async function dJ(e){const t=JSON.stringify(e),n={method:"POST",headers:{"Content-Type":"application/json"},body:t},a=await cP(()=>uJ(`${oP}/api/generate`,n)).catch(o=>{throw console.error("[aiGeneratorService] Erreur gnration:",o),o instanceof TypeError&&o.message.includes("fetch")?new Error("Impossible de contacter le serveur. Vrifiez votre connexion internet."):o});if(!a.ok){const u=(await a.json().catch(()=>({}))).error||`Erreur serveur (${a.status})`;throw new Error(u)}const l=await a.json();if(!l.success)throw new Error(l.error||"La gnration a chou.");return l}async function mJ(e,t,n,a){try{const l=await qt(je(K,"generated_content"),{userId:e,type:t.type,discipline:t.discipline,disciplineId:a,classe:t.classe,chapitre:t.chapitre,content:n,options:t.options||null,createdAt:Oe.now()});return console.log("[aiGeneratorService] Contenu sauvegard:",l.id),l.id}catch(l){throw console.error("[aiGeneratorService] Erreur sauvegarde contenu:",l),new Error("Erreur lors de la sauvegarde du contenu gnr.")}}async function fJ(e,t,n,a){try{const l=n.map((d,f)=>({id:`q_${Date.now()}_${f}`,question:d.question,options:d.options,reponseCorrecte:d.reponseCorrecte,explication:d.explication||"",difficulte:d.difficulte||"moyen",points:d.points||2})),o={disciplineId:a,titre:`Quiz IA  ${t.chapitre}`,description:`Quiz auto-gnr pour ${t.discipline} (${t.classe})  Chapitre : ${t.chapitre}`,questions:l,duree:15,isPremium:!0,noteMinimale:10,auteurId:e,source:"ia_generator",createdAt:Oe.now()},u=await qt(je(K,"quizzes"),o);return console.log("[aiGeneratorService] Quiz sauvegard:",u.id),u.id}catch(l){throw console.error("[aiGeneratorService] Erreur sauvegarde quiz:",l),new Error("Erreur lors de la sauvegarde du quiz gnr.")}}async function kb(e,t=20){try{const n=Ee(je(K,"generated_content"),Se("userId","==",e),Ve("createdAt","desc")),a=await Ce(n),l=[];return a.forEach(o=>{l.length<t&&l.push({id:o.id,...o.data()})}),l}catch(n){throw console.error("[aiGeneratorService] Erreur chargement historique:",n),new Error("Erreur lors du chargement de l'historique.")}}async function pJ(e){try{await rn(Ne(K,"generated_content",e)),console.log("[aiGeneratorService] Contenu supprim:",e)}catch(t){throw console.error("[aiGeneratorService] Erreur suppression:",t),new Error("Erreur lors de la suppression du contenu.")}}const hJ=({userId:e,selectedIds:t,onSelect:n,onFermer:a})=>{const[l,o]=g.useState(""),[u,d]=g.useState([]),[f,p]=g.useState(!0),[h,v]=g.useState("");g.useEffect(()=>{async function j(){try{const N=await kb(e,50);d(N)}catch{v("Impossible de charger les contenus gnrs.")}finally{p(!1)}}j()},[e]);const b=g.useMemo(()=>{const j=l.toLowerCase().trim();return j?u.filter(N=>N.chapitre.toLowerCase().includes(j)||N.discipline.toLowerCase().includes(j)||N.classe.toLowerCase().includes(j)||mr[N.type]?.toLowerCase().includes(j)):u},[u,l]);function x(j){j.target===j.currentTarget&&a()}return r.jsx("div",{className:"ebook-selector-overlay",onClick:x,role:"dialog","aria-modal":"true","aria-label":"Slectionner un contenu IA",children:r.jsxs("div",{className:"ebook-selector-panel",children:[r.jsxs("div",{className:"ebook-selector-header",children:[r.jsx("h3",{children:" Contenus gnrs par l'IA"}),r.jsx("button",{onClick:a,"aria-label":"Fermer",type:"button",style:{background:"none",border:"none",fontSize:"1.3rem",cursor:"pointer",color:"#6b7280"},children:""})]}),r.jsx("div",{className:"ebook-search",children:r.jsx("input",{type:"search",placeholder:" Rechercher par chapitre, discipline ou classe",value:l,onChange:j=>o(j.target.value),autoFocus:!0,"aria-label":"Recherche contenu IA"})}),r.jsxs("div",{className:"ebook-liste",children:[f&&r.jsx("p",{style:{color:"#6b7280",textAlign:"center"},children:" Chargement"}),h&&r.jsx("p",{style:{color:"#dc2626",textAlign:"center"},children:h}),!f&&!h&&b.length===0&&r.jsx("p",{style:{color:"#9ca3af",textAlign:"center"},children:"Aucun contenu ne correspond  votre recherche."}),!f&&b.map(j=>{const N=j.id?t.includes(j.id):!1,w=j.createdAt?.toDate?j.createdAt.toDate().toLocaleDateString("fr-FR"):"";return r.jsxs("button",{type:"button",className:`ebook-item ${N?"selected":""}`,onClick:()=>!N&&n(j),disabled:N,"aria-pressed":N,children:[r.jsx("div",{style:{width:36,height:48,background:"#eff6ff",borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.4rem",flexShrink:0},"aria-hidden":"true",children:Ga[j.type]}),r.jsxs("div",{className:"ebook-item-info",children:[r.jsx("div",{className:"ebook-item-titre",children:j.chapitre}),r.jsxs("div",{className:"ebook-item-meta",children:[mr[j.type],"  ",j.discipline,"  ",j.classe,w&&`  ${w}`]}),N&&r.jsx("div",{style:{fontSize:"0.75rem",color:"#2563eb",marginTop:2},children:" Dj li  cette sance"})]})]},j.id)})]})]})})},vJ=({userId:e,contenuIA:t,onChange:n,readonly:a=!1})=>{const[l,o]=g.useState(!1),u=t.map(p=>p.contenuId);function d(p){if(!p.id)return;const h={contenuId:p.id,type:p.type,discipline:p.discipline,classe:p.classe,chapitre:p.chapitre,createdAt:p.createdAt?.toDate?p.createdAt.toDate().toISOString():void 0};n([...t,h]),o(!1)}function f(p){n(t.filter(h=>h.contenuId!==p))}return r.jsxs("section",{"aria-label":"Contenus IA lis  la sance",style:{marginTop:16},children:[r.jsx("h4",{style:{fontSize:"0.95rem",fontWeight:600,color:"#111827",margin:"0 0 8px"},children:" Contenus gnrs par l'IA"}),t.length>0&&r.jsx("div",{className:"ebooks-lies",children:t.map(p=>r.jsxs("span",{className:"ebook-chip ebook-chip--ia",children:[r.jsxs("span",{title:`${p.discipline}  ${p.classe}  ${p.chapitre}`,children:[Ga[p.type]??""," ",p.chapitre]}),!a&&r.jsx("button",{onClick:()=>f(p.contenuId),title:`Retirer : ${p.chapitre}`,type:"button","aria-label":`Retirer le contenu ${p.chapitre}`,children:""})]},p.contenuId))}),t.length===0&&!a&&r.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 8px"},children:"Aucun contenu IA li. Associez un contenu gnr  cette sance."}),!a&&r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>o(!0),style:{marginTop:8},children:" Choisir un contenu IA"}),l&&r.jsx(hJ,{userId:e,selectedIds:u,onSelect:d,onFermer:()=>o(!1)})]})},gJ=()=>({date:new Date().toISOString().slice(0,10),heureDebut:"",heureFin:"",chapitre:"",typeContenu:"cours",contenu:"",objectifs:"",competences:[],statut:"realise",motifAnnulation:"",dateReport:"",notesPrivees:"",isMarqueEvaluation:!1,typeEvaluation:"",dateEvaluationPrevue:"",statutEvaluation:"a_evaluer"}),XE=()=>{const{cahierId:e,entreeId:t}=Jn(),{currentUser:n}=Ze(),a=lt(),[l,o]=g.useState(null),[u,d]=g.useState(null),[f,p]=g.useState(gJ()),[h,v]=g.useState([]),[b,x]=g.useState(!0),[j,N]=g.useState(!1),[w,C]=g.useState(!1),[E,S]=g.useState(""),[A,O]=g.useState([]),[k,M]=g.useState([]),[D,$]=g.useState([]),U=!!t;g.useEffect(()=>{if(!e)return;(async()=>{x(!0);try{const q=await nP(e);if(!q){a("/prof/cahiers");return}if(o(q),U&&t){const F=await zZ(t);F&&(d(F),v(F.piecesJointes||[]),O(F.liens??[]),M(F.ebooksLies??[]),$(F.contenuIA??[]),p({date:F.date.toDate().toISOString().slice(0,10),heureDebut:F.heureDebut||"",heureFin:F.heureFin||"",chapitre:F.chapitre,typeContenu:F.typeContenu,contenu:F.contenu,objectifs:F.objectifs||"",competences:F.competences||[],statut:F.statut,motifAnnulation:F.motifAnnulation||"",dateReport:F.dateReport?F.dateReport.toDate().toISOString().slice(0,10):"",notesPrivees:F.notesPrivees||"",isMarqueEvaluation:F.isMarqueEvaluation,typeEvaluation:F.typeEvaluation||"",dateEvaluationPrevue:F.dateEvaluationPrevue?F.dateEvaluationPrevue.toDate().toISOString().slice(0,10):"",statutEvaluation:F.statutEvaluation||"a_evaluer"}))}}finally{x(!1)}})()},[e,t]);const L=P=>{p(q=>({...q,competences:q.competences.includes(P)?q.competences.filter(F=>F!==P):[...q.competences,P]}))},B=async P=>{if(!P.target.files?.length||!n?.uid||!e)return;const q=P.target.files[0];if(q.size>10*1024*1024){alert("Fichier trop volumineux (max 10 Mo)");return}C(!0);try{const F=await kZ(n.uid,e,q),R=[...h,F];v(R),U&&t&&u&&await FE(t,h,[F])}catch{alert("Erreur upload fichier.")}finally{C(!1),P.target.value=""}},ee=async P=>{if(!t){v(q=>q.filter(F=>F.url!==P));return}try{await OZ(t,h,P),v(q=>q.filter(F=>F.url!==P))}catch{alert("Erreur suppression fichier.")}},se=async P=>{if(P.preventDefault(),!f.chapitre.trim()){S("Le chapitre est obligatoire.");return}if(!f.date){S("La date est obligatoire.");return}if(!(!n?.uid||!e)){N(!0),S("");try{if(U&&t)await Rc(t,e,f),await Rc(t,{liens:A,ebooksLies:k,contenuIA:D});else{const R=await BZ(e,n.uid,f);h.length>0&&await FE(R,[],h),(A.length>0||k.length>0||D.length>0)&&await Rc(R,{liens:A,ebooksLies:k,contenuIA:D})}const F=(await aP(e)).filter(R=>R.statut==="realise").length;await ff(e,{nombreSeancesRealise:F}),a(`/prof/cahiers/${e}`)}catch(q){const F=q instanceof Error?q.message:String(q);S("Erreur : "+F)}finally{N(!1)}}};return b?r.jsx("div",{className:"loading-spinner",children:r.jsx("div",{className:"spinner-circle"})}):l?r.jsxs("div",{className:"entree-editor-page",children:[r.jsxs("div",{className:"editor-header",children:[r.jsx("button",{onClick:()=>a(`/prof/cahiers/${e}`),style:{background:"none",border:"none",cursor:"pointer",color:"#6b7280",fontSize:"1.2rem"},children:""}),r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:"1.4rem",fontWeight:700,color:"#1f2937",margin:"0 0 0.2rem"},children:U?" Modifier la sance":" Nouvelle sance"}),r.jsxs("div",{style:{fontSize:"0.85rem",color:"#6b7280"},children:[l.titre,"  ",l.classe,"  ",l.matiere]})]})]}),r.jsxs("form",{onSubmit:se,children:[r.jsxs("div",{className:"editor-card",children:[r.jsx("div",{className:"editor-section-title",children:" Informations de la sance"}),r.jsxs("div",{className:"form-row",style:{gridTemplateColumns:"1.5fr 1fr 1fr"},children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Date *"}),r.jsx("input",{type:"date",className:"form-input",value:f.date,onChange:P=>p(q=>({...q,date:P.target.value})),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Heure dbut"}),r.jsx("input",{type:"time",className:"form-input",value:f.heureDebut,onChange:P=>p(q=>({...q,heureDebut:P.target.value}))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Heure fin"}),r.jsx("input",{type:"time",className:"form-input",value:f.heureFin,onChange:P=>p(q=>({...q,heureFin:P.target.value}))})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Chapitre / Titre de la sance *"}),r.jsx("input",{className:"form-input",placeholder:"Ex: Chapitre 3  Les fonctions affines",value:f.chapitre,onChange:P=>p(q=>({...q,chapitre:P.target.value})),required:!0})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Type de sance"}),r.jsx("select",{className:"form-select",value:f.typeContenu,onChange:P=>p(q=>({...q,typeContenu:P.target.value})),children:Object.entries(Hi).map(([P,q])=>r.jsxs("option",{value:P,children:[q.emoji," ",q.label]},P))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Statut"}),r.jsx("select",{className:"form-select",value:f.statut,onChange:P=>p(q=>({...q,statut:P.target.value})),children:Object.entries(Tc).map(([P,q])=>r.jsx("option",{value:P,children:q.label},P))})]})]}),f.statut==="annule"&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Motif d'annulation"}),r.jsx("input",{className:"form-input",placeholder:"Ex: Grve enseignants, sortie scolaire...",value:f.motifAnnulation,onChange:P=>p(q=>({...q,motifAnnulation:P.target.value}))})]}),f.statut==="reporte"&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Nouvelle date (report)"}),r.jsx("input",{type:"date",className:"form-input",value:f.dateReport,onChange:P=>p(q=>({...q,dateReport:P.target.value}))})]})]}),r.jsxs("div",{className:"editor-card",children:[r.jsx("div",{className:"editor-section-title",children:" Contenu de la sance"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Contenu (mise en forme riche)"}),r.jsx(va,{value:f.contenu,onChange:P=>p(q=>({...q,contenu:P})),placeholder:"Dcrivez le contenu enseign, les exemples traits, les formules vues...",minHeight:220,maxHeight:600})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Objectifs pdagogiques"}),r.jsx("textarea",{className:"form-textarea",placeholder:"Ex: L'lve sera capable de rsoudre une quation du second degr...",value:f.objectifs,onChange:P=>p(q=>({...q,objectifs:P.target.value})),rows:2})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Comptences vises"}),r.jsx("div",{className:"competences-container",children:z5.map(P=>r.jsx("button",{type:"button",className:`competence-tag ${f.competences.includes(P)?"selected":""}`,onClick:()=>L(P),children:P},P))})]})]}),r.jsxs("div",{className:"editor-card",children:[r.jsx("div",{className:"editor-section-title",children:" Signet d'valuation"}),r.jsxs("div",{className:"signet-section",children:[r.jsxs("div",{className:"signet-toggle",onClick:()=>p(P=>({...P,isMarqueEvaluation:!P.isMarqueEvaluation})),children:[r.jsx("div",{className:`toggle-switch ${f.isMarqueEvaluation?"on":""}`}),r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem",color:"#1f2937"},children:"Marquer pour valuation"}),r.jsx("div",{style:{fontSize:"0.78rem",color:"#6b7280"},children:"Ce contenu sera valu ultrieurement"})]})]}),f.isMarqueEvaluation&&r.jsx("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",gap:"0.75rem"},children:r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Type d'valuation"}),r.jsxs("select",{className:"form-select",value:f.typeEvaluation,onChange:P=>p(q=>({...q,typeEvaluation:P.target.value})),children:[r.jsx("option",{value:"",children:"Choisir..."}),Object.entries(wA).map(([P,q])=>r.jsx("option",{value:P,children:q},P))]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Date prvue d'valuation"}),r.jsx("input",{type:"date",className:"form-input",value:f.dateEvaluationPrevue,onChange:P=>p(q=>({...q,dateEvaluationPrevue:P.target.value}))})]})]})})]})]}),r.jsxs("div",{className:"editor-card",children:[r.jsx("div",{className:"editor-section-title",children:" Pices jointes"}),h.length>0&&r.jsx("div",{className:"pieces-jointes-list",children:h.map(P=>r.jsxs("div",{className:"piece-jointe-item",children:[r.jsx("span",{children:""}),r.jsx("a",{href:P.url,target:"_blank",rel:"noopener noreferrer",children:P.nom}),r.jsxs("span",{style:{color:"#9ca3af",fontSize:"0.75rem"},children:["(",Math.round((P.taille??0)/1024)," Ko)"]}),r.jsx("button",{type:"button",onClick:()=>ee(P.url),style:{background:"none",border:"none",cursor:"pointer",color:"#ef4444",marginLeft:"auto"},children:""})]},P.url))}),r.jsxs("label",{className:"upload-zone",children:[w?"Envoi en cours...":" Cliquer pour ajouter un fichier (PDF, image  max 10 Mo)",r.jsx("input",{type:"file",style:{display:"none"},accept:".pdf,.jpg,.jpeg,.png,.doc,.docx,.ppt,.pptx",onChange:B,disabled:w})]})]}),r.jsxs("div",{className:"editor-card",children:[r.jsx("div",{className:"editor-section-title",children:" Ressources enrichies"}),r.jsx("p",{style:{fontSize:"0.82rem",color:"#6b7280",margin:"0 0 4px"},children:"Ajoutez des liens ou des ebooks pour enrichir cette sance."}),r.jsx(sP,{liens:A,onChange:O}),r.jsx(lP,{ebooksLies:k,onChange:M}),r.jsx(vJ,{userId:n.uid,contenuIA:D,onChange:$})]}),r.jsxs("div",{className:"editor-card",children:[r.jsx("div",{className:"editor-section-title",children:" Notes prives"}),r.jsx("textarea",{className:"form-textarea",placeholder:"Notes personnelles (non visibles par l'administration)...",value:f.notesPrivees,onChange:P=>p(q=>({...q,notesPrivees:P.target.value})),rows:3}),r.jsx("div",{style:{fontSize:"0.75rem",color:"#9ca3af",marginTop:"0.25rem"},children:"Ces notes sont uniquement visibles par vous."})]}),E&&r.jsx("div",{style:{color:"#dc2626",background:"#fee2e2",padding:"0.75rem 1rem",borderRadius:8,marginBottom:"1rem",fontSize:"0.85rem"},children:E}),r.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end",paddingBottom:"2rem"},children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>a(`/prof/cahiers/${e}`),children:"Annuler"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:j,style:{minWidth:160},children:j?"Enregistrement...":U?" Mettre  jour":" Enregistrer la sance"})]})]})]}):null},xJ=50*1024*1024,bJ="image/jpeg,image/png,image/gif,image/webp,audio/mpeg,audio/wav,audio/ogg,video/mp4";function yJ(e){return e.startsWith("image/")?"image":e.startsWith("audio/")?"audio":e.startsWith("video/")?"video":"autre"}function uP(e){return e<1024?`${e} o`:e<1024*1024?`${(e/1024).toFixed(1)} Ko`:`${(e/1024/1024).toFixed(1)} Mo`}const jJ=({src:e,alt:t,onFermer:n})=>r.jsx("div",{className:"image-fullscreen-overlay",onClick:n,role:"dialog","aria-modal":"true","aria-label":"Image en plein cran",children:r.jsx("img",{src:e,alt:t})}),NJ=({pj:e,onSupprimer:t,readonly:n=!1})=>{const[a,l]=g.useState(!1);return r.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,overflow:"hidden",marginBottom:10,background:"#fff"},children:[e.type==="image"&&r.jsxs(r.Fragment,{children:[r.jsx("img",{src:e.url,alt:e.nom,className:"media-image",onClick:()=>l(!0),style:{maxWidth:"100%",display:"block"},loading:"lazy"}),a&&r.jsx(jJ,{src:e.url,alt:e.nom,onFermer:()=>l(!1)})]}),e.type==="audio"&&r.jsx("div",{className:"media-player",children:r.jsxs("audio",{controls:!0,preload:"metadata",children:[r.jsx("source",{src:e.url,type:e.mimeType}),"Votre navigateur ne supporte pas la lecture audio."]})}),e.type==="video"&&r.jsx("div",{className:"media-player",children:r.jsxs("video",{controls:!0,preload:"none",playsInline:!0,children:[r.jsx("source",{src:e.url,type:e.mimeType}),"Votre navigateur ne supporte pas la lecture vido."]})}),(e.type==="pdf"||e.type==="autre")&&r.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center",gap:8,padding:"10px 14px",textDecoration:"none",color:"#2563eb"},children:[" ",e.nom]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 12px",background:"#f9fafb",borderTop:"1px solid #f3f4f6"},children:[r.jsxs("span",{style:{fontSize:"0.78rem",color:"#6b7280",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[e.nom,e.taille&&`  ${uP(e.taille)}`]}),!n&&t&&r.jsx("button",{type:"button",onClick:()=>t(e.id),title:"Supprimer ce fichier",style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af",fontSize:"1rem",padding:"0 4px"},"aria-label":`Supprimer ${e.nom}`,children:""})]})]})},_J=({piecesJointes:e,entreeId:t,profId:n,onChange:a,readonly:l=!1})=>{const o=g.useRef(null),[u,d]=g.useState(null),[f,p]=g.useState("");async function h(b){const x=b.target.files?.[0];if(!x)return;if(x.size>xJ){p(`Fichier trop volumineux (max 50 Mo). Ce fichier fait ${uP(x.size)}.`);return}p("");const j=`${Date.now()}_${x.name}`,N=`cahiers/${n}/${t}/${j}`,w=Lr(Dr,N),C=Mb(w,x);C.on("state_changed",E=>{const S=Math.round(E.bytesTransferred/E.totalBytes*100);d(S)},E=>{p(`Erreur d'envoi : ${E.message}`),d(null)},async()=>{const E=await pa(C.snapshot.ref),S=yJ(x.type),A={id:String(Date.now()),nom:x.name,url:E,type:S,taille:x.size,mimeType:x.type};a([...e,A]),d(null),o.current&&(o.current.value="")})}function v(b){a(e.filter(x=>x.id!==b))}return r.jsxs("section",{"aria-label":"Fichiers mdias",style:{marginTop:20},children:[r.jsx("h4",{style:{fontSize:"0.95rem",fontWeight:600,color:"#111827",margin:"0 0 12px"},children:" Fichiers mdias"}),e.map(b=>r.jsx(NJ,{pj:b,onSupprimer:v,readonly:l},b.id)),e.length===0&&!l&&r.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 12px"},children:"Aucun fichier ajout. Formats accepts : images, audio, vido (max 50 Mo)."}),!l&&r.jsxs(r.Fragment,{children:[u!==null&&r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("div",{style:{height:8,background:"#e5e7eb",borderRadius:9999,overflow:"hidden"},children:r.jsx("div",{style:{height:"100%",width:`${u}%`,background:"#2563eb",transition:"width 0.3s ease"},role:"progressbar","aria-valuenow":u,"aria-valuemin":0,"aria-valuemax":100})}),r.jsxs("p",{style:{fontSize:"0.8rem",color:"#6b7280",margin:"4px 0 0"},children:["Envoi en cours ",u,"%"]})]}),f&&r.jsxs("p",{style:{fontSize:"0.8rem",color:"#dc2626",margin:"0 0 8px"},children:[" ",f]}),r.jsx("input",{ref:o,type:"file",accept:bJ,onChange:h,style:{display:"none"},"aria-label":"Choisir un fichier mdia"}),r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>o.current?.click(),disabled:u!==null,children:" Ajouter un fichier (image / audio / vido)"}),r.jsx("p",{style:{fontSize:"0.75rem",color:"#9ca3af",marginTop:6},children:"Max 50 Mo  JPG, PNG, GIF, WebP, MP3, WAV, OGG, MP4"})]})]})};function SJ(e){return e.toDate().toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}const wJ=()=>{const{cahierId:e}=Jn(),t=lt(),[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState(!0),[f,p]=g.useState(""),[h,v]=g.useState(null);g.useEffect(()=>{async function x(){if(e){d(!0);try{const j=await PZ(e);if(!j){p("Ce cahier n'est pas accessible ou n'existe pas.");return}a(j);const N=await $Z(e);o(N)}catch{p("Une erreur est survenue lors du chargement.")}finally{d(!1)}}}x()},[e]);function b(x){v(j=>j===x?null:x)}return u?r.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"#6b7280"},children:[r.jsx("div",{style:{fontSize:"2rem"},children:""}),r.jsx("p",{children:"Chargement du cahier de textes"})]}):f||!n?r.jsxs("div",{style:{textAlign:"center",padding:"60px 20px"},children:[r.jsx("div",{style:{fontSize:"2.5rem"},children:""}),r.jsx("p",{style:{color:"#dc2626",fontWeight:600},children:f||"Accs non autoris"}),r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>t(-1),style:{marginTop:12},children:" Retour"})]}):r.jsxs("main",{style:{maxWidth:760,margin:"0 auto",padding:"20px 16px"},children:[r.jsxs("header",{className:"eleve-cahier-header",children:[r.jsx("button",{type:"button",onClick:()=>t(-1),style:{background:"rgba(255,255,255,0.2)",border:"none",color:"#fff",cursor:"pointer",borderRadius:8,padding:"4px 10px",fontSize:"0.85rem",marginBottom:10,display:"inline-flex",alignItems:"center",gap:4},children:" Retour"}),r.jsx("h1",{children:n.titre}),r.jsxs("p",{children:[n.matiere,"  ",n.classe,"  ",n.anneeScolaire]}),r.jsx("span",{className:"badge-lecture-seule",children:" Lecture seule  Sances ralises"})]}),n.description&&r.jsx("div",{style:{background:"#f0f9ff",border:"1px solid #bae6fd",borderRadius:10,padding:14,marginBottom:20,fontSize:"0.9rem",color:"#0c4a6e"},children:n.description}),r.jsx("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:16},children:l.length===0?"Aucune sance ralise pour l'instant.":`${l.length} sance${l.length>1?"s":""} ralise${l.length>1?"s":""}`}),l.length===0&&r.jsxs("div",{className:"eleve-vide",children:[r.jsx("span",{className:"emoji",children:""}),r.jsx("p",{children:"Votre professeur n'a pas encore enregistr de sance ralise."}),r.jsx("p",{style:{fontSize:"0.8rem"},children:"Revenez plus tard !"})]}),l.map(x=>{const j=h===x.id,N=(x.piecesJointes?.length??0)>0,w=(x.liens?.length??0)>0,C=(x.ebooksLies?.length??0)>0;return r.jsxs("article",{className:"seance-card-eleve",children:[r.jsxs("button",{type:"button",onClick:()=>b(x.id),style:{width:"100%",background:"none",border:"none",cursor:"pointer",textAlign:"left",padding:0},"aria-expanded":j,"aria-controls":`seance-corps-${x.id}`,children:[r.jsxs("div",{className:"seance-card-eleve-date",children:[" ",SJ(x.date),x.heureDebut?`  ${x.heureDebut}${x.heureFin?`  ${x.heureFin}`:""}`:""]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0},children:x.chapitre}),r.jsx("span",{style:{fontSize:"1.1rem",transition:"transform 0.2s",transform:j?"rotate(180deg)":"rotate(0)",display:"inline-block"},"aria-hidden":"true",children:""})]}),r.jsxs("div",{style:{display:"flex",gap:6,marginTop:6,flexWrap:"wrap"},children:[w&&r.jsx("span",{style:{fontSize:"0.72rem",background:"#eff6ff",color:"#2563eb",padding:"2px 8px",borderRadius:9999},children:" Ressources"}),C&&r.jsx("span",{style:{fontSize:"0.72rem",background:"#fef3c7",color:"#92400e",padding:"2px 8px",borderRadius:9999},children:" Ebooks"}),N&&r.jsx("span",{style:{fontSize:"0.72rem",background:"#f0fdf4",color:"#16a34a",padding:"2px 8px",borderRadius:9999},children:" Mdias"})]})]}),j&&r.jsxs("div",{id:`seance-corps-${x.id}`,style:{marginTop:14,borderTop:"1px solid #f3f4f6",paddingTop:14},children:[x.objectifs&&r.jsxs("div",{style:{background:"#f0fdf4",border:"1px solid #bbf7d0",borderRadius:8,padding:10,fontSize:"0.875rem",color:"#166534",marginBottom:12},children:[r.jsx("strong",{children:" Objectifs :"})," ",x.objectifs]}),r.jsx("div",{className:"seance-card-eleve-contenu",children:x.contenu}),w&&r.jsx(sP,{liens:x.liens??[],onChange:()=>{},readonly:!0}),C&&r.jsx(lP,{ebooksLies:x.ebooksLies??[],onChange:()=>{},readonly:!0}),N&&r.jsx(_J,{piecesJointes:x.piecesJointes??[],entreeId:x.id,profId:"",onChange:()=>{},readonly:!0})]})]},x.id)})]})},ns="sequences_pedagogiques",CJ="entrees_cahier";function dP(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function hp(e){return e.filter(t=>t.estEvaluation&&t.typeEvaluation).map(t=>({id:t.id,titre:t.titre,type:t.typeEvaluation,seanceNumero:t.numero,noteMax:t.noteMax??20,coefficient:t.coefficient??1,datePrevue:t.datePrevue}))}async function EJ(e){const t=Ee(je(K,ns),Se("profId","==",e),Ve("updatedAt","desc"));return(await Ce(t)).docs.map(a=>({id:a.id,...a.data()}))}async function ru(e){const t=await Dt(Ne(K,ns,e));return t.exists()?{id:t.id,...t.data()}:null}async function AJ(e,t){const n=Oe.now(),a=t.seances.map(u=>({...u,id:u.id||dP(),exporterVersCahier:u.exporterVersCahier??!0,entreesCahierIds:u.entreesCahierIds??[]})),l=hp(a);return(await qt(je(K,ns),{...t,profId:e,seances:a,evaluationsPrevues:l,statut:t.statut??"brouillon",genereeParIA:t.genereeParIA??!1,competences:t.competences??[],createdAt:n,updatedAt:n})).id}async function zJ(e,t){const n={...t,updatedAt:Oe.now()};t.seances&&(n.evaluationsPrevues=hp(t.seances)),await Qe(Ne(K,ns,e),n)}async function kJ(e,t){await Qe(Ne(K,ns,e),{statut:t,updatedAt:Oe.now()})}async function mP(e){await rn(Ne(K,ns,e))}async function OJ(e,t){const n=await ru(e);if(!n)throw new Error(`Squence ${e} introuvable`);const a=Oe.now(),l=n.seances.map(u=>({...u,id:dP(),exporterVersCahier:!0,entreesCahierIds:[],datePrevue:void 0}));return(await qt(je(K,ns),{titre:`[Copie] ${n.titre}`,description:n.description,niveau:n.niveau,matiere:n.matiere,theme:n.theme,competences:n.competences,objectifGeneral:n.objectifGeneral,prerequis:n.prerequis,nombreSeances:n.nombreSeances,dureeSeanceMinutes:n.dureeSeanceMinutes,trimestre:n.trimestre,seances:l,evaluationsPrevues:hp(l),genereeParIA:n.genereeParIA,profId:t,statut:"brouillon",groupeClasseId:void 0,groupeClasseNom:void 0,cahierDeTextesId:void 0,cahierDeTextesNom:void 0,createdAt:a,updatedAt:a})).id}async function DJ(e){const{sequenceId:t,cahierDeTextesId:n,profId:a,datesParSeance:l}=e,o=await ru(t);if(!o)throw new Error(`Squence ${t} introuvable`);const u=Oe.now(),d=[],f=[],p=Object.keys(l),h=[...o.seances];for(const v of p){const b=h.findIndex(N=>N.id===v);if(b===-1){f.push(v);continue}const x=h[b],j=l[v];try{const N={cahierId:n,profId:a,date:j,chapitre:x.titre,typeContenu:"cours",contenu:x.contenu,objectifs:x.objectifSpecifique,statut:"planifie",notesPrivees:x.ressources.length>0?`Ressources : ${x.ressources.join(" | ")}`:void 0,isMarqueEvaluation:!1,ordre:b,liens:[],ebooksLies:[],piecesJointes:[]},w=await qt(je(K,CJ),{...N,createdAt:u,updatedAt:u});d.push(w.id),h[b]={...x,exporterVersCahier:!1,entreesCahierIds:[...x.entreesCahierIds??[],w.id]}}catch(N){console.error(`[exporterVersCahier] Erreur sance ${v}:`,N),f.push(v)}}return d.length>0&&await Qe(Ne(K,ns,t),{seances:h,evaluationsPrevues:hp(h),cahierDeTextesId:n,cahierDeTextesNom:o.cahierDeTextesNom??"",exporteAt:u,updatedAt:u}),{nbExportees:d.length,idsEntrees:d,erreurs:f}}function MJ(e,t){return e.filter(n=>{if(t.matiere&&n.matiere!==t.matiere||t.niveau&&n.niveau!==t.niveau||t.statut&&n.statut!==t.statut||t.groupeClasseId&&n.groupeClasseId!==t.groupeClasseId)return!1;if(t.recherche){const a=t.recherche.toLowerCase();if(!(n.titre.toLowerCase().includes(a)||n.matiere.toLowerCase().includes(a)||n.theme.toLowerCase().includes(a)||n.description.toLowerCase().includes(a)))return!1}return!0})}const pf={cours:"Cours",td:"TD",tp:"TP",evaluation:"valuation",revision:"Rvision",projet:"Projet",correction:"Correction"},jj={formative:"Formative",sommative:"Sommative",diagnostique:"Diagnostique",devoir:"Devoir sur table",composition:"Composition (BFEM/BAC)",interrogation:"Interrogation"},vp={brouillon:{label:"Brouillon",couleur:"#6b7280"},active:{label:"En cours",couleur:"#2563eb"},terminee:{label:"Termine",couleur:"#16a34a"},archivee:{label:"Archive",couleur:"#9ca3af"}},PJ=[{valeur:"6eme",label:"6me"},{valeur:"5eme",label:"5me"},{valeur:"4eme",label:"4me"},{valeur:"3eme",label:"3me (BFEM)"},{valeur:"2nde",label:"2nde"},{valeur:"1ere",label:"1re"},{valeur:"terminale",label:"Terminale (BAC)"}],hf=[30,45,55,60,90,120],TJ=({statut:e})=>{const{label:t}=vp[e];return r.jsxs("span",{className:`statut-badge statut-badge--${e}`,children:[r.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:"currentColor",display:"inline-block"}}),t]})},qJ=({sequence:e,onView:t,onEdit:n,onDuplicate:a,onDelete:l})=>{const o=e.seances.filter(u=>u.estEvaluation).length;return r.jsxs("article",{className:"sequence-card",onClick:t,role:"button",tabIndex:0,onKeyDown:u=>u.key==="Enter"&&t(),children:[r.jsxs("div",{className:"sequence-card__badges",children:[r.jsx(TJ,{statut:e.statut}),e.genereeParIA&&r.jsx("span",{className:"badge-ia",children:" IA"})]}),r.jsx("h3",{className:"sequence-card__title",children:e.titre}),r.jsxs("div",{className:"sequence-card__meta",children:[r.jsx("span",{className:"sequence-card__meta-chip",children:e.matiere}),r.jsx("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:e.niveau}),e.trimestre&&r.jsxs("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:["T",e.trimestre]})]}),e.description&&r.jsx("p",{className:"sequence-card__desc",children:e.description}),r.jsxs("div",{className:"sequence-card__footer",children:[r.jsxs("span",{className:"sequence-card__seances-count",children:[" ",e.seances.length," sance",e.seances.length>1?"s":"",o>0&&`   ${o} val.`]}),e.groupeClasseNom&&r.jsxs("span",{className:"sequence-card__groupe",children:[" ",e.groupeClasseNom]})]}),r.jsxs("div",{className:"sequence-card__actions",onClick:u=>u.stopPropagation(),children:[r.jsx("button",{className:"sequence-card__action-btn",onClick:n,title:"Modifier","aria-label":"Modifier la squence",children:""}),r.jsx("button",{className:"sequence-card__action-btn",onClick:a,title:"Dupliquer","aria-label":"Dupliquer la squence",children:""}),r.jsx("button",{className:"sequence-card__action-btn sequence-card__action-btn--danger",onClick:l,title:"Supprimer","aria-label":"Supprimer la squence",children:""})]})]})},RJ=()=>{const e=lt(),{currentUser:t}=Ze(),{matieres:n}=Zs(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,f]=g.useState(null),[p,h]=g.useState(null),[v,b]=g.useState({matiere:"",niveau:"",statut:"",recherche:""}),x=g.useCallback(async()=>{if(t?.uid){u(!0),f(null);try{const S=await EJ(t.uid);l(S)}catch(S){console.error("[SequencesPage] Chargement:",S),f("Impossible de charger vos squences. Vrifiez votre connexion.")}finally{u(!1)}}},[t?.uid]);if(g.useEffect(()=>{x()},[x]),!t?.isPremium&&t?.role!=="admin")return r.jsxs("div",{className:"premium-gate",children:[r.jsx("span",{className:"premium-gate__icon",children:""}),r.jsx("h2",{className:"premium-gate__title",children:"Fonctionnalit Premium"}),r.jsx("p",{className:"premium-gate__text",children:"Le Gnrateur de Squences Pdagogiques est rserv aux enseignants Premium. Passez  Premium pour crer des squences structures et les exporter vers votre Cahier de Textes."}),r.jsx("button",{className:"btn-primary",onClick:()=>e("/prof/premium"),children:" Passer  Premium  2 000 FCFA/mois"})]});const j=MJ(a,v),N=n.length>0?n.map(S=>S.valeur):[...new Set(a.map(S=>S.matiere))].sort(),w=async S=>{if(window.confirm(`Supprimer la squence "${S.titre}" ?

Cette action est irrversible.`)){h(S.id);try{await mP(S.id),l(O=>O.filter(k=>k.id!==S.id))}catch(O){console.error("[SequencesPage] Suppression:",O),f("Erreur lors de la suppression. Ressayez.")}finally{h(null)}}},C=async S=>{if(t?.uid){h(S.id);try{const A=await OJ(S.id,t.uid);e(`/prof/sequences/${A}/modifier`)}catch(A){console.error("[SequencesPage] Duplication:",A),f("Erreur lors de la duplication. Ressayez."),h(null)}}},E={total:a.length,active:a.filter(S=>S.statut==="active").length,terminee:a.filter(S=>S.statut==="terminee").length,ia:a.filter(S=>S.genereeParIA).length};return r.jsxs("div",{className:"sequences-page",children:[r.jsxs("div",{className:"sequences-page__header",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"sequences-page__title",children:" Squences Pdagogiques"}),r.jsxs("p",{className:"sequences-page__subtitle",children:[E.total," squence",E.total>1?"s":"",E.active>0&&`  ${E.active} en cours`,E.ia>0&&`  ${E.ia} assiste${E.ia>1?"s":""} par IA`]})]}),r.jsx("button",{className:"sequences-page__btn-new",onClick:()=>e("/prof/sequences/nouvelle"),children:"+ Nouvelle squence"})]}),d&&r.jsxs("div",{className:"error-banner",role:"alert",children:[" ",d,r.jsx("button",{onClick:x,style:{marginLeft:"auto",background:"none",border:"none",cursor:"pointer",color:"#dc2626",fontWeight:600},children:"Ressayer"})]}),r.jsxs("div",{className:"sequences-filters",role:"search",children:[r.jsx("input",{type:"search",className:"sequences-filters__search",placeholder:" Rechercher une squence...",value:v.recherche??"",onChange:S=>b(A=>({...A,recherche:S.target.value})),"aria-label":"Rechercher une squence"}),r.jsxs("select",{className:"sequences-filters__select",value:v.matiere??"",onChange:S=>b(A=>({...A,matiere:S.target.value})),"aria-label":"Filtrer par matire",children:[r.jsx("option",{value:"",children:"Toutes les matires"}),N.map(S=>r.jsx("option",{value:S,children:S},S))]}),r.jsxs("select",{className:"sequences-filters__select",value:v.niveau??"",onChange:S=>b(A=>({...A,niveau:S.target.value})),"aria-label":"Filtrer par niveau",children:[r.jsx("option",{value:"",children:"Tous les niveaux"}),Xs.map(S=>r.jsx("option",{value:S,children:S},S))]}),r.jsxs("select",{className:"sequences-filters__select",value:v.statut??"",onChange:S=>b(A=>({...A,statut:S.target.value})),"aria-label":"Filtrer par statut",children:[r.jsx("option",{value:"",children:"Tous les statuts"}),Object.entries(vp).map(([S,{label:A}])=>r.jsx("option",{value:S,children:A},S))]})]}),o?r.jsx("div",{className:"sequences-grid",children:[1,2,3].map(S=>r.jsxs("div",{className:"sequence-card",style:{minHeight:180},children:[r.jsx("div",{className:"skeleton",style:{height:20,width:"40%",marginBottom:10}}),r.jsx("div",{className:"skeleton",style:{height:22,width:"80%",marginBottom:8}}),r.jsx("div",{className:"skeleton",style:{height:14,width:"60%"}})]},S))}):r.jsx("div",{className:"sequences-grid",role:"list",children:j.length===0?r.jsxs("div",{className:"sequences-empty",children:[r.jsx("span",{className:"sequences-empty__icon",children:""}),r.jsx("p",{className:"sequences-empty__text",children:a.length===0?"Aucune squence pour l'instant":"Aucune squence ne correspond  vos filtres"}),r.jsx("p",{className:"sequences-empty__hint",children:a.length===0?'Cliquez sur "+ Nouvelle squence" pour commencer':"Modifiez ou effacez les filtres pour voir plus de rsultats"})]}):j.map(S=>r.jsx("div",{role:"listitem",style:{opacity:p===S.id?.6:1},children:r.jsx(qJ,{sequence:S,onView:()=>e(`/prof/sequences/${S.id}`),onEdit:()=>e(`/prof/sequences/${S.id}/modifier`),onDuplicate:()=>C(S),onDelete:()=>w(S)})},S.id))})]})},IJ="https://votre-app.railway.app",LJ=["cours","td","tp","evaluation","revision","projet","correction"],$J=["formative","sommative","diagnostique","devoir","composition","interrogation"];function BJ(e){return LJ.includes(e)?e:"cours"}function UJ(e){if(e)return $J.includes(e)?e:"formative"}function FJ(e){if(!e||typeof e!="object")throw new Error("Rponse IA invalide : non-objet");if(!Array.isArray(e.seances)||e.seances.length===0)throw new Error("Rponse IA invalide : tableau seances absent ou vide");const t=e.seances.map((n,a)=>({numero:Number(n.numero)||a+1,titre:String(n.titre??`Sance ${a+1}`),dureeMinutes:Number(n.dureeMinutes)||55,objectifSpecifique:String(n.objectifSpecifique??""),contenu:String(n.contenu??""),ressources:Array.isArray(n.ressources)?n.ressources.map(String):[],typeActivite:BJ(String(n.typeActivite??"cours")),estEvaluation:!!n.estEvaluation,typeEvaluation:UJ(n.typeEvaluation),noteMax:typeof n.noteMax=="number"?n.noteMax:void 0,coefficient:typeof n.coefficient=="number"?n.coefficient:void 0}));return{titre:String(e.titre??""),description:String(e.description??""),objectifGeneral:String(e.objectifGeneral??""),prerequis:String(e.prerequis??""),competences:Array.isArray(e.competences)?e.competences.map(String):[],seances:t}}function GJ(){return`Tu es un expert en ingnierie pdagogique pour le systme ducatif sngalais 
(programme du Ministre de l'ducation Nationale du Sngal).

Tu gnres des squences pdagogiques structures pour des professeurs du secondaire 
(collges et lyces sngalais, niveaux 6me  Terminale).

RPONDRE UNIQUEMENT EN JSON valide. Aucun texte avant ou aprs le JSON.
Aucune balise markdown, aucun \`\`\`json.

Structure JSON attendue :
{
  "titre": "string",
  "description": "string (2-3 phrases contextuelles)",
  "objectifGeneral": "string (formulation en termes de comptences, verbes d'action)",
  "prerequis": "string (connaissances ncessaires avant cette squence)",
  "competences": ["string", "string", ...],
  "seances": [
    {
      "numero": 1,
      "titre": "string",
      "dureeMinutes": 55,
      "objectifSpecifique": "string (verbe d'action + contenu)",
      "contenu": "string (droulement dtaill de la sance)",
      "ressources": ["string", ...],
      "typeActivite": "cours|td|tp|evaluation|revision|projet|correction",
      "estEvaluation": false,
      "typeEvaluation": null,
      "noteMax": null,
      "coefficient": null
    }
  ]
}

Rgles :
- Respecte les programmes officiels sngalais
- Les trimestres au Sngal : 1er (Oct-Dc), 2me (Jan-Mars), 3me (Avr-Juin)
- Inclure des sances de rvision avant les valuations
- Pour les valuations (estEvaluation=true), prciser typeEvaluation
- Les contenus doivent tre adapts aux ralits sngalaises (exemples locaux)
- Note maximale habituelle : 20 (systme franais)
- Niveaux  fort enjeu : 3me (BFEM), Terminale (BAC)
- Langue : franais`}async function HJ(e){const t=`
Gnre une squence pdagogique complte pour :
- Matire : ${e.matiere}
- Niveau : ${e.niveau}
- Thme/Chapitre : ${e.theme}
- Nombre de sances : ${e.nombreSeances}
- Dure par sance : ${e.dureeSeanceMinutes} minutes
${e.trimestre?`- Trimestre : ${e.trimestre}me trimestre`:""}
${e.instructionsSupplementaires?`- Instructions supplmentaires : ${e.instructionsSupplementaires}`:""}

Distribue intelligemment les sances : cours  TD/TP  rvision  valuation.
Assure-toi que les objectifs spcifiques sont progressifs et mesurables.
  `.trim();let n;try{n=await fetch(`${IJ}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({systemPrompt:GJ(),userPrompt:t,maxTokens:4e3})})}catch{throw new Error("Impossible de contacter le serveur IA. Vrifiez votre connexion Internet.")}if(!n.ok){const d=await n.text().catch(()=>"Erreur inconnue");throw new Error(`Erreur serveur IA (${n.status}) : ${d}`)}const a=await n.json(),l=a.content??a.result??a.text??"";if(!l)throw new Error("Rponse IA vide  le serveur a renvoy un contenu vide.");const o=l.replace(/^```json\s*/i,"").replace(/^```\s*/,"").replace(/```\s*$/,"").trim();let u;try{u=JSON.parse(o)}catch{throw new Error(`Rponse IA non parsable : ${o.substring(0,200)}...`)}return FJ(u)}function fP(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function QJ(e){return{id:fP(),numero:e,titre:"",dureeMinutes:55,objectifSpecifique:"",contenu:"",ressources:[],typeActivite:"cours",estEvaluation:!1,exporterVersCahier:!0,entreesCahierIds:[]}}const VJ=({seance:e,onChange:t,onDelete:n,onMoveUp:a,onMoveDown:l,isFirst:o,isLast:u})=>{const[d,f]=g.useState(e.titre===""),[p,h]=g.useState(""),v=j=>t({...e,...j}),b=()=>{const j=p.trim();j&&(v({ressources:[...e.ressources,j]}),h(""))},x=j=>v({ressources:e.ressources.filter((N,w)=>w!==j)});return r.jsxs("div",{className:"seance-card",children:[r.jsxs("div",{className:"seance-card__header",onClick:()=>f(j=>!j),children:[r.jsx("div",{className:`seance-card__numero${e.estEvaluation?" seance-card__numero--eval":""}`,children:e.numero}),r.jsx("span",{className:"seance-card__header-title",children:e.titre||`Sance ${e.numero} (sans titre)`}),r.jsxs("div",{className:"seance-card__header-badges",children:[r.jsx("span",{className:`type-activite-badge type-activite-badge--${e.typeActivite}`,children:pf[e.typeActivite]}),r.jsxs("span",{style:{fontSize:"0.75rem",color:"#64748b"},children:[e.dureeMinutes,"min"]})]}),r.jsx("span",{className:`seance-card__toggle-icon${d?" seance-card__toggle-icon--open":""}`,children:""})]}),d&&r.jsxs("div",{className:"seance-card__body",children:[r.jsxs("div",{className:"editor-form-grid",children:[r.jsxs("div",{className:"form-group editor-form-grid--full",children:[r.jsxs("label",{children:["Titre de la sance ",r.jsx("span",{className:"required",children:"*"})]}),r.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Introduction aux vecteurs",value:e.titre,onChange:j=>v({titre:j.target.value})})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Type d'activit"}),r.jsx("select",{className:"form-control",value:e.typeActivite,onChange:j=>v({typeActivite:j.target.value,estEvaluation:j.target.value==="evaluation"?!0:e.estEvaluation}),children:Object.entries(pf).map(([j,N])=>r.jsx("option",{value:j,children:N},j))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Dure (minutes)"}),r.jsxs("select",{className:"form-control",value:e.dureeMinutes,onChange:j=>v({dureeMinutes:Number(j.target.value)}),children:[hf.map(j=>r.jsxs("option",{value:j,children:[j," min"]},j)),r.jsx("option",{value:e.dureeMinutes,children:hf.includes(e.dureeMinutes)?null:`${e.dureeMinutes} min (personnalis)`})]})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Objectif spcifique"}),r.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Ex : L'lve sera capable de calculer le module d'un vecteur",value:e.objectifSpecifique,onChange:j=>v({objectifSpecifique:j.target.value}),rows:2})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Contenu / Droulement"}),r.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Dcrivez le droulement de la sance : activits, tapes, mthodes...",value:e.contenu,onChange:j=>v({contenu:j.target.value}),rows:4})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Supports / Ressources"}),e.ressources.length>0&&r.jsx("div",{className:"timeline-card__ressources",style:{marginBottom:6},children:e.ressources.map((j,N)=>r.jsxs("span",{className:"ressource-chip",style:{cursor:"pointer"},onClick:()=>x(N),title:"Cliquer pour supprimer",children:[j," "]},N))}),r.jsxs("div",{className:"competence-input-row",children:[r.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Manuel p.42, GeoGebra, Calculatrice...",value:p,onChange:j=>h(j.target.value),onKeyDown:j=>j.key==="Enter"&&(j.preventDefault(),b())}),r.jsx("button",{type:"button",className:"btn-add-competence",onClick:b,children:"+ Ajouter"})]})]}),r.jsx("div",{className:"form-group",children:r.jsxs("label",{style:{flexDirection:"row",alignItems:"center",display:"flex",gap:8},children:[r.jsx("input",{type:"checkbox",checked:e.estEvaluation,onChange:j=>v({estEvaluation:j.target.checked,typeEvaluation:j.target.checked?e.typeEvaluation??"formative":void 0}),style:{width:16,height:16,accentColor:"#2563eb"}}),"Cette sance est une valuation"]})}),e.estEvaluation&&r.jsxs("div",{className:"editor-form-grid",style:{background:"#fef2f2",padding:12,borderRadius:8,border:"1px solid #fecaca"},children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Type d'valuation"}),r.jsx("select",{className:"form-control",value:e.typeEvaluation??"formative",onChange:j=>v({typeEvaluation:j.target.value}),children:Object.entries(jj).map(([j,N])=>r.jsx("option",{value:j,children:N},j))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Note maximale"}),r.jsx("input",{type:"number",className:"form-control",min:1,max:100,value:e.noteMax??20,onChange:j=>v({noteMax:Number(j.target.value)})})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Coefficient"}),r.jsx("input",{type:"number",className:"form-control",min:1,max:10,step:.5,value:e.coefficient??1,onChange:j=>v({coefficient:Number(j.target.value)})})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{style:{flexDirection:"row",alignItems:"center",display:"flex",gap:8},children:[r.jsx("input",{type:"checkbox",checked:e.exporterVersCahier,onChange:j=>v({exporterVersCahier:j.target.checked}),style:{width:16,height:16,accentColor:"#2563eb"}}),"Inclure dans l'export vers le Cahier de Textes"]}),e.entreesCahierIds&&e.entreesCahierIds.length>0&&r.jsxs("span",{className:"export-seance-row__exported",style:{marginTop:4},children:[" Dj exporte (",e.entreesCahierIds.length," entre",e.entreesCahierIds.length>1?"s":"",")"]})]}),r.jsxs("div",{className:"seance-card__actions",children:[r.jsx("button",{type:"button",className:"btn-seance-action btn-secondary",onClick:a,disabled:o,title:"Monter",children:""}),r.jsx("button",{type:"button",className:"btn-seance-action btn-secondary",onClick:l,disabled:u,title:"Descendre",children:""}),r.jsx("button",{type:"button",className:"btn-seance-action btn-seance-action--delete",onClick:n,children:" Supprimer cette sance"})]})]})]})},YJ=({onSequenceGeneree:e,defaultMatiere:t,defaultNiveau:n,matieres:a})=>{const[l,o]=g.useState(t??""),[u,d]=g.useState(n??""),[f,p]=g.useState(""),[h,v]=g.useState(8),[b,x]=g.useState(55),[j,N]=g.useState(1),[w,C]=g.useState(""),[E,S]=g.useState(!1),[A,O]=g.useState({type:"idle",message:""}),k=async()=>{if(!l||!u||!f){O({type:"error",message:"Veuillez remplir la matire, le niveau et le thme."});return}S(!0),O({type:"loading",message:"L'IA gnre votre squence... (30-45 secondes)"});try{const M=await HJ({matiere:l,niveau:u,theme:f,nombreSeances:h,dureeSeanceMinutes:b,trimestre:j,instructionsSupplementaires:w||void 0}),D=M.seances.map($=>({...$,ressources:$.ressources??[]}));e({titre:M.titre,description:M.description,objectifGeneral:M.objectifGeneral,prerequis:M.prerequis,competences:M.competences,seances:D}),O({type:"success",message:` Squence gnre avec ${D.length} sances ! Vrifiez et compltez les informations.`})}catch(M){const D=M instanceof Error?M.message:"Erreur inconnue";O({type:"error",message:`Erreur IA : ${D}`})}finally{S(!1)}};return r.jsxs("div",{className:"ia-panel",children:[r.jsx("h3",{className:"ia-panel__title",children:" Gnration assiste par IA"}),r.jsx("p",{className:"ia-panel__subtitle",children:"Dcrivez votre squence et Claude gnre la structure complte"}),r.jsxs("div",{className:"ia-panel__form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Matire ",r.jsx("span",{className:"required",children:"*"})]}),r.jsxs("select",{className:"form-control",value:l,onChange:M=>o(M.target.value),children:[r.jsx("option",{value:"",children:"Slectionner..."}),a.map(M=>r.jsx("option",{value:M,children:M},M))]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Niveau ",r.jsx("span",{className:"required",children:"*"})]}),r.jsxs("select",{className:"form-control",value:u,onChange:M=>d(M.target.value),children:[r.jsx("option",{value:"",children:"Slectionner..."}),Xs.map(M=>r.jsx("option",{value:M,children:M},M))]})]}),r.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[r.jsxs("label",{children:["Thme / Chapitre ",r.jsx("span",{className:"required",children:"*"})]}),r.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Les fonctions affines, La photosynthse, La Rvolution franaise...",value:f,onChange:M=>p(M.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre de sances"}),r.jsx("input",{type:"number",className:"form-control",min:2,max:25,value:h,onChange:M=>v(Number(M.target.value))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Dure par sance"}),r.jsx("select",{className:"form-control",value:b,onChange:M=>x(Number(M.target.value)),children:hf.map(M=>r.jsxs("option",{value:M,children:[M," min"]},M))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Trimestre"}),r.jsxs("select",{className:"form-control",value:j,onChange:M=>N(Number(M.target.value)),children:[r.jsx("option",{value:1,children:"1er trimestre (OctDc)"}),r.jsx("option",{value:2,children:"2me trimestre (JanMars)"}),r.jsx("option",{value:3,children:"3me trimestre (AvrJuin)"})]})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Instructions supplmentaires (optionnel)"}),r.jsx("textarea",{className:"ia-panel__instructions",placeholder:"Ex : Insister sur la rsolution graphique, Inclure un TP sur GeoGebra, Prvoir une sance de remdiation...",value:w,onChange:M=>C(M.target.value),rows:2})]}),r.jsxs("button",{type:"button",className:"ia-panel__btn-generate",onClick:k,disabled:E,children:[E?r.jsx("span",{className:"spinner"}):"",E?"Gnration en cours...":"Gnrer avec l'IA"]}),A.type!=="idle"&&r.jsxs("div",{className:`ia-panel__status ia-panel__status--${A.type}`,children:[A.type==="loading"&&r.jsx("span",{className:"spinner spinner--blue"}),A.message]})]})},ZE=()=>{const e=lt(),{id:t}=Jn(),{currentUser:n}=Ze(),{matieres:a}=Zs(),l=!!t,[o,u]=g.useState({titre:"",description:"",niveau:"",matiere:"",theme:"",competences:[],objectifGeneral:"",prerequis:"",nombreSeances:6,dureeSeanceMinutes:55,seances:[],evaluationsPrevues:[],statut:"brouillon",genereeParIA:!1,trimestre:void 0,groupeClasseId:void 0,groupeClasseNom:void 0,cahierDeTextesId:void 0,cahierDeTextesNom:void 0}),[d,f]=g.useState([]),[p,h]=g.useState([]),[v,b]=g.useState([]),[x,j]=g.useState(l),[N,w]=g.useState(!1),[C,E]=g.useState(null),[S,A]=g.useState(null),[O,k]=g.useState(""),[M,D]=g.useState(!l);g.useEffect(()=>{(async()=>{if(!n?.uid)return;const[W,I]=await Promise.all([rP(n.uid).catch(()=>[]),iP(n.uid).catch(()=>[])]);if(h(W),b(I),l&&t){j(!0);try{const re=await ru(t);if(!re){E("Squence introuvable.");return}if(re.profId!==n.uid){E("Accs non autoris.");return}u({titre:re.titre,description:re.description,niveau:re.niveau,matiere:re.matiere,theme:re.theme,competences:re.competences,objectifGeneral:re.objectifGeneral,prerequis:re.prerequis,nombreSeances:re.nombreSeances,dureeSeanceMinutes:re.dureeSeanceMinutes,statut:re.statut,genereeParIA:re.genereeParIA,trimestre:re.trimestre,groupeClasseId:re.groupeClasseId,groupeClasseNom:re.groupeClasseNom,cahierDeTextesId:re.cahierDeTextesId,cahierDeTextesNom:re.cahierDeTextesNom}),f(re.seances)}catch{E("Erreur de chargement. Ressayez.")}finally{j(!1)}}})()},[n?.uid,t,l]);const $=()=>{f(R=>[...R,QJ(R.length+1)])},U=(R,W)=>{f(I=>I.map((re,V)=>V===R?W:re))},L=R=>{f(W=>W.filter((I,re)=>re!==R).map((I,re)=>({...I,numero:re+1})))},B=R=>{R!==0&&f(W=>{const I=[...W];return[I[R-1],I[R]]=[I[R],I[R-1]],I.map((re,V)=>({...re,numero:V+1}))})},ee=R=>{f(W=>{if(R===W.length-1)return W;const I=[...W];return[I[R],I[R+1]]=[I[R+1],I[R]],I.map((re,V)=>({...re,numero:V+1}))})},se=()=>{const R=O.trim();R&&(u(W=>({...W,competences:[...W.competences??[],R]})),k(""))},P=R=>{u(W=>({...W,competences:(W.competences??[]).filter((I,re)=>re!==R)}))},q=R=>{u(I=>({...I,titre:R.titre,description:R.description,objectifGeneral:R.objectifGeneral,prerequis:R.prerequis,competences:R.competences,genereeParIA:!0}));const W=R.seances.map(I=>({...I,id:fP(),exporterVersCahier:!0,entreesCahierIds:[]}));f(W),D(!1),window.scrollTo({top:0,behavior:"smooth"})},F=async()=>{if(!n?.uid)return;if(!o.titre?.trim()){E("Le titre est obligatoire.");return}if(!o.matiere?.trim()){E("La matire est obligatoire.");return}if(!o.niveau?.trim()){E("Le niveau est obligatoire.");return}const R=d.find(V=>!V.titre.trim());if(R){E(`La sance n${R.numero} n'a pas de titre.`);return}w(!0),E(null);const W=v.find(V=>V.id===o.groupeClasseId),I=p.find(V=>V.id===o.cahierDeTextesId),re={titre:o.titre.trim(),description:o.description?.trim()??"",niveau:o.niveau,matiere:o.matiere.trim(),theme:o.theme?.trim()??"",competences:o.competences??[],objectifGeneral:o.objectifGeneral?.trim()??"",prerequis:o.prerequis?.trim()??"",nombreSeances:d.length,dureeSeanceMinutes:o.dureeSeanceMinutes??55,statut:o.statut??"brouillon",genereeParIA:o.genereeParIA??!1,trimestre:o.trimestre??null,seances:d,evaluationsPrevues:[],groupeClasseId:o.groupeClasseId||null,groupeClasseNom:W?.nom||o.groupeClasseNom||null,cahierDeTextesId:o.cahierDeTextesId||null,cahierDeTextesNom:I?.titre||o.cahierDeTextesNom||null};try{if(l&&t)await zJ(t,re),A("Squence mise  jour avec succs !"),setTimeout(()=>e(`/prof/sequences/${t}`),1200);else{const V=await AJ(n.uid,re);A("Squence cre avec succs !"),setTimeout(()=>e(`/prof/sequences/${V}`),1200)}}catch(V){console.error("[SequenceEditorPage] Sauvegarde:",V),E("Erreur lors de la sauvegarde. Ressayez.")}finally{w(!1)}};return x?r.jsxs("div",{className:"sequence-editor",children:[r.jsx("div",{className:"skeleton",style:{height:30,width:"50%",marginBottom:20}}),r.jsx("div",{className:"skeleton",style:{height:200,borderRadius:12}})]}):r.jsxs("div",{className:"sequence-editor",children:[r.jsxs("div",{className:"sequence-editor__header",children:[r.jsxs("p",{className:"sequence-editor__breadcrumb",children:[r.jsx("a",{onClick:()=>e("/prof/sequences"),style:{cursor:"pointer"},children:" Squences"})," / ",l?"Modifier":"Nouvelle squence"]}),r.jsx("h1",{className:"sequence-editor__title",children:l?" Modifier la squence":" Nouvelle squence"})]}),C&&r.jsxs("div",{className:"error-banner",role:"alert",children:[" ",C]}),S&&r.jsxs("div",{className:"success-banner",role:"status",children:[" ",S]}),r.jsx("div",{style:{marginBottom:8},children:r.jsx("button",{type:"button",className:"btn-secondary",style:{marginBottom:12},onClick:()=>D(R=>!R),children:M?" Masquer":" Gnrer avec l'IA"})}),M&&r.jsx(YJ,{onSequenceGeneree:q,defaultMatiere:o.matiere,defaultNiveau:o.niveau,matieres:a.map(R=>R.valeur)}),r.jsxs("section",{className:"editor-section",children:[r.jsx("h2",{className:"editor-section__title",children:" Informations gnrales"}),r.jsxs("div",{className:"editor-form-grid",children:[r.jsxs("div",{className:"form-group editor-form-grid--full",children:[r.jsxs("label",{children:["Titre de la squence ",r.jsx("span",{className:"required",children:"*"})]}),r.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Les fonctions affines  Terminale S",value:o.titre??"",onChange:R=>u(W=>({...W,titre:R.target.value})),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Matire ",r.jsx("span",{className:"required",children:"*"})]}),r.jsxs("select",{className:"form-control",value:o.matiere??"",onChange:R=>u(W=>({...W,matiere:R.target.value})),children:[r.jsx("option",{value:"",children:"Slectionner..."}),a.map(R=>r.jsx("option",{value:R.valeur,children:R.label},R.valeur))]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Niveau ",r.jsx("span",{className:"required",children:"*"})]}),r.jsxs("select",{className:"form-control",value:o.niveau??"",onChange:R=>u(W=>({...W,niveau:R.target.value})),children:[r.jsx("option",{value:"",children:"Slectionner..."}),Xs.map(R=>r.jsx("option",{value:R,children:R},R))]})]}),r.jsxs("div",{className:"form-group editor-form-grid--full",children:[r.jsx("label",{children:"Thme / Chapitre du programme"}),r.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Chapitre 4  Les vecteurs du plan",value:o.theme??"",onChange:R=>u(W=>({...W,theme:R.target.value}))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Trimestre"}),r.jsxs("select",{className:"form-control",value:o.trimestre??"",onChange:R=>u(W=>({...W,trimestre:R.target.value?Number(R.target.value):void 0})),children:[r.jsx("option",{value:"",children:"Non prcis"}),r.jsx("option",{value:"1",children:"1er trimestre (OctDc)"}),r.jsx("option",{value:"2",children:"2me trimestre (JanMars)"}),r.jsx("option",{value:"3",children:"3me trimestre (AvrJuin)"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Dure standard d'une sance"}),r.jsx("select",{className:"form-control",value:o.dureeSeanceMinutes??55,onChange:R=>u(W=>({...W,dureeSeanceMinutes:Number(R.target.value)})),children:hf.map(R=>r.jsxs("option",{value:R,children:[R," minutes"]},R))})]}),r.jsxs("div",{className:"form-group editor-form-grid--full",children:[r.jsx("label",{children:"Description / Contexte"}),r.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Contexte de la squence dans le programme, niveau de la classe, prrequis globaux...",value:o.description??"",onChange:R=>u(W=>({...W,description:R.target.value})),rows:3})]}),r.jsxs("div",{className:"form-group editor-form-grid--full",children:[r.jsx("label",{children:"Objectif gnral"}),r.jsx("textarea",{className:"form-control form-control--textarea",placeholder:" la fin de cette squence, les lves seront capables de...",value:o.objectifGeneral??"",onChange:R=>u(W=>({...W,objectifGeneral:R.target.value})),rows:2})]}),r.jsxs("div",{className:"form-group editor-form-grid--full",children:[r.jsx("label",{children:"Prrequis"}),r.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Connaissances ncessaires avant cette squence...",value:o.prerequis??"",onChange:R=>u(W=>({...W,prerequis:R.target.value})),rows:2})]})]}),r.jsxs("div",{className:"form-group",style:{marginTop:14},children:[r.jsx("label",{children:"Comptences vises"}),r.jsx("div",{className:"competences-list",children:(o.competences??[]).map((R,W)=>r.jsxs("span",{className:"competence-tag",children:[R,r.jsx("button",{type:"button",className:"competence-tag__remove",onClick:()=>P(W),"aria-label":"Supprimer la comptence",children:""})]},W))}),r.jsxs("div",{className:"competence-input-row",children:[r.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Rsoudre une quation du second degr",value:O,onChange:R=>k(R.target.value),onKeyDown:R=>R.key==="Enter"&&(R.preventDefault(),se())}),r.jsx("button",{type:"button",className:"btn-add-competence",onClick:se,children:"+ Ajouter"})]})]})]}),r.jsxs("section",{className:"editor-section",children:[r.jsx("h2",{className:"editor-section__title",children:" Liens optionnels"}),r.jsxs("div",{className:"editor-form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Groupe-classe"}),r.jsxs("select",{className:"form-control",value:o.groupeClasseId??"",onChange:R=>u(W=>({...W,groupeClasseId:R.target.value||void 0})),children:[r.jsx("option",{value:"",children:"Aucun groupe"}),v.map(R=>r.jsxs("option",{value:R.id,children:[R.nom,"  ",R.classe]},R.id))]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Cahier de Textes"}),r.jsxs("select",{className:"form-control",value:o.cahierDeTextesId??"",onChange:R=>u(W=>({...W,cahierDeTextesId:R.target.value||void 0})),children:[r.jsx("option",{value:"",children:" Aucun cahier "}),p.filter(R=>o.matiere&&o.niveau?R.matiere===o.matiere&&R.classe===o.niveau:o.matiere?R.matiere===o.matiere:o.niveau?R.classe===o.niveau:!0).map(R=>r.jsxs("option",{value:R.id,children:[R.titre,"  ",R.classe,"  ",R.anneeScolaire]},R.id))]}),o.niveau&&o.matiere&&p.filter(R=>R.classe===o.niveau&&R.matiere===o.matiere).length===0&&r.jsxs("p",{style:{fontSize:"0.8rem",color:"#f59e0b",marginTop:6},children:[" Aucun cahier pour ",o.matiere,"  ",o.niveau,"."," ",r.jsx("a",{href:"/prof/cahiers",style:{color:"#2563eb",textDecoration:"underline"},children:"Crer un cahier"})]}),(!o.niveau||!o.matiere)&&p.length>0&&r.jsx("p",{style:{fontSize:"0.8rem",color:"#94a3b8",marginTop:6},children:" Slectionnez la matire et le niveau pour filtrer les cahiers."})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Statut"}),r.jsxs("select",{className:"form-control",value:o.statut??"brouillon",onChange:R=>u(W=>({...W,statut:R.target.value})),children:[r.jsx("option",{value:"brouillon",children:"Brouillon"}),r.jsx("option",{value:"active",children:"En cours"}),r.jsx("option",{value:"terminee",children:"Termine"}),r.jsx("option",{value:"archivee",children:"Archive"})]})]})]})]}),r.jsxs("section",{className:"editor-section",children:[r.jsxs("div",{className:"seances-editor__header",children:[r.jsx("h2",{className:"editor-section__title",style:{margin:0},children:" Sances"}),r.jsxs("span",{className:"seances-editor__count",children:[d.length," sance",d.length>1?"s":"",d.filter(R=>R.estEvaluation).length>0&&`  ${d.filter(R=>R.estEvaluation).length} val.`]})]}),r.jsx("div",{className:"seances-list",children:d.length===0?r.jsx("p",{style:{color:"#94a3b8",fontSize:"0.875rem",textAlign:"center",padding:"20px 0"},children:"Aucune sance. Utilisez le bouton ci-dessous ou gnrez avec l'IA."}):d.map((R,W)=>r.jsx(VJ,{seance:R,onChange:I=>U(W,I),onDelete:()=>L(W),onMoveUp:()=>B(W),onMoveDown:()=>ee(W),isFirst:W===0,isLast:W===d.length-1},R.id))}),r.jsx("button",{type:"button",className:"btn-add-seance",style:{marginTop:14},onClick:$,children:"+ Ajouter une sance"})]}),r.jsxs("div",{style:{position:"sticky",bottom:16,display:"flex",justifyContent:"flex-end",gap:10,background:"rgba(248,250,252,0.95)",backdropFilter:"blur(6px)",padding:"12px 0",zIndex:10},children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>e("/prof/sequences"),disabled:N,children:"Annuler"}),r.jsx("button",{type:"button",className:"btn-primary",onClick:F,disabled:N,children:N?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"spinner"})," Enregistrement..."]}):l?" Mettre  jour":" Crer la squence"})]})]})},KJ=({statut:e})=>{const{label:t}=vp[e];return r.jsxs("span",{className:`statut-badge statut-badge--${e}`,children:[r.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:"currentColor",display:"inline-block"}}),t]})},WJ=({sequence:e,cahiers:t,profId:n,onClose:a,onSuccess:l})=>{const[o,u]=g.useState(e.cahierDeTextesId??(t.length===1?t[0].id:"")),[d,f]=g.useState(()=>{const C=new Date().toISOString().split("T")[0],E={};return e.seances.forEach(S=>{E[S.id]=C}),E}),[p,h]=g.useState(()=>{const C={};return e.seances.forEach(E=>{C[E.id]=E.exporterVersCahier&&(!E.entreesCahierIds||E.entreesCahierIds.length===0)}),C}),[v,b]=g.useState(!1),[x,j]=g.useState(null),N=Object.values(p).filter(Boolean).length,w=async()=>{if(!o){j("Veuillez slectionner un Cahier de Textes.");return}if(N===0){j("Slectionnez au moins une sance  exporter.");return}b(!0),j(null);const C={};e.seances.filter(E=>p[E.id]).forEach(E=>{const S=d[E.id];if(S){const A=Oe.fromDate(new Date(S+"T08:00:00"));C[E.id]=A}});try{const E=await DJ({sequenceId:e.id,cahierDeTextesId:o,profId:n,datesParSeance:C});E.erreurs.length>0&&j(`${E.erreurs.length} sance(s) n'ont pas pu tre exportes.`),l(E.nbExportees)}catch(E){const S=E instanceof Error?E.message:"Erreur inconnue";j(`Erreur d'export : ${S}`)}finally{b(!1)}};return g.useEffect(()=>{const C=E=>{E.key==="Escape"&&a()};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[a]),r.jsx("div",{className:"export-modal__overlay",onClick:C=>C.target===C.currentTarget&&a(),children:r.jsxs("div",{className:"export-modal",role:"dialog","aria-modal":"true","aria-labelledby":"export-modal-title",children:[r.jsxs("div",{className:"export-modal__header",children:[r.jsx("h2",{className:"export-modal__title",id:"export-modal-title",children:" Exporter vers le Cahier de Textes"}),r.jsx("button",{className:"export-modal__close",onClick:a,"aria-label":"Fermer",children:""})]}),r.jsxs("div",{className:"export-modal__body",children:[r.jsxs("div",{className:"form-group",style:{marginBottom:16},children:[r.jsxs("label",{style:{fontWeight:600,marginBottom:6,display:"block"},children:["Cahier de Textes cible ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),t.length===0?r.jsx("p",{style:{color:"#dc2626",fontSize:"0.875rem"},children:"Aucun Cahier de Textes trouv. Crez-en un d'abord."}):r.jsxs("select",{className:"form-control",value:o,onChange:C=>u(C.target.value),children:[r.jsx("option",{value:"",children:"Slectionner un cahier..."}),t.map(C=>r.jsxs("option",{value:C.id,children:[C.titre,"  ",C.classe," (",C.anneeScolaire,")"]},C.id))]})]}),r.jsx("p",{style:{fontSize:"0.8125rem",color:"#64748b",marginBottom:12},children:"Slectionnez les sances  exporter et assignez leur une date. Chaque sance deviendra une entre dans le Cahier de Textes."}),e.seances.map(C=>{const E=(C.entreesCahierIds?.length??0)>0;return r.jsxs("div",{className:"export-seance-row",children:[r.jsx("input",{type:"checkbox",className:"export-seance-row__check",checked:!!p[C.id],onChange:S=>h(A=>({...A,[C.id]:S.target.checked})),id:`export-${C.id}`,"aria-label":`Exporter la sance ${C.numero}`}),r.jsxs("div",{className:"export-seance-row__info",children:[r.jsx("label",{htmlFor:`export-${C.id}`,style:{cursor:"pointer"},children:r.jsxs("div",{className:"export-seance-row__titre",children:[C.numero,". ",C.titre||`Sance ${C.numero}`]})}),r.jsxs("div",{className:"export-seance-row__type",children:[pf[C.typeActivite],"  ",C.dureeMinutes,"min",E&&r.jsx("span",{className:"export-seance-row__exported",style:{marginLeft:6},children:" Dj exporte"})]})]}),r.jsx("input",{type:"date",className:"export-seance-row__date",value:d[C.id]??"",onChange:S=>f(A=>({...A,[C.id]:S.target.value})),disabled:!p[C.id],"aria-label":`Date pour la sance ${C.numero}`})]},C.id)}),x&&r.jsxs("div",{className:"error-banner",style:{marginTop:12},children:[" ",x]})]}),r.jsxs("div",{className:"export-modal__footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:a,disabled:v,children:"Annuler"}),r.jsx("button",{type:"button",className:"btn-success",onClick:w,disabled:v||N===0||!o,children:v?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"spinner"})," Export en cours..."]}):` Exporter ${N} sance${N>1?"s":""}`})]})]})})},XJ=()=>{const e=lt(),{id:t}=Jn(),{currentUser:n}=Ze(),[a,l]=g.useState(null),[o,u]=g.useState([]),[d,f]=g.useState(!0),[p,h]=g.useState(null),[v,b]=g.useState(null),[x,j]=g.useState("seances"),[N,w]=g.useState(!1);g.useEffect(()=>{(async()=>{if(!(!n?.uid||!t)){f(!0);try{const[k,M]=await Promise.all([ru(t),rP(n.uid)]);if(!k){h("Squence introuvable.");return}if(k.profId!==n.uid){h("Accs non autoris.");return}l(k),u(M)}catch{h("Erreur de chargement.")}finally{f(!1)}}})()},[n?.uid,t]);const C=async()=>{if(!(!a||!window.confirm(`Supprimer "${a.titre}" ?
Cette action est irrversible.`)))try{await mP(a.id),e("/prof/sequences")}catch{h("Erreur lors de la suppression.")}},E=async O=>{if(a)try{await kJ(a.id,O),l(k=>k?{...k,statut:O}:null)}catch{h("Erreur de mise  jour du statut.")}},S=O=>{w(!1),b(` ${O} sance${O>1?"s":""} exporte${O>1?"s":""} vers le Cahier de Textes !`),t&&ru(t).then(k=>k&&l(k)).catch(()=>null),setTimeout(()=>b(null),5e3)};if(d)return r.jsxs("div",{className:"sequence-detail",children:[r.jsx("div",{className:"skeleton",style:{height:28,width:"50%",marginBottom:20}}),r.jsx("div",{className:"skeleton",style:{height:180,borderRadius:12,marginBottom:20}}),r.jsx("div",{className:"skeleton",style:{height:400,borderRadius:12}})]});if(p||!a)return r.jsxs("div",{className:"sequence-detail",children:[r.jsxs("div",{className:"error-banner",children:[" ",p??"Squence introuvable."]}),r.jsx("button",{className:"btn-secondary",onClick:()=>e("/prof/sequences"),children:" Retour"})]});const A=PJ.find(O=>O.valeur===a.niveau)?.label??a.niveau;return r.jsxs("div",{className:"sequence-detail",children:[N&&r.jsx(WJ,{sequence:a,cahiers:o,profId:n.uid,onClose:()=>w(!1),onSuccess:S}),p&&r.jsxs("div",{className:"error-banner",role:"alert",children:[" ",p]}),v&&r.jsx("div",{className:"success-banner",role:"status",children:v}),r.jsxs("div",{className:"sequence-detail__header",children:[r.jsxs("p",{style:{fontSize:"0.8125rem",color:"#64748b",marginBottom:8},children:[r.jsx("a",{onClick:()=>e("/prof/sequences"),style:{color:"#2563eb",cursor:"pointer",fontWeight:500},children:" Squences"})," / ",a.titre]}),r.jsxs("div",{className:"sequence-detail__header-top",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"sequence-detail__title",children:a.titre}),r.jsxs("div",{className:"sequence-detail__meta",style:{marginTop:8},children:[r.jsx(KJ,{statut:a.statut}),a.genereeParIA&&r.jsx("span",{className:"badge-ia",children:" IA"}),r.jsx("span",{className:"sequence-card__meta-chip",children:a.matiere}),r.jsx("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:A}),a.trimestre&&r.jsxs("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:["T",a.trimestre]}),a.groupeClasseNom&&r.jsxs("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:[" ",a.groupeClasseNom]})]})]}),r.jsxs("div",{className:"sequence-detail__actions",children:[r.jsx("select",{className:"form-control",style:{width:"auto",fontSize:"0.8rem"},value:a.statut,onChange:O=>E(O.target.value),"aria-label":"Changer le statut",children:Object.entries(vp).map(([O,{label:k}])=>r.jsx("option",{value:O,children:k},O))}),r.jsx("button",{className:"btn-success",onClick:()=>w(!0),title:"Exporter les sances vers le Cahier de Textes",children:" Exporter"}),r.jsx("button",{className:"btn-secondary",onClick:()=>e(`/prof/sequences/${a.id}/modifier`),children:" Modifier"}),r.jsx("button",{className:"btn-danger",onClick:C,children:""})]})]}),a.objectifGeneral&&r.jsxs("div",{className:"sequence-detail__objectif",children:[r.jsx("strong",{children:" Objectif :"})," ",a.objectifGeneral]}),r.jsxs("div",{style:{display:"flex",gap:16,marginTop:12,flexWrap:"wrap",fontSize:"0.8125rem",color:"#64748b"},children:[r.jsxs("span",{children:[" ",a.seances.length," sances"]}),r.jsxs("span",{children:[" ",a.evaluationsPrevues.length," valuation",a.evaluationsPrevues.length>1?"s":""]}),r.jsxs("span",{children:[" ",a.seances.reduce((O,k)=>O+k.dureeMinutes,0)," min total"]}),a.cahierDeTextesNom&&r.jsxs("span",{children:[" ",a.cahierDeTextesNom]}),a.exporteAt&&r.jsxs("span",{children:[" Export le ",a.exporteAt.toDate().toLocaleDateString("fr-FR")]})]})]}),r.jsxs("div",{className:"sequence-tabs",role:"tablist",children:[r.jsxs("button",{role:"tab",className:`sequence-tab${x==="seances"?" sequence-tab--active":""}`,onClick:()=>j("seances"),"aria-selected":x==="seances",children:[" Sances (",a.seances.length,")"]}),r.jsxs("button",{role:"tab",className:`sequence-tab${x==="evaluations"?" sequence-tab--active":""}`,onClick:()=>j("evaluations"),"aria-selected":x==="evaluations",children:[" valuations (",a.evaluationsPrevues.length,")"]}),r.jsx("button",{role:"tab",className:`sequence-tab${x==="infos"?" sequence-tab--active":""}`,onClick:()=>j("infos"),"aria-selected":x==="infos",children:" Dtails"})]}),x==="seances"&&r.jsx("div",{role:"tabpanel",children:a.seances.length===0?r.jsxs("div",{className:"sequences-empty",children:[r.jsx("span",{className:"sequences-empty__icon",children:""}),r.jsx("p",{className:"sequences-empty__text",children:"Aucune sance planifie"}),r.jsx("button",{className:"btn-primary",onClick:()=>e(`/prof/sequences/${a.id}/modifier`),children:" Ajouter des sances"})]}):r.jsx("div",{className:"sequence-timeline",children:a.seances.map(O=>r.jsx(ZJ,{seance:O},O.id))})}),x==="evaluations"&&r.jsxs("div",{role:"tabpanel",className:"evaluations-panel",children:[r.jsx("h3",{className:"evaluations-panel__title",children:" valuations prvues"}),a.evaluationsPrevues.length===0?r.jsx("p",{style:{color:"#94a3b8",fontSize:"0.875rem"},children:'Aucune valuation marque dans cette squence. Modifiez une sance et cochez "Cette sance est une valuation".'}):a.evaluationsPrevues.map(O=>r.jsxs("div",{className:"evaluation-row",children:[r.jsxs("div",{className:"evaluation-row__numero",children:["S",O.seanceNumero]}),r.jsxs("div",{className:"evaluation-row__info",children:[r.jsx("div",{className:"evaluation-row__titre",children:O.titre}),r.jsxs("div",{className:"evaluation-row__type",children:[jj[O.type],O.datePrevue&&`  ${O.datePrevue.toDate().toLocaleDateString("fr-FR")}`]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"evaluation-row__note",children:["/",O.noteMax]}),r.jsxs("div",{className:"evaluation-row__coeff",children:["Coeff. ",O.coefficient]})]})]},O.id))]}),x==="infos"&&r.jsx("div",{role:"tabpanel",children:r.jsxs("div",{className:"editor-section",children:[a.competences.length>0&&r.jsxs("div",{style:{marginBottom:16},children:[r.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:700,color:"#374151",marginBottom:8},children:"Comptences vises"}),r.jsx("div",{className:"competences-list",children:a.competences.map((O,k)=>r.jsx("span",{className:"competence-tag",children:O},k))})]}),a.prerequis&&r.jsxs("div",{style:{marginBottom:16},children:[r.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:700,color:"#374151",marginBottom:6},children:"Prrequis"}),r.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",lineHeight:1.6},children:a.prerequis})]}),a.description&&r.jsxs("div",{style:{marginBottom:16},children:[r.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:700,color:"#374151",marginBottom:6},children:"Description"}),r.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",lineHeight:1.6},children:a.description})]}),r.jsxs("div",{style:{borderTop:"1px solid #f1f5f9",paddingTop:12,fontSize:"0.8rem",color:"#94a3b8"},children:[r.jsxs("p",{children:["Cre le ",a.createdAt.toDate().toLocaleDateString("fr-FR")]}),r.jsxs("p",{children:["Modifie le ",a.updatedAt.toDate().toLocaleDateString("fr-FR")]}),a.genereeParIA&&r.jsx("p",{children:" Gnre avec l'IA Claude"})]})]})})]})},ZJ=({seance:e})=>{const[t,n]=g.useState(!1),a=(e.entreesCahierIds?.length??0)>0;return r.jsx("div",{className:`timeline-item${e.estEvaluation?" timeline-item--eval":""}`,children:r.jsxs("div",{className:"timeline-card",children:[r.jsxs("div",{className:"timeline-card__header",onClick:()=>n(l=>!l),style:{cursor:"pointer"},children:[r.jsxs("h3",{className:"timeline-card__title",children:[e.numero,". ",e.titre||`Sance ${e.numero}`]}),r.jsxs("div",{className:"timeline-card__meta",children:[r.jsx("span",{className:`type-activite-badge type-activite-badge--${e.typeActivite}`,children:pf[e.typeActivite]}),r.jsxs("span",{className:"timeline-card__duree",children:[e.dureeMinutes,"min"]}),a&&r.jsx("span",{className:"export-seance-row__exported",children:" Exporte"}),r.jsx("span",{style:{color:"#94a3b8",fontSize:"0.7rem"},children:t?"":""})]})]}),e.objectifSpecifique&&r.jsxs("p",{className:"timeline-card__objectif",children:[" ",e.objectifSpecifique]}),t&&r.jsxs(r.Fragment,{children:[e.contenu&&r.jsx("p",{className:"timeline-card__contenu",style:{marginTop:8},children:e.contenu}),e.ressources.length>0&&r.jsx("div",{className:"timeline-card__ressources",children:e.ressources.map((l,o)=>r.jsx("span",{className:"ressource-chip",children:l},o))}),e.estEvaluation&&e.typeEvaluation&&r.jsxs("div",{style:{marginTop:10,padding:"8px 12px",background:"#fef2f2",borderRadius:6,fontSize:"0.8rem",color:"#dc2626"},children:[" ",jj[e.typeEvaluation],e.noteMax&&`  /${e.noteMax}`,e.coefficient&&`  Coeff. ${e.coefficient}`]})]})]})})};function JJ({cours:e,onClick:t}){const n=e.dureeEstimee>=60?`${Math.floor(e.dureeEstimee/60)}h${e.dureeEstimee%60>0?e.dureeEstimee%60:""}`:`${e.dureeEstimee} min`,a=Lc.find(l=>l.valeur===e.niveau)?.label??e.niveau;return r.jsxs("article",{className:"cours-card",onClick:t,role:"button",tabIndex:0,onKeyDown:l=>l.key==="Enter"&&t(),"aria-label":`Cours : ${e.titre}`,children:[r.jsxs("div",{className:"cours-card__cover",children:[e.couvertureUrl?r.jsx("img",{src:e.couvertureUrl,alt:e.titre,loading:"lazy"}):r.jsx("div",{className:"cours-card__cover-placeholder",children:r.jsx("span",{children:e.matiere.charAt(0)})}),e.isPremium&&r.jsx("span",{className:"cours-card__badge cours-card__badge--premium",children:" Premium"}),!e.isPremium&&r.jsx("span",{className:"cours-card__badge cours-card__badge--gratuit",children:" Gratuit"})]}),r.jsxs("div",{className:"cours-card__body",children:[r.jsxs("div",{className:"cours-card__meta",children:[r.jsx("span",{className:"cours-card__matiere",children:e.matiere}),r.jsx("span",{className:"cours-card__niveau",children:a})]}),r.jsx("h3",{className:"cours-card__titre",children:e.titre}),r.jsx("p",{className:"cours-card__description",children:e.description}),r.jsxs("div",{className:"cours-card__footer",children:[r.jsxs("span",{className:"cours-card__prof",children:[" ",e.profNom]}),r.jsxs("div",{className:"cours-card__stats",children:[r.jsxs("span",{children:[" ",e.nombreSections," section",e.nombreSections>1?"s":""]}),r.jsxs("span",{children:[" ",n]}),r.jsxs("span",{children:[" ",e.nombreInscrits]})]})]})]})]})}function eee(){const e=lt(),{currentUser:t}=Ze(),{matieres:n}=Zs(),a=t?.subscriptionPlan,l=t?.isPremium&&a&&Ib(a),[o,u]=g.useState([]),[d,f]=g.useState([]),[p,h]=g.useState(!0),[v,b]=g.useState(null),[x,j]=g.useState({matiere:"",niveau:"",recherche:"",isPremium:""});g.useEffect(()=>{N()},[]);async function N(){h(!0),b(null);try{const S=await bA();u(S),f(S)}catch(S){console.error("[CoursPage] Erreur chargement :",S),b("Impossible de charger les cours. Vrifiez votre connexion.")}finally{h(!1)}}const w=g.useCallback(S=>{j(S);let A=[...o];if(S.matiere&&(A=A.filter(O=>O.matiere===S.matiere)),S.niveau&&(A=A.filter(O=>O.niveau===S.niveau)),S.isPremium!==""&&S.isPremium!==void 0&&(A=A.filter(O=>O.isPremium===S.isPremium)),S.recherche){const O=S.recherche.toLowerCase();A=A.filter(k=>k.titre.toLowerCase().includes(O)||k.description.toLowerCase().includes(O)||k.matiere.toLowerCase().includes(O)||k.tags.some(M=>M.toLowerCase().includes(O)))}f(A)},[o]),C=()=>{j({matiere:"",niveau:"",recherche:"",isPremium:""}),f(o)},E=!!(x.matiere||x.niveau||x.recherche||x.isPremium!=="");return r.jsxs("div",{className:"cours-catalogue",children:[r.jsx("section",{className:"cours-catalogue__hero","aria-label":"Introduction aux cours",children:r.jsxs("div",{className:"cours-catalogue__hero-content",children:[r.jsx("h1",{className:"cours-catalogue__hero-titre",children:" Cours en ligne"}),r.jsx("p",{className:"cours-catalogue__hero-sous-titre",children:"Des cours complets du programme sngalais  de la 6me au Bac. Crs par vos professeurs, accessibles partout, mme hors-ligne."}),l&&r.jsx("button",{className:"btn-primary",onClick:()=>e("/premium/mes-cours"),style:{marginTop:"1rem"},children:" Choisir mes cours"}),r.jsxs("div",{className:"cours-catalogue__hero-stats","aria-label":"Statistiques de la plateforme",children:[r.jsxs("div",{className:"cours-catalogue__stat",children:[r.jsx("span",{className:"cours-catalogue__stat-val",children:o.length}),r.jsx("span",{className:"cours-catalogue__stat-label",children:"Cours disponibles"})]}),r.jsxs("div",{className:"cours-catalogue__stat",children:[r.jsx("span",{className:"cours-catalogue__stat-val",children:o.filter(S=>!S.isPremium).length}),r.jsx("span",{className:"cours-catalogue__stat-label",children:"Cours gratuits"})]}),r.jsxs("div",{className:"cours-catalogue__stat",children:[r.jsx("span",{className:"cours-catalogue__stat-val",children:[...new Set(o.map(S=>S.matiere))].length}),r.jsx("span",{className:"cours-catalogue__stat-label",children:"Matires"})]})]})]})}),r.jsx("section",{className:"cours-catalogue__filtres","aria-label":"Filtres de recherche",children:r.jsxs("div",{className:"cours-catalogue__filtres-inner",children:[r.jsxs("div",{className:"cours-catalogue__search",children:[r.jsx("span",{className:"cours-catalogue__search-icon","aria-hidden":"true",children:""}),r.jsx("input",{type:"search",placeholder:"Rechercher un cours, une matire, un tag...",value:x.recherche,onChange:S=>w({...x,recherche:S.target.value}),className:"cours-catalogue__search-input","aria-label":"Rechercher dans les cours"})]}),r.jsxs("select",{value:x.matiere,onChange:S=>w({...x,matiere:S.target.value}),className:"cours-catalogue__select","aria-label":"Filtrer par matire",children:[r.jsx("option",{value:"",children:"Toutes les matires"}),n.map(S=>r.jsx("option",{value:S.valeur,children:S.label},S.valeur))]}),r.jsxs("select",{value:x.niveau,onChange:S=>w({...x,niveau:S.target.value}),className:"cours-catalogue__select","aria-label":"Filtrer par niveau",children:[r.jsx("option",{value:"",children:"Tous les niveaux"}),Xs.map(S=>r.jsx("option",{value:S,children:S},S))]}),r.jsxs("select",{value:String(x.isPremium),onChange:S=>{const A=S.target.value===""?"":S.target.value==="true";w({...x,isPremium:A})},className:"cours-catalogue__select","aria-label":"Filtrer par accs",children:[r.jsx("option",{value:"",children:"Tous les accs"}),r.jsx("option",{value:"false",children:" Gratuits"}),r.jsx("option",{value:"true",children:" Premium"})]}),E&&r.jsx("button",{className:"btn-secondary btn--sm",onClick:C,"aria-label":"Effacer les filtres",children:" Effacer les filtres"})]})}),r.jsxs("main",{className:"cours-catalogue__contenu",children:[v&&r.jsxs("div",{className:"error-banner",role:"alert",children:[" ",v,r.jsx("button",{className:"btn-link",onClick:N,children:"Ressayer"})]}),p&&r.jsx("div",{className:"cours-catalogue__grille","aria-busy":"true","aria-label":"Chargement des cours",children:[1,2,3,4,5,6].map(S=>r.jsxs("div",{className:"cours-card cours-card--skeleton",children:[r.jsx("div",{className:"skeleton cours-card__cover"}),r.jsxs("div",{className:"cours-card__body",children:[r.jsx("div",{className:"skeleton",style:{height:16,width:"60%",marginBottom:8}}),r.jsx("div",{className:"skeleton",style:{height:20,marginBottom:8}}),r.jsx("div",{className:"skeleton",style:{height:14,width:"80%"}})]})]},S))}),!p&&d.length>0&&r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"cours-catalogue__compteur","aria-live":"polite",children:[d.length," cours trouv",d.length>1?"s":"",E&&" pour ces critres"]}),r.jsx("div",{className:"cours-catalogue__grille",children:d.map(S=>r.jsx(JJ,{cours:S,onClick:()=>e(`/cours/${S.id}`)},S.id))})]}),!p&&d.length===0&&!v&&r.jsxs("div",{className:"cours-catalogue__vide",role:"status",children:[r.jsx("span",{"aria-hidden":"true",children:""}),r.jsx("h3",{children:"Aucun cours trouv"}),r.jsx("p",{children:E?"Essayez de modifier ou supprimer vos filtres.":"Les cours seront disponibles bientt. Revenez dans quelques jours !"}),E&&r.jsx("button",{className:"btn-secondary",onClick:C,children:"Afficher tous les cours"})]})]})]})}const Ys="progression_cours";async function JE(e,t){const n=Ee(je(K,Ys),Se("userId","==",e),Se("coursId","==",t)),a=await Ce(n);if(a.empty)return null;const l=a.docs[0];return{id:l.id,...l.data()}}async function tee(e){const t=Ee(je(K,Ys),Se("coursId","==",e));return(await Ce(t)).docs.map(a=>({id:a.id,...a.data()}))}async function ree(e,t){const n=Oe.now(),a=await qt(je(K,Ys),{userId:e,coursId:t,sectionsLues:[],reponsesQuiz:[],pourcentageProgression:0,scoreQuiz:0,tentativesQuiz:0,debutLe:n,dernierAcces:n,estTermine:!1});return await N5(t),a.id}async function nee(e,t,n){const a=await Dt(Ne(K,Ys,e));if(!a.exists())return;const l=a.data();if(l.sectionsLues.includes(t))return;const o=[...l.sectionsLues,t],u=Math.round(o.length/n*100),d=o.length>=n;await Qe(Ne(K,Ys,e),{sectionsLues:Db(t),pourcentageProgression:u,estTermine:d,dernierAcces:Oe.now()})}async function aee(e,t){const n=await Dt(Ne(K,Ys,e));if(!n.exists())return;const a=n.data(),l=a.reponsesQuiz??[];if(l.some(p=>p.blocId===t.blocId))return;const u=[...l,t],d=u.filter(p=>p.estCorrecte).length,f=u.length>0?Math.round(d/u.length*100):0;await Qe(Ne(K,Ys,e),{reponsesQuiz:Db(t),scoreQuiz:f,tentativesQuiz:a.tentativesQuiz+1,dernierAcces:Oe.now()})}function iee(e){if(e.length===0)return{nombreInscrits:0,nombreTermines:0,tauxCompletion:0,progressionMoyenne:0,scoreMoyen:0};const t=e.filter(l=>l.estTermine).length,n=Math.round(e.reduce((l,o)=>l+o.pourcentageProgression,0)/e.length),a=Math.round(e.reduce((l,o)=>l+o.scoreQuiz,0)/e.length);return{nombreInscrits:e.length,nombreTermines:t,tauxCompletion:Math.round(t/e.length*100),progressionMoyenne:n,scoreMoyen:a}}function see({bloc:e}){const t=e.contenu.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/^- (.+)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)/gs,"<ul>$1</ul>").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br/>");return r.jsx("div",{className:"bloc-texte",dangerouslySetInnerHTML:{__html:`<p>${t}</p>`}})}function lee({bloc:e}){return r.jsxs("figure",{className:"bloc-image",children:[r.jsx("img",{src:e.url,alt:e.alt,loading:"lazy"}),e.legende&&r.jsx("figcaption",{children:e.legende})]})}function oee({bloc:e}){const t=d5(e.urlYoutube);return t?r.jsxs("div",{className:"bloc-video",children:[e.titre&&r.jsxs("h4",{className:"bloc-video__titre",children:[" ",e.titre]}),e.description&&r.jsx("p",{className:"bloc-video__description",children:e.description}),r.jsx("div",{className:"bloc-video__embed",children:r.jsx("iframe",{src:`https://www.youtube.com/embed/${t}`,title:e.titre||"Vido pdagogique",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy"})})]}):null}function cee({bloc:e}){const t=EA[e.variante];return r.jsxs("div",{className:"bloc-encadre",style:{background:t.bg,borderLeftColor:t.border,color:t.color},children:[r.jsxs("p",{className:"bloc-encadre__titre",children:[t.emoji," ",e.titre]}),r.jsx("p",{className:"bloc-encadre__contenu",children:e.contenu})]})}function uee({bloc:e,onReponse:t,reponseExistante:n}){const[a,l]=g.useState(n??null),o=a!==null;function u(d,f){o||(l(d),t(d,f))}return r.jsxs("div",{className:"bloc-quiz",children:[r.jsxs("p",{className:"bloc-quiz__question",children:[" ",e.question]}),r.jsx("div",{className:"bloc-quiz__options",children:e.options.map(d=>{let f="";return o&&(d.id===a?f=d.estCorrecte?"correct":"incorrect":d.estCorrecte&&(f="attendu")),r.jsxs("button",{className:`bloc-quiz__option bloc-quiz__option--${f||"neutre"}`,onClick:()=>u(d.id,d.estCorrecte),disabled:o,"aria-pressed":d.id===a,children:[f==="correct"&&" ",f==="incorrect"&&" ",f==="attendu"&&" ",d.texte]},d.id)})}),o&&e.explication&&r.jsxs("div",{className:"bloc-quiz__explication",children:[" ",r.jsx("strong",{children:"Explication :"})," ",e.explication]})]})}function dee({bloc:e}){const[t,n]=g.useState(!1),a={facile:"#16a34a",moyen:"#ca8a04",difficile:"#dc2626"};return r.jsxs("div",{className:"bloc-exercice",children:[r.jsxs("div",{className:"bloc-exercice__header",children:[r.jsx("span",{className:"bloc-exercice__titre",children:" Exercice"}),r.jsxs("span",{className:"bloc-exercice__difficulte",style:{color:a[e.difficulte]},children:[e.difficulte.charAt(0).toUpperCase()+e.difficulte.slice(1),e.points&&`  ${e.points} pt${e.points>1?"s":""}`]})]}),r.jsx("p",{className:"bloc-exercice__enonce",children:e.enonce}),t?r.jsxs("div",{className:"bloc-exercice__correction",children:[r.jsx("p",{className:"bloc-exercice__correction-titre",children:" Correction"}),r.jsx("p",{children:e.correction})]}):r.jsx("button",{className:"btn-secondary btn--sm",onClick:()=>n(!0),children:" Voir la correction"})]})}function mee({bloc:e,isPremiumVerrou:t,onReponseQuiz:n,reponseExistante:a}){if(t)return r.jsxs("div",{className:"bloc-premium-verrou","aria-label":"Contenu Premium",children:[r.jsx("span",{children:""}),r.jsx("p",{children:"Ce contenu est rserv aux abonns Premium."})]});switch(e.type){case"texte":return r.jsx(see,{bloc:e});case"image":return r.jsx(lee,{bloc:e});case"video":return r.jsx(oee,{bloc:e});case"encadre":return r.jsx(cee,{bloc:e});case"quiz":return r.jsx(uee,{bloc:e,reponseExistante:a,onReponse:(l,o)=>n(e.id,l,o)});case"exercice":return r.jsx(dee,{bloc:e});default:return null}}function fee(){const{coursId:e}=Jn(),t=lt(),{currentUser:n}=Ze(),a=n?.isPremium??!1,l=a&&E5(e||"",a,n?.subscriptionPlan,n?.coursChoisis??[]),[o,u]=g.useState(null),[d,f]=g.useState([]),[p,h]=g.useState(null),[v,b]=g.useState(null),[x,j]=g.useState(!0),[N,w]=g.useState(null),C=g.useRef(null);g.useEffect(()=>{e&&E()},[e,n]);async function E(){if(e){j(!0),w(null);try{const[U,L]=await Promise.all([yA(e),jA(e)]);if(!U||U.statut!=="publie"){w("Ce cours n'est pas disponible."),j(!1);return}if(u(U),f(L),L.length>0&&b(L[0].id),n){let B=await JE(n.uid,e);B||(await ree(n.uid,e),B=await JE(n.uid,e)),h(B)}}catch(U){console.error("[CoursDetailPage] Erreur chargement :",U),w("Erreur de chargement. Vrifiez votre connexion.")}finally{j(!1)}}}function S(U){const L=U.blocs.filter(P=>P.type==="quiz");if(L.length===0)return!0;const B=p?.reponsesQuiz.filter(P=>L.some(q=>q.id===P.blocId))??[];return B.length<L.length?!1:B.filter(P=>P.estCorrecte).length/L.length*100>=60}async function A(U){if(!n||!p||!o||p.sectionsLues.includes(U))return;const L=d.find(B=>B.id===U);if(L&&!S(L)){w("Russissez les quiz de cette section (60% minimum) pour continuer.");return}try{await nee(p.id,U,o.nombreSections),h(B=>B?{...B,sectionsLues:[...B.sectionsLues,U],pourcentageProgression:Math.round((B.sectionsLues.length+1)/o.nombreSections*100)}:null)}catch(B){console.error("[CoursDetailPage] Erreur marquer section :",B)}}async function O(U,L,B){if(!(!n||!p))try{await aee(p.id,{blocId:U,optionChoisieId:L,estCorrecte:B,reponduAt:Oe.now()})}catch(ee){console.error("[CoursDetailPage] Erreur enregistrement quiz :",ee)}}function k(U){return!!(U.estGratuite||U.ordre===1||!o?.isPremium||l)}if(x)return r.jsxs("div",{className:"cours-detail__loading","aria-busy":"true",children:[r.jsx("div",{className:"spinner spinner--blue"}),r.jsx("p",{children:"Chargement du cours..."})]});if(N||!o)return r.jsxs("div",{className:"cours-detail__erreur",role:"alert",children:[r.jsx("span",{"aria-hidden":"true",children:""}),r.jsx("p",{children:N??"Cours introuvable."}),r.jsx("button",{className:"btn-secondary",onClick:()=>t("/cours"),children:" Retour au catalogue"})]});const M=Lc.find(U=>U.valeur===o.niveau)?.label??o.niveau,D=d.find(U=>U.id===v),$=D?k(D):!1;return r.jsxs("div",{className:"cours-detail",children:[r.jsxs("header",{className:"cours-detail__header",children:[r.jsxs("p",{className:"cours-detail__breadcrumb",children:[r.jsx("button",{className:"btn-link",onClick:()=>t("/cours"),children:" Cours"})," / ",r.jsx("span",{children:o.matiere})," / ",r.jsx("span",{children:o.titre})]}),r.jsxs("div",{className:"cours-detail__header-grid",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"cours-detail__badges",children:[r.jsx("span",{className:"badge badge--matiere",children:o.matiere}),r.jsx("span",{className:"badge badge--niveau",children:M}),o.isPremium?r.jsx("span",{className:"badge badge--premium",children:" Premium"}):r.jsx("span",{className:"badge badge--gratuit",children:" Gratuit"})]}),r.jsx("h1",{className:"cours-detail__titre",children:o.titre}),r.jsx("p",{className:"cours-detail__description",children:o.description}),r.jsxs("p",{className:"cours-detail__prof",children:[" Cours de ",r.jsx("strong",{children:o.profNom})]}),o.objectifs.length>0&&r.jsxs("div",{className:"cours-detail__objectifs",children:[r.jsx("h3",{children:" Objectifs du cours"}),r.jsx("ul",{children:o.objectifs.map((U,L)=>r.jsx("li",{children:U},L))})]})]}),n&&p&&r.jsxs("div",{className:"cours-detail__progression-card",children:[r.jsx("h3",{children:" Ma progression"}),r.jsx("div",{className:"progression-bar",children:r.jsx("div",{className:"progression-bar__fill",style:{width:`${p.pourcentageProgression}%`},role:"progressbar","aria-valuenow":p.pourcentageProgression,"aria-valuemin":0,"aria-valuemax":100})}),r.jsxs("p",{className:"progression-bar__label",children:[p.pourcentageProgression,"%  ",p.sectionsLues.length,"/",o.nombreSections," section",o.nombreSections>1?"s":""," lue",p.sectionsLues.length>1?"s":""]}),p.scoreQuiz>0&&r.jsxs("p",{className:"progression-bar__score",children:[" Score quiz : ",r.jsxs("strong",{children:[p.scoreQuiz,"%"]})]}),p.estTermine&&r.jsx("div",{className:"cours-detail__termine-badge",children:" Cours termin !"})]})]})]}),r.jsxs("div",{className:"cours-detail__layout",children:[r.jsxs("nav",{className:"cours-detail__sidebar","aria-label":"Sections du cours",children:[r.jsx("h2",{className:"cours-detail__sidebar-titre",children:" Sections"}),r.jsx("ol",{className:"cours-detail__sections-liste",children:d.map(U=>{const L=p?.sectionsLues.includes(U.id)??!1,B=U.id===v,ee=k(U);return r.jsx("li",{children:r.jsxs("button",{className:["cours-detail__section-btn",B?"cours-detail__section-btn--active":"",L?"cours-detail__section-btn--lue":"",ee?"":"cours-detail__section-btn--verrou"].join(" "),onClick:()=>b(U.id),"aria-current":B?"true":void 0,children:[r.jsx("span",{className:"cours-detail__section-icone","aria-hidden":"true",children:ee?L?"":`${U.ordre}.`:""}),r.jsx("span",{className:"cours-detail__section-nom",children:U.titre}),r.jsxs("span",{className:"cours-detail__section-duree",children:[U.dureeEstimee," min"]})]})},U.id)})})]}),r.jsx("main",{className:"cours-detail__contenu",ref:C,"aria-live":"polite",children:D?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"cours-detail__section-header",children:[r.jsxs("h2",{className:"cours-detail__section-titre",children:[D.ordre,". ",D.titre]}),r.jsxs("span",{className:"cours-detail__section-duree-label",children:[" ",D.dureeEstimee," min de lecture"]})]}),$?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"cours-detail__blocs",children:D.blocs.sort((U,L)=>U.ordre-L.ordre).map(U=>{const L=U.isPremium&&!a&&!D.estGratuite,B=p?.reponsesQuiz.find(ee=>ee.blocId===U.id)?.optionChoisieId;return r.jsx("div",{className:`cours-detail__bloc cours-detail__bloc--${U.type}`,children:r.jsx(mee,{bloc:U,isPremiumVerrou:L,onReponseQuiz:O,reponseExistante:B})},U.id)})}),n&&!p?.sectionsLues.includes(D.id)&&r.jsx("div",{className:"cours-detail__action-lu",children:r.jsx("button",{className:"btn-primary",onClick:()=>A(D.id),children:" Marquer cette section comme lue"})}),r.jsxs("div",{className:"cours-detail__nav-sections",children:[!S(D)&&D.blocs.some(U=>U.type==="quiz")&&r.jsx("p",{className:"cours-detail__quiz-requis",role:"alert",children:" Russissez les quiz de cette section (60% minimum) pour passer  la suite."}),D.ordre>1&&r.jsx("button",{className:"btn-secondary",onClick:()=>{const U=d.find(L=>L.ordre===D.ordre-1);U&&b(U.id)},children:" Section prcdente"}),D.ordre<d.length&&r.jsx("button",{className:"btn-primary",onClick:()=>{if(!S(D)&&D.blocs.some(L=>L.type==="quiz"))return;const U=d.find(L=>L.ordre===D.ordre+1);U&&b(U.id)},children:"Section suivante "})]})]}):r.jsxs("div",{className:"cours-detail__premium-gate",children:[r.jsx("span",{className:"cours-detail__premium-gate-icon","aria-hidden":"true",children:""}),r.jsx("h3",{children:"Contenu Premium"}),r.jsxs("p",{children:["Cette section ncessite un abonnement Premium PedaClic.",r.jsx("br",{}),"Formules  partir de ",r.jsx("strong",{children:"1 000 FCFA/mois"})," (1 cours) jusqu' l'accs illimit (ds 10 000 FCFA / 3 mois)."]}),n?r.jsxs("div",{className:"cours-detail__premium-gate-actions",children:[r.jsx("button",{className:"btn-primary",onClick:()=>t("/premium"),children:" Dcouvrir les formules"}),n.isPremium&&r.jsx("button",{className:"btn-secondary",onClick:()=>t("/premium/mes-cours"),children:" Choisir mes cours"})]}):r.jsx("button",{className:"btn-primary",onClick:()=>t("/connexion"),children:"Se connecter pour accder"})]})]}):r.jsx("div",{className:"cours-detail__vide-section",role:"status",children:r.jsx("p",{children:"Slectionnez une section dans le menu de gauche pour commencer."})})})]})]})}const pee=["image/jpeg","image/png","image/gif","image/webp"],hee=".jpg,.jpeg,.png,.gif,.webp",pP=({storagePath:e,existingUrl:t,onUploadComplete:n,onUploadStart:a,onUploadError:l,placeholder:o="Glissez une image ici ou cliquez pour parcourir",disabled:u=!1,maxSizeMo:d=5})=>{const[f,p]=g.useState({status:"idle",progress:0,errorMessage:null,previewUrl:t||null}),[h,v]=g.useState(!1),b=g.useRef(null),x=g.useCallback(U=>{if(!pee.includes(U.type))return`Type non support : ${U.type}. Utilisez JPG, PNG, GIF ou WebP.`;const L=U.size/(1024*1024);return L>d?`Fichier trop lourd : ${L.toFixed(1)} Mo (max ${d} Mo).`:null},[d]),j=U=>{const L=Date.now(),B=U.split(".").pop()?.toLowerCase()||"jpg";return`${U.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9_-]/g,"_").slice(0,30)}_${L}.${B}`},N=g.useCallback(async U=>{const L=x(U);if(L){p(F=>({...F,status:"error",errorMessage:L})),l?.(L);return}const B=URL.createObjectURL(U);p({status:"uploading",progress:0,errorMessage:null,previewUrl:B}),a?.();const ee=j(U.name),se=`${e}/${ee}`,P=Lr(Dr,se),q=Mb(P,U,{contentType:U.type,customMetadata:{uploadedBy:"pedaclic-prof",originalName:U.name}});q.on("state_changed",F=>{const R=Math.round(F.bytesTransferred/F.totalBytes*100);p(W=>({...W,progress:R}))},F=>{URL.revokeObjectURL(B);const R=`Erreur upload : ${F.message}`;p(W=>({...W,status:"error",errorMessage:R,previewUrl:t||null})),l?.(R)},async()=>{URL.revokeObjectURL(B);try{const F=await pa(q.snapshot.ref);p({status:"success",progress:100,errorMessage:null,previewUrl:F}),n(F)}catch{const R="Impossible de rcuprer l'URL de tlchargement.";p(W=>({...W,status:"error",errorMessage:R})),l?.(R)}})},[e,t,x,a,n,l]),w=U=>{const L=U.target.files?.[0];L&&N(L),U.target.value=""},C=U=>{U.preventDefault(),u||v(!0)},E=U=>{U.preventDefault(),v(!1)},S=U=>{if(U.preventDefault(),v(!1),u)return;const L=U.dataTransfer.files?.[0];L&&N(L)},A=async()=>{f.previewUrl&&(p({status:"idle",progress:0,errorMessage:null,previewUrl:null}),n(""))},{status:O,progress:k,errorMessage:M,previewUrl:D}=f,$=O==="uploading";return r.jsxs("div",{className:`image-uploader ${h?"image-uploader--drag-over":""} ${u?"image-uploader--disabled":""}`,children:[D&&r.jsxs("div",{className:"image-uploader__preview",children:[r.jsx("img",{src:D,alt:"Aperu",className:"image-uploader__preview-img"}),$&&r.jsx("div",{className:"image-uploader__overlay",children:r.jsx("div",{className:"image-uploader__spinner"})}),!$&&!u&&r.jsx("button",{type:"button",className:"image-uploader__remove-btn",onClick:A,title:"Supprimer l'image","aria-label":"Supprimer l'image",children:""})]}),!D&&r.jsxs("div",{className:"image-uploader__dropzone",onDragOver:C,onDragLeave:E,onDrop:S,onClick:()=>!u&&b.current?.click(),role:"button",tabIndex:u?-1:0,"aria-label":"Zone d'upload d'image",onKeyDown:U=>{(U.key==="Enter"||U.key===" ")&&!u&&b.current?.click()},children:[r.jsx("span",{className:"image-uploader__icon","aria-hidden":"true",children:""}),r.jsx("p",{className:"image-uploader__text",children:o}),r.jsxs("p",{className:"image-uploader__subtext",children:["JPG, PNG, GIF, WebP  max ",d," Mo"]}),r.jsx("button",{type:"button",className:"image-uploader__browse-btn",disabled:u,tabIndex:-1,"aria-hidden":"true",children:"Parcourir"})]}),$&&r.jsxs("div",{className:"image-uploader__progress",role:"progressbar","aria-valuenow":k,"aria-valuemin":0,"aria-valuemax":100,children:[r.jsx("div",{className:"image-uploader__progress-bar",style:{width:`${k}%`}}),r.jsxs("span",{className:"image-uploader__progress-text",children:["Upload en cours ",k,"%"]})]}),O==="success"&&r.jsx("p",{className:"image-uploader__success",children:" Image uploade avec succs"}),M&&r.jsxs("p",{className:"image-uploader__error",role:"alert",children:[" ",M]}),r.jsx("input",{ref:b,type:"file",accept:hee,onChange:w,disabled:u||$,style:{display:"none"},"aria-hidden":"true"})]})},dm=()=>crypto.randomUUID();function vee(e,t){const n={id:dm(),type:e,ordre:t,isPremium:!1};switch(e){case"texte":return{...n,type:"texte",contenu:""};case"image":return{...n,type:"image",url:"",alt:"",legende:""};case"video":return{...n,type:"video",urlYoutube:"",titre:"",description:""};case"encadre":return{...n,type:"encadre",variante:"definition",titre:"Dfinition",contenu:""};case"quiz":return{...n,type:"quiz",question:"",options:[{id:dm(),texte:"",estCorrecte:!0},{id:dm(),texte:"",estCorrecte:!1}],explication:""};case"exercice":return{...n,type:"exercice",enonce:"",correction:"",difficulte:"moyen"}}}function gee({bloc:e,index:t,total:n,onUpdate:a,onDelete:l,onMoveUp:o,onMoveDown:u,isDragging:d,onDragStart:f,onDragOver:p,onDrop:h,onDragEnd:v,dragOverIndex:b,storageBasePath:x,onBlocUploadStart:j,onBlocUploadEnd:N}){const w=Ex[e.type],C=b===t;function E(){switch(e.type){case"texte":return r.jsx("textarea",{className:"editor-bloc__textarea",placeholder:"Texte du paragraphe (Markdown : **gras**, *italique*, - liste)",value:e.contenu,onChange:S=>a({...e,contenu:S.target.value}),rows:4});case"image":return r.jsxs("div",{className:"editor-bloc__form-grid",children:[r.jsx(pP,{storagePath:`${x}/bloc-${t}`,existingUrl:e.url,placeholder:"Glissez l'image ici ou cliquez",onUploadStart:()=>j(t),onUploadComplete:S=>{a({...e,url:S}),N(t)},onUploadError:()=>N(t),maxSizeMo:5}),r.jsx("input",{type:"text",placeholder:"Texte alternatif (accessibilit)",value:e.alt,onChange:S=>a({...e,alt:S.target.value}),className:"editor-bloc__input"}),r.jsx("input",{type:"text",placeholder:"Lgende (optionnelle)",value:e.legende??"",onChange:S=>a({...e,legende:S.target.value}),className:"editor-bloc__input"})]});case"video":return r.jsxs("div",{className:"editor-bloc__form-grid",children:[r.jsx("input",{type:"url",placeholder:"URL YouTube (ex: https://www.youtube.com/watch?v=...)",value:e.urlYoutube,onChange:S=>a({...e,urlYoutube:S.target.value}),className:"editor-bloc__input"}),r.jsx("input",{type:"text",placeholder:"Titre de la vido",value:e.titre,onChange:S=>a({...e,titre:S.target.value}),className:"editor-bloc__input"}),r.jsx("input",{type:"text",placeholder:"Description courte (optionnelle)",value:e.description??"",onChange:S=>a({...e,description:S.target.value}),className:"editor-bloc__input"})]});case"encadre":return r.jsxs("div",{className:"editor-bloc__form-grid",children:[r.jsx("select",{value:e.variante,onChange:S=>a({...e,variante:S.target.value}),className:"editor-bloc__select",children:Object.entries(EA).map(([S,A])=>r.jsxs("option",{value:S,children:[A.emoji," ",A.label]},S))}),r.jsx("input",{type:"text",placeholder:"Titre de l'encadr",value:e.titre,onChange:S=>a({...e,titre:S.target.value}),className:"editor-bloc__input"}),r.jsx("textarea",{placeholder:"Contenu de l'encadr",value:e.contenu,onChange:S=>a({...e,contenu:S.target.value}),className:"editor-bloc__textarea",rows:3})]});case"quiz":{const S=e;return r.jsxs("div",{className:"editor-bloc__form-grid",children:[r.jsx("input",{type:"text",placeholder:"Question",value:S.question,onChange:A=>a({...S,question:A.target.value}),className:"editor-bloc__input"}),r.jsxs("div",{className:"editor-bloc__quiz-options",children:[S.options.map((A,O)=>r.jsxs("div",{className:"editor-bloc__quiz-option",children:[r.jsx("input",{type:"radio",name:`quiz-correct-${e.id}`,checked:A.estCorrecte,onChange:()=>a({...S,options:S.options.map((k,M)=>({...k,estCorrecte:M===O}))}),title:"Marquer comme bonne rponse"}),r.jsx("input",{type:"text",placeholder:`Option ${O+1}`,value:A.texte,onChange:k=>a({...S,options:S.options.map((M,D)=>D===O?{...M,texte:k.target.value}:M)}),className:"editor-bloc__input"}),S.options.length>2&&r.jsx("button",{type:"button",className:"btn-icon btn-icon--danger",onClick:()=>a({...S,options:S.options.filter((k,M)=>M!==O)}),title:"Supprimer cette option",children:""})]},A.id)),S.options.length<4&&r.jsx("button",{type:"button",className:"btn-link",onClick:()=>a({...S,options:[...S.options,{id:dm(),texte:"",estCorrecte:!1}]}),children:"+ Ajouter une option"})]}),r.jsx("input",{type:"text",placeholder:"Explication aprs rponse (optionnelle)",value:S.explication??"",onChange:A=>a({...S,explication:A.target.value}),className:"editor-bloc__input"})]})}case"exercice":return r.jsxs("div",{className:"editor-bloc__form-grid",children:[r.jsx("textarea",{placeholder:"nonc de l'exercice",value:e.enonce,onChange:S=>a({...e,enonce:S.target.value}),className:"editor-bloc__textarea",rows:3}),r.jsx("textarea",{placeholder:"Correction (masque pour l'lve jusqu'au clic)",value:e.correction,onChange:S=>a({...e,correction:S.target.value}),className:"editor-bloc__textarea editor-bloc__textarea--correction",rows:3}),r.jsxs("div",{className:"editor-bloc__row",children:[r.jsxs("select",{value:e.difficulte,onChange:S=>a({...e,difficulte:S.target.value}),className:"editor-bloc__select",children:[r.jsx("option",{value:"facile",children:"Facile"}),r.jsx("option",{value:"moyen",children:"Moyen"}),r.jsx("option",{value:"difficile",children:"Difficile"})]}),r.jsx("input",{type:"number",placeholder:"Points (opt.)",value:e.points??"",onChange:S=>a({...e,points:Number(S.target.value)||void 0}),className:"editor-bloc__input editor-bloc__input--sm",min:1})]})]});default:return null}}return r.jsxs("div",{className:["editor-bloc",d?"editor-bloc--dragging":"",C?"editor-bloc--drag-over":""].join(" "),draggable:!0,onDragStart:S=>f(S,t),onDragOver:S=>p(S,t),onDrop:S=>h(S,t),onDragEnd:v,children:[r.jsxs("div",{className:"editor-bloc__header",children:[r.jsx("span",{className:"editor-bloc__drag-handle",title:"Dplacer","aria-hidden":"true",children:""}),r.jsxs("span",{className:"editor-bloc__type-label",children:[w.emoji," ",w.label]}),r.jsxs("label",{className:"editor-bloc__premium-toggle",title:"Rserver aux abonns Premium",children:[r.jsx("input",{type:"checkbox",checked:e.isPremium,onChange:S=>a({...e,isPremium:S.target.checked})}),r.jsx("span",{children:" Premium"})]}),r.jsxs("div",{className:"editor-bloc__actions",children:[r.jsx("button",{type:"button",className:"btn-icon",onClick:o,disabled:t===0,title:"Monter","aria-label":"Monter ce bloc",children:""}),r.jsx("button",{type:"button",className:"btn-icon",onClick:u,disabled:t===n-1,title:"Descendre","aria-label":"Descendre ce bloc",children:""}),r.jsx("button",{type:"button",className:"btn-icon btn-icon--danger",onClick:l,title:"Supprimer ce bloc","aria-label":"Supprimer ce bloc",children:""})]})]}),r.jsx("div",{className:"editor-bloc__form",children:E()})]})}function eA(){const{coursId:e}=Jn(),t=lt(),{currentUser:n}=Ze(),a=!!e,{matieres:l}=Zs(),[o]=g.useState(()=>Ne(je(K,"cours_en_ligne")).id),u=`cours-images/${a?e:o}`,[d,f]=g.useState({titre:"",description:"",matiere:"Mathmatiques",niveau:"3me",classe:"",isPremium:!1,statut:"brouillon",couvertureUrl:"",dureeEstimee:0,objectifs:[""],prerequis:"",tags:[],cahierTextesId:""}),[p,h]=g.useState([]),[v,b]=g.useState(null),[x,j]=g.useState([]),[N,w]=g.useState(""),C=g.useRef(null),[E,S]=g.useState(null),A=g.useRef(null),[O,k]=g.useState(null),[M,D]=g.useState(null),[$,U]=g.useState(!1),[L,B]=g.useState(!1),[ee,se]=g.useState(null),[P,q]=g.useState(null),[F,R]=g.useState("infos"),[W,I]=g.useState([]),[re,V]=g.useState(!1),[oe,xe]=g.useState({});re||Object.values(oe).some(Boolean),g.useEffect(()=>{a&&e&&ve(e)},[e]),g.useEffect(()=>{n?.role==="admin"&&EZ().then(Z=>I(Z.map(ce=>({id:ce.id,titre:ce.titre})))).catch(()=>{})},[n?.role]);async function ve(Z){U(!0);try{const[ce,_e]=await Promise.all([yA(Z),jA(Z)]);ce&&f({titre:ce.titre,description:ce.description,matiere:ce.matiere,niveau:ce.niveau,classe:ce.classe??"",cahierTextesId:ce.cahierTextesId??"",isPremium:ce.isPremium,statut:ce.statut,couvertureUrl:ce.couvertureUrl??"",dureeEstimee:ce.dureeEstimee,objectifs:ce.objectifs.length>0?ce.objectifs:[""],prerequis:ce.prerequis??"",tags:ce.tags}),h(_e),_e.length>0&&(b(_e[0].id),j(_e[0].blocs),w(_e[0].titre))}catch{se("Erreur de chargement du cours.")}finally{U(!1)}}g.useEffect(()=>{if(!v)return;const Z=p.find(ce=>ce.id===v);Z&&(j([...Z.blocs].sort((ce,_e)=>ce.ordre-_e.ordre)),w(Z.titre))},[v]);const H=(Z,ce)=>f(_e=>({..._e,[Z]:ce})),he=(Z,ce)=>{const _e=[...d.objectifs];_e[Z]=ce,H("objectifs",_e)},Pe=()=>H("objectifs",[...d.objectifs,""]),ue=Z=>H("objectifs",d.objectifs.filter((ce,_e)=>_e!==Z)),[X,Q]=g.useState(""),me=()=>{const Z=X.trim();Z&&!d.tags.includes(Z)&&H("tags",[...d.tags,Z]),Q("")},we=Z=>H("tags",d.tags.filter(ce=>ce!==Z));async function qe(Z=!1){if(n){if(!d.titre.trim()){se("Le titre du cours est obligatoire.");return}B(!0),se(null);try{const ce={...d,objectifs:d.objectifs.filter(_e=>_e.trim()),statut:Z?"publie":d.statut,cahierTextesId:d.cahierTextesId?.trim()||void 0};if(a&&e)await h5(e,ce),Z&&await Cx(e),We(Z?" Cours publi !":" Cours sauvegard.");else{const _e=n.displayName??"Professeur",Xe=await p5(n.uid,_e,ce);Z&&await Cx(Xe),We(" Cours cr ! Ajoutez maintenant vos sections."),t(`/prof/cours/${Xe}/modifier`)}}catch(ce){console.error("[CoursEditorPage] Erreur sauvegarde :",ce),se("Erreur lors de la sauvegarde. Ressayez.")}finally{B(!1)}}}function We(Z){q(Z),setTimeout(()=>q(null),4e3)}async function Je(){if(!e){se("Sauvegardez d'abord le cours pour ajouter des sections.");return}const Z=p.length+1,ce=`Section ${Z}`;try{const _e=await x5(e,{titre:ce,ordre:Z,blocs:[],dureeEstimee:0,estGratuite:Z===1}),Xe=Oe.now(),Ar={id:_e,coursId:e,titre:ce,ordre:Z,blocs:[],dureeEstimee:0,estGratuite:Z===1,createdAt:Xe,updatedAt:Xe};h($n=>[...$n,Ar]),b(_e),j([]),w(ce)}catch{se("Erreur lors de la cration de la section.")}}async function at(Z){if(e&&confirm("Supprimer cette section et tous ses blocs ?"))try{await b5(Z,e);const ce=p.filter(_e=>_e.id!==Z).map((_e,Xe)=>({..._e,ordre:Xe+1}));h(ce),v===Z&&b(ce[0]?.id??null)}catch{se("Erreur lors de la suppression.")}}async function br(){if(v)try{await M1(v,{titre:N}),h(Z=>Z.map(ce=>ce.id===v?{...ce,titre:N}:ce))}catch{se("Erreur lors de la mise  jour du titre.")}}function Pr(Z,ce){C.current=ce,Z.dataTransfer.effectAllowed="move"}function lr(Z,ce){Z.preventDefault(),Z.dataTransfer.dropEffect="move",S(ce)}async function an(Z,ce){Z.preventDefault(),S(null);const _e=C.current;if(_e===null||_e===ce)return;const Xe=[...p],[Ar]=Xe.splice(_e,1);Xe.splice(ce,0,Ar);const $n=Xe.map((Bn,ra)=>({...Bn,ordre:ra+1}));h($n);try{await y5($n.map(Bn=>({id:Bn.id,ordre:Bn.ordre})))}catch{se("Erreur lors du rordonnancement. Rechargez la page.")}C.current=null}function pe(Z){const ce=vee(Z,x.length),_e=[...x,ce];j(_e),tr(_e)}function Ae(Z,ce){const _e=x.map((Xe,Ar)=>Ar===Z?ce:Xe);j(_e),tr(_e)}function Re(Z){const ce=x.filter((_e,Xe)=>Xe!==Z);j(ce),tr(ce)}function He(Z){if(Z===0)return;const ce=[...x];[ce[Z-1],ce[Z]]=[ce[Z],ce[Z-1]],j(ce),tr(ce)}function xt(Z){if(Z===x.length-1)return;const ce=[...x];[ce[Z],ce[Z+1]]=[ce[Z+1],ce[Z]],j(ce),tr(ce)}const It=g.useRef(null);function tr(Z){v&&(It.current&&clearTimeout(It.current),It.current=setTimeout(async()=>{try{await j5(v,Z),h(ce=>ce.map(_e=>_e.id===v?{..._e,blocs:Z}:_e))}catch(ce){console.error("[CoursEditorPage] Erreur sauvegarde blocs :",ce)}},1500))}function Gr(Z,ce){A.current=ce,D(ce),Z.dataTransfer.effectAllowed="move"}function J(Z,ce){Z.preventDefault(),Z.dataTransfer.dropEffect="move",k(ce)}function Me(Z,ce){Z.preventDefault(),k(null),D(null);const _e=A.current;if(_e===null||_e===ce)return;const Xe=[...x],[Ar]=Xe.splice(_e,1);Xe.splice(ce,0,Ar);const $n=Xe.map((Bn,ra)=>({...Bn,ordre:ra}));j($n),tr($n),A.current=null}function ot(){k(null),D(null),A.current=null}return $?r.jsxs("div",{className:"cours-editor__loading","aria-busy":"true",children:[r.jsx("div",{className:"spinner spinner--blue"}),r.jsx("p",{children:"Chargement de l'diteur..."})]}):r.jsxs("div",{className:"cours-editor",children:[r.jsxs("header",{className:"cours-editor__header",children:[r.jsxs("p",{className:"cours-editor__breadcrumb",children:[r.jsx("button",{className:"btn-link",onClick:()=>t("/prof/cours"),children:" Mes cours"})," / ",a?"Modifier le cours":"Nouveau cours"]}),r.jsxs("div",{className:"cours-editor__header-actions",children:[r.jsx("h1",{className:"cours-editor__titre",children:a?" Modifier le cours":" Nouveau cours"}),r.jsxs("div",{className:"cours-editor__btn-group",children:[r.jsx("button",{className:"btn-secondary",onClick:()=>t("/prof/cours"),disabled:L,children:"Annuler"}),r.jsx("button",{className:"btn-secondary",onClick:()=>qe(!1),disabled:L,children:L?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"spinner"})," Sauvegarde..."]}):" Sauvegarder"}),r.jsx("button",{className:"btn-primary",onClick:()=>qe(!0),disabled:L||d.statut==="publie",children:d.statut==="publie"?" Publi":" Publier"})]})]}),ee&&r.jsxs("div",{className:"error-banner",role:"alert",children:[" ",ee]}),P&&r.jsx("div",{className:"success-banner",role:"status",children:P})]}),r.jsxs("div",{className:"cours-editor__tabs",role:"tablist",children:[r.jsx("button",{className:`cours-editor__tab ${F==="infos"?"cours-editor__tab--active":""}`,onClick:()=>R("infos"),role:"tab","aria-selected":F==="infos",children:" Informations du cours"}),r.jsxs("button",{className:`cours-editor__tab ${F==="sections"?"cours-editor__tab--active":""}`,onClick:()=>R("sections"),role:"tab","aria-selected":F==="sections",disabled:!a&&!e,children:[" Sections et contenu ",p.length>0&&`(${p.length})`]})]}),F==="infos"&&r.jsxs("section",{className:"cours-editor__form","aria-label":"Informations du cours",children:[r.jsxs("div",{className:"cours-editor__card",children:[r.jsx("h2",{className:"cours-editor__card-titre",children:" Informations gnrales"}),r.jsxs("div",{className:"cours-editor__form-grid",children:[r.jsxs("div",{className:"cours-editor__field cours-editor__field--full",children:[r.jsx("label",{htmlFor:"titre",children:"Titre du cours *"}),r.jsx("input",{id:"titre",type:"text",value:d.titre,onChange:Z=>H("titre",Z.target.value),placeholder:"Ex : Les fonctions affines  Terminale S",className:"cours-editor__input",required:!0})]}),r.jsxs("div",{className:"cours-editor__field cours-editor__field--full",children:[r.jsx("label",{htmlFor:"description",children:"Description *"}),r.jsx("textarea",{id:"description",value:d.description,onChange:Z=>H("description",Z.target.value),placeholder:"Description courte affiche dans le catalogue",className:"cours-editor__textarea",rows:3})]}),r.jsxs("div",{className:"cours-editor__field",children:[r.jsx("label",{htmlFor:"matiere",children:"Matire *"}),r.jsx("select",{id:"matiere",value:d.matiere,onChange:Z=>H("matiere",Z.target.value),className:"cours-editor__select",children:l.map(Z=>r.jsx("option",{value:Z.valeur,children:Z.label},Z.valeur))})]}),r.jsxs("div",{className:"cours-editor__field",children:[r.jsx("label",{htmlFor:"niveau",children:"Niveau *"}),r.jsx("select",{id:"niveau",value:d.niveau,onChange:Z=>H("niveau",Z.target.value),className:"cours-editor__select",children:Xs.map(Z=>r.jsx("option",{value:Z,children:Z},Z))})]}),r.jsxs("div",{className:"cours-editor__field",children:[r.jsx("label",{htmlFor:"classe",children:"Classe (optionnelle)"}),r.jsx("input",{id:"classe",type:"text",value:d.classe??"",onChange:Z=>H("classe",Z.target.value),placeholder:"Ex : 3me A, TS, L2",className:"cours-editor__input"})]}),n?.role==="admin"&&W.length>0&&r.jsxs("div",{className:"cours-editor__field cours-editor__field--full",children:[r.jsx("label",{htmlFor:"cahierTextesId",children:" Lier  un cahier de textes"}),r.jsxs("select",{id:"cahierTextesId",value:d.cahierTextesId??"",onChange:Z=>H("cahierTextesId",Z.target.value),className:"cours-editor__select",children:[r.jsx("option",{value:"",children:" Aucun "}),W.map(Z=>r.jsx("option",{value:Z.id,children:Z.titre},Z.id))]}),r.jsx("span",{className:"cours-editor__label-hint",children:"Si le cahier n'existe pas, crez-le d'abord dans Cahier de Textes."})]}),r.jsxs("div",{className:"cours-editor__field",children:[r.jsxs("label",{htmlFor:"couverture",children:[" Image de couverture",r.jsx("span",{className:"cours-editor__label-hint",children:"(JPG, PNG, WebP  max 5 Mo)"})]}),r.jsx(pP,{storagePath:`${u}/couverture`,existingUrl:d.couvertureUrl,placeholder:"Glissez l'image de couverture ici ou cliquez",disabled:L,onUploadStart:()=>V(!0),onUploadComplete:Z=>{H("couvertureUrl",Z),V(!1)},onUploadError:Z=>{console.error("[Phase 25] Erreur couverture:",Z),V(!1)},maxSizeMo:5}),re&&r.jsx("p",{className:"cours-editor__upload-hint",children:" Upload en cours, patientez avant d'enregistrer"})]}),r.jsx("div",{className:"cours-editor__field cours-editor__field--full",children:r.jsxs("label",{className:"cours-editor__toggle-label",children:[r.jsx("input",{type:"checkbox",checked:d.isPremium,onChange:Z=>H("isPremium",Z.target.checked)}),r.jsx("span",{children:" Cours Premium  Les sections (sauf la 1re) ncessitent un abonnement"})]})})]})]}),r.jsxs("div",{className:"cours-editor__card",children:[r.jsx("h2",{className:"cours-editor__card-titre",children:" Objectifs pdagogiques"}),d.objectifs.map((Z,ce)=>r.jsxs("div",{className:"cours-editor__objectif-row",children:[r.jsx("input",{type:"text",value:Z,onChange:_e=>he(ce,_e.target.value),placeholder:`Objectif ${ce+1} (ex : Savoir calculer une drive)`,className:"cours-editor__input"}),d.objectifs.length>1&&r.jsx("button",{type:"button",className:"btn-icon btn-icon--danger",onClick:()=>ue(ce),title:"Supprimer cet objectif",children:""})]},ce)),r.jsx("button",{type:"button",className:"btn-link",onClick:Pe,children:"+ Ajouter un objectif"})]}),r.jsxs("div",{className:"cours-editor__card",children:[r.jsx("h2",{className:"cours-editor__card-titre",children:" Prrequis et tags"}),r.jsxs("div",{className:"cours-editor__field",children:[r.jsx("label",{htmlFor:"prerequis",children:"Prrequis conseills"}),r.jsx("input",{id:"prerequis",type:"text",value:d.prerequis??"",onChange:Z=>H("prerequis",Z.target.value),placeholder:"Ex : Matriser les quations du 2nd degr",className:"cours-editor__input"})]}),r.jsxs("div",{className:"cours-editor__field",children:[r.jsx("label",{children:"Tags (aide  la recherche)"}),r.jsxs("div",{className:"cours-editor__tags-wrapper",children:[d.tags.map(Z=>r.jsxs("span",{className:"cours-editor__tag",children:[Z,r.jsx("button",{type:"button",onClick:()=>we(Z),"aria-label":`Supprimer le tag ${Z}`,children:""})]},Z)),r.jsxs("div",{className:"cours-editor__tag-input-row",children:[r.jsx("input",{type:"text",value:X,onChange:Z=>Q(Z.target.value),onKeyDown:Z=>Z.key==="Enter"&&(Z.preventDefault(),me()),placeholder:"Ajouter un tag...",className:"cours-editor__input cours-editor__input--sm"}),r.jsx("button",{type:"button",className:"btn-secondary btn--sm",onClick:me,children:"+ Tag"})]})]})]})]})]}),F==="sections"&&r.jsx("section",{className:"cours-editor__sections","aria-label":"diteur de sections",children:a?r.jsxs("div",{className:"cours-editor__sections-layout",children:[r.jsxs("aside",{className:"cours-editor__sections-sidebar",children:[r.jsxs("div",{className:"cours-editor__sections-sidebar-header",children:[r.jsx("h2",{children:" Sections"}),r.jsx("button",{className:"btn-primary btn--sm",onClick:Je,children:"+ Ajouter"})]}),p.length===0?r.jsx("p",{className:"cours-editor__sections-empty-hint",children:'Aucune section. Cliquez sur "+ Ajouter" pour commencer.'}):r.jsx("ol",{className:"cours-editor__sections-liste",children:p.map((Z,ce)=>r.jsxs("li",{className:["cours-editor__section-item",Z.id===v?"cours-editor__section-item--active":"",E===ce?"cours-editor__section-item--drag-over":""].join(" "),draggable:!0,onDragStart:_e=>Pr(_e,ce),onDragOver:_e=>lr(_e,ce),onDrop:_e=>an(_e,ce),onDragEnd:()=>S(null),children:[r.jsx("span",{className:"cours-editor__section-drag","aria-hidden":"true",children:""}),r.jsxs("button",{className:"cours-editor__section-btn",onClick:()=>b(Z.id),"aria-current":Z.id===v?"true":void 0,children:[r.jsx("span",{className:"cours-editor__section-ordre",children:Z.ordre}),r.jsxs("span",{className:"cours-editor__section-nom",children:[Z.titre,Z.estGratuite&&r.jsx("span",{className:"cours-editor__section-gratuite",title:"Section gratuite",children:"G"})]}),r.jsxs("span",{className:"cours-editor__section-blocs-count",children:[Z.blocs.length," bloc",Z.blocs.length>1?"s":""]})]}),r.jsx("button",{className:"btn-icon btn-icon--danger btn-icon--xs",onClick:()=>at(Z.id),title:"Supprimer cette section","aria-label":`Supprimer la section ${Z.titre}`,children:""})]},Z.id))})]}),v?r.jsxs("div",{className:"cours-editor__section-content",children:[r.jsxs("div",{className:"cours-editor__section-titre-row",children:[r.jsx("input",{type:"text",value:N,onChange:Z=>w(Z.target.value),onBlur:br,className:"cours-editor__section-titre-input",placeholder:"Titre de la section","aria-label":"Titre de la section"}),r.jsxs("label",{className:"cours-editor__toggle-label",children:[r.jsx("input",{type:"checkbox",checked:p.find(Z=>Z.id===v)?.estGratuite??!1,onChange:async Z=>{try{await M1(v,{estGratuite:Z.target.checked}),h(ce=>ce.map(_e=>_e.id===v?{..._e,estGratuite:Z.target.checked}:_e))}catch{}}}),r.jsx("span",{children:"Gratuite"})]})]}),r.jsxs("div",{className:"cours-editor__palette","aria-label":"Ajouter un bloc",children:[r.jsx("span",{className:"cours-editor__palette-label",children:"Ajouter un bloc :"}),Object.keys(Ex).map(Z=>{const ce=Ex[Z];return r.jsxs("button",{className:"cours-editor__palette-btn",onClick:()=>pe(Z),title:ce.description,children:[ce.emoji," ",ce.label]},Z)})]}),x.length===0?r.jsxs("div",{className:"cours-editor__blocs-empty",children:[r.jsx("p",{children:" Aucun bloc dans cette section."}),r.jsx("p",{children:"Utilisez la palette ci-dessus pour ajouter du contenu."})]}):r.jsx("div",{className:"cours-editor__blocs-liste","aria-label":"Blocs de la section",children:x.map((Z,ce)=>r.jsx(gee,{bloc:Z,index:ce,total:x.length,onUpdate:_e=>Ae(ce,_e),onDelete:()=>Re(ce),onMoveUp:()=>He(ce),onMoveDown:()=>xt(ce),isDragging:M===ce,onDragStart:Gr,onDragOver:J,onDrop:Me,onDragEnd:ot,dragOverIndex:O,storageBasePath:`${u}/section-${v}`,onBlocUploadStart:_e=>{const Xe=`${v}-${_e}`;xe(Ar=>({...Ar,[Xe]:!0}))},onBlocUploadEnd:_e=>{const Xe=`${v}-${_e}`;xe(Ar=>({...Ar,[Xe]:!1}))}},Z.id))})]}):r.jsx("div",{className:"cours-editor__section-content-empty",children:r.jsx("p",{children:"Slectionnez ou crez une section pour commencer  diter."})})]}):r.jsxs("div",{className:"cours-editor__sections-empty",children:[r.jsx("p",{children:"Sauvegardez d'abord les informations du cours pour ajouter des sections."}),r.jsx("button",{className:"btn-primary",onClick:()=>R("infos"),children:" Revenir aux informations"})]})})]})}function xee({cours:e,onModifier:t,onPublier:n,onArchiver:a,onSupprimer:l,onVoirStats:o}){const u=k5[e.statut],d=Lc.find(f=>f.valeur===e.niveau)?.label??e.niveau;return r.jsxs("article",{className:"prof-cours-card",children:[r.jsxs("div",{className:"prof-cours-card__header",children:[r.jsxs("div",{className:"prof-cours-card__header-left",children:[r.jsx("span",{className:"prof-cours-card__statut",style:{color:u.couleur,background:u.bg},children:u.label}),e.isPremium&&r.jsx("span",{className:"badge badge--premium",children:" Premium"})]}),r.jsxs("div",{className:"prof-cours-card__actions",children:[r.jsx("button",{className:"btn-icon",onClick:t,title:"Modifier","aria-label":`Modifier ${e.titre}`,children:""}),e.statut==="brouillon"&&r.jsx("button",{className:"btn-icon btn-icon--success",onClick:n,title:"Publier","aria-label":`Publier ${e.titre}`,children:""}),e.statut==="publie"&&r.jsx("button",{className:"btn-icon",onClick:a,title:"Archiver","aria-label":`Archiver ${e.titre}`,children:""}),r.jsx("button",{className:"btn-icon btn-icon--info",onClick:o,title:"Voir les statistiques","aria-label":`Statistiques de ${e.titre}`,children:""}),r.jsx("button",{className:"btn-icon btn-icon--danger",onClick:l,title:"Supprimer","aria-label":`Supprimer ${e.titre}`,children:""})]})]}),r.jsxs("div",{className:"prof-cours-card__body",children:[r.jsx("h3",{className:"prof-cours-card__titre",children:e.titre}),r.jsx("p",{className:"prof-cours-card__description",children:e.description}),r.jsxs("div",{className:"prof-cours-card__meta",children:[r.jsx("span",{className:"badge badge--matiere",children:e.matiere}),r.jsx("span",{className:"badge badge--niveau",children:d}),e.classe&&r.jsx("span",{className:"badge badge--classe",children:e.classe})]})]}),r.jsxs("div",{className:"prof-cours-card__footer",children:[r.jsxs("span",{title:"Sections",children:[" ",e.nombreSections," section",e.nombreSections>1?"s":""]}),r.jsxs("span",{title:"Dure estime",children:[" ",e.dureeEstimee," min"]}),r.jsxs("span",{title:"lves inscrits",children:[" ",e.nombreInscrits," lve",e.nombreInscrits>1?"s":""]})]})]})}function bee({cours:e,onClose:t}){const[n,a]=g.useState(null),[l,o]=g.useState(!0);g.useEffect(()=>{u()},[e.id]);async function u(){try{const d=await tee(e.id);a(iee(d))}catch(d){console.error("[StatsModal] Erreur :",d)}finally{o(!1)}}return r.jsx("div",{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":`Statistiques du cours : ${e.titre}`,onClick:d=>{d.target===d.currentTarget&&t()},children:r.jsxs("div",{className:"modal-content",children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[" Statistiques  ",e.titre]}),r.jsx("button",{className:"btn-icon",onClick:t,"aria-label":"Fermer",children:""})]}),r.jsx("div",{className:"modal-body",children:l?r.jsxs("div",{className:"modal-loading",children:[r.jsx("div",{className:"spinner spinner--blue"}),r.jsx("p",{children:"Chargement des statistiques..."})]}):n?r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stats-card",children:[r.jsx("span",{className:"stats-card__val",children:n.nombreInscrits}),r.jsx("span",{className:"stats-card__label",children:"lves inscrits"})]}),r.jsxs("div",{className:"stats-card stats-card--success",children:[r.jsx("span",{className:"stats-card__val",children:n.nombreTermines}),r.jsx("span",{className:"stats-card__label",children:"Cours termins"})]}),r.jsxs("div",{className:"stats-card stats-card--info",children:[r.jsxs("span",{className:"stats-card__val",children:[n.tauxCompletion,"%"]}),r.jsx("span",{className:"stats-card__label",children:"Taux de compltion"})]}),r.jsxs("div",{className:"stats-card",children:[r.jsxs("span",{className:"stats-card__val",children:[n.progressionMoyenne,"%"]}),r.jsx("span",{className:"stats-card__label",children:"Progression moyenne"})]}),r.jsxs("div",{className:"stats-card stats-card--primary",children:[r.jsxs("span",{className:"stats-card__val",children:[n.scoreMoyen,"%"]}),r.jsx("span",{className:"stats-card__label",children:"Score moyen aux quiz"})]}),r.jsxs("div",{className:"stats-progress-bar-wrapper",children:[r.jsx("label",{children:"Progression globale des lves"}),r.jsx("div",{className:"progression-bar",children:r.jsx("div",{className:"progression-bar__fill",style:{width:`${n.progressionMoyenne}%`}})})]})]}):r.jsx("p",{className:"modal-vide",children:"Aucune donne disponible pour ce cours."})})]})})}function yee(){const e=lt(),{currentUser:t}=Ze(),[n,a]=g.useState([]),[l,o]=g.useState([]),[u,d]=g.useState(!0),[f,p]=g.useState(null),[h,v]=g.useState(null),[b,x]=g.useState(""),[j,N]=g.useState(null);g.useEffect(()=>{t&&w()},[t]);async function w(){if(t){d(!0),p(null);try{const k=t.role==="admin"?await f5():await m5(t.uid);a(k),o(k)}catch{p("Impossible de charger les cours.")}finally{d(!1)}}}function C(k){x(k),o(k?n.filter(M=>M.statut===k):n)}async function E(k){if(confirm("Publier ce cours dans le catalogue ?"))try{await Cx(k),a(M=>M.map(D=>D.id===k?{...D,statut:"publie"}:D)),o(M=>M.map(D=>D.id===k?{...D,statut:"publie"}:D)),O(" Cours publi dans le catalogue !")}catch{p("Erreur lors de la publication.")}}async function S(k){if(confirm("Archiver ce cours ? Il ne sera plus visible dans le catalogue."))try{await v5(k),a(M=>M.map(D=>D.id===k?{...D,statut:"archive"}:D)),o(M=>M.map(D=>D.id===k?{...D,statut:"archive"}:D)),O(" Cours archiv.")}catch{p("Erreur lors de l'archivage.")}}async function A(k,M){if(confirm(`Supprimer dfinitivement le cours "${M}" et tout son contenu ? Cette action est irrversible.`))try{await g5(k);const D=n.filter($=>$.id!==k);a(D),o(D.filter($=>!b||$.statut===b)),O(" Cours supprim.")}catch{p("Erreur lors de la suppression.")}}function O(k){v(k),setTimeout(()=>v(null),4e3)}return r.jsxs("div",{className:"prof-cours-page",children:[r.jsxs("header",{className:"prof-cours-page__header",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"prof-cours-page__titre",children:" Mes cours en ligne"}),r.jsx("p",{className:"prof-cours-page__sous-titre",children:t?.role==="admin"?"Grez tous les cours de la plateforme. Seul l'admin peut crer des cours.":"Consultez les cours publis par vos collgues."})]}),t?.role==="admin"&&r.jsx("button",{className:"btn-primary",onClick:()=>e("/prof/cours/nouveau"),children:" Crer un cours"})]}),f&&r.jsxs("div",{className:"error-banner",role:"alert",children:[" ",f]}),h&&r.jsx("div",{className:"success-banner",role:"status",children:h}),!u&&n.length>0&&r.jsxs("div",{className:"prof-cours-page__stats","aria-label":"Rsum de mes cours",children:[r.jsxs("div",{className:"prof-cours-page__stat",children:[r.jsx("span",{className:"prof-cours-page__stat-val",children:n.length}),r.jsx("span",{children:"Total"})]}),r.jsxs("div",{className:"prof-cours-page__stat",children:[r.jsx("span",{className:"prof-cours-page__stat-val",style:{color:"#16a34a"},children:n.filter(k=>k.statut==="publie").length}),r.jsx("span",{children:"Publis"})]}),r.jsxs("div",{className:"prof-cours-page__stat",children:[r.jsx("span",{className:"prof-cours-page__stat-val",style:{color:"#ca8a04"},children:n.filter(k=>k.statut==="brouillon").length}),r.jsx("span",{children:"Brouillons"})]}),r.jsxs("div",{className:"prof-cours-page__stat",children:[r.jsx("span",{className:"prof-cours-page__stat-val",style:{color:"#2563eb"},children:n.reduce((k,M)=>k+M.nombreInscrits,0)}),r.jsx("span",{children:"lves inscrits"})]})]}),!u&&n.length>0&&r.jsx("div",{className:"prof-cours-page__filtres",role:"tablist","aria-label":"Filtrer par statut",children:[{val:"",label:`Tous (${n.length})`},{val:"publie",label:`Publis (${n.filter(k=>k.statut==="publie").length})`},{val:"brouillon",label:`Brouillons (${n.filter(k=>k.statut==="brouillon").length})`},{val:"archive",label:`Archivs (${n.filter(k=>k.statut==="archive").length})`}].map(k=>r.jsx("button",{className:`prof-cours-page__filtre-btn ${b===k.val?"prof-cours-page__filtre-btn--active":""}`,onClick:()=>C(k.val),role:"tab","aria-selected":b===k.val,children:k.label},k.val))}),r.jsxs("main",{className:"prof-cours-page__grille",children:[u&&r.jsx("div",{className:"prof-cours-page__grille-inner","aria-busy":"true",children:[1,2,3].map(k=>r.jsxs("div",{className:"prof-cours-card prof-cours-card--skeleton",children:[r.jsx("div",{className:"skeleton",style:{height:20,marginBottom:12}}),r.jsx("div",{className:"skeleton",style:{height:16,width:"60%",marginBottom:8}}),r.jsx("div",{className:"skeleton",style:{height:14,width:"80%"}})]},k))}),!u&&l.length>0&&r.jsx("div",{className:"prof-cours-page__grille-inner",children:l.map(k=>r.jsx(xee,{cours:k,onModifier:()=>e(`/prof/cours/${k.id}/modifier`),onPublier:()=>E(k.id),onArchiver:()=>S(k.id),onSupprimer:()=>A(k.id,k.titre),onVoirStats:()=>N(k)},k.id))}),!u&&l.length===0&&r.jsxs("div",{className:"prof-cours-page__vide",role:"status",children:[r.jsx("span",{"aria-hidden":"true",children:""}),r.jsx("h3",{children:n.length===0&&t?.role==="admin"?"Aucun cours sur la plateforme.":"Aucun cours dans cette catgorie."}),n.length===0&&t?.role==="admin"&&r.jsx("button",{className:"btn-primary",onClick:()=>e("/prof/cours/nouveau"),children:" Crer mon premier cours"})]})]}),j&&r.jsx(bee,{cours:j,onClose:()=>N(null)})]})}const Yi={manuel:"Manuels scolaires",annale:"Annales corriges",guide:"Guides de rvision",litterature:"Culture gnrale & Littrature",fiche:"Fiches de lectures"},Ki={manuel:"",annale:"",guide:"",litterature:"",fiche:""},mi="ebooks";async function jee(){try{const e=Ee(je(K,mi),Se("isActive","==",!0),Ve("ordre","asc"));return(await Ce(e)).docs.map(n=>({id:n.id,...n.data(),createdAt:n.data().createdAt?.toDate()||new Date,updatedAt:n.data().updatedAt?.toDate()||null}))}catch(e){throw console.error(" Erreur rcupration ebooks:",e),e}}async function Nee(){try{const e=Ee(je(K,mi),Ve("ordre","asc"));return(await Ce(e)).docs.map(n=>({id:n.id,...n.data(),createdAt:n.data().createdAt?.toDate()||new Date,updatedAt:n.data().updatedAt?.toDate()||null}))}catch(e){throw console.error(" Erreur rcupration ebooks admin:",e),e}}async function _ee(e){try{const t=await Dt(Ne(K,mi,e));return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate()||new Date,updatedAt:t.data().updatedAt?.toDate()||null}:null}catch(t){throw console.error(" Erreur rcupration ebook:",t),t}}function See(e,t){let n=[...e];if(t.categorie&&t.categorie!=="all"&&(n=n.filter(a=>a.categorie===t.categorie)),t.niveau&&t.niveau!=="all"&&(n=n.filter(a=>a.niveau===t.niveau)),t.classe&&t.classe!=="all"&&(n=n.filter(a=>a.classe===t.classe||a.classe==="all")),t.matiere&&(n=n.filter(a=>a.matiere?.toLowerCase().includes(t.matiere.toLowerCase()))),t.recherche){const a=t.recherche.toLowerCase();n=n.filter(l=>l.titre.toLowerCase().includes(a)||l.auteur.toLowerCase().includes(a)||l.description.toLowerCase().includes(a)||l.tags?.some(o=>o.toLowerCase().includes(a)))}return n}async function wee(e,t,n,a,l){try{const o=Lr(Dr,`ebooks/pdf/${Date.now()}_${t.name}`);await Ms(o,t);const u=await pa(o);let d="";if(n){const v=Lr(Dr,`ebooks/covers/${Date.now()}_${n.name}`);await Ms(v,n),d=await pa(v)}let f="";if(a){const v=Lr(Dr,`ebooks/previews/${Date.now()}_${a.name}`);await Ms(v,a),f=await pa(v)}const p={...e,fichierURL:u,couvertureURL:d,aperuURL:f,tailleFichier:t.size,nombreTelechargements:0,nombreVues:0,uploadedBy:l||"admin",createdAt:Ot(),updatedAt:Ot()},h=await qt(je(K,mi),p);return console.log(` Ebook ajout : ${e.titre} (ID: ${h.id})`),h.id}catch(o){throw console.error(" Erreur ajout ebook:",o),o}}async function Cee(e,t,n,a,l){try{const o={...t,updatedAt:Ot()};if(n){const u=Lr(Dr,`ebooks/pdf/${Date.now()}_${n.name}`);await Ms(u,n),o.fichierURL=await pa(u),o.tailleFichier=n.size}if(a){const u=Lr(Dr,`ebooks/covers/${Date.now()}_${a.name}`);await Ms(u,a),o.couvertureURL=await pa(u)}if(l){const u=Lr(Dr,`ebooks/previews/${Date.now()}_${l.name}`);await Ms(u,l),o.aperuURL=await pa(u)}await Qe(Ne(K,mi,e),o),console.log(` Ebook mis  jour : ${e}`)}catch(o){throw console.error(" Erreur mise  jour ebook:",o),o}}async function Eee(e){try{const t=await _ee(e);if(!t)throw new Error("Ebook introuvable");try{if(t.fichierURL){const n=Lr(Dr,t.fichierURL);await Pc(n)}if(t.couvertureURL){const n=Lr(Dr,t.couvertureURL);await Pc(n)}if(t.aperuURL){const n=Lr(Dr,t.aperuURL);await Pc(n)}}catch{console.warn(" Fichiers Storage non supprims (peut-tre dj supprims)")}await rn(Ne(K,mi,e)),console.log(` Ebook supprim : ${e}`)}catch(t){throw console.error(" Erreur suppression ebook:",t),t}}async function Aee(e,t){try{await Qe(Ne(K,mi,e),{isActive:t,updatedAt:Ot()})}catch(n){throw console.error(" Erreur toggle ebook:",n),n}}async function zee(e){try{await Qe(Ne(K,mi,e),{nombreVues:Ks(1)})}catch(t){console.error(" Erreur incrment vues:",t)}}async function kee(e){try{await Qe(Ne(K,mi,e),{nombreTelechargements:Ks(1)})}catch(t){console.error(" Erreur incrment tlchargements:",t)}}function Oee(e){const t={totalEbooks:e.length,totalTelechargements:0,totalVues:0,parCategorie:{manuel:0,annale:0,guide:0,litterature:0,fiche:0},ebooksActifs:0};return e.forEach(n=>{t.totalTelechargements+=n.nombreTelechargements||0,t.totalVues+=n.nombreVues||0,t.parCategorie[n.categorie]=(t.parCategorie[n.categorie]||0)+1,n.isActive&&t.ebooksActifs++}),t}function Ic(e){return e<1024?`${e} o`:e<1024*1024?`${(e/1024).toFixed(1)} Ko`:`${(e/(1024*1024)).toFixed(1)} Mo`}const hP=["Mathmatiques","Physique-Chimie","SVT","Franais","Anglais","Histoire-Gographie","Philosophie","conomie","Comptabilit","ducation civique","Arabe","Espagnol","Informatique"],Dee=({isPremium:e,onReadEbook:t})=>{const[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState({categorie:"all",niveau:"all",classe:"all",matiere:"",recherche:""}),[h,v]=g.useState("grid");g.useEffect(()=>{b()},[]);const b=async()=>{try{o(!0),d(null);const C=await jee();a(C)}catch(C){d("Erreur lors du chargement de la bibliothque"),console.error(C)}finally{o(!1)}},x=g.useMemo(()=>See(n,f),[n,f]),j=g.useMemo(()=>{const C={all:n.length};return n.forEach(E=>{C[E.categorie]=(C[E.categorie]||0)+1}),C},[n]),N=(C,E)=>{p(S=>({...S,[C]:E}))},w=()=>{p({categorie:"all",niveau:"all",classe:"all",matiere:"",recherche:""})};return l?r.jsx("div",{className:"ebook-library",children:r.jsxs("div",{className:"ebook-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Chargement de la bibliothque..."})]})}):u?r.jsx("div",{className:"ebook-library",children:r.jsxs("div",{className:"ebook-error",children:[r.jsxs("p",{children:[" ",u]}),r.jsx("button",{onClick:b,className:"btn-retry",children:"Ressayer"})]})}):r.jsxs("div",{className:"ebook-library",children:[r.jsxs("div",{className:"ebook-library-header",children:[r.jsxs("div",{className:"ebook-header-content",children:[r.jsx("h1",{children:" Bibliothque PedaClic"}),r.jsxs("p",{className:"ebook-subtitle",children:["Manuels, annales, fiches de rvision et bien plus encore",!e&&r.jsx("span",{className:"preview-badge",children:"Aperu gratuit disponible"})]})]}),r.jsxs("div",{className:"ebook-search-bar",children:[r.jsx("input",{type:"text",placeholder:"Rechercher un ebook (titre, auteur, mot-cl)...",value:f.recherche||"",onChange:C=>N("recherche",C.target.value),className:"search-input"}),r.jsx("span",{className:"search-icon",children:""})]})]}),r.jsxs("div",{className:"ebook-categories",children:[r.jsxs("button",{className:`category-tab ${f.categorie==="all"?"active":""}`,onClick:()=>N("categorie","all"),children:[" Tous",r.jsx("span",{className:"category-count",children:j.all||0})]}),Object.keys(Yi).map(C=>r.jsxs("button",{className:`category-tab ${f.categorie===C?"active":""}`,onClick:()=>N("categorie",C),children:[Ki[C]," ",Yi[C],r.jsx("span",{className:"category-count",children:j[C]||0})]},C))]}),r.jsxs("div",{className:"ebook-filters",children:[r.jsxs("select",{value:f.niveau||"all",onChange:C=>N("niveau",C.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Tous les niveaux"}),r.jsx("option",{value:"college",children:"Collge"}),r.jsx("option",{value:"lycee",children:"Lyce"})]}),r.jsxs("select",{value:f.classe||"all",onChange:C=>N("classe",C.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Toutes les classes"}),r.jsx("option",{value:"6eme",children:"6me"}),r.jsx("option",{value:"5eme",children:"5me"}),r.jsx("option",{value:"4eme",children:"4me"}),r.jsx("option",{value:"3eme",children:"3me"}),r.jsx("option",{value:"2nde",children:"2nde"}),r.jsx("option",{value:"1ere",children:"1re"}),r.jsx("option",{value:"Terminale",children:"Terminale"})]}),r.jsxs("select",{value:f.matiere||"",onChange:C=>N("matiere",C.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Toutes les matires"}),hP.map(C=>r.jsx("option",{value:C,children:C},C))]}),r.jsxs("div",{className:"view-toggle",children:[r.jsx("button",{className:h==="grid"?"active":"",onClick:()=>v("grid"),title:"Vue grille",children:""}),r.jsx("button",{className:h==="list"?"active":"",onClick:()=>v("list"),title:"Vue liste",children:""})]}),(f.categorie!=="all"||f.niveau!=="all"||f.classe!=="all"||f.matiere||f.recherche)&&r.jsx("button",{onClick:w,className:"btn-reset-filters",children:" Rinitialiser"})]}),r.jsx("div",{className:"ebook-results-info",children:r.jsxs("span",{children:[x.length," ebook",x.length>1?"s":""," trouv",x.length>1?"s":""]})}),x.length===0?r.jsxs("div",{className:"ebook-empty",children:[r.jsx("p",{children:" Aucun ebook trouv avec ces filtres."}),r.jsx("button",{onClick:w,className:"btn-reset-filters",children:"Voir tous les ebooks"})]}):r.jsx("div",{className:`ebook-grid ${h==="list"?"list-view":""}`,children:x.map(C=>r.jsx(Mee,{ebook:C,isPremium:e,onRead:()=>t(C),viewMode:h},C.id))}),!e&&x.length>0&&r.jsx("div",{className:"ebook-premium-banner",children:r.jsxs("div",{className:"premium-banner-content",children:[r.jsx("h3",{children:" Accdez  tous les ebooks en illimit"}),r.jsx("p",{children:"Abonnez-vous  PedaClic Premium pour lire et tlcharger tous les manuels, annales et fiches de rvision sans limite."}),r.jsx("a",{href:"/premium",className:"btn-premium",children:"S'abonner  2 000 FCFA/mois"})]})})]})},Mee=({ebook:e,isPremium:t,onRead:n,viewMode:a})=>r.jsxs("div",{className:`ebook-card ${a==="list"?"ebook-card-list":""}`,children:[r.jsxs("div",{className:"ebook-cover",onClick:n,children:[e.couvertureURL?r.jsx("img",{src:e.couvertureURL,alt:e.titre,loading:"lazy"}):r.jsxs("div",{className:"ebook-cover-placeholder",children:[r.jsx("span",{className:"cover-icon",children:Ki[e.categorie]}),r.jsx("span",{className:"cover-title",children:e.titre})]}),!t&&r.jsx("div",{className:"ebook-badge-premium",children:r.jsx("span",{children:" Premium"})}),r.jsx("div",{className:"ebook-badge-category",children:Yi[e.categorie]})]}),r.jsxs("div",{className:"ebook-info",children:[r.jsx("h3",{className:"ebook-title",onClick:n,children:e.titre}),r.jsx("p",{className:"ebook-author",children:e.auteur}),r.jsx("p",{className:"ebook-description",children:e.description}),r.jsxs("div",{className:"ebook-meta",children:[e.classe!=="all"&&r.jsx("span",{className:"meta-tag",children:e.classe}),e.matiere&&r.jsx("span",{className:"meta-tag",children:e.matiere}),r.jsxs("span",{className:"meta-pages",children:[e.nombrePages," pages"]}),r.jsx("span",{className:"meta-size",children:Ic(e.tailleFichier)})]}),r.jsxs("div",{className:"ebook-actions",children:[r.jsx("button",{className:"btn-read",onClick:n,children:t?" Lire":` Aperu (${e.pagesApercu} pages)`}),t&&r.jsx("a",{href:e.fichierURL,target:"_blank",rel:"noopener noreferrer",className:"btn-download",download:!0,children:" Tlcharger"})]})]})]}),Pee=({ebook:e,isPremium:t,onBack:n,onGoPremium:a})=>{const[l,o]=g.useState(!0),[u,d]=g.useState("info");g.useEffect(()=>{zee(e.id)},[e.id]);const f=()=>t?e.fichierURL:e.aperuURL?e.aperuURL:null,p=async()=>{if(!t){a();return}await kee(e.id),window.open(e.fichierURL,"_blank")},h=()=>{o(!1)};return r.jsxs("div",{className:"ebook-viewer",children:[r.jsxs("div",{className:"viewer-navbar",children:[r.jsx("button",{onClick:n,className:"btn-back",children:" Retour  la bibliothque"}),r.jsxs("div",{className:"viewer-title-bar",children:[r.jsxs("span",{className:"viewer-category",children:[Ki[e.categorie]," ",Yi[e.categorie]]}),r.jsx("h2",{className:"viewer-title",children:e.titre})]}),r.jsxs("div",{className:"viewer-actions-bar",children:[r.jsx("button",{className:`btn-tab ${u==="info"?"active":""}`,onClick:()=>d("info"),children:" Dtails"}),r.jsxs("button",{className:`btn-tab ${u==="read"?"active":""}`,onClick:()=>d("read"),children:[" ",t?"Lire":"Aperu"]})]})]}),u==="info"&&r.jsx("div",{className:"viewer-info-panel",children:r.jsxs("div",{className:"info-layout",children:[r.jsxs("div",{className:"info-cover-column",children:[e.couvertureURL?r.jsx("img",{src:e.couvertureURL,alt:e.titre,className:"info-cover-image"}):r.jsxs("div",{className:"info-cover-placeholder",children:[r.jsx("span",{children:Ki[e.categorie]}),r.jsx("span",{children:e.titre})]}),r.jsxs("div",{className:"info-actions",children:[r.jsxs("button",{className:"btn-action-read",onClick:()=>d("read"),children:[" ",t?"Lire le document":`Aperu (${e.pagesApercu} pages)`]}),t?r.jsx("button",{className:"btn-action-download",onClick:p,children:" Tlcharger le PDF"}):r.jsx("button",{className:"btn-action-premium",onClick:a,children:" Accs complet  Passer Premium"})]})]}),r.jsxs("div",{className:"info-details-column",children:[r.jsx("h1",{className:"info-title",children:e.titre}),r.jsxs("p",{className:"info-author",children:["par ",e.auteur]}),r.jsxs("div",{className:"info-description",children:[r.jsx("h3",{children:"Description"}),r.jsx("p",{children:e.description})]}),r.jsxs("div",{className:"info-metadata",children:[r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Catgorie"}),r.jsxs("span",{className:"metadata-value",children:[Ki[e.categorie]," ",Yi[e.categorie]]})]}),r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Niveau"}),r.jsx("span",{className:"metadata-value",children:e.niveau==="college"?"Collge":"Lyce"})]}),e.classe!=="all"&&r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Classe"}),r.jsx("span",{className:"metadata-value",children:e.classe})]}),e.matiere&&r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Matire"}),r.jsx("span",{className:"metadata-value",children:e.matiere})]}),r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Pages"}),r.jsx("span",{className:"metadata-value",children:e.nombrePages})]}),r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Taille"}),r.jsx("span",{className:"metadata-value",children:Ic(e.tailleFichier)})]}),e.annee&&r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Anne"}),r.jsx("span",{className:"metadata-value",children:e.annee})]}),e.editeur&&r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"diteur"}),r.jsx("span",{className:"metadata-value",children:e.editeur})]})]}),r.jsxs("div",{className:"info-stats",children:[r.jsxs("span",{children:[" ",e.nombreVues," vue",e.nombreVues>1?"s":""]}),r.jsxs("span",{children:[" ",e.nombreTelechargements," tlchargement",e.nombreTelechargements>1?"s":""]})]}),e.tags&&e.tags.length>0&&r.jsx("div",{className:"info-tags",children:e.tags.map((v,b)=>r.jsx("span",{className:"info-tag",children:v},b))})]})]})}),u==="read"&&r.jsx("div",{className:"viewer-read-panel",children:f()?r.jsxs(r.Fragment,{children:[l&&r.jsxs("div",{className:"viewer-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Chargement du document..."})]}),r.jsx("iframe",{src:`${f()}#toolbar=1&navpanes=0`,className:"pdf-iframe",title:e.titre,onLoad:h,style:{display:l?"none":"block"}}),!t&&r.jsx("div",{className:"viewer-premium-overlay",children:r.jsxs("div",{className:"overlay-content",children:[r.jsx("div",{className:"overlay-lock",children:""}),r.jsxs("h3",{children:["Aperu limit  ",e.pagesApercu," pages"]}),r.jsxs("p",{children:["Pour lire l'intgralit de ce document (",e.nombrePages," pages) et le tlcharger, passez  PedaClic Premium."]}),r.jsx("button",{onClick:a,className:"btn-overlay-premium",children:"Passer Premium  2 000 FCFA/mois"}),r.jsx("button",{onClick:n,className:"btn-overlay-back",children:"Retour  la bibliothque"})]})})]}):r.jsx("div",{className:"viewer-no-preview",children:r.jsxs("div",{className:"no-preview-content",children:[r.jsx("div",{className:"overlay-lock",children:""}),r.jsx("h3",{children:"Document rserv aux abonns Premium"}),r.jsxs("p",{children:["Ce document de ",e.nombrePages," pages est accessible uniquement avec un abonnement PedaClic Premium."]}),r.jsx("button",{onClick:a,className:"btn-overlay-premium",children:"Passer Premium  2 000 FCFA/mois"}),r.jsx("button",{onClick:n,className:"btn-overlay-back",children:"Retour  la bibliothque"})]})})})]})},Tee=()=>{const{currentUser:e}=Ze(),t=lt(),[n,a]=g.useState(null),l=d=>{a(d)},o=()=>{a(null)},u=()=>{t("/premium")};return n?r.jsx(Pee,{ebook:n,isPremium:e?.isPremium||!1,onBack:o,onGoPremium:u}):r.jsx(Dee,{isPremium:e?.isPremium||!1,onReadEbook:l})},qee=()=>{const[e,t]=g.useState([]),[n,a]=g.useState(!0),[l,o]=g.useState(null),[u,d]=g.useState(null),[f,p]=g.useState(!1),[h,v]=g.useState(null),[b,x]=g.useState(ee()),[j,N]=g.useState(!1),[w,C]=g.useState(null),[E,S]=g.useState(null),[A,O]=g.useState(null),[k,M]=g.useState(null),D=g.useRef(null),$=g.useRef(null),U=g.useRef(null),[L,B]=g.useState(null);function ee(){return{titre:"",auteur:"",description:"",categorie:"manuel",niveau:"college",classe:"all",matiere:"",nombrePages:0,pagesApercu:5,annee:"",editeur:"",isbn:"",tags:[],ordre:0,isActive:!0}}g.useEffect(()=>{se()},[]);const se=async()=>{try{a(!0),o(null);const V=await Nee();t(V),d(Oee(V))}catch(V){o("Erreur lors du chargement des ebooks"),console.error(V)}finally{a(!1)}},P=V=>{const{name:oe,value:xe,type:ve}=V.target;x(ve==="number"?H=>({...H,[oe]:parseInt(xe)||0}):ve==="checkbox"?H=>({...H,[oe]:V.target.checked}):H=>({...H,[oe]:xe}))},q=V=>{const oe=V.target.value.split(",").map(xe=>xe.trim()).filter(Boolean);x(xe=>({...xe,tags:oe}))},F=async V=>{if(V.preventDefault(),!b.titre.trim()){o("Le titre est obligatoire");return}if(!h&&!E){o("Le fichier PDF est obligatoire");return}try{N(!0),o(null),h?(await Cee(h.id,b,E,A,k),C(` Ebook "${b.titre}" modifi avec succs`)):(await wee(b,E,A,k),C(` Ebook "${b.titre}" ajout avec succs`)),re(),await se(),setTimeout(()=>C(null),4e3)}catch(oe){o(oe.message||"Erreur lors de la sauvegarde")}finally{N(!1)}},R=V=>{v(V),x({titre:V.titre,auteur:V.auteur,description:V.description,categorie:V.categorie,niveau:V.niveau,classe:V.classe,matiere:V.matiere||"",nombrePages:V.nombrePages,pagesApercu:V.pagesApercu,annee:V.annee||"",editeur:V.editeur||"",isbn:V.isbn||"",tags:V.tags||[],ordre:V.ordre,isActive:V.isActive}),p(!0),window.scrollTo({top:0,behavior:"smooth"})},W=async V=>{try{await Eee(V),B(null),C(" Ebook supprim avec succs"),await se(),setTimeout(()=>C(null),4e3)}catch(oe){o(oe.message||"Erreur lors de la suppression")}},I=async(V,oe)=>{try{await Aee(V,!oe),await se()}catch(xe){o(xe.message)}},re=()=>{x(ee()),v(null),S(null),O(null),M(null),p(!1),D.current&&(D.current.value=""),$.current&&($.current.value=""),U.current&&(U.current.value="")};return n?r.jsx("div",{className:"admin-ebooks",children:r.jsxs("div",{className:"admin-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Chargement des ebooks..."})]})}):r.jsxs("div",{className:"admin-ebooks",children:[r.jsxs("div",{className:"admin-ebooks-header",children:[r.jsx("h1",{children:" Gestion de la Bibliothque"}),r.jsx("button",{className:"btn-add-ebook",onClick:()=>{re(),p(!f)},children:f?" Fermer":"+ Ajouter un ebook"})]}),l&&r.jsxs("div",{className:"admin-alert error",children:[" ",l]}),w&&r.jsx("div",{className:"admin-alert success",children:w}),u&&r.jsxs("div",{className:"admin-stats-grid",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("span",{className:"stat-number",children:u.totalEbooks}),r.jsx("span",{className:"stat-label",children:"Total ebooks"})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("span",{className:"stat-number",children:u.ebooksActifs}),r.jsx("span",{className:"stat-label",children:"Actifs"})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("span",{className:"stat-number",children:u.totalVues}),r.jsx("span",{className:"stat-label",children:"Vues totales"})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("span",{className:"stat-number",children:u.totalTelechargements}),r.jsx("span",{className:"stat-label",children:"Tlchargements"})]})]}),f&&r.jsxs("div",{className:"admin-ebook-form-container",children:[r.jsx("h2",{children:h?" Modifier l'ebook":" Ajouter un ebook"}),r.jsxs("form",{onSubmit:F,className:"admin-ebook-form",children:[r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"titre",children:"Titre *"}),r.jsx("input",{id:"titre",name:"titre",type:"text",value:b.titre,onChange:P,placeholder:"Ex: Mathmatiques 3me - Programme complet",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"auteur",children:"Auteur(s) *"}),r.jsx("input",{id:"auteur",name:"auteur",type:"text",value:b.auteur,onChange:P,placeholder:"Ex: Pr. Diallo Moussa",required:!0})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description *"}),r.jsx("textarea",{id:"description",name:"description",value:b.description,onChange:P,placeholder:"Dcrivez le contenu de cet ebook...",rows:3,required:!0})]}),r.jsxs("div",{className:"form-row form-row-3",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"categorie",children:"Catgorie *"}),r.jsx("select",{id:"categorie",name:"categorie",value:b.categorie,onChange:P,children:Object.keys(Yi).map(V=>r.jsxs("option",{value:V,children:[Ki[V]," ",Yi[V]]},V))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"niveau",children:"Niveau *"}),r.jsxs("select",{id:"niveau",name:"niveau",value:b.niveau,onChange:P,children:[r.jsx("option",{value:"college",children:"Collge"}),r.jsx("option",{value:"lycee",children:"Lyce"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"classe",children:"Classe"}),r.jsxs("select",{id:"classe",name:"classe",value:b.classe,onChange:P,children:[r.jsx("option",{value:"all",children:"Toutes les classes"}),r.jsx("option",{value:"6eme",children:"6me"}),r.jsx("option",{value:"5eme",children:"5me"}),r.jsx("option",{value:"4eme",children:"4me"}),r.jsx("option",{value:"3eme",children:"3me"}),r.jsx("option",{value:"2nde",children:"2nde"}),r.jsx("option",{value:"1ere",children:"1re"}),r.jsx("option",{value:"Terminale",children:"Terminale"})]})]})]}),r.jsxs("div",{className:"form-row form-row-3",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"matiere",children:"Matire"}),r.jsxs("select",{id:"matiere",name:"matiere",value:b.matiere,onChange:P,children:[r.jsx("option",{value:"",children:"-- Slectionner --"}),hP.map(V=>r.jsx("option",{value:V,children:V},V))]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"annee",children:"Anne"}),r.jsx("input",{id:"annee",name:"annee",type:"text",value:b.annee,onChange:P,placeholder:"Ex: 2024-2025"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"editeur",children:"diteur"}),r.jsx("input",{id:"editeur",name:"editeur",type:"text",value:b.editeur,onChange:P,placeholder:"Ex: INEADE"})]})]}),r.jsxs("div",{className:"form-row form-row-3",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nombrePages",children:"Nombre de pages *"}),r.jsx("input",{id:"nombrePages",name:"nombrePages",type:"number",value:b.nombrePages,onChange:P,min:"1",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"pagesApercu",children:"Pages en aperu gratuit"}),r.jsx("input",{id:"pagesApercu",name:"pagesApercu",type:"number",value:b.pagesApercu,onChange:P,min:"1",max:"20"}),r.jsx("small",{children:"Nombre de pages visibles sans Premium (1-20)"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"ordre",children:"Ordre d'affichage"}),r.jsx("input",{id:"ordre",name:"ordre",type:"number",value:b.ordre,onChange:P,min:"0"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"tags",children:"Tags (spars par des virgules)"}),r.jsx("input",{id:"tags",type:"text",value:b.tags?.join(", ")||"",onChange:q,placeholder:"Ex: BFEM, annales, mathmatiques, gomtrie"})]}),r.jsxs("div",{className:"form-files-section",children:[r.jsx("h3",{children:" Fichiers"}),r.jsxs("div",{className:"form-group file-group",children:[r.jsxs("label",{children:["Fichier PDF complet ",!h&&"*",h&&r.jsx("small",{children:"(laisser vide pour garder l'actuel)"})]}),r.jsx("input",{ref:D,type:"file",accept:".pdf",onChange:V=>S(V.target.files?.[0]||null),className:"file-input"}),E&&r.jsxs("span",{className:"file-info",children:[" ",E.name," (",Ic(E.size),")"]})]}),r.jsxs("div",{className:"form-group file-group",children:[r.jsxs("label",{children:["Image de couverture",r.jsx("small",{children:"(JPG, PNG  recommand : 400560px)"})]}),r.jsx("input",{ref:$,type:"file",accept:"image/*",onChange:V=>O(V.target.files?.[0]||null),className:"file-input"}),A&&r.jsxs("span",{className:"file-info",children:[" ",A.name," (",Ic(A.size),")"]})]}),r.jsxs("div",{className:"form-group file-group",children:[r.jsxs("label",{children:["PDF Aperu (premires pages uniquement)",r.jsx("small",{children:"(optionnel  sinon le PDF complet est affich aux non-Premium)"})]}),r.jsx("input",{ref:U,type:"file",accept:".pdf",onChange:V=>M(V.target.files?.[0]||null),className:"file-input"}),k&&r.jsxs("span",{className:"file-info",children:[" ",k.name," (",Ic(k.size),")"]})]})]}),r.jsx("div",{className:"form-group checkbox-group",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",name:"isActive",checked:b.isActive,onChange:P}),"Ebook actif (visible dans la bibliothque)"]})}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"submit",className:"btn-save",disabled:j,children:j?" Enregistrement...":h?" Modifier l'ebook":" Ajouter l'ebook"}),r.jsx("button",{type:"button",className:"btn-cancel",onClick:re,children:"Annuler"})]})]})]}),r.jsxs("div",{className:"admin-ebooks-list",children:[r.jsxs("h2",{children:[" Liste des ebooks (",e.length,")"]}),e.length===0?r.jsxs("div",{className:"admin-empty",children:[r.jsx("p",{children:"Aucun ebook pour le moment."}),r.jsx("button",{className:"btn-add-ebook",onClick:()=>p(!0),children:"+ Ajouter le premier ebook"})]}):r.jsx("div",{className:"admin-ebooks-table-wrapper",children:r.jsxs("table",{className:"admin-ebooks-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Couverture"}),r.jsx("th",{children:"Titre / Auteur"}),r.jsx("th",{children:"Catgorie"}),r.jsx("th",{children:"Classe"}),r.jsx("th",{children:"Pages"}),r.jsx("th",{children:"Vues / DL"}),r.jsx("th",{children:"Statut"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:e.map(V=>r.jsxs("tr",{className:V.isActive?"":"row-inactive",children:[r.jsx("td",{className:"td-cover",children:V.couvertureURL?r.jsx("img",{src:V.couvertureURL,alt:"",className:"mini-cover"}):r.jsx("div",{className:"mini-cover-placeholder",children:Ki[V.categorie]})}),r.jsxs("td",{className:"td-title",children:[r.jsx("strong",{children:V.titre}),r.jsx("span",{className:"td-author",children:V.auteur})]}),r.jsx("td",{children:r.jsxs("span",{className:"badge-category",children:[Ki[V.categorie]," ",Yi[V.categorie]]})}),r.jsx("td",{children:V.classe==="all"?"Toutes":V.classe}),r.jsx("td",{children:V.nombrePages}),r.jsx("td",{children:r.jsxs("span",{className:"td-stats",children:[" ",V.nombreVues,r.jsx("br",{})," ",V.nombreTelechargements]})}),r.jsx("td",{children:r.jsx("button",{className:`btn-status ${V.isActive?"active":"inactive"}`,onClick:()=>I(V.id,V.isActive),title:V.isActive?"Dsactiver":"Activer",children:V.isActive?" Actif":" Inactif"})}),r.jsxs("td",{className:"td-actions",children:[r.jsx("button",{className:"btn-edit",onClick:()=>R(V),title:"Modifier",children:""}),L===V.id?r.jsxs("div",{className:"delete-confirm",children:[r.jsx("span",{children:"Supprimer ?"}),r.jsx("button",{className:"btn-confirm-yes",onClick:()=>W(V.id),children:"Oui"}),r.jsx("button",{className:"btn-confirm-no",onClick:()=>B(null),children:"Non"})]}):r.jsx("button",{className:"btn-delete",onClick:()=>B(V.id),title:"Supprimer",children:""})]})]},V.id))})]})})]})]})};function Ree(e){return e.toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}const Iee=({notif:e,onLire:t,onArchiver:n,onSupprimer:a,onNavigate:l})=>{const o=pm[e.type],u=e.statut==="non_lue";return r.jsxs("article",{className:`notif-page__item ${u?"notif-page__item--unread":""}`,"aria-label":`Notification : ${e.titre}`,children:[r.jsx("div",{className:"notif-page__item-icon",style:{background:o.couleur+"20",color:o.couleur},"aria-hidden":"true",children:o.icone}),r.jsxs("div",{className:"notif-page__item-body",children:[r.jsxs("div",{className:"notif-page__item-header",children:[r.jsx("h3",{className:"notif-page__item-titre",children:e.titre}),u&&r.jsx("span",{className:"notif-page__item-badge",children:"Nouvelle"})]}),r.jsx("p",{className:"notif-page__item-message",children:e.message}),r.jsxs("div",{className:"notif-page__item-meta",children:[e.emetteurNom&&r.jsxs("span",{className:"notif-page__item-emetteur",children:["De : ",e.emetteurNom]}),r.jsx("span",{className:"notif-page__item-date",children:Ree(e.createdAt)}),r.jsx("span",{className:"notif-page__item-type",style:{color:o.couleur},children:Rb[e.type]})]}),e.lienAction&&r.jsx("button",{className:"notif-page__item-action-btn",onClick:()=>l(e),children:e.labelAction||"Voir "})]}),r.jsxs("div",{className:"notif-page__item-actions",children:[u&&r.jsx("button",{className:"notif-page__action-btn notif-page__action-btn--read",onClick:()=>t(e.id),title:"Marquer comme lu","aria-label":"Marquer comme lu",children:""}),e.statut!=="archivee"&&r.jsx("button",{className:"notif-page__action-btn notif-page__action-btn--archive",onClick:()=>n(e.id),title:"Archiver","aria-label":"Archiver la notification",children:""}),r.jsx("button",{className:"notif-page__action-btn notif-page__action-btn--delete",onClick:()=>a(e.id),title:"Supprimer","aria-label":"Supprimer la notification",children:""})]})]})},Lee=()=>{const{currentUser:e}=Ze(),t=lt(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState("toutes"),[h,v]=g.useState("tous"),[b,x]=g.useState(!1),j=g.useCallback(async()=>{if(e){o(!0),d(null);try{const k=await L3(e.uid,{includeArchived:f==="archivee",limitCount:100});a(k)}catch(k){d("Impossible de charger les notifications."),console.error("[Phase 26] Erreur chargement notifications:",k)}finally{o(!1)}}},[e,f]);g.useEffect(()=>{j()},[j]);const N=n.filter(k=>{const M=f==="toutes"||k.statut===f,D=h==="tous"||k.type===h;return M&&D}),w=n.filter(k=>k.statut==="non_lue").length,C=async k=>{await wx(k),a(M=>M.map(D=>D.id===k?{...D,statut:"lue",luAt:new Date}:D))},E=async k=>{await B3(k),a(M=>M.map(D=>D.id===k?{...D,statut:"archivee"}:D))},S=async k=>{window.confirm("Supprimer cette notification ?")&&(await U3(k),a(M=>M.filter(D=>D.id!==k)))},A=async k=>{k.statut==="non_lue"&&await wx(k.id),k.lienAction&&t(k.lienAction)},O=async()=>{if(!(!e||b)){x(!0);try{await mA(e.uid),a(k=>k.map(M=>M.statut==="non_lue"?{...M,statut:"lue",luAt:new Date}:M))}finally{x(!1)}}};return r.jsxs("div",{className:"notif-page",children:[r.jsxs("div",{className:"notif-page__header",children:[r.jsxs("div",{className:"notif-page__header-left",children:[r.jsx("h1",{className:"notif-page__title",children:" Notifications"}),w>0&&r.jsxs("span",{className:"notif-page__unread-count",children:[w," non ",w>1?"lues":"lue"]})]}),w>0&&r.jsx("button",{className:"notif-page__mark-all-btn",onClick:O,disabled:b,children:b?"En cours":" Tout marquer comme lu"})]}),r.jsxs("div",{className:"notif-page__filters",children:[r.jsxs("div",{className:"notif-page__filter-group",children:[r.jsx("label",{className:"notif-page__filter-label",children:"Statut"}),r.jsx("div",{className:"notif-page__filter-tabs",children:["toutes","non_lue","lue","archivee"].map(k=>r.jsx("button",{className:`notif-page__filter-tab ${f===k?"notif-page__filter-tab--active":""}`,onClick:()=>p(k),children:k==="toutes"?"Toutes":k==="non_lue"?" Non lues":k==="lue"?" Lues":" Archives"},k))})]}),r.jsxs("div",{className:"notif-page__filter-group",children:[r.jsx("label",{className:"notif-page__filter-label",children:"Type"}),r.jsxs("select",{className:"notif-page__filter-select",value:h,onChange:k=>v(k.target.value),children:[r.jsx("option",{value:"tous",children:"Tous les types"}),Object.entries(Rb).map(([k,M])=>r.jsx("option",{value:k,children:M},k))]})]})]}),l?r.jsx("div",{className:"notif-page__loading",children:[1,2,3].map(k=>r.jsx("div",{className:"notif-page__skeleton"},k))}):u?r.jsxs("div",{className:"notif-page__error",children:[r.jsxs("p",{children:[" ",u]}),r.jsx("button",{onClick:j,className:"notif-page__retry-btn",children:"Ressayer"})]}):N.length===0?r.jsxs("div",{className:"notif-page__empty",children:[r.jsx("span",{className:"notif-page__empty-icon",children:""}),r.jsx("p",{className:"notif-page__empty-title",children:"Aucune notification"}),r.jsx("p",{className:"notif-page__empty-sub",children:f==="non_lue"?"Vous tes  jour, aucune notification non lue.":"Aucune notification correspondant  vos filtres."})]}):r.jsx("div",{className:"notif-page__list",children:N.map(k=>r.jsx(Iee,{notif:k,onLire:C,onArchiver:E,onSupprimer:S,onNavigate:A},k.id))})]})},tA={type:"annonce",titre:"",message:"",lienAction:"",labelAction:"",modeDestinataire:"role",destinataireEmail:"",destinataireId:"",groupeId:"",roleDestinataire:"eleve",canal:"les_deux"},rA=()=>{const{currentUser:e}=Ze(),t=lt(),[n,a]=g.useState(tA),[l,o]=g.useState([]),[u,d]=g.useState("idle"),[f,p]=g.useState(null),[h,v]=g.useState(0);g.useEffect(()=>{if(!e)return;const E=e.role==="admin"?Ee(je(K,"groupes_prof")):Ee(je(K,"groupes_prof"),Se("profId","==",e.uid));Ce(E).then(S=>{o(S.docs.map(A=>({id:A.id,nom:A.data().nom,classe:A.data().classe,nombreInscrits:A.data().nombreInscrits??0})))})},[e]);const b=(C,E)=>{a(S=>({...S,[C]:E}))},x=C=>{const E=pm[C];a(S=>({...S,type:C,titre:E.titreDefaut,message:E.messageDefaut}))},j=()=>!(!n.titre.trim()||!n.message.trim()||n.modeDestinataire==="individuel"&&!n.destinataireEmail.trim()||n.modeDestinataire==="groupe"&&!n.groupeId),N=async()=>{if(!(!e||!j())){d("sending"),p(null);try{const C={type:n.type,titre:n.titre,message:n.message,lienAction:n.lienAction||void 0,labelAction:n.labelAction||void 0,emetteurId:e.uid,emetteurNom:e.displayName||e.email||"PedaClic",canal:n.canal};if(n.modeDestinataire==="individuel")await q3({...C,destinataireId:n.destinataireId||n.destinataireEmail,destinataireRole:"eleve",emailDestinataire:n.canal!=="in_app"?n.destinataireEmail:void 0,emailDestinatairNom:n.destinataireEmail}),v(1);else if(n.modeDestinataire==="groupe"){const E=await R3(n.groupeId,{...C,destinataireRole:"eleve"});v(E)}else{const E=await I3(n.roleDestinataire,C);v(E)}d("success")}catch(C){p(C instanceof Error?C.message:"Erreur inconnue"),d("error")}}},w=()=>{a(tA),d("idle"),p(null),v(0)};return u==="success"?r.jsx("div",{className:"notif-composer notif-composer--success",children:r.jsxs("div",{className:"notif-composer__success-card",children:[r.jsx("span",{className:"notif-composer__success-icon",children:""}),r.jsx("h2",{children:"Notification envoye !"}),r.jsxs("p",{children:[r.jsx("strong",{children:h})," destinataire",h>1?"s":""," notifi",h>1?"s":"","."]}),r.jsxs("div",{className:"notif-composer__success-actions",children:[r.jsx("button",{className:"notif-composer__btn notif-composer__btn--primary",onClick:w,children:" Nouvelle notification"}),r.jsx("button",{className:"notif-composer__btn notif-composer__btn--secondary",onClick:()=>t(-1),children:" Retour"})]})]})}):r.jsxs("div",{className:"notif-composer",children:[r.jsxs("div",{className:"notif-composer__header",children:[r.jsx("button",{className:"notif-composer__back-btn",onClick:()=>t(-1),children:" Retour"}),r.jsx("h1",{className:"notif-composer__title",children:" Envoyer une notification"})]}),r.jsxs("div",{className:"notif-composer__form",children:[r.jsxs("section",{className:"notif-composer__section",children:[r.jsx("h2",{className:"notif-composer__section-title",children:"1. Type de notification"}),r.jsx("div",{className:"notif-composer__type-grid",children:Object.entries(Rb).filter(([C])=>!["bienvenue","nouveau_abonnement","resultat_quiz"].includes(C)).map(([C,E])=>{const S=pm[C];return r.jsxs("button",{className:`notif-composer__type-card ${n.type===C?"notif-composer__type-card--active":""}`,onClick:()=>x(C),style:n.type===C?{borderColor:S.couleur,background:S.couleur+"12"}:{},children:[r.jsx("span",{className:"notif-composer__type-icon",children:S.icone}),r.jsx("span",{className:"notif-composer__type-label",children:E})]},C)})})]}),r.jsxs("section",{className:"notif-composer__section",children:[r.jsx("h2",{className:"notif-composer__section-title",children:"2. Destinataires"}),r.jsx("div",{className:"notif-composer__mode-tabs",children:[{value:"role",label:" Par rle"},{value:"groupe",label:" Groupe-classe"},{value:"individuel",label:" Individuel"}].map(({value:C,label:E})=>r.jsx("button",{className:`notif-composer__mode-tab ${n.modeDestinataire===C?"notif-composer__mode-tab--active":""}`,onClick:()=>b("modeDestinataire",C),children:E},C))}),n.modeDestinataire==="role"&&r.jsxs("div",{className:"notif-composer__field",children:[r.jsx("label",{className:"notif-composer__label",children:"Envoyer  :"}),r.jsx("div",{className:"notif-composer__role-grid",children:Object.entries(F3).map(([C,E])=>r.jsx("button",{className:`notif-composer__role-card ${n.roleDestinataire===C?"notif-composer__role-card--active":""}`,onClick:()=>b("roleDestinataire",C),children:E},C))})]}),n.modeDestinataire==="groupe"&&r.jsxs("div",{className:"notif-composer__field",children:[r.jsx("label",{className:"notif-composer__label",children:"Groupe-classe :"}),l.length===0?r.jsx("p",{className:"notif-composer__hint",children:"Aucun groupe-classe disponible."}):r.jsxs("select",{className:"notif-composer__select",value:n.groupeId,onChange:C=>b("groupeId",C.target.value),children:[r.jsx("option",{value:"",children:" Choisir un groupe "}),l.map(C=>r.jsxs("option",{value:C.id,children:[C.nom,"  ",C.classe," (",C.nombreInscrits," lves)"]},C.id))]})]}),n.modeDestinataire==="individuel"&&r.jsxs("div",{className:"notif-composer__field",children:[r.jsx("label",{className:"notif-composer__label",children:"Email du destinataire :"}),r.jsx("input",{type:"email",className:"notif-composer__input",placeholder:"eleve@exemple.sn",value:n.destinataireEmail,onChange:C=>b("destinataireEmail",C.target.value)}),r.jsx("p",{className:"notif-composer__hint",children:"L'utilisateur doit tre inscrit sur PedaClic."})]})]}),r.jsxs("section",{className:"notif-composer__section",children:[r.jsx("h2",{className:"notif-composer__section-title",children:"3. Contenu"}),r.jsxs("div",{className:"notif-composer__field",children:[r.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-titre",children:["Titre ",r.jsx("span",{className:"notif-composer__required",children:"*"})]}),r.jsx("input",{id:"notif-titre",type:"text",className:"notif-composer__input",placeholder:"Ex : Nouveau devoir de mathmatiques",value:n.titre,onChange:C=>b("titre",C.target.value),maxLength:100}),r.jsxs("span",{className:"notif-composer__char-count",children:[n.titre.length,"/100"]})]}),r.jsxs("div",{className:"notif-composer__field",children:[r.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-message",children:["Message ",r.jsx("span",{className:"notif-composer__required",children:"*"})]}),r.jsx("textarea",{id:"notif-message",className:"notif-composer__textarea",placeholder:"Rdigez votre message ici",value:n.message,onChange:C=>b("message",C.target.value),rows:4,maxLength:500}),r.jsxs("span",{className:"notif-composer__char-count",children:[n.message.length,"/500"]})]}),r.jsxs("div",{className:"notif-composer__field-row",children:[r.jsxs("div",{className:"notif-composer__field",children:[r.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-lien",children:["Lien d'action ",r.jsx("span",{className:"notif-composer__optional",children:"(optionnel)"})]}),r.jsx("input",{id:"notif-lien",type:"text",className:"notif-composer__input",placeholder:"/cours/abc123",value:n.lienAction,onChange:C=>b("lienAction",C.target.value)})]}),r.jsxs("div",{className:"notif-composer__field",children:[r.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-label",children:["Texte du bouton ",r.jsx("span",{className:"notif-composer__optional",children:"(optionnel)"})]}),r.jsx("input",{id:"notif-label",type:"text",className:"notif-composer__input",placeholder:"Voir le cours",value:n.labelAction,onChange:C=>b("labelAction",C.target.value)})]})]})]}),r.jsxs("section",{className:"notif-composer__section",children:[r.jsx("h2",{className:"notif-composer__section-title",children:"4. Canal d'envoi"}),r.jsx("div",{className:"notif-composer__canal-grid",children:[{value:"in_app",label:" In-app seulement",desc:"Cloche dans l'interface"},{value:"email",label:" Email seulement",desc:"Via Resend"},{value:"les_deux",label:" In-app + Email",desc:"Les deux canaux"}].map(({value:C,label:E,desc:S})=>r.jsxs("button",{className:`notif-composer__canal-card ${n.canal===C?"notif-composer__canal-card--active":""}`,onClick:()=>b("canal",C),children:[r.jsx("span",{className:"notif-composer__canal-label",children:E}),r.jsx("span",{className:"notif-composer__canal-desc",children:S})]},C))}),(n.canal==="email"||n.canal==="les_deux")&&n.modeDestinataire!=="individuel"&&r.jsx("p",{className:"notif-composer__canal-warning",children:" Pour l'envoi par email en mode groupe/rle, assurez-vous que Railway est bien dploy et que la cl API Resend est configure."})]}),u==="error"&&f&&r.jsxs("div",{className:"notif-composer__error",children:[" ",f]}),r.jsxs("div",{className:"notif-composer__footer",children:[r.jsx("button",{className:"notif-composer__btn notif-composer__btn--secondary",onClick:()=>t(-1),disabled:u==="sending",children:"Annuler"}),r.jsx("button",{className:"notif-composer__btn notif-composer__btn--primary",onClick:N,disabled:!j()||u==="sending",children:u==="sending"?" Envoi en cours":" Envoyer la notification"})]})]})]})},$ee=()=>{const{currentUser:e}=Ze(),t=e?.uid||"",n=e?.displayName||"Parent",[a,l]=g.useState([]),[o,u]=g.useState(null),[d,f]=g.useState(null),[p,h]=g.useState(!0),[v,b]=g.useState(!1),[x,j]=g.useState(null),[N,w]=g.useState(!1),[C,E]=g.useState(""),[S,A]=g.useState(!1),[O,k]=g.useState(null),[M,D]=g.useState(null),[$,U]=g.useState("apercu");g.useEffect(()=>{L()},[t]),g.useEffect(()=>{o&&B(o)},[o]);const L=async()=>{try{h(!0),j(null);const P=await UX(t);l(P),P.length===1&&u(P[0].enfantId)}catch(P){j("Erreur lors du chargement des enfants."),console.error(P)}finally{h(!1)}},B=async P=>{try{b(!0),j(null);const q=await GX(t,P);f(q)}catch(q){j(q.message||"Erreur lors du chargement du suivi."),f(null)}finally{b(!1)}},ee=async P=>{if(P.preventDefault(),k(null),D(null),!C.trim()){k("Veuillez saisir le code d'invitation.");return}try{A(!0);const q=await BX(t,C);D(`${q.enfantNom} a t ajout avec succs !`),E(""),w(!1),await L(),u(q.enfantId)}catch(q){k(q.message||"Erreur lors de la liaison.")}finally{A(!1)}},se=async P=>{if(window.confirm(`tes-vous sr de vouloir retirer ${P.enfantNom} de votre suivi ? Cette action est irrversible.`))try{await FX(P.id,t),o===P.enfantId&&(u(null),f(null)),await L()}catch(F){j(F.message||"Erreur lors de la suppression.")}};return p?r.jsxs("div",{className:"parent-loading",children:[r.jsx("div",{className:"parent-spinner"}),r.jsx("p",{children:"Chargement de votre espace parent..."})]}):r.jsxs("div",{className:"parent-dashboard",children:[r.jsxs("header",{className:"parent-header",children:[r.jsxs("div",{className:"parent-header-info",children:[r.jsx("h1",{className:"parent-titre",children:" Espace Parent"}),r.jsxs("p",{className:"parent-bienvenue",children:["Bienvenue, ",r.jsx("strong",{children:n}),"  Suivez la progression de vos enfants"]})]}),r.jsx("button",{className:"parent-btn parent-btn-primary",onClick:()=>{w(!N),k(null),D(null)},children:" Ajouter un enfant"})]}),x&&r.jsxs("div",{className:"parent-alerte parent-alerte-erreur",children:[r.jsxs("span",{children:[" ",x]}),r.jsx("button",{onClick:()=>j(null),children:""})]}),M&&r.jsxs("div",{className:"parent-alerte parent-alerte-succes",children:[r.jsxs("span",{children:[" ",M]}),r.jsx("button",{onClick:()=>D(null),children:""})]}),N&&r.jsxs("div",{className:"parent-form-liaison",children:[r.jsx("h3",{children:" Lier un enfant  votre compte"}),r.jsx("p",{className:"parent-form-aide",children:"Demandez le code d'invitation  votre enfant. Il peut le trouver dans son profil sur PedaClic (format: PEDA-XXXX-XXXX)."}),r.jsxs("form",{onSubmit:ee,className:"parent-form",children:[r.jsxs("div",{className:"parent-form-group",children:[r.jsx("label",{htmlFor:"code-invitation",children:"Code d'invitation"}),r.jsx("input",{id:"code-invitation",type:"text",placeholder:"PEDA-XXXX-XXXX",value:C,onChange:P=>E(P.target.value.toUpperCase()),maxLength:14,disabled:S,className:"parent-input"})]}),O&&r.jsxs("p",{className:"parent-form-erreur",children:[" ",O]}),r.jsxs("div",{className:"parent-form-actions",children:[r.jsx("button",{type:"submit",className:"parent-btn parent-btn-primary",disabled:S,children:S?"Vrification...":" Valider"}),r.jsx("button",{type:"button",className:"parent-btn parent-btn-secondary",onClick:()=>w(!1),children:"Annuler"})]})]})]}),a.length===0?r.jsxs("div",{className:"parent-empty-state",children:[r.jsx("div",{className:"parent-empty-icon",children:""}),r.jsx("h2",{children:"Aucun enfant li"}),r.jsx("p",{children:"Cliquez sur  Ajouter un enfant  et saisissez le code d'invitation de votre enfant pour commencer  suivre sa progression."}),r.jsx("button",{className:"parent-btn parent-btn-primary",onClick:()=>w(!0),children:" Ajouter mon premier enfant"})]}):r.jsxs("div",{className:"parent-content",children:[r.jsxs("aside",{className:"parent-sidebar",children:[r.jsx("h3",{className:"parent-sidebar-titre",children:"Mes enfants"}),r.jsx("ul",{className:"parent-enfants-liste",children:a.map(P=>r.jsxs("li",{className:`parent-enfant-card ${o===P.enfantId?"parent-enfant-actif":""}`,onClick:()=>u(P.enfantId),children:[r.jsx("div",{className:"parent-enfant-avatar",children:P.enfantNom.charAt(0).toUpperCase()}),r.jsxs("div",{className:"parent-enfant-info",children:[r.jsx("span",{className:"parent-enfant-nom",children:P.enfantNom}),P.enfantClasse&&r.jsx("span",{className:"parent-enfant-classe",children:P.enfantClasse})]}),r.jsx("button",{className:"parent-enfant-supprimer",onClick:q=>{q.stopPropagation(),se(P)},title:"Retirer cet enfant",children:""})]},P.id))})]}),r.jsx("main",{className:"parent-main",children:o?v?r.jsxs("div",{className:"parent-loading",children:[r.jsx("div",{className:"parent-spinner"}),r.jsx("p",{children:"Chargement du suivi..."})]}):d?r.jsxs("div",{className:"parent-dashboard-detail",children:[r.jsxs("div",{className:"parent-enfant-header",children:[r.jsxs("div",{className:"parent-enfant-header-info",children:[r.jsx("h2",{children:d.enfant.nom}),d.enfant.classe&&r.jsx("span",{className:"parent-badge",children:d.enfant.classe}),d.enfant.derniereConnexion&&r.jsxs("span",{className:"parent-derniere-connexion",children:["Dernire connexion : ",yx(d.enfant.derniereConnexion)]})]}),r.jsx("p",{className:"parent-message-motivation",children:WX(d.scoreGlobal)})]}),r.jsxs("div",{className:"parent-indicateurs",children:[r.jsxs("div",{className:"parent-card parent-card-score",children:[r.jsx("div",{className:"parent-card-icon",children:""}),r.jsxs("div",{className:"parent-card-content",children:[r.jsx("span",{className:"parent-card-label",children:"Score Global"}),r.jsxs("span",{className:`parent-card-value parent-score-${d.scoreGlobal>=60?"bon":d.scoreGlobal>=40?"moyen":"bas"}`,children:[d.scoreGlobal,"/100"]})]})]}),r.jsxs("div",{className:"parent-card parent-card-streak",children:[r.jsx("div",{className:"parent-card-icon",children:""}),r.jsxs("div",{className:"parent-card-content",children:[r.jsx("span",{className:"parent-card-label",children:"Streak"}),r.jsxs("span",{className:"parent-card-value",children:[d.streak.actuel," jour",d.streak.actuel>1?"s":""]})]})]}),r.jsxs("div",{className:"parent-card parent-card-lacunes",children:[r.jsx("div",{className:"parent-card-icon",children:""}),r.jsxs("div",{className:"parent-card-content",children:[r.jsx("span",{className:"parent-card-label",children:"Lacunes"}),r.jsxs("span",{className:"parent-card-value",children:[d.lacunes.length," matire",d.lacunes.length>1?"s":""]})]})]}),r.jsxs("div",{className:"parent-card parent-card-objectifs",children:[r.jsx("div",{className:"parent-card-icon",children:""}),r.jsxs("div",{className:"parent-card-content",children:[r.jsx("span",{className:"parent-card-label",children:"Objectifs"}),r.jsxs("span",{className:"parent-card-value",children:[d.objectifs.filter(P=>P.statut==="atteint").length,"/",d.objectifs.length]})]})]})]}),r.jsxs("div",{className:"parent-section parent-section-semaine",children:[r.jsx("h3",{children:" Activit de la semaine"}),r.jsx("div",{className:"parent-semaine-jours",children:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"].map((P,q)=>r.jsxs("div",{className:`parent-jour ${d.streak.semaineCourante[q]?"parent-jour-actif":"parent-jour-inactif"}`,children:[r.jsx("span",{className:"parent-jour-label",children:P}),r.jsx("span",{className:"parent-jour-icon",children:d.streak.semaineCourante[q]?"":""})]},P))})]}),r.jsxs("div",{className:"parent-onglets",children:[r.jsx("button",{className:`parent-onglet ${$==="apercu"?"parent-onglet-actif":""}`,onClick:()=>U("apercu"),children:" Aperu"}),r.jsxs("button",{className:`parent-onglet ${$==="lacunes"?"parent-onglet-actif":""}`,onClick:()=>U("lacunes"),children:[" Lacunes (",d.lacunes.length,")"]}),r.jsxs("button",{className:`parent-onglet ${$==="alertes"?"parent-onglet-actif":""}`,onClick:()=>U("alertes"),children:[" Alertes (",d.alertes.length,")"]}),r.jsx("button",{className:`parent-onglet ${$==="resume"?"parent-onglet-actif":""}`,onClick:()=>U("resume"),children:" Rsum"})]}),r.jsxs("div",{className:"parent-onglet-contenu",children:[$==="apercu"&&r.jsxs("div",{className:"parent-tab-apercu",children:[r.jsxs("div",{className:"parent-section",children:[r.jsx("h3",{children:" Derniers quiz passs"}),d.derniersQuiz.length===0?r.jsx("p",{className:"parent-vide",children:"Aucun quiz pass rcemment."}):r.jsx("div",{className:"parent-quiz-liste",children:d.derniersQuiz.map((P,q)=>r.jsxs("div",{className:`parent-quiz-item ${P.reussi?"parent-quiz-reussi":"parent-quiz-echoue"}`,children:[r.jsxs("div",{className:"parent-quiz-info",children:[r.jsx("span",{className:"parent-quiz-discipline",children:P.disciplineNom}),r.jsx("span",{className:"parent-quiz-titre",children:P.quizTitre})]}),r.jsxs("div",{className:"parent-quiz-score",children:[r.jsxs("span",{className:`parent-quiz-note ${P.reussi?"note-ok":"note-ko"}`,children:[P.noteSur20,"/20"]}),r.jsx("span",{className:"parent-quiz-statut",children:P.reussi?" Russi":" chou"})]}),r.jsx("span",{className:"parent-quiz-date",children:yx(P.datePassage)})]},q))})]}),r.jsxs("div",{className:"parent-section",children:[r.jsx("h3",{children:" Objectifs de la semaine"}),d.objectifs.length===0?r.jsx("p",{className:"parent-vide",children:"Aucun objectif cette semaine."}):r.jsx("div",{className:"parent-objectifs-liste",children:d.objectifs.map((P,q)=>r.jsxs("div",{className:"parent-objectif-item",children:[r.jsxs("div",{className:"parent-objectif-header",children:[r.jsx("span",{className:"parent-objectif-titre",children:P.titre}),r.jsx("span",{className:`parent-objectif-statut parent-statut-${P.statut}`,children:P.statut==="atteint"?" Atteint":P.statut==="en_cours"?" En cours":P.statut==="echoue"?" chou":" Non commenc"})]}),r.jsx("div",{className:"parent-progress-bar",children:r.jsx("div",{className:`parent-progress-fill parent-progress-${P.statut}`,style:{width:`${Math.min(P.progression/P.cible*100,100)}%`}})}),r.jsxs("span",{className:"parent-objectif-detail",children:[P.progression,"/",P.cible]})]},q))})]})]}),$==="lacunes"&&r.jsx("div",{className:"parent-tab-lacunes",children:d.lacunes.length===0?r.jsxs("div",{className:"parent-vide-section",children:[r.jsx("span",{className:"parent-vide-icon",children:""}),r.jsx("p",{children:"Aucune lacune dtecte ! Votre enfant est sur la bonne voie."})]}):r.jsx("div",{className:"parent-lacunes-liste",children:d.lacunes.map((P,q)=>r.jsxs("div",{className:"parent-lacune-item",style:{borderLeftColor:mf(P.niveauUrgence)},children:[r.jsxs("div",{className:"parent-lacune-header",children:[r.jsx("span",{className:"parent-lacune-discipline",children:P.disciplineNom}),r.jsx("span",{className:"parent-lacune-badge",style:{backgroundColor:mf(P.niveauUrgence),color:"#fff"},children:VM(P.niveauUrgence)})]}),r.jsxs("div",{className:"parent-lacune-details",children:[r.jsxs("span",{className:"parent-lacune-moyenne",children:["Moyenne : ",r.jsxs("strong",{children:[P.moyenne,"/20"]})]}),r.jsxs("span",{className:"parent-lacune-tendance",children:["Tendance : ",YM(P.tendance)," ",P.tendance==="hausse"?"En hausse":P.tendance==="baisse"?"En baisse":"Stable"]})]}),r.jsx("p",{className:"parent-lacune-conseil",children:P.niveauUrgence==="critique"?" Intervention recommande : discutez avec votre enfant et envisagez un soutien scolaire.":P.niveauUrgence==="important"?" Encouragez votre enfant  rviser cette matire rgulirement.":" Quelques rvisions suffiront pour consolider les acquis."})]},q))})}),$==="alertes"&&r.jsx("div",{className:"parent-tab-alertes",children:d.alertes.length===0?r.jsxs("div",{className:"parent-vide-section",children:[r.jsx("span",{className:"parent-vide-icon",children:""}),r.jsx("p",{children:"Aucune alerte pour le moment. Tout va bien !"})]}):r.jsx("div",{className:"parent-alertes-liste",children:d.alertes.map((P,q)=>r.jsxs("div",{className:`parent-alerte-item parent-alerte-${P.niveau}`,children:[r.jsxs("div",{className:"parent-alerte-header",children:[r.jsx("span",{className:"parent-alerte-titre",children:P.titre}),r.jsx("span",{className:"parent-alerte-badge",style:{backgroundColor:YX(P.niveau),color:"#fff"},children:KX(P.type)})]}),r.jsx("p",{className:"parent-alerte-message",children:P.message}),r.jsx("span",{className:"parent-alerte-date",children:yx(P.dateCreation)})]},q))})}),$==="resume"&&d.resume&&r.jsxs("div",{className:"parent-tab-resume",children:[r.jsxs("div",{className:"parent-resume-header",children:[r.jsxs("h3",{children:[" Rsum : ",d.resume.semaine]}),r.jsxs("span",{className:"parent-resume-evolution",children:["Score : ",d.resume.scoreGlobal,"/100"," ",LE(d.resume.evolutionScore)]})]}),r.jsxs("div",{className:"parent-resume-stats",children:[r.jsxs("div",{className:"parent-resume-stat",children:[r.jsx("span",{className:"parent-resume-stat-value",children:d.resume.nombreQuizSemaine}),r.jsx("span",{className:"parent-resume-stat-label",children:"Quiz passs"})]}),r.jsxs("div",{className:"parent-resume-stat",children:[r.jsxs("span",{className:"parent-resume-stat-value",children:[d.resume.joursActifsSemaine,"/7"]}),r.jsx("span",{className:"parent-resume-stat-label",children:"Jours actifs"})]}),r.jsxs("div",{className:"parent-resume-stat",children:[r.jsxs("span",{className:"parent-resume-stat-value",children:[d.resume.tempsEstimeMinutes," min"]}),r.jsx("span",{className:"parent-resume-stat-label",children:"Temps d'tude"})]}),r.jsxs("div",{className:"parent-resume-stat",children:[r.jsxs("span",{className:"parent-resume-stat-value",children:[d.resume.objectifsAtteints,"/",d.resume.objectifsTotal]}),r.jsx("span",{className:"parent-resume-stat-label",children:"Objectifs atteints"})]})]}),d.resume.evolutionDisciplines.length>0&&r.jsxs("div",{className:"parent-section",children:[r.jsx("h4",{children:" volution par matire"}),r.jsx("div",{className:"parent-evolution-liste",children:d.resume.evolutionDisciplines.map((P,q)=>r.jsxs("div",{className:"parent-evolution-item",children:[r.jsx("span",{className:"parent-evolution-discipline",children:P.disciplineNom}),r.jsxs("div",{className:"parent-evolution-scores",children:[r.jsxs("span",{className:"parent-evolution-prec",children:[P.moyenneSemainePrecedente,"/20"]}),r.jsx("span",{className:"parent-evolution-fleche",children:LE(P.evolution)}),r.jsxs("span",{className:"parent-evolution-courante",children:[P.moyenneSemaineCourante,"/20"]}),r.jsxs("span",{className:`parent-evolution-ecart ${P.ecart>0?"ecart-positif":P.ecart<0?"ecart-negatif":""}`,children:["(",P.ecart>0?"+":"",P.ecart,")"]})]})]},q))})]}),d.resume.disciplinesEnDifficulte.length>0&&r.jsxs("div",{className:"parent-section parent-section-warning",children:[r.jsx("h4",{children:" Matires ncessitant une attention"}),r.jsx("ul",{className:"parent-disciplines-difficulte",children:d.resume.disciplinesEnDifficulte.map((P,q)=>r.jsx("li",{children:P},q))})]})]}),$==="resume"&&!d.resume&&r.jsxs("div",{className:"parent-vide-section",children:[r.jsx("span",{className:"parent-vide-icon",children:""}),r.jsx("p",{children:"Le rsum sera disponible une fois que votre enfant aura pass des quiz."})]})]})]}):r.jsxs("div",{className:"parent-erreur-dashboard",children:[r.jsx("p",{children:" Impossible de charger le suivi. Veuillez ressayer."}),r.jsx("button",{className:"parent-btn parent-btn-primary",onClick:()=>o&&B(o),children:" Ressayer"})]}):r.jsx("div",{className:"parent-select-enfant",children:r.jsx("p",{children:" Slectionnez un enfant dans la liste pour voir son suivi."})})})]})]})},Nj="compiled_ebooks";async function Bee(e,t,n,a){return(await qt(je(K,Nj),{userId:e,titre:t,description:n,sections:a,createdAt:Oe.now()})).id}async function nA(e,t=30){const n=Ee(je(K,Nj),Se("userId","==",e),Ve("createdAt","desc")),a=await Ce(n),l=[];return a.forEach(o=>{l.length<t&&l.push({id:o.id,...o.data()})}),l}async function Uee(e){await rn(Ne(K,Nj,e))}const Fee=({userId:e,history:t,onClose:n,onSaved:a,markdownToHtml:l})=>{const[o,u]=g.useState("select"),[d,f]=g.useState([]),[p,h]=g.useState(""),[v,b]=g.useState(""),[x,j]=g.useState(!1),[N,w]=g.useState(!1),[C,E]=g.useState(""),S=t.filter(L=>L.type!=="quiz_auto"&&L.content);function A(L){f(B=>B.some(se=>se.id===L.id)?B.filter(se=>se.id!==L.id):[...B,L])}function O(L){L!==0&&f(B=>{const ee=[...B];return[ee[L-1],ee[L]]=[ee[L],ee[L-1]],ee})}function k(L){f(B=>{if(L===B.length-1)return B;const ee=[...B];return[ee[L],ee[L+1]]=[ee[L+1],ee[L]],ee})}const M=g.useCallback((L=!1)=>{const B=d.map((ee,se)=>`
      <section class="ebook-section">
        <div class="section-header">
          <span class="section-num">${se+1}</span>
          <div class="section-meta">
            <h2 class="section-title">${ee.chapitre}</h2>
            <p class="section-subtitle">
              ${mr[ee.type]} &nbsp;&nbsp;
              ${ee.discipline} &nbsp;&nbsp; Classe : ${ee.classe}
            </p>
          </div>
        </div>
        <div class="section-body">${l(ee.content||"")}</div>
      </section>`).join('<div class="page-break"></div>');return`<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>${p||"Ebook PedaClic"}</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Georgia', serif;
      font-size: 12pt;
      line-height: 1.75;
      color: #1a1a2e;
      background: #fff;
      padding: ${L?"0":"2rem"};
      max-width: 860px;
      margin: auto;
    }
    /*  Couverture  */
    .cover {
      min-height: ${L?"100vh":"280px"};
      background: linear-gradient(135deg, #1a56db 0%, #7c3aed 100%);
      border-radius: ${L?"0":"12px"};
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 3rem 2rem;
      color: #fff;
      margin-bottom: 2.5rem;
    }
    .cover-logo { font-size: 3rem; margin-bottom: 1rem; }
    .cover-title { font-size: 2rem; font-weight: 700; line-height: 1.2; margin-bottom: 0.75rem; }
    .cover-desc { font-size: 1rem; opacity: 0.85; max-width: 480px; }
    .cover-meta { margin-top: 1.5rem; font-size: 0.85rem; opacity: 0.7; }
    /*  Sommaire  */
    .toc {
      background: #f8faff;
      border: 1px solid #dbeafe;
      border-radius: 10px;
      padding: 1.5rem 2rem;
      margin-bottom: 2.5rem;
    }
    .toc h2 { font-size: 1.1rem; color: #1a56db; margin-bottom: 1rem; }
    .toc ol { padding-left: 1.25rem; }
    .toc li { padding: 0.3rem 0; font-size: 0.95rem; color: #374151; }
    .toc li span { color: #6b7280; font-size: 0.85rem; margin-left: 0.5rem; }
    /*  Sections  */
    .ebook-section { margin-bottom: 2.5rem; }
    .section-header {
      display: flex;
      gap: 1rem;
      align-items: flex-start;
      background: #eff6ff;
      border-left: 4px solid #1a56db;
      padding: 1rem 1.25rem;
      border-radius: 0 8px 8px 0;
      margin-bottom: 1.25rem;
    }
    .section-num {
      background: #1a56db;
      color: #fff;
      width: 32px; height: 32px;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-weight: 700; font-size: 0.9rem;
      flex-shrink: 0;
    }
    .section-title { font-size: 1.3rem; font-weight: 700; color: #1e3a8a; }
    .section-subtitle { font-size: 0.82rem; color: #6b7280; margin-top: 2px; }
    .section-body { padding: 0 0.5rem; }
    .section-body h1, .section-body h2 { color: #1a56db; margin: 1rem 0 0.5rem; }
    .section-body h3 { color: #4f46e5; margin: 0.75rem 0 0.4rem; }
    .section-body p { margin-bottom: 0.6rem; }
    .section-body ul, .section-body ol { margin: 0.4rem 0 0.8rem 1.5rem; }
    .section-body li { margin-bottom: 0.3rem; }
    .section-body strong { font-weight: 700; color: #111827; }
    .section-body em { font-style: italic; color: #374151; }
    .section-body code {
      font-family: 'Courier New', monospace;
      background: #f3f4f6;
      padding: 1px 5px;
      border-radius: 3px;
      font-size: 0.9em;
    }
    .section-body pre {
      background: #f3f4f6;
      padding: 0.75rem 1rem;
      border-radius: 6px;
      overflow-x: auto;
      margin: 0.8rem 0;
    }
    .section-body hr { border: none; border-top: 1px solid #e5e7eb; margin: 1rem 0; }
    /*  Sauts de page  */
    .page-break { page-break-after: always; break-after: page; height: 0; }
    /*  Pied de page  */
    .ebook-footer {
      margin-top: 3rem;
      text-align: center;
      font-size: 0.8rem;
      color: #9ca3af;
      border-top: 1px solid #e5e7eb;
      padding-top: 1rem;
    }
    @media print {
      body { padding: 0; max-width: none; }
      .cover { border-radius: 0; }
      @page { margin: 2cm; }
    }
  </style>
</head>
<body>
  <div class="cover">
    <div class="cover-logo"></div>
    <h1 class="cover-title">${p||"Ebook PedaClic"}</h1>
    ${v?`<p class="cover-desc">${v}</p>`:""}
    <p class="cover-meta">
      Gnr par PedaClic &nbsp;&nbsp;
      ${new Date().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}
    </p>
  </div>

  <div class="toc">
    <h2> Table des matires</h2>
    <ol>
      ${d.map(ee=>`<li>${ee.chapitre} <span> ${ee.discipline}  ${ee.classe}</span></li>`).join("")}
    </ol>
  </div>

  ${B}

  <div class="ebook-footer">
    PedaClic  L'cole en un clic &nbsp;&nbsp; www.pedaclic.sn
  </div>

  ${L?"<script>window.onload = () => window.print();<\/script>":""}
</body>
</html>`},[d,p,v,l]);function D(){const L=window.open("","_blank","width=920,height=720");L&&(L.document.write(M(!0)),L.document.close())}function $(){const L=M(!1),B=`
<html xmlns:o="urn:schemas-microsoft-com:office:office"
      xmlns:w="urn:schemas-microsoft-com:office:word"
      xmlns="http://www.w3.org/TR/REC-html40">
<head><meta charset="utf-8"><title>${p}</title></head>
<body>${L}</body></html>`,ee=new Blob(["\uFEFF",B],{type:"application/msword;charset=utf-8"}),se=URL.createObjectURL(ee),P=document.createElement("a");P.href=se;const q=(p||"ebook_pedaclic").replace(/[^\w\u00C0-\u017E\s-]/g,"").replace(/\s+/g,"_").slice(0,60);P.download=`${q}.doc`,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(se)}async function U(){if(!p.trim()){E("Veuillez donner un titre  l'ebook.");return}j(!0),E("");try{const L=d.map(B=>({contenuId:B.id,type:B.type,discipline:B.discipline,classe:B.classe,chapitre:B.chapitre,content:B.content}));await Bee(e,p,v,L),w(!0),a()}catch{E("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{j(!1)}}return o==="select"?r.jsx("div",{className:"ai-generator__modal-overlay",onClick:L=>{L.target===L.currentTarget&&n()},children:r.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:L=>L.stopPropagation(),children:[r.jsxs("div",{className:"ai-generator__modal-header",children:[r.jsxs("div",{className:"ai-generator__modal-title-block",children:[r.jsx("h2",{children:" Compiler un Ebook"}),r.jsx("span",{className:"ai-generator__modal-subtitle",children:"tape 1 / 3  Slectionner les chapitres  inclure"})]}),r.jsx("button",{className:"ai-generator__modal-close",onClick:n,children:""})]}),r.jsx("div",{className:"ai-generator__modal-body",children:S.length===0?r.jsx("p",{className:"ai-generator__empty",children:"Aucun contenu textuel sauvegard. Gnrez d'abord des cours, exercices ou sujets."}):r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"ebook-compiler__hint",children:"Cochez les chapitres  inclure dans l'ebook. Vous pourrez les rordonner ensuite."}),r.jsx("div",{className:"ebook-compiler__list",children:S.map(L=>{const B=d.some(ee=>ee.id===L.id);return r.jsxs("label",{className:`ebook-compiler__item ${B?"ebook-compiler__item--selected":""}`,children:[r.jsx("input",{type:"checkbox",checked:B,onChange:()=>A(L),className:"ebook-compiler__checkbox"}),r.jsx("div",{className:"ebook-compiler__item-icon",children:Ga[L.type]}),r.jsxs("div",{className:"ebook-compiler__item-info",children:[r.jsx("div",{className:"ebook-compiler__item-title",children:L.chapitre}),r.jsxs("div",{className:"ebook-compiler__item-meta",children:[mr[L.type],"  ",L.discipline,"  ",L.classe]})]}),B&&r.jsx("span",{className:"ebook-compiler__badge",children:""})]},L.id)})})]})}),r.jsxs("div",{className:"ai-generator__modal-footer",children:[r.jsx("button",{className:"btn btn--outline",onClick:n,children:"Annuler"}),r.jsx("button",{className:"btn btn--primary",onClick:()=>u("configure"),disabled:d.length===0,children:d.length===0?"Slectionnez au moins 1 chapitre":`Suivant  (${d.length} chapitre${d.length>1?"s":""})`})]})]})}):o==="configure"?r.jsx("div",{className:"ai-generator__modal-overlay",onClick:L=>{L.target===L.currentTarget&&n()},children:r.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:L=>L.stopPropagation(),children:[r.jsxs("div",{className:"ai-generator__modal-header",children:[r.jsxs("div",{className:"ai-generator__modal-title-block",children:[r.jsx("h2",{children:" Compiler un Ebook"}),r.jsx("span",{className:"ai-generator__modal-subtitle",children:"tape 2 / 3  Titre et ordre des chapitres"})]}),r.jsx("button",{className:"ai-generator__modal-close",onClick:n,children:""})]}),r.jsxs("div",{className:"ai-generator__modal-body",children:[r.jsxs("div",{className:"ebook-compiler__field",children:[r.jsx("label",{className:"ebook-compiler__label",children:"Titre de l'ebook *"}),r.jsx("input",{className:"ebook-compiler__input",type:"text",placeholder:"Ex : Cours de Mathmatiques  3me",value:p,onChange:L=>h(L.target.value),autoFocus:!0})]}),r.jsxs("div",{className:"ebook-compiler__field",children:[r.jsx("label",{className:"ebook-compiler__label",children:"Description (optionnel)"}),r.jsx("textarea",{className:"ebook-compiler__textarea",rows:2,placeholder:"Ex : Recueil de cours et exercices pour la classe de 3me",value:v,onChange:L=>b(L.target.value)})]}),r.jsxs("div",{className:"ebook-compiler__order-label",children:["Ordre des chapitres ",r.jsx("span",{children:"(glisser les flches pour rordonner)"})]}),r.jsx("div",{className:"ebook-compiler__order-list",children:d.map((L,B)=>r.jsxs("div",{className:"ebook-compiler__order-item",children:[r.jsx("span",{className:"ebook-compiler__order-num",children:B+1}),r.jsx("span",{className:"ebook-compiler__order-icon",children:Ga[L.type]}),r.jsxs("div",{className:"ebook-compiler__order-info",children:[r.jsx("div",{className:"ebook-compiler__order-title",children:L.chapitre}),r.jsxs("div",{className:"ebook-compiler__order-meta",children:[L.discipline,"  ",L.classe]})]}),r.jsxs("div",{className:"ebook-compiler__order-btns",children:[r.jsx("button",{type:"button",onClick:()=>O(B),disabled:B===0,title:"Monter",children:""}),r.jsx("button",{type:"button",onClick:()=>k(B),disabled:B===d.length-1,title:"Descendre",children:""})]})]},L.id))})]}),r.jsxs("div",{className:"ai-generator__modal-footer",children:[r.jsx("button",{className:"btn btn--outline",onClick:()=>u("select"),children:" Retour"}),r.jsx("button",{className:"btn btn--primary",onClick:()=>{if(!p.trim()){E("Titre requis.");return}E(""),u("preview")},children:"Aperu "})]}),C&&r.jsx("p",{className:"ebook-compiler__error",children:C})]})}):r.jsx("div",{className:"ai-generator__modal-overlay",onClick:L=>{L.target===L.currentTarget&&n()},children:r.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:L=>L.stopPropagation(),children:[r.jsxs("div",{className:"ai-generator__modal-header",children:[r.jsxs("div",{className:"ai-generator__modal-title-block",children:[r.jsxs("h2",{children:[" ",p]}),r.jsx("span",{className:"ai-generator__modal-subtitle",children:"tape 3 / 3  Aperu et tlchargement"})]}),r.jsxs("div",{className:"ai-generator__modal-header-actions",children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:D,title:"Enregistrer en PDF",children:" PDF"}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:$,title:"Tlcharger en Word",children:" Word"}),r.jsx("button",{className:"ai-generator__modal-close",onClick:n,children:""})]})]}),r.jsxs("div",{className:"ai-generator__modal-body",children:[r.jsxs("div",{className:"ebook-compiler__cover-preview",children:[r.jsx("span",{children:""}),r.jsxs("div",{children:[r.jsx("div",{className:"ebook-compiler__cover-title",children:p}),v&&r.jsx("div",{className:"ebook-compiler__cover-desc",children:v}),r.jsxs("div",{className:"ebook-compiler__cover-meta",children:[d.length," chapitre",d.length>1?"s":"","  PedaClic"]})]})]}),r.jsxs("div",{className:"ebook-compiler__toc",children:[r.jsx("div",{className:"ebook-compiler__toc-title",children:" Sommaire"}),r.jsx("ol",{children:d.map((L,B)=>r.jsxs("li",{children:[r.jsxs("span",{children:[B+1,". ",L.chapitre]}),r.jsxs("span",{className:"ebook-compiler__toc-meta",children:[L.discipline,"  ",L.classe]})]},L.id))})]}),N?r.jsx("div",{className:"ebook-compiler__success",children:" Ebook sauvegard avec succs dans votre bibliothque IA !"}):r.jsxs("div",{className:"ebook-compiler__save-row",children:[r.jsx("button",{className:"btn btn--primary btn--lg",onClick:U,disabled:x,children:x?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"spinner spinner--sm"})," Sauvegarde"]}):" Sauvegarder dans PedaClic"}),r.jsx("p",{className:"ebook-compiler__save-hint",children:"L'ebook sera accessible depuis votre Bibliothque."})]}),C&&r.jsx("p",{className:"ebook-compiler__error",children:C})]}),r.jsxs("div",{className:"ai-generator__modal-footer",children:[r.jsx("button",{className:"btn btn--outline",onClick:()=>u("configure"),children:" Modifier"}),r.jsx("button",{className:"btn btn--outline",onClick:n,children:"Fermer"})]})]})})},Gee=["6me","5me","4me","3me","2nde","1re","Terminale"],Hee=[30,45,60,90,120],Qee=()=>{const{currentUser:e}=Ze(),[t,n]=g.useState(1),[a,l]=g.useState([]),[o,u]=g.useState(null),[d,f]=g.useState(""),[p,h]=g.useState(""),[v,b]=g.useState(""),[x,j]=g.useState(null),[N,w]=g.useState({}),[C,E]=g.useState(!1),[S,A]=g.useState(null),[O,k]=g.useState(null),[M,D]=g.useState(!1),[$,U]=g.useState(!1),[L,B]=g.useState(null),[ee,se]=g.useState(!1),[P,q]=g.useState([]),[F,R]=g.useState(!1),[W,I]=g.useState(null),[re,V]=g.useState(!1),[oe,xe]=g.useState(!1),[ve,H]=g.useState([]),[he,Pe]=g.useState(!1),[ue,X]=g.useState(!0),Q=g.useMemo(()=>{const J=new Map;return a.forEach(Me=>{J.has(Me.nom)||J.set(Me.nom,Me)}),Array.from(J.values())},[a]);g.useEffect(()=>{(async()=>{try{X(!0);const Me=Ee(je(K,"disciplines"),Ve("nom")),ot=await Ce(Me),Z=[];ot.forEach(ce=>{const _e=ce.data();_e.nom&&_e.nom.trim()&&Z.push({id:ce.id,nom:_e.nom||"",classe:_e.classe||"",niveau:_e.niveau||""})}),l(Z)}catch(Me){console.error("[AIGenerator] Erreur chargement disciplines:",Me),k("Impossible de charger les disciplines.")}finally{X(!1)}})()},[]);const me=J=>{u(J),k(null)},we=()=>{const J=[];if(o||J.push("discipline"),d||J.push("classe"),(!p||p<1)&&J.push("dure de la leon"),J.length>0){k(`Champs requis manquants : ${J.join(", ")}`);return}n(2),k(null)},qe=()=>{if(!v.trim()){k("Veuillez saisir le titre du chapitre.");return}n(3),k(null)},We=J=>{j(J),n(4),k(null)},Je=()=>{t>1&&(n(J=>J-1),k(null),t===5&&(A(null),U(!1),B(null)))},at=()=>{n(1),u(null),f(""),h(""),b(""),j(null),w({}),A(null),k(null),U(!1),B(null)},br=async()=>{if(!o||!x||!v.trim()||!d){k("Paramtres incomplets. Veuillez reprendre depuis le dbut.");return}E(!0),k(null);try{const J={...N,duree:typeof p=="number"?p:void 0},Me={type:x,discipline:o.nom,classe:d,chapitre:v.trim(),options:Object.keys(J).length>0?J:void 0},ot=await dJ(Me);A(ot),n(5)}catch(J){const Me=J instanceof Error?J.message:"Erreur inconnue";k(Me)}finally{E(!1)}},Pr=async()=>{if(!(!e||!S||!o||!x)){D(!0),k(null);try{let J;const ot=a.find(ce=>ce.nom===o.nom&&ce.classe===d)?.id||o.id,Z={type:x,discipline:o.nom,classe:d,chapitre:v.trim(),options:{...N,duree:typeof p=="number"?p:void 0}};S.type==="quiz"&&S.data.questions?J=await fJ(e.uid,Z,S.data.questions,ot):J=await mJ(e.uid,Z,S.data.content||"",ot),B(J),U(!0);try{const ce=await kb(e.uid);q(ce)}catch{}}catch(J){const Me=J instanceof Error?J.message:"Erreur de sauvegarde";k(Me)}finally{D(!1)}}},lr=async()=>{if(e){R(!0);try{const J=await kb(e.uid);q(J),se(!0)}catch(J){console.error("[AIGenerator] Erreur historique:",J)}finally{R(!1)}}},an=J=>J.replace(/[^\w\u00C0-\u017E\s-]/g,"").trim().replace(/\s+/g,"_").slice(0,60)||"contenu_pedaclic",pe=(J,Me)=>{const ot=URL.createObjectURL(J),Z=document.createElement("a");Z.href=ot,Z.download=Me,document.body.appendChild(Z),Z.click(),document.body.removeChild(Z),URL.revokeObjectURL(ot)},Ae=(J,Me)=>{const ot=Gr(J),Z=`
<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office"
      xmlns:w="urn:schemas-microsoft-com:office:word"
      xmlns="http://www.w3.org/TR/REC-html40">
<head>
  <meta charset="utf-8">
  <title>${Me}</title>
  <!--[if gte mso 9]><xml><w:WordDocument><w:View>Print</w:View><w:Zoom>100</w:Zoom></w:WordDocument></xml><![endif]-->
  <style>
    body { font-family: Arial, sans-serif; font-size: 12pt; line-height: 1.6; margin: 2cm; color: #1a1a1a; }
    h1 { font-size: 18pt; color: #1a56db; margin-bottom: 12pt; }
    h2 { font-size: 15pt; color: #1a56db; margin-top: 18pt; margin-bottom: 8pt; }
    h3 { font-size: 13pt; color: #333; margin-top: 14pt; }
    p  { margin-bottom: 8pt; }
    ul, ol { margin-left: 1cm; margin-bottom: 8pt; }
    li { margin-bottom: 4pt; }
    strong { font-weight: bold; }
    em { font-style: italic; }
    code { font-family: Courier New; background: #f5f5f5; padding: 1pt 3pt; }
    pre  { font-family: Courier New; background: #f5f5f5; padding: 8pt; margin: 8pt 0; }
    hr { border: none; border-top: 1px solid #ccc; margin: 12pt 0; }
  </style>
</head>
<body>
  <h1>${Me}</h1>
  ${ot}
</body>
</html>`,ce=new Blob(["\uFEFF",Z],{type:"application/msword;charset=utf-8"});pe(ce,`${an(Me)}.doc`)},Re=(J,Me)=>{const ot=Gr(J),Z=window.open("","_blank","width=900,height=700");Z&&(Z.document.write(`
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>${Me}</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: Arial, sans-serif; font-size: 12pt; line-height: 1.7; color: #1a1a1a; padding: 2cm; max-width: 800px; margin: auto; }
    h1 { font-size: 20pt; color: #1a56db; margin-bottom: 14pt; padding-bottom: 6pt; border-bottom: 2px solid #1a56db; }
    h2 { font-size: 15pt; color: #1a56db; margin: 18pt 0 8pt; }
    h3 { font-size: 13pt; color: #333; margin: 14pt 0 6pt; }
    p  { margin-bottom: 8pt; }
    ul, ol { margin: 6pt 0 8pt 1.5cm; }
    li { margin-bottom: 4pt; }
    strong { font-weight: bold; }
    em { font-style: italic; }
    code { font-family: Courier New, monospace; background: #f5f5f5; padding: 1pt 4pt; border-radius: 3pt; font-size: 10pt; }
    pre  { font-family: Courier New, monospace; background: #f5f5f5; padding: 10pt; margin: 8pt 0; border-radius: 4pt; font-size: 10pt; white-space: pre-wrap; }
    hr { border: none; border-top: 1px solid #ddd; margin: 14pt 0; }
    .header-meta { font-size: 9pt; color: #888; margin-bottom: 18pt; }
    @media print {
      body { padding: 0; }
      @page { margin: 2cm; }
    }
  </style>
</head>
<body>
  <h1>${Me}</h1>
  <p class="header-meta">PedaClic  Gnr le ${new Date().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}</p>
  ${ot}
  <script>window.onload = () => { window.print(); };<\/script>
</body>
</html>`),Z.document.close())},He=async J=>{if(window.confirm("Supprimer ce contenu gnr ?"))try{await pJ(J),q(Me=>Me.filter(ot=>ot.id!==J))}catch(Me){console.error("[AIGenerator] Erreur suppression:",Me)}},xt=async()=>{if(e){Pe(!0);try{const J=await nA(e.uid);H(J),xe(!0)}catch(J){console.error("[AIGenerator] Erreur chargement ebooks:",J)}finally{Pe(!1)}}},It=async J=>{if(window.confirm("Supprimer cet ebook ?"))try{await Uee(J),H(Me=>Me.filter(ot=>ot.id!==J))}catch(Me){console.error("[AIGenerator] Erreur suppression ebook:",Me)}},tr=J=>{const Me=J.sections.map((ot,Z)=>`# ${Z+1}. ${ot.chapitre}

**${mr[ot.type]}**  ${ot.discipline}  ${ot.classe}

${ot.content}`).join(`

---

`);I({id:J.id,userId:J.userId,type:"cours_complet",discipline:"Ebook compil",disciplineId:"",classe:"",chapitre:J.titre,content:Me,createdAt:J.createdAt}),xe(!1)},Gr=g.useCallback(J=>{if(!J)return"";let Me=J.replace(/^### (.+)$/gm,"<h3>$1</h3>").replace(/^## (.+)$/gm,"<h2>$1</h2>").replace(/^# (.+)$/gm,"<h1>$1</h1>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/^- (.+)$/gm,"<li>$1</li>").replace(/^\d+\. (.+)$/gm,"<li>$1</li>").replace(/^---$/gm,"<hr />").replace(/```(\w*)\n([\s\S]*?)```/g,"<pre><code>$2</code></pre>").replace(/`(.+?)`/g,"<code>$1</code>").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br />");return Me=Me.replace(/(<li>.*?<\/li>(\s*<br \/>)?)+/g,ot=>"<ul>"+ot.replace(/<br \/>/g,"")+"</ul>"),`<p>${Me}</p>`},[]);return e?e.isPremium?r.jsxs("div",{className:"ai-generator",children:[r.jsxs("div",{className:"ai-generator__header",children:[r.jsx("h1",{className:"ai-generator__title",children:" Gnrateur de Contenu IA"}),r.jsx("p",{className:"ai-generator__subtitle",children:"Crez des cours, exercices, quiz et sujets d'examen adapts au programme sngalais"}),r.jsxs("div",{className:"ai-generator__header-actions",children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:lr,disabled:F,children:F?" Chargement...":" Historique"}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>{lr(),V(!0)},title:"Compiler plusieurs contenus en un ebook",children:" Compiler un Ebook"}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:xt,disabled:he,title:"Voir mes ebooks compils",children:he?"...":" Mes Ebooks"}),t>1&&r.jsx("button",{className:"btn btn--outline btn--sm",onClick:at,children:" Recommencer"})]})]}),r.jsx("div",{className:"ai-generator__steps",children:[1,2,3,4,5].map(J=>r.jsxs("div",{className:`ai-generator__step-indicator ${J===t?"ai-generator__step-indicator--active":""} ${J<t?"ai-generator__step-indicator--done":""}`,children:[r.jsx("span",{className:"ai-generator__step-number",children:J<t?"":J}),r.jsxs("span",{className:"ai-generator__step-label",children:[J===1&&"Paramtres",J===2&&"Chapitre",J===3&&"Type",J===4&&"Options",J===5&&"Rsultat"]})]},J))}),O&&r.jsxs("div",{className:"ai-generator__error",children:[r.jsx("span",{className:"ai-generator__error-icon",children:""}),O,r.jsx("button",{className:"ai-generator__error-close",onClick:()=>k(null),children:""})]}),r.jsxs("div",{className:"ai-generator__content",children:[t===1&&r.jsxs("div",{className:"ai-generator__step-content",children:[r.jsx("h2",{className:"ai-generator__step-title",children:" Paramtres de la leon"}),r.jsxs("div",{className:"ai-generator__field",children:[r.jsxs("label",{className:"ai-generator__label",children:["Discipline ",r.jsx("span",{className:"ai-generator__required",children:"*"})]}),ue?r.jsxs("div",{className:"ai-generator__loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement des disciplines..."})]}):Q.length===0?r.jsx("div",{className:"ai-generator__empty",children:r.jsx("p",{children:"Aucune discipline disponible."})}):r.jsx("div",{className:"ai-generator__discipline-grid",children:Q.map(J=>r.jsx("button",{className:`ai-generator__discipline-card ${o?.nom===J.nom?"ai-generator__discipline-card--selected":""}`,onClick:()=>me(J),children:r.jsx("span",{className:"ai-generator__discipline-name",children:J.nom})},J.id))})]}),r.jsxs("div",{className:"ai-generator__field",children:[r.jsxs("label",{className:"ai-generator__label",children:["Classe ",r.jsx("span",{className:"ai-generator__required",children:"*"})]}),r.jsx("div",{className:"ai-generator__classe-grid",children:Gee.map(J=>r.jsx("button",{className:`ai-generator__classe-btn ${d===J?"ai-generator__classe-btn--selected":""}`,onClick:()=>{f(J),k(null)},children:J},J))})]}),r.jsxs("div",{className:"ai-generator__field",children:[r.jsxs("label",{htmlFor:"dureeCours",className:"ai-generator__label",children:["Dure de la leon (minutes) ",r.jsx("span",{className:"ai-generator__required",children:"*"})]}),r.jsxs("div",{className:"ai-generator__duree-group",children:[r.jsx("div",{className:"ai-generator__duree-presets",children:Hee.map(J=>r.jsxs("button",{className:`ai-generator__duree-btn ${p===J?"ai-generator__duree-btn--selected":""}`,onClick:()=>{h(J),k(null)},children:[J," min"]},J))}),r.jsx("input",{id:"dureeCours",type:"number",className:"ai-generator__input ai-generator__input--small",min:"15",max:"300",step:"5",value:p,onChange:J=>{const Me=parseInt(J.target.value);h(isNaN(Me)?"":Me),k(null)},placeholder:"Autre dure..."})]})]}),r.jsxs("div",{className:"ai-generator__nav",children:[r.jsx("div",{})," ",r.jsx("button",{className:"btn btn--primary",onClick:we,disabled:!o||!d||!p,children:"Continuer "})]})]}),t===2&&r.jsxs("div",{className:"ai-generator__step-content",children:[r.jsx("h2",{className:"ai-generator__step-title",children:" Prcisez le chapitre"}),r.jsxs("div",{className:"ai-generator__recap",children:[r.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),r.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),r.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),r.jsx("span",{className:"ai-generator__recap-value",children:d}),r.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),r.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]})]}),r.jsxs("div",{className:"ai-generator__field",children:[r.jsx("label",{htmlFor:"chapitre",className:"ai-generator__label",children:"Titre du chapitre ou du thme"}),r.jsx("input",{id:"chapitre",type:"text",className:"ai-generator__input",placeholder:"Ex: Les fonctions affines, Le rcit autobiographique, La tectonique des plaques...",value:v,onChange:J=>b(J.target.value),onKeyDown:J=>J.key==="Enter"&&qe(),autoFocus:!0})]}),r.jsxs("div",{className:"ai-generator__nav",children:[r.jsx("button",{className:"btn btn--outline",onClick:Je,children:" Retour"}),r.jsx("button",{className:"btn btn--primary",onClick:qe,disabled:!v.trim(),children:"Continuer "})]})]}),t===3&&r.jsxs("div",{className:"ai-generator__step-content",children:[r.jsx("h2",{className:"ai-generator__step-title",children:" Quel type de contenu ?"}),r.jsxs("div",{className:"ai-generator__recap",children:[r.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),r.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),r.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),r.jsx("span",{className:"ai-generator__recap-value",children:d}),r.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),r.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]}),r.jsx("span",{className:"ai-generator__recap-label",children:"Chapitre :"}),r.jsx("span",{className:"ai-generator__recap-value",children:v})]}),r.jsx("div",{className:"ai-generator__type-grid",children:Object.keys(mr).map(J=>r.jsxs("button",{className:"ai-generator__type-card",onClick:()=>We(J),children:[r.jsx("span",{className:"ai-generator__type-icon",children:Ga[J]}),r.jsx("span",{className:"ai-generator__type-name",children:mr[J]}),r.jsx("span",{className:"ai-generator__type-desc",children:cJ[J]})]},J))}),r.jsx("div",{className:"ai-generator__nav",children:r.jsx("button",{className:"btn btn--outline",onClick:Je,children:" Retour"})})]}),t===4&&r.jsxs("div",{className:"ai-generator__step-content",children:[r.jsx("h2",{className:"ai-generator__step-title",children:" Options de gnration"}),r.jsxs("div",{className:"ai-generator__recap",children:[r.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),r.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),r.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),r.jsx("span",{className:"ai-generator__recap-value",children:d}),r.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),r.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]}),r.jsx("span",{className:"ai-generator__recap-label",children:"Chapitre :"}),r.jsx("span",{className:"ai-generator__recap-value",children:v}),r.jsx("span",{className:"ai-generator__recap-label",children:"Type :"}),r.jsxs("span",{className:"ai-generator__recap-value",children:[x&&Ga[x]," ",x&&mr[x]]})]}),r.jsxs("div",{className:"ai-generator__options",children:[r.jsxs("div",{className:"ai-generator__field",children:[r.jsx("label",{className:"ai-generator__label",children:"Niveau de difficult"}),r.jsx("div",{className:"ai-generator__radio-group",children:["facile","moyen","difficile"].map(J=>r.jsxs("label",{className:"ai-generator__radio",children:[r.jsx("input",{type:"radio",name:"difficulte",value:J,checked:N.difficulte===J,onChange:()=>w(Me=>({...Me,difficulte:J}))}),r.jsxs("span",{className:"ai-generator__radio-label",children:[J==="facile"&&" Facile",J==="moyen"&&" Moyen",J==="difficile"&&" Difficile"]})]},J))})]}),x==="sujet_examen"&&r.jsxs("div",{className:"ai-generator__field",children:[r.jsx("label",{className:"ai-generator__label",children:"Type d'examen"}),r.jsx("div",{className:"ai-generator__radio-group",children:["BFEM","BAC"].map(J=>r.jsxs("label",{className:"ai-generator__radio",children:[r.jsx("input",{type:"radio",name:"typeExamen",value:J,checked:N.typeExamen===J,onChange:()=>w(Me=>({...Me,typeExamen:J}))}),r.jsx("span",{className:"ai-generator__radio-label",children:J})]},J))})]}),r.jsxs("div",{className:"ai-generator__field",children:[r.jsx("label",{htmlFor:"objectifs",className:"ai-generator__label",children:"Objectifs pdagogiques (optionnel)"}),r.jsx("textarea",{id:"objectifs",className:"ai-generator__textarea",rows:3,placeholder:"Ex: L'lve doit tre capable de rsoudre une quation du 1er degr...",value:N.objectifs||"",onChange:J=>w(Me=>({...Me,objectifs:J.target.value||void 0}))})]}),r.jsxs("div",{className:"ai-generator__field",children:[r.jsx("label",{htmlFor:"consignes",className:"ai-generator__label",children:"Consignes spciales (optionnel)"}),r.jsx("textarea",{id:"consignes",className:"ai-generator__textarea",rows:2,placeholder:"Ex: Inclure un exercice sur les statistiques, utiliser des exemples avec le football...",value:N.consignesSpeciales||"",onChange:J=>w(Me=>({...Me,consignesSpeciales:J.target.value||void 0}))})]})]}),r.jsxs("div",{className:"ai-generator__nav",children:[r.jsx("button",{className:"btn btn--outline",onClick:Je,children:" Retour"}),r.jsx("button",{className:"btn btn--primary btn--lg",onClick:br,disabled:C,children:C?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"spinner spinner--sm"}),"Gnration en cours..."]}):" Gnrer le contenu"})]}),C&&r.jsxs("div",{className:"ai-generator__generating",children:[r.jsxs("div",{className:"ai-generator__generating-animation",children:[r.jsx("span",{children:""}),r.jsx("span",{children:""}),r.jsx("span",{children:""})]}),r.jsxs("p",{children:["L'IA rdige votre"," ",x&&mr[x].toLowerCase(),"..."]}),r.jsx("p",{className:"ai-generator__generating-hint",children:"Cela peut prendre 15  30 secondes."})]})]}),t===5&&S&&r.jsxs("div",{className:"ai-generator__step-content",children:[r.jsx("h2",{className:"ai-generator__step-title",children:" Contenu gnr"}),r.jsxs("div",{className:"ai-generator__recap ai-generator__recap--success",children:[r.jsx("span",{className:"ai-generator__recap-label",children:"Type :"}),r.jsxs("span",{className:"ai-generator__recap-value",children:[x&&Ga[x]," ",x&&mr[x]]}),r.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),r.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),r.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),r.jsx("span",{className:"ai-generator__recap-value",children:d}),r.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),r.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]}),r.jsx("span",{className:"ai-generator__recap-label",children:"Chapitre :"}),r.jsx("span",{className:"ai-generator__recap-value",children:v})]}),r.jsxs("div",{className:"ai-generator__preview",children:[r.jsxs("div",{className:"ai-generator__preview-header",children:[r.jsx("h3",{children:"Prvisualisation"}),r.jsxs("div",{className:"ai-generator__preview-actions",children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>{const J=S.type==="quiz"?JSON.stringify(S.data.questions,null,2):S.data.content||"";navigator.clipboard.writeText(J),alert("Contenu copi dans le presse-papier !")},children:" Copier"}),S.type!=="quiz"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Re(S.data.content||"",`${mr[x]}  ${o?.nom} ${d}`),title:"Tlcharger en PDF (via impression)",children:" PDF"}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Ae(S.data.content||"",`${mr[x]}  ${o?.nom} ${d}`),title:"Tlcharger en Word (.doc)",children:" Word"})]})]})]}),r.jsx("div",{className:"ai-generator__preview-body",children:S.type==="quiz"&&S.data.questions?r.jsxs("div",{className:"ai-generator__quiz-preview",children:[r.jsxs("p",{className:"ai-generator__quiz-count",children:[S.data.questions.length," questions gnres"]}),S.data.questions.map((J,Me)=>r.jsxs("div",{className:"ai-generator__quiz-item",children:[r.jsxs("div",{className:"ai-generator__quiz-question",children:[r.jsxs("strong",{children:["Q",Me+1,"."]})," ",J.question,r.jsx("span",{className:`ai-generator__quiz-badge ai-generator__quiz-badge--${J.difficulte}`,children:J.difficulte})]}),r.jsx("div",{className:"ai-generator__quiz-options",children:J.options.map((ot,Z)=>r.jsxs("div",{className:`ai-generator__quiz-option ${Z===J.reponseCorrecte?"ai-generator__quiz-option--correct":""}`,children:[r.jsx("span",{className:"ai-generator__quiz-option-letter",children:String.fromCharCode(65+Z)}),ot,Z===J.reponseCorrecte&&" "]},Z))}),J.explication&&r.jsxs("div",{className:"ai-generator__quiz-explanation",children:[" ",J.explication]})]},Me))]}):r.jsx("div",{className:"ai-generator__markdown-preview",dangerouslySetInnerHTML:{__html:Gr(S.data.content||"")}})})]}),r.jsxs("div",{className:"ai-generator__actions",children:[$?r.jsxs("div",{className:"ai-generator__save-success",children:[r.jsx("span",{children:" Sauvegard avec succs !"}),S.type==="quiz"&&L&&r.jsx(Fe,{to:`/quiz/${L}`,className:"btn btn--outline btn--sm",children:" Voir le quiz"})]}):r.jsx("button",{className:"btn btn--primary btn--lg",onClick:Pr,disabled:M,children:M?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"spinner spinner--sm"}),"Sauvegarde..."]}):r.jsx(r.Fragment,{children:" Sauvegarder dans PedaClic"})}),r.jsx("button",{className:"btn btn--outline",onClick:at,children:" Nouvelle gnration"})]})]})]}),W&&r.jsx("div",{className:"ai-generator__modal-overlay",onClick:()=>I(null),children:r.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:J=>J.stopPropagation(),children:[r.jsxs("div",{className:"ai-generator__modal-header",children:[r.jsxs("div",{className:"ai-generator__modal-title-block",children:[r.jsxs("h2",{children:[Ga[W.type]," ",mr[W.type]]}),r.jsxs("span",{className:"ai-generator__modal-subtitle",children:[W.discipline," (",W.classe,")  ",W.chapitre]})]}),r.jsxs("div",{className:"ai-generator__modal-header-actions",children:[W.type!=="quiz_auto"&&W.content&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Re(W.content,`${mr[W.type]}  ${W.discipline} ${W.classe}`),title:"Enregistrer en PDF",children:" PDF"}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Ae(W.content,`${mr[W.type]}  ${W.discipline} ${W.classe}`),title:"Tlcharger en Word",children:" Word"})]}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:async()=>{I(null),await lr()},title:"Retour  l'historique",children:" Historique"}),r.jsx("button",{className:"ai-generator__modal-close",onClick:()=>I(null),children:""})]})]}),r.jsx("div",{className:"ai-generator__modal-body",children:r.jsx("div",{className:"ai-generator__markdown-preview",dangerouslySetInnerHTML:{__html:Gr(W.content||"")}})})]})}),re&&r.jsx(Fee,{userId:e.uid,history:P,markdownToHtml:Gr,onClose:()=>V(!1),onSaved:async()=>{const J=await nA(e.uid);H(J)}}),oe&&r.jsx("div",{className:"ai-generator__modal-overlay",onClick:()=>xe(!1),children:r.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:J=>J.stopPropagation(),children:[r.jsxs("div",{className:"ai-generator__modal-header",children:[r.jsx("h2",{children:" Mes Ebooks compils"}),r.jsxs("div",{className:"ai-generator__modal-header-actions",children:[r.jsx("button",{className:"btn btn--primary btn--sm",onClick:()=>{xe(!1),V(!0)},children:"+ Nouvel ebook"}),r.jsx("button",{className:"ai-generator__modal-close",onClick:()=>xe(!1),children:""})]})]}),r.jsx("div",{className:"ai-generator__modal-body",children:ve.length===0?r.jsx("p",{className:"ai-generator__empty",children:`Vous n'avez pas encore compil d'ebook. Cliquez sur "Compiler un Ebook" pour commencer.`}):r.jsx("div",{className:"ebook-compiler__my-list",children:ve.map(J=>r.jsxs("div",{className:"ebook-compiler__my-item",children:[r.jsx("div",{className:"ebook-compiler__my-cover",children:""}),r.jsxs("div",{className:"ebook-compiler__my-info",children:[r.jsx("div",{className:"ebook-compiler__my-title",children:J.titre}),J.description&&r.jsx("div",{className:"ebook-compiler__my-desc",children:J.description}),r.jsxs("div",{className:"ebook-compiler__my-meta",children:[J.sections.length," chapitre",J.sections.length>1?"s":""," "," ",J.createdAt?.toDate?J.createdAt.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}):""]})]}),r.jsxs("div",{className:"ai-generator__history-actions",children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>tr(J),title:"Lire l'ebook",children:" Lire"}),r.jsx("button",{className:"btn btn--danger btn--sm",onClick:()=>J.id&&It(J.id),title:"Supprimer",children:""})]})]},J.id))})})]})}),ee&&r.jsx("div",{className:"ai-generator__modal-overlay",onClick:()=>se(!1),children:r.jsxs("div",{className:"ai-generator__modal",onClick:J=>J.stopPropagation(),children:[r.jsxs("div",{className:"ai-generator__modal-header",children:[r.jsx("h2",{children:" Historique des gnrations"}),r.jsx("button",{className:"ai-generator__modal-close",onClick:()=>se(!1),children:""})]}),r.jsx("div",{className:"ai-generator__modal-body",children:P.length===0?r.jsx("p",{className:"ai-generator__empty",children:"Aucun contenu gnr pour le moment."}):r.jsx("div",{className:"ai-generator__history-list",children:P.map(J=>r.jsxs("div",{className:"ai-generator__history-item",children:[r.jsxs("div",{className:"ai-generator__history-info",children:[r.jsxs("span",{className:"ai-generator__history-type",children:[Ga[J.type]," ",mr[J.type]]}),r.jsxs("span",{className:"ai-generator__history-details",children:[J.discipline," (",J.classe,")  ",J.chapitre]}),r.jsx("span",{className:"ai-generator__history-date",children:J.createdAt?.toDate?J.createdAt.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Date inconnue"})]}),r.jsxs("div",{className:"ai-generator__history-actions",children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>{I(J),se(!1)},title:"Lire le contenu",children:" Lire"}),J.type!=="quiz_auto"&&J.content&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Re(J.content,`${mr[J.type]}  ${J.discipline} ${J.classe}`),title:"PDF",children:""}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Ae(J.content,`${mr[J.type]}  ${J.discipline} ${J.classe}`),title:"Word",children:""})]}),r.jsx("button",{className:"btn btn--danger btn--sm",onClick:()=>J.id&&He(J.id),title:"Supprimer",children:""})]})]},J.id))})})]})})]}):r.jsx("div",{className:"ai-generator",children:r.jsxs("div",{className:"ai-generator__gate",children:[r.jsx("div",{className:"ai-generator__gate-icon",children:""}),r.jsx("h2",{children:"Fonctionnalit Premium"}),r.jsx("p",{children:"Le gnrateur de contenu IA est rserv aux abonns Premium. Gnrez des cours, des exercices, des quiz et des sujets d'examen adapts au programme sngalais en un clic !"}),r.jsxs("div",{className:"ai-generator__gate-price",children:[r.jsx("span",{className:"price",children:"2 000 FCFA"}),r.jsx("span",{className:"period",children:"/mois"})]}),r.jsx(Fe,{to:"/premium",className:"btn btn--primary btn--lg",children:"Devenir Premium"})]})}):r.jsx("div",{className:"ai-generator",children:r.jsxs("div",{className:"ai-generator__gate",children:[r.jsx("div",{className:"ai-generator__gate-icon",children:""}),r.jsx("h2",{children:"Connexion requise"}),r.jsx("p",{children:"Vous devez tre connect pour accder au gnrateur de contenu IA."}),r.jsx(Fe,{to:"/connexion",className:"btn btn--primary",children:"Se connecter"})]})})},Vee=()=>{const[e,t]=g.useState(null),[n,a]=g.useState(!1),[l,o]=g.useState(!1),[u,d]=g.useState(!1),f=()=>/iPhone|iPad|iPod/.test(navigator.userAgent)&&!window.MSStream,p=()=>window.matchMedia("(display-mode: standalone)").matches||navigator.standalone===!0,h=g.useCallback(()=>{try{return parseInt(localStorage.getItem("pedaclic_visit_count")||"0",10)}catch{return 0}},[]),v=g.useCallback(()=>{try{const N=h()+1;localStorage.setItem("pedaclic_visit_count",N.toString())}catch{}},[h]),b=()=>{try{const N=localStorage.getItem("pedaclic_install_dismissed_at");if(!N)return!1;const w=720*60*60*1e3;return Date.now()-parseInt(N,10)<w}catch{return!1}};g.useEffect(()=>{if(p()||b())return;v();const N=C=>{C.preventDefault(),t(C),h()>=1&&a(!0)};window.addEventListener("beforeinstallprompt",N),f()&&h()>=1&&(o(!0),a(!0));const w=()=>{a(!1),t(null)};return window.addEventListener("appinstalled",w),()=>{window.removeEventListener("beforeinstallprompt",N),window.removeEventListener("appinstalled",w)}},[h,v]);const x=async()=>{if(e){d(!0);try{await e.prompt();const{outcome:N}=await e.userChoice;N==="accepted"&&a(!1)}catch(N){console.error("Erreur installation PWA:",N)}finally{d(!1),t(null)}}},j=()=>{a(!1);try{localStorage.setItem("pedaclic_install_dismissed_at",Date.now().toString()),localStorage.removeItem("pedaclic_install_dismissed")}catch{}};return n?r.jsx("div",{className:"install-prompt",children:r.jsxs("div",{className:"install-prompt__container",children:[r.jsxs("div",{className:"install-prompt__content",children:[r.jsx("div",{className:"install-prompt__icon",children:r.jsx(sA,{size:24})}),r.jsxs("div",{className:"install-prompt__text",children:[r.jsx("h3",{className:"install-prompt__title",children:"Installer PedaClic"}),r.jsx("p",{className:"install-prompt__description",children:l?"Accde  tes cours mme sans connexion !":"Installe l'app pour un accs rapide, mme hors-ligne !"})]})]}),r.jsxs("div",{className:"install-prompt__actions",children:[!l&&e&&r.jsx("button",{className:"install-prompt__btn install-prompt__btn--primary",onClick:x,disabled:u,children:u?"Installation...":"Installer"}),l&&r.jsx("div",{className:"install-prompt__ios",children:r.jsxs("p",{className:"install-prompt__ios-text",children:["Appuie sur ",r.jsx(b3,{size:16,className:"install-prompt__ios-icon"})," puis",r.jsxs("span",{className:"install-prompt__ios-highlight",children:[r.jsx(zc,{size:14})," Sur l'cran d'accueil"]})]})}),r.jsx("button",{className:"install-prompt__btn install-prompt__btn--close",onClick:j,"aria-label":"Fermer la bannire d'installation",children:r.jsx(Gi,{size:20})})]})]})}):null};function Yee(){const[e,t]=g.useState(typeof navigator<"u"?navigator.onLine:!0);return g.useEffect(()=>{const n=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",n),window.addEventListener("offline",a),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",a)}},[]),e}const Kee=()=>{const e=Yee(),[t,n]=g.useState(!1),[a,l]=g.useState(!1);return g.useEffect(()=>{if(!e)l(!0),n(!1);else if(a){n(!0);const o=setTimeout(()=>{n(!1),l(!1)},3e3);return()=>clearTimeout(o)}},[e,a]),e&&!t?null:r.jsx("div",{className:`network-indicator ${e?"network-indicator--online":"network-indicator--offline"}`,children:r.jsx("div",{className:"network-indicator__content",children:e?r.jsxs(r.Fragment,{children:[r.jsx(y3,{size:14}),r.jsx("span",{children:"Connexion rtablie"})]}):r.jsxs(r.Fragment,{children:[r.jsx(j3,{size:14}),r.jsx("span",{children:"Pas de connexion  mode hors-ligne"})]})})})},Wee=()=>(g.useEffect(()=>{WE();const e=setInterval(WE,600*1e3);return()=>clearInterval(e)},[]),r.jsxs(D3,{children:[r.jsx(Vee,{}),r.jsx(Kee,{}),r.jsxs(kq,{children:[r.jsx(Be,{path:"/",element:r.jsx(ft,{children:r.jsx(Y3,{})})}),r.jsx(Be,{path:"/disciplines",element:r.jsx(ft,{children:r.jsx(K3,{})})}),r.jsx(Be,{path:"/disciplines/:id",element:r.jsx(ft,{children:r.jsx(e5,{})})}),r.jsx(Be,{path:"/quiz-gratuits",element:r.jsx(ft,{children:r.jsx(UR,{})})}),r.jsx(Be,{path:"/ebooks",element:r.jsx(ft,{children:r.jsx(Tee,{})})}),r.jsx(Be,{path:"/cours",element:r.jsx(ft,{children:r.jsx(eee,{})})}),r.jsx(Be,{path:"/cours/:coursId",element:r.jsx(ft,{children:r.jsx(fee,{})})}),r.jsx(Be,{path:"/connexion",element:r.jsx(t5,{})}),r.jsx(Be,{path:"/inscription",element:r.jsx(r5,{})}),r.jsx(Be,{path:"/mot-de-passe-oublie",element:r.jsx(n5,{})}),r.jsx(Be,{path:"/premium/confirmation",element:r.jsx(M5,{})}),r.jsx(Be,{path:"/premium/mes-cours",element:r.jsx(ft,{children:r.jsx(D5,{})})}),r.jsx(Be,{path:"/premium",element:r.jsx(ft,{children:r.jsx(u5,{})})}),r.jsx(Be,{path:"/quizzes",element:r.jsx(eo,{allowedRoles:["eleve","prof","admin"],children:r.jsx(ft,{children:r.jsx(DR,{})})})}),r.jsx(Be,{path:"/quiz/:quizId",element:r.jsx(ft,{children:r.jsx(r6,{})})}),r.jsx(Be,{path:"/quiz-avance/:quizId",element:r.jsx(ft,{children:r.jsx(zR,{})})}),r.jsx(Be,{path:"/generateur",element:r.jsx(ft,{children:r.jsx(Qee,{})})}),r.jsx(Be,{path:"/eleve/dashboard",element:r.jsx(ft,{children:r.jsx(xZ,{})})}),r.jsx(Be,{path:"/eleve/suivi",element:r.jsx(ft,{children:r.jsx(bZ,{})})}),r.jsx(Be,{path:"/eleve/cahiers/:cahierId",element:r.jsx(eo,{allowedRoles:["eleve","admin"],children:r.jsx(ft,{children:r.jsx(wJ,{})})})}),r.jsx(Be,{path:"/parent/dashboard",element:r.jsx(eo,{allowedRoles:["parent","admin"],children:r.jsx(ft,{children:r.jsx($ee,{})})})}),r.jsx(Be,{path:"/prof/dashboard",element:r.jsx(Hn,{children:r.jsx(ft,{children:r.jsx(_Z,{})})})}),r.jsx(Be,{path:"/prof/cahiers",element:r.jsx(Hn,{children:r.jsx(ft,{children:r.jsx(FZ,{})})})}),r.jsx(Be,{path:"/prof/cahiers/:cahierId",element:r.jsx(Hn,{children:r.jsx(ft,{children:r.jsx(tJ,{})})})}),r.jsx(Be,{path:"/prof/cahiers/:cahierId/nouvelle",element:r.jsx(Hn,{children:r.jsx(ft,{children:r.jsx(XE,{})})})}),r.jsx(Be,{path:"/prof/cahiers/:cahierId/modifier/:entreeId",element:r.jsx(Hn,{children:r.jsx(ft,{children:r.jsx(XE,{})})})}),r.jsx(Be,{path:"/prof/sequences",element:r.jsx(Hn,{children:r.jsx(ft,{children:r.jsx(RJ,{})})})}),r.jsx(Be,{path:"/prof/sequences/nouvelle",element:r.jsx(Hn,{children:r.jsx(ft,{children:r.jsx(ZE,{})})})}),r.jsx(Be,{path:"/prof/sequences/:id",element:r.jsx(Hn,{children:r.jsx(ft,{children:r.jsx(XJ,{})})})}),r.jsx(Be,{path:"/prof/sequences/:id/modifier",element:r.jsx(Hn,{children:r.jsx(ft,{children:r.jsx(ZE,{})})})}),r.jsx(Be,{path:"/prof/cours",element:r.jsx(Hn,{children:r.jsx(ft,{children:r.jsx(yee,{})})})}),r.jsx(Be,{path:"/prof/cours/nouveau",element:r.jsx(qr,{children:r.jsx(ft,{children:r.jsx(eA,{})})})}),r.jsx(Be,{path:"/prof/cours/:coursId/modifier",element:r.jsx(qr,{children:r.jsx(ft,{children:r.jsx(eA,{})})})}),r.jsx(Be,{path:"/admin",element:r.jsx(qr,{children:r.jsx(fn,{children:r.jsx(q5,{})})})}),r.jsx(Be,{path:"/admin/disciplines",element:r.jsx(qr,{children:r.jsx(fn,{children:r.jsx(R5,{})})})}),r.jsx(Be,{path:"/admin/chapitres",element:r.jsx(qr,{children:r.jsx(fn,{children:r.jsx(I5,{})})})}),r.jsx(Be,{path:"/admin/ressources",element:r.jsx(qr,{children:r.jsx(fn,{children:r.jsx(L5,{})})})}),r.jsx(Be,{path:"/admin/quiz",element:r.jsx(qr,{children:r.jsx(fn,{children:r.jsx(H5,{})})})}),r.jsx(Be,{path:"/admin/quiz/nouveau",element:r.jsx(qr,{children:r.jsx(fn,{children:r.jsx($1,{})})})}),r.jsx(Be,{path:"/admin/quiz/modifier/:quizId",element:r.jsx(qr,{children:r.jsx(fn,{children:r.jsx($1,{})})})}),r.jsx(Be,{path:"/admin/quiz-avance",element:r.jsx(qr,{children:r.jsx(fn,{children:r.jsx(NR,{})})})}),r.jsx(Be,{path:"/admin/utilisateurs",element:r.jsx(qr,{children:r.jsx(fn,{children:r.jsx(J5,{})})})}),r.jsx(Be,{path:"/admin/resultats",element:r.jsx(qr,{children:r.jsx(fn,{children:r.jsx(eR,{})})})}),r.jsx(Be,{path:"/admin/settings",element:r.jsx(qr,{children:r.jsx(fn,{children:r.jsx(tR,{})})})}),r.jsx(Be,{path:"/admin/ebooks",element:r.jsx(qr,{children:r.jsx(fn,{children:r.jsx(qee,{})})})}),r.jsx(Be,{path:"/admin/premium",element:r.jsx(Pd,{to:"/admin/utilisateurs?filter=premium",replace:!0})}),r.jsx(Be,{path:"/notifications",element:r.jsx(eo,{allowedRoles:["eleve","prof","admin","parent"],children:r.jsx(ft,{children:r.jsx(Lee,{})})})}),r.jsx(Be,{path:"/prof/notifications/nouvelle",element:r.jsx(Hn,{children:r.jsx(ft,{children:r.jsx(rA,{})})})}),r.jsx(Be,{path:"/admin/notifications/nouvelle",element:r.jsx(qr,{children:r.jsx(fn,{children:r.jsx(rA,{})})})}),r.jsx(Be,{path:"/cahiers",element:r.jsx(Pd,{to:"/prof/cahiers",replace:!0})}),r.jsx(Be,{path:"/sequences",element:r.jsx(Pd,{to:"/prof/sequences",replace:!0})}),r.jsx(Be,{path:"*",element:r.jsx(Pd,{to:"/",replace:!0})})]})]})),vP=document.getElementById("root");if(!vP)throw new Error("L'lment #root n'existe pas");const Xee=z3.createRoot(vP);Xee.render(r.jsx(Oq.StrictMode,{children:r.jsx(Dq,{children:r.jsx(Wee,{})})}));
//# sourceMappingURL=index-CxAW31gz.js.map
