import{a as ff,b as Sq,g as ei,r as g,u as st,c as zb,L as Ge,d as Wn,e as nA,f as aA,R as wq,h as Cq,i as Fe,N as kd,j as Eq,B as Aq}from"./vendor-react-BMsfgiGx.js";import{i as zq,g as Oq,a as kq,p as Dq,b as Mq,c as Pq,o as Tq,d as Ne,u as Qe,s as Mt,e as qq,f as Rq,h as Iq,G as Lq,j as $q,k as Bq,l as Ot,m as pf,w as Se,n as Ke,q as Cr,r as ke,t as _e,v as ze,x as Pn,T as Oe,y as en,z as hf,A as Tt,B as qr,C as Dc,D as zs,E as da,F as Hs,H as Ob,I as Uq,J as kb}from"./vendor-firebase-LntcAirY.js";import{H as bx,B as vn,G as Os,S as Wr,L as h1,a as Fq,C as ks,b as Cc,D as iA,c as cm,U as Gq,d as Hq,e as v1,X as $i,M as Qq,f as em,g as Vq,P as Yq,h as Kq,i as Wq,F as Xq,j as Db,k as tm,l as Zq,m as Jq,T as e3,I as t3,n as r3,Y as n3,A as js,o as Wl,p as Bt,Z as sA,q as lA,r as no,s as Qi,t as um,u as Ec,v as oA,w as Mb,x as yx,E as eo,y as a3,z as g1,J as i3,K as s3,N as l3,R as o3,O as c3,Q as u3,V as Ac,W as jx,_ as Cv,$ as d3,a0 as m3,a1 as Nx,a2 as Ev,a3 as Av,a4 as f3,a5 as p3,a6 as h3,a7 as v3,a8 as g3}from"./vendor-icons-Dx3xUbaS.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}})();var zv={exports:{}},fc={};var x1;function x3(){if(x1)return fc;x1=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(a,l,o){var u=null;if(o!==void 0&&(u=""+o),l.key!==void 0&&(u=""+l.key),"key"in l){o={};for(var d in l)d!=="key"&&(o[d]=l[d])}else o=l;return l=o.ref,{$$typeof:e,type:a,key:u,ref:l!==void 0?l:null,props:o}}return fc.Fragment=t,fc.jsx=n,fc.jsxs=n,fc}var b1;function b3(){return b1||(b1=1,zv.exports=x3()),zv.exports}var r=b3(),Ov={exports:{}},pc={},kv={exports:{}},Dv={};var y1;function y3(){return y1||(y1=1,(function(e){function t(q,F){var R=q.length;q.push(F);e:for(;0<R;){var K=R-1>>>1,I=q[K];if(0<l(I,F))q[K]=F,q[R]=I,R=K;else break e}}function n(q){return q.length===0?null:q[0]}function a(q){if(q.length===0)return null;var F=q[0],R=q.pop();if(R!==F){q[0]=R;e:for(var K=0,I=q.length,te=I>>>1;K<te;){var Y=2*(K+1)-1,oe=q[Y],he=Y+1,ge=q[he];if(0>l(oe,R))he<I&&0>l(ge,oe)?(q[K]=ge,q[he]=R,K=he):(q[K]=oe,q[Y]=R,K=Y);else if(he<I&&0>l(ge,R))q[K]=ge,q[he]=R,K=he;else break e}}return F}function l(q,F){var R=q.sortIndex-F.sortIndex;return R!==0?R:q.id-F.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var f=[],p=[],h=1,v=null,b=3,x=!1,j=!1,N=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;function z(q){for(var F=n(p);F!==null;){if(F.callback===null)a(p);else if(F.startTime<=q)a(p),F.sortIndex=F.expirationTime,t(f,F);else break;F=n(p)}}function k(q){if(N=!1,z(q),!j)if(n(f)!==null)j=!0,O||(O=!0,B());else{var F=n(p);F!==null&&M(k,F.startTime-q)}}var O=!1,P=-1,D=5,L=-1;function U(){return S?!0:!(e.unstable_now()-L<D)}function $(){if(S=!1,O){var q=e.unstable_now();L=q;var F=!0;try{e:{j=!1,N&&(N=!1,E(P),P=-1),x=!0;var R=b;try{t:{for(z(q),v=n(f);v!==null&&!(v.expirationTime>q&&U());){var K=v.callback;if(typeof K=="function"){v.callback=null,b=v.priorityLevel;var I=K(v.expirationTime<=q);if(q=e.unstable_now(),typeof I=="function"){v.callback=I,z(q),F=!0;break t}v===n(f)&&a(f),z(q)}else a(f);v=n(f)}if(v!==null)F=!0;else{var te=n(p);te!==null&&M(k,te.startTime-q),F=!1}}break e}finally{v=null,b=R,x=!1}F=void 0}}finally{F?B():O=!1}}}var B;if(typeof w=="function")B=function(){w($)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,se=re.port2;re.port1.onmessage=$,B=function(){se.postMessage(null)}}else B=function(){C($,0)};function M(q,F){P=C(function(){q(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(q){switch(b){case 1:case 2:case 3:var F=3;break;default:F=b}var R=b;b=F;try{return q()}finally{b=R}},e.unstable_requestPaint=function(){S=!0},e.unstable_runWithPriority=function(q,F){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var R=b;b=q;try{return F()}finally{b=R}},e.unstable_scheduleCallback=function(q,F,R){var K=e.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?K+R:K):R=K,q){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=R+I,q={id:h++,callback:F,priorityLevel:q,startTime:R,expirationTime:I,sortIndex:-1},R>K?(q.sortIndex=R,t(p,q),n(f)===null&&q===n(p)&&(N?(E(P),P=-1):N=!0,M(k,R-K))):(q.sortIndex=I,t(f,q),j||x||(j=!0,O||(O=!0,B()))),q},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(q){var F=b;return function(){var R=b;b=F;try{return q.apply(this,arguments)}finally{b=R}}}})(Dv)),Dv}var j1;function j3(){return j1||(j1=1,kv.exports=y3()),kv.exports}var N1;function N3(){if(N1)return pc;N1=1;var e=j3(),t=ff(),n=Sq();function a(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function u(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function d(i){if(i.tag===31){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function f(i){if(o(i)!==i)throw Error(a(188))}function p(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(a(188));return s!==i?null:i}for(var c=i,m=s;;){var y=c.return;if(y===null)break;var _=y.alternate;if(_===null){if(m=y.return,m!==null){c=m;continue}break}if(y.child===_.child){for(_=y.child;_;){if(_===c)return f(y),i;if(_===m)return f(y),s;_=_.sibling}throw Error(a(188))}if(c.return!==m.return)c=y,m=_;else{for(var A=!1,T=y.child;T;){if(T===c){A=!0,c=y,m=_;break}if(T===m){A=!0,m=y,c=_;break}T=T.sibling}if(!A){for(T=_.child;T;){if(T===c){A=!0,c=_,m=y;break}if(T===m){A=!0,m=_,c=y;break}T=T.sibling}if(!A)throw Error(a(189))}}if(c.alternate!==m)throw Error(a(190))}if(c.tag!==3)throw Error(a(188));return c.stateNode.current===c?i:s}function h(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=h(i),s!==null)return s;i=i.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),E=Symbol.for("react.consumer"),w=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),$=Symbol.iterator;function B(i){return i===null||typeof i!="object"?null:(i=$&&i[$]||i["@@iterator"],typeof i=="function"?i:null)}var re=Symbol.for("react.client.reference");function se(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===re?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case N:return"Fragment";case C:return"Profiler";case S:return"StrictMode";case k:return"Suspense";case O:return"SuspenseList";case L:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case j:return"Portal";case w:return i.displayName||"Context";case E:return(i._context.displayName||"Context")+".Consumer";case z:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case P:return s=i.displayName||null,s!==null?s:se(i.type)||"Memo";case D:s=i._payload,i=i._init;try{return se(i(s))}catch{}}return null}var M=Array.isArray,q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R={pending:!1,data:null,method:null,action:null},K=[],I=-1;function te(i){return{current:i}}function Y(i){0>I||(i.current=K[I],K[I]=null,I--)}function oe(i,s){I++,K[I]=i.current,i.current=s}var he=te(null),ge=te(null),Q=te(null),ve=te(null);function Me(i,s){switch(oe(Q,s),oe(ge,i),oe(he,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?I_(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=I_(s),i=L_(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}Y(he),oe(he,i)}function ce(){Y(he),Y(ge),Y(Q)}function Z(i){i.memoizedState!==null&&oe(ve,i);var s=he.current,c=L_(s,i.type);s!==c&&(oe(ge,i),oe(he,c))}function H(i){ge.current===i&&(Y(he),Y(ge)),ve.current===i&&(Y(ve),cc._currentValue=R)}var de,we;function qe(i){if(de===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);de=s&&s[1]||"",we=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+de+i+we}var We=!1;function Xe(i,s){if(!i||We)return"";We=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(s){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(me){var le=me}Reflect.construct(i,[],ye)}else{try{ye.call()}catch(me){le=me}i.call(ye.prototype)}}else{try{throw Error()}catch(me){le=me}(ye=i())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(me){if(me&&le&&typeof me.stack=="string")return[me.stack,le.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=m.DetermineComponentFrameRoot(),A=_[0],T=_[1];if(A&&T){var G=A.split(`
`),ie=T.split(`
`);for(y=m=0;m<G.length&&!G[m].includes("DetermineComponentFrameRoot");)m++;for(;y<ie.length&&!ie[y].includes("DetermineComponentFrameRoot");)y++;if(m===G.length||y===ie.length)for(m=G.length-1,y=ie.length-1;1<=m&&0<=y&&G[m]!==ie[y];)y--;for(;1<=m&&0<=y;m--,y--)if(G[m]!==ie[y]){if(m!==1||y!==1)do if(m--,y--,0>y||G[m]!==ie[y]){var xe=`
`+G[m].replace(" at new "," at ");return i.displayName&&xe.includes("<anonymous>")&&(xe=xe.replace("<anonymous>",i.displayName)),xe}while(1<=m&&0<=y);break}}}finally{We=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?qe(c):""}function nt(i,s){switch(i.tag){case 26:case 27:case 5:return qe(i.type);case 16:return qe("Lazy");case 13:return i.child!==s&&s!==null?qe("Suspense Fallback"):qe("Suspense");case 19:return qe("SuspenseList");case 0:case 15:return Xe(i.type,!1);case 11:return Xe(i.type.render,!1);case 1:return Xe(i.type,!0);case 31:return qe("Activity");default:return""}}function gr(i){try{var s="",c=null;do s+=nt(i,c),c=i,i=i.return;while(i);return s}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var Dr=Object.prototype.hasOwnProperty,ir=e.unstable_scheduleCallback,rn=e.unstable_cancelCallback,pe=e.unstable_shouldYield,Ce=e.unstable_requestPaint,Re=e.unstable_now,He=e.unstable_getCurrentPriorityLevel,lt=e.unstable_ImmediatePriority,Vt=e.unstable_UserBlockingPriority,Br=e.unstable_NormalPriority,Ur=e.unstable_LowPriority,J=e.unstable_IdlePriority,W=e.log,fe=e.unstable_setDisableYieldValue,je=null,Te=null;function gt(i){if(typeof W=="function"&&fe(i),Te&&typeof Te.setStrictMode=="function")try{Te.setStrictMode(je,i)}catch{}}var qt=Math.clz32?Math.clz32:pp,bn=Math.log,Ji=Math.LN2;function pp(i){return i>>>=0,i===0?32:31-(bn(i)/Ji|0)|0}var tl=256,rl=262144,nl=4194304;function ba(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ea(i,s,c){var m=i.pendingLanes;if(m===0)return 0;var y=0,_=i.suspendedLanes,A=i.pingedLanes;i=i.warmLanes;var T=m&134217727;return T!==0?(m=T&~_,m!==0?y=ba(m):(A&=T,A!==0?y=ba(A):c||(c=T&~i,c!==0&&(y=ba(c))))):(T=m&~_,T!==0?y=ba(T):A!==0?y=ba(A):c||(c=m&~i,c!==0&&(y=ba(c)))),y===0?0:s!==0&&s!==y&&(s&_)===0&&(_=y&-y,c=s&-s,_>=c||_===32&&(c&4194048)!==0)?s:y}function es(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function ne(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $e(){var i=nl;return nl<<=1,(nl&62914560)===0&&(nl=4194304),i}function _t(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function Er(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function _o(i,s,c,m,y,_){var A=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var T=i.entanglements,G=i.expirationTimes,ie=i.hiddenUpdates;for(c=A&~c;0<c;){var xe=31-qt(c),ye=1<<xe;T[xe]=0,G[xe]=-1;var le=ie[xe];if(le!==null)for(ie[xe]=null,xe=0;xe<le.length;xe++){var me=le[xe];me!==null&&(me.lane&=-536870913)}c&=~ye}m!==0&&ts(i,m,0),_!==0&&y===0&&i.tag!==0&&(i.suspendedLanes|=_&~(A&~s))}function ts(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var m=31-qt(s);i.entangledLanes|=s,i.entanglements[m]=i.entanglements[m]|1073741824|c&261930}function jj(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var m=31-qt(c),y=1<<m;y&s|i[m]&s&&(i[m]|=s),c&=~y}}function Nj(i,s){var c=s&-s;return c=(c&42)!==0?1:hp(c),(c&(i.suspendedLanes|s))!==0?0:c}function hp(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function vp(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function _j(){var i=F.p;return i!==0?i:(i=window.event,i===void 0?32:o1(i.type))}function Sj(i,s){var c=F.p;try{return F.p=i,s()}finally{F.p=c}}var ui=Math.random().toString(36).slice(2),xr="__reactFiber$"+ui,Fr="__reactProps$"+ui,al="__reactContainer$"+ui,gp="__reactEvents$"+ui,fP="__reactListeners$"+ui,pP="__reactHandles$"+ui,wj="__reactResources$"+ui,So="__reactMarker$"+ui;function xp(i){delete i[xr],delete i[Fr],delete i[gp],delete i[fP],delete i[pP]}function il(i){var s=i[xr];if(s)return s;for(var c=i.parentNode;c;){if(s=c[al]||c[xr]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=Q_(i);i!==null;){if(c=i[xr])return c;i=Q_(i)}return s}i=c,c=i.parentNode}return null}function sl(i){if(i=i[xr]||i[al]){var s=i.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return i}return null}function wo(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(a(33))}function ll(i){var s=i[wj];return s||(s=i[wj]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function sr(i){i[So]=!0}var Cj=new Set,Ej={};function rs(i,s){ol(i,s),ol(i+"Capture",s)}function ol(i,s){for(Ej[i]=s,i=0;i<s.length;i++)Cj.add(s[i])}var hP=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Aj={},zj={};function vP(i){return Dr.call(zj,i)?!0:Dr.call(Aj,i)?!1:hP.test(i)?zj[i]=!0:(Aj[i]=!0,!1)}function bu(i,s,c){if(vP(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var m=s.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function yu(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function ya(i,s,c,m){if(m===null)i.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+m)}}function yn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Oj(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function gP(i,s,c){var m=Object.getOwnPropertyDescriptor(i.constructor.prototype,s);if(!i.hasOwnProperty(s)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var y=m.get,_=m.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return y.call(this)},set:function(A){c=""+A,_.call(this,A)}}),Object.defineProperty(i,s,{enumerable:m.enumerable}),{getValue:function(){return c},setValue:function(A){c=""+A},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function bp(i){if(!i._valueTracker){var s=Oj(i)?"checked":"value";i._valueTracker=gP(i,s,""+i[s])}}function kj(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),m="";return i&&(m=Oj(i)?i.checked?"true":"false":i.value),i=m,i!==c?(s.setValue(i),!0):!1}function ju(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var xP=/[\n"\\]/g;function jn(i){return i.replace(xP,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function yp(i,s,c,m,y,_,A,T){i.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?i.type=A:i.removeAttribute("type"),s!=null?A==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+yn(s)):i.value!==""+yn(s)&&(i.value=""+yn(s)):A!=="submit"&&A!=="reset"||i.removeAttribute("value"),s!=null?jp(i,A,yn(s)):c!=null?jp(i,A,yn(c)):m!=null&&i.removeAttribute("value"),y==null&&_!=null&&(i.defaultChecked=!!_),y!=null&&(i.checked=y&&typeof y!="function"&&typeof y!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?i.name=""+yn(T):i.removeAttribute("name")}function Dj(i,s,c,m,y,_,A,T){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(i.type=_),s!=null||c!=null){if(!(_!=="submit"&&_!=="reset"||s!=null)){bp(i);return}c=c!=null?""+yn(c):"",s=s!=null?""+yn(s):c,T||s===i.value||(i.value=s),i.defaultValue=s}m=m??y,m=typeof m!="function"&&typeof m!="symbol"&&!!m,i.checked=T?i.checked:!!m,i.defaultChecked=!!m,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(i.name=A),bp(i)}function jp(i,s,c){s==="number"&&ju(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function cl(i,s,c,m){if(i=i.options,s){s={};for(var y=0;y<c.length;y++)s["$"+c[y]]=!0;for(c=0;c<i.length;c++)y=s.hasOwnProperty("$"+i[c].value),i[c].selected!==y&&(i[c].selected=y),y&&m&&(i[c].defaultSelected=!0)}else{for(c=""+yn(c),s=null,y=0;y<i.length;y++){if(i[y].value===c){i[y].selected=!0,m&&(i[y].defaultSelected=!0);return}s!==null||i[y].disabled||(s=i[y])}s!==null&&(s.selected=!0)}}function Mj(i,s,c){if(s!=null&&(s=""+yn(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+yn(c):""}function Pj(i,s,c,m){if(s==null){if(m!=null){if(c!=null)throw Error(a(92));if(M(m)){if(1<m.length)throw Error(a(93));m=m[0]}c=m}c==null&&(c=""),s=c}c=yn(s),i.defaultValue=c,m=i.textContent,m===c&&m!==""&&m!==null&&(i.value=m),bp(i)}function ul(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var bP=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tj(i,s,c){var m=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?m?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":m?i.setProperty(s,c):typeof c!="number"||c===0||bP.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function qj(i,s,c){if(s!=null&&typeof s!="object")throw Error(a(62));if(i=i.style,c!=null){for(var m in c)!c.hasOwnProperty(m)||s!=null&&s.hasOwnProperty(m)||(m.indexOf("--")===0?i.setProperty(m,""):m==="float"?i.cssFloat="":i[m]="");for(var y in s)m=s[y],s.hasOwnProperty(y)&&c[y]!==m&&Tj(i,y,m)}else for(var _ in s)s.hasOwnProperty(_)&&Tj(i,_,s[_])}function Np(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yP=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jP=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Nu(i){return jP.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function ja(){}var _p=null;function Sp(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var dl=null,ml=null;function Rj(i){var s=sl(i);if(s&&(i=s.stateNode)){var c=i[Fr]||null;e:switch(i=s.stateNode,s.type){case"input":if(yp(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+jn(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var m=c[s];if(m!==i&&m.form===i.form){var y=m[Fr]||null;if(!y)throw Error(a(90));yp(m,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(s=0;s<c.length;s++)m=c[s],m.form===i.form&&kj(m)}break e;case"textarea":Mj(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&cl(i,!!c.multiple,s,!1)}}}var wp=!1;function Ij(i,s,c){if(wp)return i(s,c);wp=!0;try{var m=i(s);return m}finally{if(wp=!1,(dl!==null||ml!==null)&&(cd(),dl&&(s=dl,i=ml,ml=dl=null,Rj(s),i)))for(s=0;s<i.length;s++)Rj(i[s])}}function Co(i,s){var c=i.stateNode;if(c===null)return null;var m=c[Fr]||null;if(m===null)return null;c=m[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(i=i.type,m=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!m;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(a(231,s,typeof c));return c}var Na=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cp=!1;if(Na)try{var Eo={};Object.defineProperty(Eo,"passive",{get:function(){Cp=!0}}),window.addEventListener("test",Eo,Eo),window.removeEventListener("test",Eo,Eo)}catch{Cp=!1}var di=null,Ep=null,_u=null;function Lj(){if(_u)return _u;var i,s=Ep,c=s.length,m,y="value"in di?di.value:di.textContent,_=y.length;for(i=0;i<c&&s[i]===y[i];i++);var A=c-i;for(m=1;m<=A&&s[c-m]===y[_-m];m++);return _u=y.slice(i,1<m?1-m:void 0)}function Su(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function wu(){return!0}function $j(){return!1}function Gr(i){function s(c,m,y,_,A){this._reactName=c,this._targetInst=y,this.type=m,this.nativeEvent=_,this.target=A,this.currentTarget=null;for(var T in i)i.hasOwnProperty(T)&&(c=i[T],this[T]=c?c(_):_[T]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?wu:$j,this.isPropagationStopped=$j,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=wu)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=wu)},persist:function(){},isPersistent:wu}),s}var ns={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cu=Gr(ns),Ao=v({},ns,{view:0,detail:0}),NP=Gr(Ao),Ap,zp,zo,Eu=v({},Ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kp,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==zo&&(zo&&i.type==="mousemove"?(Ap=i.screenX-zo.screenX,zp=i.screenY-zo.screenY):zp=Ap=0,zo=i),Ap)},movementY:function(i){return"movementY"in i?i.movementY:zp}}),Bj=Gr(Eu),_P=v({},Eu,{dataTransfer:0}),SP=Gr(_P),wP=v({},Ao,{relatedTarget:0}),Op=Gr(wP),CP=v({},ns,{animationName:0,elapsedTime:0,pseudoElement:0}),EP=Gr(CP),AP=v({},ns,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),zP=Gr(AP),OP=v({},ns,{data:0}),Uj=Gr(OP),kP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},DP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},MP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function PP(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=MP[i])?!!s[i]:!1}function kp(){return PP}var TP=v({},Ao,{key:function(i){if(i.key){var s=kP[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Su(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?DP[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kp,charCode:function(i){return i.type==="keypress"?Su(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Su(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),qP=Gr(TP),RP=v({},Eu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fj=Gr(RP),IP=v({},Ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kp}),LP=Gr(IP),$P=v({},ns,{propertyName:0,elapsedTime:0,pseudoElement:0}),BP=Gr($P),UP=v({},Eu,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),FP=Gr(UP),GP=v({},ns,{newState:0,oldState:0}),HP=Gr(GP),QP=[9,13,27,32],Dp=Na&&"CompositionEvent"in window,Oo=null;Na&&"documentMode"in document&&(Oo=document.documentMode);var VP=Na&&"TextEvent"in window&&!Oo,Gj=Na&&(!Dp||Oo&&8<Oo&&11>=Oo),Hj=" ",Qj=!1;function Vj(i,s){switch(i){case"keyup":return QP.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yj(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var fl=!1;function YP(i,s){switch(i){case"compositionend":return Yj(s);case"keypress":return s.which!==32?null:(Qj=!0,Hj);case"textInput":return i=s.data,i===Hj&&Qj?null:i;default:return null}}function KP(i,s){if(fl)return i==="compositionend"||!Dp&&Vj(i,s)?(i=Lj(),_u=Ep=di=null,fl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Gj&&s.locale!=="ko"?null:s.data;default:return null}}var WP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kj(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!WP[i.type]:s==="textarea"}function Wj(i,s,c,m){dl?ml?ml.push(m):ml=[m]:dl=m,s=vd(s,"onChange"),0<s.length&&(c=new Cu("onChange","change",null,c,m),i.push({event:c,listeners:s}))}var ko=null,Do=null;function XP(i){D_(i,0)}function Au(i){var s=wo(i);if(kj(s))return i}function Xj(i,s){if(i==="change")return s}var Zj=!1;if(Na){var Mp;if(Na){var Pp="oninput"in document;if(!Pp){var Jj=document.createElement("div");Jj.setAttribute("oninput","return;"),Pp=typeof Jj.oninput=="function"}Mp=Pp}else Mp=!1;Zj=Mp&&(!document.documentMode||9<document.documentMode)}function e0(){ko&&(ko.detachEvent("onpropertychange",t0),Do=ko=null)}function t0(i){if(i.propertyName==="value"&&Au(Do)){var s=[];Wj(s,Do,i,Sp(i)),Ij(XP,s)}}function ZP(i,s,c){i==="focusin"?(e0(),ko=s,Do=c,ko.attachEvent("onpropertychange",t0)):i==="focusout"&&e0()}function JP(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Au(Do)}function eT(i,s){if(i==="click")return Au(s)}function tT(i,s){if(i==="input"||i==="change")return Au(s)}function rT(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var nn=typeof Object.is=="function"?Object.is:rT;function Mo(i,s){if(nn(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),m=Object.keys(s);if(c.length!==m.length)return!1;for(m=0;m<c.length;m++){var y=c[m];if(!Dr.call(s,y)||!nn(i[y],s[y]))return!1}return!0}function r0(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function n0(i,s){var c=r0(i);i=0;for(var m;c;){if(c.nodeType===3){if(m=i+c.textContent.length,i<=s&&m>=s)return{node:c,offset:s-i};i=m}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=r0(c)}}function a0(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?a0(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function i0(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=ju(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=ju(i.document)}return s}function Tp(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var nT=Na&&"documentMode"in document&&11>=document.documentMode,pl=null,qp=null,Po=null,Rp=!1;function s0(i,s,c){var m=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Rp||pl==null||pl!==ju(m)||(m=pl,"selectionStart"in m&&Tp(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Po&&Mo(Po,m)||(Po=m,m=vd(qp,"onSelect"),0<m.length&&(s=new Cu("onSelect","select",null,s,c),i.push({event:s,listeners:m}),s.target=pl)))}function as(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var hl={animationend:as("Animation","AnimationEnd"),animationiteration:as("Animation","AnimationIteration"),animationstart:as("Animation","AnimationStart"),transitionrun:as("Transition","TransitionRun"),transitionstart:as("Transition","TransitionStart"),transitioncancel:as("Transition","TransitionCancel"),transitionend:as("Transition","TransitionEnd")},Ip={},l0={};Na&&(l0=document.createElement("div").style,"AnimationEvent"in window||(delete hl.animationend.animation,delete hl.animationiteration.animation,delete hl.animationstart.animation),"TransitionEvent"in window||delete hl.transitionend.transition);function is(i){if(Ip[i])return Ip[i];if(!hl[i])return i;var s=hl[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in l0)return Ip[i]=s[c];return i}var o0=is("animationend"),c0=is("animationiteration"),u0=is("animationstart"),aT=is("transitionrun"),iT=is("transitionstart"),sT=is("transitioncancel"),d0=is("transitionend"),m0=new Map,Lp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lp.push("scrollEnd");function $n(i,s){m0.set(i,s),rs(s,[i])}var zu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},Nn=[],vl=0,$p=0;function Ou(){for(var i=vl,s=$p=vl=0;s<i;){var c=Nn[s];Nn[s++]=null;var m=Nn[s];Nn[s++]=null;var y=Nn[s];Nn[s++]=null;var _=Nn[s];if(Nn[s++]=null,m!==null&&y!==null){var A=m.pending;A===null?y.next=y:(y.next=A.next,A.next=y),m.pending=y}_!==0&&f0(c,y,_)}}function ku(i,s,c,m){Nn[vl++]=i,Nn[vl++]=s,Nn[vl++]=c,Nn[vl++]=m,$p|=m,i.lanes|=m,i=i.alternate,i!==null&&(i.lanes|=m)}function Bp(i,s,c,m){return ku(i,s,c,m),Du(i)}function ss(i,s){return ku(i,null,null,s),Du(i)}function f0(i,s,c){i.lanes|=c;var m=i.alternate;m!==null&&(m.lanes|=c);for(var y=!1,_=i.return;_!==null;)_.childLanes|=c,m=_.alternate,m!==null&&(m.childLanes|=c),_.tag===22&&(i=_.stateNode,i===null||i._visibility&1||(y=!0)),i=_,_=_.return;return i.tag===3?(_=i.stateNode,y&&s!==null&&(y=31-qt(c),i=_.hiddenUpdates,m=i[y],m===null?i[y]=[s]:m.push(s),s.lane=c|536870912),_):null}function Du(i){if(50<rc)throw rc=0,Wh=null,Error(a(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var gl={};function lT(i,s,c,m){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function an(i,s,c,m){return new lT(i,s,c,m)}function Up(i){return i=i.prototype,!(!i||!i.isReactComponent)}function _a(i,s){var c=i.alternate;return c===null?(c=an(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function p0(i,s){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Mu(i,s,c,m,y,_){var A=0;if(m=i,typeof i=="function")Up(i)&&(A=1);else if(typeof i=="string")A=mq(i,c,he.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case L:return i=an(31,c,s,y),i.elementType=L,i.lanes=_,i;case N:return ls(c.children,y,_,s);case S:A=8,y|=24;break;case C:return i=an(12,c,s,y|2),i.elementType=C,i.lanes=_,i;case k:return i=an(13,c,s,y),i.elementType=k,i.lanes=_,i;case O:return i=an(19,c,s,y),i.elementType=O,i.lanes=_,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case w:A=10;break e;case E:A=9;break e;case z:A=11;break e;case P:A=14;break e;case D:A=16,m=null;break e}A=29,c=Error(a(130,i===null?"null":typeof i,"")),m=null}return s=an(A,c,s,y),s.elementType=i,s.type=m,s.lanes=_,s}function ls(i,s,c,m){return i=an(7,i,m,s),i.lanes=c,i}function Fp(i,s,c){return i=an(6,i,null,s),i.lanes=c,i}function h0(i){var s=an(18,null,null,0);return s.stateNode=i,s}function Gp(i,s,c){return s=an(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var v0=new WeakMap;function _n(i,s){if(typeof i=="object"&&i!==null){var c=v0.get(i);return c!==void 0?c:(s={value:i,source:s,stack:gr(s)},v0.set(i,s),s)}return{value:i,source:s,stack:gr(s)}}var xl=[],bl=0,Pu=null,To=0,Sn=[],wn=0,mi=null,ta=1,ra="";function Sa(i,s){xl[bl++]=To,xl[bl++]=Pu,Pu=i,To=s}function g0(i,s,c){Sn[wn++]=ta,Sn[wn++]=ra,Sn[wn++]=mi,mi=i;var m=ta;i=ra;var y=32-qt(m)-1;m&=~(1<<y),c+=1;var _=32-qt(s)+y;if(30<_){var A=y-y%5;_=(m&(1<<A)-1).toString(32),m>>=A,y-=A,ta=1<<32-qt(s)+y|c<<y|m,ra=_+i}else ta=1<<_|c<<y|m,ra=i}function Hp(i){i.return!==null&&(Sa(i,1),g0(i,1,0))}function Qp(i){for(;i===Pu;)Pu=xl[--bl],xl[bl]=null,To=xl[--bl],xl[bl]=null;for(;i===mi;)mi=Sn[--wn],Sn[wn]=null,ra=Sn[--wn],Sn[wn]=null,ta=Sn[--wn],Sn[wn]=null}function x0(i,s){Sn[wn++]=ta,Sn[wn++]=ra,Sn[wn++]=mi,ta=s.id,ra=s.overflow,mi=i}var br=null,Et=null,at=!1,fi=null,Cn=!1,Vp=Error(a(519));function pi(i){var s=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw qo(_n(s,i)),Vp}function b0(i){var s=i.stateNode,c=i.type,m=i.memoizedProps;switch(s[xr]=i,s[Fr]=m,c){case"dialog":Je("cancel",s),Je("close",s);break;case"iframe":case"object":case"embed":Je("load",s);break;case"video":case"audio":for(c=0;c<ac.length;c++)Je(ac[c],s);break;case"source":Je("error",s);break;case"img":case"image":case"link":Je("error",s),Je("load",s);break;case"details":Je("toggle",s);break;case"input":Je("invalid",s),Dj(s,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":Je("invalid",s);break;case"textarea":Je("invalid",s),Pj(s,m.value,m.defaultValue,m.children)}c=m.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||m.suppressHydrationWarning===!0||q_(s.textContent,c)?(m.popover!=null&&(Je("beforetoggle",s),Je("toggle",s)),m.onScroll!=null&&Je("scroll",s),m.onScrollEnd!=null&&Je("scrollend",s),m.onClick!=null&&(s.onclick=ja),s=!0):s=!1,s||pi(i,!0)}function y0(i){for(br=i.return;br;)switch(br.tag){case 5:case 31:case 13:Cn=!1;return;case 27:case 3:Cn=!0;return;default:br=br.return}}function yl(i){if(i!==br)return!1;if(!at)return y0(i),at=!0,!1;var s=i.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||dv(i.type,i.memoizedProps)),c=!c),c&&Et&&pi(i),y0(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));Et=H_(i)}else if(s===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));Et=H_(i)}else s===27?(s=Et,Ai(i.type)?(i=vv,vv=null,Et=i):Et=s):Et=br?An(i.stateNode.nextSibling):null;return!0}function os(){Et=br=null,at=!1}function Yp(){var i=fi;return i!==null&&(Yr===null?Yr=i:Yr.push.apply(Yr,i),fi=null),i}function qo(i){fi===null?fi=[i]:fi.push(i)}var Kp=te(null),cs=null,wa=null;function hi(i,s,c){oe(Kp,s._currentValue),s._currentValue=c}function Ca(i){i._currentValue=Kp.current,Y(Kp)}function Wp(i,s,c){for(;i!==null;){var m=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,m!==null&&(m.childLanes|=s)):m!==null&&(m.childLanes&s)!==s&&(m.childLanes|=s),i===c)break;i=i.return}}function Xp(i,s,c,m){var y=i.child;for(y!==null&&(y.return=i);y!==null;){var _=y.dependencies;if(_!==null){var A=y.child;_=_.firstContext;e:for(;_!==null;){var T=_;_=y;for(var G=0;G<s.length;G++)if(T.context===s[G]){_.lanes|=c,T=_.alternate,T!==null&&(T.lanes|=c),Wp(_.return,c,i),m||(A=null);break e}_=T.next}}else if(y.tag===18){if(A=y.return,A===null)throw Error(a(341));A.lanes|=c,_=A.alternate,_!==null&&(_.lanes|=c),Wp(A,c,i),A=null}else A=y.child;if(A!==null)A.return=y;else for(A=y;A!==null;){if(A===i){A=null;break}if(y=A.sibling,y!==null){y.return=A.return,A=y;break}A=A.return}y=A}}function jl(i,s,c,m){i=null;for(var y=s,_=!1;y!==null;){if(!_){if((y.flags&524288)!==0)_=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var A=y.alternate;if(A===null)throw Error(a(387));if(A=A.memoizedProps,A!==null){var T=y.type;nn(y.pendingProps.value,A.value)||(i!==null?i.push(T):i=[T])}}else if(y===ve.current){if(A=y.alternate,A===null)throw Error(a(387));A.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(i!==null?i.push(cc):i=[cc])}y=y.return}i!==null&&Xp(s,i,c,m),s.flags|=262144}function Tu(i){for(i=i.firstContext;i!==null;){if(!nn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function us(i){cs=i,wa=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function yr(i){return j0(cs,i)}function qu(i,s){return cs===null&&us(i),j0(i,s)}function j0(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},wa===null){if(i===null)throw Error(a(308));wa=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else wa=wa.next=s;return c}var oT=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,m){i.push(m)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},cT=e.unstable_scheduleCallback,uT=e.unstable_NormalPriority,Yt={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zp(){return{controller:new oT,data:new Map,refCount:0}}function Ro(i){i.refCount--,i.refCount===0&&cT(uT,function(){i.controller.abort()})}var Io=null,Jp=0,Nl=0,_l=null;function dT(i,s){if(Io===null){var c=Io=[];Jp=0,Nl=rv(),_l={status:"pending",value:void 0,then:function(m){c.push(m)}}}return Jp++,s.then(N0,N0),s}function N0(){if(--Jp===0&&Io!==null){_l!==null&&(_l.status="fulfilled");var i=Io;Io=null,Nl=0,_l=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function mT(i,s){var c=[],m={status:"pending",value:null,reason:null,then:function(y){c.push(y)}};return i.then(function(){m.status="fulfilled",m.value=s;for(var y=0;y<c.length;y++)(0,c[y])(s)},function(y){for(m.status="rejected",m.reason=y,y=0;y<c.length;y++)(0,c[y])(void 0)}),m}var _0=q.S;q.S=function(i,s){s_=Re(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&dT(i,s),_0!==null&&_0(i,s)};var ds=te(null);function eh(){var i=ds.current;return i!==null?i:St.pooledCache}function Ru(i,s){s===null?oe(ds,ds.current):oe(ds,s.pool)}function S0(){var i=eh();return i===null?null:{parent:Yt._currentValue,pool:i}}var Sl=Error(a(460)),th=Error(a(474)),Iu=Error(a(542)),Lu={then:function(){}};function w0(i){return i=i.status,i==="fulfilled"||i==="rejected"}function C0(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(ja,ja),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,A0(i),i;default:if(typeof s.status=="string")s.then(ja,ja);else{if(i=St,i!==null&&100<i.shellSuspendCounter)throw Error(a(482));i=s,i.status="pending",i.then(function(m){if(s.status==="pending"){var y=s;y.status="fulfilled",y.value=m}},function(m){if(s.status==="pending"){var y=s;y.status="rejected",y.reason=m}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,A0(i),i}throw fs=s,Sl}}function ms(i){try{var s=i._init;return s(i._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(fs=c,Sl):c}}var fs=null;function E0(){if(fs===null)throw Error(a(459));var i=fs;return fs=null,i}function A0(i){if(i===Sl||i===Iu)throw Error(a(483))}var wl=null,Lo=0;function $u(i){var s=Lo;return Lo+=1,wl===null&&(wl=[]),C0(wl,i,s)}function $o(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Bu(i,s){throw s.$$typeof===b?Error(a(525)):(i=Object.prototype.toString.call(s),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function z0(i){function s(ee,V){if(i){var ae=ee.deletions;ae===null?(ee.deletions=[V],ee.flags|=16):ae.push(V)}}function c(ee,V){if(!i)return null;for(;V!==null;)s(ee,V),V=V.sibling;return null}function m(ee){for(var V=new Map;ee!==null;)ee.key!==null?V.set(ee.key,ee):V.set(ee.index,ee),ee=ee.sibling;return V}function y(ee,V){return ee=_a(ee,V),ee.index=0,ee.sibling=null,ee}function _(ee,V,ae){return ee.index=ae,i?(ae=ee.alternate,ae!==null?(ae=ae.index,ae<V?(ee.flags|=67108866,V):ae):(ee.flags|=67108866,V)):(ee.flags|=1048576,V)}function A(ee){return i&&ee.alternate===null&&(ee.flags|=67108866),ee}function T(ee,V,ae,be){return V===null||V.tag!==6?(V=Fp(ae,ee.mode,be),V.return=ee,V):(V=y(V,ae),V.return=ee,V)}function G(ee,V,ae,be){var Le=ae.type;return Le===N?xe(ee,V,ae.props.children,be,ae.key):V!==null&&(V.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===D&&ms(Le)===V.type)?(V=y(V,ae.props),$o(V,ae),V.return=ee,V):(V=Mu(ae.type,ae.key,ae.props,null,ee.mode,be),$o(V,ae),V.return=ee,V)}function ie(ee,V,ae,be){return V===null||V.tag!==4||V.stateNode.containerInfo!==ae.containerInfo||V.stateNode.implementation!==ae.implementation?(V=Gp(ae,ee.mode,be),V.return=ee,V):(V=y(V,ae.children||[]),V.return=ee,V)}function xe(ee,V,ae,be,Le){return V===null||V.tag!==7?(V=ls(ae,ee.mode,be,Le),V.return=ee,V):(V=y(V,ae),V.return=ee,V)}function ye(ee,V,ae){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return V=Fp(""+V,ee.mode,ae),V.return=ee,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case x:return ae=Mu(V.type,V.key,V.props,null,ee.mode,ae),$o(ae,V),ae.return=ee,ae;case j:return V=Gp(V,ee.mode,ae),V.return=ee,V;case D:return V=ms(V),ye(ee,V,ae)}if(M(V)||B(V))return V=ls(V,ee.mode,ae,null),V.return=ee,V;if(typeof V.then=="function")return ye(ee,$u(V),ae);if(V.$$typeof===w)return ye(ee,qu(ee,V),ae);Bu(ee,V)}return null}function le(ee,V,ae,be){var Le=V!==null?V.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return Le!==null?null:T(ee,V,""+ae,be);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case x:return ae.key===Le?G(ee,V,ae,be):null;case j:return ae.key===Le?ie(ee,V,ae,be):null;case D:return ae=ms(ae),le(ee,V,ae,be)}if(M(ae)||B(ae))return Le!==null?null:xe(ee,V,ae,be,null);if(typeof ae.then=="function")return le(ee,V,$u(ae),be);if(ae.$$typeof===w)return le(ee,V,qu(ee,ae),be);Bu(ee,ae)}return null}function me(ee,V,ae,be,Le){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return ee=ee.get(ae)||null,T(V,ee,""+be,Le);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case x:return ee=ee.get(be.key===null?ae:be.key)||null,G(V,ee,be,Le);case j:return ee=ee.get(be.key===null?ae:be.key)||null,ie(V,ee,be,Le);case D:return be=ms(be),me(ee,V,ae,be,Le)}if(M(be)||B(be))return ee=ee.get(ae)||null,xe(V,ee,be,Le,null);if(typeof be.then=="function")return me(ee,V,ae,$u(be),Le);if(be.$$typeof===w)return me(ee,V,ae,qu(V,be),Le);Bu(V,be)}return null}function Ae(ee,V,ae,be){for(var Le=null,ot=null,Pe=V,Ye=V=0,tt=null;Pe!==null&&Ye<ae.length;Ye++){Pe.index>Ye?(tt=Pe,Pe=null):tt=Pe.sibling;var ct=le(ee,Pe,ae[Ye],be);if(ct===null){Pe===null&&(Pe=tt);break}i&&Pe&&ct.alternate===null&&s(ee,Pe),V=_(ct,V,Ye),ot===null?Le=ct:ot.sibling=ct,ot=ct,Pe=tt}if(Ye===ae.length)return c(ee,Pe),at&&Sa(ee,Ye),Le;if(Pe===null){for(;Ye<ae.length;Ye++)Pe=ye(ee,ae[Ye],be),Pe!==null&&(V=_(Pe,V,Ye),ot===null?Le=Pe:ot.sibling=Pe,ot=Pe);return at&&Sa(ee,Ye),Le}for(Pe=m(Pe);Ye<ae.length;Ye++)tt=me(Pe,ee,Ye,ae[Ye],be),tt!==null&&(i&&tt.alternate!==null&&Pe.delete(tt.key===null?Ye:tt.key),V=_(tt,V,Ye),ot===null?Le=tt:ot.sibling=tt,ot=tt);return i&&Pe.forEach(function(Mi){return s(ee,Mi)}),at&&Sa(ee,Ye),Le}function Ue(ee,V,ae,be){if(ae==null)throw Error(a(151));for(var Le=null,ot=null,Pe=V,Ye=V=0,tt=null,ct=ae.next();Pe!==null&&!ct.done;Ye++,ct=ae.next()){Pe.index>Ye?(tt=Pe,Pe=null):tt=Pe.sibling;var Mi=le(ee,Pe,ct.value,be);if(Mi===null){Pe===null&&(Pe=tt);break}i&&Pe&&Mi.alternate===null&&s(ee,Pe),V=_(Mi,V,Ye),ot===null?Le=Mi:ot.sibling=Mi,ot=Mi,Pe=tt}if(ct.done)return c(ee,Pe),at&&Sa(ee,Ye),Le;if(Pe===null){for(;!ct.done;Ye++,ct=ae.next())ct=ye(ee,ct.value,be),ct!==null&&(V=_(ct,V,Ye),ot===null?Le=ct:ot.sibling=ct,ot=ct);return at&&Sa(ee,Ye),Le}for(Pe=m(Pe);!ct.done;Ye++,ct=ae.next())ct=me(Pe,ee,Ye,ct.value,be),ct!==null&&(i&&ct.alternate!==null&&Pe.delete(ct.key===null?Ye:ct.key),V=_(ct,V,Ye),ot===null?Le=ct:ot.sibling=ct,ot=ct);return i&&Pe.forEach(function(_q){return s(ee,_q)}),at&&Sa(ee,Ye),Le}function yt(ee,V,ae,be){if(typeof ae=="object"&&ae!==null&&ae.type===N&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case x:e:{for(var Le=ae.key;V!==null;){if(V.key===Le){if(Le=ae.type,Le===N){if(V.tag===7){c(ee,V.sibling),be=y(V,ae.props.children),be.return=ee,ee=be;break e}}else if(V.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===D&&ms(Le)===V.type){c(ee,V.sibling),be=y(V,ae.props),$o(be,ae),be.return=ee,ee=be;break e}c(ee,V);break}else s(ee,V);V=V.sibling}ae.type===N?(be=ls(ae.props.children,ee.mode,be,ae.key),be.return=ee,ee=be):(be=Mu(ae.type,ae.key,ae.props,null,ee.mode,be),$o(be,ae),be.return=ee,ee=be)}return A(ee);case j:e:{for(Le=ae.key;V!==null;){if(V.key===Le)if(V.tag===4&&V.stateNode.containerInfo===ae.containerInfo&&V.stateNode.implementation===ae.implementation){c(ee,V.sibling),be=y(V,ae.children||[]),be.return=ee,ee=be;break e}else{c(ee,V);break}else s(ee,V);V=V.sibling}be=Gp(ae,ee.mode,be),be.return=ee,ee=be}return A(ee);case D:return ae=ms(ae),yt(ee,V,ae,be)}if(M(ae))return Ae(ee,V,ae,be);if(B(ae)){if(Le=B(ae),typeof Le!="function")throw Error(a(150));return ae=Le.call(ae),Ue(ee,V,ae,be)}if(typeof ae.then=="function")return yt(ee,V,$u(ae),be);if(ae.$$typeof===w)return yt(ee,V,qu(ee,ae),be);Bu(ee,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint"?(ae=""+ae,V!==null&&V.tag===6?(c(ee,V.sibling),be=y(V,ae),be.return=ee,ee=be):(c(ee,V),be=Fp(ae,ee.mode,be),be.return=ee,ee=be),A(ee)):c(ee,V)}return function(ee,V,ae,be){try{Lo=0;var Le=yt(ee,V,ae,be);return wl=null,Le}catch(Pe){if(Pe===Sl||Pe===Iu)throw Pe;var ot=an(29,Pe,null,ee.mode);return ot.lanes=be,ot.return=ee,ot}}}var ps=z0(!0),O0=z0(!1),vi=!1;function rh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function nh(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function gi(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function xi(i,s,c){var m=i.updateQueue;if(m===null)return null;if(m=m.shared,(dt&2)!==0){var y=m.pending;return y===null?s.next=s:(s.next=y.next,y.next=s),m.pending=s,s=Du(i),f0(i,null,c),s}return ku(i,m,s,c),Du(i)}function Bo(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var m=s.lanes;m&=i.pendingLanes,c|=m,s.lanes=c,jj(i,c)}}function ah(i,s){var c=i.updateQueue,m=i.alternate;if(m!==null&&(m=m.updateQueue,c===m)){var y=null,_=null;if(c=c.firstBaseUpdate,c!==null){do{var A={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};_===null?y=_=A:_=_.next=A,c=c.next}while(c!==null);_===null?y=_=s:_=_.next=s}else y=_=s;c={baseState:m.baseState,firstBaseUpdate:y,lastBaseUpdate:_,shared:m.shared,callbacks:m.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var ih=!1;function Uo(){if(ih){var i=_l;if(i!==null)throw i}}function Fo(i,s,c,m){ih=!1;var y=i.updateQueue;vi=!1;var _=y.firstBaseUpdate,A=y.lastBaseUpdate,T=y.shared.pending;if(T!==null){y.shared.pending=null;var G=T,ie=G.next;G.next=null,A===null?_=ie:A.next=ie,A=G;var xe=i.alternate;xe!==null&&(xe=xe.updateQueue,T=xe.lastBaseUpdate,T!==A&&(T===null?xe.firstBaseUpdate=ie:T.next=ie,xe.lastBaseUpdate=G))}if(_!==null){var ye=y.baseState;A=0,xe=ie=G=null,T=_;do{var le=T.lane&-536870913,me=le!==T.lane;if(me?(et&le)===le:(m&le)===le){le!==0&&le===Nl&&(ih=!0),xe!==null&&(xe=xe.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var Ae=i,Ue=T;le=s;var yt=c;switch(Ue.tag){case 1:if(Ae=Ue.payload,typeof Ae=="function"){ye=Ae.call(yt,ye,le);break e}ye=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=Ue.payload,le=typeof Ae=="function"?Ae.call(yt,ye,le):Ae,le==null)break e;ye=v({},ye,le);break e;case 2:vi=!0}}le=T.callback,le!==null&&(i.flags|=64,me&&(i.flags|=8192),me=y.callbacks,me===null?y.callbacks=[le]:me.push(le))}else me={lane:le,tag:T.tag,payload:T.payload,callback:T.callback,next:null},xe===null?(ie=xe=me,G=ye):xe=xe.next=me,A|=le;if(T=T.next,T===null){if(T=y.shared.pending,T===null)break;me=T,T=me.next,me.next=null,y.lastBaseUpdate=me,y.shared.pending=null}}while(!0);xe===null&&(G=ye),y.baseState=G,y.firstBaseUpdate=ie,y.lastBaseUpdate=xe,_===null&&(y.shared.lanes=0),_i|=A,i.lanes=A,i.memoizedState=ye}}function k0(i,s){if(typeof i!="function")throw Error(a(191,i));i.call(s)}function D0(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)k0(c[i],s)}var Cl=te(null),Uu=te(0);function M0(i,s){i=Ta,oe(Uu,i),oe(Cl,s),Ta=i|s.baseLanes}function sh(){oe(Uu,Ta),oe(Cl,Cl.current)}function lh(){Ta=Uu.current,Y(Cl),Y(Uu)}var sn=te(null),En=null;function bi(i){var s=i.alternate;oe(Gt,Gt.current&1),oe(sn,i),En===null&&(s===null||Cl.current!==null||s.memoizedState!==null)&&(En=i)}function oh(i){oe(Gt,Gt.current),oe(sn,i),En===null&&(En=i)}function P0(i){i.tag===22?(oe(Gt,Gt.current),oe(sn,i),En===null&&(En=i)):yi()}function yi(){oe(Gt,Gt.current),oe(sn,sn.current)}function ln(i){Y(sn),En===i&&(En=null),Y(Gt)}var Gt=te(0);function Fu(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||pv(c)||hv(c)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Ea=0,Ve=null,xt=null,Kt=null,Gu=!1,El=!1,hs=!1,Hu=0,Go=0,Al=null,fT=0;function It(){throw Error(a(321))}function ch(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!nn(i[c],s[c]))return!1;return!0}function uh(i,s,c,m,y,_){return Ea=_,Ve=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,q.H=i===null||i.memoizedState===null?gN:wh,hs=!1,_=c(m,y),hs=!1,El&&(_=q0(s,c,m,y)),T0(i),_}function T0(i){q.H=Vo;var s=xt!==null&&xt.next!==null;if(Ea=0,Kt=xt=Ve=null,Gu=!1,Go=0,Al=null,s)throw Error(a(300));i===null||Wt||(i=i.dependencies,i!==null&&Tu(i)&&(Wt=!0))}function q0(i,s,c,m){Ve=i;var y=0;do{if(El&&(Al=null),Go=0,El=!1,25<=y)throw Error(a(301));if(y+=1,Kt=xt=null,i.updateQueue!=null){var _=i.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}q.H=xN,_=s(c,m)}while(El);return _}function pT(){var i=q.H,s=i.useState()[0];return s=typeof s.then=="function"?Ho(s):s,i=i.useState()[0],(xt!==null?xt.memoizedState:null)!==i&&(Ve.flags|=1024),s}function dh(){var i=Hu!==0;return Hu=0,i}function mh(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function fh(i){if(Gu){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Gu=!1}Ea=0,Kt=xt=Ve=null,El=!1,Go=Hu=0,Al=null}function Mr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kt===null?Ve.memoizedState=Kt=i:Kt=Kt.next=i,Kt}function Ht(){if(xt===null){var i=Ve.alternate;i=i!==null?i.memoizedState:null}else i=xt.next;var s=Kt===null?Ve.memoizedState:Kt.next;if(s!==null)Kt=s,xt=i;else{if(i===null)throw Ve.alternate===null?Error(a(467)):Error(a(310));xt=i,i={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},Kt===null?Ve.memoizedState=Kt=i:Kt=Kt.next=i}return Kt}function Qu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ho(i){var s=Go;return Go+=1,Al===null&&(Al=[]),i=C0(Al,i,s),s=Ve,(Kt===null?s.memoizedState:Kt.next)===null&&(s=s.alternate,q.H=s===null||s.memoizedState===null?gN:wh),i}function Vu(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Ho(i);if(i.$$typeof===w)return yr(i)}throw Error(a(438,String(i)))}function ph(i){var s=null,c=Ve.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var m=Ve.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(s={data:m.data.map(function(y){return y.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=Qu(),Ve.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),m=0;m<i;m++)c[m]=U;return s.index++,c}function Aa(i,s){return typeof s=="function"?s(i):s}function Yu(i){var s=Ht();return hh(s,xt,i)}function hh(i,s,c){var m=i.queue;if(m===null)throw Error(a(311));m.lastRenderedReducer=c;var y=i.baseQueue,_=m.pending;if(_!==null){if(y!==null){var A=y.next;y.next=_.next,_.next=A}s.baseQueue=y=_,m.pending=null}if(_=i.baseState,y===null)i.memoizedState=_;else{s=y.next;var T=A=null,G=null,ie=s,xe=!1;do{var ye=ie.lane&-536870913;if(ye!==ie.lane?(et&ye)===ye:(Ea&ye)===ye){var le=ie.revertLane;if(le===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),ye===Nl&&(xe=!0);else if((Ea&le)===le){ie=ie.next,le===Nl&&(xe=!0);continue}else ye={lane:0,revertLane:ie.revertLane,gesture:null,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},G===null?(T=G=ye,A=_):G=G.next=ye,Ve.lanes|=le,_i|=le;ye=ie.action,hs&&c(_,ye),_=ie.hasEagerState?ie.eagerState:c(_,ye)}else le={lane:ye,revertLane:ie.revertLane,gesture:ie.gesture,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null},G===null?(T=G=le,A=_):G=G.next=le,Ve.lanes|=ye,_i|=ye;ie=ie.next}while(ie!==null&&ie!==s);if(G===null?A=_:G.next=T,!nn(_,i.memoizedState)&&(Wt=!0,xe&&(c=_l,c!==null)))throw c;i.memoizedState=_,i.baseState=A,i.baseQueue=G,m.lastRenderedState=_}return y===null&&(m.lanes=0),[i.memoizedState,m.dispatch]}function vh(i){var s=Ht(),c=s.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=i;var m=c.dispatch,y=c.pending,_=s.memoizedState;if(y!==null){c.pending=null;var A=y=y.next;do _=i(_,A.action),A=A.next;while(A!==y);nn(_,s.memoizedState)||(Wt=!0),s.memoizedState=_,s.baseQueue===null&&(s.baseState=_),c.lastRenderedState=_}return[_,m]}function R0(i,s,c){var m=Ve,y=Ht(),_=at;if(_){if(c===void 0)throw Error(a(407));c=c()}else c=s();var A=!nn((xt||y).memoizedState,c);if(A&&(y.memoizedState=c,Wt=!0),y=y.queue,bh($0.bind(null,m,y,i),[i]),y.getSnapshot!==s||A||Kt!==null&&Kt.memoizedState.tag&1){if(m.flags|=2048,zl(9,{destroy:void 0},L0.bind(null,m,y,c,s),null),St===null)throw Error(a(349));_||(Ea&127)!==0||I0(m,s,c)}return c}function I0(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=Ve.updateQueue,s===null?(s=Qu(),Ve.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function L0(i,s,c,m){s.value=c,s.getSnapshot=m,B0(s)&&U0(i)}function $0(i,s,c){return c(function(){B0(s)&&U0(i)})}function B0(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!nn(i,c)}catch{return!0}}function U0(i){var s=ss(i,2);s!==null&&Kr(s,i,2)}function gh(i){var s=Mr();if(typeof i=="function"){var c=i;if(i=c(),hs){gt(!0);try{c()}finally{gt(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:i},s}function F0(i,s,c,m){return i.baseState=c,hh(i,xt,typeof m=="function"?m:Aa)}function hT(i,s,c,m,y){if(Xu(i))throw Error(a(485));if(i=s.action,i!==null){var _={payload:y,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){_.listeners.push(A)}};q.T!==null?c(!0):_.isTransition=!1,m(_),c=s.pending,c===null?(_.next=s.pending=_,G0(s,_)):(_.next=c.next,s.pending=c.next=_)}}function G0(i,s){var c=s.action,m=s.payload,y=i.state;if(s.isTransition){var _=q.T,A={};q.T=A;try{var T=c(y,m),G=q.S;G!==null&&G(A,T),H0(i,s,T)}catch(ie){xh(i,s,ie)}finally{_!==null&&A.types!==null&&(_.types=A.types),q.T=_}}else try{_=c(y,m),H0(i,s,_)}catch(ie){xh(i,s,ie)}}function H0(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(m){Q0(i,s,m)},function(m){return xh(i,s,m)}):Q0(i,s,c)}function Q0(i,s,c){s.status="fulfilled",s.value=c,V0(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,G0(i,c)))}function xh(i,s,c){var m=i.pending;if(i.pending=null,m!==null){m=m.next;do s.status="rejected",s.reason=c,V0(s),s=s.next;while(s!==m)}i.action=null}function V0(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function Y0(i,s){return s}function K0(i,s){if(at){var c=St.formState;if(c!==null){e:{var m=Ve;if(at){if(Et){t:{for(var y=Et,_=Cn;y.nodeType!==8;){if(!_){y=null;break t}if(y=An(y.nextSibling),y===null){y=null;break t}}_=y.data,y=_==="F!"||_==="F"?y:null}if(y){Et=An(y.nextSibling),m=y.data==="F!";break e}}pi(m)}m=!1}m&&(s=c[0])}}return c=Mr(),c.memoizedState=c.baseState=s,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Y0,lastRenderedState:s},c.queue=m,c=pN.bind(null,Ve,m),m.dispatch=c,m=gh(!1),_=Sh.bind(null,Ve,!1,m.queue),m=Mr(),y={state:s,dispatch:null,action:i,pending:null},m.queue=y,c=hT.bind(null,Ve,y,_,c),y.dispatch=c,m.memoizedState=i,[s,c,!1]}function W0(i){var s=Ht();return X0(s,xt,i)}function X0(i,s,c){if(s=hh(i,s,Y0)[0],i=Yu(Aa)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var m=Ho(s)}catch(A){throw A===Sl?Iu:A}else m=s;s=Ht();var y=s.queue,_=y.dispatch;return c!==s.memoizedState&&(Ve.flags|=2048,zl(9,{destroy:void 0},vT.bind(null,y,c),null)),[m,_,i]}function vT(i,s){i.action=s}function Z0(i){var s=Ht(),c=xt;if(c!==null)return X0(s,c,i);Ht(),s=s.memoizedState,c=Ht();var m=c.queue.dispatch;return c.memoizedState=i,[s,m,!1]}function zl(i,s,c,m){return i={tag:i,create:c,deps:m,inst:s,next:null},s=Ve.updateQueue,s===null&&(s=Qu(),Ve.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(m=c.next,c.next=i,i.next=m,s.lastEffect=i),i}function J0(){return Ht().memoizedState}function Ku(i,s,c,m){var y=Mr();Ve.flags|=i,y.memoizedState=zl(1|s,{destroy:void 0},c,m===void 0?null:m)}function Wu(i,s,c,m){var y=Ht();m=m===void 0?null:m;var _=y.memoizedState.inst;xt!==null&&m!==null&&ch(m,xt.memoizedState.deps)?y.memoizedState=zl(s,_,c,m):(Ve.flags|=i,y.memoizedState=zl(1|s,_,c,m))}function eN(i,s){Ku(8390656,8,i,s)}function bh(i,s){Wu(2048,8,i,s)}function gT(i){Ve.flags|=4;var s=Ve.updateQueue;if(s===null)s=Qu(),Ve.updateQueue=s,s.events=[i];else{var c=s.events;c===null?s.events=[i]:c.push(i)}}function tN(i){var s=Ht().memoizedState;return gT({ref:s,nextImpl:i}),function(){if((dt&2)!==0)throw Error(a(440));return s.impl.apply(void 0,arguments)}}function rN(i,s){return Wu(4,2,i,s)}function nN(i,s){return Wu(4,4,i,s)}function aN(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function iN(i,s,c){c=c!=null?c.concat([i]):null,Wu(4,4,aN.bind(null,s,i),c)}function yh(){}function sN(i,s){var c=Ht();s=s===void 0?null:s;var m=c.memoizedState;return s!==null&&ch(s,m[1])?m[0]:(c.memoizedState=[i,s],i)}function lN(i,s){var c=Ht();s=s===void 0?null:s;var m=c.memoizedState;if(s!==null&&ch(s,m[1]))return m[0];if(m=i(),hs){gt(!0);try{i()}finally{gt(!1)}}return c.memoizedState=[m,s],m}function jh(i,s,c){return c===void 0||(Ea&1073741824)!==0&&(et&261930)===0?i.memoizedState=s:(i.memoizedState=c,i=o_(),Ve.lanes|=i,_i|=i,c)}function oN(i,s,c,m){return nn(c,s)?c:Cl.current!==null?(i=jh(i,c,m),nn(i,s)||(Wt=!0),i):(Ea&42)===0||(Ea&1073741824)!==0&&(et&261930)===0?(Wt=!0,i.memoizedState=c):(i=o_(),Ve.lanes|=i,_i|=i,s)}function cN(i,s,c,m,y){var _=F.p;F.p=_!==0&&8>_?_:8;var A=q.T,T={};q.T=T,Sh(i,!1,s,c);try{var G=y(),ie=q.S;if(ie!==null&&ie(T,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var xe=mT(G,m);Qo(i,s,xe,un(i))}else Qo(i,s,m,un(i))}catch(ye){Qo(i,s,{then:function(){},status:"rejected",reason:ye},un())}finally{F.p=_,A!==null&&T.types!==null&&(A.types=T.types),q.T=A}}function xT(){}function Nh(i,s,c,m){if(i.tag!==5)throw Error(a(476));var y=uN(i).queue;cN(i,y,s,R,c===null?xT:function(){return dN(i),c(m)})}function uN(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:R,baseState:R,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:R},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function dN(i){var s=uN(i);s.next===null&&(s=i.alternate.memoizedState),Qo(i,s.next.queue,{},un())}function _h(){return yr(cc)}function mN(){return Ht().memoizedState}function fN(){return Ht().memoizedState}function bT(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=un();i=gi(c);var m=xi(s,i,c);m!==null&&(Kr(m,s,c),Bo(m,s,c)),s={cache:Zp()},i.payload=s;return}s=s.return}}function yT(i,s,c){var m=un();c={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Xu(i)?hN(s,c):(c=Bp(i,s,c,m),c!==null&&(Kr(c,i,m),vN(c,s,m)))}function pN(i,s,c){var m=un();Qo(i,s,c,m)}function Qo(i,s,c,m){var y={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Xu(i))hN(s,y);else{var _=i.alternate;if(i.lanes===0&&(_===null||_.lanes===0)&&(_=s.lastRenderedReducer,_!==null))try{var A=s.lastRenderedState,T=_(A,c);if(y.hasEagerState=!0,y.eagerState=T,nn(T,A))return ku(i,s,y,0),St===null&&Ou(),!1}catch{}if(c=Bp(i,s,y,m),c!==null)return Kr(c,i,m),vN(c,s,m),!0}return!1}function Sh(i,s,c,m){if(m={lane:2,revertLane:rv(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Xu(i)){if(s)throw Error(a(479))}else s=Bp(i,c,m,2),s!==null&&Kr(s,i,2)}function Xu(i){var s=i.alternate;return i===Ve||s!==null&&s===Ve}function hN(i,s){El=Gu=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function vN(i,s,c){if((c&4194048)!==0){var m=s.lanes;m&=i.pendingLanes,c|=m,s.lanes=c,jj(i,c)}}var Vo={readContext:yr,use:Vu,useCallback:It,useContext:It,useEffect:It,useImperativeHandle:It,useLayoutEffect:It,useInsertionEffect:It,useMemo:It,useReducer:It,useRef:It,useState:It,useDebugValue:It,useDeferredValue:It,useTransition:It,useSyncExternalStore:It,useId:It,useHostTransitionStatus:It,useFormState:It,useActionState:It,useOptimistic:It,useMemoCache:It,useCacheRefresh:It};Vo.useEffectEvent=It;var gN={readContext:yr,use:Vu,useCallback:function(i,s){return Mr().memoizedState=[i,s===void 0?null:s],i},useContext:yr,useEffect:eN,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,Ku(4194308,4,aN.bind(null,s,i),c)},useLayoutEffect:function(i,s){return Ku(4194308,4,i,s)},useInsertionEffect:function(i,s){Ku(4,2,i,s)},useMemo:function(i,s){var c=Mr();s=s===void 0?null:s;var m=i();if(hs){gt(!0);try{i()}finally{gt(!1)}}return c.memoizedState=[m,s],m},useReducer:function(i,s,c){var m=Mr();if(c!==void 0){var y=c(s);if(hs){gt(!0);try{c(s)}finally{gt(!1)}}}else y=s;return m.memoizedState=m.baseState=y,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:y},m.queue=i,i=i.dispatch=yT.bind(null,Ve,i),[m.memoizedState,i]},useRef:function(i){var s=Mr();return i={current:i},s.memoizedState=i},useState:function(i){i=gh(i);var s=i.queue,c=pN.bind(null,Ve,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:yh,useDeferredValue:function(i,s){var c=Mr();return jh(c,i,s)},useTransition:function(){var i=gh(!1);return i=cN.bind(null,Ve,i.queue,!0,!1),Mr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var m=Ve,y=Mr();if(at){if(c===void 0)throw Error(a(407));c=c()}else{if(c=s(),St===null)throw Error(a(349));(et&127)!==0||I0(m,s,c)}y.memoizedState=c;var _={value:c,getSnapshot:s};return y.queue=_,eN($0.bind(null,m,_,i),[i]),m.flags|=2048,zl(9,{destroy:void 0},L0.bind(null,m,_,c,s),null),c},useId:function(){var i=Mr(),s=St.identifierPrefix;if(at){var c=ra,m=ta;c=(m&~(1<<32-qt(m)-1)).toString(32)+c,s="_"+s+"R_"+c,c=Hu++,0<c&&(s+="H"+c.toString(32)),s+="_"}else c=fT++,s="_"+s+"r_"+c.toString(32)+"_";return i.memoizedState=s},useHostTransitionStatus:_h,useFormState:K0,useActionState:K0,useOptimistic:function(i){var s=Mr();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=Sh.bind(null,Ve,!0,c),c.dispatch=s,[i,s]},useMemoCache:ph,useCacheRefresh:function(){return Mr().memoizedState=bT.bind(null,Ve)},useEffectEvent:function(i){var s=Mr(),c={impl:i};return s.memoizedState=c,function(){if((dt&2)!==0)throw Error(a(440));return c.impl.apply(void 0,arguments)}}},wh={readContext:yr,use:Vu,useCallback:sN,useContext:yr,useEffect:bh,useImperativeHandle:iN,useInsertionEffect:rN,useLayoutEffect:nN,useMemo:lN,useReducer:Yu,useRef:J0,useState:function(){return Yu(Aa)},useDebugValue:yh,useDeferredValue:function(i,s){var c=Ht();return oN(c,xt.memoizedState,i,s)},useTransition:function(){var i=Yu(Aa)[0],s=Ht().memoizedState;return[typeof i=="boolean"?i:Ho(i),s]},useSyncExternalStore:R0,useId:mN,useHostTransitionStatus:_h,useFormState:W0,useActionState:W0,useOptimistic:function(i,s){var c=Ht();return F0(c,xt,i,s)},useMemoCache:ph,useCacheRefresh:fN};wh.useEffectEvent=tN;var xN={readContext:yr,use:Vu,useCallback:sN,useContext:yr,useEffect:bh,useImperativeHandle:iN,useInsertionEffect:rN,useLayoutEffect:nN,useMemo:lN,useReducer:vh,useRef:J0,useState:function(){return vh(Aa)},useDebugValue:yh,useDeferredValue:function(i,s){var c=Ht();return xt===null?jh(c,i,s):oN(c,xt.memoizedState,i,s)},useTransition:function(){var i=vh(Aa)[0],s=Ht().memoizedState;return[typeof i=="boolean"?i:Ho(i),s]},useSyncExternalStore:R0,useId:mN,useHostTransitionStatus:_h,useFormState:Z0,useActionState:Z0,useOptimistic:function(i,s){var c=Ht();return xt!==null?F0(c,xt,i,s):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:ph,useCacheRefresh:fN};xN.useEffectEvent=tN;function Ch(i,s,c,m){s=i.memoizedState,c=c(m,s),c=c==null?s:v({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var Eh={enqueueSetState:function(i,s,c){i=i._reactInternals;var m=un(),y=gi(m);y.payload=s,c!=null&&(y.callback=c),s=xi(i,y,m),s!==null&&(Kr(s,i,m),Bo(s,i,m))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var m=un(),y=gi(m);y.tag=1,y.payload=s,c!=null&&(y.callback=c),s=xi(i,y,m),s!==null&&(Kr(s,i,m),Bo(s,i,m))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=un(),m=gi(c);m.tag=2,s!=null&&(m.callback=s),s=xi(i,m,c),s!==null&&(Kr(s,i,c),Bo(s,i,c))}};function bN(i,s,c,m,y,_,A){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(m,_,A):s.prototype&&s.prototype.isPureReactComponent?!Mo(c,m)||!Mo(y,_):!0}function yN(i,s,c,m){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,m),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,m),s.state!==i&&Eh.enqueueReplaceState(s,s.state,null)}function vs(i,s){var c=s;if("ref"in s){c={};for(var m in s)m!=="ref"&&(c[m]=s[m])}if(i=i.defaultProps){c===s&&(c=v({},c));for(var y in i)c[y]===void 0&&(c[y]=i[y])}return c}function jN(i){zu(i)}function NN(i){console.error(i)}function _N(i){zu(i)}function Zu(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(m){setTimeout(function(){throw m})}}function SN(i,s,c){try{var m=i.onCaughtError;m(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Ah(i,s,c){return c=gi(c),c.tag=3,c.payload={element:null},c.callback=function(){Zu(i,s)},c}function wN(i){return i=gi(i),i.tag=3,i}function CN(i,s,c,m){var y=c.type.getDerivedStateFromError;if(typeof y=="function"){var _=m.value;i.payload=function(){return y(_)},i.callback=function(){SN(s,c,m)}}var A=c.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(i.callback=function(){SN(s,c,m),typeof y!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var T=m.stack;this.componentDidCatch(m.value,{componentStack:T!==null?T:""})})}function jT(i,s,c,m,y){if(c.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(s=c.alternate,s!==null&&jl(s,c,y,!0),c=sn.current,c!==null){switch(c.tag){case 31:case 13:return En===null?ud():c.alternate===null&&Lt===0&&(Lt=3),c.flags&=-257,c.flags|=65536,c.lanes=y,m===Lu?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([m]):s.add(m),Jh(i,m,y)),!1;case 22:return c.flags|=65536,m===Lu?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([m])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([m]):c.add(m)),Jh(i,m,y)),!1}throw Error(a(435,c.tag))}return Jh(i,m,y),ud(),!1}if(at)return s=sn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=y,m!==Vp&&(i=Error(a(422),{cause:m}),qo(_n(i,c)))):(m!==Vp&&(s=Error(a(423),{cause:m}),qo(_n(s,c))),i=i.current.alternate,i.flags|=65536,y&=-y,i.lanes|=y,m=_n(m,c),y=Ah(i.stateNode,m,y),ah(i,y),Lt!==4&&(Lt=2)),!1;var _=Error(a(520),{cause:m});if(_=_n(_,c),tc===null?tc=[_]:tc.push(_),Lt!==4&&(Lt=2),s===null)return!0;m=_n(m,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=y&-y,c.lanes|=i,i=Ah(c.stateNode,m,i),ah(c,i),!1;case 1:if(s=c.type,_=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Si===null||!Si.has(_))))return c.flags|=65536,y&=-y,c.lanes|=y,y=wN(y),CN(y,i,c,m),ah(c,y),!1}c=c.return}while(c!==null);return!1}var zh=Error(a(461)),Wt=!1;function jr(i,s,c,m){s.child=i===null?O0(s,null,c,m):ps(s,i.child,c,m)}function EN(i,s,c,m,y){c=c.render;var _=s.ref;if("ref"in m){var A={};for(var T in m)T!=="ref"&&(A[T]=m[T])}else A=m;return us(s),m=uh(i,s,c,A,_,y),T=dh(),i!==null&&!Wt?(mh(i,s,y),za(i,s,y)):(at&&T&&Hp(s),s.flags|=1,jr(i,s,m,y),s.child)}function AN(i,s,c,m,y){if(i===null){var _=c.type;return typeof _=="function"&&!Up(_)&&_.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=_,zN(i,s,_,m,y)):(i=Mu(c.type,null,m,s,s.mode,y),i.ref=s.ref,i.return=s,s.child=i)}if(_=i.child,!Rh(i,y)){var A=_.memoizedProps;if(c=c.compare,c=c!==null?c:Mo,c(A,m)&&i.ref===s.ref)return za(i,s,y)}return s.flags|=1,i=_a(_,m),i.ref=s.ref,i.return=s,s.child=i}function zN(i,s,c,m,y){if(i!==null){var _=i.memoizedProps;if(Mo(_,m)&&i.ref===s.ref)if(Wt=!1,s.pendingProps=m=_,Rh(i,y))(i.flags&131072)!==0&&(Wt=!0);else return s.lanes=i.lanes,za(i,s,y)}return Oh(i,s,c,m,y)}function ON(i,s,c,m){var y=m.children,_=i!==null?i.memoizedState:null;if(i===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((s.flags&128)!==0){if(_=_!==null?_.baseLanes|c:c,i!==null){for(m=s.child=i.child,y=0;m!==null;)y=y|m.lanes|m.childLanes,m=m.sibling;m=y&~_}else m=0,s.child=null;return kN(i,s,_,c,m)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Ru(s,_!==null?_.cachePool:null),_!==null?M0(s,_):sh(),P0(s);else return m=s.lanes=536870912,kN(i,s,_!==null?_.baseLanes|c:c,c,m)}else _!==null?(Ru(s,_.cachePool),M0(s,_),yi(),s.memoizedState=null):(i!==null&&Ru(s,null),sh(),yi());return jr(i,s,y,c),s.child}function Yo(i,s){return i!==null&&i.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function kN(i,s,c,m,y){var _=eh();return _=_===null?null:{parent:Yt._currentValue,pool:_},s.memoizedState={baseLanes:c,cachePool:_},i!==null&&Ru(s,null),sh(),P0(s),i!==null&&jl(i,s,m,!0),s.childLanes=y,null}function Ju(i,s){return s=td({mode:s.mode,children:s.children},i.mode),s.ref=i.ref,i.child=s,s.return=i,s}function DN(i,s,c){return ps(s,i.child,null,c),i=Ju(s,s.pendingProps),i.flags|=2,ln(s),s.memoizedState=null,i}function NT(i,s,c){var m=s.pendingProps,y=(s.flags&128)!==0;if(s.flags&=-129,i===null){if(at){if(m.mode==="hidden")return i=Ju(s,m),s.lanes=536870912,Yo(null,i);if(oh(s),(i=Et)?(i=G_(i,Cn),i=i!==null&&i.data==="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:mi!==null?{id:ta,overflow:ra}:null,retryLane:536870912,hydrationErrors:null},c=h0(i),c.return=s,s.child=c,br=s,Et=null)):i=null,i===null)throw pi(s);return s.lanes=536870912,null}return Ju(s,m)}var _=i.memoizedState;if(_!==null){var A=_.dehydrated;if(oh(s),y)if(s.flags&256)s.flags&=-257,s=DN(i,s,c);else if(s.memoizedState!==null)s.child=i.child,s.flags|=128,s=null;else throw Error(a(558));else if(Wt||jl(i,s,c,!1),y=(c&i.childLanes)!==0,Wt||y){if(m=St,m!==null&&(A=Nj(m,c),A!==0&&A!==_.retryLane))throw _.retryLane=A,ss(i,A),Kr(m,i,A),zh;ud(),s=DN(i,s,c)}else i=_.treeContext,Et=An(A.nextSibling),br=s,at=!0,fi=null,Cn=!1,i!==null&&x0(s,i),s=Ju(s,m),s.flags|=4096;return s}return i=_a(i.child,{mode:m.mode,children:m.children}),i.ref=s.ref,s.child=i,i.return=s,i}function ed(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(a(284));(i===null||i.ref!==c)&&(s.flags|=4194816)}}function Oh(i,s,c,m,y){return us(s),c=uh(i,s,c,m,void 0,y),m=dh(),i!==null&&!Wt?(mh(i,s,y),za(i,s,y)):(at&&m&&Hp(s),s.flags|=1,jr(i,s,c,y),s.child)}function MN(i,s,c,m,y,_){return us(s),s.updateQueue=null,c=q0(s,m,c,y),T0(i),m=dh(),i!==null&&!Wt?(mh(i,s,_),za(i,s,_)):(at&&m&&Hp(s),s.flags|=1,jr(i,s,c,_),s.child)}function PN(i,s,c,m,y){if(us(s),s.stateNode===null){var _=gl,A=c.contextType;typeof A=="object"&&A!==null&&(_=yr(A)),_=new c(m,_),s.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Eh,s.stateNode=_,_._reactInternals=s,_=s.stateNode,_.props=m,_.state=s.memoizedState,_.refs={},rh(s),A=c.contextType,_.context=typeof A=="object"&&A!==null?yr(A):gl,_.state=s.memoizedState,A=c.getDerivedStateFromProps,typeof A=="function"&&(Ch(s,c,A,m),_.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(A=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),A!==_.state&&Eh.enqueueReplaceState(_,_.state,null),Fo(s,m,_,y),Uo(),_.state=s.memoizedState),typeof _.componentDidMount=="function"&&(s.flags|=4194308),m=!0}else if(i===null){_=s.stateNode;var T=s.memoizedProps,G=vs(c,T);_.props=G;var ie=_.context,xe=c.contextType;A=gl,typeof xe=="object"&&xe!==null&&(A=yr(xe));var ye=c.getDerivedStateFromProps;xe=typeof ye=="function"||typeof _.getSnapshotBeforeUpdate=="function",T=s.pendingProps!==T,xe||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(T||ie!==A)&&yN(s,_,m,A),vi=!1;var le=s.memoizedState;_.state=le,Fo(s,m,_,y),Uo(),ie=s.memoizedState,T||le!==ie||vi?(typeof ye=="function"&&(Ch(s,c,ye,m),ie=s.memoizedState),(G=vi||bN(s,c,G,m,le,ie,A))?(xe||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(s.flags|=4194308)):(typeof _.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=m,s.memoizedState=ie),_.props=m,_.state=ie,_.context=A,m=G):(typeof _.componentDidMount=="function"&&(s.flags|=4194308),m=!1)}else{_=s.stateNode,nh(i,s),A=s.memoizedProps,xe=vs(c,A),_.props=xe,ye=s.pendingProps,le=_.context,ie=c.contextType,G=gl,typeof ie=="object"&&ie!==null&&(G=yr(ie)),T=c.getDerivedStateFromProps,(ie=typeof T=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(A!==ye||le!==G)&&yN(s,_,m,G),vi=!1,le=s.memoizedState,_.state=le,Fo(s,m,_,y),Uo();var me=s.memoizedState;A!==ye||le!==me||vi||i!==null&&i.dependencies!==null&&Tu(i.dependencies)?(typeof T=="function"&&(Ch(s,c,T,m),me=s.memoizedState),(xe=vi||bN(s,c,xe,m,le,me,G)||i!==null&&i.dependencies!==null&&Tu(i.dependencies))?(ie||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(m,me,G),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(m,me,G)),typeof _.componentDidUpdate=="function"&&(s.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof _.componentDidUpdate!="function"||A===i.memoizedProps&&le===i.memoizedState||(s.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&le===i.memoizedState||(s.flags|=1024),s.memoizedProps=m,s.memoizedState=me),_.props=m,_.state=me,_.context=G,m=xe):(typeof _.componentDidUpdate!="function"||A===i.memoizedProps&&le===i.memoizedState||(s.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&le===i.memoizedState||(s.flags|=1024),m=!1)}return _=m,ed(i,s),m=(s.flags&128)!==0,_||m?(_=s.stateNode,c=m&&typeof c.getDerivedStateFromError!="function"?null:_.render(),s.flags|=1,i!==null&&m?(s.child=ps(s,i.child,null,y),s.child=ps(s,null,c,y)):jr(i,s,c,y),s.memoizedState=_.state,i=s.child):i=za(i,s,y),i}function TN(i,s,c,m){return os(),s.flags|=256,jr(i,s,c,m),s.child}var kh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dh(i){return{baseLanes:i,cachePool:S0()}}function Mh(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=cn),i}function qN(i,s,c){var m=s.pendingProps,y=!1,_=(s.flags&128)!==0,A;if((A=_)||(A=i!==null&&i.memoizedState===null?!1:(Gt.current&2)!==0),A&&(y=!0,s.flags&=-129),A=(s.flags&32)!==0,s.flags&=-33,i===null){if(at){if(y?bi(s):yi(),(i=Et)?(i=G_(i,Cn),i=i!==null&&i.data!=="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:mi!==null?{id:ta,overflow:ra}:null,retryLane:536870912,hydrationErrors:null},c=h0(i),c.return=s,s.child=c,br=s,Et=null)):i=null,i===null)throw pi(s);return hv(i)?s.lanes=32:s.lanes=536870912,null}var T=m.children;return m=m.fallback,y?(yi(),y=s.mode,T=td({mode:"hidden",children:T},y),m=ls(m,y,c,null),T.return=s,m.return=s,T.sibling=m,s.child=T,m=s.child,m.memoizedState=Dh(c),m.childLanes=Mh(i,A,c),s.memoizedState=kh,Yo(null,m)):(bi(s),Ph(s,T))}var G=i.memoizedState;if(G!==null&&(T=G.dehydrated,T!==null)){if(_)s.flags&256?(bi(s),s.flags&=-257,s=Th(i,s,c)):s.memoizedState!==null?(yi(),s.child=i.child,s.flags|=128,s=null):(yi(),T=m.fallback,y=s.mode,m=td({mode:"visible",children:m.children},y),T=ls(T,y,c,null),T.flags|=2,m.return=s,T.return=s,m.sibling=T,s.child=m,ps(s,i.child,null,c),m=s.child,m.memoizedState=Dh(c),m.childLanes=Mh(i,A,c),s.memoizedState=kh,s=Yo(null,m));else if(bi(s),hv(T)){if(A=T.nextSibling&&T.nextSibling.dataset,A)var ie=A.dgst;A=ie,m=Error(a(419)),m.stack="",m.digest=A,qo({value:m,source:null,stack:null}),s=Th(i,s,c)}else if(Wt||jl(i,s,c,!1),A=(c&i.childLanes)!==0,Wt||A){if(A=St,A!==null&&(m=Nj(A,c),m!==0&&m!==G.retryLane))throw G.retryLane=m,ss(i,m),Kr(A,i,m),zh;pv(T)||ud(),s=Th(i,s,c)}else pv(T)?(s.flags|=192,s.child=i.child,s=null):(i=G.treeContext,Et=An(T.nextSibling),br=s,at=!0,fi=null,Cn=!1,i!==null&&x0(s,i),s=Ph(s,m.children),s.flags|=4096);return s}return y?(yi(),T=m.fallback,y=s.mode,G=i.child,ie=G.sibling,m=_a(G,{mode:"hidden",children:m.children}),m.subtreeFlags=G.subtreeFlags&65011712,ie!==null?T=_a(ie,T):(T=ls(T,y,c,null),T.flags|=2),T.return=s,m.return=s,m.sibling=T,s.child=m,Yo(null,m),m=s.child,T=i.child.memoizedState,T===null?T=Dh(c):(y=T.cachePool,y!==null?(G=Yt._currentValue,y=y.parent!==G?{parent:G,pool:G}:y):y=S0(),T={baseLanes:T.baseLanes|c,cachePool:y}),m.memoizedState=T,m.childLanes=Mh(i,A,c),s.memoizedState=kh,Yo(i.child,m)):(bi(s),c=i.child,i=c.sibling,c=_a(c,{mode:"visible",children:m.children}),c.return=s,c.sibling=null,i!==null&&(A=s.deletions,A===null?(s.deletions=[i],s.flags|=16):A.push(i)),s.child=c,s.memoizedState=null,c)}function Ph(i,s){return s=td({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function td(i,s){return i=an(22,i,null,s),i.lanes=0,i}function Th(i,s,c){return ps(s,i.child,null,c),i=Ph(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function RN(i,s,c){i.lanes|=s;var m=i.alternate;m!==null&&(m.lanes|=s),Wp(i.return,s,c)}function qh(i,s,c,m,y,_){var A=i.memoizedState;A===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:m,tail:c,tailMode:y,treeForkCount:_}:(A.isBackwards=s,A.rendering=null,A.renderingStartTime=0,A.last=m,A.tail=c,A.tailMode=y,A.treeForkCount=_)}function IN(i,s,c){var m=s.pendingProps,y=m.revealOrder,_=m.tail;m=m.children;var A=Gt.current,T=(A&2)!==0;if(T?(A=A&1|2,s.flags|=128):A&=1,oe(Gt,A),jr(i,s,m,c),m=at?To:0,!T&&i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&RN(i,c,s);else if(i.tag===19)RN(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(y){case"forwards":for(c=s.child,y=null;c!==null;)i=c.alternate,i!==null&&Fu(i)===null&&(y=c),c=c.sibling;c=y,c===null?(y=s.child,s.child=null):(y=c.sibling,c.sibling=null),qh(s,!1,y,c,_,m);break;case"backwards":case"unstable_legacy-backwards":for(c=null,y=s.child,s.child=null;y!==null;){if(i=y.alternate,i!==null&&Fu(i)===null){s.child=y;break}i=y.sibling,y.sibling=c,c=y,y=i}qh(s,!0,c,null,_,m);break;case"together":qh(s,!1,null,null,void 0,m);break;default:s.memoizedState=null}return s.child}function za(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),_i|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(jl(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(a(153));if(s.child!==null){for(i=s.child,c=_a(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=_a(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function Rh(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Tu(i)))}function _T(i,s,c){switch(s.tag){case 3:Me(s,s.stateNode.containerInfo),hi(s,Yt,i.memoizedState.cache),os();break;case 27:case 5:Z(s);break;case 4:Me(s,s.stateNode.containerInfo);break;case 10:hi(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,oh(s),null;break;case 13:var m=s.memoizedState;if(m!==null)return m.dehydrated!==null?(bi(s),s.flags|=128,null):(c&s.child.childLanes)!==0?qN(i,s,c):(bi(s),i=za(i,s,c),i!==null?i.sibling:null);bi(s);break;case 19:var y=(i.flags&128)!==0;if(m=(c&s.childLanes)!==0,m||(jl(i,s,c,!1),m=(c&s.childLanes)!==0),y){if(m)return IN(i,s,c);s.flags|=128}if(y=s.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),oe(Gt,Gt.current),m)break;return null;case 22:return s.lanes=0,ON(i,s,c,s.pendingProps);case 24:hi(s,Yt,i.memoizedState.cache)}return za(i,s,c)}function LN(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)Wt=!0;else{if(!Rh(i,c)&&(s.flags&128)===0)return Wt=!1,_T(i,s,c);Wt=(i.flags&131072)!==0}else Wt=!1,at&&(s.flags&1048576)!==0&&g0(s,To,s.index);switch(s.lanes=0,s.tag){case 16:e:{var m=s.pendingProps;if(i=ms(s.elementType),s.type=i,typeof i=="function")Up(i)?(m=vs(i,m),s.tag=1,s=PN(null,s,i,m,c)):(s.tag=0,s=Oh(null,s,i,m,c));else{if(i!=null){var y=i.$$typeof;if(y===z){s.tag=11,s=EN(null,s,i,m,c);break e}else if(y===P){s.tag=14,s=AN(null,s,i,m,c);break e}}throw s=se(i)||i,Error(a(306,s,""))}}return s;case 0:return Oh(i,s,s.type,s.pendingProps,c);case 1:return m=s.type,y=vs(m,s.pendingProps),PN(i,s,m,y,c);case 3:e:{if(Me(s,s.stateNode.containerInfo),i===null)throw Error(a(387));m=s.pendingProps;var _=s.memoizedState;y=_.element,nh(i,s),Fo(s,m,null,c);var A=s.memoizedState;if(m=A.cache,hi(s,Yt,m),m!==_.cache&&Xp(s,[Yt],c,!0),Uo(),m=A.element,_.isDehydrated)if(_={element:m,isDehydrated:!1,cache:A.cache},s.updateQueue.baseState=_,s.memoizedState=_,s.flags&256){s=TN(i,s,m,c);break e}else if(m!==y){y=_n(Error(a(424)),s),qo(y),s=TN(i,s,m,c);break e}else for(i=s.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,Et=An(i.firstChild),br=s,at=!0,fi=null,Cn=!0,c=O0(s,null,m,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(os(),m===y){s=za(i,s,c);break e}jr(i,s,m,c)}s=s.child}return s;case 26:return ed(i,s),i===null?(c=W_(s.type,null,s.pendingProps,null))?s.memoizedState=c:at||(c=s.type,i=s.pendingProps,m=gd(Q.current).createElement(c),m[xr]=s,m[Fr]=i,Nr(m,c,i),sr(m),s.stateNode=m):s.memoizedState=W_(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Z(s),i===null&&at&&(m=s.stateNode=V_(s.type,s.pendingProps,Q.current),br=s,Cn=!0,y=Et,Ai(s.type)?(vv=y,Et=An(m.firstChild)):Et=y),jr(i,s,s.pendingProps.children,c),ed(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&at&&((y=m=Et)&&(m=JT(m,s.type,s.pendingProps,Cn),m!==null?(s.stateNode=m,br=s,Et=An(m.firstChild),Cn=!1,y=!0):y=!1),y||pi(s)),Z(s),y=s.type,_=s.pendingProps,A=i!==null?i.memoizedProps:null,m=_.children,dv(y,_)?m=null:A!==null&&dv(y,A)&&(s.flags|=32),s.memoizedState!==null&&(y=uh(i,s,pT,null,null,c),cc._currentValue=y),ed(i,s),jr(i,s,m,c),s.child;case 6:return i===null&&at&&((i=c=Et)&&(c=eq(c,s.pendingProps,Cn),c!==null?(s.stateNode=c,br=s,Et=null,i=!0):i=!1),i||pi(s)),null;case 13:return qN(i,s,c);case 4:return Me(s,s.stateNode.containerInfo),m=s.pendingProps,i===null?s.child=ps(s,null,m,c):jr(i,s,m,c),s.child;case 11:return EN(i,s,s.type,s.pendingProps,c);case 7:return jr(i,s,s.pendingProps,c),s.child;case 8:return jr(i,s,s.pendingProps.children,c),s.child;case 12:return jr(i,s,s.pendingProps.children,c),s.child;case 10:return m=s.pendingProps,hi(s,s.type,m.value),jr(i,s,m.children,c),s.child;case 9:return y=s.type._context,m=s.pendingProps.children,us(s),y=yr(y),m=m(y),s.flags|=1,jr(i,s,m,c),s.child;case 14:return AN(i,s,s.type,s.pendingProps,c);case 15:return zN(i,s,s.type,s.pendingProps,c);case 19:return IN(i,s,c);case 31:return NT(i,s,c);case 22:return ON(i,s,c,s.pendingProps);case 24:return us(s),m=yr(Yt),i===null?(y=eh(),y===null&&(y=St,_=Zp(),y.pooledCache=_,_.refCount++,_!==null&&(y.pooledCacheLanes|=c),y=_),s.memoizedState={parent:m,cache:y},rh(s),hi(s,Yt,y)):((i.lanes&c)!==0&&(nh(i,s),Fo(s,null,null,c),Uo()),y=i.memoizedState,_=s.memoizedState,y.parent!==m?(y={parent:m,cache:m},s.memoizedState=y,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=y),hi(s,Yt,m)):(m=_.cache,hi(s,Yt,m),m!==y.cache&&Xp(s,[Yt],c,!0))),jr(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(a(156,s.tag))}function Oa(i){i.flags|=4}function Ih(i,s,c,m,y){if((s=(i.mode&32)!==0)&&(s=!1),s){if(i.flags|=16777216,(y&335544128)===y)if(i.stateNode.complete)i.flags|=8192;else if(m_())i.flags|=8192;else throw fs=Lu,th}else i.flags&=-16777217}function $N(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!t1(s))if(m_())i.flags|=8192;else throw fs=Lu,th}function rd(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?$e():536870912,i.lanes|=s,Ml|=s)}function Ko(i,s){if(!at)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:m.sibling=null}}function At(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,m=0;if(s)for(var y=i.child;y!==null;)c|=y.lanes|y.childLanes,m|=y.subtreeFlags&65011712,m|=y.flags&65011712,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)c|=y.lanes|y.childLanes,m|=y.subtreeFlags,m|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=m,i.childLanes=c,s}function ST(i,s,c){var m=s.pendingProps;switch(Qp(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(s),null;case 1:return At(s),null;case 3:return c=s.stateNode,m=null,i!==null&&(m=i.memoizedState.cache),s.memoizedState.cache!==m&&(s.flags|=2048),Ca(Yt),ce(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(yl(s)?Oa(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Yp())),At(s),null;case 26:var y=s.type,_=s.memoizedState;return i===null?(Oa(s),_!==null?(At(s),$N(s,_)):(At(s),Ih(s,y,null,m,c))):_?_!==i.memoizedState?(Oa(s),At(s),$N(s,_)):(At(s),s.flags&=-16777217):(i=i.memoizedProps,i!==m&&Oa(s),At(s),Ih(s,y,i,m,c)),null;case 27:if(H(s),c=Q.current,y=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==m&&Oa(s);else{if(!m){if(s.stateNode===null)throw Error(a(166));return At(s),null}i=he.current,yl(s)?b0(s):(i=V_(y,m,c),s.stateNode=i,Oa(s))}return At(s),null;case 5:if(H(s),y=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==m&&Oa(s);else{if(!m){if(s.stateNode===null)throw Error(a(166));return At(s),null}if(_=he.current,yl(s))b0(s);else{var A=gd(Q.current);switch(_){case 1:_=A.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:_=A.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":_=A.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":_=A.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":_=A.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof m.is=="string"?A.createElement("select",{is:m.is}):A.createElement("select"),m.multiple?_.multiple=!0:m.size&&(_.size=m.size);break;default:_=typeof m.is=="string"?A.createElement(y,{is:m.is}):A.createElement(y)}}_[xr]=s,_[Fr]=m;e:for(A=s.child;A!==null;){if(A.tag===5||A.tag===6)_.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===s)break e;for(;A.sibling===null;){if(A.return===null||A.return===s)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}s.stateNode=_;e:switch(Nr(_,y,m),y){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&Oa(s)}}return At(s),Ih(s,s.type,i===null?null:i.memoizedProps,s.pendingProps,c),null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==m&&Oa(s);else{if(typeof m!="string"&&s.stateNode===null)throw Error(a(166));if(i=Q.current,yl(s)){if(i=s.stateNode,c=s.memoizedProps,m=null,y=br,y!==null)switch(y.tag){case 27:case 5:m=y.memoizedProps}i[xr]=s,i=!!(i.nodeValue===c||m!==null&&m.suppressHydrationWarning===!0||q_(i.nodeValue,c)),i||pi(s,!0)}else i=gd(i).createTextNode(m),i[xr]=s,s.stateNode=i}return At(s),null;case 31:if(c=s.memoizedState,i===null||i.memoizedState!==null){if(m=yl(s),c!==null){if(i===null){if(!m)throw Error(a(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(557));i[xr]=s}else os(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;At(s),i=!1}else c=Yp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=c),i=!0;if(!i)return s.flags&256?(ln(s),s):(ln(s),null);if((s.flags&128)!==0)throw Error(a(558))}return At(s),null;case 13:if(m=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(y=yl(s),m!==null&&m.dehydrated!==null){if(i===null){if(!y)throw Error(a(318));if(y=s.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(a(317));y[xr]=s}else os(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;At(s),y=!1}else y=Yp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=y),y=!0;if(!y)return s.flags&256?(ln(s),s):(ln(s),null)}return ln(s),(s.flags&128)!==0?(s.lanes=c,s):(c=m!==null,i=i!==null&&i.memoizedState!==null,c&&(m=s.child,y=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(y=m.alternate.memoizedState.cachePool.pool),_=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(_=m.memoizedState.cachePool.pool),_!==y&&(m.flags|=2048)),c!==i&&c&&(s.child.flags|=8192),rd(s,s.updateQueue),At(s),null);case 4:return ce(),i===null&&sv(s.stateNode.containerInfo),At(s),null;case 10:return Ca(s.type),At(s),null;case 19:if(Y(Gt),m=s.memoizedState,m===null)return At(s),null;if(y=(s.flags&128)!==0,_=m.rendering,_===null)if(y)Ko(m,!1);else{if(Lt!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(_=Fu(i),_!==null){for(s.flags|=128,Ko(m,!1),i=_.updateQueue,s.updateQueue=i,rd(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)p0(c,i),c=c.sibling;return oe(Gt,Gt.current&1|2),at&&Sa(s,m.treeForkCount),s.child}i=i.sibling}m.tail!==null&&Re()>ld&&(s.flags|=128,y=!0,Ko(m,!1),s.lanes=4194304)}else{if(!y)if(i=Fu(_),i!==null){if(s.flags|=128,y=!0,i=i.updateQueue,s.updateQueue=i,rd(s,i),Ko(m,!0),m.tail===null&&m.tailMode==="hidden"&&!_.alternate&&!at)return At(s),null}else 2*Re()-m.renderingStartTime>ld&&c!==536870912&&(s.flags|=128,y=!0,Ko(m,!1),s.lanes=4194304);m.isBackwards?(_.sibling=s.child,s.child=_):(i=m.last,i!==null?i.sibling=_:s.child=_,m.last=_)}return m.tail!==null?(i=m.tail,m.rendering=i,m.tail=i.sibling,m.renderingStartTime=Re(),i.sibling=null,c=Gt.current,oe(Gt,y?c&1|2:c&1),at&&Sa(s,m.treeForkCount),i):(At(s),null);case 22:case 23:return ln(s),lh(),m=s.memoizedState!==null,i!==null?i.memoizedState!==null!==m&&(s.flags|=8192):m&&(s.flags|=8192),m?(c&536870912)!==0&&(s.flags&128)===0&&(At(s),s.subtreeFlags&6&&(s.flags|=8192)):At(s),c=s.updateQueue,c!==null&&rd(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),m=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(m=s.memoizedState.cachePool.pool),m!==c&&(s.flags|=2048),i!==null&&Y(ds),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Ca(Yt),At(s),null;case 25:return null;case 30:return null}throw Error(a(156,s.tag))}function wT(i,s){switch(Qp(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Ca(Yt),ce(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return H(s),null;case 31:if(s.memoizedState!==null){if(ln(s),s.alternate===null)throw Error(a(340));os()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 13:if(ln(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(a(340));os()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return Y(Gt),null;case 4:return ce(),null;case 10:return Ca(s.type),null;case 22:case 23:return ln(s),lh(),i!==null&&Y(ds),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Ca(Yt),null;case 25:return null;default:return null}}function BN(i,s){switch(Qp(s),s.tag){case 3:Ca(Yt),ce();break;case 26:case 27:case 5:H(s);break;case 4:ce();break;case 31:s.memoizedState!==null&&ln(s);break;case 13:ln(s);break;case 19:Y(Gt);break;case 10:Ca(s.type);break;case 22:case 23:ln(s),lh(),i!==null&&Y(ds);break;case 24:Ca(Yt)}}function Wo(i,s){try{var c=s.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var y=m.next;c=y;do{if((c.tag&i)===i){m=void 0;var _=c.create,A=c.inst;m=_(),A.destroy=m}c=c.next}while(c!==y)}}catch(T){pt(s,s.return,T)}}function ji(i,s,c){try{var m=s.updateQueue,y=m!==null?m.lastEffect:null;if(y!==null){var _=y.next;m=_;do{if((m.tag&i)===i){var A=m.inst,T=A.destroy;if(T!==void 0){A.destroy=void 0,y=s;var G=c,ie=T;try{ie()}catch(xe){pt(y,G,xe)}}}m=m.next}while(m!==_)}}catch(xe){pt(s,s.return,xe)}}function UN(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{D0(s,c)}catch(m){pt(i,i.return,m)}}}function FN(i,s,c){c.props=vs(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(m){pt(i,s,m)}}function Xo(i,s){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var m=i.stateNode;break;case 30:m=i.stateNode;break;default:m=i.stateNode}typeof c=="function"?i.refCleanup=c(m):c.current=m}}catch(y){pt(i,s,y)}}function na(i,s){var c=i.ref,m=i.refCleanup;if(c!==null)if(typeof m=="function")try{m()}catch(y){pt(i,s,y)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(y){pt(i,s,y)}else c.current=null}function GN(i){var s=i.type,c=i.memoizedProps,m=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&m.focus();break e;case"img":c.src?m.src=c.src:c.srcSet&&(m.srcset=c.srcSet)}}catch(y){pt(i,i.return,y)}}function Lh(i,s,c){try{var m=i.stateNode;VT(m,i.type,c,s),m[Fr]=s}catch(y){pt(i,i.return,y)}}function HN(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ai(i.type)||i.tag===4}function $h(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||HN(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ai(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Bh(i,s,c){var m=i.tag;if(m===5||m===6)i=i.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(i),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=ja));else if(m!==4&&(m===27&&Ai(i.type)&&(c=i.stateNode,s=null),i=i.child,i!==null))for(Bh(i,s,c),i=i.sibling;i!==null;)Bh(i,s,c),i=i.sibling}function nd(i,s,c){var m=i.tag;if(m===5||m===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(m!==4&&(m===27&&Ai(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(nd(i,s,c),i=i.sibling;i!==null;)nd(i,s,c),i=i.sibling}function QN(i){var s=i.stateNode,c=i.memoizedProps;try{for(var m=i.type,y=s.attributes;y.length;)s.removeAttributeNode(y[0]);Nr(s,m,c),s[xr]=i,s[Fr]=c}catch(_){pt(i,i.return,_)}}var ka=!1,Xt=!1,Uh=!1,VN=typeof WeakSet=="function"?WeakSet:Set,lr=null;function CT(i,s){if(i=i.containerInfo,cv=Sd,i=i0(i),Tp(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var m=c.getSelection&&c.getSelection();if(m&&m.rangeCount!==0){c=m.anchorNode;var y=m.anchorOffset,_=m.focusNode;m=m.focusOffset;try{c.nodeType,_.nodeType}catch{c=null;break e}var A=0,T=-1,G=-1,ie=0,xe=0,ye=i,le=null;t:for(;;){for(var me;ye!==c||y!==0&&ye.nodeType!==3||(T=A+y),ye!==_||m!==0&&ye.nodeType!==3||(G=A+m),ye.nodeType===3&&(A+=ye.nodeValue.length),(me=ye.firstChild)!==null;)le=ye,ye=me;for(;;){if(ye===i)break t;if(le===c&&++ie===y&&(T=A),le===_&&++xe===m&&(G=A),(me=ye.nextSibling)!==null)break;ye=le,le=ye.parentNode}ye=me}c=T===-1||G===-1?null:{start:T,end:G}}else c=null}c=c||{start:0,end:0}}else c=null;for(uv={focusedElem:i,selectionRange:c},Sd=!1,lr=s;lr!==null;)if(s=lr,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,lr=i;else for(;lr!==null;){switch(s=lr,_=s.alternate,i=s.flags,s.tag){case 0:if((i&4)!==0&&(i=s.updateQueue,i=i!==null?i.events:null,i!==null))for(c=0;c<i.length;c++)y=i[c],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&_!==null){i=void 0,c=s,y=_.memoizedProps,_=_.memoizedState,m=c.stateNode;try{var Ae=vs(c.type,y);i=m.getSnapshotBeforeUpdate(Ae,_),m.__reactInternalSnapshotBeforeUpdate=i}catch(Ue){pt(c,c.return,Ue)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)fv(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":fv(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(a(163))}if(i=s.sibling,i!==null){i.return=s.return,lr=i;break}lr=s.return}}function YN(i,s,c){var m=c.flags;switch(c.tag){case 0:case 11:case 15:Ma(i,c),m&4&&Wo(5,c);break;case 1:if(Ma(i,c),m&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(A){pt(c,c.return,A)}else{var y=vs(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(y,s,i.__reactInternalSnapshotBeforeUpdate)}catch(A){pt(c,c.return,A)}}m&64&&UN(c),m&512&&Xo(c,c.return);break;case 3:if(Ma(i,c),m&64&&(i=c.updateQueue,i!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{D0(i,s)}catch(A){pt(c,c.return,A)}}break;case 27:s===null&&m&4&&QN(c);case 26:case 5:Ma(i,c),s===null&&m&4&&GN(c),m&512&&Xo(c,c.return);break;case 12:Ma(i,c);break;case 31:Ma(i,c),m&4&&XN(i,c);break;case 13:Ma(i,c),m&4&&ZN(i,c),m&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=TT.bind(null,c),tq(i,c))));break;case 22:if(m=c.memoizedState!==null||ka,!m){s=s!==null&&s.memoizedState!==null||Xt,y=ka;var _=Xt;ka=m,(Xt=s)&&!_?Pa(i,c,(c.subtreeFlags&8772)!==0):Ma(i,c),ka=y,Xt=_}break;case 30:break;default:Ma(i,c)}}function KN(i){var s=i.alternate;s!==null&&(i.alternate=null,KN(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&xp(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var kt=null,Hr=!1;function Da(i,s,c){for(c=c.child;c!==null;)WN(i,s,c),c=c.sibling}function WN(i,s,c){if(Te&&typeof Te.onCommitFiberUnmount=="function")try{Te.onCommitFiberUnmount(je,c)}catch{}switch(c.tag){case 26:Xt||na(c,s),Da(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Xt||na(c,s);var m=kt,y=Hr;Ai(c.type)&&(kt=c.stateNode,Hr=!1),Da(i,s,c),sc(c.stateNode),kt=m,Hr=y;break;case 5:Xt||na(c,s);case 6:if(m=kt,y=Hr,kt=null,Da(i,s,c),kt=m,Hr=y,kt!==null)if(Hr)try{(kt.nodeType===9?kt.body:kt.nodeName==="HTML"?kt.ownerDocument.body:kt).removeChild(c.stateNode)}catch(_){pt(c,s,_)}else try{kt.removeChild(c.stateNode)}catch(_){pt(c,s,_)}break;case 18:kt!==null&&(Hr?(i=kt,U_(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),Bl(i)):U_(kt,c.stateNode));break;case 4:m=kt,y=Hr,kt=c.stateNode.containerInfo,Hr=!0,Da(i,s,c),kt=m,Hr=y;break;case 0:case 11:case 14:case 15:ji(2,c,s),Xt||ji(4,c,s),Da(i,s,c);break;case 1:Xt||(na(c,s),m=c.stateNode,typeof m.componentWillUnmount=="function"&&FN(c,s,m)),Da(i,s,c);break;case 21:Da(i,s,c);break;case 22:Xt=(m=Xt)||c.memoizedState!==null,Da(i,s,c),Xt=m;break;default:Da(i,s,c)}}function XN(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Bl(i)}catch(c){pt(s,s.return,c)}}}function ZN(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Bl(i)}catch(c){pt(s,s.return,c)}}function ET(i){switch(i.tag){case 31:case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new VN),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new VN),s;default:throw Error(a(435,i.tag))}}function ad(i,s){var c=ET(i);s.forEach(function(m){if(!c.has(m)){c.add(m);var y=qT.bind(null,i,m);m.then(y,y)}})}function Qr(i,s){var c=s.deletions;if(c!==null)for(var m=0;m<c.length;m++){var y=c[m],_=i,A=s,T=A;e:for(;T!==null;){switch(T.tag){case 27:if(Ai(T.type)){kt=T.stateNode,Hr=!1;break e}break;case 5:kt=T.stateNode,Hr=!1;break e;case 3:case 4:kt=T.stateNode.containerInfo,Hr=!0;break e}T=T.return}if(kt===null)throw Error(a(160));WN(_,A,y),kt=null,Hr=!1,_=y.alternate,_!==null&&(_.return=null),y.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)JN(s,i),s=s.sibling}var Bn=null;function JN(i,s){var c=i.alternate,m=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Qr(s,i),Vr(i),m&4&&(ji(3,i,i.return),Wo(3,i),ji(5,i,i.return));break;case 1:Qr(s,i),Vr(i),m&512&&(Xt||c===null||na(c,c.return)),m&64&&ka&&(i=i.updateQueue,i!==null&&(m=i.callbacks,m!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?m:c.concat(m))));break;case 26:var y=Bn;if(Qr(s,i),Vr(i),m&512&&(Xt||c===null||na(c,c.return)),m&4){var _=c!==null?c.memoizedState:null;if(m=i.memoizedState,c===null)if(m===null)if(i.stateNode===null){e:{m=i.type,c=i.memoizedProps,y=y.ownerDocument||y;t:switch(m){case"title":_=y.getElementsByTagName("title")[0],(!_||_[So]||_[xr]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=y.createElement(m),y.head.insertBefore(_,y.querySelector("head > title"))),Nr(_,m,c),_[xr]=i,sr(_),m=_;break e;case"link":var A=J_("link","href",y).get(m+(c.href||""));if(A){for(var T=0;T<A.length;T++)if(_=A[T],_.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&_.getAttribute("rel")===(c.rel==null?null:c.rel)&&_.getAttribute("title")===(c.title==null?null:c.title)&&_.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){A.splice(T,1);break t}}_=y.createElement(m),Nr(_,m,c),y.head.appendChild(_);break;case"meta":if(A=J_("meta","content",y).get(m+(c.content||""))){for(T=0;T<A.length;T++)if(_=A[T],_.getAttribute("content")===(c.content==null?null:""+c.content)&&_.getAttribute("name")===(c.name==null?null:c.name)&&_.getAttribute("property")===(c.property==null?null:c.property)&&_.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&_.getAttribute("charset")===(c.charSet==null?null:c.charSet)){A.splice(T,1);break t}}_=y.createElement(m),Nr(_,m,c),y.head.appendChild(_);break;default:throw Error(a(468,m))}_[xr]=i,sr(_),m=_}i.stateNode=m}else e1(y,i.type,i.stateNode);else i.stateNode=Z_(y,m,i.memoizedProps);else _!==m?(_===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):_.count--,m===null?e1(y,i.type,i.stateNode):Z_(y,m,i.memoizedProps)):m===null&&i.stateNode!==null&&Lh(i,i.memoizedProps,c.memoizedProps)}break;case 27:Qr(s,i),Vr(i),m&512&&(Xt||c===null||na(c,c.return)),c!==null&&m&4&&Lh(i,i.memoizedProps,c.memoizedProps);break;case 5:if(Qr(s,i),Vr(i),m&512&&(Xt||c===null||na(c,c.return)),i.flags&32){y=i.stateNode;try{ul(y,"")}catch(Ae){pt(i,i.return,Ae)}}m&4&&i.stateNode!=null&&(y=i.memoizedProps,Lh(i,y,c!==null?c.memoizedProps:y)),m&1024&&(Uh=!0);break;case 6:if(Qr(s,i),Vr(i),m&4){if(i.stateNode===null)throw Error(a(162));m=i.memoizedProps,c=i.stateNode;try{c.nodeValue=m}catch(Ae){pt(i,i.return,Ae)}}break;case 3:if(yd=null,y=Bn,Bn=xd(s.containerInfo),Qr(s,i),Bn=y,Vr(i),m&4&&c!==null&&c.memoizedState.isDehydrated)try{Bl(s.containerInfo)}catch(Ae){pt(i,i.return,Ae)}Uh&&(Uh=!1,e_(i));break;case 4:m=Bn,Bn=xd(i.stateNode.containerInfo),Qr(s,i),Vr(i),Bn=m;break;case 12:Qr(s,i),Vr(i);break;case 31:Qr(s,i),Vr(i),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,ad(i,m)));break;case 13:Qr(s,i),Vr(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(sd=Re()),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,ad(i,m)));break;case 22:y=i.memoizedState!==null;var G=c!==null&&c.memoizedState!==null,ie=ka,xe=Xt;if(ka=ie||y,Xt=xe||G,Qr(s,i),Xt=xe,ka=ie,Vr(i),m&8192)e:for(s=i.stateNode,s._visibility=y?s._visibility&-2:s._visibility|1,y&&(c===null||G||ka||Xt||gs(i)),c=null,s=i;;){if(s.tag===5||s.tag===26){if(c===null){G=c=s;try{if(_=G.stateNode,y)A=_.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{T=G.stateNode;var ye=G.memoizedProps.style,le=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;T.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(Ae){pt(G,G.return,Ae)}}}else if(s.tag===6){if(c===null){G=s;try{G.stateNode.nodeValue=y?"":G.memoizedProps}catch(Ae){pt(G,G.return,Ae)}}}else if(s.tag===18){if(c===null){G=s;try{var me=G.stateNode;y?F_(me,!0):F_(G.stateNode,!1)}catch(Ae){pt(G,G.return,Ae)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}m&4&&(m=i.updateQueue,m!==null&&(c=m.retryQueue,c!==null&&(m.retryQueue=null,ad(i,c))));break;case 19:Qr(s,i),Vr(i),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,ad(i,m)));break;case 30:break;case 21:break;default:Qr(s,i),Vr(i)}}function Vr(i){var s=i.flags;if(s&2){try{for(var c,m=i.return;m!==null;){if(HN(m)){c=m;break}m=m.return}if(c==null)throw Error(a(160));switch(c.tag){case 27:var y=c.stateNode,_=$h(i);nd(i,_,y);break;case 5:var A=c.stateNode;c.flags&32&&(ul(A,""),c.flags&=-33);var T=$h(i);nd(i,T,A);break;case 3:case 4:var G=c.stateNode.containerInfo,ie=$h(i);Bh(i,ie,G);break;default:throw Error(a(161))}}catch(xe){pt(i,i.return,xe)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function e_(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;e_(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Ma(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)YN(i,s.alternate,s),s=s.sibling}function gs(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:ji(4,s,s.return),gs(s);break;case 1:na(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&FN(s,s.return,c),gs(s);break;case 27:sc(s.stateNode);case 26:case 5:na(s,s.return),gs(s);break;case 22:s.memoizedState===null&&gs(s);break;case 30:gs(s);break;default:gs(s)}i=i.sibling}}function Pa(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var m=s.alternate,y=i,_=s,A=_.flags;switch(_.tag){case 0:case 11:case 15:Pa(y,_,c),Wo(4,_);break;case 1:if(Pa(y,_,c),m=_,y=m.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(ie){pt(m,m.return,ie)}if(m=_,y=m.updateQueue,y!==null){var T=m.stateNode;try{var G=y.shared.hiddenCallbacks;if(G!==null)for(y.shared.hiddenCallbacks=null,y=0;y<G.length;y++)k0(G[y],T)}catch(ie){pt(m,m.return,ie)}}c&&A&64&&UN(_),Xo(_,_.return);break;case 27:QN(_);case 26:case 5:Pa(y,_,c),c&&m===null&&A&4&&GN(_),Xo(_,_.return);break;case 12:Pa(y,_,c);break;case 31:Pa(y,_,c),c&&A&4&&XN(y,_);break;case 13:Pa(y,_,c),c&&A&4&&ZN(y,_);break;case 22:_.memoizedState===null&&Pa(y,_,c),Xo(_,_.return);break;case 30:break;default:Pa(y,_,c)}s=s.sibling}}function Fh(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Ro(c))}function Gh(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Ro(i))}function Un(i,s,c,m){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)t_(i,s,c,m),s=s.sibling}function t_(i,s,c,m){var y=s.flags;switch(s.tag){case 0:case 11:case 15:Un(i,s,c,m),y&2048&&Wo(9,s);break;case 1:Un(i,s,c,m);break;case 3:Un(i,s,c,m),y&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Ro(i)));break;case 12:if(y&2048){Un(i,s,c,m),i=s.stateNode;try{var _=s.memoizedProps,A=_.id,T=_.onPostCommit;typeof T=="function"&&T(A,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(G){pt(s,s.return,G)}}else Un(i,s,c,m);break;case 31:Un(i,s,c,m);break;case 13:Un(i,s,c,m);break;case 23:break;case 22:_=s.stateNode,A=s.alternate,s.memoizedState!==null?_._visibility&2?Un(i,s,c,m):Zo(i,s):_._visibility&2?Un(i,s,c,m):(_._visibility|=2,Ol(i,s,c,m,(s.subtreeFlags&10256)!==0||!1)),y&2048&&Fh(A,s);break;case 24:Un(i,s,c,m),y&2048&&Gh(s.alternate,s);break;default:Un(i,s,c,m)}}function Ol(i,s,c,m,y){for(y=y&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var _=i,A=s,T=c,G=m,ie=A.flags;switch(A.tag){case 0:case 11:case 15:Ol(_,A,T,G,y),Wo(8,A);break;case 23:break;case 22:var xe=A.stateNode;A.memoizedState!==null?xe._visibility&2?Ol(_,A,T,G,y):Zo(_,A):(xe._visibility|=2,Ol(_,A,T,G,y)),y&&ie&2048&&Fh(A.alternate,A);break;case 24:Ol(_,A,T,G,y),y&&ie&2048&&Gh(A.alternate,A);break;default:Ol(_,A,T,G,y)}s=s.sibling}}function Zo(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,m=s,y=m.flags;switch(m.tag){case 22:Zo(c,m),y&2048&&Fh(m.alternate,m);break;case 24:Zo(c,m),y&2048&&Gh(m.alternate,m);break;default:Zo(c,m)}s=s.sibling}}var Jo=8192;function kl(i,s,c){if(i.subtreeFlags&Jo)for(i=i.child;i!==null;)r_(i,s,c),i=i.sibling}function r_(i,s,c){switch(i.tag){case 26:kl(i,s,c),i.flags&Jo&&i.memoizedState!==null&&fq(c,Bn,i.memoizedState,i.memoizedProps);break;case 5:kl(i,s,c);break;case 3:case 4:var m=Bn;Bn=xd(i.stateNode.containerInfo),kl(i,s,c),Bn=m;break;case 22:i.memoizedState===null&&(m=i.alternate,m!==null&&m.memoizedState!==null?(m=Jo,Jo=16777216,kl(i,s,c),Jo=m):kl(i,s,c));break;default:kl(i,s,c)}}function n_(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function ec(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var m=s[c];lr=m,i_(m,i)}n_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)a_(i),i=i.sibling}function a_(i){switch(i.tag){case 0:case 11:case 15:ec(i),i.flags&2048&&ji(9,i,i.return);break;case 3:ec(i);break;case 12:ec(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,id(i)):ec(i);break;default:ec(i)}}function id(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var m=s[c];lr=m,i_(m,i)}n_(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:ji(8,s,s.return),id(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,id(s));break;default:id(s)}i=i.sibling}}function i_(i,s){for(;lr!==null;){var c=lr;switch(c.tag){case 0:case 11:case 15:ji(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var m=c.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Ro(c.memoizedState.cache)}if(m=c.child,m!==null)m.return=c,lr=m;else e:for(c=i;lr!==null;){m=lr;var y=m.sibling,_=m.return;if(KN(m),m===c){lr=null;break e}if(y!==null){y.return=_,lr=y;break e}lr=_}}}var AT={getCacheForType:function(i){var s=yr(Yt),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c},cacheSignal:function(){return yr(Yt).controller.signal}},zT=typeof WeakMap=="function"?WeakMap:Map,dt=0,St=null,Ze=null,et=0,ft=0,on=null,Ni=!1,Dl=!1,Hh=!1,Ta=0,Lt=0,_i=0,xs=0,Qh=0,cn=0,Ml=0,tc=null,Yr=null,Vh=!1,sd=0,s_=0,ld=1/0,od=null,Si=null,tr=0,wi=null,Pl=null,qa=0,Yh=0,Kh=null,l_=null,rc=0,Wh=null;function un(){return(dt&2)!==0&&et!==0?et&-et:q.T!==null?rv():_j()}function o_(){if(cn===0)if((et&536870912)===0||at){var i=rl;rl<<=1,(rl&3932160)===0&&(rl=262144),cn=i}else cn=536870912;return i=sn.current,i!==null&&(i.flags|=32),cn}function Kr(i,s,c){(i===St&&(ft===2||ft===9)||i.cancelPendingCommit!==null)&&(Tl(i,0),Ci(i,et,cn,!1)),Er(i,c),((dt&2)===0||i!==St)&&(i===St&&((dt&2)===0&&(xs|=c),Lt===4&&Ci(i,et,cn,!1)),aa(i))}function c_(i,s,c){if((dt&6)!==0)throw Error(a(327));var m=!c&&(s&127)===0&&(s&i.expiredLanes)===0||es(i,s),y=m?DT(i,s):Zh(i,s,!0),_=m;do{if(y===0){Dl&&!m&&Ci(i,s,0,!1);break}else{if(c=i.current.alternate,_&&!OT(c)){y=Zh(i,s,!1),_=!1;continue}if(y===2){if(_=s,i.errorRecoveryDisabledLanes&_)var A=0;else A=i.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){s=A;e:{var T=i;y=tc;var G=T.current.memoizedState.isDehydrated;if(G&&(Tl(T,A).flags|=256),A=Zh(T,A,!1),A!==2){if(Hh&&!G){T.errorRecoveryDisabledLanes|=_,xs|=_,y=4;break e}_=Yr,Yr=y,_!==null&&(Yr===null?Yr=_:Yr.push.apply(Yr,_))}y=A}if(_=!1,y!==2)continue}}if(y===1){Tl(i,0),Ci(i,s,0,!0);break}e:{switch(m=i,_=y,_){case 0:case 1:throw Error(a(345));case 4:if((s&4194048)!==s)break;case 6:Ci(m,s,cn,!Ni);break e;case 2:Yr=null;break;case 3:case 5:break;default:throw Error(a(329))}if((s&62914560)===s&&(y=sd+300-Re(),10<y)){if(Ci(m,s,cn,!Ni),ea(m,0,!0)!==0)break e;qa=s,m.timeoutHandle=$_(u_.bind(null,m,c,Yr,od,Vh,s,cn,xs,Ml,Ni,_,"Throttled",-0,0),y);break e}u_(m,c,Yr,od,Vh,s,cn,xs,Ml,Ni,_,null,-0,0)}}break}while(!0);aa(i)}function u_(i,s,c,m,y,_,A,T,G,ie,xe,ye,le,me){if(i.timeoutHandle=-1,ye=s.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ja},r_(s,_,ye);var Ae=(_&62914560)===_?sd-Re():(_&4194048)===_?s_-Re():0;if(Ae=pq(ye,Ae),Ae!==null){qa=_,i.cancelPendingCommit=Ae(x_.bind(null,i,s,_,c,m,y,A,T,G,xe,ye,null,le,me)),Ci(i,_,A,!ie);return}}x_(i,s,_,c,m,y,A,T,G)}function OT(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var m=0;m<c.length;m++){var y=c[m],_=y.getSnapshot;y=y.value;try{if(!nn(_(),y))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ci(i,s,c,m){s&=~Qh,s&=~xs,i.suspendedLanes|=s,i.pingedLanes&=~s,m&&(i.warmLanes|=s),m=i.expirationTimes;for(var y=s;0<y;){var _=31-qt(y),A=1<<_;m[_]=-1,y&=~A}c!==0&&ts(i,c,s)}function cd(){return(dt&6)===0?(nc(0),!1):!0}function Xh(){if(Ze!==null){if(ft===0)var i=Ze.return;else i=Ze,wa=cs=null,fh(i),wl=null,Lo=0,i=Ze;for(;i!==null;)BN(i.alternate,i),i=i.return;Ze=null}}function Tl(i,s){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,WT(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),qa=0,Xh(),St=i,Ze=c=_a(i.current,null),et=s,ft=0,on=null,Ni=!1,Dl=es(i,s),Hh=!1,Ml=cn=Qh=xs=_i=Lt=0,Yr=tc=null,Vh=!1,(s&8)!==0&&(s|=s&32);var m=i.entangledLanes;if(m!==0)for(i=i.entanglements,m&=s;0<m;){var y=31-qt(m),_=1<<y;s|=i[y],m&=~_}return Ta=s,Ou(),c}function d_(i,s){Ve=null,q.H=Vo,s===Sl||s===Iu?(s=E0(),ft=3):s===th?(s=E0(),ft=4):ft=s===zh?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,on=s,Ze===null&&(Lt=1,Zu(i,_n(s,i.current)))}function m_(){var i=sn.current;return i===null?!0:(et&4194048)===et?En===null:(et&62914560)===et||(et&536870912)!==0?i===En:!1}function f_(){var i=q.H;return q.H=Vo,i===null?Vo:i}function p_(){var i=q.A;return q.A=AT,i}function ud(){Lt=4,Ni||(et&4194048)!==et&&sn.current!==null||(Dl=!0),(_i&134217727)===0&&(xs&134217727)===0||St===null||Ci(St,et,cn,!1)}function Zh(i,s,c){var m=dt;dt|=2;var y=f_(),_=p_();(St!==i||et!==s)&&(od=null,Tl(i,s)),s=!1;var A=Lt;e:do try{if(ft!==0&&Ze!==null){var T=Ze,G=on;switch(ft){case 8:Xh(),A=6;break e;case 3:case 2:case 9:case 6:sn.current===null&&(s=!0);var ie=ft;if(ft=0,on=null,ql(i,T,G,ie),c&&Dl){A=0;break e}break;default:ie=ft,ft=0,on=null,ql(i,T,G,ie)}}kT(),A=Lt;break}catch(xe){d_(i,xe)}while(!0);return s&&i.shellSuspendCounter++,wa=cs=null,dt=m,q.H=y,q.A=_,Ze===null&&(St=null,et=0,Ou()),A}function kT(){for(;Ze!==null;)h_(Ze)}function DT(i,s){var c=dt;dt|=2;var m=f_(),y=p_();St!==i||et!==s?(od=null,ld=Re()+500,Tl(i,s)):Dl=es(i,s);e:do try{if(ft!==0&&Ze!==null){s=Ze;var _=on;t:switch(ft){case 1:ft=0,on=null,ql(i,s,_,1);break;case 2:case 9:if(w0(_)){ft=0,on=null,v_(s);break}s=function(){ft!==2&&ft!==9||St!==i||(ft=7),aa(i)},_.then(s,s);break e;case 3:ft=7;break e;case 4:ft=5;break e;case 7:w0(_)?(ft=0,on=null,v_(s)):(ft=0,on=null,ql(i,s,_,7));break;case 5:var A=null;switch(Ze.tag){case 26:A=Ze.memoizedState;case 5:case 27:var T=Ze;if(A?t1(A):T.stateNode.complete){ft=0,on=null;var G=T.sibling;if(G!==null)Ze=G;else{var ie=T.return;ie!==null?(Ze=ie,dd(ie)):Ze=null}break t}}ft=0,on=null,ql(i,s,_,5);break;case 6:ft=0,on=null,ql(i,s,_,6);break;case 8:Xh(),Lt=6;break e;default:throw Error(a(462))}}MT();break}catch(xe){d_(i,xe)}while(!0);return wa=cs=null,q.H=m,q.A=y,dt=c,Ze!==null?0:(St=null,et=0,Ou(),Lt)}function MT(){for(;Ze!==null&&!pe();)h_(Ze)}function h_(i){var s=LN(i.alternate,i,Ta);i.memoizedProps=i.pendingProps,s===null?dd(i):Ze=s}function v_(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=MN(c,s,s.pendingProps,s.type,void 0,et);break;case 11:s=MN(c,s,s.pendingProps,s.type.render,s.ref,et);break;case 5:fh(s);default:BN(c,s),s=Ze=p0(s,Ta),s=LN(c,s,Ta)}i.memoizedProps=i.pendingProps,s===null?dd(i):Ze=s}function ql(i,s,c,m){wa=cs=null,fh(s),wl=null,Lo=0;var y=s.return;try{if(jT(i,y,s,c,et)){Lt=1,Zu(i,_n(c,i.current)),Ze=null;return}}catch(_){if(y!==null)throw Ze=y,_;Lt=1,Zu(i,_n(c,i.current)),Ze=null;return}s.flags&32768?(at||m===1?i=!0:Dl||(et&536870912)!==0?i=!1:(Ni=i=!0,(m===2||m===9||m===3||m===6)&&(m=sn.current,m!==null&&m.tag===13&&(m.flags|=16384))),g_(s,i)):dd(s)}function dd(i){var s=i;do{if((s.flags&32768)!==0){g_(s,Ni);return}i=s.return;var c=ST(s.alternate,s,Ta);if(c!==null){Ze=c;return}if(s=s.sibling,s!==null){Ze=s;return}Ze=s=i}while(s!==null);Lt===0&&(Lt=5)}function g_(i,s){do{var c=wT(i.alternate,i);if(c!==null){c.flags&=32767,Ze=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){Ze=i;return}Ze=i=c}while(i!==null);Lt=6,Ze=null}function x_(i,s,c,m,y,_,A,T,G){i.cancelPendingCommit=null;do md();while(tr!==0);if((dt&6)!==0)throw Error(a(327));if(s!==null){if(s===i.current)throw Error(a(177));if(_=s.lanes|s.childLanes,_|=$p,_o(i,c,_,A,T,G),i===St&&(Ze=St=null,et=0),Pl=s,wi=i,qa=c,Yh=_,Kh=y,l_=m,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,RT(Br,function(){return __(),null})):(i.callbackNode=null,i.callbackPriority=0),m=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||m){m=q.T,q.T=null,y=F.p,F.p=2,A=dt,dt|=4;try{CT(i,s,c)}finally{dt=A,F.p=y,q.T=m}}tr=1,b_(),y_(),j_()}}function b_(){if(tr===1){tr=0;var i=wi,s=Pl,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=q.T,q.T=null;var m=F.p;F.p=2;var y=dt;dt|=4;try{JN(s,i);var _=uv,A=i0(i.containerInfo),T=_.focusedElem,G=_.selectionRange;if(A!==T&&T&&T.ownerDocument&&a0(T.ownerDocument.documentElement,T)){if(G!==null&&Tp(T)){var ie=G.start,xe=G.end;if(xe===void 0&&(xe=ie),"selectionStart"in T)T.selectionStart=ie,T.selectionEnd=Math.min(xe,T.value.length);else{var ye=T.ownerDocument||document,le=ye&&ye.defaultView||window;if(le.getSelection){var me=le.getSelection(),Ae=T.textContent.length,Ue=Math.min(G.start,Ae),yt=G.end===void 0?Ue:Math.min(G.end,Ae);!me.extend&&Ue>yt&&(A=yt,yt=Ue,Ue=A);var ee=n0(T,Ue),V=n0(T,yt);if(ee&&V&&(me.rangeCount!==1||me.anchorNode!==ee.node||me.anchorOffset!==ee.offset||me.focusNode!==V.node||me.focusOffset!==V.offset)){var ae=ye.createRange();ae.setStart(ee.node,ee.offset),me.removeAllRanges(),Ue>yt?(me.addRange(ae),me.extend(V.node,V.offset)):(ae.setEnd(V.node,V.offset),me.addRange(ae))}}}}for(ye=[],me=T;me=me.parentNode;)me.nodeType===1&&ye.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<ye.length;T++){var be=ye[T];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}Sd=!!cv,uv=cv=null}finally{dt=y,F.p=m,q.T=c}}i.current=s,tr=2}}function y_(){if(tr===2){tr=0;var i=wi,s=Pl,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=q.T,q.T=null;var m=F.p;F.p=2;var y=dt;dt|=4;try{YN(i,s.alternate,s)}finally{dt=y,F.p=m,q.T=c}}tr=3}}function j_(){if(tr===4||tr===3){tr=0,Ce();var i=wi,s=Pl,c=qa,m=l_;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?tr=5:(tr=0,Pl=wi=null,N_(i,i.pendingLanes));var y=i.pendingLanes;if(y===0&&(Si=null),vp(c),s=s.stateNode,Te&&typeof Te.onCommitFiberRoot=="function")try{Te.onCommitFiberRoot(je,s,void 0,(s.current.flags&128)===128)}catch{}if(m!==null){s=q.T,y=F.p,F.p=2,q.T=null;try{for(var _=i.onRecoverableError,A=0;A<m.length;A++){var T=m[A];_(T.value,{componentStack:T.stack})}}finally{q.T=s,F.p=y}}(qa&3)!==0&&md(),aa(i),y=i.pendingLanes,(c&261930)!==0&&(y&42)!==0?i===Wh?rc++:(rc=0,Wh=i):rc=0,nc(0)}}function N_(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Ro(s)))}function md(){return b_(),y_(),j_(),__()}function __(){if(tr!==5)return!1;var i=wi,s=Yh;Yh=0;var c=vp(qa),m=q.T,y=F.p;try{F.p=32>c?32:c,q.T=null,c=Kh,Kh=null;var _=wi,A=qa;if(tr=0,Pl=wi=null,qa=0,(dt&6)!==0)throw Error(a(331));var T=dt;if(dt|=4,a_(_.current),t_(_,_.current,A,c),dt=T,nc(0,!1),Te&&typeof Te.onPostCommitFiberRoot=="function")try{Te.onPostCommitFiberRoot(je,_)}catch{}return!0}finally{F.p=y,q.T=m,N_(i,s)}}function S_(i,s,c){s=_n(c,s),s=Ah(i.stateNode,s,2),i=xi(i,s,2),i!==null&&(Er(i,2),aa(i))}function pt(i,s,c){if(i.tag===3)S_(i,i,c);else for(;s!==null;){if(s.tag===3){S_(s,i,c);break}else if(s.tag===1){var m=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Si===null||!Si.has(m))){i=_n(c,i),c=wN(2),m=xi(s,c,2),m!==null&&(CN(c,m,s,i),Er(m,2),aa(m));break}}s=s.return}}function Jh(i,s,c){var m=i.pingCache;if(m===null){m=i.pingCache=new zT;var y=new Set;m.set(s,y)}else y=m.get(s),y===void 0&&(y=new Set,m.set(s,y));y.has(c)||(Hh=!0,y.add(c),i=PT.bind(null,i,s,c),s.then(i,i))}function PT(i,s,c){var m=i.pingCache;m!==null&&m.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,St===i&&(et&c)===c&&(Lt===4||Lt===3&&(et&62914560)===et&&300>Re()-sd?(dt&2)===0&&Tl(i,0):Qh|=c,Ml===et&&(Ml=0)),aa(i)}function w_(i,s){s===0&&(s=$e()),i=ss(i,s),i!==null&&(Er(i,s),aa(i))}function TT(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),w_(i,c)}function qT(i,s){var c=0;switch(i.tag){case 31:case 13:var m=i.stateNode,y=i.memoizedState;y!==null&&(c=y.retryLane);break;case 19:m=i.stateNode;break;case 22:m=i.stateNode._retryCache;break;default:throw Error(a(314))}m!==null&&m.delete(s),w_(i,c)}function RT(i,s){return ir(i,s)}var fd=null,Rl=null,ev=!1,pd=!1,tv=!1,Ei=0;function aa(i){i!==Rl&&i.next===null&&(Rl===null?fd=Rl=i:Rl=Rl.next=i),pd=!0,ev||(ev=!0,LT())}function nc(i,s){if(!tv&&pd){tv=!0;do for(var c=!1,m=fd;m!==null;){if(i!==0){var y=m.pendingLanes;if(y===0)var _=0;else{var A=m.suspendedLanes,T=m.pingedLanes;_=(1<<31-qt(42|i)+1)-1,_&=y&~(A&~T),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(c=!0,z_(m,_))}else _=et,_=ea(m,m===St?_:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(_&3)===0||es(m,_)||(c=!0,z_(m,_));m=m.next}while(c);tv=!1}}function IT(){C_()}function C_(){pd=ev=!1;var i=0;Ei!==0&&KT()&&(i=Ei);for(var s=Re(),c=null,m=fd;m!==null;){var y=m.next,_=E_(m,s);_===0?(m.next=null,c===null?fd=y:c.next=y,y===null&&(Rl=c)):(c=m,(i!==0||(_&3)!==0)&&(pd=!0)),m=y}tr!==0&&tr!==5||nc(i),Ei!==0&&(Ei=0)}function E_(i,s){for(var c=i.suspendedLanes,m=i.pingedLanes,y=i.expirationTimes,_=i.pendingLanes&-62914561;0<_;){var A=31-qt(_),T=1<<A,G=y[A];G===-1?((T&c)===0||(T&m)!==0)&&(y[A]=ne(T,s)):G<=s&&(i.expiredLanes|=T),_&=~T}if(s=St,c=et,c=ea(i,i===s?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),m=i.callbackNode,c===0||i===s&&(ft===2||ft===9)||i.cancelPendingCommit!==null)return m!==null&&m!==null&&rn(m),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||es(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(m!==null&&rn(m),vp(c)){case 2:case 8:c=Vt;break;case 32:c=Br;break;case 268435456:c=J;break;default:c=Br}return m=A_.bind(null,i),c=ir(c,m),i.callbackPriority=s,i.callbackNode=c,s}return m!==null&&m!==null&&rn(m),i.callbackPriority=2,i.callbackNode=null,2}function A_(i,s){if(tr!==0&&tr!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(md()&&i.callbackNode!==c)return null;var m=et;return m=ea(i,i===St?m:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),m===0?null:(c_(i,m,s),E_(i,Re()),i.callbackNode!=null&&i.callbackNode===c?A_.bind(null,i):null)}function z_(i,s){if(md())return null;c_(i,s,!0)}function LT(){XT(function(){(dt&6)!==0?ir(lt,IT):C_()})}function rv(){if(Ei===0){var i=Nl;i===0&&(i=tl,tl<<=1,(tl&261888)===0&&(tl=256)),Ei=i}return Ei}function O_(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Nu(""+i)}function k_(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function $T(i,s,c,m,y){if(s==="submit"&&c&&c.stateNode===y){var _=O_((y[Fr]||null).action),A=m.submitter;A&&(s=(s=A[Fr]||null)?O_(s.formAction):A.getAttribute("formAction"),s!==null&&(_=s,A=null));var T=new Cu("action","action",null,m,y);i.push({event:T,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Ei!==0){var G=A?k_(y,A):new FormData(y);Nh(c,{pending:!0,data:G,method:y.method,action:_},null,G)}}else typeof _=="function"&&(T.preventDefault(),G=A?k_(y,A):new FormData(y),Nh(c,{pending:!0,data:G,method:y.method,action:_},_,G))},currentTarget:y}]})}}for(var nv=0;nv<Lp.length;nv++){var av=Lp[nv],BT=av.toLowerCase(),UT=av[0].toUpperCase()+av.slice(1);$n(BT,"on"+UT)}$n(o0,"onAnimationEnd"),$n(c0,"onAnimationIteration"),$n(u0,"onAnimationStart"),$n("dblclick","onDoubleClick"),$n("focusin","onFocus"),$n("focusout","onBlur"),$n(aT,"onTransitionRun"),$n(iT,"onTransitionStart"),$n(sT,"onTransitionCancel"),$n(d0,"onTransitionEnd"),ol("onMouseEnter",["mouseout","mouseover"]),ol("onMouseLeave",["mouseout","mouseover"]),ol("onPointerEnter",["pointerout","pointerover"]),ol("onPointerLeave",["pointerout","pointerover"]),rs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rs("onBeforeInput",["compositionend","keypress","textInput","paste"]),rs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ac="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ac));function D_(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var m=i[c],y=m.event;m=m.listeners;e:{var _=void 0;if(s)for(var A=m.length-1;0<=A;A--){var T=m[A],G=T.instance,ie=T.currentTarget;if(T=T.listener,G!==_&&y.isPropagationStopped())break e;_=T,y.currentTarget=ie;try{_(y)}catch(xe){zu(xe)}y.currentTarget=null,_=G}else for(A=0;A<m.length;A++){if(T=m[A],G=T.instance,ie=T.currentTarget,T=T.listener,G!==_&&y.isPropagationStopped())break e;_=T,y.currentTarget=ie;try{_(y)}catch(xe){zu(xe)}y.currentTarget=null,_=G}}}}function Je(i,s){var c=s[gp];c===void 0&&(c=s[gp]=new Set);var m=i+"__bubble";c.has(m)||(M_(s,i,2,!1),c.add(m))}function iv(i,s,c){var m=0;s&&(m|=4),M_(c,i,m,s)}var hd="_reactListening"+Math.random().toString(36).slice(2);function sv(i){if(!i[hd]){i[hd]=!0,Cj.forEach(function(c){c!=="selectionchange"&&(FT.has(c)||iv(c,!1,i),iv(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[hd]||(s[hd]=!0,iv("selectionchange",!1,s))}}function M_(i,s,c,m){switch(o1(s)){case 2:var y=gq;break;case 8:y=xq;break;default:y=jv}c=y.bind(null,s,c,i),y=void 0,!Cp||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(y=!0),m?y!==void 0?i.addEventListener(s,c,{capture:!0,passive:y}):i.addEventListener(s,c,!0):y!==void 0?i.addEventListener(s,c,{passive:y}):i.addEventListener(s,c,!1)}function lv(i,s,c,m,y){var _=m;if((s&1)===0&&(s&2)===0&&m!==null)e:for(;;){if(m===null)return;var A=m.tag;if(A===3||A===4){var T=m.stateNode.containerInfo;if(T===y)break;if(A===4)for(A=m.return;A!==null;){var G=A.tag;if((G===3||G===4)&&A.stateNode.containerInfo===y)return;A=A.return}for(;T!==null;){if(A=il(T),A===null)return;if(G=A.tag,G===5||G===6||G===26||G===27){m=_=A;continue e}T=T.parentNode}}m=m.return}Ij(function(){var ie=_,xe=Sp(c),ye=[];e:{var le=m0.get(i);if(le!==void 0){var me=Cu,Ae=i;switch(i){case"keypress":if(Su(c)===0)break e;case"keydown":case"keyup":me=qP;break;case"focusin":Ae="focus",me=Op;break;case"focusout":Ae="blur",me=Op;break;case"beforeblur":case"afterblur":me=Op;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=Bj;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=SP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=LP;break;case o0:case c0:case u0:me=EP;break;case d0:me=BP;break;case"scroll":case"scrollend":me=NP;break;case"wheel":me=FP;break;case"copy":case"cut":case"paste":me=zP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=Fj;break;case"toggle":case"beforetoggle":me=HP}var Ue=(s&4)!==0,yt=!Ue&&(i==="scroll"||i==="scrollend"),ee=Ue?le!==null?le+"Capture":null:le;Ue=[];for(var V=ie,ae;V!==null;){var be=V;if(ae=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||ae===null||ee===null||(be=Co(V,ee),be!=null&&Ue.push(ic(V,be,ae))),yt)break;V=V.return}0<Ue.length&&(le=new me(le,Ae,null,c,xe),ye.push({event:le,listeners:Ue}))}}if((s&7)===0){e:{if(le=i==="mouseover"||i==="pointerover",me=i==="mouseout"||i==="pointerout",le&&c!==_p&&(Ae=c.relatedTarget||c.fromElement)&&(il(Ae)||Ae[al]))break e;if((me||le)&&(le=xe.window===xe?xe:(le=xe.ownerDocument)?le.defaultView||le.parentWindow:window,me?(Ae=c.relatedTarget||c.toElement,me=ie,Ae=Ae?il(Ae):null,Ae!==null&&(yt=o(Ae),Ue=Ae.tag,Ae!==yt||Ue!==5&&Ue!==27&&Ue!==6)&&(Ae=null)):(me=null,Ae=ie),me!==Ae)){if(Ue=Bj,be="onMouseLeave",ee="onMouseEnter",V="mouse",(i==="pointerout"||i==="pointerover")&&(Ue=Fj,be="onPointerLeave",ee="onPointerEnter",V="pointer"),yt=me==null?le:wo(me),ae=Ae==null?le:wo(Ae),le=new Ue(be,V+"leave",me,c,xe),le.target=yt,le.relatedTarget=ae,be=null,il(xe)===ie&&(Ue=new Ue(ee,V+"enter",Ae,c,xe),Ue.target=ae,Ue.relatedTarget=yt,be=Ue),yt=be,me&&Ae)t:{for(Ue=GT,ee=me,V=Ae,ae=0,be=ee;be;be=Ue(be))ae++;be=0;for(var Le=V;Le;Le=Ue(Le))be++;for(;0<ae-be;)ee=Ue(ee),ae--;for(;0<be-ae;)V=Ue(V),be--;for(;ae--;){if(ee===V||V!==null&&ee===V.alternate){Ue=ee;break t}ee=Ue(ee),V=Ue(V)}Ue=null}else Ue=null;me!==null&&P_(ye,le,me,Ue,!1),Ae!==null&&yt!==null&&P_(ye,yt,Ae,Ue,!0)}}e:{if(le=ie?wo(ie):window,me=le.nodeName&&le.nodeName.toLowerCase(),me==="select"||me==="input"&&le.type==="file")var ot=Xj;else if(Kj(le))if(Zj)ot=tT;else{ot=JP;var Pe=ZP}else me=le.nodeName,!me||me.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?ie&&Np(ie.elementType)&&(ot=Xj):ot=eT;if(ot&&(ot=ot(i,ie))){Wj(ye,ot,c,xe);break e}Pe&&Pe(i,le,ie),i==="focusout"&&ie&&le.type==="number"&&ie.memoizedProps.value!=null&&jp(le,"number",le.value)}switch(Pe=ie?wo(ie):window,i){case"focusin":(Kj(Pe)||Pe.contentEditable==="true")&&(pl=Pe,qp=ie,Po=null);break;case"focusout":Po=qp=pl=null;break;case"mousedown":Rp=!0;break;case"contextmenu":case"mouseup":case"dragend":Rp=!1,s0(ye,c,xe);break;case"selectionchange":if(nT)break;case"keydown":case"keyup":s0(ye,c,xe)}var Ye;if(Dp)e:{switch(i){case"compositionstart":var tt="onCompositionStart";break e;case"compositionend":tt="onCompositionEnd";break e;case"compositionupdate":tt="onCompositionUpdate";break e}tt=void 0}else fl?Vj(i,c)&&(tt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(tt="onCompositionStart");tt&&(Gj&&c.locale!=="ko"&&(fl||tt!=="onCompositionStart"?tt==="onCompositionEnd"&&fl&&(Ye=Lj()):(di=xe,Ep="value"in di?di.value:di.textContent,fl=!0)),Pe=vd(ie,tt),0<Pe.length&&(tt=new Uj(tt,i,null,c,xe),ye.push({event:tt,listeners:Pe}),Ye?tt.data=Ye:(Ye=Yj(c),Ye!==null&&(tt.data=Ye)))),(Ye=VP?YP(i,c):KP(i,c))&&(tt=vd(ie,"onBeforeInput"),0<tt.length&&(Pe=new Uj("onBeforeInput","beforeinput",null,c,xe),ye.push({event:Pe,listeners:tt}),Pe.data=Ye)),$T(ye,i,ie,c,xe)}D_(ye,s)})}function ic(i,s,c){return{instance:i,listener:s,currentTarget:c}}function vd(i,s){for(var c=s+"Capture",m=[];i!==null;){var y=i,_=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||_===null||(y=Co(i,c),y!=null&&m.unshift(ic(i,y,_)),y=Co(i,s),y!=null&&m.push(ic(i,y,_))),i.tag===3)return m;i=i.return}return[]}function GT(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function P_(i,s,c,m,y){for(var _=s._reactName,A=[];c!==null&&c!==m;){var T=c,G=T.alternate,ie=T.stateNode;if(T=T.tag,G!==null&&G===m)break;T!==5&&T!==26&&T!==27||ie===null||(G=ie,y?(ie=Co(c,_),ie!=null&&A.unshift(ic(c,ie,G))):y||(ie=Co(c,_),ie!=null&&A.push(ic(c,ie,G)))),c=c.return}A.length!==0&&i.push({event:s,listeners:A})}var HT=/\r\n?/g,QT=/\u0000|\uFFFD/g;function T_(i){return(typeof i=="string"?i:""+i).replace(HT,`
`).replace(QT,"")}function q_(i,s){return s=T_(s),T_(i)===s}function bt(i,s,c,m,y,_){switch(c){case"children":typeof m=="string"?s==="body"||s==="textarea"&&m===""||ul(i,m):(typeof m=="number"||typeof m=="bigint")&&s!=="body"&&ul(i,""+m);break;case"className":yu(i,"class",m);break;case"tabIndex":yu(i,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":yu(i,c,m);break;case"style":qj(i,m,_);break;case"data":if(s!=="object"){yu(i,"data",m);break}case"src":case"href":if(m===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){i.removeAttribute(c);break}m=Nu(""+m),i.setAttribute(c,m);break;case"action":case"formAction":if(typeof m=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(c==="formAction"?(s!=="input"&&bt(i,s,"name",y.name,y,null),bt(i,s,"formEncType",y.formEncType,y,null),bt(i,s,"formMethod",y.formMethod,y,null),bt(i,s,"formTarget",y.formTarget,y,null)):(bt(i,s,"encType",y.encType,y,null),bt(i,s,"method",y.method,y,null),bt(i,s,"target",y.target,y,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){i.removeAttribute(c);break}m=Nu(""+m),i.setAttribute(c,m);break;case"onClick":m!=null&&(i.onclick=ja);break;case"onScroll":m!=null&&Je("scroll",i);break;case"onScrollEnd":m!=null&&Je("scrollend",i);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(a(61));if(c=m.__html,c!=null){if(y.children!=null)throw Error(a(60));i.innerHTML=c}}break;case"multiple":i.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":i.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){i.removeAttribute("xlink:href");break}c=Nu(""+m),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(c,""+m):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":m===!0?i.setAttribute(c,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(c,m):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?i.setAttribute(c,m):i.removeAttribute(c);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?i.removeAttribute(c):i.setAttribute(c,m);break;case"popover":Je("beforetoggle",i),Je("toggle",i),bu(i,"popover",m);break;case"xlinkActuate":ya(i,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":ya(i,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":ya(i,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":ya(i,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":ya(i,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":ya(i,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":ya(i,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":ya(i,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":ya(i,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":bu(i,"is",m);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=yP.get(c)||c,bu(i,c,m))}}function ov(i,s,c,m,y,_){switch(c){case"style":qj(i,m,_);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(a(61));if(c=m.__html,c!=null){if(y.children!=null)throw Error(a(60));i.innerHTML=c}}break;case"children":typeof m=="string"?ul(i,m):(typeof m=="number"||typeof m=="bigint")&&ul(i,""+m);break;case"onScroll":m!=null&&Je("scroll",i);break;case"onScrollEnd":m!=null&&Je("scrollend",i);break;case"onClick":m!=null&&(i.onclick=ja);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ej.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(y=c.endsWith("Capture"),s=c.slice(2,y?c.length-7:void 0),_=i[Fr]||null,_=_!=null?_[c]:null,typeof _=="function"&&i.removeEventListener(s,_,y),typeof m=="function")){typeof _!="function"&&_!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,m,y);break e}c in i?i[c]=m:m===!0?i.setAttribute(c,""):bu(i,c,m)}}}function Nr(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Je("error",i),Je("load",i);var m=!1,y=!1,_;for(_ in c)if(c.hasOwnProperty(_)){var A=c[_];if(A!=null)switch(_){case"src":m=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:bt(i,s,_,A,c,null)}}y&&bt(i,s,"srcSet",c.srcSet,c,null),m&&bt(i,s,"src",c.src,c,null);return;case"input":Je("invalid",i);var T=_=A=y=null,G=null,ie=null;for(m in c)if(c.hasOwnProperty(m)){var xe=c[m];if(xe!=null)switch(m){case"name":y=xe;break;case"type":A=xe;break;case"checked":G=xe;break;case"defaultChecked":ie=xe;break;case"value":_=xe;break;case"defaultValue":T=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(a(137,s));break;default:bt(i,s,m,xe,c,null)}}Dj(i,_,T,G,ie,A,y,!1);return;case"select":Je("invalid",i),m=A=_=null;for(y in c)if(c.hasOwnProperty(y)&&(T=c[y],T!=null))switch(y){case"value":_=T;break;case"defaultValue":A=T;break;case"multiple":m=T;default:bt(i,s,y,T,c,null)}s=_,c=A,i.multiple=!!m,s!=null?cl(i,!!m,s,!1):c!=null&&cl(i,!!m,c,!0);return;case"textarea":Je("invalid",i),_=y=m=null;for(A in c)if(c.hasOwnProperty(A)&&(T=c[A],T!=null))switch(A){case"value":m=T;break;case"defaultValue":y=T;break;case"children":_=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(a(91));break;default:bt(i,s,A,T,c,null)}Pj(i,m,y,_);return;case"option":for(G in c)c.hasOwnProperty(G)&&(m=c[G],m!=null)&&(G==="selected"?i.selected=m&&typeof m!="function"&&typeof m!="symbol":bt(i,s,G,m,c,null));return;case"dialog":Je("beforetoggle",i),Je("toggle",i),Je("cancel",i),Je("close",i);break;case"iframe":case"object":Je("load",i);break;case"video":case"audio":for(m=0;m<ac.length;m++)Je(ac[m],i);break;case"image":Je("error",i),Je("load",i);break;case"details":Je("toggle",i);break;case"embed":case"source":case"link":Je("error",i),Je("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ie in c)if(c.hasOwnProperty(ie)&&(m=c[ie],m!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:bt(i,s,ie,m,c,null)}return;default:if(Np(s)){for(xe in c)c.hasOwnProperty(xe)&&(m=c[xe],m!==void 0&&ov(i,s,xe,m,c,void 0));return}}for(T in c)c.hasOwnProperty(T)&&(m=c[T],m!=null&&bt(i,s,T,m,c,null))}function VT(i,s,c,m){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,_=null,A=null,T=null,G=null,ie=null,xe=null;for(me in c){var ye=c[me];if(c.hasOwnProperty(me)&&ye!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":G=ye;default:m.hasOwnProperty(me)||bt(i,s,me,null,m,ye)}}for(var le in m){var me=m[le];if(ye=c[le],m.hasOwnProperty(le)&&(me!=null||ye!=null))switch(le){case"type":_=me;break;case"name":y=me;break;case"checked":ie=me;break;case"defaultChecked":xe=me;break;case"value":A=me;break;case"defaultValue":T=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(a(137,s));break;default:me!==ye&&bt(i,s,le,me,m,ye)}}yp(i,A,T,G,ie,xe,_,y);return;case"select":me=A=T=le=null;for(_ in c)if(G=c[_],c.hasOwnProperty(_)&&G!=null)switch(_){case"value":break;case"multiple":me=G;default:m.hasOwnProperty(_)||bt(i,s,_,null,m,G)}for(y in m)if(_=m[y],G=c[y],m.hasOwnProperty(y)&&(_!=null||G!=null))switch(y){case"value":le=_;break;case"defaultValue":T=_;break;case"multiple":A=_;default:_!==G&&bt(i,s,y,_,m,G)}s=T,c=A,m=me,le!=null?cl(i,!!c,le,!1):!!m!=!!c&&(s!=null?cl(i,!!c,s,!0):cl(i,!!c,c?[]:"",!1));return;case"textarea":me=le=null;for(T in c)if(y=c[T],c.hasOwnProperty(T)&&y!=null&&!m.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:bt(i,s,T,null,m,y)}for(A in m)if(y=m[A],_=c[A],m.hasOwnProperty(A)&&(y!=null||_!=null))switch(A){case"value":le=y;break;case"defaultValue":me=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(a(91));break;default:y!==_&&bt(i,s,A,y,m,_)}Mj(i,le,me);return;case"option":for(var Ae in c)le=c[Ae],c.hasOwnProperty(Ae)&&le!=null&&!m.hasOwnProperty(Ae)&&(Ae==="selected"?i.selected=!1:bt(i,s,Ae,null,m,le));for(G in m)le=m[G],me=c[G],m.hasOwnProperty(G)&&le!==me&&(le!=null||me!=null)&&(G==="selected"?i.selected=le&&typeof le!="function"&&typeof le!="symbol":bt(i,s,G,le,m,me));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ue in c)le=c[Ue],c.hasOwnProperty(Ue)&&le!=null&&!m.hasOwnProperty(Ue)&&bt(i,s,Ue,null,m,le);for(ie in m)if(le=m[ie],me=c[ie],m.hasOwnProperty(ie)&&le!==me&&(le!=null||me!=null))switch(ie){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(a(137,s));break;default:bt(i,s,ie,le,m,me)}return;default:if(Np(s)){for(var yt in c)le=c[yt],c.hasOwnProperty(yt)&&le!==void 0&&!m.hasOwnProperty(yt)&&ov(i,s,yt,void 0,m,le);for(xe in m)le=m[xe],me=c[xe],!m.hasOwnProperty(xe)||le===me||le===void 0&&me===void 0||ov(i,s,xe,le,m,me);return}}for(var ee in c)le=c[ee],c.hasOwnProperty(ee)&&le!=null&&!m.hasOwnProperty(ee)&&bt(i,s,ee,null,m,le);for(ye in m)le=m[ye],me=c[ye],!m.hasOwnProperty(ye)||le===me||le==null&&me==null||bt(i,s,ye,le,m,me)}function R_(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function YT(){if(typeof performance.getEntriesByType=="function"){for(var i=0,s=0,c=performance.getEntriesByType("resource"),m=0;m<c.length;m++){var y=c[m],_=y.transferSize,A=y.initiatorType,T=y.duration;if(_&&T&&R_(A)){for(A=0,T=y.responseEnd,m+=1;m<c.length;m++){var G=c[m],ie=G.startTime;if(ie>T)break;var xe=G.transferSize,ye=G.initiatorType;xe&&R_(ye)&&(G=G.responseEnd,A+=xe*(G<T?1:(T-ie)/(G-ie)))}if(--m,s+=8*(_+A)/(y.duration/1e3),i++,10<i)break}}if(0<i)return s/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var cv=null,uv=null;function gd(i){return i.nodeType===9?i:i.ownerDocument}function I_(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function L_(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function dv(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var mv=null;function KT(){var i=window.event;return i&&i.type==="popstate"?i===mv?!1:(mv=i,!0):(mv=null,!1)}var $_=typeof setTimeout=="function"?setTimeout:void 0,WT=typeof clearTimeout=="function"?clearTimeout:void 0,B_=typeof Promise=="function"?Promise:void 0,XT=typeof queueMicrotask=="function"?queueMicrotask:typeof B_<"u"?function(i){return B_.resolve(null).then(i).catch(ZT)}:$_;function ZT(i){setTimeout(function(){throw i})}function Ai(i){return i==="head"}function U_(i,s){var c=s,m=0;do{var y=c.nextSibling;if(i.removeChild(c),y&&y.nodeType===8)if(c=y.data,c==="/$"||c==="/&"){if(m===0){i.removeChild(y),Bl(s);return}m--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")m++;else if(c==="html")sc(i.ownerDocument.documentElement);else if(c==="head"){c=i.ownerDocument.head,sc(c);for(var _=c.firstChild;_;){var A=_.nextSibling,T=_.nodeName;_[So]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&_.rel.toLowerCase()==="stylesheet"||c.removeChild(_),_=A}}else c==="body"&&sc(i.ownerDocument.body);c=y}while(c);Bl(s)}function F_(i,s){var c=i;i=0;do{var m=c.nextSibling;if(c.nodeType===1?s?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(s?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(i===0)break;i--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||i++;c=m}while(c)}function fv(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":fv(c),xp(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function JT(i,s,c,m){for(;i.nodeType===1;){var y=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!m&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(m){if(!i[So])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(_=i.getAttribute("rel"),_==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(_!==y.rel||i.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||i.getAttribute("title")!==(y.title==null?null:y.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(_=i.getAttribute("src"),(_!==(y.src==null?null:y.src)||i.getAttribute("type")!==(y.type==null?null:y.type)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&_&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var _=y.name==null?null:""+y.name;if(y.type==="hidden"&&i.getAttribute("name")===_)return i}else return i;if(i=An(i.nextSibling),i===null)break}return null}function eq(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=An(i.nextSibling),i===null))return null;return i}function G_(i,s){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!s||(i=An(i.nextSibling),i===null))return null;return i}function pv(i){return i.data==="$?"||i.data==="$~"}function hv(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function tq(i,s){var c=i.ownerDocument;if(i.data==="$~")i._reactRetry=s;else if(i.data!=="$?"||c.readyState!=="loading")s();else{var m=function(){s(),c.removeEventListener("DOMContentLoaded",m)};c.addEventListener("DOMContentLoaded",m),i._reactRetry=m}}function An(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return i}var vv=null;function H_(i){i=i.nextSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"||c==="/&"){if(s===0)return An(i.nextSibling);s--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||s++}i=i.nextSibling}return null}function Q_(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(s===0)return i;s--}else c!=="/$"&&c!=="/&"||s++}i=i.previousSibling}return null}function V_(i,s,c){switch(s=gd(c),i){case"html":if(i=s.documentElement,!i)throw Error(a(452));return i;case"head":if(i=s.head,!i)throw Error(a(453));return i;case"body":if(i=s.body,!i)throw Error(a(454));return i;default:throw Error(a(451))}}function sc(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);xp(i)}var zn=new Map,Y_=new Set;function xd(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ra=F.d;F.d={f:rq,r:nq,D:aq,C:iq,L:sq,m:lq,X:cq,S:oq,M:uq};function rq(){var i=Ra.f(),s=cd();return i||s}function nq(i){var s=sl(i);s!==null&&s.tag===5&&s.type==="form"?dN(s):Ra.r(i)}var Il=typeof document>"u"?null:document;function K_(i,s,c){var m=Il;if(m&&typeof s=="string"&&s){var y=jn(s);y='link[rel="'+i+'"][href="'+y+'"]',typeof c=="string"&&(y+='[crossorigin="'+c+'"]'),Y_.has(y)||(Y_.add(y),i={rel:i,crossOrigin:c,href:s},m.querySelector(y)===null&&(s=m.createElement("link"),Nr(s,"link",i),sr(s),m.head.appendChild(s)))}}function aq(i){Ra.D(i),K_("dns-prefetch",i,null)}function iq(i,s){Ra.C(i,s),K_("preconnect",i,s)}function sq(i,s,c){Ra.L(i,s,c);var m=Il;if(m&&i&&s){var y='link[rel="preload"][as="'+jn(s)+'"]';s==="image"&&c&&c.imageSrcSet?(y+='[imagesrcset="'+jn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(y+='[imagesizes="'+jn(c.imageSizes)+'"]')):y+='[href="'+jn(i)+'"]';var _=y;switch(s){case"style":_=Ll(i);break;case"script":_=$l(i)}zn.has(_)||(i=v({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),zn.set(_,i),m.querySelector(y)!==null||s==="style"&&m.querySelector(lc(_))||s==="script"&&m.querySelector(oc(_))||(s=m.createElement("link"),Nr(s,"link",i),sr(s),m.head.appendChild(s)))}}function lq(i,s){Ra.m(i,s);var c=Il;if(c&&i){var m=s&&typeof s.as=="string"?s.as:"script",y='link[rel="modulepreload"][as="'+jn(m)+'"][href="'+jn(i)+'"]',_=y;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=$l(i)}if(!zn.has(_)&&(i=v({rel:"modulepreload",href:i},s),zn.set(_,i),c.querySelector(y)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(oc(_)))return}m=c.createElement("link"),Nr(m,"link",i),sr(m),c.head.appendChild(m)}}}function oq(i,s,c){Ra.S(i,s,c);var m=Il;if(m&&i){var y=ll(m).hoistableStyles,_=Ll(i);s=s||"default";var A=y.get(_);if(!A){var T={loading:0,preload:null};if(A=m.querySelector(lc(_)))T.loading=5;else{i=v({rel:"stylesheet",href:i,"data-precedence":s},c),(c=zn.get(_))&&gv(i,c);var G=A=m.createElement("link");sr(G),Nr(G,"link",i),G._p=new Promise(function(ie,xe){G.onload=ie,G.onerror=xe}),G.addEventListener("load",function(){T.loading|=1}),G.addEventListener("error",function(){T.loading|=2}),T.loading|=4,bd(A,s,m)}A={type:"stylesheet",instance:A,count:1,state:T},y.set(_,A)}}}function cq(i,s){Ra.X(i,s);var c=Il;if(c&&i){var m=ll(c).hoistableScripts,y=$l(i),_=m.get(y);_||(_=c.querySelector(oc(y)),_||(i=v({src:i,async:!0},s),(s=zn.get(y))&&xv(i,s),_=c.createElement("script"),sr(_),Nr(_,"link",i),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},m.set(y,_))}}function uq(i,s){Ra.M(i,s);var c=Il;if(c&&i){var m=ll(c).hoistableScripts,y=$l(i),_=m.get(y);_||(_=c.querySelector(oc(y)),_||(i=v({src:i,async:!0,type:"module"},s),(s=zn.get(y))&&xv(i,s),_=c.createElement("script"),sr(_),Nr(_,"link",i),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},m.set(y,_))}}function W_(i,s,c,m){var y=(y=Q.current)?xd(y):null;if(!y)throw Error(a(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Ll(c.href),c=ll(y).hoistableStyles,m=c.get(s),m||(m={type:"style",instance:null,count:0,state:null},c.set(s,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Ll(c.href);var _=ll(y).hoistableStyles,A=_.get(i);if(A||(y=y.ownerDocument||y,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(i,A),(_=y.querySelector(lc(i)))&&!_._p&&(A.instance=_,A.state.loading=5),zn.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},zn.set(i,c),_||dq(y,i,c,A.state))),s&&m===null)throw Error(a(528,""));return A}if(s&&m!==null)throw Error(a(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=$l(c),c=ll(y).hoistableScripts,m=c.get(s),m||(m={type:"script",instance:null,count:0,state:null},c.set(s,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,i))}}function Ll(i){return'href="'+jn(i)+'"'}function lc(i){return'link[rel="stylesheet"]['+i+"]"}function X_(i){return v({},i,{"data-precedence":i.precedence,precedence:null})}function dq(i,s,c,m){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?m.loading=1:(s=i.createElement("link"),m.preload=s,s.addEventListener("load",function(){return m.loading|=1}),s.addEventListener("error",function(){return m.loading|=2}),Nr(s,"link",c),sr(s),i.head.appendChild(s))}function $l(i){return'[src="'+jn(i)+'"]'}function oc(i){return"script[async]"+i}function Z_(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var m=i.querySelector('style[data-href~="'+jn(c.href)+'"]');if(m)return s.instance=m,sr(m),m;var y=v({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return m=(i.ownerDocument||i).createElement("style"),sr(m),Nr(m,"style",y),bd(m,c.precedence,i),s.instance=m;case"stylesheet":y=Ll(c.href);var _=i.querySelector(lc(y));if(_)return s.state.loading|=4,s.instance=_,sr(_),_;m=X_(c),(y=zn.get(y))&&gv(m,y),_=(i.ownerDocument||i).createElement("link"),sr(_);var A=_;return A._p=new Promise(function(T,G){A.onload=T,A.onerror=G}),Nr(_,"link",m),s.state.loading|=4,bd(_,c.precedence,i),s.instance=_;case"script":return _=$l(c.src),(y=i.querySelector(oc(_)))?(s.instance=y,sr(y),y):(m=c,(y=zn.get(_))&&(m=v({},c),xv(m,y)),i=i.ownerDocument||i,y=i.createElement("script"),sr(y),Nr(y,"link",m),i.head.appendChild(y),s.instance=y);case"void":return null;default:throw Error(a(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(m=s.instance,s.state.loading|=4,bd(m,c.precedence,i));return s.instance}function bd(i,s,c){for(var m=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=m.length?m[m.length-1]:null,_=y,A=0;A<m.length;A++){var T=m[A];if(T.dataset.precedence===s)_=T;else if(_!==y)break}_?_.parentNode.insertBefore(i,_.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function gv(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function xv(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var yd=null;function J_(i,s,c){if(yd===null){var m=new Map,y=yd=new Map;y.set(c,m)}else y=yd,m=y.get(c),m||(m=new Map,y.set(c,m));if(m.has(i))return m;for(m.set(i,null),c=c.getElementsByTagName(i),y=0;y<c.length;y++){var _=c[y];if(!(_[So]||_[xr]||i==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var A=_.getAttribute(s)||"";A=i+A;var T=m.get(A);T?T.push(_):m.set(A,[_])}}return m}function e1(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function mq(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(i=s.disabled,typeof s.precedence=="string"&&i==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function t1(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function fq(i,s,c,m){if(c.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var y=Ll(m.href),_=s.querySelector(lc(y));if(_){s=_._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(i.count++,i=jd.bind(i),s.then(i,i)),c.state.loading|=4,c.instance=_,sr(_);return}_=s.ownerDocument||s,m=X_(m),(y=zn.get(y))&&gv(m,y),_=_.createElement("link"),sr(_);var A=_;A._p=new Promise(function(T,G){A.onload=T,A.onerror=G}),Nr(_,"link",m),c.instance=_}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(i.count++,c=jd.bind(i),s.addEventListener("load",c),s.addEventListener("error",c))}}var bv=0;function pq(i,s){return i.stylesheets&&i.count===0&&_d(i,i.stylesheets),0<i.count||0<i.imgCount?function(c){var m=setTimeout(function(){if(i.stylesheets&&_d(i,i.stylesheets),i.unsuspend){var _=i.unsuspend;i.unsuspend=null,_()}},6e4+s);0<i.imgBytes&&bv===0&&(bv=62500*YT());var y=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&_d(i,i.stylesheets),i.unsuspend)){var _=i.unsuspend;i.unsuspend=null,_()}},(i.imgBytes>bv?50:800)+s);return i.unsuspend=c,function(){i.unsuspend=null,clearTimeout(m),clearTimeout(y)}}:null}function jd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)_d(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Nd=null;function _d(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Nd=new Map,s.forEach(hq,i),Nd=null,jd.call(i))}function hq(i,s){if(!(s.state.loading&4)){var c=Nd.get(i);if(c)var m=c.get(null);else{c=new Map,Nd.set(i,c);for(var y=i.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<y.length;_++){var A=y[_];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(c.set(A.dataset.precedence,A),m=A)}m&&c.set(null,m)}y=s.instance,A=y.getAttribute("data-precedence"),_=c.get(A)||m,_===m&&c.set(null,y),c.set(A,y),this.count++,m=jd.bind(this),y.addEventListener("load",m),y.addEventListener("error",m),_?_.parentNode.insertBefore(y,_.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(y,i.firstChild)),s.state.loading|=4}}var cc={$$typeof:w,Provider:null,Consumer:null,_currentValue:R,_currentValue2:R,_threadCount:0};function vq(i,s,c,m,y,_,A,T,G){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_t(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_t(0),this.hiddenUpdates=_t(null),this.identifierPrefix=m,this.onUncaughtError=y,this.onCaughtError=_,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function r1(i,s,c,m,y,_,A,T,G,ie,xe,ye){return i=new vq(i,s,c,A,G,ie,xe,ye,T),s=1,_===!0&&(s|=24),_=an(3,null,null,s),i.current=_,_.stateNode=i,s=Zp(),s.refCount++,i.pooledCache=s,s.refCount++,_.memoizedState={element:m,isDehydrated:c,cache:s},rh(_),i}function n1(i){return i?(i=gl,i):gl}function a1(i,s,c,m,y,_){y=n1(y),m.context===null?m.context=y:m.pendingContext=y,m=gi(s),m.payload={element:c},_=_===void 0?null:_,_!==null&&(m.callback=_),c=xi(i,m,s),c!==null&&(Kr(c,i,s),Bo(c,i,s))}function i1(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function yv(i,s){i1(i,s),(i=i.alternate)&&i1(i,s)}function s1(i){if(i.tag===13||i.tag===31){var s=ss(i,67108864);s!==null&&Kr(s,i,67108864),yv(i,67108864)}}function l1(i){if(i.tag===13||i.tag===31){var s=un();s=hp(s);var c=ss(i,s);c!==null&&Kr(c,i,s),yv(i,s)}}var Sd=!0;function gq(i,s,c,m){var y=q.T;q.T=null;var _=F.p;try{F.p=2,jv(i,s,c,m)}finally{F.p=_,q.T=y}}function xq(i,s,c,m){var y=q.T;q.T=null;var _=F.p;try{F.p=8,jv(i,s,c,m)}finally{F.p=_,q.T=y}}function jv(i,s,c,m){if(Sd){var y=Nv(m);if(y===null)lv(i,s,m,wd,c),c1(i,m);else if(yq(y,i,s,c,m))m.stopPropagation();else if(c1(i,m),s&4&&-1<bq.indexOf(i)){for(;y!==null;){var _=sl(y);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var A=ba(_.pendingLanes);if(A!==0){var T=_;for(T.pendingLanes|=2,T.entangledLanes|=2;A;){var G=1<<31-qt(A);T.entanglements[1]|=G,A&=~G}aa(_),(dt&6)===0&&(ld=Re()+500,nc(0))}}break;case 31:case 13:T=ss(_,2),T!==null&&Kr(T,_,2),cd(),yv(_,2)}if(_=Nv(m),_===null&&lv(i,s,m,wd,c),_===y)break;y=_}y!==null&&m.stopPropagation()}else lv(i,s,m,null,c)}}function Nv(i){return i=Sp(i),_v(i)}var wd=null;function _v(i){if(wd=null,i=il(i),i!==null){var s=o(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=u(s),i!==null)return i;i=null}else if(c===31){if(i=d(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return wd=i,null}function o1(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(He()){case lt:return 2;case Vt:return 8;case Br:case Ur:return 32;case J:return 268435456;default:return 32}default:return 32}}var Sv=!1,zi=null,Oi=null,ki=null,uc=new Map,dc=new Map,Di=[],bq="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function c1(i,s){switch(i){case"focusin":case"focusout":zi=null;break;case"dragenter":case"dragleave":Oi=null;break;case"mouseover":case"mouseout":ki=null;break;case"pointerover":case"pointerout":uc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":dc.delete(s.pointerId)}}function mc(i,s,c,m,y,_){return i===null||i.nativeEvent!==_?(i={blockedOn:s,domEventName:c,eventSystemFlags:m,nativeEvent:_,targetContainers:[y]},s!==null&&(s=sl(s),s!==null&&s1(s)),i):(i.eventSystemFlags|=m,s=i.targetContainers,y!==null&&s.indexOf(y)===-1&&s.push(y),i)}function yq(i,s,c,m,y){switch(s){case"focusin":return zi=mc(zi,i,s,c,m,y),!0;case"dragenter":return Oi=mc(Oi,i,s,c,m,y),!0;case"mouseover":return ki=mc(ki,i,s,c,m,y),!0;case"pointerover":var _=y.pointerId;return uc.set(_,mc(uc.get(_)||null,i,s,c,m,y)),!0;case"gotpointercapture":return _=y.pointerId,dc.set(_,mc(dc.get(_)||null,i,s,c,m,y)),!0}return!1}function u1(i){var s=il(i.target);if(s!==null){var c=o(s);if(c!==null){if(s=c.tag,s===13){if(s=u(c),s!==null){i.blockedOn=s,Sj(i.priority,function(){l1(c)});return}}else if(s===31){if(s=d(c),s!==null){i.blockedOn=s,Sj(i.priority,function(){l1(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Cd(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=Nv(i.nativeEvent);if(c===null){c=i.nativeEvent;var m=new c.constructor(c.type,c);_p=m,c.target.dispatchEvent(m),_p=null}else return s=sl(c),s!==null&&s1(s),i.blockedOn=c,!1;s.shift()}return!0}function d1(i,s,c){Cd(i)&&c.delete(s)}function jq(){Sv=!1,zi!==null&&Cd(zi)&&(zi=null),Oi!==null&&Cd(Oi)&&(Oi=null),ki!==null&&Cd(ki)&&(ki=null),uc.forEach(d1),dc.forEach(d1)}function Ed(i,s){i.blockedOn===s&&(i.blockedOn=null,Sv||(Sv=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,jq)))}var Ad=null;function m1(i){Ad!==i&&(Ad=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Ad===i&&(Ad=null);for(var s=0;s<i.length;s+=3){var c=i[s],m=i[s+1],y=i[s+2];if(typeof m!="function"){if(_v(m||c)===null)continue;break}var _=sl(c);_!==null&&(i.splice(s,3),s-=3,Nh(_,{pending:!0,data:y,method:c.method,action:m},m,y))}}))}function Bl(i){function s(G){return Ed(G,i)}zi!==null&&Ed(zi,i),Oi!==null&&Ed(Oi,i),ki!==null&&Ed(ki,i),uc.forEach(s),dc.forEach(s);for(var c=0;c<Di.length;c++){var m=Di[c];m.blockedOn===i&&(m.blockedOn=null)}for(;0<Di.length&&(c=Di[0],c.blockedOn===null);)u1(c),c.blockedOn===null&&Di.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(m=0;m<c.length;m+=3){var y=c[m],_=c[m+1],A=y[Fr]||null;if(typeof _=="function")A||m1(c);else if(A){var T=null;if(_&&_.hasAttribute("formAction")){if(y=_,A=_[Fr]||null)T=A.formAction;else if(_v(y)!==null)continue}else T=A.action;typeof T=="function"?c[m+1]=T:(c.splice(m,3),m-=3),m1(c)}}}function f1(){function i(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(A){return y=A})},focusReset:"manual",scroll:"manual"})}function s(){y!==null&&(y(),y=null),m||setTimeout(c,20)}function c(){if(!m&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,y=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(c,100),function(){m=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),y!==null&&(y(),y=null)}}}function wv(i){this._internalRoot=i}zd.prototype.render=wv.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(a(409));var c=s.current,m=un();a1(c,m,i,s,null,null)},zd.prototype.unmount=wv.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;a1(i.current,2,null,i,null,null),cd(),s[al]=null}};function zd(i){this._internalRoot=i}zd.prototype.unstable_scheduleHydration=function(i){if(i){var s=_j();i={blockedOn:null,target:i,priority:s};for(var c=0;c<Di.length&&s!==0&&s<Di[c].priority;c++);Di.splice(c,0,i),c===0&&u1(i)}};var p1=t.version;if(p1!=="19.2.4")throw Error(a(527,p1,"19.2.4"));F.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=p(s),i=i!==null?h(i):null,i=i===null?null:i.stateNode,i};var Nq={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Od=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Od.isDisabled&&Od.supportsFiber)try{je=Od.inject(Nq),Te=Od}catch{}}return pc.createRoot=function(i,s){if(!l(i))throw Error(a(299));var c=!1,m="",y=jN,_=NN,A=_N;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(m=s.identifierPrefix),s.onUncaughtError!==void 0&&(y=s.onUncaughtError),s.onCaughtError!==void 0&&(_=s.onCaughtError),s.onRecoverableError!==void 0&&(A=s.onRecoverableError)),s=r1(i,1,!1,null,null,c,m,null,y,_,A,f1),i[al]=s.current,sv(i),new wv(s)},pc.hydrateRoot=function(i,s,c){if(!l(i))throw Error(a(299));var m=!1,y="",_=jN,A=NN,T=_N,G=null;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onUncaughtError!==void 0&&(_=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(T=c.onRecoverableError),c.formState!==void 0&&(G=c.formState)),s=r1(i,1,!0,s,c??null,m,y,G,_,A,T,f1),s.context=n1(null),c=s.current,m=un(),m=hp(m),y=gi(m),y.callback=null,xi(c,y,m),c=m,s.current.lanes=c,Er(s,c),aa(s),i[al]=s.current,sv(i),new zd(s)},pc.version="19.2.4",pc}var _1;function _3(){if(_1)return Ov.exports;_1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Ov.exports=N3(),Ov.exports}var S3=_3();const w3=ei(S3),C3={apiKey:"AIzaSyDgk_1graNBFkIURTJnyLZTZ1nyxi7slUo",authDomain:"pedaclic.firebaseapp.com",projectId:"pedaclic",storageBucket:"pedaclic.firebasestorage.app",messagingSenderId:"863649621890",appId:"1:863649621890:web:6ab56a8c8db111e3a9119b"},Pb=zq(C3),Vl=Oq(Pb),X=kq(Pb,{localCache:Dq({tabManager:Pq()})}),Or=Mq(Pb),E3=Object.freeze(Object.defineProperty({__proto__:null,auth:Vl,db:X,storage:Or},Symbol.toStringTag,{value:"Module"})),S1={"auth/email-already-in-use":"Cette adresse email est dj utilise.","auth/invalid-email":"Adresse email invalide.","auth/operation-not-allowed":"Opration non autorise.","auth/weak-password":"Le mot de passe doit contenir au moins 6 caractres.","auth/user-disabled":"Ce compte a t dsactiv.","auth/user-not-found":"Aucun compte associ  cette adresse email.","auth/wrong-password":"Mot de passe incorrect.","auth/too-many-requests":"Trop de tentatives. Veuillez ressayer plus tard.","auth/network-request-failed":"Erreur de connexion. Vrifiez votre connexion internet.",default:"Une erreur est survenue. Veuillez ressayer."},Mv=e=>S1[e]||S1.default,cA=g.createContext(null),A3=({children:e})=>{const[t,n]=g.useState(null),[a,l]=g.useState(!0),o=async x=>{try{const j=await Ot(Ne(X,"users",x));if(j.exists()){const N=j.data();return{uid:x,email:N.email,displayName:N.displayName,role:N.role,isPremium:N.isPremium||!1,subscriptionEnd:N.subscriptionEnd?.toDate()||null,photoURL:N.photoURL,createdAt:N.createdAt?.toDate()||new Date,lastLogin:N.lastLogin?.toDate()}}return null}catch(j){return console.error("Erreur lors de la rcupration des donnes utilisateur:",j),null}},u=async(x,j)=>{const N=Ne(X,"users",x.uid);(await Ot(N)).exists()?await Qe(N,{lastLogin:Mt()}):await pf(N,{email:x.email,displayName:x.displayName||j?.displayName||"",role:j?.role||"eleve",isPremium:!1,photoURL:x.photoURL,createdAt:Mt(),lastLogin:Mt()})},d=async(x,j)=>{try{const N=await Bq(Vl,x,j);await u(N.user)}catch(N){throw new Error(Mv(N.code))}},f=async x=>{try{if(x.password!==x.confirmPassword)throw new Error("Les mots de passe ne correspondent pas.");const j=await Rq(Vl,x.email,x.password);await Iq(j.user,{displayName:x.displayName}),await u(j.user,{displayName:x.displayName,role:x.role})}catch(j){throw j.message?j:new Error(Mv(j.code))}},p=async x=>{try{const j=new Lq;j.setCustomParameters({prompt:"select_account"});const N=await $q(Vl,j);await u(N.user,{role:x??"eleve"})}catch(j){throw new Error(Mv(j.code))}},h=async()=>{try{await qq(Vl),n(null)}catch{throw new Error("Erreur lors de la dconnexion.")}},v=async x=>{if(!t)throw new Error("Aucun utilisateur connect.");try{const j=Ne(X,"users",t.uid);await Qe(j,{...x,updatedAt:Mt()}),n(N=>N?{...N,...x}:null)}catch{throw new Error("Erreur lors de la mise  jour du profil.")}};g.useEffect(()=>{const x=Tq(Vl,async j=>{if(j){const N=await o(j.uid);n(N)}else n(null);l(!1)});return()=>x()},[]);const b={currentUser:t,loading:a,login:d,loginWithGoogle:p,register:f,logout:h,updateProfile:v};return r.jsx(cA.Provider,{value:b,children:a?r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement..."})]}):e})},rt=()=>{const e=g.useContext(cA);if(!e)throw new Error("useAuth doit tre utilis  l'intrieur d'un AuthProvider");return e},Xl=({children:e,allowedRoles:t,requirePremium:n=!1})=>{const{currentUser:a,loading:l}=rt();return l?r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Vrification des autorisations..."})]}):a?t&&!t.includes(a.role)?r.jsxs("div",{className:"error-container",children:[r.jsx("h2",{children:"Accs non autoris"}),r.jsx("p",{children:"Vous n'avez pas les permissions ncessaires pour accder  cette page."}),r.jsx("a",{href:"/",className:"btn btn-primary",children:"Retour  l'accueil"})]}):n&&!a.isPremium?r.jsxs("div",{className:"error-container premium-required",children:[r.jsx("h2",{children:"Contenu Premium"}),r.jsx("p",{children:"Cette ressource est rserve aux abonns Premium."}),r.jsxs("div",{className:"premium-cta",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"2 000 FCFA/mois"})," ou ",r.jsx("strong",{children:"20 000 FCFA/an"})]}),r.jsx("a",{href:"/premium",className:"btn btn-premium",children:"Devenir Premium"})]})]}):r.jsx(r.Fragment,{children:e}):r.jsxs("div",{className:"error-container",children:[r.jsx("h2",{children:"Accs refus"}),r.jsx("p",{children:"Vous devez tre connect pour accder  cette page."}),r.jsx("a",{href:"/connexion",className:"btn btn-primary",children:"Se connecter"})]})},dn=({children:e})=>r.jsx(Xl,{allowedRoles:["admin"],children:e}),mn=({children:e})=>r.jsx(Xl,{allowedRoles:["admin","prof"],children:e}),z3="http://localhost:3001",xa="notifications";function uA(e,t){return{id:e,destinataireId:t.destinataireId,destinataireRole:t.destinataireRole,type:t.type,titre:t.titre,message:t.message,lienAction:t.lienAction,labelAction:t.labelAction,emetteurId:t.emetteurId,emetteurNom:t.emetteurNom,entiteId:t.entiteId,entiteType:t.entiteType,statut:t.statut,canal:t.canal,emailEnvoye:t.emailEnvoye,emailErreur:t.emailErreur,createdAt:t.createdAt?.toDate()??new Date,luAt:t.luAt?.toDate()??void 0}}async function O3(e){return(await Tt(_e(X,xa),{destinataireId:e.destinataireId,destinataireRole:e.destinataireRole,type:e.type,titre:e.titre,message:e.message,lienAction:e.lienAction??null,labelAction:e.labelAction??null,emetteurId:e.emetteurId??null,emetteurNom:e.emetteurNom??null,entiteId:e.entiteId??null,entiteType:e.entiteType??null,statut:"non_lue",canal:e.canal,emailEnvoye:!1,createdAt:Oe.now()})).id}async function k3(e){try{const t=await fetch(`${z3}/api/notifications/send-email`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const a=await t.text();return{success:!1,error:`HTTP ${t.status}: ${a}`}}return await t.json()}catch(t){return{success:!1,error:t instanceof Error?t.message:"Erreur rseau inconnue"}}}async function D3(e){const t=await O3(e);let n=!1,a;if((e.canal==="email"||e.canal==="les_deux")&&e.emailDestinataire){const l=await k3({to:e.emailDestinataire,toName:e.emailDestinatairNom,type:e.type,titre:e.titre,message:e.message,lienAction:e.lienAction,labelAction:e.labelAction,emetteurNom:e.emetteurNom});n=l.success,a=l.error,await Qe(Ne(X,xa,t),{emailEnvoye:n,emailErreur:a??null})}return{notifId:t,emailEnvoye:n,emailErreur:a}}async function M3(e,t){const n=ke(_e(X,"inscriptions_groupe"),Se("groupeId","==",e),Se("statut","==","actif")),a=await ze(n);let l=0;const o=Pn(X);return a.docs.forEach(u=>{const d=u.data().eleveId,f=Ne(_e(X,xa));o.set(f,{destinataireId:d,destinataireRole:"eleve",type:t.type,titre:t.titre,message:t.message,lienAction:t.lienAction??null,labelAction:t.labelAction??null,emetteurId:t.emetteurId??null,emetteurNom:t.emetteurNom??null,entiteId:t.entiteId??null,entiteType:t.entiteType??null,statut:"non_lue",canal:t.canal,emailEnvoye:!1,createdAt:Oe.now()}),l++}),await o.commit(),l}async function P3(e,t){const n=e==="tous"?ke(_e(X,"users"),Cr(500)):ke(_e(X,"users"),Se("role","==",e),Cr(500)),a=await ze(n);let l=0;const o=Pn(X);return a.docs.forEach(u=>{const d=u.data(),f=Ne(_e(X,xa));o.set(f,{destinataireId:u.id,destinataireRole:d.role??e,type:t.type,titre:t.titre,message:t.message,lienAction:t.lienAction??null,labelAction:t.labelAction??null,emetteurId:t.emetteurId??null,emetteurNom:t.emetteurNom??null,entiteId:t.entiteId??null,entiteType:t.entiteType??null,statut:"non_lue",canal:t.canal,emailEnvoye:!1,createdAt:Oe.now()}),l++}),await o.commit(),l}async function T3(e,t={}){const{includeArchived:n=!1,limitCount:a=50}=t,l=[Se("destinataireId","==",e),Ke("createdAt","desc"),Cr(a)];n||l.splice(1,0,Se("statut","!=","archivee"));const o=ke(_e(X,xa),...l);return(await ze(o)).docs.map(d=>uA(d.id,d.data()))}function q3(e,t){const n=ke(_e(X,xa),Se("destinataireId","==",e),Se("statut","==","non_lue"),Ke("createdAt","desc"),Cr(20));return hf(n,a=>{const l=a.docs.map(o=>uA(o.id,o.data()));t(l)})}async function _x(e){await Qe(Ne(X,xa,e),{statut:"lue",luAt:Oe.now()})}async function dA(e){const t=ke(_e(X,xa),Se("destinataireId","==",e),Se("statut","==","non_lue")),n=await ze(t),a=Pn(X);n.docs.forEach(l=>{a.update(l.ref,{statut:"lue",luAt:Oe.now()})}),await a.commit()}async function R3(e){await Qe(Ne(X,xa,e),{statut:"archivee"})}async function I3(e){await en(Ne(X,xa,e))}const dm={nouveau_cours:{titreDefaut:"Nouveau cours disponible",messageDefaut:"Un nouveau cours vient d'tre publi dans votre matire.",icone:"",couleur:"#2563eb"},resultat_quiz:{titreDefaut:"Rsultat de votre quiz",messageDefaut:"Votre rsultat au quiz est disponible.",icone:"",couleur:"#10b981"},rappel_echeance:{titreDefaut:"Rappel d'chance",messageDefaut:"N'oubliez pas votre examen approche.",icone:"",couleur:"#f59e0b"},message_prof:{titreDefaut:"Message de votre professeur",messageDefaut:"",icone:"",couleur:"#8b5cf6"},annonce:{titreDefaut:"Annonce importante",messageDefaut:"",icone:"",couleur:"#ef4444"},nouveau_abonnement:{titreDefaut:"Abonnement Premium activ ",messageDefaut:"Votre abonnement Premium PedaClic est maintenant actif. Profitez de tous les contenus !",icone:"",couleur:"#f59e0b"},bienvenue:{titreDefaut:"Bienvenue sur PedaClic !",messageDefaut:"Bienvenue sur PedaClic, la plateforme ducative sngalaise. Commencez votre apprentissage ds maintenant !",icone:"",couleur:"#10b981"}},Tb={nouveau_cours:" Nouveau cours",resultat_quiz:" Rsultat quiz",rappel_echeance:" Rappel chance",message_prof:" Message prof",annonce:" Annonce",nouveau_abonnement:" Abonnement",bienvenue:" Bienvenue"},L3={eleve:" lves",parent:" Parents",prof:" Professeurs",admin:" Admins",tous:" Tous les utilisateurs"};function $3(e){const n=new Date().getTime()-e.getTime(),a=Math.floor(n/6e4),l=Math.floor(a/60),o=Math.floor(l/24);return a<1?" l'instant":a<60?`Il y a ${a} min`:l<24?`Il y a ${l}h`:o===1?"Hier":o<7?`Il y a ${o} jours`:e.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})}const B3=()=>{const{currentUser:e}=rt(),t=st(),[n,a]=g.useState([]),[l,o]=g.useState(!1),[u,d]=g.useState(!1),f=g.useRef(null);g.useEffect(()=>{if(!e)return;const x=q3(e.uid,j=>a(j));return()=>x()},[e]),g.useEffect(()=>{function x(j){f.current&&!f.current.contains(j.target)&&o(!1)}return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const p=n.length,h=g.useCallback(async x=>{await _x(x.id),o(!1),x.lienAction&&t(x.lienAction)},[t]),v=g.useCallback(async()=>{if(!(!e||u)){d(!0);try{await dA(e.uid)}finally{d(!1)}}},[e,u]),b=()=>{o(!1),t("/notifications")};return e?r.jsxs("div",{className:"notif-bell",ref:f,children:[r.jsxs("button",{className:"notif-bell__btn",onClick:()=>o(x=>!x),"aria-label":`Notifications${p>0?`  ${p} non lues`:""}`,"aria-expanded":l,"aria-haspopup":"true",children:[r.jsx("span",{className:"notif-bell__icon","aria-hidden":"true",children:""}),p>0&&r.jsx("span",{className:"notif-bell__badge","aria-hidden":"true",children:p>99?"99+":p})]}),l&&r.jsxs("div",{className:"notif-bell__dropdown",role:"dialog","aria-label":"Notifications rcentes",children:[r.jsxs("div",{className:"notif-bell__dropdown-header",children:[r.jsxs("h3",{className:"notif-bell__dropdown-title",children:[" Notifications",p>0&&r.jsxs("span",{className:"notif-bell__dropdown-count",children:[p," nouvelles"]})]}),p>0&&r.jsx("button",{className:"notif-bell__mark-all-btn",onClick:v,disabled:u,children:u?"":"Tout lire"})]}),r.jsx("div",{className:"notif-bell__list",children:n.length===0?r.jsxs("div",{className:"notif-bell__empty",children:[r.jsx("span",{className:"notif-bell__empty-icon",children:""}),r.jsx("p",{children:"Tout est  jour !"})]}):n.slice(0,5).map(x=>{const j=dm[x.type];return r.jsxs("button",{className:`notif-bell__item ${x.statut==="non_lue"?"notif-bell__item--unread":""}`,onClick:()=>h(x),children:[r.jsx("span",{className:"notif-bell__item-icon",style:{background:j.couleur+"20",color:j.couleur},"aria-hidden":"true",children:j.icone}),r.jsxs("div",{className:"notif-bell__item-content",children:[r.jsx("p",{className:"notif-bell__item-titre",children:x.titre}),r.jsx("p",{className:"notif-bell__item-message",children:x.message}),r.jsx("p",{className:"notif-bell__item-date",children:$3(x.createdAt)})]}),x.statut==="non_lue"&&r.jsx("span",{className:"notif-bell__item-dot","aria-hidden":"true"})]},x.id)})}),r.jsx("div",{className:"notif-bell__dropdown-footer",children:r.jsx("button",{className:"notif-bell__see-all-btn",onClick:b,children:"Voir toutes les notifications "})})]})]}):null},U3=()=>{const{currentUser:e,logout:t,loading:n}=rt(),a=st(),l=zb(),[o,u]=g.useState(!1),[d,f]=g.useState(!1),[p,h]=g.useState(!1),[v,b]=g.useState(null),x=g.useRef(null),j=[{path:"/",label:"Accueil",icon:r.jsx(bx,{size:18})},{path:"/disciplines",label:"Disciplines",icon:r.jsx(vn,{size:18})},{path:"/ebooks",label:"Bibliothque",icon:r.jsx(vn,{size:18})},{path:"/quiz-gratuits",label:"Quiz",icon:r.jsx(Os,{size:18}),requireAuth:!1},{path:"/quizzes",label:"Quiz Avancs",icon:r.jsx(Os,{size:18}),requireAuth:!0,requirePremium:!0},{path:"/premium",label:"Premium",icon:r.jsx(Wr,{size:18}),hideIfPremium:!0},{path:e?.role==="eleve"?"/eleve/dashboard":e?.role==="prof"?"/prof/dashboard":"/admin",label:"Tableau de bord",icon:r.jsx(h1,{size:18}),requireAuth:!0},{path:"/generateur",label:"Gnrateur IA",icon:r.jsx(Fq,{size:18}),requireAuth:!0,requirePremium:!0},{path:"/parent/dashboard",label:"Espace Parent",icon:r.jsx(ks,{size:18}),requireAuth:!0,requireRole:["parent"]}];g.useEffect(()=>{const P=D=>{x.current&&!x.current.contains(D.target)&&f(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]),g.useEffect(()=>{const P=L=>{L.preventDefault(),b(L)},D=()=>b(null);return window.addEventListener("beforeinstallprompt",P),window.addEventListener("appinstalled",D),()=>{window.removeEventListener("beforeinstallprompt",P),window.removeEventListener("appinstalled",D)}},[]);const N=g.useCallback(async()=>{if(!v)return;await v.prompt();const{outcome:P}=await v.userChoice;P==="accepted"&&b(null)},[v]);g.useEffect(()=>{u(!1),f(!1)},[l.pathname]),g.useEffect(()=>(o?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[o]);const S=async()=>{try{h(!0),await t(),f(!1),a("/")}catch(P){console.error("Erreur lors de la dconnexion:",P)}finally{h(!1)}},C=()=>{u(!o)},E=()=>{f(!d)},w=P=>!(P.requireAuth&&!e||P.requirePremium&&e&&!e.isPremium||P.hideIfPremium&&(e?.isPremium||e?.role==="admin")||P.requireRole&&e&&!P.requireRole.includes(e.role)),z=P=>P==="/"?l.pathname==="/":l.pathname.startsWith(P),k=P=>({admin:"Administrateur",prof:"Professeur",eleve:"lve",parent:"Parent"})[P]||P,O=()=>e?e.displayName?e.displayName.split(" ").map(D=>D[0]).join("").toUpperCase().slice(0,2):e.email[0].toUpperCase():"?";return r.jsxs("header",{className:"header",children:[r.jsxs("div",{className:"header__container",children:[r.jsxs(Ge,{to:"/",className:"header__logo",children:[r.jsx(Os,{className:"header__logo-icon",size:32}),r.jsxs("div",{className:"header__logo-text",children:[r.jsx("span",{className:"header__logo-name",children:"PedaClic"}),r.jsx("span",{className:"header__logo-tagline",children:"L'cole en un clic"})]})]}),r.jsx("nav",{className:"header__nav header__nav--desktop",children:r.jsx("ul",{className:"header__nav-list",children:j.map(P=>w(P)&&r.jsx("li",{className:"header__nav-item",children:r.jsxs(Ge,{to:P.path,className:`header__nav-link ${z(P.path)?"header__nav-link--active":""} ${P.hideIfPremium?"header__nav-link--premium-cta":""}`,children:[P.icon,r.jsx("span",{children:P.label}),P.requirePremium&&r.jsx(Cc,{size:14,className:"header__premium-badge"})]})},P.path))})}),r.jsxs("div",{className:"header__actions",children:[v&&r.jsxs("button",{className:"header__install-btn",onClick:N,title:"Installer PedaClic sur cet appareil",children:[r.jsx(iA,{size:16}),r.jsx("span",{children:"Installer"})]}),n?r.jsx("div",{className:"header__loading",children:r.jsx("div",{className:"header__spinner"})}):e?r.jsxs(r.Fragment,{children:[r.jsx(B3,{}),r.jsxs("div",{className:"header__user",ref:x,children:[e.isPremium&&r.jsxs("span",{className:"header__premium-tag",children:[r.jsx(Cc,{size:14}),"Premium"]}),r.jsxs("button",{className:"header__user-button",onClick:E,"aria-expanded":d,"aria-haspopup":"true",children:[r.jsx("div",{className:"header__avatar",children:e.photoURL?r.jsx("img",{src:e.photoURL,alt:e.displayName||"Avatar",className:"header__avatar-img"}):r.jsx("span",{className:"header__avatar-initials",children:O()})}),r.jsx("span",{className:"header__user-name",children:e.displayName||e.email.split("@")[0]}),r.jsx(cm,{size:16,className:`header__chevron ${d?"header__chevron--open":""}`})]}),d&&r.jsxs("div",{className:"header__dropdown",children:[r.jsxs("div",{className:"header__dropdown-header",children:[r.jsx("p",{className:"header__dropdown-email",children:e.email}),r.jsx("span",{className:`header__dropdown-role header__dropdown-role--${e.role}`,children:k(e.role)})]}),r.jsx("div",{className:"header__dropdown-divider"}),r.jsxs("nav",{className:"header__dropdown-nav",children:[r.jsxs(Ge,{to:e.role==="eleve"?"/eleve/dashboard":e.role==="prof"?"/prof/dashboard":"/admin",className:"header__dropdown-link",children:[r.jsx(h1,{size:18}),r.jsx("span",{children:"Tableau de bord"})]}),e.role==="eleve"&&r.jsxs(Ge,{to:"/eleve/suivi",className:"header__dropdown-link",children:[r.jsx(ks,{size:18}),r.jsx("span",{children:"Mes points  amliorer"})]}),e.role==="parent"&&r.jsxs(Ge,{to:"/parent/dashboard",className:"header__dropdown-link",children:[r.jsx(ks,{size:18}),r.jsx("span",{children:"Espace Parent"})]}),r.jsxs(Ge,{to:"/profil",className:"header__dropdown-link",children:[r.jsx(Gq,{size:18}),r.jsx("span",{children:"Mon profil"})]}),e.role==="admin"&&r.jsxs(Ge,{to:"/admin",className:"header__dropdown-link",children:[r.jsx(Hq,{size:18}),r.jsx("span",{children:"Administration"})]}),!e.isPremium&&r.jsxs(Ge,{to:"/premium",className:"header__dropdown-link header__dropdown-link--premium",children:[r.jsx(Cc,{size:18}),r.jsx("span",{children:"Passer Premium"})]})]}),r.jsx("div",{className:"header__dropdown-divider"}),r.jsxs("button",{className:"header__dropdown-logout",onClick:S,disabled:p,children:[r.jsx(v1,{size:18}),r.jsx("span",{children:p?"Dconnexion...":"Se dconnecter"})]})]})]})]}):r.jsxs("div",{className:"header__auth-buttons",children:[r.jsx(Ge,{to:"/connexion",className:"header__btn header__btn--outline",children:"Connexion"}),r.jsx(Ge,{to:"/inscription",className:"header__btn header__btn--primary",children:"S'inscrire"})]}),r.jsx("button",{className:"header__mobile-toggle",onClick:C,"aria-label":o?"Fermer le menu":"Ouvrir le menu","aria-expanded":o,children:o?r.jsx($i,{size:24}):r.jsx(Qq,{size:24})})]})]}),r.jsxs("div",{className:`header__mobile-menu ${o?"header__mobile-menu--open":""}`,children:[r.jsx("div",{className:"header__mobile-overlay",onClick:()=>u(!1)}),r.jsxs("div",{className:"header__mobile-content",children:[r.jsx("nav",{className:"header__mobile-nav",children:r.jsx("ul",{className:"header__mobile-list",children:j.map(P=>w(P)&&r.jsx("li",{className:"header__mobile-item",children:r.jsxs(Ge,{to:P.path,className:`header__mobile-link ${z(P.path)?"header__mobile-link--active":""} ${P.hideIfPremium?"header__mobile-link--premium-cta":""}`,children:[P.icon,r.jsx("span",{children:P.label}),P.requirePremium&&r.jsx(Cc,{size:14,className:"header__premium-badge"})]})},P.path))})}),!e&&r.jsxs("div",{className:"header__mobile-auth",children:[r.jsx(Ge,{to:"/connexion",className:"header__btn header__btn--outline header__btn--block",children:"Connexion"}),r.jsx(Ge,{to:"/inscription",className:"header__btn header__btn--primary header__btn--block",children:"S'inscrire"})]}),e&&r.jsxs("div",{className:"header__mobile-user",children:[r.jsxs("div",{className:"header__mobile-user-info",children:[r.jsx("div",{className:"header__avatar header__avatar--large",children:e.photoURL?r.jsx("img",{src:e.photoURL,alt:e.displayName||"Avatar",className:"header__avatar-img"}):r.jsx("span",{className:"header__avatar-initials",children:O()})}),r.jsxs("div",{className:"header__mobile-user-details",children:[r.jsx("p",{className:"header__mobile-user-name",children:e.displayName||e.email.split("@")[0]}),r.jsx("p",{className:"header__mobile-user-email",children:e.email})]})]}),r.jsxs("button",{className:"header__mobile-logout",onClick:S,disabled:p,children:[r.jsx(v1,{size:18}),r.jsx("span",{children:p?"Dconnexion...":"Se dconnecter"})]})]})]})]})]})},F3=()=>{const e=new Date().getFullYear(),{currentUser:t}=rt(),a=[{label:"Accueil",path:"/"},{label:"Disciplines",path:"/disciplines"},{label:"Quiz Avancs",path:"/quizzes"},{label:"Tarifs",path:"/premium"},{label:"Tableau de bord",path:(()=>{if(!t)return"/connexion";switch(t.role){case"eleve":return"/eleve/dashboard";case"prof":return"/prof/dashboard";case"parent":return"/parent/dashboard";case"admin":return"/admin";default:return"/connexion"}})()}],l=[{label:"Cours en ligne",path:"/cours",badge:"Nouveau",icon:r.jsx(Zq,{size:14})},{label:"Exercices corrigs",path:"/disciplines"},{label:"Annales examens",path:"/disciplines"},{label:"Fiches de rvision",path:"/disciplines"}],o=[{name:"Facebook",url:"https://facebook.com/pedaclic",icon:r.jsx(Jq,{size:20})},{name:"Twitter",url:"https://twitter.com/pedaclic",icon:r.jsx(e3,{size:20})},{name:"Instagram",url:"https://instagram.com/pedaclic",icon:r.jsx(t3,{size:20})},{name:"LinkedIn",url:"https://linkedin.com/company/pedaclic",icon:r.jsx(r3,{size:20})},{name:"YouTube",url:"https://youtube.com/@pedaclic",icon:r.jsx(n3,{size:20})}];return r.jsxs("footer",{className:"footer",children:[r.jsx("div",{className:"footer__main",children:r.jsxs("div",{className:"footer__container",children:[r.jsxs("div",{className:"footer__column footer__column--about",children:[r.jsxs(Ge,{to:"/",className:"footer__logo",children:[r.jsx(Os,{className:"footer__logo-icon",size:36}),r.jsxs("div",{className:"footer__logo-text",children:[r.jsx("span",{className:"footer__logo-name",children:"PedaClic"}),r.jsx("span",{className:"footer__logo-tagline",children:"L'cole en un clic"})]})]}),r.jsx("p",{className:"footer__description",children:"PedaClic est la plateforme ducative de rfrence au Sngal. Nous accompagnons les lves du collge au lyce avec des cours, exercices et quiz de qualit."}),r.jsxs("div",{className:"footer__stats",children:[r.jsxs("div",{className:"footer__stat",children:[r.jsx(vn,{size:18}),r.jsx("span",{children:"500+ cours"})]}),r.jsxs("div",{className:"footer__stat",children:[r.jsx(em,{size:18}),r.jsx("span",{children:"10 000+ lves"})]})]})]}),r.jsxs("div",{className:"footer__column",children:[r.jsxs("h3",{className:"footer__title",children:[r.jsx("span",{className:"footer__title-icon",children:""}),"Plateforme"]}),r.jsx("nav",{className:"footer__nav",children:r.jsx("ul",{className:"footer__list",children:a.map((u,d)=>r.jsx("li",{className:"footer__item",children:r.jsx(Ge,{to:u.path,className:"footer__link",children:u.label})},d))})})]}),r.jsxs("div",{className:"footer__column",children:[r.jsxs("h3",{className:"footer__title",children:[r.jsx("span",{className:"footer__title-icon",children:""}),"Ressources"]}),r.jsx("nav",{className:"footer__nav",children:r.jsx("ul",{className:"footer__list",children:l.map((u,d)=>r.jsx("li",{className:"footer__item",children:r.jsxs(Ge,{to:u.path,className:`footer__link${u.badge?" footer__link--new":""}`,children:[u.icon&&r.jsx("span",{className:"footer__link-icon",children:u.icon}),u.label,u.badge&&r.jsx("span",{className:"footer__badge",children:u.badge})]})},d))})})]}),r.jsxs("div",{className:"footer__column",children:[r.jsxs("h3",{className:"footer__title",children:[r.jsx("span",{className:"footer__title-icon",children:""}),"Contact"]}),r.jsxs("div",{className:"footer__contact",children:[r.jsxs("a",{href:"mailto:contact@pedaclic.sn",className:"footer__contact-item",children:[r.jsx(Vq,{size:16,className:"footer__contact-icon"}),r.jsx("span",{children:"contact@pedaclic.sn"})]}),r.jsxs("a",{href:"tel:+221770000000",className:"footer__contact-item",children:[r.jsx(Yq,{size:16,className:"footer__contact-icon"}),r.jsx("span",{children:"+221 77 000 00 00"})]}),r.jsxs("div",{className:"footer__contact-item",children:[r.jsx(Kq,{size:16,className:"footer__contact-icon"}),r.jsx("span",{children:"Dakar, Sngal"})]})]}),r.jsxs("div",{className:"footer__social",children:[r.jsx("h4",{className:"footer__social-title",children:"Suivez-nous"}),r.jsx("div",{className:"footer__social-links",children:o.map((u,d)=>r.jsx("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",className:"footer__social-link",title:u.name,children:u.icon},d))})]})]})]})}),r.jsx("div",{className:"footer__bottom",children:r.jsxs("div",{className:"footer__container footer__bottom-content",children:[r.jsxs("p",{className:"footer__copyright",children:[" ",e," PedaClic. Tous droits rservs."]}),r.jsxs("p",{className:"footer__made-with",children:["Fait avec ",r.jsx(Wq,{size:14,className:"footer__heart"})," au Sngal "]}),r.jsxs("nav",{className:"footer__legal",children:[r.jsxs(Ge,{to:"/mentions-legales",className:"footer__legal-link",children:[r.jsx(Xq,{size:14})," Mentions lgales"]}),r.jsxs(Ge,{to:"/confidentialite",className:"footer__legal-link",children:[r.jsx(Db,{size:14})," Confidentialit"]}),r.jsxs(Ge,{to:"/aide",className:"footer__legal-link",children:[r.jsx(tm,{size:14})," Aide"]})]})]})})]})},mt=({children:e,hideHeader:t=!1,hideFooter:n=!1,className:a=""})=>r.jsxs("div",{className:"layout",children:[!t&&r.jsx(U3,{}),r.jsx("main",{className:`layout__main ${t?"":"layout__main--with-header"} ${a}`,children:e}),!n&&r.jsx(F3,{})]}),G3=()=>{const{currentUser:e}=rt();return r.jsxs("div",{className:"home-page",children:[r.jsxs("section",{className:"home-page__hero",children:[r.jsxs("div",{className:"home-page__hero-content",children:[r.jsxs("div",{className:"home-page__hero-badge",children:[r.jsx(Wr,{size:14}),r.jsx("span",{children:"Plateforme N1 au Sngal"})]}),r.jsxs("h1",{className:"home-page__hero-title",children:["Russis tes examens avec",r.jsx("span",{className:"home-page__hero-highlight",children:" PedaClic"})]}),r.jsx("p",{className:"home-page__hero-subtitle",children:"La plateforme ducative qui accompagne les lves sngalais du collge au lyce avec des cours, exercices et quiz de qualit."}),r.jsx("div",{className:"home-page__hero-cta",children:e?r.jsxs(Ge,{to:e.role==="eleve"?"/eleve/dashboard":e.role==="prof"?"/prof/dashboard":"/admin",className:"home-page__btn home-page__btn--primary",children:["  Accder  mon espace",r.jsx(js,{size:20})]}):r.jsxs(r.Fragment,{children:[r.jsxs(Ge,{to:"/register",className:"home-page__btn home-page__btn--primary",children:["Commencer gratuitement",r.jsx(js,{size:20})]}),r.jsxs(Ge,{to:"/disciplines",className:"home-page__btn home-page__btn--outline",children:[r.jsx(Wl,{size:18}),"Dcouvrir les cours"]})]})}),r.jsxs("div",{className:"home-page__hero-stats",children:[r.jsxs("div",{className:"home-page__hero-stat",children:[r.jsx("strong",{children:"10 000+"}),r.jsx("span",{children:"lves inscrits"})]}),r.jsxs("div",{className:"home-page__hero-stat",children:[r.jsx("strong",{children:"500+"}),r.jsx("span",{children:"Cours disponibles"})]}),r.jsxs("div",{className:"home-page__hero-stat",children:[r.jsx("strong",{children:"95%"}),r.jsx("span",{children:"Taux de russite"})]})]})]}),r.jsx("div",{className:"home-page__hero-image",children:r.jsxs("div",{className:"home-page__hero-illustration",children:[r.jsx(Os,{size:120}),r.jsx("div",{className:"home-page__hero-floating home-page__hero-floating--1",children:""}),r.jsx("div",{className:"home-page__hero-floating home-page__hero-floating--2",children:""}),r.jsx("div",{className:"home-page__hero-floating home-page__hero-floating--3",children:""})]})})]}),r.jsx("section",{className:"home-page__levels",children:r.jsxs("div",{className:"home-page__container",children:[r.jsx("h2",{className:"home-page__section-title",children:"Tous les niveaux, toutes les matires"}),r.jsx("p",{className:"home-page__section-subtitle",children:"Du collge au lyce, prpare tes examens avec confiance"}),r.jsxs("div",{className:"home-page__levels-grid",children:[r.jsxs(Ge,{to:"/disciplines?niveau=college",className:"home-page__level-card",children:[r.jsx("div",{className:"home-page__level-icon home-page__level-icon--college",children:""}),r.jsx("h3",{children:"Collge"}),r.jsx("p",{children:"6me  3me"}),r.jsxs("ul",{children:[r.jsxs("li",{children:[r.jsx(Bt,{size:16})," Prparation au BFEM"]}),r.jsxs("li",{children:[r.jsx(Bt,{size:16})," 9 matires disponibles"]}),r.jsxs("li",{children:[r.jsx(Bt,{size:16})," Exercices corrigs"]})]}),r.jsxs("span",{className:"home-page__level-link",children:["Voir les cours ",r.jsx(js,{size:16})]})]}),r.jsxs(Ge,{to:"/disciplines?niveau=lycee",className:"home-page__level-card",children:[r.jsx("div",{className:"home-page__level-icon home-page__level-icon--lycee",children:""}),r.jsx("h3",{children:"Lyce"}),r.jsx("p",{children:"2nde  Terminale"}),r.jsxs("ul",{children:[r.jsxs("li",{children:[r.jsx(Bt,{size:16})," Prparation au BAC"]}),r.jsxs("li",{children:[r.jsx(Bt,{size:16})," 12 matires disponibles"]}),r.jsxs("li",{children:[r.jsx(Bt,{size:16})," Annales d'examens"]})]}),r.jsxs("span",{className:"home-page__level-link",children:["Voir les cours ",r.jsx(js,{size:16})]})]})]})]})}),r.jsx("section",{className:"home-page__features",children:r.jsxs("div",{className:"home-page__container",children:[r.jsx("h2",{className:"home-page__section-title",children:"Pourquoi choisir PedaClic ?"}),r.jsx("p",{className:"home-page__section-subtitle",children:"Des outils modernes pour une ducation de qualit"}),r.jsxs("div",{className:"home-page__features-grid",children:[r.jsxs("div",{className:"home-page__feature-card",children:[r.jsx("div",{className:"home-page__feature-icon",children:r.jsx(vn,{size:28})}),r.jsx("h3",{children:"Cours complets"}),r.jsx("p",{children:"Des cours structurs et conformes au programme sngalais, rdigs par des enseignants expriments."})]}),r.jsxs("div",{className:"home-page__feature-card",children:[r.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--secondary",children:r.jsx(sA,{size:28})}),r.jsx("h3",{children:"Quiz interactifs"}),r.jsx("p",{children:"Testez vos connaissances avec des quiz adapts  chaque niveau et obtenez un feedback instantan."})]}),r.jsxs("div",{className:"home-page__feature-card",children:[r.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--warning",children:r.jsx(lA,{size:28})}),r.jsx("h3",{children:"Suivi de progression"}),r.jsx("p",{children:"Visualisez vos progrs et identifiez vos points faibles pour cibler vos rvisions."})]}),r.jsxs("div",{className:"home-page__feature-card",children:[r.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--success",children:r.jsx(Db,{size:28})}),r.jsx("h3",{children:"Contenu vrifi"}),r.jsx("p",{children:"Tous nos contenus sont valids par des professeurs certifis pour garantir leur qualit."})]}),r.jsxs("div",{className:"home-page__feature-card",children:[r.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--info",children:r.jsx(no,{size:28})}),r.jsx("h3",{children:"Accessible 24/7"}),r.jsx("p",{children:"tudiez  votre rythme, o que vous soyez, sur ordinateur, tablette ou smartphone."})]}),r.jsxs("div",{className:"home-page__feature-card",children:[r.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--premium",children:r.jsx(Qi,{size:28})}),r.jsx("h3",{children:"Certificats"}),r.jsx("p",{children:"Obtenez des certificats de russite pour valoriser vos comptences acquises."})]})]})]})}),r.jsx("section",{className:"home-page__premium",children:r.jsx("div",{className:"home-page__container",children:r.jsxs("div",{className:"home-page__premium-content",children:[r.jsxs("div",{className:"home-page__premium-text",children:[r.jsx("span",{className:"home-page__premium-badge",children:" Premium"}),r.jsx("h2",{children:"Passez  la vitesse suprieure"}),r.jsxs("p",{children:["Accdez  tous les quiz, exercices corrigs et ressources exclusives pour seulement ",r.jsx("strong",{children:"2 000 FCFA/mois"}),"."]}),r.jsxs("ul",{className:"home-page__premium-features",children:[r.jsxs("li",{children:[r.jsx(Bt,{size:18})," Quiz illimits dans toutes les matires"]}),r.jsxs("li",{children:[r.jsx(Bt,{size:18})," Corrections dtailles des exercices"]}),r.jsxs("li",{children:[r.jsx(Bt,{size:18})," Annales des examens (BFEM, BAC)"]}),r.jsxs("li",{children:[r.jsx(Bt,{size:18})," Support prioritaire"]})]}),r.jsxs(Ge,{to:"/premium",className:"home-page__btn home-page__btn--premium",children:["Dcouvrir Premium",r.jsx(js,{size:20})]})]}),r.jsx("div",{className:"home-page__premium-pricing",children:r.jsxs("div",{className:"home-page__pricing-card",children:[r.jsx("span",{className:"home-page__pricing-popular",children:"Plus populaire"}),r.jsx("h3",{children:"Abonnement Annuel"}),r.jsxs("div",{className:"home-page__pricing-price",children:[r.jsx("span",{className:"home-page__pricing-amount",children:"20 000"}),r.jsx("span",{className:"home-page__pricing-currency",children:"FCFA"}),r.jsx("span",{className:"home-page__pricing-period",children:"/an"})]}),r.jsx("p",{className:"home-page__pricing-save",children:"conomisez 4 000 FCFA vs mensuel"}),r.jsx(Ge,{to:"/premium",className:"home-page__btn home-page__btn--primary home-page__btn--block",children:"Choisir ce plan"})]})})]})})}),r.jsx("section",{className:"home-page__testimonials",children:r.jsxs("div",{className:"home-page__container",children:[r.jsx("h2",{className:"home-page__section-title",children:"Ce qu'en disent nos lves"}),r.jsxs("div",{className:"home-page__testimonials-grid",children:[r.jsxs("div",{className:"home-page__testimonial-card",children:[r.jsx("div",{className:"home-page__testimonial-stars",children:[1,2,3,4,5].map(t=>r.jsx(Wr,{size:16,fill:"#f59e0b",color:"#f59e0b"},t))}),r.jsx("p",{className:"home-page__testimonial-text",children:`"Grce  PedaClic, j'ai obtenu mon BFEM avec mention. Les quiz m'ont vraiment aid  me prparer !"`}),r.jsxs("div",{className:"home-page__testimonial-author",children:[r.jsx("div",{className:"home-page__testimonial-avatar",children:"FA"}),r.jsxs("div",{children:[r.jsx("strong",{children:"Fatou Adara"}),r.jsx("span",{children:"lve en 3me - Dakar"})]})]})]}),r.jsxs("div",{className:"home-page__testimonial-card",children:[r.jsx("div",{className:"home-page__testimonial-stars",children:[1,2,3,4,5].map(t=>r.jsx(Wr,{size:16,fill:"#f59e0b",color:"#f59e0b"},t))}),r.jsx("p",{className:"home-page__testimonial-text",children:`"Les cours de maths sont trs bien expliqus. J'ai enfin compris les quations du second degr !"`}),r.jsxs("div",{className:"home-page__testimonial-author",children:[r.jsx("div",{className:"home-page__testimonial-avatar",children:"MD"}),r.jsxs("div",{children:[r.jsx("strong",{children:"Moussa Diallo"}),r.jsx("span",{children:"lve en Terminale S - This"})]})]})]}),r.jsxs("div",{className:"home-page__testimonial-card",children:[r.jsx("div",{className:"home-page__testimonial-stars",children:[1,2,3,4,5].map(t=>r.jsx(Wr,{size:16,fill:"#f59e0b",color:"#f59e0b"},t))}),r.jsx("p",{className:"home-page__testimonial-text",children:`"Je recommande PedaClic  tous les parents. Ma fille a beaucoup progress depuis qu'elle l'utilise."`}),r.jsxs("div",{className:"home-page__testimonial-author",children:[r.jsx("div",{className:"home-page__testimonial-avatar",children:"AN"}),r.jsxs("div",{children:[r.jsx("strong",{children:"Aminata Ndiaye"}),r.jsx("span",{children:"Parent d'lve - Saint-Louis"})]})]})]})]})]})}),r.jsx("section",{className:"home-page__final-cta",children:r.jsxs("div",{className:"home-page__container",children:[r.jsx("h2",{children:"Prt  russir ?"}),r.jsx("p",{children:"Rejoignez les milliers d'lves qui font confiance  PedaClic"}),!e&&r.jsxs(Ge,{to:"/register",className:"home-page__btn home-page__btn--large",children:["Crer mon compte gratuit",r.jsx(js,{size:24})]})]})})]})},mA=[{value:"6eme",label:"6me"},{value:"5eme",label:"5me"},{value:"4eme",label:"4me"},{value:"3eme",label:"3me"}],fA=[{value:"2nde",label:"2nde"},{value:"1ere",label:"1re"},{value:"Terminale",label:"Terminale"}],pA=[{value:"debutant",label:"Dbutant"},{value:"intermediaire",label:"Intermdiaire"},{value:"avance",label:"Avanc"}],hA={college:"Collge",lycee:"Lyce",formation_libre:"Formation libre"};function w1(e){switch(e){case"college":return mA;case"lycee":return fA;case"formation_libre":return pA;default:return[]}}function vA(e){return[...mA,...fA,...pA].find(n=>n.value===e)?.label||e}const C1=[{niveau:"college",icon:"",label:"Collge",color:"#2b6cb0",bgLight:"#ebf8ff"},{niveau:"lycee",icon:"",label:"Lyce",color:"#975a16",bgLight:"#fefcbf"},{niveau:"formation_libre",icon:"",label:"Formation libre",color:"#276749",bgLight:"#f0fff4"}],H3=()=>{const[e,t]=g.useState("college"),[n,a]=g.useState([]),[l,o]=g.useState(!0),u=st();g.useEffect(()=>{const p=ke(_e(X,"disciplines"),Ke("ordre")),h=hf(p,v=>{const b=v.docs.map(x=>({id:x.id,...x.data(),createdAt:x.data().createdAt?.toDate()||new Date,updatedAt:x.data().updatedAt?.toDate()||new Date}));a(b),o(!1)});return()=>h()},[]);const d=n.filter(p=>p.niveau===e),f=C1.find(p=>p.niveau===e);return r.jsxs("div",{style:{maxWidth:"1100px",margin:"0 auto",padding:"24px"},children:[r.jsxs("div",{style:{marginBottom:"32px",textAlign:"center"},children:[r.jsx("h1",{style:{fontSize:"1.8rem",fontWeight:700,color:"#1a365d",marginBottom:"8px"},children:" Disciplines"}),r.jsx("p",{style:{color:"#718096",fontSize:"1rem"},children:"Explorez les disciplines disponibles sur PedaClic"})]}),r.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"12px",marginBottom:"32px",flexWrap:"wrap"},children:C1.map(p=>{const h=e===p.niveau;return r.jsxs("button",{onClick:()=>t(p.niveau),style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 28px",borderRadius:"12px",border:`2px solid ${h?p.color:"#e2e8f0"}`,background:h?p.bgLight:"#fff",color:h?p.color:"#718096",fontSize:"1rem",fontWeight:h?700:500,cursor:"pointer",transition:"all 0.25s ease",boxShadow:h?`0 2px 8px ${p.color}20`:"none"},children:[r.jsx("span",{style:{fontSize:"1.2rem"},children:p.icon}),p.label]},p.niveau)})}),l&&r.jsx("div",{style:{textAlign:"center",padding:"48px",color:"#a0aec0"},children:"Chargement des disciplines..."}),!l&&d.length===0&&r.jsxs("div",{style:{textAlign:"center",padding:"48px",background:"#f7fafc",borderRadius:"12px",border:"1px dashed #e2e8f0"},children:[r.jsx("p",{style:{fontSize:"2rem",marginBottom:"8px"},children:""}),r.jsxs("p",{style:{color:"#a0aec0",fontSize:"1rem"},children:["Aucune discipline disponible en ",hA[e]," pour le moment."]})]}),!l&&d.length>0&&r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:d.map(p=>r.jsxs("div",{onClick:()=>u(`/disciplines/${p.id}`),style:{background:"#fff",borderRadius:"12px",padding:"24px",border:"1px solid #e2e8f0",boxShadow:"0 2px 6px rgba(0,0,0,0.05)",cursor:"pointer",transition:"all 0.2s ease",borderTop:`3px solid ${p.couleur||f.color}`},onMouseEnter:h=>{h.currentTarget.style.transform="translateY(-2px)",h.currentTarget.style.boxShadow="0 6px 16px rgba(0,0,0,0.1)"},onMouseLeave:h=>{h.currentTarget.style.transform="translateY(0)",h.currentTarget.style.boxShadow="0 2px 6px rgba(0,0,0,0.05)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"12px"},children:[r.jsx("span",{style:{fontSize:"1.8rem"},children:p.icone||""}),r.jsx("h3",{style:{fontSize:"1.1rem",fontWeight:600,color:"#2d3748",margin:0},children:p.nom})]}),p.description&&r.jsx("p",{style:{fontSize:"0.875rem",color:"#718096",marginBottom:"12px",lineHeight:1.5},children:p.description.length>100?`${p.description.slice(0,100)}...`:p.description}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginBottom:"8px"},children:r.jsx("span",{style:{display:"inline-block",padding:"2px 10px",borderRadius:"10px",fontSize:"0.75rem",fontWeight:500,background:f.bgLight,color:f.color},children:vA(p.classe)})}),p.coefficient!==void 0&&r.jsxs("p",{style:{fontSize:"0.8rem",color:"#a0aec0"},children:["Coefficient : ",p.coefficient]})]},p.id))})]})},hc="disciplines",E1=e=>{const t=e.data();return{id:e.id,nom:t.nom,niveau:t.niveau,classe:t.classe,ordre:t.ordre,coefficient:t.coefficient,couleur:t.couleur,icone:t.icone,description:t.description,createdAt:t.createdAt?.toDate()||new Date,updatedAt:t.updatedAt?.toDate()}},Ki={async getAll(e){try{const t=[Ke("ordre","asc")];e?.niveau&&t.unshift(Se("niveau","==",e.niveau)),e?.classe&&t.unshift(Se("classe","==",e.classe));const n=ke(_e(X,hc),...t);return(await ze(n)).docs.map(E1)}catch(t){throw console.error("Erreur lors de la rcupration des disciplines:",t),new Error("Impossible de rcuprer les disciplines")}},async getById(e){try{const t=Ne(X,hc,e),n=await Ot(t);return n.exists()?E1(n):null}catch(t){throw console.error("Erreur lors de la rcupration de la discipline:",t),new Error("Impossible de rcuprer la discipline")}},async getByNiveau(e){return this.getAll({niveau:e})},async getByClasse(e){return this.getAll({classe:e})},async create(e){try{return(await Tt(_e(X,hc),{...e,createdAt:Mt(),updatedAt:Mt()})).id}catch(t){throw console.error("Erreur lors de la cration de la discipline:",t),new Error("Impossible de crer la discipline")}},async update(e,t){try{const n=Ne(X,hc,e);await Qe(n,{...t,updatedAt:Mt()})}catch(n){throw console.error("Erreur lors de la mise  jour de la discipline:",n),new Error("Impossible de mettre  jour la discipline")}},async delete(e){try{const t=Ne(X,hc,e);await en(t)}catch(t){throw console.error("Erreur lors de la suppression de la discipline:",t),new Error("Impossible de supprimer la discipline")}},async exists(e){return await this.getById(e)!==null},async countByNiveau(e){return(await this.getByNiveau(e)).length}},Q3="modulepreload",V3=function(e){return"/"+e},A1={},z1=function(t,n,a){let l=Promise.resolve();if(n&&n.length>0){let f=function(p){return Promise.all(p.map(h=>Promise.resolve(h).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=u?.nonce||u?.getAttribute("nonce");l=f(n.map(p=>{if(p=V3(p),p in A1)return;A1[p]=!0;const h=p.endsWith(".css"),v=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${v}`))return;const b=document.createElement("link");if(b.rel=h?"stylesheet":Q3,h||(b.as="script"),b.crossOrigin="",b.href=p,d&&b.setAttribute("nonce",d),document.head.appendChild(b),h)return new Promise((x,j)=>{b.addEventListener("load",x),b.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return l.then(u=>{for(const d of u||[])d.status==="rejected"&&o(d.reason);return t().catch(o)})},bs="ressources",Y3="ressources",O1=e=>{const t=e.data();return{id:e.id,disciplineId:t.disciplineId,titre:t.titre,type:t.type,contenu:t.contenu,description:t.description,isPremium:t.isPremium||!1,ordre:t.ordre||0,chapitre:t.chapitre,fichierURL:t.fichierURL,dureeEstimee:t.dureeEstimee,tags:t.tags||[],auteurId:t.auteurId,createdAt:t.createdAt?.toDate()||new Date,updatedAt:t.updatedAt?.toDate()}},K3=e=>{const t=Date.now(),n=e.split(".").pop();return`${e.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9]/g,"_")}_${t}.${n}`},Ia={async getAll(e,t){try{const n=[Ke("ordre","asc")];e?.disciplineId&&n.unshift(Se("disciplineId","==",e.disciplineId)),e?.chapitreId&&n.unshift(Se("chapitre","==",e.chapitreId)),e?.type&&n.unshift(Se("type","==",e.type)),e?.isPremium!==void 0&&n.unshift(Se("isPremium","==",e.isPremium)),e?.auteurId&&n.unshift(Se("auteurId","==",e.auteurId)),t&&n.push(Cr(t));const a=ke(_e(X,bs),...n);return(await ze(a)).docs.map(O1)}catch(n){throw console.error("Erreur lors de la rcupration des ressources:",n),new Error("Impossible de rcuprer les ressources")}},async getById(e){try{const t=Ne(X,bs,e),n=await Ot(t);return n.exists()?O1(n):null}catch(t){throw console.error("Erreur lors de la rcupration de la ressource:",t),new Error("Impossible de rcuprer la ressource")}},async getByDiscipline(e){return this.getAll({disciplineId:e})},async getByChapitre(e){return this.getAll({chapitreId:e})},async getByType(e){return this.getAll({type:e})},async getPremium(){return this.getAll({isPremium:!0})},async getFree(){return this.getAll({isPremium:!1})},async create(e,t){try{return(await Tt(_e(X,bs),{...e,auteurId:t,createdAt:Mt(),updatedAt:Mt()})).id}catch(n){throw console.error("Erreur lors de la cration de la ressource:",n),new Error("Impossible de crer la ressource")}},async update(e,t){try{const n=Ne(X,bs,e);await Qe(n,{...t,updatedAt:Mt()})}catch(n){throw console.error("Erreur lors de la mise  jour de la ressource:",n),new Error("Impossible de mettre  jour la ressource")}},async delete(e){try{const t=await this.getById(e);t?.fichierURL&&await this.deleteFile(t.fichierURL);const n=Ne(X,bs,e);await en(n)}catch(t){throw console.error("Erreur lors de la suppression de la ressource:",t),new Error("Impossible de supprimer la ressource")}},async deleteByDiscipline(e){try{const t=await this.getByDiscipline(e),n=Pn(X);for(const a of t){a.fichierURL&&await this.deleteFile(a.fichierURL);const l=Ne(X,bs,a.id);n.delete(l)}await n.commit()}catch(t){throw console.error("Erreur lors de la suppression des ressources:",t),new Error("Impossible de supprimer les ressources")}},async uploadFile(e,t){try{const n=K3(e.name),a=`${Y3}/${t}/${n}`,l=qr(Or,a);return await zs(l,e),await da(l)}catch(n){throw console.error("Erreur lors de l'upload du fichier:",n),new Error("Impossible d'uploader le fichier")}},async deleteFile(e){try{const t=qr(Or,e);await Dc(t)}catch(t){console.warn("Fichier non trouv ou dj supprim:",t)}},async reorder(e,t){try{const n=Pn(X);t.forEach((a,l)=>{const o=Ne(X,bs,a);n.update(o,{ordre:l+1,updatedAt:Mt()})}),await n.commit()}catch(n){throw console.error("Erreur lors de la rorganisation des ressources:",n),new Error("Impossible de rorganiser les ressources")}},async togglePremium(e,t){await this.update(e,{isPremium:t})},async countByType(e){return(await this.getByType(e)).length},async getStats(){try{const e=await this.getAll(),t={total:e.length,premium:e.filter(n=>n.isPremium).length,gratuit:e.filter(n=>!n.isPremium).length,parType:{cours:0,exercice:0,video:0,document:0,quiz:0}};return e.forEach(n=>{t.parType[n.type]!==void 0&&t.parType[n.type]++}),t}catch(e){throw console.error("Erreur lors du calcul des statistiques:",e),new Error("Impossible de calculer les statistiques")}}},W3=()=>{const{id:e}=Wn(),t=st(),[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState([]),[f,p]=g.useState(!0),[h,v]=g.useState(null),[b,x]=g.useState("tous"),[j,N]=g.useState(new Set),S=g.useCallback(async()=>{if(e)try{p(!0),v(null);const L=await Ki.getById(e);if(!L){v("Discipline introuvable."),p(!1);return}a(L);const U=await Ia.getAll({disciplineId:e}),$=new Map,B=[];for(const se of U){const M=se.chapitre||se.chapitreId;M?($.has(M)||$.set(M,[]),$.get(M).push(se)):B.push(se)}const re=Array.from($.entries()).map(([se,M])=>({chapitreNom:se,ressources:M.sort((q,F)=>q.ordre-F.ordre)})).sort((se,M)=>se.chapitreNom.localeCompare(M.chapitreNom,"fr"));o(re),d(B),re.length>0&&N(new Set([re[0].chapitreNom]))}catch(L){console.error("Erreur chargement discipline:",L),v("Impossible de charger les donnes. Ressayez plus tard.")}finally{p(!1)}},[e]);g.useEffect(()=>{S()},[S]);const C=L=>{N(U=>{const $=new Set(U);return $.has(L)?$.delete(L):$.add(L),$})},E=L=>b==="tous"?L:L.filter(U=>U.type===b),w=L=>{switch(L){case"cours":return"";case"exercice":return"";case"video":return"";case"document":return"";case"quiz":return"";default:return""}},z=L=>{switch(L){case"cours":return"Cours";case"exercice":return"Exercice";case"video":return"Vido";case"document":return"Document";case"quiz":return"Quiz";default:return L}},k=L=>{switch(L){case"cours":return"#3b82f6";case"exercice":return"#10b981";case"video":return"#f59e0b";case"document":return"#8b5cf6";case"quiz":return"#ef4444";default:return"#6b7280"}},O=L=>L==="college"?"Collge":"Lyce";if(f)return r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem 1rem",minHeight:"50vh"},children:[r.jsx("div",{style:{width:"48px",height:"48px",border:"4px solid #e5e7eb",borderTopColor:"#2563eb",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),r.jsx("p",{style:{marginTop:"1rem",color:"#6b7280"},children:"Chargement de la discipline..."}),r.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"})]});if(h||!n)return r.jsxs("div",{style:{maxWidth:"600px",margin:"3rem auto",padding:"2rem",textAlign:"center",background:"#fef2f2",borderRadius:"12px",border:"1px solid #fecaca"},children:[r.jsx("span",{style:{fontSize:"3rem"},children:""}),r.jsx("h2",{style:{color:"#991b1b",margin:"1rem 0 0.5rem"},children:h||"Discipline introuvable"}),r.jsx("p",{style:{color:"#b91c1c",marginBottom:"1.5rem"},children:"Vrifiez le lien ou retournez  la liste des disciplines."}),r.jsx("button",{onClick:()=>t("/disciplines"),style:{padding:"0.75rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:600},children:" Retour aux disciplines"})]});const P=[...l.flatMap(L=>L.ressources),...u],D=[...new Set(P.map(L=>L.type))];return r.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto",padding:"1.5rem 1rem"},children:[r.jsxs("nav",{style:{marginBottom:"1.5rem",fontSize:"0.875rem",color:"#6b7280"},children:[r.jsx(Ge,{to:"/",style:{color:"#2563eb",textDecoration:"none"},children:"Accueil"}),r.jsx("span",{style:{margin:"0 0.5rem"},children:"/"}),r.jsx(Ge,{to:"/disciplines",style:{color:"#2563eb",textDecoration:"none"},children:"Disciplines"}),r.jsx("span",{style:{margin:"0 0.5rem"},children:"/"}),r.jsx("span",{style:{color:"#374151"},children:n.nom})]}),r.jsxs("header",{style:{background:"linear-gradient(135deg, #1e40af 0%, #3b82f6 100%)",borderRadius:"16px",padding:"2rem",color:"#fff",marginBottom:"2rem"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.75rem"},children:[r.jsx("span",{style:{fontSize:"2.5rem"},children:n.icone||""}),r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:"1.75rem",fontWeight:700,margin:0},children:n.nom}),n.description&&r.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.9,fontSize:"0.95rem"},children:n.description})]})]}),r.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap",marginTop:"1rem"},children:[r.jsxs("span",{style:{background:"rgba(255,255,255,0.2)",padding:"0.35rem 0.75rem",borderRadius:"20px",fontSize:"0.8rem",fontWeight:600},children:[" ",O(n.niveau),"  ",n.classe]}),r.jsxs("span",{style:{background:"rgba(255,255,255,0.2)",padding:"0.35rem 0.75rem",borderRadius:"20px",fontSize:"0.8rem",fontWeight:600},children:[" ",P.length," ressource",P.length!==1?"s":""]}),n.coefficient&&r.jsxs("span",{style:{background:"rgba(255,255,255,0.2)",padding:"0.35rem 0.75rem",borderRadius:"20px",fontSize:"0.8rem",fontWeight:600},children:[" Coeff. ",n.coefficient]})]})]}),D.length>1&&r.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginBottom:"1.5rem"},children:[r.jsxs("button",{onClick:()=>x("tous"),style:{padding:"0.5rem 1rem",borderRadius:"20px",border:b==="tous"?"2px solid #2563eb":"1px solid #d1d5db",background:b==="tous"?"#2563eb":"#fff",color:b==="tous"?"#fff":"#374151",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:["Tous (",P.length,")"]}),D.map(L=>{const U=P.filter(B=>B.type===L).length,$=b===L;return r.jsxs("button",{onClick:()=>x(L),style:{padding:"0.5rem 1rem",borderRadius:"20px",border:$?`2px solid ${k(L)}`:"1px solid #d1d5db",background:$?k(L):"#fff",color:$?"#fff":"#374151",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:[w(L)," ",z(L)," (",U,")"]},L)})]}),l.length===0&&u.length===0?r.jsxs("div",{style:{textAlign:"center",padding:"3rem 1rem",background:"#f9fafb",borderRadius:"12px",border:"1px solid #e5e7eb"},children:[r.jsx("span",{style:{fontSize:"3rem"},children:""}),r.jsx("h3",{style:{color:"#374151",margin:"1rem 0 0.5rem"},children:"Aucune ressource disponible"}),r.jsx("p",{style:{color:"#6b7280"},children:"Les cours et exercices pour cette discipline seront bientt ajouts."})]}):r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[l.map(L=>{const U=E(L.ressources);if(U.length===0&&b!=="tous")return null;const $=j.has(L.chapitreNom),B=b==="tous"?L.ressources:U;return r.jsxs("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e5e7eb",overflow:"hidden",transition:"box-shadow 0.2s",boxShadow:$?"0 4px 12px rgba(0,0,0,0.08)":"none"},children:[r.jsx("button",{onClick:()=>C(L.chapitreNom),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1rem 1.25rem",background:$?"#f0f5ff":"#fff",border:"none",cursor:"pointer",textAlign:"left",transition:"background 0.2s"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[r.jsx("span",{style:{fontSize:"1.25rem",transform:$?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s"},children:""}),r.jsxs("div",{children:[r.jsx("span",{style:{fontWeight:700,color:"#1f2937",fontSize:"1rem"},children:L.chapitreNom}),r.jsxs("span",{style:{display:"block",fontSize:"0.75rem",color:"#6b7280",marginTop:"2px"},children:[L.ressources.length," ressource",L.ressources.length!==1?"s":""]})]})]})}),$&&r.jsx("div",{style:{padding:"0 1.25rem 1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:B.map(re=>r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #f3f4f6",transition:"background 0.15s",cursor:"pointer"},onMouseEnter:se=>se.currentTarget.style.background="#eef2ff",onMouseLeave:se=>se.currentTarget.style.background="#f9fafb",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flex:1},children:[r.jsx("span",{style:{fontSize:"1.2rem"},children:w(re.type)}),r.jsxs("div",{children:[r.jsx("span",{style:{fontWeight:600,color:"#1f2937",fontSize:"0.9rem"},children:re.titre}),re.description&&r.jsx("span",{style:{display:"block",fontSize:"0.75rem",color:"#9ca3af",marginTop:"2px"},children:re.description})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexShrink:0},children:[r.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#fff",background:k(re.type)},children:z(re.type)}),re.isPremium&&r.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#92400e",background:"#fef3c7",border:"1px solid #fde68a"},children:" Premium"}),re.dureeEstimee&&r.jsxs("span",{style:{fontSize:"0.75rem",color:"#6b7280"},children:[" ",re.dureeEstimee," min"]})]})]},re.id))})]},L.chapitreNom)}),E(u).length>0&&r.jsxs("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e5e7eb",padding:"1rem 1.25rem"},children:[r.jsx("h3",{style:{fontSize:"1rem",fontWeight:700,color:"#374151",marginBottom:"0.75rem"},children:" Autres ressources"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:E(u).map(L=>r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #f3f4f6"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[r.jsx("span",{style:{fontSize:"1.2rem"},children:w(L.type)}),r.jsx("span",{style:{fontWeight:600,color:"#1f2937",fontSize:"0.9rem"},children:L.titre})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#fff",background:k(L.type)},children:z(L.type)}),L.isPremium&&r.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#92400e",background:"#fef3c7",border:"1px solid #fde68a"},children:" Premium"})]})]},L.id))})]})]}),r.jsx("div",{style:{marginTop:"2rem",textAlign:"center"},children:r.jsx(Ge,{to:"/disciplines",style:{display:"inline-block",padding:"0.75rem 1.5rem",background:"#f3f4f6",color:"#374151",borderRadius:"8px",textDecoration:"none",fontWeight:600,transition:"background 0.2s"},children:" Retour aux disciplines"})})]})},X3=()=>{const{login:e,loginWithGoogle:t}=rt(),n=st(),l=zb().state?.from||"/",[o,u]=g.useState({email:"",password:""}),[d,f]=g.useState(!1),[p,h]=g.useState(!1),[v,b]=g.useState(""),[x,j]=g.useState(!1),N=w=>{const{name:z,value:k}=w.target;u(O=>({...O,[z]:k})),v&&b("")},S=()=>o.email.trim()?o.password?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email)?!0:(b("Veuillez entrer une adresse email valide."),!1):(b("Veuillez entrer votre mot de passe."),!1):(b("Veuillez entrer votre adresse email."),!1),C=async w=>{if(w.preventDefault(),!!S()){f(!0),b("");try{await e(o.email,o.password),n(l,{replace:!0})}catch(z){z instanceof Error?b(z.message):b("Une erreur est survenue lors de la connexion.")}finally{f(!1)}}},E=async()=>{h(!0),b("");try{await t(),n(l,{replace:!0})}catch(w){w instanceof Error&&b(w.message)}finally{h(!1)}};return r.jsx("div",{className:"auth-page",children:r.jsxs("div",{className:"auth-container",children:[r.jsxs("div",{className:"auth-card",children:[r.jsxs("div",{className:"auth-header",children:[r.jsxs(Ge,{to:"/",className:"auth-logo",children:[r.jsx("div",{className:"auth-logo__icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})})}),r.jsx("span",{children:"PedaClic"})]}),r.jsx("h1",{className:"auth-title",children:"Connexion"}),r.jsx("p",{className:"auth-subtitle",children:"Accdez  votre espace d'apprentissage"})]}),v&&r.jsxs("div",{className:"auth-error",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 8v4M12 16h.01"})]}),r.jsx("span",{children:v})]}),r.jsxs("form",{onSubmit:C,className:"auth-form",children:[r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"email",className:"auth-label",children:"Adresse email"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),r.jsx("input",{type:"email",id:"email",name:"email",value:o.email,onChange:N,placeholder:"exemple@email.com",className:"auth-input",autoComplete:"email",disabled:d})]})]}),r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"password",className:"auth-label",children:"Mot de passe"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",strokeWidth:"2"}),r.jsx("path",{strokeWidth:"2",d:"M7 11V7a5 5 0 0110 0v4"})]}),r.jsx("input",{type:x?"text":"password",id:"password",name:"password",value:o.password,onChange:N,placeholder:"Votre mot de passe",className:"auth-input",autoComplete:"current-password",disabled:d}),r.jsx("button",{type:"button",className:"auth-password-toggle",onClick:()=>j(!x),"aria-label":x?"Masquer le mot de passe":"Afficher le mot de passe",children:x?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),r.jsx("div",{className:"auth-forgot",children:r.jsx(Ge,{to:"/mot-de-passe-oublie",className:"auth-forgot-link",children:"Mot de passe oubli ?"})}),r.jsx("button",{type:"submit",className:"auth-button",disabled:d,children:d?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"auth-button-spinner"}),"Connexion en cours..."]}):"Se connecter"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"ou"})}),r.jsx("button",{type:"button",className:"auth-google-btn",onClick:E,disabled:d||p,children:p?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"auth-button-spinner auth-button-spinner--dark"}),"Connexion en cours"]}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"auth-google-icon",viewBox:"0 0 24 24","aria-hidden":"true",children:[r.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),r.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),r.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z"}),r.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continuer avec Google"]})}),r.jsxs("p",{className:"auth-switch",children:["Pas encore de compte ?"," ",r.jsx(Ge,{to:"/inscription",className:"auth-switch-link",children:"Crer un compte"})]})]}),r.jsxs("div",{className:"auth-welcome",children:[r.jsx("h2",{children:"Bienvenue sur PedaClic !"}),r.jsx("p",{children:"L'cole en un clic - Accdez  des milliers de cours, exercices et quiz."}),r.jsxs("ul",{className:"auth-features",children:[r.jsxs("li",{children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Cours du programme sngalais"]}),r.jsxs("li",{children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Exercices interactifs"]}),r.jsxs("li",{children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Quiz pour tester vos connaissances"]}),r.jsxs("li",{children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Suivi de progression"]})]})]})]})})},Z3=()=>{const{register:e,loginWithGoogle:t}=rt(),n=st(),[a,l]=g.useState({email:"",password:"",confirmPassword:"",displayName:"",role:"eleve"}),[o,u]=g.useState(!1),[d,f]=g.useState(""),[p,h]=g.useState(!1),[v,b]=g.useState(!1),[x,j]=g.useState(!1),[N,S]=g.useState(!1),C=k=>{const{name:O,value:P}=k.target;l(D=>({...D,[O]:P})),d&&f("")},E=()=>a.displayName.trim()?a.displayName.trim().length<2?(f("Le nom doit contenir au moins 2 caractres."),!1):a.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)?a.password?a.password.length<6?(f("Le mot de passe doit contenir au moins 6 caractres."),!1):a.password!==a.confirmPassword?(f("Les mots de passe ne correspondent pas."),!1):x?!0:(f("Veuillez accepter les conditions d'utilisation."),!1):(f("Veuillez entrer un mot de passe."),!1):(f("Veuillez entrer une adresse email valide."),!1):(f("Veuillez entrer votre adresse email."),!1):(f("Veuillez entrer votre nom complet."),!1),w=async k=>{if(k.preventDefault(),!!E()){u(!0),f("");try{await e(a),n("/disciplines",{replace:!0})}catch(O){O instanceof Error?f(O.message):f("Une erreur est survenue lors de l'inscription.")}finally{u(!1)}}},z=async()=>{if(!x){f("Veuillez accepter les conditions d'utilisation.");return}S(!0),f("");try{await t(a.role),n("/disciplines",{replace:!0})}catch(k){k instanceof Error&&f(k.message)}finally{S(!1)}};return r.jsx("div",{className:"auth-page",children:r.jsxs("div",{className:"auth-container",children:[r.jsxs("div",{className:"auth-card auth-card--register",children:[r.jsxs("div",{className:"auth-header",children:[r.jsxs(Ge,{to:"/",className:"auth-logo",children:[r.jsx("div",{className:"auth-logo__icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})})}),r.jsx("span",{children:"PedaClic"})]}),r.jsx("h1",{className:"auth-title",children:"Crer un compte"}),r.jsx("p",{className:"auth-subtitle",children:"Rejoignez PedaClic et commencez  apprendre"})]}),d&&r.jsxs("div",{className:"auth-error",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 8v4M12 16h.01"})]}),r.jsx("span",{children:d})]}),r.jsxs("form",{onSubmit:w,className:"auth-form",children:[r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"displayName",className:"auth-label",children:"Nom complet"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),r.jsx("input",{type:"text",id:"displayName",name:"displayName",value:a.displayName,onChange:C,placeholder:"Amadou Diallo",className:"auth-input",autoComplete:"name",disabled:o})]})]}),r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"email",className:"auth-label",children:"Adresse email"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),r.jsx("input",{type:"email",id:"email",name:"email",value:a.email,onChange:C,placeholder:"exemple@email.com",className:"auth-input",autoComplete:"email",disabled:o})]})]}),r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{className:"auth-label",children:"Je suis :"}),r.jsxs("div",{className:"auth-role-selector",children:[r.jsxs("label",{className:`auth-role-option ${a.role==="eleve"?"auth-role-option--selected":""}`,children:[r.jsx("input",{type:"radio",name:"role",value:"eleve",checked:a.role==="eleve",onChange:C,className:"auth-role-input",disabled:o}),r.jsxs("div",{className:"auth-role-content",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 14l9-5-9-5-9 5 9 5z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"})]}),r.jsx("span",{children:"lve"})]})]}),r.jsxs("label",{className:`auth-role-option ${a.role==="prof"?"auth-role-option--selected":""}`,children:[r.jsx("input",{type:"radio",name:"role",value:"prof",checked:a.role==="prof",onChange:C,className:"auth-role-input",disabled:o}),r.jsxs("div",{className:"auth-role-content",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),r.jsx("span",{children:"Professeur"})]})]}),r.jsxs("label",{className:`auth-role-option ${a.role==="parent"?"auth-role-option--selected":""}`,children:[r.jsx("input",{type:"radio",name:"role",value:"parent",checked:a.role==="parent",onChange:C,className:"auth-role-input",disabled:o}),r.jsxs("div",{className:"auth-role-content",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})}),r.jsx("span",{children:"Parent d'lve"})]})]})]})]}),r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"password",className:"auth-label",children:"Mot de passe"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:[r.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",strokeWidth:"2"}),r.jsx("path",{strokeWidth:"2",d:"M7 11V7a5 5 0 0110 0v4"})]}),r.jsx("input",{type:p?"text":"password",id:"password",name:"password",value:a.password,onChange:C,placeholder:"Minimum 6 caractres",className:"auth-input",autoComplete:"new-password",disabled:o}),r.jsx("button",{type:"button",className:"auth-password-toggle",onClick:()=>h(!p),"aria-label":p?"Masquer":"Afficher",children:p?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),r.jsx("p",{className:"auth-hint",children:"Au moins 6 caractres avec des lettres et des chiffres"})]}),r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"confirmPassword",className:"auth-label",children:"Confirmer le mot de passe"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),r.jsx("input",{type:v?"text":"password",id:"confirmPassword",name:"confirmPassword",value:a.confirmPassword,onChange:C,placeholder:"Retapez votre mot de passe",className:"auth-input",autoComplete:"new-password",disabled:o}),r.jsx("button",{type:"button",className:"auth-password-toggle",onClick:()=>b(!v),"aria-label":v?"Masquer":"Afficher",children:v?r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),r.jsx("div",{className:"auth-checkbox-field",children:r.jsxs("label",{className:"auth-checkbox-label",children:[r.jsx("input",{type:"checkbox",checked:x,onChange:k=>j(k.target.checked),className:"auth-checkbox",disabled:o}),r.jsx("span",{className:"auth-checkbox-custom"}),r.jsxs("span",{children:["J'accepte les"," ",r.jsx(Ge,{to:"/cgu",target:"_blank",className:"auth-link",children:"conditions d'utilisation"})," ","et la"," ",r.jsx(Ge,{to:"/confidentialite",target:"_blank",className:"auth-link",children:"politique de confidentialit"})]})]})}),r.jsx("button",{type:"submit",className:"auth-button",disabled:o,children:o?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"auth-button-spinner"}),"Cration du compte..."]}):"Crer mon compte"})]}),r.jsx("div",{className:"auth-divider",children:r.jsx("span",{children:"ou"})}),r.jsx("button",{type:"button",className:"auth-google-btn",onClick:z,disabled:o||N,children:N?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"auth-button-spinner auth-button-spinner--dark"}),"Cration du compte"]}):r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"auth-google-icon",viewBox:"0 0 24 24","aria-hidden":"true",children:[r.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),r.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),r.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z"}),r.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"S'inscrire avec Google"]})}),r.jsx("p",{className:"auth-google-hint",children:"Le rle slectionn ci-dessus sera utilis pour votre compte Google."}),r.jsxs("p",{className:"auth-switch",children:["Dj un compte ?"," ",r.jsx(Ge,{to:"/connexion",className:"auth-switch-link",children:"Se connecter"})]})]}),r.jsxs("div",{className:"auth-welcome auth-welcome--register",children:[r.jsx("h2",{children:"Rejoignez la communaut PedaClic"}),r.jsx("p",{children:"Des milliers d'lves et professeurs sngalais nous font dj confiance."}),r.jsxs("div",{className:"auth-stats",children:[r.jsxs("div",{className:"auth-stat",children:[r.jsx("span",{className:"auth-stat-number",children:"10 000+"}),r.jsx("span",{className:"auth-stat-label",children:"lves inscrits"})]}),r.jsxs("div",{className:"auth-stat",children:[r.jsx("span",{className:"auth-stat-number",children:"500+"}),r.jsx("span",{className:"auth-stat-label",children:"Cours disponibles"})]}),r.jsxs("div",{className:"auth-stat",children:[r.jsx("span",{className:"auth-stat-number",children:"95%"}),r.jsx("span",{className:"auth-stat-label",children:"Taux de satisfaction"})]})]}),r.jsxs("div",{className:"auth-testimonial",children:[r.jsx("p",{className:"auth-testimonial-text",children:`"Grce  PedaClic, j'ai amlior mes notes en mathmatiques de 4 points !"`}),r.jsx("p",{className:"auth-testimonial-author",children:" Fatou N., lve de 3me  Dakar"})]})]})]})})},J3=()=>{const e=async b=>{const{sendPasswordResetEmail:x}=await z1(async()=>{const{sendPasswordResetEmail:N}=await import("./vendor-firebase-LntcAirY.js").then(S=>S.K);return{sendPasswordResetEmail:N}},[]),{auth:j}=await z1(async()=>{const{auth:N}=await Promise.resolve().then(()=>E3);return{auth:N}},void 0);await x(j,b)},[t,n]=g.useState(""),[a,l]=g.useState(!1),[o,u]=g.useState(""),[d,f]=g.useState(!1),p=()=>t.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?!0:(u("Veuillez entrer une adresse email valide."),!1):(u("Veuillez entrer votre adresse email."),!1),h=async b=>{if(b.preventDefault(),!!p()){l(!0),u("");try{await e(t),f(!0)}catch(x){x instanceof Error?u(x.message):u("Une erreur est survenue. Veuillez ressayer.")}finally{l(!1)}}},v=()=>{f(!1),n(""),u("")};return r.jsx("div",{className:"auth-page",children:r.jsx("div",{className:"auth-container auth-container--centered",children:r.jsxs("div",{className:"auth-card auth-card--narrow",children:[r.jsx("div",{className:"auth-header",children:r.jsxs(Ge,{to:"/",className:"auth-logo",children:[r.jsx("div",{className:"auth-logo__icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})})}),r.jsx("span",{children:"PedaClic"})]})}),d?r.jsxs("div",{className:"auth-success-content",children:[r.jsx("div",{className:"auth-success-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),r.jsx("h1",{className:"auth-title",children:"Email envoy !"}),r.jsxs("p",{className:"auth-subtitle",children:["Nous avons envoy un lien de rinitialisation  ",r.jsx("strong",{children:t})]}),r.jsxs("div",{className:"auth-instructions",children:[r.jsx("p",{children:"Vrifiez votre bote de rception et cliquez sur le lien pour rinitialiser votre mot de passe."}),r.jsxs("p",{className:"auth-instructions-note",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"Si vous ne voyez pas l'email, vrifiez votre dossier spam."]})]}),r.jsxs("div",{className:"auth-success-actions",children:[r.jsx(Ge,{to:"/connexion",className:"auth-button",children:"Retour  la connexion"}),r.jsx("button",{type:"button",className:"auth-button auth-button--outline",onClick:v,children:"Renvoyer l'email"})]})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"auth-icon",children:r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),r.jsx("h1",{className:"auth-title",children:"Mot de passe oubli ?"}),r.jsx("p",{className:"auth-subtitle",children:"Pas de panique ! Entrez votre email et nous vous enverrons un lien pour rinitialiser votre mot de passe."}),o&&r.jsxs("div",{className:"auth-error",children:[r.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10"}),r.jsx("path",{d:"M12 8v4M12 16h.01"})]}),r.jsx("span",{children:o})]}),r.jsxs("form",{onSubmit:h,className:"auth-form",children:[r.jsxs("div",{className:"auth-field",children:[r.jsx("label",{htmlFor:"email",className:"auth-label",children:"Adresse email"}),r.jsxs("div",{className:"auth-input-wrapper",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),r.jsx("input",{type:"email",id:"email",value:t,onChange:b=>{n(b.target.value),o&&u("")},placeholder:"exemple@email.com",className:"auth-input",autoComplete:"email",disabled:a,autoFocus:!0})]})]}),r.jsx("button",{type:"submit",className:"auth-button",disabled:a,children:a?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"auth-button-spinner"}),"Envoi en cours..."]}):"Envoyer le lien"})]}),r.jsx("div",{className:"auth-back",children:r.jsxs(Ge,{to:"/connexion",className:"auth-back-link",children:[r.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Retour  la connexion"]})})]})]})})})},gA="https://api.pedaclic.sn",k1={mensuel:{description:"Accs illimit aux cours, quiz et ressources pendant 1 mois"},annuel:{description:"Accs illimit toute l'anne  conomisez 4 000 FCFA !"}};async function e5(e){const t=await fetch(`${gA}/api/moneroo/initiate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const a=await t.json().catch(()=>({}));throw new Error(a.error||`Erreur serveur (${t.status})`)}const n=await t.json();if(!n.success||!n.checkoutUrl)throw new Error("Rponse invalide du serveur de paiement");return n}async function t5(e){const t=await fetch(`${gA}/api/moneroo/verify/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Erreur vrification paiement (${t.status})`);return t.json()}function r5(e){window.location.href=e}function n5(){const e=new URLSearchParams(window.location.search);return{paymentId:e.get("paymentId"),paymentStatus:e.get("paymentStatus"),status:e.get("status")}}const a5=[{icone:"",titre:"Cours complets",description:"Accs illimit  tous les cours du programme sngalais 6me  Terminale"},{icone:"",titre:"Quiz illimits",description:"Tous les quiz par matire avec corrections dtailles et explications"},{icone:"",titre:"Gnrateur IA",description:"Gnration de cours, fiches de rvision et valuations par intelligence artificielle"},{icone:"",titre:"Suivi de progression",description:"Tableaux de bord analytiques pour suivre les performances en temps rel"},{icone:"",titre:"Bibliothque ebooks",description:"Accs  tous les manuels et ressources pdagogiques numriques"},{icone:"",titre:"Notifications",description:"Alertes personnalises pour devoirs, valuations et rappels scolaires"}],i5=[{nom:"Wave",couleur:"#1976D2",emoji:""},{nom:"Orange Money",couleur:"#FF6B00",emoji:""},{nom:"Free Money",couleur:"#E30613",emoji:""},{nom:"FLASH",couleur:"#6B21A8",emoji:""},{nom:"Carte Bancaire",couleur:"#059669",emoji:""}];function s5(){const e=st(),{currentUser:t}=rt(),[n,a]=g.useState("mensuel"),[l,o]=g.useState(!1),[u,d]=g.useState(null),f=t?.isPremium===!0;async function p(){if(!t){e("/login?redirect=/premium");return}o(!0),d(null);try{const h=await e5({plan:n,userId:t.uid,userEmail:t.email||"",userFirstName:t.displayName?.split(" ")[0]||"lve",userLastName:t.displayName?.split(" ")[1]||"PedaClic"});r5(h.checkoutUrl)}catch(h){d(h instanceof Error?h.message:"Une erreur est survenue. Veuillez ressayer."),o(!1)}}return r.jsxs("div",{className:"premium-page",children:[r.jsx("header",{className:"premium-hero",children:r.jsxs("div",{className:"premium-hero__content",children:[r.jsx("span",{className:"premium-hero__badge",children:" PREMIUM"}),r.jsx("h1",{className:"premium-hero__titre",children:"Dbloque tout PedaClic"}),r.jsxs("p",{className:"premium-hero__sous-titre",children:["Accde  tous les cours, quiz et ressources du programme sngalais.",r.jsx("br",{}),"Du 6me au BAC  ",r.jsx("strong",{children:"L'cole en un clic !"})]})]})}),r.jsxs("div",{className:"premium-contenu",children:[f&&r.jsxs("section",{className:"premium-abonne",children:[r.jsx("div",{className:"premium-abonne__icone",children:""}),r.jsx("h2",{children:"Tu es dj abonn Premium !"}),r.jsx("p",{children:"Ton abonnement est actif. Profite de tous les contenus exclusifs."}),r.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/dashboard"),children:"Aller au tableau de bord"})]}),!f&&r.jsxs("section",{className:"premium-plans",children:[r.jsx("h2",{className:"premium-section__titre",children:"Choisir un abonnement"}),r.jsxs("div",{className:"premium-plans__grille",children:[r.jsxs("div",{className:`premium-plan-card ${n==="mensuel"?"premium-plan-card--actif":""}`,onClick:()=>a("mensuel"),role:"button",tabIndex:0,onKeyDown:h=>h.key==="Enter"&&a("mensuel"),"aria-label":"Slectionner le plan mensuel",children:[r.jsx("div",{className:"premium-plan-card__select",children:r.jsx("span",{className:n==="mensuel"?"premium-plan-card__radio--actif":"premium-plan-card__radio"})}),r.jsxs("div",{className:"premium-plan-card__header",children:[r.jsx("span",{className:"premium-plan-card__icone",children:""}),r.jsx("h3",{className:"premium-plan-card__nom",children:"Mensuel"})]}),r.jsxs("div",{className:"premium-plan-card__prix",children:[r.jsx("span",{className:"premium-plan-card__montant",children:"2 000"}),r.jsx("span",{className:"premium-plan-card__devise",children:"FCFA / mois"})]}),r.jsx("p",{className:"premium-plan-card__description",children:k1.mensuel.description})]}),r.jsxs("div",{className:`premium-plan-card premium-plan-card--populaire ${n==="annuel"?"premium-plan-card--actif":""}`,onClick:()=>a("annuel"),role:"button",tabIndex:0,onKeyDown:h=>h.key==="Enter"&&a("annuel"),"aria-label":"Slectionner le plan annuel",children:[r.jsx("div",{className:"premium-plan-card__badge-populaire",children:" Meilleure offre"}),r.jsx("div",{className:"premium-plan-card__select",children:r.jsx("span",{className:n==="annuel"?"premium-plan-card__radio--actif":"premium-plan-card__radio"})}),r.jsxs("div",{className:"premium-plan-card__header",children:[r.jsx("span",{className:"premium-plan-card__icone",children:""}),r.jsx("h3",{className:"premium-plan-card__nom",children:"Annuel"})]}),r.jsxs("div",{className:"premium-plan-card__prix",children:[r.jsx("span",{className:"premium-plan-card__montant",children:"20 000"}),r.jsx("span",{className:"premium-plan-card__devise",children:"FCFA / an"})]}),r.jsx("div",{className:"premium-plan-card__economie",children:" conomisez 4 000 FCFA vs mensuel"}),r.jsx("p",{className:"premium-plan-card__description",children:k1.annuel.description})]})]}),u&&r.jsxs("div",{className:"premium-erreur",role:"alert",children:[" ",u]}),r.jsxs("div",{className:"premium-paiement",children:[r.jsx("button",{className:"premium-btn premium-btn--principal",onClick:p,disabled:l,"aria-busy":l,children:l?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"premium-spinner","aria-hidden":"true"})," Redirection en cours"]}):r.jsxs(r.Fragment,{children:[" S'abonner  ",n==="mensuel"?"2 000":"20 000"," FCFA"]})}),r.jsx("p",{className:"premium-paiement__securite",children:" Paiement 100% scuris via Moneroo"}),r.jsxs("div",{className:"premium-moyens-paiement",children:[r.jsx("p",{className:"premium-moyens-paiement__titre",children:"Moyens de paiement accepts :"}),r.jsx("div",{className:"premium-moyens-paiement__liste",children:i5.map(h=>r.jsxs("span",{className:"premium-moyen-badge",style:{borderColor:h.couleur,color:h.couleur},title:h.nom,children:[h.emoji," ",h.nom]},h.nom))})]})]})]}),r.jsxs("section",{className:"premium-avantages",children:[r.jsx("h2",{className:"premium-section__titre",children:"Ce qui est inclus"}),r.jsx("div",{className:"premium-avantages__grille",children:a5.map(h=>r.jsxs("div",{className:"premium-avantage-card",children:[r.jsx("span",{className:"premium-avantage-card__icone",children:h.icone}),r.jsxs("div",{className:"premium-avantage-card__texte",children:[r.jsx("h3",{children:h.titre}),r.jsx("p",{children:h.description})]})]},h.titre))})]}),r.jsxs("section",{className:"premium-faq",children:[r.jsx("h2",{className:"premium-section__titre",children:"Questions frquentes"}),r.jsxs("div",{className:"premium-faq__liste",children:[r.jsxs("div",{className:"premium-faq__item",children:[r.jsx("h3",{children:"Comment payer avec Wave ou Orange Money ?"}),r.jsx("p",{children:`Clique sur "S'abonner", tu seras redirig vers la page de paiement Moneroo. Choisis ton moyen de paiement prfr et suis les instructions.`})]}),r.jsxs("div",{className:"premium-faq__item",children:[r.jsx("h3",{children:"Mon accs est activ quand ?"}),r.jsx("p",{children:"L'accs Premium est activ automatiquement ds la confirmation de ton paiement, en quelques secondes."})]}),r.jsxs("div",{className:"premium-faq__item",children:[r.jsx("h3",{children:"Puis-je annuler mon abonnement ?"}),r.jsx("p",{children:"Oui. Contacte-nous via WhatsApp ou email. L'accs reste actif jusqu' la fin de la priode paye."})]}),r.jsxs("div",{className:"premium-faq__item",children:[r.jsx("h3",{children:"Le plan annuel est-il renouvel automatiquement ?"}),r.jsx("p",{children:"Non. Tu recevras une notification avant l'expiration pour renouveler si tu le souhaites."})]})]})]})]})]})}function l5(){const e=st(),[t,n]=g.useState("chargement"),[a,l]=g.useState(null);return g.useEffect(()=>{async function o(){const{paymentId:u,paymentStatus:d}=n5();if(!u){e("/premium");return}if(d==="failed"||d==="cancelled"){n("echec"),l("Le paiement a t annul ou a chou. Aucun montant n'a t dbit.");return}try{const f=await t5(u);f.status==="success"?n("succes"):f.status==="pending"?n("attente"):(n("echec"),l("Le paiement n'a pas pu tre confirm. Contactez le support si le montant a t dbit."))}catch{n("attente")}}o()},[e]),t==="chargement"?r.jsx("div",{className:"premium-confirmation",children:r.jsxs("div",{className:"premium-confirmation__card",children:[r.jsx("div",{className:"premium-spinner premium-spinner--lg","aria-label":"Vrification en cours"}),r.jsx("h2",{children:"Vrification du paiement"}),r.jsx("p",{children:"Merci de patienter quelques secondes."})]})}):t==="succes"?r.jsx("div",{className:"premium-confirmation",children:r.jsxs("div",{className:"premium-confirmation__card premium-confirmation__card--succes",children:[r.jsx("div",{className:"premium-confirmation__icone premium-confirmation__icone--succes",children:""}),r.jsx("h1",{children:"Bienvenue dans Premium ! "}),r.jsxs("p",{className:"premium-confirmation__message",children:["Ton abonnement est activ. Tu as maintenant accs  ",r.jsx("strong",{children:"tous les cours, quiz et ressources"})," de PedaClic."]}),r.jsxs("div",{className:"premium-confirmation__actions",children:[r.jsx("button",{className:"premium-btn premium-btn--principal",onClick:()=>e("/dashboard"),children:" Accder au tableau de bord"}),r.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/cours"),children:" Voir les cours"})]})]})}):t==="attente"?r.jsx("div",{className:"premium-confirmation",children:r.jsxs("div",{className:"premium-confirmation__card premium-confirmation__card--attente",children:[r.jsx("div",{className:"premium-confirmation__icone premium-confirmation__icone--attente",children:""}),r.jsx("h1",{children:"Paiement en cours de traitement"}),r.jsx("p",{className:"premium-confirmation__message",children:"Ton paiement est en cours de vrification. Ton accs Premium sera activ automatiquement ds confirmation (gnralement moins de 5 minutes)."}),r.jsx("p",{className:"premium-confirmation__message",children:"Tu recevras une notification ds que c'est prt. Tu peux fermer cette page."}),r.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/dashboard"),children:"Aller au tableau de bord"})]})}):r.jsx("div",{className:"premium-confirmation",children:r.jsxs("div",{className:"premium-confirmation__card premium-confirmation__card--echec",children:[r.jsx("div",{className:"premium-confirmation__icone premium-confirmation__icone--echec",children:""}),r.jsx("h1",{children:"Paiement non abouti"}),r.jsx("p",{className:"premium-confirmation__message",children:a||"Une erreur est survenue lors du paiement."}),r.jsxs("div",{className:"premium-confirmation__actions",children:[r.jsx("button",{className:"premium-btn premium-btn--principal",onClick:()=>e("/premium"),children:" Ressayer"}),r.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/dashboard"),children:"Retour au tableau de bord"})]})]})})}const o5=[{title:"Principal",items:[{id:"dashboard",label:"Tableau de bord",icon:"",href:"/admin"},{id:"disciplines",label:"Disciplines",icon:"",href:"/admin/disciplines"},{id:"chapitres",label:"Chapitres",icon:"",href:"/admin/chapitres"},{id:"ressources",label:"Ressources",icon:"",href:"/admin/ressources"},{id:"ebooks",label:"Bibliothque Ebooks",icon:"",href:"/admin/ebooks"}]},{title:"valuation",items:[{id:"quiz",label:"Quiz",icon:"",href:"/admin/quiz"},{id:"quiz-avance",label:"Quiz Avancs",icon:"",href:"/admin/quiz-avance"},{id:"resultats",label:"Rsultats",icon:"",href:"/admin/resultats"}]},{title:"Utilisateurs",items:[{id:"utilisateurs",label:"Tous les utilisateurs",icon:"",href:"/admin/utilisateurs"},{id:"premium",label:"Abonns Premium",icon:"",href:"/admin/premium"}]},{title:"Outils IA",items:[{id:"generateur",label:"Gnrateur IA",icon:"",href:"/generateur"}]},{title:"Paramtres",items:[{id:"settings",label:"Configuration",icon:"",href:"/admin/settings"}]}],fn=({children:e,currentPage:t="dashboard"})=>{const{currentUser:n,logout:a}=rt(),[l,o]=g.useState(!0),[u,d]=g.useState(!1),f=zb(),p=async()=>{try{d(!0),await a(),window.location.href="/connexion"}catch(x){console.error("Erreur lors de la dconnexion:",x),d(!1)}},h=()=>n?.displayName?n.displayName.split(" ").map(x=>x[0]).join("").toUpperCase().slice(0,2):"AD",v=()=>{switch(n?.role){case"admin":return"Administrateur";case"prof":return"Professeur";case"eleve":return"lve";default:return"Utilisateur"}},b=x=>x.href==="/admin"?f.pathname==="/admin"||f.pathname==="/admin/":f.pathname.startsWith(x.href);return r.jsxs("div",{className:"admin-layout",children:[r.jsxs("aside",{className:`admin-sidebar ${l?"":"admin-sidebar--collapsed"}`,children:[r.jsx("header",{className:"admin-sidebar__header",children:r.jsxs(Ge,{to:"/",className:"admin-sidebar__logo",children:[r.jsx("div",{className:"admin-sidebar__logo-icon",children:""}),r.jsx("span",{children:"PedaClic"})]})}),r.jsx("nav",{className:"admin-sidebar__nav",children:o5.map((x,j)=>r.jsxs("div",{className:"admin-nav__section",children:[r.jsx("h3",{className:"admin-nav__title",children:x.title}),r.jsx("ul",{className:"admin-nav__list",children:x.items.map(N=>r.jsx("li",{className:"admin-nav__item",children:r.jsxs(Ge,{to:N.href,className:`admin-nav__link ${b(N)?"admin-nav__link--active":""}`,children:[r.jsx("span",{className:"admin-nav__icon",children:N.icon}),r.jsx("span",{className:"admin-nav__label",children:N.label})]})},N.id))})]},j))}),r.jsx("footer",{className:"admin-sidebar__footer",children:r.jsxs("div",{className:"admin-user",children:[r.jsx("div",{className:"admin-user__avatar",children:h()}),r.jsxs("div",{className:"admin-user__info",children:[r.jsx("div",{className:"admin-user__name",children:n?.displayName||"Administrateur"}),r.jsx("div",{className:"admin-user__role",children:v()})]}),r.jsx("button",{onClick:p,disabled:u,className:"admin-logout-btn",title:"Se dconnecter",children:u?"...":""})]})})]}),r.jsxs("main",{className:"admin-content",children:[r.jsx("button",{className:"admin-sidebar-toggle",onClick:()=>o(!l),"aria-label":"Toggle sidebar",children:""}),e]}),r.jsx("style",{children:`
        /* Bouton de dconnexion */
        .admin-logout-btn {
          width: 36px;
          height: 36px;
          border: none;
          background: rgba(255, 255, 255, 0.1);
          color: white;
          border-radius: var(--radius-md);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all var(--transition-base);
          font-size: var(--text-lg);
        }

        .admin-logout-btn:hover {
          background: rgba(255, 255, 255, 0.2);
        }

        .admin-logout-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        /* Bouton toggle sidebar (mobile) */
        .admin-sidebar-toggle {
          display: none;
          position: fixed;
          top: var(--spacing-md);
          left: var(--spacing-md);
          z-index: var(--z-fixed);
          width: 44px;
          height: 44px;
          border: none;
          background: var(--color-primary);
          color: white;
          border-radius: var(--radius-md);
          cursor: pointer;
          font-size: var(--text-xl);
        }

        @media (max-width: 768px) {
          .admin-sidebar-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
          }

          .admin-sidebar {
            transform: translateX(-100%);
            transition: transform var(--transition-base);
          }

          .admin-sidebar:not(.admin-sidebar--collapsed) {
            transform: translateX(0);
          }

          .admin-content {
            padding-top: calc(var(--spacing-xl) + 44px);
          }
        }

        /* Animation de la sidebar rduite */
        .admin-sidebar--collapsed {
          width: 80px;
        }

        .admin-sidebar--collapsed .admin-nav__label,
        .admin-sidebar--collapsed .admin-nav__title,
        .admin-sidebar--collapsed .admin-sidebar__logo span,
        .admin-sidebar--collapsed .admin-user__info {
          display: none;
        }

        .admin-sidebar--collapsed .admin-sidebar__logo {
          justify-content: center;
        }
      `})]})},Pi="chapitres",c5=e=>Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0)),Pv=e=>{const t=e.data();return{id:e.id,disciplineId:t.disciplineId,numero:t.numero,titre:t.titre,description:t.description,objectifs:t.objectifs||[],dureeEstimee:t.dureeEstimee,isPremium:t.isPremium||!1,actif:t.actif!==!1,createdAt:t.createdAt?.toDate()||new Date,updatedAt:t.updatedAt?.toDate()}},Ti={async getByDiscipline(e){try{const t=ke(_e(X,Pi),Se("disciplineId","==",e),Ke("numero","asc"));return(await ze(t)).docs.map(Pv)}catch(t){throw console.error("Erreur lors de la rcupration des chapitres:",t),new Error("Impossible de rcuprer les chapitres")}},async getAll(){try{const e=ke(_e(X,Pi),Ke("numero","asc"));return(await ze(e)).docs.map(Pv)}catch(e){throw console.error("Erreur lors de la rcupration des chapitres:",e),new Error("Impossible de rcuprer les chapitres")}},async getById(e){try{const t=Ne(X,Pi,e),n=await Ot(t);return n.exists()?Pv(n):null}catch(t){throw console.error("Erreur lors de la rcupration du chapitre:",t),new Error("Impossible de rcuprer le chapitre")}},async create(e){try{return(await Tt(_e(X,Pi),{...e,actif:e.actif!==!1,createdAt:Mt(),updatedAt:Mt()})).id}catch(t){throw console.error("Erreur lors de la cration du chapitre:",t),new Error("Impossible de crer le chapitre")}},async update(e,t){try{const n=Ne(X,Pi,e),a=c5({...t,updatedAt:Mt()});await Qe(n,a)}catch(n){throw console.error("Erreur lors de la mise  jour du chapitre:",n),new Error("Impossible de mettre  jour le chapitre")}},async delete(e){try{const t=Ne(X,Pi,e);await en(t)}catch(t){throw console.error("Erreur lors de la suppression du chapitre:",t),new Error("Impossible de supprimer le chapitre")}},async deleteByDiscipline(e){try{const t=await this.getByDiscipline(e),n=Pn(X);t.forEach(a=>{const l=Ne(X,Pi,a.id);n.delete(l)}),await n.commit()}catch(t){throw console.error("Erreur lors de la suppression des chapitres:",t),new Error("Impossible de supprimer les chapitres")}},async reorder(e,t){try{const n=Pn(X);t.forEach((a,l)=>{const o=Ne(X,Pi,a);n.update(o,{numero:l+1,updatedAt:Mt()})}),await n.commit()}catch(n){throw console.error("Erreur lors de la rorganisation des chapitres:",n),new Error("Impossible de rorganiser les chapitres")}},async toggleActive(e,t){await this.update(e,{actif:t})},async countByDiscipline(e){return(await this.getByDiscipline(e)).length},async getNextNumero(e){return await this.countByDiscipline(e)+1}},u5=()=>{const{currentUser:e}=rt(),t=st(),[n,a]=g.useState({totalDisciplines:0,totalChapitres:0,totalRessources:0,ressourcesPremium:0,ressourcesGratuites:0,totalQuiz:0,totalQuizAvances:0,ressourcesParType:{cours:0,exercice:0,video:0,document:0,quiz:0}}),[l,o]=g.useState(!0),[u,d]=g.useState(null);return g.useEffect(()=>{(async()=>{try{o(!0),d(null);const[p,h,v,b,x]=await Promise.all([Ki.getAll(),Ti.getAll(),Ia.getStats(),ze(_e(X,"quizzes")),ze(_e(X,"quizzes_v2"))]);a({totalDisciplines:p.length,totalChapitres:h.length,totalRessources:v.total,ressourcesPremium:v.premium,ressourcesGratuites:v.gratuit,totalQuiz:b.size,totalQuizAvances:x.size,ressourcesParType:v.parType})}catch(p){console.error("Erreur lors du chargement des statistiques:",p),d("Impossible de charger les statistiques")}finally{o(!1)}})()},[]),r.jsxs("div",{className:"admin-dashboard",children:[r.jsx("header",{className:"admin-page-header",children:r.jsxs("div",{className:"admin-page-header__info",children:[r.jsx("h1",{className:"admin-page-header__title",children:"Tableau de bord"}),r.jsxs("p",{className:"admin-page-header__subtitle",children:["Bienvenue, ",e?.displayName||"Administrateur"," ! Grez votre contenu pdagogique depuis cette interface."]})]})}),u&&r.jsxs("div",{className:"alert alert--error",children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:u})})]}),l?r.jsxs("div",{className:"loading-container",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement des statistiques..."})]}):r.jsxs(r.Fragment,{children:[r.jsxs("section",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>t("/admin/disciplines"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&t("/admin/disciplines"),children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--primary",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.totalDisciplines}),r.jsx("div",{className:"stat-card__label",children:"Disciplines"})]})]}),r.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>t("/admin/chapitres"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&t("/admin/chapitres"),children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--secondary",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.totalChapitres}),r.jsx("div",{className:"stat-card__label",children:"Chapitres"})]})]}),r.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>t("/admin/ressources"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&t("/admin/ressources"),children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--info",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.totalRessources}),r.jsx("div",{className:"stat-card__label",children:"Ressources"})]})]}),r.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>t("/admin/ressources"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&t("/admin/ressources"),children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--warning",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.ressourcesPremium}),r.jsx("div",{className:"stat-card__label",children:"Ressources Premium"})]})]}),r.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>t("/admin/quiz"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&t("/admin/quiz"),children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--quiz",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.totalQuiz}),r.jsx("div",{className:"stat-card__label",children:"Quiz"})]})]}),r.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>t("/admin/quiz-avance"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&t("/admin/quiz-avance"),children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--advanced",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.totalQuizAvances}),r.jsx("div",{className:"stat-card__label",children:"Quiz Avancs"})]})]})]}),r.jsxs("section",{className:"content-card",children:[r.jsx("div",{className:"content-card__header",children:r.jsx("h2",{children:"Rpartition des ressources par type"})}),r.jsx("div",{className:"content-card__body",children:r.jsxs("div",{className:"resource-type-grid",children:[r.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>t("/admin/ressources"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"resource-item__icon resource-item__icon--cours",children:""}),r.jsxs("div",{className:"resource-type-info",children:[r.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.cours}),r.jsx("span",{className:"resource-type-label",children:"Cours"})]})]}),r.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>t("/admin/ressources"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"resource-item__icon resource-item__icon--exercice",children:""}),r.jsxs("div",{className:"resource-type-info",children:[r.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.exercice}),r.jsx("span",{className:"resource-type-label",children:"Exercices"})]})]}),r.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>t("/admin/ressources"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"resource-item__icon resource-item__icon--video",children:""}),r.jsxs("div",{className:"resource-type-info",children:[r.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.video}),r.jsx("span",{className:"resource-type-label",children:"Vidos"})]})]}),r.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>t("/admin/ressources"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"resource-item__icon resource-item__icon--document",children:""}),r.jsxs("div",{className:"resource-type-info",children:[r.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.document}),r.jsx("span",{className:"resource-type-label",children:"Documents"})]})]}),r.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>t("/admin/quiz"),role:"button",tabIndex:0,children:[r.jsx("div",{className:"resource-item__icon resource-item__icon--quiz",children:""}),r.jsxs("div",{className:"resource-type-info",children:[r.jsx("span",{className:"resource-type-value",children:n.totalQuiz+n.totalQuizAvances}),r.jsx("span",{className:"resource-type-label",children:"Quiz (tous)"})]})]})]})})]}),r.jsxs("section",{className:"content-card",style:{marginTop:"var(--spacing-xl)"},children:[r.jsx("div",{className:"content-card__header",children:r.jsx("h2",{children:"Actions rapides"})}),r.jsx("div",{className:"content-card__body",children:r.jsxs("div",{className:"quick-actions-grid",children:[r.jsxs("a",{href:"/admin/disciplines",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Grer les disciplines"}),r.jsx("p",{children:"Ajouter, modifier ou supprimer des matires"})]})]}),r.jsxs("a",{href:"/admin/chapitres",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Grer les chapitres"}),r.jsx("p",{children:"Organiser le contenu par chapitres"})]})]}),r.jsxs("a",{href:"/admin/ressources",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Grer les ressources"}),r.jsx("p",{children:"Cours, exercices, vidos et documents"})]})]}),r.jsxs("a",{href:"/admin/quiz",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Grer les quiz"}),r.jsx("p",{children:"Crer et modifier des quiz pour les lves"})]})]}),r.jsxs("a",{href:"/admin/quiz-avance",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Quiz avancs"}),r.jsx("p",{children:"Quiz interactifs avec niveaux de difficult"})]})]}),r.jsxs("a",{href:"/admin/utilisateurs",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Grer les utilisateurs"}),r.jsx("p",{children:"lves, professeurs et administrateurs"})]})]}),r.jsxs("a",{href:"/prof/cahiers",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Cahier de Textes"}),r.jsx("p",{children:"Planifier et suivre l'enseignement"})]})]}),r.jsxs("a",{href:"/prof/sequences",className:"quick-action-card",children:[r.jsx("div",{className:"quick-action-icon",children:""}),r.jsxs("div",{className:"quick-action-content",children:[r.jsx("h3",{children:"Squences Pdagogiques"}),r.jsx("p",{children:"Crer et organiser des squences de cours"})]})]})]})})]})]}),r.jsx("style",{children:`
        /* ====== Stat cards cliquables ====== */
        /* Curseur pointer + effet hover sur les cartes de statistiques */
        .stat-card--clickable {
          cursor: pointer;
          transition: all 0.2s ease;
        }
        .stat-card--clickable:hover {
          transform: translateY(-3px);
          box-shadow: var(--shadow-lg, 0 8px 24px rgba(0,0,0,0.12));
          border-color: var(--color-primary, #3182ce);
        }
        .stat-card--clickable:active {
          transform: translateY(-1px);
        }

        /* Icne quiz (violet) */
        .stat-card__icon--quiz {
          background: #f3e8ff;
          color: #7c3aed;
        }
        /* Icne quiz avanc (rose) */
        .stat-card__icon--advanced {
          background: #fce7f3;
          color: #db2777;
        }

        /* ====== Grille des types de ressources ====== */
        .resource-type-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
          gap: var(--spacing-lg);
        }

        .resource-type-item {
          display: flex;
          align-items: center;
          gap: var(--spacing-md);
          padding: var(--spacing-md);
          background: var(--color-bg-secondary);
          border-radius: var(--radius-lg);
        }

        /* Cartes de rpartition cliquables */
        .resource-type-item--clickable {
          cursor: pointer;
          transition: all 0.2s ease;
          border: 1px solid transparent;
        }
        .resource-type-item--clickable:hover {
          border-color: var(--color-primary, #3182ce);
          box-shadow: 0 2px 8px rgba(0,0,0,0.08);
          transform: translateY(-2px);
        }

        .resource-type-info {
          display: flex;
          flex-direction: column;
        }

        .resource-type-value {
          font-size: var(--text-2xl);
          font-weight: var(--font-bold);
          color: var(--color-text);
        }

        .resource-type-label {
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        /* ====== Actions rapides ====== */
        .quick-actions-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
          gap: var(--spacing-lg);
        }

        .quick-action-card {
          display: flex;
          align-items: flex-start;
          gap: var(--spacing-lg);
          padding: var(--spacing-lg);
          background: var(--color-bg-secondary);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-lg);
          text-decoration: none;
          color: inherit;
          transition: all var(--transition-base);
        }

        .quick-action-card:hover {
          border-color: var(--color-primary);
          box-shadow: var(--shadow-md);
          transform: translateY(-2px);
        }

        .quick-action-icon {
          font-size: 2rem;
          line-height: 1;
        }

        .quick-action-content h3 {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          margin-bottom: var(--spacing-xs);
          color: var(--color-text);
        }

        .quick-action-content p {
          font-size: var(--text-sm);
          color: var(--color-text-light);
          margin: 0;
        }

        @media (max-width: 768px) {
          .resource-type-grid,
          .quick-actions-grid {
            grid-template-columns: 1fr;
          }
        }
      `})]})},Be={container:{maxWidth:"900px",margin:"0 auto",padding:"24px"},title:{fontSize:"1.5rem",fontWeight:700,color:"#1a365d",marginBottom:"24px"},form:{background:"#ffffff",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",marginBottom:"32px",border:"1px solid #e2e8f0"},formTitle:{fontSize:"1.1rem",fontWeight:600,color:"#2d3748",marginBottom:"20px",paddingBottom:"12px",borderBottom:"2px solid #3182ce"},formGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"16px",marginBottom:"20px"},fieldGroup:{display:"flex",flexDirection:"column",gap:"6px"},label:{fontSize:"0.875rem",fontWeight:600,color:"#4a5568"},labelOptional:{fontSize:"0.75rem",fontWeight:400,color:"#a0aec0",marginLeft:"4px"},input:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"0.95rem",outline:"none",transition:"border-color 0.2s"},select:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"0.95rem",background:"#fff",cursor:"pointer"},textarea:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"0.95rem",minHeight:"80px",resize:"vertical",fontFamily:"inherit"},btnPrimary:{padding:"12px 28px",background:"#3182ce",color:"#fff",border:"none",borderRadius:"8px",fontSize:"0.95rem",fontWeight:600,cursor:"pointer",transition:"background 0.2s"},btnSecondary:{padding:"12px 28px",background:"#e2e8f0",color:"#4a5568",border:"none",borderRadius:"8px",fontSize:"0.95rem",fontWeight:600,cursor:"pointer",marginLeft:"12px"},btnDanger:{padding:"6px 14px",background:"#fed7d7",color:"#c53030",border:"1px solid #fc8181",borderRadius:"6px",fontSize:"0.8rem",cursor:"pointer"},btnEdit:{padding:"6px 14px",background:"#ebf8ff",color:"#2b6cb0",border:"1px solid #90cdf4",borderRadius:"6px",fontSize:"0.8rem",cursor:"pointer",marginRight:"8px"},card:{background:"#fff",borderRadius:"10px",padding:"16px 20px",boxShadow:"0 1px 4px rgba(0,0,0,0.06)",border:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},badge:{display:"inline-block",padding:"3px 10px",borderRadius:"12px",fontSize:"0.75rem",fontWeight:600},badgeCollege:{background:"#ebf8ff",color:"#2b6cb0"},badgeLycee:{background:"#fefcbf",color:"#975a16"},badgeFormationLibre:{background:"#f0fff4",color:"#276749"},tabs:{display:"flex",gap:"8px",marginBottom:"20px",flexWrap:"wrap"},tab:{padding:"8px 20px",borderRadius:"8px",border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,transition:"all 0.2s"},tabActive:{background:"#3182ce",color:"#fff",borderColor:"#3182ce"}},Tv={nom:"",niveau:"college",classe:"6eme",ordre:0,coefficient:void 0,couleur:"",icone:"",description:""},d5=()=>{const[e,t]=g.useState([]),[n,a]=g.useState(Tv),[l,o]=g.useState(null),[u,d]=g.useState(!1),[f,p]=g.useState("all");g.useEffect(()=>{const E=ke(_e(X,"disciplines"),Ke("nom")),w=hf(E,z=>{const k=z.docs.map(O=>({id:O.id,...O.data(),createdAt:O.data().createdAt?.toDate()||new Date,updatedAt:O.data().updatedAt?.toDate()||new Date}));t(k)});return()=>w()},[]);const h=g.useCallback(E=>{const w=w1(E)[0]?.value||"6eme";a(z=>({...z,niveau:E,classe:w,coefficient:E==="formation_libre"?void 0:z.coefficient}))},[]),v=async E=>{if(E.preventDefault(),!!n.nom.trim()){d(!0);try{const w={nom:n.nom.trim(),niveau:n.niveau,classe:n.classe,ordre:n.ordre,...n.coefficient!==void 0&&{coefficient:n.coefficient},couleur:n.couleur||"",icone:n.icone||"",description:n.description||"",updatedAt:Oe.now()};l?await Qe(Ne(X,"disciplines",l),w):await Tt(_e(X,"disciplines"),{...w,createdAt:Oe.now()}),a(Tv),o(null)}catch(w){console.error("Erreur lors de la sauvegarde :",w),alert("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{d(!1)}}},b=E=>{a({nom:E.nom,niveau:E.niveau,classe:E.classe,ordre:E.ordre,coefficient:E.coefficient,couleur:E.couleur||"",icone:E.icone||"",description:E.description||""}),o(E.id)},x=async(E,w)=>{if(window.confirm(`Supprimer la discipline "${w}" ? Cette action est irrversible.`))try{await en(Ne(X,"disciplines",E))}catch(z){console.error("Erreur lors de la suppression :",z)}},j=()=>{a(Tv),o(null)},N=w1(n.niveau),S=f==="all"?e:e.filter(E=>E.niveau===f),C=E=>({...Be.badge,...E==="college"?Be.badgeCollege:{},...E==="lycee"?Be.badgeLycee:{},...E==="formation_libre"?Be.badgeFormationLibre:{}});return r.jsxs("div",{style:Be.container,children:[r.jsx("h2",{style:Be.title,children:" Gestion des Disciplines"}),r.jsxs("form",{style:Be.form,onSubmit:v,children:[r.jsx("h3",{style:Be.formTitle,children:l?" Modifier la discipline":" Ajouter une discipline"}),r.jsxs("div",{style:Be.formGrid,children:[r.jsxs("div",{style:Be.fieldGroup,children:[r.jsx("label",{style:Be.label,children:"Nom de la discipline"}),r.jsx("input",{type:"text",style:Be.input,value:n.nom,onChange:E=>a({...n,nom:E.target.value}),placeholder:"Ex : Cuisine sngalaise, Couture, Franais...",required:!0})]}),r.jsxs("div",{style:Be.fieldGroup,children:[r.jsx("label",{style:Be.label,children:"Niveau"}),r.jsxs("select",{style:Be.select,value:n.niveau,onChange:E=>h(E.target.value),children:[r.jsx("option",{value:"college",children:" Collge"}),r.jsx("option",{value:"lycee",children:" Lyce"}),r.jsx("option",{value:"formation_libre",children:" Formation libre"})]})]}),r.jsxs("div",{style:Be.fieldGroup,children:[r.jsx("label",{style:Be.label,children:n.niveau==="formation_libre"?"Niveau de formation":"Classe"}),r.jsx("select",{style:Be.select,value:n.classe,onChange:E=>a({...n,classe:E.target.value}),children:N.map(({value:E,label:w})=>r.jsx("option",{value:E,children:w},E))})]}),r.jsxs("div",{style:Be.fieldGroup,children:[r.jsx("label",{style:Be.label,children:"Ordre d'affichage"}),r.jsx("input",{type:"number",style:Be.input,value:n.ordre,onChange:E=>a({...n,ordre:Number(E.target.value)}),placeholder:"Ex : 1",min:"0"})]}),r.jsxs("div",{style:Be.fieldGroup,children:[r.jsxs("label",{style:Be.label,children:["Coefficient",n.niveau==="formation_libre"&&r.jsx("span",{style:Be.labelOptional,children:"(optionnel)"})]}),r.jsx("input",{type:"number",style:Be.input,value:n.coefficient??"",onChange:E=>a({...n,coefficient:E.target.value?Number(E.target.value):void 0}),placeholder:n.niveau==="formation_libre"?"Non requis":"Ex : 3",min:"1",max:"10",required:n.niveau!=="formation_libre"})]}),r.jsxs("div",{style:Be.fieldGroup,children:[r.jsxs("label",{style:Be.label,children:["Couleur",r.jsx("span",{style:Be.labelOptional,children:"(optionnel)"})]}),r.jsx("input",{type:"color",style:{...Be.input,maxWidth:"80px",padding:"4px",height:"40px"},value:n.couleur||"#3182ce",onChange:E=>a({...n,couleur:E.target.value})})]})]}),r.jsxs("div",{style:{...Be.fieldGroup,marginBottom:"20px"},children:[r.jsxs("label",{style:Be.label,children:["Description",r.jsx("span",{style:Be.labelOptional,children:"(optionnel)"})]}),r.jsx("textarea",{style:Be.textarea,value:n.description,onChange:E=>a({...n,description:E.target.value}),placeholder:"Brve description de la discipline..."})]}),r.jsxs("div",{style:{...Be.fieldGroup,marginBottom:"20px"},children:[r.jsxs("label",{style:Be.label,children:["Icne (emoji)",r.jsx("span",{style:Be.labelOptional,children:"(optionnel)"})]}),r.jsx("input",{type:"text",style:{...Be.input,maxWidth:"120px"},value:n.icone,onChange:E=>a({...n,icone:E.target.value}),placeholder:""})]}),r.jsxs("div",{children:[r.jsx("button",{type:"submit",style:Be.btnPrimary,disabled:u,children:u?"Enregistrement...":l?"Mettre  jour":"Ajouter la discipline"}),l&&r.jsx("button",{type:"button",style:Be.btnSecondary,onClick:j,children:"Annuler"})]})]}),r.jsxs("div",{children:[r.jsxs("h3",{style:Be.formTitle,children:[" Disciplines existantes (",S.length,")"]}),r.jsxs("div",{style:Be.tabs,children:[r.jsx("button",{style:{...Be.tab,...f==="all"?Be.tabActive:{}},onClick:()=>p("all"),children:"Toutes"}),r.jsx("button",{style:{...Be.tab,...f==="college"?Be.tabActive:{}},onClick:()=>p("college"),children:" Collge"}),r.jsx("button",{style:{...Be.tab,...f==="lycee"?Be.tabActive:{}},onClick:()=>p("lycee"),children:" Lyce"}),r.jsx("button",{style:{...Be.tab,...f==="formation_libre"?Be.tabActive:{}},onClick:()=>p("formation_libre"),children:" Formation libre"})]}),S.length===0?r.jsx("p",{style:{color:"#a0aec0",fontStyle:"italic",textAlign:"center",padding:"32px"},children:"Aucune discipline trouve pour ce filtre."}):S.map(E=>r.jsxs("div",{style:Be.card,children:[r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[E.icone&&r.jsx("span",{style:{fontSize:"1.2rem"},children:E.icone}),r.jsx("strong",{style:{fontSize:"1rem",color:"#2d3748"},children:E.nom}),r.jsx("span",{style:C(E.niveau),children:hA[E.niveau]})]}),r.jsxs("div",{style:{fontSize:"0.85rem",color:"#718096"},children:[E.niveau==="formation_libre"?"Niveau":"Classe"," :"," ",vA(E.classe),E.coefficient!==void 0&&r.jsxs("span",{style:{marginLeft:"12px"},children:["| Coeff : ",E.coefficient]})]})]}),r.jsxs("div",{style:{display:"flex",gap:"4px"},children:[r.jsx("button",{style:Be.btnEdit,onClick:()=>b(E),children:"Modifier"}),r.jsx("button",{style:Be.btnDanger,onClick:()=>x(E.id,E.nom),children:"Supprimer"})]})]},E.id))]})]})},D1={numero:1,titre:"",description:"",objectifs:[],dureeEstimee:0,isPremium:!1,actif:!0},m5=()=>{const[e,t]=g.useState([]),[n,a]=g.useState([]),[l,o]=g.useState(""),[u,d]=g.useState(!0),[f,p]=g.useState(!1),[h,v]=g.useState(!1),[b,x]=g.useState(null),[j,N]=g.useState(null),[S,C]=g.useState(null),[E,w]=g.useState(!1),[z,k]=g.useState(!1),[O,P]=g.useState(null),[D,L]=g.useState(null),[U,$]=g.useState({...D1,disciplineId:""}),[B,re]=g.useState({}),[se,M]=g.useState(""),q=g.useCallback(async()=>{try{d(!0);const H=await Ki.getAll();t(H),H.length>0&&!l&&o(H[0].id)}catch(H){console.error("Erreur lors du chargement des disciplines:",H),N("Impossible de charger les disciplines.")}finally{d(!1)}},[l]),F=g.useCallback(async()=>{if(!l){a([]);return}try{p(!0);const H=await Ti.getByDiscipline(l);a(H)}catch(H){console.error("Erreur lors du chargement des chapitres:",H),N("Impossible de charger les chapitres.")}finally{p(!1)}},[l]);g.useEffect(()=>{q()},[q]),g.useEffect(()=>{F()},[F]);const R=()=>{const H={};return U.disciplineId||(H.disciplineId="Veuillez slectionner une discipline"),U.titre.trim()?U.titre.length<3&&(H.titre="Le titre doit contenir au moins 3 caractres"):H.titre="Le titre du chapitre est requis",U.numero<1&&(H.numero="Le numro doit tre suprieur  0"),re(H),Object.keys(H).length===0},K=H=>{o(H),N(null)},I=async()=>{const H=await Ti.getNextNumero(l);P(null),$({...D1,disciplineId:l,numero:H}),re({}),M(""),w(!0)},te=H=>{P(H),$({disciplineId:H.disciplineId,numero:H.numero,titre:H.titre,description:H.description,objectifs:H.objectifs||[],dureeEstimee:H.dureeEstimee,isPremium:H.isPremium,actif:H.actif}),re({}),M(""),w(!0)},Y=H=>{L(H),k(!0)},oe=()=>{w(!1),k(!1),P(null),L(null),re({}),M("")},he=H=>{const{name:de,value:we,type:qe}=H.target,We=H.target.checked;$(Xe=>({...Xe,[de]:qe==="checkbox"?We:qe==="number"?Number(we):we})),B[de]&&re(Xe=>({...Xe,[de]:void 0}))},ge=()=>{se.trim()&&($(H=>({...H,objectifs:[...H.objectifs||[],se.trim()]})),M(""))},Q=H=>{$(de=>({...de,objectifs:(de.objectifs||[]).filter((we,qe)=>qe!==H)}))},ve=async H=>{if(H.preventDefault(),!!R())try{v(!0),N(null),O?(await Ti.update(O.id,U),C("Chapitre modifi avec succs !")):(await Ti.create(U),C("Chapitre cr avec succs !")),oe(),await F(),setTimeout(()=>C(null),3e3)}catch(de){console.error("Erreur lors de la sauvegarde:",de),N("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{v(!1)}},Me=async()=>{if(D)try{x(D.id),await Ti.delete(D.id),C("Chapitre supprim avec succs !"),oe(),await F(),setTimeout(()=>C(null),3e3)}catch(H){console.error("Erreur lors de la suppression:",H),N("Erreur lors de la suppression. Veuillez ressayer.")}finally{x(null)}},ce=async H=>{try{await Ti.toggleActive(H.id,!H.actif),await F(),C(H.actif?"Chapitre dsactiv":"Chapitre activ"),setTimeout(()=>C(null),2e3)}catch{N("Erreur lors de la mise  jour")}},Z=H=>{const de=e.find(we=>we.id===H);return de?de.nom:"Non trouve"};return r.jsxs("div",{className:"chapitre-manager",children:[r.jsxs("header",{className:"admin-page-header",children:[r.jsxs("div",{className:"admin-page-header__info",children:[r.jsx("h1",{className:"admin-page-header__title",children:"Gestion des Chapitres"}),r.jsx("p",{className:"admin-page-header__subtitle",children:"Organisez le contenu pdagogique par chapitres"})]}),r.jsx("div",{className:"admin-page-header__actions",children:r.jsxs("button",{onClick:I,className:"btn btn--primary",disabled:!l||u,children:[r.jsx("span",{children:""}),"Nouveau chapitre"]})})]}),j&&r.jsxs("div",{className:"alert alert--error",children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:j})}),r.jsx("button",{onClick:()=>N(null),className:"alert__close",children:""})]}),S&&r.jsxs("div",{className:"alert alert--success",children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:S})})]}),r.jsx("div",{className:"content-card",style:{marginBottom:"var(--spacing-lg)"},children:r.jsx("div",{className:"content-card__body",children:r.jsxs("div",{className:"discipline-selector",children:[r.jsx("label",{className:"form-label",children:"Slectionner une discipline :"}),u?r.jsx("p",{className:"text-muted",children:"Chargement des disciplines..."}):e.length===0?r.jsxs("p",{className:"text-muted",children:["Aucune discipline disponible.",r.jsx("a",{href:"/admin/disciplines",children:" Crer une discipline"})]}):r.jsx("div",{className:"discipline-tabs",children:e.map(H=>r.jsxs("button",{className:`discipline-tab ${l===H.id?"discipline-tab--active":""}`,onClick:()=>K(H.id),style:{"--discipline-color":H.couleur||"#2563eb"},children:[r.jsx("span",{className:"discipline-tab__icon",children:H.icone||""}),r.jsx("span",{className:"discipline-tab__name",children:H.nom}),r.jsx("span",{className:"discipline-tab__class",children:H.classe})]},H.id))})]})})}),r.jsxs("div",{className:"admin-table-container",children:[r.jsx("div",{className:"admin-table-header",children:r.jsxs("h2",{className:"admin-table-title",children:["Chapitres ",l&&`- ${Z(l)}`,n.length>0&&` (${n.length})`]})}),f?r.jsxs("div",{className:"loading-container",style:{padding:"var(--spacing-2xl)"},children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement des chapitres..."})]}):l?n.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-state__icon",children:""}),r.jsx("h3",{className:"empty-state__title",children:"Aucun chapitre"}),r.jsx("p",{className:"empty-state__message",children:"Cette discipline n'a pas encore de chapitres."}),r.jsx("button",{onClick:I,className:"btn btn--primary",children:"Crer le premier chapitre"})]}):r.jsx("div",{className:"chapitres-list",children:n.map(H=>r.jsxs("div",{className:`chapitre-card ${H.actif?"":"chapitre-card--inactive"}`,children:[r.jsx("div",{className:"chapitre-card__number",children:H.numero}),r.jsxs("div",{className:"chapitre-card__content",children:[r.jsxs("h3",{className:"chapitre-card__title",children:[H.titre,H.isPremium&&r.jsx("span",{className:"badge badge--premium",children:"Premium"}),!H.actif&&r.jsx("span",{className:"badge badge--warning",children:"Inactif"})]}),H.description&&r.jsx("p",{className:"chapitre-card__description",children:H.description}),r.jsxs("div",{className:"chapitre-card__meta",children:[H.dureeEstimee&&r.jsxs("span",{children:[" ",H.dureeEstimee,"h estime"]}),H.objectifs&&H.objectifs.length>0&&r.jsxs("span",{children:[" ",H.objectifs.length," objectif(s)"]})]})]}),r.jsxs("div",{className:"chapitre-card__actions",children:[r.jsx("button",{onClick:()=>ce(H),className:`table-action-btn ${H.actif?"table-action-btn--view":"table-action-btn--edit"}`,title:H.actif?"Dsactiver":"Activer",children:H.actif?"":""}),r.jsx("button",{onClick:()=>te(H),className:"table-action-btn table-action-btn--edit",title:"Modifier",children:""}),r.jsx("button",{onClick:()=>Y(H),className:"table-action-btn table-action-btn--delete",title:"Supprimer",disabled:b===H.id,children:b===H.id?"":""})]})]},H.id))}):r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-state__icon",children:""}),r.jsx("h3",{className:"empty-state__title",children:"Slectionnez une discipline"}),r.jsx("p",{className:"empty-state__message",children:"Choisissez une discipline ci-dessus pour voir ses chapitres."})]})]}),E&&r.jsx("div",{className:"modal-overlay",onClick:oe,children:r.jsxs("div",{className:"modal modal--lg",onClick:H=>H.stopPropagation(),children:[r.jsxs("div",{className:"modal__header",children:[r.jsx("h2",{className:"modal__title",children:O?"Modifier le chapitre":"Nouveau chapitre"}),r.jsx("button",{onClick:oe,className:"modal__close",children:""})]}),r.jsxs("form",{onSubmit:ve,children:[r.jsxs("div",{className:"modal__body",children:[!O&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label form-label--required",children:"Discipline"}),r.jsxs("select",{name:"disciplineId",className:`form-select ${B.disciplineId?"form-select--error":""}`,value:U.disciplineId,onChange:he,children:[r.jsx("option",{value:"",children:"Slectionner une discipline"}),e.map(H=>r.jsxs("option",{value:H.id,children:[H.icone," ",H.nom," (",H.classe,")"]},H.id))]}),B.disciplineId&&r.jsx("span",{className:"form-error",children:B.disciplineId})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",style:{flex:"0 0 100px"},children:[r.jsx("label",{className:"form-label form-label--required",children:"N"}),r.jsx("input",{type:"number",name:"numero",className:`form-input ${B.numero?"form-input--error":""}`,min:"1",value:U.numero,onChange:he}),B.numero&&r.jsx("span",{className:"form-error",children:B.numero})]}),r.jsxs("div",{className:"form-group",style:{flex:1},children:[r.jsx("label",{className:"form-label form-label--required",children:"Titre du chapitre"}),r.jsx("input",{type:"text",name:"titre",className:`form-input ${B.titre?"form-input--error":""}`,placeholder:"Ex: Les fractions, La Rvolution franaise...",value:U.titre,onChange:he}),B.titre&&r.jsx("span",{className:"form-error",children:B.titre})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Description"}),r.jsx("textarea",{name:"description",className:"form-textarea",rows:3,placeholder:"Description du chapitre...",value:U.description||"",onChange:he})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Objectifs pdagogiques"}),r.jsxs("div",{className:"objectifs-input",children:[r.jsx("input",{type:"text",className:"form-input",placeholder:"Ajouter un objectif...",value:se,onChange:H=>M(H.target.value),onKeyPress:H=>H.key==="Enter"&&(H.preventDefault(),ge())}),r.jsx("button",{type:"button",onClick:ge,className:"btn btn--outline btn--sm",children:"Ajouter"})]}),U.objectifs&&U.objectifs.length>0&&r.jsx("ul",{className:"objectifs-list",children:U.objectifs.map((H,de)=>r.jsxs("li",{className:"objectif-item",children:[r.jsxs("span",{children:[" ",H]}),r.jsx("button",{type:"button",onClick:()=>Q(de),className:"objectif-remove",children:""})]},de))})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Dure estime (heures)"}),r.jsx("input",{type:"number",name:"dureeEstimee",className:"form-input",min:"0",step:"0.5",placeholder:"Ex: 2",value:U.dureeEstimee||"",onChange:he})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Options"}),r.jsxs("div",{className:"form-options",children:[r.jsxs("label",{className:"form-checkbox",children:[r.jsx("input",{type:"checkbox",name:"isPremium",checked:U.isPremium,onChange:he}),r.jsx("span",{children:"Contenu Premium "})]}),r.jsxs("label",{className:"form-checkbox",children:[r.jsx("input",{type:"checkbox",name:"actif",checked:U.actif!==!1,onChange:he}),r.jsx("span",{children:"Chapitre actif"})]})]})]})]})]}),r.jsxs("div",{className:"modal__footer",children:[r.jsx("button",{type:"button",onClick:oe,className:"btn btn--outline",disabled:h,children:"Annuler"}),r.jsx("button",{type:"submit",className:"btn btn--primary",disabled:h,children:h?"Enregistrement...":O?"Mettre  jour":"Crer le chapitre"})]})]})]})}),z&&D&&r.jsx("div",{className:"modal-overlay",onClick:oe,children:r.jsxs("div",{className:"modal",onClick:H=>H.stopPropagation(),children:[r.jsxs("div",{className:"modal__header",children:[r.jsx("h2",{className:"modal__title",children:"Confirmer la suppression"}),r.jsx("button",{onClick:oe,className:"modal__close",children:""})]}),r.jsxs("div",{className:"modal__body",children:[r.jsxs("p",{children:["Supprimer le chapitre ",r.jsxs("strong",{children:[D.numero,". ",D.titre]})," ?"]}),r.jsxs("div",{className:"alert alert--warning",style:{marginTop:"var(--spacing-md)"},children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:"Les ressources associes ne seront pas supprimes automatiquement."})})]})]}),r.jsxs("div",{className:"modal__footer",children:[r.jsx("button",{onClick:oe,className:"btn btn--outline",children:"Annuler"}),r.jsx("button",{onClick:Me,className:"btn btn--danger",disabled:b!==null,children:b?"Suppression...":"Supprimer"})]})]})}),r.jsx("style",{children:`
        /* Slecteur de discipline */
        .discipline-tabs {
          display: flex;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
          margin-top: var(--spacing-md);
        }

        .discipline-tab {
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          padding: var(--spacing-sm) var(--spacing-md);
          border: 2px solid var(--color-border);
          border-radius: var(--radius-lg);
          background: white;
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .discipline-tab:hover {
          border-color: var(--discipline-color, var(--color-primary));
        }

        .discipline-tab--active {
          border-color: var(--discipline-color, var(--color-primary));
          background: color-mix(in srgb, var(--discipline-color, var(--color-primary)) 10%, white);
        }

        .discipline-tab__icon {
          font-size: var(--text-lg);
        }

        .discipline-tab__name {
          font-weight: var(--font-medium);
        }

        .discipline-tab__class {
          font-size: var(--text-xs);
          color: var(--color-text-light);
          background: var(--color-bg-secondary);
          padding: 2px 6px;
          border-radius: var(--radius-sm);
        }

        /* Liste des chapitres */
        .chapitres-list {
          display: flex;
          flex-direction: column;
          gap: var(--spacing-md);
          padding: var(--spacing-lg);
        }

        .chapitre-card {
          display: flex;
          align-items: center;
          gap: var(--spacing-lg);
          padding: var(--spacing-lg);
          background: var(--color-bg-secondary);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-lg);
          transition: all var(--transition-base);
        }

        .chapitre-card:hover {
          border-color: var(--color-primary);
          box-shadow: var(--shadow-md);
        }

        .chapitre-card--inactive {
          opacity: 0.6;
          background: var(--color-bg-tertiary);
        }

        .chapitre-card__number {
          width: 48px;
          height: 48px;
          background: var(--color-primary);
          color: white;
          border-radius: var(--radius-md);
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
          flex-shrink: 0;
        }

        .chapitre-card__content {
          flex: 1;
          min-width: 0;
        }

        .chapitre-card__title {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          margin-bottom: var(--spacing-xs);
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
        }

        .chapitre-card__description {
          font-size: var(--text-sm);
          color: var(--color-text-light);
          margin: 0 0 var(--spacing-sm);
        }

        .chapitre-card__meta {
          display: flex;
          gap: var(--spacing-lg);
          font-size: var(--text-xs);
          color: var(--color-text-lighter);
        }

        .chapitre-card__actions {
          display: flex;
          gap: var(--spacing-sm);
        }

        /* Formulaire: Ligne */
        .form-row {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: var(--spacing-lg);
        }

        @media (max-width: 600px) {
          .form-row {
            grid-template-columns: 1fr;
          }
        }

        /* Objectifs */
        .objectifs-input {
          display: flex;
          gap: var(--spacing-sm);
        }

        .objectifs-list {
          list-style: none;
          margin-top: var(--spacing-md);
        }

        .objectif-item {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: var(--spacing-sm) var(--spacing-md);
          background: var(--color-bg-secondary);
          border-radius: var(--radius-md);
          margin-bottom: var(--spacing-xs);
        }

        .objectif-remove {
          background: none;
          border: none;
          cursor: pointer;
          color: var(--color-error);
          opacity: 0.7;
        }

        .objectif-remove:hover {
          opacity: 1;
        }

        /* Options */
        .form-options {
          display: flex;
          flex-direction: column;
          gap: var(--spacing-sm);
          margin-top: var(--spacing-sm);
        }
      `})]})},Dd=[{value:"cours",label:"Cours",icon:"",color:"#2563eb"},{value:"exercice",label:"Exercice",icon:"",color:"#10b981"},{value:"video",label:"Vido",icon:"",color:"#ef4444"},{value:"document",label:"Document",icon:"",color:"#f59e0b"},{value:"quiz",label:"Quiz",icon:"",color:"#8b5cf6"}],Md={cours:[".pdf",".doc",".docx",".ppt",".pptx"],exercice:[".pdf",".doc",".docx"],video:[".mp4",".webm",".mov",".avi"],document:[".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx"],quiz:[".json",".pdf"]},qv=50,M1={titre:"",type:"cours",description:"",contenu:"",chapitre:"",ordre:1,isPremium:!1,actif:!0,tags:[],duree:void 0,urlExterne:""},f5=()=>{const{currentUser:e}=rt(),[t,n]=g.useState([]),[a,l]=g.useState([]),[o,u]=g.useState([]),[d,f]=g.useState([]),[p,h]=g.useState(""),[v,b]=g.useState(""),[x,j]=g.useState(""),[N,S]=g.useState(""),[C,E]=g.useState(""),[w,z]=g.useState(!0),[k,O]=g.useState(!1),[P,D]=g.useState(!1),[L,U]=g.useState(!1),[$,B]=g.useState(null),[re,se]=g.useState(!1),[M,q]=g.useState(0),[F,R]=g.useState(null),[K,I]=g.useState(null),[te,Y]=g.useState(!1),[oe,he]=g.useState(!1),[ge,Q]=g.useState(!1),[ve,Me]=g.useState(null),[ce,Z]=g.useState(null),[H,de]=g.useState(null),[we,qe]=g.useState({...M1,disciplineId:""}),[We,Xe]=g.useState({}),[nt,gr]=g.useState(null),[Dr,ir]=g.useState(null),rn=g.useRef(null),[pe,Ce]=g.useState(""),Re=g.useCallback(async()=>{try{z(!0);const ne=await Ki.getAll();n(ne),ne.length>0&&!p&&h(ne[0].id)}catch(ne){console.error("Erreur lors du chargement des disciplines:",ne),R("Impossible de charger les disciplines.")}finally{z(!1)}},[p]),He=g.useCallback(async()=>{if(!p){l([]);return}try{O(!0);const ne=await Ti.getByDiscipline(p);l(ne)}catch(ne){console.error("Erreur lors du chargement des chapitres:",ne)}finally{O(!1)}},[p]),lt=g.useCallback(async()=>{if(!p){u([]),f([]);return}try{D(!0);const ne=await Ia.getByDiscipline(p);u(ne),f(ne)}catch(ne){console.error("Erreur lors du chargement des ressources:",ne),R("Impossible de charger les ressources.")}finally{D(!1)}},[p]);g.useEffect(()=>{Re()},[Re]),g.useEffect(()=>{He()},[He]),g.useEffect(()=>{lt()},[lt]),g.useEffect(()=>{let ne=[...o];if(v&&(ne=ne.filter($e=>$e.chapitre===v)),x&&(ne=ne.filter($e=>$e.type===x)),N==="premium"?ne=ne.filter($e=>$e.isPremium):N==="free"&&(ne=ne.filter($e=>!$e.isPremium)),C){const $e=C.toLowerCase();ne=ne.filter(_t=>_t.titre.toLowerCase().includes($e)||_t.description?.toLowerCase().includes($e)||_t.tags?.some(Er=>Er.toLowerCase().includes($e)))}f(ne)},[o,v,x,N,C]);const Vt=()=>{const ne={};if(we.disciplineId||(ne.disciplineId="Veuillez slectionner une discipline"),we.titre.trim()?we.titre.length<3&&(ne.titre="Le titre doit contenir au moins 3 caractres"):ne.titre="Le titre est requis",we.type||(ne.type="Veuillez slectionner un type de ressource"),nt){const $e="."+nt.name.split(".").pop()?.toLowerCase(),_t=Md[we.type];_t.includes($e)||(ne.fichier=`Extension non autorise. Extensions acceptes : ${_t.join(", ")}`),nt.size/(1024*1024)>qv&&(ne.fichier=`Le fichier est trop volumineux (max ${qv} Mo)`)}return Xe(ne),Object.keys(ne).length===0},Br=ne=>{h(ne),b(""),R(null)},Ur=()=>{Me(null),qe({...M1,disciplineId:p}),Xe({}),gr(null),ir(null),Ce(""),Y(!0)},J=ne=>{Me(ne),qe({disciplineId:ne.disciplineId,titre:ne.titre,type:ne.type,description:ne.description,contenu:ne.contenu,chapitre:ne.chapitre||"",ordre:ne.ordre,isPremium:ne.isPremium,actif:ne.actif,tags:ne.tags||[],duree:ne.duree,urlExterne:ne.urlExterne||""}),Xe({}),gr(null),ir(ne.fichierURL||null),Ce(""),Y(!0)},W=ne=>{de(ne),Q(!0)},fe=ne=>{Z(ne),he(!0)},je=()=>{Y(!1),he(!1),Q(!1),Me(null),Z(null),de(null),Xe({}),gr(null),ir(null),Ce("")},Te=ne=>{const{name:$e,value:_t,type:Er}=ne.target,_o=ne.target.checked;qe(ts=>({...ts,[$e]:Er==="checkbox"?_o:Er==="number"?Number(_t):_t})),We[$e]&&Xe(ts=>({...ts,[$e]:void 0}))},gt=ne=>{const $e=ne.target.files?.[0];if($e)if(gr($e),Xe(_t=>({..._t,fichier:void 0})),$e.type.startsWith("image/")||$e.type.startsWith("video/")){const _t=new FileReader;_t.onloadend=()=>{ir(_t.result)},_t.readAsDataURL($e)}else ir(null)},qt=()=>{gr(null),ir(null),rn.current&&(rn.current.value="")},bn=()=>{pe.trim()&&!we.tags?.includes(pe.trim())&&(qe(ne=>({...ne,tags:[...ne.tags||[],pe.trim()]})),Ce(""))},Ji=ne=>{qe($e=>({...$e,tags:($e.tags||[]).filter((_t,Er)=>Er!==ne)}))},pp=async ne=>{if(ne.preventDefault(),!!Vt())try{U(!0),R(null);let $e=ve?.fichierURL,_t=ve?.fichierNom;if(nt){se(!0);const _o=ve?.id||`temp_${Date.now()}`;$e=await Ia.uploadFile(nt,_o),_t=nt?.name||"fichier",se(!1)}const Er={...we,fichierURL:$e,fichierNom:_t};ve?(await Ia.update(ve.id,Er),I("Ressource modifie avec succs !")):(await Ia.create(Er,"admin"),I("Ressource cre avec succs !")),je(),await lt(),setTimeout(()=>I(null),3e3)}catch($e){console.error("Erreur lors de la sauvegarde:",$e),R("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{U(!1),se(!1),q(0)}},tl=async()=>{if(ce)try{B(ce.id),ce.fichierURL&&await Ia.deleteFile(ce.fichierURL),await Ia.delete(ce.id),I("Ressource supprime avec succs !"),je(),await lt(),setTimeout(()=>I(null),3e3)}catch(ne){console.error("Erreur lors de la suppression:",ne),R("Erreur lors de la suppression. Veuillez ressayer.")}finally{B(null)}},rl=async ne=>{try{await Ia.togglePremium(ne.id,!ne.isPremium),await lt(),I(ne.isPremium?"Ressource passe en gratuit":"Ressource passe en Premium"),setTimeout(()=>I(null),2e3)}catch{R("Erreur lors de la mise  jour")}},nl=ne=>{const $e=t.find(_t=>_t.id===ne);return $e?$e.nom:"Non trouve"},ba=ne=>{const $e=a.find(_t=>_t.id===ne);return $e?`${$e.numero}. ${$e.titre}`:""},ea=ne=>Dd.find($e=>$e.value===ne)||Dd[0],es=ne=>ne<1024?ne+" o":ne<1024*1024?(ne/1024).toFixed(1)+" Ko":(ne/(1024*1024)).toFixed(1)+" Mo";return r.jsxs("div",{className:"resource-manager",children:[r.jsxs("header",{className:"admin-page-header",children:[r.jsxs("div",{className:"admin-page-header__info",children:[r.jsx("h1",{className:"admin-page-header__title",children:"Gestion des Ressources"}),r.jsx("p",{className:"admin-page-header__subtitle",children:"Grez les cours, exercices, vidos et documents pdagogiques"})]}),r.jsx("div",{className:"admin-page-header__actions",children:r.jsxs("button",{onClick:Ur,className:"btn btn--primary",disabled:!p||w,children:[r.jsx("span",{children:""}),"Nouvelle ressource"]})})]}),F&&r.jsxs("div",{className:"alert alert--error",children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:F})}),r.jsx("button",{onClick:()=>R(null),className:"alert__close",children:""})]}),K&&r.jsxs("div",{className:"alert alert--success",children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:K})})]}),r.jsx("div",{className:"content-card",style:{marginBottom:"var(--spacing-lg)"},children:r.jsx("div",{className:"content-card__body",children:r.jsxs("div",{className:"discipline-selector",children:[r.jsx("label",{className:"form-label",children:"Slectionner une discipline :"}),w?r.jsx("p",{className:"text-muted",children:"Chargement des disciplines..."}):t.length===0?r.jsxs("p",{className:"text-muted",children:["Aucune discipline disponible.",r.jsx("a",{href:"/admin/disciplines",children:" Crer une discipline"})]}):r.jsx("div",{className:"discipline-tabs",children:t.map(ne=>r.jsxs("button",{className:`discipline-tab ${p===ne.id?"discipline-tab--active":""}`,onClick:()=>Br(ne.id),style:{"--discipline-color":ne.couleur||"#2563eb"},children:[r.jsx("span",{className:"discipline-tab__icon",children:ne.icone||""}),r.jsx("span",{className:"discipline-tab__name",children:ne.nom}),r.jsx("span",{className:"discipline-tab__class",children:ne.classe})]},ne.id))})]})})}),r.jsxs("div",{className:"admin-table-container",children:[r.jsxs("div",{className:"admin-table-header",children:[r.jsxs("h2",{className:"admin-table-title",children:["Ressources ",p&&`- ${nl(p)}`,d.length>0&&` (${d.length})`]}),r.jsxs("div",{className:"admin-table-actions",children:[r.jsxs("div",{className:"search-input",children:[r.jsx("span",{className:"search-input__icon",children:""}),r.jsx("input",{type:"text",className:"search-input__field",placeholder:"Rechercher...",value:C,onChange:ne=>E(ne.target.value)})]}),r.jsxs("select",{className:"form-select form-select--sm",value:v,onChange:ne=>b(ne.target.value),disabled:k||a.length===0,children:[r.jsx("option",{value:"",children:"Tous les chapitres"}),a.map(ne=>r.jsxs("option",{value:ne.id,children:[ne.numero,". ",ne.titre]},ne.id))]}),r.jsxs("select",{className:"form-select form-select--sm",value:x,onChange:ne=>j(ne.target.value),children:[r.jsx("option",{value:"",children:"Tous les types"}),Dd.map(ne=>r.jsxs("option",{value:ne.value,children:[ne.icon," ",ne.label]},ne.value))]}),r.jsxs("select",{className:"form-select form-select--sm",value:N,onChange:ne=>S(ne.target.value),children:[r.jsx("option",{value:"",children:"Tous"}),r.jsx("option",{value:"premium",children:" Premium"}),r.jsx("option",{value:"free",children:"Gratuit"})]})]})]}),P?r.jsxs("div",{className:"loading-container",style:{padding:"var(--spacing-2xl)"},children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement des ressources..."})]}):p?d.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-state__icon",children:""}),r.jsx("h3",{className:"empty-state__title",children:"Aucune ressource"}),r.jsx("p",{className:"empty-state__message",children:C||x||N||v?"Aucune ressource ne correspond aux critres de recherche.":"Cette discipline n'a pas encore de ressources."}),!C&&!x&&!N&&!v&&r.jsx("button",{onClick:Ur,className:"btn btn--primary",children:"Crer la premire ressource"})]}):r.jsx("div",{className:"resource-list",style:{padding:"var(--spacing-lg)"},children:d.map(ne=>{const $e=ea(ne.type);return r.jsxs("div",{className:"resource-item",children:[r.jsx("div",{className:`resource-item__icon resource-item__icon--${ne.type}`,style:{backgroundColor:`${$e.color}15`,color:$e.color},children:$e.icon}),r.jsxs("div",{className:"resource-item__content",children:[r.jsxs("div",{className:"resource-item__title",children:[ne.titre,ne.isPremium&&r.jsx("span",{className:"badge badge--premium",children:"Premium"}),!ne.actif&&r.jsx("span",{className:"badge badge--warning",children:"Inactif"})]}),r.jsxs("div",{className:"resource-item__meta",children:[r.jsx("span",{children:$e.label}),ne.chapitre&&r.jsxs("span",{children:[" ",ba(ne.chapitre)]}),ne.duree&&r.jsxs("span",{children:[" ",ne.duree," min"]}),ne.fichierNom&&r.jsxs("span",{children:[" ",ne.fichierNom]}),ne.tags&&ne.tags.length>0&&r.jsxs("span",{children:[" ",ne.tags.join(", ")]})]})]}),r.jsxs("div",{className:"resource-item__actions",children:[r.jsx("button",{onClick:()=>rl(ne),className:`table-action-btn ${ne.isPremium?"table-action-btn--warning":"table-action-btn--view"}`,title:ne.isPremium?"Passer en gratuit":"Passer en Premium",children:ne.isPremium?"":""}),(ne.fichierURL||ne.urlExterne)&&r.jsx("button",{onClick:()=>W(ne),className:"table-action-btn table-action-btn--view",title:"Prvisualiser",children:""}),r.jsx("button",{onClick:()=>J(ne),className:"table-action-btn table-action-btn--edit",title:"Modifier",children:""}),r.jsx("button",{onClick:()=>fe(ne),className:"table-action-btn table-action-btn--delete",title:"Supprimer",disabled:$===ne.id,children:$===ne.id?"":""})]})]},ne.id)})}):r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{className:"empty-state__icon",children:""}),r.jsx("h3",{className:"empty-state__title",children:"Slectionnez une discipline"}),r.jsx("p",{className:"empty-state__message",children:"Choisissez une discipline ci-dessus pour voir ses ressources."})]})]}),te&&r.jsx("div",{className:"modal-overlay",onClick:je,children:r.jsxs("div",{className:"modal modal--xl",onClick:ne=>ne.stopPropagation(),children:[r.jsxs("div",{className:"modal__header",children:[r.jsx("h2",{className:"modal__title",children:ve?"Modifier la ressource":"Nouvelle ressource"}),r.jsx("button",{onClick:je,className:"modal__close",children:""})]}),r.jsxs("form",{onSubmit:pp,children:[r.jsxs("div",{className:"modal__body",children:[!ve&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label form-label--required",children:"Discipline"}),r.jsxs("select",{name:"disciplineId",className:`form-select ${We.disciplineId?"form-select--error":""}`,value:we.disciplineId,onChange:Te,children:[r.jsx("option",{value:"",children:"Slectionner une discipline"}),t.map(ne=>r.jsxs("option",{value:ne.id,children:[ne.icone," ",ne.nom," (",ne.classe,")"]},ne.id))]}),We.disciplineId&&r.jsx("span",{className:"form-error",children:We.disciplineId})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",style:{flex:2},children:[r.jsx("label",{className:"form-label form-label--required",children:"Titre"}),r.jsx("input",{type:"text",name:"titre",className:`form-input ${We.titre?"form-input--error":""}`,placeholder:"Ex: Introduction aux fractions",value:we.titre,onChange:Te}),We.titre&&r.jsx("span",{className:"form-error",children:We.titre})]}),r.jsxs("div",{className:"form-group",style:{flex:1},children:[r.jsx("label",{className:"form-label form-label--required",children:"Type"}),r.jsx("select",{name:"type",className:`form-select ${We.type?"form-select--error":""}`,value:we.type,onChange:Te,children:Dd.map(ne=>r.jsxs("option",{value:ne.value,children:[ne.icon," ",ne.label]},ne.value))}),We.type&&r.jsx("span",{className:"form-error",children:We.type})]})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Chapitre (optionnel)"}),r.jsxs("select",{name:"chapitreId",className:"form-select",value:we.chapitre||"",onChange:Te,disabled:k,children:[r.jsx("option",{value:"",children:"Aucun chapitre"}),a.map(ne=>r.jsxs("option",{value:ne.id,children:[ne.numero,". ",ne.titre]},ne.id))]})]}),r.jsxs("div",{className:"form-group",style:{flex:"0 0 120px"},children:[r.jsx("label",{className:"form-label",children:"Ordre"}),r.jsx("input",{type:"number",name:"ordre",className:"form-input",min:"1",value:we.ordre,onChange:Te})]}),r.jsxs("div",{className:"form-group",style:{flex:"0 0 120px"},children:[r.jsx("label",{className:"form-label",children:"Dure (min)"}),r.jsx("input",{type:"number",name:"duree",className:"form-input",min:"0",placeholder:"Ex: 30",value:we.duree||"",onChange:Te})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Description"}),r.jsx("textarea",{name:"description",className:"form-textarea",rows:3,placeholder:"Description de la ressource...",value:we.description||"",onChange:Te})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{className:"form-label",children:["Fichier",r.jsxs("span",{className:"form-helper",style:{marginLeft:"var(--spacing-sm)"},children:["(",Md[we.type].join(", ")," - max ",qv," Mo)"]})]}),r.jsxs("div",{className:"file-upload",children:[r.jsx("input",{ref:rn,type:"file",accept:Md[we.type].join(","),onChange:gt,className:"file-upload__input",id:"file-input"}),!nt&&!Dr?r.jsxs("label",{htmlFor:"file-input",className:"file-upload__dropzone",children:[r.jsx("div",{className:"file-upload__icon",children:""}),r.jsx("p",{className:"file-upload__text",children:"Cliquez ou glissez un fichier ici"}),r.jsx("p",{className:"file-upload__hint",children:Md[we.type].join(", ")})]}):r.jsxs("div",{className:"file-upload__preview",children:[nt?.type.startsWith("image/")&&Dr&&r.jsx("img",{src:Dr,alt:"Aperu",className:"file-preview__image"}),nt?.type.startsWith("video/")&&Dr&&r.jsx("video",{src:Dr,controls:!0,className:"file-preview__video"}),!nt?.type.startsWith("image/")&&!nt?.type.startsWith("video/")&&r.jsx("div",{className:"file-preview__document",children:r.jsx("span",{className:"file-preview__icon",children:ea(we.type).icon})}),r.jsxs("div",{className:"file-preview__info",children:[r.jsx("p",{className:"file-preview__name",children:nt?.name||ve?.fichierNom}),nt&&r.jsx("p",{className:"file-preview__size",children:es(nt.size)})]}),r.jsx("button",{type:"button",onClick:qt,className:"file-preview__remove",children:""})]})]}),We.fichier&&r.jsx("span",{className:"form-error",children:We.fichier}),re&&r.jsxs("div",{className:"upload-progress",children:[r.jsx("div",{className:"upload-progress__bar",style:{width:`${M}%`}}),r.jsxs("span",{className:"upload-progress__text",children:[M,"%"]})]})]}),we.type==="video"&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"URL externe (YouTube, Vimeo...)"}),r.jsx("input",{type:"url",name:"urlExterne",className:"form-input",placeholder:"https://www.youtube.com/watch?v=...",value:we.urlExterne||"",onChange:Te}),r.jsx("span",{className:"form-helper",children:"Alternative  l'upload de fichier"})]}),we.type==="cours"&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Contenu du cours"}),r.jsx("textarea",{name:"contenu",className:"form-textarea",rows:6,placeholder:"Saisissez le contenu du cours ici...",value:we.contenu||"",onChange:Te}),r.jsx("span",{className:"form-helper",children:"Optionnel si vous uploadez un fichier"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Tags"}),r.jsxs("div",{className:"tags-input",children:[r.jsx("input",{type:"text",className:"form-input",placeholder:"Ajouter un tag...",value:pe,onChange:ne=>Ce(ne.target.value),onKeyPress:ne=>ne.key==="Enter"&&(ne.preventDefault(),bn())}),r.jsx("button",{type:"button",onClick:bn,className:"btn btn--outline btn--sm",children:"Ajouter"})]}),we.tags&&we.tags.length>0&&r.jsx("div",{className:"tags-list",children:we.tags.map((ne,$e)=>r.jsxs("span",{className:"tag",children:[ne,r.jsx("button",{type:"button",onClick:()=>Ji($e),className:"tag__remove",children:""})]},$e))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Options"}),r.jsxs("div",{className:"form-options",children:[r.jsxs("label",{className:"form-checkbox",children:[r.jsx("input",{type:"checkbox",name:"isPremium",checked:we.isPremium,onChange:Te}),r.jsx("span",{children:"Contenu Premium "})]}),r.jsxs("label",{className:"form-checkbox",children:[r.jsx("input",{type:"checkbox",name:"actif",checked:we.actif!==!1,onChange:Te}),r.jsx("span",{children:"Ressource active"})]})]})]})]}),r.jsxs("div",{className:"modal__footer",children:[r.jsx("button",{type:"button",onClick:je,className:"btn btn--outline",disabled:L||re,children:"Annuler"}),r.jsx("button",{type:"submit",className:"btn btn--primary",disabled:L||re,children:L||re?re?`Upload ${M}%...`:"Enregistrement...":ve?"Mettre  jour":"Crer la ressource"})]})]})]})}),ge&&H&&r.jsx("div",{className:"modal-overlay",onClick:je,children:r.jsxs("div",{className:"modal modal--xl",onClick:ne=>ne.stopPropagation(),children:[r.jsxs("div",{className:"modal__header",children:[r.jsxs("h2",{className:"modal__title",children:[ea(H.type).icon," ",H.titre]}),r.jsx("button",{onClick:je,className:"modal__close",children:""})]}),r.jsxs("div",{className:"modal__body",children:[H.type==="video"&&H.urlExterne?r.jsx("div",{className:"preview-video",children:r.jsx("iframe",{src:H.urlExterne.replace("watch?v=","embed/"),title:H.titre,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}):H.fichierURL?r.jsx("div",{className:"preview-file",children:H.fichierURL.match(/\.(jpg|jpeg|png|gif|webp)$/i)?r.jsx("img",{src:H.fichierURL,alt:H.titre}):H.fichierURL.match(/\.(mp4|webm)$/i)?r.jsx("video",{src:H.fichierURL,controls:!0}):H.fichierURL.match(/\.pdf$/i)?r.jsx("iframe",{src:H.fichierURL,title:H.titre}):r.jsxs("div",{className:"preview-download",children:[r.jsx("span",{className:"preview-download__icon",children:ea(H.type).icon}),r.jsx("p",{children:H.fichierNom}),r.jsx("a",{href:H.fichierURL,target:"_blank",rel:"noopener noreferrer",className:"btn btn--primary",children:"Tlcharger"})]})}):H.contenu?r.jsx("div",{className:"preview-content",children:r.jsx("p",{children:H.contenu})}):r.jsx("div",{className:"preview-empty",children:r.jsx("p",{children:"Aucun contenu  prvisualiser"})}),r.jsxs("div",{className:"preview-info",children:[H.description&&r.jsx("p",{className:"preview-description",children:H.description}),r.jsxs("div",{className:"preview-meta",children:[r.jsxs("span",{children:["Type : ",ea(H.type).label]}),H.duree&&r.jsxs("span",{children:["Dure : ",H.duree," min"]}),H.isPremium&&r.jsx("span",{className:"badge badge--premium",children:"Premium"})]})]})]})]})}),oe&&ce&&r.jsx("div",{className:"modal-overlay",onClick:je,children:r.jsxs("div",{className:"modal",onClick:ne=>ne.stopPropagation(),children:[r.jsxs("div",{className:"modal__header",children:[r.jsx("h2",{className:"modal__title",children:"Confirmer la suppression"}),r.jsx("button",{onClick:je,className:"modal__close",children:""})]}),r.jsxs("div",{className:"modal__body",children:[r.jsxs("p",{children:["Supprimer la ressource ",r.jsx("strong",{children:ce.titre})," ?"]}),ce.fichierURL&&r.jsxs("div",{className:"alert alert--warning",style:{marginTop:"var(--spacing-md)"},children:[r.jsx("span",{className:"alert__icon",children:""}),r.jsx("div",{className:"alert__content",children:r.jsx("p",{className:"alert__message",children:"Le fichier associ sera galement supprim de faon permanente."})})]})]}),r.jsxs("div",{className:"modal__footer",children:[r.jsx("button",{onClick:je,className:"btn btn--outline",children:"Annuler"}),r.jsx("button",{onClick:tl,className:"btn btn--danger",disabled:$!==null,children:$?"Suppression...":"Supprimer"})]})]})}),r.jsx("style",{children:`
        /* ==================== SLECTEUR DE DISCIPLINE ==================== */
        
        .discipline-tabs {
          display: flex;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
          margin-top: var(--spacing-md);
        }

        .discipline-tab {
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          padding: var(--spacing-sm) var(--spacing-md);
          border: 2px solid var(--color-border);
          border-radius: var(--radius-lg);
          background: white;
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .discipline-tab:hover {
          border-color: var(--discipline-color, var(--color-primary));
        }

        .discipline-tab--active {
          border-color: var(--discipline-color, var(--color-primary));
          background: color-mix(in srgb, var(--discipline-color, var(--color-primary)) 10%, white);
        }

        .discipline-tab__icon {
          font-size: var(--text-lg);
        }

        .discipline-tab__name {
          font-weight: var(--font-medium);
        }

        .discipline-tab__class {
          font-size: var(--text-xs);
          color: var(--color-text-light);
          background: var(--color-bg-secondary);
          padding: 2px 6px;
          border-radius: var(--radius-sm);
        }

        /* ==================== FORMULAIRE ==================== */
        
        .form-row {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
          gap: var(--spacing-lg);
        }

        .form-options {
          display: flex;
          flex-wrap: wrap;
          gap: var(--spacing-lg);
          margin-top: var(--spacing-sm);
        }

        .form-select--sm {
          padding: var(--spacing-sm) var(--spacing-md);
          font-size: var(--text-sm);
          min-width: 140px;
        }

        /* ==================== UPLOAD DE FICHIER ==================== */
        
        .file-upload {
          position: relative;
        }

        .file-upload__input {
          position: absolute;
          opacity: 0;
          pointer-events: none;
        }

        .file-upload__dropzone {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: var(--spacing-xl);
          border: 2px dashed var(--color-border);
          border-radius: var(--radius-lg);
          background: var(--color-bg-secondary);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .file-upload__dropzone:hover {
          border-color: var(--color-primary);
          background: rgba(37, 99, 235, 0.05);
        }

        .file-upload__icon {
          font-size: 48px;
          margin-bottom: var(--spacing-md);
        }

        .file-upload__text {
          font-weight: var(--font-medium);
          margin-bottom: var(--spacing-xs);
        }

        .file-upload__hint {
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        .file-upload__preview {
          display: flex;
          align-items: center;
          gap: var(--spacing-lg);
          padding: var(--spacing-md);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-lg);
          background: var(--color-bg-secondary);
        }

        .file-preview__image,
        .file-preview__video {
          width: 120px;
          height: 80px;
          object-fit: cover;
          border-radius: var(--radius-md);
        }

        .file-preview__document {
          width: 80px;
          height: 80px;
          background: white;
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .file-preview__icon {
          font-size: 32px;
        }

        .file-preview__info {
          flex: 1;
        }

        .file-preview__name {
          font-weight: var(--font-medium);
          margin-bottom: var(--spacing-xs);
          word-break: break-all;
        }

        .file-preview__size {
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        .file-preview__remove {
          width: 32px;
          height: 32px;
          border: none;
          background: var(--color-error);
          color: white;
          border-radius: 50%;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all var(--transition-base);
        }

        .file-preview__remove:hover {
          background: #dc2626;
          transform: scale(1.1);
        }

        /* ==================== BARRE DE PROGRESSION ==================== */
        
        .upload-progress {
          margin-top: var(--spacing-md);
          height: 8px;
          background: var(--color-bg-tertiary);
          border-radius: var(--radius-full);
          overflow: hidden;
          position: relative;
        }

        .upload-progress__bar {
          height: 100%;
          background: linear-gradient(90deg, var(--color-primary), var(--color-secondary));
          border-radius: var(--radius-full);
          transition: width var(--transition-base);
        }

        .upload-progress__text {
          position: absolute;
          right: var(--spacing-sm);
          top: 50%;
          transform: translateY(-50%);
          font-size: var(--text-xs);
          font-weight: var(--font-semibold);
          color: var(--color-text);
        }

        /* ==================== TAGS ==================== */
        
        .tags-input {
          display: flex;
          gap: var(--spacing-sm);
        }

        .tags-list {
          display: flex;
          flex-wrap: wrap;
          gap: var(--spacing-sm);
          margin-top: var(--spacing-md);
        }

        .tag {
          display: inline-flex;
          align-items: center;
          gap: var(--spacing-xs);
          padding: var(--spacing-xs) var(--spacing-sm);
          background: var(--color-bg-tertiary);
          border-radius: var(--radius-full);
          font-size: var(--text-sm);
          color: var(--color-text);
        }

        .tag__remove {
          width: 18px;
          height: 18px;
          border: none;
          background: transparent;
          color: var(--color-text-light);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          border-radius: 50%;
          transition: all var(--transition-base);
        }

        .tag__remove:hover {
          background: var(--color-error);
          color: white;
        }

        /* ==================== PRVISUALISATION ==================== */
        
        .preview-video {
          position: relative;
          padding-bottom: 56.25%;
          height: 0;
          overflow: hidden;
          border-radius: var(--radius-lg);
        }

        .preview-video iframe {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          border: none;
        }

        .preview-file {
          text-align: center;
        }

        .preview-file img,
        .preview-file video {
          max-width: 100%;
          max-height: 60vh;
          border-radius: var(--radius-lg);
        }

        .preview-file iframe {
          width: 100%;
          height: 60vh;
          border: none;
          border-radius: var(--radius-lg);
        }

        .preview-download {
          padding: var(--spacing-2xl);
          text-align: center;
        }

        .preview-download__icon {
          font-size: 64px;
          display: block;
          margin-bottom: var(--spacing-lg);
        }

        .preview-content {
          padding: var(--spacing-lg);
          background: var(--color-bg-secondary);
          border-radius: var(--radius-lg);
          white-space: pre-wrap;
        }

        .preview-empty {
          padding: var(--spacing-2xl);
          text-align: center;
          color: var(--color-text-light);
        }

        .preview-info {
          margin-top: var(--spacing-lg);
          padding-top: var(--spacing-lg);
          border-top: 1px solid var(--color-border);
        }

        .preview-description {
          color: var(--color-text-light);
          margin-bottom: var(--spacing-md);
        }

        .preview-meta {
          display: flex;
          flex-wrap: wrap;
          gap: var(--spacing-lg);
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        /* ==================== RESSOURCES - AFFICHAGE CARTE ==================== */
        
        .resource-item__title {
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
        }

        /* ==================== ACTION WARNING ==================== */
        
        .table-action-btn--warning {
          color: var(--color-warning);
        }

        /* ==================== RESPONSIVE ==================== */
        
        @media (max-width: 768px) {
          .form-row {
            grid-template-columns: 1fr;
          }

          .admin-table-actions {
            flex-direction: column;
            align-items: stretch;
          }

          .search-input__field {
            width: 100%;
          }

          .file-upload__preview {
            flex-direction: column;
            text-align: center;
          }

          .preview-meta {
            flex-direction: column;
            gap: var(--spacing-sm);
          }
        }
      `})]})},xA=_e(X,"quizzes"),bA=async e=>{try{let t=ke(xA,Ke("titre","asc"));e?.disciplineId;let a=(await ze(t)).docs.map(l=>({id:l.id,...l.data()}));return e?.isPremium,e?.difficulte,a}catch(t){throw console.error("Erreur lors de la rcupration des quiz :",t),t}},p5=async e=>{try{const t=await Ot(Ne(X,"quizzes",e));return t.exists()?{id:t.id,...t.data()}:null}catch(t){throw console.error("Erreur lors de la rcupration du quiz :",t),t}},h5=async e=>{try{return(await Tt(xA,{...e,createdAt:Oe.now(),updatedAt:Oe.now()})).id}catch(t){throw console.error("Erreur lors de la cration du quiz :",t),t}},v5=async(e,t)=>{try{await Qe(Ne(X,"quizzes",e),{...t,updatedAt:Oe.now()})}catch(n){throw console.error("Erreur lors de la mise  jour du quiz :",n),n}},g5=async e=>{try{await en(Ne(X,"quizzes",e))}catch(t){throw console.error("Erreur lors de la suppression du quiz :",t),t}},x5=()=>`q_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,P1=()=>({id:x5(),question:"",options:["","","",""],reponseCorrecte:0,explication:"",difficulte:"moyen",points:1}),T1=e=>{const t=e.questions||[],n=t.reduce((l,o)=>l+(o.points||1),0),a={facile:t.filter(l=>l.difficulte==="facile").length,moyen:t.filter(l=>l.difficulte==="moyen").length,difficile:t.filter(l=>l.difficulte==="difficile").length};return{nombreQuestions:t.length,totalPoints:n,parDifficulte:a,duree:e.duree||0}},b5=()=>{const[e,t]=g.useState([]),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState(null),[h,v]=g.useState(""),[b,x]=g.useState(""),[j,N]=g.useState(""),[S,C]=g.useState(""),[E,w]=g.useState(!1),[z,k]=g.useState("list"),[O,P]=g.useState(null),[D,L]=g.useState({disciplineId:"",titre:"",questions:[],duree:15,isPremium:!1,noteMinimale:50}),[U,$]=g.useState(null),[B,re]=g.useState(!1),[se,M]=g.useState(null),[q,F]=g.useState(null),[R,K]=g.useState({}),[I,te]=g.useState(!1),Y=g.useCallback(async()=>{o(!0),d(null);try{const[pe,Ce]=await Promise.all([bA(),Ki.getAll()]);t(pe),a(Ce.map(Re=>({id:Re.id,nom:Re.nom||Re.name||Re.id})))}catch(pe){d("Erreur lors du chargement des donnes."),console.error(pe)}finally{o(!1)}},[]);g.useEffect(()=>{Y()},[Y]),g.useEffect(()=>{if(f){const pe=setTimeout(()=>p(null),4e3);return()=>clearTimeout(pe)}},[f]);const oe=e.filter(pe=>{if(h){const Ce=h.toLowerCase();if(!pe.titre.toLowerCase().includes(Ce))return!1}return!(b&&pe.disciplineId!==b||j==="true"&&!pe.isPremium||j==="false"&&pe.isPremium||S&&!pe.questions?.some(Re=>Re.difficulte===S))}),he=()=>{P(null),L({disciplineId:"",titre:"",questions:[P1()],duree:15,isPremium:!1,noteMinimale:50}),$(null),k("form")},ge=pe=>{P(pe),L({disciplineId:pe.disciplineId,titre:pe.titre,questions:pe.questions||[],duree:pe.duree||15,isPremium:pe.isPremium||!1,noteMinimale:pe.noteMinimale||50}),$(null),k("form")},Q=async()=>{if(!D.titre.trim()){d("Le titre du quiz est obligatoire.");return}if(!D.disciplineId){d("Veuillez slectionner une discipline.");return}if(D.questions.length===0){d("Le quiz doit contenir au moins une question.");return}for(let pe=0;pe<D.questions.length;pe++){const Ce=D.questions[pe];if(!Ce.question.trim()){d(`La question ${pe+1} n'a pas d'nonc.`);return}if(Ce.options.filter(He=>!He.trim()).length>0){d(`La question ${pe+1} a des options vides.`);return}}re(!0),d(null);try{O?(await v5(O.id,D),p("Quiz mis  jour avec succs !")):(await h5(D),p("Quiz cr avec succs !")),await Y(),k("list")}catch(pe){d("Erreur lors de la sauvegarde du quiz."),console.error(pe)}finally{re(!1)}},ve=async pe=>{try{await g5(pe),p("Quiz supprim avec succs."),M(null),await Y()}catch(Ce){d("Erreur lors de la suppression du quiz."),console.error(Ce)}},Me=()=>{const pe=P1();L(Ce=>({...Ce,questions:[...Ce.questions,pe]})),$(pe.id)},ce=pe=>{const Ce=D.questions.find(Vt=>Vt.id===pe);if(!Ce)return;const Re={...Ce,id:`q_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,question:`${Ce.question} (copie)`},He=D.questions.findIndex(Vt=>Vt.id===pe),lt=[...D.questions];lt.splice(He+1,0,Re),L(Vt=>({...Vt,questions:lt})),$(Re.id)},Z=pe=>{L(Ce=>({...Ce,questions:Ce.questions.filter(Re=>Re.id!==pe)})),U===pe&&$(null)},H=(pe,Ce,Re)=>{L(He=>({...He,questions:He.questions.map(lt=>lt.id===pe?{...lt,[Ce]:Re}:lt)}))},de=(pe,Ce,Re)=>{L(He=>({...He,questions:He.questions.map(lt=>lt.id===pe?{...lt,options:lt.options.map((Vt,Br)=>Br===Ce?Re:Vt)}:lt)}))},we=pe=>{F(pe),K({}),te(!1),k("preview")},qe=(pe,Ce)=>{I||K(Re=>({...Re,[pe]:Ce}))},We=()=>{te(!0)},Xe=pe=>n.find(Ce=>Ce.id===pe)?.nom||pe,nt=({level:pe})=>{const Ce={facile:"quiz-badge-facile",moyen:"quiz-badge-moyen",difficile:"quiz-badge-difficile"};return r.jsx("span",{className:`quiz-badge ${Ce[pe]||"quiz-badge-moyen"}`,children:pe.charAt(0).toUpperCase()+pe.slice(1)})},gr=()=>r.jsxs(r.Fragment,{children:[u&&r.jsxs("div",{className:"admin-message admin-message-error",children:[r.jsx(um,{size:18}),r.jsx("span",{children:u}),r.jsx("button",{onClick:()=>d(null),className:"admin-message-close",children:r.jsx($i,{size:16})})]}),f&&r.jsxs("div",{className:"admin-message admin-message-success",children:[r.jsx(Bt,{size:18}),r.jsx("span",{children:f})]})]}),Dr=()=>r.jsxs("div",{className:"quiz-manager",children:[r.jsxs("div",{className:"admin-header",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"admin-title",children:[r.jsx(vn,{size:24})," Gestion des Quiz"]}),r.jsxs("p",{className:"admin-subtitle",children:[e.length," quiz au total  ",oe.length," affich(s)"]})]}),r.jsxs("button",{className:"admin-btn admin-btn-primary",onClick:he,children:[r.jsx(Ec,{size:18})," Nouveau Quiz"]})]}),r.jsxs("div",{className:"admin-toolbar",children:[r.jsxs("div",{className:"admin-search-wrapper",children:[r.jsx(oA,{size:18,className:"admin-search-icon"}),r.jsx("input",{type:"text",className:"admin-search-input",placeholder:"Rechercher un quiz...",value:h,onChange:pe=>v(pe.target.value)})]}),r.jsxs("button",{className:`admin-btn admin-btn-outline ${E?"active":""}`,onClick:()=>w(!E),children:[r.jsx(Mb,{size:16})," Filtres",E?r.jsx(yx,{size:14}):r.jsx(cm,{size:14})]})]}),E&&r.jsxs("div",{className:"admin-filters-panel",children:[r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Discipline"}),r.jsxs("select",{className:"admin-select",value:b,onChange:pe=>x(pe.target.value),children:[r.jsx("option",{value:"",children:"Toutes les disciplines"}),n.map(pe=>r.jsx("option",{value:pe.id,children:pe.nom},pe.id))]})]}),r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Accs"}),r.jsxs("select",{className:"admin-select",value:j,onChange:pe=>N(pe.target.value),children:[r.jsx("option",{value:"",children:"Tous"}),r.jsx("option",{value:"false",children:"Gratuit"}),r.jsx("option",{value:"true",children:"Premium"})]})]}),r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Difficult"}),r.jsxs("select",{className:"admin-select",value:S,onChange:pe=>C(pe.target.value),children:[r.jsx("option",{value:"",children:"Toutes"}),r.jsx("option",{value:"facile",children:"Facile"}),r.jsx("option",{value:"moyen",children:"Moyen"}),r.jsx("option",{value:"difficile",children:"Difficile"})]})]}),r.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{x(""),N(""),C(""),v("")},children:"Rinitialiser"})]}),l?r.jsxs("div",{className:"admin-loading",children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement des quiz..."})]}):oe.length===0?r.jsxs("div",{className:"admin-empty-state",children:[r.jsx(tm,{size:48}),r.jsx("h3",{children:"Aucun quiz trouv"}),r.jsx("p",{children:e.length===0?"Crez votre premier quiz pour vos lves.":"Aucun quiz ne correspond  vos filtres."}),e.length===0&&r.jsxs("button",{className:"admin-btn admin-btn-primary",onClick:he,children:[r.jsx(Ec,{size:18})," Crer un quiz"]})]}):r.jsx("div",{className:"quiz-grid",children:oe.map(pe=>{const Ce=T1(pe);return r.jsxs("div",{className:"quiz-card",children:[r.jsxs("div",{className:"quiz-card-header",children:[r.jsxs("div",{className:"quiz-card-title-row",children:[r.jsx("h3",{className:"quiz-card-title",children:pe.titre}),pe.isPremium&&r.jsxs("span",{className:"quiz-badge quiz-badge-premium",children:[r.jsx(Wr,{size:12})," Premium"]})]}),r.jsx("span",{className:"quiz-card-discipline",children:Xe(pe.disciplineId)})]}),r.jsxs("div",{className:"quiz-card-stats",children:[r.jsxs("div",{className:"quiz-stat",children:[r.jsx(tm,{size:14}),r.jsxs("span",{children:[Ce.nombreQuestions," question(s)"]})]}),r.jsxs("div",{className:"quiz-stat",children:[r.jsx(Qi,{size:14}),r.jsxs("span",{children:[Ce.totalPoints," pts"]})]}),r.jsxs("div",{className:"quiz-stat",children:[r.jsx(no,{size:14}),r.jsxs("span",{children:[Ce.duree," min"]})]})]}),r.jsxs("div",{className:"quiz-card-difficulty",children:[Ce.parDifficulte.facile>0&&r.jsx(nt,{level:"facile"}),Ce.parDifficulte.moyen>0&&r.jsx(nt,{level:"moyen"}),Ce.parDifficulte.difficile>0&&r.jsx(nt,{level:"difficile"})]}),r.jsxs("div",{className:"quiz-card-actions",children:[r.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>we(pe),title:"Prvisualiser",children:[r.jsx(eo,{size:14})," Aperu"]}),r.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>ge(pe),title:"Modifier",children:[r.jsx(a3,{size:14})," Modifier"]}),se===pe.id?r.jsxs("div",{className:"quiz-delete-confirm",children:[r.jsx("button",{className:"admin-btn admin-btn-sm admin-btn-danger",onClick:()=>ve(pe.id),children:"Confirmer"}),r.jsx("button",{className:"admin-btn admin-btn-sm admin-btn-ghost",onClick:()=>M(null),children:"Annuler"})]}):r.jsx("button",{className:"admin-btn admin-btn-sm admin-btn-danger-outline",onClick:()=>M(pe.id),title:"Supprimer",children:r.jsx(g1,{size:14})})]})]},pe.id)})})]}),ir=()=>r.jsxs("div",{className:"quiz-manager",children:[r.jsxs("div",{className:"admin-header",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"admin-title",children:[r.jsx(vn,{size:24}),O?"Modifier le quiz":"Nouveau quiz"]}),r.jsxs("p",{className:"admin-subtitle",children:[D.questions.length," question(s) ajoute(s)"]})]}),r.jsxs("div",{className:"admin-header-actions",children:[r.jsxs("button",{className:"admin-btn admin-btn-ghost",onClick:()=>k("list"),children:[r.jsx($i,{size:18})," Annuler"]}),r.jsxs("button",{className:"admin-btn admin-btn-primary",onClick:Q,disabled:B,children:[r.jsx(i3,{size:18})," ",B?"Enregistrement...":"Enregistrer"]})]})]}),r.jsxs("div",{className:"admin-card quiz-form-section",children:[r.jsx("h3",{className:"quiz-form-section-title",children:"Informations gnrales"}),r.jsxs("div",{className:"quiz-form-grid",children:[r.jsxs("div",{className:"admin-form-group quiz-form-full",children:[r.jsx("label",{className:"admin-label",children:"Titre du quiz *"}),r.jsx("input",{type:"text",className:"admin-input",placeholder:"Ex : Quiz - Les Misrables, Chapitre 1",value:D.titre,onChange:pe=>L(Ce=>({...Ce,titre:pe.target.value}))})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Discipline *"}),r.jsxs("select",{className:"admin-select",value:D.disciplineId,onChange:pe=>L(Ce=>({...Ce,disciplineId:pe.target.value})),children:[r.jsx("option",{value:"",children:"-- Slectionner --"}),n.map(pe=>r.jsx("option",{value:pe.id,children:pe.nom},pe.id))]})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Dure (minutes)"}),r.jsx("input",{type:"number",className:"admin-input",min:1,max:180,value:D.duree,onChange:pe=>L(Ce=>({...Ce,duree:parseInt(pe.target.value)||15}))})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Note minimale (%)"}),r.jsx("input",{type:"number",className:"admin-input",min:0,max:100,value:D.noteMinimale,onChange:pe=>L(Ce=>({...Ce,noteMinimale:parseInt(pe.target.value)||50}))})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Accs"}),r.jsxs("div",{className:`quiz-toggle ${D.isPremium?"quiz-toggle-active":""}`,onClick:()=>L(pe=>({...pe,isPremium:!pe.isPremium})),children:[r.jsx(Wr,{size:16}),r.jsx("span",{children:D.isPremium?"Premium (2 000 FCFA/mois)":"Gratuit"})]})]})]})]}),r.jsxs("div",{className:"admin-card quiz-form-section",children:[r.jsxs("div",{className:"quiz-questions-header",children:[r.jsxs("h3",{className:"quiz-form-section-title",children:["Questions (",D.questions.length,")"]}),r.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-primary",onClick:Me,children:[r.jsx(Ec,{size:14})," Ajouter une question"]})]}),D.questions.length===0?r.jsxs("div",{className:"admin-empty-state",style:{padding:"2rem"},children:[r.jsx(tm,{size:36}),r.jsx("p",{children:'Aucune question. Cliquez sur "Ajouter une question" pour commencer.'})]}):r.jsx("div",{className:"quiz-questions-list",children:D.questions.map((pe,Ce)=>r.jsxs("div",{className:`quiz-question-item ${U===pe.id?"expanded":""}`,children:[r.jsxs("div",{className:"quiz-question-header",onClick:()=>$(U===pe.id?null:pe.id),children:[r.jsxs("div",{className:"quiz-question-header-left",children:[r.jsx(s3,{size:16,className:"quiz-grip-icon"}),r.jsxs("span",{className:"quiz-question-number",children:["Q",Ce+1]}),r.jsx("span",{className:"quiz-question-preview",children:pe.question||"Question sans nonc..."})]}),r.jsxs("div",{className:"quiz-question-header-right",children:[r.jsx(nt,{level:pe.difficulte||"moyen"}),r.jsxs("span",{className:"quiz-question-points",children:[pe.points," pt(s)"]}),U===pe.id?r.jsx(yx,{size:16}):r.jsx(cm,{size:16})]})]}),U===pe.id&&r.jsxs("div",{className:"quiz-question-body",children:[r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"nonc de la question *"}),r.jsx("textarea",{className:"admin-textarea",rows:2,placeholder:"Ex : Quel est le personnage principal du roman ?",value:pe.question,onChange:Re=>H(pe.id,"question",Re.target.value)})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Options de rponse (cliquez sur la bonne rponse)"}),r.jsx("div",{className:"quiz-options-grid",children:pe.options.map((Re,He)=>r.jsxs("div",{className:`quiz-option-item ${pe.reponseCorrecte===He?"quiz-option-correct":""}`,children:[r.jsx("button",{type:"button",className:`quiz-option-radio ${pe.reponseCorrecte===He?"active":""}`,onClick:()=>H(pe.id,"reponseCorrecte",He),title:pe.reponseCorrecte===He?"Bonne rponse":"Marquer comme bonne rponse",children:pe.reponseCorrecte===He?r.jsx(Bt,{size:16}):r.jsx("span",{className:"quiz-option-letter",children:String.fromCharCode(65+He)})}),r.jsx("input",{type:"text",className:"admin-input",placeholder:`Option ${String.fromCharCode(65+He)}`,value:Re,onChange:lt=>de(pe.id,He,lt.target.value)})]},He))})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Explication (affiche aprs rponse)"}),r.jsx("textarea",{className:"admin-textarea",rows:2,placeholder:"Ex : Jean Valjean est le protagoniste du roman de Victor Hugo...",value:pe.explication,onChange:Re=>H(pe.id,"explication",Re.target.value)})]}),r.jsxs("div",{className:"quiz-question-meta",children:[r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Difficult"}),r.jsxs("select",{className:"admin-select",value:pe.difficulte,onChange:Re=>H(pe.id,"difficulte",Re.target.value),children:[r.jsx("option",{value:"facile",children:"Facile"}),r.jsx("option",{value:"moyen",children:"Moyen"}),r.jsx("option",{value:"difficile",children:"Difficile"})]})]}),r.jsxs("div",{className:"admin-form-group",children:[r.jsx("label",{className:"admin-label",children:"Points"}),r.jsx("input",{type:"number",className:"admin-input",min:1,max:10,value:pe.points,onChange:Re=>H(pe.id,"points",parseInt(Re.target.value)||1)})]})]}),r.jsxs("div",{className:"quiz-question-actions",children:[r.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>ce(pe.id),children:[r.jsx(l3,{size:14})," Dupliquer"]}),r.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-danger-outline",onClick:()=>Z(pe.id),children:[r.jsx(g1,{size:14})," Supprimer"]})]})]})]},pe.id))}),D.questions.length>0&&r.jsx("div",{className:"quiz-add-question-bottom",children:r.jsxs("button",{className:"admin-btn admin-btn-outline",onClick:Me,children:[r.jsx(Ec,{size:16})," Ajouter une question"]})})]})]}),rn=()=>{if(!q)return null;const pe=T1(q);let Ce=0,Re=0;return I&&q.questions.forEach(He=>{Re+=He.points||1,R[He.id]===He.reponseCorrecte&&(Ce+=He.points||1)}),r.jsxs("div",{className:"quiz-manager",children:[r.jsxs("div",{className:"admin-header",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"admin-title",children:[r.jsx(eo,{size:24})," Prvisualisation : ",q.titre]}),r.jsxs("p",{className:"admin-subtitle",children:[Xe(q.disciplineId),"  ",pe.nombreQuestions," questions  ",pe.duree," min"]})]}),r.jsxs("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{k("list"),F(null)},children:[r.jsx($i,{size:18})," Fermer"]})]}),I&&r.jsxs("div",{className:`quiz-preview-score ${Ce/Re>=(q.noteMinimale||50)/100?"success":"fail"}`,children:[r.jsx(Qi,{size:32}),r.jsxs("div",{children:[r.jsxs("h3",{children:["Score : ",Ce,"/",Re," (",Math.round(Ce/Re*100),"%)"]}),r.jsxs("p",{children:["Note minimale : ",q.noteMinimale||50,"% "," ",Ce/Re>=(q.noteMinimale||50)/100?" Russi !":" Non russi"]})]})]}),r.jsx("div",{className:"quiz-preview-questions",children:q.questions.map((He,lt)=>{const Vt=R[He.id],Br=Vt===He.reponseCorrecte;return r.jsxs("div",{className:"admin-card quiz-preview-question",children:[r.jsxs("div",{className:"quiz-preview-question-header",children:[r.jsxs("span",{className:"quiz-question-number",children:["Q",lt+1]}),r.jsx(nt,{level:He.difficulte||"moyen"}),r.jsxs("span",{className:"quiz-question-points",children:[He.points," pt(s)"]})]}),r.jsx("p",{className:"quiz-preview-question-text",children:He.question}),r.jsx("div",{className:"quiz-preview-options",children:He.options.map((Ur,J)=>{let W="quiz-preview-option";return I?J===He.reponseCorrecte?W+=" correct":J===Vt&&!Br&&(W+=" incorrect"):Vt===J&&(W+=" selected"),r.jsxs("button",{className:W,onClick:()=>qe(He.id,J),disabled:I,children:[r.jsx("span",{className:"quiz-preview-option-letter",children:String.fromCharCode(65+J)}),r.jsx("span",{children:Ur}),I&&J===He.reponseCorrecte&&r.jsx(Bt,{size:16,className:"quiz-preview-check"})]},J)})}),I&&He.explication&&r.jsxs("div",{className:"quiz-preview-explication",children:[r.jsx("strong",{children:"Explication :"})," ",He.explication]})]},He.id)})}),!I&&r.jsx("div",{className:"quiz-preview-submit",children:r.jsxs("button",{className:"admin-btn admin-btn-primary admin-btn-lg",onClick:We,disabled:Object.keys(R).length<q.questions.length,children:[r.jsx(Bt,{size:18})," Soumettre (",Object.keys(R).length,"/",q.questions.length,")"]})})]})};return r.jsxs("div",{className:"admin-container",children:[gr(),z==="list"&&Dr(),z==="form"&&ir(),z==="preview"&&rn()]})},yA=_e(X,"users"),y5=_e(X,"quizResults"),j5=async e=>{try{let t=ke(yA,Ke("displayName","asc"));e?.role;let a=(await ze(t)).docs.map(l=>({uid:l.id,...l.data()}));return e?.isPremium,e?.isActive,e?.search,a}catch(t){throw console.error("Erreur lors de la rcupration des utilisateurs :",t),t}},N5=async(e,t)=>{try{await Qe(Ne(X,"users",e),{role:t,updatedAt:Oe.now()})}catch(n){throw console.error("Erreur lors de la mise  jour du rle :",n),n}},_5=async(e,t)=>{try{const n={isPremium:t,updatedAt:Oe.now()};if(t){const a=new Date;a.setDate(a.getDate()+30),n.subscriptionEnd=Oe.fromDate(a)}else n.subscriptionEnd=null;await Qe(Ne(X,"users",e),n)}catch(n){throw console.error("Erreur lors de la mise  jour du statut Premium :",n),n}},S5=async(e,t)=>{try{await Qe(Ne(X,"users",e),{isActive:t,updatedAt:Oe.now()})}catch(n){throw console.error("Erreur lors du changement de statut du compte :",n),n}},w5=async e=>{try{const t=ke(y5,Se("userId","==",e)),a=(await ze(t)).docs.map(f=>({id:f.id,...f.data()})),l=a.length,o=a.filter(f=>f.reussi).length,u=l>0?Math.round(a.reduce((f,p)=>f+p.score,0)/l):0,d=a.length>0?new Date(Math.max(...a.map(f=>{const p=f.datePassage;return p?.toDate?p.toDate().getTime():new Date(p).getTime()}))):null;return{totalQuizPasses:l,scoresMoyens:u,quizReussis:o,dernierQuiz:d}}catch(t){return console.error("Erreur lors du calcul des statistiques :",t),{totalQuizPasses:0,scoresMoyens:0,quizReussis:0,dernierQuiz:null}}},C5=async()=>{try{const t=(await ze(yA)).docs.map(n=>n.data());return{total:t.length,admins:t.filter(n=>n.role==="admin").length,profs:t.filter(n=>n.role==="prof").length,eleves:t.filter(n=>n.role==="eleve").length,premium:t.filter(n=>n.isPremium).length,actifs:t.filter(n=>n.isActive!==!1).length}}catch(e){throw console.error("Erreur lors du calcul des stats globales :",e),e}},E5=()=>{const[e,t]=g.useState([]),[n,a]=g.useState(null),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState(null),[h,v]=g.useState(""),[b,x]=g.useState(""),[j,N]=g.useState(""),[S,C]=g.useState(""),[E,w]=g.useState(!1),[z]=nA();g.useEffect(()=>{z.get("filter")==="premium"&&N("true")},[z]);const[k,O]=g.useState(null),[P,D]=g.useState(null),[L,U]=g.useState(!1),[$,B]=g.useState(null),[re,se]=g.useState(null),M=g.useCallback(async()=>{o(!0),d(null);try{const[Q,ve]=await Promise.all([j5(),C5()]);t(Q),a(ve)}catch(Q){d("Erreur lors du chargement des utilisateurs."),console.error(Q)}finally{o(!1)}},[]);g.useEffect(()=>{M()},[M]),g.useEffect(()=>{if(f){const Q=setTimeout(()=>p(null),4e3);return()=>clearTimeout(Q)}},[f]);const q=e.filter(Q=>{if(h){const ve=h.toLowerCase();if(!Q.displayName?.toLowerCase().includes(ve)&&!Q.email?.toLowerCase().includes(ve))return!1}return!(b&&Q.role!==b||j==="true"&&!Q.isPremium||j==="false"&&Q.isPremium||S==="true"&&Q.isActive===!1||S==="false"&&Q.isActive!==!1)}),F=async Q=>{O(Q),U(!0);try{const ve=await w5(Q.uid);D(ve)}catch(ve){console.error("Erreur lors du chargement des statistiques :",ve),D(null)}finally{U(!1)}},R=async()=>{if(re){B(re.userId);try{switch(re.type){case"role":await N5(re.userId,re.value),p("Rle mis  jour avec succs.");break;case"premium":await _5(re.userId,re.value),p(re.value?"Statut Premium activ (30 jours).":"Statut Premium dsactiv.");break;case"active":await S5(re.userId,re.value),p(re.value?"Compte ractiv.":"Compte dsactiv.");break}await M()}catch(Q){d("Erreur lors de l'excution de l'action."),console.error(Q)}finally{B(null),se(null)}}},K=({role:Q})=>{const ve={admin:{icon:r.jsx(Db,{size:12}),className:"user-badge-admin",label:"Admin"},prof:{icon:r.jsx(Os,{size:12}),className:"user-badge-prof",label:"Professeur"},eleve:{icon:r.jsx(vn,{size:12}),className:"user-badge-eleve",label:"lve"}},Me=ve[Q]||ve.eleve;return r.jsxs("span",{className:`user-badge ${Me.className}`,children:[Me.icon," ",Me.label]})},I=Q=>Q?(Q?.toDate?Q.toDate():new Date(Q)).toLocaleDateString("fr-SN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",te=Q=>Q?Q.charAt(0).toUpperCase():"?",Y=()=>r.jsxs(r.Fragment,{children:[u&&r.jsxs("div",{className:"admin-message admin-message-error",children:[r.jsx(um,{size:18}),r.jsx("span",{children:u}),r.jsx("button",{onClick:()=>d(null),className:"admin-message-close",children:r.jsx($i,{size:16})})]}),f&&r.jsxs("div",{className:"admin-message admin-message-success",children:[r.jsx(Bt,{size:18}),r.jsx("span",{children:f})]})]}),oe=()=>{if(!n)return null;const Q=[{label:"Total",value:n.total,icon:r.jsx(em,{size:20}),color:"stat-blue"},{label:"lves",value:n.eleves,icon:r.jsx(vn,{size:20}),color:"stat-green"},{label:"Professeurs",value:n.profs,icon:r.jsx(Os,{size:20}),color:"stat-purple"},{label:"Premium",value:n.premium,icon:r.jsx(Wr,{size:20}),color:"stat-gold"}];return r.jsx("div",{className:"user-stats-grid",children:Q.map(ve=>r.jsxs("div",{className:`user-stat-card ${ve.color}`,children:[r.jsx("div",{className:"user-stat-icon",children:ve.icon}),r.jsxs("div",{className:"user-stat-info",children:[r.jsx("span",{className:"user-stat-value",children:ve.value}),r.jsx("span",{className:"user-stat-label",children:ve.label})]})]},ve.label))})},he=()=>re?r.jsx("div",{className:"admin-modal-overlay",onClick:()=>se(null),children:r.jsxs("div",{className:"admin-modal",onClick:Q=>Q.stopPropagation(),children:[r.jsxs("div",{className:"admin-modal-header",children:[r.jsx("h3",{children:"Confirmer l'action"}),r.jsx("button",{className:"admin-modal-close",onClick:()=>se(null),children:r.jsx($i,{size:20})})]}),r.jsx("div",{className:"admin-modal-body",children:r.jsx("p",{children:re.label})}),r.jsxs("div",{className:"admin-modal-footer",children:[r.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>se(null),children:"Annuler"}),r.jsx("button",{className:"admin-btn admin-btn-primary",onClick:R,disabled:$===re.userId,children:$===re.userId?"En cours...":"Confirmer"})]})]})}):null,ge=()=>k?r.jsx("div",{className:"admin-modal-overlay",onClick:()=>O(null),children:r.jsxs("div",{className:"admin-modal admin-modal-lg",onClick:Q=>Q.stopPropagation(),children:[r.jsxs("div",{className:"admin-modal-header",children:[r.jsx("h3",{children:"Dtail de l'utilisateur"}),r.jsx("button",{className:"admin-modal-close",onClick:()=>O(null),children:r.jsx($i,{size:20})})]}),r.jsxs("div",{className:"admin-modal-body",children:[r.jsxs("div",{className:"user-detail-profile",children:[r.jsx("div",{className:"user-detail-avatar",children:te(k.displayName)}),r.jsxs("div",{className:"user-detail-info",children:[r.jsx("h4",{children:k.displayName||"Sans nom"}),r.jsx("p",{children:k.email}),r.jsxs("div",{className:"user-detail-badges",children:[r.jsx(K,{role:k.role}),k.isPremium&&r.jsxs("span",{className:"user-badge user-badge-premium",children:[r.jsx(Wr,{size:12})," Premium"]}),r.jsx("span",{className:`user-badge ${k.isActive!==!1?"user-badge-active":"user-badge-inactive"}`,children:k.isActive!==!1?"Actif":"Dsactiv"})]})]})]}),r.jsxs("div",{className:"user-detail-dates",children:[r.jsxs("div",{children:[r.jsx("span",{className:"user-detail-date-label",children:"Inscription"}),r.jsx("span",{children:I(k.createdAt)})]}),k.isPremium&&k.subscriptionEnd&&r.jsxs("div",{children:[r.jsx("span",{className:"user-detail-date-label",children:"Premium jusqu'au"}),r.jsx("span",{children:I(k.subscriptionEnd)})]})]}),r.jsxs("div",{className:"user-detail-stats-section",children:[r.jsxs("h4",{children:[r.jsx(ks,{size:18})," Statistiques"]}),L?r.jsxs("div",{className:"admin-loading",style:{padding:"1rem"},children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement des statistiques..."})]}):P?r.jsxs("div",{className:"user-detail-stats-grid",children:[r.jsxs("div",{className:"user-detail-stat",children:[r.jsx(vn,{size:20}),r.jsx("span",{className:"user-detail-stat-value",children:P.totalQuizPasses}),r.jsx("span",{className:"user-detail-stat-label",children:"Quiz passs"})]}),r.jsxs("div",{className:"user-detail-stat",children:[r.jsx(Ac,{size:20}),r.jsxs("span",{className:"user-detail-stat-value",children:[P.scoresMoyens,"%"]}),r.jsx("span",{className:"user-detail-stat-label",children:"Score moyen"})]}),r.jsxs("div",{className:"user-detail-stat",children:[r.jsx(Qi,{size:20}),r.jsx("span",{className:"user-detail-stat-value",children:P.quizReussis}),r.jsx("span",{className:"user-detail-stat-label",children:"Quiz russis"})]}),r.jsxs("div",{className:"user-detail-stat",children:[r.jsx(no,{size:20}),r.jsx("span",{className:"user-detail-stat-value",children:P.dernierQuiz?I(P.dernierQuiz):"Aucun"}),r.jsx("span",{className:"user-detail-stat-label",children:"Dernier quiz"})]})]}):r.jsx("p",{className:"user-detail-no-stats",children:"Aucune statistique disponible."})]})]})]})}):null;return r.jsxs("div",{className:"admin-container",children:[Y(),he(),ge(),r.jsxs("div",{className:"user-manager",children:[r.jsxs("div",{className:"admin-header",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"admin-title",children:[r.jsx(em,{size:24})," Gestion des Utilisateurs"]}),r.jsxs("p",{className:"admin-subtitle",children:[e.length," utilisateur(s) au total  ",q.length," affich(s)"]})]}),r.jsxs("button",{className:"admin-btn admin-btn-outline",onClick:M,children:[r.jsx(o3,{size:16})," Actualiser"]})]}),oe(),r.jsxs("div",{className:"admin-toolbar",children:[r.jsxs("div",{className:"admin-search-wrapper",children:[r.jsx(oA,{size:18,className:"admin-search-icon"}),r.jsx("input",{type:"text",className:"admin-search-input",placeholder:"Rechercher par nom ou email...",value:h,onChange:Q=>v(Q.target.value)})]}),r.jsxs("button",{className:`admin-btn admin-btn-outline ${E?"active":""}`,onClick:()=>w(!E),children:[r.jsx(Mb,{size:16})," Filtres",E?r.jsx(yx,{size:14}):r.jsx(cm,{size:14})]})]}),E&&r.jsxs("div",{className:"admin-filters-panel",children:[r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Rle"}),r.jsxs("select",{className:"admin-select",value:b,onChange:Q=>x(Q.target.value),children:[r.jsx("option",{value:"",children:"Tous les rles"}),r.jsx("option",{value:"admin",children:"Admin"}),r.jsx("option",{value:"prof",children:"Professeur"}),r.jsx("option",{value:"eleve",children:"lve"})]})]}),r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Abonnement"}),r.jsxs("select",{className:"admin-select",value:j,onChange:Q=>N(Q.target.value),children:[r.jsx("option",{value:"",children:"Tous"}),r.jsx("option",{value:"true",children:"Premium"}),r.jsx("option",{value:"false",children:"Gratuit"})]})]}),r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Statut"}),r.jsxs("select",{className:"admin-select",value:S,onChange:Q=>C(Q.target.value),children:[r.jsx("option",{value:"",children:"Tous"}),r.jsx("option",{value:"true",children:"Actifs"}),r.jsx("option",{value:"false",children:"Dsactivs"})]})]}),r.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{x(""),N(""),C(""),v("")},children:"Rinitialiser"})]}),l?r.jsxs("div",{className:"admin-loading",children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement des utilisateurs..."})]}):q.length===0?r.jsxs("div",{className:"admin-empty-state",children:[r.jsx(em,{size:48}),r.jsx("h3",{children:"Aucun utilisateur trouv"}),r.jsx("p",{children:e.length===0?"Aucun utilisateur n'est encore inscrit.":"Aucun utilisateur ne correspond  vos filtres."})]}):r.jsx("div",{className:"user-table-wrapper",children:r.jsxs("table",{className:"user-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Utilisateur"}),r.jsx("th",{children:"Rle"}),r.jsx("th",{children:"Abonnement"}),r.jsx("th",{children:"Statut"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:q.map(Q=>r.jsxs("tr",{className:Q.isActive===!1?"user-row-inactive":"",children:[r.jsx("td",{children:r.jsxs("div",{className:"user-cell-info",children:[r.jsx("div",{className:"user-avatar-sm",children:te(Q.displayName)}),r.jsxs("div",{children:[r.jsx("span",{className:"user-cell-name",children:Q.displayName||"Sans nom"}),r.jsx("span",{className:"user-cell-email",children:Q.email})]})]})}),r.jsx("td",{children:r.jsxs("select",{className:"admin-select admin-select-sm",value:Q.role,onChange:ve=>se({type:"role",userId:Q.uid,value:ve.target.value,label:`Changer le rle de "${Q.displayName||Q.email}" en "${ve.target.value}" ?`}),children:[r.jsx("option",{value:"eleve",children:"lve"}),r.jsx("option",{value:"prof",children:"Professeur"}),r.jsx("option",{value:"admin",children:"Admin"})]})}),r.jsx("td",{children:r.jsx("button",{className:`user-premium-toggle ${Q.isPremium?"active":""}`,onClick:()=>se({type:"premium",userId:Q.uid,value:!Q.isPremium,label:Q.isPremium?`Dsactiver le statut Premium de "${Q.displayName||Q.email}" ?`:`Activer le statut Premium de "${Q.displayName||Q.email}" pour 30 jours ?`}),disabled:$===Q.uid,children:Q.isPremium?r.jsxs(r.Fragment,{children:[r.jsx(Cc,{size:14})," Premium"]}):r.jsxs(r.Fragment,{children:[r.jsx(Wr,{size:14})," Gratuit"]})})}),r.jsx("td",{children:r.jsx("button",{className:`user-status-toggle ${Q.isActive!==!1?"active":"inactive"}`,onClick:()=>se({type:"active",userId:Q.uid,value:Q.isActive===!1,label:Q.isActive===!1?`Ractiver le compte de "${Q.displayName||Q.email}" ?`:`Dsactiver le compte de "${Q.displayName||Q.email}" ?`}),disabled:$===Q.uid,children:Q.isActive!==!1?r.jsxs(r.Fragment,{children:[r.jsx(c3,{size:14})," Actif"]}):r.jsxs(r.Fragment,{children:[r.jsx(u3,{size:14})," Dsactiv"]})})}),r.jsx("td",{children:r.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>F(Q),title:"Voir les statistiques",children:[r.jsx(eo,{size:14})," Dtail"]})})]},Q.uid))})]})})]})]})},A5=()=>{const[e,t]=g.useState([]),[n,a]=g.useState(null),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState(""),[h,v]=g.useState(""),[b,x]=g.useState(""),[j,N]=g.useState(!1),S=g.useCallback(async()=>{try{o(!0),d(null);const k=await ze(_e(X,"users")),O=new Map;k.docs.forEach(oe=>{const he=oe.data();O.set(oe.id,{name:he.displayName||"Sans nom",email:he.email||""})});const P=await ze(_e(X,"quizzes")),D=new Map;P.docs.forEach(oe=>{const he=oe.data();D.set(oe.id,{titre:he.titre||he.quizTitre||"Quiz sans titre",discipline:he.disciplineNom||he.matiereNom||""})});const L=await ze(_e(X,"quizzes_v2")),U=new Map;L.docs.forEach(oe=>{const he=oe.data();U.set(oe.id,{titre:he.titre||"Quiz avanc sans titre",discipline:he.disciplineNom||""})});const $=[];try{(await ze(ke(_e(X,"quiz_results"),Ke("datePassage","desc"),Cr(200)))).docs.forEach(he=>{const ge=he.data(),Q=O.get(ge.userId)||{name:"Inconnu",email:""},ve=D.get(ge.quizId)||{titre:ge.quizTitre||"Quiz",discipline:ge.disciplineNom||""},Me=ge.pourcentage??(ge.totalPoints>0?Math.round(ge.score/ge.totalPoints*100):ge.score>0?Math.round(ge.score/20*100):0);$.push({id:he.id,quizId:ge.quizId||"",quizTitre:ve.titre,userId:ge.userId||"",userName:Q.name,userEmail:Q.email,score:ge.score||0,scoreMax:ge.totalPoints||20,pourcentage:Me,reussi:ge.reussi??Me>=50,tempsEcoule:ge.tempsEcoule||0,datePassage:ge.datePassage?.toDate?.()||new Date,type:"classique",disciplineNom:ve.discipline})})}catch(oe){console.warn("Pas de rsultats v1 ou index manquant:",oe)}const B=[];try{(await ze(ke(_e(X,"quiz_results_v2"),Ke("datePassage","desc"),Cr(200)))).docs.forEach(he=>{const ge=he.data(),Q=O.get(ge.userId)||{name:"Inconnu",email:""},ve=U.get(ge.quizId)||{titre:ge.quizTitre||"Quiz avanc",discipline:ge.disciplineNom||""},Me=ge.scoreMax>0?Math.round(ge.score/ge.scoreMax*100):0;B.push({id:he.id,quizId:ge.quizId||"",quizTitre:ve.titre,userId:ge.userId||"",userName:Q.name,userEmail:Q.email,score:ge.score||0,scoreMax:ge.scoreMax||0,pourcentage:Me,reussi:ge.reussi??Me>=50,tempsEcoule:ge.tempsTotal||ge.tempsEcoule||0,datePassage:ge.datePassage?.toDate?.()||new Date,type:"avance",disciplineNom:ve.discipline})})}catch(oe){console.warn("Pas de rsultats v2 ou index manquant:",oe)}const re=[...$,...B].sort((oe,he)=>he.datePassage.getTime()-oe.datePassage.getTime());t(re);const se=new Date,M=new Date(se.getFullYear(),se.getMonth(),se.getDate()),q=new Date(M.getTime()-10080*60*1e3),F=re.length,R=F>0?Math.round(re.reduce((oe,he)=>oe+he.pourcentage,0)/F):0,K=F>0?Math.round(re.filter(oe=>oe.reussi).length/F*100):0,I=F>0?Math.round(re.reduce((oe,he)=>oe+he.tempsEcoule,0)/F):0,te=re.filter(oe=>oe.datePassage>=M).length,Y=re.filter(oe=>oe.datePassage>=q).length;a({totalResultats:F,moyenneGenerale:R,tauxReussite:K,tempsEcouleMoyen:I,resultatsAujourdHui:te,resultats7Jours:Y})}catch(k){console.error("Erreur chargement rsultats:",k),d("Impossible de charger les rsultats. Vrifiez votre connexion.")}finally{o(!1)}},[]);g.useEffect(()=>{S()},[S]);const C=e.filter(k=>{if(f&&k.type!==f||h==="true"&&!k.reussi||h==="false"&&k.reussi)return!1;if(b){const O=b.toLowerCase();if(!k.userName.toLowerCase().includes(O)&&!k.userEmail.toLowerCase().includes(O)&&!k.quizTitre.toLowerCase().includes(O)&&!k.disciplineNom.toLowerCase().includes(O))return!1}return!0}),E=k=>{if(k<60)return`${k}s`;const O=Math.floor(k/60),P=k%60;return P>0?`${O}min ${P}s`:`${O}min`},w=k=>k.toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),z=k=>k>=80?"results-score--excellent":k>=60?"results-score--bien":k>=40?"results-score--moyen":"results-score--faible";return r.jsxs("div",{className:"results-admin",children:[r.jsxs("div",{className:"admin-page-header",children:[r.jsxs("div",{className:"admin-page-header__info",children:[r.jsx("h1",{className:"admin-page-header__title",children:" Rsultats des Quiz"}),r.jsx("p",{className:"admin-page-header__subtitle",children:"Vue d'ensemble des performances des lves"})]}),r.jsx("div",{className:"admin-page-header__actions",children:r.jsx("button",{className:"admin-btn admin-btn-secondary",onClick:S,children:" Actualiser"})})]}),n&&r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--primary",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.totalResultats}),r.jsx("div",{className:"stat-card__label",children:"Rsultats totaux"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--secondary",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsxs("div",{className:"stat-card__value",children:[n.moyenneGenerale,"%"]}),r.jsx("div",{className:"stat-card__label",children:"Moyenne gnrale"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--warning",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsxs("div",{className:"stat-card__value",children:[n.tauxReussite,"%"]}),r.jsx("div",{className:"stat-card__label",children:"Taux de russite"})]})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("div",{className:"stat-card__icon stat-card__icon--info",children:""}),r.jsxs("div",{className:"stat-card__content",children:[r.jsx("div",{className:"stat-card__value",children:n.resultatsAujourdHui}),r.jsx("div",{className:"stat-card__label",children:"Aujourd'hui"})]})]})]}),r.jsxs("div",{className:"admin-toolbar",children:[r.jsxs("div",{className:"admin-search",children:[r.jsx("span",{className:"admin-search-icon",children:""}),r.jsx("input",{type:"text",className:"admin-search-input",placeholder:"Rechercher par lve, quiz ou discipline...",value:b,onChange:k=>x(k.target.value)})]}),r.jsx("button",{className:`admin-btn admin-btn-ghost ${j?"active":""}`,onClick:()=>N(!j),children:" Filtres"})]}),j&&r.jsxs("div",{className:"admin-filters-panel",children:[r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Type de quiz"}),r.jsxs("select",{className:"admin-select",value:f,onChange:k=>p(k.target.value),children:[r.jsx("option",{value:"",children:"Tous les types"}),r.jsx("option",{value:"classique",children:"Classique (v1)"}),r.jsx("option",{value:"avance",children:"Avanc (v2)"})]})]}),r.jsxs("div",{className:"admin-filter-group",children:[r.jsx("label",{className:"admin-filter-label",children:"Rsultat"}),r.jsxs("select",{className:"admin-select",value:h,onChange:k=>v(k.target.value),children:[r.jsx("option",{value:"",children:"Tous"}),r.jsx("option",{value:"true",children:"Russis"}),r.jsx("option",{value:"false",children:"chous"})]})]}),r.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{p(""),v(""),x("")},children:"Rinitialiser"})]}),l?r.jsxs("div",{className:"admin-loading",children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement des rsultats..."})]}):u?r.jsxs("div",{className:"admin-error",children:[r.jsxs("p",{children:[" ",u]}),r.jsx("button",{className:"admin-btn admin-btn-primary",onClick:S,children:"Ressayer"})]}):C.length===0?r.jsxs("div",{className:"admin-empty-state",children:[r.jsx("span",{style:{fontSize:"3rem"},children:""}),r.jsx("h3",{children:"Aucun rsultat trouv"}),r.jsx("p",{children:e.length===0?"Aucun lve n'a encore pass de quiz.":"Aucun rsultat ne correspond  vos filtres."})]}):r.jsxs("div",{className:"results-table-wrapper",children:[r.jsxs("table",{className:"results-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"lve"}),r.jsx("th",{children:"Quiz"}),r.jsx("th",{children:"Type"}),r.jsx("th",{children:"Score"}),r.jsx("th",{children:"Rsultat"}),r.jsx("th",{children:"Dure"}),r.jsx("th",{children:"Date"})]})}),r.jsx("tbody",{children:C.map(k=>r.jsxs("tr",{children:[r.jsx("td",{children:r.jsxs("div",{className:"results-cell-user",children:[r.jsx("span",{className:"results-cell-name",children:k.userName}),r.jsx("span",{className:"results-cell-email",children:k.userEmail})]})}),r.jsx("td",{children:r.jsxs("div",{className:"results-cell-quiz",children:[r.jsx("span",{className:"results-cell-quiz-title",children:k.quizTitre}),k.disciplineNom&&r.jsx("span",{className:"results-cell-discipline",children:k.disciplineNom})]})}),r.jsx("td",{children:r.jsx("span",{className:`results-badge results-badge--${k.type}`,children:k.type==="classique"?" Classique":" Avanc"})}),r.jsxs("td",{children:[r.jsxs("span",{className:`results-score ${z(k.pourcentage)}`,children:[k.pourcentage,"%"]}),r.jsxs("span",{className:"results-score-detail",children:[k.score,"/",k.scoreMax]})]}),r.jsx("td",{children:r.jsx("span",{className:`results-status ${k.reussi?"results-status--success":"results-status--fail"}`,children:k.reussi?" Russi":" chou"})}),r.jsx("td",{className:"results-cell-duration",children:E(k.tempsEcoule)}),r.jsx("td",{className:"results-cell-date",children:w(k.datePassage)})]},`${k.type}-${k.id}`))})]}),r.jsx("div",{className:"results-footer",children:r.jsxs("p",{children:[C.length," rsultat",C.length>1?"s":""," affich",C.length>1?"s":"",C.length!==e.length&&` sur ${e.length} au total`]})})]})]})},Ul={siteName:"PedaClic",siteDescription:"L'cole en un clic  Plateforme ducative sngalaise",contactEmail:"contact@pedaclic.sn",contactPhone:"+221 XX XXX XX XX",premiumMensuel:2e3,premiumAnnuel:2e4,quizDureeDefaut:15,quizNoteMinimale:10,quizTentativesMax:3,maintenanceMode:!1,maintenanceMessage:"PedaClic est en maintenance. Nous revenons bientt !",cahierPdfExport:!0},z5=()=>{const[e,t]=g.useState(Ul),[n,a]=g.useState(Ul),[l,o]=g.useState(!0),[u,d]=g.useState(!1),[f,p]=g.useState(null),[h,v]=g.useState(null),[b,x]=g.useState(!1),j=g.useCallback(async()=>{try{o(!0),p(null);const w=Ne(X,"settings","platform"),z=await Ot(w);if(z.exists()){const k=z.data(),O={...Ul,...k};t(O),a(O)}else t(Ul),a(Ul)}catch(w){console.error("Erreur chargement paramtres:",w),p("Impossible de charger les paramtres.")}finally{o(!1)}},[]);g.useEffect(()=>{j()},[j]),g.useEffect(()=>{if(h){const w=setTimeout(()=>v(null),4e3);return()=>clearTimeout(w)}},[h]),g.useEffect(()=>{const w=JSON.stringify(e)!==JSON.stringify(n);x(w)},[e,n]);const N=(w,z)=>{t(k=>({...k,[w]:z}))},S=async()=>{try{if(d(!0),p(null),e.premiumMensuel<0||e.premiumAnnuel<0){p("Les tarifs ne peuvent pas tre ngatifs.");return}if(e.quizNoteMinimale<0||e.quizNoteMinimale>20){p("La note minimale doit tre entre 0 et 20.");return}const w=Ne(X,"settings","platform");await pf(w,{...e,updatedAt:Mt()}),a(e),x(!1),v("Paramtres sauvegards avec succs !")}catch(w){console.error("Erreur sauvegarde paramtres:",w),p("Impossible de sauvegarder les paramtres.")}finally{d(!1)}},C=()=>{t(n),x(!1)},E=()=>{window.confirm("Rinitialiser tous les paramtres aux valeurs par dfaut ?")&&t(Ul)};return l?r.jsxs("div",{className:"admin-loading",children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement des paramtres..."})]}):r.jsxs("div",{className:"settings-admin",children:[r.jsxs("div",{className:"admin-page-header",children:[r.jsxs("div",{className:"admin-page-header__info",children:[r.jsx("h1",{className:"admin-page-header__title",children:" Configuration"}),r.jsx("p",{className:"admin-page-header__subtitle",children:"Paramtres gnraux de la plateforme PedaClic"})]}),r.jsxs("div",{className:"admin-page-header__actions",children:[b&&r.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:C,children:"Annuler"}),r.jsx("button",{className:"admin-btn admin-btn-primary",onClick:S,disabled:!b||u,children:u?" Sauvegarde...":" Sauvegarder"})]})]}),b&&r.jsx("div",{className:"settings-unsaved-banner",children:" Vous avez des modifications non sauvegardes."}),f&&r.jsxs("div",{className:"admin-alert admin-alert--error",children:[" ",f]}),h&&r.jsxs("div",{className:"admin-alert admin-alert--success",children:[" ",h]}),r.jsxs("div",{className:"settings-section",children:[r.jsxs("div",{className:"settings-section__header",children:[r.jsx("h2",{className:"settings-section__title",children:" Informations gnrales"}),r.jsx("p",{className:"settings-section__description",children:"Informations de base de la plateforme"})]}),r.jsxs("div",{className:"settings-grid",children:[r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Nom du site"}),r.jsx("input",{type:"text",className:"admin-input",value:e.siteName,onChange:w=>N("siteName",w.target.value)})]}),r.jsxs("div",{className:"settings-field settings-field--full",children:[r.jsx("label",{className:"settings-label",children:"Description"}),r.jsx("input",{type:"text",className:"admin-input",value:e.siteDescription,onChange:w=>N("siteDescription",w.target.value)})]}),r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Email de contact"}),r.jsx("input",{type:"email",className:"admin-input",value:e.contactEmail,onChange:w=>N("contactEmail",w.target.value)})]}),r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Tlphone"}),r.jsx("input",{type:"tel",className:"admin-input",value:e.contactPhone,onChange:w=>N("contactPhone",w.target.value)})]})]})]}),r.jsxs("div",{className:"settings-section",children:[r.jsxs("div",{className:"settings-section__header",children:[r.jsx("h2",{className:"settings-section__title",children:" Tarifs Premium"}),r.jsx("p",{className:"settings-section__description",children:"Montants des abonnements en FCFA"})]}),r.jsxs("div",{className:"settings-grid",children:[r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Abonnement mensuel (FCFA)"}),r.jsx("input",{type:"number",className:"admin-input",value:e.premiumMensuel,onChange:w=>N("premiumMensuel",parseInt(w.target.value)||0),min:0,step:500}),r.jsxs("span",{className:"settings-hint",children:["Actuellement : ",e.premiumMensuel.toLocaleString("fr-FR")," FCFA/mois"]})]}),r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Abonnement annuel (FCFA)"}),r.jsx("input",{type:"number",className:"admin-input",value:e.premiumAnnuel,onChange:w=>N("premiumAnnuel",parseInt(w.target.value)||0),min:0,step:1e3}),r.jsxs("span",{className:"settings-hint",children:["conomie : ",(e.premiumMensuel*12-e.premiumAnnuel).toLocaleString("fr-FR")," FCFA/an"]})]})]})]}),r.jsxs("div",{className:"settings-section",children:[r.jsxs("div",{className:"settings-section__header",children:[r.jsx("h2",{className:"settings-section__title",children:" Paramtres des Quiz"}),r.jsx("p",{className:"settings-section__description",children:"Valeurs par dfaut pour la cration de quiz"})]}),r.jsxs("div",{className:"settings-grid",children:[r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Dure par dfaut (minutes)"}),r.jsx("input",{type:"number",className:"admin-input",value:e.quizDureeDefaut,onChange:w=>N("quizDureeDefaut",parseInt(w.target.value)||0),min:1,max:120})]}),r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Note minimale pour russir (/20)"}),r.jsx("input",{type:"number",className:"admin-input",value:e.quizNoteMinimale,onChange:w=>N("quizNoteMinimale",parseInt(w.target.value)||0),min:0,max:20})]}),r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Tentatives max par quiz"}),r.jsx("input",{type:"number",className:"admin-input",value:e.quizTentativesMax,onChange:w=>N("quizTentativesMax",parseInt(w.target.value)||0),min:1,max:10}),r.jsx("span",{className:"settings-hint",children:"0 = illimit"})]})]})]}),r.jsxs("div",{className:"settings-section",children:[r.jsxs("div",{className:"settings-section__header",children:[r.jsx("h2",{className:"settings-section__title",children:" Cahier de Textes"}),r.jsx("p",{className:"settings-section__description",children:"Options des fonctionnalits du cahier de textes pour les professeurs"})]}),r.jsx("div",{className:"settings-grid",children:r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Export PDF du cahier"}),r.jsxs("div",{className:"settings-toggle-wrapper",children:[r.jsx("button",{className:`settings-toggle ${e.cahierPdfExport?"settings-toggle--active":""}`,onClick:()=>N("cahierPdfExport",!e.cahierPdfExport),children:r.jsx("span",{className:"settings-toggle__knob"})}),r.jsx("span",{className:`settings-toggle-label ${e.cahierPdfExport?"settings-toggle-label--active":""}`,children:e.cahierPdfExport?" Export PDF activ":" Export PDF dsactiv"})]}),r.jsx("span",{className:"settings-hint",children:'Affiche le bouton " PDF" dans les cahiers de textes des professeurs'})]})})]}),r.jsxs("div",{className:"settings-section",children:[r.jsxs("div",{className:"settings-section__header",children:[r.jsx("h2",{className:"settings-section__title",children:" Mode Maintenance"}),r.jsx("p",{className:"settings-section__description",children:"Activer pour bloquer l'accs au site pendant les mises  jour"})]}),r.jsxs("div",{className:"settings-grid",children:[r.jsxs("div",{className:"settings-field",children:[r.jsx("label",{className:"settings-label",children:"Mode maintenance"}),r.jsxs("div",{className:"settings-toggle-wrapper",children:[r.jsx("button",{className:`settings-toggle ${e.maintenanceMode?"settings-toggle--active":""}`,onClick:()=>N("maintenanceMode",!e.maintenanceMode),children:r.jsx("span",{className:"settings-toggle__knob"})}),r.jsx("span",{className:`settings-toggle-label ${e.maintenanceMode?"settings-toggle-label--active":""}`,children:e.maintenanceMode?" Maintenance active":" Site en ligne"})]})]}),r.jsxs("div",{className:"settings-field settings-field--full",children:[r.jsx("label",{className:"settings-label",children:"Message affich aux visiteurs"}),r.jsx("textarea",{className:"admin-input admin-textarea",rows:3,value:e.maintenanceMessage,onChange:w=>N("maintenanceMessage",w.target.value),disabled:!e.maintenanceMode})]})]})]}),r.jsxs("div",{className:"settings-actions",children:[r.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:E,children:" Rinitialiser aux valeurs par dfaut"}),r.jsx("button",{className:"admin-btn admin-btn-primary",onClick:S,disabled:!b||u,children:u?" Sauvegarde...":" Sauvegarder les modifications"})]})]})},O5=["#000000","#1f2937","#374151","#6b7280","#dc2626","#ef4444","#f97316","#d97706","#eab308","#65a30d","#059669","#14b8a6","#2563eb","#3b82f6","#0891b2","#7c3aed","#db2777","#ec4899","#be185d","#9333ea","#ffffff","#f3f4f6","#fef3c7","#dbeafe"],k5=["#fef08a","#fde68a","#fef3c7","#bbf7d0","#d1fae5","#a7f3d0","#bfdbfe","#dbeafe","#c7d2fe","#fecaca","#fee2e2","#fde8e8","#e9d5ff","#f3e8ff","#d8b4fe","#fed7aa","#ffedd5","#fce7f3","transparent","#ffffff"],D5=["#f0fdf4","#ecfdf5","#f0f9ff","#eff6ff","#faf5ff","#fdf2f8","#fff7ed","#fffbeb","#fef2f2","#f9fafb","#f3f4f6","transparent"],M5=[{tag:"p",label:" Paragraphe"},{tag:"h1",label:"H1  Titre 1"},{tag:"h2",label:"H2  Titre 2"},{tag:"h3",label:"H3  Titre 3"},{tag:"h4",label:"H4  Titre 4"},{tag:"pre",label:"</> Code"},{tag:"blockquote",label:" Citation"}],P5=[{value:"1",label:"Trs petit"},{value:"2",label:"Petit"},{value:"3",label:"Normal"},{value:"4",label:"Grand"},{value:"5",label:"Trs grand"},{value:"6",label:"norme"}],T5=["headinglevel","fontsize","separator","bold","italic","underline","strikethrough","separator","color","highlight","blockBg","separator","alignLeft","alignCenter","alignRight","alignJustify","separator","bulletList","numberedList","indent","outdent","separator","subscript","superscript","link","clean"],fa=({value:e,onChange:t,placeholder:n="Saisissez votre texte...",minHeight:a=120,maxHeight:l=500,toolbar:o=T5,disabled:u=!1,className:d=""})=>{const f=g.useRef(null),p=g.useRef(!1),[h,v]=g.useState(!1),[b,x]=g.useState(!1),[j,N]=g.useState(!1);g.useEffect(()=>{f.current&&!p.current&&f.current.innerHTML!==e&&(f.current.innerHTML=e||""),p.current=!1},[e]);const S=g.useCallback(()=>{f.current&&(p.current=!0,t(f.current.innerHTML))},[t]),C=g.useCallback((O,P)=>{f.current?.focus(),document.execCommand(O,!1,P),S()},[S]),E=g.useCallback(O=>{f.current?.focus();const P=window.getSelection();if(!P||!f.current)return;let D=P.anchorNode;for(;D&&D!==f.current;){if(D.nodeType===Node.ELEMENT_NODE){const L=D,U=L.tagName;if(["P","DIV","H1","H2","H3","H4","LI","BLOCKQUOTE","PRE"].includes(U)){L.style.backgroundColor=O==="transparent"?"":O,S();return}}D=D.parentNode}document.execCommand("hiliteColor",!1,O==="transparent"?"transparent":O),S()},[S]),w=g.useCallback(()=>{const O=prompt("URL du lien :","https://");O&&C("createLink",O)},[C]),z=g.useCallback(()=>{C("removeFormat"),C("formatBlock","p")},[C]);g.useEffect(()=>{const O=()=>{v(!1),x(!1),N(!1)};return document.addEventListener("click",O),()=>document.removeEventListener("click",O)},[]);const k=(O,P)=>{switch(O){case"separator":return r.jsx("span",{className:"rte-separator"},`sep-${P}`);case"bold":return r.jsx("button",{type:"button",className:"rte-btn",title:"Gras (Ctrl+B)",onMouseDown:D=>{D.preventDefault(),C("bold")},children:r.jsx("strong",{children:"G"})},"bold");case"italic":return r.jsx("button",{type:"button",className:"rte-btn",title:"Italique (Ctrl+I)",onMouseDown:D=>{D.preventDefault(),C("italic")},children:r.jsx("em",{children:"I"})},"italic");case"underline":return r.jsx("button",{type:"button",className:"rte-btn",title:"Soulign (Ctrl+U)",onMouseDown:D=>{D.preventDefault(),C("underline")},children:r.jsx("u",{children:"S"})},"underline");case"strikethrough":return r.jsx("button",{type:"button",className:"rte-btn",title:"Barr",onMouseDown:D=>{D.preventDefault(),C("strikeThrough")},children:r.jsx("s",{children:"R"})},"strike");case"headinglevel":return r.jsxs("select",{className:"rte-select",title:"Niveau de titre",defaultValue:"",onChange:D=>{const L=D.target.value;f.current?.focus(),document.execCommand("formatBlock",!1,L),S(),D.target.value=""},children:[r.jsx("option",{value:"",disabled:!0,children:"Titre"}),M5.map(D=>r.jsx("option",{value:D.tag,children:D.label},D.tag))]},"headinglevel");case"fontsize":return r.jsxs("select",{className:"rte-select",title:"Taille de police",defaultValue:"",onChange:D=>{const L=D.target.value;f.current?.focus(),document.execCommand("fontSize",!1,L),S(),D.target.value=""},children:[r.jsx("option",{value:"",disabled:!0,children:"Taille"}),P5.map(D=>r.jsx("option",{value:D.value,children:D.label},D.value))]},"fontsize");case"color":return r.jsxs("span",{className:"rte-dropdown-wrapper",onClick:D=>D.stopPropagation(),children:[r.jsx("button",{type:"button",className:"rte-btn",title:"Couleur du texte",onClick:()=>{v(D=>!D),x(!1),N(!1)},children:r.jsx("span",{style:{borderBottom:"3px solid #dc2626",paddingBottom:1},children:"A"})}),h&&r.jsx("div",{className:"rte-color-picker rte-color-picker--grid",children:O5.map(D=>r.jsx("button",{type:"button",className:"rte-color-swatch",style:{backgroundColor:D,border:D==="#ffffff"||D==="#f3f4f6"?"1px solid #d1d5db":"1px solid transparent"},title:D,onMouseDown:L=>{L.preventDefault(),C("foreColor",D),v(!1)}},D))})]},"color");case"highlight":return r.jsxs("span",{className:"rte-dropdown-wrapper",onClick:D=>D.stopPropagation(),children:[r.jsx("button",{type:"button",className:"rte-btn",title:"Fond de texte (surlignage)",onClick:()=>{x(D=>!D),v(!1),N(!1)},children:r.jsx("span",{style:{backgroundColor:"#fef08a",padding:"0 3px",borderRadius:2},children:"A"})}),b&&r.jsx("div",{className:"rte-color-picker rte-color-picker--grid",children:k5.map((D,L)=>r.jsx("button",{type:"button",className:"rte-color-swatch",style:{backgroundColor:D==="transparent"?"#fff":D,border:"1px solid #d1d5db"},title:D==="transparent"?"Aucun fond":D,onMouseDown:U=>{U.preventDefault(),C("hiliteColor",D==="transparent"?"transparent":D),x(!1)},children:D==="transparent"?r.jsx("span",{style:{fontSize:10,color:"#6b7280"},children:""}):null},L))})]},"highlight");case"blockBg":return r.jsxs("span",{className:"rte-dropdown-wrapper",onClick:D=>D.stopPropagation(),children:[r.jsx("button",{type:"button",className:"rte-btn",title:"Trame de fond du paragraphe",onClick:()=>{N(D=>!D),v(!1),x(!1)},children:r.jsx("span",{style:{background:"linear-gradient(135deg, #dbeafe 40%, #d1fae5 100%)",padding:"0 3px",borderRadius:2},children:""})}),j&&r.jsx("div",{className:"rte-color-picker rte-color-picker--grid",children:D5.map((D,L)=>r.jsx("button",{type:"button",className:"rte-color-swatch rte-color-swatch--block",style:{backgroundColor:D==="transparent"?"#fff":D,border:"1px solid #d1d5db"},title:D==="transparent"?"Aucun fond":"Fond de bloc",onMouseDown:U=>{U.preventDefault(),E(D),N(!1)},children:D==="transparent"?r.jsx("span",{style:{fontSize:10,color:"#6b7280"},children:""}):null},L))})]},"blockbg");case"alignLeft":return r.jsx("button",{type:"button",className:"rte-btn",title:"Aligner  gauche",onMouseDown:D=>{D.preventDefault(),C("justifyLeft")},children:r.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:r.jsx("path",{d:"M2 12.5a.5.5 0 010-1h7a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h11a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h7a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h11a.5.5 0 010 1H2z"})})},"alignL");case"alignCenter":return r.jsx("button",{type:"button",className:"rte-btn",title:"Centrer",onMouseDown:D=>{D.preventDefault(),C("justifyCenter")},children:r.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:r.jsx("path",{d:"M4 12.5a.5.5 0 010-1h8a.5.5 0 010 1H4zm-2-3a.5.5 0 010-1h12a.5.5 0 010 1H2zm2-3a.5.5 0 010-1h8a.5.5 0 010 1H4zm-2-3a.5.5 0 010-1h12a.5.5 0 010 1H2z"})})},"alignC");case"alignRight":return r.jsx("button",{type:"button",className:"rte-btn",title:"Aligner  droite",onMouseDown:D=>{D.preventDefault(),C("justifyRight")},children:r.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:r.jsx("path",{d:"M14 12.5a.5.5 0 010-1H7a.5.5 0 010 1h7zm0-3a.5.5 0 010-1H3a.5.5 0 010 1h11zm0-3a.5.5 0 010-1H7a.5.5 0 010 1h7zm0-3a.5.5 0 010-1H3a.5.5 0 010 1h11z"})})},"alignR");case"alignJustify":return r.jsx("button",{type:"button",className:"rte-btn",title:"Justifier",onMouseDown:D=>{D.preventDefault(),C("justifyFull")},children:r.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:r.jsx("path",{d:"M2 12.5a.5.5 0 010-1h12a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h12a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h12a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h12a.5.5 0 010 1H2z"})})},"alignJ");case"bulletList":return r.jsx("button",{type:"button",className:"rte-btn",title:"Liste  puces",onMouseDown:D=>{D.preventDefault(),C("insertUnorderedList")},children:""},"ul");case"numberedList":return r.jsx("button",{type:"button",className:"rte-btn",title:"Liste numrote",onMouseDown:D=>{D.preventDefault(),C("insertOrderedList")},children:"1"},"ol");case"indent":return r.jsx("button",{type:"button",className:"rte-btn",title:"Augmenter le retrait",onMouseDown:D=>{D.preventDefault(),C("indent")},children:""},"indent");case"outdent":return r.jsx("button",{type:"button",className:"rte-btn",title:"Diminuer le retrait",onMouseDown:D=>{D.preventDefault(),C("outdent")},children:""},"outdent");case"blockquote":return r.jsx("button",{type:"button",className:"rte-btn",title:"Citation",onMouseDown:D=>{D.preventDefault(),C("formatBlock","blockquote")},children:""},"blockquote");case"subscript":return r.jsxs("button",{type:"button",className:"rte-btn",title:"Indice",onMouseDown:D=>{D.preventDefault(),C("subscript")},children:["X",r.jsx("sub",{children:""})]},"sub");case"superscript":return r.jsxs("button",{type:"button",className:"rte-btn",title:"Exposant",onMouseDown:D=>{D.preventDefault(),C("superscript")},children:["X",r.jsx("sup",{children:""})]},"sup");case"link":return r.jsx("button",{type:"button",className:"rte-btn",title:"Insrer un lien",onMouseDown:D=>{D.preventDefault(),w()},children:""},"link");case"clean":return r.jsx("button",{type:"button",className:"rte-btn rte-btn-clean",title:"Effacer le formatage",onMouseDown:D=>{D.preventDefault(),z()},children:""},"clean");default:return null}};return r.jsxs("div",{className:`rte-container ${u?"rte-disabled":""} ${d}`,children:[!u&&r.jsx("div",{className:"rte-toolbar",children:o.map((O,P)=>k(O,P))}),r.jsx("div",{ref:f,className:"rte-editor",contentEditable:!u,onInput:S,onBlur:S,"data-placeholder":n,style:{minHeight:`${a}px`,maxHeight:`${l}px`},suppressContentEditableWarning:!0})]})},ao={qcm_unique:"QCM  Choix unique",qcm_multiple:"QCM  Choix multiple",drag_drop:"Glisser-Dposer",mise_en_relation:"Mise en relation",essai:"Essai / Rdaction"},mm={qcm_unique:"",qcm_multiple:"",drag_drop:"",mise_en_relation:"",essai:""},fm={qcm_unique:"#2563eb",qcm_multiple:"#7c3aed",drag_drop:"#059669",mise_en_relation:"#d97706",essai:"#dc2626"};function Zt(e="id"){return`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function q5(e,t){const n={id:Zt("q"),type:e,enonce:"",difficulte:"moyen",points:2,ordre:t};switch(e){case"qcm_unique":return{...n,typeData:{options:[{id:Zt("opt"),texte:"",isCorrect:!0},{id:Zt("opt"),texte:"",isCorrect:!1},{id:Zt("opt"),texte:"",isCorrect:!1},{id:Zt("opt"),texte:"",isCorrect:!1}]}};case"qcm_multiple":return{...n,typeData:{options:[{id:Zt("opt"),texte:"",isCorrect:!0},{id:Zt("opt"),texte:"",isCorrect:!0},{id:Zt("opt"),texte:"",isCorrect:!1},{id:Zt("opt"),texte:"",isCorrect:!1}],scoringPartiel:!0}};case"drag_drop":return{...n,typeData:{items:[{id:Zt("item"),texte:"",ordreCorrect:1},{id:Zt("item"),texte:"",ordreCorrect:2},{id:Zt("item"),texte:"",ordreCorrect:3}],consigneOrdre:"Remettez les lments dans le bon ordre"}};case"mise_en_relation":return{...n,typeData:{paires:[{id:Zt("pair"),gauche:"",droite:""},{id:Zt("pair"),gauche:"",droite:""},{id:Zt("pair"),gauche:"",droite:""}]}};case"essai":return{...n,points:5,typeData:{nombreMotsMin:50,nombreMotsMax:500,motsCles:[],correctionMode:"manuelle"}}}}const eu="quizzes_v2",R5="quiz_results_v2";async function I5(e,t){try{const n=await Tt(_e(X,eu),{...e,auteurId:t,createdAt:Mt(),updatedAt:Mt()});return console.log(" Quiz avanc cr :",n.id),n.id}catch(n){throw console.error(" Erreur cration quiz avanc :",n),new Error("Impossible de crer le quiz")}}async function L5(e,t){try{const n=Ne(X,eu,e);await Qe(n,{...t,updatedAt:Mt()}),console.log(" Quiz avanc mis  jour :",e)}catch(n){throw console.error(" Erreur mise  jour quiz :",n),new Error("Impossible de mettre  jour le quiz")}}async function $5(e){try{await en(Ne(X,eu,e)),console.log(" Quiz avanc supprim :",e)}catch(t){throw console.error(" Erreur suppression quiz :",t),new Error("Impossible de supprimer le quiz")}}async function jA(e){try{const t=await Ot(Ne(X,eu,e));if(!t.exists())return null;const n=t.data();return{id:t.id,...n,createdAt:n.createdAt?.toDate()||new Date,updatedAt:n.updatedAt?.toDate()||void 0}}catch(t){throw console.error(" Erreur rcupration quiz :",t),new Error("Impossible de rcuprer le quiz")}}async function NA(){try{const e=ke(_e(X,eu),Ke("createdAt","desc"));return(await ze(e)).docs.map(n=>{const a=n.data();return{id:n.id,...a,createdAt:a.createdAt?.toDate()||new Date,updatedAt:a.updatedAt?.toDate()||void 0}})}catch(e){throw console.error(" Erreur rcupration tous les quiz :",e),new Error("Impossible de rcuprer les quiz")}}function B5(e,t){let n=0,a=0;const l=[];for(const o of e.questions){a+=o.points;const u=t.find(v=>v.questionId===o.id);if(!u){l.push({questionId:o.id,type:o.type,pointsObtenus:0,pointsMax:o.points,isCorrect:!1});continue}let d=0,f=!1,p=!1,h=!1;switch(o.type){case"qcm_unique":{const b=o.typeData.options.find(x=>x.isCorrect);b&&u.selectedOptionId===b.id&&(d=o.points,f=!0);break}case"qcm_multiple":{const v=o.typeData,b=v.options.filter(C=>C.isCorrect).map(C=>C.id),x=v.options.filter(C=>!C.isCorrect).map(C=>C.id),j=u.selectedOptionIds||[],N=j.some(C=>x.includes(C)),S=j.filter(C=>b.includes(C)).length;!N&&S===b.length?(d=o.points,f=!0):v.scoringPartiel&&S>0&&!N&&(d=Math.round(o.points*S/b.length*100)/100,p=!0);break}case"drag_drop":{const v=o.typeData,b=u.ordrePropose||[],x=v.items.sort((N,S)=>N.ordreCorrect-S.ordreCorrect).map(N=>N.id);let j=0;for(let N=0;N<x.length;N++)b[N]===x[N]&&j++;j===x.length?(d=o.points,f=!0):j>0&&(d=Math.round(o.points*j/x.length*100)/100,p=!0);break}case"mise_en_relation":{const v=o.typeData,b=u.relationsProposees||{};let x=0;for(const j of v.paires)b[j.id]===j.id&&x++;x===v.paires.length?(d=o.points,f=!0):x>0&&(d=Math.round(o.points*x/v.paires.length*100)/100,p=!0);break}case"essai":{const v=o.typeData,b=u.texteReponse||"";if(v.correctionMode==="mots_cles"&&v.motsCles.length>0){const x=b.toLowerCase().replace(/<[^>]*>/g,"");let j=0,N=0;for(const S of v.motsCles)j+=S.poids,x.includes(S.mot.toLowerCase())&&(N+=S.poids);j>0&&(d=Math.round(o.points*N/j*100)/100,f=N===j,p=N>0&&N<j)}else h=!0;break}}n+=d,l.push({questionId:o.id,type:o.type,pointsObtenus:d,pointsMax:o.points,isCorrect:f,isPartiel:p,correctionManuelleRequise:h})}return{score:n,scoreMax:a,details:l}}async function U5(e,t,n,a){try{const{score:l,scoreMax:o,details:u}=B5(e,n),d=o>0?Math.round(l/o*20*100)/100:0,f=u.some(v=>v.correctionManuelleRequise),p={quizId:e.id,userId:t,reponses:n,score:l,scoreMax:o,note20:d,tempsEcoule:a,datePassage:new Date,reussi:d>=e.noteMinimale,correctionManuelle:f,detailsParQuestion:u},h=await Tt(_e(X,R5),{...p,datePassage:Mt()});return console.log(" Rsultat quiz enregistr :",h.id),{id:h.id,...p}}catch(l){throw console.error(" Erreur soumission quiz :",l),new Error("Impossible d'enregistrer le rsultat")}}const F5=({existingQuiz:e,disciplines:t,auteurId:n,onSave:a,onCancel:l})=>{const[o,u]=g.useState(e?.titre||""),[d,f]=g.useState(e?.description||""),[p,h]=g.useState(e?.disciplineId||""),[v,b]=g.useState(e?.duree||30),[x,j]=g.useState(e?.isPremium??!0),[N,S]=g.useState(e?.noteMinimale||10),[C,E]=g.useState(e?.melangerQuestions??!1),[w,z]=g.useState(e?.melangerOptions??!1),[k,O]=g.useState(e?.afficherCorrection??!0),[P,D]=g.useState(e?.tentativesMax||0),[L,U]=g.useState(e?.questions||[]),[$,B]=g.useState(null),[re,se]=g.useState(!1),[M,q]=g.useState(null),[F,R]=g.useState(!1),K=g.useCallback(Q=>{const ve=q5(Q,L.length+1);U(Me=>[...Me,ve]),B(L.length),R(!1)},[L.length]),I=g.useCallback(Q=>{confirm("Supprimer cette question ?")&&(U(ve=>ve.filter((ce,Z)=>Z!==Q).map((ce,Z)=>({...ce,ordre:Z+1}))),B(null))},[]),te=g.useCallback(Q=>{U(ve=>{const Me=ve[Q],ce={...JSON.parse(JSON.stringify(Me)),id:Zt("q"),ordre:ve.length+1};return[...ve,ce]})},[]),Y=g.useCallback((Q,ve)=>{U(Me=>{const ce=[...Me],Z=ve==="up"?Q-1:Q+1;return Z<0||Z>=ce.length?Me:([ce[Q],ce[Z]]=[ce[Z],ce[Q]],ce.map((H,de)=>({...H,ordre:de+1})))}),B(ve==="up"?$!==null?$-1:null:$!==null?$+1:null)},[$]),oe=g.useCallback((Q,ve)=>{U(Me=>Me.map((ce,Z)=>Z===Q?{...ce,...ve}:ce))},[]),he=async()=>{if(!o.trim()){q("Le titre est obligatoire");return}if(!p){q("Slectionnez une discipline");return}if(L.length===0){q("Ajoutez au moins une question");return}for(let Q=0;Q<L.length;Q++)if(!L[Q].enonce.replace(/<[^>]*>/g,"").trim()){q(`La question ${Q+1} n'a pas d'nonc`),B(Q);return}q(null),se(!0);try{const Q={disciplineId:p,titre:o.trim(),description:d.trim()||void 0,questions:L,duree:v,isPremium:x,noteMinimale:N,melangerQuestions:C,melangerOptions:w,afficherCorrection:k,tentativesMax:P};let ve;e?.id?(await L5(e.id,Q),ve=e.id):ve=await I5(Q,n),a?.(ve)}catch(Q){q(Q.message||"Erreur lors de la sauvegarde")}finally{se(!1)}},ge=L.reduce((Q,ve)=>Q+ve.points,0);return r.jsxs("div",{className:"quiz-editor",children:[r.jsxs("div",{className:"quiz-editor__header",children:[r.jsx("h2",{children:e?" Modifier le quiz":" Nouveau quiz avanc"}),r.jsxs("div",{className:"quiz-editor__header-actions",children:[r.jsxs("span",{className:"quiz-editor__score-badge",children:["Score total : ",ge," pts"]}),r.jsxs("span",{className:"quiz-editor__count-badge",children:[L.length," question",L.length>1?"s":""]})]})]}),M&&r.jsxs("div",{className:"quiz-editor__error",children:[" ",M,r.jsx("button",{onClick:()=>q(null),children:""})]}),r.jsxs("div",{className:"quiz-editor__section",children:[r.jsx("h3",{className:"quiz-editor__section-title",children:" Paramtres du quiz"}),r.jsxs("div",{className:"quiz-editor__grid",children:[r.jsxs("div",{className:"quiz-editor__field quiz-editor__field--full",children:[r.jsx("label",{children:"Titre du quiz *"}),r.jsx("input",{type:"text",value:o,onChange:Q=>u(Q.target.value),placeholder:"Ex: valuation Chapitre 3  Les fonctions",className:"quiz-editor__input"})]}),r.jsxs("div",{className:"quiz-editor__field",children:[r.jsx("label",{children:"Discipline *"}),r.jsxs("select",{value:p,onChange:Q=>h(Q.target.value),className:"quiz-editor__select",children:[r.jsx("option",{value:"",children:" Slectionner "}),t.map(Q=>r.jsxs("option",{value:Q.id,children:[Q.nom," (",Q.classe,")"]},Q.id))]})]}),r.jsxs("div",{className:"quiz-editor__field",children:[r.jsx("label",{children:"Dure (minutes)"}),r.jsx("input",{type:"number",value:v,onChange:Q=>b(Number(Q.target.value)),min:1,max:180,className:"quiz-editor__input"})]}),r.jsxs("div",{className:"quiz-editor__field",children:[r.jsx("label",{children:"Note minimale (/20)"}),r.jsx("input",{type:"number",value:N,onChange:Q=>S(Number(Q.target.value)),min:0,max:20,className:"quiz-editor__input"})]}),r.jsxs("div",{className:"quiz-editor__field",children:[r.jsx("label",{children:"Tentatives max (0 = illimit)"}),r.jsx("input",{type:"number",value:P,onChange:Q=>D(Number(Q.target.value)),min:0,max:10,className:"quiz-editor__input"})]}),r.jsxs("div",{className:"quiz-editor__field quiz-editor__field--full",children:[r.jsx("label",{children:"Description (optionnel)"}),r.jsx(fa,{value:d,onChange:f,placeholder:"Dcrivez le contenu et les objectifs de ce quiz...",minHeight:80,toolbar:["bold","italic","underline","color","bulletList"]})]})]}),r.jsxs("div",{className:"quiz-editor__options-row",children:[r.jsxs("label",{className:"quiz-editor__checkbox",children:[r.jsx("input",{type:"checkbox",checked:x,onChange:Q=>j(Q.target.checked)}),r.jsx("span",{children:" Premium"})]}),r.jsxs("label",{className:"quiz-editor__checkbox",children:[r.jsx("input",{type:"checkbox",checked:C,onChange:Q=>E(Q.target.checked)}),r.jsx("span",{children:" Mlanger les questions"})]}),r.jsxs("label",{className:"quiz-editor__checkbox",children:[r.jsx("input",{type:"checkbox",checked:w,onChange:Q=>z(Q.target.checked)}),r.jsx("span",{children:" Mlanger les options QCM"})]}),r.jsxs("label",{className:"quiz-editor__checkbox",children:[r.jsx("input",{type:"checkbox",checked:k,onChange:Q=>O(Q.target.checked)}),r.jsx("span",{children:" Afficher la correction"})]})]})]}),r.jsxs("div",{className:"quiz-editor__section",children:[r.jsx("h3",{className:"quiz-editor__section-title",children:" Questions"}),r.jsx("div",{className:"quiz-editor__questions-list",children:L.map((Q,ve)=>r.jsx(G5,{question:Q,index:ve,isActive:$===ve,onToggle:()=>B($===ve?null:ve),onUpdate:Me=>oe(ve,Me),onDelete:()=>I(ve),onDuplicate:()=>te(ve),onMoveUp:()=>Y(ve,"up"),onMoveDown:()=>Y(ve,"down"),isFirst:ve===0,isLast:ve===L.length-1},Q.id))}),r.jsxs("div",{className:"quiz-editor__add-wrapper",children:[r.jsx("button",{type:"button",className:"quiz-editor__add-btn",onClick:()=>R(!F),children:"+ Ajouter une question"}),F&&r.jsx("div",{className:"quiz-editor__add-menu",children:Object.keys(ao).map(Q=>r.jsxs("button",{type:"button",className:"quiz-editor__add-menu-item",onClick:()=>K(Q),children:[r.jsx("span",{className:"quiz-editor__type-badge",style:{backgroundColor:fm[Q]},children:mm[Q]}),r.jsx("span",{children:ao[Q]})]},Q))})]})]}),r.jsxs("div",{className:"quiz-editor__actions",children:[r.jsx("button",{type:"button",className:"quiz-editor__btn quiz-editor__btn--secondary",onClick:l,disabled:re,children:"Annuler"}),r.jsx("button",{type:"button",className:"quiz-editor__btn quiz-editor__btn--primary",onClick:he,disabled:re||L.length===0,children:re?" Sauvegarde...":e?" Mettre  jour":" Crer le quiz"})]})]})},G5=({question:e,index:t,isActive:n,onToggle:a,onUpdate:l,onDelete:o,onDuplicate:u,onMoveUp:d,onMoveDown:f,isFirst:p,isLast:h})=>{const v=fm[e.type],b=mm[e.type],x=ao[e.type],j=N=>{const S=N.replace(/<[^>]*>/g,"").trim();return S.length>80?S.substring(0,80)+"...":S||"(sans nonc)"};return r.jsxs("div",{className:`question-editor ${n?"question-editor--active":""}`,style:{borderLeftColor:v},children:[r.jsxs("div",{className:"question-editor__header",onClick:a,children:[r.jsxs("div",{className:"question-editor__header-left",children:[r.jsx("span",{className:"question-editor__number",children:t+1}),r.jsxs("span",{className:"question-editor__type-badge",style:{backgroundColor:v},children:[b," ",x]}),!n&&r.jsx("span",{className:"question-editor__preview",children:j(e.enonce)})]}),r.jsxs("div",{className:"question-editor__header-right",children:[r.jsxs("span",{className:"question-editor__points",children:[e.points," pts"]}),r.jsx("span",{className:"question-editor__toggle",children:n?"":""})]})]}),n&&r.jsxs("div",{className:"question-editor__body",children:[r.jsxs("div",{className:"question-editor__toolbar",children:[r.jsx("button",{type:"button",onClick:d,disabled:p,title:"Monter",children:""}),r.jsx("button",{type:"button",onClick:f,disabled:h,title:"Descendre",children:""}),r.jsx("button",{type:"button",onClick:u,title:"Dupliquer",children:""}),r.jsx("button",{type:"button",onClick:o,className:"btn-danger",title:"Supprimer",children:""})]}),r.jsxs("div",{className:"question-editor__field",children:[r.jsx("label",{children:"nonc de la question *"}),r.jsx(fa,{value:e.enonce,onChange:N=>l({enonce:N}),placeholder:"Saisissez l'nonc de la question...",minHeight:100})]}),r.jsxs("div",{className:"question-editor__params",children:[r.jsxs("div",{className:"question-editor__param",children:[r.jsx("label",{children:"Difficult"}),r.jsxs("select",{value:e.difficulte,onChange:N=>l({difficulte:N.target.value}),children:[r.jsx("option",{value:"facile",children:" Facile"}),r.jsx("option",{value:"moyen",children:" Moyen"}),r.jsx("option",{value:"difficile",children:" Difficile"})]})]}),r.jsxs("div",{className:"question-editor__param",children:[r.jsx("label",{children:"Points"}),r.jsx("input",{type:"number",value:e.points,onChange:N=>l({points:Number(N.target.value)}),min:1,max:20})]})]}),r.jsxs("div",{className:"question-editor__type-specific",children:[e.type==="qcm_unique"&&r.jsx(H5,{data:e.typeData,onChange:N=>l({typeData:N})}),e.type==="qcm_multiple"&&r.jsx(Q5,{data:e.typeData,onChange:N=>l({typeData:N})}),e.type==="drag_drop"&&r.jsx(V5,{data:e.typeData,onChange:N=>l({typeData:N})}),e.type==="mise_en_relation"&&r.jsx(Y5,{data:e.typeData,onChange:N=>l({typeData:N})}),e.type==="essai"&&r.jsx(K5,{data:e.typeData,onChange:N=>l({typeData:N})})]}),r.jsxs("div",{className:"question-editor__field",children:[r.jsx("label",{children:"Explication (affiche aprs correction, optionnel)"}),r.jsx(fa,{value:e.explication||"",onChange:N=>l({explication:N}),placeholder:"Expliquez la bonne rponse...",minHeight:60,toolbar:["bold","italic","color","link"]})]})]})]})},H5=({data:e,onChange:t})=>{const n=(o,u)=>{const d=e.options.map((f,p)=>p===o?{...f,...u}:u.isCorrect===!0?{...f,isCorrect:!1}:f);t({options:d})},a=()=>{e.options.length>=6||t({options:[...e.options,{id:Zt("opt"),texte:"",isCorrect:!1}]})},l=o=>{e.options.length<=2||t({options:e.options.filter((u,d)=>d!==o)})};return r.jsxs("div",{className:"type-editor",children:[r.jsx("label",{className:"type-editor__label",children:" Options (slectionnez la bonne rponse)"}),e.options.map((o,u)=>r.jsxs("div",{className:"type-editor__option-row",children:[r.jsx("input",{type:"radio",name:`qcm_unique_${o.id}`,checked:o.isCorrect,onChange:()=>n(u,{isCorrect:!0}),className:"type-editor__radio",title:"Bonne rponse"}),r.jsx("div",{className:"type-editor__option-text",children:r.jsx(fa,{value:o.texte,onChange:d=>n(u,{texte:d}),placeholder:`Option ${u+1}...`,minHeight:40,toolbar:["bold","italic","color","subscript","superscript"]})}),o.isCorrect&&r.jsx("span",{className:"type-editor__correct-badge",children:""}),r.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.options.length<=2,title:"Supprimer cette option",children:""})]},o.id)),e.options.length<6&&r.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter une option"})]})},Q5=({data:e,onChange:t})=>{const n=(o,u)=>{const d=e.options.map((f,p)=>p===o?{...f,...u}:f);t({...e,options:d})},a=()=>{e.options.length>=8||t({...e,options:[...e.options,{id:Zt("opt"),texte:"",isCorrect:!1}]})},l=o=>{e.options.length<=2||t({...e,options:e.options.filter((u,d)=>d!==o)})};return r.jsxs("div",{className:"type-editor",children:[r.jsx("label",{className:"type-editor__label",children:" Options (cochez toutes les bonnes rponses)"}),e.options.map((o,u)=>r.jsxs("div",{className:"type-editor__option-row",children:[r.jsx("input",{type:"checkbox",checked:o.isCorrect,onChange:d=>n(u,{isCorrect:d.target.checked}),className:"type-editor__checkbox",title:"Bonne rponse"}),r.jsx("div",{className:"type-editor__option-text",children:r.jsx(fa,{value:o.texte,onChange:d=>n(u,{texte:d}),placeholder:`Option ${u+1}...`,minHeight:40,toolbar:["bold","italic","color","subscript","superscript"]})}),o.isCorrect&&r.jsx("span",{className:"type-editor__correct-badge",children:""}),r.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.options.length<=2,children:""})]},o.id)),e.options.length<8&&r.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter une option"}),r.jsxs("label",{className:"type-editor__sub-option",children:[r.jsx("input",{type:"checkbox",checked:e.scoringPartiel,onChange:o=>t({...e,scoringPartiel:o.target.checked})}),r.jsx("span",{children:"Accorder des points partiels (proportionnel aux bonnes rponses trouves)"})]})]})},V5=({data:e,onChange:t})=>{const n=(o,u)=>{const d=e.items.map((f,p)=>p===o?{...f,...u}:f);t({...e,items:d})},a=()=>{e.items.length>=10||t({...e,items:[...e.items,{id:Zt("item"),texte:"",ordreCorrect:e.items.length+1}]})},l=o=>{if(e.items.length<=2)return;const u=e.items.filter((d,f)=>f!==o).map((d,f)=>({...d,ordreCorrect:f+1}));t({...e,items:u})};return r.jsxs("div",{className:"type-editor",children:[r.jsx("label",{className:"type-editor__label",children:" lments  rordonner (dans l'ordre correct)"}),r.jsx("p",{className:"type-editor__hint",children:"Saisissez les lments dans l'ordre correct. Ils seront mlangs automatiquement pour l'lve."}),r.jsxs("div",{className:"type-editor__field-inline",children:[r.jsx("label",{children:"Consigne :"}),r.jsx("input",{type:"text",value:e.consigneOrdre,onChange:o=>t({...e,consigneOrdre:o.target.value}),placeholder:"Ex: Classez du plus ancien au plus rcent",className:"type-editor__input"})]}),e.items.map((o,u)=>r.jsxs("div",{className:"type-editor__drag-row",children:[r.jsx("span",{className:"type-editor__drag-number",children:u+1}),r.jsx("div",{className:"type-editor__option-text",children:r.jsx(fa,{value:o.texte,onChange:d=>n(u,{texte:d}),placeholder:`lment ${u+1}...`,minHeight:40,toolbar:["bold","italic","color"]})}),r.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.items.length<=2,children:""})]},o.id)),e.items.length<10&&r.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter un lment"})]})},Y5=({data:e,onChange:t})=>{const n=(o,u)=>{const d=e.paires.map((f,p)=>p===o?{...f,...u}:f);t({paires:d})},a=()=>{e.paires.length>=8||t({paires:[...e.paires,{id:Zt("pair"),gauche:"",droite:""}]})},l=o=>{e.paires.length<=2||t({paires:e.paires.filter((u,d)=>d!==o)})};return r.jsxs("div",{className:"type-editor",children:[r.jsx("label",{className:"type-editor__label",children:" Paires  relier (gauche  droite)"}),r.jsx("p",{className:"type-editor__hint",children:"Saisissez les correspondances correctes. La colonne droite sera mlange pour l'lve."}),r.jsxs("div",{className:"type-editor__relation-header",children:[r.jsx("span",{children:"Colonne A (gauche)"}),r.jsx("span",{}),r.jsx("span",{children:"Colonne B (droite)"}),r.jsx("span",{})]}),e.paires.map((o,u)=>r.jsxs("div",{className:"type-editor__relation-row",children:[r.jsx("div",{className:"type-editor__relation-cell",children:r.jsx(fa,{value:o.gauche,onChange:d=>n(u,{gauche:d}),placeholder:`lment A${u+1}...`,minHeight:40,toolbar:["bold","italic","color"]})}),r.jsx("span",{className:"type-editor__relation-arrow",children:""}),r.jsx("div",{className:"type-editor__relation-cell",children:r.jsx(fa,{value:o.droite,onChange:d=>n(u,{droite:d}),placeholder:`lment B${u+1}...`,minHeight:40,toolbar:["bold","italic","color"]})}),r.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.paires.length<=2,children:""})]},o.id)),e.paires.length<8&&r.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter une paire"})]})},K5=({data:e,onChange:t})=>{const n=()=>{t({...e,motsCles:[...e.motsCles,{mot:"",poids:1,obligatoire:!1}]})},a=(o,u)=>{const d=e.motsCles.map((f,p)=>p===o?{...f,...u}:f);t({...e,motsCles:d})},l=o=>{t({...e,motsCles:e.motsCles.filter((u,d)=>d!==o)})};return r.jsxs("div",{className:"type-editor",children:[r.jsx("label",{className:"type-editor__label",children:" Paramtres de l'essai"}),r.jsxs("div",{className:"type-editor__params-row",children:[r.jsxs("div",{className:"type-editor__param-inline",children:[r.jsx("label",{children:"Mots minimum :"}),r.jsx("input",{type:"number",value:e.nombreMotsMin||"",onChange:o=>t({...e,nombreMotsMin:Number(o.target.value)||void 0}),min:0,placeholder:"Ex: 50"})]}),r.jsxs("div",{className:"type-editor__param-inline",children:[r.jsx("label",{children:"Mots maximum :"}),r.jsx("input",{type:"number",value:e.nombreMotsMax||"",onChange:o=>t({...e,nombreMotsMax:Number(o.target.value)||void 0}),min:0,placeholder:"Ex: 500"})]})]}),r.jsxs("div",{className:"type-editor__field-inline",children:[r.jsx("label",{children:"Mode de correction :"}),r.jsxs("select",{value:e.correctionMode,onChange:o=>t({...e,correctionMode:o.target.value}),children:[r.jsx("option",{value:"manuelle",children:" Manuelle (par le prof)"}),r.jsx("option",{value:"mots_cles",children:" Par mots-cls (automatique)"}),r.jsx("option",{value:"semi_auto",children:" Semi-automatique (mots-cls + validation prof)"})]})]}),(e.correctionMode==="mots_cles"||e.correctionMode==="semi_auto")&&r.jsxs("div",{className:"type-editor__keywords",children:[r.jsx("label",{className:"type-editor__sub-label",children:"Mots-cls attendus"}),e.motsCles.map((o,u)=>r.jsxs("div",{className:"type-editor__keyword-row",children:[r.jsx("input",{type:"text",value:o.mot,onChange:d=>a(u,{mot:d.target.value}),placeholder:"Mot ou expression...",className:"type-editor__keyword-input"}),r.jsxs("select",{value:o.poids,onChange:d=>a(u,{poids:Number(d.target.value)}),className:"type-editor__keyword-weight",children:[r.jsx("option",{value:1,children:"Poids 1"}),r.jsx("option",{value:2,children:"Poids 2"}),r.jsx("option",{value:3,children:"Poids 3"}),r.jsx("option",{value:4,children:"Poids 4"}),r.jsx("option",{value:5,children:"Poids 5"})]}),r.jsxs("label",{className:"type-editor__keyword-required",children:[r.jsx("input",{type:"checkbox",checked:o.obligatoire,onChange:d=>a(u,{obligatoire:d.target.checked})}),r.jsx("span",{children:"Obligatoire"})]}),r.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),children:""})]},u)),r.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:n,children:"+ Ajouter un mot-cl"})]}),r.jsxs("div",{className:"type-editor__field-block",children:[r.jsx("label",{children:"Rponse modle (optionnel  pour le prof)"}),r.jsx(fa,{value:e.reponseModele||"",onChange:o=>t({...e,reponseModele:o}),placeholder:"Saisissez une rponse modle...",minHeight:80})]})]})},q1=()=>{const{quizId:e}=Wn(),t=st(),{currentUser:n}=rt(),[a,l]=g.useState([]),[o,u]=g.useState(void 0),[d,f]=g.useState(!0),[p,h]=g.useState(null);return g.useEffect(()=>{(async()=>{try{f(!0);const b=await Ki.getAll();if(l(b.map(x=>({id:x.id,nom:x.nom,classe:x.classe||""}))),e){const x=await jA(e);x?u(x):h("Quiz introuvable")}}catch(b){console.error("Erreur chargement donnes:",b),h(b.message||"Erreur de chargement")}finally{f(!1)}})()},[e]),d?r.jsx("div",{style:{textAlign:"center",padding:"3rem"},children:r.jsx("p",{children:" Chargement..."})}):p?r.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[r.jsxs("p",{style:{color:"#dc2626"},children:[" ",p]}),r.jsx("button",{onClick:()=>t(-1),children:" Retour"})]}):r.jsx(F5,{existingQuiz:o?{...o,id:o.id}:void 0,disciplines:a,auteurId:n?.uid||"",onSave:v=>{alert(" Quiz sauvegard avec succs !"),t("/admin/quiz")},onCancel:()=>t(-1)})},W5=()=>{const e=st(),{currentUser:t}=rt(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState(null);g.useEffect(()=>{h()},[]);const h=async()=>{try{o(!0),d(null);const N=await NA();a(N)}catch(N){console.error("Erreur chargement quiz:",N),d("Impossible de charger les quiz")}finally{o(!1)}},v=async N=>{try{await $5(N),a(S=>S.filter(C=>C.id!==N)),p(null)}catch(S){console.error("Erreur suppression:",S),alert("Erreur lors de la suppression : "+S.message)}},b=N=>{const S={};return N.questions.forEach(C=>{S[C.type]=(S[C.type]||0)+1}),Object.entries(S).map(([C,E])=>`${E} ${ao[C]||C}`).join(", ")},x=N=>N?(N.toDate?N.toDate():new Date(N)).toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric"}):"",j=N=>N.questions.reduce((S,C)=>S+C.points,0);return r.jsxs("div",{style:{padding:"1.5rem"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",flexWrap:"wrap",gap:"1rem"},children:[r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:"1.5rem",fontWeight:700,color:"#1f2937",margin:0},children:" Quiz Avancs (Multi-types)"}),r.jsxs("p",{style:{color:"#6b7280",margin:"0.25rem 0 0",fontSize:"0.9rem"},children:[n.length," quiz cr",n.length!==1?"s":""]})]}),r.jsx("button",{onClick:()=>e("/admin/quiz/nouveau"),style:{padding:"0.7rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:" Nouveau quiz avanc"})]}),u&&r.jsxs("div",{style:{padding:"1rem",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",color:"#991b1b",marginBottom:"1rem"},children:[" ",u,r.jsx("button",{onClick:h,style:{marginLeft:"1rem",padding:"0.3rem 0.8rem",background:"#fff",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer"},children:" Ressayer"})]}),l&&r.jsx("div",{style:{textAlign:"center",padding:"3rem",color:"#6b7280"},children:" Chargement des quiz..."}),!l&&n.length===0&&!u&&r.jsxs("div",{style:{textAlign:"center",padding:"3rem",background:"#f9fafb",borderRadius:"12px",border:"1px solid #e5e7eb"},children:[r.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),r.jsx("h3",{style:{color:"#374151",marginBottom:"0.5rem"},children:"Aucun quiz avanc"}),r.jsx("p",{style:{color:"#6b7280",marginBottom:"1.5rem"},children:"Crez votre premier quiz multi-types avec l'diteur riche !"}),r.jsx("button",{onClick:()=>e("/admin/quiz/nouveau"),style:{padding:"0.7rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:" Crer un quiz"})]}),!l&&n.length>0&&r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:n.map(N=>r.jsx("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e5e7eb",padding:"1.25rem",boxShadow:"0 1px 3px rgba(0,0,0,0.04)",transition:"box-shadow 0.2s"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"1rem"},children:[r.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[r.jsx("h3",{style:{fontSize:"1.05rem",fontWeight:700,color:"#1f2937",margin:0},children:N.titre}),N.isPremium&&r.jsx("span",{style:{padding:"0.15rem 0.5rem",background:"#fef3c7",color:"#92400e",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,border:"1px solid #fde68a"},children:" Premium"})]}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.4rem",marginBottom:"0.5rem"},children:[r.jsxs("span",{style:{padding:"0.2rem 0.6rem",background:"#eff6ff",color:"#1d4ed8",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500},children:[" ",N.questions.length," question",N.questions.length!==1?"s":""]}),r.jsxs("span",{style:{padding:"0.2rem 0.6rem",background:"#f0fdf4",color:"#166534",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500},children:[" ",j(N)," pts"]}),r.jsxs("span",{style:{padding:"0.2rem 0.6rem",background:"#fdf4ff",color:"#86198f",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500},children:[" ",N.duree," min"]})]}),r.jsxs("p",{style:{fontSize:"0.8rem",color:"#6b7280",margin:0},children:["Types : ",b(N)]}),r.jsxs("p",{style:{fontSize:"0.75rem",color:"#9ca3af",margin:"0.25rem 0 0"},children:["Cr le ",x(N.createdAt)]})]}),r.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,flexWrap:"wrap"},children:[r.jsx("button",{onClick:()=>e(`/quiz-avance/${N.id}`),title:"Tester le quiz",style:{padding:"0.5rem 0.9rem",background:"#f0fdf4",color:"#166534",border:"1px solid #bbf7d0",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Tester"}),r.jsx("button",{onClick:()=>e(`/admin/quiz/modifier/${N.id}`),title:"Modifier le quiz",style:{padding:"0.5rem 0.9rem",background:"#eff6ff",color:"#1d4ed8",border:"1px solid #bfdbfe",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Modifier"}),r.jsx("button",{onClick:()=>{const S=`${window.location.origin}/quiz-avance/${N.id}`;navigator.clipboard.writeText(S).then(()=>{alert(` Lien copi !

`+S+`

Partagez ce lien aux lves.`)})},title:"Copier le lien pour les lves",style:{padding:"0.5rem 0.9rem",background:"#fdf4ff",color:"#86198f",border:"1px solid #e9d5ff",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Lien"}),f===N.id?r.jsxs("div",{style:{display:"flex",gap:"0.3rem"},children:[r.jsx("button",{onClick:()=>v(N.id),style:{padding:"0.5rem 0.7rem",background:"#dc2626",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Confirmer"}),r.jsx("button",{onClick:()=>p(null),style:{padding:"0.5rem 0.7rem",background:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontSize:"0.8rem"},children:""})]}):r.jsx("button",{onClick:()=>p(N.id),title:"Supprimer le quiz",style:{padding:"0.5rem 0.9rem",background:"#fef2f2",color:"#991b1b",border:"1px solid #fecaca",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:""})]})]})},N.id))})]})},X5=({quiz:e,userId:t,onComplete:n,onQuit:a})=>{const l=g.useMemo(()=>{let D=[...e.questions];return e.melangerQuestions&&(D=D.sort(()=>Math.random()-.5)),D},[e]),[o,u]=g.useState(0),[d,f]=g.useState(new Map),[p,h]=g.useState(e.duree*60),[v,b]=g.useState(!1),[x,j]=g.useState(null),[N,S]=g.useState(!1),C=g.useRef(Date.now());g.useEffect(()=>{if(x)return;const D=setInterval(()=>{h(L=>L<=1?(clearInterval(D),O(),0):L-1)},1e3);return()=>clearInterval(D)},[x]);const E=D=>{const L=Math.floor(D/60),U=D%60;return`${L.toString().padStart(2,"0")}:${U.toString().padStart(2,"0")}`},w=l[o],z=g.useCallback((D,L)=>{f(U=>{const $=new Map(U),B=$.get(D)||{questionId:D,type:w.type};return $.set(D,{...B,...L}),$})},[w]),k=D=>{D>=0&&D<l.length&&u(D)},O=async()=>{S(!1),b(!0);try{const D=Array.from(d.values()),L=Math.round((Date.now()-C.current)/1e3),U=await U5(e,t,D,L);j(U),n?.(U)}catch(D){alert("Erreur lors de la soumission : "+D.message)}finally{b(!1)}},P=d.size;return x?r.jsx("div",{className:"quiz-player quiz-player--results",children:r.jsxs("div",{className:"quiz-results",children:[r.jsxs("div",{className:`quiz-results__header ${x.reussi?"quiz-results__header--success":"quiz-results__header--fail"}`,children:[r.jsx("div",{className:"quiz-results__emoji",children:x.reussi?"":""}),r.jsx("h2",{children:x.reussi?"Flicitations !":"Quiz termin"}),r.jsxs("div",{className:"quiz-results__score",children:[r.jsxs("span",{className:"quiz-results__note",children:[x.note20,"/20"]}),r.jsxs("span",{className:"quiz-results__detail",children:[x.score,"/",x.scoreMax," points"]})]}),r.jsxs("div",{className:"quiz-results__time",children:[" Temps : ",E(x.tempsEcoule)]}),x.correctionManuelle&&r.jsx("p",{className:"quiz-results__pending",children:" Ce quiz contient des questions  correction manuelle. Votre note finale pourra tre ajuste par le professeur."})]}),e.afficherCorrection&&r.jsxs("div",{className:"quiz-results__details",children:[r.jsx("h3",{children:" Dtail des rponses"}),l.map((D,L)=>{const U=x.detailsParQuestion.find($=>$.questionId===D.id);return r.jsxs("div",{className:`quiz-results__question ${U?.isCorrect?"quiz-results__question--correct":U?.isPartiel?"quiz-results__question--partial":"quiz-results__question--wrong"}`,children:[r.jsxs("div",{className:"quiz-results__q-header",children:[r.jsxs("span",{children:["Q",L+1," "," ",r.jsxs("span",{style:{color:fm[D.type]},children:[mm[D.type]," ",ao[D.type]]})]}),r.jsxs("span",{className:"quiz-results__q-score",children:[U?.pointsObtenus||0,"/",U?.pointsMax||D.points," pts",U?.isCorrect&&" ",U?.isPartiel&&" ",!U?.isCorrect&&!U?.isPartiel&&" "]})]}),r.jsx("div",{className:"quiz-results__q-enonce",dangerouslySetInnerHTML:{__html:D.enonce}}),D.explication&&r.jsxs("div",{className:"quiz-results__q-explanation",children:[r.jsx("strong",{children:" Explication :"}),r.jsx("div",{dangerouslySetInnerHTML:{__html:D.explication}})]})]},D.id)})]}),r.jsx("div",{className:"quiz-results__actions",children:r.jsx("button",{className:"quiz-player__btn quiz-player__btn--primary",onClick:a,children:"Retour au tableau de bord"})})]})}):r.jsxs("div",{className:"quiz-player",children:[r.jsxs("div",{className:"quiz-player__topbar",children:[r.jsxs("div",{className:"quiz-player__info",children:[r.jsx("span",{className:"quiz-player__title",children:e.titre}),r.jsxs("span",{className:"quiz-player__progress",children:["Question ",o+1,"/",l.length]})]}),r.jsxs("div",{className:"quiz-player__topbar-right",children:[r.jsxs("span",{className:`quiz-player__timer ${p<60?"quiz-player__timer--danger":p<300?"quiz-player__timer--warning":""}`,children:[" ",E(p)]}),r.jsxs("span",{className:"quiz-player__answered",children:[P,"/",l.length," rpondue",P>1?"s":""]})]})]}),r.jsx("div",{className:"quiz-player__progress-bar",children:r.jsx("div",{className:"quiz-player__progress-fill",style:{width:`${(o+1)/l.length*100}%`}})}),r.jsxs("div",{className:"quiz-player__question-area",children:[r.jsxs("div",{className:"quiz-player__question-meta",children:[r.jsxs("span",{className:"quiz-player__type-badge",style:{backgroundColor:fm[w.type]},children:[mm[w.type]," ",ao[w.type]]}),r.jsxs("span",{className:"quiz-player__points",children:[w.points," point",w.points>1?"s":""]})]}),r.jsx("div",{className:"quiz-player__enonce",dangerouslySetInnerHTML:{__html:w.enonce}}),r.jsxs("div",{className:"quiz-player__answer-area",children:[w.type==="qcm_unique"&&r.jsx(Z5,{question:w,reponse:d.get(w.id),onUpdate:D=>z(w.id,D),melangerOptions:e.melangerOptions}),w.type==="qcm_multiple"&&r.jsx(J5,{question:w,reponse:d.get(w.id),onUpdate:D=>z(w.id,D),melangerOptions:e.melangerOptions}),w.type==="drag_drop"&&r.jsx(eR,{question:w,reponse:d.get(w.id),onUpdate:D=>z(w.id,D)}),w.type==="mise_en_relation"&&r.jsx(tR,{question:w,reponse:d.get(w.id),onUpdate:D=>z(w.id,D)}),w.type==="essai"&&r.jsx(rR,{question:w,reponse:d.get(w.id),onUpdate:D=>z(w.id,D)})]})]}),r.jsxs("div",{className:"quiz-player__nav",children:[r.jsx("button",{className:"quiz-player__btn quiz-player__btn--secondary",onClick:()=>k(o-1),disabled:o===0,children:" Prcdent"}),r.jsx("div",{className:"quiz-player__pagination",children:l.map((D,L)=>r.jsx("button",{className:`quiz-player__page-dot ${L===o?"quiz-player__page-dot--current":""} ${d.has(D.id)?"quiz-player__page-dot--answered":""}`,onClick:()=>k(L),title:`Question ${L+1}`,children:L+1},D.id))}),o<l.length-1?r.jsx("button",{className:"quiz-player__btn quiz-player__btn--primary",onClick:()=>k(o+1),children:"Suivant "}):r.jsx("button",{className:"quiz-player__btn quiz-player__btn--submit",onClick:()=>S(!0),disabled:v,children:v?" Envoi...":" Soumettre le quiz"})]}),N&&r.jsx("div",{className:"quiz-player__modal-overlay",children:r.jsxs("div",{className:"quiz-player__modal",children:[r.jsx("h3",{children:"Soumettre le quiz ?"}),r.jsxs("p",{children:["Vous avez rpondu  ",r.jsx("strong",{children:P})," question",P>1?"s":""," sur"," ",r.jsx("strong",{children:l.length}),"."]}),P<l.length&&r.jsxs("p",{className:"quiz-player__modal-warning",children:[" ",l.length-P," question",l.length-P>1?"s":""," sans rponse !"]}),r.jsxs("div",{className:"quiz-player__modal-actions",children:[r.jsx("button",{className:"quiz-player__btn quiz-player__btn--secondary",onClick:()=>S(!1),children:"Continuer le quiz"}),r.jsx("button",{className:"quiz-player__btn quiz-player__btn--submit",onClick:O,children:"Confirmer la soumission"})]})]})})]})},Z5=({question:e,reponse:t,onUpdate:n,melangerOptions:a})=>{const l=e.typeData,o=g.useMemo(()=>a?[...l.options].sort(()=>Math.random()-.5):l.options,[l.options,a]);return r.jsx("div",{className:"player-qcm",children:o.map(u=>r.jsxs("label",{className:`player-qcm__option ${t?.selectedOptionId===u.id?"player-qcm__option--selected":""}`,children:[r.jsx("input",{type:"radio",name:`q_${e.id}`,checked:t?.selectedOptionId===u.id,onChange:()=>n({selectedOptionId:u.id})}),r.jsx("div",{className:"player-qcm__text",dangerouslySetInnerHTML:{__html:u.texte}})]},u.id))})},J5=({question:e,reponse:t,onUpdate:n,melangerOptions:a})=>{const l=e.typeData,o=g.useMemo(()=>a?[...l.options].sort(()=>Math.random()-.5):l.options,[l.options,a]),u=t?.selectedOptionIds||[],d=f=>{const p=u.includes(f)?u.filter(h=>h!==f):[...u,f];n({selectedOptionIds:p})};return r.jsxs("div",{className:"player-qcm",children:[r.jsx("p",{className:"player-qcm__hint",children:"Plusieurs rponses possibles"}),o.map(f=>r.jsxs("label",{className:`player-qcm__option ${u.includes(f.id)?"player-qcm__option--selected":""}`,children:[r.jsx("input",{type:"checkbox",checked:u.includes(f.id),onChange:()=>d(f.id)}),r.jsx("div",{className:"player-qcm__text",dangerouslySetInnerHTML:{__html:f.texte}})]},f.id))]})},eR=({question:e,reponse:t,onUpdate:n})=>{const a=e.typeData,[l,o]=g.useState(()=>t?.ordrePropose?t.ordrePropose.map(b=>a.items.find(x=>x.id===b)).filter(Boolean):[...a.items].sort(()=>Math.random()-.5)),[u,d]=g.useState(null);g.useEffect(()=>{n({ordrePropose:l.map(b=>b.id)})},[l]);const f=b=>{d(b)},p=(b,x)=>{if(b.preventDefault(),u===null||u===x)return;const j=[...l],[N]=j.splice(u,1);j.splice(x,0,N),o(j),d(x)},h=()=>{d(null)},v=(b,x)=>{const j=x==="up"?b-1:b+1;if(j<0||j>=l.length)return;const N=[...l];[N[b],N[j]]=[N[j],N[b]],o(N)};return r.jsxs("div",{className:"player-dragdrop",children:[r.jsx("p",{className:"player-dragdrop__consigne",children:a.consigneOrdre}),r.jsx("div",{className:"player-dragdrop__list",children:l.map((b,x)=>r.jsxs("div",{className:`player-dragdrop__item ${u===x?"player-dragdrop__item--dragging":""}`,draggable:!0,onDragStart:()=>f(x),onDragOver:j=>p(j,x),onDragEnd:h,children:[r.jsx("span",{className:"player-dragdrop__handle",children:""}),r.jsx("span",{className:"player-dragdrop__number",children:x+1}),r.jsx("div",{className:"player-dragdrop__text",dangerouslySetInnerHTML:{__html:b.texte}}),r.jsxs("div",{className:"player-dragdrop__mobile-btns",children:[r.jsx("button",{type:"button",onClick:()=>v(x,"up"),disabled:x===0,children:""}),r.jsx("button",{type:"button",onClick:()=>v(x,"down"),disabled:x===l.length-1,children:""})]})]},b.id))})]})},tR=({question:e,reponse:t,onUpdate:n})=>{const a=e.typeData,l=g.useMemo(()=>[...a.paires].sort(()=>Math.random()-.5),[a.paires]),[o,u]=g.useState(t?.relationsProposees||{}),[d,f]=g.useState(null);g.useEffect(()=>{n({relationsProposees:o})},[o]);const p=x=>{f(x)},h=x=>{d&&(u(j=>({...j,[d]:x})),f(null))},v=x=>{u(j=>{const N={...j};return delete N[x],N})},b=new Set(Object.values(o));return r.jsxs("div",{className:"player-relation",children:[r.jsx("p",{className:"player-relation__hint",children:"Cliquez sur un lment  gauche puis sur son correspondant  droite"}),r.jsxs("div",{className:"player-relation__columns",children:[r.jsxs("div",{className:"player-relation__col",children:[r.jsx("h4",{className:"player-relation__col-title",children:"Colonne A"}),a.paires.map(x=>r.jsxs("div",{className:`player-relation__item player-relation__item--left ${d===x.id?"player-relation__item--selected":""} ${o[x.id]?"player-relation__item--matched":""}`,onClick:()=>{o[x.id]?v(x.id):p(x.id)},children:[r.jsx("div",{dangerouslySetInnerHTML:{__html:x.gauche}}),o[x.id]&&r.jsx("span",{className:"player-relation__linked",children:""})]},x.id))]}),r.jsxs("div",{className:"player-relation__col",children:[r.jsx("h4",{className:"player-relation__col-title",children:"Colonne B"}),l.map(x=>r.jsxs("div",{className:`player-relation__item player-relation__item--right ${b.has(x.id)?"player-relation__item--matched":""} ${d&&!b.has(x.id)?"player-relation__item--clickable":""}`,onClick:()=>{d&&!b.has(x.id)&&h(x.id)},children:[r.jsx("div",{dangerouslySetInnerHTML:{__html:x.droite}}),b.has(x.id)&&r.jsx("span",{className:"player-relation__linked",children:""})]},x.id))]})]})]})},rR=({question:e,reponse:t,onUpdate:n})=>{const a=e.typeData,[l,o]=g.useState(t?.texteReponse||""),u=l.replace(/<[^>]*>/g,"").trim().split(/\s+/).filter(Boolean).length;return g.useEffect(()=>{n({texteReponse:l})},[l]),r.jsxs("div",{className:"player-essai",children:[r.jsxs("div",{className:"player-essai__info",children:[a.nombreMotsMin&&r.jsxs("span",{className:u<a.nombreMotsMin?"player-essai__warning":"",children:["Minimum : ",a.nombreMotsMin," mots"]}),a.nombreMotsMax&&r.jsxs("span",{className:u>a.nombreMotsMax?"player-essai__warning":"",children:["Maximum : ",a.nombreMotsMax," mots"]}),r.jsxs("span",{className:"player-essai__count",children:[u," mot",u>1?"s":""]})]}),r.jsx("textarea",{className:"player-essai__textarea",value:l,onChange:d=>o(d.target.value),placeholder:"Rdigez votre rponse ici...",rows:10})]})},nR=()=>{const{quizId:e}=Wn(),t=st(),{currentUser:n}=rt(),[a,l]=g.useState(null),[o,u]=g.useState(!0),[d,f]=g.useState(null);return g.useEffect(()=>{(async()=>{if(!e){f("ID du quiz manquant"),u(!1);return}try{const h=await jA(e);if(!h){f("Quiz introuvable");return}if(h.isPremium&&!n?.isPremium){f("Ce quiz est rserv aux abonns Premium");return}l(h)}catch(h){console.error("Erreur chargement quiz:",h),f(h.message||"Impossible de charger le quiz")}finally{u(!1)}})()},[e,n]),o?r.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[r.jsx("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:""}),r.jsx("p",{children:"Chargement du quiz..."})]}):d?r.jsx("div",{style:{textAlign:"center",padding:"3rem",maxWidth:"500px",margin:"2rem auto"},children:r.jsxs("div",{style:{padding:"2rem",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px"},children:[r.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:""}),r.jsx("p",{style:{color:"#991b1b",fontWeight:600,marginBottom:"1rem"},children:d}),d.includes("Premium")&&r.jsx("button",{onClick:()=>t("/premium"),style:{padding:"0.6rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",marginRight:"0.5rem",fontWeight:600},children:" Devenir Premium"}),r.jsx("button",{onClick:()=>t(-1),style:{padding:"0.6rem 1.5rem",background:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:" Retour"})]})}):a?r.jsx(X5,{quiz:a,userId:n?.uid||"",onComplete:p=>{console.log(" Quiz termin  Note:",p.note20,"/20")},onQuit:()=>t("/dashboard")}):r.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[r.jsx("p",{children:"Quiz introuvable"}),r.jsx("button",{onClick:()=>t(-1),children:" Retour"})]})},aR=e=>{if(!e?.length)return{label:"",color:"#9ca3af"};const t=e.map(a=>a.difficulte),n=t.reduce((a,l)=>a+(l==="facile"?1:l==="moyen"?2:3),0)/t.length;return n<1.5?{label:"Facile",color:"#059669"}:n<2.5?{label:"Moyen",color:"#d97706"}:{label:"Difficile",color:"#dc2626"}},iR=e=>e?.reduce((t,n)=>t+(n.points??0),0)??0,sR=()=>{const e=st(),{currentUser:t}=rt(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(""),[f,p]=g.useState("");g.useEffect(()=>{(async()=>{try{const b=await NA();a(b)}catch{d("Impossible de charger les quiz.")}finally{o(!1)}})()},[]);const h=n.filter(v=>v.titre.toLowerCase().includes(f.toLowerCase())||(v.description??"").toLowerCase().includes(f.toLowerCase()));return r.jsxs("div",{style:{maxWidth:1100,margin:"0 auto",padding:"2rem 1rem"},children:[r.jsxs("div",{style:{marginBottom:"2rem"},children:[r.jsx("h1",{style:{fontSize:"1.8rem",fontWeight:800,color:"#1f2937",margin:"0 0 0.4rem"},children:" Quiz disponibles"}),r.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem",margin:0},children:"Testez vos connaissances avec nos quiz interactifs"})]}),r.jsx("div",{style:{marginBottom:"1.5rem"},children:r.jsx("input",{type:"text",placeholder:"Rechercher un quiz...",value:f,onChange:v=>p(v.target.value),style:{width:"100%",maxWidth:400,padding:"0.6rem 1rem",border:"1.5px solid #e5e7eb",borderRadius:10,fontSize:"0.9rem",outline:"none",boxSizing:"border-box"}})}),l&&r.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"#6b7280"},children:[r.jsx("div",{style:{width:36,height:36,border:"3px solid #e5e7eb",borderTopColor:"#2563eb",borderRadius:"50%",animation:"spin 0.8s linear infinite",margin:"0 auto 1rem"}}),"Chargement des quiz..."]}),u&&r.jsxs("div",{style:{background:"#fee2e2",color:"#dc2626",padding:"0.9rem 1.2rem",borderRadius:10,marginBottom:"1.5rem"},children:[" ",u]}),!l&&!u&&h.length===0&&r.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"#9ca3af"},children:[r.jsx("div",{style:{fontSize:"3rem",marginBottom:"0.75rem",opacity:.4},children:""}),r.jsx("p",{style:{margin:0},children:f?"Aucun quiz ne correspond  votre recherche.":"Aucun quiz disponible pour le moment."})]}),!l&&!u&&h.length>0&&r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1.25rem"},children:h.map(v=>{const b=aR(v.questions),x=iR(v.questions),j=v.questions?.length??0,N=v.isPremium,S=!N||t?.isPremium;return r.jsxs("div",{onClick:()=>S&&e(`/quiz-avance/${v.id}`),style:{background:"white",borderRadius:14,boxShadow:"0 2px 10px rgba(0,0,0,0.08)",padding:"1.25rem",cursor:S?"pointer":"default",opacity:S?1:.65,transition:"transform 0.15s, box-shadow 0.15s",border:"1.5px solid #f3f4f6",display:"flex",flexDirection:"column",gap:"0.6rem",position:"relative"},onMouseEnter:C=>{S&&(C.currentTarget.style.transform="translateY(-3px)",C.currentTarget.style.boxShadow="0 6px 20px rgba(0,0,0,0.12)")},onMouseLeave:C=>{C.currentTarget.style.transform="",C.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.08)"},children:[N&&r.jsx("span",{style:{position:"absolute",top:12,right:12,background:"#fef3c7",color:"#d97706",fontSize:"0.7rem",fontWeight:700,padding:"0.15rem 0.5rem",borderRadius:20},children:" Premium"}),r.jsx("h3",{style:{fontSize:"1.05rem",fontWeight:700,color:"#1f2937",margin:0,lineHeight:1.3,paddingRight:N?"4rem":0},children:v.titre}),v.description&&r.jsx("p",{style:{fontSize:"0.82rem",color:"#6b7280",margin:0,lineHeight:1.5,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},dangerouslySetInnerHTML:{__html:v.description}}),r.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginTop:"0.25rem"},children:[r.jsxs("span",{style:{fontSize:"0.75rem",background:"#eff6ff",color:"#2563eb",padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:600},children:[" ",j," question",j>1?"s":""]}),r.jsxs("span",{style:{fontSize:"0.75rem",background:"#f3f4f6",color:"#374151",padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:600},children:[" ",v.duree," min"]}),x>0&&r.jsxs("span",{style:{fontSize:"0.75rem",background:"#f0fdf4",color:"#059669",padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:600},children:[" ",x," pts"]}),r.jsx("span",{style:{fontSize:"0.75rem",background:"#fafafa",color:b.color,padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:700,border:`1px solid ${b.color}30`},children:b.label})]}),r.jsx("button",{disabled:!S,onClick:C=>{C.stopPropagation(),S&&e(`/quiz-avance/${v.id}`)},style:{marginTop:"auto",padding:"0.55rem 1rem",background:S?"#2563eb":"#e5e7eb",color:S?"white":"#9ca3af",border:"none",borderRadius:8,fontWeight:600,fontSize:"0.85rem",cursor:S?"pointer":"not-allowed",transition:"background 0.15s"},children:S?" Commencer le quiz":" Premium requis"})]},v.id)})}),!l&&h.length>0&&r.jsxs("p",{style:{textAlign:"center",color:"#9ca3af",fontSize:"0.8rem",marginTop:"2rem"},children:[h.length," quiz",(h.length>1,"")," disponible",h.length>1?"s":""]})]})},lR="quizzes",oR="quizzes_v2",R1=50;function cR(e){const t=e.data();return{id:e.id,titre:t.titre||"Quiz sans titre",description:t.description||"",matiere:t.matiere||t.disciplineId||"",niveau:t.niveau||"",classe:t.classe||"",nombreQuestions:Array.isArray(t.questions)?t.questions.length:0,duree:t.duree||void 0,difficulte:t.difficulte||"moyen",source:"quizzes",isPremium:!1,createdAt:t.createdAt||void 0}}function uR(e){const t=e.data();return{id:e.id,titre:t.titre||"Quiz sans titre",description:t.description||"",matiere:t.matiere||"",niveau:t.niveau||"",classe:t.classe||"",nombreQuestions:Array.isArray(t.questions)?t.questions.length:0,duree:t.dureeEstimee||void 0,difficulte:t.difficulte||"moyen",source:"quizzes_v2",isPremium:!1,createdAt:t.createdAt||void 0}}async function _A(){const[e,t]=await Promise.all([ze(ke(_e(X,lR),Se("isPremium","==",!1),Ke("createdAt","desc"),Cr(R1))),ze(ke(_e(X,oR),Se("isPremium","==",!1),Ke("createdAt","desc"),Cr(R1)))]),n=e.docs.map(cR),a=t.docs.map(uR);return[...n,...a].sort((l,o)=>{const u=l.createdAt?.toMillis()??0;return(o.createdAt?.toMillis()??0)-u})}async function dR(){return(await _A()).slice(0,3)}const mR={"6eme":1,"6me":1,"5eme":2,"5me":2,"4eme":3,"4me":3,"3eme":4,"3me":4,"2nde":5,seconde:5,"1ere":6,"1re":6,terminale:7};function I1(e){const t=e.toLowerCase().trim();return mR[t]??99}function fo(){const[e,t]=g.useState([]),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null);return g.useEffect(()=>{let f=!1;async function p(){o(!0),d(null);try{const h=ke(_e(X,"disciplines"),Ke("ordre")),v=await ze(h);if(f)return;const b=new Set,x=new Set;v.forEach(S=>{const C=S.data();C.nom&&typeof C.nom=="string"&&b.add(C.nom.trim()),C.classe&&typeof C.classe=="string"&&x.add(C.classe.trim())});const j=Array.from(b).sort((S,C)=>S.localeCompare(C,"fr")).map(S=>({valeur:S,label:S})),N=Array.from(x).sort((S,C)=>{const E=I1(S),w=I1(C);return E!==w?E-w:S.localeCompare(C,"fr")}).map(S=>({valeur:S,label:S}));t(j),a(N)}catch(h){f||(console.error("[useDisciplinesOptions] Erreur Firestore :",h),d("Impossible de charger les matires/niveaux."))}finally{f||o(!1)}}return p(),()=>{f=!0}},[]),{matieres:e,niveaux:n,loading:l,error:u}}const fR={facile:{label:"Facile",color:"#059669",bg:"#d1fae5"},moyen:{label:"Moyen",color:"#d97706",bg:"#fef3c7"},difficile:{label:"Difficile",color:"#dc2626",bg:"#fee2e2"}},pR=({quiz:e,onJouer:t,estConnecte:n})=>{const a=fR[e.difficulte??"moyen"];return r.jsxs("div",{className:"qg-card",onClick:()=>t(e),children:[r.jsxs("div",{className:"qg-card__header",children:[r.jsx("span",{className:`qg-card__source qg-card__source--${e.source}`,children:e.source==="quizzes_v2"?" Quiz avanc":" Quiz"}),r.jsx("span",{className:"qg-card__difficulte",style:{color:a.color,background:a.bg},children:a.label})]}),r.jsx("h3",{className:"qg-card__titre",children:e.titre}),e.description&&r.jsx("p",{className:"qg-card__description",children:e.description}),r.jsxs("div",{className:"qg-card__meta",children:[e.matiere&&r.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.matiere]}),e.classe&&r.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.classe]}),r.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.nombreQuestions," question",e.nombreQuestions>1?"s":""]}),e.duree&&r.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.duree," min"]})]}),r.jsx("button",{className:"qg-card__btn",children:n?" Commencer":" Aperu"})]})},hR=()=>r.jsxs("div",{className:"qg-banniere qg-banniere--inscription",children:[r.jsx("div",{className:"qg-banniere__icone",children:""}),r.jsxs("div",{className:"qg-banniere__texte",children:[r.jsx("h3",{children:"Connectez-vous pour accder  tous les quiz gratuits"}),r.jsx("p",{children:"Crez un compte gratuitement et commencez  vous entraner ds maintenant."})]}),r.jsxs("div",{className:"qg-banniere__actions",children:[r.jsx(Ge,{to:"/inscription",className:"btn btn-primary",children:"Crer un compte gratuit"}),r.jsx(Ge,{to:"/connexion",className:"btn btn-secondary",children:"Se connecter"})]})]}),vR=()=>r.jsxs("div",{className:"qg-banniere qg-banniere--premium",children:[r.jsx("div",{className:"qg-banniere__icone",children:""}),r.jsxs("div",{className:"qg-banniere__texte",children:[r.jsx("h3",{children:"Dbloquez les Quiz Avancs Premium"}),r.jsx("p",{children:"Accdez  des centaines de quiz avancs avec corrections dtailles, suivi de progression et bien plus encore."}),r.jsxs("p",{className:"qg-banniere__prix",children:[r.jsx("strong",{children:"2 000 FCFA/mois"}),"  ",r.jsx("strong",{children:"20 000 FCFA/an"})]})]}),r.jsx(Ge,{to:"/premium",className:"btn btn-premium",children:" Devenir Premium"})]}),gR=()=>{const e=st(),{currentUser:t}=rt(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(""),[f,p]=g.useState(""),[h,v]=g.useState(""),[b,x]=g.useState(""),{matieres:j}=fo(),N=!!t,S=t?.isPremium??!1,C=t?.role==="prof"||t?.role==="admin";g.useEffect(()=>{(async()=>{o(!0),d("");try{const k=N?await _A():await dR();a(k)}catch(k){console.error("Erreur chargement quiz gratuits:",k),d("Impossible de charger les quiz. Veuillez ressayer.")}finally{o(!1)}})()},[N]);const E=n.filter(z=>{const k=!b||z.titre.toLowerCase().includes(b.toLowerCase())||z.matiere.toLowerCase().includes(b.toLowerCase()),O=!f||z.matiere.toLowerCase().includes(f.toLowerCase()),P=!h||(z.niveau??"").toLowerCase().includes(h.toLowerCase())||(z.classe??"").toLowerCase().includes(h.toLowerCase());return k&&O&&P}),w=z=>{if(!N){e("/connexion");return}z.source==="quizzes_v2"?e(`/quiz-avance/${z.id}`):e(`/quiz/${z.id}`)};return r.jsxs("div",{className:"qg-page",children:[r.jsxs("div",{className:"qg-hero",children:[r.jsxs("div",{className:"qg-hero__content",children:[r.jsx("h1",{className:"qg-hero__titre",children:" Quiz Gratuits"}),r.jsx("p",{className:"qg-hero__sous-titre",children:"Entranez-vous gratuitement avec nos quiz de rvision pour tous les niveaux du collge au lyce."}),r.jsxs("div",{className:"qg-hero__stats",children:[r.jsxs("span",{className:"qg-hero__stat",children:[r.jsx("strong",{children:n.length}),N?" quiz disponibles":"+ quiz"]}),r.jsxs("span",{className:"qg-hero__stat",children:[r.jsx("strong",{children:"100%"})," gratuit"]}),r.jsxs("span",{className:"qg-hero__stat",children:[r.jsx("strong",{children:"6me"}),"  ",r.jsx("strong",{children:"Terminale"})]})]})]}),(S||C)&&r.jsx(Ge,{to:"/quizzes",className:"qg-hero__lien-premium",children:" Voir les Quiz Premium "})]}),r.jsxs("div",{className:"qg-filtres",children:[r.jsx("div",{className:"qg-filtres__recherche",children:r.jsx("input",{type:"text",placeholder:" Rechercher un quiz...",value:b,onChange:z=>x(z.target.value),className:"qg-filtres__input"})}),r.jsxs("select",{value:f,onChange:z=>p(z.target.value),className:"qg-filtres__select",children:[r.jsx("option",{value:"",children:"Toutes les matires"}),j.map(z=>r.jsx("option",{value:z.valeur,children:z.label},z.valeur))]}),(f||h||b)&&r.jsx("button",{className:"qg-filtres__reset",onClick:()=>{p(""),v(""),x("")},children:" Rinitialiser"})]}),r.jsxs("div",{className:"qg-contenu",children:[l&&r.jsxs("div",{className:"qg-loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement des quiz..."})]}),!l&&u&&r.jsxs("div",{className:"qg-erreur",children:[r.jsxs("p",{children:[" ",u]}),r.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-secondary",children:"Ressayer"})]}),!l&&!u&&r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"qg-compteur",children:[E.length," quiz",E.length>1?"s":"",f?` en ${f}`:"",N?"":" (aperu  connectez-vous pour tout voir)"]}),E.length>0?r.jsx("div",{className:"qg-grille",children:E.map(z=>r.jsx(pR,{quiz:z,onJouer:w,estConnecte:N},`${z.source}-${z.id}`))}):r.jsxs("div",{className:"qg-vide",children:[r.jsx("p",{children:" Aucun quiz trouv pour ces critres."}),r.jsx("button",{onClick:()=>{p(""),x("")},className:"btn btn-secondary",children:"Voir tous les quiz"})]}),!N&&r.jsx(hR,{}),N&&!S&&!C&&r.jsx(vR,{})]})]})]})},SA=_e(X,"quiz_results"),qb=_e(X,"progressions"),xR=async e=>{try{const t=await Tt(SA,{...e,datePassage:Oe.now()});return e.reussi&&await SR(e.userId,e.disciplineId,e.disciplineNom,e.quizId),t.id}catch(t){throw console.error("Erreur lors de la sauvegarde du rsultat :",t),t}},vf=async(e,t)=>{try{let n=ke(SA,Se("userId","==",e),Ke("datePassage","desc"));return t&&(n=ke(n,Cr(t))),(await ze(n)).docs.map(l=>({id:l.id,...l.data()}))}catch(n){throw console.error("Erreur rcupration historique :",n),n}},bR=async e=>{try{const t=await vf(e);if(t.length===0)return{totalQuizPasses:0,totalQuizReussis:0,moyenneGenerale:0,tempsTotal:0,meilleurScore:0,serieReussites:0,meilleureSerieReussites:0};const n=t.reduce((h,v)=>h+v.pourcentage,0),a=Math.round(n/t.length),l=Math.max(...t.map(h=>h.pourcentage)),o=t.reduce((h,v)=>h+(v.tempsEcoule||0),0),u=t.filter(h=>h.reussi).length;let d=0,f=0;for(const h of t)h.reussi?(d++,f=Math.max(f,d)):d=0;let p=0;for(const h of t)if(h.reussi)p++;else break;return{totalQuizPasses:t.length,totalQuizReussis:u,moyenneGenerale:a,tempsTotal:o,meilleurScore:l,serieReussites:p,meilleureSerieReussites:Math.max(f,p)}}catch(t){return console.error("Erreur calcul stats :",t),{totalQuizPasses:0,totalQuizReussis:0,moyenneGenerale:0,tempsTotal:0,meilleurScore:0,serieReussites:0,meilleureSerieReussites:0}}},yR=async e=>{try{const t=await vf(e);if(t.length===0)return[];const n={};for(const a of t){const l=a.disciplineId;n[l]||(n[l]=[]),n[l].push(a)}return Object.entries(n).map(([a,l])=>{const o=Math.round(l.reduce((v,b)=>v+b.pourcentage,0)/l.length),u=Math.max(...l.map(v=>v.pourcentage)),d=l[0].pourcentage,f=l.filter(v=>v.reussi).length,p=l.reduce((v,b)=>v+(b.tempsEcoule||0),0);let h="stable";if(l.length>=4){const v=l.slice(0,3),b=l.slice(3,6),x=v.reduce((N,S)=>N+S.pourcentage,0)/v.length,j=b.reduce((N,S)=>N+S.pourcentage,0)/b.length;x-j>5?h="up":j-x>5&&(h="down")}return{disciplineId:a,disciplineNom:l[0].disciplineNom||a,nombreQuiz:l.length,moyenne:o,meilleurScore:u,dernierScore:d,quizReussis:f,tempsTotal:p,tendance:h}})}catch(t){return console.error("Erreur progression par discipline :",t),[]}},jR=async(e,t)=>{try{return(await vf(e,t||20)).reverse().map(a=>({date:(a.datePassage?.toDate?a.datePassage.toDate():new Date(a.datePassage)).toLocaleDateString("fr-SN",{day:"2-digit",month:"2-digit"}),score:a.pourcentage,discipline:a.disciplineNom||a.disciplineId}))}catch(n){return console.error("Erreur donnes temporelles :",n),[]}},NR=async(e,t,n)=>{const a=`${e}_${t}`,l=Ne(qb,a),o=await Ot(l);if(o.exists())return{...o.data()};const[u,d]=await Promise.all([L1("ressources",t),L1("quizzes",t)]),f={userId:e,disciplineId:t,disciplineNom:n,ressourcesVues:[],quizReussis:[],totalRessources:u,totalQuiz:d,pourcentage:0,dernierAcces:Oe.now(),createdAt:Oe.now(),updatedAt:Oe.now()};return await pf(l,f),f},L1=async(e,t)=>{try{const n=ke(_e(X,e),Se("disciplineId","==",t));return(await ze(n)).size}catch{return 0}},_R=e=>{if(e.totalRessources+e.totalQuiz===0)return 0;const n=e.totalRessources>0?e.ressourcesVues.length/e.totalRessources*40:0,a=e.totalQuiz>0?e.quizReussis.length/e.totalQuiz*60:0;return e.totalRessources===0?Math.min(100,Math.round(e.quizReussis.length/e.totalQuiz*100)):e.totalQuiz===0?Math.min(100,Math.round(e.ressourcesVues.length/e.totalRessources*100)):Math.min(100,Math.round(n+a))},SR=async(e,t,n,a)=>{try{const l=`${e}_${t}`,o=Ne(qb,l),u=await NR(e,t,n);if(u.quizReussis.includes(a))return await Qe(o,{dernierAcces:Oe.now()}),u;const d=[...u.quizReussis,a],f={...u,quizReussis:d,dernierAcces:Oe.now(),updatedAt:Oe.now(),pourcentage:0};return f.pourcentage=_R(f),await pf(o,f),f}catch(l){throw console.error("Erreur enregistrement quiz russi :",l),l}},wR=async e=>{try{const t=ke(qb,Se("userId","==",e));return(await ze(t)).docs.map(a=>a.data())}catch(t){return console.error("Erreur rcupration progressions :",t),[]}},CR=async e=>{try{const t=await wR(e),n=await wA(e),a=t.reduce((d,f)=>d+f.ressourcesVues.length,0),l=t.reduce((d,f)=>d+f.quizReussis.length,0),o=t.length>0?Math.round(t.reduce((d,f)=>d+f.pourcentage,0)/t.length):0,u=t.filter(d=>d.pourcentage>=100).length;return{totalRessourcesVues:a,totalQuizReussis:l,pourcentageMoyen:o,disciplinesCommencees:t.length,disciplinesCompletees:u,streakActuel:n.streakActuel,meilleurStreak:n.meilleurStreak,parDiscipline:t}}catch(t){return console.error("Erreur progression globale :",t),{totalRessourcesVues:0,totalQuizReussis:0,pourcentageMoyen:0,disciplinesCommencees:0,disciplinesCompletees:0,streakActuel:0,meilleurStreak:0,parDiscipline:[]}}},ER=()=>new Date().toISOString().split("T")[0],AR=()=>{const e=new Date;return e.setDate(e.getDate()-1),e.toISOString().split("T")[0]},wA=async e=>{try{const t=Ne(X,"users",e),n=await Ot(t);if(!n.exists())return{streakActuel:0,meilleurStreak:0,dernierJourAcces:""};const a=n.data();return{streakActuel:a.streakActuel||0,meilleurStreak:a.meilleurStreak||0,dernierJourAcces:a.dernierJourAcces||""}}catch(t){return console.error("Erreur rcupration streak :",t),{streakActuel:0,meilleurStreak:0,dernierJourAcces:""}}},zR=async e=>{try{const t=Ne(X,"users",e),n=await wA(e),a=ER();if(n.dernierJourAcces===a)return n;const l=AR();let o;n.dernierJourAcces===l?o=n.streakActuel+1:o=1;const u=Math.max(n.meilleurStreak,o);return await Qe(t,{streakActuel:o,meilleurStreak:u,dernierJourAcces:a}),{streakActuel:o,meilleurStreak:u,dernierJourAcces:a}}catch(t){return console.error("Erreur mise  jour streak :",t),{streakActuel:0,meilleurStreak:0,dernierJourAcces:""}}},OR=(e,t,n)=>{const a=n?.totalRessourcesVues||0;n?.totalQuizReussis;const l=n?.disciplinesCompletees||0;n?.streakActuel;const o=n?.meilleurStreak||0,u=n?.disciplinesCommencees||0;return[{id:"premier_pas",nom:"Premier pas ",description:"Consulter votre premire ressource",icone:"",condition:"1 ressource consulte",categorie:"ressources",obtenu:a>=1},{id:"lecteur_assidu",nom:"Lecteur assidu ",description:"Consulter 10 ressources",icone:"",condition:"10 ressources consultes",categorie:"ressources",obtenu:a>=10},{id:"bibliophile",nom:"Bibliophile ",description:"Consulter 25 ressources",icone:"",condition:"25 ressources consultes",categorie:"ressources",obtenu:a>=25},{id:"savant",nom:"Savant ",description:"Consulter 50 ressources",icone:"",condition:"50 ressources consultes",categorie:"ressources",obtenu:a>=50},{id:"premier_quiz",nom:"Apprenti ",description:"Passer votre premier quiz",icone:"",condition:"1 quiz pass",categorie:"quiz",obtenu:e.totalQuizPasses>=1},{id:"challenger",nom:"Challenger ",description:"Russir 5 quiz",icone:"",condition:"5 quiz russis",categorie:"quiz",obtenu:e.totalQuizReussis>=5},{id:"dix_quiz",nom:"Dcathlon ",description:"Passer 10 quiz",icone:"",condition:"10 quiz passs",categorie:"quiz",obtenu:e.totalQuizPasses>=10},{id:"cinquante_quiz",nom:"Marathonien ",description:"Passer 50 quiz",icone:"",condition:"50 quiz passs",categorie:"quiz",obtenu:e.totalQuizPasses>=50},{id:"score_parfait",nom:"Score parfait ",description:"Obtenir 100%  un quiz",icone:"",condition:"100%  un quiz",categorie:"performance",obtenu:e.meilleurScore>=100},{id:"moyenne_80",nom:"Excellent ",description:"Moyenne gnrale de 80%+",icone:"",condition:"Moyenne  80% (min. 5 quiz)",categorie:"performance",obtenu:e.moyenneGenerale>=80&&e.totalQuizPasses>=5},{id:"serie_5",nom:"Imbattable ",description:"5 quiz russis d'affile",icone:"",condition:"Srie de 5 russites",categorie:"performance",obtenu:e.meilleureSerieReussites>=5},{id:"serie_10",nom:"Lgende ",description:"10 quiz russis d'affile",icone:"",condition:"Srie de 10 russites",categorie:"performance",obtenu:e.meilleureSerieReussites>=10},{id:"maitre",nom:"Matre ",description:"Complter 100% d'une discipline",icone:"",condition:"1 discipline  100%",categorie:"discipline",obtenu:l>=1},{id:"explorateur_teranga",nom:"Explorateur Teranga ",description:"Commencer 3 disciplines diffrentes",icone:"",condition:"3 disciplines commences",categorie:"discipline",obtenu:u>=3||t.length>=3},{id:"touche_a_tout",nom:"Touche--tout ",description:"Commencer 5 disciplines diffrentes",icone:"",condition:"5 disciplines commences",categorie:"discipline",obtenu:u>=5||t.length>=5},{id:"en_feu_3",nom:"Rgulier ",description:"3 jours de connexion conscutifs",icone:"",condition:"3 jours conscutifs",categorie:"streak",obtenu:o>=3},{id:"en_feu_7",nom:"En feu ",description:"7 jours de connexion conscutifs",icone:"",condition:"7 jours conscutifs",categorie:"streak",obtenu:o>=7},{id:"en_feu_30",nom:"Infatigable ",description:"30 jours de connexion conscutifs",icone:"",condition:"30 jours conscutifs",categorie:"streak",obtenu:o>=30},{id:"diamant",nom:"Diamant ",description:"50 ressources + 20 quiz russis",icone:"",condition:"50 ressources + 20 quiz",categorie:"performance",obtenu:a>=50&&e.totalQuizReussis>=20}]},CA=e=>{if(e<60)return`${e} s`;const t=Math.floor(e/60),n=e%60;return n>0?`${t} min ${n.toString().padStart(2,"0")} s`:`${t} min`},Yl=e=>e>=80?"#10b981":e>=60?"#3b82f6":e>=40?"#f59e0b":"#ef4444",EA=e=>e>=80?"Excellent":e>=60?"Bien":e>=40?"Passable":" amliorer",kR=()=>{const{quizId:e}=Wn(),t=st(),{currentUser:n}=rt(),[a,l]=g.useState(null),[o,u]=g.useState(""),[d,f]=g.useState(!0),[p,h]=g.useState(null),[v,b]=g.useState("intro"),[x,j]=g.useState(0),[N,S]=g.useState({}),[C,E]=g.useState(0),[w,z]=g.useState(0),k=g.useRef(null),[O,P]=g.useState(0),[D,L]=g.useState(0),[U,$]=g.useState(0),[B,re]=g.useState(!1),[se,M]=g.useState(!1);g.useEffect(()=>{(async()=>{if(!e){h("ID du quiz manquant."),f(!1);return}try{const Q=await p5(e);if(!Q){h("Quiz introuvable."),f(!1);return}l(Q),E(Q.duree*60);try{const Me=(await Ki.getAll()).find(ce=>ce.id===Q.disciplineId);u(Me?.nom||Q.disciplineId)}catch{u(Q.disciplineId)}}catch(Q){h("Erreur lors du chargement du quiz."),console.error(Q)}finally{f(!1)}})()},[e]),g.useEffect(()=>{if(v==="playing")return k.current=setInterval(()=>{E(ge=>ge<=1?(clearInterval(k.current),K(),0):ge-1),z(ge=>ge+1)},1e3),()=>{k.current&&clearInterval(k.current)}},[v]);const q=()=>{b("playing"),j(0),S({}),z(0),a&&E(a.duree*60)},F=(ge,Q)=>{S(ve=>({...ve,[ge]:Q}))},R=ge=>{a&&ge>=0&&ge<a.questions.length&&j(ge)},K=g.useCallback(async()=>{if(!a||!n||v==="review")return;k.current&&clearInterval(k.current);let ge=0,Q=0,ve=0;a.questions.forEach(Z=>{const H=Z.points||1;Q+=H,N[Z.id]===Z.reponseCorrecte&&(ge+=H,ve++)});const Me=Q>0?Math.round(ge/Q*100):0,ce=Me>=(a.noteMinimale||50);P(ge),L(Q),$(ve),b("review"),re(!0);try{const Z={quizId:a.id,quizTitre:a.titre,disciplineId:a.disciplineId,disciplineNom:o,userId:n.uid,reponses:a.questions.map(H=>N[H.id]??-1),tempsEcoule:w,score:ge,totalPoints:Q,pourcentage:Me,reussi:ce,nombreQuestions:a.questions.length,bonnesReponses:ve};await xR(Z),M(!0)}catch(Z){console.error("Erreur lors de la sauvegarde :",Z)}finally{re(!1)}},[a,n,N,w,o,v]),I=ge=>{const Q=Math.floor(ge/60),ve=ge%60;return`${Q.toString().padStart(2,"0")}:${ve.toString().padStart(2,"0")}`},te=()=>{if(!a)return"";const ge=a.duree*60,Q=C/ge;return Q<=.1?"timer-critical":Q<=.25?"timer-warning":""},Y=Object.keys(N).length;if(d)return r.jsxs("div",{className:"quiz-player-loading",children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement du quiz..."})]});if(p||!a)return r.jsxs("div",{className:"quiz-player-error",children:[r.jsx(um,{size:48}),r.jsx("h3",{children:p||"Quiz introuvable"}),r.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>t("/eleve/dashboard"),children:[r.jsx(bx,{size:18})," Retour au tableau de bord"]})]});if(a.isPremium&&!n?.isPremium)return r.jsx("div",{className:"quiz-player-locked",children:r.jsxs("div",{className:"qp-locked-card",children:[r.jsx(jx,{size:48}),r.jsx("h3",{children:"Quiz Premium"}),r.jsx("p",{children:"Ce quiz est rserv aux abonns Premium."}),r.jsxs("p",{className:"qp-locked-price",children:[" partir de ",r.jsx("strong",{children:"2 000 FCFA/mois"})]}),r.jsxs("div",{className:"qp-locked-actions",children:[r.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>t("/premium"),children:[r.jsx(Wr,{size:18})," Devenir Premium"]}),r.jsxs("button",{className:"qp-btn qp-btn-outline",onClick:()=>t("/eleve/dashboard"),children:[r.jsx(Cv,{size:18})," Retour"]})]})]})});if(v==="intro")return r.jsx("div",{className:"quiz-player-intro",children:r.jsxs("div",{className:"qp-intro-card",children:[r.jsxs("div",{className:"qp-intro-header",children:[r.jsxs("button",{className:"qp-back-btn",onClick:()=>t(-1),children:[r.jsx(Cv,{size:20})," Retour"]}),a.isPremium&&r.jsxs("span",{className:"qp-badge qp-badge-premium",children:[r.jsx(Wr,{size:12})," Premium"]})]}),r.jsxs("div",{className:"qp-intro-content",children:[r.jsx("h1",{className:"qp-intro-title",children:a.titre}),r.jsx("span",{className:"qp-intro-discipline",children:o}),r.jsxs("div",{className:"qp-intro-stats",children:[r.jsxs("div",{className:"qp-intro-stat",children:[r.jsx(vn,{size:20}),r.jsxs("div",{children:[r.jsx("span",{className:"qp-intro-stat-value",children:a.questions.length}),r.jsx("span",{className:"qp-intro-stat-label",children:"Questions"})]})]}),r.jsxs("div",{className:"qp-intro-stat",children:[r.jsx(no,{size:20}),r.jsxs("div",{children:[r.jsxs("span",{className:"qp-intro-stat-value",children:[a.duree," min"]}),r.jsx("span",{className:"qp-intro-stat-label",children:"Dure"})]})]}),r.jsxs("div",{className:"qp-intro-stat",children:[r.jsx(Qi,{size:20}),r.jsxs("div",{children:[r.jsxs("span",{className:"qp-intro-stat-value",children:[a.noteMinimale||50,"%"]}),r.jsx("span",{className:"qp-intro-stat-label",children:"Note min."})]})]})]}),r.jsxs("div",{className:"qp-intro-instructions",children:[r.jsx("h3",{children:"Instructions"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Rpondez  toutes les questions dans le temps imparti"}),r.jsx("li",{children:"Chaque question a une seule bonne rponse"}),r.jsx("li",{children:"Vous pouvez naviguer entre les questions"}),r.jsx("li",{children:"Le quiz est soumis automatiquement quand le temps est coul"}),r.jsxs("li",{children:["Il faut obtenir au moins ",a.noteMinimale||50,"% pour russir"]})]})]})]}),r.jsxs("button",{className:"qp-btn qp-btn-start",onClick:q,children:[r.jsx(Wl,{size:20})," Commencer le quiz"]})]})});if(v==="playing"){const ge=a.questions[x];return r.jsxs("div",{className:"quiz-player-game",children:[r.jsxs("div",{className:"qp-game-header",children:[r.jsxs("div",{className:"qp-game-info",children:[r.jsx("span",{className:"qp-game-title",children:a.titre}),r.jsx("span",{className:"qp-game-discipline",children:o})]}),r.jsxs("div",{className:`qp-timer ${te()}`,children:[r.jsx(d3,{size:18}),r.jsx("span",{children:I(C)})]})]}),r.jsx("div",{className:"qp-progress-bar",children:r.jsx("div",{className:"qp-progress-fill",style:{width:`${(x+1)/a.questions.length*100}%`}})}),r.jsxs("div",{className:"qp-game-content",children:[r.jsxs("div",{className:"qp-question-header",children:[r.jsxs("span",{className:"qp-question-number",children:["Question ",x+1,"/",a.questions.length]}),r.jsxs("span",{className:"qp-question-points",children:[ge.points||1," pt(s)"]})]}),r.jsx("h2",{className:"qp-question-text",children:ge.question}),r.jsx("div",{className:"qp-options-list",children:ge.options.map((Q,ve)=>r.jsxs("button",{className:`qp-option ${N[ge.id]===ve?"selected":""}`,onClick:()=>F(ge.id,ve),children:[r.jsx("span",{className:"qp-option-letter",children:String.fromCharCode(65+ve)}),r.jsx("span",{className:"qp-option-text",children:Q}),N[ge.id]===ve&&r.jsx(Bt,{size:18,className:"qp-option-check"})]},ve))})]}),r.jsxs("div",{className:"qp-game-footer",children:[r.jsx("div",{className:"qp-question-indicators",children:a.questions.map((Q,ve)=>r.jsx("button",{className:`qp-indicator ${ve===x?"active":""} ${N[Q.id]!==void 0?"answered":""}`,onClick:()=>R(ve),children:ve+1},Q.id))}),r.jsxs("div",{className:"qp-nav-buttons",children:[r.jsxs("button",{className:"qp-btn qp-btn-outline",onClick:()=>R(x-1),disabled:x===0,children:[r.jsx(Cv,{size:16})," Prcdent"]}),x<a.questions.length-1?r.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>R(x+1),children:["Suivant ",r.jsx(js,{size:16})]}):r.jsxs("button",{className:"qp-btn qp-btn-submit",onClick:K,disabled:Y<a.questions.length,children:[r.jsx(Bt,{size:16}),"Soumettre (",Y,"/",a.questions.length,")"]})]})]})]})}const oe=D>0?Math.round(O/D*100):0,he=oe>=(a.noteMinimale||50);return r.jsxs("div",{className:"quiz-player-review",children:[r.jsxs("div",{className:`qp-score-card ${he?"success":"fail"}`,children:[r.jsx("div",{className:"qp-score-icon",children:he?r.jsx(Qi,{size:48}):r.jsx(um,{size:48})}),r.jsx("h2",{className:"qp-score-title",children:he?"Flicitations ! ":"Continuez vos efforts ! "}),r.jsxs("div",{className:"qp-score-circle",style:{borderColor:Yl(oe)},children:[r.jsxs("span",{className:"qp-score-value",children:[oe,"%"]}),r.jsx("span",{className:"qp-score-label",children:EA(oe)})]}),r.jsxs("div",{className:"qp-score-details",children:[r.jsxs("div",{className:"qp-score-detail",children:[r.jsxs("span",{children:[U,"/",a.questions.length]}),r.jsx("small",{children:"Bonnes rponses"})]}),r.jsxs("div",{className:"qp-score-detail",children:[r.jsxs("span",{children:[O,"/",D]}),r.jsx("small",{children:"Points"})]}),r.jsxs("div",{className:"qp-score-detail",children:[r.jsx("span",{children:CA(w)}),r.jsx("small",{children:"Temps"})]})]}),B&&r.jsx("p",{className:"qp-saving",children:"Sauvegarde en cours..."}),se&&r.jsx("p",{className:"qp-saved",children:" Rsultat sauvegard"})]}),r.jsxs("div",{className:"qp-review-actions",children:[r.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>t("/eleve/dashboard"),children:[r.jsx(bx,{size:18})," Tableau de bord"]}),r.jsxs("button",{className:"qp-btn qp-btn-outline",onClick:q,children:[r.jsx(m3,{size:18})," Recommencer"]})]}),r.jsxs("div",{className:"qp-review-questions",children:[r.jsx("h3",{className:"qp-review-title",children:"Correction dtaille"}),a.questions.map((ge,Q)=>{const ve=N[ge.id],Me=ve===ge.reponseCorrecte;return r.jsxs("div",{className:`qp-review-question ${Me?"correct":"incorrect"}`,children:[r.jsxs("div",{className:"qp-review-question-header",children:[r.jsxs("span",{className:"qp-review-q-number",children:["Q",Q+1]}),Me?r.jsxs("span",{className:"qp-review-badge correct",children:[r.jsx(Bt,{size:14})," Correct"]}):r.jsxs("span",{className:"qp-review-badge incorrect",children:[r.jsx(Nx,{size:14})," Incorrect"]}),r.jsxs("span",{className:"qp-review-q-points",children:[Me?ge.points||1:0,"/",ge.points||1," pt(s)"]})]}),r.jsx("p",{className:"qp-review-q-text",children:ge.question}),r.jsx("div",{className:"qp-review-options",children:ge.options.map((ce,Z)=>{let H="qp-review-option";return Z===ge.reponseCorrecte&&(H+=" correct-answer"),Z===ve&&!Me&&(H+=" wrong-answer"),r.jsxs("div",{className:H,children:[r.jsx("span",{className:"qp-review-option-letter",children:String.fromCharCode(65+Z)}),r.jsx("span",{children:ce}),Z===ge.reponseCorrecte&&r.jsx(Bt,{size:14,className:"qp-review-check"}),Z===ve&&!Me&&r.jsx(Nx,{size:14,className:"qp-review-x"})]},Z)})}),ge.explication&&r.jsxs("div",{className:"qp-review-explication",children:[r.jsx("strong",{children:" Explication :"})," ",ge.explication]})]},ge.id)})]})]})};function AA(e){var t,n,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var l=e.length;for(t=0;t<l;t++)e[t]&&(n=AA(e[t]))&&(a&&(a+=" "),a+=n)}else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}function Nt(){for(var e,t,n=0,a="",l=arguments.length;n<l;n++)(e=arguments[n])&&(t=AA(e))&&(a&&(a+=" "),a+=t);return a}var DR=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Rb(e){if(typeof e!="string")return!1;var t=DR;return t.includes(e)}var MR=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],PR=new Set(MR);function zA(e){return typeof e!="string"?!1:PR.has(e)}function OA(e){return typeof e=="string"&&e.startsWith("data-")}function Vn(e){if(typeof e!="object"||e===null)return{};var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(zA(n)||OA(n))&&(t[n]=e[n]);return t}function tu(e){if(e==null)return null;if(g.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return Vn(t)}return typeof e=="object"&&!Array.isArray(e)?Vn(e):null}function Rr(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(zA(n)||OA(n)||Rb(n))&&(t[n]=e[n]);return t}function TR(e){return e==null?null:g.isValidElement(e)?Rr(e.props):typeof e=="object"&&!Array.isArray(e)?Rr(e):null}var qR=["children","width","height","viewBox","className","style","title","desc"];function Sx(){return Sx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Sx.apply(null,arguments)}function RR(e,t){if(e==null)return{};var n,a,l=IR(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function IR(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var kA=g.forwardRef((e,t)=>{var{children:n,width:a,height:l,viewBox:o,className:u,style:d,title:f,desc:p}=e,h=RR(e,qR),v=o||{width:a,height:l,x:0,y:0},b=Nt("recharts-surface",u);return g.createElement("svg",Sx({},Rr(h),{className:b,width:a,height:l,style:d,viewBox:"".concat(v.x," ").concat(v.y," ").concat(v.width," ").concat(v.height),ref:t}),g.createElement("title",null,f),g.createElement("desc",null,p),n)}),LR=["children","className"];function wx(){return wx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},wx.apply(null,arguments)}function $R(e,t){if(e==null)return{};var n,a,l=BR(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function BR(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var Tn=g.forwardRef((e,t)=>{var{children:n,className:a}=e,l=$R(e,LR),o=Nt("recharts-layer",a);return g.createElement("g",wx({className:o},Rr(l),{ref:t}),n)}),UR=g.createContext(null);function Ct(e){return function(){return e}}const DA=Math.cos,pm=Math.sin,Xn=Math.sqrt,hm=Math.PI,gf=2*hm,Cx=Math.PI,Ex=2*Cx,Ns=1e-6,FR=Ex-Ns;function MA(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function GR(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return MA;const n=10**t;return function(a){this._+=a[0];for(let l=1,o=a.length;l<o;++l)this._+=Math.round(arguments[l]*n)/n+a[l]}}class HR{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?MA:GR(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,a,l){this._append`Q${+t},${+n},${this._x1=+a},${this._y1=+l}`}bezierCurveTo(t,n,a,l,o,u){this._append`C${+t},${+n},${+a},${+l},${this._x1=+o},${this._y1=+u}`}arcTo(t,n,a,l,o){if(t=+t,n=+n,a=+a,l=+l,o=+o,o<0)throw new Error(`negative radius: ${o}`);let u=this._x1,d=this._y1,f=a-t,p=l-n,h=u-t,v=d-n,b=h*h+v*v;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(b>Ns)if(!(Math.abs(v*f-p*h)>Ns)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let x=a-u,j=l-d,N=f*f+p*p,S=x*x+j*j,C=Math.sqrt(N),E=Math.sqrt(b),w=o*Math.tan((Cx-Math.acos((N+b-S)/(2*C*E)))/2),z=w/E,k=w/C;Math.abs(z-1)>Ns&&this._append`L${t+z*h},${n+z*v}`,this._append`A${o},${o},0,0,${+(v*x>h*j)},${this._x1=t+k*f},${this._y1=n+k*p}`}}arc(t,n,a,l,o,u){if(t=+t,n=+n,a=+a,u=!!u,a<0)throw new Error(`negative radius: ${a}`);let d=a*Math.cos(l),f=a*Math.sin(l),p=t+d,h=n+f,v=1^u,b=u?l-o:o-l;this._x1===null?this._append`M${p},${h}`:(Math.abs(this._x1-p)>Ns||Math.abs(this._y1-h)>Ns)&&this._append`L${p},${h}`,a&&(b<0&&(b=b%Ex+Ex),b>FR?this._append`A${a},${a},0,1,${v},${t-d},${n-f}A${a},${a},0,1,${v},${this._x1=p},${this._y1=h}`:b>Ns&&this._append`A${a},${a},0,${+(b>=Cx)},${v},${this._x1=t+a*Math.cos(o)},${this._y1=n+a*Math.sin(o)}`)}rect(t,n,a,l){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${a=+a}v${+l}h${-a}Z`}toString(){return this._}}function Ib(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const a=Math.floor(n);if(!(a>=0))throw new RangeError(`invalid digits: ${n}`);t=a}return e},()=>new HR(t)}function Lb(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function PA(e){this._context=e}PA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function xf(e){return new PA(e)}function TA(e){return e[0]}function qA(e){return e[1]}function RA(e,t){var n=Ct(!0),a=null,l=xf,o=null,u=Ib(d);e=typeof e=="function"?e:e===void 0?TA:Ct(e),t=typeof t=="function"?t:t===void 0?qA:Ct(t);function d(f){var p,h=(f=Lb(f)).length,v,b=!1,x;for(a==null&&(o=l(x=u())),p=0;p<=h;++p)!(p<h&&n(v=f[p],p,f))===b&&((b=!b)?o.lineStart():o.lineEnd()),b&&o.point(+e(v,p,f),+t(v,p,f));if(x)return o=null,x+""||null}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:Ct(+f),d):e},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:Ct(+f),d):t},d.defined=function(f){return arguments.length?(n=typeof f=="function"?f:Ct(!!f),d):n},d.curve=function(f){return arguments.length?(l=f,a!=null&&(o=l(a)),d):l},d.context=function(f){return arguments.length?(f==null?a=o=null:o=l(a=f),d):a},d}function Pd(e,t,n){var a=null,l=Ct(!0),o=null,u=xf,d=null,f=Ib(p);e=typeof e=="function"?e:e===void 0?TA:Ct(+e),t=typeof t=="function"?t:Ct(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?qA:Ct(+n);function p(v){var b,x,j,N=(v=Lb(v)).length,S,C=!1,E,w=new Array(N),z=new Array(N);for(o==null&&(d=u(E=f())),b=0;b<=N;++b){if(!(b<N&&l(S=v[b],b,v))===C)if(C=!C)x=b,d.areaStart(),d.lineStart();else{for(d.lineEnd(),d.lineStart(),j=b-1;j>=x;--j)d.point(w[j],z[j]);d.lineEnd(),d.areaEnd()}C&&(w[b]=+e(S,b,v),z[b]=+t(S,b,v),d.point(a?+a(S,b,v):w[b],n?+n(S,b,v):z[b]))}if(E)return d=null,E+""||null}function h(){return RA().defined(l).curve(u).context(o)}return p.x=function(v){return arguments.length?(e=typeof v=="function"?v:Ct(+v),a=null,p):e},p.x0=function(v){return arguments.length?(e=typeof v=="function"?v:Ct(+v),p):e},p.x1=function(v){return arguments.length?(a=v==null?null:typeof v=="function"?v:Ct(+v),p):a},p.y=function(v){return arguments.length?(t=typeof v=="function"?v:Ct(+v),n=null,p):t},p.y0=function(v){return arguments.length?(t=typeof v=="function"?v:Ct(+v),p):t},p.y1=function(v){return arguments.length?(n=v==null?null:typeof v=="function"?v:Ct(+v),p):n},p.lineX0=p.lineY0=function(){return h().x(e).y(t)},p.lineY1=function(){return h().x(e).y(n)},p.lineX1=function(){return h().x(a).y(t)},p.defined=function(v){return arguments.length?(l=typeof v=="function"?v:Ct(!!v),p):l},p.curve=function(v){return arguments.length?(u=v,o!=null&&(d=u(o)),p):u},p.context=function(v){return arguments.length?(v==null?o=d=null:d=u(o=v),p):o},p}class IA{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function QR(e){return new IA(e,!0)}function VR(e){return new IA(e,!1)}const $b={draw(e,t){const n=Xn(t/hm);e.moveTo(n,0),e.arc(0,0,n,0,gf)}},YR={draw(e,t){const n=Xn(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},LA=Xn(1/3),KR=LA*2,WR={draw(e,t){const n=Xn(t/KR),a=n*LA;e.moveTo(0,-n),e.lineTo(a,0),e.lineTo(0,n),e.lineTo(-a,0),e.closePath()}},XR={draw(e,t){const n=Xn(t),a=-n/2;e.rect(a,a,n,n)}},ZR=.8908130915292852,$A=pm(hm/10)/pm(7*hm/10),JR=pm(gf/10)*$A,eI=-DA(gf/10)*$A,tI={draw(e,t){const n=Xn(t*ZR),a=JR*n,l=eI*n;e.moveTo(0,-n),e.lineTo(a,l);for(let o=1;o<5;++o){const u=gf*o/5,d=DA(u),f=pm(u);e.lineTo(f*n,-d*n),e.lineTo(d*a-f*l,f*a+d*l)}e.closePath()}},Rv=Xn(3),rI={draw(e,t){const n=-Xn(t/(Rv*3));e.moveTo(0,n*2),e.lineTo(-Rv*n,-n),e.lineTo(Rv*n,-n),e.closePath()}},On=-.5,kn=Xn(3)/2,Ax=1/Xn(12),nI=(Ax/2+1)*3,aI={draw(e,t){const n=Xn(t/nI),a=n/2,l=n*Ax,o=a,u=n*Ax+n,d=-o,f=u;e.moveTo(a,l),e.lineTo(o,u),e.lineTo(d,f),e.lineTo(On*a-kn*l,kn*a+On*l),e.lineTo(On*o-kn*u,kn*o+On*u),e.lineTo(On*d-kn*f,kn*d+On*f),e.lineTo(On*a+kn*l,On*l-kn*a),e.lineTo(On*o+kn*u,On*u-kn*o),e.lineTo(On*d+kn*f,On*f-kn*d),e.closePath()}};function iI(e,t){let n=null,a=Ib(l);e=typeof e=="function"?e:Ct(e||$b),t=typeof t=="function"?t:Ct(t===void 0?64:+t);function l(){let o;if(n||(n=o=a()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),o)return n=null,o+""||null}return l.type=function(o){return arguments.length?(e=typeof o=="function"?o:Ct(o),l):e},l.size=function(o){return arguments.length?(t=typeof o=="function"?o:Ct(+o),l):t},l.context=function(o){return arguments.length?(n=o??null,l):n},l}function vm(){}function gm(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function BA(e){this._context=e}BA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:gm(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:gm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function sI(e){return new BA(e)}function UA(e){this._context=e}UA.prototype={areaStart:vm,areaEnd:vm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:gm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function lI(e){return new UA(e)}function FA(e){this._context=e}FA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,a):this._context.moveTo(n,a);break;case 3:this._point=4;default:gm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function oI(e){return new FA(e)}function GA(e){this._context=e}GA.prototype={areaStart:vm,areaEnd:vm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function cI(e){return new GA(e)}function $1(e){return e<0?-1:1}function B1(e,t,n){var a=e._x1-e._x0,l=t-e._x1,o=(e._y1-e._y0)/(a||l<0&&-0),u=(n-e._y1)/(l||a<0&&-0),d=(o*l+u*a)/(a+l);return($1(o)+$1(u))*Math.min(Math.abs(o),Math.abs(u),.5*Math.abs(d))||0}function U1(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Iv(e,t,n){var a=e._x0,l=e._y0,o=e._x1,u=e._y1,d=(o-a)/3;e._context.bezierCurveTo(a+d,l+d*t,o-d,u-d*n,o,u)}function xm(e){this._context=e}xm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Iv(this,this._t0,U1(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Iv(this,U1(this,n=B1(this,e,t)),n);break;default:Iv(this,this._t0,n=B1(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function HA(e){this._context=new QA(e)}(HA.prototype=Object.create(xm.prototype)).point=function(e,t){xm.prototype.point.call(this,t,e)};function QA(e){this._context=e}QA.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,a,l,o){this._context.bezierCurveTo(t,e,a,n,o,l)}};function uI(e){return new xm(e)}function dI(e){return new HA(e)}function VA(e){this._context=e}VA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var a=F1(e),l=F1(t),o=0,u=1;u<n;++o,++u)this._context.bezierCurveTo(a[0][o],l[0][o],a[1][o],l[1][o],e[u],t[u]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function F1(e){var t,n=e.length-1,a,l=new Array(n),o=new Array(n),u=new Array(n);for(l[0]=0,o[0]=2,u[0]=e[0]+2*e[1],t=1;t<n-1;++t)l[t]=1,o[t]=4,u[t]=4*e[t]+2*e[t+1];for(l[n-1]=2,o[n-1]=7,u[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)a=l[t]/o[t-1],o[t]-=a,u[t]-=a*u[t-1];for(l[n-1]=u[n-1]/o[n-1],t=n-2;t>=0;--t)l[t]=(u[t]-l[t+1])/o[t];for(o[n-1]=(e[n]+l[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-l[t+1];return[l,o]}function mI(e){return new VA(e)}function bf(e,t){this._context=e,this._t=t}bf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function fI(e){return new bf(e,.5)}function pI(e){return new bf(e,0)}function hI(e){return new bf(e,1)}function Ts(e,t){if((u=e.length)>1)for(var n=1,a,l,o=e[t[0]],u,d=o.length;n<u;++n)for(l=o,o=e[t[n]],a=0;a<d;++a)o[a][1]+=o[a][0]=isNaN(l[a][1])?l[a][0]:l[a][1]}function zx(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function vI(e,t){return e[t]}function gI(e){const t=[];return t.key=e,t}function xI(){var e=Ct([]),t=zx,n=Ts,a=vI;function l(o){var u=Array.from(e.apply(this,arguments),gI),d,f=u.length,p=-1,h;for(const v of o)for(d=0,++p;d<f;++d)(u[d][p]=[0,+a(v,u[d].key,p,o)]).data=v;for(d=0,h=Lb(t(u));d<f;++d)u[h[d]].index=d;return n(u,h),u}return l.keys=function(o){return arguments.length?(e=typeof o=="function"?o:Ct(Array.from(o)),l):e},l.value=function(o){return arguments.length?(a=typeof o=="function"?o:Ct(+o),l):a},l.order=function(o){return arguments.length?(t=o==null?zx:typeof o=="function"?o:Ct(Array.from(o)),l):t},l.offset=function(o){return arguments.length?(n=o??Ts,l):n},l}function bI(e,t){if((a=e.length)>0){for(var n,a,l=0,o=e[0].length,u;l<o;++l){for(u=n=0;n<a;++n)u+=e[n][l][1]||0;if(u)for(n=0;n<a;++n)e[n][l][1]/=u}Ts(e,t)}}function yI(e,t){if((l=e.length)>0){for(var n=0,a=e[t[0]],l,o=a.length;n<o;++n){for(var u=0,d=0;u<l;++u)d+=e[u][n][1]||0;a[n][1]+=a[n][0]=-d/2}Ts(e,t)}}function jI(e,t){if(!(!((u=e.length)>0)||!((o=(l=e[t[0]]).length)>0))){for(var n=0,a=1,l,o,u;a<o;++a){for(var d=0,f=0,p=0;d<u;++d){for(var h=e[t[d]],v=h[a][1]||0,b=h[a-1][1]||0,x=(v-b)/2,j=0;j<d;++j){var N=e[t[j]],S=N[a][1]||0,C=N[a-1][1]||0;x+=S-C}f+=v,p+=x*v}l[a-1][1]+=l[a-1][0]=n,f&&(n-=p/f)}l[a-1][1]+=l[a-1][0]=n,Ts(e,t)}}var Lv={},$v={},G1;function NI(){return G1||(G1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==="__proto__"}e.isUnsafeProperty=t})($v)),$v}var Bv={},H1;function YA(){return H1||(H1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}e.isDeepKey=t})(Bv)),Bv}var Uv={},Q1;function Bb(){return Q1||(Q1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="string"||typeof n=="symbol"?n:Object.is(n?.valueOf?.(),-0)?"-0":String(n)}e.toKey=t})(Uv)),Uv}var Fv={},Gv={},V1;function _I(){return V1||(V1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){if(n==null)return"";if(typeof n=="string")return n;if(Array.isArray(n))return n.map(t).join(",");const a=String(n);return a==="0"&&Object.is(Number(n),-0)?"-0":a}e.toString=t})(Gv)),Gv}var Y1;function Ub(){return Y1||(Y1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_I(),n=Bb();function a(l){if(Array.isArray(l))return l.map(n.toKey);if(typeof l=="symbol")return[l];l=t.toString(l);const o=[],u=l.length;if(u===0)return o;let d=0,f="",p="",h=!1;for(l.charCodeAt(0)===46&&(o.push(""),d++);d<u;){const v=l[d];p?v==="\\"&&d+1<u?(d++,f+=l[d]):v===p?p="":f+=v:h?v==='"'||v==="'"?p=v:v==="]"?(h=!1,o.push(f),f=""):f+=v:v==="["?(h=!0,f&&(o.push(f),f="")):v==="."?f&&(o.push(f),f=""):f+=v,d++}return f&&o.push(f),o}e.toPath=a})(Fv)),Fv}var K1;function Fb(){return K1||(K1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=NI(),n=YA(),a=Bb(),l=Ub();function o(d,f,p){if(d==null)return p;switch(typeof f){case"string":{if(t.isUnsafeProperty(f))return p;const h=d[f];return h===void 0?n.isDeepKey(f)?o(d,l.toPath(f),p):p:h}case"number":case"symbol":{typeof f=="number"&&(f=a.toKey(f));const h=d[f];return h===void 0?p:h}default:{if(Array.isArray(f))return u(d,f,p);if(Object.is(f?.valueOf(),-0)?f="-0":f=String(f),t.isUnsafeProperty(f))return p;const h=d[f];return h===void 0?p:h}}}function u(d,f,p){if(f.length===0)return p;let h=d;for(let v=0;v<f.length;v++){if(h==null||t.isUnsafeProperty(f[v]))return p;h=h[f[v]]}return h===void 0?p:h}e.get=o})(Lv)),Lv}var Hv,W1;function SI(){return W1||(W1=1,Hv=Fb().get),Hv}var wI=SI();const io=ei(wI);var CI=4;function Li(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:CI,n=10**t,a=Math.round(e*n)/n;return Object.is(a,-0)?0:a}function Ut(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return e.reduce((l,o,u)=>{var d=n[u-1];return typeof d=="string"?l+d+o:d!==void 0?l+Li(d)+o:l+o},"")}var Xr=e=>e===0?0:e>0?1:-1,pa=e=>typeof e=="number"&&e!=+e,qs=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,De=e=>(typeof e=="number"||e instanceof Number)&&!pa(e),ha=e=>De(e)||typeof e=="string",EI=0,Rc=e=>{var t=++EI;return"".concat(e||"").concat(t)},Yn=function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!De(t)&&typeof t!="string")return a;var o;if(qs(t)){if(n==null)return a;var u=t.indexOf("%");o=n*parseFloat(t.slice(0,u))/100}else o=+t;return pa(o)&&(o=a),l&&n!=null&&o>n&&(o=n),o},KA=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},a=0;a<t;a++)if(!n[String(e[a])])n[String(e[a])]=!0;else return!0;return!1};function Ft(e,t,n){return De(e)&&De(t)?Li(e+n*(t-e)):t}function WA(e,t,n){if(!(!e||!e.length))return e.find(a=>a&&(typeof t=="function"?t(a):io(a,t))===n)}var Rt=e=>e===null||typeof e>"u",ru=e=>Rt(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function Zr(e){return e!=null}function Qs(){}var AI=["type","size","sizeType"];function Ox(){return Ox=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ox.apply(null,arguments)}function X1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Z1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?X1(Object(n),!0).forEach(function(a){zI(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X1(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function zI(e,t,n){return(t=OI(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OI(e){var t=kI(e,"string");return typeof t=="symbol"?t:t+""}function kI(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DI(e,t){if(e==null)return{};var n,a,l=MI(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function MI(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var XA={symbolCircle:$b,symbolCross:YR,symbolDiamond:WR,symbolSquare:XR,symbolStar:tI,symbolTriangle:rI,symbolWye:aI},PI=Math.PI/180,TI=e=>{var t="symbol".concat(ru(e));return XA[t]||$b},qI=(e,t,n)=>{if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var a=18*PI;return 1.25*e*e*(Math.tan(a)-Math.tan(a*2)*Math.tan(a)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},RI=(e,t)=>{XA["symbol".concat(ru(e))]=t},ZA=e=>{var{type:t="circle",size:n=64,sizeType:a="area"}=e,l=DI(e,AI),o=Z1(Z1({},l),{},{type:t,size:n,sizeType:a}),u="circle";typeof t=="string"&&(u=t);var d=()=>{var b=TI(u),x=iI().type(b).size(qI(n,a,u)),j=x();if(j!==null)return j},{className:f,cx:p,cy:h}=o,v=Rr(o);return De(p)&&De(h)&&De(n)?g.createElement("path",Ox({},v,{className:Nt("recharts-symbols",f),transform:"translate(".concat(p,", ").concat(h,")"),d:d()})):null};ZA.registerSymbol=RI;var JA=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,Gb=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(g.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(l=>{Rb(l)&&(a[l]=(o=>n[l](n,o)))}),a},II=(e,t,n)=>a=>(e(t,n,a),null),Hb=(e,t,n)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var a=null;return Object.keys(e).forEach(l=>{var o=e[l];Rb(l)&&typeof o=="function"&&(a||(a={}),a[l]=II(o,t,n))}),a};function J1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function LI(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?J1(Object(n),!0).forEach(function(a){$I(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J1(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function $I(e,t,n){return(t=BI(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BI(e){var t=UI(e,"string");return typeof t=="symbol"?t:t+""}function UI(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lr(e,t){var n=LI({},e),a=t,l=Object.keys(t),o=l.reduce((u,d)=>(u[d]===void 0&&a[d]!==void 0&&(u[d]=a[d]),u),n);return o}var Qv={},Vv={},eS;function FI(){return eS||(eS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a){const l=new Map;for(let o=0;o<n.length;o++){const u=n[o],d=a(u,o,n);l.has(d)||l.set(d,u)}return Array.from(l.values())}e.uniqBy=t})(Vv)),Vv}var Yv={},tS;function GI(){return tS||(tS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a){return function(...l){return n.apply(this,l.slice(0,a))}}e.ary=t})(Yv)),Yv}var Kv={},rS;function ez(){return rS||(rS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n}e.identity=t})(Kv)),Kv}var Wv={},Xv={},Zv={},nS;function HI(){return nS||(nS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Number.isSafeInteger(n)&&n>=0}e.isLength=t})(Zv)),Zv}var aS;function Qb(){return aS||(aS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=HI();function n(a){return a!=null&&typeof a!="function"&&t.isLength(a.length)}e.isArrayLike=n})(Xv)),Xv}var Jv={},iS;function QI(){return iS||(iS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="object"&&n!==null}e.isObjectLike=t})(Jv)),Jv}var sS;function VI(){return sS||(sS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Qb(),n=QI();function a(l){return n.isObjectLike(l)&&t.isArrayLike(l)}e.isArrayLikeObject=a})(Wv)),Wv}var eg={},tg={},lS;function YI(){return lS||(lS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fb();function n(a){return function(l){return t.get(l,a)}}e.property=n})(tg)),tg}var rg={},ng={},ag={},ig={},oS;function tz(){return oS||(oS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n!==null&&(typeof n=="object"||typeof n=="function")}e.isObject=t})(ig)),ig}var sg={},cS;function rz(){return cS||(cS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null||typeof n!="object"&&typeof n!="function"}e.isPrimitive=t})(sg)),sg}var lg={},uS;function nz(){return uS||(uS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a){return n===a||Number.isNaN(n)&&Number.isNaN(a)}e.isEqualsSameValueZero=t})(lg)),lg}var dS;function KI(){return dS||(dS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tz(),n=rz(),a=nz();function l(h,v,b){return typeof b!="function"?l(h,v,()=>{}):o(h,v,function x(j,N,S,C,E,w){const z=b(j,N,S,C,E,w);return z!==void 0?!!z:o(j,N,x,w)},new Map)}function o(h,v,b,x){if(v===h)return!0;switch(typeof v){case"object":return u(h,v,b,x);case"function":return Object.keys(v).length>0?o(h,{...v},b,x):a.isEqualsSameValueZero(h,v);default:return t.isObject(h)?typeof v=="string"?v==="":!0:a.isEqualsSameValueZero(h,v)}}function u(h,v,b,x){if(v==null)return!0;if(Array.isArray(v))return f(h,v,b,x);if(v instanceof Map)return d(h,v,b,x);if(v instanceof Set)return p(h,v,b,x);const j=Object.keys(v);if(h==null||n.isPrimitive(h))return j.length===0;if(j.length===0)return!0;if(x?.has(v))return x.get(v)===h;x?.set(v,h);try{for(let N=0;N<j.length;N++){const S=j[N];if(!n.isPrimitive(h)&&!(S in h)||v[S]===void 0&&h[S]!==void 0||v[S]===null&&h[S]!==null||!b(h[S],v[S],S,h,v,x))return!1}return!0}finally{x?.delete(v)}}function d(h,v,b,x){if(v.size===0)return!0;if(!(h instanceof Map))return!1;for(const[j,N]of v.entries()){const S=h.get(j);if(b(S,N,j,h,v,x)===!1)return!1}return!0}function f(h,v,b,x){if(v.length===0)return!0;if(!Array.isArray(h))return!1;const j=new Set;for(let N=0;N<v.length;N++){const S=v[N];let C=!1;for(let E=0;E<h.length;E++){if(j.has(E))continue;const w=h[E];let z=!1;if(b(w,S,N,h,v,x)&&(z=!0),z){j.add(E),C=!0;break}}if(!C)return!1}return!0}function p(h,v,b,x){return v.size===0?!0:h instanceof Set?f([...h],[...v],b,x):!1}e.isMatchWith=l,e.isSetMatch=p})(ag)),ag}var mS;function az(){return mS||(mS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=KI();function n(a,l){return t.isMatchWith(a,l,()=>{})}e.isMatch=n})(ng)),ng}var og={},cg={},ug={},fS;function WI(){return fS||(fS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Object.getOwnPropertySymbols(n).filter(a=>Object.prototype.propertyIsEnumerable.call(n,a))}e.getSymbols=t})(ug)),ug}var dg={},pS;function Vb(){return pS||(pS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}e.getTag=t})(dg)),dg}var mg={},hS;function iz(){return hS||(hS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",n="[object String]",a="[object Number]",l="[object Boolean]",o="[object Arguments]",u="[object Symbol]",d="[object Date]",f="[object Map]",p="[object Set]",h="[object Array]",v="[object Function]",b="[object ArrayBuffer]",x="[object Object]",j="[object Error]",N="[object DataView]",S="[object Uint8Array]",C="[object Uint8ClampedArray]",E="[object Uint16Array]",w="[object Uint32Array]",z="[object BigUint64Array]",k="[object Int8Array]",O="[object Int16Array]",P="[object Int32Array]",D="[object BigInt64Array]",L="[object Float32Array]",U="[object Float64Array]";e.argumentsTag=o,e.arrayBufferTag=b,e.arrayTag=h,e.bigInt64ArrayTag=D,e.bigUint64ArrayTag=z,e.booleanTag=l,e.dataViewTag=N,e.dateTag=d,e.errorTag=j,e.float32ArrayTag=L,e.float64ArrayTag=U,e.functionTag=v,e.int16ArrayTag=O,e.int32ArrayTag=P,e.int8ArrayTag=k,e.mapTag=f,e.numberTag=a,e.objectTag=x,e.regexpTag=t,e.setTag=p,e.stringTag=n,e.symbolTag=u,e.uint16ArrayTag=E,e.uint32ArrayTag=w,e.uint8ArrayTag=S,e.uint8ClampedArrayTag=C})(mg)),mg}var fg={},vS;function XI(){return vS||(vS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}e.isTypedArray=t})(fg)),fg}var gS;function sz(){return gS||(gS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=WI(),n=Vb(),a=iz(),l=rz(),o=XI();function u(h,v){return d(h,void 0,h,new Map,v)}function d(h,v,b,x=new Map,j=void 0){const N=j?.(h,v,b,x);if(N!==void 0)return N;if(l.isPrimitive(h))return h;if(x.has(h))return x.get(h);if(Array.isArray(h)){const S=new Array(h.length);x.set(h,S);for(let C=0;C<h.length;C++)S[C]=d(h[C],C,b,x,j);return Object.hasOwn(h,"index")&&(S.index=h.index),Object.hasOwn(h,"input")&&(S.input=h.input),S}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const S=new RegExp(h.source,h.flags);return S.lastIndex=h.lastIndex,S}if(h instanceof Map){const S=new Map;x.set(h,S);for(const[C,E]of h)S.set(C,d(E,C,b,x,j));return S}if(h instanceof Set){const S=new Set;x.set(h,S);for(const C of h)S.add(d(C,void 0,b,x,j));return S}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(o.isTypedArray(h)){const S=new(Object.getPrototypeOf(h)).constructor(h.length);x.set(h,S);for(let C=0;C<h.length;C++)S[C]=d(h[C],C,b,x,j);return S}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const S=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return x.set(h,S),f(S,h,b,x,j),S}if(typeof File<"u"&&h instanceof File){const S=new File([h],h.name,{type:h.type});return x.set(h,S),f(S,h,b,x,j),S}if(typeof Blob<"u"&&h instanceof Blob){const S=new Blob([h],{type:h.type});return x.set(h,S),f(S,h,b,x,j),S}if(h instanceof Error){const S=new h.constructor;return x.set(h,S),S.message=h.message,S.name=h.name,S.stack=h.stack,S.cause=h.cause,f(S,h,b,x,j),S}if(h instanceof Boolean){const S=new Boolean(h.valueOf());return x.set(h,S),f(S,h,b,x,j),S}if(h instanceof Number){const S=new Number(h.valueOf());return x.set(h,S),f(S,h,b,x,j),S}if(h instanceof String){const S=new String(h.valueOf());return x.set(h,S),f(S,h,b,x,j),S}if(typeof h=="object"&&p(h)){const S=Object.create(Object.getPrototypeOf(h));return x.set(h,S),f(S,h,b,x,j),S}return h}function f(h,v,b=h,x,j){const N=[...Object.keys(v),...t.getSymbols(v)];for(let S=0;S<N.length;S++){const C=N[S],E=Object.getOwnPropertyDescriptor(h,C);(E==null||E.writable)&&(h[C]=d(v[C],C,b,x,j))}}function p(h){switch(n.getTag(h)){case a.argumentsTag:case a.arrayTag:case a.arrayBufferTag:case a.dataViewTag:case a.booleanTag:case a.dateTag:case a.float32ArrayTag:case a.float64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.mapTag:case a.numberTag:case a.objectTag:case a.regexpTag:case a.setTag:case a.stringTag:case a.symbolTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=u,e.cloneDeepWithImpl=d,e.copyProperties=f})(cg)),cg}var xS;function ZI(){return xS||(xS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sz();function n(a){return t.cloneDeepWithImpl(a,void 0,a,new Map,void 0)}e.cloneDeep=n})(og)),og}var bS;function JI(){return bS||(bS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=az(),n=ZI();function a(l){return l=n.cloneDeep(l),o=>t.isMatch(o,l)}e.matches=a})(rg)),rg}var pg={},hg={},vg={},yS;function e6(){return yS||(yS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sz(),n=Vb(),a=iz();function l(o,u){return t.cloneDeepWith(o,(d,f,p,h)=>{const v=u?.(d,f,p,h);if(v!==void 0)return v;if(typeof o=="object"){if(n.getTag(o)===a.objectTag&&typeof o.constructor!="function"){const b={};return h.set(o,b),t.copyProperties(b,o,p,h),b}switch(Object.prototype.toString.call(o)){case a.numberTag:case a.stringTag:case a.booleanTag:{const b=new o.constructor(o?.valueOf());return t.copyProperties(b,o),b}case a.argumentsTag:{const b={};return t.copyProperties(b,o),b.length=o.length,b[Symbol.iterator]=o[Symbol.iterator],b}default:return}}})}e.cloneDeepWith=l})(vg)),vg}var jS;function t6(){return jS||(jS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=e6();function n(a){return t.cloneDeepWith(a)}e.cloneDeep=n})(hg)),hg}var gg={},xg={},NS;function lz(){return NS||(NS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function n(a,l=Number.MAX_SAFE_INTEGER){switch(typeof a){case"number":return Number.isInteger(a)&&a>=0&&a<l;case"symbol":return!1;case"string":return t.test(a)}}e.isIndex=n})(xg)),xg}var bg={},_S;function r6(){return _S||(_S=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Vb();function n(a){return a!==null&&typeof a=="object"&&t.getTag(a)==="[object Arguments]"}e.isArguments=n})(bg)),bg}var SS;function n6(){return SS||(SS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=YA(),n=lz(),a=r6(),l=Ub();function o(u,d){let f;if(Array.isArray(d)?f=d:typeof d=="string"&&t.isDeepKey(d)&&u?.[d]==null?f=l.toPath(d):f=[d],f.length===0)return!1;let p=u;for(let h=0;h<f.length;h++){const v=f[h];if((p==null||!Object.hasOwn(p,v))&&!((Array.isArray(p)||a.isArguments(p))&&n.isIndex(v)&&v<p.length))return!1;p=p[v]}return!0}e.has=o})(gg)),gg}var wS;function a6(){return wS||(wS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=az(),n=Bb(),a=t6(),l=Fb(),o=n6();function u(d,f){switch(typeof d){case"object":{Object.is(d?.valueOf(),-0)&&(d="-0");break}case"number":{d=n.toKey(d);break}}return f=a.cloneDeep(f),function(p){const h=l.get(p,d);return h===void 0?o.has(p,d):f===void 0?h===void 0:t.isMatch(h,f)}}e.matchesProperty=u})(pg)),pg}var CS;function i6(){return CS||(CS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ez(),n=YI(),a=JI(),l=a6();function o(u){if(u==null)return t.identity;switch(typeof u){case"function":return u;case"object":return Array.isArray(u)&&u.length===2?l.matchesProperty(u[0],u[1]):a.matches(u);case"string":case"symbol":case"number":return n.property(u)}}e.iteratee=o})(eg)),eg}var ES;function s6(){return ES||(ES=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FI(),n=GI(),a=ez(),l=VI(),o=i6();function u(d,f=a.identity){return l.isArrayLikeObject(d)?t.uniqBy(Array.from(d),n.ary(o.iteratee(f),1)):[]}e.uniqBy=u})(Qv)),Qv}var yg,AS;function l6(){return AS||(AS=1,yg=s6().uniqBy),yg}var o6=l6();const zS=ei(o6);function c6(e,t,n){return t===!0?zS(e,n):typeof t=="function"?zS(e,t):e}var jg={exports:{}},Ng={},_g={exports:{}},Sg={};var OS;function u6(){if(OS)return Sg;OS=1;var e=ff();function t(v,b){return v===b&&(v!==0||1/v===1/b)||v!==v&&b!==b}var n=typeof Object.is=="function"?Object.is:t,a=e.useState,l=e.useEffect,o=e.useLayoutEffect,u=e.useDebugValue;function d(v,b){var x=b(),j=a({inst:{value:x,getSnapshot:b}}),N=j[0].inst,S=j[1];return o(function(){N.value=x,N.getSnapshot=b,f(N)&&S({inst:N})},[v,x,b]),l(function(){return f(N)&&S({inst:N}),v(function(){f(N)&&S({inst:N})})},[v]),u(x),x}function f(v){var b=v.getSnapshot;v=v.value;try{var x=b();return!n(v,x)}catch{return!0}}function p(v,b){return b()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:d;return Sg.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,Sg}var kS;function d6(){return kS||(kS=1,_g.exports=u6()),_g.exports}var DS;function m6(){if(DS)return Ng;DS=1;var e=ff(),t=d6();function n(p,h){return p===h&&(p!==0||1/p===1/h)||p!==p&&h!==h}var a=typeof Object.is=="function"?Object.is:n,l=t.useSyncExternalStore,o=e.useRef,u=e.useEffect,d=e.useMemo,f=e.useDebugValue;return Ng.useSyncExternalStoreWithSelector=function(p,h,v,b,x){var j=o(null);if(j.current===null){var N={hasValue:!1,value:null};j.current=N}else N=j.current;j=d(function(){function C(O){if(!E){if(E=!0,w=O,O=b(O),x!==void 0&&N.hasValue){var P=N.value;if(x(P,O))return z=P}return z=O}if(P=z,a(w,O))return P;var D=b(O);return x!==void 0&&x(P,D)?(w=O,P):(w=O,z=D)}var E=!1,w,z,k=v===void 0?null:v;return[function(){return C(h())},k===null?void 0:function(){return C(k())}]},[h,v,b,x]);var S=l(p,j[0],j[1]);return u(function(){N.hasValue=!0,N.value=S},[S]),f(S),S},Ng}var MS;function f6(){return MS||(MS=1,jg.exports=m6()),jg.exports}var p6=f6(),Yb=g.createContext(null),h6=e=>e,Qt=()=>{var e=g.useContext(Yb);return e?e.store.dispatch:h6},rm=()=>{},v6=()=>rm,g6=(e,t)=>e===t;function Ie(e){var t=g.useContext(Yb),n=g.useMemo(()=>t?a=>{if(a!=null)return e(a)}:rm,[t,e]);return p6.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:v6,t?t.store.getState:rm,t?t.store.getState:rm,n,g6)}function x6(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function b6(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function y6(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(n=>typeof n=="function")){const n=e.map(a=>typeof a=="function"?`function ${a.name||"unnamed"}()`:typeof a).join(", ");throw new TypeError(`${t}[${n}]`)}}var PS=e=>Array.isArray(e)?e:[e];function j6(e){const t=Array.isArray(e[0])?e[0]:e;return y6(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function N6(e,t){const n=[],{length:a}=e;for(let l=0;l<a;l++)n.push(e[l].apply(null,t));return n}var _6=class{constructor(e){this.value=e}deref(){return this.value}},S6=typeof WeakRef<"u"?WeakRef:_6,w6=0,TS=1;function Td(){return{s:w6,v:void 0,o:null,p:null}}function oz(e,t={}){let n=Td();const{resultEqualityCheck:a}=t;let l,o=0;function u(){let d=n;const{length:f}=arguments;for(let v=0,b=f;v<b;v++){const x=arguments[v];if(typeof x=="function"||typeof x=="object"&&x!==null){let j=d.o;j===null&&(d.o=j=new WeakMap);const N=j.get(x);N===void 0?(d=Td(),j.set(x,d)):d=N}else{let j=d.p;j===null&&(d.p=j=new Map);const N=j.get(x);N===void 0?(d=Td(),j.set(x,d)):d=N}}const p=d;let h;if(d.s===TS)h=d.v;else if(h=e.apply(null,arguments),o++,a){const v=l?.deref?.()??l;v!=null&&a(v,h)&&(h=v,o!==0&&o--),l=typeof h=="object"&&h!==null||typeof h=="function"?new S6(h):h}return p.s=TS,p.v=h,h}return u.clearCache=()=>{n=Td(),u.resetResultsCount()},u.resultsCount=()=>o,u.resetResultsCount=()=>{o=0},u}function C6(e,...t){const n=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,a=(...l)=>{let o=0,u=0,d,f={},p=l.pop();typeof p=="object"&&(f=p,p=l.pop()),x6(p,`createSelector expects an output function after the inputs, but received: [${typeof p}]`);const h={...n,...f},{memoize:v,memoizeOptions:b=[],argsMemoize:x=oz,argsMemoizeOptions:j=[]}=h,N=PS(b),S=PS(j),C=j6(l),E=v(function(){return o++,p.apply(null,arguments)},...N),w=x(function(){u++;const k=N6(C,arguments);return d=E.apply(null,k),d},...S);return Object.assign(w,{resultFunc:p,memoizedResultFunc:E,dependencies:C,dependencyRecomputations:()=>u,resetDependencyRecomputations:()=>{u=0},lastResult:()=>d,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:v,argsMemoize:x})};return Object.assign(a,{withTypes:()=>a}),a}var ue=C6(oz),E6=Object.assign((e,t=ue)=>{b6(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const n=Object.keys(e),a=n.map(o=>e[o]);return t(a,(...o)=>o.reduce((u,d,f)=>(u[n[f]]=d,u),{}))},{withTypes:()=>E6}),wg={},Cg={},Eg={},qS;function A6(){return qS||(qS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(a){return typeof a=="symbol"?1:a===null?2:a===void 0?3:a!==a?4:0}const n=(a,l,o)=>{if(a!==l){const u=t(a),d=t(l);if(u===d&&u===0){if(a<l)return o==="desc"?1:-1;if(a>l)return o==="desc"?-1:1}return o==="desc"?d-u:u-d}return 0};e.compareValues=n})(Eg)),Eg}var Ag={},zg={},RS;function cz(){return RS||(RS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"||n instanceof Symbol}e.isSymbol=t})(zg)),zg}var IS;function z6(){return IS||(IS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cz(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function l(o,u){return Array.isArray(o)?!1:typeof o=="number"||typeof o=="boolean"||o==null||t.isSymbol(o)?!0:typeof o=="string"&&(a.test(o)||!n.test(o))||u!=null&&Object.hasOwn(u,o)}e.isKey=l})(Ag)),Ag}var LS;function O6(){return LS||(LS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=A6(),n=z6(),a=Ub();function l(o,u,d,f){if(o==null)return[];d=f?void 0:d,Array.isArray(o)||(o=Object.values(o)),Array.isArray(u)||(u=u==null?[null]:[u]),u.length===0&&(u=[null]),Array.isArray(d)||(d=d==null?[]:[d]),d=d.map(x=>String(x));const p=(x,j)=>{let N=x;for(let S=0;S<j.length&&N!=null;++S)N=N[j[S]];return N},h=(x,j)=>j==null||x==null?j:typeof x=="object"&&"key"in x?Object.hasOwn(j,x.key)?j[x.key]:p(j,x.path):typeof x=="function"?x(j):Array.isArray(x)?p(j,x):typeof j=="object"?j[x]:j,v=u.map(x=>(Array.isArray(x)&&x.length===1&&(x=x[0]),x==null||typeof x=="function"||Array.isArray(x)||n.isKey(x)?x:{key:x,path:a.toPath(x)}));return o.map(x=>({original:x,criteria:v.map(j=>h(j,x))})).slice().sort((x,j)=>{for(let N=0;N<v.length;N++){const S=t.compareValues(x.criteria[N],j.criteria[N],d[N]);if(S!==0)return S}return 0}).map(x=>x.original)}e.orderBy=l})(Cg)),Cg}var Og={},$S;function k6(){return $S||($S=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a=1){const l=[],o=Math.floor(a),u=(d,f)=>{for(let p=0;p<d.length;p++){const h=d[p];Array.isArray(h)&&f<o?u(h,f+1):l.push(h)}};return u(n,0),l}e.flatten=t})(Og)),Og}var kg={},BS;function uz(){return BS||(BS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lz(),n=Qb(),a=tz(),l=nz();function o(u,d,f){return a.isObject(f)&&(typeof d=="number"&&n.isArrayLike(f)&&t.isIndex(d)&&d<f.length||typeof d=="string"&&d in f)?l.isEqualsSameValueZero(f[d],u):!1}e.isIterateeCall=o})(kg)),kg}var US;function D6(){return US||(US=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=O6(),n=k6(),a=uz();function l(o,...u){const d=u.length;return d>1&&a.isIterateeCall(o,u[0],u[1])?u=[]:d>2&&a.isIterateeCall(u[0],u[1],u[2])&&(u=[u[0]]),t.orderBy(o,n.flatten(u),["asc"])}e.sortBy=l})(wg)),wg}var Dg,FS;function M6(){return FS||(FS=1,Dg=D6().sortBy),Dg}var P6=M6();const yf=ei(P6);var dz=e=>e.legend.settings,T6=e=>e.legend.size,q6=e=>e.legend.payload;ue([q6,dz],(e,t)=>{var{itemSorter:n}=t,a=e.flat(1);return n?yf(a,n):a});var qd=1;function R6(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,n]=g.useState({height:0,left:0,top:0,width:0}),a=g.useCallback(l=>{if(l!=null){var o=l.getBoundingClientRect(),u={height:o.height,left:o.left,top:o.top,width:o.width};(Math.abs(u.height-t.height)>qd||Math.abs(u.left-t.left)>qd||Math.abs(u.top-t.top)>qd||Math.abs(u.width-t.width)>qd)&&n({height:u.height,left:u.left,top:u.top,width:u.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,a]}function _r(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var I6=typeof Symbol=="function"&&Symbol.observable||"@@observable",GS=I6,Mg=()=>Math.random().toString(36).substring(7).split("").join("."),L6={INIT:`@@redux/INIT${Mg()}`,REPLACE:`@@redux/REPLACE${Mg()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Mg()}`},bm=L6;function Kb(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function mz(e,t,n){if(typeof e!="function")throw new Error(_r(2));if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(_r(0));if(typeof t=="function"&&typeof n>"u"&&(n=t,t=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(_r(1));return n(mz)(e,t)}let a=e,l=t,o=new Map,u=o,d=0,f=!1;function p(){u===o&&(u=new Map,o.forEach((S,C)=>{u.set(C,S)}))}function h(){if(f)throw new Error(_r(3));return l}function v(S){if(typeof S!="function")throw new Error(_r(4));if(f)throw new Error(_r(5));let C=!0;p();const E=d++;return u.set(E,S),function(){if(C){if(f)throw new Error(_r(6));C=!1,p(),u.delete(E),o=null}}}function b(S){if(!Kb(S))throw new Error(_r(7));if(typeof S.type>"u")throw new Error(_r(8));if(typeof S.type!="string")throw new Error(_r(17));if(f)throw new Error(_r(9));try{f=!0,l=a(l,S)}finally{f=!1}return(o=u).forEach(E=>{E()}),S}function x(S){if(typeof S!="function")throw new Error(_r(10));a=S,b({type:bm.REPLACE})}function j(){const S=v;return{subscribe(C){if(typeof C!="object"||C===null)throw new Error(_r(11));function E(){const z=C;z.next&&z.next(h())}return E(),{unsubscribe:S(E)}},[GS](){return this}}}return b({type:bm.INIT}),{dispatch:b,subscribe:v,getState:h,replaceReducer:x,[GS]:j}}function $6(e){Object.keys(e).forEach(t=>{const n=e[t];if(typeof n(void 0,{type:bm.INIT})>"u")throw new Error(_r(12));if(typeof n(void 0,{type:bm.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(_r(13))})}function fz(e){const t=Object.keys(e),n={};for(let o=0;o<t.length;o++){const u=t[o];typeof e[u]=="function"&&(n[u]=e[u])}const a=Object.keys(n);let l;try{$6(n)}catch(o){l=o}return function(u={},d){if(l)throw l;let f=!1;const p={};for(let h=0;h<a.length;h++){const v=a[h],b=n[v],x=u[v],j=b(x,d);if(typeof j>"u")throw d&&d.type,new Error(_r(14));p[v]=j,f=f||j!==x}return f=f||a.length!==Object.keys(u).length,f?p:u}}function ym(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,n)=>(...a)=>t(n(...a)))}function B6(...e){return t=>(n,a)=>{const l=t(n,a);let o=()=>{throw new Error(_r(15))};const u={getState:l.getState,dispatch:(f,...p)=>o(f,...p)},d=e.map(f=>f(u));return o=ym(...d)(l.dispatch),{...l,dispatch:o}}}function pz(e){return Kb(e)&&"type"in e&&typeof e.type=="string"}var hz=Symbol.for("immer-nothing"),HS=Symbol.for("immer-draftable"),Ir=Symbol.for("immer-state");function Fn(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var hn=Object,so=hn.getPrototypeOf,jm="constructor",jf="prototype",kx="configurable",Nm="enumerable",nm="writable",Ic="value",Va=e=>!!e&&!!e[Ir];function Kn(e){return e?vz(e)||_f(e)||!!e[HS]||!!e[jm]?.[HS]||Sf(e)||wf(e):!1}var U6=hn[jf][jm].toString(),QS=new WeakMap;function vz(e){if(!e||!Wb(e))return!1;const t=so(e);if(t===null||t===hn[jf])return!0;const n=hn.hasOwnProperty.call(t,jm)&&t[jm];if(n===Object)return!0;if(!Kl(n))return!1;let a=QS.get(n);return a===void 0&&(a=Function.toString.call(n),QS.set(n,a)),a===U6}function Nf(e,t,n=!0){nu(e)===0?(n?Reflect.ownKeys(e):hn.keys(e)).forEach(l=>{t(l,e[l],e)}):e.forEach((a,l)=>t(l,a,e))}function nu(e){const t=e[Ir];return t?t.type_:_f(e)?1:Sf(e)?2:wf(e)?3:0}var VS=(e,t,n=nu(e))=>n===2?e.has(t):hn[jf].hasOwnProperty.call(e,t),Dx=(e,t,n=nu(e))=>n===2?e.get(t):e[t],_m=(e,t,n,a=nu(e))=>{a===2?e.set(t,n):a===3?e.add(n):e[t]=n};function F6(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var _f=Array.isArray,Sf=e=>e instanceof Map,wf=e=>e instanceof Set,Wb=e=>typeof e=="object",Kl=e=>typeof e=="function",Pg=e=>typeof e=="boolean";function G6(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var La=e=>e.copy_||e.base_,Xb=e=>e.modified_?e.copy_:e.base_;function Mx(e,t){if(Sf(e))return new Map(e);if(wf(e))return new Set(e);if(_f(e))return Array[jf].slice.call(e);const n=vz(e);if(t===!0||t==="class_only"&&!n){const a=hn.getOwnPropertyDescriptors(e);delete a[Ir];let l=Reflect.ownKeys(a);for(let o=0;o<l.length;o++){const u=l[o],d=a[u];d[nm]===!1&&(d[nm]=!0,d[kx]=!0),(d.get||d.set)&&(a[u]={[kx]:!0,[nm]:!0,[Nm]:d[Nm],[Ic]:e[u]})}return hn.create(so(e),a)}else{const a=so(e);if(a!==null&&n)return{...e};const l=hn.create(a);return hn.assign(l,e)}}function Zb(e,t=!1){return Cf(e)||Va(e)||!Kn(e)||(nu(e)>1&&hn.defineProperties(e,{set:Rd,add:Rd,clear:Rd,delete:Rd}),hn.freeze(e),t&&Nf(e,(n,a)=>{Zb(a,!0)},!1)),e}function H6(){Fn(2)}var Rd={[Ic]:H6};function Cf(e){return e===null||!Wb(e)?!0:hn.isFrozen(e)}var Sm="MapSet",Px="Patches",YS="ArrayMethods",gz={};function Rs(e){const t=gz[e];return t||Fn(0,e),t}var KS=e=>!!gz[e],Lc,xz=()=>Lc,Q6=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:KS(Sm)?Rs(Sm):void 0,arrayMethodsPlugin_:KS(YS)?Rs(YS):void 0});function WS(e,t){t&&(e.patchPlugin_=Rs(Px),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Tx(e){qx(e),e.drafts_.forEach(V6),e.drafts_=null}function qx(e){e===Lc&&(Lc=e.parent_)}var XS=e=>Lc=Q6(Lc,e);function V6(e){const t=e[Ir];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function ZS(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];if(e!==void 0&&e!==n){n[Ir].modified_&&(Tx(t),Fn(4)),Kn(e)&&(e=JS(t,e));const{patchPlugin_:l}=t;l&&l.generateReplacementPatches_(n[Ir].base_,e,t)}else e=JS(t,n);return Y6(t,e,!0),Tx(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==hz?e:void 0}function JS(e,t){if(Cf(t))return t;const n=t[Ir];if(!n)return wm(t,e.handledSet_,e);if(!Ef(n,e))return t;if(!n.modified_)return n.base_;if(!n.finalized_){const{callbacks_:a}=n;if(a)for(;a.length>0;)a.pop()(e);jz(n,e)}return n.copy_}function Y6(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Zb(t,n)}function bz(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var Ef=(e,t)=>e.scope_===t,K6=[];function yz(e,t,n,a){const l=La(e),o=e.type_;if(a!==void 0&&Dx(l,a,o)===t){_m(l,a,n,o);return}if(!e.draftLocations_){const d=e.draftLocations_=new Map;Nf(l,(f,p)=>{if(Va(p)){const h=d.get(p)||[];h.push(f),d.set(p,h)}})}const u=e.draftLocations_.get(t)??K6;for(const d of u)_m(l,d,n,o)}function W6(e,t,n){e.callbacks_.push(function(l){const o=t;if(!o||!Ef(o,l))return;l.mapSetPlugin_?.fixSetContents(o);const u=Xb(o);yz(e,o.draft_??o,u,n),jz(o,l)})}function jz(e,t){if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){const{patchPlugin_:a}=t;if(a){const l=a.getPath(e);l&&a.generatePatches_(e,l,t)}bz(e)}}function X6(e,t,n){const{scope_:a}=e;if(Va(n)){const l=n[Ir];Ef(l,a)&&l.callbacks_.push(function(){am(e);const u=Xb(l);yz(e,n,u,t)})}else Kn(n)&&e.callbacks_.push(function(){const o=La(e);e.type_===3?o.has(n)&&wm(n,a.handledSet_,a):Dx(o,t,e.type_)===n&&a.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&wm(Dx(e.copy_,t,e.type_),a.handledSet_,a)})}function wm(e,t,n){return!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||Va(e)||t.has(e)||!Kn(e)||Cf(e)||(t.add(e),Nf(e,(a,l)=>{if(Va(l)){const o=l[Ir];if(Ef(o,n)){const u=Xb(o);_m(e,a,u,e.type_),bz(o)}}else Kn(l)&&wm(l,t,n)})),e}function Z6(e,t){const n=_f(e),a={type_:n?1:0,scope_:t?t.scope_:xz(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let l=a,o=Cm;n&&(l=[a],o=$c);const{revoke:u,proxy:d}=Proxy.revocable(l,o);return a.draft_=d,a.revoke_=u,[d,a]}var Cm={get(e,t){if(t===Ir)return e;let n=e.scope_.arrayMethodsPlugin_;const a=e.type_===1&&typeof t=="string";if(a&&n?.isArrayOperationMethod(t))return n.createMethodInterceptor(e,t);const l=La(e);if(!VS(l,t,e.type_))return J6(e,l,t);const o=l[t];if(e.finalized_||!Kn(o)||a&&e.operationMethod&&n?.isMutatingArrayMethod(e.operationMethod)&&G6(t))return o;if(o===Tg(e.base_,t)){am(e);const u=e.type_===1?+t:t,d=Ix(e.scope_,o,e,u);return e.copy_[u]=d}return o},has(e,t){return t in La(e)},ownKeys(e){return Reflect.ownKeys(La(e))},set(e,t,n){const a=Nz(La(e),t);if(a?.set)return a.set.call(e.draft_,n),!0;if(!e.modified_){const l=Tg(La(e),t),o=l?.[Ir];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_.set(t,!1),!0;if(F6(n,l)&&(n!==void 0||VS(e.base_,t,e.type_)))return!0;am(e),Rx(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_.set(t,!0),X6(e,t,n)),!0},deleteProperty(e,t){return am(e),Tg(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),Rx(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=La(e),a=Reflect.getOwnPropertyDescriptor(n,t);return a&&{[nm]:!0,[kx]:e.type_!==1||t!=="length",[Nm]:a[Nm],[Ic]:n[t]}},defineProperty(){Fn(11)},getPrototypeOf(e){return so(e.base_)},setPrototypeOf(){Fn(12)}},$c={};for(let e in Cm){let t=Cm[e];$c[e]=function(){const n=arguments;return n[0]=n[0][0],t.apply(this,n)}}$c.deleteProperty=function(e,t){return $c.set.call(this,e,t,void 0)};$c.set=function(e,t,n){return Cm.set.call(this,e[0],t,n,e[0])};function Tg(e,t){const n=e[Ir];return(n?La(n):e)[t]}function J6(e,t,n){const a=Nz(t,n);return a?Ic in a?a[Ic]:a.get?.call(e.draft_):void 0}function Nz(e,t){if(!(t in e))return;let n=so(e);for(;n;){const a=Object.getOwnPropertyDescriptor(n,t);if(a)return a;n=so(n)}}function Rx(e){e.modified_||(e.modified_=!0,e.parent_&&Rx(e.parent_))}function am(e){e.copy_||(e.assigned_=new Map,e.copy_=Mx(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var e4=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(n,a,l)=>{if(Kl(n)&&!Kl(a)){const u=a;a=n;const d=this;return function(p=u,...h){return d.produce(p,v=>a.call(this,v,...h))}}Kl(a)||Fn(6),l!==void 0&&!Kl(l)&&Fn(7);let o;if(Kn(n)){const u=XS(this),d=Ix(u,n,void 0);let f=!0;try{o=a(d),f=!1}finally{f?Tx(u):qx(u)}return WS(u,l),ZS(o,u)}else if(!n||!Wb(n)){if(o=a(n),o===void 0&&(o=n),o===hz&&(o=void 0),this.autoFreeze_&&Zb(o,!0),l){const u=[],d=[];Rs(Px).generateReplacementPatches_(n,o,{patches_:u,inversePatches_:d}),l(u,d)}return o}else Fn(1,n)},this.produceWithPatches=(n,a)=>{if(Kl(n))return(d,...f)=>this.produceWithPatches(d,p=>n(p,...f));let l,o;return[this.produce(n,a,(d,f)=>{l=d,o=f}),l,o]},Pg(t?.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),Pg(t?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),Pg(t?.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Kn(t)||Fn(8),Va(t)&&(t=Qn(t));const n=XS(this),a=Ix(n,t,void 0);return a[Ir].isManual_=!0,qx(n),a}finishDraft(t,n){const a=t&&t[Ir];(!a||!a.isManual_)&&Fn(9);const{scope_:l}=a;return WS(l,n),ZS(void 0,l)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,n){let a;for(a=n.length-1;a>=0;a--){const o=n[a];if(o.path.length===0&&o.op==="replace"){t=o.value;break}}a>-1&&(n=n.slice(a+1));const l=Rs(Px).applyPatches_;return Va(t)?l(t,n):this.produce(t,o=>l(o,n))}};function Ix(e,t,n,a){const[l,o]=Sf(t)?Rs(Sm).proxyMap_(t,n):wf(t)?Rs(Sm).proxySet_(t,n):Z6(t,n);return(n?.scope_??xz()).drafts_.push(l),o.callbacks_=n?.callbacks_??[],o.key_=a,n&&a!==void 0?W6(n,o,a):o.callbacks_.push(function(f){f.mapSetPlugin_?.fixSetContents(o);const{patchPlugin_:p}=f;o.modified_&&p&&p.generatePatches_(o,[],f)}),l}function Qn(e){return Va(e)||Fn(10,e),_z(e)}function _z(e){if(!Kn(e)||Cf(e))return e;const t=e[Ir];let n,a=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Mx(e,t.scope_.immer_.useStrictShallowCopy_),a=t.scope_.immer_.shouldUseStrictIteration()}else n=Mx(e,!0);return Nf(n,(l,o)=>{_m(n,l,_z(o))},a),t&&(t.finalized_=!1),n}var t4=new e4,Sz=t4.produce;function wz(e){return({dispatch:n,getState:a})=>l=>o=>typeof o=="function"?o(n,a,e):l(o)}var r4=wz(),n4=wz,a4=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ym:ym.apply(null,arguments)};function qn(e,t){function n(...a){if(t){let l=t(...a);if(!l)throw new Error(gn(0));return{type:e,payload:l.payload,..."meta"in l&&{meta:l.meta},..."error"in l&&{error:l.error}}}return{type:e,payload:a[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=a=>pz(a)&&a.type===e,n}var Cz=class zc extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,zc.prototype)}static get[Symbol.species](){return zc}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new zc(...t[0].concat(this)):new zc(...t.concat(this))}};function ew(e){return Kn(e)?Sz(e,()=>{}):e}function Id(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}function i4(e){return typeof e=="boolean"}var s4=()=>function(t){const{thunk:n=!0,immutableCheck:a=!0,serializableCheck:l=!0,actionCreatorCheck:o=!0}=t??{};let u=new Cz;return n&&(i4(n)?u.push(r4):u.push(n4(n.extraArgument))),u},Ez="RTK_autoBatch",Dt=()=>e=>({payload:e,meta:{[Ez]:!0}}),tw=e=>t=>{setTimeout(t,e)},Az=(e={type:"raf"})=>t=>(...n)=>{const a=t(...n);let l=!0,o=!1,u=!1;const d=new Set,f=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:tw(10):e.type==="callback"?e.queueNotification:tw(e.timeout),p=()=>{u=!1,o&&(o=!1,d.forEach(h=>h()))};return Object.assign({},a,{subscribe(h){const v=()=>l&&h(),b=a.subscribe(v);return d.add(h),()=>{b(),d.delete(h)}},dispatch(h){try{return l=!h?.meta?.[Ez],o=!l,o&&(u||(u=!0,f(p))),a.dispatch(h)}finally{l=!0}}})},l4=e=>function(n){const{autoBatch:a=!0}=n??{};let l=new Cz(e);return a&&l.push(Az(typeof a=="object"?a:void 0)),l};function o4(e){const t=s4(),{reducer:n=void 0,middleware:a,devTools:l=!0,preloadedState:o=void 0,enhancers:u=void 0}=e||{};let d;if(typeof n=="function")d=n;else if(Kb(n))d=fz(n);else throw new Error(gn(1));let f;typeof a=="function"?f=a(t):f=t();let p=ym;l&&(p=a4({trace:!1,...typeof l=="object"&&l}));const h=B6(...f),v=l4(h);let b=typeof u=="function"?u(v):v();const x=p(...b);return mz(d,o,x)}function zz(e){const t={},n=[];let a;const l={addCase(o,u){const d=typeof o=="string"?o:o.type;if(!d)throw new Error(gn(28));if(d in t)throw new Error(gn(29));return t[d]=u,l},addAsyncThunk(o,u){return u.pending&&(t[o.pending.type]=u.pending),u.rejected&&(t[o.rejected.type]=u.rejected),u.fulfilled&&(t[o.fulfilled.type]=u.fulfilled),u.settled&&n.push({matcher:o.settled,reducer:u.settled}),l},addMatcher(o,u){return n.push({matcher:o,reducer:u}),l},addDefaultCase(o){return a=o,l}};return e(l),[t,n,a]}function c4(e){return typeof e=="function"}function u4(e,t){let[n,a,l]=zz(t),o;if(c4(e))o=()=>ew(e());else{const d=ew(e);o=()=>d}function u(d=o(),f){let p=[n[f.type],...a.filter(({matcher:h})=>h(f)).map(({reducer:h})=>h)];return p.filter(h=>!!h).length===0&&(p=[l]),p.reduce((h,v)=>{if(v)if(Va(h)){const x=v(h,f);return x===void 0?h:x}else{if(Kn(h))return Sz(h,b=>v(b,f));{const b=v(h,f);if(b===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return b}}return h},d)}return u.getInitialState=o,u}var d4="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",m4=(e=21)=>{let t="",n=e;for(;n--;)t+=d4[Math.random()*64|0];return t},f4=Symbol.for("rtk-slice-createasyncthunk");function p4(e,t){return`${e}/${t}`}function h4({creators:e}={}){const t=e?.asyncThunk?.[f4];return function(a){const{name:l,reducerPath:o=l}=a;if(!l)throw new Error(gn(11));const u=(typeof a.reducers=="function"?a.reducers(g4()):a.reducers)||{},d=Object.keys(u),f={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},p={addCase(w,z){const k=typeof w=="string"?w:w.type;if(!k)throw new Error(gn(12));if(k in f.sliceCaseReducersByType)throw new Error(gn(13));return f.sliceCaseReducersByType[k]=z,p},addMatcher(w,z){return f.sliceMatchers.push({matcher:w,reducer:z}),p},exposeAction(w,z){return f.actionCreators[w]=z,p},exposeCaseReducer(w,z){return f.sliceCaseReducersByName[w]=z,p}};d.forEach(w=>{const z=u[w],k={reducerName:w,type:p4(l,w),createNotation:typeof a.reducers=="function"};b4(z)?j4(k,z,p,t):x4(k,z,p)});function h(){const[w={},z=[],k=void 0]=typeof a.extraReducers=="function"?zz(a.extraReducers):[a.extraReducers],O={...w,...f.sliceCaseReducersByType};return u4(a.initialState,P=>{for(let D in O)P.addCase(D,O[D]);for(let D of f.sliceMatchers)P.addMatcher(D.matcher,D.reducer);for(let D of z)P.addMatcher(D.matcher,D.reducer);k&&P.addDefaultCase(k)})}const v=w=>w,b=new Map,x=new WeakMap;let j;function N(w,z){return j||(j=h()),j(w,z)}function S(){return j||(j=h()),j.getInitialState()}function C(w,z=!1){function k(P){let D=P[w];return typeof D>"u"&&z&&(D=Id(x,k,S)),D}function O(P=v){const D=Id(b,z,()=>new WeakMap);return Id(D,P,()=>{const L={};for(const[U,$]of Object.entries(a.selectors??{}))L[U]=v4($,P,()=>Id(x,P,S),z);return L})}return{reducerPath:w,getSelectors:O,get selectors(){return O(k)},selectSlice:k}}const E={name:l,reducer:N,actions:f.actionCreators,caseReducers:f.sliceCaseReducersByName,getInitialState:S,...C(o),injectInto(w,{reducerPath:z,...k}={}){const O=z??o;return w.inject({reducerPath:O,reducer:N},k),{...E,...C(O,!0)}}};return E}}function v4(e,t,n,a){function l(o,...u){let d=t(o);return typeof d>"u"&&a&&(d=n()),e(d,...u)}return l.unwrapped=e,l}var tn=h4();function g4(){function e(t,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...n}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...n){return t(...n)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:n}},asyncThunk:e}}function x4({type:e,reducerName:t,createNotation:n},a,l){let o,u;if("reducer"in a){if(n&&!y4(a))throw new Error(gn(17));o=a.reducer,u=a.prepare}else o=a;l.addCase(e,o).exposeCaseReducer(t,o).exposeAction(t,u?qn(e,u):qn(e))}function b4(e){return e._reducerDefinitionType==="asyncThunk"}function y4(e){return e._reducerDefinitionType==="reducerWithPrepare"}function j4({type:e,reducerName:t},n,a,l){if(!l)throw new Error(gn(18));const{payloadCreator:o,fulfilled:u,pending:d,rejected:f,settled:p,options:h}=n,v=l(e,o,h);a.exposeAction(t,v),u&&a.addCase(v.fulfilled,u),d&&a.addCase(v.pending,d),f&&a.addCase(v.rejected,f),p&&a.addMatcher(v.settled,p),a.exposeCaseReducer(t,{fulfilled:u||Ld,pending:d||Ld,rejected:f||Ld,settled:p||Ld})}function Ld(){}var N4="task",Oz="listener",kz="completed",Jb="cancelled",_4=`task-${Jb}`,S4=`task-${kz}`,Lx=`${Oz}-${Jb}`,w4=`${Oz}-${kz}`,Af=class{constructor(e){this.code=e,this.message=`${N4} ${Jb} (reason: ${e})`}name="TaskAbortError";message},ey=(e,t)=>{if(typeof e!="function")throw new TypeError(gn(32))},Em=()=>{},Dz=(e,t=Em)=>(e.catch(t),e),Mz=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Ds=e=>{if(e.aborted)throw new Af(e.reason)};function Pz(e,t){let n=Em;return new Promise((a,l)=>{const o=()=>l(new Af(e.reason));if(e.aborted){o();return}n=Mz(e,o),t.finally(()=>n()).then(a,l)}).finally(()=>{n=Em})}var C4=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof Af?"cancelled":"rejected",error:n}}finally{t?.()}},Am=e=>t=>Dz(Pz(e,t).then(n=>(Ds(e),n))),Tz=e=>{const t=Am(e);return n=>t(new Promise(a=>setTimeout(a,n)))},{assign:to}=Object,rw={},zf="listenerMiddleware",E4=(e,t)=>{const n=a=>Mz(e,()=>a.abort(e.reason));return(a,l)=>{ey(a);const o=new AbortController;n(o);const u=C4(async()=>{Ds(e),Ds(o.signal);const d=await a({pause:Am(o.signal),delay:Tz(o.signal),signal:o.signal});return Ds(o.signal),d},()=>o.abort(S4));return l?.autoJoin&&t.push(u.catch(Em)),{result:Am(e)(u),cancel(){o.abort(_4)}}}},A4=(e,t)=>{const n=async(a,l)=>{Ds(t);let o=()=>{};const d=[new Promise((f,p)=>{let h=e({predicate:a,effect:(v,b)=>{b.unsubscribe(),f([v,b.getState(),b.getOriginalState()])}});o=()=>{h(),p()}})];l!=null&&d.push(new Promise(f=>setTimeout(f,l,null)));try{const f=await Pz(t,Promise.race(d));return Ds(t),f}finally{o()}};return(a,l)=>Dz(n(a,l))},qz=e=>{let{type:t,actionCreator:n,matcher:a,predicate:l,effect:o}=e;if(t)l=qn(t).match;else if(n)t=n.type,l=n.match;else if(a)l=a;else if(!l)throw new Error(gn(21));return ey(o),{predicate:l,type:t,effect:o}},Rz=to(e=>{const{type:t,predicate:n,effect:a}=qz(e);return{id:m4(),effect:a,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(gn(22))}}},{withTypes:()=>Rz}),nw=(e,t)=>{const{type:n,effect:a,predicate:l}=qz(t);return Array.from(e.values()).find(o=>(typeof n=="string"?o.type===n:o.predicate===l)&&o.effect===a)},$x=e=>{e.pending.forEach(t=>{t.abort(Lx)})},z4=(e,t)=>()=>{for(const n of t.keys())$x(n);e.clear()},aw=(e,t,n)=>{try{e(t,n)}catch(a){setTimeout(()=>{throw a},0)}},Iz=to(qn(`${zf}/add`),{withTypes:()=>Iz}),O4=qn(`${zf}/removeAll`),Lz=to(qn(`${zf}/remove`),{withTypes:()=>Lz}),k4=(...e)=>{console.error(`${zf}/error`,...e)},au=(e={})=>{const t=new Map,n=new Map,a=x=>{const j=n.get(x)??0;n.set(x,j+1)},l=x=>{const j=n.get(x)??1;j===1?n.delete(x):n.set(x,j-1)},{extra:o,onError:u=k4}=e;ey(u);const d=x=>(x.unsubscribe=()=>t.delete(x.id),t.set(x.id,x),j=>{x.unsubscribe(),j?.cancelActive&&$x(x)}),f=x=>{const j=nw(t,x)??Rz(x);return d(j)};to(f,{withTypes:()=>f});const p=x=>{const j=nw(t,x);return j&&(j.unsubscribe(),x.cancelActive&&$x(j)),!!j};to(p,{withTypes:()=>p});const h=async(x,j,N,S)=>{const C=new AbortController,E=A4(f,C.signal),w=[];try{x.pending.add(C),a(x),await Promise.resolve(x.effect(j,to({},N,{getOriginalState:S,condition:(z,k)=>E(z,k).then(Boolean),take:E,delay:Tz(C.signal),pause:Am(C.signal),extra:o,signal:C.signal,fork:E4(C.signal,w),unsubscribe:x.unsubscribe,subscribe:()=>{t.set(x.id,x)},cancelActiveListeners:()=>{x.pending.forEach((z,k,O)=>{z!==C&&(z.abort(Lx),O.delete(z))})},cancel:()=>{C.abort(Lx),x.pending.delete(C)},throwIfCancelled:()=>{Ds(C.signal)}})))}catch(z){z instanceof Af||aw(u,z,{raisedBy:"effect"})}finally{await Promise.all(w),C.abort(w4),l(x),x.pending.delete(C)}},v=z4(t,n);return{middleware:x=>j=>N=>{if(!pz(N))return j(N);if(Iz.match(N))return f(N.payload);if(O4.match(N)){v();return}if(Lz.match(N))return p(N.payload);let S=x.getState();const C=()=>{if(S===rw)throw new Error(gn(23));return S};let E;try{if(E=j(N),t.size>0){const w=x.getState(),z=Array.from(t.values());for(const k of z){let O=!1;try{O=k.predicate(N,w,S)}catch(P){O=!1,aw(u,P,{raisedBy:"predicate"})}O&&h(k,N,x,C)}}}finally{S=rw}return E},startListening:f,stopListening:p,clearListeners:v}};function gn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var D4={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},$z=tn({name:"chartLayout",initialState:D4,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var n,a,l,o;e.margin.top=(n=t.payload.top)!==null&&n!==void 0?n:0,e.margin.right=(a=t.payload.right)!==null&&a!==void 0?a:0,e.margin.bottom=(l=t.payload.bottom)!==null&&l!==void 0?l:0,e.margin.left=(o=t.payload.left)!==null&&o!==void 0?o:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:M4,setLayout:P4,setChartSize:T4,setScale:q4}=$z.actions,R4=$z.reducer;function Bz(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function it(e){return Number.isFinite(e)}function va(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function iw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Zl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?iw(Object(n),!0).forEach(function(a){I4(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function I4(e,t,n){return(t=L4(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L4(e){var t=$4(e,"string");return typeof t=="symbol"?t:t+""}function $4(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jt(e,t,n){return Rt(e)||Rt(t)?n:ha(t)?io(e,t,n):typeof t=="function"?t(e):n}var B4=(e,t,n)=>{if(t&&n){var{width:a,height:l}=n,{align:o,verticalAlign:u,layout:d}=t;if((d==="vertical"||d==="horizontal"&&u==="middle")&&o!=="center"&&De(e[o]))return Zl(Zl({},e),{},{[o]:e[o]+(a||0)});if((d==="horizontal"||d==="vertical"&&o==="center")&&u!=="middle"&&De(e[u]))return Zl(Zl({},e),{},{[u]:e[u]+(l||0)})}return e},ti=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",Uz=(e,t,n,a)=>{if(a)return e.map(d=>d.coordinate);var l,o,u=e.map(d=>(d.coordinate===t&&(l=!0),d.coordinate===n&&(o=!0),d.coordinate));return l||u.push(t),o||u.push(n),u},Fz=(e,t,n)=>{if(!e)return null;var{duplicateDomain:a,type:l,range:o,scale:u,realScaleType:d,isCategorical:f,categoricalDomain:p,tickCount:h,ticks:v,niceTicks:b,axisType:x}=e;if(!u)return null;var j=d==="scaleBand"&&u.bandwidth?u.bandwidth()/2:2,N=l==="category"&&u.bandwidth?u.bandwidth()/j:0;if(N=x==="angleAxis"&&o&&o.length>=2?Xr(o[0]-o[1])*2*N:N,v||b){var S=(v||b||[]).map((C,E)=>{var w=a?a.indexOf(C):C,z=u.map(w);return it(z)?{coordinate:z+N,value:C,offset:N,index:E}:null}).filter(Zr);return S}return f&&p?p.map((C,E)=>{var w=u.map(C);return it(w)?{coordinate:w+N,value:C,index:E,offset:N}:null}).filter(Zr):u.ticks&&h!=null?u.ticks(h).map((C,E)=>{var w=u.map(C);return it(w)?{coordinate:w+N,value:C,index:E,offset:N}:null}).filter(Zr):u.domain().map((C,E)=>{var w=u.map(C);return it(w)?{coordinate:w+N,value:a?a[C]:C,index:E,offset:N}:null}).filter(Zr)},U4=(e,t)=>{if(!t||t.length!==2||!De(t[0])||!De(t[1]))return e;var n=Math.min(t[0],t[1]),a=Math.max(t[0],t[1]),l=[e[0],e[1]];return(!De(e[0])||e[0]<n)&&(l[0]=n),(!De(e[1])||e[1]>a)&&(l[1]=a),l[0]>a&&(l[0]=a),l[1]<n&&(l[1]=n),l},F4=e=>{var t,n=e.length;if(!(n<=0)){var a=(t=e[0])===null||t===void 0?void 0:t.length;if(!(a==null||a<=0))for(var l=0;l<a;++l)for(var o=0,u=0,d=0;d<n;++d){var f=e[d],p=f?.[l];if(p!=null){var h=p[1],v=p[0],b=pa(h)?v:h;b>=0?(p[0]=o,o+=b,p[1]=o):(p[0]=u,u+=b,p[1]=u)}}}},G4=e=>{var t,n=e.length;if(!(n<=0)){var a=(t=e[0])===null||t===void 0?void 0:t.length;if(!(a==null||a<=0))for(var l=0;l<a;++l)for(var o=0,u=0;u<n;++u){var d=e[u],f=d?.[l];if(f!=null){var p=pa(f[1])?f[0]:f[1];p>=0?(f[0]=o,o+=p,f[1]=o):(f[0]=0,f[1]=0)}}}},H4={sign:F4,expand:bI,none:Ts,silhouette:yI,wiggle:jI,positive:G4},Q4=(e,t,n)=>{var a,l=(a=H4[n])!==null&&a!==void 0?a:Ts,o=xI().keys(t).value((d,f)=>Number(Jt(d,f,0))).order(zx).offset(l),u=o(e);return u.forEach((d,f)=>{d.forEach((p,h)=>{var v=Jt(e[h],t[f],0);Array.isArray(v)&&v.length===2&&De(v[0])&&De(v[1])&&(p[0]=v[0],p[1]=v[1])})}),u};function V4(e){return e==null?void 0:String(e)}function sw(e){var{axis:t,ticks:n,bandSize:a,entry:l,index:o,dataKey:u}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Rt(l[t.dataKey])){var d=WA(n,"value",l[t.dataKey]);if(d)return d.coordinate+a/2}return n!=null&&n[o]?n[o].coordinate+a/2:null}var f=Jt(l,Rt(u)?t.dataKey:u),p=t.scale.map(f);return De(p)?p:null}var lw=e=>{var{axis:t,ticks:n,offset:a,bandSize:l,entry:o,index:u}=e;if(t.type==="category")return n[u]?n[u].coordinate+a:null;var d=Jt(o,t.dataKey,t.scale.domain()[u]);if(Rt(d))return null;var f=t.scale.map(d);return De(f)?f-l/2+a:null},Y4=e=>{var{numericAxis:t}=e,n=t.scale.domain();if(t.type==="number"){var a=Math.min(n[0],n[1]),l=Math.max(n[0],n[1]);return a<=0&&l>=0?0:l<0?l:a}return n[0]},K4=e=>{var t=e.flat(2).filter(De);return[Math.min(...t),Math.max(...t)]},W4=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],X4=(e,t,n)=>{if(e!=null)return W4(Object.keys(e).reduce((a,l)=>{var o=e[l];if(!o)return a;var{stackedData:u}=o,d=u.reduce((f,p)=>{var h=Bz(p,t,n),v=K4(h);return!it(v[0])||!it(v[1])?f:[Math.min(f[0],v[0]),Math.max(f[1],v[1])]},[1/0,-1/0]);return[Math.min(d[0],a[0]),Math.max(d[1],a[1])]},[1/0,-1/0]))},ow=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,cw=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,lo=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var a=e.scale.bandwidth();if(!n||a>0)return a}if(e&&t&&t.length>=2){for(var l=yf(t,h=>h.coordinate),o=1/0,u=1,d=l.length;u<d;u++){var f=l[u],p=l[u-1];o=Math.min((f?.coordinate||0)-(p?.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0};function uw(e){var{tooltipEntrySettings:t,dataKey:n,payload:a,value:l,name:o}=e;return Zl(Zl({},t),{},{dataKey:n,payload:a,value:l,name:o})}function Of(e,t){if(e)return String(e);if(typeof t=="string")return t}var Z4=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},J4=(e,t)=>t==="centric"?e.angle:e.radius,ri=e=>e.layout.width,ni=e=>e.layout.height,eL=e=>e.layout.scale,Gz=e=>e.layout.margin,kf=ue(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Df=ue(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),tL="data-recharts-item-index",rL="data-recharts-item-id",iu=60;function dw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function $d(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dw(Object(n),!0).forEach(function(a){nL(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function nL(e,t,n){return(t=aL(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aL(e){var t=iL(e,"string");return typeof t=="symbol"?t:t+""}function iL(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sL=e=>e.brush.height;function lL(e){var t=Df(e);return t.reduce((n,a)=>{if(a.orientation==="left"&&!a.mirror&&!a.hide){var l=typeof a.width=="number"?a.width:iu;return n+l}return n},0)}function oL(e){var t=Df(e);return t.reduce((n,a)=>{if(a.orientation==="right"&&!a.mirror&&!a.hide){var l=typeof a.width=="number"?a.width:iu;return n+l}return n},0)}function cL(e){var t=kf(e);return t.reduce((n,a)=>a.orientation==="top"&&!a.mirror&&!a.hide?n+a.height:n,0)}function uL(e){var t=kf(e);return t.reduce((n,a)=>a.orientation==="bottom"&&!a.mirror&&!a.hide?n+a.height:n,0)}var fr=ue([ri,ni,Gz,sL,lL,oL,cL,uL,dz,T6],(e,t,n,a,l,o,u,d,f,p)=>{var h={left:(n.left||0)+l,right:(n.right||0)+o},v={top:(n.top||0)+u,bottom:(n.bottom||0)+d},b=$d($d({},v),h),x=b.bottom;b.bottom+=a,b=B4(b,f,p);var j=e-b.left-b.right,N=t-b.top-b.bottom;return $d($d({brushBottom:x},b),{},{width:Math.max(j,0),height:Math.max(N,0)})}),dL=ue(fr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),ty=ue(ri,ni,(e,t)=>({x:0,y:0,width:e,height:t})),mL=g.createContext(null),kr=()=>g.useContext(mL)!=null,Mf=e=>e.brush,Pf=ue([Mf,fr,Gz],(e,t,n)=>({height:e.height,x:De(e.x)?e.x:t.left,y:De(e.y)?e.y:t.top+t.height+t.brushBottom-(n?.bottom||0),width:De(e.width)?e.width:t.width})),qg={},Rg={},Ig={},mw;function fL(){return mw||(mw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,a,{signal:l,edges:o}={}){let u,d=null;const f=o!=null&&o.includes("leading"),p=o==null||o.includes("trailing"),h=()=>{d!==null&&(n.apply(u,d),u=void 0,d=null)},v=()=>{p&&h(),N()};let b=null;const x=()=>{b!=null&&clearTimeout(b),b=setTimeout(()=>{b=null,v()},a)},j=()=>{b!==null&&(clearTimeout(b),b=null)},N=()=>{j(),u=void 0,d=null},S=()=>{h()},C=function(...E){if(l?.aborted)return;u=this,d=E;const w=b==null;x(),f&&w&&h()};return C.schedule=x,C.cancel=N,C.flush=S,l?.addEventListener("abort",N,{once:!0}),C}e.debounce=t})(Ig)),Ig}var fw;function pL(){return fw||(fw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=fL();function n(a,l=0,o={}){typeof o!="object"&&(o={});const{leading:u=!1,trailing:d=!0,maxWait:f}=o,p=Array(2);u&&(p[0]="leading"),d&&(p[1]="trailing");let h,v=null;const b=t.debounce(function(...N){h=a.apply(this,N),v=null},l,{edges:p}),x=function(...N){return f!=null&&(v===null&&(v=Date.now()),Date.now()-v>=f)?(h=a.apply(this,N),v=Date.now(),b.cancel(),b.schedule(),h):(b.apply(this,N),h)},j=()=>(b.flush(),h);return x.cancel=b.cancel,x.flush=j,x}e.debounce=n})(Rg)),Rg}var pw;function hL(){return pw||(pw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pL();function n(a,l=0,o={}){const{leading:u=!0,trailing:d=!0}=o;return t.debounce(a,l,{leading:u,maxWait:l,trailing:d})}e.throttle=n})(qg)),qg}var Lg,hw;function vL(){return hw||(hw=1,Lg=hL().throttle),Lg}var gL=vL();const xL=ei(gL);var zm=function(t,n){for(var a=arguments.length,l=new Array(a>2?a-2:0),o=2;o<a;o++)l[o-2]=arguments[o];if(typeof console<"u"&&console.warn&&(n===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(n===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=0;console.warn(n.replace(/%s/g,()=>l[u++]))}},ca={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},Hz=(e,t,n)=>{var{width:a=ca.width,height:l=ca.height,aspect:o,maxHeight:u}=n,d=qs(a)?e:Number(a),f=qs(l)?t:Number(l);return o&&o>0&&(d?f=d/o:f&&(d=f*o),u&&f!=null&&f>u&&(f=u)),{calculatedWidth:d,calculatedHeight:f}},bL={width:0,height:0,overflow:"visible"},yL={width:0,overflowX:"visible"},jL={height:0,overflowY:"visible"},NL={},_L=e=>{var{width:t,height:n}=e,a=qs(t),l=qs(n);return a&&l?bL:a?yL:l?jL:NL};function SL(e){var{width:t,height:n,aspect:a}=e,l=t,o=n;return l===void 0&&o===void 0?(l=ca.width,o=ca.height):l===void 0?l=a&&a>0?void 0:ca.width:o===void 0&&(o=a&&a>0?void 0:ca.height),{width:l,height:o}}function Bx(){return Bx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Bx.apply(null,arguments)}function vw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function gw(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?vw(Object(n),!0).forEach(function(a){wL(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function wL(e,t,n){return(t=CL(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CL(e){var t=EL(e,"string");return typeof t=="symbol"?t:t+""}function EL(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qz=g.createContext(ca.initialDimension);function AL(e){return va(e.width)&&va(e.height)}function Vz(e){var{children:t,width:n,height:a}=e,l=g.useMemo(()=>({width:n,height:a}),[n,a]);return AL(l)?g.createElement(Qz.Provider,{value:l},t):null}var ry=()=>g.useContext(Qz),zL=g.forwardRef((e,t)=>{var{aspect:n,initialDimension:a=ca.initialDimension,width:l,height:o,minWidth:u=ca.minWidth,minHeight:d,maxHeight:f,children:p,debounce:h=ca.debounce,id:v,className:b,onResize:x,style:j={}}=e,N=g.useRef(null),S=g.useRef();S.current=x,g.useImperativeHandle(t,()=>N.current);var[C,E]=g.useState({containerWidth:a.width,containerHeight:a.height}),w=g.useCallback((D,L)=>{E(U=>{var $=Math.round(D),B=Math.round(L);return U.containerWidth===$&&U.containerHeight===B?U:{containerWidth:$,containerHeight:B}})},[]);g.useEffect(()=>{if(N.current==null||typeof ResizeObserver>"u")return Qs;var D=B=>{var re,se=B[0];if(se!=null){var{width:M,height:q}=se.contentRect;w(M,q),(re=S.current)===null||re===void 0||re.call(S,M,q)}};h>0&&(D=xL(D,h,{trailing:!0,leading:!1}));var L=new ResizeObserver(D),{width:U,height:$}=N.current.getBoundingClientRect();return w(U,$),L.observe(N.current),()=>{L.disconnect()}},[w,h]);var{containerWidth:z,containerHeight:k}=C;zm(!n||n>0,"The aspect(%s) must be greater than zero.",n);var{calculatedWidth:O,calculatedHeight:P}=Hz(z,k,{width:l,height:o,aspect:n,maxHeight:f});return zm(O!=null&&O>0||P!=null&&P>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,O,P,l,o,u,d,n),g.createElement("div",{id:v?"".concat(v):void 0,className:Nt("recharts-responsive-container",b),style:gw(gw({},j),{},{width:l,height:o,minWidth:u,minHeight:d,maxHeight:f}),ref:N},g.createElement("div",{style:_L({width:l,height:o})},g.createElement(Vz,{width:O,height:P},p)))}),xw=g.forwardRef((e,t)=>{var n=ry();if(va(n.width)&&va(n.height))return e.children;var{width:a,height:l}=SL({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:o,calculatedHeight:u}=Hz(void 0,void 0,{width:a,height:l,aspect:e.aspect,maxHeight:e.maxHeight});return De(o)&&De(u)?g.createElement(Vz,{width:o,height:u},e.children):g.createElement(zL,Bx({},e,{width:a,height:l,ref:t}))});function ny(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var Tf=()=>{var e,t=kr(),n=Ie(dL),a=Ie(Pf),l=(e=Ie(Mf))===null||e===void 0?void 0:e.padding;return!t||!a||!l?n:{width:a.width-l.left-l.right,height:a.height-l.top-l.bottom,x:l.left,y:l.top}},OL={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Yz=()=>{var e;return(e=Ie(fr))!==null&&e!==void 0?e:OL},Kz=()=>Ie(ri),Wz=()=>Ie(ni),vt=e=>e.layout.layoutType,Vs=()=>Ie(vt),Xz=()=>{var e=Vs();if(e==="horizontal"||e==="vertical")return e},Zz=e=>{var t=e.layout.layoutType;if(t==="centric"||t==="radial")return t},kL=()=>{var e=Vs();return e!==void 0},su=e=>{var t=Qt(),n=kr(),{width:a,height:l}=e,o=ry(),u=a,d=l;return o&&(u=o.width>0?o.width:a,d=o.height>0?o.height:l),g.useEffect(()=>{!n&&va(u)&&va(d)&&t(T4({width:u,height:d}))},[t,n,u,d]),null},Jz=Symbol.for("immer-nothing"),bw=Symbol.for("immer-draftable"),xn=Symbol.for("immer-state");function Gn(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Bc=Object.getPrototypeOf;function oo(e){return!!e&&!!e[xn]}function Is(e){return e?eO(e)||Array.isArray(e)||!!e[bw]||!!e.constructor?.[bw]||lu(e)||Rf(e):!1}var DL=Object.prototype.constructor.toString(),yw=new WeakMap;function eO(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let a=yw.get(n);return a===void 0&&(a=Function.toString.call(n),yw.set(n,a)),a===DL}function Om(e,t,n=!0){qf(e)===0?(n?Reflect.ownKeys(e):Object.keys(e)).forEach(l=>{t(l,e[l],e)}):e.forEach((a,l)=>t(l,a,e))}function qf(e){const t=e[xn];return t?t.type_:Array.isArray(e)?1:lu(e)?2:Rf(e)?3:0}function Ux(e,t){return qf(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function tO(e,t,n){const a=qf(e);a===2?e.set(t,n):a===3?e.add(n):e[t]=n}function ML(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function lu(e){return e instanceof Map}function Rf(e){return e instanceof Set}function _s(e){return e.copy_||e.base_}function Fx(e,t){if(lu(e))return new Map(e);if(Rf(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=eO(e);if(t===!0||t==="class_only"&&!n){const a=Object.getOwnPropertyDescriptors(e);delete a[xn];let l=Reflect.ownKeys(a);for(let o=0;o<l.length;o++){const u=l[o],d=a[u];d.writable===!1&&(d.writable=!0,d.configurable=!0),(d.get||d.set)&&(a[u]={configurable:!0,writable:!0,enumerable:d.enumerable,value:e[u]})}return Object.create(Bc(e),a)}else{const a=Bc(e);if(a!==null&&n)return{...e};const l=Object.create(a);return Object.assign(l,e)}}function ay(e,t=!1){return If(e)||oo(e)||!Is(e)||(qf(e)>1&&Object.defineProperties(e,{set:Bd,add:Bd,clear:Bd,delete:Bd}),Object.freeze(e),t&&Object.values(e).forEach(n=>ay(n,!0))),e}function PL(){Gn(2)}var Bd={value:PL};function If(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var TL={};function Ls(e){const t=TL[e];return t||Gn(0,e),t}var Uc;function rO(){return Uc}function qL(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function jw(e,t){t&&(Ls("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Gx(e){Hx(e),e.drafts_.forEach(RL),e.drafts_=null}function Hx(e){e===Uc&&(Uc=e.parent_)}function Nw(e){return Uc=qL(Uc,e)}function RL(e){const t=e[xn];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function _w(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[xn].modified_&&(Gx(t),Gn(4)),Is(e)&&(e=km(t,e),t.parent_||Dm(t,e)),t.patches_&&Ls("Patches").generateReplacementPatches_(n[xn].base_,e,t.patches_,t.inversePatches_)):e=km(t,n,[]),Gx(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Jz?e:void 0}function km(e,t,n){if(If(t))return t;const a=e.immer_.shouldUseStrictIteration(),l=t[xn];if(!l)return Om(t,(o,u)=>Sw(e,l,t,o,u,n),a),t;if(l.scope_!==e)return t;if(!l.modified_)return Dm(e,l.base_,!0),l.base_;if(!l.finalized_){l.finalized_=!0,l.scope_.unfinalizedDrafts_--;const o=l.copy_;let u=o,d=!1;l.type_===3&&(u=new Set(o),o.clear(),d=!0),Om(u,(f,p)=>Sw(e,l,o,f,p,n,d),a),Dm(e,o,!1),n&&e.patches_&&Ls("Patches").generatePatches_(l,n,e.patches_,e.inversePatches_)}return l.copy_}function Sw(e,t,n,a,l,o,u){if(l==null||typeof l!="object"&&!u)return;const d=If(l);if(!(d&&!u)){if(oo(l)){const f=o&&t&&t.type_!==3&&!Ux(t.assigned_,a)?o.concat(a):void 0,p=km(e,l,f);if(tO(n,a,p),oo(p))e.canAutoFreeze_=!1;else return}else u&&n.add(l);if(Is(l)&&!d){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[a]===l&&d)return;km(e,l),(!t||!t.scope_.parent_)&&typeof a!="symbol"&&(lu(n)?n.has(a):Object.prototype.propertyIsEnumerable.call(n,a))&&Dm(e,l)}}}function Dm(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&ay(t,n)}function IL(e,t){const n=Array.isArray(e),a={type_:n?1:0,scope_:t?t.scope_:rO(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let l=a,o=iy;n&&(l=[a],o=Fc);const{revoke:u,proxy:d}=Proxy.revocable(l,o);return a.draft_=d,a.revoke_=u,d}var iy={get(e,t){if(t===xn)return e;const n=_s(e);if(!Ux(n,t))return LL(e,n,t);const a=n[t];return e.finalized_||!Is(a)?a:a===$g(e.base_,t)?(Bg(e),e.copy_[t]=Vx(a,e)):a},has(e,t){return t in _s(e)},ownKeys(e){return Reflect.ownKeys(_s(e))},set(e,t,n){const a=nO(_s(e),t);if(a?.set)return a.set.call(e.draft_,n),!0;if(!e.modified_){const l=$g(_s(e),t),o=l?.[xn];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(ML(n,l)&&(n!==void 0||Ux(e.base_,t)))return!0;Bg(e),Qx(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return $g(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Bg(e),Qx(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=_s(e),a=Reflect.getOwnPropertyDescriptor(n,t);return a&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:a.enumerable,value:n[t]}},defineProperty(){Gn(11)},getPrototypeOf(e){return Bc(e.base_)},setPrototypeOf(){Gn(12)}},Fc={};Om(iy,(e,t)=>{Fc[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Fc.deleteProperty=function(e,t){return Fc.set.call(this,e,t,void 0)};Fc.set=function(e,t,n){return iy.set.call(this,e[0],t,n,e[0])};function $g(e,t){const n=e[xn];return(n?_s(n):e)[t]}function LL(e,t,n){const a=nO(t,n);return a?"value"in a?a.value:a.get?.call(e.draft_):void 0}function nO(e,t){if(!(t in e))return;let n=Bc(e);for(;n;){const a=Object.getOwnPropertyDescriptor(n,t);if(a)return a;n=Bc(n)}}function Qx(e){e.modified_||(e.modified_=!0,e.parent_&&Qx(e.parent_))}function Bg(e){e.copy_||(e.copy_=Fx(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var $L=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,n,a)=>{if(typeof t=="function"&&typeof n!="function"){const o=n;n=t;const u=this;return function(f=o,...p){return u.produce(f,h=>n.call(this,h,...p))}}typeof n!="function"&&Gn(6),a!==void 0&&typeof a!="function"&&Gn(7);let l;if(Is(t)){const o=Nw(this),u=Vx(t,void 0);let d=!0;try{l=n(u),d=!1}finally{d?Gx(o):Hx(o)}return jw(o,a),_w(l,o)}else if(!t||typeof t!="object"){if(l=n(t),l===void 0&&(l=t),l===Jz&&(l=void 0),this.autoFreeze_&&ay(l,!0),a){const o=[],u=[];Ls("Patches").generateReplacementPatches_(t,l,o,u),a(o,u)}return l}else Gn(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(u,...d)=>this.produceWithPatches(u,f=>t(f,...d));let a,l;return[this.produce(t,n,(u,d)=>{a=u,l=d}),a,l]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Is(e)||Gn(8),oo(e)&&(e=BL(e));const t=Nw(this),n=Vx(e,void 0);return n[xn].isManual_=!0,Hx(t),n}finishDraft(e,t){const n=e&&e[xn];(!n||!n.isManual_)&&Gn(9);const{scope_:a}=n;return jw(a,t),_w(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const l=t[n];if(l.path.length===0&&l.op==="replace"){e=l.value;break}}n>-1&&(t=t.slice(n+1));const a=Ls("Patches").applyPatches_;return oo(e)?a(e,t):this.produce(e,l=>a(l,t))}};function Vx(e,t){const n=lu(e)?Ls("MapSet").proxyMap_(e,t):Rf(e)?Ls("MapSet").proxySet_(e,t):IL(e,t);return(t?t.scope_:rO()).drafts_.push(n),n}function BL(e){return oo(e)||Gn(10,e),aO(e)}function aO(e){if(!Is(e)||If(e))return e;const t=e[xn];let n,a=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Fx(e,t.scope_.immer_.useStrictShallowCopy_),a=t.scope_.immer_.shouldUseStrictIteration()}else n=Fx(e,!0);return Om(n,(l,o)=>{tO(n,l,aO(o))},a),t&&(t.finalized_=!1),n}var UL=new $L;UL.produce;var FL={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},iO=tn({name:"legend",initialState:FL,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Dt()},replaceLegendPayload:{reducer(e,t){var{prev:n,next:a}=t.payload,l=Qn(e).payload.indexOf(n);l>-1&&(e.payload[l]=a)},prepare:Dt()},removeLegendPayload:{reducer(e,t){var n=Qn(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)},prepare:Dt()}}}),{setLegendSize:Hee,setLegendSettings:Qee,addLegendPayload:GL,replaceLegendPayload:HL,removeLegendPayload:QL}=iO.actions,VL=iO.reducer;function Yx(){return Yx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Yx.apply(null,arguments)}function ww(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function vc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ww(Object(n),!0).forEach(function(a){YL(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ww(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function YL(e,t,n){return(t=KL(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KL(e){var t=WL(e,"string");return typeof t=="symbol"?t:t+""}function WL(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XL(e){return Array.isArray(e)&&ha(e[0])&&ha(e[1])?e.join(" ~ "):e}var Fl={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},ZL=e=>{var{separator:t=Fl.separator,contentStyle:n,itemStyle:a,labelStyle:l=Fl.labelStyle,payload:o,formatter:u,itemSorter:d,wrapperClassName:f,labelClassName:p,label:h,labelFormatter:v,accessibilityLayer:b=Fl.accessibilityLayer}=e,x=()=>{if(o&&o.length){var k={padding:0,margin:0},O=(d?yf(o,d):o).map((P,D)=>{if(P.type==="none")return null;var L=P.formatter||u||XL,{value:U,name:$}=P,B=U,re=$;if(L){var se=L(U,$,P,D,o);if(Array.isArray(se))[B,re]=se;else if(se!=null)B=se;else return null}var M=vc(vc({},Fl.itemStyle),{},{color:P.color||Fl.itemStyle.color},a);return g.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(D),style:M},ha(re)?g.createElement("span",{className:"recharts-tooltip-item-name"},re):null,ha(re)?g.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,g.createElement("span",{className:"recharts-tooltip-item-value"},B),g.createElement("span",{className:"recharts-tooltip-item-unit"},P.unit||""))});return g.createElement("ul",{className:"recharts-tooltip-item-list",style:k},O)}return null},j=vc(vc({},Fl.contentStyle),n),N=vc({margin:0},l),S=!Rt(h),C=S?h:"",E=Nt("recharts-default-tooltip",f),w=Nt("recharts-tooltip-label",p);S&&v&&o!==void 0&&o!==null&&(C=v(h,o));var z=b?{role:"status","aria-live":"assertive"}:{};return g.createElement("div",Yx({className:E,style:j},z),g.createElement("p",{className:w,style:N},g.isValidElement(C)?C:"".concat(C)),x())},gc="recharts-tooltip-wrapper",JL={visibility:"hidden"};function e8(e){var{coordinate:t,translateX:n,translateY:a}=e;return Nt(gc,{["".concat(gc,"-right")]:De(n)&&t&&De(t.x)&&n>=t.x,["".concat(gc,"-left")]:De(n)&&t&&De(t.x)&&n<t.x,["".concat(gc,"-bottom")]:De(a)&&t&&De(t.y)&&a>=t.y,["".concat(gc,"-top")]:De(a)&&t&&De(t.y)&&a<t.y})}function Cw(e){var{allowEscapeViewBox:t,coordinate:n,key:a,offset:l,position:o,reverseDirection:u,tooltipDimension:d,viewBox:f,viewBoxDimension:p}=e;if(o&&De(o[a]))return o[a];var h=n[a]-d-(l>0?l:0),v=n[a]+l;if(t[a])return u[a]?h:v;var b=f[a];if(b==null)return 0;if(u[a]){var x=h,j=b;return x<j?Math.max(v,b):Math.max(h,b)}if(p==null)return 0;var N=v+d,S=b+p;return N>S?Math.max(h,b):Math.max(v,b)}function t8(e){var{translateX:t,translateY:n,useTranslate3d:a}=e;return{transform:a?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function r8(e){var{allowEscapeViewBox:t,coordinate:n,offsetTop:a,offsetLeft:l,position:o,reverseDirection:u,tooltipBox:d,useTranslate3d:f,viewBox:p}=e,h,v,b;return d.height>0&&d.width>0&&n?(v=Cw({allowEscapeViewBox:t,coordinate:n,key:"x",offset:l,position:o,reverseDirection:u,tooltipDimension:d.width,viewBox:p,viewBoxDimension:p.width}),b=Cw({allowEscapeViewBox:t,coordinate:n,key:"y",offset:a,position:o,reverseDirection:u,tooltipDimension:d.height,viewBox:p,viewBoxDimension:p.height}),h=t8({translateX:v,translateY:b,useTranslate3d:f})):h=JL,{cssProperties:h,cssClasses:e8({translateX:v,translateY:b,coordinate:n})}}function Ew(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Ud(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ew(Object(n),!0).forEach(function(a){Kx(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ew(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Kx(e,t,n){return(t=n8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n8(e){var t=a8(e,"string");return typeof t=="symbol"?t:t+""}function a8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class i8 extends g.PureComponent{constructor(){super(...arguments),Kx(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Kx(this,"handleKeyDown",t=>{if(t.key==="Escape"){var n,a,l,o;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==null&&n!==void 0?n:0,y:(l=(o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==null&&l!==void 0?l:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,n;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:n,animationDuration:a,animationEasing:l,children:o,coordinate:u,hasPayload:d,isAnimationActive:f,offset:p,position:h,reverseDirection:v,useTranslate3d:b,viewBox:x,wrapperStyle:j,lastBoundingBox:N,innerRef:S,hasPortalFromProps:C}=this.props,E=typeof p=="number"?p:p.x,w=typeof p=="number"?p:p.y,{cssClasses:z,cssProperties:k}=r8({allowEscapeViewBox:n,coordinate:u,offsetLeft:E,offsetTop:w,position:h,reverseDirection:v,tooltipBox:{height:N.height,width:N.width},useTranslate3d:b,viewBox:x}),O=C?{}:Ud(Ud({transition:f&&t?"transform ".concat(a,"ms ").concat(l):void 0},k),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&d?"visible":"hidden",position:"absolute",top:0,left:0}),P=Ud(Ud({},O),{},{visibility:!this.state.dismissed&&t&&d?"visible":"hidden"},j);return g.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:z,style:P,ref:S},o)}}var sO=()=>{var e;return(e=Ie(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function Wx(){return Wx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Wx.apply(null,arguments)}function Aw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function zw(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Aw(Object(n),!0).forEach(function(a){s8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Aw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function s8(e,t,n){return(t=l8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l8(e){var t=o8(e,"string");return typeof t=="symbol"?t:t+""}function o8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ow={curveBasisClosed:lI,curveBasisOpen:oI,curveBasis:sI,curveBumpX:QR,curveBumpY:VR,curveLinearClosed:cI,curveLinear:xf,curveMonotoneX:uI,curveMonotoneY:dI,curveNatural:mI,curveStep:fI,curveStepAfter:hI,curveStepBefore:pI},Mm=e=>it(e.x)&&it(e.y),kw=e=>e.base!=null&&Mm(e.base)&&Mm(e),xc=e=>e.x,bc=e=>e.y,c8=(e,t)=>{if(typeof e=="function")return e;var n="curve".concat(ru(e));if((n==="curveMonotone"||n==="curveBump")&&t){var a=Ow["".concat(n).concat(t==="vertical"?"Y":"X")];if(a)return a}return Ow[n]||xf},Dw={connectNulls:!1,type:"linear"},u8=e=>{var{type:t=Dw.type,points:n=[],baseLine:a,layout:l,connectNulls:o=Dw.connectNulls}=e,u=c8(t,l),d=o?n.filter(Mm):n;if(Array.isArray(a)){var f,p=n.map((j,N)=>zw(zw({},j),{},{base:a[N]}));l==="vertical"?f=Pd().y(bc).x1(xc).x0(j=>j.base.x):f=Pd().x(xc).y1(bc).y0(j=>j.base.y);var h=f.defined(kw).curve(u),v=o?p.filter(kw):p;return h(v)}var b;l==="vertical"&&De(a)?b=Pd().y(bc).x1(xc).x0(a):De(a)?b=Pd().x(xc).y1(bc).y0(a):b=RA().x(xc).y(bc);var x=b.defined(Mm).curve(u);return x(d)},lO=e=>{var{className:t,points:n,path:a,pathRef:l}=e,o=Vs();if((!n||!n.length)&&!a)return null;var u={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||o,connectNulls:e.connectNulls},d=n&&n.length?u8(u):a;return g.createElement("path",Wx({},Vn(e),Gb(e),{className:Nt("recharts-curve",t),d:d===null?void 0:d,ref:l}))},d8=["x","y","top","left","width","height","className"];function Xx(){return Xx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Xx.apply(null,arguments)}function Mw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function m8(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Mw(Object(n),!0).forEach(function(a){f8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function f8(e,t,n){return(t=p8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p8(e){var t=h8(e,"string");return typeof t=="symbol"?t:t+""}function h8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function v8(e,t){if(e==null)return{};var n,a,l=g8(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function g8(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var x8=(e,t,n,a,l,o)=>"M".concat(e,",").concat(l,"v").concat(a,"M").concat(o,",").concat(t,"h").concat(n),b8=e=>{var{x:t=0,y:n=0,top:a=0,left:l=0,width:o=0,height:u=0,className:d}=e,f=v8(e,d8),p=m8({x:t,y:n,top:a,left:l,width:o,height:u},f);return!De(t)||!De(n)||!De(o)||!De(u)||!De(a)||!De(l)?null:g.createElement("path",Xx({},Rr(p),{className:Nt("recharts-cross",d),d:x8(t,n,o,u,a,l)}))};function y8(e,t,n,a){var l=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-l:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-l,width:e==="horizontal"?a:n.width-1,height:e==="horizontal"?n.height-1:a}}function Pw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Tw(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Pw(Object(n),!0).forEach(function(a){j8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function j8(e,t,n){return(t=N8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N8(e){var t=_8(e,"string");return typeof t=="symbol"?t:t+""}function _8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S8=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),oO=(e,t,n)=>e.map(a=>"".concat(S8(a)," ").concat(t,"ms ").concat(n)).join(","),w8=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((n,a)=>n.filter(l=>a.includes(l))),Gc=(e,t)=>Object.keys(t).reduce((n,a)=>Tw(Tw({},n),{},{[a]:e(a,t[a])}),{});function qw(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function rr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qw(Object(n),!0).forEach(function(a){C8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function C8(e,t,n){return(t=E8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E8(e){var t=A8(e,"string");return typeof t=="symbol"?t:t+""}function A8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pm=(e,t,n)=>e+(t-e)*n,Zx=e=>{var{from:t,to:n}=e;return t!==n},cO=(e,t,n)=>{var a=Gc((l,o)=>{if(Zx(o)){var[u,d]=e(o.from,o.to,o.velocity);return rr(rr({},o),{},{from:u,velocity:d})}return o},t);return n<1?Gc((l,o)=>Zx(o)&&a[l]!=null?rr(rr({},o),{},{velocity:Pm(o.velocity,a[l].velocity,n),from:Pm(o.from,a[l].from,n)}):o,t):cO(e,a,n-1)};function z8(e,t,n,a,l,o){var u,d=a.reduce((b,x)=>rr(rr({},b),{},{[x]:{from:e[x],velocity:0,to:t[x]}}),{}),f=()=>Gc((b,x)=>x.from,d),p=()=>!Object.values(d).filter(Zx).length,h=null,v=b=>{u||(u=b);var x=b-u,j=x/n.dt;d=cO(n,d,j),l(rr(rr(rr({},e),t),f())),u=b,p()||(h=o.setTimeout(v))};return()=>(h=o.setTimeout(v),()=>{var b;(b=h)===null||b===void 0||b()})}function O8(e,t,n,a,l,o,u){var d=null,f=l.reduce((v,b)=>{var x=e[b],j=t[b];return x==null||j==null?v:rr(rr({},v),{},{[b]:[x,j]})},{}),p,h=v=>{p||(p=v);var b=(v-p)/a,x=Gc((N,S)=>Pm(...S,n(b)),f);if(o(rr(rr(rr({},e),t),x)),b<1)d=u.setTimeout(h);else{var j=Gc((N,S)=>Pm(...S,n(1)),f);o(rr(rr(rr({},e),t),j))}};return()=>(d=u.setTimeout(h),()=>{var v;(v=d)===null||v===void 0||v()})}const k8=(e,t,n,a,l,o)=>{var u=w8(e,t);return n==null?()=>(l(rr(rr({},e),t)),()=>{}):n.isStepper===!0?z8(e,t,n,u,l,o):O8(e,t,n,a,u,l,o)};var Tm=1e-4,uO=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],dO=(e,t)=>e.map((n,a)=>n*t**a).reduce((n,a)=>n+a),Rw=(e,t)=>n=>{var a=uO(e,t);return dO(a,n)},D8=(e,t)=>n=>{var a=uO(e,t),l=[...a.map((o,u)=>o*u).slice(1),0];return dO(l,n)},M8=e=>{var t,n=e.split("(");if(n.length!==2||n[0]!=="cubic-bezier")return null;var a=(t=n[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(a==null||a.length!==4)return null;var l=a.map(o=>parseFloat(o));return[l[0],l[1],l[2],l[3]]},P8=function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];if(n.length===1)switch(n[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var l=M8(n[0]);if(l)return l}}return n.length===4?n:[0,0,1,1]},T8=(e,t,n,a)=>{var l=Rw(e,n),o=Rw(t,a),u=D8(e,n),d=p=>p>1?1:p<0?0:p,f=p=>{for(var h=p>1?1:p,v=h,b=0;b<8;++b){var x=l(v)-h,j=u(v);if(Math.abs(x-h)<Tm||j<Tm)return o(v);v=d(v-x/j)}return o(v)};return f.isStepper=!1,f},Iw=function(){return T8(...P8(...arguments))},q8=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:a=8,dt:l=17}=t,o=(u,d,f)=>{var p=-(u-d)*n,h=f*a,v=f+(p-h)*l/1e3,b=f*l/1e3+u;return Math.abs(b-d)<Tm&&Math.abs(v)<Tm?[d,0]:[b,v]};return o.isStepper=!0,o.dt=l,o},R8=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Iw(e);case"spring":return q8();default:if(e.split("(")[0]==="cubic-bezier")return Iw(e)}return typeof e=="function"?e:null};function I8(e){var t,n=()=>null,a=!1,l=null,o=u=>{if(!a){if(Array.isArray(u)){if(!u.length)return;var d=u,[f,...p]=d;if(typeof f=="number"){l=e.setTimeout(o.bind(null,p),f);return}o(f),l=e.setTimeout(o.bind(null,p));return}typeof u=="string"&&(t=u,n(t)),typeof u=="object"&&(t=u,n(t)),typeof u=="function"&&u()}};return{stop:()=>{a=!0},start:u=>{a=!1,l&&(l(),l=null),o(u)},subscribe:u=>(n=u,()=>{n=()=>null}),getTimeoutController:()=>e}}class L8{setTimeout(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=performance.now(),l=null,o=u=>{u-a>=n?t(u):typeof requestAnimationFrame=="function"&&(l=requestAnimationFrame(o))};return l=requestAnimationFrame(o),()=>{l!=null&&cancelAnimationFrame(l)}}}function $8(){return I8(new L8)}var B8=g.createContext($8);function U8(e,t){var n=g.useContext(B8);return g.useMemo(()=>t??n(e),[e,t,n])}var F8=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Lf={isSsr:F8()},G8={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},Lw={t:0},Ug={t:1};function $f(e){var t=Lr(e,G8),{isActive:n,canBegin:a,duration:l,easing:o,begin:u,onAnimationEnd:d,onAnimationStart:f,children:p}=t,h=n==="auto"?!Lf.isSsr:n,v=U8(t.animationId,t.animationManager),[b,x]=g.useState(h?Lw:Ug),j=g.useRef(null);return g.useEffect(()=>{h||x(Ug)},[h]),g.useEffect(()=>{if(!h||!a)return Qs;var N=k8(Lw,Ug,R8(o),l,x,v.getTimeoutController()),S=()=>{j.current=N()};return v.start([f,u,S,l,d]),()=>{v.stop(),j.current&&j.current(),d()}},[h,a,l,o,u,f,d,v]),p(b.t)}function Bf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=g.useRef(Rc(t)),a=g.useRef(e);return a.current!==e&&(n.current=Rc(t),a.current=e),n.current}var H8=["radius"],Q8=["radius"],$w,Bw,Uw,Fw,Gw,Hw,Qw,Vw,Yw,Kw;function Ww(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Xw(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ww(Object(n),!0).forEach(function(a){V8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ww(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function V8(e,t,n){return(t=Y8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y8(e){var t=K8(e,"string");return typeof t=="symbol"?t:t+""}function K8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qm(){return qm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},qm.apply(null,arguments)}function Zw(e,t){if(e==null)return{};var n,a,l=W8(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function W8(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function ia(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Jw=(e,t,n,a,l)=>{var o=Li(n),u=Li(a),d=Math.min(Math.abs(o)/2,Math.abs(u)/2),f=u>=0?1:-1,p=o>=0?1:-1,h=u>=0&&o>=0||u<0&&o<0?1:0,v;if(d>0&&Array.isArray(l)){for(var b=[0,0,0,0],x=0,j=4;x<j;x++){var N,S=(N=l[x])!==null&&N!==void 0?N:0;b[x]=S>d?d:S}v=Ut($w||($w=ia(["M",",",""])),e,t+f*b[0]),b[0]>0&&(v+=Ut(Bw||(Bw=ia(["A ",",",",0,0,",",",",",""])),b[0],b[0],h,e+p*b[0],t)),v+=Ut(Uw||(Uw=ia(["L ",",",""])),e+n-p*b[1],t),b[1]>0&&(v+=Ut(Fw||(Fw=ia(["A ",",",",0,0,",`,
        `,",",""])),b[1],b[1],h,e+n,t+f*b[1])),v+=Ut(Gw||(Gw=ia(["L ",",",""])),e+n,t+a-f*b[2]),b[2]>0&&(v+=Ut(Hw||(Hw=ia(["A ",",",",0,0,",`,
        `,",",""])),b[2],b[2],h,e+n-p*b[2],t+a)),v+=Ut(Qw||(Qw=ia(["L ",",",""])),e+p*b[3],t+a),b[3]>0&&(v+=Ut(Vw||(Vw=ia(["A ",",",",0,0,",`,
        `,",",""])),b[3],b[3],h,e,t+a-f*b[3])),v+="Z"}else if(d>0&&l===+l&&l>0){var C=Math.min(d,l);v=Ut(Yw||(Yw=ia(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+f*C,C,C,h,e+p*C,t,e+n-p*C,t,C,C,h,e+n,t+f*C,e+n,t+a-f*C,C,C,h,e+n-p*C,t+a,e+p*C,t+a,C,C,h,e,t+a-f*C)}else v=Ut(Kw||(Kw=ia(["M ",","," h "," v "," h "," Z"])),e,t,n,a,-n);return v},eC={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},mO=e=>{var t=Lr(e,eC),n=g.useRef(null),[a,l]=g.useState(-1);g.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var F=n.current.getTotalLength();F&&l(F)}catch{}},[]);var{x:o,y:u,width:d,height:f,radius:p,className:h}=t,{animationEasing:v,animationDuration:b,animationBegin:x,isAnimationActive:j,isUpdateAnimationActive:N}=t,S=g.useRef(d),C=g.useRef(f),E=g.useRef(o),w=g.useRef(u),z=g.useMemo(()=>({x:o,y:u,width:d,height:f,radius:p}),[o,u,d,f,p]),k=Bf(z,"rectangle-");if(o!==+o||u!==+u||d!==+d||f!==+f||d===0||f===0)return null;var O=Nt("recharts-rectangle",h);if(!N){var P=Rr(t),{radius:D}=P,L=Zw(P,H8);return g.createElement("path",qm({},L,{x:Li(o),y:Li(u),width:Li(d),height:Li(f),radius:typeof p=="number"?p:void 0,className:O,d:Jw(o,u,d,f,p)}))}var U=S.current,$=C.current,B=E.current,re=w.current,se="0px ".concat(a===-1?1:a,"px"),M="".concat(a,"px 0px"),q=oO(["strokeDasharray"],b,typeof v=="string"?v:eC.animationEasing);return g.createElement($f,{animationId:k,key:k,canBegin:a>0,duration:b,easing:v,isActive:N,begin:x},F=>{var R=Ft(U,d,F),K=Ft($,f,F),I=Ft(B,o,F),te=Ft(re,u,F);n.current&&(S.current=R,C.current=K,E.current=I,w.current=te);var Y;j?F>0?Y={transition:q,strokeDasharray:M}:Y={strokeDasharray:se}:Y={strokeDasharray:M};var oe=Rr(t),{radius:he}=oe,ge=Zw(oe,Q8);return g.createElement("path",qm({},ge,{radius:typeof p=="number"?p:void 0,className:O,d:Jw(I,te,R,K,p),ref:n,style:Xw(Xw({},Y),t.style)}))})};function tC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function rC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tC(Object(n),!0).forEach(function(a){X8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tC(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function X8(e,t,n){return(t=Z8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Z8(e){var t=J8(e,"string");return typeof t=="symbol"?t:t+""}function J8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rm=Math.PI/180,e$=e=>e*180/Math.PI,wr=(e,t,n,a)=>({x:e+Math.cos(-Rm*a)*n,y:t+Math.sin(-Rm*a)*n}),t$=function(t,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(a.left||0)-(a.right||0)),Math.abs(n-(a.top||0)-(a.bottom||0)))/2},r$=(e,t)=>{var{x:n,y:a}=e,{x:l,y:o}=t;return Math.sqrt((n-l)**2+(a-o)**2)},n$=(e,t)=>{var{x:n,y:a}=e,{cx:l,cy:o}=t,u=r$({x:n,y:a},{x:l,y:o});if(u<=0)return{radius:u,angle:0};var d=(n-l)/u,f=Math.acos(d);return a>o&&(f=2*Math.PI-f),{radius:u,angle:e$(f),angleInRadian:f}},a$=e=>{var{startAngle:t,endAngle:n}=e,a=Math.floor(t/360),l=Math.floor(n/360),o=Math.min(a,l);return{startAngle:t-o*360,endAngle:n-o*360}},i$=(e,t)=>{var{startAngle:n,endAngle:a}=t,l=Math.floor(n/360),o=Math.floor(a/360),u=Math.min(l,o);return e+u*360},s$=(e,t)=>{var{chartX:n,chartY:a}=e,{radius:l,angle:o}=n$({x:n,y:a},t),{innerRadius:u,outerRadius:d}=t;if(l<u||l>d||l===0)return null;var{startAngle:f,endAngle:p}=a$(t),h=o,v;if(f<=p){for(;h>p;)h-=360;for(;h<f;)h+=360;v=h>=f&&h<=p}else{for(;h>f;)h-=360;for(;h<p;)h+=360;v=h>=p&&h<=f}return v?rC(rC({},t),{},{radius:l,angle:i$(h,t)}):null};function fO(e){var{cx:t,cy:n,radius:a,startAngle:l,endAngle:o}=e,u=wr(t,n,a,l),d=wr(t,n,a,o);return{points:[u,d],cx:t,cy:n,radius:a,startAngle:l,endAngle:o}}var nC,aC,iC,sC,lC,oC,cC;function Jx(){return Jx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Jx.apply(null,arguments)}function ws(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var l$=(e,t)=>{var n=Xr(t-e),a=Math.min(Math.abs(t-e),359.999);return n*a},Fd=e=>{var{cx:t,cy:n,radius:a,angle:l,sign:o,isExternal:u,cornerRadius:d,cornerIsExternal:f}=e,p=d*(u?1:-1)+a,h=Math.asin(d/p)/Rm,v=f?l:l+o*h,b=wr(t,n,p,v),x=wr(t,n,a,v),j=f?l-o*h:l,N=wr(t,n,p*Math.cos(h*Rm),j);return{center:b,circleTangency:x,lineTangency:N,theta:h}},pO=e=>{var{cx:t,cy:n,innerRadius:a,outerRadius:l,startAngle:o,endAngle:u}=e,d=l$(o,u),f=o+d,p=wr(t,n,l,o),h=wr(t,n,l,f),v=Ut(nC||(nC=ws(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),p.x,p.y,l,l,+(Math.abs(d)>180),+(o>f),h.x,h.y);if(a>0){var b=wr(t,n,a,o),x=wr(t,n,a,f);v+=Ut(aC||(aC=ws(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),x.x,x.y,a,a,+(Math.abs(d)>180),+(o<=f),b.x,b.y)}else v+=Ut(iC||(iC=ws(["L ",","," Z"])),t,n);return v},o$=e=>{var{cx:t,cy:n,innerRadius:a,outerRadius:l,cornerRadius:o,forceCornerRadius:u,cornerIsExternal:d,startAngle:f,endAngle:p}=e,h=Xr(p-f),{circleTangency:v,lineTangency:b,theta:x}=Fd({cx:t,cy:n,radius:l,angle:f,sign:h,cornerRadius:o,cornerIsExternal:d}),{circleTangency:j,lineTangency:N,theta:S}=Fd({cx:t,cy:n,radius:l,angle:p,sign:-h,cornerRadius:o,cornerIsExternal:d}),C=d?Math.abs(f-p):Math.abs(f-p)-x-S;if(C<0)return u?Ut(sC||(sC=ws(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),b.x,b.y,o,o,o*2,o,o,-o*2):pO({cx:t,cy:n,innerRadius:a,outerRadius:l,startAngle:f,endAngle:p});var E=Ut(lC||(lC=ws(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),b.x,b.y,o,o,+(h<0),v.x,v.y,l,l,+(C>180),+(h<0),j.x,j.y,o,o,+(h<0),N.x,N.y);if(a>0){var{circleTangency:w,lineTangency:z,theta:k}=Fd({cx:t,cy:n,radius:a,angle:f,sign:h,isExternal:!0,cornerRadius:o,cornerIsExternal:d}),{circleTangency:O,lineTangency:P,theta:D}=Fd({cx:t,cy:n,radius:a,angle:p,sign:-h,isExternal:!0,cornerRadius:o,cornerIsExternal:d}),L=d?Math.abs(f-p):Math.abs(f-p)-k-D;if(L<0&&o===0)return"".concat(E,"L").concat(t,",").concat(n,"Z");E+=Ut(oC||(oC=ws(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),P.x,P.y,o,o,+(h<0),O.x,O.y,a,a,+(L>180),+(h>0),w.x,w.y,o,o,+(h<0),z.x,z.y)}else E+=Ut(cC||(cC=ws(["L",",","Z"])),t,n);return E},c$={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},hO=e=>{var t=Lr(e,c$),{cx:n,cy:a,innerRadius:l,outerRadius:o,cornerRadius:u,forceCornerRadius:d,cornerIsExternal:f,startAngle:p,endAngle:h,className:v}=t;if(o<l||p===h)return null;var b=Nt("recharts-sector",v),x=o-l,j=Yn(u,x,0,!0),N;return j>0&&Math.abs(p-h)<360?N=o$({cx:n,cy:a,innerRadius:l,outerRadius:o,cornerRadius:Math.min(j,x/2),forceCornerRadius:d,cornerIsExternal:f,startAngle:p,endAngle:h}):N=pO({cx:n,cy:a,innerRadius:l,outerRadius:o,startAngle:p,endAngle:h}),g.createElement("path",Jx({},Rr(t),{className:b,d:N}))};function u$(e,t,n){if(e==="horizontal")return[{x:t.x,y:n.top},{x:t.x,y:n.top+n.height}];if(e==="vertical")return[{x:n.left,y:t.y},{x:n.left+n.width,y:t.y}];if(JA(t)){if(e==="centric"){var{cx:a,cy:l,innerRadius:o,outerRadius:u,angle:d}=t,f=wr(a,l,o,d),p=wr(a,l,u,d);return[{x:f.x,y:f.y},{x:p.x,y:p.y}]}return fO(t)}}var Fg={},Gg={},Hg={},uC;function d$(){return uC||(uC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cz();function n(a){return t.isSymbol(a)?NaN:Number(a)}e.toNumber=n})(Hg)),Hg}var dC;function m$(){return dC||(dC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=d$();function n(a){return a?(a=t.toNumber(a),a===1/0||a===-1/0?(a<0?-1:1)*Number.MAX_VALUE:a===a?a:0):a===0?a:0}e.toFinite=n})(Gg)),Gg}var mC;function f$(){return mC||(mC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uz(),n=m$();function a(l,o,u){u&&typeof u!="number"&&t.isIterateeCall(l,o,u)&&(o=u=void 0),l=n.toFinite(l),o===void 0?(o=l,l=0):o=n.toFinite(o),u=u===void 0?l<o?1:-1:n.toFinite(u);const d=Math.max(Math.ceil((o-l)/(u||1)),0),f=new Array(d);for(let p=0;p<d;p++)f[p]=l,l+=u;return f}e.range=a})(Fg)),Fg}var Qg,fC;function p$(){return fC||(fC=1,Qg=f$().range),Qg}var h$=p$();const vO=ei(h$);function Bi(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function v$(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function sy(e){let t,n,a;e.length!==2?(t=Bi,n=(d,f)=>Bi(e(d),f),a=(d,f)=>e(d)-f):(t=e===Bi||e===v$?e:g$,n=e,a=e);function l(d,f,p=0,h=d.length){if(p<h){if(t(f,f)!==0)return h;do{const v=p+h>>>1;n(d[v],f)<0?p=v+1:h=v}while(p<h)}return p}function o(d,f,p=0,h=d.length){if(p<h){if(t(f,f)!==0)return h;do{const v=p+h>>>1;n(d[v],f)<=0?p=v+1:h=v}while(p<h)}return p}function u(d,f,p=0,h=d.length){const v=l(d,f,p,h-1);return v>p&&a(d[v-1],f)>-a(d[v],f)?v-1:v}return{left:l,center:u,right:o}}function g$(){return 0}function gO(e){return e===null?NaN:+e}function*x$(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const b$=sy(Bi),ou=b$.right;sy(gO).center;class pC extends Map{constructor(t,n=N$){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[a,l]of t)this.set(a,l)}get(t){return super.get(hC(this,t))}has(t){return super.has(hC(this,t))}set(t,n){return super.set(y$(this,t),n)}delete(t){return super.delete(j$(this,t))}}function hC({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):n}function y$({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):(e.set(a,n),n)}function j$({_intern:e,_key:t},n){const a=t(n);return e.has(a)&&(n=e.get(a),e.delete(a)),n}function N$(e){return e!==null&&typeof e=="object"?e.valueOf():e}function _$(e=Bi){if(e===Bi)return xO;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const a=e(t,n);return a||a===0?a:(e(n,n)===0)-(e(t,t)===0)}}function xO(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const S$=Math.sqrt(50),w$=Math.sqrt(10),C$=Math.sqrt(2);function Im(e,t,n){const a=(t-e)/Math.max(0,n),l=Math.floor(Math.log10(a)),o=a/Math.pow(10,l),u=o>=S$?10:o>=w$?5:o>=C$?2:1;let d,f,p;return l<0?(p=Math.pow(10,-l)/u,d=Math.round(e*p),f=Math.round(t*p),d/p<e&&++d,f/p>t&&--f,p=-p):(p=Math.pow(10,l)*u,d=Math.round(e/p),f=Math.round(t/p),d*p<e&&++d,f*p>t&&--f),f<d&&.5<=n&&n<2?Im(e,t,n*2):[d,f,p]}function eb(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const a=t<e,[l,o,u]=a?Im(t,e,n):Im(e,t,n);if(!(o>=l))return[];const d=o-l+1,f=new Array(d);if(a)if(u<0)for(let p=0;p<d;++p)f[p]=(o-p)/-u;else for(let p=0;p<d;++p)f[p]=(o-p)*u;else if(u<0)for(let p=0;p<d;++p)f[p]=(l+p)/-u;else for(let p=0;p<d;++p)f[p]=(l+p)*u;return f}function tb(e,t,n){return t=+t,e=+e,n=+n,Im(e,t,n)[2]}function rb(e,t,n){t=+t,e=+e,n=+n;const a=t<e,l=a?tb(t,e,n):tb(e,t,n);return(a?-1:1)*(l<0?1/-l:l)}function vC(e,t){let n;for(const a of e)a!=null&&(n<a||n===void 0&&a>=a)&&(n=a);return n}function gC(e,t){let n;for(const a of e)a!=null&&(n>a||n===void 0&&a>=a)&&(n=a);return n}function bO(e,t,n=0,a=1/0,l){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),a=Math.floor(Math.min(e.length-1,a)),!(n<=t&&t<=a))return e;for(l=l===void 0?xO:_$(l);a>n;){if(a-n>600){const f=a-n+1,p=t-n+1,h=Math.log(f),v=.5*Math.exp(2*h/3),b=.5*Math.sqrt(h*v*(f-v)/f)*(p-f/2<0?-1:1),x=Math.max(n,Math.floor(t-p*v/f+b)),j=Math.min(a,Math.floor(t+(f-p)*v/f+b));bO(e,t,x,j,l)}const o=e[t];let u=n,d=a;for(yc(e,n,t),l(e[a],o)>0&&yc(e,n,a);u<d;){for(yc(e,u,d),++u,--d;l(e[u],o)<0;)++u;for(;l(e[d],o)>0;)--d}l(e[n],o)===0?yc(e,n,d):(++d,yc(e,d,a)),d<=t&&(n=d+1),t<=d&&(a=d-1)}return e}function yc(e,t,n){const a=e[t];e[t]=e[n],e[n]=a}function E$(e,t,n){if(e=Float64Array.from(x$(e)),!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return gC(e);if(t>=1)return vC(e);var a,l=(a-1)*t,o=Math.floor(l),u=vC(bO(e,o).subarray(0,o+1)),d=gC(e.subarray(o+1));return u+(d-u)*(l-o)}}function A$(e,t,n=gO){if(!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return+n(e[0],0,e);if(t>=1)return+n(e[a-1],a-1,e);var a,l=(a-1)*t,o=Math.floor(l),u=+n(e[o],o,e),d=+n(e[o+1],o+1,e);return u+(d-u)*(l-o)}}function z$(e,t,n){e=+e,t=+t,n=(l=arguments.length)<2?(t=e,e=0,1):l<3?1:+n;for(var a=-1,l=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(l);++a<l;)o[a]=e+a*n;return o}function In(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ai(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const nb=Symbol("implicit");function ly(){var e=new pC,t=[],n=[],a=nb;function l(o){let u=e.get(o);if(u===void 0){if(a!==nb)return a;e.set(o,u=t.push(o)-1)}return n[u%n.length]}return l.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new pC;for(const u of o)e.has(u)||e.set(u,t.push(u)-1);return l},l.range=function(o){return arguments.length?(n=Array.from(o),l):n.slice()},l.unknown=function(o){return arguments.length?(a=o,l):a},l.copy=function(){return ly(t,n).unknown(a)},In.apply(l,arguments),l}function oy(){var e=ly().unknown(void 0),t=e.domain,n=e.range,a=0,l=1,o,u,d=!1,f=0,p=0,h=.5;delete e.unknown;function v(){var b=t().length,x=l<a,j=x?l:a,N=x?a:l;o=(N-j)/Math.max(1,b-f+p*2),d&&(o=Math.floor(o)),j+=(N-j-o*(b-f))*h,u=o*(1-f),d&&(j=Math.round(j),u=Math.round(u));var S=z$(b).map(function(C){return j+o*C});return n(x?S.reverse():S)}return e.domain=function(b){return arguments.length?(t(b),v()):t()},e.range=function(b){return arguments.length?([a,l]=b,a=+a,l=+l,v()):[a,l]},e.rangeRound=function(b){return[a,l]=b,a=+a,l=+l,d=!0,v()},e.bandwidth=function(){return u},e.step=function(){return o},e.round=function(b){return arguments.length?(d=!!b,v()):d},e.padding=function(b){return arguments.length?(f=Math.min(1,p=+b),v()):f},e.paddingInner=function(b){return arguments.length?(f=Math.min(1,b),v()):f},e.paddingOuter=function(b){return arguments.length?(p=+b,v()):p},e.align=function(b){return arguments.length?(h=Math.max(0,Math.min(1,b)),v()):h},e.copy=function(){return oy(t(),[a,l]).round(d).paddingInner(f).paddingOuter(p).align(h)},In.apply(v(),arguments)}function yO(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return yO(t())},e}function O$(){return yO(oy.apply(null,arguments).paddingInner(1))}function cy(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function jO(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function cu(){}var Hc=.7,Lm=1/Hc,ro="\\s*([+-]?\\d+)\\s*",Qc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ma="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",k$=/^#([0-9a-f]{3,8})$/,D$=new RegExp(`^rgb\\(${ro},${ro},${ro}\\)$`),M$=new RegExp(`^rgb\\(${ma},${ma},${ma}\\)$`),P$=new RegExp(`^rgba\\(${ro},${ro},${ro},${Qc}\\)$`),T$=new RegExp(`^rgba\\(${ma},${ma},${ma},${Qc}\\)$`),q$=new RegExp(`^hsl\\(${Qc},${ma},${ma}\\)$`),R$=new RegExp(`^hsla\\(${Qc},${ma},${ma},${Qc}\\)$`),xC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};cy(cu,Vc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:bC,formatHex:bC,formatHex8:I$,formatHsl:L$,formatRgb:yC,toString:yC});function bC(){return this.rgb().formatHex()}function I$(){return this.rgb().formatHex8()}function L$(){return NO(this).formatHsl()}function yC(){return this.rgb().formatRgb()}function Vc(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=k$.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?jC(t):n===3?new Jr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Gd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Gd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=D$.exec(e))?new Jr(t[1],t[2],t[3],1):(t=M$.exec(e))?new Jr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=P$.exec(e))?Gd(t[1],t[2],t[3],t[4]):(t=T$.exec(e))?Gd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=q$.exec(e))?SC(t[1],t[2]/100,t[3]/100,1):(t=R$.exec(e))?SC(t[1],t[2]/100,t[3]/100,t[4]):xC.hasOwnProperty(e)?jC(xC[e]):e==="transparent"?new Jr(NaN,NaN,NaN,0):null}function jC(e){return new Jr(e>>16&255,e>>8&255,e&255,1)}function Gd(e,t,n,a){return a<=0&&(e=t=n=NaN),new Jr(e,t,n,a)}function $$(e){return e instanceof cu||(e=Vc(e)),e?(e=e.rgb(),new Jr(e.r,e.g,e.b,e.opacity)):new Jr}function ab(e,t,n,a){return arguments.length===1?$$(e):new Jr(e,t,n,a??1)}function Jr(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}cy(Jr,ab,jO(cu,{brighter(e){return e=e==null?Lm:Math.pow(Lm,e),new Jr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Hc:Math.pow(Hc,e),new Jr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Jr(Ms(this.r),Ms(this.g),Ms(this.b),$m(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:NC,formatHex:NC,formatHex8:B$,formatRgb:_C,toString:_C}));function NC(){return`#${Cs(this.r)}${Cs(this.g)}${Cs(this.b)}`}function B$(){return`#${Cs(this.r)}${Cs(this.g)}${Cs(this.b)}${Cs((isNaN(this.opacity)?1:this.opacity)*255)}`}function _C(){const e=$m(this.opacity);return`${e===1?"rgb(":"rgba("}${Ms(this.r)}, ${Ms(this.g)}, ${Ms(this.b)}${e===1?")":`, ${e})`}`}function $m(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ms(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Cs(e){return e=Ms(e),(e<16?"0":"")+e.toString(16)}function SC(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Hn(e,t,n,a)}function NO(e){if(e instanceof Hn)return new Hn(e.h,e.s,e.l,e.opacity);if(e instanceof cu||(e=Vc(e)),!e)return new Hn;if(e instanceof Hn)return e;e=e.rgb();var t=e.r/255,n=e.g/255,a=e.b/255,l=Math.min(t,n,a),o=Math.max(t,n,a),u=NaN,d=o-l,f=(o+l)/2;return d?(t===o?u=(n-a)/d+(n<a)*6:n===o?u=(a-t)/d+2:u=(t-n)/d+4,d/=f<.5?o+l:2-o-l,u*=60):d=f>0&&f<1?0:u,new Hn(u,d,f,e.opacity)}function U$(e,t,n,a){return arguments.length===1?NO(e):new Hn(e,t,n,a??1)}function Hn(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}cy(Hn,U$,jO(cu,{brighter(e){return e=e==null?Lm:Math.pow(Lm,e),new Hn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Hc:Math.pow(Hc,e),new Hn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,l=2*n-a;return new Jr(Vg(e>=240?e-240:e+120,l,a),Vg(e,l,a),Vg(e<120?e+240:e-120,l,a),this.opacity)},clamp(){return new Hn(wC(this.h),Hd(this.s),Hd(this.l),$m(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=$m(this.opacity);return`${e===1?"hsl(":"hsla("}${wC(this.h)}, ${Hd(this.s)*100}%, ${Hd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function wC(e){return e=(e||0)%360,e<0?e+360:e}function Hd(e){return Math.max(0,Math.min(1,e||0))}function Vg(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const uy=e=>()=>e;function F$(e,t){return function(n){return e+n*t}}function G$(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(a){return Math.pow(e+a*t,n)}}function H$(e){return(e=+e)==1?_O:function(t,n){return n-t?G$(t,n,e):uy(isNaN(t)?n:t)}}function _O(e,t){var n=t-e;return n?F$(e,n):uy(isNaN(e)?t:e)}const CC=(function e(t){var n=H$(t);function a(l,o){var u=n((l=ab(l)).r,(o=ab(o)).r),d=n(l.g,o.g),f=n(l.b,o.b),p=_O(l.opacity,o.opacity);return function(h){return l.r=u(h),l.g=d(h),l.b=f(h),l.opacity=p(h),l+""}}return a.gamma=e,a})(1);function Q$(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,a=t.slice(),l;return function(o){for(l=0;l<n;++l)a[l]=e[l]*(1-o)+t[l]*o;return a}}function V$(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Y$(e,t){var n=t?t.length:0,a=e?Math.min(n,e.length):0,l=new Array(a),o=new Array(n),u;for(u=0;u<a;++u)l[u]=po(e[u],t[u]);for(;u<n;++u)o[u]=t[u];return function(d){for(u=0;u<a;++u)o[u]=l[u](d);return o}}function K$(e,t){var n=new Date;return e=+e,t=+t,function(a){return n.setTime(e*(1-a)+t*a),n}}function Bm(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function W$(e,t){var n={},a={},l;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(l in t)l in e?n[l]=po(e[l],t[l]):a[l]=t[l];return function(o){for(l in n)a[l]=n[l](o);return a}}var ib=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Yg=new RegExp(ib.source,"g");function X$(e){return function(){return e}}function Z$(e){return function(t){return e(t)+""}}function J$(e,t){var n=ib.lastIndex=Yg.lastIndex=0,a,l,o,u=-1,d=[],f=[];for(e=e+"",t=t+"";(a=ib.exec(e))&&(l=Yg.exec(t));)(o=l.index)>n&&(o=t.slice(n,o),d[u]?d[u]+=o:d[++u]=o),(a=a[0])===(l=l[0])?d[u]?d[u]+=l:d[++u]=l:(d[++u]=null,f.push({i:u,x:Bm(a,l)})),n=Yg.lastIndex;return n<t.length&&(o=t.slice(n),d[u]?d[u]+=o:d[++u]=o),d.length<2?f[0]?Z$(f[0].x):X$(t):(t=f.length,function(p){for(var h=0,v;h<t;++h)d[(v=f[h]).i]=v.x(p);return d.join("")})}function po(e,t){var n=typeof t,a;return t==null||n==="boolean"?uy(t):(n==="number"?Bm:n==="string"?(a=Vc(t))?(t=a,CC):J$:t instanceof Vc?CC:t instanceof Date?K$:V$(t)?Q$:Array.isArray(t)?Y$:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?W$:Bm)(e,t)}function dy(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function e7(e,t){t===void 0&&(t=e,e=po);for(var n=0,a=t.length-1,l=t[0],o=new Array(a<0?0:a);n<a;)o[n]=e(l,l=t[++n]);return function(u){var d=Math.max(0,Math.min(a-1,Math.floor(u*=a)));return o[d](u-d)}}function t7(e){return function(){return e}}function Um(e){return+e}var EC=[0,1];function Tr(e){return e}function sb(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:t7(isNaN(t)?NaN:.5)}function r7(e,t){var n;return e>t&&(n=e,e=t,t=n),function(a){return Math.max(e,Math.min(t,a))}}function n7(e,t,n){var a=e[0],l=e[1],o=t[0],u=t[1];return l<a?(a=sb(l,a),o=n(u,o)):(a=sb(a,l),o=n(o,u)),function(d){return o(a(d))}}function a7(e,t,n){var a=Math.min(e.length,t.length)-1,l=new Array(a),o=new Array(a),u=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++u<a;)l[u]=sb(e[u],e[u+1]),o[u]=n(t[u],t[u+1]);return function(d){var f=ou(e,d,1,a)-1;return o[f](l[f](d))}}function uu(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Uf(){var e=EC,t=EC,n=po,a,l,o,u=Tr,d,f,p;function h(){var b=Math.min(e.length,t.length);return u!==Tr&&(u=r7(e[0],e[b-1])),d=b>2?a7:n7,f=p=null,v}function v(b){return b==null||isNaN(b=+b)?o:(f||(f=d(e.map(a),t,n)))(a(u(b)))}return v.invert=function(b){return u(l((p||(p=d(t,e.map(a),Bm)))(b)))},v.domain=function(b){return arguments.length?(e=Array.from(b,Um),h()):e.slice()},v.range=function(b){return arguments.length?(t=Array.from(b),h()):t.slice()},v.rangeRound=function(b){return t=Array.from(b),n=dy,h()},v.clamp=function(b){return arguments.length?(u=b?!0:Tr,h()):u!==Tr},v.interpolate=function(b){return arguments.length?(n=b,h()):n},v.unknown=function(b){return arguments.length?(o=b,v):o},function(b,x){return a=b,l=x,h()}}function my(){return Uf()(Tr,Tr)}function i7(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Fm(e,t){if(!isFinite(e)||e===0)return null;var n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),a=e.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+e.slice(n+1)]}function co(e){return e=Fm(Math.abs(e)),e?e[1]:NaN}function s7(e,t){return function(n,a){for(var l=n.length,o=[],u=0,d=e[0],f=0;l>0&&d>0&&(f+d+1>a&&(d=Math.max(1,a-f)),o.push(n.substring(l-=d,l+d)),!((f+=d+1)>a));)d=e[u=(u+1)%e.length];return o.reverse().join(t)}}function l7(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var o7=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Yc(e){if(!(t=o7.exec(e)))throw new Error("invalid format: "+e);var t;return new fy({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Yc.prototype=fy.prototype;function fy(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}fy.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function c7(e){e:for(var t=e.length,n=1,a=-1,l;n<t;++n)switch(e[n]){case".":a=l=n;break;case"0":a===0&&(a=n),l=n;break;default:if(!+e[n])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(l+1):e}var Gm;function u7(e,t){var n=Fm(e,t);if(!n)return Gm=void 0,e.toPrecision(t);var a=n[0],l=n[1],o=l-(Gm=Math.max(-8,Math.min(8,Math.floor(l/3)))*3)+1,u=a.length;return o===u?a:o>u?a+new Array(o-u+1).join("0"):o>0?a.slice(0,o)+"."+a.slice(o):"0."+new Array(1-o).join("0")+Fm(e,Math.max(0,t+o-1))[0]}function AC(e,t){var n=Fm(e,t);if(!n)return e+"";var a=n[0],l=n[1];return l<0?"0."+new Array(-l).join("0")+a:a.length>l+1?a.slice(0,l+1)+"."+a.slice(l+1):a+new Array(l-a.length+2).join("0")}const zC={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:i7,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>AC(e*100,t),r:AC,s:u7,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function OC(e){return e}var kC=Array.prototype.map,DC=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function d7(e){var t=e.grouping===void 0||e.thousands===void 0?OC:s7(kC.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",l=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?OC:l7(kC.call(e.numerals,String)),u=e.percent===void 0?"%":e.percent+"",d=e.minus===void 0?"":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function p(v,b){v=Yc(v);var x=v.fill,j=v.align,N=v.sign,S=v.symbol,C=v.zero,E=v.width,w=v.comma,z=v.precision,k=v.trim,O=v.type;O==="n"?(w=!0,O="g"):zC[O]||(z===void 0&&(z=12),k=!0,O="g"),(C||x==="0"&&j==="=")&&(C=!0,x="0",j="=");var P=(b&&b.prefix!==void 0?b.prefix:"")+(S==="$"?n:S==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():""),D=(S==="$"?a:/[%p]/.test(O)?u:"")+(b&&b.suffix!==void 0?b.suffix:""),L=zC[O],U=/[defgprs%]/.test(O);z=z===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,z)):Math.max(0,Math.min(20,z));function $(B){var re=P,se=D,M,q,F;if(O==="c")se=L(B)+se,B="";else{B=+B;var R=B<0||1/B<0;if(B=isNaN(B)?f:L(Math.abs(B),z),k&&(B=c7(B)),R&&+B==0&&N!=="+"&&(R=!1),re=(R?N==="("?N:d:N==="-"||N==="("?"":N)+re,se=(O==="s"&&!isNaN(B)&&Gm!==void 0?DC[8+Gm/3]:"")+se+(R&&N==="("?")":""),U){for(M=-1,q=B.length;++M<q;)if(F=B.charCodeAt(M),48>F||F>57){se=(F===46?l+B.slice(M+1):B.slice(M))+se,B=B.slice(0,M);break}}}w&&!C&&(B=t(B,1/0));var K=re.length+B.length+se.length,I=K<E?new Array(E-K+1).join(x):"";switch(w&&C&&(B=t(I+B,I.length?E-se.length:1/0),I=""),j){case"<":B=re+B+se+I;break;case"=":B=re+I+B+se;break;case"^":B=I.slice(0,K=I.length>>1)+re+B+se+I.slice(K);break;default:B=I+re+B+se;break}return o(B)}return $.toString=function(){return v+""},$}function h(v,b){var x=Math.max(-8,Math.min(8,Math.floor(co(b)/3)))*3,j=Math.pow(10,-x),N=p((v=Yc(v),v.type="f",v),{suffix:DC[8+x/3]});return function(S){return N(j*S)}}return{format:p,formatPrefix:h}}var Qd,py,SO;m7({thousands:",",grouping:[3],currency:["$",""]});function m7(e){return Qd=d7(e),py=Qd.format,SO=Qd.formatPrefix,Qd}function f7(e){return Math.max(0,-co(Math.abs(e)))}function p7(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(co(t)/3)))*3-co(Math.abs(e)))}function h7(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,co(t)-co(e))+1}function wO(e,t,n,a){var l=rb(e,t,n),o;switch(a=Yc(a??",f"),a.type){case"s":{var u=Math.max(Math.abs(e),Math.abs(t));return a.precision==null&&!isNaN(o=p7(l,u))&&(a.precision=o),SO(a,u)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(o=h7(l,Math.max(Math.abs(e),Math.abs(t))))&&(a.precision=o-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(o=f7(l))&&(a.precision=o-(a.type==="%")*2);break}}return py(a)}function Wi(e){var t=e.domain;return e.ticks=function(n){var a=t();return eb(a[0],a[a.length-1],n??10)},e.tickFormat=function(n,a){var l=t();return wO(l[0],l[l.length-1],n??10,a)},e.nice=function(n){n==null&&(n=10);var a=t(),l=0,o=a.length-1,u=a[l],d=a[o],f,p,h=10;for(d<u&&(p=u,u=d,d=p,p=l,l=o,o=p);h-- >0;){if(p=tb(u,d,n),p===f)return a[l]=u,a[o]=d,t(a);if(p>0)u=Math.floor(u/p)*p,d=Math.ceil(d/p)*p;else if(p<0)u=Math.ceil(u*p)/p,d=Math.floor(d*p)/p;else break;f=p}return e},e}function CO(){var e=my();return e.copy=function(){return uu(e,CO())},In.apply(e,arguments),Wi(e)}function EO(e){var t;function n(a){return a==null||isNaN(a=+a)?t:a}return n.invert=n,n.domain=n.range=function(a){return arguments.length?(e=Array.from(a,Um),n):e.slice()},n.unknown=function(a){return arguments.length?(t=a,n):t},n.copy=function(){return EO(e).unknown(t)},e=arguments.length?Array.from(e,Um):[0,1],Wi(n)}function AO(e,t){e=e.slice();var n=0,a=e.length-1,l=e[n],o=e[a],u;return o<l&&(u=n,n=a,a=u,u=l,l=o,o=u),e[n]=t.floor(l),e[a]=t.ceil(o),e}function MC(e){return Math.log(e)}function PC(e){return Math.exp(e)}function v7(e){return-Math.log(-e)}function g7(e){return-Math.exp(-e)}function x7(e){return isFinite(e)?+("1e"+e):e<0?0:e}function b7(e){return e===10?x7:e===Math.E?Math.exp:t=>Math.pow(e,t)}function y7(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function TC(e){return(t,n)=>-e(-t,n)}function hy(e){const t=e(MC,PC),n=t.domain;let a=10,l,o;function u(){return l=y7(a),o=b7(a),n()[0]<0?(l=TC(l),o=TC(o),e(v7,g7)):e(MC,PC),t}return t.base=function(d){return arguments.length?(a=+d,u()):a},t.domain=function(d){return arguments.length?(n(d),u()):n()},t.ticks=d=>{const f=n();let p=f[0],h=f[f.length-1];const v=h<p;v&&([p,h]=[h,p]);let b=l(p),x=l(h),j,N;const S=d==null?10:+d;let C=[];if(!(a%1)&&x-b<S){if(b=Math.floor(b),x=Math.ceil(x),p>0){for(;b<=x;++b)for(j=1;j<a;++j)if(N=b<0?j/o(-b):j*o(b),!(N<p)){if(N>h)break;C.push(N)}}else for(;b<=x;++b)for(j=a-1;j>=1;--j)if(N=b>0?j/o(-b):j*o(b),!(N<p)){if(N>h)break;C.push(N)}C.length*2<S&&(C=eb(p,h,S))}else C=eb(b,x,Math.min(x-b,S)).map(o);return v?C.reverse():C},t.tickFormat=(d,f)=>{if(d==null&&(d=10),f==null&&(f=a===10?"s":","),typeof f!="function"&&(!(a%1)&&(f=Yc(f)).precision==null&&(f.trim=!0),f=py(f)),d===1/0)return f;const p=Math.max(1,a*d/t.ticks().length);return h=>{let v=h/o(Math.round(l(h)));return v*a<a-.5&&(v*=a),v<=p?f(h):""}},t.nice=()=>n(AO(n(),{floor:d=>o(Math.floor(l(d))),ceil:d=>o(Math.ceil(l(d)))})),t}function zO(){const e=hy(Uf()).domain([1,10]);return e.copy=()=>uu(e,zO()).base(e.base()),In.apply(e,arguments),e}function qC(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function RC(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function vy(e){var t=1,n=e(qC(t),RC(t));return n.constant=function(a){return arguments.length?e(qC(t=+a),RC(t)):t},Wi(n)}function OO(){var e=vy(Uf());return e.copy=function(){return uu(e,OO()).constant(e.constant())},In.apply(e,arguments)}function IC(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function j7(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function N7(e){return e<0?-e*e:e*e}function gy(e){var t=e(Tr,Tr),n=1;function a(){return n===1?e(Tr,Tr):n===.5?e(j7,N7):e(IC(n),IC(1/n))}return t.exponent=function(l){return arguments.length?(n=+l,a()):n},Wi(t)}function xy(){var e=gy(Uf());return e.copy=function(){return uu(e,xy()).exponent(e.exponent())},In.apply(e,arguments),e}function _7(){return xy.apply(null,arguments).exponent(.5)}function LC(e){return Math.sign(e)*e*e}function S7(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function kO(){var e=my(),t=[0,1],n=!1,a;function l(o){var u=S7(e(o));return isNaN(u)?a:n?Math.round(u):u}return l.invert=function(o){return e.invert(LC(o))},l.domain=function(o){return arguments.length?(e.domain(o),l):e.domain()},l.range=function(o){return arguments.length?(e.range((t=Array.from(o,Um)).map(LC)),l):t.slice()},l.rangeRound=function(o){return l.range(o).round(!0)},l.round=function(o){return arguments.length?(n=!!o,l):n},l.clamp=function(o){return arguments.length?(e.clamp(o),l):e.clamp()},l.unknown=function(o){return arguments.length?(a=o,l):a},l.copy=function(){return kO(e.domain(),t).round(n).clamp(e.clamp()).unknown(a)},In.apply(l,arguments),Wi(l)}function DO(){var e=[],t=[],n=[],a;function l(){var u=0,d=Math.max(1,t.length);for(n=new Array(d-1);++u<d;)n[u-1]=A$(e,u/d);return o}function o(u){return u==null||isNaN(u=+u)?a:t[ou(n,u)]}return o.invertExtent=function(u){var d=t.indexOf(u);return d<0?[NaN,NaN]:[d>0?n[d-1]:e[0],d<n.length?n[d]:e[e.length-1]]},o.domain=function(u){if(!arguments.length)return e.slice();e=[];for(let d of u)d!=null&&!isNaN(d=+d)&&e.push(d);return e.sort(Bi),l()},o.range=function(u){return arguments.length?(t=Array.from(u),l()):t.slice()},o.unknown=function(u){return arguments.length?(a=u,o):a},o.quantiles=function(){return n.slice()},o.copy=function(){return DO().domain(e).range(t).unknown(a)},In.apply(o,arguments)}function MO(){var e=0,t=1,n=1,a=[.5],l=[0,1],o;function u(f){return f!=null&&f<=f?l[ou(a,f,0,n)]:o}function d(){var f=-1;for(a=new Array(n);++f<n;)a[f]=((f+1)*t-(f-n)*e)/(n+1);return u}return u.domain=function(f){return arguments.length?([e,t]=f,e=+e,t=+t,d()):[e,t]},u.range=function(f){return arguments.length?(n=(l=Array.from(f)).length-1,d()):l.slice()},u.invertExtent=function(f){var p=l.indexOf(f);return p<0?[NaN,NaN]:p<1?[e,a[0]]:p>=n?[a[n-1],t]:[a[p-1],a[p]]},u.unknown=function(f){return arguments.length&&(o=f),u},u.thresholds=function(){return a.slice()},u.copy=function(){return MO().domain([e,t]).range(l).unknown(o)},In.apply(Wi(u),arguments)}function PO(){var e=[.5],t=[0,1],n,a=1;function l(o){return o!=null&&o<=o?t[ou(e,o,0,a)]:n}return l.domain=function(o){return arguments.length?(e=Array.from(o),a=Math.min(e.length,t.length-1),l):e.slice()},l.range=function(o){return arguments.length?(t=Array.from(o),a=Math.min(e.length,t.length-1),l):t.slice()},l.invertExtent=function(o){var u=t.indexOf(o);return[e[u-1],e[u]]},l.unknown=function(o){return arguments.length?(n=o,l):n},l.copy=function(){return PO().domain(e).range(t).unknown(n)},In.apply(l,arguments)}const Kg=new Date,Wg=new Date;function nr(e,t,n,a){function l(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return l.floor=o=>(e(o=new Date(+o)),o),l.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),l.round=o=>{const u=l(o),d=l.ceil(o);return o-u<d-o?u:d},l.offset=(o,u)=>(t(o=new Date(+o),u==null?1:Math.floor(u)),o),l.range=(o,u,d)=>{const f=[];if(o=l.ceil(o),d=d==null?1:Math.floor(d),!(o<u)||!(d>0))return f;let p;do f.push(p=new Date(+o)),t(o,d),e(o);while(p<o&&o<u);return f},l.filter=o=>nr(u=>{if(u>=u)for(;e(u),!o(u);)u.setTime(u-1)},(u,d)=>{if(u>=u)if(d<0)for(;++d<=0;)for(;t(u,-1),!o(u););else for(;--d>=0;)for(;t(u,1),!o(u););}),n&&(l.count=(o,u)=>(Kg.setTime(+o),Wg.setTime(+u),e(Kg),e(Wg),Math.floor(n(Kg,Wg))),l.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?l.filter(a?u=>a(u)%o===0:u=>l.count(0,u)%o===0):l)),l}const Hm=nr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Hm.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?nr(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Hm);Hm.range;const Ua=1e3,Mn=Ua*60,Fa=Mn*60,Ya=Fa*24,by=Ya*7,$C=Ya*30,Xg=Ya*365,Es=nr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ua)},(e,t)=>(t-e)/Ua,e=>e.getUTCSeconds());Es.range;const yy=nr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ua)},(e,t)=>{e.setTime(+e+t*Mn)},(e,t)=>(t-e)/Mn,e=>e.getMinutes());yy.range;const jy=nr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Mn)},(e,t)=>(t-e)/Mn,e=>e.getUTCMinutes());jy.range;const Ny=nr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ua-e.getMinutes()*Mn)},(e,t)=>{e.setTime(+e+t*Fa)},(e,t)=>(t-e)/Fa,e=>e.getHours());Ny.range;const _y=nr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Fa)},(e,t)=>(t-e)/Fa,e=>e.getUTCHours());_y.range;const du=nr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Mn)/Ya,e=>e.getDate()-1);du.range;const Ff=nr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ya,e=>e.getUTCDate()-1);Ff.range;const TO=nr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ya,e=>Math.floor(e/Ya));TO.range;function Ys(e){return nr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Mn)/by)}const Gf=Ys(0),Qm=Ys(1),w7=Ys(2),C7=Ys(3),uo=Ys(4),E7=Ys(5),A7=Ys(6);Gf.range;Qm.range;w7.range;C7.range;uo.range;E7.range;A7.range;function Ks(e){return nr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/by)}const Hf=Ks(0),Vm=Ks(1),z7=Ks(2),O7=Ks(3),mo=Ks(4),k7=Ks(5),D7=Ks(6);Hf.range;Vm.range;z7.range;O7.range;mo.range;k7.range;D7.range;const Sy=nr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Sy.range;const wy=nr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());wy.range;const Ka=nr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ka.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:nr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Ka.range;const Wa=nr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Wa.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:nr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Wa.range;function qO(e,t,n,a,l,o){const u=[[Es,1,Ua],[Es,5,5*Ua],[Es,15,15*Ua],[Es,30,30*Ua],[o,1,Mn],[o,5,5*Mn],[o,15,15*Mn],[o,30,30*Mn],[l,1,Fa],[l,3,3*Fa],[l,6,6*Fa],[l,12,12*Fa],[a,1,Ya],[a,2,2*Ya],[n,1,by],[t,1,$C],[t,3,3*$C],[e,1,Xg]];function d(p,h,v){const b=h<p;b&&([p,h]=[h,p]);const x=v&&typeof v.range=="function"?v:f(p,h,v),j=x?x.range(p,+h+1):[];return b?j.reverse():j}function f(p,h,v){const b=Math.abs(h-p)/v,x=sy(([,,S])=>S).right(u,b);if(x===u.length)return e.every(rb(p/Xg,h/Xg,v));if(x===0)return Hm.every(Math.max(rb(p,h,v),1));const[j,N]=u[b/u[x-1][2]<u[x][2]/b?x-1:x];return j.every(N)}return[d,f]}const[M7,P7]=qO(Wa,wy,Hf,TO,_y,jy),[T7,q7]=qO(Ka,Sy,Gf,du,Ny,yy);function Zg(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Jg(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function jc(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function R7(e){var t=e.dateTime,n=e.date,a=e.time,l=e.periods,o=e.days,u=e.shortDays,d=e.months,f=e.shortMonths,p=Nc(l),h=_c(l),v=Nc(o),b=_c(o),x=Nc(u),j=_c(u),N=Nc(d),S=_c(d),C=Nc(f),E=_c(f),w={a:F,A:R,b:K,B:I,c:null,d:QC,e:QC,f:sB,g:vB,G:xB,H:nB,I:aB,j:iB,L:RO,m:lB,M:oB,p:te,q:Y,Q:KC,s:WC,S:cB,u:uB,U:dB,V:mB,w:fB,W:pB,x:null,X:null,y:hB,Y:gB,Z:bB,"%":YC},z={a:oe,A:he,b:ge,B:Q,c:null,d:VC,e:VC,f:_B,g:MB,G:TB,H:yB,I:jB,j:NB,L:LO,m:SB,M:wB,p:ve,q:Me,Q:KC,s:WC,S:CB,u:EB,U:AB,V:zB,w:OB,W:kB,x:null,X:null,y:DB,Y:PB,Z:qB,"%":YC},k={a:U,A:$,b:B,B:re,c:se,d:GC,e:GC,f:J7,g:FC,G:UC,H:HC,I:HC,j:K7,L:Z7,m:Y7,M:W7,p:L,q:V7,Q:tB,s:rB,S:X7,u:U7,U:F7,V:G7,w:B7,W:H7,x:M,X:q,y:FC,Y:UC,Z:Q7,"%":eB};w.x=O(n,w),w.X=O(a,w),w.c=O(t,w),z.x=O(n,z),z.X=O(a,z),z.c=O(t,z);function O(ce,Z){return function(H){var de=[],we=-1,qe=0,We=ce.length,Xe,nt,gr;for(H instanceof Date||(H=new Date(+H));++we<We;)ce.charCodeAt(we)===37&&(de.push(ce.slice(qe,we)),(nt=BC[Xe=ce.charAt(++we)])!=null?Xe=ce.charAt(++we):nt=Xe==="e"?" ":"0",(gr=Z[Xe])&&(Xe=gr(H,nt)),de.push(Xe),qe=we+1);return de.push(ce.slice(qe,we)),de.join("")}}function P(ce,Z){return function(H){var de=jc(1900,void 0,1),we=D(de,ce,H+="",0),qe,We;if(we!=H.length)return null;if("Q"in de)return new Date(de.Q);if("s"in de)return new Date(de.s*1e3+("L"in de?de.L:0));if(Z&&!("Z"in de)&&(de.Z=0),"p"in de&&(de.H=de.H%12+de.p*12),de.m===void 0&&(de.m="q"in de?de.q:0),"V"in de){if(de.V<1||de.V>53)return null;"w"in de||(de.w=1),"Z"in de?(qe=Jg(jc(de.y,0,1)),We=qe.getUTCDay(),qe=We>4||We===0?Vm.ceil(qe):Vm(qe),qe=Ff.offset(qe,(de.V-1)*7),de.y=qe.getUTCFullYear(),de.m=qe.getUTCMonth(),de.d=qe.getUTCDate()+(de.w+6)%7):(qe=Zg(jc(de.y,0,1)),We=qe.getDay(),qe=We>4||We===0?Qm.ceil(qe):Qm(qe),qe=du.offset(qe,(de.V-1)*7),de.y=qe.getFullYear(),de.m=qe.getMonth(),de.d=qe.getDate()+(de.w+6)%7)}else("W"in de||"U"in de)&&("w"in de||(de.w="u"in de?de.u%7:"W"in de?1:0),We="Z"in de?Jg(jc(de.y,0,1)).getUTCDay():Zg(jc(de.y,0,1)).getDay(),de.m=0,de.d="W"in de?(de.w+6)%7+de.W*7-(We+5)%7:de.w+de.U*7-(We+6)%7);return"Z"in de?(de.H+=de.Z/100|0,de.M+=de.Z%100,Jg(de)):Zg(de)}}function D(ce,Z,H,de){for(var we=0,qe=Z.length,We=H.length,Xe,nt;we<qe;){if(de>=We)return-1;if(Xe=Z.charCodeAt(we++),Xe===37){if(Xe=Z.charAt(we++),nt=k[Xe in BC?Z.charAt(we++):Xe],!nt||(de=nt(ce,H,de))<0)return-1}else if(Xe!=H.charCodeAt(de++))return-1}return de}function L(ce,Z,H){var de=p.exec(Z.slice(H));return de?(ce.p=h.get(de[0].toLowerCase()),H+de[0].length):-1}function U(ce,Z,H){var de=x.exec(Z.slice(H));return de?(ce.w=j.get(de[0].toLowerCase()),H+de[0].length):-1}function $(ce,Z,H){var de=v.exec(Z.slice(H));return de?(ce.w=b.get(de[0].toLowerCase()),H+de[0].length):-1}function B(ce,Z,H){var de=C.exec(Z.slice(H));return de?(ce.m=E.get(de[0].toLowerCase()),H+de[0].length):-1}function re(ce,Z,H){var de=N.exec(Z.slice(H));return de?(ce.m=S.get(de[0].toLowerCase()),H+de[0].length):-1}function se(ce,Z,H){return D(ce,t,Z,H)}function M(ce,Z,H){return D(ce,n,Z,H)}function q(ce,Z,H){return D(ce,a,Z,H)}function F(ce){return u[ce.getDay()]}function R(ce){return o[ce.getDay()]}function K(ce){return f[ce.getMonth()]}function I(ce){return d[ce.getMonth()]}function te(ce){return l[+(ce.getHours()>=12)]}function Y(ce){return 1+~~(ce.getMonth()/3)}function oe(ce){return u[ce.getUTCDay()]}function he(ce){return o[ce.getUTCDay()]}function ge(ce){return f[ce.getUTCMonth()]}function Q(ce){return d[ce.getUTCMonth()]}function ve(ce){return l[+(ce.getUTCHours()>=12)]}function Me(ce){return 1+~~(ce.getUTCMonth()/3)}return{format:function(ce){var Z=O(ce+="",w);return Z.toString=function(){return ce},Z},parse:function(ce){var Z=P(ce+="",!1);return Z.toString=function(){return ce},Z},utcFormat:function(ce){var Z=O(ce+="",z);return Z.toString=function(){return ce},Z},utcParse:function(ce){var Z=P(ce+="",!0);return Z.toString=function(){return ce},Z}}}var BC={"-":"",_:" ",0:"0"},pr=/^\s*\d+/,I7=/^%/,L7=/[\\^$*+?|[\]().{}]/g;function ut(e,t,n){var a=e<0?"-":"",l=(a?-e:e)+"",o=l.length;return a+(o<n?new Array(n-o+1).join(t)+l:l)}function $7(e){return e.replace(L7,"\\$&")}function Nc(e){return new RegExp("^(?:"+e.map($7).join("|")+")","i")}function _c(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function B7(e,t,n){var a=pr.exec(t.slice(n,n+1));return a?(e.w=+a[0],n+a[0].length):-1}function U7(e,t,n){var a=pr.exec(t.slice(n,n+1));return a?(e.u=+a[0],n+a[0].length):-1}function F7(e,t,n){var a=pr.exec(t.slice(n,n+2));return a?(e.U=+a[0],n+a[0].length):-1}function G7(e,t,n){var a=pr.exec(t.slice(n,n+2));return a?(e.V=+a[0],n+a[0].length):-1}function H7(e,t,n){var a=pr.exec(t.slice(n,n+2));return a?(e.W=+a[0],n+a[0].length):-1}function UC(e,t,n){var a=pr.exec(t.slice(n,n+4));return a?(e.y=+a[0],n+a[0].length):-1}function FC(e,t,n){var a=pr.exec(t.slice(n,n+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function Q7(e,t,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function V7(e,t,n){var a=pr.exec(t.slice(n,n+1));return a?(e.q=a[0]*3-3,n+a[0].length):-1}function Y7(e,t,n){var a=pr.exec(t.slice(n,n+2));return a?(e.m=a[0]-1,n+a[0].length):-1}function GC(e,t,n){var a=pr.exec(t.slice(n,n+2));return a?(e.d=+a[0],n+a[0].length):-1}function K7(e,t,n){var a=pr.exec(t.slice(n,n+3));return a?(e.m=0,e.d=+a[0],n+a[0].length):-1}function HC(e,t,n){var a=pr.exec(t.slice(n,n+2));return a?(e.H=+a[0],n+a[0].length):-1}function W7(e,t,n){var a=pr.exec(t.slice(n,n+2));return a?(e.M=+a[0],n+a[0].length):-1}function X7(e,t,n){var a=pr.exec(t.slice(n,n+2));return a?(e.S=+a[0],n+a[0].length):-1}function Z7(e,t,n){var a=pr.exec(t.slice(n,n+3));return a?(e.L=+a[0],n+a[0].length):-1}function J7(e,t,n){var a=pr.exec(t.slice(n,n+6));return a?(e.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function eB(e,t,n){var a=I7.exec(t.slice(n,n+1));return a?n+a[0].length:-1}function tB(e,t,n){var a=pr.exec(t.slice(n));return a?(e.Q=+a[0],n+a[0].length):-1}function rB(e,t,n){var a=pr.exec(t.slice(n));return a?(e.s=+a[0],n+a[0].length):-1}function QC(e,t){return ut(e.getDate(),t,2)}function nB(e,t){return ut(e.getHours(),t,2)}function aB(e,t){return ut(e.getHours()%12||12,t,2)}function iB(e,t){return ut(1+du.count(Ka(e),e),t,3)}function RO(e,t){return ut(e.getMilliseconds(),t,3)}function sB(e,t){return RO(e,t)+"000"}function lB(e,t){return ut(e.getMonth()+1,t,2)}function oB(e,t){return ut(e.getMinutes(),t,2)}function cB(e,t){return ut(e.getSeconds(),t,2)}function uB(e){var t=e.getDay();return t===0?7:t}function dB(e,t){return ut(Gf.count(Ka(e)-1,e),t,2)}function IO(e){var t=e.getDay();return t>=4||t===0?uo(e):uo.ceil(e)}function mB(e,t){return e=IO(e),ut(uo.count(Ka(e),e)+(Ka(e).getDay()===4),t,2)}function fB(e){return e.getDay()}function pB(e,t){return ut(Qm.count(Ka(e)-1,e),t,2)}function hB(e,t){return ut(e.getFullYear()%100,t,2)}function vB(e,t){return e=IO(e),ut(e.getFullYear()%100,t,2)}function gB(e,t){return ut(e.getFullYear()%1e4,t,4)}function xB(e,t){var n=e.getDay();return e=n>=4||n===0?uo(e):uo.ceil(e),ut(e.getFullYear()%1e4,t,4)}function bB(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ut(t/60|0,"0",2)+ut(t%60,"0",2)}function VC(e,t){return ut(e.getUTCDate(),t,2)}function yB(e,t){return ut(e.getUTCHours(),t,2)}function jB(e,t){return ut(e.getUTCHours()%12||12,t,2)}function NB(e,t){return ut(1+Ff.count(Wa(e),e),t,3)}function LO(e,t){return ut(e.getUTCMilliseconds(),t,3)}function _B(e,t){return LO(e,t)+"000"}function SB(e,t){return ut(e.getUTCMonth()+1,t,2)}function wB(e,t){return ut(e.getUTCMinutes(),t,2)}function CB(e,t){return ut(e.getUTCSeconds(),t,2)}function EB(e){var t=e.getUTCDay();return t===0?7:t}function AB(e,t){return ut(Hf.count(Wa(e)-1,e),t,2)}function $O(e){var t=e.getUTCDay();return t>=4||t===0?mo(e):mo.ceil(e)}function zB(e,t){return e=$O(e),ut(mo.count(Wa(e),e)+(Wa(e).getUTCDay()===4),t,2)}function OB(e){return e.getUTCDay()}function kB(e,t){return ut(Vm.count(Wa(e)-1,e),t,2)}function DB(e,t){return ut(e.getUTCFullYear()%100,t,2)}function MB(e,t){return e=$O(e),ut(e.getUTCFullYear()%100,t,2)}function PB(e,t){return ut(e.getUTCFullYear()%1e4,t,4)}function TB(e,t){var n=e.getUTCDay();return e=n>=4||n===0?mo(e):mo.ceil(e),ut(e.getUTCFullYear()%1e4,t,4)}function qB(){return"+0000"}function YC(){return"%"}function KC(e){return+e}function WC(e){return Math.floor(+e/1e3)}var Gl,BO,UO;RB({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function RB(e){return Gl=R7(e),BO=Gl.format,Gl.parse,UO=Gl.utcFormat,Gl.utcParse,Gl}function IB(e){return new Date(e)}function LB(e){return e instanceof Date?+e:+new Date(+e)}function Cy(e,t,n,a,l,o,u,d,f,p){var h=my(),v=h.invert,b=h.domain,x=p(".%L"),j=p(":%S"),N=p("%I:%M"),S=p("%I %p"),C=p("%a %d"),E=p("%b %d"),w=p("%B"),z=p("%Y");function k(O){return(f(O)<O?x:d(O)<O?j:u(O)<O?N:o(O)<O?S:a(O)<O?l(O)<O?C:E:n(O)<O?w:z)(O)}return h.invert=function(O){return new Date(v(O))},h.domain=function(O){return arguments.length?b(Array.from(O,LB)):b().map(IB)},h.ticks=function(O){var P=b();return e(P[0],P[P.length-1],O??10)},h.tickFormat=function(O,P){return P==null?k:p(P)},h.nice=function(O){var P=b();return(!O||typeof O.range!="function")&&(O=t(P[0],P[P.length-1],O??10)),O?b(AO(P,O)):h},h.copy=function(){return uu(h,Cy(e,t,n,a,l,o,u,d,f,p))},h}function $B(){return In.apply(Cy(T7,q7,Ka,Sy,Gf,du,Ny,yy,Es,BO).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function BB(){return In.apply(Cy(M7,P7,Wa,wy,Hf,Ff,_y,jy,Es,UO).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Qf(){var e=0,t=1,n,a,l,o,u=Tr,d=!1,f;function p(v){return v==null||isNaN(v=+v)?f:u(l===0?.5:(v=(o(v)-n)*l,d?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t]=v,n=o(e=+e),a=o(t=+t),l=n===a?0:1/(a-n),p):[e,t]},p.clamp=function(v){return arguments.length?(d=!!v,p):d},p.interpolator=function(v){return arguments.length?(u=v,p):u};function h(v){return function(b){var x,j;return arguments.length?([x,j]=b,u=v(x,j),p):[u(0),u(1)]}}return p.range=h(po),p.rangeRound=h(dy),p.unknown=function(v){return arguments.length?(f=v,p):f},function(v){return o=v,n=v(e),a=v(t),l=n===a?0:1/(a-n),p}}function Xi(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function FO(){var e=Wi(Qf()(Tr));return e.copy=function(){return Xi(e,FO())},ai.apply(e,arguments)}function GO(){var e=hy(Qf()).domain([1,10]);return e.copy=function(){return Xi(e,GO()).base(e.base())},ai.apply(e,arguments)}function HO(){var e=vy(Qf());return e.copy=function(){return Xi(e,HO()).constant(e.constant())},ai.apply(e,arguments)}function Ey(){var e=gy(Qf());return e.copy=function(){return Xi(e,Ey()).exponent(e.exponent())},ai.apply(e,arguments)}function UB(){return Ey.apply(null,arguments).exponent(.5)}function QO(){var e=[],t=Tr;function n(a){if(a!=null&&!isNaN(a=+a))return t((ou(e,a,1)-1)/(e.length-1))}return n.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let l of a)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Bi),n},n.interpolator=function(a){return arguments.length?(t=a,n):t},n.range=function(){return e.map((a,l)=>t(l/(e.length-1)))},n.quantiles=function(a){return Array.from({length:a+1},(l,o)=>E$(e,o/a))},n.copy=function(){return QO(t).domain(e)},ai.apply(n,arguments)}function Vf(){var e=0,t=.5,n=1,a=1,l,o,u,d,f,p=Tr,h,v=!1,b;function x(N){return isNaN(N=+N)?b:(N=.5+((N=+h(N))-o)*(a*N<a*o?d:f),p(v?Math.max(0,Math.min(1,N)):N))}x.domain=function(N){return arguments.length?([e,t,n]=N,l=h(e=+e),o=h(t=+t),u=h(n=+n),d=l===o?0:.5/(o-l),f=o===u?0:.5/(u-o),a=o<l?-1:1,x):[e,t,n]},x.clamp=function(N){return arguments.length?(v=!!N,x):v},x.interpolator=function(N){return arguments.length?(p=N,x):p};function j(N){return function(S){var C,E,w;return arguments.length?([C,E,w]=S,p=e7(N,[C,E,w]),x):[p(0),p(.5),p(1)]}}return x.range=j(po),x.rangeRound=j(dy),x.unknown=function(N){return arguments.length?(b=N,x):b},function(N){return h=N,l=N(e),o=N(t),u=N(n),d=l===o?0:.5/(o-l),f=o===u?0:.5/(u-o),a=o<l?-1:1,x}}function VO(){var e=Wi(Vf()(Tr));return e.copy=function(){return Xi(e,VO())},ai.apply(e,arguments)}function YO(){var e=hy(Vf()).domain([.1,1,10]);return e.copy=function(){return Xi(e,YO()).base(e.base())},ai.apply(e,arguments)}function KO(){var e=vy(Vf());return e.copy=function(){return Xi(e,KO()).constant(e.constant())},ai.apply(e,arguments)}function Ay(){var e=gy(Vf());return e.copy=function(){return Xi(e,Ay()).exponent(e.exponent())},ai.apply(e,arguments)}function FB(){return Ay.apply(null,arguments).exponent(.5)}const Oc=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:oy,scaleDiverging:VO,scaleDivergingLog:YO,scaleDivergingPow:Ay,scaleDivergingSqrt:FB,scaleDivergingSymlog:KO,scaleIdentity:EO,scaleImplicit:nb,scaleLinear:CO,scaleLog:zO,scaleOrdinal:ly,scalePoint:O$,scalePow:xy,scaleQuantile:DO,scaleQuantize:MO,scaleRadial:kO,scaleSequential:FO,scaleSequentialLog:GO,scaleSequentialPow:Ey,scaleSequentialQuantile:QO,scaleSequentialSqrt:UB,scaleSequentialSymlog:HO,scaleSqrt:_7,scaleSymlog:OO,scaleThreshold:PO,scaleTime:$B,scaleUtc:BB,tickFormat:wO},Symbol.toStringTag,{value:"Module"}));var ii=e=>e.chartData,WO=ue([ii],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),zy=(e,t,n,a)=>a?WO(e):ii(e),GB=(e,t,n)=>n?WO(e):ii(e);function Xa(e){if(Array.isArray(e)&&e.length===2){var[t,n]=e;if(it(t)&&it(n))return!0}return!1}function XC(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function XO(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[n,a]=e,l,o;if(it(n))l=n;else if(typeof n=="function")return;if(it(a))o=a;else if(typeof a=="function")return;var u=[l,o];if(Xa(u))return u}}function HB(e,t,n){if(!(!n&&t==null)){if(typeof e=="function"&&t!=null)try{var a=e(t,n);if(Xa(a))return XC(a,t,n)}catch{}if(Array.isArray(e)&&e.length===2){var[l,o]=e,u,d;if(l==="auto")t!=null&&(u=Math.min(...t));else if(De(l))u=l;else if(typeof l=="function")try{t!=null&&(u=l(t?.[0]))}catch{}else if(typeof l=="string"&&ow.test(l)){var f=ow.exec(l);if(f==null||f[1]==null||t==null)u=void 0;else{var p=+f[1];u=t[0]-p}}else u=t?.[0];if(o==="auto")t!=null&&(d=Math.max(...t));else if(De(o))d=o;else if(typeof o=="function")try{t!=null&&(d=o(t?.[1]))}catch{}else if(typeof o=="string"&&cw.test(o)){var h=cw.exec(o);if(h==null||h[1]==null||t==null)d=void 0;else{var v=+h[1];d=t[1]+v}}else d=t?.[1];var b=[u,d];if(Xa(b))return t==null?b:XC(b,t,n)}}}var ho=1e9,QB={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},ky,Pt=!0,Rn="[DecimalError] ",Ps=Rn+"Invalid argument: ",Oy=Rn+"Exponent out of range: ",vo=Math.floor,Ss=Math.pow,VB=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,pn,dr=1e7,zt=7,ZO=9007199254740991,Ym=vo(ZO/zt),Ee={};Ee.absoluteValue=Ee.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Ee.comparedTo=Ee.cmp=function(e){var t,n,a,l,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(a=o.d.length,l=e.d.length,t=0,n=a<l?a:l;t<n;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return a===l?0:a>l^o.s<0?1:-1};Ee.decimalPlaces=Ee.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*zt;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};Ee.dividedBy=Ee.div=function(e){return Ha(this,new this.constructor(e))};Ee.dividedToIntegerBy=Ee.idiv=function(e){var t=this,n=t.constructor;return wt(Ha(t,new n(e),0,1),n.precision)};Ee.equals=Ee.eq=function(e){return!this.cmp(e)};Ee.exponent=function(){return er(this)};Ee.greaterThan=Ee.gt=function(e){return this.cmp(e)>0};Ee.greaterThanOrEqualTo=Ee.gte=function(e){return this.cmp(e)>=0};Ee.isInteger=Ee.isint=function(){return this.e>this.d.length-2};Ee.isNegative=Ee.isneg=function(){return this.s<0};Ee.isPositive=Ee.ispos=function(){return this.s>0};Ee.isZero=function(){return this.s===0};Ee.lessThan=Ee.lt=function(e){return this.cmp(e)<0};Ee.lessThanOrEqualTo=Ee.lte=function(e){return this.cmp(e)<1};Ee.logarithm=Ee.log=function(e){var t,n=this,a=n.constructor,l=a.precision,o=l+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(pn))throw Error(Rn+"NaN");if(n.s<1)throw Error(Rn+(n.s?"NaN":"-Infinity"));return n.eq(pn)?new a(0):(Pt=!1,t=Ha(Kc(n,o),Kc(e,o),o),Pt=!0,wt(t,l))};Ee.minus=Ee.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?tk(t,e):JO(t,(e.s=-e.s,e))};Ee.modulo=Ee.mod=function(e){var t,n=this,a=n.constructor,l=a.precision;if(e=new a(e),!e.s)throw Error(Rn+"NaN");return n.s?(Pt=!1,t=Ha(n,e,0,1).times(e),Pt=!0,n.minus(t)):wt(new a(n),l)};Ee.naturalExponential=Ee.exp=function(){return ek(this)};Ee.naturalLogarithm=Ee.ln=function(){return Kc(this)};Ee.negated=Ee.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Ee.plus=Ee.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?JO(t,e):tk(t,(e.s=-e.s,e))};Ee.precision=Ee.sd=function(e){var t,n,a,l=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ps+e);if(t=er(l)+1,a=l.d.length-1,n=a*zt+1,a=l.d[a],a){for(;a%10==0;a/=10)n--;for(a=l.d[0];a>=10;a/=10)n++}return e&&t>n?t:n};Ee.squareRoot=Ee.sqrt=function(){var e,t,n,a,l,o,u,d=this,f=d.constructor;if(d.s<1){if(!d.s)return new f(0);throw Error(Rn+"NaN")}for(e=er(d),Pt=!1,l=Math.sqrt(+d),l==0||l==1/0?(t=ua(d.d),(t.length+e)%2==0&&(t+="0"),l=Math.sqrt(t),e=vo((e+1)/2)-(e<0||e%2),l==1/0?t="5e"+e:(t=l.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),a=new f(t)):a=new f(l.toString()),n=f.precision,l=u=n+3;;)if(o=a,a=o.plus(Ha(d,o,u+2)).times(.5),ua(o.d).slice(0,u)===(t=ua(a.d)).slice(0,u)){if(t=t.slice(u-3,u+1),l==u&&t=="4999"){if(wt(o,n+1,0),o.times(o).eq(d)){a=o;break}}else if(t!="9999")break;u+=4}return Pt=!0,wt(a,n)};Ee.times=Ee.mul=function(e){var t,n,a,l,o,u,d,f,p,h=this,v=h.constructor,b=h.d,x=(e=new v(e)).d;if(!h.s||!e.s)return new v(0);for(e.s*=h.s,n=h.e+e.e,f=b.length,p=x.length,f<p&&(o=b,b=x,x=o,u=f,f=p,p=u),o=[],u=f+p,a=u;a--;)o.push(0);for(a=p;--a>=0;){for(t=0,l=f+a;l>a;)d=o[l]+x[a]*b[l-a-1]+t,o[l--]=d%dr|0,t=d/dr|0;o[l]=(o[l]+t)%dr|0}for(;!o[--u];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,Pt?wt(e,v.precision):e};Ee.toDecimalPlaces=Ee.todp=function(e,t){var n=this,a=n.constructor;return n=new a(n),e===void 0?n:(ga(e,0,ho),t===void 0?t=a.rounding:ga(t,0,8),wt(n,e+er(n)+1,t))};Ee.toExponential=function(e,t){var n,a=this,l=a.constructor;return e===void 0?n=$s(a,!0):(ga(e,0,ho),t===void 0?t=l.rounding:ga(t,0,8),a=wt(new l(a),e+1,t),n=$s(a,!0,e+1)),n};Ee.toFixed=function(e,t){var n,a,l=this,o=l.constructor;return e===void 0?$s(l):(ga(e,0,ho),t===void 0?t=o.rounding:ga(t,0,8),a=wt(new o(l),e+er(l)+1,t),n=$s(a.abs(),!1,e+er(a)+1),l.isneg()&&!l.isZero()?"-"+n:n)};Ee.toInteger=Ee.toint=function(){var e=this,t=e.constructor;return wt(new t(e),er(e)+1,t.rounding)};Ee.toNumber=function(){return+this};Ee.toPower=Ee.pow=function(e){var t,n,a,l,o,u,d=this,f=d.constructor,p=12,h=+(e=new f(e));if(!e.s)return new f(pn);if(d=new f(d),!d.s){if(e.s<1)throw Error(Rn+"Infinity");return d}if(d.eq(pn))return d;if(a=f.precision,e.eq(pn))return wt(d,a);if(t=e.e,n=e.d.length-1,u=t>=n,o=d.s,u){if((n=h<0?-h:h)<=ZO){for(l=new f(pn),t=Math.ceil(a/zt+4),Pt=!1;n%2&&(l=l.times(d),JC(l.d,t)),n=vo(n/2),n!==0;)d=d.times(d),JC(d.d,t);return Pt=!0,e.s<0?new f(pn).div(l):wt(l,a)}}else if(o<0)throw Error(Rn+"NaN");return o=o<0&&e.d[Math.max(t,n)]&1?-1:1,d.s=1,Pt=!1,l=e.times(Kc(d,a+p)),Pt=!0,l=ek(l),l.s=o,l};Ee.toPrecision=function(e,t){var n,a,l=this,o=l.constructor;return e===void 0?(n=er(l),a=$s(l,n<=o.toExpNeg||n>=o.toExpPos)):(ga(e,1,ho),t===void 0?t=o.rounding:ga(t,0,8),l=wt(new o(l),e,t),n=er(l),a=$s(l,e<=n||n<=o.toExpNeg,e)),a};Ee.toSignificantDigits=Ee.tosd=function(e,t){var n=this,a=n.constructor;return e===void 0?(e=a.precision,t=a.rounding):(ga(e,1,ho),t===void 0?t=a.rounding:ga(t,0,8)),wt(new a(n),e,t)};Ee.toString=Ee.valueOf=Ee.val=Ee.toJSON=Ee[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=er(e),n=e.constructor;return $s(e,t<=n.toExpNeg||t>=n.toExpPos)};function JO(e,t){var n,a,l,o,u,d,f,p,h=e.constructor,v=h.precision;if(!e.s||!t.s)return t.s||(t=new h(e)),Pt?wt(t,v):t;if(f=e.d,p=t.d,u=e.e,l=t.e,f=f.slice(),o=u-l,o){for(o<0?(a=f,o=-o,d=p.length):(a=p,l=u,d=f.length),u=Math.ceil(v/zt),d=u>d?u+1:d+1,o>d&&(o=d,a.length=1),a.reverse();o--;)a.push(0);a.reverse()}for(d=f.length,o=p.length,d-o<0&&(o=d,a=p,p=f,f=a),n=0;o;)n=(f[--o]=f[o]+p[o]+n)/dr|0,f[o]%=dr;for(n&&(f.unshift(n),++l),d=f.length;f[--d]==0;)f.pop();return t.d=f,t.e=l,Pt?wt(t,v):t}function ga(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Ps+e)}function ua(e){var t,n,a,l=e.length-1,o="",u=e[0];if(l>0){for(o+=u,t=1;t<l;t++)a=e[t]+"",n=zt-a.length,n&&(o+=qi(n)),o+=a;u=e[t],a=u+"",n=zt-a.length,n&&(o+=qi(n))}else if(u===0)return"0";for(;u%10===0;)u/=10;return o+u}var Ha=(function(){function e(a,l){var o,u=0,d=a.length;for(a=a.slice();d--;)o=a[d]*l+u,a[d]=o%dr|0,u=o/dr|0;return u&&a.unshift(u),a}function t(a,l,o,u){var d,f;if(o!=u)f=o>u?1:-1;else for(d=f=0;d<o;d++)if(a[d]!=l[d]){f=a[d]>l[d]?1:-1;break}return f}function n(a,l,o){for(var u=0;o--;)a[o]-=u,u=a[o]<l[o]?1:0,a[o]=u*dr+a[o]-l[o];for(;!a[0]&&a.length>1;)a.shift()}return function(a,l,o,u){var d,f,p,h,v,b,x,j,N,S,C,E,w,z,k,O,P,D,L=a.constructor,U=a.s==l.s?1:-1,$=a.d,B=l.d;if(!a.s)return new L(a);if(!l.s)throw Error(Rn+"Division by zero");for(f=a.e-l.e,P=B.length,k=$.length,x=new L(U),j=x.d=[],p=0;B[p]==($[p]||0);)++p;if(B[p]>($[p]||0)&&--f,o==null?E=o=L.precision:u?E=o+(er(a)-er(l))+1:E=o,E<0)return new L(0);if(E=E/zt+2|0,p=0,P==1)for(h=0,B=B[0],E++;(p<k||h)&&E--;p++)w=h*dr+($[p]||0),j[p]=w/B|0,h=w%B|0;else{for(h=dr/(B[0]+1)|0,h>1&&(B=e(B,h),$=e($,h),P=B.length,k=$.length),z=P,N=$.slice(0,P),S=N.length;S<P;)N[S++]=0;D=B.slice(),D.unshift(0),O=B[0],B[1]>=dr/2&&++O;do h=0,d=t(B,N,P,S),d<0?(C=N[0],P!=S&&(C=C*dr+(N[1]||0)),h=C/O|0,h>1?(h>=dr&&(h=dr-1),v=e(B,h),b=v.length,S=N.length,d=t(v,N,b,S),d==1&&(h--,n(v,P<b?D:B,b))):(h==0&&(d=h=1),v=B.slice()),b=v.length,b<S&&v.unshift(0),n(N,v,S),d==-1&&(S=N.length,d=t(B,N,P,S),d<1&&(h++,n(N,P<S?D:B,S))),S=N.length):d===0&&(h++,N=[0]),j[p++]=h,d&&N[0]?N[S++]=$[z]||0:(N=[$[z]],S=1);while((z++<k||N[0]!==void 0)&&E--)}return j[0]||j.shift(),x.e=f,wt(x,u?o+er(x)+1:o)}})();function ek(e,t){var n,a,l,o,u,d,f=0,p=0,h=e.constructor,v=h.precision;if(er(e)>16)throw Error(Oy+er(e));if(!e.s)return new h(pn);for(Pt=!1,d=v,u=new h(.03125);e.abs().gte(.1);)e=e.times(u),p+=5;for(a=Math.log(Ss(2,p))/Math.LN10*2+5|0,d+=a,n=l=o=new h(pn),h.precision=d;;){if(l=wt(l.times(e),d),n=n.times(++f),u=o.plus(Ha(l,n,d)),ua(u.d).slice(0,d)===ua(o.d).slice(0,d)){for(;p--;)o=wt(o.times(o),d);return h.precision=v,t==null?(Pt=!0,wt(o,v)):o}o=u}}function er(e){for(var t=e.e*zt,n=e.d[0];n>=10;n/=10)t++;return t}function ex(e,t,n){if(t>e.LN10.sd())throw Pt=!0,n&&(e.precision=n),Error(Rn+"LN10 precision limit exceeded");return wt(new e(e.LN10),t)}function qi(e){for(var t="";e--;)t+="0";return t}function Kc(e,t){var n,a,l,o,u,d,f,p,h,v=1,b=10,x=e,j=x.d,N=x.constructor,S=N.precision;if(x.s<1)throw Error(Rn+(x.s?"NaN":"-Infinity"));if(x.eq(pn))return new N(0);if(t==null?(Pt=!1,p=S):p=t,x.eq(10))return t==null&&(Pt=!0),ex(N,p);if(p+=b,N.precision=p,n=ua(j),a=n.charAt(0),o=er(x),Math.abs(o)<15e14){for(;a<7&&a!=1||a==1&&n.charAt(1)>3;)x=x.times(e),n=ua(x.d),a=n.charAt(0),v++;o=er(x),a>1?(x=new N("0."+n),o++):x=new N(a+"."+n.slice(1))}else return f=ex(N,p+2,S).times(o+""),x=Kc(new N(a+"."+n.slice(1)),p-b).plus(f),N.precision=S,t==null?(Pt=!0,wt(x,S)):x;for(d=u=x=Ha(x.minus(pn),x.plus(pn),p),h=wt(x.times(x),p),l=3;;){if(u=wt(u.times(h),p),f=d.plus(Ha(u,new N(l),p)),ua(f.d).slice(0,p)===ua(d.d).slice(0,p))return d=d.times(2),o!==0&&(d=d.plus(ex(N,p+2,S).times(o+""))),d=Ha(d,new N(v),p),N.precision=S,t==null?(Pt=!0,wt(d,S)):d;d=f,l+=2}}function ZC(e,t){var n,a,l;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(n<0&&(n=a),n+=+t.slice(a+1),t=t.substring(0,a)):n<0&&(n=t.length),a=0;t.charCodeAt(a)===48;)++a;for(l=t.length;t.charCodeAt(l-1)===48;)--l;if(t=t.slice(a,l),t){if(l-=a,n=n-a-1,e.e=vo(n/zt),e.d=[],a=(n+1)%zt,n<0&&(a+=zt),a<l){for(a&&e.d.push(+t.slice(0,a)),l-=zt;a<l;)e.d.push(+t.slice(a,a+=zt));t=t.slice(a),a=zt-t.length}else a-=l;for(;a--;)t+="0";if(e.d.push(+t),Pt&&(e.e>Ym||e.e<-Ym))throw Error(Oy+n)}else e.s=0,e.e=0,e.d=[0];return e}function wt(e,t,n){var a,l,o,u,d,f,p,h,v=e.d;for(u=1,o=v[0];o>=10;o/=10)u++;if(a=t-u,a<0)a+=zt,l=t,p=v[h=0];else{if(h=Math.ceil((a+1)/zt),o=v.length,h>=o)return e;for(p=o=v[h],u=1;o>=10;o/=10)u++;a%=zt,l=a-zt+u}if(n!==void 0&&(o=Ss(10,u-l-1),d=p/o%10|0,f=t<0||v[h+1]!==void 0||p%o,f=n<4?(d||f)&&(n==0||n==(e.s<0?3:2)):d>5||d==5&&(n==4||f||n==6&&(a>0?l>0?p/Ss(10,u-l):0:v[h-1])%10&1||n==(e.s<0?8:7))),t<1||!v[0])return f?(o=er(e),v.length=1,t=t-o-1,v[0]=Ss(10,(zt-t%zt)%zt),e.e=vo(-t/zt)||0):(v.length=1,v[0]=e.e=e.s=0),e;if(a==0?(v.length=h,o=1,h--):(v.length=h+1,o=Ss(10,zt-a),v[h]=l>0?(p/Ss(10,u-l)%Ss(10,l)|0)*o:0),f)for(;;)if(h==0){(v[0]+=o)==dr&&(v[0]=1,++e.e);break}else{if(v[h]+=o,v[h]!=dr)break;v[h--]=0,o=1}for(a=v.length;v[--a]===0;)v.pop();if(Pt&&(e.e>Ym||e.e<-Ym))throw Error(Oy+er(e));return e}function tk(e,t){var n,a,l,o,u,d,f,p,h,v,b=e.constructor,x=b.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new b(e),Pt?wt(t,x):t;if(f=e.d,v=t.d,a=t.e,p=e.e,f=f.slice(),u=p-a,u){for(h=u<0,h?(n=f,u=-u,d=v.length):(n=v,a=p,d=f.length),l=Math.max(Math.ceil(x/zt),d)+2,u>l&&(u=l,n.length=1),n.reverse(),l=u;l--;)n.push(0);n.reverse()}else{for(l=f.length,d=v.length,h=l<d,h&&(d=l),l=0;l<d;l++)if(f[l]!=v[l]){h=f[l]<v[l];break}u=0}for(h&&(n=f,f=v,v=n,t.s=-t.s),d=f.length,l=v.length-d;l>0;--l)f[d++]=0;for(l=v.length;l>u;){if(f[--l]<v[l]){for(o=l;o&&f[--o]===0;)f[o]=dr-1;--f[o],f[l]+=dr}f[l]-=v[l]}for(;f[--d]===0;)f.pop();for(;f[0]===0;f.shift())--a;return f[0]?(t.d=f,t.e=a,Pt?wt(t,x):t):new b(0)}function $s(e,t,n){var a,l=er(e),o=ua(e.d),u=o.length;return t?(n&&(a=n-u)>0?o=o.charAt(0)+"."+o.slice(1)+qi(a):u>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(l<0?"e":"e+")+l):l<0?(o="0."+qi(-l-1)+o,n&&(a=n-u)>0&&(o+=qi(a))):l>=u?(o+=qi(l+1-u),n&&(a=n-l-1)>0&&(o=o+"."+qi(a))):((a=l+1)<u&&(o=o.slice(0,a)+"."+o.slice(a)),n&&(a=n-u)>0&&(l+1===u&&(o+="."),o+=qi(a))),e.s<0?"-"+o:o}function JC(e,t){if(e.length>t)return e.length=t,!0}function rk(e){var t,n,a;function l(o){var u=this;if(!(u instanceof l))return new l(o);if(u.constructor=l,o instanceof l){u.s=o.s,u.e=o.e,u.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(Ps+o);if(o>0)u.s=1;else if(o<0)o=-o,u.s=-1;else{u.s=0,u.e=0,u.d=[0];return}if(o===~~o&&o<1e7){u.e=0,u.d=[o];return}return ZC(u,o.toString())}else if(typeof o!="string")throw Error(Ps+o);if(o.charCodeAt(0)===45?(o=o.slice(1),u.s=-1):u.s=1,VB.test(o))ZC(u,o);else throw Error(Ps+o)}if(l.prototype=Ee,l.ROUND_UP=0,l.ROUND_DOWN=1,l.ROUND_CEIL=2,l.ROUND_FLOOR=3,l.ROUND_HALF_UP=4,l.ROUND_HALF_DOWN=5,l.ROUND_HALF_EVEN=6,l.ROUND_HALF_CEIL=7,l.ROUND_HALF_FLOOR=8,l.clone=rk,l.config=l.set=YB,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<a.length;)e.hasOwnProperty(n=a[t++])||(e[n]=this[n]);return l.config(e),l}function YB(e){if(!e||typeof e!="object")throw Error(Rn+"Object expected");var t,n,a,l=["precision",1,ho,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<l.length;t+=3)if((a=e[n=l[t]])!==void 0)if(vo(a)===a&&a>=l[t+1]&&a<=l[t+2])this[n]=a;else throw Error(Ps+n+": "+a);if((a=e[n="LN10"])!==void 0)if(a==Math.LN10)this[n]=new this(a);else throw Error(Ps+n+": "+a);return this}var ky=rk(QB);pn=new ky(1);const ht=ky;function nk(e){var t;return e===0?t=1:t=Math.floor(new ht(e).abs().log(10).toNumber())+1,t}function ak(e,t,n){for(var a=new ht(e),l=0,o=[];a.lt(t)&&l<1e5;)o.push(a.toNumber()),a=a.add(n),l++;return o}var ik=e=>{var[t,n]=e,[a,l]=[t,n];return t>n&&([a,l]=[n,t]),[a,l]},sk=(e,t,n)=>{if(e.lte(0))return new ht(0);var a=nk(e.toNumber()),l=new ht(10).pow(a),o=e.div(l),u=a!==1?.05:.1,d=new ht(Math.ceil(o.div(u).toNumber())).add(n).mul(u),f=d.mul(l);return t?new ht(f.toNumber()):new ht(Math.ceil(f.toNumber()))},KB=(e,t,n)=>{var a=new ht(1),l=new ht(e);if(!l.isint()&&n){var o=Math.abs(e);o<1?(a=new ht(10).pow(nk(e)-1),l=new ht(Math.floor(l.div(a).toNumber())).mul(a)):o>1&&(l=new ht(Math.floor(e)))}else e===0?l=new ht(Math.floor((t-1)/2)):n||(l=new ht(Math.floor(e)));for(var u=Math.floor((t-1)/2),d=[],f=0;f<t;f++)d.push(l.add(new ht(f-u).mul(a)).toNumber());return d},lk=function(t,n,a,l){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-t)/(a-1)))return{step:new ht(0),tickMin:new ht(0),tickMax:new ht(0)};var u=sk(new ht(n).sub(t).div(a-1),l,o),d;t<=0&&n>=0?d=new ht(0):(d=new ht(t).add(n).div(2),d=d.sub(new ht(d).mod(u)));var f=Math.ceil(d.sub(t).div(u).toNumber()),p=Math.ceil(new ht(n).sub(d).div(u).toNumber()),h=f+p+1;return h>a?lk(t,n,a,l,o+1):(h<a&&(p=n>0?p+(a-h):p,f=n>0?f:f+(a-h)),{step:u,tickMin:d.sub(new ht(f).mul(u)),tickMax:d.add(new ht(p).mul(u))})},WB=function(t){var[n,a]=t,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,u=Math.max(l,2),[d,f]=ik([n,a]);if(d===-1/0||f===1/0){var p=f===1/0?[d,...Array(l-1).fill(1/0)]:[...Array(l-1).fill(-1/0),f];return n>a?p.reverse():p}if(d===f)return KB(d,l,o);var{step:h,tickMin:v,tickMax:b}=lk(d,f,u,o,0),x=ak(v,b.add(new ht(.1).mul(h)),h);return n>a?x.reverse():x},XB=function(t,n){var[a,l]=t,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[u,d]=ik([a,l]);if(u===-1/0||d===1/0)return[a,l];if(u===d)return[u];var f=Math.max(n,2),p=sk(new ht(d).sub(u).div(f-1),o,0),h=[...ak(new ht(u),new ht(d),p),d];return o===!1&&(h=h.map(v=>Math.round(v))),a>l?h.reverse():h},ok=e=>e.rootProps.maxBarSize,ZB=e=>e.rootProps.barGap,ck=e=>e.rootProps.barCategoryGap,JB=e=>e.rootProps.barSize,Yf=e=>e.rootProps.stackOffset,uk=e=>e.rootProps.reverseStackOrder,Dy=e=>e.options.chartName,My=e=>e.rootProps.syncId,dk=e=>e.rootProps.syncMethod,Py=e=>e.options.eventEmitter,mr={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},ys={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},sa={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},Kf=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};function Wf(e,t,n){if(n!=="auto")return n;if(e!=null)return ti(e,t)?"category":"number"}function e2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Km(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?e2(Object(n),!0).forEach(function(a){e9(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function e9(e,t,n){return(t=t9(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t9(e){var t=r9(e,"string");return typeof t=="symbol"?t:t+""}function r9(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var t2={allowDataOverflow:ys.allowDataOverflow,allowDecimals:ys.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:ys.angleAxisId,includeHidden:!1,name:void 0,reversed:ys.reversed,scale:ys.scale,tick:ys.tick,tickCount:void 0,ticks:void 0,type:ys.type,unit:void 0},r2={allowDataOverflow:sa.allowDataOverflow,allowDecimals:sa.allowDecimals,allowDuplicatedCategory:sa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:sa.radiusAxisId,includeHidden:sa.includeHidden,name:void 0,reversed:sa.reversed,scale:sa.scale,tick:sa.tick,tickCount:sa.tickCount,ticks:void 0,type:sa.type,unit:void 0},n9=(e,t)=>{if(t!=null)return e.polarAxis.angleAxis[t]},Ty=ue([n9,Zz],(e,t)=>{var n;if(e!=null)return e;var a=(n=Wf(t,"angleAxis",t2.type))!==null&&n!==void 0?n:"category";return Km(Km({},t2),{},{type:a})}),a9=(e,t)=>e.polarAxis.radiusAxis[t],qy=ue([a9,Zz],(e,t)=>{var n;if(e!=null)return e;var a=(n=Wf(t,"radiusAxis",r2.type))!==null&&n!==void 0?n:"category";return Km(Km({},r2),{},{type:a})}),Xf=e=>e.polarOptions,Ry=ue([ri,ni,fr],t$),mk=ue([Xf,Ry],(e,t)=>{if(e!=null)return Yn(e.innerRadius,t,0)}),fk=ue([Xf,Ry],(e,t)=>{if(e!=null)return Yn(e.outerRadius,t,t*.8)}),i9=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]},pk=ue([Xf],i9);ue([Ty,pk],Kf);var hk=ue([Ry,mk,fk],(e,t,n)=>{if(!(e==null||t==null||n==null))return[t,n]});ue([qy,hk],Kf);var vk=ue([vt,Xf,mk,fk,ri,ni],(e,t,n,a,l,o)=>{if(!(e!=="centric"&&e!=="radial"||t==null||n==null||a==null)){var{cx:u,cy:d,startAngle:f,endAngle:p}=t;return{cx:Yn(u,l,l/2),cy:Yn(d,o,o/2),innerRadius:n,outerRadius:a,startAngle:f,endAngle:p,clockWise:!1}}}),hr=(e,t)=>t,Zf=(e,t,n)=>n;function Iy(e){return e?.id}function gk(e,t,n){var{chartData:a=[]}=t,{allowDuplicatedCategory:l,dataKey:o}=n,u=new Map;return e.forEach(d=>{var f,p=(f=d.data)!==null&&f!==void 0?f:a;if(!(p==null||p.length===0)){var h=Iy(d);p.forEach((v,b)=>{var x=o==null||l?b:String(Jt(v,o,null)),j=Jt(v,d.dataKey,0),N;u.has(x)?N=u.get(x):N={},Object.assign(N,{[h]:j}),u.set(x,N)})}}),Array.from(u.values())}function Jf(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var ep=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function tp(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function s9(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}var vr=e=>{var t=vt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},go=e=>e.tooltip.settings.axisId;function l9(e){if(e in Oc)return Oc[e]();var t="scale".concat(ru(e));if(t in Oc)return Oc[t]()}function n2(e){var t=e.ticks,n=e.bandwidth,a=e.range(),l=[Math.min(...a),Math.max(...a)];return{domain:()=>e.domain(),range:(function(o){function u(){return o.apply(this,arguments)}return u.toString=function(){return o.toString()},u})(()=>l),rangeMin:()=>l[0],rangeMax:()=>l[1],isInRange(o){var u=l[0],d=l[1];return u<=d?o>=u&&o<=d:o>=d&&o<=u},bandwidth:n?()=>n.call(e):void 0,ticks:t?o=>t.call(e,o):void 0,map:(o,u)=>{var d=e(o);if(d!=null){if(e.bandwidth&&u!==null&&u!==void 0&&u.position){var f=e.bandwidth();switch(u.position){case"middle":d+=f/2;break;case"end":d+=f;break}}return d}}}}function a2(e,t,n){if(typeof e=="function")return n2(e.copy().domain(t).range(n));if(e!=null){var a=l9(e);if(a!=null)return a.domain(t).range(n),n2(a)}}var o9=(e,t)=>{if(t!=null)switch(e){case"linear":{if(!Xa(t)){for(var n,a,l=0;l<t.length;l++){var o=t[l];it(o)&&((n===void 0||o<n)&&(n=o),(a===void 0||o>a)&&(a=o))}return n!==void 0&&a!==void 0?[n,a]:void 0}return t}default:return t}};function i2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Wm(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?i2(Object(n),!0).forEach(function(a){c9(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function c9(e,t,n){return(t=u9(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u9(e){var t=d9(e,"string");return typeof t=="symbol"?t:t+""}function d9(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lb=[0,"auto"],or={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},xk=(e,t)=>e.cartesianAxis.xAxis[t],si=(e,t)=>{var n=xk(e,t);return n??or},cr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:lb,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:iu},bk=(e,t)=>e.cartesianAxis.yAxis[t],li=(e,t)=>{var n=bk(e,t);return n??cr},m9={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Ly=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return n??m9},$r=(e,t,n)=>{switch(t){case"xAxis":return si(e,n);case"yAxis":return li(e,n);case"zAxis":return Ly(e,n);case"angleAxis":return Ty(e,n);case"radiusAxis":return qy(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},f9=(e,t,n)=>{switch(t){case"xAxis":return si(e,n);case"yAxis":return li(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},mu=(e,t,n)=>{switch(t){case"xAxis":return si(e,n);case"yAxis":return li(e,n);case"angleAxis":return Ty(e,n);case"radiusAxis":return qy(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},yk=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function jk(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var rp=e=>e.graphicalItems.cartesianItems,p9=ue([hr,Zf],jk),Nk=(e,t,n)=>e.filter(n).filter(a=>t?.includeHidden===!0?!0:!a.hide),fu=ue([rp,$r,p9],Nk,{memoizeOptions:{resultEqualityCheck:tp}}),_k=ue([fu],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Jf)),Sk=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),h9=ue([fu],Sk),wk=e=>e.map(t=>t.data).filter(Boolean).flat(1),v9=ue([fu],wk,{memoizeOptions:{resultEqualityCheck:tp}}),Ck=(e,t)=>{var{chartData:n=[],dataStartIndex:a,dataEndIndex:l}=t;return e.length>0?e:n.slice(a,l+1)},$y=ue([v9,zy],Ck),Ek=(e,t,n)=>t?.dataKey!=null?e.map(a=>({value:Jt(a,t.dataKey)})):n.length>0?n.map(a=>a.dataKey).flatMap(a=>e.map(l=>({value:Jt(l,a)}))):e.map(a=>({value:a})),np=ue([$y,$r,fu],Ek);function Ak(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function im(e){if(ha(e)||e instanceof Date){var t=Number(e);if(it(t))return t}}function s2(e){if(Array.isArray(e)){var t=[im(e[0]),im(e[1])];return Xa(t)?t:void 0}var n=im(e);if(n!=null)return[n,n]}function Za(e){return e.map(im).filter(Zr)}function g9(e,t,n){return!n||typeof t!="number"||pa(t)?[]:n.length?Za(n.flatMap(a=>{var l=Jt(e,a.dataKey),o,u;if(Array.isArray(l)?[o,u]=l:o=u=l,!(!it(o)||!it(u)))return[t-o,t+u]})):[]}var ar=e=>{var t=vr(e),n=go(e);return mu(e,t,n)},pu=ue([ar],e=>e?.dataKey),x9=ue([_k,zy,ar],gk),zk=(e,t,n,a)=>{var l={},o=t.reduce((u,d)=>{if(d.stackId==null)return u;var f=u[d.stackId];return f==null&&(f=[]),f.push(d),u[d.stackId]=f,u},l);return Object.fromEntries(Object.entries(o).map(u=>{var[d,f]=u,p=a?[...f].reverse():f,h=p.map(Iy);return[d,{stackedData:Q4(e,h,n),graphicalItems:p}]}))},ob=ue([x9,_k,Yf,uk],zk),Ok=(e,t,n,a)=>{var{dataStartIndex:l,dataEndIndex:o}=t;if(a==null&&n!=="zAxis"){var u=X4(e,l,o);if(!(u!=null&&u[0]===0&&u[1]===0))return u}},b9=ue([$r],e=>e.allowDataOverflow),By=e=>{var t;if(e==null||!("domain"in e))return lb;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var n=Za(e.ticks);return[Math.min(...n),Math.max(...n)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:lb},kk=ue([$r],By),Dk=ue([kk,b9],XO),y9=ue([ob,ii,hr,Dk],Ok,{memoizeOptions:{resultEqualityCheck:ep}}),Uy=e=>e.errorBars,j9=(e,t,n)=>e.flatMap(a=>t[a.id]).filter(Boolean).filter(a=>Ak(n,a)),Xm=function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];var l=n.filter(Boolean);if(l.length!==0){var o=l.flat(),u=Math.min(...o),d=Math.max(...o);return[u,d]}},Mk=(e,t,n,a,l)=>{var o,u;if(n.length>0&&e.forEach(d=>{n.forEach(f=>{var p,h,v=(p=a[f.id])===null||p===void 0?void 0:p.filter(C=>Ak(l,C)),b=Jt(d,(h=t.dataKey)!==null&&h!==void 0?h:f.dataKey),x=g9(d,b,v);if(x.length>=2){var j=Math.min(...x),N=Math.max(...x);(o==null||j<o)&&(o=j),(u==null||N>u)&&(u=N)}var S=s2(b);S!=null&&(o=o==null?S[0]:Math.min(o,S[0]),u=u==null?S[1]:Math.max(u,S[1]))})}),t?.dataKey!=null&&e.forEach(d=>{var f=s2(Jt(d,t.dataKey));f!=null&&(o=o==null?f[0]:Math.min(o,f[0]),u=u==null?f[1]:Math.max(u,f[1]))}),it(o)&&it(u))return[o,u]},N9=ue([$y,$r,h9,Uy,hr],Mk,{memoizeOptions:{resultEqualityCheck:ep}});function _9(e){var{value:t}=e;if(ha(t)||t instanceof Date)return t}var S9=(e,t,n)=>{var a=e.map(_9).filter(l=>l!=null);return n&&(t.dataKey==null||t.allowDuplicatedCategory&&KA(a))?vO(0,e.length):t.allowDuplicatedCategory?a:Array.from(new Set(a))},Pk=e=>e.referenceElements.dots,xo=(e,t,n)=>e.filter(a=>a.ifOverflow==="extendDomain").filter(a=>t==="xAxis"?a.xAxisId===n:a.yAxisId===n),w9=ue([Pk,hr,Zf],xo),Tk=e=>e.referenceElements.areas,C9=ue([Tk,hr,Zf],xo),qk=e=>e.referenceElements.lines,E9=ue([qk,hr,Zf],xo),Rk=(e,t)=>{if(e!=null){var n=Za(e.map(a=>t==="xAxis"?a.x:a.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},A9=ue(w9,hr,Rk),Ik=(e,t)=>{if(e!=null){var n=Za(e.flatMap(a=>[t==="xAxis"?a.x1:a.y1,t==="xAxis"?a.x2:a.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},z9=ue([C9,hr],Ik);function O9(e){var t;if(e.x!=null)return Za([e.x]);var n=(t=e.segment)===null||t===void 0?void 0:t.map(a=>a.x);return n==null||n.length===0?[]:Za(n)}function k9(e){var t;if(e.y!=null)return Za([e.y]);var n=(t=e.segment)===null||t===void 0?void 0:t.map(a=>a.y);return n==null||n.length===0?[]:Za(n)}var Lk=(e,t)=>{if(e!=null){var n=e.flatMap(a=>t==="xAxis"?O9(a):k9(a));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},D9=ue([E9,hr],Lk),M9=ue(A9,D9,z9,(e,t,n)=>Xm(e,n,t)),$k=(e,t,n,a,l,o,u,d)=>{if(n!=null)return n;var f=u==="vertical"&&d==="xAxis"||u==="horizontal"&&d==="yAxis",p=f?Xm(a,o,l):Xm(o,l);return HB(t,p,e.allowDataOverflow)},P9=ue([$r,kk,Dk,y9,N9,M9,vt,hr],$k,{memoizeOptions:{resultEqualityCheck:ep}}),T9=[0,1],Bk=(e,t,n,a,l,o,u)=>{if(!((e==null||n==null||n.length===0)&&u===void 0)){var{dataKey:d,type:f}=e,p=ti(t,o);if(p&&d==null){var h;return vO(0,(h=n?.length)!==null&&h!==void 0?h:0)}return f==="category"?S9(a,e,p):l==="expand"?T9:u}},Fy=ue([$r,vt,$y,np,Yf,hr,P9],Bk);function q9(e){return e in Oc}var Uk=(e,t,n)=>{if(e!=null){var{scale:a,type:l}=e;if(a==="auto")return l==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!t)?"point":l==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(ru(a));return q9(o)?o:"point"}}},bo=ue([$r,yk,Dy],Uk);function Gy(e,t,n,a){if(!(n==null||a==null))return typeof e.scale=="function"?a2(e.scale,n,a):a2(t,n,a)}var Fk=(e,t,n)=>{var a=By(t);if(!(n!=="auto"&&n!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(a)&&(a[0]==="auto"||a[1]==="auto")&&Xa(e))return WB(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Xa(e))return XB(e,t.tickCount,t.allowDecimals)}},Hy=ue([Fy,mu,bo],Fk),Gk=(e,t,n,a)=>{if(a!=="angleAxis"&&e?.type==="number"&&Xa(t)&&Array.isArray(n)&&n.length>0){var l,o,u=t[0],d=(l=n[0])!==null&&l!==void 0?l:0,f=t[1],p=(o=n[n.length-1])!==null&&o!==void 0?o:0;return[Math.min(u,d),Math.max(f,p)]}return t},R9=ue([$r,Fy,Hy,hr],Gk),I9=ue(np,$r,(e,t)=>{if(!(!t||t.type!=="number")){var n=1/0,a=Array.from(Za(e.map(v=>v.value))).sort((v,b)=>v-b),l=a[0],o=a[a.length-1];if(l==null||o==null)return 1/0;var u=o-l;if(u===0)return 1/0;for(var d=0;d<a.length-1;d++){var f=a[d],p=a[d+1];if(!(f==null||p==null)){var h=p-f;n=Math.min(n,h)}}return n/u}}),Hk=ue(I9,vt,ck,fr,(e,t,n,a,l)=>l,(e,t,n,a,l)=>{if(!it(e))return 0;var o=t==="vertical"?a.height:a.width;if(l==="gap")return e*o/2;if(l==="no-gap"){var u=Yn(n,e*o),d=e*o/2;return d-u-(d-u)/o*u}return 0}),L9=(e,t,n)=>{var a=si(e,t);return a==null||typeof a.padding!="string"?0:Hk(e,"xAxis",t,n,a.padding)},$9=(e,t,n)=>{var a=li(e,t);return a==null||typeof a.padding!="string"?0:Hk(e,"yAxis",t,n,a.padding)},B9=ue(si,L9,(e,t)=>{var n,a;if(e==null)return{left:0,right:0};var{padding:l}=e;return typeof l=="string"?{left:t,right:t}:{left:((n=l.left)!==null&&n!==void 0?n:0)+t,right:((a=l.right)!==null&&a!==void 0?a:0)+t}}),U9=ue(li,$9,(e,t)=>{var n,a;if(e==null)return{top:0,bottom:0};var{padding:l}=e;return typeof l=="string"?{top:t,bottom:t}:{top:((n=l.top)!==null&&n!==void 0?n:0)+t,bottom:((a=l.bottom)!==null&&a!==void 0?a:0)+t}}),F9=ue([fr,B9,Pf,Mf,(e,t,n)=>n],(e,t,n,a,l)=>{var{padding:o}=a;return l?[o.left,n.width-o.right]:[e.left+t.left,e.left+e.width-t.right]}),G9=ue([fr,vt,U9,Pf,Mf,(e,t,n)=>n],(e,t,n,a,l,o)=>{var{padding:u}=l;return o?[a.height-u.bottom,u.top]:t==="horizontal"?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),hu=(e,t,n,a)=>{var l;switch(t){case"xAxis":return F9(e,n,a);case"yAxis":return G9(e,n,a);case"zAxis":return(l=Ly(e,n))===null||l===void 0?void 0:l.range;case"angleAxis":return pk(e);case"radiusAxis":return hk(e,n);default:return}},Qk=ue([$r,hu],Kf),H9=ue([bo,R9],o9),ap=ue([$r,bo,H9,Qk],Gy);ue([fu,Uy,hr],j9);function Vk(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var ip=(e,t)=>t,sp=(e,t,n)=>n,Q9=ue(kf,ip,sp,(e,t,n)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===n).sort(Vk)),V9=ue(Df,ip,sp,(e,t,n)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===n).sort(Vk)),Yk=(e,t)=>({width:e.width,height:t.height}),Y9=(e,t)=>{var n=typeof t.width=="number"?t.width:iu;return{width:n,height:e.height}},Kk=ue(fr,si,Yk),K9=(e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}},W9=(e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}},X9=ue(ni,fr,Q9,ip,sp,(e,t,n,a,l)=>{var o={},u;return n.forEach(d=>{var f=Yk(t,d);u==null&&(u=K9(t,a,e));var p=a==="top"&&!l||a==="bottom"&&l;o[d.id]=u-Number(p)*f.height,u+=(p?-1:1)*f.height}),o}),Z9=ue(ri,fr,V9,ip,sp,(e,t,n,a,l)=>{var o={},u;return n.forEach(d=>{var f=Y9(t,d);u==null&&(u=W9(t,a,e));var p=a==="left"&&!l||a==="right"&&l;o[d.id]=u-Number(p)*f.width,u+=(p?-1:1)*f.width}),o}),J9=(e,t)=>{var n=si(e,t);if(n!=null)return X9(e,n.orientation,n.mirror)},eU=ue([fr,si,J9,(e,t)=>t],(e,t,n,a)=>{if(t!=null){var l=n?.[a];return l==null?{x:e.left,y:0}:{x:e.left,y:l}}}),tU=(e,t)=>{var n=li(e,t);if(n!=null)return Z9(e,n.orientation,n.mirror)},rU=ue([fr,li,tU,(e,t)=>t],(e,t,n,a)=>{if(t!=null){var l=n?.[a];return l==null?{x:0,y:e.top}:{x:l,y:e.top}}}),Wk=ue(fr,li,(e,t)=>{var n=typeof t.width=="number"?t.width:iu;return{width:n,height:e.height}}),l2=(e,t,n)=>{switch(t){case"xAxis":return Kk(e,n).width;case"yAxis":return Wk(e,n).height;default:return}},Xk=(e,t,n,a)=>{if(n!=null){var{allowDuplicatedCategory:l,type:o,dataKey:u}=n,d=ti(e,a),f=t.map(p=>p.value);if(u&&d&&o==="category"&&l&&KA(f))return f}},Qy=ue([vt,np,$r,hr],Xk),Zk=(e,t,n,a)=>{if(!(n==null||n.dataKey==null)){var{type:l,scale:o}=n,u=ti(e,a);if(u&&(l==="number"||o!=="auto"))return t.map(d=>d.value)}},Vy=ue([vt,np,mu,hr],Zk),o2=ue([vt,f9,bo,ap,Qy,Vy,hu,Hy,hr],(e,t,n,a,l,o,u,d,f)=>{if(t!=null){var p=ti(e,f);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:f,categoricalDomain:o,duplicateDomain:l,isCategorical:p,niceTicks:d,range:u,realScaleType:n,scale:a}}}),nU=(e,t,n,a,l,o,u,d,f)=>{if(!(t==null||a==null)){var p=ti(e,f),{type:h,ticks:v,tickCount:b}=t,x=n==="scaleBand"&&typeof a.bandwidth=="function"?a.bandwidth()/2:2,j=h==="category"&&a.bandwidth?a.bandwidth()/x:0;j=f==="angleAxis"&&o!=null&&o.length>=2?Xr(o[0]-o[1])*2*j:j;var N=v||l;return N?N.map((S,C)=>{var E=u?u.indexOf(S):S,w=a.map(E);return it(w)?{index:C,coordinate:w+j,value:S,offset:j}:null}).filter(Zr):p&&d?d.map((S,C)=>{var E=a.map(S);return it(E)?{coordinate:E+j,value:S,index:C,offset:j}:null}).filter(Zr):a.ticks?a.ticks(b).map((S,C)=>{var E=a.map(S);return it(E)?{coordinate:E+j,value:S,index:C,offset:j}:null}).filter(Zr):a.domain().map((S,C)=>{var E=a.map(S);return it(E)?{coordinate:E+j,value:u?u[S]:S,index:C,offset:j}:null}).filter(Zr)}},Jk=ue([vt,mu,bo,ap,Hy,hu,Qy,Vy,hr],nU),aU=(e,t,n,a,l,o,u)=>{if(!(t==null||n==null||a==null||a[0]===a[1])){var d=ti(e,u),{tickCount:f}=t,p=0;return p=u==="angleAxis"&&a?.length>=2?Xr(a[0]-a[1])*2*p:p,d&&o?o.map((h,v)=>{var b=n.map(h);return it(b)?{coordinate:b+p,value:h,index:v,offset:p}:null}).filter(Zr):n.ticks?n.ticks(f).map((h,v)=>{var b=n.map(h);return it(b)?{coordinate:b+p,value:h,index:v,offset:p}:null}).filter(Zr):n.domain().map((h,v)=>{var b=n.map(h);return it(b)?{coordinate:b+p,value:l?l[h]:h,index:v,offset:p}:null}).filter(Zr)}},Vi=ue([vt,mu,ap,hu,Qy,Vy,hr],aU),Yi=ue($r,ap,(e,t)=>{if(!(e==null||t==null))return Wm(Wm({},e),{},{scale:t})}),iU=ue([$r,bo,Fy,Qk],Gy);ue((e,t,n)=>Ly(e,n),iU,(e,t)=>{if(!(e==null||t==null))return Wm(Wm({},e),{},{scale:t})});var sU=ue([vt,kf,Df],(e,t,n)=>{switch(e){case"horizontal":return t.some(a=>a.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(a=>a.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),eD=e=>e.options.defaultTooltipEventType,tD=e=>e.options.validateTooltipEventTypes;function rD(e,t,n){if(e==null)return t;var a=e?"axis":"item";return n==null?t:n.includes(a)?a:t}function Yy(e,t){var n=eD(e),a=tD(e);return rD(t,n,a)}function lU(e){return Ie(t=>Yy(t,e))}var nD=(e,t)=>{var n,a=Number(t);if(!(pa(a)||t==null))return a>=0?e==null||(n=e[a])===null||n===void 0?void 0:n.value:void 0},oU=e=>e.tooltip.settings,Ii={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},cU={itemInteraction:{click:Ii,hover:Ii},axisInteraction:{click:Ii,hover:Ii},keyboardInteraction:Ii,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},aD=tn({name:"tooltip",initialState:cU,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Dt()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:n,next:a}=t.payload,l=Qn(e).tooltipItemPayloads.indexOf(n);l>-1&&(e.tooltipItemPayloads[l]=a)},prepare:Dt()},removeTooltipEntrySettings:{reducer(e,t){var n=Qn(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},prepare:Dt()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:uU,replaceTooltipEntrySettings:dU,removeTooltipEntrySettings:mU,setTooltipSettingsState:fU,setActiveMouseOverItemIndex:iD,mouseLeaveItem:pU,mouseLeaveChart:sD,setActiveClickItemIndex:hU,setMouseOverAxisIndex:lD,setMouseClickAxisIndex:vU,setSyncInteraction:cb,setKeyboardInteraction:ub}=aD.actions,gU=aD.reducer;function c2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Vd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?c2(Object(n),!0).forEach(function(a){xU(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function xU(e,t,n){return(t=bU(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bU(e){var t=yU(e,"string");return typeof t=="symbol"?t:t+""}function yU(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jU(e,t,n){return t==="axis"?n==="click"?e.axisInteraction.click:e.axisInteraction.hover:n==="click"?e.itemInteraction.click:e.itemInteraction.hover}function NU(e){return e.index!=null}var oD=(e,t,n,a)=>{if(t==null)return Ii;var l=jU(e,t,n);if(l==null)return Ii;if(l.active)return l;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var o=e.settings.active===!0;if(NU(l)){if(o)return Vd(Vd({},l),{},{active:!0})}else if(a!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:a,graphicalItemId:void 0};return Vd(Vd({},Ii),{},{coordinate:l.coordinate})};function _U(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var n=Number(e);return Number.isFinite(n)?n:void 0}function SU(e,t){var n=_U(e),a=t[0],l=t[1];if(n===void 0)return!1;var o=Math.min(a,l),u=Math.max(a,l);return n>=o&&n<=u}function wU(e,t,n){if(n==null||t==null)return!0;var a=Jt(e,t);return a==null||!Xa(n)?!0:SU(a,n)}var Ky=(e,t,n,a)=>{var l=e?.index;if(l==null)return null;var o=Number(l);if(!it(o))return l;var u=0,d=1/0;t.length>0&&(d=t.length-1);var f=Math.max(u,Math.min(o,d)),p=t[f];return p==null||wU(p,n,a)?String(f):null},cD=(e,t,n,a,l,o,u)=>{if(o!=null){var d=u[0],f=d?.getPosition(o);if(f!=null)return f;var p=l?.[Number(o)];if(p)return n==="horizontal"?{x:p.coordinate,y:(a.top+t)/2}:{x:(a.left+e)/2,y:p.coordinate}}},uD=(e,t,n,a)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var l;if(n==="hover"?l=e.itemInteraction.hover.graphicalItemId:l=e.itemInteraction.click.graphicalItemId,l==null&&a!=null){var o=e.tooltipItemPayloads[0];return o!=null?[o]:[]}return e.tooltipItemPayloads.filter(u=>{var d;return((d=u.settings)===null||d===void 0?void 0:d.graphicalItemId)===l})},dD=e=>e.options.tooltipPayloadSearcher,yo=e=>e.tooltip;function u2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function d2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?u2(Object(n),!0).forEach(function(a){CU(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function CU(e,t,n){return(t=EU(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function EU(e){var t=AU(e,"string");return typeof t=="symbol"?t:t+""}function AU(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zU(e,t){return e??t}var mD=(e,t,n,a,l,o,u)=>{if(!(t==null||o==null)){var{chartData:d,computedData:f,dataStartIndex:p,dataEndIndex:h}=n,v=[];return e.reduce((b,x)=>{var j,{dataDefinedOnItem:N,settings:S}=x,C=zU(N,d),E=Array.isArray(C)?Bz(C,p,h):C,w=(j=S?.dataKey)!==null&&j!==void 0?j:a,z=S?.nameKey,k;if(a&&Array.isArray(E)&&!Array.isArray(E[0])&&u==="axis"?k=WA(E,a,l):k=o(E,t,f,z),Array.isArray(k))k.forEach(P=>{var D=d2(d2({},S),{},{name:P.name,unit:P.unit,color:void 0,fill:void 0});b.push(uw({tooltipEntrySettings:D,dataKey:P.dataKey,payload:P.payload,value:Jt(P.payload,P.dataKey),name:P.name}))});else{var O;b.push(uw({tooltipEntrySettings:S,dataKey:w,payload:k,value:Jt(k,w),name:(O=Jt(k,z))!==null&&O!==void 0?O:S?.name}))}return b},v)}},Wy=ue([ar,yk,Dy],Uk),OU=ue([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),kU=ue([vr,go],jk),jo=ue([OU,ar,kU],Nk,{memoizeOptions:{resultEqualityCheck:tp}}),DU=ue([jo],e=>e.filter(Jf)),MU=ue([jo],wk,{memoizeOptions:{resultEqualityCheck:tp}}),No=ue([MU,ii],Ck),PU=ue([DU,ii,ar],gk),Xy=ue([No,ar,jo],Ek),fD=ue([ar],By),TU=ue([ar],e=>e.allowDataOverflow),pD=ue([fD,TU],XO),qU=ue([jo],e=>e.filter(Jf)),RU=ue([PU,qU,Yf,uk],zk),IU=ue([RU,ii,vr,pD],Ok),LU=ue([jo],Sk),$U=ue([No,ar,LU,Uy,vr],Mk,{memoizeOptions:{resultEqualityCheck:ep}}),BU=ue([Pk,vr,go],xo),UU=ue([BU,vr],Rk),FU=ue([Tk,vr,go],xo),GU=ue([FU,vr],Ik),HU=ue([qk,vr,go],xo),QU=ue([HU,vr],Lk),VU=ue([UU,QU,GU],Xm),YU=ue([ar,fD,pD,IU,$U,VU,vt,vr],$k),vu=ue([ar,vt,No,Xy,Yf,vr,YU],Bk),KU=ue([vu,ar,Wy],Fk),WU=ue([ar,vu,KU,vr],Gk),hD=e=>{var t=vr(e),n=go(e),a=!1;return hu(e,t,n,a)},vD=ue([ar,hD],Kf),gD=ue([ar,Wy,WU,vD],Gy),XU=ue([vt,Xy,ar,vr],Xk),ZU=ue([vt,Xy,ar,vr],Zk),JU=(e,t,n,a,l,o,u,d)=>{if(t){var{type:f}=t,p=ti(e,d);if(a){var h=n==="scaleBand"&&a.bandwidth?a.bandwidth()/2:2,v=f==="category"&&a.bandwidth?a.bandwidth()/h:0;return v=d==="angleAxis"&&l!=null&&l?.length>=2?Xr(l[0]-l[1])*2*v:v,p&&u?u.map((b,x)=>{var j=a.map(b);return it(j)?{coordinate:j+v,value:b,index:x,offset:v}:null}).filter(Zr):a.domain().map((b,x)=>{var j=a.map(b);return it(j)?{coordinate:j+v,value:o?o[b]:b,index:x,offset:v}:null}).filter(Zr)}}},oi=ue([vt,ar,Wy,gD,hD,XU,ZU,vr],JU),Zy=ue([eD,tD,oU],(e,t,n)=>rD(n.shared,e,t)),xD=e=>e.tooltip.settings.trigger,Jy=e=>e.tooltip.settings.defaultIndex,gu=ue([yo,Zy,xD,Jy],oD),Bs=ue([gu,No,pu,vu],Ky),bD=ue([oi,Bs],nD),yD=ue([gu],e=>{if(e)return e.dataKey});ue([gu],e=>{if(e)return e.graphicalItemId});var jD=ue([yo,Zy,xD,Jy],uD),eF=ue([ri,ni,vt,fr,oi,Jy,jD],cD),tF=ue([gu,eF],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),rF=ue([gu],e=>{var t;return(t=e?.active)!==null&&t!==void 0?t:!1}),nF=ue([jD,Bs,ii,pu,bD,dD,Zy],mD),aF=ue([nF],e=>{if(e!=null){var t=e.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(t))}});function m2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function f2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?m2(Object(n),!0).forEach(function(a){iF(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function iF(e,t,n){return(t=sF(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sF(e){var t=lF(e,"string");return typeof t=="symbol"?t:t+""}function lF(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oF=()=>Ie(ar),cF=()=>{var e=oF(),t=Ie(oi),n=Ie(gD);return lo(!e||!n?void 0:f2(f2({},e),{},{scale:n}),t)};function p2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Hl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?p2(Object(n),!0).forEach(function(a){uF(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function uF(e,t,n){return(t=dF(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dF(e){var t=mF(e,"string");return typeof t=="symbol"?t:t+""}function mF(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fF=(e,t,n,a)=>{var l=t.find(o=>o&&o.index===n);if(l){if(e==="horizontal")return{x:l.coordinate,y:a.chartY};if(e==="vertical")return{x:a.chartX,y:l.coordinate}}return{x:0,y:0}},pF=(e,t,n,a)=>{var l=t.find(p=>p&&p.index===n);if(l){if(e==="centric"){var o=l.coordinate,{radius:u}=a;return Hl(Hl(Hl({},a),wr(a.cx,a.cy,u,o)),{},{angle:o,radius:u})}var d=l.coordinate,{angle:f}=a;return Hl(Hl(Hl({},a),wr(a.cx,a.cy,d,f)),{},{angle:f,radius:d})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function hF(e,t){var{chartX:n,chartY:a}=e;return n>=t.left&&n<=t.left+t.width&&a>=t.top&&a<=t.top+t.height}var ND=(e,t,n,a,l)=>{var o,u=(o=t?.length)!==null&&o!==void 0?o:0;if(u<=1||e==null)return 0;if(a==="angleAxis"&&l!=null&&Math.abs(Math.abs(l[1]-l[0])-360)<=1e-6)for(var d=0;d<u;d++){var f,p,h,v,b,x=d>0?(f=n[d-1])===null||f===void 0?void 0:f.coordinate:(p=n[u-1])===null||p===void 0?void 0:p.coordinate,j=(h=n[d])===null||h===void 0?void 0:h.coordinate,N=d>=u-1?(v=n[0])===null||v===void 0?void 0:v.coordinate:(b=n[d+1])===null||b===void 0?void 0:b.coordinate,S=void 0;if(!(x==null||j==null||N==null))if(Xr(j-x)!==Xr(N-j)){var C=[];if(Xr(N-j)===Xr(l[1]-l[0])){S=N;var E=j+l[1]-l[0];C[0]=Math.min(E,(E+x)/2),C[1]=Math.max(E,(E+x)/2)}else{S=x;var w=N+l[1]-l[0];C[0]=Math.min(j,(w+j)/2),C[1]=Math.max(j,(w+j)/2)}var z=[Math.min(j,(S+j)/2),Math.max(j,(S+j)/2)];if(e>z[0]&&e<=z[1]||e>=C[0]&&e<=C[1]){var k;return(k=n[d])===null||k===void 0?void 0:k.index}}else{var O=Math.min(x,N),P=Math.max(x,N);if(e>(O+j)/2&&e<=(P+j)/2){var D;return(D=n[d])===null||D===void 0?void 0:D.index}}}else if(t)for(var L=0;L<u;L++){var U=t[L];if(U!=null){var $=t[L+1],B=t[L-1];if(L===0&&$!=null&&e<=(U.coordinate+$.coordinate)/2||L===u-1&&B!=null&&e>(U.coordinate+B.coordinate)/2||L>0&&L<u-1&&B!=null&&$!=null&&e>(U.coordinate+B.coordinate)/2&&e<=(U.coordinate+$.coordinate)/2)return U.index}}return-1},vF=()=>Ie(Dy),ej=(e,t)=>t,_D=(e,t,n)=>n,tj=(e,t,n,a)=>a,gF=ue(oi,e=>yf(e,t=>t.coordinate)),rj=ue([yo,ej,_D,tj],oD),nj=ue([rj,No,pu,vu],Ky),xF=(e,t,n)=>{if(t!=null){var a=yo(e);return t==="axis"?n==="hover"?a.axisInteraction.hover.dataKey:a.axisInteraction.click.dataKey:n==="hover"?a.itemInteraction.hover.dataKey:a.itemInteraction.click.dataKey}},SD=ue([yo,ej,_D,tj],uD),Zm=ue([ri,ni,vt,fr,oi,tj,SD],cD),bF=ue([rj,Zm],(e,t)=>{var n;return(n=e.coordinate)!==null&&n!==void 0?n:t}),wD=ue([oi,nj],nD),yF=ue([SD,nj,ii,pu,wD,dD,ej],mD),jF=ue([rj,nj],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),NF=(e,t,n,a,l,o,u)=>{if(!(!e||!n||!a||!l)&&hF(e,u)){var d=Z4(e,t),f=ND(d,o,l,n,a),p=fF(t,l,f,e);return{activeIndex:String(f),activeCoordinate:p}}},_F=(e,t,n,a,l,o,u)=>{if(!(!e||!a||!l||!o||!n)){var d=s$(e,n);if(d){var f=J4(d,t),p=ND(f,u,o,a,l),h=pF(t,o,p,d);return{activeIndex:String(p),activeCoordinate:h}}}},SF=(e,t,n,a,l,o,u,d)=>{if(!(!e||!t||!a||!l||!o))return t==="horizontal"||t==="vertical"?NF(e,t,a,l,o,u,d):_F(e,t,n,a,l,o,u)},wF=ue(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,n)=>n,(e,t,n)=>{if(t!=null){var a=e[t];if(a!=null)return n?a.panoramaElement:a.element}}),CF=ue(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(a=>parseInt(a,10)).concat(Object.values(mr)),n=Array.from(new Set(t));return n.sort((a,l)=>a-l)},{memoizeOptions:{resultEqualityCheck:s9}});function h2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function v2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?h2(Object(n),!0).forEach(function(a){EF(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function EF(e,t,n){return(t=AF(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AF(e){var t=zF(e,"string");return typeof t=="symbol"?t:t+""}function zF(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OF={},kF={zIndexMap:Object.values(mr).reduce((e,t)=>v2(v2({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),OF)},DF=new Set(Object.values(mr));function MF(e){return DF.has(e)}var CD=tn({name:"zIndex",initialState:kF,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]?e.zIndexMap[n].consumers+=1:e.zIndexMap[n]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Dt()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(e.zIndexMap[n].consumers-=1,e.zIndexMap[n].consumers<=0&&!MF(n)&&delete e.zIndexMap[n])},prepare:Dt()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:n,element:a,isPanorama:l}=t.payload;e.zIndexMap[n]?l?e.zIndexMap[n].panoramaElement=a:e.zIndexMap[n].element=a:e.zIndexMap[n]={consumers:0,element:l?void 0:a,panoramaElement:l?a:void 0}},prepare:Dt()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(t.payload.isPanorama?e.zIndexMap[n].panoramaElement=void 0:e.zIndexMap[n].element=void 0)},prepare:Dt()}}}),{registerZIndexPortal:PF,unregisterZIndexPortal:TF,registerZIndexPortalElement:qF,unregisterZIndexPortalElement:RF}=CD.actions,IF=CD.reducer;function Ln(e){var{zIndex:t,children:n}=e,a=kL(),l=a&&t!==void 0&&t!==0,o=kr(),u=Qt();g.useLayoutEffect(()=>l?(u(PF({zIndex:t})),()=>{u(TF({zIndex:t}))}):Qs,[u,t,l]);var d=Ie(f=>wF(f,t,o));return l?d?aA.createPortal(n,d):null:n}function db(){return db=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},db.apply(null,arguments)}function g2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Yd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?g2(Object(n),!0).forEach(function(a){LF(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function LF(e,t,n){return(t=$F(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $F(e){var t=BF(e,"string");return typeof t=="symbol"?t:t+""}function BF(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UF(e){var{cursor:t,cursorComp:n,cursorProps:a}=e;return g.isValidElement(t)?g.cloneElement(t,a):g.createElement(n,a)}function FF(e){var t,{coordinate:n,payload:a,index:l,offset:o,tooltipAxisBandSize:u,layout:d,cursor:f,tooltipEventType:p,chartName:h}=e,v=n,b=a,x=l;if(!f||!v||h!=="ScatterChart"&&p!=="axis")return null;var j,N,S;if(h==="ScatterChart")j=v,N=b8,S=mr.cursorLine;else if(h==="BarChart")j=y8(d,v,o,u),N=mO,S=mr.cursorRectangle;else if(d==="radial"&&JA(v)){var{cx:C,cy:E,radius:w,startAngle:z,endAngle:k}=fO(v);j={cx:C,cy:E,startAngle:z,endAngle:k,innerRadius:w,outerRadius:w},N=hO,S=mr.cursorLine}else j={points:u$(d,v,o)},N=lO,S=mr.cursorLine;var O=typeof f=="object"&&"className"in f?f.className:void 0,P=Yd(Yd(Yd(Yd({stroke:"#ccc",pointerEvents:"none"},o),j),tu(f)),{},{payload:b,payloadIndex:x,className:Nt("recharts-tooltip-cursor",O)});return g.createElement(Ln,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:S},g.createElement(UF,{cursor:f,cursorComp:N,cursorProps:P}))}function GF(e){var t=cF(),n=Yz(),a=Vs(),l=vF();return t==null||n==null||a==null||l==null?null:g.createElement(FF,db({},e,{offset:n,layout:a,tooltipAxisBandSize:t,chartName:l}))}var ED=g.createContext(null),HF=()=>g.useContext(ED),tx={exports:{}},x2;function QF(){return x2||(x2=1,(function(e){var t=Object.prototype.hasOwnProperty,n="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(n=!1));function l(f,p,h){this.fn=f,this.context=p,this.once=h||!1}function o(f,p,h,v,b){if(typeof h!="function")throw new TypeError("The listener must be a function");var x=new l(h,v||f,b),j=n?n+p:p;return f._events[j]?f._events[j].fn?f._events[j]=[f._events[j],x]:f._events[j].push(x):(f._events[j]=x,f._eventsCount++),f}function u(f,p){--f._eventsCount===0?f._events=new a:delete f._events[p]}function d(){this._events=new a,this._eventsCount=0}d.prototype.eventNames=function(){var p=[],h,v;if(this._eventsCount===0)return p;for(v in h=this._events)t.call(h,v)&&p.push(n?v.slice(1):v);return Object.getOwnPropertySymbols?p.concat(Object.getOwnPropertySymbols(h)):p},d.prototype.listeners=function(p){var h=n?n+p:p,v=this._events[h];if(!v)return[];if(v.fn)return[v.fn];for(var b=0,x=v.length,j=new Array(x);b<x;b++)j[b]=v[b].fn;return j},d.prototype.listenerCount=function(p){var h=n?n+p:p,v=this._events[h];return v?v.fn?1:v.length:0},d.prototype.emit=function(p,h,v,b,x,j){var N=n?n+p:p;if(!this._events[N])return!1;var S=this._events[N],C=arguments.length,E,w;if(S.fn){switch(S.once&&this.removeListener(p,S.fn,void 0,!0),C){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,h),!0;case 3:return S.fn.call(S.context,h,v),!0;case 4:return S.fn.call(S.context,h,v,b),!0;case 5:return S.fn.call(S.context,h,v,b,x),!0;case 6:return S.fn.call(S.context,h,v,b,x,j),!0}for(w=1,E=new Array(C-1);w<C;w++)E[w-1]=arguments[w];S.fn.apply(S.context,E)}else{var z=S.length,k;for(w=0;w<z;w++)switch(S[w].once&&this.removeListener(p,S[w].fn,void 0,!0),C){case 1:S[w].fn.call(S[w].context);break;case 2:S[w].fn.call(S[w].context,h);break;case 3:S[w].fn.call(S[w].context,h,v);break;case 4:S[w].fn.call(S[w].context,h,v,b);break;default:if(!E)for(k=1,E=new Array(C-1);k<C;k++)E[k-1]=arguments[k];S[w].fn.apply(S[w].context,E)}}return!0},d.prototype.on=function(p,h,v){return o(this,p,h,v,!1)},d.prototype.once=function(p,h,v){return o(this,p,h,v,!0)},d.prototype.removeListener=function(p,h,v,b){var x=n?n+p:p;if(!this._events[x])return this;if(!h)return u(this,x),this;var j=this._events[x];if(j.fn)j.fn===h&&(!b||j.once)&&(!v||j.context===v)&&u(this,x);else{for(var N=0,S=[],C=j.length;N<C;N++)(j[N].fn!==h||b&&!j[N].once||v&&j[N].context!==v)&&S.push(j[N]);S.length?this._events[x]=S.length===1?S[0]:S:u(this,x)}return this},d.prototype.removeAllListeners=function(p){var h;return p?(h=n?n+p:p,this._events[h]&&u(this,h)):(this._events=new a,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=n,d.EventEmitter=d,e.exports=d})(tx)),tx.exports}var VF=QF();const YF=ei(VF);var Wc=new YF,mb="recharts.syncEvent.tooltip",b2="recharts.syncEvent.brush",AD=(e,t)=>{if(t&&Array.isArray(e)){var n=Number.parseInt(t,10);if(!pa(n))return e[n]}},KF={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},zD=tn({name:"options",initialState:KF,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),WF=zD.reducer,{createEventEmitter:XF}=zD.actions;function ZF(e){return e.tooltip.syncInteraction}var JF={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},OD=tn({name:"chartData",initialState:JF,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:a}=t.payload;n!=null&&(e.dataStartIndex=n),a!=null&&(e.dataEndIndex=a)}}}),{setChartData:y2,setDataStartEndIndexes:eG,setComputedData:Vee}=OD.actions,tG=OD.reducer,rG=["x","y"];function j2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Ql(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?j2(Object(n),!0).forEach(function(a){nG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function nG(e,t,n){return(t=aG(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aG(e){var t=iG(e,"string");return typeof t=="symbol"?t:t+""}function iG(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sG(e,t){if(e==null)return{};var n,a,l=lG(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function lG(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function oG(){var e=Ie(My),t=Ie(Py),n=Qt(),a=Ie(dk),l=Ie(oi),o=Vs(),u=Tf(),d=Ie(f=>f.rootProps.className);g.useEffect(()=>{if(e==null)return Qs;var f=(p,h,v)=>{if(t!==v&&e===p){if(a==="index"){var b;if(u&&h!==null&&h!==void 0&&(b=h.payload)!==null&&b!==void 0&&b.coordinate&&h.payload.sourceViewBox){var x=h.payload.coordinate,{x:j,y:N}=x,S=sG(x,rG),{x:C,y:E,width:w,height:z}=h.payload.sourceViewBox,k=Ql(Ql({},S),{},{x:u.x+(w?(j-C)/w:0)*u.width,y:u.y+(z?(N-E)/z:0)*u.height});n(Ql(Ql({},h),{},{payload:Ql(Ql({},h.payload),{},{coordinate:k})}))}else n(h);return}if(l!=null){var O;if(typeof a=="function"){var P={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},D=a(l,P);O=l[D]}else a==="value"&&(O=l.find(q=>String(q.value)===h.payload.label));var{coordinate:L}=h.payload;if(O==null||h.payload.active===!1||L==null||u==null){n(cb({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:U,y:$}=L,B=Math.min(U,u.x+u.width),re=Math.min($,u.y+u.height),se={x:o==="horizontal"?O.coordinate:B,y:o==="horizontal"?re:O.coordinate},M=cb({active:h.payload.active,coordinate:se,dataKey:h.payload.dataKey,index:String(O.index),label:h.payload.label,sourceViewBox:h.payload.sourceViewBox,graphicalItemId:h.payload.graphicalItemId});n(M)}}};return Wc.on(mb,f),()=>{Wc.off(mb,f)}},[d,n,t,e,a,l,o,u])}function cG(){var e=Ie(My),t=Ie(Py),n=Qt();g.useEffect(()=>{if(e==null)return Qs;var a=(l,o,u)=>{t!==u&&e===l&&n(eG(o))};return Wc.on(b2,a),()=>{Wc.off(b2,a)}},[n,t,e])}function uG(){var e=Qt();g.useEffect(()=>{e(XF())},[e]),oG(),cG()}function dG(e,t,n,a,l,o){var u=Ie(x=>xF(x,e,t)),d=Ie(Py),f=Ie(My),p=Ie(dk),h=Ie(ZF),v=h?.active,b=Tf();g.useEffect(()=>{if(!v&&f!=null&&d!=null){var x=cb({active:o,coordinate:n,dataKey:u,index:l,label:typeof a=="number"?String(a):a,sourceViewBox:b,graphicalItemId:void 0});Wc.emit(mb,f,x,d)}},[v,n,u,l,a,d,f,p,o,b])}function N2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function _2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?N2(Object(n),!0).forEach(function(a){mG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function mG(e,t,n){return(t=fG(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fG(e){var t=pG(e,"string");return typeof t=="symbol"?t:t+""}function pG(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hG(e){return e.dataKey}function vG(e,t){return g.isValidElement(e)?g.cloneElement(e,t):typeof e=="function"?g.createElement(e,t):g.createElement(ZL,t)}var S2=[],gG={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function w2(e){var t,n,a=Lr(e,gG),{active:l,allowEscapeViewBox:o,animationDuration:u,animationEasing:d,content:f,filterNull:p,isAnimationActive:h,offset:v,payloadUniqBy:b,position:x,reverseDirection:j,useTranslate3d:N,wrapperStyle:S,cursor:C,shared:E,trigger:w,defaultIndex:z,portal:k,axisId:O}=a,P=Qt(),D=typeof z=="number"?String(z):z;g.useEffect(()=>{P(fU({shared:E,trigger:w,axisId:O,active:l,defaultIndex:D}))},[P,E,w,O,l,D]);var L=Tf(),U=sO(),$=lU(E),{activeIndex:B,isActive:re}=(t=Ie(ve=>jF(ve,$,w,D)))!==null&&t!==void 0?t:{},se=Ie(ve=>yF(ve,$,w,D)),M=Ie(ve=>wD(ve,$,w,D)),q=Ie(ve=>bF(ve,$,w,D)),F=se,R=HF(),K=(n=l??re)!==null&&n!==void 0?n:!1,[I,te]=R6([F,K]),Y=$==="axis"?M:void 0;dG($,w,q,Y,B,K);var oe=k??R;if(oe==null||L==null||$==null)return null;var he=F??S2;K||(he=S2),p&&he.length&&(he=c6(he.filter(ve=>ve.value!=null&&(ve.hide!==!0||a.includeHidden)),b,hG));var ge=he.length>0,Q=g.createElement(i8,{allowEscapeViewBox:o,animationDuration:u,animationEasing:d,isAnimationActive:h,active:K,coordinate:q,hasPayload:ge,offset:v,position:x,reverseDirection:j,useTranslate3d:N,viewBox:L,wrapperStyle:S,lastBoundingBox:I,innerRef:te,hasPortalFromProps:!!k},vG(f,_2(_2({},a),{},{payload:he,label:Y,active:K,activeIndex:B,coordinate:q,accessibilityLayer:U})));return g.createElement(g.Fragment,null,aA.createPortal(Q,oe),K&&g.createElement(GF,{cursor:C,tooltipEventType:$,coordinate:q,payload:he,index:B}))}var aj=e=>null;aj.displayName="Cell";function xG(e,t,n){return(t=bG(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bG(e){var t=yG(e,"string");return typeof t=="symbol"?t:t+""}function yG(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class jG{constructor(t){xG(this,"cache",new Map),this.maxSize=t}get(t){var n=this.cache.get(t);return n!==void 0&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var a=this.cache.keys().next().value;a!=null&&this.cache.delete(a)}this.cache.set(t,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function C2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function NG(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?C2(Object(n),!0).forEach(function(a){_G(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _G(e,t,n){return(t=SG(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SG(e){var t=wG(e,"string");return typeof t=="symbol"?t:t+""}function wG(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CG={cacheSize:2e3,enableCache:!0},kD=NG({},CG),E2=new jG(kD.cacheSize),EG={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},A2="recharts_measurement_span";function AG(e,t){var n=t.fontSize||"",a=t.fontFamily||"",l=t.fontWeight||"",o=t.fontStyle||"",u=t.letterSpacing||"",d=t.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(a,"|").concat(l,"|").concat(o,"|").concat(u,"|").concat(d)}var z2=(e,t)=>{try{var n=document.getElementById(A2);n||(n=document.createElement("span"),n.setAttribute("id",A2),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,EG,t),n.textContent="".concat(e);var a=n.getBoundingClientRect();return{width:a.width,height:a.height}}catch{return{width:0,height:0}}},Mc=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Lf.isSsr)return{width:0,height:0};if(!kD.enableCache)return z2(t,n);var a=AG(t,n),l=E2.get(a);if(l)return l;var o=z2(t,n);return E2.set(a,o),o},DD;function zG(e,t,n){return(t=OG(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OG(e){var t=kG(e,"string");return typeof t=="symbol"?t:t+""}function kG(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var O2=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,k2=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,DG=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,MG=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,PG={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},TG=["cm","mm","pt","pc","in","Q","px"];function qG(e){return TG.includes(e)}var Jl="NaN";function RG(e,t){return e*PG[t]}class Sr{static parse(t){var n,[,a,l]=(n=MG.exec(t))!==null&&n!==void 0?n:[];return a==null?Sr.NaN:new Sr(parseFloat(a),l??"")}constructor(t,n){this.num=t,this.unit=n,this.num=t,this.unit=n,pa(t)&&(this.unit=""),n!==""&&!DG.test(n)&&(this.num=NaN,this.unit=""),qG(n)&&(this.num=RG(t,n),this.unit="px")}add(t){return this.unit!==t.unit?new Sr(NaN,""):new Sr(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Sr(NaN,""):new Sr(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Sr(NaN,""):new Sr(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Sr(NaN,""):new Sr(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return pa(this.num)}}DD=Sr;zG(Sr,"NaN",new DD(NaN,""));function MD(e){if(e==null||e.includes(Jl))return Jl;for(var t=e;t.includes("*")||t.includes("/");){var n,[,a,l,o]=(n=O2.exec(t))!==null&&n!==void 0?n:[],u=Sr.parse(a??""),d=Sr.parse(o??""),f=l==="*"?u.multiply(d):u.divide(d);if(f.isNaN())return Jl;t=t.replace(O2,f.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var p,[,h,v,b]=(p=k2.exec(t))!==null&&p!==void 0?p:[],x=Sr.parse(h??""),j=Sr.parse(b??""),N=v==="+"?x.add(j):x.subtract(j);if(N.isNaN())return Jl;t=t.replace(k2,N.toString())}return t}var D2=/\(([^()]*)\)/;function IG(e){for(var t=e,n;(n=D2.exec(t))!=null;){var[,a]=n;t=t.replace(D2,MD(a))}return t}function LG(e){var t=e.replace(/\s+/g,"");return t=IG(t),t=MD(t),t}function $G(e){try{return LG(e)}catch{return Jl}}function rx(e){var t=$G(e.slice(5,-1));return t===Jl?"":t}var BG=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],UG=["dx","dy","angle","className","breakAll"];function fb(){return fb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},fb.apply(null,arguments)}function M2(e,t){if(e==null)return{};var n,a,l=FG(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function FG(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var PD=/[ \f\n\r\t\v\u2028\u2029]+/,TD=e=>{var{children:t,breakAll:n,style:a}=e;try{var l=[];Rt(t)||(n?l=t.toString().split(""):l=t.toString().split(PD));var o=l.map(d=>({word:d,width:Mc(d,a).width})),u=n?0:Mc("",a).width;return{wordsWithComputedWidth:o,spaceWidth:u}}catch{return null}};function GG(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var qD=(e,t,n,a)=>e.reduce((l,o)=>{var{word:u,width:d}=o,f=l[l.length-1];if(f&&d!=null&&(t==null||a||f.width+d+n<Number(t)))f.words.push(u),f.width+=d+n;else{var p={words:[u],width:d};l.push(p)}return l},[]),RD=e=>e.reduce((t,n)=>t.width>n.width?t:n),HG="",P2=(e,t,n,a,l,o,u,d)=>{var f=e.slice(0,t),p=TD({breakAll:n,style:a,children:f+HG});if(!p)return[!1,[]];var h=qD(p.wordsWithComputedWidth,o,u,d),v=h.length>l||RD(h).width>Number(o);return[v,h]},QG=(e,t,n,a,l)=>{var{maxLines:o,children:u,style:d,breakAll:f}=e,p=De(o),h=String(u),v=qD(t,a,n,l);if(!p||l)return v;var b=v.length>o||RD(v).width>Number(a);if(!b)return v;for(var x=0,j=h.length-1,N=0,S;x<=j&&N<=h.length-1;){var C=Math.floor((x+j)/2),E=C-1,[w,z]=P2(h,E,f,d,o,a,n,l),[k]=P2(h,C,f,d,o,a,n,l);if(!w&&!k&&(x=C+1),w&&k&&(j=C-1),!w&&k){S=z;break}N++}return S||v},T2=e=>{var t=Rt(e)?[]:e.toString().split(PD);return[{words:t,width:void 0}]},VG=e=>{var{width:t,scaleToFit:n,children:a,style:l,breakAll:o,maxLines:u}=e;if((t||n)&&!Lf.isSsr){var d,f,p=TD({breakAll:o,children:a,style:l});if(p){var{wordsWithComputedWidth:h,spaceWidth:v}=p;d=h,f=v}else return T2(a);return QG({breakAll:o,children:a,maxLines:u,style:l},d,f,t,!!n)}return T2(a)},ID="#808080",YG={angle:0,breakAll:!1,capHeight:"0.71em",fill:ID,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},ij=g.forwardRef((e,t)=>{var n=Lr(e,YG),{x:a,y:l,lineHeight:o,capHeight:u,fill:d,scaleToFit:f,textAnchor:p,verticalAnchor:h}=n,v=M2(n,BG),b=g.useMemo(()=>VG({breakAll:v.breakAll,children:v.children,maxLines:v.maxLines,scaleToFit:f,style:v.style,width:v.width}),[v.breakAll,v.children,v.maxLines,f,v.style,v.width]),{dx:x,dy:j,angle:N,className:S,breakAll:C}=v,E=M2(v,UG);if(!ha(a)||!ha(l)||b.length===0)return null;var w=Number(a)+(De(x)?x:0),z=Number(l)+(De(j)?j:0);if(!it(w)||!it(z))return null;var k;switch(h){case"start":k=rx("calc(".concat(u,")"));break;case"middle":k=rx("calc(".concat((b.length-1)/2," * -").concat(o," + (").concat(u," / 2))"));break;default:k=rx("calc(".concat(b.length-1," * -").concat(o,")"));break}var O=[],P=b[0];if(f&&P!=null){var D=P.width,{width:L}=v;O.push("scale(".concat(De(L)&&De(D)?L/D:1,")"))}return N&&O.push("rotate(".concat(N,", ").concat(w,", ").concat(z,")")),O.length&&(E.transform=O.join(" ")),g.createElement("text",fb({},Rr(E),{ref:t,x:w,y:z,className:Nt("recharts-text",S),textAnchor:p,fill:d.includes("url")?ID:d}),b.map((U,$)=>{var B=U.words.join(C?"":" ");return g.createElement("tspan",{x:w,dy:$===0?k:o,key:"".concat(B,"-").concat($)},B)}))});ij.displayName="Text";function q2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function la(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?q2(Object(n),!0).forEach(function(a){KG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function KG(e,t,n){return(t=WG(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function WG(e){var t=XG(e,"string");return typeof t=="symbol"?t:t+""}function XG(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZG=e=>{var{viewBox:t,position:n,offset:a=0,parentViewBox:l}=e,{x:o,y:u,height:d,upperWidth:f,lowerWidth:p}=ny(t),h=o,v=o+(f-p)/2,b=(h+v)/2,x=(f+p)/2,j=h+f/2,N=d>=0?1:-1,S=N*a,C=N>0?"end":"start",E=N>0?"start":"end",w=f>=0?1:-1,z=w*a,k=w>0?"end":"start",O=w>0?"start":"end",P=l;if(n==="top"){var D={x:h+f/2,y:u-S,horizontalAnchor:"middle",verticalAnchor:C};return P&&(D.height=Math.max(u-P.y,0),D.width=f),D}if(n==="bottom"){var L={x:v+p/2,y:u+d+S,horizontalAnchor:"middle",verticalAnchor:E};return P&&(L.height=Math.max(P.y+P.height-(u+d),0),L.width=p),L}if(n==="left"){var U={x:b-z,y:u+d/2,horizontalAnchor:k,verticalAnchor:"middle"};return P&&(U.width=Math.max(U.x-P.x,0),U.height=d),U}if(n==="right"){var $={x:b+x+z,y:u+d/2,horizontalAnchor:O,verticalAnchor:"middle"};return P&&($.width=Math.max(P.x+P.width-$.x,0),$.height=d),$}var B=P?{width:x,height:d}:{};return n==="insideLeft"?la({x:b+z,y:u+d/2,horizontalAnchor:O,verticalAnchor:"middle"},B):n==="insideRight"?la({x:b+x-z,y:u+d/2,horizontalAnchor:k,verticalAnchor:"middle"},B):n==="insideTop"?la({x:h+f/2,y:u+S,horizontalAnchor:"middle",verticalAnchor:E},B):n==="insideBottom"?la({x:v+p/2,y:u+d-S,horizontalAnchor:"middle",verticalAnchor:C},B):n==="insideTopLeft"?la({x:h+z,y:u+S,horizontalAnchor:O,verticalAnchor:E},B):n==="insideTopRight"?la({x:h+f-z,y:u+S,horizontalAnchor:k,verticalAnchor:E},B):n==="insideBottomLeft"?la({x:v+z,y:u+d-S,horizontalAnchor:O,verticalAnchor:C},B):n==="insideBottomRight"?la({x:v+p-z,y:u+d-S,horizontalAnchor:k,verticalAnchor:C},B):n&&typeof n=="object"&&(De(n.x)||qs(n.x))&&(De(n.y)||qs(n.y))?la({x:o+Yn(n.x,x),y:u+Yn(n.y,d),horizontalAnchor:"end",verticalAnchor:"end"},B):la({x:j,y:u+d/2,horizontalAnchor:"middle",verticalAnchor:"middle"},B)},JG=["labelRef"],eH=["content"];function R2(e,t){if(e==null)return{};var n,a,l=tH(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function tH(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function I2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function kc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?I2(Object(n),!0).forEach(function(a){rH(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function rH(e,t,n){return(t=nH(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nH(e){var t=aH(e,"string");return typeof t=="symbol"?t:t+""}function aH(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $a(){return $a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},$a.apply(null,arguments)}var LD=g.createContext(null),iH=e=>{var{x:t,y:n,upperWidth:a,lowerWidth:l,width:o,height:u,children:d}=e,f=g.useMemo(()=>({x:t,y:n,upperWidth:a,lowerWidth:l,width:o,height:u}),[t,n,a,l,o,u]);return g.createElement(LD.Provider,{value:f},d)},$D=()=>{var e=g.useContext(LD),t=Tf();return e||(t?ny(t):void 0)},sH=g.createContext(null),lH=()=>{var e=g.useContext(sH),t=Ie(vk);return e||t},oH=e=>{var{value:t,formatter:n}=e,a=Rt(e.children)?t:e.children;return typeof n=="function"?n(a):a},sj=e=>e!=null&&typeof e=="function",cH=(e,t)=>{var n=Xr(t-e),a=Math.min(Math.abs(t-e),360);return n*a},uH=(e,t,n,a,l)=>{var{offset:o,className:u}=e,{cx:d,cy:f,innerRadius:p,outerRadius:h,startAngle:v,endAngle:b,clockWise:x}=l,j=(p+h)/2,N=cH(v,b),S=N>=0?1:-1,C,E;switch(t){case"insideStart":C=v+S*o,E=x;break;case"insideEnd":C=b-S*o,E=!x;break;case"end":C=b+S*o,E=x;break;default:throw new Error("Unsupported position ".concat(t))}E=N<=0?E:!E;var w=wr(d,f,j,C),z=wr(d,f,j,C+(E?1:-1)*359),k="M".concat(w.x,",").concat(w.y,`
    A`).concat(j,",").concat(j,",0,1,").concat(E?0:1,`,
    `).concat(z.x,",").concat(z.y),O=Rt(e.id)?Rc("recharts-radial-line-"):e.id;return g.createElement("text",$a({},a,{dominantBaseline:"central",className:Nt("recharts-radial-bar-label",u)}),g.createElement("defs",null,g.createElement("path",{id:O,d:k})),g.createElement("textPath",{xlinkHref:"#".concat(O)},n))},dH=(e,t,n)=>{var{cx:a,cy:l,innerRadius:o,outerRadius:u,startAngle:d,endAngle:f}=e,p=(d+f)/2;if(n==="outside"){var{x:h,y:v}=wr(a,l,u+t,p);return{x:h,y:v,textAnchor:h>=a?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"end"};var b=(o+u)/2,{x,y:j}=wr(a,l,b,p);return{x,y:j,textAnchor:"middle",verticalAnchor:"middle"}},sm=e=>e!=null&&"cx"in e&&De(e.cx),mH={angle:0,offset:5,zIndex:mr.label,position:"middle",textBreakAll:!1};function fH(e){if(!sm(e))return e;var{cx:t,cy:n,outerRadius:a}=e,l=a*2;return{x:t-a,y:n-a,width:l,upperWidth:l,lowerWidth:l,height:l}}function Ri(e){var t=Lr(e,mH),{viewBox:n,parentViewBox:a,position:l,value:o,children:u,content:d,className:f="",textBreakAll:p,labelRef:h}=t,v=lH(),b=$D(),x=l==="center"?b:v??b,j,N,S;n==null?j=x:sm(n)?j=n:j=ny(n);var C=fH(j);if(!j||Rt(o)&&Rt(u)&&!g.isValidElement(d)&&typeof d!="function")return null;var E=kc(kc({},t),{},{viewBox:j});if(g.isValidElement(d)){var{labelRef:w}=E,z=R2(E,JG);return g.cloneElement(d,z)}if(typeof d=="function"){var{content:k}=E,O=R2(E,eH);if(N=g.createElement(d,O),g.isValidElement(N))return N}else N=oH(t);var P=Rr(t);if(sm(j)){if(l==="insideStart"||l==="insideEnd"||l==="end")return uH(t,l,N,P,j);S=dH(j,t.offset,t.position)}else{if(!C)return null;var D=ZG({viewBox:C,position:l,offset:t.offset,parentViewBox:sm(a)?void 0:a});S=kc(kc({x:D.x,y:D.y,textAnchor:D.horizontalAnchor,verticalAnchor:D.verticalAnchor},D.width!==void 0?{width:D.width}:{}),D.height!==void 0?{height:D.height}:{})}return g.createElement(Ln,{zIndex:t.zIndex},g.createElement(ij,$a({ref:h,className:Nt("recharts-label",f)},P,S,{textAnchor:GG(P.textAnchor)?P.textAnchor:S.textAnchor,breakAll:p}),N))}Ri.displayName="Label";var pH=(e,t,n)=>{if(!e)return null;var a={viewBox:t,labelRef:n};return e===!0?g.createElement(Ri,$a({key:"label-implicit"},a)):ha(e)?g.createElement(Ri,$a({key:"label-implicit",value:e},a)):g.isValidElement(e)?e.type===Ri?g.cloneElement(e,kc({key:"label-implicit"},a)):g.createElement(Ri,$a({key:"label-implicit",content:e},a)):sj(e)?g.createElement(Ri,$a({key:"label-implicit",content:e},a)):e&&typeof e=="object"?g.createElement(Ri,$a({},e,{key:"label-implicit"},a)):null};function hH(e){var{label:t,labelRef:n}=e,a=$D();return pH(t,a,n)||null}var nx={},ax={},L2;function vH(){return L2||(L2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n[n.length-1]}e.last=t})(ax)),ax}var ix={},$2;function gH(){return $2||($2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Array.isArray(n)?n:Array.from(n)}e.toArray=t})(ix)),ix}var B2;function xH(){return B2||(B2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vH(),n=gH(),a=Qb();function l(o){if(a.isArrayLike(o))return t.last(n.toArray(o))}e.last=l})(nx)),nx}var sx,U2;function bH(){return U2||(U2=1,sx=xH().last),sx}var yH=bH();const jH=ei(yH);var NH=["valueAccessor"],_H=["dataKey","clockWise","id","textBreakAll","zIndex"];function Jm(){return Jm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Jm.apply(null,arguments)}function F2(e,t){if(e==null)return{};var n,a,l=SH(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function SH(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var wH=e=>Array.isArray(e.value)?jH(e.value):e.value,BD=g.createContext(void 0),UD=BD.Provider,FD=g.createContext(void 0);FD.Provider;function CH(){return g.useContext(BD)}function EH(){return g.useContext(FD)}function lm(e){var{valueAccessor:t=wH}=e,n=F2(e,NH),{dataKey:a,clockWise:l,id:o,textBreakAll:u,zIndex:d}=n,f=F2(n,_H),p=CH(),h=EH(),v=p||h;return!v||!v.length?null:g.createElement(Ln,{zIndex:d??mr.label},g.createElement(Tn,{className:"recharts-label-list"},v.map((b,x)=>{var j,N=Rt(a)?t(b,x):Jt(b.payload,a),S=Rt(o)?{}:{id:"".concat(o,"-").concat(x)};return g.createElement(Ri,Jm({key:"label-".concat(x)},Rr(b),f,S,{fill:(j=n.fill)!==null&&j!==void 0?j:b.fill,parentViewBox:b.parentViewBox,value:N,textBreakAll:u,viewBox:b.viewBox,index:x,zIndex:0}))})))}lm.displayName="LabelList";function GD(e){var{label:t}=e;return t?t===!0?g.createElement(lm,{key:"labelList-implicit"}):g.isValidElement(t)||sj(t)?g.createElement(lm,{key:"labelList-implicit",content:t}):typeof t=="object"?g.createElement(lm,Jm({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function pb(){return pb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},pb.apply(null,arguments)}var HD=e=>{var{cx:t,cy:n,r:a,className:l}=e,o=Nt("recharts-dot",l);return De(t)&&De(n)&&De(a)?g.createElement("circle",pb({},Vn(e),Gb(e),{className:o,cx:t,cy:n,r:a})):null},AH={radiusAxis:{},angleAxis:{}},QD=tn({name:"polarAxis",initialState:AH,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Yee,removeRadiusAxis:Kee,addAngleAxis:Wee,removeAngleAxis:Xee}=QD.actions,zH=QD.reducer;function OH(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var lx={exports:{}},jt={};var G2;function kH(){if(G2)return jt;G2=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),b=Symbol.for("react.view_transition"),x=Symbol.for("react.client.reference");function j(N){if(typeof N=="object"&&N!==null){var S=N.$$typeof;switch(S){case e:switch(N=N.type,N){case n:case l:case a:case f:case p:case b:return N;default:switch(N=N&&N.$$typeof,N){case u:case d:case v:case h:return N;case o:return N;default:return S}}case t:return S}}}return jt.ContextConsumer=o,jt.ContextProvider=u,jt.Element=e,jt.ForwardRef=d,jt.Fragment=n,jt.Lazy=v,jt.Memo=h,jt.Portal=t,jt.Profiler=l,jt.StrictMode=a,jt.Suspense=f,jt.SuspenseList=p,jt.isContextConsumer=function(N){return j(N)===o},jt.isContextProvider=function(N){return j(N)===u},jt.isElement=function(N){return typeof N=="object"&&N!==null&&N.$$typeof===e},jt.isForwardRef=function(N){return j(N)===d},jt.isFragment=function(N){return j(N)===n},jt.isLazy=function(N){return j(N)===v},jt.isMemo=function(N){return j(N)===h},jt.isPortal=function(N){return j(N)===t},jt.isProfiler=function(N){return j(N)===l},jt.isStrictMode=function(N){return j(N)===a},jt.isSuspense=function(N){return j(N)===f},jt.isSuspenseList=function(N){return j(N)===p},jt.isValidElementType=function(N){return typeof N=="string"||typeof N=="function"||N===n||N===l||N===a||N===f||N===p||typeof N=="object"&&N!==null&&(N.$$typeof===v||N.$$typeof===h||N.$$typeof===u||N.$$typeof===o||N.$$typeof===d||N.$$typeof===x||N.getModuleId!==void 0)},jt.typeOf=j,jt}var H2;function DH(){return H2||(H2=1,lx.exports=kH()),lx.exports}var MH=DH(),Q2=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",V2=null,ox=null,VD=e=>{if(e===V2&&Array.isArray(ox))return ox;var t=[];return g.Children.forEach(e,n=>{Rt(n)||(MH.isFragment(n)?t=t.concat(VD(n.props.children)):t.push(n))}),ox=t,V2=e,t};function PH(e,t){var n=[],a=[];return Array.isArray(t)?a=t.map(l=>Q2(l)):a=[Q2(t)],VD(e).forEach(l=>{var o=io(l,"type.displayName")||io(l,"type.name");o&&a.indexOf(o)!==-1&&n.push(l)}),n}var YD=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,cx={},Y2;function TH(){return Y2||(Y2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const l=n[Symbol.toStringTag];return l==null||!Object.getOwnPropertyDescriptor(n,Symbol.toStringTag)?.writable?!1:n.toString()===`[object ${l}]`}let a=n;for(;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(n)===a}e.isPlainObject=t})(cx)),cx}var ux,K2;function qH(){return K2||(K2=1,ux=TH().isPlainObject),ux}var RH=qH();const IH=ei(RH);var W2,X2,Z2,J2,eE;function tE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function rE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tE(Object(n),!0).forEach(function(a){LH(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function LH(e,t,n){return(t=$H(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $H(e){var t=BH(e,"string");return typeof t=="symbol"?t:t+""}function BH(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ef(){return ef=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ef.apply(null,arguments)}function Sc(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var nE=(e,t,n,a,l)=>{var o=n-a,u;return u=Ut(W2||(W2=Sc(["M ",",",""])),e,t),u+=Ut(X2||(X2=Sc(["L ",",",""])),e+n,t),u+=Ut(Z2||(Z2=Sc(["L ",",",""])),e+n-o/2,t+l),u+=Ut(J2||(J2=Sc(["L ",",",""])),e+n-o/2-a,t+l),u+=Ut(eE||(eE=Sc(["L ",","," Z"])),e,t),u},UH={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},FH=e=>{var t=Lr(e,UH),{x:n,y:a,upperWidth:l,lowerWidth:o,height:u,className:d}=t,{animationEasing:f,animationDuration:p,animationBegin:h,isUpdateAnimationActive:v}=t,b=g.useRef(null),[x,j]=g.useState(-1),N=g.useRef(l),S=g.useRef(o),C=g.useRef(u),E=g.useRef(n),w=g.useRef(a),z=Bf(e,"trapezoid-");if(g.useEffect(()=>{if(b.current&&b.current.getTotalLength)try{var se=b.current.getTotalLength();se&&j(se)}catch{}},[]),n!==+n||a!==+a||l!==+l||o!==+o||u!==+u||l===0&&o===0||u===0)return null;var k=Nt("recharts-trapezoid",d);if(!v)return g.createElement("g",null,g.createElement("path",ef({},Rr(t),{className:k,d:nE(n,a,l,o,u)})));var O=N.current,P=S.current,D=C.current,L=E.current,U=w.current,$="0px ".concat(x===-1?1:x,"px"),B="".concat(x,"px 0px"),re=oO(["strokeDasharray"],p,f);return g.createElement($f,{animationId:z,key:z,canBegin:x>0,duration:p,easing:f,isActive:v,begin:h},se=>{var M=Ft(O,l,se),q=Ft(P,o,se),F=Ft(D,u,se),R=Ft(L,n,se),K=Ft(U,a,se);b.current&&(N.current=M,S.current=q,C.current=F,E.current=R,w.current=K);var I=se>0?{transition:re,strokeDasharray:B}:{strokeDasharray:$};return g.createElement("path",ef({},Rr(t),{className:k,d:nE(R,K,M,q,F),ref:b,style:rE(rE({},I),t.style)}))})},GH=["option","shapeType","activeClassName"];function HH(e,t){if(e==null)return{};var n,a,l=QH(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function QH(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function aE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function tf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?aE(Object(n),!0).forEach(function(a){VH(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function VH(e,t,n){return(t=YH(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function YH(e){var t=KH(e,"string");return typeof t=="symbol"?t:t+""}function KH(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WH(e,t){return tf(tf({},t),e)}function XH(e,t){return e==="symbols"}function iE(e){var{shapeType:t,elementProps:n}=e;switch(t){case"rectangle":return g.createElement(mO,n);case"trapezoid":return g.createElement(FH,n);case"sector":return g.createElement(hO,n);case"symbols":if(XH(t))return g.createElement(ZA,n);break;case"curve":return g.createElement(lO,n);default:return null}}function ZH(e){return g.isValidElement(e)?e.props:e}function KD(e){var{option:t,shapeType:n,activeClassName:a="recharts-active-shape"}=e,l=HH(e,GH),o;if(g.isValidElement(t))o=g.cloneElement(t,tf(tf({},l),ZH(t)));else if(typeof t=="function")o=t(l,l.index);else if(IH(t)&&typeof t!="boolean"){var u=WH(t,l);o=g.createElement(iE,{shapeType:n,elementProps:u})}else{var d=l;o=g.createElement(iE,{shapeType:n,elementProps:d})}return l.isActive?g.createElement(Tn,{className:a},o):o}var WD=(e,t,n)=>{var a=Qt();return(l,o)=>u=>{e?.(l,o,u),a(iD({activeIndex:String(o),activeDataKey:t,activeCoordinate:l.tooltipPosition,activeGraphicalItemId:n}))}},XD=e=>{var t=Qt();return(n,a)=>l=>{e?.(n,a,l),t(pU())}},ZD=(e,t,n)=>{var a=Qt();return(l,o)=>u=>{e?.(l,o,u),a(hU({activeIndex:String(o),activeDataKey:t,activeCoordinate:l.tooltipPosition,activeGraphicalItemId:n}))}};function JD(e){var{tooltipEntrySettings:t}=e,n=Qt(),a=kr(),l=g.useRef(null);return g.useLayoutEffect(()=>{a||(l.current===null?n(uU(t)):l.current!==t&&n(dU({prev:l.current,next:t})),l.current=t)},[t,n,a]),g.useLayoutEffect(()=>()=>{l.current&&(n(mU(l.current)),l.current=null)},[n]),null}function eM(e){var{legendPayload:t}=e,n=Qt(),a=kr(),l=g.useRef(null);return g.useLayoutEffect(()=>{a||(l.current===null?n(GL(t)):l.current!==t&&n(HL({prev:l.current,next:t})),l.current=t)},[n,a,t]),g.useLayoutEffect(()=>()=>{l.current&&(n(QL(l.current)),l.current=null)},[n]),null}var dx,JH=()=>{var[e]=g.useState(()=>Rc("uid-"));return e},eQ=(dx=wq.useId)!==null&&dx!==void 0?dx:JH;function tQ(e,t){var n=eQ();return t||(e?"".concat(e,"-").concat(n):n)}var rQ=g.createContext(void 0),tM=e=>{var{id:t,type:n,children:a}=e,l=tQ("recharts-".concat(n),t);return g.createElement(rQ.Provider,{value:l},a(l))},nQ={cartesianItems:[],polarItems:[]},rM=tn({name:"graphicalItems",initialState:nQ,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Dt()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:n,next:a}=t.payload,l=Qn(e).cartesianItems.indexOf(n);l>-1&&(e.cartesianItems[l]=a)},prepare:Dt()},removeCartesianGraphicalItem:{reducer(e,t){var n=Qn(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},prepare:Dt()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Dt()},removePolarGraphicalItem:{reducer(e,t){var n=Qn(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)},prepare:Dt()}}}),{addCartesianGraphicalItem:aQ,replaceCartesianGraphicalItem:iQ,removeCartesianGraphicalItem:sQ,addPolarGraphicalItem:Zee,removePolarGraphicalItem:Jee}=rM.actions,lQ=rM.reducer,oQ=e=>{var t=Qt(),n=g.useRef(null);return g.useLayoutEffect(()=>{n.current===null?t(aQ(e)):n.current!==e&&t(iQ({prev:n.current,next:e})),n.current=e},[t,e]),g.useLayoutEffect(()=>()=>{n.current&&(t(sQ(n.current)),n.current=null)},[t]),null},nM=g.memo(oQ),cQ=["points"];function sE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function mx(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sE(Object(n),!0).forEach(function(a){uQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function uQ(e,t,n){return(t=dQ(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dQ(e){var t=mQ(e,"string");return typeof t=="symbol"?t:t+""}function mQ(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rf(){return rf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},rf.apply(null,arguments)}function fQ(e,t){if(e==null)return{};var n,a,l=pQ(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function pQ(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function hQ(e){var{option:t,dotProps:n,className:a}=e;if(g.isValidElement(t))return g.cloneElement(t,n);if(typeof t=="function")return t(n);var l=Nt(a,typeof t!="boolean"?t.className:""),o=n??{},{points:u}=o,d=fQ(o,cQ);return g.createElement(HD,rf({},d,{className:l}))}function vQ(e,t){return e==null?!1:t?!0:e.length===1}function gQ(e){var{points:t,dot:n,className:a,dotClassName:l,dataKey:o,baseProps:u,needClip:d,clipPathId:f,zIndex:p=mr.scatter}=e;if(!vQ(t,n))return null;var h=YD(n),v=TR(n),b=t.map((j,N)=>{var S,C,E=mx(mx(mx({r:3},u),v),{},{index:N,cx:(S=j.x)!==null&&S!==void 0?S:void 0,cy:(C=j.y)!==null&&C!==void 0?C:void 0,dataKey:o,value:j.value,payload:j.payload,points:t});return g.createElement(hQ,{key:"dot-".concat(N),option:n,dotProps:E,className:l})}),x={};return d&&f!=null&&(x.clipPath="url(#clipPath-".concat(h?"":"dots-").concat(f,")")),g.createElement(Ln,{zIndex:p},g.createElement(Tn,rf({className:a},x),b))}function lE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function oE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lE(Object(n),!0).forEach(function(a){xQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function xQ(e,t,n){return(t=bQ(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bQ(e){var t=yQ(e,"string");return typeof t=="symbol"?t:t+""}function yQ(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aM=0,jQ={xAxis:{},yAxis:{},zAxis:{}},iM=tn({name:"cartesianAxis",initialState:jQ,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Dt()},replaceXAxis:{reducer(e,t){var{prev:n,next:a}=t.payload;e.xAxis[n.id]!==void 0&&(n.id!==a.id&&delete e.xAxis[n.id],e.xAxis[a.id]=a)},prepare:Dt()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Dt()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Dt()},replaceYAxis:{reducer(e,t){var{prev:n,next:a}=t.payload;e.yAxis[n.id]!==void 0&&(n.id!==a.id&&delete e.yAxis[n.id],e.yAxis[a.id]=a)},prepare:Dt()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Dt()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Dt()},replaceZAxis:{reducer(e,t){var{prev:n,next:a}=t.payload;e.zAxis[n.id]!==void 0&&(n.id!==a.id&&delete e.zAxis[n.id],e.zAxis[a.id]=a)},prepare:Dt()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Dt()},updateYAxisWidth(e,t){var{id:n,width:a}=t.payload,l=e.yAxis[n];if(l){var o,u=l.widthHistory||[];if(u.length===3&&u[0]===u[2]&&a===u[1]&&a!==l.width&&Math.abs(a-((o=u[0])!==null&&o!==void 0?o:0))<=1)return;var d=[...u,a].slice(-3);e.yAxis[n]=oE(oE({},l),{},{width:a,widthHistory:d})}}}}),{addXAxis:NQ,replaceXAxis:_Q,removeXAxis:SQ,addYAxis:wQ,replaceYAxis:CQ,removeYAxis:EQ,addZAxis:ete,replaceZAxis:tte,removeZAxis:rte,updateYAxisWidth:AQ}=iM.actions,zQ=iM.reducer,OQ=ue([fr],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),kQ=ue([OQ,ri,ni],(e,t,n)=>{if(!(!e||t==null||n==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),lj=()=>Ie(kQ),DQ=()=>Ie(aF);function cE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function fx(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cE(Object(n),!0).forEach(function(a){MQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function MQ(e,t,n){return(t=PQ(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PQ(e){var t=TQ(e,"string");return typeof t=="symbol"?t:t+""}function TQ(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qQ=e=>{var{point:t,childIndex:n,mainColor:a,activeDot:l,dataKey:o,clipPath:u}=e;if(l===!1||t.x==null||t.y==null)return null;var d={index:n,dataKey:o,cx:t.x,cy:t.y,r:4,fill:a??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},f=fx(fx(fx({},d),tu(l)),Gb(l)),p;return g.isValidElement(l)?p=g.cloneElement(l,f):typeof l=="function"?p=l(f):p=g.createElement(HD,f),g.createElement(Tn,{className:"recharts-active-dot",clipPath:u},p)};function RQ(e){var{points:t,mainColor:n,activeDot:a,itemDataKey:l,clipPath:o,zIndex:u=mr.activeDot}=e,d=Ie(Bs),f=DQ();if(t==null||f==null)return null;var p=t.find(h=>f.includes(h.payload));return Rt(p)?null:g.createElement(Ln,{zIndex:u},g.createElement(qQ,{point:p,childIndex:Number(d),mainColor:n,dataKey:l,activeDot:a,clipPath:o}))}var uE=(e,t,n)=>{var a=n??e;if(!Rt(a))return Yn(a,t,0)},IQ=(e,t,n)=>{var a={},l=e.filter(Jf),o=e.filter(p=>p.stackId==null),u=l.reduce((p,h)=>{var v=p[h.stackId];return v==null&&(v=[]),v.push(h),p[h.stackId]=v,p},a),d=Object.entries(u).map(p=>{var h,[v,b]=p,x=b.map(N=>N.dataKey),j=uE(t,n,(h=b[0])===null||h===void 0?void 0:h.barSize);return{stackId:v,dataKeys:x,barSize:j}}),f=o.map(p=>{var h=[p.dataKey].filter(b=>b!=null),v=uE(t,n,p.barSize);return{stackId:void 0,dataKeys:h,barSize:v}});return[...d,...f]};function dE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Kd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dE(Object(n),!0).forEach(function(a){LQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function LQ(e,t,n){return(t=$Q(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $Q(e){var t=BQ(e,"string");return typeof t=="symbol"?t:t+""}function BQ(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UQ(e,t,n,a,l){var o,u=a.length;if(!(u<1)){var d=Yn(e,n,0,!0),f,p=[];if(it((o=a[0])===null||o===void 0?void 0:o.barSize)){var h=!1,v=n/u,b=a.reduce((E,w)=>E+(w.barSize||0),0);b+=(u-1)*d,b>=n&&(b-=(u-1)*d,d=0),b>=n&&v>0&&(h=!0,v*=.9,b=u*v);var x=(n-b)/2>>0,j={offset:x-d,size:0};f=a.reduce((E,w)=>{var z,k={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:j.offset+j.size+d,size:h?v:(z=w.barSize)!==null&&z!==void 0?z:0}},O=[...E,k];return j=k.position,O},p)}else{var N=Yn(t,n,0,!0);n-2*N-(u-1)*d<=0&&(d=0);var S=(n-2*N-(u-1)*d)/u;S>1&&(S>>=0);var C=it(l)?Math.min(S,l):S;f=a.reduce((E,w,z)=>[...E,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:N+(S+d)*z+(S-C)/2,size:C}}],p)}return f}}var FQ=(e,t,n,a,l,o,u)=>{var d=Rt(u)?t:u,f=UQ(n,a,l!==o?l:o,e,d);return l!==o&&f!=null&&(f=f.map(p=>Kd(Kd({},p),{},{position:Kd(Kd({},p.position),{},{offset:p.position.offset-l/2})}))),f},GQ=(e,t)=>{var n=Iy(t);if(!(!e||n==null||t==null)){var{stackId:a}=t;if(a!=null){var l=e[a];if(l){var{stackedData:o}=l;if(o)return o.find(u=>u.key===n)}}}},HQ=(e,t)=>{if(!(e==null||t==null)){var n=e.find(a=>a.stackId===t.stackId&&t.dataKey!=null&&a.dataKeys.includes(t.dataKey));if(n!=null)return n.position}};function QQ(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&it(e.zIndex)?e.zIndex:t}var VQ=e=>{var{chartData:t}=e,n=Qt(),a=kr();return g.useEffect(()=>a?()=>{}:(n(y2(t)),()=>{n(y2(void 0))}),[t,n,a]),null},mE={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},sM=tn({name:"brush",initialState:mE,reducers:{setBrushSettings(e,t){return t.payload==null?mE:t.payload}}}),{setBrushSettings:nte}=sM.actions,YQ=sM.reducer;function KQ(e){return(e%180+180)%180}var WQ=function(t){var{width:n,height:a}=t,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=KQ(l),u=o*Math.PI/180,d=Math.atan(a/n),f=u>d&&u<Math.PI-d?a/Math.sin(u):n/Math.cos(u);return Math.abs(f)},XQ={dots:[],areas:[],lines:[]},lM=tn({name:"referenceElements",initialState:XQ,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=Qn(e).dots.findIndex(a=>a===t.payload);n!==-1&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=Qn(e).areas.findIndex(a=>a===t.payload);n!==-1&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=Qn(e).lines.findIndex(a=>a===t.payload);n!==-1&&e.lines.splice(n,1)}}}),{addDot:ate,removeDot:ite,addArea:ste,removeArea:lte,addLine:ote,removeLine:cte}=lM.actions,ZQ=lM.reducer,JQ=g.createContext(void 0),eV=e=>{var{children:t}=e,[n]=g.useState("".concat(Rc("recharts"),"-clip")),a=lj();if(a==null)return null;var{x:l,y:o,width:u,height:d}=a;return g.createElement(JQ.Provider,{value:n},g.createElement("defs",null,g.createElement("clipPath",{id:n},g.createElement("rect",{x:l,y:o,height:d,width:u}))),t)};function oM(e,t){if(t<1)return[];if(t===1)return e;for(var n=[],a=0;a<e.length;a+=t){var l=e[a];l!==void 0&&n.push(l)}return n}function tV(e,t,n){var a={width:e.width+t.width,height:e.height+t.height};return WQ(a,n)}function rV(e,t,n){var a=n==="width",{x:l,y:o,width:u,height:d}=e;return t===1?{start:a?l:o,end:a?l+u:o+d}:{start:a?l+u:o+d,end:a?l:o}}function Xc(e,t,n,a,l){if(e*t<e*a||e*t>e*l)return!1;var o=n();return e*(t-e*o/2-a)>=0&&e*(t+e*o/2-l)<=0}function nV(e,t){return oM(e,t+1)}function aV(e,t,n,a,l){for(var o=(a||[]).slice(),{start:u,end:d}=t,f=0,p=1,h=u,v=function(){var j=a?.[f];if(j===void 0)return{v:oM(a,p)};var N=f,S,C=()=>(S===void 0&&(S=n(j,N)),S),E=j.coordinate,w=f===0||Xc(e,E,C,h,d);w||(f=0,h=u,p+=1),w&&(h=E+e*(C()/2+l),f+=p)},b;p<=o.length;)if(b=v(),b)return b.v;return[]}function iV(e,t,n,a,l){var o=(a||[]).slice(),u=o.length;if(u===0)return[];for(var{start:d,end:f}=t,p=1;p<=u;p++){for(var h=(u-1)%p,v=d,b=!0,x=function(){var z=a[N];if(z==null)return 0;var k=N,O,P=()=>(O===void 0&&(O=n(z,k)),O),D=z.coordinate,L=N===h||Xc(e,D,P,v,f);if(!L)return b=!1,1;L&&(v=D+e*(P()/2+l))},j,N=h;N<u&&(j=x(),!(j!==0&&j===1));N+=p);if(b){for(var S=[],C=h;C<u;C+=p){var E=a[C];E!=null&&S.push(E)}return S}}return[]}function fE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Ar(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fE(Object(n),!0).forEach(function(a){sV(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function sV(e,t,n){return(t=lV(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lV(e){var t=oV(e,"string");return typeof t=="symbol"?t:t+""}function oV(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cV(e,t,n,a,l){for(var o=(a||[]).slice(),u=o.length,{start:d}=t,{end:f}=t,p=function(b){var x=o[b];if(x==null)return 1;var j=x,N,S=()=>(N===void 0&&(N=n(x,b)),N);if(b===u-1){var C=e*(j.coordinate+e*S()/2-f);o[b]=j=Ar(Ar({},j),{},{tickCoord:C>0?j.coordinate-C*e:j.coordinate})}else o[b]=j=Ar(Ar({},j),{},{tickCoord:j.coordinate});if(j.tickCoord!=null){var E=Xc(e,j.tickCoord,S,d,f);E&&(f=j.tickCoord-e*(S()/2+l),o[b]=Ar(Ar({},j),{},{isShow:!0}))}},h=u-1;h>=0;h--)p(h);return o}function uV(e,t,n,a,l,o){var u=(a||[]).slice(),d=u.length,{start:f,end:p}=t;if(o){var h=a[d-1];if(h!=null){var v=n(h,d-1),b=e*(h.coordinate+e*v/2-p);if(u[d-1]=h=Ar(Ar({},h),{},{tickCoord:b>0?h.coordinate-b*e:h.coordinate}),h.tickCoord!=null){var x=Xc(e,h.tickCoord,()=>v,f,p);x&&(p=h.tickCoord-e*(v/2+l),u[d-1]=Ar(Ar({},h),{},{isShow:!0}))}}}for(var j=o?d-1:d,N=function(E){var w=u[E];if(w==null)return 1;var z=w,k,O=()=>(k===void 0&&(k=n(w,E)),k);if(E===0){var P=e*(z.coordinate-e*O()/2-f);u[E]=z=Ar(Ar({},z),{},{tickCoord:P<0?z.coordinate-P*e:z.coordinate})}else u[E]=z=Ar(Ar({},z),{},{tickCoord:z.coordinate});if(z.tickCoord!=null){var D=Xc(e,z.tickCoord,O,f,p);D&&(f=z.tickCoord+e*(O()/2+l),u[E]=Ar(Ar({},z),{},{isShow:!0}))}},S=0;S<j;S++)N(S);return u}function oj(e,t,n){var{tick:a,ticks:l,viewBox:o,minTickGap:u,orientation:d,interval:f,tickFormatter:p,unit:h,angle:v}=e;if(!l||!l.length||!a)return[];if(De(f)||Lf.isSsr){var b;return(b=nV(l,De(f)?f:0))!==null&&b!==void 0?b:[]}var x=[],j=d==="top"||d==="bottom"?"width":"height",N=h&&j==="width"?Mc(h,{fontSize:t,letterSpacing:n}):{width:0,height:0},S=(k,O)=>{var P=typeof p=="function"?p(k.value,O):k.value;return j==="width"?tV(Mc(P,{fontSize:t,letterSpacing:n}),N,v):Mc(P,{fontSize:t,letterSpacing:n})[j]},C=l[0],E=l[1],w=l.length>=2&&C!=null&&E!=null?Xr(E.coordinate-C.coordinate):1,z=rV(o,w,j);return f==="equidistantPreserveStart"?aV(w,z,S,l,u):f==="equidistantPreserveEnd"?iV(w,z,S,l,u):(f==="preserveStart"||f==="preserveStartEnd"?x=uV(w,z,S,l,u,f==="preserveStartEnd"):x=cV(w,z,S,l,u),x.filter(k=>k.isShow))}var dV=e=>{var{ticks:t,label:n,labelGapWithTick:a=5,tickSize:l=0,tickMargin:o=0}=e,u=0;if(t){Array.from(t).forEach(h=>{if(h){var v=h.getBoundingClientRect();v.width>u&&(u=v.width)}});var d=n?n.getBoundingClientRect().width:0,f=l+o,p=u+f+d+(n?a:0);return Math.round(p)}return 0},mV=["axisLine","width","height","className","hide","ticks","axisType"];function fV(e,t){if(e==null)return{};var n,a,l=pV(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function pV(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function Us(){return Us=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Us.apply(null,arguments)}function pE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function $t(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pE(Object(n),!0).forEach(function(a){hV(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function hV(e,t,n){return(t=vV(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vV(e){var t=gV(e,"string");return typeof t=="symbol"?t:t+""}function gV(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qa={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:mr.axis};function xV(e){var{x:t,y:n,width:a,height:l,orientation:o,mirror:u,axisLine:d,otherSvgProps:f}=e;if(!d)return null;var p=$t($t($t({},f),Vn(d)),{},{fill:"none"});if(o==="top"||o==="bottom"){var h=+(o==="top"&&!u||o==="bottom"&&u);p=$t($t({},p),{},{x1:t,y1:n+h*l,x2:t+a,y2:n+h*l})}else{var v=+(o==="left"&&!u||o==="right"&&u);p=$t($t({},p),{},{x1:t+v*a,y1:n,x2:t+v*a,y2:n+l})}return g.createElement("line",Us({},p,{className:Nt("recharts-cartesian-axis-line",io(d,"className"))}))}function bV(e,t,n,a,l,o,u,d,f){var p,h,v,b,x,j,N=d?-1:1,S=e.tickSize||u,C=De(e.tickCoord)?e.tickCoord:e.coordinate;switch(o){case"top":p=h=e.coordinate,b=n+ +!d*l,v=b-N*S,j=v-N*f,x=C;break;case"left":v=b=e.coordinate,h=t+ +!d*a,p=h-N*S,x=p-N*f,j=C;break;case"right":v=b=e.coordinate,h=t+ +d*a,p=h+N*S,x=p+N*f,j=C;break;default:p=h=e.coordinate,b=n+ +d*l,v=b+N*S,j=v+N*f,x=C;break}return{line:{x1:p,y1:v,x2:h,y2:b},tick:{x,y:j}}}function yV(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function jV(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function NV(e){var{option:t,tickProps:n,value:a}=e,l,o=Nt(n.className,"recharts-cartesian-axis-tick-value");if(g.isValidElement(t))l=g.cloneElement(t,$t($t({},n),{},{className:o}));else if(typeof t=="function")l=t($t($t({},n),{},{className:o}));else{var u="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(u=Nt(u,OH(t))),l=g.createElement(ij,Us({},n,{className:u}),a)}return l}var _V=g.forwardRef((e,t)=>{var{ticks:n=[],tick:a,tickLine:l,stroke:o,tickFormatter:u,unit:d,padding:f,tickTextProps:p,orientation:h,mirror:v,x:b,y:x,width:j,height:N,tickSize:S,tickMargin:C,fontSize:E,letterSpacing:w,getTicksConfig:z,events:k,axisType:O}=e,P=oj($t($t({},z),{},{ticks:n}),E,w),D=yV(h,v),L=jV(h,v),U=Vn(z),$=tu(a),B={};typeof l=="object"&&(B=l);var re=$t($t({},U),{},{fill:"none"},B),se=P.map(F=>$t({entry:F},bV(F,b,x,j,N,h,S,v,C))),M=se.map(F=>{var{entry:R,line:K}=F;return g.createElement(Tn,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(R.value,"-").concat(R.coordinate,"-").concat(R.tickCoord)},l&&g.createElement("line",Us({},re,K,{className:Nt("recharts-cartesian-axis-tick-line",io(l,"className"))})))}),q=se.map((F,R)=>{var K,I,{entry:te,tick:Y}=F,oe=$t($t($t($t({verticalAnchor:L},U),{},{textAnchor:D,stroke:"none",fill:o},Y),{},{index:R,payload:te,visibleTicksCount:P.length,tickFormatter:u,padding:f},p),{},{angle:(K=(I=p?.angle)!==null&&I!==void 0?I:U.angle)!==null&&K!==void 0?K:0}),he=$t($t({},oe),$);return g.createElement(Tn,Us({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(te.value,"-").concat(te.coordinate,"-").concat(te.tickCoord)},Hb(k,te,R)),a&&g.createElement(NV,{option:a,tickProps:he,value:"".concat(typeof u=="function"?u(te.value,R):te.value).concat(d||"")}))});return g.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(O,"-ticks")},q.length>0&&g.createElement(Ln,{zIndex:mr.label},g.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(O,"-tick-labels"),ref:t},q)),M.length>0&&g.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(O,"-tick-lines")},M))}),SV=g.forwardRef((e,t)=>{var{axisLine:n,width:a,height:l,className:o,hide:u,ticks:d,axisType:f}=e,p=fV(e,mV),[h,v]=g.useState(""),[b,x]=g.useState(""),j=g.useRef(null);g.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var S;return dV({ticks:j.current,label:(S=e.labelRef)===null||S===void 0?void 0:S.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var N=g.useCallback(S=>{if(S){var C=S.getElementsByClassName("recharts-cartesian-axis-tick-value");j.current=C;var E=C[0];if(E){var w=window.getComputedStyle(E),z=w.fontSize,k=w.letterSpacing;(z!==h||k!==b)&&(v(z),x(k))}}},[h,b]);return u||a!=null&&a<=0||l!=null&&l<=0?null:g.createElement(Ln,{zIndex:e.zIndex},g.createElement(Tn,{className:Nt("recharts-cartesian-axis",o)},g.createElement(xV,{x:e.x,y:e.y,width:a,height:l,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:Vn(e)}),g.createElement(_V,{ref:N,axisType:f,events:p,fontSize:h,getTicksConfig:e,height:e.height,letterSpacing:b,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:d,unit:e.unit,width:e.width,x:e.x,y:e.y}),g.createElement(iH,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},g.createElement(hH,{label:e.label,labelRef:e.labelRef}),e.children)))}),cj=g.forwardRef((e,t)=>{var n=Lr(e,Qa);return g.createElement(SV,Us({},n,{ref:t}))});cj.displayName="CartesianAxis";var wV=["x1","y1","x2","y2","key"],CV=["offset"],EV=["xAxisId","yAxisId"],AV=["xAxisId","yAxisId"];function hE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function zr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hE(Object(n),!0).forEach(function(a){zV(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function zV(e,t,n){return(t=OV(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function OV(e){var t=kV(e,"string");return typeof t=="symbol"?t:t+""}function kV(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function As(){return As=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},As.apply(null,arguments)}function nf(e,t){if(e==null)return{};var n,a,l=DV(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function DV(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var MV=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:n,x:a,y:l,width:o,height:u,ry:d}=e;return g.createElement("rect",{x:a,y:l,ry:d,width:o,height:u,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function cM(e){var{option:t,lineItemProps:n}=e,a;if(g.isValidElement(t))a=g.cloneElement(t,n);else if(typeof t=="function")a=t(n);else{var l,{x1:o,y1:u,x2:d,y2:f,key:p}=n,h=nf(n,wV),v=(l=Vn(h))!==null&&l!==void 0?l:{},{offset:b}=v,x=nf(v,CV);a=g.createElement("line",As({},x,{x1:o,y1:u,x2:d,y2:f,fill:"none",key:p}))}return a}function PV(e){var{x:t,width:n,horizontal:a=!0,horizontalPoints:l}=e;if(!a||!l||!l.length)return null;var{xAxisId:o,yAxisId:u}=e,d=nf(e,EV),f=l.map((p,h)=>{var v=zr(zr({},d),{},{x1:t,y1:p,x2:t+n,y2:p,key:"line-".concat(h),index:h});return g.createElement(cM,{key:"line-".concat(h),option:a,lineItemProps:v})});return g.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function TV(e){var{y:t,height:n,vertical:a=!0,verticalPoints:l}=e;if(!a||!l||!l.length)return null;var{xAxisId:o,yAxisId:u}=e,d=nf(e,AV),f=l.map((p,h)=>{var v=zr(zr({},d),{},{x1:p,y1:t,x2:p,y2:t+n,key:"line-".concat(h),index:h});return g.createElement(cM,{option:a,lineItemProps:v,key:"line-".concat(h)})});return g.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function qV(e){var{horizontalFill:t,fillOpacity:n,x:a,y:l,width:o,height:u,horizontalPoints:d,horizontal:f=!0}=e;if(!f||!t||!t.length||d==null)return null;var p=d.map(v=>Math.round(v+l-l)).sort((v,b)=>v-b);l!==p[0]&&p.unshift(0);var h=p.map((v,b)=>{var x=p[b+1],j=x==null,N=j?l+u-v:x-v;if(N<=0)return null;var S=b%t.length;return g.createElement("rect",{key:"react-".concat(b),y:v,x:a,height:N,width:o,stroke:"none",fill:t[S],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return g.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function RV(e){var{vertical:t=!0,verticalFill:n,fillOpacity:a,x:l,y:o,width:u,height:d,verticalPoints:f}=e;if(!t||!n||!n.length)return null;var p=f.map(v=>Math.round(v+l-l)).sort((v,b)=>v-b);l!==p[0]&&p.unshift(0);var h=p.map((v,b)=>{var x=p[b+1],j=x==null,N=j?l+u-v:x-v;if(N<=0)return null;var S=b%n.length;return g.createElement("rect",{key:"react-".concat(b),x:v,y:o,width:N,height:d,stroke:"none",fill:n[S],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return g.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var IV=(e,t)=>{var{xAxis:n,width:a,height:l,offset:o}=e;return Uz(oj(zr(zr(zr({},Qa),n),{},{ticks:Fz(n),viewBox:{x:0,y:0,width:a,height:l}})),o.left,o.left+o.width,t)},LV=(e,t)=>{var{yAxis:n,width:a,height:l,offset:o}=e;return Uz(oj(zr(zr(zr({},Qa),n),{},{ticks:Fz(n),viewBox:{x:0,y:0,width:a,height:l}})),o.top,o.top+o.height,t)},$V={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:mr.grid};function hb(e){var t=Kz(),n=Wz(),a=Yz(),l=zr(zr({},Lr(e,$V)),{},{x:De(e.x)?e.x:a.left,y:De(e.y)?e.y:a.top,width:De(e.width)?e.width:a.width,height:De(e.height)?e.height:a.height}),{xAxisId:o,yAxisId:u,x:d,y:f,width:p,height:h,syncWithTicks:v,horizontalValues:b,verticalValues:x}=l,j=kr(),N=Ie(L=>o2(L,"xAxis",o,j)),S=Ie(L=>o2(L,"yAxis",u,j));if(!va(p)||!va(h)||!De(d)||!De(f))return null;var C=l.verticalCoordinatesGenerator||IV,E=l.horizontalCoordinatesGenerator||LV,{horizontalPoints:w,verticalPoints:z}=l;if((!w||!w.length)&&typeof E=="function"){var k=b&&b.length,O=E({yAxis:S?zr(zr({},S),{},{ticks:k?b:S.ticks}):void 0,width:t??p,height:n??h,offset:a},k?!0:v);zm(Array.isArray(O),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof O,"]")),Array.isArray(O)&&(w=O)}if((!z||!z.length)&&typeof C=="function"){var P=x&&x.length,D=C({xAxis:N?zr(zr({},N),{},{ticks:P?x:N.ticks}):void 0,width:t??p,height:n??h,offset:a},P?!0:v);zm(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(z=D)}return g.createElement(Ln,{zIndex:l.zIndex},g.createElement("g",{className:"recharts-cartesian-grid"},g.createElement(MV,{fill:l.fill,fillOpacity:l.fillOpacity,x:l.x,y:l.y,width:l.width,height:l.height,ry:l.ry}),g.createElement(qV,As({},l,{horizontalPoints:w})),g.createElement(RV,As({},l,{verticalPoints:z})),g.createElement(PV,As({},l,{offset:a,horizontalPoints:w,xAxis:N,yAxis:S})),g.createElement(TV,As({},l,{offset:a,verticalPoints:z,xAxis:N,yAxis:S}))))}hb.displayName="CartesianGrid";var BV={},uM=tn({name:"errorBars",initialState:BV,reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:a}=t.payload;e[n]||(e[n]=[]),e[n].push(a)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:a,next:l}=t.payload;e[n]&&(e[n]=e[n].map(o=>o.dataKey===a.dataKey&&o.direction===a.direction?l:o))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:a}=t.payload;e[n]&&(e[n]=e[n].filter(l=>l.dataKey!==a.dataKey||l.direction!==a.direction))}}}),{addErrorBar:ute,replaceErrorBar:dte,removeErrorBar:mte}=uM.actions,UV=uM.reducer,FV=["children"];function GV(e,t){if(e==null)return{};var n,a,l=HV(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function HV(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var QV={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},VV=g.createContext(QV);function dM(e){var{children:t}=e,n=GV(e,FV);return g.createElement(VV.Provider,{value:n},t)}function uj(e,t){var n,a,l=Ie(p=>si(p,e)),o=Ie(p=>li(p,t)),u=(n=l?.allowDataOverflow)!==null&&n!==void 0?n:or.allowDataOverflow,d=(a=o?.allowDataOverflow)!==null&&a!==void 0?a:cr.allowDataOverflow,f=u||d;return{needClip:f,needClipX:u,needClipY:d}}function mM(e){var{xAxisId:t,yAxisId:n,clipPathId:a}=e,l=lj(),{needClipX:o,needClipY:u,needClip:d}=uj(t,n);if(!d||!l)return null;var{x:f,y:p,width:h,height:v}=l;return g.createElement("clipPath",{id:"clipPath-".concat(a)},g.createElement("rect",{x:o?f:f-h/2,y:u?p:p-v/2,width:o?h:h*2,height:u?v:v*2}))}var fM=(e,t,n,a)=>Yi(e,"xAxis",t,a),pM=(e,t,n,a)=>Vi(e,"xAxis",t,a),hM=(e,t,n,a)=>Yi(e,"yAxis",n,a),vM=(e,t,n,a)=>Vi(e,"yAxis",n,a),YV=ue([vt,fM,hM,pM,vM],(e,t,n,a,l)=>ti(e,"xAxis")?lo(t,a,!1):lo(n,l,!1)),KV=(e,t,n,a,l)=>l;function WV(e){return e.type==="line"}var XV=ue([rp,KV],(e,t)=>e.filter(WV).find(n=>n.id===t)),ZV=ue([vt,fM,hM,pM,vM,XV,YV,zy],(e,t,n,a,l,o,u,d)=>{var{chartData:f,dataStartIndex:p,dataEndIndex:h}=d;if(!(o==null||t==null||n==null||a==null||l==null||a.length===0||l.length===0||u==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:v,data:b}=o,x;if(b!=null&&b.length>0?x=b:x=f?.slice(p,h+1),x!=null)return LY({layout:e,xAxis:t,yAxis:n,xAxisTicks:a,yAxisTicks:l,dataKey:v,bandSize:u,displayedData:x})}});function JV(e){var t=tu(e),n=3,a=2;if(t!=null){var{r:l,strokeWidth:o}=t,u=Number(l),d=Number(o);return(Number.isNaN(u)||u<0)&&(u=n),(Number.isNaN(d)||d<0)&&(d=a),{r:u,strokeWidth:d}}return{r:n,strokeWidth:a}}var px={exports:{}},hx={};var vE;function eY(){if(vE)return hx;vE=1;var e=ff();function t(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var n=typeof Object.is=="function"?Object.is:t,a=e.useSyncExternalStore,l=e.useRef,o=e.useEffect,u=e.useMemo,d=e.useDebugValue;return hx.useSyncExternalStoreWithSelector=function(f,p,h,v,b){var x=l(null);if(x.current===null){var j={hasValue:!1,value:null};x.current=j}else j=x.current;x=u(function(){function S(k){if(!C){if(C=!0,E=k,k=v(k),b!==void 0&&j.hasValue){var O=j.value;if(b(O,k))return w=O}return w=k}if(O=w,n(E,k))return O;var P=v(k);return b!==void 0&&b(O,P)?(E=k,O):(E=k,w=P)}var C=!1,E,w,z=h===void 0?null:h;return[function(){return S(p())},z===null?void 0:function(){return S(z())}]},[p,h,v,b]);var N=a(f,x[0],x[1]);return o(function(){j.hasValue=!0,j.value=N},[N]),d(N),N},hx}var gE;function tY(){return gE||(gE=1,px.exports=eY()),px.exports}tY();function rY(e){e()}function nY(){let e=null,t=null;return{clear(){e=null,t=null},notify(){rY(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){const n=[];let a=e;for(;a;)n.push(a),a=a.next;return n},subscribe(n){let a=!0;const l=t={callback:n,next:null,prev:t};return l.prev?l.prev.next=l:e=l,function(){!a||e===null||(a=!1,l.next?l.next.prev=l.prev:t=l.prev,l.prev?l.prev.next=l.next:e=l.next)}}}}var xE={notify(){},get:()=>[]};function aY(e,t){let n,a=xE,l=0,o=!1;function u(N){h();const S=a.subscribe(N);let C=!1;return()=>{C||(C=!0,S(),v())}}function d(){a.notify()}function f(){j.onStateChange&&j.onStateChange()}function p(){return o}function h(){l++,n||(n=e.subscribe(f),a=nY())}function v(){l--,n&&l===0&&(n(),n=void 0,a.clear(),a=xE)}function b(){o||(o=!0,h())}function x(){o&&(o=!1,v())}const j={addNestedSub:u,notifyNestedSubs:d,handleChangeWrapper:f,isSubscribed:p,trySubscribe:b,tryUnsubscribe:x,getListeners:()=>a};return j}var iY=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",sY=iY(),lY=()=>typeof navigator<"u"&&navigator.product==="ReactNative",oY=lY(),cY=()=>sY||oY?g.useLayoutEffect:g.useEffect,uY=cY();function bE(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function dY(e,t){if(bE(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(let l=0;l<n.length;l++)if(!Object.prototype.hasOwnProperty.call(t,n[l])||!bE(e[n[l]],t[n[l]]))return!1;return!0}var mY=Symbol.for("react-redux-context"),fY=typeof globalThis<"u"?globalThis:{};function pY(){if(!g.createContext)return{};const e=fY[mY]??=new Map;let t=e.get(g.createContext);return t||(t=g.createContext(null),e.set(g.createContext,t)),t}var hY=pY();function vY(e){const{children:t,context:n,serverState:a,store:l}=e,o=g.useMemo(()=>{const f=aY(l);return{store:l,subscription:f,getServerState:a?()=>a:void 0}},[l,a]),u=g.useMemo(()=>l.getState(),[l]);uY(()=>{const{subscription:f}=o;return f.onStateChange=f.notifyNestedSubs,f.trySubscribe(),u!==l.getState()&&f.notifyNestedSubs(),()=>{f.tryUnsubscribe(),f.onStateChange=void 0}},[o,u]);const d=n||hY;return g.createElement(d.Provider,{value:o},t)}var gY=vY,xY=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function bY(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function lp(e,t){var n=new Set([...Object.keys(e),...Object.keys(t)]);for(var a of n)if(xY.has(a)){if(e[a]==null&&t[a]==null)continue;if(!dY(e[a],t[a]))return!1}else if(!bY(e[a],t[a]))return!1;return!0}var yY=["id"],jY=["type","layout","connectNulls","needClip","shape"],NY=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function Zc(){return Zc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Zc.apply(null,arguments)}function yE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function oa(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yE(Object(n),!0).forEach(function(a){_Y(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function _Y(e,t,n){return(t=SY(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SY(e){var t=wY(e,"string");return typeof t=="symbol"?t:t+""}function wY(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dj(e,t){if(e==null)return{};var n,a,l=CY(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function CY(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var EY=e=>{var{dataKey:t,name:n,stroke:a,legendType:l,hide:o}=e;return[{inactive:o,dataKey:t,type:l,color:a,value:Of(n,t),payload:e}]},AY=g.memo(e=>{var{dataKey:t,data:n,stroke:a,strokeWidth:l,fill:o,name:u,hide:d,unit:f,tooltipType:p,id:h}=e,v={dataDefinedOnItem:n,getPosition:Qs,settings:{stroke:a,strokeWidth:l,fill:o,dataKey:t,nameKey:void 0,name:Of(u,t),hide:d,type:p,color:a,unit:f,graphicalItemId:h}};return g.createElement(JD,{tooltipEntrySettings:v})}),gM=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function zY(e,t){for(var n=e.length%2!==0?[...e,0]:e,a=[],l=0;l<t;++l)a=[...a,...n];return a}var OY=(e,t,n)=>{var a=n.reduce((x,j)=>x+j);if(!a)return gM(t,e);for(var l=Math.floor(e/a),o=e%a,u=t-e,d=[],f=0,p=0;f<n.length;p+=(h=n[f])!==null&&h!==void 0?h:0,++f){var h,v=n[f];if(v!=null&&p+v>o){d=[...n.slice(0,f),o-p];break}}var b=d.length%2===0?[0,u]:[u];return[...zY(n,l),...d,...b].map(x=>"".concat(x,"px")).join(", ")};function kY(e){var{clipPathId:t,points:n,props:a}=e,{dot:l,dataKey:o,needClip:u}=a,{id:d}=a,f=dj(a,yY),p=Vn(f);return g.createElement(gQ,{points:n,dot:l,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:o,baseProps:p,needClip:u,clipPathId:t})}function DY(e){var{showLabels:t,children:n,points:a}=e,l=g.useMemo(()=>a?.map(o=>{var u,d,f={x:(u=o.x)!==null&&u!==void 0?u:0,y:(d=o.y)!==null&&d!==void 0?d:0,width:0,lowerWidth:0,upperWidth:0,height:0};return oa(oa({},f),{},{value:o.value,payload:o.payload,viewBox:f,parentViewBox:void 0,fill:void 0})}),[a]);return g.createElement(UD,{value:t?l:void 0},n)}function jE(e){var{clipPathId:t,pathRef:n,points:a,strokeDasharray:l,props:o}=e,{type:u,layout:d,connectNulls:f,needClip:p,shape:h}=o,v=dj(o,jY),b=oa(oa({},Rr(v)),{},{fill:"none",className:"recharts-line-curve",clipPath:p?"url(#clipPath-".concat(t,")"):void 0,points:a,type:u,layout:d,connectNulls:f,strokeDasharray:l??o.strokeDasharray});return g.createElement(g.Fragment,null,a?.length>1&&g.createElement(KD,Zc({shapeType:"curve",option:h},b,{pathRef:n})),g.createElement(kY,{points:a,clipPathId:t,props:o}))}function MY(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function PY(e){var{clipPathId:t,props:n,pathRef:a,previousPointsRef:l,longestAnimatedLengthRef:o}=e,{points:u,strokeDasharray:d,isAnimationActive:f,animationBegin:p,animationDuration:h,animationEasing:v,animateNewValues:b,width:x,height:j,onAnimationEnd:N,onAnimationStart:S}=n,C=l.current,E=Bf(u,"recharts-line-"),w=g.useRef(E),[z,k]=g.useState(!1),O=!z,P=g.useCallback(()=>{typeof N=="function"&&N(),k(!1)},[N]),D=g.useCallback(()=>{typeof S=="function"&&S(),k(!0)},[S]),L=MY(a.current),U=g.useRef(0);w.current!==E&&(U.current=o.current,w.current=E);var $=U.current;return g.createElement(DY,{points:u,showLabels:O},n.children,g.createElement($f,{animationId:E,begin:p,duration:h,isActive:f,easing:v,onAnimationEnd:P,onAnimationStart:D,key:E},B=>{var re=Ft($,L+$,B),se=Math.min(re,L),M;if(f)if(d){var q="".concat(d).split(/[,\s]+/gim).map(K=>parseFloat(K));M=OY(se,L,q)}else M=gM(L,se);else M=d==null?void 0:String(d);if(B>0&&L>0&&(l.current=u,o.current=Math.max(o.current,se)),C){var F=C.length/u.length,R=B===1?u:u.map((K,I)=>{var te=Math.floor(I*F);if(C[te]){var Y=C[te];return oa(oa({},K),{},{x:Ft(Y.x,K.x,B),y:Ft(Y.y,K.y,B)})}return b?oa(oa({},K),{},{x:Ft(x*2,K.x,B),y:Ft(j/2,K.y,B)}):oa(oa({},K),{},{x:K.x,y:K.y})});return l.current=R,g.createElement(jE,{props:n,points:R,clipPathId:t,pathRef:a,strokeDasharray:M})}return g.createElement(jE,{props:n,points:u,clipPathId:t,pathRef:a,strokeDasharray:M})}),g.createElement(GD,{label:n.label}))}function TY(e){var{clipPathId:t,props:n}=e,a=g.useRef(null),l=g.useRef(0),o=g.useRef(null);return g.createElement(PY,{props:n,clipPathId:t,previousPointsRef:a,longestAnimatedLengthRef:l,pathRef:o})}var qY=(e,t)=>{var n,a;return{x:(n=e.x)!==null&&n!==void 0?n:void 0,y:(a=e.y)!==null&&a!==void 0?a:void 0,value:e.value,errorVal:Jt(e.payload,t)}};class RY extends g.Component{render(){var{hide:t,dot:n,points:a,className:l,xAxisId:o,yAxisId:u,top:d,left:f,width:p,height:h,id:v,needClip:b,zIndex:x}=this.props;if(t)return null;var j=Nt("recharts-line",l),N=v,{r:S,strokeWidth:C}=JV(n),E=YD(n),w=S*2+C,z=b?"url(#clipPath-".concat(E?"":"dots-").concat(N,")"):void 0;return g.createElement(Ln,{zIndex:x},g.createElement(Tn,{className:j},b&&g.createElement("defs",null,g.createElement(mM,{clipPathId:N,xAxisId:o,yAxisId:u}),!E&&g.createElement("clipPath",{id:"clipPath-dots-".concat(N)},g.createElement("rect",{x:f-w/2,y:d-w/2,width:p+w,height:h+w}))),g.createElement(dM,{xAxisId:o,yAxisId:u,data:a,dataPointFormatter:qY,errorBarOffset:0},g.createElement(TY,{props:this.props,clipPathId:N}))),g.createElement(RQ,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:z}))}}var xM={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:mr.line,type:"linear"};function IY(e){var t=Lr(e,xM),{activeDot:n,animateNewValues:a,animationBegin:l,animationDuration:o,animationEasing:u,connectNulls:d,dot:f,hide:p,isAnimationActive:h,label:v,legendType:b,xAxisId:x,yAxisId:j,id:N}=t,S=dj(t,NY),{needClip:C}=uj(x,j),E=lj(),w=Vs(),z=kr(),k=Ie(U=>ZV(U,x,j,z,N));if(w!=="horizontal"&&w!=="vertical"||k==null||E==null)return null;var{height:O,width:P,x:D,y:L}=E;return g.createElement(RY,Zc({},S,{id:N,connectNulls:d,dot:f,activeDot:n,animateNewValues:a,animationBegin:l,animationDuration:o,animationEasing:u,isAnimationActive:h,hide:p,label:v,legendType:b,xAxisId:x,yAxisId:j,points:k,layout:w,height:O,width:P,left:D,top:L,needClip:C}))}function LY(e){var{layout:t,xAxis:n,yAxis:a,xAxisTicks:l,yAxisTicks:o,dataKey:u,bandSize:d,displayedData:f}=e;return f.map((p,h)=>{var v=Jt(p,u);if(t==="horizontal"){var b=sw({axis:n,ticks:l,bandSize:d,entry:p,index:h}),x=Rt(v)?null:a.scale.map(v);return{x:b,y:x??null,value:v,payload:p}}var j=Rt(v)?null:n.scale.map(v),N=sw({axis:a,ticks:o,bandSize:d,entry:p,index:h});return j==null||N==null?null:{x:j,y:N,value:v,payload:p}}).filter(Boolean)}function $Y(e){var t=Lr(e,xM),n=kr();return g.createElement(tM,{id:t.id,type:"line"},a=>g.createElement(g.Fragment,null,g.createElement(eM,{legendPayload:EY(t)}),g.createElement(AY,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:a}),g.createElement(nM,{type:"line",id:a,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:n}),g.createElement(IY,Zc({},t,{id:a}))))}var bM=g.memo($Y,lp);bM.displayName="Line";function Ws(e,t){var n,a;return(n=(a=e.graphicalItems.cartesianItems.find(l=>l.id===t))===null||a===void 0?void 0:a.xAxisId)!==null&&n!==void 0?n:aM}function Xs(e,t){var n,a;return(n=(a=e.graphicalItems.cartesianItems.find(l=>l.id===t))===null||a===void 0?void 0:a.yAxisId)!==null&&n!==void 0?n:aM}var BY="Invariant failed";function UY(e,t){throw new Error(BY)}function vb(){return vb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},vb.apply(null,arguments)}function af(e){return g.createElement(KD,vb({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var FY=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a,l)=>{if(De(t))return t;var o=De(a)||Rt(a);return o?t(a,l):(o||UY(),n)}},GY=(e,t,n)=>n,HY=(e,t)=>t,xu=ue([rp,HY],(e,t)=>e.filter(n=>n.type==="bar").find(n=>n.id===t)),QY=ue([xu],e=>e?.maxBarSize),VY=(e,t,n,a)=>a,YY=ue([vt,rp,Ws,Xs,GY],(e,t,n,a,l)=>t.filter(o=>e==="horizontal"?o.xAxisId===n:o.yAxisId===a).filter(o=>o.isPanorama===l).filter(o=>o.hide===!1).filter(o=>o.type==="bar")),KY=(e,t,n)=>{var a=vt(e),l=Ws(e,t),o=Xs(e,t);if(!(l==null||o==null))return a==="horizontal"?ob(e,"yAxis",o,n):ob(e,"xAxis",l,n)},WY=(e,t)=>{var n=vt(e),a=Ws(e,t),l=Xs(e,t);if(!(a==null||l==null))return n==="horizontal"?l2(e,"xAxis",a):l2(e,"yAxis",l)},XY=ue([YY,JB,WY],IQ),ZY=(e,t,n)=>{var a,l,o=xu(e,t);if(o==null)return 0;var u=Ws(e,t),d=Xs(e,t);if(u==null||d==null)return 0;var f=vt(e),p=ok(e),{maxBarSize:h}=o,v=Rt(h)?p:h,b,x;return f==="horizontal"?(b=Yi(e,"xAxis",u,n),x=Vi(e,"xAxis",u,n)):(b=Yi(e,"yAxis",d,n),x=Vi(e,"yAxis",d,n)),(a=(l=lo(b,x,!0))!==null&&l!==void 0?l:v)!==null&&a!==void 0?a:0},yM=(e,t,n)=>{var a=vt(e),l=Ws(e,t),o=Xs(e,t);if(!(l==null||o==null)){var u,d;return a==="horizontal"?(u=Yi(e,"xAxis",l,n),d=Vi(e,"xAxis",l,n)):(u=Yi(e,"yAxis",o,n),d=Vi(e,"yAxis",o,n)),lo(u,d)}},JY=ue([XY,ok,ZB,ck,ZY,yM,QY],FQ),eK=(e,t,n)=>{var a=Ws(e,t);if(a!=null)return Yi(e,"xAxis",a,n)},tK=(e,t,n)=>{var a=Xs(e,t);if(a!=null)return Yi(e,"yAxis",a,n)},rK=(e,t,n)=>{var a=Ws(e,t);if(a!=null)return Vi(e,"xAxis",a,n)},nK=(e,t,n)=>{var a=Xs(e,t);if(a!=null)return Vi(e,"yAxis",a,n)},aK=ue([JY,xu],HQ),iK=ue([KY,xu],GQ),sK=ue([fr,ty,eK,tK,rK,nK,aK,vt,GB,yM,iK,xu,VY],(e,t,n,a,l,o,u,d,f,p,h,v,b)=>{var{chartData:x,dataStartIndex:j,dataEndIndex:N}=f;if(!(v==null||u==null||t==null||d!=="horizontal"&&d!=="vertical"||n==null||a==null||l==null||o==null||p==null)){var{data:S}=v,C;if(S!=null&&S.length>0?C=S:C=x?.slice(j,N+1),C!=null)return PK({layout:d,barSettings:v,pos:u,parentViewBox:t,bandSize:p,xAxis:n,yAxis:a,xAxisTicks:l,yAxisTicks:o,stackedData:h,displayedData:C,offset:e,cells:b,dataStartIndex:j})}}),lK=["index"];function gb(){return gb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},gb.apply(null,arguments)}function oK(e,t){if(e==null)return{};var n,a,l=cK(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function cK(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var jM=g.createContext(void 0),uK=e=>{var t=g.useContext(jM);if(t!=null)return t.stackId;if(e!=null)return V4(e)},dK=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),mK=e=>{var t=g.useContext(jM);if(t!=null){var{stackId:n}=t;return"url(#".concat(dK(n,e),")")}},NM=e=>{var{index:t}=e,n=oK(e,lK),a=mK(t);return g.createElement(Tn,gb({className:"recharts-bar-stack-layer",clipPath:a},n))},fK=["onMouseEnter","onMouseLeave","onClick"],pK=["value","background","tooltipPosition"],hK=["id"],vK=["onMouseEnter","onClick","onMouseLeave"];function Ja(){return Ja=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ja.apply(null,arguments)}function NE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Pr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?NE(Object(n),!0).forEach(function(a){gK(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function gK(e,t,n){return(t=xK(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xK(e){var t=bK(e,"string");return typeof t=="symbol"?t:t+""}function bK(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sf(e,t){if(e==null)return{};var n,a,l=yK(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function yK(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var jK=e=>{var{dataKey:t,name:n,fill:a,legendType:l,hide:o}=e;return[{inactive:o,dataKey:t,type:l,color:a,value:Of(n,t),payload:e}]},NK=g.memo(e=>{var{dataKey:t,stroke:n,strokeWidth:a,fill:l,name:o,hide:u,unit:d,tooltipType:f,id:p}=e,h={dataDefinedOnItem:void 0,getPosition:Qs,settings:{stroke:n,strokeWidth:a,fill:l,dataKey:t,nameKey:void 0,name:Of(o,t),hide:u,type:f,color:l,unit:d,graphicalItemId:p}};return g.createElement(JD,{tooltipEntrySettings:h})});function _K(e){var t=Ie(Bs),{data:n,dataKey:a,background:l,allOtherBarProps:o}=e,{onMouseEnter:u,onMouseLeave:d,onClick:f}=o,p=sf(o,fK),h=WD(u,a,o.id),v=XD(d),b=ZD(f,a,o.id);if(!l||n==null)return null;var x=tu(l);return g.createElement(Ln,{zIndex:QQ(l,mr.barBackground)},n.map((j,N)=>{var{value:S,background:C,tooltipPosition:E}=j,w=sf(j,pK);if(!C)return null;var z=h(j,N),k=v(j,N),O=b(j,N),P=Pr(Pr(Pr(Pr(Pr({option:l,isActive:String(N)===t},w),{},{fill:"#eee"},C),x),Hb(p,j,N)),{},{onMouseEnter:z,onMouseLeave:k,onClick:O,dataKey:a,index:N,className:"recharts-bar-background-rectangle"});return g.createElement(af,Ja({key:"background-bar-".concat(N)},P))}))}function SK(e){var{showLabels:t,children:n,rects:a}=e,l=a?.map(o=>{var u={x:o.x,y:o.y,width:o.width,lowerWidth:o.width,upperWidth:o.width,height:o.height};return Pr(Pr({},u),{},{value:o.value,payload:o.payload,parentViewBox:o.parentViewBox,viewBox:u,fill:o.fill})});return g.createElement(UD,{value:t?l:void 0},n)}function wK(e){var{shape:t,activeBar:n,baseProps:a,entry:l,index:o,dataKey:u}=e,d=Ie(Bs),f=Ie(yD),p=n&&String(o)===d&&(f==null||u===f),h=p?n:t;return p?g.createElement(Ln,{zIndex:mr.activeBar},g.createElement(NM,{index:o},g.createElement(af,Ja({},a,{name:String(a.name)},l,{isActive:p,option:h,index:o,dataKey:u})))):g.createElement(af,Ja({},a,{name:String(a.name)},l,{isActive:p,option:h,index:o,dataKey:u}))}function CK(e){var{shape:t,baseProps:n,entry:a,index:l,dataKey:o}=e;return g.createElement(af,Ja({},n,{name:String(n.name)},a,{isActive:!1,option:t,index:l,dataKey:o}))}function EK(e){var t,{data:n,props:a}=e,l=(t=Vn(a))!==null&&t!==void 0?t:{},{id:o}=l,u=sf(l,hK),{shape:d,dataKey:f,activeBar:p}=a,{onMouseEnter:h,onClick:v,onMouseLeave:b}=a,x=sf(a,vK),j=WD(h,f,o),N=XD(b),S=ZD(v,f,o);return n?g.createElement(g.Fragment,null,n.map((C,E)=>g.createElement(NM,Ja({index:E,key:"rectangle-".concat(C?.x,"-").concat(C?.y,"-").concat(C?.value,"-").concat(E),className:"recharts-bar-rectangle"},Hb(x,C,E),{onMouseEnter:j(C,E),onMouseLeave:N(C,E),onClick:S(C,E)}),p?g.createElement(wK,{shape:d,activeBar:p,baseProps:u,entry:C,index:E,dataKey:f}):g.createElement(CK,{shape:d,baseProps:u,entry:C,index:E,dataKey:f})))):null}function AK(e){var{props:t,previousRectanglesRef:n}=e,{data:a,layout:l,isAnimationActive:o,animationBegin:u,animationDuration:d,animationEasing:f,onAnimationEnd:p,onAnimationStart:h}=t,v=n.current,b=Bf(t,"recharts-bar-"),[x,j]=g.useState(!1),N=!x,S=g.useCallback(()=>{typeof p=="function"&&p(),j(!1)},[p]),C=g.useCallback(()=>{typeof h=="function"&&h(),j(!0)},[h]);return g.createElement(SK,{showLabels:N,rects:a},g.createElement($f,{animationId:b,begin:u,duration:d,isActive:o,easing:f,onAnimationEnd:S,onAnimationStart:C,key:b},E=>{var w=E===1?a:a?.map((z,k)=>{var O=v&&v[k];if(O)return Pr(Pr({},z),{},{x:Ft(O.x,z.x,E),y:Ft(O.y,z.y,E),width:Ft(O.width,z.width,E),height:Ft(O.height,z.height,E)});if(l==="horizontal"){var P=Ft(0,z.height,E),D=Ft(z.stackedBarStart,z.y,E);return Pr(Pr({},z),{},{y:D,height:P})}var L=Ft(0,z.width,E),U=Ft(z.stackedBarStart,z.x,E);return Pr(Pr({},z),{},{width:L,x:U})});return E>0&&(n.current=w??null),w==null?null:g.createElement(Tn,null,g.createElement(EK,{props:t,data:w}))}),g.createElement(GD,{label:t.label}),t.children)}function zK(e){var t=g.useRef(null);return g.createElement(AK,{previousRectanglesRef:t,props:e})}var _M=0,OK=(e,t)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:Jt(e,t)}};class kK extends g.PureComponent{render(){var{hide:t,data:n,dataKey:a,className:l,xAxisId:o,yAxisId:u,needClip:d,background:f,id:p}=this.props;if(t||n==null)return null;var h=Nt("recharts-bar",l),v=p;return g.createElement(Tn,{className:h,id:p},d&&g.createElement("defs",null,g.createElement(mM,{clipPathId:v,xAxisId:o,yAxisId:u})),g.createElement(Tn,{className:"recharts-bar-rectangles",clipPath:d?"url(#clipPath-".concat(v,")"):void 0},g.createElement(_K,{data:n,dataKey:a,background:f,allOtherBarProps:this.props}),g.createElement(zK,this.props)))}}var DK={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:_M,xAxisId:0,yAxisId:0,zIndex:mr.bar};function MK(e){var{xAxisId:t,yAxisId:n,hide:a,legendType:l,minPointSize:o,activeBar:u,animationBegin:d,animationDuration:f,animationEasing:p,isAnimationActive:h}=e,{needClip:v}=uj(t,n),b=Vs(),x=kr(),j=PH(e.children,aj),N=Ie(E=>sK(E,e.id,x,j));if(b!=="vertical"&&b!=="horizontal")return null;var S,C=N?.[0];return C==null||C.height==null||C.width==null?S=0:S=b==="vertical"?C.height/2:C.width/2,g.createElement(dM,{xAxisId:t,yAxisId:n,data:N,dataPointFormatter:OK,errorBarOffset:S},g.createElement(kK,Ja({},e,{layout:b,needClip:v,data:N,xAxisId:t,yAxisId:n,hide:a,legendType:l,minPointSize:o,activeBar:u,animationBegin:d,animationDuration:f,animationEasing:p,isAnimationActive:h})))}function PK(e){var{layout:t,barSettings:{dataKey:n,minPointSize:a},pos:l,bandSize:o,xAxis:u,yAxis:d,xAxisTicks:f,yAxisTicks:p,stackedData:h,displayedData:v,offset:b,cells:x,parentViewBox:j,dataStartIndex:N}=e,S=t==="horizontal"?d:u,C=h?S.scale.domain():null,E=Y4({numericAxis:S}),w=S.scale.map(E);return v.map((z,k)=>{var O,P,D,L,U,$;if(h){var B=h[k+N];if(B==null)return null;O=U4(B,C)}else O=Jt(z,n),Array.isArray(O)||(O=[E,O]);var re=FY(a,_M)(O[1],k);if(t==="horizontal"){var se,M=d.scale.map(O[0]),q=d.scale.map(O[1]);if(M==null||q==null)return null;P=lw({axis:u,ticks:f,bandSize:o,offset:l.offset,entry:z,index:k}),D=(se=q??M)!==null&&se!==void 0?se:void 0,L=l.size;var F=M-q;if(U=pa(F)?0:F,$={x:P,y:b.top,width:L,height:b.height},Math.abs(re)>0&&Math.abs(U)<Math.abs(re)){var R=Xr(U||re)*(Math.abs(re)-Math.abs(U));D-=R,U+=R}}else{var K=u.scale.map(O[0]),I=u.scale.map(O[1]);if(K==null||I==null)return null;if(P=K,D=lw({axis:d,ticks:p,bandSize:o,offset:l.offset,entry:z,index:k}),L=I-K,U=l.size,$={x:b.left,y:D,width:b.width,height:U},Math.abs(re)>0&&Math.abs(L)<Math.abs(re)){var te=Xr(L||re)*(Math.abs(re)-Math.abs(L));L+=te}}if(P==null||D==null||L==null||U==null)return null;var Y=Pr(Pr({},z),{},{stackedBarStart:w,x:P,y:D,width:L,height:U,value:h?O:O[1],payload:z,background:$,tooltipPosition:{x:P+L/2,y:D+U/2},parentViewBox:j},x&&x[k]&&x[k].props);return Y}).filter(Boolean)}function TK(e){var t=Lr(e,DK),n=uK(t.stackId),a=kr();return g.createElement(tM,{id:t.id,type:"bar"},l=>g.createElement(g.Fragment,null,g.createElement(eM,{legendPayload:jK(t)}),g.createElement(NK,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:l}),g.createElement(nM,{type:"bar",id:l,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:n,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:a}),g.createElement(Ln,{zIndex:t.zIndex},g.createElement(MK,Ja({},t,{id:l})))))}var SM=g.memo(TK,lp);SM.displayName="Bar";var qK=["domain","range"],RK=["domain","range"];function _E(e,t){if(e==null)return{};var n,a,l=IK(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function IK(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function SE(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function wM(e,t){if(e===t)return!0;var{domain:n,range:a}=e,l=_E(e,qK),{domain:o,range:u}=t,d=_E(t,RK);return!SE(n,o)||!SE(a,u)?!1:lp(l,d)}var LK=["type"],$K=["dangerouslySetInnerHTML","ticks","scale"],BK=["id","scale"];function xb(){return xb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},xb.apply(null,arguments)}function wE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function CE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wE(Object(n),!0).forEach(function(a){UK(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function UK(e,t,n){return(t=FK(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FK(e){var t=GK(e,"string");return typeof t=="symbol"?t:t+""}function GK(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bb(e,t){if(e==null)return{};var n,a,l=HK(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function HK(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function QK(e){var t=Qt(),n=g.useRef(null),a=Xz(),{type:l}=e,o=bb(e,LK),u=Wf(a,"xAxis",l),d=g.useMemo(()=>{if(u!=null)return CE(CE({},o),{},{type:u})},[o,u]);return g.useLayoutEffect(()=>{d!=null&&(n.current===null?t(NQ(d)):n.current!==d&&t(_Q({prev:n.current,next:d})),n.current=d)},[d,t]),g.useLayoutEffect(()=>()=>{n.current&&(t(SQ(n.current)),n.current=null)},[t]),null}var VK=e=>{var{xAxisId:t,className:n}=e,a=Ie(ty),l=kr(),o="xAxis",u=Ie(C=>Jk(C,o,t,l)),d=Ie(C=>Kk(C,t)),f=Ie(C=>eU(C,t)),p=Ie(C=>xk(C,t));if(d==null||f==null||p==null)return null;var{dangerouslySetInnerHTML:h,ticks:v,scale:b}=e,x=bb(e,$K),{id:j,scale:N}=p,S=bb(p,BK);return g.createElement(cj,xb({},x,S,{x:f.x,y:f.y,width:d.width,height:d.height,className:Nt("recharts-".concat(o," ").concat(o),n),viewBox:a,ticks:u,axisType:o}))},YK={allowDataOverflow:or.allowDataOverflow,allowDecimals:or.allowDecimals,allowDuplicatedCategory:or.allowDuplicatedCategory,angle:or.angle,axisLine:Qa.axisLine,height:or.height,hide:!1,includeHidden:or.includeHidden,interval:or.interval,label:!1,minTickGap:or.minTickGap,mirror:or.mirror,orientation:or.orientation,padding:or.padding,reversed:or.reversed,scale:or.scale,tick:or.tick,tickCount:or.tickCount,tickLine:Qa.tickLine,tickSize:Qa.tickSize,type:or.type,xAxisId:0},KK=e=>{var t=Lr(e,YK);return g.createElement(g.Fragment,null,g.createElement(QK,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),g.createElement(VK,t))},yb=g.memo(KK,wM);yb.displayName="XAxis";var WK=["type"],XK=["dangerouslySetInnerHTML","ticks","scale"],ZK=["id","scale"];function jb(){return jb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},jb.apply(null,arguments)}function EE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function AE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?EE(Object(n),!0).forEach(function(a){JK(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function JK(e,t,n){return(t=eW(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eW(e){var t=tW(e,"string");return typeof t=="symbol"?t:t+""}function tW(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nb(e,t){if(e==null)return{};var n,a,l=rW(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function rW(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function nW(e){var t=Qt(),n=g.useRef(null),a=Xz(),{type:l}=e,o=Nb(e,WK),u=Wf(a,"yAxis",l),d=g.useMemo(()=>{if(u!=null)return AE(AE({},o),{},{type:u})},[u,o]);return g.useLayoutEffect(()=>{d!=null&&(n.current===null?t(wQ(d)):n.current!==d&&t(CQ({prev:n.current,next:d})),n.current=d)},[d,t]),g.useLayoutEffect(()=>()=>{n.current&&(t(EQ(n.current)),n.current=null)},[t]),null}function aW(e){var{yAxisId:t,className:n,width:a,label:l}=e,o=g.useRef(null),u=g.useRef(null),d=Ie(ty),f=kr(),p=Qt(),h="yAxis",v=Ie(O=>Wk(O,t)),b=Ie(O=>rU(O,t)),x=Ie(O=>Jk(O,h,t,f)),j=Ie(O=>bk(O,t));if(g.useLayoutEffect(()=>{if(!(a!=="auto"||!v||sj(l)||g.isValidElement(l)||j==null)){var O=o.current;if(O){var P=O.getCalculatedWidth();Math.round(v.width)!==Math.round(P)&&p(AQ({id:t,width:P}))}}},[x,v,p,l,t,a,j]),v==null||b==null||j==null)return null;var{dangerouslySetInnerHTML:N,ticks:S,scale:C}=e,E=Nb(e,XK),{id:w,scale:z}=j,k=Nb(j,ZK);return g.createElement(cj,jb({},E,k,{ref:o,labelRef:u,x:b.x,y:b.y,tickTextProps:a==="auto"?{width:void 0}:{width:a},width:v.width,height:v.height,className:Nt("recharts-".concat(h," ").concat(h),n),viewBox:d,ticks:x,axisType:h}))}var iW={allowDataOverflow:cr.allowDataOverflow,allowDecimals:cr.allowDecimals,allowDuplicatedCategory:cr.allowDuplicatedCategory,angle:cr.angle,axisLine:Qa.axisLine,hide:!1,includeHidden:cr.includeHidden,interval:cr.interval,label:!1,minTickGap:cr.minTickGap,mirror:cr.mirror,orientation:cr.orientation,padding:cr.padding,reversed:cr.reversed,scale:cr.scale,tick:cr.tick,tickCount:cr.tickCount,tickLine:Qa.tickLine,tickSize:Qa.tickSize,type:cr.type,width:cr.width,yAxisId:0},sW=e=>{var t=Lr(e,iW);return g.createElement(g.Fragment,null,g.createElement(nW,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),g.createElement(aW,t))},_b=g.memo(sW,wM);_b.displayName="YAxis";var lW=(e,t)=>t,mj=ue([lW,vt,vk,vr,vD,oi,gF,fr],SF),fj=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,a=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/a)}},CM=qn("mouseClick"),EM=au();EM.startListening({actionCreator:CM,effect:(e,t)=>{var n=e.payload,a=mj(t.getState(),fj(n));a?.activeIndex!=null&&t.dispatch(vU({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}});var Sb=qn("mouseMove"),AM=au(),Wd=null;AM.startListening({actionCreator:Sb,effect:(e,t)=>{var n=e.payload;Wd!==null&&cancelAnimationFrame(Wd);var a=fj(n);Wd=requestAnimationFrame(()=>{var l=t.getState(),o=Yy(l,l.tooltip.settings.shared);if(o==="axis"){var u=mj(l,a);u?.activeIndex!=null?t.dispatch(lD({activeIndex:u.activeIndex,activeDataKey:void 0,activeCoordinate:u.activeCoordinate})):t.dispatch(sD())}Wd=null})}});function oW(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var zE={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},zM=tn({name:"rootProps",initialState:zE,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(n=t.payload.barGap)!==null&&n!==void 0?n:zE.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),cW=zM.reducer,{updateOptions:uW}=zM.actions,dW=null,mW={updatePolarOptions:(e,t)=>t.payload},OM=tn({name:"polarOptions",initialState:dW,reducers:mW}),{updatePolarOptions:fte}=OM.actions,fW=OM.reducer,kM=qn("keyDown"),DM=qn("focus"),pj=au();pj.startListening({actionCreator:kM,effect:(e,t)=>{var n=t.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:l}=n.tooltip,o=e.payload;if(!(o!=="ArrowRight"&&o!=="ArrowLeft"&&o!=="Enter")){var u=Ky(l,No(n),pu(n),vu(n)),d=u==null?-1:Number(u);if(!(!Number.isFinite(d)||d<0)){var f=oi(n);if(o==="Enter"){var p=Zm(n,"axis","hover",String(l.index));t.dispatch(ub({active:!l.active,activeIndex:l.index,activeCoordinate:p}));return}var h=sU(n),v=h==="left-to-right"?1:-1,b=o==="ArrowRight"?1:-1,x=d+b*v;if(!(f==null||x>=f.length||x<0)){var j=Zm(n,"axis","hover",String(x));t.dispatch(ub({active:!0,activeIndex:x.toString(),activeCoordinate:j}))}}}}}});pj.startListening({actionCreator:DM,effect:(e,t)=>{var n=t.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:l}=n.tooltip;if(!l.active&&l.index==null){var o="0",u=Zm(n,"axis","hover",String(o));t.dispatch(ub({active:!0,activeIndex:o,activeCoordinate:u}))}}}});var Dn=qn("externalEvent"),MM=au(),vx=new Map;MM.startListening({actionCreator:Dn,effect:(e,t)=>{var{handler:n,reactEvent:a}=e.payload;if(n!=null){a.persist();var l=a.type,o=vx.get(l);o!==void 0&&cancelAnimationFrame(o);var u=requestAnimationFrame(()=>{try{var d=t.getState(),f={activeCoordinate:tF(d),activeDataKey:yD(d),activeIndex:Bs(d),activeLabel:bD(d),activeTooltipIndex:Bs(d),isTooltipActive:rF(d)};n(f,a)}finally{vx.delete(l)}});vx.set(l,u)}}});var pW=ue([yo],e=>e.tooltipItemPayloads),hW=ue([pW,(e,t)=>t,(e,t,n)=>n],(e,t,n)=>{if(t!=null){var a=e.find(o=>o.settings.graphicalItemId===n);if(a!=null){var{getPosition:l}=a;if(l!=null)return l(t)}}}),PM=qn("touchMove"),TM=au();TM.startListening({actionCreator:PM,effect:(e,t)=>{var n=e.payload;if(!(n.touches==null||n.touches.length===0)){var a=t.getState(),l=Yy(a,a.tooltip.settings.shared);if(l==="axis"){var o=n.touches[0];if(o==null)return;var u=mj(a,fj({clientX:o.clientX,clientY:o.clientY,currentTarget:n.currentTarget}));u?.activeIndex!=null&&t.dispatch(lD({activeIndex:u.activeIndex,activeDataKey:void 0,activeCoordinate:u.activeCoordinate}))}else if(l==="item"){var d,f=n.touches[0];if(document.elementFromPoint==null||f==null)return;var p=document.elementFromPoint(f.clientX,f.clientY);if(!p||!p.getAttribute)return;var h=p.getAttribute(tL),v=(d=p.getAttribute(rL))!==null&&d!==void 0?d:void 0,b=jo(a).find(N=>N.id===v);if(h==null||b==null||v==null)return;var{dataKey:x}=b,j=hW(a,h,v);t.dispatch(iD({activeDataKey:x,activeIndex:h,activeCoordinate:j,activeGraphicalItemId:v}))}}}});var vW=fz({brush:YQ,cartesianAxis:zQ,chartData:tG,errorBars:UV,graphicalItems:lQ,layout:R4,legend:VL,options:WF,polarAxis:zH,polarOptions:fW,referenceElements:ZQ,rootProps:cW,tooltip:gU,zIndex:IF}),gW=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return o4({reducer:vW,preloadedState:t,middleware:a=>{var l;return a({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((l="es6")!==null&&l!==void 0?l:"")}).concat([EM.middleware,AM.middleware,pj.middleware,MM.middleware,TM.middleware])},enhancers:a=>{var l=a;return typeof a=="function"&&(l=a()),l.concat(Az({type:"raf"}))},devTools:{serialize:{replacer:oW},name:"recharts-".concat(n)}})};function xW(e){var{preloadedState:t,children:n,reduxStoreName:a}=e,l=kr(),o=g.useRef(null);if(l)return n;o.current==null&&(o.current=gW(t,a));var u=Yb;return g.createElement(gY,{context:u,store:o.current},n)}function bW(e){var{layout:t,margin:n}=e,a=Qt(),l=kr();return g.useEffect(()=>{l||(a(P4(t)),a(M4(n)))},[a,l,t,n]),null}var yW=g.memo(bW,lp);function jW(e){var t=Qt();return g.useEffect(()=>{t(uW(e))},[t,e]),null}function OE(e){var{zIndex:t,isPanorama:n}=e,a=g.useRef(null),l=Qt();return g.useLayoutEffect(()=>(a.current&&l(qF({zIndex:t,element:a.current,isPanorama:n})),()=>{l(RF({zIndex:t,isPanorama:n}))}),[l,t,n]),g.createElement("g",{tabIndex:-1,ref:a})}function kE(e){var{children:t,isPanorama:n}=e,a=Ie(CF);if(!a||a.length===0)return t;var l=a.filter(u=>u<0),o=a.filter(u=>u>0);return g.createElement(g.Fragment,null,l.map(u=>g.createElement(OE,{key:u,zIndex:u,isPanorama:n})),t,o.map(u=>g.createElement(OE,{key:u,zIndex:u,isPanorama:n})))}var NW=["children"];function _W(e,t){if(e==null)return{};var n,a,l=SW(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function SW(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function lf(){return lf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},lf.apply(null,arguments)}var wW={width:"100%",height:"100%",display:"block"},CW=g.forwardRef((e,t)=>{var n=Kz(),a=Wz(),l=sO();if(!va(n)||!va(a))return null;var{children:o,otherAttributes:u,title:d,desc:f}=e,p,h;return u!=null&&(typeof u.tabIndex=="number"?p=u.tabIndex:p=l?0:void 0,typeof u.role=="string"?h=u.role:h=l?"application":void 0),g.createElement(kA,lf({},u,{title:d,desc:f,role:h,tabIndex:p,width:n,height:a,style:wW,ref:t}),o)}),EW=e=>{var{children:t}=e,n=Ie(Pf);if(!n)return null;var{width:a,height:l,y:o,x:u}=n;return g.createElement(kA,{width:a,height:l,x:u,y:o},t)},DE=g.forwardRef((e,t)=>{var{children:n}=e,a=_W(e,NW),l=kr();return l?g.createElement(EW,null,g.createElement(kE,{isPanorama:!0},n)):g.createElement(CW,lf({ref:t},a),g.createElement(kE,{isPanorama:!1},n))});function AW(){var e=Qt(),[t,n]=g.useState(null),a=Ie(eL);return g.useEffect(()=>{if(t!=null){var l=t.getBoundingClientRect(),o=l.width/t.offsetWidth;it(o)&&o!==a&&e(q4(o))}},[t,e,a]),n}function ME(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function zW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ME(Object(n),!0).forEach(function(a){OW(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ME(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function OW(e,t,n){return(t=kW(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kW(e){var t=DW(e,"string");return typeof t=="symbol"?t:t+""}function DW(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ui(){return Ui=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ui.apply(null,arguments)}var MW=()=>(uG(),null);function of(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var PW=g.forwardRef((e,t)=>{var n,a,l=g.useRef(null),[o,u]=g.useState({containerWidth:of((n=e.style)===null||n===void 0?void 0:n.width),containerHeight:of((a=e.style)===null||a===void 0?void 0:a.height)}),d=g.useCallback((p,h)=>{u(v=>{var b=Math.round(p),x=Math.round(h);return v.containerWidth===b&&v.containerHeight===x?v:{containerWidth:b,containerHeight:x}})},[]),f=g.useCallback(p=>{if(typeof t=="function"&&t(p),p!=null&&typeof ResizeObserver<"u"){var{width:h,height:v}=p.getBoundingClientRect();d(h,v);var b=j=>{var N=j[0];if(N!=null){var{width:S,height:C}=N.contentRect;d(S,C)}},x=new ResizeObserver(b);x.observe(p),l.current=x}},[t,d]);return g.useEffect(()=>()=>{var p=l.current;p?.disconnect()},[d]),g.createElement(g.Fragment,null,g.createElement(su,{width:o.containerWidth,height:o.containerHeight}),g.createElement("div",Ui({ref:f},e)))}),TW=g.forwardRef((e,t)=>{var{width:n,height:a}=e,[l,o]=g.useState({containerWidth:of(n),containerHeight:of(a)}),u=g.useCallback((f,p)=>{o(h=>{var v=Math.round(f),b=Math.round(p);return h.containerWidth===v&&h.containerHeight===b?h:{containerWidth:v,containerHeight:b}})},[]),d=g.useCallback(f=>{if(typeof t=="function"&&t(f),f!=null){var{width:p,height:h}=f.getBoundingClientRect();u(p,h)}},[t,u]);return g.createElement(g.Fragment,null,g.createElement(su,{width:l.containerWidth,height:l.containerHeight}),g.createElement("div",Ui({ref:d},e)))}),qW=g.forwardRef((e,t)=>{var{width:n,height:a}=e;return g.createElement(g.Fragment,null,g.createElement(su,{width:n,height:a}),g.createElement("div",Ui({ref:t},e)))}),RW=g.forwardRef((e,t)=>{var{width:n,height:a}=e;return typeof n=="string"||typeof a=="string"?g.createElement(TW,Ui({},e,{ref:t})):typeof n=="number"&&typeof a=="number"?g.createElement(qW,Ui({},e,{width:n,height:a,ref:t})):g.createElement(g.Fragment,null,g.createElement(su,{width:n,height:a}),g.createElement("div",Ui({ref:t},e)))});function IW(e){return e?PW:RW}var LW=g.forwardRef((e,t)=>{var{children:n,className:a,height:l,onClick:o,onContextMenu:u,onDoubleClick:d,onMouseDown:f,onMouseEnter:p,onMouseLeave:h,onMouseMove:v,onMouseUp:b,onTouchEnd:x,onTouchMove:j,onTouchStart:N,style:S,width:C,responsive:E,dispatchTouchEvents:w=!0}=e,z=g.useRef(null),k=Qt(),[O,P]=g.useState(null),[D,L]=g.useState(null),U=AW(),$=ry(),B=$?.width>0?$.width:C,re=$?.height>0?$.height:l,se=g.useCallback(ce=>{U(ce),typeof t=="function"&&t(ce),P(ce),L(ce),ce!=null&&(z.current=ce)},[U,t,P,L]),M=g.useCallback(ce=>{k(CM(ce)),k(Dn({handler:o,reactEvent:ce}))},[k,o]),q=g.useCallback(ce=>{k(Sb(ce)),k(Dn({handler:p,reactEvent:ce}))},[k,p]),F=g.useCallback(ce=>{k(sD()),k(Dn({handler:h,reactEvent:ce}))},[k,h]),R=g.useCallback(ce=>{k(Sb(ce)),k(Dn({handler:v,reactEvent:ce}))},[k,v]),K=g.useCallback(()=>{k(DM())},[k]),I=g.useCallback(ce=>{k(kM(ce.key))},[k]),te=g.useCallback(ce=>{k(Dn({handler:u,reactEvent:ce}))},[k,u]),Y=g.useCallback(ce=>{k(Dn({handler:d,reactEvent:ce}))},[k,d]),oe=g.useCallback(ce=>{k(Dn({handler:f,reactEvent:ce}))},[k,f]),he=g.useCallback(ce=>{k(Dn({handler:b,reactEvent:ce}))},[k,b]),ge=g.useCallback(ce=>{k(Dn({handler:N,reactEvent:ce}))},[k,N]),Q=g.useCallback(ce=>{w&&k(PM(ce)),k(Dn({handler:j,reactEvent:ce}))},[k,w,j]),ve=g.useCallback(ce=>{k(Dn({handler:x,reactEvent:ce}))},[k,x]),Me=IW(E);return g.createElement(ED.Provider,{value:O},g.createElement(UR.Provider,{value:D},g.createElement(Me,{width:B??S?.width,height:re??S?.height,className:Nt("recharts-wrapper",a),style:zW({position:"relative",cursor:"default",width:B,height:re},S),onClick:M,onContextMenu:te,onDoubleClick:Y,onFocus:K,onKeyDown:I,onMouseDown:oe,onMouseEnter:q,onMouseLeave:F,onMouseMove:R,onMouseUp:he,onTouchEnd:ve,onTouchMove:Q,onTouchStart:ge,ref:se},g.createElement(MW,null),n)))}),$W=["width","height","responsive","children","className","style","compact","title","desc"];function BW(e,t){if(e==null)return{};var n,a,l=UW(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function UW(e,t){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var FW=g.forwardRef((e,t)=>{var{width:n,height:a,responsive:l,children:o,className:u,style:d,compact:f,title:p,desc:h}=e,v=BW(e,$W),b=Vn(v);return f?g.createElement(g.Fragment,null,g.createElement(su,{width:n,height:a}),g.createElement(DE,{otherAttributes:b,title:p,desc:h},o)):g.createElement(LW,{className:u,style:d,width:n,height:a,responsive:l??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},g.createElement(DE,{otherAttributes:b,title:p,desc:h,ref:t},g.createElement(eV,null,o)))});function wb(){return wb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},wb.apply(null,arguments)}var GW={top:5,right:5,bottom:5,left:5},HW={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:GW,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},qM=g.forwardRef(function(t,n){var a,l=Lr(t.categoricalChartProps,HW),{chartName:o,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,categoricalChartProps:p}=t,h={chartName:o,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,eventEmitter:void 0};return g.createElement(xW,{preloadedState:{options:h},reduxStoreName:(a=p.id)!==null&&a!==void 0?a:o},g.createElement(VQ,{chartData:p.data}),g.createElement(yW,{layout:l.layout,margin:l.margin}),g.createElement(jW,{baseValue:l.baseValue,accessibilityLayer:l.accessibilityLayer,barCategoryGap:l.barCategoryGap,maxBarSize:l.maxBarSize,stackOffset:l.stackOffset,barGap:l.barGap,barSize:l.barSize,syncId:l.syncId,syncMethod:l.syncMethod,className:l.className,reverseStackOrder:l.reverseStackOrder}),g.createElement(FW,wb({},l,{ref:n})))}),QW=["axis"],VW=g.forwardRef((e,t)=>g.createElement(qM,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:QW,tooltipPayloadSearcher:AD,categoricalChartProps:e,ref:t})),YW=["axis","item"],KW=g.forwardRef((e,t)=>g.createElement(qM,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:YW,tooltipPayloadSearcher:AD,categoricalChartProps:e,ref:t}));const WW=8,XW=12,ZW=14,JW=1;function hj(e){return e instanceof Oe?e.toDate():e instanceof Date?e:e?.seconds?new Date(e.seconds*1e3):new Date(e)}function PE(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function op(){const e=new Date,t=e.getDay(),n=t===0?-6:1-t,a=new Date(e);return a.setDate(e.getDate()+n),a.setHours(0,0,0,0),a}function eX(){const e=op(),t=new Date(e);return t.setDate(e.getDate()+6),t.setHours(23,59,59,999),t}function gx(e,t){return Math.floor(Math.abs(t.getTime()-e.getTime())/864e5)}async function cp(e){try{const t=ke(_e(X,"quiz_results"),Se("userId","==",e),Ke("datePassage","desc"));return(await ze(t)).docs.map(a=>({id:a.id,...a.data()}))}catch(t){return console.error("Erreur rcupration rsultats lve:",t),[]}}async function tX(e){try{const t=await cp(e);if(t.length===0)return[];const n=new Map;t.forEach(o=>{const u=o.disciplineId;n.has(u)||n.set(u,[]),n.get(u).push(o)});const a=[];n.forEach((o,u)=>{if(o.length<JW)return;const d=o.map(S=>S.pourcentage/100*20),f=d.reduce((S,C)=>S+C,0)/d.length;if(f>=ZW)return;let p="stable";if(d.length>=3){const S=d.slice(0,2),C=d.slice(2,4),E=S.reduce((k,O)=>k+O,0)/S.length,w=C.reduce((k,O)=>k+O,0)/C.length,z=E-w;z>1.5?p="hausse":z<-1.5&&(p="baisse")}let h="modere";f<WW?h="critique":f<XW&&(h="important");const v=d[0],b=Math.max(...d),x=Math.min(...d),j=hj(o[0].datePassage),N=o[0].disciplineNom||"Discipline inconnue";a.push({id:`lacune_${u}`,disciplineId:u,disciplineNom:N,moyenne:Math.round(f*10)/10,nombreQuiz:o.length,tendance:p,niveauUrgence:h,dernierQuizDate:j,scoreDetails:{dernierScore:Math.round(v*10)/10,meilleurScore:Math.round(b*10)/10,pireScore:Math.round(x*10)/10}})});const l={critique:0,important:1,modere:2};return a.sort((o,u)=>{const d=l[o.niveauUrgence]-l[u.niveauUrgence];return d!==0?d:o.moyenne-u.moyenne}),a}catch(t){return console.error("Erreur dtection lacunes:",t),[]}}function rX(e){const t=[];let n=1;return e.forEach(a=>{const{id:l,disciplineNom:o,niveauUrgence:u,moyenne:d,tendance:f}=a;switch(u){case"critique":t.push({id:`reco_cours_${l}`,lacuneId:l,type:"revoir_cours",titre:` Revoir les cours de ${o}`,description:`Ta moyenne est de ${d}/20 en ${o}. Il est important de reprendre les bases. Consulte les cours disponibles et prends des notes.`,disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date}),t.push({id:`reco_quiz_${l}`,lacuneId:l,type:"refaire_quiz",titre:` Refaire les quiz de ${o}`,description:"Aprs avoir rvis, refais les quiz pour vrifier ta comprhension. Vise au moins 12/20 !",disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date});break;case"important":t.push({id:`reco_exercice_${l}`,lacuneId:l,type:"exercice_cible",titre:` Exercices cibls en ${o}`,description:`Avec ${d}/20 de moyenne, concentre-toi sur les exercices pratiques. ${f==="hausse"?"Tu progresses, continue !":"Un effort supplmentaire est ncessaire."}`,disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date}),t.push({id:`reco_cours2_${l}`,lacuneId:l,type:"revoir_cours",titre:` Rviser les points cls en ${o}`,description:"Identifie les concepts qui te posent problme et revois-les attentivement.",disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date});break;case"modere":t.push({id:`reco_consolider_${l}`,lacuneId:l,type:"refaire_quiz",titre:` Consolider tes acquis en ${o}`,description:`Tu es proche du niveau attendu (${d}/20). Un quiz supplmentaire devrait suffire pour atteindre 14/20 !`,disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date});break}}),t}async function nX(e){try{const t=await cp(e);if(t.length===0)return{userId:e,streakActuel:0,meilleurStreak:0,dernierJourActif:null,totalJoursActifs:0,semaineCourante:[!1,!1,!1,!1,!1,!1,!1],historiqueHebdo:[]};const n=new Set;t.forEach(N=>{const S=hj(N.datePassage),C=`${S.getFullYear()}-${S.getMonth()}-${S.getDate()}`;n.add(C)});const a=Array.from(n).map(N=>{const[S,C,E]=N.split("-").map(Number);return new Date(S,C,E)}).sort((N,S)=>S.getTime()-N.getTime()),l=a.length,o=a[0];let u=0;const d=new Date;d.setHours(0,0,0,0);const f=a[0];if(gx(f,d)<=1){u=1;for(let N=1;N<a.length&&gx(a[N],a[N-1])===1;N++)u++}let h=0,v=1;for(let N=1;N<a.length;N++)gx(a[N],a[N-1])===1?v++:(h=Math.max(h,v),v=1);h=Math.max(h,v,u);const b=op(),x=[];for(let N=0;N<7;N++){const S=new Date(b);S.setDate(b.getDate()+N);const C=a.some(E=>PE(E,S));x.push(C)}const j=[];for(let N=0;N<4;N++){const S=new Date(b);S.setDate(b.getDate()-N*7);let C=0;for(let w=0;w<7;w++){const z=new Date(S);z.setDate(S.getDate()+w),a.some(k=>PE(k,z))&&C++}const E=Math.ceil((S.getDate()+new Date(S.getFullYear(),S.getMonth(),1).getDay())/7);j.push({semaine:N===0?"Cette sem.":`Sem. -${N}`,joursActifs:C})}return{userId:e,streakActuel:u,meilleurStreak:h,dernierJourActif:o,totalJoursActifs:l,semaineCourante:x,historiqueHebdo:j.reverse()}}catch(t){return console.error("Erreur calcul streak:",t),{userId:e,streakActuel:0,meilleurStreak:0,dernierJourActif:null,totalJoursActifs:0,semaineCourante:[!1,!1,!1,!1,!1,!1,!1],historiqueHebdo:[]}}}function aX(e,t,n){const a=[],l=op(),o=eX(),u=t.length>2?5:3;if(a.push({id:`obj_quiz_${e}_${l.getTime()}`,userId:e,titre:`Passer ${u} quiz cette semaine`,description:`Entrane-toi en passant au moins ${u} quiz pour progresser dans tes matires.`,type:"quiz_count",cible:u,progression:0,statut:"en_cours",dateDebut:l,dateFin:o,recompense:' Badge "Travailleur"'}),t.length>0){const f=t[0],p=Math.min(f.moyenne+3,14);a.push({id:`obj_score_${e}_${l.getTime()}`,userId:e,titre:`Atteindre ${Math.round(p)}/20 en ${f.disciplineNom}`,description:`Ta moyenne actuelle est de ${f.moyenne}/20. Vise ${Math.round(p)}/20 lors de ton prochain quiz !`,type:"score_min",cible:Math.round(p),progression:Math.round(f.moyenne),statut:"en_cours",disciplineId:f.disciplineId,disciplineNom:f.disciplineNom,dateDebut:l,dateFin:o,recompense:' Badge "En progrs"'})}const d=n.streakActuel>=5?7:n.streakActuel+2;return a.push({id:`obj_streak_${e}_${l.getTime()}`,userId:e,titre:`Maintenir un streak de ${d} jours`,description:`Tu es actuellement  ${n.streakActuel} jour(s) conscutif(s). Continue !`,type:"streak",cible:d,progression:n.streakActuel,statut:n.streakActuel>=d?"atteint":"en_cours",dateDebut:l,dateFin:o,recompense:' Badge "Flamme"'}),a}function iX(e,t,n,a){let l=0;if(a.length>0){const v=a.reduce((b,x)=>b+x.pourcentage/100*20,0)/a.length;l=Math.min(v/20*100,100)}let o=100;const u=e.filter(v=>v.niveauUrgence==="critique").length,d=e.filter(v=>v.niveauUrgence==="important").length;o-=u*25,o-=d*15,o=Math.max(o,0);const f=Math.min(t.streakActuel/7*100,100);let p=0;n.length>0&&(p=n.filter(b=>b.statut==="atteint").length/n.length*100);const h=l*.4+o*.25+f*.2+p*.15;return Math.round(Math.min(Math.max(h,0),100))}function sX(e,t,n){const a=op(),l=t.filter(o=>hj(o.datePassage)>=a);return e.map(o=>{const u={...o};switch(o.type){case"quiz_count":u.progression=l.length;break;case"score_min":if(o.disciplineId){const d=l.filter(f=>f.disciplineId===o.disciplineId);if(d.length>0){const f=Math.max(...d.map(p=>p.pourcentage));u.progression=Math.round(f/100*20)}}break;case"streak":u.progression=n.streakActuel;break}return u.progression>=u.cible&&(u.statut="atteint"),u})}async function vj(e){try{const t=await tX(e),n=rX(t),a=await nX(e);let l=aX(e,t,a);const o=await cp(e);l=sX(l,o,a);const u=iX(t,a,l,o);return{lacunes:t,recommandations:n,streak:a,objectifs:l,scoreGlobal:u}}catch(t){return console.error("Erreur suivi complet:",t),{lacunes:[],recommandations:[],streak:{userId:e,streakActuel:0,meilleurStreak:0,dernierJourActif:null,totalJoursActifs:0,semaineCourante:[!1,!1,!1,!1,!1,!1,!1],historiqueHebdo:[]},objectifs:[],scoreGlobal:0}}}function cf(e){switch(e){case"critique":return"#ef4444";case"important":return"#f59e0b";case"modere":return"#eab308";case"info":return"#10b981";default:return"#6b7280"}}function RM(e){switch(e){case"critique":return"Critique";case"important":return"Important";case"modere":return"Modr";case"info":return"Info";default:return"Inconnu"}}function IM(e){switch(e){case"hausse":return"";case"baisse":return"";case"stable":return"";default:return""}}function lX(e){return e>=80?"Excellent travail ! Continue comme a, tu es sur la bonne voie ! ":e>=60?"Bon travail ! Quelques efforts supplmentaires et tu seras au top ! ":e>=40?"Tu peux faire mieux ! Suis les recommandations pour progresser. ":e>=20?"Courage ! Chaque effort compte. Commence par les recommandations prioritaires. ":"C'est le moment de se lancer ! Passe ton premier quiz pour commencer. "}function oX(e){return e.cible===0?0:Math.min(Math.round(e.progression/e.cible*100),100)}const cX="PEDA",uX=4,dX=5,mX=40,LM=5;function Ga(e){return e instanceof Oe?e.toDate():e instanceof Date?e:e?.seconds?new Date(e.seconds*1e3):new Date(e)}function $M(e){const t=new Date,n=t.getDay(),a=n===0?-6:1-n,l=new Date(t);return l.setDate(t.getDate()+a),l.setHours(0,0,0,0),l}function fX(e){const t=$M(),n=new Date(t);return n.setDate(t.getDate()+6),n.setHours(23,59,59,999),n}function TE(e){const t=["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"];return`${e.getDate()} ${t[e.getMonth()]}`}function BM(e,t){return Math.floor(Math.abs(t.getTime()-e.getTime())/864e5)}async function pX(e){try{const t="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let n="",a="";for(let u=0;u<uX;u++)n+=t.charAt(Math.floor(Math.random()*t.length)),a+=t.charAt(Math.floor(Math.random()*t.length));const l=`${cX}-${n}-${a}`,o=Ne(X,"users",e);return await Qe(o,{codeParent:l,codeParentGenere:new Date}),l}catch(t){throw console.error("Erreur gnration code invitation:",t),new Error("Impossible de gnrer le code d'invitation")}}async function hX(e){try{const t=Ne(X,"users",e),n=await Ot(t);if(!n.exists())throw new Error("lve introuvable");const a=n.data();return a.codeParent?a.codeParent:await pX(e)}catch(t){throw console.error("Erreur rcupration code invitation:",t),new Error("Impossible de rcuprer le code d'invitation")}}async function vX(e,t){try{const n=t.trim().toUpperCase(),a=_e(X,"users"),l=ke(a,Se("codeParent","==",n),Se("role","==","eleve"),Cr(1)),o=await ze(l);if(o.empty)throw new Error("Code d'invitation invalide. Vrifiez le code et ressayez.");const u=o.docs[0],d=u.data(),f=u.id,p=_e(X,"liens_parent_enfant"),h=ke(p,Se("parentId","==",e),Se("enfantId","==",f),Se("statut","==","actif"),Cr(1));if(!(await ze(h)).empty)throw new Error("Cet enfant est dj li  votre compte.");const b={parentId:e,enfantId:f,enfantNom:d.displayName||d.email,enfantEmail:d.email,enfantClasse:d.classe||void 0,codeInvitation:n,statut:"actif",dateCreation:new Date};return{id:(await Tt(p,b)).id,...b}}catch(n){throw console.error("Erreur liaison parent-enfant:",n),n}}async function gX(e){try{const t=_e(X,"liens_parent_enfant"),n=ke(t,Se("parentId","==",e),Se("statut","==","actif"),Ke("dateCreation","desc"));return(await ze(n)).docs.map(l=>({id:l.id,...l.data(),dateCreation:Ga(l.data().dateCreation),dateDerniereConsultation:l.data().dateDerniereConsultation?Ga(l.data().dateDerniereConsultation):void 0}))}catch(t){return console.error("Erreur rcupration enfants lis:",t),[]}}async function xX(e,t){try{const n=Ne(X,"liens_parent_enfant",e),a=await Ot(n);if(!a.exists())throw new Error("Lien introuvable");if(a.data().parentId!==t)throw new Error("Action non autorise");await Qe(n,{statut:"revoque",dateRevocation:new Date})}catch(n){throw console.error("Erreur rvocation lien:",n),n}}async function bX(e,t){try{const n=_e(X,"liens_parent_enfant"),a=ke(n,Se("parentId","==",e),Se("enfantId","==",t),Se("statut","==","actif"),Cr(1)),l=await ze(a);if(l.empty)throw new Error("Vous n'tes pas autoris  consulter le suivi de cet enfant.");const o=Ne(X,"users",t),u=await Ot(o);if(!u.exists())throw new Error("Profil de l'enfant introuvable.");const d=u.data(),f=await vj(t),p=await cp(t),h=p.slice(0,LM).map(j=>({quizTitre:j.quizTitre||"Quiz",disciplineNom:j.disciplineNom||"Discipline",pourcentage:j.pourcentage,noteSur20:Math.round(j.pourcentage/100*20*10)/10,reussi:j.reussi,datePassage:Ga(j.datePassage)})),v=await yX(e,t,d.displayName||d.email,f.lacunes,f.streak,f.scoreGlobal,p),b=jX(t,d.displayName||d.email,f,p),x=l.docs[0];return await Qe(Ne(X,"liens_parent_enfant",x.id),{dateDerniereConsultation:new Date}),{enfant:{id:t,nom:d.displayName||d.email,email:d.email,classe:d.classe||void 0,derniereConnexion:d.lastLogin?Ga(d.lastLogin):void 0},scoreGlobal:f.scoreGlobal,streak:{actuel:f.streak.streakActuel,meilleur:f.streak.meilleurStreak,semaineCourante:f.streak.semaineCourante},lacunes:f.lacunes.map(j=>({disciplineNom:j.disciplineNom,moyenne:j.moyenne,niveauUrgence:j.niveauUrgence,tendance:j.tendance})),objectifs:f.objectifs.map(j=>({titre:j.titre,progression:j.progression,cible:j.cible,statut:j.statut})),derniersQuiz:h,resume:b,alertes:v}}catch(n){throw console.error("Erreur dashboard parent:",n),n}}async function yX(e,t,n,a,l,o,u){const d=[],f=new Date;if(a.filter(h=>h.niveauUrgence==="critique").forEach(h=>{d.push({id:`alerte_parent_lacune_${h.id}`,parentId:e,enfantId:t,enfantNom:n,type:"lacune_critique",niveau:"critique",titre:` Alerte critique en ${h.disciplineNom}`,message:`${n} a une moyenne de ${h.moyenne}/20 en ${h.disciplineNom}. Un suivi rapproch est recommand.`,lue:!1,dateCreation:f})}),l.dernierJourActif){const h=BM(Ga(l.dernierJourActif),f);h>=dX&&d.push({id:`alerte_parent_inactif_${t}`,parentId:e,enfantId:t,enfantNom:n,type:"inactivite",niveau:"important",titre:` ${n} est inactif`,message:`${n} n'a pas utilis PedaClic depuis ${h} jours. Un petit encouragement pourrait aider !`,lue:!1,dateCreation:f})}else u.length===0&&d.push({id:`alerte_parent_jamais_actif_${t}`,parentId:e,enfantId:t,enfantNom:n,type:"inactivite",niveau:"modere",titre:` ${n} n'a pas encore commenc`,message:`${n} n'a pas encore pass de quiz sur PedaClic. Encouragez-le  commencer !`,lue:!1,dateCreation:f});o<mX&&u.length>0&&d.push({id:`alerte_parent_score_${t}`,parentId:e,enfantId:t,enfantNom:n,type:"score_bas",niveau:"important",titre:` Score global bas : ${o}/100`,message:`Le score de sant global de ${n} est de ${o}/100. Des efforts supplmentaires sont ncessaires dans plusieurs matires.`,lue:!1,dateCreation:f}),a.filter(h=>h.tendance==="hausse").forEach(h=>{d.push({id:`alerte_parent_progression_${h.id}`,parentId:e,enfantId:t,enfantNom:n,type:"progression",niveau:"info",titre:` Progression en ${h.disciplineNom}`,message:`Bonne nouvelle ! ${n} montre une tendance  la hausse en ${h.disciplineNom}.`,lue:!1,dateCreation:f})}),l.streakActuel>=5&&d.push({id:`alerte_parent_streak_${t}`,parentId:e,enfantId:t,enfantNom:n,type:"objectif_atteint",niveau:"info",titre:` Streak de ${l.streakActuel} jours !`,message:`Flicitations ! ${n} maintient un streak de ${l.streakActuel} jours conscutifs de travail.`,lue:!1,dateCreation:f});const p={critique:0,important:1,modere:2,info:3};return d.sort((h,v)=>p[h.niveau]-p[v.niveau]),d}function jX(e,t,n,a){const l=$M(),o=fX(),u=new Date(l);u.setDate(u.getDate()-7);const d=new Date(o);d.setDate(d.getDate()-7);const f=a.filter(z=>{const k=Ga(z.datePassage);return k>=l&&k<=o}),p=a.filter(z=>{const k=Ga(z.datePassage);return k>=u&&k<=d}),h=f.slice(0,LM).map(z=>({quizTitre:z.quizTitre||"Quiz",disciplineNom:z.disciplineNom||"Discipline",pourcentage:z.pourcentage,noteSur20:Math.round(z.pourcentage/100*20*10)/10,reussi:z.reussi,datePassage:Ga(z.datePassage)})),v=NX(f,p),b=new Set;f.forEach(z=>{const k=Ga(z.datePassage);b.add(`${k.getFullYear()}-${k.getMonth()}-${k.getDate()}`)});const x=f.reduce((z,k)=>z+(k.tempsEcoule||5),0);let j=0;if(p.length>0){const z=p.reduce((k,O)=>k+O.pourcentage,0)/p.length;j=Math.round(z)}let N="stable";const S=n.scoreGlobal-j;S>5?N="hausse":S<-5&&(N="baisse");const C=n.lacunes.filter(z=>z.niveauUrgence==="critique"||z.niveauUrgence==="important").map(z=>z.disciplineNom),E=n.objectifs.filter(z=>z.statut==="atteint").length,w=`${TE(l)} - ${TE(o)} ${o.getFullYear()}`;return{enfantId:e,enfantNom:t,semaine:w,dateDebut:l,dateFin:o,scoreGlobal:n.scoreGlobal,scoreGlobalPrecedent:j,evolutionScore:N,nombreQuizSemaine:f.length,tempsEstimeMinutes:Math.round(x),joursActifsSemaine:b.size,streakActuel:n.streak.streakActuel,derniersQuiz:h,evolutionDisciplines:v,lacunesCritiques:n.lacunes.filter(z=>z.niveauUrgence==="critique").length,lacunesImportantes:n.lacunes.filter(z=>z.niveauUrgence==="important").length,disciplinesEnDifficulte:C,objectifsAtteints:E,objectifsTotal:n.objectifs.length}}function NX(e,t){const n=new Map;e.forEach(o=>{n.has(o.disciplineId)||n.set(o.disciplineId,{scores:[],nom:o.disciplineNom||"Discipline"}),n.get(o.disciplineId).scores.push(o.pourcentage)});const a=new Map;t.forEach(o=>{a.has(o.disciplineId)||a.set(o.disciplineId,[]),a.get(o.disciplineId).push(o.pourcentage)});const l=[];return n.forEach((o,u)=>{const d=o.scores.reduce((j,N)=>j+N,0)/o.scores.length,f=a.get(u)||[],p=f.length>0?f.reduce((j,N)=>j+N,0)/f.length:d,h=Math.round(d/100*20*10)/10,v=Math.round(p/100*20*10)/10,b=Math.round((h-v)*10)/10;let x="stable";b>1?x="hausse":b<-1&&(x="baisse"),l.push({disciplineNom:o.nom,disciplineId:u,moyenneSemainePrecedente:v,moyenneSemaineCourante:h,evolution:x,ecart:b})}),l}function _X(e){return cf(e)}function SX(e){return{lacune_critique:"Lacune critique",inactivite:"Inactivit",streak_perdu:"Streak perdu",objectif_atteint:"Objectif atteint",progression:"Progression",score_bas:"Score bas",nouveau_quiz:"Nouveau quiz"}[e]||"Alerte"}function qE(e){switch(e){case"hausse":return"";case"baisse":return"";case"stable":return"";default:return""}}function wX(e){return e>=80?"Votre enfant fait un excellent travail ! Continuez  l'encourager. ":e>=60?"De bons rsultats ! Quelques efforts supplmentaires et ce sera parfait. ":e>=40?"Des progrs sont possibles. Encouragez votre enfant  suivre les recommandations. ":e>=20?"Votre enfant a besoin de soutien. Un suivi rgulier est recommand. ":"Il est temps de commencer ! Encouragez votre enfant  passer ses premiers quiz. "}function xx(e){const n=BM(e,new Date);return n===0?"Aujourd'hui":n===1?"Hier":n<7?`Il y a ${n} jours`:n<30?`Il y a ${Math.floor(n/7)} semaine(s)`:`Il y a ${Math.floor(n/30)} mois`}const CX="PROF",EX=4,Xd="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",UM=8,AX=7,zX=16;function Fs(e){return e instanceof Oe?e.toDate():e instanceof Date?e:e?.seconds?new Oe(e.seconds,e.nanoseconds||0).toDate():new Date(e)}function OX(e,t){return Math.floor(Math.abs(t.getTime()-e.getTime())/864e5)}async function FM(){let e=0;const t=10;for(;e<t;){let n="",a="";for(let d=0;d<EX;d++)n+=Xd.charAt(Math.floor(Math.random()*Xd.length)),a+=Xd.charAt(Math.floor(Math.random()*Xd.length));const l=`${CX}-${n}-${a}`,o=ke(_e(X,"groupes_prof"),Se("codeInvitation","==",l),Cr(1));if((await ze(o)).empty)return l;e++}throw new Error("Impossible de gnrer un code unique aprs plusieurs tentatives")}async function kX(e,t,n){try{const a=await FM(),l={profId:e,profNom:t,nom:n.nom.trim(),description:n.description?.trim()||"",matiereId:n.matiereId,matiereNom:n.matiereNom,classeNiveau:n.classeNiveau,codeInvitation:a,nombreInscrits:0,statut:"actif",anneeScolaire:n.anneeScolaire,dateCreation:new Date,dateMiseAJour:new Date},o=await Tt(_e(X,"groupes_prof"),l);return console.log(` Groupe "${n.nom}" cr avec code: ${a}`),{id:o.id,...l}}catch(a){throw console.error(" Erreur cration groupe:",a),new Error("Impossible de crer le groupe. Ressayez.")}}async function GM(e){try{const t=ke(_e(X,"groupes_prof"),Se("profId","==",e),Ke("dateCreation","desc"));return(await ze(t)).docs.map(a=>({id:a.id,...a.data(),dateCreation:Fs(a.data().dateCreation),dateMiseAJour:a.data().dateMiseAJour?Fs(a.data().dateMiseAJour):void 0}))}catch(t){throw console.error(" Erreur rcupration groupes:",t),new Error("Impossible de charger vos groupes.")}}async function DX(e){try{const t=await Ot(Ne(X,"groupes_prof",e));if(!t.exists())return null;const n=t.data();return{id:t.id,...n,dateCreation:Fs(n.dateCreation),dateMiseAJour:n.dateMiseAJour?Fs(n.dateMiseAJour):void 0}}catch(t){return console.error(" Erreur rcupration groupe:",t),null}}async function HM(e,t){try{const n=Ne(X,"groupes_prof",e);await Qe(n,{...t,dateMiseAJour:new Date}),console.log(` Groupe ${e} mis  jour`)}catch(n){throw console.error(" Erreur modification groupe:",n),new Error("Impossible de modifier le groupe.")}}async function MX(e){try{const t=Pn(X),n=ke(_e(X,"inscriptions_groupe"),Se("groupeId","==",e));(await ze(n)).docs.forEach(l=>t.delete(l.ref)),t.delete(Ne(X,"groupes_prof",e)),await t.commit(),console.log(` Groupe ${e} et ses inscriptions supprims`)}catch(t){throw console.error(" Erreur suppression groupe:",t),new Error("Impossible de supprimer le groupe.")}}async function PX(e){await HM(e,{statut:"archive"})}async function TX(e){try{const t=await FM();return await Qe(Ne(X,"groupes_prof",e),{codeInvitation:t,dateMiseAJour:new Date}),console.log(` Nouveau code pour groupe ${e}: ${t}`),t}catch(t){throw console.error(" Erreur rgnration code:",t),new Error("Impossible de rgnrer le code.")}}async function qX(e,t,n,a){try{const l=a.trim().toUpperCase(),o=ke(_e(X,"groupes_prof"),Se("codeInvitation","==",l),Cr(1)),u=await ze(o);if(u.empty)throw new Error("Code d'invitation invalide. Vrifiez le code et ressayez.");const d=u.docs[0],f=d.data();if(f.statut!=="actif")throw new Error("Ce groupe n'accepte plus de nouvelles inscriptions.");const p=ke(_e(X,"inscriptions_groupe"),Se("groupeId","==",d.id),Se("eleveId","==",e),Se("statut","==","actif"),Cr(1));if(!(await ze(p)).empty)throw new Error("Tu es dj inscrit(e) dans ce groupe.");const v={groupeId:d.id,eleveId:e,eleveNom:t,eleveEmail:n,statut:"actif",dateInscription:new Date},b=await Tt(_e(X,"inscriptions_groupe"),v);return await Qe(Ne(X,"groupes_prof",d.id),{nombreInscrits:Hs(1),dateMiseAJour:new Date}),console.log(` lve ${t} inscrit au groupe "${f.nom}"`),{id:b.id,...v}}catch(l){throw console.error(" Erreur inscription groupe:",l),l}}async function up(e,t="actif"){try{const n=ke(_e(X,"inscriptions_groupe"),Se("groupeId","==",e),Se("statut","==",t),Ke("dateInscription","asc"));return(await ze(n)).docs.map(l=>({id:l.id,...l.data(),dateInscription:Fs(l.data().dateInscription),dateRetrait:l.data().dateRetrait?Fs(l.data().dateRetrait):void 0}))}catch(n){throw console.error(" Erreur rcupration lves groupe:",n),new Error("Impossible de charger les lves du groupe.")}}async function RX(e){try{const t=ke(_e(X,"inscriptions_groupe"),Se("eleveId","==",e),Se("statut","==","actif")),n=await ze(t);if(n.empty)return[];const a=[];for(const l of n.docs){const o=l.data().groupeId,u=await DX(o);u&&u.statut==="actif"&&a.push(u)}return a}catch(t){return console.error(" Erreur rcupration groupes lve:",t),[]}}async function IX(e,t){try{await Qe(Ne(X,"inscriptions_groupe",e),{statut:"retire",dateRetrait:new Date}),await Qe(Ne(X,"groupes_prof",t),{nombreInscrits:Hs(-1),dateMiseAJour:new Date}),console.log(" lve retir du groupe")}catch(n){throw console.error(" Erreur retrait lve:",n),new Error("Impossible de retirer l'lve du groupe.")}}async function gj(e){try{const n=(await up(e)).map(b=>b.eleveId);if(n.length===0)return{groupeId:e,nombreEleves:0,moyenneClasse:0,tauxReussite:0,tauxParticipation:0,totalQuizPasses:0,elevesEnDifficulte:0,meilleureNote:0,pireNote:0,derniereMiseAJour:new Date};const a=[],l=[];for(let b=0;b<n.length;b+=10)l.push(n.slice(b,b+10));for(const b of l){const x=ke(_e(X,"quiz_results"),Se("userId","in",b));(await ze(x)).docs.forEach(N=>a.push({id:N.id,...N.data()}))}const o=new Map;for(const b of a){const x=b.userId;o.has(x)||o.set(x,{total:0,somme:0,reussis:0});const j=o.get(x);j.total++,j.somme+=b.score||0,(b.score||0)>=10&&j.reussis++}let u=0,d=0,f=0,p=0,h=20,v=0;for(const[,b]of o){const x=b.total>0?b.somme/b.total:0;u+=x,d++,v+=b.total,x<UM&&f++,x>p&&(p=x),x<h&&(h=x)}return d===0&&(h=0),{groupeId:e,nombreEleves:n.length,moyenneClasse:d>0?Math.round(u/d*10)/10:0,tauxReussite:v>0?Math.round(Array.from(o.values()).reduce((b,x)=>b+x.reussis,0)/v*100):0,tauxParticipation:Math.round(d/n.length*100),totalQuizPasses:v,elevesEnDifficulte:f,meilleureNote:Math.round(p*10)/10,pireNote:Math.round(h*10)/10,derniereMiseAJour:new Date}}catch(t){throw console.error(" Erreur calcul stats groupe:",t),new Error("Impossible de calculer les statistiques du groupe.")}}async function LX(e){try{const t=await up(e);if(t.length===0)return[];const n=[];for(const a of t)try{const l=await vj(a.eleveId),o=ke(_e(X,"quiz_results"),Se("userId","==",a.eleveId),Ke("datePassage","desc")),d=(await ze(o)).docs.map(x=>x.data());let f=0,p=0,h;if(d.length>0){const x=d.reduce((j,N)=>j+(N.score||0),0);f=Math.round(x/d.length*10)/10,p=Math.round(d.filter(j=>(j.score||0)>=10).length/d.length*100),h=Fs(d[0].datePassage)}let v="stable";if(d.length>=4){const x=d.slice(0,Math.ceil(d.length/2)),j=d.slice(Math.ceil(d.length/2)),N=x.reduce((C,E)=>C+(E.score||0),0)/x.length,S=j.reduce((C,E)=>C+(E.score||0),0)/j.length;N-S>1?v="hausse":S-N>1&&(v="baisse")}const b=l.lacunes.map(x=>({disciplineNom:x.disciplineNom,chapitre:x.chapitre,moyenne:x.moyenne,niveauUrgence:x.niveauUrgence}));n.push({eleveId:a.eleveId,eleveNom:a.eleveNom,eleveEmail:a.eleveEmail,moyenne:f,totalQuiz:d.length,tauxReussite:p,scoreGlobal:l.scoreGlobal,streak:{actuel:l.streak.streakActuel,meilleur:l.streak.meilleurStreak},lacunes:b,dernierQuiz:h,tendance:v})}catch(l){console.warn(` Suivi incomplet pour lve ${a.eleveNom}:`,l),n.push({eleveId:a.eleveId,eleveNom:a.eleveNom,eleveEmail:a.eleveEmail,moyenne:0,totalQuiz:0,tauxReussite:0,scoreGlobal:0,streak:{actuel:0,meilleur:0},lacunes:[],tendance:"stable"})}return n.sort((a,l)=>l.moyenne-a.moyenne),n}catch(t){throw console.error(" Erreur stats lves groupe:",t),new Error("Impossible de charger les statistiques des lves.")}}async function $X(e,t,n){try{const l=(await up(e)).map(x=>x.eleveId);if(l.length===0)return null;let o=null,u="quiz_results";if(n!=="quizzes_v2"){if(n!=="quizzes"){const x=await Ot(Ne(X,"quizzes_v2",t));if(x.exists())o=x.data(),u="quiz_results_v2";else{const j=await Ot(Ne(X,"quizzes",t));j.exists()&&(o=j.data(),u="quiz_results")}}}if(!o)return null;const d=[],f=[];for(let x=0;x<l.length;x+=10)f.push(l.slice(x,x+10));for(const x of f){const j=ke(_e(X,u),Se("quizId","==",t),Se("userId","in",x));(await ze(j)).docs.forEach(S=>d.push(S.data()))}if(d.length===0)return null;const p=u==="quiz_results_v2",h=d.map(x=>p?x.note20||(x.scoreMax>0?x.score/x.scoreMax*20:0):x.score||0),v=d.map(x=>x.tempsEcoule||0),b=[];if(p&&o.questions)for(let x=0;x<o.questions.length;x++){const j=o.questions[x];let N=0,S=0;for(const w of d){const z=w.detailsParQuestion?.find(k=>k.questionId===j.id);z&&(S++,z.isCorrect||N++)}const C=S>0?Math.round(N/S*100):0,E=j.enonce?.replace(/<[^>]*>/g,"").trim()||`Question ${x+1}`;b.push({questionIndex:x,questionTexte:E,tauxEchec:C,reponseCorrecte:"Voir correction dtaille",reponsesFrequentes:[]})}else if(o.questions)for(let x=0;x<o.questions.length;x++){const j=o.questions[x];let N=0;const S=new Map;for(const w of d){const z=w.reponses?.[x];z!==void 0&&(S.set(z,(S.get(z)||0)+1),z!==j.reponseCorrecte&&N++)}const C=Math.round(N/d.length*100),E=Array.from(S.entries()).filter(([w])=>w!==j.reponseCorrecte).map(([w,z])=>({reponse:j.options?.[w]||`Option ${w+1}`,nombre:z})).sort((w,z)=>z.nombre-w.nombre);b.push({questionIndex:x,questionTexte:j.question,tauxEchec:C,reponseCorrecte:j.options?.[j.reponseCorrecte]||"N/A",reponsesFrequentes:E})}return b.sort((x,j)=>j.tauxEchec-x.tauxEchec),{quizId:t,quizTitre:o.titre||"Quiz sans titre",disciplineNom:o.disciplineNom||o.matiereNom||"",totalPassages:d.length,moyenneScore:Math.round(h.reduce((x,j)=>x+j,0)/h.length*10)/10,tauxReussite:Math.round(h.filter(x=>x>=10).length/h.length*100),tempsEcouleMoyen:Math.round(v.reduce((x,j)=>x+j,0)/v.length),questionsRatees:b}}catch(a){return console.error(" Erreur analyse quiz groupe:",a),null}}async function BX(e){try{const t=[];try{const n=ke(_e(X,"quizzes"),Se("disciplineId","==",e),Ke("createdAt","desc"));(await ze(n)).docs.forEach(l=>{t.push({id:l.id,titre:l.data().titre||"Quiz sans titre",source:"quizzes"})})}catch(n){console.warn(" Recherche quizzes choue (index manquant ?):",n)}try{const n=ke(_e(X,"quizzes_v2"),Se("disciplineId","==",e),Ke("createdAt","desc"));(await ze(n)).docs.forEach(l=>{t.push({id:l.id,titre:l.data().titre||"Quiz avanc sans titre",source:"quizzes_v2"})})}catch(n){console.warn(" Recherche quizzes_v2 choue (index manquant ?):",n)}return console.log(` ${t.length} quiz trouv(s) pour discipline ${e}`),t}catch(t){return console.error(" Erreur rcupration quiz par matire:",t),[]}}function UX(e,t){const n=[],a=new Date;for(const o of e){if(o.totalQuiz>0&&o.moyenne<UM&&n.push({id:`diff-${o.eleveId}`,type:"difficulte",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:t,message:`${o.eleveNom} a une moyenne de ${o.moyenne}/20. Lacunes : ${o.lacunes.map(u=>u.disciplineNom).join(", ")||"non dtectes"}.`,niveauUrgence:o.moyenne<5?"critique":"important",dateCreation:a}),o.dernierQuiz){const u=OX(o.dernierQuiz,a);u>=AX&&n.push({id:`inact-${o.eleveId}`,type:"inactivite",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:t,message:`${o.eleveNom} n'a pas fait de quiz depuis ${u} jours.`,niveauUrgence:u>=14?"important":"info",dateCreation:a})}else o.totalQuiz===0&&n.push({id:`inact-${o.eleveId}`,type:"inactivite",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:t,message:`${o.eleveNom} n'a encore pass aucun quiz.`,niveauUrgence:"info",dateCreation:a});o.tendance==="baisse"&&o.totalQuiz>=4&&n.push({id:`baisse-${o.eleveId}`,type:"baisse",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:t,message:`${o.eleveNom} est en baisse de rsultats (tendance ngative).`,niveauUrgence:"important",dateCreation:a}),o.moyenne>=zX&&o.totalQuiz>=3&&n.push({id:`felicite-${o.eleveId}`,type:"felicitation",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:t,message:`${o.eleveNom} excelle avec ${o.moyenne}/20 ! `,niveauUrgence:"info",dateCreation:a})}const l={critique:0,important:1,info:2};return n.sort((o,u)=>l[o.niveauUrgence]-l[u.niveauUrgence]),n}function FX(e,t){const n=["Nom","Email","Moyenne (/20)","Quiz passs","Taux russite (%)","Streak (jours)","Lacunes principales","Tendance"],a=e.map(o=>{const u=o.lacunes.map(d=>`${d.disciplineNom} (${d.moyenne}/20)`).join(" | ")||"Aucune";return[`"${o.eleveNom}"`,`"${o.eleveEmail}"`,o.moyenne.toString(),o.totalQuiz.toString(),o.tauxReussite.toString(),o.streak.actuel.toString(),`"${u}"`,o.tendance].join(",")});return"\uFEFF"+[n.join(","),...a].join(`
`)}function GX(e,t){const n=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(n),l=document.createElement("a");l.href=a,l.download=`${t}.csv`,l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)}const HX=()=>{const{currentUser:e}=rt(),[t,n]=g.useState([]),[a,l]=g.useState(!1),[o,u]=g.useState(""),[d,f]=g.useState(!0),[p,h]=g.useState(!1),[v,b]=g.useState(null),[x,j]=g.useState(null),N=g.useCallback(async()=>{if(e?.uid)try{f(!0);const C=await RX(e.uid);n(C)}catch(C){console.error("Erreur chargement groupes:",C)}finally{f(!1)}},[e?.uid]);g.useEffect(()=>{N()},[N]);const S=async C=>{if(C.preventDefault(),!(!e?.uid||!o.trim()))try{h(!0),b(null),j(null),await qX(e.uid,e.displayName||e.email||"lve",e.email||"",o),j("Tu as rejoint le groupe avec succs ! "),u(""),l(!1),await N(),setTimeout(()=>j(null),5e3)}catch(E){b(E.message||"Impossible de rejoindre le groupe.")}finally{h(!1)}};return r.jsxs("div",{className:"rejoindre-groupe-section",children:[r.jsxs("div",{className:"rejoindre-groupe-header",children:[r.jsx("h3",{children:" Mes groupes-classes"}),r.jsx("button",{className:"prof-btn prof-btn-primary prof-btn-sm",onClick:()=>l(!a),children:a?" Annuler":" Rejoindre un groupe"})]}),v&&r.jsxs("div",{className:"prof-alert prof-alert-error",children:[" ",v,r.jsx("button",{onClick:()=>b(null),className:"prof-alert-close",children:""})]}),x&&r.jsx("div",{className:"prof-alert",style:{background:"#d1fae5",border:"1px solid #a7f3d0",color:"#065f46"},children:x}),a&&r.jsxs("div",{className:"groupe-form-container",style:{marginBottom:"1rem"},children:[r.jsx("p",{style:{marginBottom:"0.75rem",color:"#6b7280",fontSize:"0.875rem"},children:"Saisis le code donn par ton professeur (format: PROF-XXXX-XXXX)"}),r.jsxs("form",{onSubmit:S,style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[r.jsx("input",{type:"text",placeholder:"PROF-XXXX-XXXX",value:o,onChange:C=>u(C.target.value.toUpperCase()),maxLength:14,disabled:p,className:"prof-input",style:{flex:1,maxWidth:"280px",fontFamily:"monospace",letterSpacing:"2px"}}),r.jsx("button",{type:"submit",className:"prof-btn prof-btn-primary",disabled:p||o.length<14,children:p?" Vrification...":" Rejoindre"})]})]}),d?r.jsx("p",{style:{color:"#9ca3af",textAlign:"center",padding:"1rem"},children:"Chargement..."}):t.length===0?r.jsxs("div",{style:{textAlign:"center",padding:"2rem",color:"#9ca3af"},children:[r.jsx("p",{children:"Tu n'es inscrit(e) dans aucun groupe-classe."}),r.jsx("p",{style:{fontSize:"0.875rem"},children:"Demande  ton professeur un code d'invitation pour rejoindre son groupe."})]}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:t.map(C=>r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[r.jsxs("div",{children:[r.jsx("strong",{style:{color:"#1f2937"},children:C.nom}),r.jsxs("span",{style:{display:"block",fontSize:"0.75rem",color:"#9ca3af"},children:[C.matiereNom,"  Prof: ",C.profNom]})]}),r.jsx("span",{style:{fontSize:"0.875rem",color:"#10b981",fontWeight:600},children:" Inscrit(e)"})]},C.id))})]})},QX=e=>e>=80?"#10b981":e>=60?"#3b82f6":e>=40?"#f59e0b":e>0?"#ef4444":"#d1d5db",RE=({pourcentage:e,label:t,size:n="md",showPercent:a=!0,color:l,showCheck:o=!0,className:u=""})=>{const[d,f]=g.useState(0);g.useEffect(()=>{const x=setTimeout(()=>{f(Math.min(100,Math.max(0,e)))},100);return()=>clearTimeout(x)},[e]);const h={sm:"4px",md:"8px",lg:"12px"}[n],v=l||QX(e),b=e>=100;return r.jsxs("div",{className:`progress-bar-wrapper ${u}`,children:[(t||a)&&r.jsxs("div",{className:"progress-bar-header",children:[t&&r.jsx("span",{className:"progress-bar-label",children:t}),a&&r.jsxs("span",{className:"progress-bar-percent",style:{color:v},children:[b&&o?" ":"",e,"%"]})]}),r.jsx("div",{className:"progress-bar-track",style:{height:h},children:r.jsx("div",{className:"progress-bar-fill",style:{width:`${d}%`,backgroundColor:v,height:"100%"}})})]})},VX=()=>{const e=st(),{currentUser:t}=rt(),[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState([]),[f,p]=g.useState([]),[h,v]=g.useState([]),[b,x]=g.useState(null),[j,N]=g.useState([]),[S,C]=g.useState("all"),[E,w]=g.useState(!0),[z,k]=g.useState("overview"),[O,P]=g.useState(null),[D,L]=g.useState(!1),[U,$]=g.useState(!1),B=async()=>{if(t){L(!0);try{const R=await hX(t.uid);P(R)}catch(R){console.error("Erreur gnration code parent :",R)}finally{L(!1)}}},re=()=>{O&&(navigator.clipboard.writeText(O),$(!0),setTimeout(()=>$(!1),2e3))};if(g.useEffect(()=>{(async()=>{if(t){w(!0);try{await zR(t.uid);const[K,I,te,Y,oe,he]=await Promise.all([bR(t.uid),yR(t.uid),jR(t.uid,20),vf(t.uid,10),bA().catch(()=>[]),CR(t.uid)]);a(K),o(I),d(te),p(Y),v(oe),x(he);const ge=OR(K,I,he);N(ge)}catch(K){console.error("Erreur chargement dashboard :",K)}finally{w(!1)}}})()},[t]),E)return r.jsxs("div",{className:"sd-loading",children:[r.jsx("div",{className:"admin-spinner"}),r.jsx("p",{children:"Chargement de votre tableau de bord..."})]});const se=j.filter(R=>R.obtenu),M=j.length,q=t?.displayName||t?.email?.split("@")[0]||"lve",F=S==="all"?j:j.filter(R=>R.categorie===S);return r.jsxs("div",{className:"student-dashboard",children:[r.jsxs("div",{className:"sd-welcome",children:[r.jsxs("div",{className:"sd-welcome-text",children:[r.jsxs("h1",{children:["Bienvenue, ",q," "]}),r.jsx("p",{children:n&&n.totalQuizPasses>0?`Vous avez pass ${n.totalQuizPasses} quiz avec une moyenne de ${n.moyenneGenerale}%. Continuez !`:"Commencez par consulter une ressource ou passer un quiz !"})]}),r.jsxs("div",{className:"sd-welcome-badges-row",children:[t?.isPremium&&r.jsxs("span",{className:"sd-premium-badge",children:[r.jsx(Wr,{size:14})," Premium"]}),b&&b.streakActuel>0&&r.jsxs("span",{className:"sd-streak-badge",children:[" ",b.streakActuel," jour",b.streakActuel>1?"s":""]})]})]}),r.jsxs("div",{className:"sd-stats-grid",children:[r.jsxs("div",{className:"sd-stat-card",children:[r.jsx("div",{className:"sd-stat-icon",style:{background:"#eff6ff",color:"#3b82f6"},children:r.jsx(vn,{size:22})}),r.jsxs("div",{className:"sd-stat-content",children:[r.jsx("span",{className:"sd-stat-value",children:n?.totalQuizPasses||0}),r.jsx("span",{className:"sd-stat-label",children:"Quiz passs"})]})]}),r.jsxs("div",{className:"sd-stat-card",children:[r.jsx("div",{className:"sd-stat-icon",style:{background:"#f0fdf4",color:"#10b981"},children:r.jsx(Ev,{size:22})}),r.jsxs("div",{className:"sd-stat-content",children:[r.jsxs("span",{className:"sd-stat-value",style:{color:Yl(n?.moyenneGenerale||0)},children:[n?.moyenneGenerale||0,"%"]}),r.jsx("span",{className:"sd-stat-label",children:"Moyenne gnrale"})]})]}),r.jsxs("div",{className:"sd-stat-card",children:[r.jsx("div",{className:"sd-stat-icon",style:{background:"#fef3c7",color:"#d97706"},children:r.jsx(eo,{size:22})}),r.jsxs("div",{className:"sd-stat-content",children:[r.jsx("span",{className:"sd-stat-value",children:b?.totalRessourcesVues||0}),r.jsx("span",{className:"sd-stat-label",children:"Ressources vues"})]})]}),r.jsxs("div",{className:"sd-stat-card",children:[r.jsx("div",{className:"sd-stat-icon",style:{background:"#fef2f2",color:"#ef4444"},children:r.jsx(sA,{size:22})}),r.jsxs("div",{className:"sd-stat-content",children:[r.jsxs("span",{className:"sd-stat-value",children:[b?.streakActuel||0," "]}),r.jsx("span",{className:"sd-stat-label",children:"Jours conscutifs"})]})]}),r.jsxs("div",{className:"sd-stat-card",children:[r.jsx("div",{className:"sd-stat-icon",style:{background:"#fefce8",color:"#f59e0b"},children:r.jsx(lA,{size:22})}),r.jsxs("div",{className:"sd-stat-content",children:[r.jsxs("span",{className:"sd-stat-value",children:[n?.meilleurScore||0,"%"]}),r.jsx("span",{className:"sd-stat-label",children:"Meilleur score"})]})]}),r.jsxs("div",{className:"sd-stat-card",children:[r.jsx("div",{className:"sd-stat-icon",style:{background:"#f0f9ff",color:"#0ea5e9"},children:r.jsx(Qi,{size:22})}),r.jsxs("div",{className:"sd-stat-content",children:[r.jsxs("span",{className:"sd-stat-value",children:[b?.disciplinesCompletees||0,"/",b?.disciplinesCommencees||0]}),r.jsx("span",{className:"sd-stat-label",children:"Disciplines compltes"})]})]})]}),r.jsxs("div",{className:"sd-chart-card",style:{marginBottom:"1.5rem"},children:[r.jsx("h3",{className:"sd-section-title",children:" Code Parent"}),r.jsx("p",{style:{color:"#6b7280",fontSize:"0.9rem",marginBottom:"1rem"},children:"Partagez ce code avec vos parents pour qu'ils puissent suivre votre progression."}),O?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[r.jsx("span",{style:{fontFamily:"monospace",fontSize:"1.4rem",fontWeight:700,letterSpacing:"0.1em",background:"#eff6ff",color:"#2563eb",padding:"0.75rem 1.5rem",borderRadius:"12px",border:"2px dashed #93c5fd",userSelect:"all"},children:O}),r.jsx("button",{className:"sd-btn",onClick:re,style:{display:"inline-flex",alignItems:"center",gap:"0.4rem",background:U?"#10b981":"#f3f4f6",color:U?"#fff":"#374151",border:"none",padding:"0.6rem 1rem",borderRadius:"8px",cursor:"pointer",fontWeight:500,transition:"all 0.2s"},children:U?" Copi !":" Copier"})]}):r.jsx("button",{className:"sd-btn sd-btn-primary",onClick:B,disabled:D,style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:D?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"admin-spinner",style:{width:"16px",height:"16px"}})," Gnration..."]}):r.jsx(r.Fragment,{children:" Gnrer mon code"})})]}),r.jsx("div",{className:"sd-chart-card",style:{marginBottom:"1.5rem"},children:r.jsx(HX,{})}),r.jsxs("div",{className:"sd-chart-card",style:{marginBottom:"1.5rem"},children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(vn,{size:18})," Cours en ligne"]}),r.jsx("p",{style:{color:"#6b7280",fontSize:"0.9rem",marginBottom:"1rem"},children:"Des cours complets du programme sngalais, accessibles partout."}),r.jsxs("button",{className:"sd-btn sd-btn-primary",onClick:()=>e("/cours"),style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[r.jsx(Wl,{size:16})," Accder aux cours"]})]}),r.jsxs("div",{className:"sd-tabs",children:[r.jsxs("button",{className:`sd-tab ${z==="overview"?"active":""}`,onClick:()=>k("overview"),children:[r.jsx(ks,{size:16})," Vue d'ensemble"]}),r.jsxs("button",{className:`sd-tab ${z==="progression"?"active":""}`,onClick:()=>k("progression"),children:[r.jsx(Ac,{size:16})," Progression"]}),r.jsxs("button",{className:`sd-tab ${z==="history"?"active":""}`,onClick:()=>k("history"),children:[r.jsx(Av,{size:16})," Historique"]}),r.jsxs("button",{className:`sd-tab ${z==="badges"?"active":""}`,onClick:()=>k("badges"),children:[r.jsx(Qi,{size:16})," Badges (",se.length,"/",M,")"]})]}),z==="overview"&&r.jsxs("div",{className:"sd-overview",children:[u.length>1&&r.jsxs("div",{className:"sd-chart-card",children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(Ac,{size:18})," volution de vos scores"]}),r.jsx("div",{className:"sd-chart-container",children:r.jsx(xw,{width:"100%",height:280,children:r.jsxs(VW,{data:u,children:[r.jsx(hb,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),r.jsx(yb,{dataKey:"date",tick:{fontSize:12,fill:"#6b7280"},tickLine:!1}),r.jsx(_b,{domain:[0,100],tick:{fontSize:12,fill:"#6b7280"},tickLine:!1,unit:"%"}),r.jsx(w2,{formatter:R=>[`${R}%`,"Score"],labelFormatter:R=>`Date : ${R}`,contentStyle:{borderRadius:"8px",border:"1px solid #e5e7eb",boxShadow:"0 4px 6px rgba(0,0,0,0.07)"}}),r.jsx(bM,{type:"monotone",dataKey:"score",stroke:"#3b82f6",strokeWidth:2.5,dot:{r:4,fill:"#3b82f6",stroke:"#fff",strokeWidth:2},activeDot:{r:6}})]})})})]}),l.length>0&&r.jsxs("div",{className:"sd-chart-card",children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(ks,{size:18})," Moyennes par discipline"]}),r.jsx("div",{className:"sd-chart-container",children:r.jsx(xw,{width:"100%",height:280,children:r.jsxs(KW,{data:l,layout:"vertical",children:[r.jsx(hb,{strokeDasharray:"3 3",stroke:"#e5e7eb",horizontal:!1}),r.jsx(yb,{type:"number",domain:[0,100],tick:{fontSize:12,fill:"#6b7280"},unit:"%"}),r.jsx(_b,{type:"category",dataKey:"disciplineNom",width:120,tick:{fontSize:12,fill:"#374151"}}),r.jsx(w2,{formatter:R=>[`${R}%`,"Moyenne"],contentStyle:{borderRadius:"8px",border:"1px solid #e5e7eb",boxShadow:"0 4px 6px rgba(0,0,0,0.07)"}}),r.jsx(SM,{dataKey:"moyenne",radius:[0,6,6,0],barSize:24,children:l.map((R,K)=>r.jsx(aj,{fill:Yl(R.moyenne)},K))})]})})})]}),h.length>0&&r.jsxs("div",{className:"sd-chart-card",children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(Wl,{size:18})," Quiz disponibles"]}),r.jsx("div",{className:"sd-quiz-grid",children:h.slice(0,6).map(R=>{const K=R.isPremium&&!t?.isPremium;return r.jsxs("div",{className:`sd-quiz-card ${K?"locked":""}`,onClick:()=>!K&&e(`/quiz/${R.id}`),children:[R.isPremium&&r.jsxs("span",{className:"sd-quiz-badge-premium",children:[K?r.jsx(jx,{size:10}):r.jsx(Wr,{size:10})," Premium"]}),r.jsx("h4",{className:"sd-quiz-title",children:R.titre}),r.jsxs("div",{className:"sd-quiz-meta",children:[r.jsxs("span",{children:[r.jsx(vn,{size:12})," ",R.questions.length," questions"]}),r.jsxs("span",{children:[r.jsx(no,{size:12})," ",R.duree," min"]})]}),!K&&r.jsxs("button",{className:"sd-quiz-play-btn",children:[r.jsx(Wl,{size:14})," Commencer"]}),K&&r.jsxs("button",{className:"sd-quiz-unlock-btn",onClick:I=>{I.stopPropagation(),e("/premium")},children:[r.jsx(jx,{size:14})," Dbloquer"]})]},R.id)})})]}),n&&n.totalQuizPasses===0&&(!b||b.totalRessourcesVues===0)&&r.jsxs("div",{className:"sd-empty-state",children:[r.jsx(Ev,{size:48}),r.jsx("h3",{children:"Commencez votre parcours !"}),r.jsx("p",{children:"Consultez une ressource ou passez un quiz pour voir votre progression."}),h.length>0&&r.jsxs("button",{className:"sd-btn sd-btn-primary",onClick:()=>e(`/quiz/${h[0].id}`),children:[r.jsx(Wl,{size:18})," Passer un quiz"]})]})]}),z==="progression"&&r.jsxs("div",{className:"sd-progression",children:[r.jsxs("div",{className:"sd-chart-card sd-prog-summary",children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(Ac,{size:18})," Avancement global"]}),r.jsx(RE,{pourcentage:b?.pourcentageMoyen||0,label:"Progression moyenne",size:"lg",showCheck:!0}),r.jsxs("div",{className:"sd-prog-stats-row",children:[r.jsxs("div",{className:"sd-prog-stat-item",children:[r.jsx("span",{className:"sd-prog-stat-number",children:b?.totalRessourcesVues||0}),r.jsx("span",{className:"sd-prog-stat-text",children:"Ressources consultes"})]}),r.jsxs("div",{className:"sd-prog-stat-item",children:[r.jsx("span",{className:"sd-prog-stat-number",children:b?.totalQuizReussis||0}),r.jsx("span",{className:"sd-prog-stat-text",children:"Quiz russis"})]}),r.jsxs("div",{className:"sd-prog-stat-item",children:[r.jsx("span",{className:"sd-prog-stat-number",children:b?.disciplinesCommencees||0}),r.jsx("span",{className:"sd-prog-stat-text",children:"Disciplines"})]}),r.jsxs("div",{className:"sd-prog-stat-item",children:[r.jsxs("span",{className:"sd-prog-stat-number",children:[" ",b?.streakActuel||0]}),r.jsxs("span",{className:"sd-prog-stat-text",children:["Streak (max: ",b?.meilleurStreak||0,")"]})]})]})]}),b&&b.parDiscipline.length>0?r.jsxs("div",{className:"sd-chart-card",children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(ks,{size:18})," Par discipline"]}),r.jsx("div",{className:"sd-prog-disciplines",children:b.parDiscipline.map(R=>r.jsxs("div",{className:"sd-prog-disc-card",children:[r.jsxs("div",{className:"sd-prog-disc-header",children:[r.jsx("span",{className:"sd-prog-disc-name",children:R.disciplineNom}),R.pourcentage>=100&&r.jsx("span",{className:"sd-prog-complete-tag",children:" Complt"})]}),r.jsx(RE,{pourcentage:R.pourcentage,size:"md",showPercent:!0}),r.jsxs("div",{className:"sd-prog-disc-details",children:[r.jsxs("span",{children:[r.jsx(eo,{size:12})," ",R.ressourcesVues.length,"/",R.totalRessources," ressources"]}),r.jsxs("span",{children:[r.jsx(Bt,{size:12})," ",R.quizReussis.length,"/",R.totalQuiz," quiz russis"]})]})]},R.disciplineId))})]}):r.jsxs("div",{className:"sd-empty-state",children:[r.jsx(eo,{size:48}),r.jsx("h3",{children:"Aucune progression enregistre"}),r.jsx("p",{children:"Consultez des ressources ou passez des quiz pour voir votre avancement ici."})]}),l.length>0&&r.jsxs("div",{className:"sd-chart-card",children:[r.jsxs("h3",{className:"sd-section-title",children:[r.jsx(Ev,{size:18})," Performance quiz par discipline"]}),r.jsx("div",{className:"sd-disc-list",children:l.map(R=>r.jsxs("div",{className:"sd-disc-card",children:[r.jsxs("div",{className:"sd-disc-header",children:[r.jsx("span",{className:"sd-disc-name",children:R.disciplineNom}),r.jsxs("span",{className:"sd-disc-tendance",children:[R.tendance==="up"&&r.jsx(Ac,{size:16,className:"tendance-up"}),R.tendance==="down"&&r.jsx(f3,{size:16,className:"tendance-down"}),R.tendance==="stable"&&r.jsx(p3,{size:16,className:"tendance-stable"})]})]}),r.jsxs("div",{className:"sd-disc-stats",children:[r.jsxs("div",{className:"sd-disc-stat",children:[r.jsxs("span",{className:"sd-disc-stat-value",style:{color:Yl(R.moyenne)},children:[R.moyenne,"%"]}),r.jsx("span",{className:"sd-disc-stat-label",children:"Moyenne"})]}),r.jsxs("div",{className:"sd-disc-stat",children:[r.jsx("span",{className:"sd-disc-stat-value",children:R.nombreQuiz}),r.jsx("span",{className:"sd-disc-stat-label",children:"Quiz"})]}),r.jsxs("div",{className:"sd-disc-stat",children:[r.jsxs("span",{className:"sd-disc-stat-value",children:[R.meilleurScore,"%"]}),r.jsx("span",{className:"sd-disc-stat-label",children:"Meilleur"})]}),r.jsxs("div",{className:"sd-disc-stat",children:[r.jsxs("span",{className:"sd-disc-stat-value",children:[R.quizReussis,"/",R.nombreQuiz]}),r.jsx("span",{className:"sd-disc-stat-label",children:"Russis"})]})]}),r.jsx("div",{className:"sd-disc-bar",children:r.jsx("div",{className:"sd-disc-bar-fill",style:{width:`${R.moyenne}%`,background:Yl(R.moyenne)}})})]},R.disciplineId))})]})]}),z==="history"&&r.jsx("div",{className:"sd-history",children:f.length===0?r.jsxs("div",{className:"sd-empty-state",children:[r.jsx(Av,{size:48}),r.jsx("h3",{children:"Aucun quiz pass"}),r.jsx("p",{children:"Votre historique apparatra ici aprs avoir pass des quiz."})]}):r.jsx("div",{className:"sd-history-list",children:f.map(R=>{const K=R.datePassage?.toDate?R.datePassage.toDate():new Date(R.datePassage);return r.jsxs("div",{className:`sd-history-item ${R.reussi?"success":"fail"}`,children:[r.jsx("div",{className:`sd-history-icon ${R.reussi?"success":"fail"}`,children:R.reussi?r.jsx(Bt,{size:20}):r.jsx(Nx,{size:20})}),r.jsxs("div",{className:"sd-history-content",children:[r.jsxs("div",{className:"sd-history-top",children:[r.jsx("span",{className:"sd-history-title",children:R.quizTitre}),r.jsx("span",{className:"sd-history-discipline",children:R.disciplineNom})]}),r.jsxs("div",{className:"sd-history-meta",children:[r.jsxs("span",{children:[r.jsx(Av,{size:12}),K.toLocaleDateString("fr-SN",{day:"2-digit",month:"long",year:"numeric"})]}),r.jsxs("span",{children:[r.jsx(no,{size:12})," ",CA(R.tempsEcoule)]}),r.jsxs("span",{children:[r.jsx(Bt,{size:12})," ",R.bonnesReponses,"/",R.nombreQuestions]})]})]}),r.jsxs("div",{className:"sd-history-score",style:{color:Yl(R.pourcentage)},children:[r.jsxs("span",{className:"sd-history-score-value",children:[R.pourcentage,"%"]}),r.jsx("span",{className:"sd-history-score-label",children:EA(R.pourcentage)})]})]},R.id)})})}),z==="badges"&&r.jsxs("div",{className:"sd-badges",children:[r.jsxs("div",{className:"sd-badges-summary",children:[r.jsxs("div",{className:"sd-badges-circle",children:[r.jsx("span",{className:"sd-badges-count",children:se.length}),r.jsxs("span",{className:"sd-badges-total",children:["/ ",M]})]}),r.jsx("p",{children:"badges obtenus"}),r.jsx("div",{className:"sd-badges-progress",children:r.jsx("div",{className:"sd-badges-progress-fill",style:{width:`${se.length/M*100}%`}})})]}),r.jsx("div",{className:"sd-badges-filters",children:[{key:"all",label:"Tous"},{key:"ressources",label:" Ressources"},{key:"quiz",label:" Quiz"},{key:"performance",label:" Performance"},{key:"discipline",label:" Disciplines"},{key:"streak",label:" Streak"}].map(R=>r.jsx("button",{className:`sd-badge-filter-btn ${S===R.key?"active":""}`,onClick:()=>C(R.key),children:R.label},R.key))}),r.jsx("div",{className:"sd-badges-grid",children:F.map(R=>r.jsxs("div",{className:`sd-badge-card ${R.obtenu?"obtained":"locked"}`,children:[r.jsx("span",{className:"sd-badge-icon",children:R.icone}),r.jsx("h4",{className:"sd-badge-name",children:R.nom}),r.jsx("p",{className:"sd-badge-description",children:R.description}),r.jsx("span",{className:"sd-badge-condition",children:R.condition}),R.obtenu&&r.jsx("span",{className:"sd-badge-obtained-tag",children:" Obtenu"}),r.jsx("span",{className:"sd-badge-category",children:R.categorie})]},R.id))}),F.length===0&&r.jsxs("div",{className:"sd-empty-state",style:{marginTop:"1rem"},children:[r.jsx(Mb,{size:36}),r.jsx("h3",{children:"Aucun badge dans cette catgorie"}),r.jsx("p",{children:"Essayez un autre filtre."})]})]})]})},YX=()=>{const{currentUser:e}=rt(),t=st(),[n,a]=g.useState(null),[l,o]=g.useState(!0),[u,d]=g.useState(null),f=["L","M","M","J","V","S","D"],p=g.useCallback(async()=>{if(e?.uid)try{o(!0),d(null);const w=await vj(e.uid);a(w)}catch(w){console.error("Erreur chargement suivi:",w),d("Impossible de charger ton suivi. Vrifie ta connexion et ressaie.")}finally{o(!1)}},[e?.uid]);g.useEffect(()=>{p()},[p]);const h=(()=>{const w=new Date().getDay();return w===0?6:w-1})();if(l)return r.jsx("div",{className:"suivi-page",children:r.jsx("div",{className:"suivi-container",children:r.jsxs("div",{className:"suivi-loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{className:"suivi-loading-text",children:"Analyse de ta progression en cours..."})]})})});if(u)return r.jsx("div",{className:"suivi-page",children:r.jsx("div",{className:"suivi-container",children:r.jsxs("div",{className:"suivi-error",children:[r.jsx("p",{className:"suivi-error-title",children:" Erreur de chargement"}),r.jsx("p",{className:"suivi-error-text",children:u}),r.jsx("button",{className:"suivi-btn-retry",onClick:p,children:" Ressayer"})]})})});if(!n)return null;const{lacunes:v,recommandations:b,streak:x,objectifs:j,scoreGlobal:N}=n,S=2*Math.PI*40,C=S-N/100*S,E=N>=60?"#10b981":N>=30?"#f59e0b":"#ef4444";return r.jsx("div",{className:"suivi-page",children:r.jsxs("div",{className:"suivi-container",children:[r.jsx("div",{className:"suivi-header",children:r.jsxs("div",{className:"suivi-header-content",children:[r.jsxs("div",{children:[r.jsx("h1",{children:" Mes points  amliorer"}),r.jsx("p",{className:"suivi-motivation",children:lX(N)})]}),r.jsxs("div",{className:"score-global-circle",children:[r.jsxs("svg",{className:"score-circle-svg",viewBox:"0 0 100 100",children:[r.jsx("circle",{className:"score-circle-bg",cx:"50",cy:"50",r:"40"}),r.jsx("circle",{className:"score-circle-progress",cx:"50",cy:"50",r:"40",stroke:E,strokeDasharray:S,strokeDashoffset:C}),r.jsx("text",{className:"score-circle-text",x:"50",y:"50",children:N})]}),r.jsx("span",{className:"score-global-label",children:"Score global"})]})]})}),r.jsxs("div",{className:"streak-card",children:[r.jsxs("div",{className:"streak-header",children:[r.jsx("span",{className:"streak-flamme",children:x.streakActuel>0?"":""}),r.jsxs("div",{children:[r.jsx("div",{className:"streak-nombre",children:x.streakActuel}),r.jsx("div",{className:"streak-label",children:x.streakActuel<=1?"jour conscutif":"jours conscutifs"})]})]}),r.jsx("div",{className:"streak-semaine",children:f.map((w,z)=>r.jsxs("div",{className:"streak-jour",children:[r.jsx("span",{className:"streak-jour-label",children:w}),r.jsx("div",{className:`streak-jour-indicateur ${x.semaineCourante[z]?"actif":"inactif"} ${z===h?"aujourd-hui":""}`,children:x.semaineCourante[z]?"":""})]},z))}),r.jsxs("div",{className:"streak-stats",children:[r.jsxs("div",{className:"streak-stat",children:[r.jsx("span",{className:"streak-stat-icon",children:""}),r.jsx("span",{className:"streak-stat-value",children:x.meilleurStreak}),r.jsx("span",{className:"streak-stat-label",children:"record"})]}),r.jsxs("div",{className:"streak-stat",children:[r.jsx("span",{className:"streak-stat-icon",children:""}),r.jsx("span",{className:"streak-stat-value",children:x.totalJoursActifs}),r.jsx("span",{className:"streak-stat-label",children:"jours actifs au total"})]}),x.dernierJourActif&&r.jsxs("div",{className:"streak-stat",children:[r.jsx("span",{className:"streak-stat-icon",children:""}),r.jsxs("span",{className:"streak-stat-label",children:["Dernier quiz : ",new Date(x.dernierJourActif).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})]})]})]})]}),r.jsxs("h2",{className:"suivi-section-title",children:[" Objectifs de la semaine",r.jsx("span",{className:"suivi-section-badge",children:j.length})]}),j.length>0?r.jsx("div",{className:"objectifs-grid",children:j.map(w=>{const z=oX(w);return r.jsxs("div",{className:`objectif-card ${w.statut==="atteint"?"atteint":""}`,children:[r.jsxs("div",{className:"objectif-header",children:[r.jsx("span",{className:"objectif-titre",children:w.titre}),w.recompense&&r.jsx("span",{className:"objectif-recompense",children:w.recompense})]}),r.jsx("p",{className:"objectif-description",children:w.description}),r.jsxs("div",{className:"objectif-progress",children:[r.jsxs("div",{className:"objectif-progress-labels",children:[r.jsxs("span",{className:"objectif-progress-value",children:[w.progression," / ",w.cible]}),r.jsxs("span",{className:"objectif-progress-cible",children:[z,"%"]})]}),r.jsx("div",{className:"objectif-progress-track",children:r.jsx("div",{className:`objectif-progress-fill ${w.statut==="atteint"?"atteint":""}`,style:{width:`${z}%`}})})]}),r.jsx("p",{className:`objectif-statut ${w.statut}`,children:w.statut==="atteint"?" Objectif atteint !":w.statut==="en_cours"?" En cours...":" Non commenc"})]},w.id)})}):r.jsxs("div",{className:"suivi-empty",children:[r.jsx("div",{className:"suivi-empty-icon",children:""}),r.jsx("p",{className:"suivi-empty-title",children:"Pas encore d'objectifs"}),r.jsx("p",{className:"suivi-empty-text",children:"Passe ton premier quiz pour dbloquer tes objectifs hebdomadaires !"})]}),r.jsxs("h2",{className:"suivi-section-title",children:[" Points faibles dtects",v.length>0&&r.jsx("span",{className:"suivi-section-badge",children:v.length})]}),v.length>0?r.jsx("div",{className:"lacunes-grid",children:v.map(w=>r.jsxs("div",{className:`lacune-card ${w.niveauUrgence}`,children:[r.jsxs("div",{className:"lacune-card-header",children:[r.jsx("span",{className:"lacune-discipline",children:w.disciplineNom}),r.jsx("span",{className:`lacune-badge ${w.niveauUrgence}`,children:RM(w.niveauUrgence)})]}),r.jsxs("div",{className:"lacune-score-bar",children:[r.jsxs("div",{className:"lacune-score-labels",children:[r.jsxs("span",{className:"lacune-score-value",style:{color:cf(w.niveauUrgence)},children:[w.moyenne,"/20"]}),r.jsx("span",{className:"lacune-score-objectif",children:"Objectif : 14/20"})]}),r.jsx("div",{className:"lacune-progress-track",children:r.jsx("div",{className:`lacune-progress-fill ${w.niveauUrgence}`,style:{width:`${w.moyenne/20*100}%`}})})]}),r.jsxs("div",{className:"lacune-details",children:[r.jsxs("span",{className:"lacune-detail-tag",children:[IM(w.tendance)," ",w.tendance]}),r.jsxs("span",{className:"lacune-detail-tag",children:[" ",w.nombreQuiz," quiz"]}),r.jsxs("span",{className:"lacune-detail-tag",children:["Dernier : ",w.scoreDetails.dernierScore,"/20"]})]})]},w.id))}):r.jsxs("div",{className:"suivi-empty",children:[r.jsx("div",{className:"suivi-empty-icon",children:""}),r.jsx("p",{className:"suivi-empty-title",children:"Aucune lacune dtecte !"}),r.jsx("p",{className:"suivi-empty-text",children:N>0?"Toutes tes moyennes sont au-dessus de 14/20. Bravo, continue !":"Passe des quiz pour que l'analyse puisse commencer."}),r.jsx("button",{className:"suivi-cta-btn",onClick:()=>t("/disciplines"),style:{marginTop:"1rem"},children:" Voir les disciplines"})]}),b.length>0&&r.jsxs(r.Fragment,{children:[r.jsxs("h2",{className:"suivi-section-title",children:[" Recommandations personnalises",r.jsx("span",{className:"suivi-section-badge",children:b.length})]}),r.jsx("div",{className:"recommandations-list",children:b.map(w=>r.jsxs("div",{className:"recommandation-card",children:[r.jsx("div",{className:"recommandation-priorite",children:w.priorite}),r.jsxs("div",{className:"recommandation-content",children:[r.jsx("p",{className:"recommandation-titre",children:w.titre}),r.jsx("p",{className:"recommandation-description",children:w.description}),r.jsx("span",{className:"recommandation-discipline-tag",children:w.disciplineNom})]})]},w.id))})]}),r.jsx("div",{style:{textAlign:"center",marginTop:"1rem",marginBottom:"2rem"},children:r.jsx("button",{className:"suivi-cta-btn",onClick:()=>t("/disciplines"),children:" Passer un quiz maintenant"})})]})})},KX=()=>{const e=new Date,t=e.getFullYear(),a=e.getMonth()>=9?t:t-1,l=[];for(let o=-1;o<=3;o++){const u=a+o;l.push(`${u}-${u+1}`)}return l},IE=KX(),wc=()=>{const e=new Date,t=e.getFullYear(),a=e.getMonth()>=9?t:t-1;return`${a}-${a+1}`},LE=[{value:"6eme",label:"6me"},{value:"5eme",label:"5me"},{value:"4eme",label:"4me"},{value:"3eme",label:"3me"},{value:"2nde",label:"2nde"},{value:"1ere",label:"1re"},{value:"Terminale",label:"Terminale"}],WX=({onSelectGroupe:e})=>{const{currentUser:t}=rt(),[n,a]=g.useState([]),[l,o]=g.useState(new Map),[u,d]=g.useState([]),[f,p]=g.useState(!0),[h,v]=g.useState(null),[b,x]=g.useState(!1),[j,N]=g.useState(!1),[S,C]=g.useState(null),[E,w]=g.useState(null),[z,k]=g.useState(null),[O,P]=g.useState(!1),[D,L]=g.useState(null),[U,$]=g.useState({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:"6eme",anneeScolaire:wc()}),[B,re]=g.useState({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:"6eme",anneeScolaire:wc()}),[se,M]=g.useState("actif");g.useEffect(()=>{(async()=>{try{const H=await Ki.getAll();d(H.map(de=>({id:de.id,nom:de.nom,classe:de.classe||""})))}catch(H){console.warn(" Impossible de charger les disciplines:",H)}})()},[]);const q=g.useCallback(async()=>{if(t?.uid)try{p(!0),v(null);const Z=await GM(t.uid);a(Z);const H=new Map;for(const de of Z)if(de.statut==="actif")try{const we=await gj(de.id);H.set(de.id,we)}catch{console.warn(`Stats indisponibles pour ${de.nom}`)}o(H)}catch(Z){console.error("Erreur chargement groupes:",Z),v("Impossible de charger vos groupes. Vrifiez votre connexion.")}finally{p(!1)}},[t?.uid]);g.useEffect(()=>{q()},[q]);const F=(Z,H=!1)=>{const de=u.find(qe=>qe.id===Z),we=de?`${de.nom}${de.classe?` (${de.classe})`:""}`:"";H?re(qe=>({...qe,matiereId:Z,matiereNom:we})):$(qe=>({...qe,matiereId:Z,matiereNom:we}))},R=async Z=>{if(Z.preventDefault(),!(!t?.uid||!U.nom.trim()||!U.matiereId))try{N(!0),await kX(t.uid,t.displayName||t.email||"Professeur",U),$({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:"6eme",anneeScolaire:wc()}),x(!1),L("Groupe cr avec succs !"),setTimeout(()=>L(null),3e3),await q()}catch(H){v(H.message||"Erreur lors de la cration du groupe.")}finally{N(!1)}},K=Z=>{k(Z),re({nom:Z.nom,description:Z.description||"",matiereId:Z.matiereId,matiereNom:Z.matiereNom,classeNiveau:Z.classeNiveau,anneeScolaire:Z.anneeScolaire}),x(!1)},I=()=>{k(null),re({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:"6eme",anneeScolaire:wc()})},te=async Z=>{if(Z.preventDefault(),!(!z||!B.nom.trim()||!B.matiereId))try{P(!0),await HM(z.id,{nom:B.nom.trim(),description:B.description?.trim()||"",matiereId:B.matiereId,matiereNom:B.matiereNom,classeNiveau:B.classeNiveau,anneeScolaire:B.anneeScolaire}),k(null),L("Groupe modifi avec succs !"),setTimeout(()=>L(null),3e3),await q()}catch(H){v(H.message||"Erreur lors de la modification du groupe.")}finally{P(!1)}},Y=async Z=>{try{await navigator.clipboard.writeText(Z),C(Z),setTimeout(()=>C(null),2e3)}catch{const H=document.createElement("textarea");H.value=Z,document.body.appendChild(H),H.select(),document.execCommand("copy"),document.body.removeChild(H),C(Z),setTimeout(()=>C(null),2e3)}},oe=async Z=>{try{await MX(Z),w(null),await q()}catch(H){v(H.message)}},he=async Z=>{try{await PX(Z),await q()}catch(H){v(H.message)}},ge=async Z=>{try{await TX(Z),await q()}catch(H){v(H.message)}},Q=(Z,H)=>{$(de=>({...de,[Z]:H}))},ve=(Z,H)=>{re(de=>({...de,[Z]:H}))},Me=n.filter(Z=>se==="tous"?!0:Z.statut===se),ce=(Z,H,de)=>r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:Z,children:"Discipline / Matire *"}),r.jsxs("select",{id:Z,value:H,onChange:we=>de(we.target.value),className:"prof-select",required:!0,children:[r.jsx("option",{value:"",children:" Slectionner une discipline "}),u.map(we=>r.jsxs("option",{value:we.id,children:[we.nom,we.classe?` (${we.classe})`:""]},we.id))]}),u.length===0&&r.jsx("small",{style:{color:"#f59e0b",marginTop:"0.25rem",display:"block"},children:" Aucune discipline trouve. Crez des disciplines dans l'espace admin."})]});return f?r.jsxs("div",{className:"prof-loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement de vos groupes-classes..."})]}):r.jsxs("div",{className:"groupe-manager",children:[r.jsxs("div",{className:"groupe-manager-header",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"groupe-manager-titre",children:"Mes groupes-classes"}),r.jsxs("p",{className:"groupe-manager-subtitle",children:[n.length," groupe",n.length!==1?"s":"","  Anne ",wc()]})]}),r.jsx("button",{className:"prof-btn prof-btn-primary",onClick:()=>{x(!b),z&&I()},children:b?" Annuler":" Nouveau groupe"})]}),h&&r.jsxs("div",{className:"prof-alert prof-alert-error",children:[r.jsx("span",{children:""})," ",h,r.jsx("button",{onClick:()=>v(null),className:"prof-alert-close",children:""})]}),D&&r.jsxs("div",{className:"prof-alert prof-alert-success",children:[r.jsx("span",{children:""})," ",D,r.jsx("button",{onClick:()=>L(null),className:"prof-alert-close",children:""})]}),b&&r.jsxs("div",{className:"groupe-form-container",children:[r.jsx("h3",{children:"Crer un nouveau groupe-classe"}),r.jsxs("form",{onSubmit:R,className:"groupe-form",children:[r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"groupe-nom",children:"Nom du groupe *"}),r.jsx("input",{id:"groupe-nom",type:"text",placeholder:"Ex: 3me A - Maths 2025",value:U.nom,onChange:Z=>Q("nom",Z.target.value),required:!0,className:"prof-input",maxLength:60})]}),r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"groupe-desc",children:"Description (optionnelle)"}),r.jsx("input",{id:"groupe-desc",type:"text",placeholder:"Ex: Cours du mardi et jeudi matin",value:U.description||"",onChange:Z=>Q("description",Z.target.value),className:"prof-input",maxLength:120})]}),r.jsxs("div",{className:"prof-form-row",children:[r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"groupe-niveau",children:"Niveau de classe *"}),r.jsx("select",{id:"groupe-niveau",value:U.classeNiveau,onChange:Z=>Q("classeNiveau",Z.target.value),className:"prof-select",children:LE.map(Z=>r.jsx("option",{value:Z.value,children:Z.label},Z.value))})]}),r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"groupe-annee",children:"Anne scolaire *"}),r.jsx("select",{id:"groupe-annee",value:U.anneeScolaire,onChange:Z=>Q("anneeScolaire",Z.target.value),className:"prof-select",children:IE.map(Z=>r.jsx("option",{value:Z,children:Z},Z))})]})]}),ce("groupe-discipline",U.matiereId,Z=>F(Z,!1)),r.jsx("div",{className:"prof-form-actions",children:r.jsx("button",{type:"submit",className:"prof-btn prof-btn-primary",disabled:j||!U.nom.trim()||!U.matiereId,children:j?" Cration...":" Crer le groupe"})})]})]}),z&&r.jsxs("div",{className:"groupe-form-container",style:{borderLeft:"4px solid #f59e0b"},children:[r.jsxs("h3",{children:[" Modifier le groupe : ",z.nom]}),r.jsxs("form",{onSubmit:te,className:"groupe-form",children:[r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"edit-groupe-nom",children:"Nom du groupe *"}),r.jsx("input",{id:"edit-groupe-nom",type:"text",value:B.nom,onChange:Z=>ve("nom",Z.target.value),required:!0,className:"prof-input",maxLength:60})]}),r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"edit-groupe-desc",children:"Description (optionnelle)"}),r.jsx("input",{id:"edit-groupe-desc",type:"text",value:B.description||"",onChange:Z=>ve("description",Z.target.value),className:"prof-input",maxLength:120})]}),r.jsxs("div",{className:"prof-form-row",children:[r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"edit-groupe-niveau",children:"Niveau de classe *"}),r.jsx("select",{id:"edit-groupe-niveau",value:B.classeNiveau,onChange:Z=>ve("classeNiveau",Z.target.value),className:"prof-select",children:LE.map(Z=>r.jsx("option",{value:Z.value,children:Z.label},Z.value))})]}),r.jsxs("div",{className:"prof-form-group",children:[r.jsx("label",{htmlFor:"edit-groupe-annee",children:"Anne scolaire *"}),r.jsx("select",{id:"edit-groupe-annee",value:B.anneeScolaire,onChange:Z=>ve("anneeScolaire",Z.target.value),className:"prof-select",children:IE.map(Z=>r.jsx("option",{value:Z,children:Z},Z))})]})]}),ce("edit-groupe-discipline",B.matiereId,Z=>F(Z,!0)),r.jsxs("div",{className:"prof-form-actions",style:{display:"flex",gap:"0.75rem"},children:[r.jsx("button",{type:"submit",className:"prof-btn prof-btn-primary",disabled:O||!B.nom.trim()||!B.matiereId,children:O?" Enregistrement...":" Enregistrer"}),r.jsx("button",{type:"button",className:"prof-btn prof-btn-secondary",onClick:I,disabled:O,children:" Annuler"})]})]})]}),r.jsxs("div",{className:"groupe-filtres",children:[r.jsxs("button",{className:`prof-filtre-btn ${se==="actif"?"active":""}`,onClick:()=>M("actif"),children:["Actifs (",n.filter(Z=>Z.statut==="actif").length,")"]}),r.jsxs("button",{className:`prof-filtre-btn ${se==="archive"?"active":""}`,onClick:()=>M("archive"),children:["Archivs (",n.filter(Z=>Z.statut==="archive").length,")"]}),r.jsxs("button",{className:`prof-filtre-btn ${se==="tous"?"active":""}`,onClick:()=>M("tous"),children:["Tous (",n.length,")"]})]}),Me.length===0?r.jsxs("div",{className:"prof-empty-state",children:[r.jsx("div",{className:"prof-empty-icon",children:""}),r.jsx("h3",{children:se==="archive"?"Aucun groupe archiv":"Aucun groupe-classe cr"}),r.jsx("p",{children:se==="archive"?"Vos groupes archivs apparatront ici.":"Crez votre premier groupe-classe pour commencer  suivre vos lves."}),se!=="archive"&&r.jsx("button",{className:"prof-btn prof-btn-primary",onClick:()=>x(!0),children:" Crer mon premier groupe"})]}):r.jsx("div",{className:"groupe-grid",children:Me.map(Z=>{const H=l.get(Z.id),de=z?.id===Z.id;return r.jsxs("div",{className:`groupe-card ${Z.statut==="archive"?"groupe-card-archive":""} ${de?"groupe-card-editing":""}`,children:[r.jsxs("div",{className:"groupe-card-header",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"groupe-card-titre",children:Z.nom}),r.jsx("span",{className:"groupe-card-matiere",children:Z.matiereNom})]}),r.jsx("span",{className:`groupe-badge groupe-badge-${Z.statut}`,children:Z.statut==="actif"?" Actif":" Archiv"})]}),Z.description&&r.jsx("p",{style:{color:"#6b7280",fontSize:"0.85rem",margin:"0.25rem 0 0.5rem"},children:Z.description}),r.jsxs("div",{className:"groupe-card-infos",children:[r.jsxs("span",{children:[" ",Z.classeNiveau]}),r.jsxs("span",{children:[" ",Z.anneeScolaire]}),r.jsxs("span",{children:[" ",Z.nombreInscrits," lve",Z.nombreInscrits!==1?"s":""]})]}),r.jsxs("div",{className:"groupe-card-code",children:[r.jsx("span",{className:"groupe-code-label",children:"Code d'invitation :"}),r.jsxs("div",{className:"groupe-code-box",children:[r.jsx("code",{className:"groupe-code-value",children:Z.codeInvitation}),r.jsx("button",{className:"prof-btn-icon",onClick:we=>{we.stopPropagation(),Y(Z.codeInvitation)},title:"Copier le code",children:S===Z.codeInvitation?"":""}),Z.statut==="actif"&&r.jsx("button",{className:"prof-btn-icon",onClick:we=>{we.stopPropagation(),ge(Z.id)},title:"Rgnrer le code",children:""})]})]}),H&&H.nombreEleves>0&&r.jsxs("div",{className:"groupe-card-stats",children:[r.jsxs("div",{className:"groupe-stat-item",children:[r.jsx("span",{className:"groupe-stat-value",children:H.moyenneClasse}),r.jsx("span",{className:"groupe-stat-label",children:"Moyenne"})]}),r.jsxs("div",{className:"groupe-stat-item",children:[r.jsxs("span",{className:"groupe-stat-value",children:[H.tauxReussite,"%"]}),r.jsx("span",{className:"groupe-stat-label",children:"Russite"})]}),r.jsxs("div",{className:"groupe-stat-item",children:[r.jsx("span",{className:"groupe-stat-value",children:H.elevesEnDifficulte}),r.jsx("span",{className:"groupe-stat-label",children:"En difficult"})]})]}),r.jsxs("div",{className:"groupe-card-actions",children:[Z.statut==="actif"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"prof-btn prof-btn-primary prof-btn-sm",onClick:()=>e(Z),children:" Voir dtails"}),r.jsx("button",{className:"prof-btn prof-btn-warning prof-btn-sm",onClick:()=>K(Z),style:{background:"#fef3c7",color:"#92400e",border:"1px solid #fbbf24"},children:" Modifier"}),r.jsx("button",{className:"prof-btn prof-btn-secondary prof-btn-sm",onClick:()=>he(Z.id),children:" Archiver"})]}),E===Z.id?r.jsxs("div",{className:"groupe-confirm-suppression",children:[r.jsx("span",{children:"Confirmer ?"}),r.jsx("button",{className:"prof-btn prof-btn-danger prof-btn-sm",onClick:()=>oe(Z.id),children:"Oui, supprimer"}),r.jsx("button",{className:"prof-btn prof-btn-secondary prof-btn-sm",onClick:()=>w(null),children:"Non"})]}):r.jsx("button",{className:"prof-btn prof-btn-danger prof-btn-sm",onClick:()=>w(Z.id),children:" Supprimer"})]})]},Z.id)})})]})},XX=({groupe:e,onRetour:t})=>{const[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState([]),[f,p]=g.useState([]),[h,v]=g.useState(null),[b,x]=g.useState(!0),[j,N]=g.useState(null),[S,C]=g.useState("apercu"),[E,w]=g.useState("moyenne_desc"),[z,k]=g.useState(null),[O,P]=g.useState(null),[D,L]=g.useState(!1),[U,$]=g.useState(null),B=g.useCallback(async()=>{try{x(!0),N(null);const[I,te,Y]=await Promise.all([gj(e.id),LX(e.id),BX(e.matiereId)]);a(I),o(te),p(Y);const oe=UX(te,e.nom);d(oe)}catch(I){console.error("Erreur chargement dtail groupe:",I),N("Impossible de charger les donnes du groupe.")}finally{x(!1)}},[e.id,e.matiereId,e.nom]);g.useEffect(()=>{B()},[B]);const re=async I=>{try{L(!0),P(I);const te=await $X(e.id,I);v(te)}catch(te){console.error("Erreur analyse quiz:",te)}finally{L(!1)}},se=()=>{const I=FX(l,e.nom),te=`PedaClic_${e.nom.replace(/\s+/g,"_")}_${new Date().toISOString().slice(0,10)}`;GX(I,te)},M=async I=>{try{$(I);const Y=(await up(e.id)).find(oe=>oe.eleveId===I);Y&&(await IX(Y.id,e.id),await B())}catch(te){N(te.message)}finally{$(null)}},q=[...l].sort((I,te)=>{switch(E){case"moyenne_desc":return te.moyenne-I.moyenne;case"moyenne_asc":return I.moyenne-te.moyenne;case"nom":return I.eleveNom.localeCompare(te.eleveNom);case"streak":return te.streak.actuel-I.streak.actuel;case"quiz_count":return te.totalQuiz-I.totalQuiz;default:return 0}}),F=I=>I>=16?"prof-note-excellent":I>=12?"prof-note-bien":I>=10?"prof-note-passable":I>=8?"prof-note-insuffisant":"prof-note-critique",R=I=>{switch(I){case"hausse":return"";case"baisse":return"";default:return""}},K=I=>{switch(I){case"difficulte":return"";case"inactivite":return"";case"baisse":return"";case"felicitation":return"";default:return""}};return b?r.jsxs("div",{className:"prof-loading",children:[r.jsx("div",{className:"spinner"}),r.jsxs("p",{children:['Chargement des donnes de "',e.nom,'"...']})]}):r.jsxs("div",{className:"groupe-detail",children:[r.jsxs("div",{className:"groupe-detail-header",children:[r.jsx("button",{className:"prof-btn prof-btn-secondary",onClick:t,children:" Retour aux groupes"}),r.jsxs("div",{className:"groupe-detail-titre-section",children:[r.jsx("h2",{className:"groupe-detail-titre",children:e.nom}),r.jsxs("p",{className:"groupe-detail-subtitle",children:[e.matiereNom,"  ",e.classeNiveau,"  ",e.anneeScolaire]})]}),r.jsx("button",{className:"prof-btn prof-btn-secondary",onClick:se,children:" Export CSV"})]}),j&&r.jsxs("div",{className:"prof-alert prof-alert-error",children:[" ",j,r.jsx("button",{onClick:()=>N(null),className:"prof-alert-close",children:""})]}),r.jsx("div",{className:"groupe-detail-onglets",children:[{id:"apercu",label:" Aperu",count:null},{id:"eleves",label:" lves",count:l.length},{id:"quiz",label:" Quiz",count:f.length},{id:"alertes",label:" Alertes",count:u.length}].map(I=>r.jsxs("button",{className:`groupe-onglet ${S===I.id?"active":""}`,onClick:()=>C(I.id),children:[I.label,I.count!==null&&I.count>0&&r.jsx("span",{className:"groupe-onglet-badge",children:I.count})]},I.id))}),S==="apercu"&&n&&r.jsxs("div",{className:"groupe-apercu",children:[r.jsxs("div",{className:"groupe-stats-grid",children:[r.jsxs("div",{className:"groupe-stat-card",children:[r.jsx("div",{className:"groupe-stat-card-icon",children:""}),r.jsxs("div",{className:"groupe-stat-card-content",children:[r.jsxs("span",{className:`groupe-stat-card-value ${F(n.moyenneClasse)}`,children:[n.moyenneClasse,"/20"]}),r.jsx("span",{className:"groupe-stat-card-label",children:"Moyenne classe"})]})]}),r.jsxs("div",{className:"groupe-stat-card",children:[r.jsx("div",{className:"groupe-stat-card-icon",children:""}),r.jsxs("div",{className:"groupe-stat-card-content",children:[r.jsxs("span",{className:"groupe-stat-card-value",children:[n.tauxReussite,"%"]}),r.jsx("span",{className:"groupe-stat-card-label",children:"Taux de russite"})]})]}),r.jsxs("div",{className:"groupe-stat-card",children:[r.jsx("div",{className:"groupe-stat-card-icon",children:""}),r.jsxs("div",{className:"groupe-stat-card-content",children:[r.jsx("span",{className:"groupe-stat-card-value",children:n.nombreEleves}),r.jsx("span",{className:"groupe-stat-card-label",children:"lves inscrits"})]})]}),r.jsxs("div",{className:"groupe-stat-card",children:[r.jsx("div",{className:"groupe-stat-card-icon",children:""}),r.jsxs("div",{className:"groupe-stat-card-content",children:[r.jsx("span",{className:"groupe-stat-card-value",children:n.totalQuizPasses}),r.jsx("span",{className:"groupe-stat-card-label",children:"Quiz passs"})]})]}),r.jsxs("div",{className:"groupe-stat-card",children:[r.jsx("div",{className:"groupe-stat-card-icon",children:""}),r.jsxs("div",{className:"groupe-stat-card-content",children:[r.jsxs("span",{className:"groupe-stat-card-value",children:[n.tauxParticipation,"%"]}),r.jsx("span",{className:"groupe-stat-card-label",children:"Participation"})]})]}),r.jsxs("div",{className:"groupe-stat-card",children:[r.jsx("div",{className:"groupe-stat-card-icon",children:""}),r.jsxs("div",{className:"groupe-stat-card-content",children:[r.jsx("span",{className:`groupe-stat-card-value ${n.elevesEnDifficulte>0?"prof-note-critique":"prof-note-excellent"}`,children:n.elevesEnDifficulte}),r.jsx("span",{className:"groupe-stat-card-label",children:"En difficult"})]})]})]}),r.jsx("div",{className:"groupe-apercu-notes",children:r.jsxs("div",{className:"groupe-note-range",children:[r.jsx("span",{className:"groupe-note-range-label",children:"Plage des notes :"}),r.jsxs("span",{className:"prof-note-critique",children:[n.pireNote,"/20"]}),r.jsx("div",{className:"groupe-note-barre",children:r.jsx("div",{className:"groupe-note-barre-fill",style:{left:`${n.pireNote/20*100}%`,width:`${(n.meilleureNote-n.pireNote)/20*100}%`}})}),r.jsxs("span",{className:"prof-note-excellent",children:[n.meilleureNote,"/20"]})]})}),l.length>=3&&r.jsxs("div",{className:"groupe-apercu-classement",children:[r.jsxs("div",{className:"groupe-classement-section",children:[r.jsx("h4",{children:" Top 3"}),l.slice(0,3).map((I,te)=>r.jsxs("div",{className:"groupe-classement-item",children:[r.jsx("span",{className:"groupe-classement-rang",children:te===0?"":te===1?"":""}),r.jsx("span",{className:"groupe-classement-nom",children:I.eleveNom}),r.jsxs("span",{className:`groupe-classement-note ${F(I.moyenne)}`,children:[I.moyenne,"/20"]})]},I.eleveId))]}),r.jsxs("div",{className:"groupe-classement-section",children:[r.jsx("h4",{children:"  surveiller"}),l.filter(I=>I.moyenne<8&&I.totalQuiz>0).slice(0,3).map(I=>r.jsxs("div",{className:"groupe-classement-item",children:[r.jsx("span",{className:"groupe-classement-rang",children:""}),r.jsx("span",{className:"groupe-classement-nom",children:I.eleveNom}),r.jsxs("span",{className:`groupe-classement-note ${F(I.moyenne)}`,children:[I.moyenne,"/20"]})]},I.eleveId)),l.filter(I=>I.moyenne<8&&I.totalQuiz>0).length===0&&r.jsx("p",{className:"groupe-classement-vide",children:"Aucun lve en difficult "})]})]})]}),S==="eleves"&&r.jsxs("div",{className:"groupe-eleves",children:[r.jsxs("div",{className:"groupe-eleves-toolbar",children:[r.jsx("label",{htmlFor:"tri-eleves",children:"Trier par :"}),r.jsxs("select",{id:"tri-eleves",value:E,onChange:I=>w(I.target.value),className:"prof-select prof-select-sm",children:[r.jsx("option",{value:"moyenne_desc",children:"Moyenne ()"}),r.jsx("option",{value:"moyenne_asc",children:"Moyenne ()"}),r.jsx("option",{value:"nom",children:"Nom (A-Z)"}),r.jsx("option",{value:"streak",children:"Streak ()"}),r.jsx("option",{value:"quiz_count",children:"Quiz passs ()"})]}),r.jsxs("span",{className:"groupe-eleves-count",children:[l.length," lve",l.length!==1?"s":""]})]}),l.length===0?r.jsxs("div",{className:"prof-empty-state",children:[r.jsx("div",{className:"prof-empty-icon",children:""}),r.jsx("h3",{children:"Aucun lve inscrit"}),r.jsxs("p",{children:["Partagez le code ",r.jsx("strong",{children:e.codeInvitation}),"  vos lves."]})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"groupe-eleves-table-wrapper",children:r.jsxs("table",{className:"groupe-eleves-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"#"}),r.jsx("th",{children:"lve"}),r.jsx("th",{children:"Moyenne"}),r.jsx("th",{children:"Quiz"}),r.jsx("th",{children:"Russite"}),r.jsx("th",{children:"Streak"}),r.jsx("th",{children:"Tendance"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:q.map((I,te)=>r.jsxs("tr",{className:`${z===I.eleveId?"groupe-eleve-row-active":""}`,children:[r.jsx("td",{className:"groupe-eleve-rang",children:te+1}),r.jsx("td",{className:"groupe-eleve-nom-cell",children:r.jsxs("div",{children:[r.jsx("strong",{children:I.eleveNom}),r.jsx("span",{className:"groupe-eleve-email",children:I.eleveEmail})]})}),r.jsx("td",{children:r.jsxs("span",{className:`groupe-note-badge ${F(I.moyenne)}`,children:[I.moyenne,"/20"]})}),r.jsx("td",{children:I.totalQuiz}),r.jsxs("td",{children:[I.tauxReussite,"%"]}),r.jsx("td",{children:r.jsxs("span",{className:"groupe-streak",children:[" ",I.streak.actuel,"j"]})}),r.jsxs("td",{children:[R(I.tendance)," ",I.tendance]}),r.jsxs("td",{className:"groupe-eleve-actions",children:[r.jsx("button",{className:"prof-btn-icon",onClick:()=>k(z===I.eleveId?null:I.eleveId),title:"Voir dtails",children:z===I.eleveId?"":""}),r.jsx("button",{className:"prof-btn-icon prof-btn-icon-danger",onClick:()=>M(I.eleveId),disabled:U===I.eleveId,title:"Retirer du groupe",children:U===I.eleveId?"":""})]})]},I.eleveId))})]})}),z&&(()=>{const I=l.find(te=>te.eleveId===z);return I?r.jsxs("div",{className:"groupe-eleve-detail",children:[r.jsxs("div",{className:"groupe-eleve-detail-header",children:[r.jsxs("h3",{children:[" Dtail  ",I.eleveNom]}),r.jsx("button",{className:"prof-btn-icon",onClick:()=>k(null),children:""})]}),r.jsxs("div",{className:"groupe-eleve-detail-grid",children:[r.jsxs("div",{className:"groupe-eleve-detail-card",children:[r.jsx("h4",{children:"Score global"}),r.jsx("div",{className:"groupe-eleve-score-circle",children:r.jsxs("span",{className:F(I.scoreGlobal/5),children:[I.scoreGlobal,"/100"]})})]}),r.jsxs("div",{className:"groupe-eleve-detail-card",children:[r.jsx("h4",{children:" Streak"}),r.jsxs("p",{children:["Actuel : ",r.jsxs("strong",{children:[I.streak.actuel," jour",I.streak.actuel!==1?"s":""]})]}),r.jsxs("p",{children:["Meilleur : ",I.streak.meilleur," jours"]})]}),r.jsxs("div",{className:"groupe-eleve-detail-card groupe-eleve-detail-card-wide",children:[r.jsx("h4",{children:" Lacunes dtectes"}),I.lacunes.length===0?r.jsx("p",{className:"text-muted",children:"Aucune lacune dtecte "}):r.jsx("ul",{className:"groupe-lacunes-liste",children:I.lacunes.map((te,Y)=>r.jsxs("li",{className:`groupe-lacune-item groupe-lacune-${te.niveauUrgence}`,children:[r.jsxs("span",{className:"groupe-lacune-nom",children:[te.disciplineNom,te.chapitre&&`  ${te.chapitre}`]}),r.jsxs("span",{className:"groupe-lacune-moyenne",children:[te.moyenne,"/20"]}),r.jsx("span",{className:`groupe-lacune-badge groupe-lacune-badge-${te.niveauUrgence}`,children:te.niveauUrgence})]},Y))})]})]})]}):null})()]})]}),S==="quiz"&&r.jsxs("div",{className:"groupe-quiz",children:[r.jsxs("div",{className:"groupe-quiz-selector",children:[r.jsx("label",{htmlFor:"select-quiz",children:"Slectionner un quiz  analyser :"}),r.jsxs("select",{id:"select-quiz",value:O||"",onChange:I=>{I.target.value&&re(I.target.value)},className:"prof-select",children:[r.jsx("option",{value:"",children:" Choisir un quiz "}),f.map(I=>r.jsx("option",{value:I.id,children:I.titre},I.id))]})]}),!O&&r.jsxs("div",{className:"prof-empty-state",children:[r.jsx("div",{className:"prof-empty-icon",children:""}),r.jsx("h3",{children:"Analyse par quiz"}),r.jsx("p",{children:"Slectionnez un quiz pour voir les statistiques dtailles et les questions les plus rates."})]}),D&&r.jsxs("div",{className:"prof-loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Analyse en cours..."})]}),h&&!D&&r.jsxs("div",{className:"groupe-quiz-resultats",children:[r.jsxs("div",{className:"groupe-quiz-stats-header",children:[r.jsx("h3",{children:h.quizTitre}),r.jsxs("div",{className:"groupe-quiz-stats-grid",children:[r.jsxs("div",{className:"groupe-stat-mini",children:[r.jsx("span",{className:"groupe-stat-mini-value",children:h.totalPassages}),r.jsx("span",{className:"groupe-stat-mini-label",children:"Passages"})]}),r.jsxs("div",{className:"groupe-stat-mini",children:[r.jsxs("span",{className:`groupe-stat-mini-value ${F(h.moyenneScore)}`,children:[h.moyenneScore,"/20"]}),r.jsx("span",{className:"groupe-stat-mini-label",children:"Moyenne"})]}),r.jsxs("div",{className:"groupe-stat-mini",children:[r.jsxs("span",{className:"groupe-stat-mini-value",children:[h.tauxReussite,"%"]}),r.jsx("span",{className:"groupe-stat-mini-label",children:"Russite"})]}),r.jsxs("div",{className:"groupe-stat-mini",children:[r.jsxs("span",{className:"groupe-stat-mini-value",children:[Math.floor(h.tempsEcouleMoyen/60),"min"]}),r.jsx("span",{className:"groupe-stat-mini-label",children:"Temps moyen"})]})]})]}),r.jsxs("div",{className:"groupe-quiz-questions",children:[r.jsx("h4",{children:" Questions les plus rates"}),h.questionsRatees.filter(I=>I.tauxEchec>30).map((I,te)=>r.jsxs("div",{className:"groupe-quiz-question-card",children:[r.jsxs("div",{className:"groupe-quiz-question-header",children:[r.jsxs("span",{className:"groupe-quiz-question-num",children:["Q",I.questionIndex+1]}),r.jsxs("span",{className:"groupe-quiz-question-echec",children:[I.tauxEchec,"% d'chec"]})]}),r.jsx("p",{className:"groupe-quiz-question-texte",children:I.questionTexte}),r.jsx("div",{className:"groupe-quiz-question-reponse",children:r.jsxs("span",{className:"groupe-quiz-bonne-reponse",children:[" Bonne rponse : ",I.reponseCorrecte]})}),I.reponsesFrequentes.length>0&&r.jsxs("div",{className:"groupe-quiz-mauvaises-reponses",children:[r.jsx("span",{children:"Erreurs frquentes :"}),I.reponsesFrequentes.slice(0,2).map((Y,oe)=>r.jsxs("span",{className:"groupe-quiz-mauvaise-reponse",children:[" ",Y.reponse," (",Y.nombre," lve",Y.nombre>1?"s":"",")"]},oe))]})]},te)),h.questionsRatees.filter(I=>I.tauxEchec>30).length===0&&r.jsx("p",{className:"text-muted",children:"Toutes les questions ont un taux de russite suprieur  70% "})]})]})]}),S==="alertes"&&r.jsx("div",{className:"groupe-alertes",children:u.length===0?r.jsxs("div",{className:"prof-empty-state",children:[r.jsx("div",{className:"prof-empty-icon",children:""}),r.jsx("h3",{children:"Aucune alerte"}),r.jsx("p",{children:"Tous vos lves se portent bien ! Les alertes apparatront ici quand un lve aura besoin d'attention."})]}):r.jsx("div",{className:"groupe-alertes-liste",children:u.map(I=>r.jsxs("div",{className:`groupe-alerte-card groupe-alerte-${I.niveauUrgence}`,children:[r.jsxs("div",{className:"groupe-alerte-header",children:[r.jsx("span",{className:"groupe-alerte-emoji",children:K(I.type)}),r.jsx("span",{className:"groupe-alerte-eleve",children:I.eleveNom}),r.jsx("span",{className:`groupe-alerte-badge groupe-alerte-badge-${I.niveauUrgence}`,children:I.niveauUrgence})]}),r.jsx("p",{className:"groupe-alerte-message",children:I.message}),r.jsx("button",{className:"prof-btn prof-btn-secondary prof-btn-sm",onClick:()=>{C("eleves"),k(I.eleveId)},children:" Voir dtail"})]},I.id))})})]})},ZX=()=>{const{currentUser:e}=rt(),t=st(),[n,a]=g.useState("overview"),[l,o]=g.useState(null),[u,d]=g.useState(0),[f,p]=g.useState(0),[h,v]=g.useState(0),[b,x]=g.useState(0),[j,N]=g.useState([]),[S,C]=g.useState(!0),E=g.useCallback(async()=>{if(e?.uid)try{C(!0);const O=(await GM(e.uid)).filter(B=>B.statut==="actif");d(O.length);let P=0,D=0,L=0,U=0;const $=[];for(const B of O)try{const re=await gj(B.id);P+=re.nombreEleves,re.nombreEleves>0&&(D+=re.moyenneClasse,L++),U+=re.elevesEnDifficulte,$.push({...B,stats:re})}catch{$.push({...B})}p(P),v(L>0?Math.round(D/L*10)/10:0),x(U),N($)}catch(k){console.error("Erreur chargement rsum prof:",k)}finally{C(!1)}},[e?.uid]);g.useEffect(()=>{E()},[E]);const w=k=>{o(k),a("detail")},z=()=>{o(null),a("groupes"),E()};return S?r.jsxs("div",{className:"prof-loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement de votre espace professeur..."})]}):r.jsxs("div",{className:"prof-dashboard",children:[r.jsx("header",{className:"prof-dashboard-header",children:r.jsxs("div",{children:[r.jsx("h1",{className:"prof-dashboard-titre",children:"Tableau de bord Professeur"}),r.jsxs("p",{className:"prof-dashboard-subtitle",children:["Bienvenue, ",e?.displayName||"Professeur"," "]})]})}),n!=="detail"&&r.jsxs("nav",{className:"prof-nav",children:[r.jsx("button",{className:`prof-nav-btn ${n==="overview"?"active":""}`,onClick:()=>a("overview"),children:" Vue d'ensemble"}),r.jsx("button",{className:`prof-nav-btn ${n==="groupes"?"active":""}`,onClick:()=>a("groupes"),children:" Mes groupes-classes"}),r.jsx("button",{className:"prof-nav-btn",onClick:()=>t("/prof/cahiers"),children:" Cahier de textes"}),r.jsx("button",{className:"prof-nav-btn",onClick:()=>t("/prof/sequences"),children:" Squences pdagogiques"}),r.jsx("button",{className:"prof-nav-btn",onClick:()=>t("/prof/cours"),children:" Cours en ligne"})]}),n==="overview"&&r.jsxs("div",{className:"prof-overview",children:[r.jsxs("div",{className:"prof-overview-cards",children:[r.jsxs("div",{className:"prof-overview-card prof-overview-card-clickable",onClick:()=>a("groupes"),children:[r.jsx("div",{className:"prof-overview-card-icon",children:""}),r.jsxs("div",{className:"prof-overview-card-content",children:[r.jsx("span",{className:"prof-overview-card-value",children:u}),r.jsxs("span",{className:"prof-overview-card-label",children:["Groupe",u!==1?"s":""," actif",u!==1?"s":""]})]})]}),r.jsxs("div",{className:"prof-overview-card",children:[r.jsx("div",{className:"prof-overview-card-icon",children:""}),r.jsxs("div",{className:"prof-overview-card-content",children:[r.jsx("span",{className:"prof-overview-card-value",children:f}),r.jsxs("span",{className:"prof-overview-card-label",children:["lve",f!==1?"s":""," inscrit",f!==1?"s":""]})]})]}),r.jsxs("div",{className:"prof-overview-card",children:[r.jsx("div",{className:"prof-overview-card-icon",children:""}),r.jsxs("div",{className:"prof-overview-card-content",children:[r.jsxs("span",{className:"prof-overview-card-value",children:[h,"/20"]}),r.jsx("span",{className:"prof-overview-card-label",children:"Moyenne gnrale"})]})]}),r.jsxs("div",{className:"prof-overview-card",children:[r.jsx("div",{className:"prof-overview-card-icon",children:""}),r.jsxs("div",{className:"prof-overview-card-content",children:[r.jsx("span",{className:`prof-overview-card-value ${b>0?"prof-note-critique":""}`,children:b}),r.jsxs("span",{className:"prof-overview-card-label",children:["lve",b!==1?"s":""," en difficult"]})]})]})]}),j.length===0?r.jsxs("div",{className:"prof-empty-state",children:[r.jsx("div",{className:"prof-empty-icon",children:""}),r.jsx("h3",{children:"Bienvenue sur votre espace Professeur !"}),r.jsx("p",{children:"Crez votre premier groupe-classe pour commencer  suivre vos lves."}),r.jsx("button",{className:"prof-btn prof-btn-primary",onClick:()=>a("groupes"),children:" Crer un groupe-classe"})]}):r.jsxs("div",{className:"prof-overview-groupes",children:[r.jsx("h2",{children:"Mes groupes"}),r.jsx("div",{className:"prof-overview-groupes-grid",children:j.map(k=>r.jsxs("div",{className:"prof-overview-groupe-card",onClick:()=>w(k),children:[r.jsxs("div",{className:"prof-overview-groupe-header",children:[r.jsx("h3",{children:k.nom}),r.jsx("span",{className:"prof-overview-groupe-matiere",children:k.matiereNom})]}),k.stats&&r.jsxs("div",{className:"prof-overview-groupe-stats",children:[r.jsxs("div",{children:[r.jsx("span",{className:"prof-overview-groupe-stat-value",children:k.stats.nombreEleves}),r.jsx("span",{className:"prof-overview-groupe-stat-label",children:"lves"})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"prof-overview-groupe-stat-value",children:[k.stats.moyenneClasse,"/20"]}),r.jsx("span",{className:"prof-overview-groupe-stat-label",children:"Moyenne"})]}),r.jsxs("div",{children:[r.jsxs("span",{className:"prof-overview-groupe-stat-value",children:[k.stats.tauxReussite,"%"]}),r.jsx("span",{className:"prof-overview-groupe-stat-label",children:"Russite"})]})]}),r.jsx("span",{className:"prof-overview-groupe-arrow",children:""})]},k.id))})]})]}),n==="groupes"&&r.jsx(WX,{onSelectGroupe:w}),n==="detail"&&l&&r.jsx(XX,{groupe:l,onRetour:z})]})},Zs="cahiers_textes",Zn="entrees_cahier",JX="groupes_prof",eZ="ebooks";async function tZ(e,t){const n=[Se("profId","==",e),Ke("updatedAt","desc")],a=ke(_e(X,Zs),...n);return(await ze(a)).docs.map(o=>({groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...o.data(),id:o.id}))}const QM=e=>tZ(e);function rZ(e,t,n,a){const l=[Se("profId","==",e),Ke("updatedAt","desc")];t&&l.splice(1,0,Se("anneeScolaire","==",t));const o=ke(_e(X,Zs),...l);return hf(o,u=>{n(u.docs.map(d=>({groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...d.data(),id:d.id})))},a)}async function VM(e){const t=await Ot(Ne(X,Zs,e));return t.exists()?{groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...t.data(),id:t.id}:null}const YM=e=>uZ(e);async function nZ(e){const t=await Ot(Ne(X,Zn,e));return t.exists()?{id:t.id,...t.data()}:null}async function aZ(e,t,n,a){const l=`${Date.now()}_${n.name}`,o=`cahiers/${e}/${t}/${l}`,u=qr(Or,o),d=kb(u,n);return new Promise((f,p)=>{d.on("state_changed",h=>{},p,async()=>{const h=await da(d.snapshot.ref);f({id:l,nom:n.name,url:h,type:n.type,taille:n.size,mimeType:n.type,uploadedAt:new Date().toISOString()})})})}async function $E(e,t,n){await Qe(Ne(X,Zn,e),{piecesJointes:Ob(...n),updatedAt:Oe.now()})}async function iZ(e,t,n){const a=t.find(l=>l.url===n);try{a?.id&&await Dc(qr(Or,`cahiers/${a.id}`))}catch{}a&&await Qe(Ne(X,Zn,e),{piecesJointes:Uq(a),updatedAt:Oe.now()})}async function sZ(e,t){const n=Oe.now(),a=t.titre?.trim()||`${t.matiere} ${t.classe} ${t.anneeScolaire}`;return(await Tt(_e(X,Zs),{profId:e,titre:a,matiere:t.matiere,classe:t.classe,anneeScolaire:t.anneeScolaire,description:t.description||"",couleur:t.couleur,nombreSeancesPrevu:t.nombreSeancesPrevu,nombreSeancesRealise:0,isArchived:!1,groupeIds:t.groupeIds??[],groupeNoms:t.groupeNoms??[],isPartage:t.isPartage??!1,createdAt:n,updatedAt:n})).id}async function uf(e,t){const n={...t};if("matiere"in t&&"classe"in t&&!("id"in t)){const a=t;a.titre?.trim()||(n.titre=`${a.matiere} ${a.classe} ${a.anneeScolaire}`)}await Qe(Ne(X,Zs,e),{...n,updatedAt:Oe.now()})}async function lZ(e){await en(Ne(X,Zs,e))}async function oZ(e){const t=await Ot(Ne(X,Zs,e));if(!t.exists())return null;const n=t.data();return n.isPartage?{id:t.id,...n}:null}async function KM(e){const t=ke(_e(X,JX),Se("profId","==",e),Ke("nom","asc"));return(await ze(t)).docs.map(a=>({id:a.id,...a.data()}))}async function cZ(){return(await ze(_e(X,eZ))).docs.map(t=>({id:t.id,...t.data()}))}async function uZ(e){const t=ke(_e(X,Zn),Se("cahierId","==",e),Ke("ordre","asc"));return(await ze(t)).docs.map(a=>({id:a.id,...a.data()}))}const dZ=async(e,t,n)=>{const a=Oe.fromDate(new Date(t,n,1)),l=Oe.fromDate(new Date(t,n+1,0,23,59,59)),o=ke(_e(X,Zn),Se("cahierId","==",e),Se("date",">=",a),Se("date","<=",l),Ke("date","asc"));return(await ze(o)).docs.map(d=>({id:d.id,...d.data()}))},mZ=async(e,t)=>{const n=[Se("profId","==",e),Se("isMarqueEvaluation","==",!0),Ke("date","desc")];t&&n.unshift(Se("cahierId","==",t));const a=ke(_e(X,Zn),...n);return(await ze(a)).docs.map(o=>({id:o.id,...o.data()}))},fZ=async e=>{const n=(await ze(ke(_e(X,Zn),Se("cahierId","==",e)))).docs.map(u=>u.data()),a=n.length,l={realise:0,planifie:0,annule:0,reporte:0},o={};for(const u of n){const d=u.statut;d in l&&l[d]++,u.typeContenu&&(o[u.typeContenu]=(o[u.typeContenu]??0)+1)}return{total:a,...l,parType:o,tauxRealisation:a>0?Math.round(l.realise/a*100):0}};async function pZ(e){const t=ke(_e(X,Zn),Se("cahierId","==",e),Se("statut","==","realise"),Ke("date","desc"));return(await ze(t)).docs.map(a=>({id:a.id,...a.data()}))}async function hZ(e,t,n){const a=Oe.now();let l;if(typeof e=="string"){const u=n;l={cahierId:e,profId:t,date:Oe.fromDate(new Date(u.date)),heureDebut:u.heureDebut||"",heureFin:u.heureFin||"",chapitre:u.chapitre,typeContenu:u.typeContenu,contenu:u.contenu,objectifs:u.objectifs||"",competences:u.competences||[],statut:u.statut,motifAnnulation:u.motifAnnulation||"",dateReport:u.dateReport?Oe.fromDate(new Date(u.dateReport)):null,notesPrivees:u.notesPrivees||"",isMarqueEvaluation:u.isMarqueEvaluation,typeEvaluation:u.typeEvaluation||null,dateEvaluationPrevue:u.dateEvaluationPrevue?Oe.fromDate(new Date(u.dateEvaluationPrevue)):null,statutEvaluation:u.statutEvaluation,ordre:Date.now(),piecesJointes:[],liens:[],ebooksLies:[],contenuIA:[]}}else l={liens:[],ebooksLies:[],piecesJointes:[],contenuIA:[],...e};return(await Tt(_e(X,Zn),{...l,createdAt:a,updatedAt:a})).id}async function Pc(e,t,n){let a;if(typeof t=="string"&&n){const l=n;a={date:Oe.fromDate(new Date(l.date)),heureDebut:l.heureDebut||"",heureFin:l.heureFin||"",chapitre:l.chapitre,typeContenu:l.typeContenu,contenu:l.contenu,objectifs:l.objectifs||"",competences:l.competences||[],statut:l.statut,motifAnnulation:l.motifAnnulation||"",dateReport:l.dateReport?Oe.fromDate(new Date(l.dateReport)):null,notesPrivees:l.notesPrivees||"",isMarqueEvaluation:l.isMarqueEvaluation,typeEvaluation:l.typeEvaluation||null,dateEvaluationPrevue:l.dateEvaluationPrevue?Oe.fromDate(new Date(l.dateEvaluationPrevue)):null,statutEvaluation:l.statutEvaluation}}else a={...t};await Qe(Ne(X,Zn,e),{...a,updatedAt:Oe.now()})}async function vZ(e){await en(Ne(X,Zn,e))}const Js=["6me","5me","4me","3me","2nde","1re","Terminale"],BE=["2023-2024","2024-2025","2025-2026","2026-2027"],gZ=["#2563eb","#7c3aed","#059669","#d97706","#dc2626","#0891b2","#db2777","#65a30d"],Fi={cours:{label:"Cours",emoji:"",color:"#3b82f6"},exercices:{label:"Exercices",emoji:"",color:"#8b5cf6"},correction:{label:"Correction",emoji:"",color:"#10b981"},devoir_surveille:{label:"Devoir surveill",emoji:"",color:"#f59e0b"},devoir_maison:{label:"Devoir  la maison",emoji:"",color:"#6366f1"},travaux_pratiques:{label:"Travaux pratiques",emoji:"",color:"#14b8a6"},evaluation:{label:"valuation",emoji:"",color:"#ef4444"},revision:{label:"Rvision",emoji:"",color:"#f97316"}},Tc={realise:{label:"Ralis",color:"#059669",bg:"#d1fae5"},planifie:{label:"Planifi",color:"#d97706",bg:"#fef3c7"},annule:{label:"Annul",color:"#dc2626",bg:"#fee2e2"},reporte:{label:"Report",color:"#2563eb",bg:"#dbeafe"}},WM={interro:"Interrogation",ds:"Devoir Surveill",examen:"Examen",oral:"Oral",autre:"Autre"},XM={devoir:{label:"Devoir  corriger",emoji:""},evaluation:{label:"valuation  prparer",emoji:""},notes:{label:"Notes  saisir",emoji:""},cours:{label:"Cours  prparer",emoji:""},personnalise:{label:"Rappel personnalis",emoji:""}},xZ=["Communiquer  l'crit","Communiquer  l'oral","Raisonner et rsoudre des problmes","Chercher et s'informer","Modliser","Reprsenter","Calculer et algorithmiser","Analyser et interprter","Exprimenter et observer","Cooprer et mutualiser"],UE=()=>({classe:"3me",matiere:"Mathmatiques",anneeScolaire:"2025-2026",titre:"",description:"",couleur:"#2563eb",nombreSeancesPrevu:30,groupeIds:[],groupeNoms:[],isPartage:!1}),bZ=()=>{const{currentUser:e}=rt(),t=st(),[n]=nA(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,f]=g.useState("2025-2026"),[p,h]=g.useState(!1),[v,b]=g.useState(null),[x,j]=g.useState(UE()),[N,S]=g.useState(!1),[C,E]=g.useState(""),{matieres:w,loading:z}=fo(),[k,O]=g.useState([]),[P,D]=g.useState([]);if(!e?.isPremium&&e?.role!=="admin")return r.jsx("div",{className:"cahier-textes-page",children:r.jsxs("div",{className:"premium-gate",children:[r.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),r.jsx("h2",{children:"Cahier de Textes Numrique"}),r.jsxs("p",{children:["Cette fonctionnalit est rserve aux enseignants Premium.",r.jsx("br",{}),"Passez au Premium pour organiser, planifier et suivre votre enseignement."]}),r.jsx("button",{className:"btn-primary",onClick:()=>t("/premium"),children:" Passer au Premium  2 000 FCFA/mois"})]})});g.useEffect(()=>{if(!e?.uid)return;u(!0);const M=rZ(e.uid,d||void 0,q=>{l(q),u(!1)},q=>{console.error("Erreur chargement cahiers:",q),u(!1)});return()=>M()},[e?.uid,d]),g.useEffect(()=>{if(!e?.uid)return;KM(e.uid).then(O).catch(R=>console.error("Erreur chargement groupes:",R));const M=n.get("groupeId"),q=n.get("groupeNom"),F=n.get("classe");M&&q&&(D([M]),j(R=>({...R,classe:F||R.classe,groupeIds:[M],groupeNoms:[q]})),b(null),E(""),h(!0))},[e?.uid]);const L=()=>{b(null),j(UE()),D([]),E(""),h(!0)},U=(M,q)=>{q.stopPropagation(),b(M),D(M.groupeIds??[]),j({classe:M.classe,matiere:M.matiere,anneeScolaire:M.anneeScolaire,titre:M.titre,description:M.description||"",couleur:M.couleur,nombreSeancesPrevu:M.nombreSeancesPrevu,groupeIds:M.groupeIds??[],groupeNoms:M.groupeNoms??[],isPartage:M.isPartage??!1}),E(""),h(!0)},$=M=>{D(q=>{const F=q.includes(M)?q.filter(K=>K!==M):[...q,M],R=F.map(K=>k.find(I=>I.id===K)?.nom??"").filter(Boolean);return j(K=>({...K,groupeIds:F,groupeNoms:R})),F})},B=async M=>{if(M.preventDefault(),!!e?.uid){S(!0),E("");try{v?await uf(v.id,x):await sZ(e.uid,x),h(!1)}catch(q){const F=q instanceof Error?q.message:String(q);E("Erreur : "+F)}finally{S(!1)}}},re=async(M,q)=>{if(q.stopPropagation(),!!confirm(`Supprimer le cahier "${M.titre}" et toutes ses entres ?`))try{await lZ(M.id),l(F=>F.filter(R=>R.id!==M.id))}catch{alert("Erreur lors de la suppression.")}},se=M=>M.nombreSeancesPrevu>0?Math.min(100,Math.round(M.nombreSeancesRealise/M.nombreSeancesPrevu*100)):0;return r.jsxs("div",{className:"cahier-textes-page",children:[r.jsxs("div",{className:"cahier-page-header",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"cahier-page-title",children:" Cahier de Textes"}),r.jsx("p",{className:"cahier-page-subtitle",children:"Organisez et planifiez votre enseignement"})]}),r.jsx("button",{className:"btn-primary",onClick:L,children:"+ Nouveau cahier"})]}),r.jsxs("div",{className:"cahier-filtres",children:[r.jsx("label",{style:{fontSize:"0.85rem",color:"#6b7280",fontWeight:600},children:"Anne scolaire :"}),r.jsxs("select",{className:"filtre-select",value:d,onChange:M=>f(M.target.value),children:[r.jsx("option",{value:"",children:"Toutes les annes"}),BE.map(M=>r.jsx("option",{value:M,children:M},M))]})]}),o?r.jsx("div",{className:"loading-spinner",children:r.jsx("div",{className:"spinner-circle"})}):a.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{style:{fontSize:"3rem",opacity:.3,marginBottom:"0.75rem"},children:""}),r.jsxs("h3",{children:["Aucun cahier pour ",d||"cette priode"]}),r.jsx("p",{children:"Crez votre premier cahier de textes pour commencer  planifier votre enseignement."}),r.jsx("button",{className:"btn-primary",onClick:L,style:{marginTop:"1rem"},children:"+ Crer mon premier cahier"})]}):r.jsx("div",{className:"cahiers-grid",children:a.map(M=>{const q=se(M);return r.jsxs("div",{className:"cahier-card",onClick:()=>t(`/prof/cahiers/${M.id}`),children:[r.jsx("div",{style:{height:4,background:M.couleur,borderRadius:"12px 12px 0 0"}}),r.jsx("div",{className:"cahier-card-header",children:r.jsxs("div",{style:{flex:1},children:[r.jsx("h3",{className:"cahier-card-titre",children:M.titre}),r.jsxs("div",{className:"cahier-card-meta",children:[r.jsx("span",{className:"badge-classe",children:M.classe}),r.jsx("span",{className:"badge-matiere",children:M.matiere}),r.jsx("span",{className:"badge-annee",children:M.anneeScolaire})]}),(M.groupeIds?.length??0)>0&&r.jsxs("span",{className:`badge-partage ${M.isPartage?"actif":""}`,style:{marginTop:6,display:"inline-flex"},children:[M.isPartage?" Partag avec":" Li "," ",M.groupeIds.length," groupe",M.groupeIds.length>1?"s":""]})]})}),r.jsxs("div",{className:"cahier-card-body",children:[M.description&&r.jsxs("p",{style:{fontSize:"0.82rem",color:"#6b7280",margin:"0 0 0.75rem",lineHeight:1.5},children:[M.description.substring(0,80),M.description.length>80?"...":""]}),r.jsxs("div",{className:"progression-bar-wrap",children:[r.jsxs("div",{className:"progression-label",children:[r.jsx("span",{children:"Progression"}),r.jsxs("span",{style:{fontWeight:700,color:M.couleur},children:[q,"%"]})]}),r.jsx("div",{className:"progression-bar-bg",children:r.jsx("div",{className:"progression-bar-fill",style:{width:`${q}%`,background:M.couleur}})}),r.jsxs("div",{style:{fontSize:"0.72rem",color:"#9ca3af",marginTop:"0.3rem"},children:[M.nombreSeancesRealise," / ",M.nombreSeancesPrevu," sances ralises"]})]})]}),r.jsxs("div",{className:"cahier-card-footer",children:[r.jsxs("span",{style:{fontSize:"0.75rem",color:"#9ca3af"},children:["Mis  jour le ",M.updatedAt?.toDate().toLocaleDateString("fr-FR")||""]}),r.jsxs("div",{className:"cahier-actions",children:[r.jsx("button",{className:"btn-icon",onClick:F=>U(M,F),title:"Modifier",children:""}),r.jsx("button",{className:"btn-icon",onClick:F=>re(M,F),title:"Supprimer",style:{color:"#ef4444"},children:""})]})]})]},M.id)})}),p&&r.jsx("div",{className:"modal-overlay",onClick:()=>h(!1),children:r.jsxs("div",{className:"modal-content",onClick:M=>M.stopPropagation(),children:[r.jsxs("h2",{className:"modal-title",children:[" ",v?"Modifier le cahier":"Nouveau cahier de textes"]}),r.jsxs("form",{onSubmit:B,children:[r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Classe *"}),r.jsx("select",{className:"form-select",value:x.classe,onChange:M=>j(q=>({...q,classe:M.target.value})),required:!0,children:Js.map(M=>r.jsx("option",{value:M,children:M},M))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Matire *"}),r.jsxs("select",{className:"form-select",value:x.matiere,onChange:M=>j(q=>({...q,matiere:M.target.value})),required:!0,disabled:z,children:[r.jsx("option",{value:"",children:z?"Chargement":" Slectionner "}),w.map(M=>r.jsx("option",{value:M.valeur,children:M.label},M.valeur)),x.matiere&&!w.find(M=>M.valeur===x.matiere)&&r.jsx("option",{value:x.matiere,children:x.matiere})]})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Anne scolaire *"}),r.jsx("select",{className:"form-select",value:x.anneeScolaire,onChange:M=>j(q=>({...q,anneeScolaire:M.target.value})),children:BE.map(M=>r.jsx("option",{value:M,children:M},M))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Titre personnalis"}),r.jsx("input",{className:"form-input",placeholder:`Ex: Maths 3me A - ${x.anneeScolaire}`,value:x.titre,onChange:M=>j(q=>({...q,titre:M.target.value}))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Nombre de sances prvues"}),r.jsx("input",{type:"number",className:"form-input",min:"1",max:"200",value:x.nombreSeancesPrevu,onChange:M=>j(q=>({...q,nombreSeancesPrevu:Number(M.target.value)}))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Description / Objectifs (optionnel)"}),r.jsx("textarea",{className:"form-textarea",placeholder:"Objectifs gnraux, groupe classe, notes...",value:x.description,onChange:M=>j(q=>({...q,description:M.target.value})),rows:2})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Couleur du cahier"}),r.jsx("div",{className:"couleur-picker",children:gZ.map(M=>r.jsx("div",{className:`couleur-option ${x.couleur===M?"selected":""}`,style:{background:M},onClick:()=>j(q=>({...q,couleur:M})),title:M},M))})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{className:"form-label",children:["Groupes classes lis"," ",r.jsx("span",{style:{fontWeight:400,color:"#9ca3af"},children:"(optionnel)"})]}),k.length===0?r.jsxs("p",{style:{fontSize:"0.82rem",color:"#9ca3af",margin:0},children:["Aucun groupe cr."," ",r.jsx("button",{type:"button",style:{background:"none",border:"none",color:"#2563eb",cursor:"pointer",padding:0,fontSize:"0.82rem"},onClick:()=>t("/prof/groupes"),children:"Crer un groupe "})]}):r.jsx("div",{className:"groupe-selector",children:k.map(M=>{const q=P.includes(M.id);return r.jsxs("div",{className:`groupe-option ${q?"selected":""}`,onClick:()=>$(M.id),children:[r.jsx("input",{type:"checkbox",checked:q,readOnly:!0,tabIndex:-1}),r.jsxs("span",{children:[r.jsx("strong",{children:M.nom}),"  ",M.classe," (",M.anneeScolaire,")"]})]},M.id)})}),P.length>0&&r.jsx("div",{className:"groupes-tags",children:P.map(M=>{const q=k.find(F=>F.id===M);return q?r.jsxs("span",{className:"groupe-tag",children:[q.nom,r.jsx("button",{type:"button",onClick:()=>$(M),"aria-label":`Retirer ${q.nom}`,children:""})]},M):null})}),P.length>0&&r.jsxs("label",{className:"toggle-partage",style:{marginTop:10},children:[r.jsx("input",{type:"checkbox",checked:x.isPartage??!1,onChange:M=>j(q=>({...q,isPartage:M.target.checked}))}),r.jsx("span",{children:" Rendre visible aux lves des groupes lis"})]})]}),C&&r.jsx("div",{style:{color:"#dc2626",fontSize:"0.85rem",marginBottom:"0.75rem",background:"#fee2e2",padding:"0.5rem 0.75rem",borderRadius:8},children:C}),r.jsxs("div",{className:"modal-footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>h(!1),children:"Annuler"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:N,children:N?"Enregistrement...":v?"Mettre  jour":"Crer le cahier"})]})]})]})})]})},yZ=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],jZ=["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],NZ=(e,t,n)=>{const a=new Date(e,t,1),l=new Date(e,t+1,0);let o=a.getDay()-1;o<0&&(o=6);const u=new Date,d=[];for(let p=o-1;p>=0;p--){const h=new Date(e,t,-p);d.push({date:h,isCurrentMonth:!1,isToday:!1,entrees:[]})}for(let p=1;p<=l.getDate();p++){const h=new Date(e,t,p),v=h.toDateString()===u.toDateString(),b=n.filter(x=>{const j=x.date.toDate();return j.getFullYear()===e&&j.getMonth()===t&&j.getDate()===p});d.push({date:h,isCurrentMonth:!0,isToday:v,entrees:b})}let f=1;for(;d.length<42;){const p=new Date(e,t+1,f++);d.push({date:p,isCurrentMonth:!1,isToday:!1,entrees:[]})}return d},_Z=({cahierId:e})=>{const t=st(),n=new Date,[a,l]=g.useState(n.getFullYear()),[o,u]=g.useState(n.getMonth()),[d,f]=g.useState([]),[p,h]=g.useState(!1),[v,b]=g.useState(null),[x,j]=g.useState({x:0,y:0});g.useEffect(()=>{(async()=>{h(!0);try{const z=await dZ(e,a,o);f(z)}catch(z){console.error("Erreur chargement entres calendrier:",z)}finally{h(!1)}})()},[e,a,o]);const N=NZ(a,o,d),S=()=>{o===0?(l(w=>w-1),u(11)):u(w=>w-1)},C=()=>{o===11?(l(w=>w+1),u(0)):u(w=>w+1)},E=(w,z)=>{if(!w.isCurrentMonth||w.entrees.length===0)return;const k=z.target.getBoundingClientRect();j({x:k.left,y:k.bottom+window.scrollY+8}),b(w)};return r.jsxs("div",{className:"cahier-calendar",onClick:()=>b(null),children:[r.jsxs("div",{className:"calendar-nav",children:[r.jsx("button",{className:"calendar-nav-btn",onClick:S,"aria-label":"Mois prcdent",children:""}),r.jsxs("span",{className:"calendar-nav-title",children:[jZ[o]," ",a,p&&" ..."]}),r.jsx("button",{className:"calendar-nav-btn",onClick:C,"aria-label":"Mois suivant",children:""})]}),r.jsx("div",{className:"calendar-weekdays",children:yZ.map(w=>r.jsx("div",{className:"calendar-weekday",children:w},w))}),r.jsx("div",{className:"calendar-grid",onClick:w=>w.stopPropagation(),children:N.map((w,z)=>r.jsxs("div",{className:`calendar-day ${w.isCurrentMonth?"":"other-month"} ${w.isToday?"today":""} ${v?.date.toDateString()===w.date.toDateString()?"selected":""}`,onClick:k=>E(w,k),children:[r.jsx("div",{className:"calendar-day-num",children:w.date.getDate()}),r.jsxs("div",{className:"calendar-day-events",children:[w.entrees.slice(0,3).map(k=>{const O=Fi[k.typeContenu];return r.jsxs("div",{className:"calendar-event-dot",style:{background:O.color},title:k.chapitre,children:[O.emoji," ",k.chapitre.substring(0,12)]},k.id)}),w.entrees.length>3&&r.jsxs("div",{className:"calendar-more",children:["+",w.entrees.length-3]})]})]},z))}),r.jsx("div",{className:"calendar-legend",children:Object.entries(Fi).slice(0,5).map(([w,z])=>r.jsxs("div",{className:"legend-item",children:[r.jsx("div",{className:"legend-dot",style:{background:z.color}}),z.label]},w))}),v&&v.entrees.length>0&&r.jsxs("div",{className:"calendar-day-popup",style:{top:x.y,left:Math.min(x.x,window.innerWidth-300)},onClick:w=>w.stopPropagation(),children:[r.jsxs("div",{className:"calendar-day-popup-title",children:[" ",v.date.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"})]}),v.entrees.map(w=>{const z=Fi[w.typeContenu];return r.jsxs("div",{className:"calendar-popup-entree",onClick:()=>t(`/prof/cahiers/${e}/modifier/${w.id}`),children:[r.jsx("span",{className:"calendar-popup-entree-type",children:z.emoji}),r.jsxs("div",{className:"calendar-popup-entree-info",children:[r.jsx("div",{className:"calendar-popup-entree-chapitre",children:w.chapitre}),w.heureDebut&&r.jsxs("div",{className:"calendar-popup-entree-heure",children:[w.heureDebut,w.heureFin?`  ${w.heureFin}`:""]})]})]},w.id)})]})]})},dp="rappels_prof",SZ=async(e,t)=>(await Tt(_e(X,dp),{profId:e,titre:t.titre,description:t.description||"",typeRappel:t.typeRappel,dateRappel:Oe.fromDate(new Date(t.dateRappel)),recurrence:t.recurrence,priorite:t.priorite,cahierId:t.cahierId||null,isLu:!1,isDone:!1,createdAt:Oe.now()})).id,wZ=async e=>{const t=ke(_e(X,dp),Se("profId","==",e),Se("isDone","==",!1),Ke("dateRappel","asc"));return(await ze(t)).docs.map(a=>({id:a.id,...a.data()}))},CZ=async(e,t)=>{await Qe(Ne(X,dp,e),{isDone:t,isLu:t})},EZ=async e=>{await en(Ne(X,dp,e))},FE=()=>({titre:"",description:"",typeRappel:"personnalise",dateRappel:new Date(Date.now()+36e5).toISOString().slice(0,16),recurrence:"unique",priorite:"normale"}),Zd=({profId:e,cahierId:t})=>{const[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(!1),[f,p]=g.useState(FE()),[h,v]=g.useState(!1),b=async()=>{try{o(!0);const w=await wZ(e);a(w)}catch(w){console.error("Erreur rappels:",w)}finally{o(!1)}};g.useEffect(()=>{b()},[e]);const x=async w=>{if(w.preventDefault(),!!f.titre.trim()){v(!0);try{await SZ(e,{...f,cahierId:t}),d(!1),p(FE()),await b()}catch(z){console.error("Erreur cration rappel:",z)}finally{v(!1)}}},j=async w=>{await CZ(w,!0),a(z=>z.filter(k=>k.id!==w))},N=async w=>{confirm("Supprimer ce rappel ?")&&(await EZ(w),a(z=>z.filter(k=>k.id!==w)))},S=new Date,C=n.filter(w=>w.dateRappel.toDate()<=S),E=n.filter(w=>w.dateRappel.toDate()>S);return r.jsxs("div",{style:{background:"white",borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",overflow:"hidden"},children:[r.jsxs("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid #f3f4f6",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[r.jsx("span",{style:{fontSize:"1.1rem"},children:""}),r.jsx("span",{style:{fontWeight:700,fontSize:"0.95rem",color:"#1f2937"},children:"Rappels"}),C.length>0&&r.jsx("span",{style:{background:"#dc2626",color:"white",borderRadius:20,padding:"1px 7px",fontSize:"0.7rem",fontWeight:700},children:C.length})]}),r.jsx("button",{className:"btn-primary",style:{padding:"0.35rem 0.75rem",fontSize:"0.8rem"},onClick:()=>d(w=>!w),children:"+ Ajouter"})]}),u&&r.jsxs("form",{onSubmit:x,style:{padding:"1rem 1.25rem",borderBottom:"1px solid #f3f4f6",background:"#f9fafb"},children:[r.jsx("div",{className:"form-group",children:r.jsx("input",{className:"form-input",placeholder:"Titre du rappel *",value:f.titre,onChange:w=>p(z=>({...z,titre:w.target.value})),required:!0})}),r.jsx("div",{className:"form-group",children:r.jsx("select",{className:"form-select",value:f.typeRappel,onChange:w=>p(z=>({...z,typeRappel:w.target.value})),children:Object.entries(XM).map(([w,z])=>r.jsxs("option",{value:w,children:[z.emoji," ",z.label]},w))})}),r.jsx("div",{className:"form-group",children:r.jsx("input",{type:"datetime-local",className:"form-input",value:f.dateRappel,onChange:w=>p(z=>({...z,dateRappel:w.target.value})),required:!0})}),r.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[r.jsxs("select",{className:"form-select",value:f.priorite,onChange:w=>p(z=>({...z,priorite:w.target.value})),children:[r.jsx("option",{value:"normale",children:"Normale"}),r.jsx("option",{value:"urgente",children:" Urgente"})]}),r.jsxs("select",{className:"form-select",value:f.recurrence,onChange:w=>p(z=>({...z,recurrence:w.target.value})),children:[r.jsx("option",{value:"unique",children:"Une fois"}),r.jsx("option",{value:"hebdomadaire",children:"Hebdo"})]})]}),r.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.75rem"},children:[r.jsx("button",{type:"submit",className:"btn-primary",disabled:h,style:{flex:1},children:h?"...":"Enregistrer"}),r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>d(!1),children:"Annuler"})]})]}),r.jsx("div",{style:{padding:"0.75rem 1.25rem"},children:l?r.jsx("div",{style:{textAlign:"center",color:"#9ca3af",padding:"1rem",fontSize:"0.85rem"},children:"Chargement..."}):n.length===0?r.jsxs("div",{style:{textAlign:"center",color:"#9ca3af",padding:"1rem",fontSize:"0.85rem"},children:[r.jsx("div",{children:""}),r.jsx("div",{children:"Aucun rappel actif"})]}):r.jsxs(r.Fragment,{children:[C.length>0&&r.jsxs("div",{style:{marginBottom:"0.75rem"},children:[r.jsx("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"#dc2626",textTransform:"uppercase",marginBottom:"0.4rem"},children:" En retard"}),C.map(w=>r.jsx(GE,{rappel:w,onDone:j,onDelete:N},w.id))]}),E.length>0&&r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"#6b7280",textTransform:"uppercase",marginBottom:"0.4rem"},children:" venir"}),E.slice(0,5).map(w=>r.jsx(GE,{rappel:w,onDone:j,onDelete:N},w.id))]})]})})]})},GE=({rappel:e,onDone:t,onDelete:n})=>{const a=XM[e.typeRappel],l=e.dateRappel.toDate(),o=e.priorite==="urgente",u=l<=new Date;return r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem",padding:"0.5rem 0",borderBottom:"1px solid #f9fafb"},children:[r.jsx("button",{onClick:()=>t(e.id),style:{width:20,height:20,border:`2px solid ${o?"#dc2626":"#d1d5db"}`,borderRadius:4,background:"white",cursor:"pointer",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",marginTop:2},title:"Marquer termin"}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsxs("div",{style:{fontSize:"0.82rem",fontWeight:600,color:u?"#dc2626":"#1f2937",display:"flex",alignItems:"center",gap:"0.3rem"},children:[a.emoji," ",e.titre,o&&r.jsx("span",{style:{fontSize:"0.65rem",color:"#dc2626"},children:""})]}),r.jsxs("div",{style:{fontSize:"0.72rem",color:"#9ca3af",marginTop:2},children:[l.toLocaleDateString("fr-FR",{day:"numeric",month:"short"}),"  ",l.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]}),r.jsx("button",{onClick:()=>n(e.id),style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af",fontSize:"0.9rem",flexShrink:0},title:"Supprimer",children:""})]})},AZ=({profId:e,cahierId:t})=>{const n=st(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,f]=g.useState("tous");g.useEffect(()=>{(async()=>{u(!0);try{const x=await mZ(e,t);l(x)}catch(x){console.error("Erreur signets:",x)}finally{u(!1)}})()},[e,t]);const p=async(b,x)=>{try{await Pc(b.id,{statutEvaluation:x}),l(j=>j.map(N=>N.id===b.id?{...N,statutEvaluation:x}:N))}catch(j){console.error("Erreur mise  jour statut:",j)}},h=d==="tous"?a:a.filter(b=>b.statutEvaluation===d),v=[{value:"tous",label:"Tous",color:"#6b7280"},{value:"a_evaluer",label:" valuer",color:"#d97706"},{value:"evaluation_creee",label:"Cre",color:"#2563eb"},{value:"evaluation_terminee",label:"Termine",color:"#059669"}];return r.jsxs("div",{children:[r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem",flexWrap:"wrap",gap:"0.5rem"},children:r.jsxs("h3",{style:{fontSize:"1.1rem",fontWeight:700,color:"#1f2937",margin:0},children:[" Signets d'valuation (",a.length,")"]})}),r.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.25rem",flexWrap:"wrap"},children:v.map(b=>r.jsx("button",{onClick:()=>f(b.value),style:{padding:"0.3rem 0.85rem",borderRadius:20,border:`1.5px solid ${d===b.value?b.color:"#e5e7eb"}`,background:d===b.value?b.color:"white",color:d===b.value?"white":"#4b5563",fontSize:"0.8rem",fontWeight:600,cursor:"pointer",transition:"all 0.15s"},children:b.label},b.value))}),o?r.jsx("div",{style:{textAlign:"center",color:"#9ca3af",padding:"2rem"},children:"Chargement..."}):h.length===0?r.jsxs("div",{style:{textAlign:"center",padding:"2.5rem",color:"#9ca3af"},children:[r.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:""}),r.jsx("div",{style:{fontWeight:600,color:"#6b7280",marginBottom:"0.25rem"},children:"Aucun signet trouv"}),r.jsx("div",{style:{fontSize:"0.85rem"},children:"Marquez des entres pour valuation depuis l'diteur de sance."})]}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:h.map(b=>{const x=Fi[b.typeContenu];return Tc[b.statut],r.jsxs("div",{style:{background:"white",borderRadius:10,boxShadow:"0 2px 8px rgba(0,0,0,0.07)",padding:"1rem",borderLeft:"4px solid #f59e0b"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:"0.5rem",marginBottom:"0.5rem"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"0.9rem",fontWeight:700,color:"#1f2937"},children:b.chapitre}),r.jsx("div",{style:{fontSize:"0.78rem",color:"#9ca3af",marginTop:"0.15rem"},children:b.date.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})})]}),r.jsx("button",{onClick:()=>n(`/prof/cahiers/${t}/modifier/${b.id}`),style:{background:"none",border:"none",cursor:"pointer",color:"#2563eb",fontSize:"0.8rem",fontWeight:600,whiteSpace:"nowrap"},children:" Modifier"})]}),r.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.75rem"},children:[r.jsxs("span",{style:{padding:"0.15rem 0.6rem",borderRadius:20,fontSize:"0.72rem",fontWeight:600,background:x.color+"22",color:x.color},children:[x.emoji," ",x.label]}),b.typeEvaluation&&r.jsxs("span",{style:{padding:"0.15rem 0.6rem",borderRadius:20,fontSize:"0.72rem",fontWeight:600,background:"#fef3c7",color:"#92400e"},children:[" ",WM[b.typeEvaluation]]}),b.dateEvaluationPrevue&&r.jsxs("span",{style:{padding:"0.15rem 0.6rem",borderRadius:20,fontSize:"0.72rem",background:"#f3f4f6",color:"#4b5563"},children:[" ",b.dateEvaluationPrevue.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"short"})]})]}),r.jsx("div",{style:{display:"flex",gap:"0.4rem",flexWrap:"wrap"},children:["a_evaluer","evaluation_creee","evaluation_terminee"].map(j=>{const N=b.statutEvaluation===j,S={a_evaluer:" valuer",evaluation_creee:"Cre",evaluation_terminee:" Termine"},C={a_evaluer:"#d97706",evaluation_creee:"#2563eb",evaluation_terminee:"#059669"};return r.jsx("button",{onClick:()=>p(b,j),style:{padding:"0.25rem 0.7rem",borderRadius:20,border:`1.5px solid ${N?C[j]:"#e5e7eb"}`,background:N?C[j]:"white",color:N?"white":"#6b7280",fontSize:"0.72rem",fontWeight:600,cursor:"pointer"},children:S[j]},j)})})]},b.id)})})]})},zZ=({cahier:e})=>{const[t,n]=g.useState(null),[a,l]=g.useState(!0);g.useEffect(()=>{(async()=>{try{const d=await fZ(e.id);n(d)}catch{}finally{l(!1)}})()},[e.id]);const o=e.nombreSeancesPrevu>0?Math.min(100,Math.round(e.nombreSeancesRealise/e.nombreSeancesPrevu*100)):0;return a?r.jsx("div",{style:{padding:"1rem",textAlign:"center",color:"#9ca3af",fontSize:"0.85rem"},children:"Chargement des stats..."}):t?r.jsxs("div",{style:{background:"white",borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",padding:"1.25rem"},children:[r.jsx("div",{style:{fontWeight:700,fontSize:"0.95rem",color:"#1f2937",marginBottom:"1.25rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:" Statistiques du cahier"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem",marginBottom:"1.25rem"},children:[r.jsx(Jd,{value:t.total,label:"Sances total",color:"#2563eb",bg:"#dbeafe"}),r.jsx(Jd,{value:t.realise,label:"Ralises",color:"#059669",bg:"#d1fae5"}),r.jsx(Jd,{value:t.planifie,label:"Planifies",color:"#d97706",bg:"#fef3c7"}),r.jsx(Jd,{value:`${t.tauxRealisation}%`,label:"Taux de ralisation",color:"#7c3aed",bg:"#ede9fe"})]}),r.jsxs("div",{style:{marginBottom:"1.25rem"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.4rem"},children:[r.jsx("span",{children:"Progression du programme"}),r.jsxs("span",{style:{fontWeight:700,color:e.couleur},children:[o,"%"]})]}),r.jsx("div",{style:{height:8,background:"#e5e7eb",borderRadius:10,overflow:"hidden"},children:r.jsx("div",{style:{height:"100%",width:`${o}%`,background:e.couleur,borderRadius:10,transition:"width 0.5s ease"}})}),r.jsxs("div",{style:{fontSize:"0.75rem",color:"#9ca3af",marginTop:"0.3rem"},children:[e.nombreSeancesRealise," / ",e.nombreSeancesPrevu," sances prvues"]})]}),Object.keys(t.parType).length>0&&r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:"0.78rem",fontWeight:700,color:"#9ca3af",textTransform:"uppercase",marginBottom:"0.6rem"},children:"Rpartition par type"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.4rem"},children:Object.entries(t.parType).sort((u,d)=>d[1]-u[1]).map(([u,d])=>{const f=Fi[u];if(!f)return null;const p=t.total>0?Math.round(d/t.total*100):0;return r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.78rem",color:"#4b5563",marginBottom:"0.2rem"},children:[r.jsxs("span",{children:[f.emoji," ",f.label]}),r.jsxs("span",{style:{fontWeight:600},children:[d," (",p,"%)"]})]}),r.jsx("div",{style:{height:4,background:"#f3f4f6",borderRadius:10,overflow:"hidden"},children:r.jsx("div",{style:{height:"100%",width:`${p}%`,background:f.color,borderRadius:10}})})]},u)})})]})]}):null},Jd=({value:e,label:t,color:n,bg:a})=>r.jsxs("div",{style:{background:a,borderRadius:10,padding:"0.75rem",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800,color:n},children:e}),r.jsx("div",{style:{fontSize:"0.72rem",color:"#6b7280",marginTop:"0.15rem"},children:t})]});function HE(e){const t=new Date(e),n=t.getDay(),a=n===0?-6:1-n;return t.setDate(t.getDate()+a),t.setHours(0,0,0,0),t}function OZ(e){const t=new Date(e);return t.setDate(t.getDate()+6),t}function QE(e){const t=new Date(e),n=OZ(t),a={day:"numeric",month:"short"};return`${t.toLocaleDateString("fr-FR",a)}  ${n.toLocaleDateString("fr-FR",a)}`}function VE(e){const[t,n]=e.split("-");return new Date(Number(t),Number(n)-1).toLocaleDateString("fr-FR",{month:"long",year:"numeric"})}const kZ=()=>{const{cahierId:e}=Wn(),{currentUser:t}=rt(),n=st(),[a,l]=g.useState(null),[o,u]=g.useState([]),[d,f]=g.useState(!0),[p,h]=g.useState(!0),[v,b]=g.useState("liste"),[x,j]=g.useState("tous"),[N,S]=g.useState("tous"),[C,E]=g.useState("tous"),[w,z]=g.useState(null),[k,O]=g.useState("asc"),[P,D]=g.useState(!0),[L,U]=g.useState(!1);g.useEffect(()=>{Ot(Ne(X,"settings","platform")).then(I=>{if(I.exists()){const te=I.data();D(te.cahierPdfExport!==!1)}}).catch(()=>{})},[]),g.useEffect(()=>{if(!e)return;(async()=>{f(!0);try{const te=await VM(e);if(!te){n("/prof/cahiers");return}l(te)}finally{f(!1)}})()},[e,n]);const $=g.useCallback(async()=>{if(e){h(!0);try{const I=await YM(e);u(I)}finally{h(!1)}}},[e]);g.useEffect(()=>{$()},[$]);const B=async I=>{if(confirm(`Supprimer la sance "${I.chapitre}" ?`))try{await vZ(I.id);const te=o.filter(oe=>oe.id!==I.id);u(te);const Y=te.filter(oe=>oe.statut==="realise").length;await uf(e,{nombreSeancesRealise:Y}),l(oe=>oe&&{...oe,nombreSeancesRealise:Y})}catch{alert("Erreur lors de la suppression.")}},re=async(I,te)=>{try{await Pc(I.id,{statut:te});const Y=o.map(he=>he.id===I.id?{...he,statut:te}:he);u(Y);const oe=Y.filter(he=>he.statut==="realise").length;await uf(e,{nombreSeancesRealise:oe}),l(he=>he&&{...he,nombreSeancesRealise:oe})}catch{alert("Erreur mise  jour statut.")}},se=g.useCallback(()=>{U(!0),setTimeout(()=>{window.print(),U(!1)},100)},[]),M=g.useMemo(()=>Array.from(new Set(o.map(I=>{const te=I.date.toDate();return`${te.getFullYear()}-${String(te.getMonth()+1).padStart(2,"0")}`}))).sort(),[o]),q=g.useMemo(()=>{const I=C==="tous"?o:o.filter(Y=>{const oe=Y.date.toDate();return`${oe.getFullYear()}-${String(oe.getMonth()+1).padStart(2,"0")}`===C}),te=new Map;return I.forEach(Y=>{const he=HE(Y.date.toDate()).toISOString().slice(0,10);te.set(he,(te.get(he)||0)+1)}),Array.from(te.entries()).sort(([Y],[oe])=>Y.localeCompare(oe)).map(([Y,oe])=>({start:Y,count:oe}))},[o,C]),F=g.useMemo(()=>{const I=new Map;return o.forEach(te=>{const Y=te.date.toDate(),oe=`${Y.getFullYear()}-${String(Y.getMonth()+1).padStart(2,"0")}`;I.set(oe,(I.get(oe)||0)+1)}),I},[o]),R=g.useMemo(()=>o.filter(I=>{const te=I.date.toDate(),Y=x==="tous"||I.statut===x,oe=N==="tous"||I.typeContenu===N;let he=!0;C!=="tous"&&(he=`${te.getFullYear()}-${String(te.getMonth()+1).padStart(2,"0")}`===C);let ge=!0;return w&&(ge=HE(te).toISOString().slice(0,10)===w),Y&&oe&&he&&ge}).sort((I,te)=>{const Y=I.date.toMillis()-te.date.toMillis();return k==="asc"?Y:-Y}),[o,x,N,C,w,k]);if(d)return r.jsx("div",{className:"loading-spinner",children:r.jsx("div",{className:"spinner-circle"})});if(!a)return null;const K=a.nombreSeancesPrevu>0?Math.round(o.filter(I=>I.statut==="realise").length/a.nombreSeancesPrevu*100):0;return r.jsxs("div",{className:"cahier-detail-page",id:"cahier-detail-print-zone",children:[r.jsxs("div",{className:"cahier-detail-header",children:[r.jsx("button",{className:"btn-retour no-print",onClick:()=>n("/prof/cahiers"),title:"Retour  la liste",children:" Retour"}),r.jsx("div",{className:"cahier-detail-couleur-barre",style:{background:a.couleur}}),r.jsxs("div",{className:"cahier-detail-info",children:[r.jsx("h1",{className:"cahier-detail-titre",children:a.titre}),r.jsxs("div",{className:"cahier-detail-badges",children:[r.jsx("span",{className:"badge-classe",children:a.classe}),r.jsx("span",{className:"badge-matiere",children:a.matiere}),r.jsx("span",{className:"badge-annee",children:a.anneeScolaire}),a.isPartage&&r.jsx("span",{className:"badge-partage",children:" Partag"})]}),a.description&&r.jsx("p",{className:"cahier-detail-description",children:a.description}),r.jsxs("div",{className:"cahier-detail-progression",children:[r.jsx("div",{className:"progression-bar-bg",style:{width:200},children:r.jsx("div",{className:"progression-bar-fill",style:{width:`${K}%`,background:a.couleur}})}),r.jsxs("span",{className:"progression-pct",children:[o.filter(I=>I.statut==="realise").length," / ",a.nombreSeancesPrevu," sances (",K,"%)"]})]})]}),r.jsxs("div",{className:"cahier-detail-actions no-print",children:[P&&r.jsxs("button",{className:"btn-pdf",onClick:se,disabled:L,title:"Tlcharger en PDF",children:[L?"":""," PDF"]}),r.jsx("button",{className:"btn-primary",onClick:()=>n(`/prof/cahiers/${e}/nouvelle`),children:"+ Nouvelle sance"})]})]}),r.jsx("div",{className:"view-tabs no-print",children:[{id:"liste",label:" Liste"},{id:"calendrier",label:" Calendrier"},{id:"signets",label:" Signets"},{id:"stats",label:" Statistiques"}].map(I=>r.jsx("button",{className:`view-tab ${v===I.id?"active":""}`,onClick:()=>b(I.id),children:I.label},I.id))}),v==="calendrier"&&r.jsxs("div",{className:"cahier-detail-layout",children:[r.jsx("div",{children:r.jsx(_Z,{cahierId:a.id})}),r.jsx("div",{children:r.jsx(Zd,{profId:t.uid,cahierId:a.id})})]}),v==="signets"&&r.jsxs("div",{className:"cahier-detail-layout",children:[r.jsx(AZ,{profId:t.uid,cahierId:a.id}),r.jsx(Zd,{profId:t.uid,cahierId:a.id})]}),v==="stats"&&r.jsxs("div",{className:"cahier-detail-layout",children:[r.jsx(zZ,{cahier:{...a,nombreSeancesRealise:o.filter(I=>I.statut==="realise").length}}),r.jsx(Zd,{profId:t.uid,cahierId:a.id})]}),v==="liste"&&r.jsxs("div",{className:"cahier-three-col-layout",children:[r.jsxs("aside",{className:"cahier-nav-sidebar no-print",children:[r.jsxs("div",{className:"nav-sidebar-header",children:[r.jsx("span",{className:"nav-sidebar-icon",children:""}),r.jsx("span",{className:"nav-sidebar-title",children:"Navigation"})]}),r.jsxs("button",{className:`nav-month-item ${C==="tous"?"active":""}`,onClick:()=>{E("tous"),z(null)},children:[r.jsx("span",{children:"Tout afficher"}),r.jsx("span",{className:"nav-count-badge",children:o.length})]}),M.length>0&&r.jsx("div",{className:"nav-months-list",children:M.map(I=>r.jsxs("button",{className:`nav-month-item ${C===I?"active":""}`,onClick:()=>{E(I),z(null)},children:[r.jsx("span",{className:"nav-month-label",children:VE(I)}),r.jsx("span",{className:"nav-count-badge",children:F.get(I)||0})]},I))}),C!=="tous"&&q.length>0&&r.jsxs("div",{className:"nav-weeks-section",children:[r.jsx("div",{className:"nav-weeks-header",children:"Semaines"}),r.jsxs("button",{className:`nav-week-item ${w===null?"active":""}`,onClick:()=>z(null),children:[r.jsx("span",{children:"Tout le mois"}),r.jsx("span",{className:"nav-count-badge nav-count-badge--sm",children:F.get(C)||0})]}),q.map(I=>r.jsxs("button",{className:`nav-week-item ${w===I.start?"active":""}`,onClick:()=>z(I.start),children:[r.jsx("span",{className:"nav-week-label",children:QE(I.start)}),r.jsx("span",{className:"nav-count-badge nav-count-badge--sm",children:I.count})]},I.start))]}),o.length===0&&r.jsx("p",{className:"nav-sidebar-empty",children:"Aucune sance pour l'instant"})]}),r.jsxs("div",{className:"cahier-content-col",children:[r.jsxs("div",{className:"entrees-controls no-print",children:[r.jsx("div",{className:"entrees-statut-filters",children:["tous","realise","planifie","annule","reporte"].map(I=>{const te=I==="tous"?null:Tc[I];return r.jsx("button",{className:`statut-chip ${x===I?"active":""}`,style:x===I&&te?{borderColor:te.color,background:te.bg,color:te.color}:{},onClick:()=>j(I),children:I==="tous"?"Tous":te?.label},I)})}),r.jsxs("div",{className:"entrees-right-controls",children:[r.jsxs("select",{className:"filtre-select",value:N,onChange:I=>S(I.target.value),children:[r.jsx("option",{value:"tous",children:"Tous types"}),Object.entries(Fi).map(([I,te])=>r.jsxs("option",{value:I,children:[te.emoji," ",te.label]},I))]}),r.jsx("button",{className:"btn-sort",onClick:()=>O(I=>I==="asc"?"desc":"asc"),title:k==="asc"?"Ordre croissant (cliquer pour inverser)":"Ordre dcroissant (cliquer pour inverser)",children:k==="asc"?" Plus ancien":" Plus rcent"})]})]}),(C!=="tous"||w||x!=="tous"||N!=="tous")&&r.jsxs("div",{className:"filtre-actif-bar no-print",children:[r.jsxs("span",{className:"filtre-actif-label",children:[R.length," sance",R.length!==1?"s":"",w?`  Semaine du ${QE(w)}`:"",C!=="tous"&&!w?`  ${VE(C)}`:""]}),r.jsx("button",{className:"filtre-actif-reset",onClick:()=>{j("tous"),S("tous"),E("tous"),z(null)},children:" Rinitialiser"})]}),p&&R.length===0?r.jsx("div",{className:"loading-spinner",children:r.jsx("div",{className:"spinner-circle"})}):R.length===0?r.jsxs("div",{className:"empty-state",children:[r.jsx("div",{style:{fontSize:"2.5rem",opacity:.3,marginBottom:"0.5rem"},children:""}),r.jsx("h3",{children:x!=="tous"||N!=="tous"||C!=="tous"?"Aucune sance correspondant aux filtres":"Aucune sance pour l'instant"}),x==="tous"&&N==="tous"&&C==="tous"&&r.jsx("button",{className:"btn-primary",onClick:()=>n(`/prof/cahiers/${e}/nouvelle`),style:{marginTop:"1rem"},children:"+ Ajouter la premire sance"})]}):r.jsx("div",{className:"entrees-list",children:R.map((I,te)=>{const Y=Fi[I.typeContenu],oe=Tc[I.statut],he=I.date.toDate();return r.jsxs("div",{className:"entree-card",style:{borderLeftColor:Y.color},onClick:()=>n(`/prof/cahiers/${e}/modifier/${I.id}`),children:[r.jsx("div",{className:"entree-num",children:r.jsx("span",{style:{background:Y.color},children:k==="asc"?te+1:R.length-te})}),r.jsxs("div",{className:"entree-card-inner",children:[r.jsxs("div",{className:"entree-card-top",children:[r.jsxs("div",{className:"entree-card-gauche",children:[r.jsxs("div",{className:"entree-date",children:[" ",he.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),I.heureDebut&&r.jsxs("span",{className:"entree-heure",children:[" ",I.heureDebut,I.heureFin?`  ${I.heureFin}`:""]})]}),r.jsx("h3",{className:"entree-chapitre",children:I.chapitre}),r.jsxs("div",{className:"entree-badges",children:[r.jsxs("span",{className:"entree-type-badge",style:{background:Y.color},children:[Y.emoji," ",Y.label]}),r.jsx("span",{className:"entree-statut-badge",style:{background:oe.bg,color:oe.color},children:oe.label}),I.isMarqueEvaluation&&r.jsx("span",{className:"signet-badge",children:" valuation"}),I.piecesJointes&&I.piecesJointes.length>0&&r.jsxs("span",{className:"badge-pj",children:[" ",I.piecesJointes.length]})]})]}),r.jsxs("div",{className:"entree-actions no-print",children:[r.jsx("button",{className:"btn-icon",onClick:ge=>{ge.stopPropagation(),n(`/prof/cahiers/${e}/modifier/${I.id}`)},title:"Modifier",children:""}),r.jsx("button",{className:"btn-icon btn-icon--danger",onClick:ge=>{ge.stopPropagation(),B(I)},title:"Supprimer",children:""})]})]}),I.contenu&&r.jsx("div",{className:"entree-contenu-preview",dangerouslySetInnerHTML:{__html:I.contenu}}),I.objectifs&&r.jsxs("div",{className:"entree-objectifs",children:[" ",r.jsx("em",{children:I.objectifs})]}),r.jsxs("div",{className:"entree-card-footer no-print",children:[r.jsx("div",{className:"entree-statuts-rapides",children:["realise","planifie","annule"].map(ge=>{const Q=Tc[ge],ve=I.statut===ge;return r.jsx("button",{className:`statut-quick-btn ${ve?"active":""}`,style:ve?{borderColor:Q.color,background:Q.bg,color:Q.color}:{},onClick:Me=>{Me.stopPropagation(),re(I,ge)},children:Q.label},ge)})}),I.notesPrivees&&r.jsx("span",{className:"entree-has-notes",title:"Contient des notes prives",children:" Notes prives"})]})]})]},I.id)})})]}),r.jsx("div",{className:"cahier-sidebar-right no-print",children:r.jsx(Zd,{profId:t.uid,cahierId:a.id})})]})]})};function DZ(e){return{video:"",article:"",exercice:"",autre:""}[e]??""}function MZ(e){const t=/(?:youtube\.com\/watch\?v=|youtu\.be\/)([A-Za-z0-9_\-]{11})/,n=e.match(t);return n?n[1]:null}const PZ=({onAjouter:e,onAnnuler:t})=>{const[n,a]=g.useState(""),[l,o]=g.useState(""),[u,d]=g.useState("article"),[f,p]=g.useState(""),[h,v]=g.useState("");function b(j){o(j),(j.includes("youtube.com")||j.includes("youtu.be"))&&d("video")}function x(){if(!n.trim()){v("Le titre est requis.");return}if(!l.trim()||!l.startsWith("http://")&&!l.startsWith("https://")){v("Entrez une URL valide commenant par https://");return}const j={id:String(Date.now()),titre:n.trim(),url:l.trim(),type:u,description:f.trim()||void 0};e(j)}return r.jsxs("div",{className:"lien-form",children:[r.jsx("input",{type:"text",placeholder:"Titre du lien *",value:n,onChange:j=>a(j.target.value),"aria-label":"Titre du lien"}),r.jsx("input",{type:"url",placeholder:"https://... *",value:l,onChange:j=>b(j.target.value),"aria-label":"URL du lien"}),r.jsxs("select",{value:u,onChange:j=>d(j.target.value),"aria-label":"Type de lien",children:[r.jsx("option",{value:"article",children:" Article"}),r.jsx("option",{value:"video",children:" Vido"}),r.jsx("option",{value:"exercice",children:" Exercice"}),r.jsx("option",{value:"autre",children:" Autre"})]}),r.jsx("textarea",{placeholder:"Description (optionnelle)",value:f,onChange:j=>p(j.target.value),rows:2,"aria-label":"Description du lien"}),h&&r.jsx("p",{style:{color:"#dc2626",fontSize:"0.8rem",margin:0},children:h}),r.jsxs("div",{className:"lien-form-actions",children:[r.jsx("button",{className:"btn-secondary",onClick:t,type:"button",children:"Annuler"}),r.jsx("button",{className:"btn-pedaclic",onClick:x,type:"button",children:" Ajouter"})]})]})},TZ=({videoId:e})=>r.jsx("div",{className:"youtube-embed",children:r.jsx("iframe",{src:`https://www.youtube.com/embed/${e}`,title:"Vido YouTube",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy"})}),ZM=({liens:e,onChange:t,readonly:n=!1})=>{const[a,l]=g.useState(!1);function o(d){t([...e,d]),l(!1)}function u(d){t(e.filter(f=>f.id!==d))}return r.jsxs("section",{className:"liens-section","aria-label":"Liens externes",children:[r.jsx("h4",{children:" Liens et ressources"}),e.length>0&&r.jsx("div",{className:"liens-liste",children:e.map(d=>{const f=MZ(d.url);return r.jsxs("div",{className:"lien-card",children:[r.jsx("span",{className:"lien-icone","aria-hidden":"true",children:DZ(d.type)}),r.jsxs("div",{className:"lien-infos",children:[r.jsx("a",{href:d.url,target:"_blank",rel:"noopener noreferrer",className:"lien-titre",title:d.url,children:d.titre}),d.description&&r.jsx("p",{className:"lien-description",children:d.description}),f&&r.jsx(TZ,{videoId:f})]}),!n&&r.jsx("button",{className:"lien-suppr",onClick:()=>u(d.id),title:"Supprimer ce lien",type:"button","aria-label":`Supprimer le lien ${d.titre}`,children:""})]},d.id)})}),e.length===0&&!n&&r.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 12px"},children:"Aucun lien ajout. Ajoutez des ressources pour enrichir cette sance."}),!n&&r.jsx(r.Fragment,{children:a?r.jsx(PZ,{onAjouter:o,onAnnuler:()=>l(!1)}):r.jsx("button",{className:"btn-secondary",onClick:()=>l(!0),type:"button",children:" Ajouter un lien"})})]})},qZ=({selectedIds:e,onSelect:t,onFermer:n})=>{const[a,l]=g.useState(""),[o,u]=g.useState([]),[d,f]=g.useState(!0),[p,h]=g.useState("");g.useEffect(()=>{async function x(){try{const j=await cZ();u(j)}catch{h("Impossible de charger la bibliothque.")}finally{f(!1)}}x()},[]);const v=g.useMemo(()=>{const x=a.toLowerCase().trim();return x?o.filter(j=>j.titre.toLowerCase().includes(x)||j.auteur.toLowerCase().includes(x)||j.categorie.toLowerCase().includes(x)):o},[o,a]);function b(x){x.target===x.currentTarget&&n()}return r.jsx("div",{className:"ebook-selector-overlay",onClick:b,role:"dialog","aria-modal":"true","aria-label":"Slectionner un ebook",children:r.jsxs("div",{className:"ebook-selector-panel",children:[r.jsxs("div",{className:"ebook-selector-header",children:[r.jsx("h3",{children:" Bibliothque PedaClic"}),r.jsx("button",{onClick:n,"aria-label":"Fermer",style:{background:"none",border:"none",fontSize:"1.3rem",cursor:"pointer",color:"#6b7280"},type:"button",children:""})]}),r.jsx("div",{className:"ebook-search",children:r.jsx("input",{type:"search",placeholder:" Rechercher par titre, auteur ou catgorie...",value:a,onChange:x=>l(x.target.value),autoFocus:!0,"aria-label":"Recherche ebook"})}),r.jsxs("div",{className:"ebook-liste",children:[d&&r.jsx("p",{style:{color:"#6b7280",textAlign:"center"},children:" Chargement de la bibliothque"}),p&&r.jsx("p",{style:{color:"#dc2626",textAlign:"center"},children:p}),!d&&!p&&v.length===0&&r.jsx("p",{style:{color:"#9ca3af",textAlign:"center"},children:"Aucun ebook ne correspond  votre recherche."}),!d&&v.map(x=>{const j=e.includes(x.id);return r.jsxs("button",{type:"button",className:`ebook-item ${j?"selected":""}`,onClick:()=>!j&&t(x),disabled:j,"aria-pressed":j,"aria-label":`${j?"Dj li : ":""}${x.titre}`,children:[x.couvertureUrl?r.jsx("img",{src:x.couvertureUrl,alt:`Couverture de ${x.titre}`,loading:"lazy"}):r.jsx("div",{style:{width:36,height:48,background:"#e5e7eb",borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.2rem",flexShrink:0},"aria-hidden":"true",children:""}),r.jsxs("div",{className:"ebook-item-info",children:[r.jsx("div",{className:"ebook-item-titre",children:x.titre}),r.jsxs("div",{className:"ebook-item-meta",children:[x.auteur,"  ",x.categorie]}),j&&r.jsx("div",{style:{fontSize:"0.75rem",color:"#2563eb",marginTop:2},children:" Dj li  cette sance"})]})]},x.id)})]})]})})},JM=({ebooksLies:e,onChange:t,readonly:n=!1})=>{const[a,l]=g.useState(!1),o=e.map(f=>f.ebookId);function u(f){const p={ebookId:f.id,titre:f.titre,categorie:f.categorie,auteur:f.auteur};t([...e,p]),l(!1)}function d(f){t(e.filter(p=>p.ebookId!==f))}return r.jsxs("section",{"aria-label":"Ebooks lis  la sance",style:{marginTop:16},children:[r.jsx("h4",{style:{fontSize:"0.95rem",fontWeight:600,color:"#111827",margin:"0 0 8px"},children:" Ebooks de la bibliothque"}),e.length>0&&r.jsx("div",{className:"ebooks-lies",children:e.map(f=>r.jsxs("span",{className:"ebook-chip",children:[r.jsxs("a",{href:`/bibliotheque/${f.ebookId}`,className:"ebook-chip",style:{textDecoration:"none"},title:`Lire : ${f.titre}`,children:[" ",f.titre]}),!n&&r.jsx("button",{onClick:()=>d(f.ebookId),title:`Retirer ${f.titre}`,type:"button","aria-label":`Retirer l'ebook ${f.titre}`,children:""})]},f.ebookId))}),e.length===0&&!n&&r.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 8px"},children:"Aucun ebook li. Associez un ebook de la bibliothque  cette sance."}),!n&&r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>l(!0),style:{marginTop:8},children:" Choisir dans la bibliothque"}),a&&r.jsx(qZ,{selectedIds:o,onSelect:u,onFermer:()=>l(!1)})]})},eP="https://api.pedaclic.sn",RZ=12e4,IZ=1,ur={cours_complet:"Cours complet",fiche_revision:"Fiche de rvision",exercices_corriges:"Exercices corrigs",quiz_auto:"Quiz auto-gnr",sujet_examen:"Sujet type examen",evaluation_personnalisee:"valuation personnalise"},LZ={cours_complet:"Un cours structur avec introduction, dveloppement et conclusion adapt au programme sngalais.",fiche_revision:"Synthse des points cls pour rviser efficacement avant un examen.",exercices_corriges:"Srie d'exercices progressifs avec corrections dtailles tape par tape.",quiz_auto:"10 questions QCM avec 4 options, corrections et explications. Sauvegard directement comme quiz jouable.",sujet_examen:"Sujet conforme au format officiel BFEM ou BAC avec barme.",evaluation_personnalisee:"valuation sur mesure avec barme /20 et corrig-type."},Ba={cours_complet:"",fiche_revision:"",exercices_corriges:"",quiz_auto:"",sujet_examen:"",evaluation_personnalisee:""};async function $Z(e,t,n=RZ){const a=new AbortController,l=setTimeout(()=>a.abort(),n);try{const o=await fetch(e,{...t,signal:a.signal});return clearTimeout(l),o}catch(o){throw clearTimeout(l),o.name==="AbortError"?new Error(`La gnration a pris trop de temps (>${n/1e3}s). Le serveur est peut-tre surcharg. Veuillez ressayer dans quelques instants.`):o}}async function tP(e,t=IZ){try{return await e()}catch(n){if(t<=0)throw n;return console.warn(`[aiGeneratorService] chec, nouvelle tentative dans 3s... (${t} restante(s))`),await new Promise(a=>setTimeout(a,3e3)),tP(e,t-1)}}async function YE(){try{(await fetch(`${eP}/api/health`,{method:"GET"})).ok&&console.log("[aiGeneratorService] Ping Railway OK")}catch{}}async function BZ(e){const t=JSON.stringify(e),n={method:"POST",headers:{"Content-Type":"application/json"},body:t},a=await tP(()=>$Z(`${eP}/api/generate`,n)).catch(o=>{throw console.error("[aiGeneratorService] Erreur gnration:",o),o instanceof TypeError&&o.message.includes("fetch")?new Error("Impossible de contacter le serveur. Vrifiez votre connexion internet."):o});if(!a.ok){const u=(await a.json().catch(()=>({}))).error||`Erreur serveur (${a.status})`;throw new Error(u)}const l=await a.json();if(!l.success)throw new Error(l.error||"La gnration a chou.");return l}async function UZ(e,t,n,a){try{const l=await Tt(_e(X,"generated_content"),{userId:e,type:t.type,discipline:t.discipline,disciplineId:a,classe:t.classe,chapitre:t.chapitre,content:n,options:t.options||null,createdAt:Oe.now()});return console.log("[aiGeneratorService] Contenu sauvegard:",l.id),l.id}catch(l){throw console.error("[aiGeneratorService] Erreur sauvegarde contenu:",l),new Error("Erreur lors de la sauvegarde du contenu gnr.")}}async function FZ(e,t,n,a){try{const l=n.map((d,f)=>({id:`q_${Date.now()}_${f}`,question:d.question,options:d.options,reponseCorrecte:d.reponseCorrecte,explication:d.explication||"",difficulte:d.difficulte||"moyen",points:d.points||2})),o={disciplineId:a,titre:`Quiz IA  ${t.chapitre}`,description:`Quiz auto-gnr pour ${t.discipline} (${t.classe})  Chapitre : ${t.chapitre}`,questions:l,duree:15,isPremium:!0,noteMinimale:10,auteurId:e,source:"ia_generator",createdAt:Oe.now()},u=await Tt(_e(X,"quizzes"),o);return console.log("[aiGeneratorService] Quiz sauvegard:",u.id),u.id}catch(l){throw console.error("[aiGeneratorService] Erreur sauvegarde quiz:",l),new Error("Erreur lors de la sauvegarde du quiz gnr.")}}async function Cb(e,t=20){try{const n=ke(_e(X,"generated_content"),Se("userId","==",e),Ke("createdAt","desc")),a=await ze(n),l=[];return a.forEach(o=>{l.length<t&&l.push({id:o.id,...o.data()})}),l}catch(n){throw console.error("[aiGeneratorService] Erreur chargement historique:",n),new Error("Erreur lors du chargement de l'historique.")}}async function GZ(e){try{await en(Ne(X,"generated_content",e)),console.log("[aiGeneratorService] Contenu supprim:",e)}catch(t){throw console.error("[aiGeneratorService] Erreur suppression:",t),new Error("Erreur lors de la suppression du contenu.")}}const HZ=({userId:e,selectedIds:t,onSelect:n,onFermer:a})=>{const[l,o]=g.useState(""),[u,d]=g.useState([]),[f,p]=g.useState(!0),[h,v]=g.useState("");g.useEffect(()=>{async function j(){try{const N=await Cb(e,50);d(N)}catch{v("Impossible de charger les contenus gnrs.")}finally{p(!1)}}j()},[e]);const b=g.useMemo(()=>{const j=l.toLowerCase().trim();return j?u.filter(N=>N.chapitre.toLowerCase().includes(j)||N.discipline.toLowerCase().includes(j)||N.classe.toLowerCase().includes(j)||ur[N.type]?.toLowerCase().includes(j)):u},[u,l]);function x(j){j.target===j.currentTarget&&a()}return r.jsx("div",{className:"ebook-selector-overlay",onClick:x,role:"dialog","aria-modal":"true","aria-label":"Slectionner un contenu IA",children:r.jsxs("div",{className:"ebook-selector-panel",children:[r.jsxs("div",{className:"ebook-selector-header",children:[r.jsx("h3",{children:" Contenus gnrs par l'IA"}),r.jsx("button",{onClick:a,"aria-label":"Fermer",type:"button",style:{background:"none",border:"none",fontSize:"1.3rem",cursor:"pointer",color:"#6b7280"},children:""})]}),r.jsx("div",{className:"ebook-search",children:r.jsx("input",{type:"search",placeholder:" Rechercher par chapitre, discipline ou classe",value:l,onChange:j=>o(j.target.value),autoFocus:!0,"aria-label":"Recherche contenu IA"})}),r.jsxs("div",{className:"ebook-liste",children:[f&&r.jsx("p",{style:{color:"#6b7280",textAlign:"center"},children:" Chargement"}),h&&r.jsx("p",{style:{color:"#dc2626",textAlign:"center"},children:h}),!f&&!h&&b.length===0&&r.jsx("p",{style:{color:"#9ca3af",textAlign:"center"},children:"Aucun contenu ne correspond  votre recherche."}),!f&&b.map(j=>{const N=j.id?t.includes(j.id):!1,S=j.createdAt?.toDate?j.createdAt.toDate().toLocaleDateString("fr-FR"):"";return r.jsxs("button",{type:"button",className:`ebook-item ${N?"selected":""}`,onClick:()=>!N&&n(j),disabled:N,"aria-pressed":N,children:[r.jsx("div",{style:{width:36,height:48,background:"#eff6ff",borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.4rem",flexShrink:0},"aria-hidden":"true",children:Ba[j.type]}),r.jsxs("div",{className:"ebook-item-info",children:[r.jsx("div",{className:"ebook-item-titre",children:j.chapitre}),r.jsxs("div",{className:"ebook-item-meta",children:[ur[j.type],"  ",j.discipline,"  ",j.classe,S&&`  ${S}`]}),N&&r.jsx("div",{style:{fontSize:"0.75rem",color:"#2563eb",marginTop:2},children:" Dj li  cette sance"})]})]},j.id)})]})]})})},QZ=({userId:e,contenuIA:t,onChange:n,readonly:a=!1})=>{const[l,o]=g.useState(!1),u=t.map(p=>p.contenuId);function d(p){if(!p.id)return;const h={contenuId:p.id,type:p.type,discipline:p.discipline,classe:p.classe,chapitre:p.chapitre,createdAt:p.createdAt?.toDate?p.createdAt.toDate().toISOString():void 0};n([...t,h]),o(!1)}function f(p){n(t.filter(h=>h.contenuId!==p))}return r.jsxs("section",{"aria-label":"Contenus IA lis  la sance",style:{marginTop:16},children:[r.jsx("h4",{style:{fontSize:"0.95rem",fontWeight:600,color:"#111827",margin:"0 0 8px"},children:" Contenus gnrs par l'IA"}),t.length>0&&r.jsx("div",{className:"ebooks-lies",children:t.map(p=>r.jsxs("span",{className:"ebook-chip ebook-chip--ia",children:[r.jsxs("span",{title:`${p.discipline}  ${p.classe}  ${p.chapitre}`,children:[Ba[p.type]??""," ",p.chapitre]}),!a&&r.jsx("button",{onClick:()=>f(p.contenuId),title:`Retirer : ${p.chapitre}`,type:"button","aria-label":`Retirer le contenu ${p.chapitre}`,children:""})]},p.contenuId))}),t.length===0&&!a&&r.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 8px"},children:"Aucun contenu IA li. Associez un contenu gnr  cette sance."}),!a&&r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>o(!0),style:{marginTop:8},children:" Choisir un contenu IA"}),l&&r.jsx(HZ,{userId:e,selectedIds:u,onSelect:d,onFermer:()=>o(!1)})]})},VZ=()=>({date:new Date().toISOString().slice(0,10),heureDebut:"",heureFin:"",chapitre:"",typeContenu:"cours",contenu:"",objectifs:"",competences:[],statut:"realise",motifAnnulation:"",dateReport:"",notesPrivees:"",isMarqueEvaluation:!1,typeEvaluation:"",dateEvaluationPrevue:"",statutEvaluation:"a_evaluer"}),KE=()=>{const{cahierId:e,entreeId:t}=Wn(),{currentUser:n}=rt(),a=st(),[l,o]=g.useState(null),[u,d]=g.useState(null),[f,p]=g.useState(VZ()),[h,v]=g.useState([]),[b,x]=g.useState(!0),[j,N]=g.useState(!1),[S,C]=g.useState(!1),[E,w]=g.useState(""),[z,k]=g.useState([]),[O,P]=g.useState([]),[D,L]=g.useState([]),U=!!t;g.useEffect(()=>{if(!e)return;(async()=>{x(!0);try{const q=await VM(e);if(!q){a("/prof/cahiers");return}if(o(q),U&&t){const F=await nZ(t);F&&(d(F),v(F.piecesJointes||[]),k(F.liens??[]),P(F.ebooksLies??[]),L(F.contenuIA??[]),p({date:F.date.toDate().toISOString().slice(0,10),heureDebut:F.heureDebut||"",heureFin:F.heureFin||"",chapitre:F.chapitre,typeContenu:F.typeContenu,contenu:F.contenu,objectifs:F.objectifs||"",competences:F.competences||[],statut:F.statut,motifAnnulation:F.motifAnnulation||"",dateReport:F.dateReport?F.dateReport.toDate().toISOString().slice(0,10):"",notesPrivees:F.notesPrivees||"",isMarqueEvaluation:F.isMarqueEvaluation,typeEvaluation:F.typeEvaluation||"",dateEvaluationPrevue:F.dateEvaluationPrevue?F.dateEvaluationPrevue.toDate().toISOString().slice(0,10):"",statutEvaluation:F.statutEvaluation||"a_evaluer"}))}}finally{x(!1)}})()},[e,t]);const $=M=>{p(q=>({...q,competences:q.competences.includes(M)?q.competences.filter(F=>F!==M):[...q.competences,M]}))},B=async M=>{if(!M.target.files?.length||!n?.uid||!e)return;const q=M.target.files[0];if(q.size>10*1024*1024){alert("Fichier trop volumineux (max 10 Mo)");return}C(!0);try{const F=await aZ(n.uid,e,q),R=[...h,F];v(R),U&&t&&u&&await $E(t,h,[F])}catch{alert("Erreur upload fichier.")}finally{C(!1),M.target.value=""}},re=async M=>{if(!t){v(q=>q.filter(F=>F.url!==M));return}try{await iZ(t,h,M),v(q=>q.filter(F=>F.url!==M))}catch{alert("Erreur suppression fichier.")}},se=async M=>{if(M.preventDefault(),!f.chapitre.trim()){w("Le chapitre est obligatoire.");return}if(!f.date){w("La date est obligatoire.");return}if(!(!n?.uid||!e)){N(!0),w("");try{if(U&&t)await Pc(t,e,f),await Pc(t,{liens:z,ebooksLies:O,contenuIA:D});else{const R=await hZ(e,n.uid,f);h.length>0&&await $E(R,[],h),(z.length>0||O.length>0||D.length>0)&&await Pc(R,{liens:z,ebooksLies:O,contenuIA:D})}const F=(await YM(e)).filter(R=>R.statut==="realise").length;await uf(e,{nombreSeancesRealise:F}),a(`/prof/cahiers/${e}`)}catch(q){const F=q instanceof Error?q.message:String(q);w("Erreur : "+F)}finally{N(!1)}}};return b?r.jsx("div",{className:"loading-spinner",children:r.jsx("div",{className:"spinner-circle"})}):l?r.jsxs("div",{className:"entree-editor-page",children:[r.jsxs("div",{className:"editor-header",children:[r.jsx("button",{onClick:()=>a(`/prof/cahiers/${e}`),style:{background:"none",border:"none",cursor:"pointer",color:"#6b7280",fontSize:"1.2rem"},children:""}),r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:"1.4rem",fontWeight:700,color:"#1f2937",margin:"0 0 0.2rem"},children:U?" Modifier la sance":" Nouvelle sance"}),r.jsxs("div",{style:{fontSize:"0.85rem",color:"#6b7280"},children:[l.titre,"  ",l.classe,"  ",l.matiere]})]})]}),r.jsxs("form",{onSubmit:se,children:[r.jsxs("div",{className:"editor-card",children:[r.jsx("div",{className:"editor-section-title",children:" Informations de la sance"}),r.jsxs("div",{className:"form-row",style:{gridTemplateColumns:"1.5fr 1fr 1fr"},children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Date *"}),r.jsx("input",{type:"date",className:"form-input",value:f.date,onChange:M=>p(q=>({...q,date:M.target.value})),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Heure dbut"}),r.jsx("input",{type:"time",className:"form-input",value:f.heureDebut,onChange:M=>p(q=>({...q,heureDebut:M.target.value}))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Heure fin"}),r.jsx("input",{type:"time",className:"form-input",value:f.heureFin,onChange:M=>p(q=>({...q,heureFin:M.target.value}))})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Chapitre / Titre de la sance *"}),r.jsx("input",{className:"form-input",placeholder:"Ex: Chapitre 3  Les fonctions affines",value:f.chapitre,onChange:M=>p(q=>({...q,chapitre:M.target.value})),required:!0})]}),r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Type de sance"}),r.jsx("select",{className:"form-select",value:f.typeContenu,onChange:M=>p(q=>({...q,typeContenu:M.target.value})),children:Object.entries(Fi).map(([M,q])=>r.jsxs("option",{value:M,children:[q.emoji," ",q.label]},M))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Statut"}),r.jsx("select",{className:"form-select",value:f.statut,onChange:M=>p(q=>({...q,statut:M.target.value})),children:Object.entries(Tc).map(([M,q])=>r.jsx("option",{value:M,children:q.label},M))})]})]}),f.statut==="annule"&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Motif d'annulation"}),r.jsx("input",{className:"form-input",placeholder:"Ex: Grve enseignants, sortie scolaire...",value:f.motifAnnulation,onChange:M=>p(q=>({...q,motifAnnulation:M.target.value}))})]}),f.statut==="reporte"&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Nouvelle date (report)"}),r.jsx("input",{type:"date",className:"form-input",value:f.dateReport,onChange:M=>p(q=>({...q,dateReport:M.target.value}))})]})]}),r.jsxs("div",{className:"editor-card",children:[r.jsx("div",{className:"editor-section-title",children:" Contenu de la sance"}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Contenu (mise en forme riche)"}),r.jsx(fa,{value:f.contenu,onChange:M=>p(q=>({...q,contenu:M})),placeholder:"Dcrivez le contenu enseign, les exemples traits, les formules vues...",minHeight:220,maxHeight:600})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Objectifs pdagogiques"}),r.jsx("textarea",{className:"form-textarea",placeholder:"Ex: L'lve sera capable de rsoudre une quation du second degr...",value:f.objectifs,onChange:M=>p(q=>({...q,objectifs:M.target.value})),rows:2})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Comptences vises"}),r.jsx("div",{className:"competences-container",children:xZ.map(M=>r.jsx("button",{type:"button",className:`competence-tag ${f.competences.includes(M)?"selected":""}`,onClick:()=>$(M),children:M},M))})]})]}),r.jsxs("div",{className:"editor-card",children:[r.jsx("div",{className:"editor-section-title",children:" Signet d'valuation"}),r.jsxs("div",{className:"signet-section",children:[r.jsxs("div",{className:"signet-toggle",onClick:()=>p(M=>({...M,isMarqueEvaluation:!M.isMarqueEvaluation})),children:[r.jsx("div",{className:`toggle-switch ${f.isMarqueEvaluation?"on":""}`}),r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem",color:"#1f2937"},children:"Marquer pour valuation"}),r.jsx("div",{style:{fontSize:"0.78rem",color:"#6b7280"},children:"Ce contenu sera valu ultrieurement"})]})]}),f.isMarqueEvaluation&&r.jsx("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",gap:"0.75rem"},children:r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Type d'valuation"}),r.jsxs("select",{className:"form-select",value:f.typeEvaluation,onChange:M=>p(q=>({...q,typeEvaluation:M.target.value})),children:[r.jsx("option",{value:"",children:"Choisir..."}),Object.entries(WM).map(([M,q])=>r.jsx("option",{value:M,children:q},M))]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{className:"form-label",children:"Date prvue d'valuation"}),r.jsx("input",{type:"date",className:"form-input",value:f.dateEvaluationPrevue,onChange:M=>p(q=>({...q,dateEvaluationPrevue:M.target.value}))})]})]})})]})]}),r.jsxs("div",{className:"editor-card",children:[r.jsx("div",{className:"editor-section-title",children:" Pices jointes"}),h.length>0&&r.jsx("div",{className:"pieces-jointes-list",children:h.map(M=>r.jsxs("div",{className:"piece-jointe-item",children:[r.jsx("span",{children:""}),r.jsx("a",{href:M.url,target:"_blank",rel:"noopener noreferrer",children:M.nom}),r.jsxs("span",{style:{color:"#9ca3af",fontSize:"0.75rem"},children:["(",Math.round((M.taille??0)/1024)," Ko)"]}),r.jsx("button",{type:"button",onClick:()=>re(M.url),style:{background:"none",border:"none",cursor:"pointer",color:"#ef4444",marginLeft:"auto"},children:""})]},M.url))}),r.jsxs("label",{className:"upload-zone",children:[S?"Envoi en cours...":" Cliquer pour ajouter un fichier (PDF, image  max 10 Mo)",r.jsx("input",{type:"file",style:{display:"none"},accept:".pdf,.jpg,.jpeg,.png,.doc,.docx,.ppt,.pptx",onChange:B,disabled:S})]})]}),r.jsxs("div",{className:"editor-card",children:[r.jsx("div",{className:"editor-section-title",children:" Ressources enrichies"}),r.jsx("p",{style:{fontSize:"0.82rem",color:"#6b7280",margin:"0 0 4px"},children:"Ajoutez des liens ou des ebooks pour enrichir cette sance."}),r.jsx(ZM,{liens:z,onChange:k}),r.jsx(JM,{ebooksLies:O,onChange:P}),r.jsx(QZ,{userId:n.uid,contenuIA:D,onChange:L})]}),r.jsxs("div",{className:"editor-card",children:[r.jsx("div",{className:"editor-section-title",children:" Notes prives"}),r.jsx("textarea",{className:"form-textarea",placeholder:"Notes personnelles (non visibles par l'administration)...",value:f.notesPrivees,onChange:M=>p(q=>({...q,notesPrivees:M.target.value})),rows:3}),r.jsx("div",{style:{fontSize:"0.75rem",color:"#9ca3af",marginTop:"0.25rem"},children:"Ces notes sont uniquement visibles par vous."})]}),E&&r.jsx("div",{style:{color:"#dc2626",background:"#fee2e2",padding:"0.75rem 1rem",borderRadius:8,marginBottom:"1rem",fontSize:"0.85rem"},children:E}),r.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end",paddingBottom:"2rem"},children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>a(`/prof/cahiers/${e}`),children:"Annuler"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:j,style:{minWidth:160},children:j?"Enregistrement...":U?" Mettre  jour":" Enregistrer la sance"})]})]})]}):null},YZ=50*1024*1024,KZ="image/jpeg,image/png,image/gif,image/webp,audio/mpeg,audio/wav,audio/ogg,video/mp4";function WZ(e){return e.startsWith("image/")?"image":e.startsWith("audio/")?"audio":e.startsWith("video/")?"video":"autre"}function rP(e){return e<1024?`${e} o`:e<1024*1024?`${(e/1024).toFixed(1)} Ko`:`${(e/1024/1024).toFixed(1)} Mo`}const XZ=({src:e,alt:t,onFermer:n})=>r.jsx("div",{className:"image-fullscreen-overlay",onClick:n,role:"dialog","aria-modal":"true","aria-label":"Image en plein cran",children:r.jsx("img",{src:e,alt:t})}),ZZ=({pj:e,onSupprimer:t,readonly:n=!1})=>{const[a,l]=g.useState(!1);return r.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,overflow:"hidden",marginBottom:10,background:"#fff"},children:[e.type==="image"&&r.jsxs(r.Fragment,{children:[r.jsx("img",{src:e.url,alt:e.nom,className:"media-image",onClick:()=>l(!0),style:{maxWidth:"100%",display:"block"},loading:"lazy"}),a&&r.jsx(XZ,{src:e.url,alt:e.nom,onFermer:()=>l(!1)})]}),e.type==="audio"&&r.jsx("div",{className:"media-player",children:r.jsxs("audio",{controls:!0,preload:"metadata",children:[r.jsx("source",{src:e.url,type:e.mimeType}),"Votre navigateur ne supporte pas la lecture audio."]})}),e.type==="video"&&r.jsx("div",{className:"media-player",children:r.jsxs("video",{controls:!0,preload:"none",playsInline:!0,children:[r.jsx("source",{src:e.url,type:e.mimeType}),"Votre navigateur ne supporte pas la lecture vido."]})}),(e.type==="pdf"||e.type==="autre")&&r.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center",gap:8,padding:"10px 14px",textDecoration:"none",color:"#2563eb"},children:[" ",e.nom]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 12px",background:"#f9fafb",borderTop:"1px solid #f3f4f6"},children:[r.jsxs("span",{style:{fontSize:"0.78rem",color:"#6b7280",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[e.nom,e.taille&&`  ${rP(e.taille)}`]}),!n&&t&&r.jsx("button",{type:"button",onClick:()=>t(e.id),title:"Supprimer ce fichier",style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af",fontSize:"1rem",padding:"0 4px"},"aria-label":`Supprimer ${e.nom}`,children:""})]})]})},JZ=({piecesJointes:e,entreeId:t,profId:n,onChange:a,readonly:l=!1})=>{const o=g.useRef(null),[u,d]=g.useState(null),[f,p]=g.useState("");async function h(b){const x=b.target.files?.[0];if(!x)return;if(x.size>YZ){p(`Fichier trop volumineux (max 50 Mo). Ce fichier fait ${rP(x.size)}.`);return}p("");const j=`${Date.now()}_${x.name}`,N=`cahiers/${n}/${t}/${j}`,S=qr(Or,N),C=kb(S,x);C.on("state_changed",E=>{const w=Math.round(E.bytesTransferred/E.totalBytes*100);d(w)},E=>{p(`Erreur d'envoi : ${E.message}`),d(null)},async()=>{const E=await da(C.snapshot.ref),w=WZ(x.type),z={id:String(Date.now()),nom:x.name,url:E,type:w,taille:x.size,mimeType:x.type};a([...e,z]),d(null),o.current&&(o.current.value="")})}function v(b){a(e.filter(x=>x.id!==b))}return r.jsxs("section",{"aria-label":"Fichiers mdias",style:{marginTop:20},children:[r.jsx("h4",{style:{fontSize:"0.95rem",fontWeight:600,color:"#111827",margin:"0 0 12px"},children:" Fichiers mdias"}),e.map(b=>r.jsx(ZZ,{pj:b,onSupprimer:v,readonly:l},b.id)),e.length===0&&!l&&r.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 12px"},children:"Aucun fichier ajout. Formats accepts : images, audio, vido (max 50 Mo)."}),!l&&r.jsxs(r.Fragment,{children:[u!==null&&r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("div",{style:{height:8,background:"#e5e7eb",borderRadius:9999,overflow:"hidden"},children:r.jsx("div",{style:{height:"100%",width:`${u}%`,background:"#2563eb",transition:"width 0.3s ease"},role:"progressbar","aria-valuenow":u,"aria-valuemin":0,"aria-valuemax":100})}),r.jsxs("p",{style:{fontSize:"0.8rem",color:"#6b7280",margin:"4px 0 0"},children:["Envoi en cours ",u,"%"]})]}),f&&r.jsxs("p",{style:{fontSize:"0.8rem",color:"#dc2626",margin:"0 0 8px"},children:[" ",f]}),r.jsx("input",{ref:o,type:"file",accept:KZ,onChange:h,style:{display:"none"},"aria-label":"Choisir un fichier mdia"}),r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>o.current?.click(),disabled:u!==null,children:" Ajouter un fichier (image / audio / vido)"}),r.jsx("p",{style:{fontSize:"0.75rem",color:"#9ca3af",marginTop:6},children:"Max 50 Mo  JPG, PNG, GIF, WebP, MP3, WAV, OGG, MP4"})]})]})};function eJ(e){return e.toDate().toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}const tJ=()=>{const{cahierId:e}=Wn(),t=st(),[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState(!0),[f,p]=g.useState(""),[h,v]=g.useState(null);g.useEffect(()=>{async function x(){if(e){d(!0);try{const j=await oZ(e);if(!j){p("Ce cahier n'est pas accessible ou n'existe pas.");return}a(j);const N=await pZ(e);o(N)}catch{p("Une erreur est survenue lors du chargement.")}finally{d(!1)}}}x()},[e]);function b(x){v(j=>j===x?null:x)}return u?r.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"#6b7280"},children:[r.jsx("div",{style:{fontSize:"2rem"},children:""}),r.jsx("p",{children:"Chargement du cahier de textes"})]}):f||!n?r.jsxs("div",{style:{textAlign:"center",padding:"60px 20px"},children:[r.jsx("div",{style:{fontSize:"2.5rem"},children:""}),r.jsx("p",{style:{color:"#dc2626",fontWeight:600},children:f||"Accs non autoris"}),r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>t(-1),style:{marginTop:12},children:" Retour"})]}):r.jsxs("main",{style:{maxWidth:760,margin:"0 auto",padding:"20px 16px"},children:[r.jsxs("header",{className:"eleve-cahier-header",children:[r.jsx("button",{type:"button",onClick:()=>t(-1),style:{background:"rgba(255,255,255,0.2)",border:"none",color:"#fff",cursor:"pointer",borderRadius:8,padding:"4px 10px",fontSize:"0.85rem",marginBottom:10,display:"inline-flex",alignItems:"center",gap:4},children:" Retour"}),r.jsx("h1",{children:n.titre}),r.jsxs("p",{children:[n.matiere,"  ",n.classe,"  ",n.anneeScolaire]}),r.jsx("span",{className:"badge-lecture-seule",children:" Lecture seule  Sances ralises"})]}),n.description&&r.jsx("div",{style:{background:"#f0f9ff",border:"1px solid #bae6fd",borderRadius:10,padding:14,marginBottom:20,fontSize:"0.9rem",color:"#0c4a6e"},children:n.description}),r.jsx("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:16},children:l.length===0?"Aucune sance ralise pour l'instant.":`${l.length} sance${l.length>1?"s":""} ralise${l.length>1?"s":""}`}),l.length===0&&r.jsxs("div",{className:"eleve-vide",children:[r.jsx("span",{className:"emoji",children:""}),r.jsx("p",{children:"Votre professeur n'a pas encore enregistr de sance ralise."}),r.jsx("p",{style:{fontSize:"0.8rem"},children:"Revenez plus tard !"})]}),l.map(x=>{const j=h===x.id,N=(x.piecesJointes?.length??0)>0,S=(x.liens?.length??0)>0,C=(x.ebooksLies?.length??0)>0;return r.jsxs("article",{className:"seance-card-eleve",children:[r.jsxs("button",{type:"button",onClick:()=>b(x.id),style:{width:"100%",background:"none",border:"none",cursor:"pointer",textAlign:"left",padding:0},"aria-expanded":j,"aria-controls":`seance-corps-${x.id}`,children:[r.jsxs("div",{className:"seance-card-eleve-date",children:[" ",eJ(x.date),x.heureDebut?`  ${x.heureDebut}${x.heureFin?`  ${x.heureFin}`:""}`:""]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0},children:x.chapitre}),r.jsx("span",{style:{fontSize:"1.1rem",transition:"transform 0.2s",transform:j?"rotate(180deg)":"rotate(0)",display:"inline-block"},"aria-hidden":"true",children:""})]}),r.jsxs("div",{style:{display:"flex",gap:6,marginTop:6,flexWrap:"wrap"},children:[S&&r.jsx("span",{style:{fontSize:"0.72rem",background:"#eff6ff",color:"#2563eb",padding:"2px 8px",borderRadius:9999},children:" Ressources"}),C&&r.jsx("span",{style:{fontSize:"0.72rem",background:"#fef3c7",color:"#92400e",padding:"2px 8px",borderRadius:9999},children:" Ebooks"}),N&&r.jsx("span",{style:{fontSize:"0.72rem",background:"#f0fdf4",color:"#16a34a",padding:"2px 8px",borderRadius:9999},children:" Mdias"})]})]}),j&&r.jsxs("div",{id:`seance-corps-${x.id}`,style:{marginTop:14,borderTop:"1px solid #f3f4f6",paddingTop:14},children:[x.objectifs&&r.jsxs("div",{style:{background:"#f0fdf4",border:"1px solid #bbf7d0",borderRadius:8,padding:10,fontSize:"0.875rem",color:"#166534",marginBottom:12},children:[r.jsx("strong",{children:" Objectifs :"})," ",x.objectifs]}),r.jsx("div",{className:"seance-card-eleve-contenu",children:x.contenu}),S&&r.jsx(ZM,{liens:x.liens??[],onChange:()=>{},readonly:!0}),C&&r.jsx(JM,{ebooksLies:x.ebooksLies??[],onChange:()=>{},readonly:!0}),N&&r.jsx(JZ,{piecesJointes:x.piecesJointes??[],entreeId:x.id,profId:"",onChange:()=>{},readonly:!0})]})]},x.id)})]})},Zi="sequences_pedagogiques",rJ="entrees_cahier";function nP(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function mp(e){return e.filter(t=>t.estEvaluation&&t.typeEvaluation).map(t=>({id:t.id,titre:t.titre,type:t.typeEvaluation,seanceNumero:t.numero,noteMax:t.noteMax??20,coefficient:t.coefficient??1,datePrevue:t.datePrevue}))}async function nJ(e){const t=ke(_e(X,Zi),Se("profId","==",e),Ke("updatedAt","desc"));return(await ze(t)).docs.map(a=>({id:a.id,...a.data()}))}async function Jc(e){const t=await Ot(Ne(X,Zi,e));return t.exists()?{id:t.id,...t.data()}:null}async function aJ(e,t){const n=Oe.now(),a=t.seances.map(u=>({...u,id:u.id||nP(),exporterVersCahier:u.exporterVersCahier??!0,entreesCahierIds:u.entreesCahierIds??[]})),l=mp(a);return(await Tt(_e(X,Zi),{...t,profId:e,seances:a,evaluationsPrevues:l,statut:t.statut??"brouillon",genereeParIA:t.genereeParIA??!1,competences:t.competences??[],createdAt:n,updatedAt:n})).id}async function iJ(e,t){const n={...t,updatedAt:Oe.now()};t.seances&&(n.evaluationsPrevues=mp(t.seances)),await Qe(Ne(X,Zi,e),n)}async function sJ(e,t){await Qe(Ne(X,Zi,e),{statut:t,updatedAt:Oe.now()})}async function aP(e){await en(Ne(X,Zi,e))}async function lJ(e,t){const n=await Jc(e);if(!n)throw new Error(`Squence ${e} introuvable`);const a=Oe.now(),l=n.seances.map(u=>({...u,id:nP(),exporterVersCahier:!0,entreesCahierIds:[],datePrevue:void 0}));return(await Tt(_e(X,Zi),{titre:`[Copie] ${n.titre}`,description:n.description,niveau:n.niveau,matiere:n.matiere,theme:n.theme,competences:n.competences,objectifGeneral:n.objectifGeneral,prerequis:n.prerequis,nombreSeances:n.nombreSeances,dureeSeanceMinutes:n.dureeSeanceMinutes,trimestre:n.trimestre,seances:l,evaluationsPrevues:mp(l),genereeParIA:n.genereeParIA,profId:t,statut:"brouillon",groupeClasseId:void 0,groupeClasseNom:void 0,cahierDeTextesId:void 0,cahierDeTextesNom:void 0,createdAt:a,updatedAt:a})).id}async function oJ(e){const{sequenceId:t,cahierDeTextesId:n,profId:a,datesParSeance:l}=e,o=await Jc(t);if(!o)throw new Error(`Squence ${t} introuvable`);const u=Oe.now(),d=[],f=[],p=Object.keys(l),h=[...o.seances];for(const v of p){const b=h.findIndex(N=>N.id===v);if(b===-1){f.push(v);continue}const x=h[b],j=l[v];try{const N={cahierId:n,profId:a,date:j,chapitre:x.titre,typeContenu:"cours",contenu:x.contenu,objectifs:x.objectifSpecifique,statut:"planifie",notesPrivees:x.ressources.length>0?`Ressources : ${x.ressources.join(" | ")}`:void 0,isMarqueEvaluation:!1,ordre:b,liens:[],ebooksLies:[],piecesJointes:[]},S=await Tt(_e(X,rJ),{...N,createdAt:u,updatedAt:u});d.push(S.id),h[b]={...x,exporterVersCahier:!1,entreesCahierIds:[...x.entreesCahierIds??[],S.id]}}catch(N){console.error(`[exporterVersCahier] Erreur sance ${v}:`,N),f.push(v)}}return d.length>0&&await Qe(Ne(X,Zi,t),{seances:h,evaluationsPrevues:mp(h),cahierDeTextesId:n,cahierDeTextesNom:o.cahierDeTextesNom??"",exporteAt:u,updatedAt:u}),{nbExportees:d.length,idsEntrees:d,erreurs:f}}function cJ(e,t){return e.filter(n=>{if(t.matiere&&n.matiere!==t.matiere||t.niveau&&n.niveau!==t.niveau||t.statut&&n.statut!==t.statut||t.groupeClasseId&&n.groupeClasseId!==t.groupeClasseId)return!1;if(t.recherche){const a=t.recherche.toLowerCase();if(!(n.titre.toLowerCase().includes(a)||n.matiere.toLowerCase().includes(a)||n.theme.toLowerCase().includes(a)||n.description.toLowerCase().includes(a)))return!1}return!0})}const df={cours:"Cours",td:"TD",tp:"TP",evaluation:"valuation",revision:"Rvision",projet:"Projet",correction:"Correction"},xj={formative:"Formative",sommative:"Sommative",diagnostique:"Diagnostique",devoir:"Devoir sur table",composition:"Composition (BFEM/BAC)",interrogation:"Interrogation"},fp={brouillon:{label:"Brouillon",couleur:"#6b7280"},active:{label:"En cours",couleur:"#2563eb"},terminee:{label:"Termine",couleur:"#16a34a"},archivee:{label:"Archive",couleur:"#9ca3af"}},uJ=[{valeur:"6eme",label:"6me"},{valeur:"5eme",label:"5me"},{valeur:"4eme",label:"4me"},{valeur:"3eme",label:"3me (BFEM)"},{valeur:"2nde",label:"2nde"},{valeur:"1ere",label:"1re"},{valeur:"terminale",label:"Terminale (BAC)"}],mf=[30,45,55,60,90,120],dJ=({statut:e})=>{const{label:t}=fp[e];return r.jsxs("span",{className:`statut-badge statut-badge--${e}`,children:[r.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:"currentColor",display:"inline-block"}}),t]})},mJ=({sequence:e,onView:t,onEdit:n,onDuplicate:a,onDelete:l})=>{const o=e.seances.filter(u=>u.estEvaluation).length;return r.jsxs("article",{className:"sequence-card",onClick:t,role:"button",tabIndex:0,onKeyDown:u=>u.key==="Enter"&&t(),children:[r.jsxs("div",{className:"sequence-card__badges",children:[r.jsx(dJ,{statut:e.statut}),e.genereeParIA&&r.jsx("span",{className:"badge-ia",children:" IA"})]}),r.jsx("h3",{className:"sequence-card__title",children:e.titre}),r.jsxs("div",{className:"sequence-card__meta",children:[r.jsx("span",{className:"sequence-card__meta-chip",children:e.matiere}),r.jsx("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:e.niveau}),e.trimestre&&r.jsxs("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:["T",e.trimestre]})]}),e.description&&r.jsx("p",{className:"sequence-card__desc",children:e.description}),r.jsxs("div",{className:"sequence-card__footer",children:[r.jsxs("span",{className:"sequence-card__seances-count",children:[" ",e.seances.length," sance",e.seances.length>1?"s":"",o>0&&`   ${o} val.`]}),e.groupeClasseNom&&r.jsxs("span",{className:"sequence-card__groupe",children:[" ",e.groupeClasseNom]})]}),r.jsxs("div",{className:"sequence-card__actions",onClick:u=>u.stopPropagation(),children:[r.jsx("button",{className:"sequence-card__action-btn",onClick:n,title:"Modifier","aria-label":"Modifier la squence",children:""}),r.jsx("button",{className:"sequence-card__action-btn",onClick:a,title:"Dupliquer","aria-label":"Dupliquer la squence",children:""}),r.jsx("button",{className:"sequence-card__action-btn sequence-card__action-btn--danger",onClick:l,title:"Supprimer","aria-label":"Supprimer la squence",children:""})]})]})},fJ=()=>{const e=st(),{currentUser:t}=rt(),{matieres:n}=fo(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,f]=g.useState(null),[p,h]=g.useState(null),[v,b]=g.useState({matiere:"",niveau:"",statut:"",recherche:""}),x=g.useCallback(async()=>{if(t?.uid){u(!0),f(null);try{const w=await nJ(t.uid);l(w)}catch(w){console.error("[SequencesPage] Chargement:",w),f("Impossible de charger vos squences. Vrifiez votre connexion.")}finally{u(!1)}}},[t?.uid]);if(g.useEffect(()=>{x()},[x]),!t?.isPremium&&t?.role!=="admin")return r.jsxs("div",{className:"premium-gate",children:[r.jsx("span",{className:"premium-gate__icon",children:""}),r.jsx("h2",{className:"premium-gate__title",children:"Fonctionnalit Premium"}),r.jsx("p",{className:"premium-gate__text",children:"Le Gnrateur de Squences Pdagogiques est rserv aux enseignants Premium. Passez  Premium pour crer des squences structures et les exporter vers votre Cahier de Textes."}),r.jsx("button",{className:"btn-primary",onClick:()=>e("/prof/premium"),children:" Passer  Premium  2 000 FCFA/mois"})]});const j=cJ(a,v),N=n.length>0?n.map(w=>w.valeur):[...new Set(a.map(w=>w.matiere))].sort(),S=async w=>{if(window.confirm(`Supprimer la squence "${w.titre}" ?

Cette action est irrversible.`)){h(w.id);try{await aP(w.id),l(k=>k.filter(O=>O.id!==w.id))}catch(k){console.error("[SequencesPage] Suppression:",k),f("Erreur lors de la suppression. Ressayez.")}finally{h(null)}}},C=async w=>{if(t?.uid){h(w.id);try{const z=await lJ(w.id,t.uid);e(`/prof/sequences/${z}/modifier`)}catch(z){console.error("[SequencesPage] Duplication:",z),f("Erreur lors de la duplication. Ressayez."),h(null)}}},E={total:a.length,active:a.filter(w=>w.statut==="active").length,terminee:a.filter(w=>w.statut==="terminee").length,ia:a.filter(w=>w.genereeParIA).length};return r.jsxs("div",{className:"sequences-page",children:[r.jsxs("div",{className:"sequences-page__header",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"sequences-page__title",children:" Squences Pdagogiques"}),r.jsxs("p",{className:"sequences-page__subtitle",children:[E.total," squence",E.total>1?"s":"",E.active>0&&`  ${E.active} en cours`,E.ia>0&&`  ${E.ia} assiste${E.ia>1?"s":""} par IA`]})]}),r.jsx("button",{className:"sequences-page__btn-new",onClick:()=>e("/prof/sequences/nouvelle"),children:"+ Nouvelle squence"})]}),d&&r.jsxs("div",{className:"error-banner",role:"alert",children:[" ",d,r.jsx("button",{onClick:x,style:{marginLeft:"auto",background:"none",border:"none",cursor:"pointer",color:"#dc2626",fontWeight:600},children:"Ressayer"})]}),r.jsxs("div",{className:"sequences-filters",role:"search",children:[r.jsx("input",{type:"search",className:"sequences-filters__search",placeholder:" Rechercher une squence...",value:v.recherche??"",onChange:w=>b(z=>({...z,recherche:w.target.value})),"aria-label":"Rechercher une squence"}),r.jsxs("select",{className:"sequences-filters__select",value:v.matiere??"",onChange:w=>b(z=>({...z,matiere:w.target.value})),"aria-label":"Filtrer par matire",children:[r.jsx("option",{value:"",children:"Toutes les matires"}),N.map(w=>r.jsx("option",{value:w,children:w},w))]}),r.jsxs("select",{className:"sequences-filters__select",value:v.niveau??"",onChange:w=>b(z=>({...z,niveau:w.target.value})),"aria-label":"Filtrer par niveau",children:[r.jsx("option",{value:"",children:"Tous les niveaux"}),Js.map(w=>r.jsx("option",{value:w,children:w},w))]}),r.jsxs("select",{className:"sequences-filters__select",value:v.statut??"",onChange:w=>b(z=>({...z,statut:w.target.value})),"aria-label":"Filtrer par statut",children:[r.jsx("option",{value:"",children:"Tous les statuts"}),Object.entries(fp).map(([w,{label:z}])=>r.jsx("option",{value:w,children:z},w))]})]}),o?r.jsx("div",{className:"sequences-grid",children:[1,2,3].map(w=>r.jsxs("div",{className:"sequence-card",style:{minHeight:180},children:[r.jsx("div",{className:"skeleton",style:{height:20,width:"40%",marginBottom:10}}),r.jsx("div",{className:"skeleton",style:{height:22,width:"80%",marginBottom:8}}),r.jsx("div",{className:"skeleton",style:{height:14,width:"60%"}})]},w))}):r.jsx("div",{className:"sequences-grid",role:"list",children:j.length===0?r.jsxs("div",{className:"sequences-empty",children:[r.jsx("span",{className:"sequences-empty__icon",children:""}),r.jsx("p",{className:"sequences-empty__text",children:a.length===0?"Aucune squence pour l'instant":"Aucune squence ne correspond  vos filtres"}),r.jsx("p",{className:"sequences-empty__hint",children:a.length===0?'Cliquez sur "+ Nouvelle squence" pour commencer':"Modifiez ou effacez les filtres pour voir plus de rsultats"})]}):j.map(w=>r.jsx("div",{role:"listitem",style:{opacity:p===w.id?.6:1},children:r.jsx(mJ,{sequence:w,onView:()=>e(`/prof/sequences/${w.id}`),onEdit:()=>e(`/prof/sequences/${w.id}/modifier`),onDuplicate:()=>C(w),onDelete:()=>S(w)})},w.id))})]})},pJ="https://votre-app.railway.app",hJ=["cours","td","tp","evaluation","revision","projet","correction"],vJ=["formative","sommative","diagnostique","devoir","composition","interrogation"];function gJ(e){return hJ.includes(e)?e:"cours"}function xJ(e){if(e)return vJ.includes(e)?e:"formative"}function bJ(e){if(!e||typeof e!="object")throw new Error("Rponse IA invalide : non-objet");if(!Array.isArray(e.seances)||e.seances.length===0)throw new Error("Rponse IA invalide : tableau seances absent ou vide");const t=e.seances.map((n,a)=>({numero:Number(n.numero)||a+1,titre:String(n.titre??`Sance ${a+1}`),dureeMinutes:Number(n.dureeMinutes)||55,objectifSpecifique:String(n.objectifSpecifique??""),contenu:String(n.contenu??""),ressources:Array.isArray(n.ressources)?n.ressources.map(String):[],typeActivite:gJ(String(n.typeActivite??"cours")),estEvaluation:!!n.estEvaluation,typeEvaluation:xJ(n.typeEvaluation),noteMax:typeof n.noteMax=="number"?n.noteMax:void 0,coefficient:typeof n.coefficient=="number"?n.coefficient:void 0}));return{titre:String(e.titre??""),description:String(e.description??""),objectifGeneral:String(e.objectifGeneral??""),prerequis:String(e.prerequis??""),competences:Array.isArray(e.competences)?e.competences.map(String):[],seances:t}}function yJ(){return`Tu es un expert en ingnierie pdagogique pour le systme ducatif sngalais 
(programme du Ministre de l'ducation Nationale du Sngal).

Tu gnres des squences pdagogiques structures pour des professeurs du secondaire 
(collges et lyces sngalais, niveaux 6me  Terminale).

RPONDRE UNIQUEMENT EN JSON valide. Aucun texte avant ou aprs le JSON.
Aucune balise markdown, aucun \`\`\`json.

Structure JSON attendue :
{
  "titre": "string",
  "description": "string (2-3 phrases contextuelles)",
  "objectifGeneral": "string (formulation en termes de comptences, verbes d'action)",
  "prerequis": "string (connaissances ncessaires avant cette squence)",
  "competences": ["string", "string", ...],
  "seances": [
    {
      "numero": 1,
      "titre": "string",
      "dureeMinutes": 55,
      "objectifSpecifique": "string (verbe d'action + contenu)",
      "contenu": "string (droulement dtaill de la sance)",
      "ressources": ["string", ...],
      "typeActivite": "cours|td|tp|evaluation|revision|projet|correction",
      "estEvaluation": false,
      "typeEvaluation": null,
      "noteMax": null,
      "coefficient": null
    }
  ]
}

Rgles :
- Respecte les programmes officiels sngalais
- Les trimestres au Sngal : 1er (Oct-Dc), 2me (Jan-Mars), 3me (Avr-Juin)
- Inclure des sances de rvision avant les valuations
- Pour les valuations (estEvaluation=true), prciser typeEvaluation
- Les contenus doivent tre adapts aux ralits sngalaises (exemples locaux)
- Note maximale habituelle : 20 (systme franais)
- Niveaux  fort enjeu : 3me (BFEM), Terminale (BAC)
- Langue : franais`}async function jJ(e){const t=`
Gnre une squence pdagogique complte pour :
- Matire : ${e.matiere}
- Niveau : ${e.niveau}
- Thme/Chapitre : ${e.theme}
- Nombre de sances : ${e.nombreSeances}
- Dure par sance : ${e.dureeSeanceMinutes} minutes
${e.trimestre?`- Trimestre : ${e.trimestre}me trimestre`:""}
${e.instructionsSupplementaires?`- Instructions supplmentaires : ${e.instructionsSupplementaires}`:""}

Distribue intelligemment les sances : cours  TD/TP  rvision  valuation.
Assure-toi que les objectifs spcifiques sont progressifs et mesurables.
  `.trim();let n;try{n=await fetch(`${pJ}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({systemPrompt:yJ(),userPrompt:t,maxTokens:4e3})})}catch{throw new Error("Impossible de contacter le serveur IA. Vrifiez votre connexion Internet.")}if(!n.ok){const d=await n.text().catch(()=>"Erreur inconnue");throw new Error(`Erreur serveur IA (${n.status}) : ${d}`)}const a=await n.json(),l=a.content??a.result??a.text??"";if(!l)throw new Error("Rponse IA vide  le serveur a renvoy un contenu vide.");const o=l.replace(/^```json\s*/i,"").replace(/^```\s*/,"").replace(/```\s*$/,"").trim();let u;try{u=JSON.parse(o)}catch{throw new Error(`Rponse IA non parsable : ${o.substring(0,200)}...`)}return bJ(u)}function iP(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function NJ(e){return{id:iP(),numero:e,titre:"",dureeMinutes:55,objectifSpecifique:"",contenu:"",ressources:[],typeActivite:"cours",estEvaluation:!1,exporterVersCahier:!0,entreesCahierIds:[]}}const _J=({seance:e,onChange:t,onDelete:n,onMoveUp:a,onMoveDown:l,isFirst:o,isLast:u})=>{const[d,f]=g.useState(e.titre===""),[p,h]=g.useState(""),v=j=>t({...e,...j}),b=()=>{const j=p.trim();j&&(v({ressources:[...e.ressources,j]}),h(""))},x=j=>v({ressources:e.ressources.filter((N,S)=>S!==j)});return r.jsxs("div",{className:"seance-card",children:[r.jsxs("div",{className:"seance-card__header",onClick:()=>f(j=>!j),children:[r.jsx("div",{className:`seance-card__numero${e.estEvaluation?" seance-card__numero--eval":""}`,children:e.numero}),r.jsx("span",{className:"seance-card__header-title",children:e.titre||`Sance ${e.numero} (sans titre)`}),r.jsxs("div",{className:"seance-card__header-badges",children:[r.jsx("span",{className:`type-activite-badge type-activite-badge--${e.typeActivite}`,children:df[e.typeActivite]}),r.jsxs("span",{style:{fontSize:"0.75rem",color:"#64748b"},children:[e.dureeMinutes,"min"]})]}),r.jsx("span",{className:`seance-card__toggle-icon${d?" seance-card__toggle-icon--open":""}`,children:""})]}),d&&r.jsxs("div",{className:"seance-card__body",children:[r.jsxs("div",{className:"editor-form-grid",children:[r.jsxs("div",{className:"form-group editor-form-grid--full",children:[r.jsxs("label",{children:["Titre de la sance ",r.jsx("span",{className:"required",children:"*"})]}),r.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Introduction aux vecteurs",value:e.titre,onChange:j=>v({titre:j.target.value})})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Type d'activit"}),r.jsx("select",{className:"form-control",value:e.typeActivite,onChange:j=>v({typeActivite:j.target.value,estEvaluation:j.target.value==="evaluation"?!0:e.estEvaluation}),children:Object.entries(df).map(([j,N])=>r.jsx("option",{value:j,children:N},j))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Dure (minutes)"}),r.jsxs("select",{className:"form-control",value:e.dureeMinutes,onChange:j=>v({dureeMinutes:Number(j.target.value)}),children:[mf.map(j=>r.jsxs("option",{value:j,children:[j," min"]},j)),r.jsx("option",{value:e.dureeMinutes,children:mf.includes(e.dureeMinutes)?null:`${e.dureeMinutes} min (personnalis)`})]})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Objectif spcifique"}),r.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Ex : L'lve sera capable de calculer le module d'un vecteur",value:e.objectifSpecifique,onChange:j=>v({objectifSpecifique:j.target.value}),rows:2})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Contenu / Droulement"}),r.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Dcrivez le droulement de la sance : activits, tapes, mthodes...",value:e.contenu,onChange:j=>v({contenu:j.target.value}),rows:4})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Supports / Ressources"}),e.ressources.length>0&&r.jsx("div",{className:"timeline-card__ressources",style:{marginBottom:6},children:e.ressources.map((j,N)=>r.jsxs("span",{className:"ressource-chip",style:{cursor:"pointer"},onClick:()=>x(N),title:"Cliquer pour supprimer",children:[j," "]},N))}),r.jsxs("div",{className:"competence-input-row",children:[r.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Manuel p.42, GeoGebra, Calculatrice...",value:p,onChange:j=>h(j.target.value),onKeyDown:j=>j.key==="Enter"&&(j.preventDefault(),b())}),r.jsx("button",{type:"button",className:"btn-add-competence",onClick:b,children:"+ Ajouter"})]})]}),r.jsx("div",{className:"form-group",children:r.jsxs("label",{style:{flexDirection:"row",alignItems:"center",display:"flex",gap:8},children:[r.jsx("input",{type:"checkbox",checked:e.estEvaluation,onChange:j=>v({estEvaluation:j.target.checked,typeEvaluation:j.target.checked?e.typeEvaluation??"formative":void 0}),style:{width:16,height:16,accentColor:"#2563eb"}}),"Cette sance est une valuation"]})}),e.estEvaluation&&r.jsxs("div",{className:"editor-form-grid",style:{background:"#fef2f2",padding:12,borderRadius:8,border:"1px solid #fecaca"},children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Type d'valuation"}),r.jsx("select",{className:"form-control",value:e.typeEvaluation??"formative",onChange:j=>v({typeEvaluation:j.target.value}),children:Object.entries(xj).map(([j,N])=>r.jsx("option",{value:j,children:N},j))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Note maximale"}),r.jsx("input",{type:"number",className:"form-control",min:1,max:100,value:e.noteMax??20,onChange:j=>v({noteMax:Number(j.target.value)})})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Coefficient"}),r.jsx("input",{type:"number",className:"form-control",min:1,max:10,step:.5,value:e.coefficient??1,onChange:j=>v({coefficient:Number(j.target.value)})})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{style:{flexDirection:"row",alignItems:"center",display:"flex",gap:8},children:[r.jsx("input",{type:"checkbox",checked:e.exporterVersCahier,onChange:j=>v({exporterVersCahier:j.target.checked}),style:{width:16,height:16,accentColor:"#2563eb"}}),"Inclure dans l'export vers le Cahier de Textes"]}),e.entreesCahierIds&&e.entreesCahierIds.length>0&&r.jsxs("span",{className:"export-seance-row__exported",style:{marginTop:4},children:[" Dj exporte (",e.entreesCahierIds.length," entre",e.entreesCahierIds.length>1?"s":"",")"]})]}),r.jsxs("div",{className:"seance-card__actions",children:[r.jsx("button",{type:"button",className:"btn-seance-action btn-secondary",onClick:a,disabled:o,title:"Monter",children:""}),r.jsx("button",{type:"button",className:"btn-seance-action btn-secondary",onClick:l,disabled:u,title:"Descendre",children:""}),r.jsx("button",{type:"button",className:"btn-seance-action btn-seance-action--delete",onClick:n,children:" Supprimer cette sance"})]})]})]})},SJ=({onSequenceGeneree:e,defaultMatiere:t,defaultNiveau:n,matieres:a})=>{const[l,o]=g.useState(t??""),[u,d]=g.useState(n??""),[f,p]=g.useState(""),[h,v]=g.useState(8),[b,x]=g.useState(55),[j,N]=g.useState(1),[S,C]=g.useState(""),[E,w]=g.useState(!1),[z,k]=g.useState({type:"idle",message:""}),O=async()=>{if(!l||!u||!f){k({type:"error",message:"Veuillez remplir la matire, le niveau et le thme."});return}w(!0),k({type:"loading",message:"L'IA gnre votre squence... (30-45 secondes)"});try{const P=await jJ({matiere:l,niveau:u,theme:f,nombreSeances:h,dureeSeanceMinutes:b,trimestre:j,instructionsSupplementaires:S||void 0}),D=P.seances.map(L=>({...L,ressources:L.ressources??[]}));e({titre:P.titre,description:P.description,objectifGeneral:P.objectifGeneral,prerequis:P.prerequis,competences:P.competences,seances:D}),k({type:"success",message:` Squence gnre avec ${D.length} sances ! Vrifiez et compltez les informations.`})}catch(P){const D=P instanceof Error?P.message:"Erreur inconnue";k({type:"error",message:`Erreur IA : ${D}`})}finally{w(!1)}};return r.jsxs("div",{className:"ia-panel",children:[r.jsx("h3",{className:"ia-panel__title",children:" Gnration assiste par IA"}),r.jsx("p",{className:"ia-panel__subtitle",children:"Dcrivez votre squence et Claude gnre la structure complte"}),r.jsxs("div",{className:"ia-panel__form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Matire ",r.jsx("span",{className:"required",children:"*"})]}),r.jsxs("select",{className:"form-control",value:l,onChange:P=>o(P.target.value),children:[r.jsx("option",{value:"",children:"Slectionner..."}),a.map(P=>r.jsx("option",{value:P,children:P},P))]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Niveau ",r.jsx("span",{className:"required",children:"*"})]}),r.jsxs("select",{className:"form-control",value:u,onChange:P=>d(P.target.value),children:[r.jsx("option",{value:"",children:"Slectionner..."}),Js.map(P=>r.jsx("option",{value:P,children:P},P))]})]}),r.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[r.jsxs("label",{children:["Thme / Chapitre ",r.jsx("span",{className:"required",children:"*"})]}),r.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Les fonctions affines, La photosynthse, La Rvolution franaise...",value:f,onChange:P=>p(P.target.value)})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Nombre de sances"}),r.jsx("input",{type:"number",className:"form-control",min:2,max:25,value:h,onChange:P=>v(Number(P.target.value))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Dure par sance"}),r.jsx("select",{className:"form-control",value:b,onChange:P=>x(Number(P.target.value)),children:mf.map(P=>r.jsxs("option",{value:P,children:[P," min"]},P))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Trimestre"}),r.jsxs("select",{className:"form-control",value:j,onChange:P=>N(Number(P.target.value)),children:[r.jsx("option",{value:1,children:"1er trimestre (OctDc)"}),r.jsx("option",{value:2,children:"2me trimestre (JanMars)"}),r.jsx("option",{value:3,children:"3me trimestre (AvrJuin)"})]})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Instructions supplmentaires (optionnel)"}),r.jsx("textarea",{className:"ia-panel__instructions",placeholder:"Ex : Insister sur la rsolution graphique, Inclure un TP sur GeoGebra, Prvoir une sance de remdiation...",value:S,onChange:P=>C(P.target.value),rows:2})]}),r.jsxs("button",{type:"button",className:"ia-panel__btn-generate",onClick:O,disabled:E,children:[E?r.jsx("span",{className:"spinner"}):"",E?"Gnration en cours...":"Gnrer avec l'IA"]}),z.type!=="idle"&&r.jsxs("div",{className:`ia-panel__status ia-panel__status--${z.type}`,children:[z.type==="loading"&&r.jsx("span",{className:"spinner spinner--blue"}),z.message]})]})},WE=()=>{const e=st(),{id:t}=Wn(),{currentUser:n}=rt(),{matieres:a}=fo(),l=!!t,[o,u]=g.useState({titre:"",description:"",niveau:"",matiere:"",theme:"",competences:[],objectifGeneral:"",prerequis:"",nombreSeances:6,dureeSeanceMinutes:55,seances:[],evaluationsPrevues:[],statut:"brouillon",genereeParIA:!1,trimestre:void 0,groupeClasseId:void 0,groupeClasseNom:void 0,cahierDeTextesId:void 0,cahierDeTextesNom:void 0}),[d,f]=g.useState([]),[p,h]=g.useState([]),[v,b]=g.useState([]),[x,j]=g.useState(l),[N,S]=g.useState(!1),[C,E]=g.useState(null),[w,z]=g.useState(null),[k,O]=g.useState(""),[P,D]=g.useState(!l);g.useEffect(()=>{(async()=>{if(!n?.uid)return;const[K,I]=await Promise.all([QM(n.uid).catch(()=>[]),KM(n.uid).catch(()=>[])]);if(h(K),b(I),l&&t){j(!0);try{const te=await Jc(t);if(!te){E("Squence introuvable.");return}if(te.profId!==n.uid){E("Accs non autoris.");return}u({titre:te.titre,description:te.description,niveau:te.niveau,matiere:te.matiere,theme:te.theme,competences:te.competences,objectifGeneral:te.objectifGeneral,prerequis:te.prerequis,nombreSeances:te.nombreSeances,dureeSeanceMinutes:te.dureeSeanceMinutes,statut:te.statut,genereeParIA:te.genereeParIA,trimestre:te.trimestre,groupeClasseId:te.groupeClasseId,groupeClasseNom:te.groupeClasseNom,cahierDeTextesId:te.cahierDeTextesId,cahierDeTextesNom:te.cahierDeTextesNom}),f(te.seances)}catch{E("Erreur de chargement. Ressayez.")}finally{j(!1)}}})()},[n?.uid,t,l]);const L=()=>{f(R=>[...R,NJ(R.length+1)])},U=(R,K)=>{f(I=>I.map((te,Y)=>Y===R?K:te))},$=R=>{f(K=>K.filter((I,te)=>te!==R).map((I,te)=>({...I,numero:te+1})))},B=R=>{R!==0&&f(K=>{const I=[...K];return[I[R-1],I[R]]=[I[R],I[R-1]],I.map((te,Y)=>({...te,numero:Y+1}))})},re=R=>{f(K=>{if(R===K.length-1)return K;const I=[...K];return[I[R],I[R+1]]=[I[R+1],I[R]],I.map((te,Y)=>({...te,numero:Y+1}))})},se=()=>{const R=k.trim();R&&(u(K=>({...K,competences:[...K.competences??[],R]})),O(""))},M=R=>{u(K=>({...K,competences:(K.competences??[]).filter((I,te)=>te!==R)}))},q=R=>{u(I=>({...I,titre:R.titre,description:R.description,objectifGeneral:R.objectifGeneral,prerequis:R.prerequis,competences:R.competences,genereeParIA:!0}));const K=R.seances.map(I=>({...I,id:iP(),exporterVersCahier:!0,entreesCahierIds:[]}));f(K),D(!1),window.scrollTo({top:0,behavior:"smooth"})},F=async()=>{if(!n?.uid)return;if(!o.titre?.trim()){E("Le titre est obligatoire.");return}if(!o.matiere?.trim()){E("La matire est obligatoire.");return}if(!o.niveau?.trim()){E("Le niveau est obligatoire.");return}const R=d.find(Y=>!Y.titre.trim());if(R){E(`La sance n${R.numero} n'a pas de titre.`);return}S(!0),E(null);const K=v.find(Y=>Y.id===o.groupeClasseId),I=p.find(Y=>Y.id===o.cahierDeTextesId),te={titre:o.titre.trim(),description:o.description?.trim()??"",niveau:o.niveau,matiere:o.matiere.trim(),theme:o.theme?.trim()??"",competences:o.competences??[],objectifGeneral:o.objectifGeneral?.trim()??"",prerequis:o.prerequis?.trim()??"",nombreSeances:d.length,dureeSeanceMinutes:o.dureeSeanceMinutes??55,statut:o.statut??"brouillon",genereeParIA:o.genereeParIA??!1,trimestre:o.trimestre??null,seances:d,evaluationsPrevues:[],groupeClasseId:o.groupeClasseId||null,groupeClasseNom:K?.nom||o.groupeClasseNom||null,cahierDeTextesId:o.cahierDeTextesId||null,cahierDeTextesNom:I?.titre||o.cahierDeTextesNom||null};try{if(l&&t)await iJ(t,te),z("Squence mise  jour avec succs !"),setTimeout(()=>e(`/prof/sequences/${t}`),1200);else{const Y=await aJ(n.uid,te);z("Squence cre avec succs !"),setTimeout(()=>e(`/prof/sequences/${Y}`),1200)}}catch(Y){console.error("[SequenceEditorPage] Sauvegarde:",Y),E("Erreur lors de la sauvegarde. Ressayez.")}finally{S(!1)}};return x?r.jsxs("div",{className:"sequence-editor",children:[r.jsx("div",{className:"skeleton",style:{height:30,width:"50%",marginBottom:20}}),r.jsx("div",{className:"skeleton",style:{height:200,borderRadius:12}})]}):r.jsxs("div",{className:"sequence-editor",children:[r.jsxs("div",{className:"sequence-editor__header",children:[r.jsxs("p",{className:"sequence-editor__breadcrumb",children:[r.jsx("a",{onClick:()=>e("/prof/sequences"),style:{cursor:"pointer"},children:" Squences"})," / ",l?"Modifier":"Nouvelle squence"]}),r.jsx("h1",{className:"sequence-editor__title",children:l?" Modifier la squence":" Nouvelle squence"})]}),C&&r.jsxs("div",{className:"error-banner",role:"alert",children:[" ",C]}),w&&r.jsxs("div",{className:"success-banner",role:"status",children:[" ",w]}),r.jsx("div",{style:{marginBottom:8},children:r.jsx("button",{type:"button",className:"btn-secondary",style:{marginBottom:12},onClick:()=>D(R=>!R),children:P?" Masquer":" Gnrer avec l'IA"})}),P&&r.jsx(SJ,{onSequenceGeneree:q,defaultMatiere:o.matiere,defaultNiveau:o.niveau,matieres:a.map(R=>R.valeur)}),r.jsxs("section",{className:"editor-section",children:[r.jsx("h2",{className:"editor-section__title",children:" Informations gnrales"}),r.jsxs("div",{className:"editor-form-grid",children:[r.jsxs("div",{className:"form-group editor-form-grid--full",children:[r.jsxs("label",{children:["Titre de la squence ",r.jsx("span",{className:"required",children:"*"})]}),r.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Les fonctions affines  Terminale S",value:o.titre??"",onChange:R=>u(K=>({...K,titre:R.target.value})),required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Matire ",r.jsx("span",{className:"required",children:"*"})]}),r.jsxs("select",{className:"form-control",value:o.matiere??"",onChange:R=>u(K=>({...K,matiere:R.target.value})),children:[r.jsx("option",{value:"",children:"Slectionner..."}),a.map(R=>r.jsx("option",{value:R.valeur,children:R.label},R.valeur))]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{children:["Niveau ",r.jsx("span",{className:"required",children:"*"})]}),r.jsxs("select",{className:"form-control",value:o.niveau??"",onChange:R=>u(K=>({...K,niveau:R.target.value})),children:[r.jsx("option",{value:"",children:"Slectionner..."}),Js.map(R=>r.jsx("option",{value:R,children:R},R))]})]}),r.jsxs("div",{className:"form-group editor-form-grid--full",children:[r.jsx("label",{children:"Thme / Chapitre du programme"}),r.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Chapitre 4  Les vecteurs du plan",value:o.theme??"",onChange:R=>u(K=>({...K,theme:R.target.value}))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Trimestre"}),r.jsxs("select",{className:"form-control",value:o.trimestre??"",onChange:R=>u(K=>({...K,trimestre:R.target.value?Number(R.target.value):void 0})),children:[r.jsx("option",{value:"",children:"Non prcis"}),r.jsx("option",{value:"1",children:"1er trimestre (OctDc)"}),r.jsx("option",{value:"2",children:"2me trimestre (JanMars)"}),r.jsx("option",{value:"3",children:"3me trimestre (AvrJuin)"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Dure standard d'une sance"}),r.jsx("select",{className:"form-control",value:o.dureeSeanceMinutes??55,onChange:R=>u(K=>({...K,dureeSeanceMinutes:Number(R.target.value)})),children:mf.map(R=>r.jsxs("option",{value:R,children:[R," minutes"]},R))})]}),r.jsxs("div",{className:"form-group editor-form-grid--full",children:[r.jsx("label",{children:"Description / Contexte"}),r.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Contexte de la squence dans le programme, niveau de la classe, prrequis globaux...",value:o.description??"",onChange:R=>u(K=>({...K,description:R.target.value})),rows:3})]}),r.jsxs("div",{className:"form-group editor-form-grid--full",children:[r.jsx("label",{children:"Objectif gnral"}),r.jsx("textarea",{className:"form-control form-control--textarea",placeholder:" la fin de cette squence, les lves seront capables de...",value:o.objectifGeneral??"",onChange:R=>u(K=>({...K,objectifGeneral:R.target.value})),rows:2})]}),r.jsxs("div",{className:"form-group editor-form-grid--full",children:[r.jsx("label",{children:"Prrequis"}),r.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Connaissances ncessaires avant cette squence...",value:o.prerequis??"",onChange:R=>u(K=>({...K,prerequis:R.target.value})),rows:2})]})]}),r.jsxs("div",{className:"form-group",style:{marginTop:14},children:[r.jsx("label",{children:"Comptences vises"}),r.jsx("div",{className:"competences-list",children:(o.competences??[]).map((R,K)=>r.jsxs("span",{className:"competence-tag",children:[R,r.jsx("button",{type:"button",className:"competence-tag__remove",onClick:()=>M(K),"aria-label":"Supprimer la comptence",children:""})]},K))}),r.jsxs("div",{className:"competence-input-row",children:[r.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Rsoudre une quation du second degr",value:k,onChange:R=>O(R.target.value),onKeyDown:R=>R.key==="Enter"&&(R.preventDefault(),se())}),r.jsx("button",{type:"button",className:"btn-add-competence",onClick:se,children:"+ Ajouter"})]})]})]}),r.jsxs("section",{className:"editor-section",children:[r.jsx("h2",{className:"editor-section__title",children:" Liens optionnels"}),r.jsxs("div",{className:"editor-form-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Groupe-classe"}),r.jsxs("select",{className:"form-control",value:o.groupeClasseId??"",onChange:R=>u(K=>({...K,groupeClasseId:R.target.value||void 0})),children:[r.jsx("option",{value:"",children:"Aucun groupe"}),v.map(R=>r.jsxs("option",{value:R.id,children:[R.nom,"  ",R.classe]},R.id))]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Cahier de Textes"}),r.jsxs("select",{className:"form-control",value:o.cahierDeTextesId??"",onChange:R=>u(K=>({...K,cahierDeTextesId:R.target.value||void 0})),children:[r.jsx("option",{value:"",children:" Aucun cahier "}),p.filter(R=>o.matiere&&o.niveau?R.matiere===o.matiere&&R.classe===o.niveau:o.matiere?R.matiere===o.matiere:o.niveau?R.classe===o.niveau:!0).map(R=>r.jsxs("option",{value:R.id,children:[R.titre,"  ",R.classe,"  ",R.anneeScolaire]},R.id))]}),o.niveau&&o.matiere&&p.filter(R=>R.classe===o.niveau&&R.matiere===o.matiere).length===0&&r.jsxs("p",{style:{fontSize:"0.8rem",color:"#f59e0b",marginTop:6},children:[" Aucun cahier pour ",o.matiere,"  ",o.niveau,"."," ",r.jsx("a",{href:"/prof/cahiers",style:{color:"#2563eb",textDecoration:"underline"},children:"Crer un cahier"})]}),(!o.niveau||!o.matiere)&&p.length>0&&r.jsx("p",{style:{fontSize:"0.8rem",color:"#94a3b8",marginTop:6},children:" Slectionnez la matire et le niveau pour filtrer les cahiers."})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{children:"Statut"}),r.jsxs("select",{className:"form-control",value:o.statut??"brouillon",onChange:R=>u(K=>({...K,statut:R.target.value})),children:[r.jsx("option",{value:"brouillon",children:"Brouillon"}),r.jsx("option",{value:"active",children:"En cours"}),r.jsx("option",{value:"terminee",children:"Termine"}),r.jsx("option",{value:"archivee",children:"Archive"})]})]})]})]}),r.jsxs("section",{className:"editor-section",children:[r.jsxs("div",{className:"seances-editor__header",children:[r.jsx("h2",{className:"editor-section__title",style:{margin:0},children:" Sances"}),r.jsxs("span",{className:"seances-editor__count",children:[d.length," sance",d.length>1?"s":"",d.filter(R=>R.estEvaluation).length>0&&`  ${d.filter(R=>R.estEvaluation).length} val.`]})]}),r.jsx("div",{className:"seances-list",children:d.length===0?r.jsx("p",{style:{color:"#94a3b8",fontSize:"0.875rem",textAlign:"center",padding:"20px 0"},children:"Aucune sance. Utilisez le bouton ci-dessous ou gnrez avec l'IA."}):d.map((R,K)=>r.jsx(_J,{seance:R,onChange:I=>U(K,I),onDelete:()=>$(K),onMoveUp:()=>B(K),onMoveDown:()=>re(K),isFirst:K===0,isLast:K===d.length-1},R.id))}),r.jsx("button",{type:"button",className:"btn-add-seance",style:{marginTop:14},onClick:L,children:"+ Ajouter une sance"})]}),r.jsxs("div",{style:{position:"sticky",bottom:16,display:"flex",justifyContent:"flex-end",gap:10,background:"rgba(248,250,252,0.95)",backdropFilter:"blur(6px)",padding:"12px 0",zIndex:10},children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>e("/prof/sequences"),disabled:N,children:"Annuler"}),r.jsx("button",{type:"button",className:"btn-primary",onClick:F,disabled:N,children:N?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"spinner"})," Enregistrement..."]}):l?" Mettre  jour":" Crer la squence"})]})]})},wJ=({statut:e})=>{const{label:t}=fp[e];return r.jsxs("span",{className:`statut-badge statut-badge--${e}`,children:[r.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:"currentColor",display:"inline-block"}}),t]})},CJ=({sequence:e,cahiers:t,profId:n,onClose:a,onSuccess:l})=>{const[o,u]=g.useState(e.cahierDeTextesId??(t.length===1?t[0].id:"")),[d,f]=g.useState(()=>{const C=new Date().toISOString().split("T")[0],E={};return e.seances.forEach(w=>{E[w.id]=C}),E}),[p,h]=g.useState(()=>{const C={};return e.seances.forEach(E=>{C[E.id]=E.exporterVersCahier&&(!E.entreesCahierIds||E.entreesCahierIds.length===0)}),C}),[v,b]=g.useState(!1),[x,j]=g.useState(null),N=Object.values(p).filter(Boolean).length,S=async()=>{if(!o){j("Veuillez slectionner un Cahier de Textes.");return}if(N===0){j("Slectionnez au moins une sance  exporter.");return}b(!0),j(null);const C={};e.seances.filter(E=>p[E.id]).forEach(E=>{const w=d[E.id];if(w){const z=Oe.fromDate(new Date(w+"T08:00:00"));C[E.id]=z}});try{const E=await oJ({sequenceId:e.id,cahierDeTextesId:o,profId:n,datesParSeance:C});E.erreurs.length>0&&j(`${E.erreurs.length} sance(s) n'ont pas pu tre exportes.`),l(E.nbExportees)}catch(E){const w=E instanceof Error?E.message:"Erreur inconnue";j(`Erreur d'export : ${w}`)}finally{b(!1)}};return g.useEffect(()=>{const C=E=>{E.key==="Escape"&&a()};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[a]),r.jsx("div",{className:"export-modal__overlay",onClick:C=>C.target===C.currentTarget&&a(),children:r.jsxs("div",{className:"export-modal",role:"dialog","aria-modal":"true","aria-labelledby":"export-modal-title",children:[r.jsxs("div",{className:"export-modal__header",children:[r.jsx("h2",{className:"export-modal__title",id:"export-modal-title",children:" Exporter vers le Cahier de Textes"}),r.jsx("button",{className:"export-modal__close",onClick:a,"aria-label":"Fermer",children:""})]}),r.jsxs("div",{className:"export-modal__body",children:[r.jsxs("div",{className:"form-group",style:{marginBottom:16},children:[r.jsxs("label",{style:{fontWeight:600,marginBottom:6,display:"block"},children:["Cahier de Textes cible ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),t.length===0?r.jsx("p",{style:{color:"#dc2626",fontSize:"0.875rem"},children:"Aucun Cahier de Textes trouv. Crez-en un d'abord."}):r.jsxs("select",{className:"form-control",value:o,onChange:C=>u(C.target.value),children:[r.jsx("option",{value:"",children:"Slectionner un cahier..."}),t.map(C=>r.jsxs("option",{value:C.id,children:[C.titre,"  ",C.classe," (",C.anneeScolaire,")"]},C.id))]})]}),r.jsx("p",{style:{fontSize:"0.8125rem",color:"#64748b",marginBottom:12},children:"Slectionnez les sances  exporter et assignez leur une date. Chaque sance deviendra une entre dans le Cahier de Textes."}),e.seances.map(C=>{const E=(C.entreesCahierIds?.length??0)>0;return r.jsxs("div",{className:"export-seance-row",children:[r.jsx("input",{type:"checkbox",className:"export-seance-row__check",checked:!!p[C.id],onChange:w=>h(z=>({...z,[C.id]:w.target.checked})),id:`export-${C.id}`,"aria-label":`Exporter la sance ${C.numero}`}),r.jsxs("div",{className:"export-seance-row__info",children:[r.jsx("label",{htmlFor:`export-${C.id}`,style:{cursor:"pointer"},children:r.jsxs("div",{className:"export-seance-row__titre",children:[C.numero,". ",C.titre||`Sance ${C.numero}`]})}),r.jsxs("div",{className:"export-seance-row__type",children:[df[C.typeActivite],"  ",C.dureeMinutes,"min",E&&r.jsx("span",{className:"export-seance-row__exported",style:{marginLeft:6},children:" Dj exporte"})]})]}),r.jsx("input",{type:"date",className:"export-seance-row__date",value:d[C.id]??"",onChange:w=>f(z=>({...z,[C.id]:w.target.value})),disabled:!p[C.id],"aria-label":`Date pour la sance ${C.numero}`})]},C.id)}),x&&r.jsxs("div",{className:"error-banner",style:{marginTop:12},children:[" ",x]})]}),r.jsxs("div",{className:"export-modal__footer",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:a,disabled:v,children:"Annuler"}),r.jsx("button",{type:"button",className:"btn-success",onClick:S,disabled:v||N===0||!o,children:v?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"spinner"})," Export en cours..."]}):` Exporter ${N} sance${N>1?"s":""}`})]})]})})},EJ=()=>{const e=st(),{id:t}=Wn(),{currentUser:n}=rt(),[a,l]=g.useState(null),[o,u]=g.useState([]),[d,f]=g.useState(!0),[p,h]=g.useState(null),[v,b]=g.useState(null),[x,j]=g.useState("seances"),[N,S]=g.useState(!1);g.useEffect(()=>{(async()=>{if(!(!n?.uid||!t)){f(!0);try{const[O,P]=await Promise.all([Jc(t),QM(n.uid)]);if(!O){h("Squence introuvable.");return}if(O.profId!==n.uid){h("Accs non autoris.");return}l(O),u(P)}catch{h("Erreur de chargement.")}finally{f(!1)}}})()},[n?.uid,t]);const C=async()=>{if(!(!a||!window.confirm(`Supprimer "${a.titre}" ?
Cette action est irrversible.`)))try{await aP(a.id),e("/prof/sequences")}catch{h("Erreur lors de la suppression.")}},E=async k=>{if(a)try{await sJ(a.id,k),l(O=>O?{...O,statut:k}:null)}catch{h("Erreur de mise  jour du statut.")}},w=k=>{S(!1),b(` ${k} sance${k>1?"s":""} exporte${k>1?"s":""} vers le Cahier de Textes !`),t&&Jc(t).then(O=>O&&l(O)).catch(()=>null),setTimeout(()=>b(null),5e3)};if(d)return r.jsxs("div",{className:"sequence-detail",children:[r.jsx("div",{className:"skeleton",style:{height:28,width:"50%",marginBottom:20}}),r.jsx("div",{className:"skeleton",style:{height:180,borderRadius:12,marginBottom:20}}),r.jsx("div",{className:"skeleton",style:{height:400,borderRadius:12}})]});if(p||!a)return r.jsxs("div",{className:"sequence-detail",children:[r.jsxs("div",{className:"error-banner",children:[" ",p??"Squence introuvable."]}),r.jsx("button",{className:"btn-secondary",onClick:()=>e("/prof/sequences"),children:" Retour"})]});const z=uJ.find(k=>k.valeur===a.niveau)?.label??a.niveau;return r.jsxs("div",{className:"sequence-detail",children:[N&&r.jsx(CJ,{sequence:a,cahiers:o,profId:n.uid,onClose:()=>S(!1),onSuccess:w}),p&&r.jsxs("div",{className:"error-banner",role:"alert",children:[" ",p]}),v&&r.jsx("div",{className:"success-banner",role:"status",children:v}),r.jsxs("div",{className:"sequence-detail__header",children:[r.jsxs("p",{style:{fontSize:"0.8125rem",color:"#64748b",marginBottom:8},children:[r.jsx("a",{onClick:()=>e("/prof/sequences"),style:{color:"#2563eb",cursor:"pointer",fontWeight:500},children:" Squences"})," / ",a.titre]}),r.jsxs("div",{className:"sequence-detail__header-top",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"sequence-detail__title",children:a.titre}),r.jsxs("div",{className:"sequence-detail__meta",style:{marginTop:8},children:[r.jsx(wJ,{statut:a.statut}),a.genereeParIA&&r.jsx("span",{className:"badge-ia",children:" IA"}),r.jsx("span",{className:"sequence-card__meta-chip",children:a.matiere}),r.jsx("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:z}),a.trimestre&&r.jsxs("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:["T",a.trimestre]}),a.groupeClasseNom&&r.jsxs("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:[" ",a.groupeClasseNom]})]})]}),r.jsxs("div",{className:"sequence-detail__actions",children:[r.jsx("select",{className:"form-control",style:{width:"auto",fontSize:"0.8rem"},value:a.statut,onChange:k=>E(k.target.value),"aria-label":"Changer le statut",children:Object.entries(fp).map(([k,{label:O}])=>r.jsx("option",{value:k,children:O},k))}),r.jsx("button",{className:"btn-success",onClick:()=>S(!0),title:"Exporter les sances vers le Cahier de Textes",children:" Exporter"}),r.jsx("button",{className:"btn-secondary",onClick:()=>e(`/prof/sequences/${a.id}/modifier`),children:" Modifier"}),r.jsx("button",{className:"btn-danger",onClick:C,children:""})]})]}),a.objectifGeneral&&r.jsxs("div",{className:"sequence-detail__objectif",children:[r.jsx("strong",{children:" Objectif :"})," ",a.objectifGeneral]}),r.jsxs("div",{style:{display:"flex",gap:16,marginTop:12,flexWrap:"wrap",fontSize:"0.8125rem",color:"#64748b"},children:[r.jsxs("span",{children:[" ",a.seances.length," sances"]}),r.jsxs("span",{children:[" ",a.evaluationsPrevues.length," valuation",a.evaluationsPrevues.length>1?"s":""]}),r.jsxs("span",{children:[" ",a.seances.reduce((k,O)=>k+O.dureeMinutes,0)," min total"]}),a.cahierDeTextesNom&&r.jsxs("span",{children:[" ",a.cahierDeTextesNom]}),a.exporteAt&&r.jsxs("span",{children:[" Export le ",a.exporteAt.toDate().toLocaleDateString("fr-FR")]})]})]}),r.jsxs("div",{className:"sequence-tabs",role:"tablist",children:[r.jsxs("button",{role:"tab",className:`sequence-tab${x==="seances"?" sequence-tab--active":""}`,onClick:()=>j("seances"),"aria-selected":x==="seances",children:[" Sances (",a.seances.length,")"]}),r.jsxs("button",{role:"tab",className:`sequence-tab${x==="evaluations"?" sequence-tab--active":""}`,onClick:()=>j("evaluations"),"aria-selected":x==="evaluations",children:[" valuations (",a.evaluationsPrevues.length,")"]}),r.jsx("button",{role:"tab",className:`sequence-tab${x==="infos"?" sequence-tab--active":""}`,onClick:()=>j("infos"),"aria-selected":x==="infos",children:" Dtails"})]}),x==="seances"&&r.jsx("div",{role:"tabpanel",children:a.seances.length===0?r.jsxs("div",{className:"sequences-empty",children:[r.jsx("span",{className:"sequences-empty__icon",children:""}),r.jsx("p",{className:"sequences-empty__text",children:"Aucune sance planifie"}),r.jsx("button",{className:"btn-primary",onClick:()=>e(`/prof/sequences/${a.id}/modifier`),children:" Ajouter des sances"})]}):r.jsx("div",{className:"sequence-timeline",children:a.seances.map(k=>r.jsx(AJ,{seance:k},k.id))})}),x==="evaluations"&&r.jsxs("div",{role:"tabpanel",className:"evaluations-panel",children:[r.jsx("h3",{className:"evaluations-panel__title",children:" valuations prvues"}),a.evaluationsPrevues.length===0?r.jsx("p",{style:{color:"#94a3b8",fontSize:"0.875rem"},children:'Aucune valuation marque dans cette squence. Modifiez une sance et cochez "Cette sance est une valuation".'}):a.evaluationsPrevues.map(k=>r.jsxs("div",{className:"evaluation-row",children:[r.jsxs("div",{className:"evaluation-row__numero",children:["S",k.seanceNumero]}),r.jsxs("div",{className:"evaluation-row__info",children:[r.jsx("div",{className:"evaluation-row__titre",children:k.titre}),r.jsxs("div",{className:"evaluation-row__type",children:[xj[k.type],k.datePrevue&&`  ${k.datePrevue.toDate().toLocaleDateString("fr-FR")}`]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"evaluation-row__note",children:["/",k.noteMax]}),r.jsxs("div",{className:"evaluation-row__coeff",children:["Coeff. ",k.coefficient]})]})]},k.id))]}),x==="infos"&&r.jsx("div",{role:"tabpanel",children:r.jsxs("div",{className:"editor-section",children:[a.competences.length>0&&r.jsxs("div",{style:{marginBottom:16},children:[r.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:700,color:"#374151",marginBottom:8},children:"Comptences vises"}),r.jsx("div",{className:"competences-list",children:a.competences.map((k,O)=>r.jsx("span",{className:"competence-tag",children:k},O))})]}),a.prerequis&&r.jsxs("div",{style:{marginBottom:16},children:[r.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:700,color:"#374151",marginBottom:6},children:"Prrequis"}),r.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",lineHeight:1.6},children:a.prerequis})]}),a.description&&r.jsxs("div",{style:{marginBottom:16},children:[r.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:700,color:"#374151",marginBottom:6},children:"Description"}),r.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",lineHeight:1.6},children:a.description})]}),r.jsxs("div",{style:{borderTop:"1px solid #f1f5f9",paddingTop:12,fontSize:"0.8rem",color:"#94a3b8"},children:[r.jsxs("p",{children:["Cre le ",a.createdAt.toDate().toLocaleDateString("fr-FR")]}),r.jsxs("p",{children:["Modifie le ",a.updatedAt.toDate().toLocaleDateString("fr-FR")]}),a.genereeParIA&&r.jsx("p",{children:" Gnre avec l'IA Claude"})]})]})})]})},AJ=({seance:e})=>{const[t,n]=g.useState(!1),a=(e.entreesCahierIds?.length??0)>0;return r.jsx("div",{className:`timeline-item${e.estEvaluation?" timeline-item--eval":""}`,children:r.jsxs("div",{className:"timeline-card",children:[r.jsxs("div",{className:"timeline-card__header",onClick:()=>n(l=>!l),style:{cursor:"pointer"},children:[r.jsxs("h3",{className:"timeline-card__title",children:[e.numero,". ",e.titre||`Sance ${e.numero}`]}),r.jsxs("div",{className:"timeline-card__meta",children:[r.jsx("span",{className:`type-activite-badge type-activite-badge--${e.typeActivite}`,children:df[e.typeActivite]}),r.jsxs("span",{className:"timeline-card__duree",children:[e.dureeMinutes,"min"]}),a&&r.jsx("span",{className:"export-seance-row__exported",children:" Exporte"}),r.jsx("span",{style:{color:"#94a3b8",fontSize:"0.7rem"},children:t?"":""})]})]}),e.objectifSpecifique&&r.jsxs("p",{className:"timeline-card__objectif",children:[" ",e.objectifSpecifique]}),t&&r.jsxs(r.Fragment,{children:[e.contenu&&r.jsx("p",{className:"timeline-card__contenu",style:{marginTop:8},children:e.contenu}),e.ressources.length>0&&r.jsx("div",{className:"timeline-card__ressources",children:e.ressources.map((l,o)=>r.jsx("span",{className:"ressource-chip",children:l},o))}),e.estEvaluation&&e.typeEvaluation&&r.jsxs("div",{style:{marginTop:10,padding:"8px 12px",background:"#fef2f2",borderRadius:6,fontSize:"0.8rem",color:"#dc2626"},children:[" ",xj[e.typeEvaluation],e.noteMax&&`  /${e.noteMax}`,e.coefficient&&`  Coeff. ${e.coefficient}`]})]})]})})},Jn="cours_en_ligne",el="cours_sections";function zJ(e){const t=[/(?:youtube\.com\/watch\?v=)([^&\n?#]+)/,/(?:youtu\.be\/)([^&\n?#]+)/,/(?:youtube\.com\/embed\/)([^&\n?#]+)/];for(const n of t){const a=e.match(n);if(a)return a[1]}return null}async function OJ(e){let t=ke(_e(X,Jn),Se("statut","==","publie"),Ke("updatedAt","desc"),Cr(50));return(await ze(t)).docs.map(l=>({id:l.id,...l.data()}))}async function sP(e){const t=await Ot(Ne(X,Jn,e));return t.exists()?{id:t.id,...t.data()}:null}async function kJ(e){const t=ke(_e(X,Jn),Se("profId","==",e),Ke("updatedAt","desc"));return(await ze(t)).docs.map(a=>({id:a.id,...a.data()}))}async function DJ(e,t,n){const a=Oe.now();return(await Tt(_e(X,Jn),{...n,profId:e,profNom:t,statut:n.statut??"brouillon",nombreInscrits:0,nombreSections:0,createdAt:a,updatedAt:a})).id}async function MJ(e,t){await Qe(Ne(X,Jn,e),{...t,updatedAt:Oe.now()})}async function Eb(e){await Qe(Ne(X,Jn,e),{statut:"publie",publieAt:Oe.now(),updatedAt:Oe.now()})}async function PJ(e){await Qe(Ne(X,Jn,e),{statut:"archive",updatedAt:Oe.now()})}async function TJ(e){const t=Pn(X);(await ze(ke(_e(X,el),Se("coursId","==",e)))).docs.forEach(a=>t.delete(a.ref)),t.delete(Ne(X,Jn,e)),await t.commit()}async function lP(e){const t=ke(_e(X,el),Se("coursId","==",e),Ke("ordre","asc"));return(await ze(t)).docs.map(a=>({id:a.id,...a.data()}))}async function qJ(e,t){const n=Pn(X),a=Oe.now(),l=Ne(_e(X,el));return n.set(l,{...t,coursId:e,blocs:t.blocs??[],createdAt:a,updatedAt:a}),n.update(Ne(X,Jn,e),{nombreSections:Hs(1),updatedAt:a}),await n.commit(),l.id}async function XE(e,t){const n=Oe.now();let a={...t,updatedAt:n};t.blocs&&(a.dureeEstimee=oP(t.blocs)),await Qe(Ne(X,el,e),a)}async function RJ(e,t){const n=Pn(X),a=Oe.now();n.delete(Ne(X,el,e)),n.update(Ne(X,Jn,t),{nombreSections:Hs(-1),updatedAt:a}),await n.commit()}async function IJ(e){const t=Pn(X),n=Oe.now();e.forEach(({id:a,ordre:l})=>{t.update(Ne(X,el,a),{ordre:l,updatedAt:n})}),await t.commit()}async function LJ(e,t){const n=t.map((a,l)=>({...a,ordre:l}));await Qe(Ne(X,el,e),{blocs:n,dureeEstimee:oP(n),updatedAt:Oe.now()})}function oP(e){let t=0;return e.forEach(n=>{switch(n.type){case"texte":t+=Math.max(1,Math.ceil(n.contenu.split(" ").length/200));break;case"video":t+=5;break;case"quiz":t+=2;break;case"exercice":t+=n.difficulte==="difficile"?10:n.difficulte==="moyen"?5:3;break;case"image":case"encadre":t+=1;break}}),Math.max(1,t)}async function $J(e){await Qe(Ne(X,Jn,e),{nombreInscrits:Hs(1)})}const Ab={texte:{label:"Texte",emoji:"",description:"Paragraphe format"},image:{label:"Image",emoji:"",description:"Image avec lgende"},video:{label:"Vido",emoji:"",description:"Vido YouTube"},encadre:{label:"Encadr",emoji:"",description:"Dfinition, remarque, astuce..."},quiz:{label:"Quiz",emoji:"",description:"Question  choix multiple"},exercice:{label:"Exercice",emoji:"",description:"Problme avec correction"}},cP={definition:{label:"Dfinition",emoji:"",bg:"#eff6ff",border:"#2563eb",color:"#1d4ed8"},remarque:{label:"Remarque",emoji:"",bg:"#fefce8",border:"#ca8a04",color:"#854d0e"},attention:{label:"Attention",emoji:"",bg:"#fef2f2",border:"#dc2626",color:"#991b1b"},astuce:{label:"Astuce",emoji:"",bg:"#f0fdf4",border:"#16a34a",color:"#15803d"},exemple:{label:"Exemple",emoji:"",bg:"#f8fafc",border:"#64748b",color:"#475569"}},bj=Js.map(e=>({valeur:e,label:e==="3me"?"3me (BFEM)":e==="Terminale"?"Terminale (BAC)":e})),BJ={brouillon:{label:"Brouillon",couleur:"#6b7280",bg:"#f3f4f6"},publie:{label:"Publi",couleur:"#16a34a",bg:"#f0fdf4"},archive:{label:"Archiv",couleur:"#9ca3af",bg:"#f9fafb"}};function UJ({cours:e,onClick:t}){const n=e.dureeEstimee>=60?`${Math.floor(e.dureeEstimee/60)}h${e.dureeEstimee%60>0?e.dureeEstimee%60:""}`:`${e.dureeEstimee} min`,a=bj.find(l=>l.valeur===e.niveau)?.label??e.niveau;return r.jsxs("article",{className:"cours-card",onClick:t,role:"button",tabIndex:0,onKeyDown:l=>l.key==="Enter"&&t(),"aria-label":`Cours : ${e.titre}`,children:[r.jsxs("div",{className:"cours-card__cover",children:[e.couvertureUrl?r.jsx("img",{src:e.couvertureUrl,alt:e.titre,loading:"lazy"}):r.jsx("div",{className:"cours-card__cover-placeholder",children:r.jsx("span",{children:e.matiere.charAt(0)})}),e.isPremium&&r.jsx("span",{className:"cours-card__badge cours-card__badge--premium",children:" Premium"}),!e.isPremium&&r.jsx("span",{className:"cours-card__badge cours-card__badge--gratuit",children:" Gratuit"})]}),r.jsxs("div",{className:"cours-card__body",children:[r.jsxs("div",{className:"cours-card__meta",children:[r.jsx("span",{className:"cours-card__matiere",children:e.matiere}),r.jsx("span",{className:"cours-card__niveau",children:a})]}),r.jsx("h3",{className:"cours-card__titre",children:e.titre}),r.jsx("p",{className:"cours-card__description",children:e.description}),r.jsxs("div",{className:"cours-card__footer",children:[r.jsxs("span",{className:"cours-card__prof",children:[" ",e.profNom]}),r.jsxs("div",{className:"cours-card__stats",children:[r.jsxs("span",{children:[" ",e.nombreSections," section",e.nombreSections>1?"s":""]}),r.jsxs("span",{children:[" ",n]}),r.jsxs("span",{children:[" ",e.nombreInscrits]})]})]})]})]})}function FJ(){const e=st(),{matieres:t}=fo(),[n,a]=g.useState([]),[l,o]=g.useState([]),[u,d]=g.useState(!0),[f,p]=g.useState(null),[h,v]=g.useState({matiere:"",niveau:"",recherche:"",isPremium:""});g.useEffect(()=>{b()},[]);async function b(){d(!0),p(null);try{const S=await OJ();a(S),o(S)}catch(S){console.error("[CoursPage] Erreur chargement :",S),p("Impossible de charger les cours. Vrifiez votre connexion.")}finally{d(!1)}}const x=g.useCallback(S=>{v(S);let C=[...n];if(S.matiere&&(C=C.filter(E=>E.matiere===S.matiere)),S.niveau&&(C=C.filter(E=>E.niveau===S.niveau)),S.isPremium!==""&&S.isPremium!==void 0&&(C=C.filter(E=>E.isPremium===S.isPremium)),S.recherche){const E=S.recherche.toLowerCase();C=C.filter(w=>w.titre.toLowerCase().includes(E)||w.description.toLowerCase().includes(E)||w.matiere.toLowerCase().includes(E)||w.tags.some(z=>z.toLowerCase().includes(E)))}o(C)},[n]),j=()=>{v({matiere:"",niveau:"",recherche:"",isPremium:""}),o(n)},N=!!(h.matiere||h.niveau||h.recherche||h.isPremium!=="");return r.jsxs("div",{className:"cours-catalogue",children:[r.jsx("section",{className:"cours-catalogue__hero","aria-label":"Introduction aux cours",children:r.jsxs("div",{className:"cours-catalogue__hero-content",children:[r.jsx("h1",{className:"cours-catalogue__hero-titre",children:" Cours en ligne"}),r.jsx("p",{className:"cours-catalogue__hero-sous-titre",children:"Des cours complets du programme sngalais  de la 6me au Bac. Crs par vos professeurs, accessibles partout, mme hors-ligne."}),r.jsxs("div",{className:"cours-catalogue__hero-stats","aria-label":"Statistiques de la plateforme",children:[r.jsxs("div",{className:"cours-catalogue__stat",children:[r.jsx("span",{className:"cours-catalogue__stat-val",children:n.length}),r.jsx("span",{className:"cours-catalogue__stat-label",children:"Cours disponibles"})]}),r.jsxs("div",{className:"cours-catalogue__stat",children:[r.jsx("span",{className:"cours-catalogue__stat-val",children:n.filter(S=>!S.isPremium).length}),r.jsx("span",{className:"cours-catalogue__stat-label",children:"Cours gratuits"})]}),r.jsxs("div",{className:"cours-catalogue__stat",children:[r.jsx("span",{className:"cours-catalogue__stat-val",children:[...new Set(n.map(S=>S.matiere))].length}),r.jsx("span",{className:"cours-catalogue__stat-label",children:"Matires"})]})]})]})}),r.jsx("section",{className:"cours-catalogue__filtres","aria-label":"Filtres de recherche",children:r.jsxs("div",{className:"cours-catalogue__filtres-inner",children:[r.jsxs("div",{className:"cours-catalogue__search",children:[r.jsx("span",{className:"cours-catalogue__search-icon","aria-hidden":"true",children:""}),r.jsx("input",{type:"search",placeholder:"Rechercher un cours, une matire, un tag...",value:h.recherche,onChange:S=>x({...h,recherche:S.target.value}),className:"cours-catalogue__search-input","aria-label":"Rechercher dans les cours"})]}),r.jsxs("select",{value:h.matiere,onChange:S=>x({...h,matiere:S.target.value}),className:"cours-catalogue__select","aria-label":"Filtrer par matire",children:[r.jsx("option",{value:"",children:"Toutes les matires"}),t.map(S=>r.jsx("option",{value:S.valeur,children:S.label},S.valeur))]}),r.jsxs("select",{value:h.niveau,onChange:S=>x({...h,niveau:S.target.value}),className:"cours-catalogue__select","aria-label":"Filtrer par niveau",children:[r.jsx("option",{value:"",children:"Tous les niveaux"}),Js.map(S=>r.jsx("option",{value:S,children:S},S))]}),r.jsxs("select",{value:String(h.isPremium),onChange:S=>{const C=S.target.value===""?"":S.target.value==="true";x({...h,isPremium:C})},className:"cours-catalogue__select","aria-label":"Filtrer par accs",children:[r.jsx("option",{value:"",children:"Tous les accs"}),r.jsx("option",{value:"false",children:" Gratuits"}),r.jsx("option",{value:"true",children:" Premium"})]}),N&&r.jsx("button",{className:"btn-secondary btn--sm",onClick:j,"aria-label":"Effacer les filtres",children:" Effacer les filtres"})]})}),r.jsxs("main",{className:"cours-catalogue__contenu",children:[f&&r.jsxs("div",{className:"error-banner",role:"alert",children:[" ",f,r.jsx("button",{className:"btn-link",onClick:b,children:"Ressayer"})]}),u&&r.jsx("div",{className:"cours-catalogue__grille","aria-busy":"true","aria-label":"Chargement des cours",children:[1,2,3,4,5,6].map(S=>r.jsxs("div",{className:"cours-card cours-card--skeleton",children:[r.jsx("div",{className:"skeleton cours-card__cover"}),r.jsxs("div",{className:"cours-card__body",children:[r.jsx("div",{className:"skeleton",style:{height:16,width:"60%",marginBottom:8}}),r.jsx("div",{className:"skeleton",style:{height:20,marginBottom:8}}),r.jsx("div",{className:"skeleton",style:{height:14,width:"80%"}})]})]},S))}),!u&&l.length>0&&r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"cours-catalogue__compteur","aria-live":"polite",children:[l.length," cours trouv",l.length>1?"s":"",N&&" pour ces critres"]}),r.jsx("div",{className:"cours-catalogue__grille",children:l.map(S=>r.jsx(UJ,{cours:S,onClick:()=>e(`/cours/${S.id}`)},S.id))})]}),!u&&l.length===0&&!f&&r.jsxs("div",{className:"cours-catalogue__vide",role:"status",children:[r.jsx("span",{"aria-hidden":"true",children:""}),r.jsx("h3",{children:"Aucun cours trouv"}),r.jsx("p",{children:N?"Essayez de modifier ou supprimer vos filtres.":"Les cours seront disponibles bientt. Revenez dans quelques jours !"}),N&&r.jsx("button",{className:"btn-secondary",onClick:j,children:"Afficher tous les cours"})]})]})]})}const Gs="progression_cours";async function ZE(e,t){const n=ke(_e(X,Gs),Se("userId","==",e),Se("coursId","==",t)),a=await ze(n);if(a.empty)return null;const l=a.docs[0];return{id:l.id,...l.data()}}async function GJ(e){const t=ke(_e(X,Gs),Se("coursId","==",e));return(await ze(t)).docs.map(a=>({id:a.id,...a.data()}))}async function HJ(e,t){const n=Oe.now(),a=await Tt(_e(X,Gs),{userId:e,coursId:t,sectionsLues:[],reponsesQuiz:[],pourcentageProgression:0,scoreQuiz:0,tentativesQuiz:0,debutLe:n,dernierAcces:n,estTermine:!1});return await $J(t),a.id}async function QJ(e,t,n){const a=await Ot(Ne(X,Gs,e));if(!a.exists())return;const l=a.data();if(l.sectionsLues.includes(t))return;const o=[...l.sectionsLues,t],u=Math.round(o.length/n*100),d=o.length>=n;await Qe(Ne(X,Gs,e),{sectionsLues:Ob(t),pourcentageProgression:u,estTermine:d,dernierAcces:Oe.now()})}async function VJ(e,t){const n=await Ot(Ne(X,Gs,e));if(!n.exists())return;const a=n.data(),l=a.reponsesQuiz??[];if(l.some(p=>p.blocId===t.blocId))return;const u=[...l,t],d=u.filter(p=>p.estCorrecte).length,f=u.length>0?Math.round(d/u.length*100):0;await Qe(Ne(X,Gs,e),{reponsesQuiz:Ob(t),scoreQuiz:f,tentativesQuiz:a.tentativesQuiz+1,dernierAcces:Oe.now()})}function YJ(e){if(e.length===0)return{nombreInscrits:0,nombreTermines:0,tauxCompletion:0,progressionMoyenne:0,scoreMoyen:0};const t=e.filter(l=>l.estTermine).length,n=Math.round(e.reduce((l,o)=>l+o.pourcentageProgression,0)/e.length),a=Math.round(e.reduce((l,o)=>l+o.scoreQuiz,0)/e.length);return{nombreInscrits:e.length,nombreTermines:t,tauxCompletion:Math.round(t/e.length*100),progressionMoyenne:n,scoreMoyen:a}}function KJ({bloc:e}){const t=e.contenu.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/^- (.+)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)/gs,"<ul>$1</ul>").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br/>");return r.jsx("div",{className:"bloc-texte",dangerouslySetInnerHTML:{__html:`<p>${t}</p>`}})}function WJ({bloc:e}){return r.jsxs("figure",{className:"bloc-image",children:[r.jsx("img",{src:e.url,alt:e.alt,loading:"lazy"}),e.legende&&r.jsx("figcaption",{children:e.legende})]})}function XJ({bloc:e}){const t=zJ(e.urlYoutube);return t?r.jsxs("div",{className:"bloc-video",children:[e.titre&&r.jsxs("h4",{className:"bloc-video__titre",children:[" ",e.titre]}),e.description&&r.jsx("p",{className:"bloc-video__description",children:e.description}),r.jsx("div",{className:"bloc-video__embed",children:r.jsx("iframe",{src:`https://www.youtube.com/embed/${t}`,title:e.titre||"Vido pdagogique",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy"})})]}):null}function ZJ({bloc:e}){const t=cP[e.variante];return r.jsxs("div",{className:"bloc-encadre",style:{background:t.bg,borderLeftColor:t.border,color:t.color},children:[r.jsxs("p",{className:"bloc-encadre__titre",children:[t.emoji," ",e.titre]}),r.jsx("p",{className:"bloc-encadre__contenu",children:e.contenu})]})}function JJ({bloc:e,onReponse:t,reponseExistante:n}){const[a,l]=g.useState(n??null),o=a!==null;function u(d,f){o||(l(d),t(d,f))}return r.jsxs("div",{className:"bloc-quiz",children:[r.jsxs("p",{className:"bloc-quiz__question",children:[" ",e.question]}),r.jsx("div",{className:"bloc-quiz__options",children:e.options.map(d=>{let f="";return o&&(d.id===a?f=d.estCorrecte?"correct":"incorrect":d.estCorrecte&&(f="attendu")),r.jsxs("button",{className:`bloc-quiz__option bloc-quiz__option--${f||"neutre"}`,onClick:()=>u(d.id,d.estCorrecte),disabled:o,"aria-pressed":d.id===a,children:[f==="correct"&&" ",f==="incorrect"&&" ",f==="attendu"&&" ",d.texte]},d.id)})}),o&&e.explication&&r.jsxs("div",{className:"bloc-quiz__explication",children:[" ",r.jsx("strong",{children:"Explication :"})," ",e.explication]})]})}function eee({bloc:e}){const[t,n]=g.useState(!1),a={facile:"#16a34a",moyen:"#ca8a04",difficile:"#dc2626"};return r.jsxs("div",{className:"bloc-exercice",children:[r.jsxs("div",{className:"bloc-exercice__header",children:[r.jsx("span",{className:"bloc-exercice__titre",children:" Exercice"}),r.jsxs("span",{className:"bloc-exercice__difficulte",style:{color:a[e.difficulte]},children:[e.difficulte.charAt(0).toUpperCase()+e.difficulte.slice(1),e.points&&`  ${e.points} pt${e.points>1?"s":""}`]})]}),r.jsx("p",{className:"bloc-exercice__enonce",children:e.enonce}),t?r.jsxs("div",{className:"bloc-exercice__correction",children:[r.jsx("p",{className:"bloc-exercice__correction-titre",children:" Correction"}),r.jsx("p",{children:e.correction})]}):r.jsx("button",{className:"btn-secondary btn--sm",onClick:()=>n(!0),children:" Voir la correction"})]})}function tee({bloc:e,isPremiumVerrou:t,onReponseQuiz:n,reponseExistante:a}){if(t)return r.jsxs("div",{className:"bloc-premium-verrou","aria-label":"Contenu Premium",children:[r.jsx("span",{children:""}),r.jsx("p",{children:"Ce contenu est rserv aux abonns Premium."})]});switch(e.type){case"texte":return r.jsx(KJ,{bloc:e});case"image":return r.jsx(WJ,{bloc:e});case"video":return r.jsx(XJ,{bloc:e});case"encadre":return r.jsx(ZJ,{bloc:e});case"quiz":return r.jsx(JJ,{bloc:e,reponseExistante:a,onReponse:(l,o)=>n(e.id,l,o)});case"exercice":return r.jsx(eee,{bloc:e});default:return null}}function ree(){const{coursId:e}=Wn(),t=st(),{currentUser:n}=rt(),a=n?.isPremium??!1,[l,o]=g.useState(null),[u,d]=g.useState([]),[f,p]=g.useState(null),[h,v]=g.useState(null),[b,x]=g.useState(!0),[j,N]=g.useState(null),S=g.useRef(null);g.useEffect(()=>{e&&C()},[e,n]);async function C(){if(e){x(!0),N(null);try{const[D,L]=await Promise.all([sP(e),lP(e)]);if(!D||D.statut!=="publie"){N("Ce cours n'est pas disponible."),x(!1);return}if(o(D),d(L),L.length>0&&v(L[0].id),n){let U=await ZE(n.uid,e);U||(await HJ(n.uid,e),U=await ZE(n.uid,e)),p(U)}}catch(D){console.error("[CoursDetailPage] Erreur chargement :",D),N("Erreur de chargement. Vrifiez votre connexion.")}finally{x(!1)}}}async function E(D){if(!(!n||!f||!l)&&!f.sectionsLues.includes(D))try{await QJ(f.id,D,l.nombreSections),p(L=>L?{...L,sectionsLues:[...L.sectionsLues,D],pourcentageProgression:Math.round((L.sectionsLues.length+1)/l.nombreSections*100)}:null)}catch(L){console.error("[CoursDetailPage] Erreur marquer section :",L)}}async function w(D,L,U){if(!(!n||!f))try{await VJ(f.id,{blocId:D,optionChoisieId:L,estCorrecte:U,reponduAt:Oe.now()})}catch($){console.error("[CoursDetailPage] Erreur enregistrement quiz :",$)}}function z(D){return!!(D.estGratuite||D.ordre===1||!l?.isPremium||a)}if(b)return r.jsxs("div",{className:"cours-detail__loading","aria-busy":"true",children:[r.jsx("div",{className:"spinner spinner--blue"}),r.jsx("p",{children:"Chargement du cours..."})]});if(j||!l)return r.jsxs("div",{className:"cours-detail__erreur",role:"alert",children:[r.jsx("span",{"aria-hidden":"true",children:""}),r.jsx("p",{children:j??"Cours introuvable."}),r.jsx("button",{className:"btn-secondary",onClick:()=>t("/cours"),children:" Retour au catalogue"})]});const k=bj.find(D=>D.valeur===l.niveau)?.label??l.niveau,O=u.find(D=>D.id===h),P=O?z(O):!1;return r.jsxs("div",{className:"cours-detail",children:[r.jsxs("header",{className:"cours-detail__header",children:[r.jsxs("p",{className:"cours-detail__breadcrumb",children:[r.jsx("button",{className:"btn-link",onClick:()=>t("/cours"),children:" Cours"})," / ",r.jsx("span",{children:l.matiere})," / ",r.jsx("span",{children:l.titre})]}),r.jsxs("div",{className:"cours-detail__header-grid",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"cours-detail__badges",children:[r.jsx("span",{className:"badge badge--matiere",children:l.matiere}),r.jsx("span",{className:"badge badge--niveau",children:k}),l.isPremium?r.jsx("span",{className:"badge badge--premium",children:" Premium"}):r.jsx("span",{className:"badge badge--gratuit",children:" Gratuit"})]}),r.jsx("h1",{className:"cours-detail__titre",children:l.titre}),r.jsx("p",{className:"cours-detail__description",children:l.description}),r.jsxs("p",{className:"cours-detail__prof",children:[" Cours de ",r.jsx("strong",{children:l.profNom})]}),l.objectifs.length>0&&r.jsxs("div",{className:"cours-detail__objectifs",children:[r.jsx("h3",{children:" Objectifs du cours"}),r.jsx("ul",{children:l.objectifs.map((D,L)=>r.jsx("li",{children:D},L))})]})]}),n&&f&&r.jsxs("div",{className:"cours-detail__progression-card",children:[r.jsx("h3",{children:" Ma progression"}),r.jsx("div",{className:"progression-bar",children:r.jsx("div",{className:"progression-bar__fill",style:{width:`${f.pourcentageProgression}%`},role:"progressbar","aria-valuenow":f.pourcentageProgression,"aria-valuemin":0,"aria-valuemax":100})}),r.jsxs("p",{className:"progression-bar__label",children:[f.pourcentageProgression,"%  ",f.sectionsLues.length,"/",l.nombreSections," section",l.nombreSections>1?"s":""," lue",f.sectionsLues.length>1?"s":""]}),f.scoreQuiz>0&&r.jsxs("p",{className:"progression-bar__score",children:[" Score quiz : ",r.jsxs("strong",{children:[f.scoreQuiz,"%"]})]}),f.estTermine&&r.jsx("div",{className:"cours-detail__termine-badge",children:" Cours termin !"})]})]})]}),r.jsxs("div",{className:"cours-detail__layout",children:[r.jsxs("nav",{className:"cours-detail__sidebar","aria-label":"Sections du cours",children:[r.jsx("h2",{className:"cours-detail__sidebar-titre",children:" Sections"}),r.jsx("ol",{className:"cours-detail__sections-liste",children:u.map(D=>{const L=f?.sectionsLues.includes(D.id)??!1,U=D.id===h,$=z(D);return r.jsx("li",{children:r.jsxs("button",{className:["cours-detail__section-btn",U?"cours-detail__section-btn--active":"",L?"cours-detail__section-btn--lue":"",$?"":"cours-detail__section-btn--verrou"].join(" "),onClick:()=>v(D.id),"aria-current":U?"true":void 0,children:[r.jsx("span",{className:"cours-detail__section-icone","aria-hidden":"true",children:$?L?"":`${D.ordre}.`:""}),r.jsx("span",{className:"cours-detail__section-nom",children:D.titre}),r.jsxs("span",{className:"cours-detail__section-duree",children:[D.dureeEstimee," min"]})]})},D.id)})})]}),r.jsx("main",{className:"cours-detail__contenu",ref:S,"aria-live":"polite",children:O?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"cours-detail__section-header",children:[r.jsxs("h2",{className:"cours-detail__section-titre",children:[O.ordre,". ",O.titre]}),r.jsxs("span",{className:"cours-detail__section-duree-label",children:[" ",O.dureeEstimee," min de lecture"]})]}),P?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"cours-detail__blocs",children:O.blocs.sort((D,L)=>D.ordre-L.ordre).map(D=>{const L=D.isPremium&&!a&&!O.estGratuite,U=f?.reponsesQuiz.find($=>$.blocId===D.id)?.optionChoisieId;return r.jsx("div",{className:`cours-detail__bloc cours-detail__bloc--${D.type}`,children:r.jsx(tee,{bloc:D,isPremiumVerrou:L,onReponseQuiz:w,reponseExistante:U})},D.id)})}),n&&!f?.sectionsLues.includes(O.id)&&r.jsx("div",{className:"cours-detail__action-lu",children:r.jsx("button",{className:"btn-primary",onClick:()=>E(O.id),children:" Marquer cette section comme lue"})}),r.jsxs("div",{className:"cours-detail__nav-sections",children:[O.ordre>1&&r.jsx("button",{className:"btn-secondary",onClick:()=>{const D=u.find(L=>L.ordre===O.ordre-1);D&&v(D.id)},children:" Section prcdente"}),O.ordre<u.length&&r.jsx("button",{className:"btn-primary",onClick:()=>{const D=u.find(L=>L.ordre===O.ordre+1);D&&v(D.id)},children:"Section suivante "})]})]}):r.jsxs("div",{className:"cours-detail__premium-gate",children:[r.jsx("span",{className:"cours-detail__premium-gate-icon","aria-hidden":"true",children:""}),r.jsx("h3",{children:"Contenu Premium"}),r.jsxs("p",{children:["Cette section ncessite un abonnement Premium PedaClic.",r.jsx("br",{}),"Accdez  tous les cours complets  partir de ",r.jsx("strong",{children:"2 000 FCFA/mois"}),"."]}),n?r.jsx("button",{className:"btn-primary",onClick:()=>t("/premium"),children:" Passer Premium"}):r.jsx("button",{className:"btn-primary",onClick:()=>t("/connexion"),children:"Se connecter pour accder"})]})]}):r.jsx("div",{className:"cours-detail__vide-section",role:"status",children:r.jsx("p",{children:"Slectionnez une section dans le menu de gauche pour commencer."})})})]})]})}const nee=["image/jpeg","image/png","image/gif","image/webp"],aee=".jpg,.jpeg,.png,.gif,.webp",uP=({storagePath:e,existingUrl:t,onUploadComplete:n,onUploadStart:a,onUploadError:l,placeholder:o="Glissez une image ici ou cliquez pour parcourir",disabled:u=!1,maxSizeMo:d=5})=>{const[f,p]=g.useState({status:"idle",progress:0,errorMessage:null,previewUrl:t||null}),[h,v]=g.useState(!1),b=g.useRef(null),x=g.useCallback(U=>{if(!nee.includes(U.type))return`Type non support : ${U.type}. Utilisez JPG, PNG, GIF ou WebP.`;const $=U.size/(1024*1024);return $>d?`Fichier trop lourd : ${$.toFixed(1)} Mo (max ${d} Mo).`:null},[d]),j=U=>{const $=Date.now(),B=U.split(".").pop()?.toLowerCase()||"jpg";return`${U.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9_-]/g,"_").slice(0,30)}_${$}.${B}`},N=g.useCallback(async U=>{const $=x(U);if($){p(F=>({...F,status:"error",errorMessage:$})),l?.($);return}const B=URL.createObjectURL(U);p({status:"uploading",progress:0,errorMessage:null,previewUrl:B}),a?.();const re=j(U.name),se=`${e}/${re}`,M=qr(Or,se),q=kb(M,U,{contentType:U.type,customMetadata:{uploadedBy:"pedaclic-prof",originalName:U.name}});q.on("state_changed",F=>{const R=Math.round(F.bytesTransferred/F.totalBytes*100);p(K=>({...K,progress:R}))},F=>{URL.revokeObjectURL(B);const R=`Erreur upload : ${F.message}`;p(K=>({...K,status:"error",errorMessage:R,previewUrl:t||null})),l?.(R)},async()=>{URL.revokeObjectURL(B);try{const F=await da(q.snapshot.ref);p({status:"success",progress:100,errorMessage:null,previewUrl:F}),n(F)}catch{const R="Impossible de rcuprer l'URL de tlchargement.";p(K=>({...K,status:"error",errorMessage:R})),l?.(R)}})},[e,t,x,a,n,l]),S=U=>{const $=U.target.files?.[0];$&&N($),U.target.value=""},C=U=>{U.preventDefault(),u||v(!0)},E=U=>{U.preventDefault(),v(!1)},w=U=>{if(U.preventDefault(),v(!1),u)return;const $=U.dataTransfer.files?.[0];$&&N($)},z=async()=>{f.previewUrl&&(p({status:"idle",progress:0,errorMessage:null,previewUrl:null}),n(""))},{status:k,progress:O,errorMessage:P,previewUrl:D}=f,L=k==="uploading";return r.jsxs("div",{className:`image-uploader ${h?"image-uploader--drag-over":""} ${u?"image-uploader--disabled":""}`,children:[D&&r.jsxs("div",{className:"image-uploader__preview",children:[r.jsx("img",{src:D,alt:"Aperu",className:"image-uploader__preview-img"}),L&&r.jsx("div",{className:"image-uploader__overlay",children:r.jsx("div",{className:"image-uploader__spinner"})}),!L&&!u&&r.jsx("button",{type:"button",className:"image-uploader__remove-btn",onClick:z,title:"Supprimer l'image","aria-label":"Supprimer l'image",children:""})]}),!D&&r.jsxs("div",{className:"image-uploader__dropzone",onDragOver:C,onDragLeave:E,onDrop:w,onClick:()=>!u&&b.current?.click(),role:"button",tabIndex:u?-1:0,"aria-label":"Zone d'upload d'image",onKeyDown:U=>{(U.key==="Enter"||U.key===" ")&&!u&&b.current?.click()},children:[r.jsx("span",{className:"image-uploader__icon","aria-hidden":"true",children:""}),r.jsx("p",{className:"image-uploader__text",children:o}),r.jsxs("p",{className:"image-uploader__subtext",children:["JPG, PNG, GIF, WebP  max ",d," Mo"]}),r.jsx("button",{type:"button",className:"image-uploader__browse-btn",disabled:u,tabIndex:-1,"aria-hidden":"true",children:"Parcourir"})]}),L&&r.jsxs("div",{className:"image-uploader__progress",role:"progressbar","aria-valuenow":O,"aria-valuemin":0,"aria-valuemax":100,children:[r.jsx("div",{className:"image-uploader__progress-bar",style:{width:`${O}%`}}),r.jsxs("span",{className:"image-uploader__progress-text",children:["Upload en cours ",O,"%"]})]}),k==="success"&&r.jsx("p",{className:"image-uploader__success",children:" Image uploade avec succs"}),P&&r.jsxs("p",{className:"image-uploader__error",role:"alert",children:[" ",P]}),r.jsx("input",{ref:b,type:"file",accept:aee,onChange:S,disabled:u||L,style:{display:"none"},"aria-hidden":"true"})]})},om=()=>crypto.randomUUID();function iee(e,t){const n={id:om(),type:e,ordre:t,isPremium:!1};switch(e){case"texte":return{...n,type:"texte",contenu:""};case"image":return{...n,type:"image",url:"",alt:"",legende:""};case"video":return{...n,type:"video",urlYoutube:"",titre:"",description:""};case"encadre":return{...n,type:"encadre",variante:"definition",titre:"Dfinition",contenu:""};case"quiz":return{...n,type:"quiz",question:"",options:[{id:om(),texte:"",estCorrecte:!0},{id:om(),texte:"",estCorrecte:!1}],explication:""};case"exercice":return{...n,type:"exercice",enonce:"",correction:"",difficulte:"moyen"}}}function see({bloc:e,index:t,total:n,onUpdate:a,onDelete:l,onMoveUp:o,onMoveDown:u,isDragging:d,onDragStart:f,onDragOver:p,onDrop:h,onDragEnd:v,dragOverIndex:b,storageBasePath:x,onBlocUploadStart:j,onBlocUploadEnd:N}){const S=Ab[e.type],C=b===t;function E(){switch(e.type){case"texte":return r.jsx("textarea",{className:"editor-bloc__textarea",placeholder:"Texte du paragraphe (Markdown : **gras**, *italique*, - liste)",value:e.contenu,onChange:w=>a({...e,contenu:w.target.value}),rows:4});case"image":return r.jsxs("div",{className:"editor-bloc__form-grid",children:[r.jsx(uP,{storagePath:`${x}/bloc-${t}`,existingUrl:e.url,placeholder:"Glissez l'image ici ou cliquez",onUploadStart:()=>j(t),onUploadComplete:w=>{a({...e,url:w}),N(t)},onUploadError:()=>N(t),maxSizeMo:5}),r.jsx("input",{type:"text",placeholder:"Texte alternatif (accessibilit)",value:e.alt,onChange:w=>a({...e,alt:w.target.value}),className:"editor-bloc__input"}),r.jsx("input",{type:"text",placeholder:"Lgende (optionnelle)",value:e.legende??"",onChange:w=>a({...e,legende:w.target.value}),className:"editor-bloc__input"})]});case"video":return r.jsxs("div",{className:"editor-bloc__form-grid",children:[r.jsx("input",{type:"url",placeholder:"URL YouTube (ex: https://www.youtube.com/watch?v=...)",value:e.urlYoutube,onChange:w=>a({...e,urlYoutube:w.target.value}),className:"editor-bloc__input"}),r.jsx("input",{type:"text",placeholder:"Titre de la vido",value:e.titre,onChange:w=>a({...e,titre:w.target.value}),className:"editor-bloc__input"}),r.jsx("input",{type:"text",placeholder:"Description courte (optionnelle)",value:e.description??"",onChange:w=>a({...e,description:w.target.value}),className:"editor-bloc__input"})]});case"encadre":return r.jsxs("div",{className:"editor-bloc__form-grid",children:[r.jsx("select",{value:e.variante,onChange:w=>a({...e,variante:w.target.value}),className:"editor-bloc__select",children:Object.entries(cP).map(([w,z])=>r.jsxs("option",{value:w,children:[z.emoji," ",z.label]},w))}),r.jsx("input",{type:"text",placeholder:"Titre de l'encadr",value:e.titre,onChange:w=>a({...e,titre:w.target.value}),className:"editor-bloc__input"}),r.jsx("textarea",{placeholder:"Contenu de l'encadr",value:e.contenu,onChange:w=>a({...e,contenu:w.target.value}),className:"editor-bloc__textarea",rows:3})]});case"quiz":{const w=e;return r.jsxs("div",{className:"editor-bloc__form-grid",children:[r.jsx("input",{type:"text",placeholder:"Question",value:w.question,onChange:z=>a({...w,question:z.target.value}),className:"editor-bloc__input"}),r.jsxs("div",{className:"editor-bloc__quiz-options",children:[w.options.map((z,k)=>r.jsxs("div",{className:"editor-bloc__quiz-option",children:[r.jsx("input",{type:"radio",name:`quiz-correct-${e.id}`,checked:z.estCorrecte,onChange:()=>a({...w,options:w.options.map((O,P)=>({...O,estCorrecte:P===k}))}),title:"Marquer comme bonne rponse"}),r.jsx("input",{type:"text",placeholder:`Option ${k+1}`,value:z.texte,onChange:O=>a({...w,options:w.options.map((P,D)=>D===k?{...P,texte:O.target.value}:P)}),className:"editor-bloc__input"}),w.options.length>2&&r.jsx("button",{type:"button",className:"btn-icon btn-icon--danger",onClick:()=>a({...w,options:w.options.filter((O,P)=>P!==k)}),title:"Supprimer cette option",children:""})]},z.id)),w.options.length<4&&r.jsx("button",{type:"button",className:"btn-link",onClick:()=>a({...w,options:[...w.options,{id:om(),texte:"",estCorrecte:!1}]}),children:"+ Ajouter une option"})]}),r.jsx("input",{type:"text",placeholder:"Explication aprs rponse (optionnelle)",value:w.explication??"",onChange:z=>a({...w,explication:z.target.value}),className:"editor-bloc__input"})]})}case"exercice":return r.jsxs("div",{className:"editor-bloc__form-grid",children:[r.jsx("textarea",{placeholder:"nonc de l'exercice",value:e.enonce,onChange:w=>a({...e,enonce:w.target.value}),className:"editor-bloc__textarea",rows:3}),r.jsx("textarea",{placeholder:"Correction (masque pour l'lve jusqu'au clic)",value:e.correction,onChange:w=>a({...e,correction:w.target.value}),className:"editor-bloc__textarea editor-bloc__textarea--correction",rows:3}),r.jsxs("div",{className:"editor-bloc__row",children:[r.jsxs("select",{value:e.difficulte,onChange:w=>a({...e,difficulte:w.target.value}),className:"editor-bloc__select",children:[r.jsx("option",{value:"facile",children:"Facile"}),r.jsx("option",{value:"moyen",children:"Moyen"}),r.jsx("option",{value:"difficile",children:"Difficile"})]}),r.jsx("input",{type:"number",placeholder:"Points (opt.)",value:e.points??"",onChange:w=>a({...e,points:Number(w.target.value)||void 0}),className:"editor-bloc__input editor-bloc__input--sm",min:1})]})]});default:return null}}return r.jsxs("div",{className:["editor-bloc",d?"editor-bloc--dragging":"",C?"editor-bloc--drag-over":""].join(" "),draggable:!0,onDragStart:w=>f(w,t),onDragOver:w=>p(w,t),onDrop:w=>h(w,t),onDragEnd:v,children:[r.jsxs("div",{className:"editor-bloc__header",children:[r.jsx("span",{className:"editor-bloc__drag-handle",title:"Dplacer","aria-hidden":"true",children:""}),r.jsxs("span",{className:"editor-bloc__type-label",children:[S.emoji," ",S.label]}),r.jsxs("label",{className:"editor-bloc__premium-toggle",title:"Rserver aux abonns Premium",children:[r.jsx("input",{type:"checkbox",checked:e.isPremium,onChange:w=>a({...e,isPremium:w.target.checked})}),r.jsx("span",{children:" Premium"})]}),r.jsxs("div",{className:"editor-bloc__actions",children:[r.jsx("button",{type:"button",className:"btn-icon",onClick:o,disabled:t===0,title:"Monter","aria-label":"Monter ce bloc",children:""}),r.jsx("button",{type:"button",className:"btn-icon",onClick:u,disabled:t===n-1,title:"Descendre","aria-label":"Descendre ce bloc",children:""}),r.jsx("button",{type:"button",className:"btn-icon btn-icon--danger",onClick:l,title:"Supprimer ce bloc","aria-label":"Supprimer ce bloc",children:""})]})]}),r.jsx("div",{className:"editor-bloc__form",children:E()})]})}function JE(){const{coursId:e}=Wn(),t=st(),{currentUser:n}=rt(),a=!!e,{matieres:l}=fo(),[o]=g.useState(()=>Ne(_e(X,"cours_en_ligne")).id),u=`cours-images/${a?e:o}`,[d,f]=g.useState({titre:"",description:"",matiere:"Mathmatiques",niveau:"3me",classe:"",isPremium:!1,statut:"brouillon",couvertureUrl:"",dureeEstimee:0,objectifs:[""],prerequis:"",tags:[]}),[p,h]=g.useState([]),[v,b]=g.useState(null),[x,j]=g.useState([]),[N,S]=g.useState(""),C=g.useRef(null),[E,w]=g.useState(null),z=g.useRef(null),[k,O]=g.useState(null),[P,D]=g.useState(null),[L,U]=g.useState(!1),[$,B]=g.useState(!1),[re,se]=g.useState(null),[M,q]=g.useState(null),[F,R]=g.useState("infos"),[K,I]=g.useState(!1),[te,Y]=g.useState({});K||Object.values(te).some(Boolean),g.useEffect(()=>{a&&e&&oe(e)},[e]);async function oe(W){U(!0);try{const[fe,je]=await Promise.all([sP(W),lP(W)]);fe&&f({titre:fe.titre,description:fe.description,matiere:fe.matiere,niveau:fe.niveau,classe:fe.classe??"",isPremium:fe.isPremium,statut:fe.statut,couvertureUrl:fe.couvertureUrl??"",dureeEstimee:fe.dureeEstimee,objectifs:fe.objectifs.length>0?fe.objectifs:[""],prerequis:fe.prerequis??"",tags:fe.tags}),h(je),je.length>0&&(b(je[0].id),j(je[0].blocs),S(je[0].titre))}catch{se("Erreur de chargement du cours.")}finally{U(!1)}}g.useEffect(()=>{if(!v)return;const W=p.find(fe=>fe.id===v);W&&(j([...W.blocs].sort((fe,je)=>fe.ordre-je.ordre)),S(W.titre))},[v]);const he=(W,fe)=>f(je=>({...je,[W]:fe})),ge=(W,fe)=>{const je=[...d.objectifs];je[W]=fe,he("objectifs",je)},Q=()=>he("objectifs",[...d.objectifs,""]),ve=W=>he("objectifs",d.objectifs.filter((fe,je)=>je!==W)),[Me,ce]=g.useState(""),Z=()=>{const W=Me.trim();W&&!d.tags.includes(W)&&he("tags",[...d.tags,W]),ce("")},H=W=>he("tags",d.tags.filter(fe=>fe!==W));async function de(W=!1){if(n){if(!d.titre.trim()){se("Le titre du cours est obligatoire.");return}B(!0),se(null);try{const fe={...d,objectifs:d.objectifs.filter(je=>je.trim()),statut:W?"publie":d.statut};if(a&&e)await MJ(e,fe),W&&await Eb(e),we(W?" Cours publi !":" Cours sauvegard.");else{const je=n.displayName??"Professeur",Te=await DJ(n.uid,je,fe);W&&await Eb(Te),we(" Cours cr ! Ajoutez maintenant vos sections."),t(`/prof/cours/${Te}/modifier`)}}catch(fe){console.error("[CoursEditorPage] Erreur sauvegarde :",fe),se("Erreur lors de la sauvegarde. Ressayez.")}finally{B(!1)}}}function we(W){q(W),setTimeout(()=>q(null),4e3)}async function qe(){if(!e){se("Sauvegardez d'abord le cours pour ajouter des sections.");return}const W=p.length+1,fe=`Section ${W}`;try{const je=await qJ(e,{titre:fe,ordre:W,blocs:[],dureeEstimee:0,estGratuite:W===1}),Te=Oe.now(),gt={id:je,coursId:e,titre:fe,ordre:W,blocs:[],dureeEstimee:0,estGratuite:W===1,createdAt:Te,updatedAt:Te};h(qt=>[...qt,gt]),b(je),j([]),S(fe)}catch{se("Erreur lors de la cration de la section.")}}async function We(W){if(e&&confirm("Supprimer cette section et tous ses blocs ?"))try{await RJ(W,e);const fe=p.filter(je=>je.id!==W).map((je,Te)=>({...je,ordre:Te+1}));h(fe),v===W&&b(fe[0]?.id??null)}catch{se("Erreur lors de la suppression.")}}async function Xe(){if(v)try{await XE(v,{titre:N}),h(W=>W.map(fe=>fe.id===v?{...fe,titre:N}:fe))}catch{se("Erreur lors de la mise  jour du titre.")}}function nt(W,fe){C.current=fe,W.dataTransfer.effectAllowed="move"}function gr(W,fe){W.preventDefault(),W.dataTransfer.dropEffect="move",w(fe)}async function Dr(W,fe){W.preventDefault(),w(null);const je=C.current;if(je===null||je===fe)return;const Te=[...p],[gt]=Te.splice(je,1);Te.splice(fe,0,gt);const qt=Te.map((bn,Ji)=>({...bn,ordre:Ji+1}));h(qt);try{await IJ(qt.map(bn=>({id:bn.id,ordre:bn.ordre})))}catch{se("Erreur lors du rordonnancement. Rechargez la page.")}C.current=null}function ir(W){const fe=iee(W,x.length),je=[...x,fe];j(je),lt(je)}function rn(W,fe){const je=x.map((Te,gt)=>gt===W?fe:Te);j(je),lt(je)}function pe(W){const fe=x.filter((je,Te)=>Te!==W);j(fe),lt(fe)}function Ce(W){if(W===0)return;const fe=[...x];[fe[W-1],fe[W]]=[fe[W],fe[W-1]],j(fe),lt(fe)}function Re(W){if(W===x.length-1)return;const fe=[...x];[fe[W],fe[W+1]]=[fe[W+1],fe[W]],j(fe),lt(fe)}const He=g.useRef(null);function lt(W){v&&(He.current&&clearTimeout(He.current),He.current=setTimeout(async()=>{try{await LJ(v,W),h(fe=>fe.map(je=>je.id===v?{...je,blocs:W}:je))}catch(fe){console.error("[CoursEditorPage] Erreur sauvegarde blocs :",fe)}},1500))}function Vt(W,fe){z.current=fe,D(fe),W.dataTransfer.effectAllowed="move"}function Br(W,fe){W.preventDefault(),W.dataTransfer.dropEffect="move",O(fe)}function Ur(W,fe){W.preventDefault(),O(null),D(null);const je=z.current;if(je===null||je===fe)return;const Te=[...x],[gt]=Te.splice(je,1);Te.splice(fe,0,gt);const qt=Te.map((bn,Ji)=>({...bn,ordre:Ji}));j(qt),lt(qt),z.current=null}function J(){O(null),D(null),z.current=null}return L?r.jsxs("div",{className:"cours-editor__loading","aria-busy":"true",children:[r.jsx("div",{className:"spinner spinner--blue"}),r.jsx("p",{children:"Chargement de l'diteur..."})]}):r.jsxs("div",{className:"cours-editor",children:[r.jsxs("header",{className:"cours-editor__header",children:[r.jsxs("p",{className:"cours-editor__breadcrumb",children:[r.jsx("button",{className:"btn-link",onClick:()=>t("/prof/cours"),children:" Mes cours"})," / ",a?"Modifier le cours":"Nouveau cours"]}),r.jsxs("div",{className:"cours-editor__header-actions",children:[r.jsx("h1",{className:"cours-editor__titre",children:a?" Modifier le cours":" Nouveau cours"}),r.jsxs("div",{className:"cours-editor__btn-group",children:[r.jsx("button",{className:"btn-secondary",onClick:()=>t("/prof/cours"),disabled:$,children:"Annuler"}),r.jsx("button",{className:"btn-secondary",onClick:()=>de(!1),disabled:$,children:$?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"spinner"})," Sauvegarde..."]}):" Sauvegarder"}),r.jsx("button",{className:"btn-primary",onClick:()=>de(!0),disabled:$||d.statut==="publie",children:d.statut==="publie"?" Publi":" Publier"})]})]}),re&&r.jsxs("div",{className:"error-banner",role:"alert",children:[" ",re]}),M&&r.jsx("div",{className:"success-banner",role:"status",children:M})]}),r.jsxs("div",{className:"cours-editor__tabs",role:"tablist",children:[r.jsx("button",{className:`cours-editor__tab ${F==="infos"?"cours-editor__tab--active":""}`,onClick:()=>R("infos"),role:"tab","aria-selected":F==="infos",children:" Informations du cours"}),r.jsxs("button",{className:`cours-editor__tab ${F==="sections"?"cours-editor__tab--active":""}`,onClick:()=>R("sections"),role:"tab","aria-selected":F==="sections",disabled:!a&&!e,children:[" Sections et contenu ",p.length>0&&`(${p.length})`]})]}),F==="infos"&&r.jsxs("section",{className:"cours-editor__form","aria-label":"Informations du cours",children:[r.jsxs("div",{className:"cours-editor__card",children:[r.jsx("h2",{className:"cours-editor__card-titre",children:" Informations gnrales"}),r.jsxs("div",{className:"cours-editor__form-grid",children:[r.jsxs("div",{className:"cours-editor__field cours-editor__field--full",children:[r.jsx("label",{htmlFor:"titre",children:"Titre du cours *"}),r.jsx("input",{id:"titre",type:"text",value:d.titre,onChange:W=>he("titre",W.target.value),placeholder:"Ex : Les fonctions affines  Terminale S",className:"cours-editor__input",required:!0})]}),r.jsxs("div",{className:"cours-editor__field cours-editor__field--full",children:[r.jsx("label",{htmlFor:"description",children:"Description *"}),r.jsx("textarea",{id:"description",value:d.description,onChange:W=>he("description",W.target.value),placeholder:"Description courte affiche dans le catalogue",className:"cours-editor__textarea",rows:3})]}),r.jsxs("div",{className:"cours-editor__field",children:[r.jsx("label",{htmlFor:"matiere",children:"Matire *"}),r.jsx("select",{id:"matiere",value:d.matiere,onChange:W=>he("matiere",W.target.value),className:"cours-editor__select",children:l.map(W=>r.jsx("option",{value:W.valeur,children:W.label},W.valeur))})]}),r.jsxs("div",{className:"cours-editor__field",children:[r.jsx("label",{htmlFor:"niveau",children:"Niveau *"}),r.jsx("select",{id:"niveau",value:d.niveau,onChange:W=>he("niveau",W.target.value),className:"cours-editor__select",children:Js.map(W=>r.jsx("option",{value:W,children:W},W))})]}),r.jsxs("div",{className:"cours-editor__field",children:[r.jsx("label",{htmlFor:"classe",children:"Classe (optionnelle)"}),r.jsx("input",{id:"classe",type:"text",value:d.classe??"",onChange:W=>he("classe",W.target.value),placeholder:"Ex : 3me A, TS, L2",className:"cours-editor__input"})]}),r.jsxs("div",{className:"cours-editor__field",children:[r.jsxs("label",{htmlFor:"couverture",children:[" Image de couverture",r.jsx("span",{className:"cours-editor__label-hint",children:"(JPG, PNG, WebP  max 5 Mo)"})]}),r.jsx(uP,{storagePath:`${u}/couverture`,existingUrl:d.couvertureUrl,placeholder:"Glissez l'image de couverture ici ou cliquez",disabled:$,onUploadStart:()=>I(!0),onUploadComplete:W=>{he("couvertureUrl",W),I(!1)},onUploadError:W=>{console.error("[Phase 25] Erreur couverture:",W),I(!1)},maxSizeMo:5}),K&&r.jsx("p",{className:"cours-editor__upload-hint",children:" Upload en cours, patientez avant d'enregistrer"})]}),r.jsx("div",{className:"cours-editor__field cours-editor__field--full",children:r.jsxs("label",{className:"cours-editor__toggle-label",children:[r.jsx("input",{type:"checkbox",checked:d.isPremium,onChange:W=>he("isPremium",W.target.checked)}),r.jsx("span",{children:" Cours Premium  Les sections (sauf la 1re) ncessitent un abonnement"})]})})]})]}),r.jsxs("div",{className:"cours-editor__card",children:[r.jsx("h2",{className:"cours-editor__card-titre",children:" Objectifs pdagogiques"}),d.objectifs.map((W,fe)=>r.jsxs("div",{className:"cours-editor__objectif-row",children:[r.jsx("input",{type:"text",value:W,onChange:je=>ge(fe,je.target.value),placeholder:`Objectif ${fe+1} (ex : Savoir calculer une drive)`,className:"cours-editor__input"}),d.objectifs.length>1&&r.jsx("button",{type:"button",className:"btn-icon btn-icon--danger",onClick:()=>ve(fe),title:"Supprimer cet objectif",children:""})]},fe)),r.jsx("button",{type:"button",className:"btn-link",onClick:Q,children:"+ Ajouter un objectif"})]}),r.jsxs("div",{className:"cours-editor__card",children:[r.jsx("h2",{className:"cours-editor__card-titre",children:" Prrequis et tags"}),r.jsxs("div",{className:"cours-editor__field",children:[r.jsx("label",{htmlFor:"prerequis",children:"Prrequis conseills"}),r.jsx("input",{id:"prerequis",type:"text",value:d.prerequis??"",onChange:W=>he("prerequis",W.target.value),placeholder:"Ex : Matriser les quations du 2nd degr",className:"cours-editor__input"})]}),r.jsxs("div",{className:"cours-editor__field",children:[r.jsx("label",{children:"Tags (aide  la recherche)"}),r.jsxs("div",{className:"cours-editor__tags-wrapper",children:[d.tags.map(W=>r.jsxs("span",{className:"cours-editor__tag",children:[W,r.jsx("button",{type:"button",onClick:()=>H(W),"aria-label":`Supprimer le tag ${W}`,children:""})]},W)),r.jsxs("div",{className:"cours-editor__tag-input-row",children:[r.jsx("input",{type:"text",value:Me,onChange:W=>ce(W.target.value),onKeyDown:W=>W.key==="Enter"&&(W.preventDefault(),Z()),placeholder:"Ajouter un tag...",className:"cours-editor__input cours-editor__input--sm"}),r.jsx("button",{type:"button",className:"btn-secondary btn--sm",onClick:Z,children:"+ Tag"})]})]})]})]})]}),F==="sections"&&r.jsx("section",{className:"cours-editor__sections","aria-label":"diteur de sections",children:a?r.jsxs("div",{className:"cours-editor__sections-layout",children:[r.jsxs("aside",{className:"cours-editor__sections-sidebar",children:[r.jsxs("div",{className:"cours-editor__sections-sidebar-header",children:[r.jsx("h2",{children:" Sections"}),r.jsx("button",{className:"btn-primary btn--sm",onClick:qe,children:"+ Ajouter"})]}),p.length===0?r.jsx("p",{className:"cours-editor__sections-empty-hint",children:'Aucune section. Cliquez sur "+ Ajouter" pour commencer.'}):r.jsx("ol",{className:"cours-editor__sections-liste",children:p.map((W,fe)=>r.jsxs("li",{className:["cours-editor__section-item",W.id===v?"cours-editor__section-item--active":"",E===fe?"cours-editor__section-item--drag-over":""].join(" "),draggable:!0,onDragStart:je=>nt(je,fe),onDragOver:je=>gr(je,fe),onDrop:je=>Dr(je,fe),onDragEnd:()=>w(null),children:[r.jsx("span",{className:"cours-editor__section-drag","aria-hidden":"true",children:""}),r.jsxs("button",{className:"cours-editor__section-btn",onClick:()=>b(W.id),"aria-current":W.id===v?"true":void 0,children:[r.jsx("span",{className:"cours-editor__section-ordre",children:W.ordre}),r.jsxs("span",{className:"cours-editor__section-nom",children:[W.titre,W.estGratuite&&r.jsx("span",{className:"cours-editor__section-gratuite",title:"Section gratuite",children:"G"})]}),r.jsxs("span",{className:"cours-editor__section-blocs-count",children:[W.blocs.length," bloc",W.blocs.length>1?"s":""]})]}),r.jsx("button",{className:"btn-icon btn-icon--danger btn-icon--xs",onClick:()=>We(W.id),title:"Supprimer cette section","aria-label":`Supprimer la section ${W.titre}`,children:""})]},W.id))})]}),v?r.jsxs("div",{className:"cours-editor__section-content",children:[r.jsxs("div",{className:"cours-editor__section-titre-row",children:[r.jsx("input",{type:"text",value:N,onChange:W=>S(W.target.value),onBlur:Xe,className:"cours-editor__section-titre-input",placeholder:"Titre de la section","aria-label":"Titre de la section"}),r.jsxs("label",{className:"cours-editor__toggle-label",children:[r.jsx("input",{type:"checkbox",checked:p.find(W=>W.id===v)?.estGratuite??!1,onChange:async W=>{try{await XE(v,{estGratuite:W.target.checked}),h(fe=>fe.map(je=>je.id===v?{...je,estGratuite:W.target.checked}:je))}catch{}}}),r.jsx("span",{children:"Gratuite"})]})]}),r.jsxs("div",{className:"cours-editor__palette","aria-label":"Ajouter un bloc",children:[r.jsx("span",{className:"cours-editor__palette-label",children:"Ajouter un bloc :"}),Object.keys(Ab).map(W=>{const fe=Ab[W];return r.jsxs("button",{className:"cours-editor__palette-btn",onClick:()=>ir(W),title:fe.description,children:[fe.emoji," ",fe.label]},W)})]}),x.length===0?r.jsxs("div",{className:"cours-editor__blocs-empty",children:[r.jsx("p",{children:" Aucun bloc dans cette section."}),r.jsx("p",{children:"Utilisez la palette ci-dessus pour ajouter du contenu."})]}):r.jsx("div",{className:"cours-editor__blocs-liste","aria-label":"Blocs de la section",children:x.map((W,fe)=>r.jsx(see,{bloc:W,index:fe,total:x.length,onUpdate:je=>rn(fe,je),onDelete:()=>pe(fe),onMoveUp:()=>Ce(fe),onMoveDown:()=>Re(fe),isDragging:P===fe,onDragStart:Vt,onDragOver:Br,onDrop:Ur,onDragEnd:J,dragOverIndex:k,storageBasePath:`${u}/section-${v}`,onBlocUploadStart:je=>{const Te=`${v}-${je}`;Y(gt=>({...gt,[Te]:!0}))},onBlocUploadEnd:je=>{const Te=`${v}-${je}`;Y(gt=>({...gt,[Te]:!1}))}},W.id))})]}):r.jsx("div",{className:"cours-editor__section-content-empty",children:r.jsx("p",{children:"Slectionnez ou crez une section pour commencer  diter."})})]}):r.jsxs("div",{className:"cours-editor__sections-empty",children:[r.jsx("p",{children:"Sauvegardez d'abord les informations du cours pour ajouter des sections."}),r.jsx("button",{className:"btn-primary",onClick:()=>R("infos"),children:" Revenir aux informations"})]})})]})}function lee({cours:e,onModifier:t,onPublier:n,onArchiver:a,onSupprimer:l,onVoirStats:o}){const u=BJ[e.statut],d=bj.find(f=>f.valeur===e.niveau)?.label??e.niveau;return r.jsxs("article",{className:"prof-cours-card",children:[r.jsxs("div",{className:"prof-cours-card__header",children:[r.jsxs("div",{className:"prof-cours-card__header-left",children:[r.jsx("span",{className:"prof-cours-card__statut",style:{color:u.couleur,background:u.bg},children:u.label}),e.isPremium&&r.jsx("span",{className:"badge badge--premium",children:" Premium"})]}),r.jsxs("div",{className:"prof-cours-card__actions",children:[r.jsx("button",{className:"btn-icon",onClick:t,title:"Modifier","aria-label":`Modifier ${e.titre}`,children:""}),e.statut==="brouillon"&&r.jsx("button",{className:"btn-icon btn-icon--success",onClick:n,title:"Publier","aria-label":`Publier ${e.titre}`,children:""}),e.statut==="publie"&&r.jsx("button",{className:"btn-icon",onClick:a,title:"Archiver","aria-label":`Archiver ${e.titre}`,children:""}),r.jsx("button",{className:"btn-icon btn-icon--info",onClick:o,title:"Voir les statistiques","aria-label":`Statistiques de ${e.titre}`,children:""}),r.jsx("button",{className:"btn-icon btn-icon--danger",onClick:l,title:"Supprimer","aria-label":`Supprimer ${e.titre}`,children:""})]})]}),r.jsxs("div",{className:"prof-cours-card__body",children:[r.jsx("h3",{className:"prof-cours-card__titre",children:e.titre}),r.jsx("p",{className:"prof-cours-card__description",children:e.description}),r.jsxs("div",{className:"prof-cours-card__meta",children:[r.jsx("span",{className:"badge badge--matiere",children:e.matiere}),r.jsx("span",{className:"badge badge--niveau",children:d}),e.classe&&r.jsx("span",{className:"badge badge--classe",children:e.classe})]})]}),r.jsxs("div",{className:"prof-cours-card__footer",children:[r.jsxs("span",{title:"Sections",children:[" ",e.nombreSections," section",e.nombreSections>1?"s":""]}),r.jsxs("span",{title:"Dure estime",children:[" ",e.dureeEstimee," min"]}),r.jsxs("span",{title:"lves inscrits",children:[" ",e.nombreInscrits," lve",e.nombreInscrits>1?"s":""]})]})]})}function oee({cours:e,onClose:t}){const[n,a]=g.useState(null),[l,o]=g.useState(!0);g.useEffect(()=>{u()},[e.id]);async function u(){try{const d=await GJ(e.id);a(YJ(d))}catch(d){console.error("[StatsModal] Erreur :",d)}finally{o(!1)}}return r.jsx("div",{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":`Statistiques du cours : ${e.titre}`,onClick:d=>{d.target===d.currentTarget&&t()},children:r.jsxs("div",{className:"modal-content",children:[r.jsxs("div",{className:"modal-header",children:[r.jsxs("h2",{children:[" Statistiques  ",e.titre]}),r.jsx("button",{className:"btn-icon",onClick:t,"aria-label":"Fermer",children:""})]}),r.jsx("div",{className:"modal-body",children:l?r.jsxs("div",{className:"modal-loading",children:[r.jsx("div",{className:"spinner spinner--blue"}),r.jsx("p",{children:"Chargement des statistiques..."})]}):n?r.jsxs("div",{className:"stats-grid",children:[r.jsxs("div",{className:"stats-card",children:[r.jsx("span",{className:"stats-card__val",children:n.nombreInscrits}),r.jsx("span",{className:"stats-card__label",children:"lves inscrits"})]}),r.jsxs("div",{className:"stats-card stats-card--success",children:[r.jsx("span",{className:"stats-card__val",children:n.nombreTermines}),r.jsx("span",{className:"stats-card__label",children:"Cours termins"})]}),r.jsxs("div",{className:"stats-card stats-card--info",children:[r.jsxs("span",{className:"stats-card__val",children:[n.tauxCompletion,"%"]}),r.jsx("span",{className:"stats-card__label",children:"Taux de compltion"})]}),r.jsxs("div",{className:"stats-card",children:[r.jsxs("span",{className:"stats-card__val",children:[n.progressionMoyenne,"%"]}),r.jsx("span",{className:"stats-card__label",children:"Progression moyenne"})]}),r.jsxs("div",{className:"stats-card stats-card--primary",children:[r.jsxs("span",{className:"stats-card__val",children:[n.scoreMoyen,"%"]}),r.jsx("span",{className:"stats-card__label",children:"Score moyen aux quiz"})]}),r.jsxs("div",{className:"stats-progress-bar-wrapper",children:[r.jsx("label",{children:"Progression globale des lves"}),r.jsx("div",{className:"progression-bar",children:r.jsx("div",{className:"progression-bar__fill",style:{width:`${n.progressionMoyenne}%`}})})]})]}):r.jsx("p",{className:"modal-vide",children:"Aucune donne disponible pour ce cours."})})]})})}function cee(){const e=st(),{currentUser:t}=rt(),[n,a]=g.useState([]),[l,o]=g.useState([]),[u,d]=g.useState(!0),[f,p]=g.useState(null),[h,v]=g.useState(null),[b,x]=g.useState(""),[j,N]=g.useState(null);g.useEffect(()=>{t&&S()},[t]);async function S(){if(t){d(!0),p(null);try{const O=await kJ(t.uid);a(O),o(O)}catch{p("Impossible de charger vos cours.")}finally{d(!1)}}}function C(O){x(O),o(O?n.filter(P=>P.statut===O):n)}async function E(O){if(confirm("Publier ce cours dans le catalogue ?"))try{await Eb(O),a(P=>P.map(D=>D.id===O?{...D,statut:"publie"}:D)),o(P=>P.map(D=>D.id===O?{...D,statut:"publie"}:D)),k(" Cours publi dans le catalogue !")}catch{p("Erreur lors de la publication.")}}async function w(O){if(confirm("Archiver ce cours ? Il ne sera plus visible dans le catalogue."))try{await PJ(O),a(P=>P.map(D=>D.id===O?{...D,statut:"archive"}:D)),o(P=>P.map(D=>D.id===O?{...D,statut:"archive"}:D)),k(" Cours archiv.")}catch{p("Erreur lors de l'archivage.")}}async function z(O,P){if(confirm(`Supprimer dfinitivement le cours "${P}" et tout son contenu ? Cette action est irrversible.`))try{await TJ(O);const D=n.filter(L=>L.id!==O);a(D),o(D.filter(L=>!b||L.statut===b)),k(" Cours supprim.")}catch{p("Erreur lors de la suppression.")}}function k(O){v(O),setTimeout(()=>v(null),4e3)}return r.jsxs("div",{className:"prof-cours-page",children:[r.jsxs("header",{className:"prof-cours-page__header",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"prof-cours-page__titre",children:" Mes cours en ligne"}),r.jsx("p",{className:"prof-cours-page__sous-titre",children:"Crez, grez et publiez vos cours pour vos lves."})]}),r.jsx("button",{className:"btn-primary",onClick:()=>e("/prof/cours/nouveau"),children:" Crer un cours"})]}),f&&r.jsxs("div",{className:"error-banner",role:"alert",children:[" ",f]}),h&&r.jsx("div",{className:"success-banner",role:"status",children:h}),!u&&n.length>0&&r.jsxs("div",{className:"prof-cours-page__stats","aria-label":"Rsum de mes cours",children:[r.jsxs("div",{className:"prof-cours-page__stat",children:[r.jsx("span",{className:"prof-cours-page__stat-val",children:n.length}),r.jsx("span",{children:"Total"})]}),r.jsxs("div",{className:"prof-cours-page__stat",children:[r.jsx("span",{className:"prof-cours-page__stat-val",style:{color:"#16a34a"},children:n.filter(O=>O.statut==="publie").length}),r.jsx("span",{children:"Publis"})]}),r.jsxs("div",{className:"prof-cours-page__stat",children:[r.jsx("span",{className:"prof-cours-page__stat-val",style:{color:"#ca8a04"},children:n.filter(O=>O.statut==="brouillon").length}),r.jsx("span",{children:"Brouillons"})]}),r.jsxs("div",{className:"prof-cours-page__stat",children:[r.jsx("span",{className:"prof-cours-page__stat-val",style:{color:"#2563eb"},children:n.reduce((O,P)=>O+P.nombreInscrits,0)}),r.jsx("span",{children:"lves inscrits"})]})]}),!u&&n.length>0&&r.jsx("div",{className:"prof-cours-page__filtres",role:"tablist","aria-label":"Filtrer par statut",children:[{val:"",label:`Tous (${n.length})`},{val:"publie",label:`Publis (${n.filter(O=>O.statut==="publie").length})`},{val:"brouillon",label:`Brouillons (${n.filter(O=>O.statut==="brouillon").length})`},{val:"archive",label:`Archivs (${n.filter(O=>O.statut==="archive").length})`}].map(O=>r.jsx("button",{className:`prof-cours-page__filtre-btn ${b===O.val?"prof-cours-page__filtre-btn--active":""}`,onClick:()=>C(O.val),role:"tab","aria-selected":b===O.val,children:O.label},O.val))}),r.jsxs("main",{className:"prof-cours-page__grille",children:[u&&r.jsx("div",{className:"prof-cours-page__grille-inner","aria-busy":"true",children:[1,2,3].map(O=>r.jsxs("div",{className:"prof-cours-card prof-cours-card--skeleton",children:[r.jsx("div",{className:"skeleton",style:{height:20,marginBottom:12}}),r.jsx("div",{className:"skeleton",style:{height:16,width:"60%",marginBottom:8}}),r.jsx("div",{className:"skeleton",style:{height:14,width:"80%"}})]},O))}),!u&&l.length>0&&r.jsx("div",{className:"prof-cours-page__grille-inner",children:l.map(O=>r.jsx(lee,{cours:O,onModifier:()=>e(`/prof/cours/${O.id}/modifier`),onPublier:()=>E(O.id),onArchiver:()=>w(O.id),onSupprimer:()=>z(O.id,O.titre),onVoirStats:()=>N(O)},O.id))}),!u&&l.length===0&&r.jsxs("div",{className:"prof-cours-page__vide",role:"status",children:[r.jsx("span",{"aria-hidden":"true",children:""}),r.jsx("h3",{children:n.length===0?"Vous n'avez pas encore cr de cours.":"Aucun cours dans cette catgorie."}),n.length===0&&r.jsx("button",{className:"btn-primary",onClick:()=>e("/prof/cours/nouveau"),children:" Crer mon premier cours"})]})]}),j&&r.jsx(oee,{cours:j,onClose:()=>N(null)})]})}const Gi={manuel:"Manuels scolaires",annale:"Annales corriges",guide:"Guides de rvision",litterature:"Culture gnrale & Littrature",fiche:"Fiches de lectures"},Hi={manuel:"",annale:"",guide:"",litterature:"",fiche:""},ci="ebooks";async function uee(){try{const e=ke(_e(X,ci),Se("isActive","==",!0),Ke("ordre","asc"));return(await ze(e)).docs.map(n=>({id:n.id,...n.data(),createdAt:n.data().createdAt?.toDate()||new Date,updatedAt:n.data().updatedAt?.toDate()||null}))}catch(e){throw console.error(" Erreur rcupration ebooks:",e),e}}async function dee(){try{const e=ke(_e(X,ci),Ke("ordre","asc"));return(await ze(e)).docs.map(n=>({id:n.id,...n.data(),createdAt:n.data().createdAt?.toDate()||new Date,updatedAt:n.data().updatedAt?.toDate()||null}))}catch(e){throw console.error(" Erreur rcupration ebooks admin:",e),e}}async function mee(e){try{const t=await Ot(Ne(X,ci,e));return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt?.toDate()||new Date,updatedAt:t.data().updatedAt?.toDate()||null}:null}catch(t){throw console.error(" Erreur rcupration ebook:",t),t}}function fee(e,t){let n=[...e];if(t.categorie&&t.categorie!=="all"&&(n=n.filter(a=>a.categorie===t.categorie)),t.niveau&&t.niveau!=="all"&&(n=n.filter(a=>a.niveau===t.niveau)),t.classe&&t.classe!=="all"&&(n=n.filter(a=>a.classe===t.classe||a.classe==="all")),t.matiere&&(n=n.filter(a=>a.matiere?.toLowerCase().includes(t.matiere.toLowerCase()))),t.recherche){const a=t.recherche.toLowerCase();n=n.filter(l=>l.titre.toLowerCase().includes(a)||l.auteur.toLowerCase().includes(a)||l.description.toLowerCase().includes(a)||l.tags?.some(o=>o.toLowerCase().includes(a)))}return n}async function pee(e,t,n,a,l){try{const o=qr(Or,`ebooks/pdf/${Date.now()}_${t.name}`);await zs(o,t);const u=await da(o);let d="";if(n){const v=qr(Or,`ebooks/covers/${Date.now()}_${n.name}`);await zs(v,n),d=await da(v)}let f="";if(a){const v=qr(Or,`ebooks/previews/${Date.now()}_${a.name}`);await zs(v,a),f=await da(v)}const p={...e,fichierURL:u,couvertureURL:d,aperuURL:f,tailleFichier:t.size,nombreTelechargements:0,nombreVues:0,uploadedBy:l||"admin",createdAt:Mt(),updatedAt:Mt()},h=await Tt(_e(X,ci),p);return console.log(` Ebook ajout : ${e.titre} (ID: ${h.id})`),h.id}catch(o){throw console.error(" Erreur ajout ebook:",o),o}}async function hee(e,t,n,a,l){try{const o={...t,updatedAt:Mt()};if(n){const u=qr(Or,`ebooks/pdf/${Date.now()}_${n.name}`);await zs(u,n),o.fichierURL=await da(u),o.tailleFichier=n.size}if(a){const u=qr(Or,`ebooks/covers/${Date.now()}_${a.name}`);await zs(u,a),o.couvertureURL=await da(u)}if(l){const u=qr(Or,`ebooks/previews/${Date.now()}_${l.name}`);await zs(u,l),o.aperuURL=await da(u)}await Qe(Ne(X,ci,e),o),console.log(` Ebook mis  jour : ${e}`)}catch(o){throw console.error(" Erreur mise  jour ebook:",o),o}}async function vee(e){try{const t=await mee(e);if(!t)throw new Error("Ebook introuvable");try{if(t.fichierURL){const n=qr(Or,t.fichierURL);await Dc(n)}if(t.couvertureURL){const n=qr(Or,t.couvertureURL);await Dc(n)}if(t.aperuURL){const n=qr(Or,t.aperuURL);await Dc(n)}}catch{console.warn(" Fichiers Storage non supprims (peut-tre dj supprims)")}await en(Ne(X,ci,e)),console.log(` Ebook supprim : ${e}`)}catch(t){throw console.error(" Erreur suppression ebook:",t),t}}async function gee(e,t){try{await Qe(Ne(X,ci,e),{isActive:t,updatedAt:Mt()})}catch(n){throw console.error(" Erreur toggle ebook:",n),n}}async function xee(e){try{await Qe(Ne(X,ci,e),{nombreVues:Hs(1)})}catch(t){console.error(" Erreur incrment vues:",t)}}async function bee(e){try{await Qe(Ne(X,ci,e),{nombreTelechargements:Hs(1)})}catch(t){console.error(" Erreur incrment tlchargements:",t)}}function yee(e){const t={totalEbooks:e.length,totalTelechargements:0,totalVues:0,parCategorie:{manuel:0,annale:0,guide:0,litterature:0,fiche:0},ebooksActifs:0};return e.forEach(n=>{t.totalTelechargements+=n.nombreTelechargements||0,t.totalVues+=n.nombreVues||0,t.parCategorie[n.categorie]=(t.parCategorie[n.categorie]||0)+1,n.isActive&&t.ebooksActifs++}),t}function qc(e){return e<1024?`${e} o`:e<1024*1024?`${(e/1024).toFixed(1)} Ko`:`${(e/(1024*1024)).toFixed(1)} Mo`}const dP=["Mathmatiques","Physique-Chimie","SVT","Franais","Anglais","Histoire-Gographie","Philosophie","conomie","Comptabilit","ducation civique","Arabe","Espagnol","Informatique"],jee=({isPremium:e,onReadEbook:t})=>{const[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState({categorie:"all",niveau:"all",classe:"all",matiere:"",recherche:""}),[h,v]=g.useState("grid");g.useEffect(()=>{b()},[]);const b=async()=>{try{o(!0),d(null);const C=await uee();a(C)}catch(C){d("Erreur lors du chargement de la bibliothque"),console.error(C)}finally{o(!1)}},x=g.useMemo(()=>fee(n,f),[n,f]),j=g.useMemo(()=>{const C={all:n.length};return n.forEach(E=>{C[E.categorie]=(C[E.categorie]||0)+1}),C},[n]),N=(C,E)=>{p(w=>({...w,[C]:E}))},S=()=>{p({categorie:"all",niveau:"all",classe:"all",matiere:"",recherche:""})};return l?r.jsx("div",{className:"ebook-library",children:r.jsxs("div",{className:"ebook-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Chargement de la bibliothque..."})]})}):u?r.jsx("div",{className:"ebook-library",children:r.jsxs("div",{className:"ebook-error",children:[r.jsxs("p",{children:[" ",u]}),r.jsx("button",{onClick:b,className:"btn-retry",children:"Ressayer"})]})}):r.jsxs("div",{className:"ebook-library",children:[r.jsxs("div",{className:"ebook-library-header",children:[r.jsxs("div",{className:"ebook-header-content",children:[r.jsx("h1",{children:" Bibliothque PedaClic"}),r.jsxs("p",{className:"ebook-subtitle",children:["Manuels, annales, fiches de rvision et bien plus encore",!e&&r.jsx("span",{className:"preview-badge",children:"Aperu gratuit disponible"})]})]}),r.jsxs("div",{className:"ebook-search-bar",children:[r.jsx("input",{type:"text",placeholder:"Rechercher un ebook (titre, auteur, mot-cl)...",value:f.recherche||"",onChange:C=>N("recherche",C.target.value),className:"search-input"}),r.jsx("span",{className:"search-icon",children:""})]})]}),r.jsxs("div",{className:"ebook-categories",children:[r.jsxs("button",{className:`category-tab ${f.categorie==="all"?"active":""}`,onClick:()=>N("categorie","all"),children:[" Tous",r.jsx("span",{className:"category-count",children:j.all||0})]}),Object.keys(Gi).map(C=>r.jsxs("button",{className:`category-tab ${f.categorie===C?"active":""}`,onClick:()=>N("categorie",C),children:[Hi[C]," ",Gi[C],r.jsx("span",{className:"category-count",children:j[C]||0})]},C))]}),r.jsxs("div",{className:"ebook-filters",children:[r.jsxs("select",{value:f.niveau||"all",onChange:C=>N("niveau",C.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Tous les niveaux"}),r.jsx("option",{value:"college",children:"Collge"}),r.jsx("option",{value:"lycee",children:"Lyce"})]}),r.jsxs("select",{value:f.classe||"all",onChange:C=>N("classe",C.target.value),className:"filter-select",children:[r.jsx("option",{value:"all",children:"Toutes les classes"}),r.jsx("option",{value:"6eme",children:"6me"}),r.jsx("option",{value:"5eme",children:"5me"}),r.jsx("option",{value:"4eme",children:"4me"}),r.jsx("option",{value:"3eme",children:"3me"}),r.jsx("option",{value:"2nde",children:"2nde"}),r.jsx("option",{value:"1ere",children:"1re"}),r.jsx("option",{value:"Terminale",children:"Terminale"})]}),r.jsxs("select",{value:f.matiere||"",onChange:C=>N("matiere",C.target.value),className:"filter-select",children:[r.jsx("option",{value:"",children:"Toutes les matires"}),dP.map(C=>r.jsx("option",{value:C,children:C},C))]}),r.jsxs("div",{className:"view-toggle",children:[r.jsx("button",{className:h==="grid"?"active":"",onClick:()=>v("grid"),title:"Vue grille",children:""}),r.jsx("button",{className:h==="list"?"active":"",onClick:()=>v("list"),title:"Vue liste",children:""})]}),(f.categorie!=="all"||f.niveau!=="all"||f.classe!=="all"||f.matiere||f.recherche)&&r.jsx("button",{onClick:S,className:"btn-reset-filters",children:" Rinitialiser"})]}),r.jsx("div",{className:"ebook-results-info",children:r.jsxs("span",{children:[x.length," ebook",x.length>1?"s":""," trouv",x.length>1?"s":""]})}),x.length===0?r.jsxs("div",{className:"ebook-empty",children:[r.jsx("p",{children:" Aucun ebook trouv avec ces filtres."}),r.jsx("button",{onClick:S,className:"btn-reset-filters",children:"Voir tous les ebooks"})]}):r.jsx("div",{className:`ebook-grid ${h==="list"?"list-view":""}`,children:x.map(C=>r.jsx(Nee,{ebook:C,isPremium:e,onRead:()=>t(C),viewMode:h},C.id))}),!e&&x.length>0&&r.jsx("div",{className:"ebook-premium-banner",children:r.jsxs("div",{className:"premium-banner-content",children:[r.jsx("h3",{children:" Accdez  tous les ebooks en illimit"}),r.jsx("p",{children:"Abonnez-vous  PedaClic Premium pour lire et tlcharger tous les manuels, annales et fiches de rvision sans limite."}),r.jsx("a",{href:"/premium",className:"btn-premium",children:"S'abonner  2 000 FCFA/mois"})]})})]})},Nee=({ebook:e,isPremium:t,onRead:n,viewMode:a})=>r.jsxs("div",{className:`ebook-card ${a==="list"?"ebook-card-list":""}`,children:[r.jsxs("div",{className:"ebook-cover",onClick:n,children:[e.couvertureURL?r.jsx("img",{src:e.couvertureURL,alt:e.titre,loading:"lazy"}):r.jsxs("div",{className:"ebook-cover-placeholder",children:[r.jsx("span",{className:"cover-icon",children:Hi[e.categorie]}),r.jsx("span",{className:"cover-title",children:e.titre})]}),!t&&r.jsx("div",{className:"ebook-badge-premium",children:r.jsx("span",{children:" Premium"})}),r.jsx("div",{className:"ebook-badge-category",children:Gi[e.categorie]})]}),r.jsxs("div",{className:"ebook-info",children:[r.jsx("h3",{className:"ebook-title",onClick:n,children:e.titre}),r.jsx("p",{className:"ebook-author",children:e.auteur}),r.jsx("p",{className:"ebook-description",children:e.description}),r.jsxs("div",{className:"ebook-meta",children:[e.classe!=="all"&&r.jsx("span",{className:"meta-tag",children:e.classe}),e.matiere&&r.jsx("span",{className:"meta-tag",children:e.matiere}),r.jsxs("span",{className:"meta-pages",children:[e.nombrePages," pages"]}),r.jsx("span",{className:"meta-size",children:qc(e.tailleFichier)})]}),r.jsxs("div",{className:"ebook-actions",children:[r.jsx("button",{className:"btn-read",onClick:n,children:t?" Lire":` Aperu (${e.pagesApercu} pages)`}),t&&r.jsx("a",{href:e.fichierURL,target:"_blank",rel:"noopener noreferrer",className:"btn-download",download:!0,children:" Tlcharger"})]})]})]}),_ee=({ebook:e,isPremium:t,onBack:n,onGoPremium:a})=>{const[l,o]=g.useState(!0),[u,d]=g.useState("info");g.useEffect(()=>{xee(e.id)},[e.id]);const f=()=>t?e.fichierURL:e.aperuURL?e.aperuURL:null,p=async()=>{if(!t){a();return}await bee(e.id),window.open(e.fichierURL,"_blank")},h=()=>{o(!1)};return r.jsxs("div",{className:"ebook-viewer",children:[r.jsxs("div",{className:"viewer-navbar",children:[r.jsx("button",{onClick:n,className:"btn-back",children:" Retour  la bibliothque"}),r.jsxs("div",{className:"viewer-title-bar",children:[r.jsxs("span",{className:"viewer-category",children:[Hi[e.categorie]," ",Gi[e.categorie]]}),r.jsx("h2",{className:"viewer-title",children:e.titre})]}),r.jsxs("div",{className:"viewer-actions-bar",children:[r.jsx("button",{className:`btn-tab ${u==="info"?"active":""}`,onClick:()=>d("info"),children:" Dtails"}),r.jsxs("button",{className:`btn-tab ${u==="read"?"active":""}`,onClick:()=>d("read"),children:[" ",t?"Lire":"Aperu"]})]})]}),u==="info"&&r.jsx("div",{className:"viewer-info-panel",children:r.jsxs("div",{className:"info-layout",children:[r.jsxs("div",{className:"info-cover-column",children:[e.couvertureURL?r.jsx("img",{src:e.couvertureURL,alt:e.titre,className:"info-cover-image"}):r.jsxs("div",{className:"info-cover-placeholder",children:[r.jsx("span",{children:Hi[e.categorie]}),r.jsx("span",{children:e.titre})]}),r.jsxs("div",{className:"info-actions",children:[r.jsxs("button",{className:"btn-action-read",onClick:()=>d("read"),children:[" ",t?"Lire le document":`Aperu (${e.pagesApercu} pages)`]}),t?r.jsx("button",{className:"btn-action-download",onClick:p,children:" Tlcharger le PDF"}):r.jsx("button",{className:"btn-action-premium",onClick:a,children:" Accs complet  Passer Premium"})]})]}),r.jsxs("div",{className:"info-details-column",children:[r.jsx("h1",{className:"info-title",children:e.titre}),r.jsxs("p",{className:"info-author",children:["par ",e.auteur]}),r.jsxs("div",{className:"info-description",children:[r.jsx("h3",{children:"Description"}),r.jsx("p",{children:e.description})]}),r.jsxs("div",{className:"info-metadata",children:[r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Catgorie"}),r.jsxs("span",{className:"metadata-value",children:[Hi[e.categorie]," ",Gi[e.categorie]]})]}),r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Niveau"}),r.jsx("span",{className:"metadata-value",children:e.niveau==="college"?"Collge":"Lyce"})]}),e.classe!=="all"&&r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Classe"}),r.jsx("span",{className:"metadata-value",children:e.classe})]}),e.matiere&&r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Matire"}),r.jsx("span",{className:"metadata-value",children:e.matiere})]}),r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Pages"}),r.jsx("span",{className:"metadata-value",children:e.nombrePages})]}),r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Taille"}),r.jsx("span",{className:"metadata-value",children:qc(e.tailleFichier)})]}),e.annee&&r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"Anne"}),r.jsx("span",{className:"metadata-value",children:e.annee})]}),e.editeur&&r.jsxs("div",{className:"metadata-item",children:[r.jsx("span",{className:"metadata-label",children:"diteur"}),r.jsx("span",{className:"metadata-value",children:e.editeur})]})]}),r.jsxs("div",{className:"info-stats",children:[r.jsxs("span",{children:[" ",e.nombreVues," vue",e.nombreVues>1?"s":""]}),r.jsxs("span",{children:[" ",e.nombreTelechargements," tlchargement",e.nombreTelechargements>1?"s":""]})]}),e.tags&&e.tags.length>0&&r.jsx("div",{className:"info-tags",children:e.tags.map((v,b)=>r.jsx("span",{className:"info-tag",children:v},b))})]})]})}),u==="read"&&r.jsx("div",{className:"viewer-read-panel",children:f()?r.jsxs(r.Fragment,{children:[l&&r.jsxs("div",{className:"viewer-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Chargement du document..."})]}),r.jsx("iframe",{src:`${f()}#toolbar=1&navpanes=0`,className:"pdf-iframe",title:e.titre,onLoad:h,style:{display:l?"none":"block"}}),!t&&r.jsx("div",{className:"viewer-premium-overlay",children:r.jsxs("div",{className:"overlay-content",children:[r.jsx("div",{className:"overlay-lock",children:""}),r.jsxs("h3",{children:["Aperu limit  ",e.pagesApercu," pages"]}),r.jsxs("p",{children:["Pour lire l'intgralit de ce document (",e.nombrePages," pages) et le tlcharger, passez  PedaClic Premium."]}),r.jsx("button",{onClick:a,className:"btn-overlay-premium",children:"Passer Premium  2 000 FCFA/mois"}),r.jsx("button",{onClick:n,className:"btn-overlay-back",children:"Retour  la bibliothque"})]})})]}):r.jsx("div",{className:"viewer-no-preview",children:r.jsxs("div",{className:"no-preview-content",children:[r.jsx("div",{className:"overlay-lock",children:""}),r.jsx("h3",{children:"Document rserv aux abonns Premium"}),r.jsxs("p",{children:["Ce document de ",e.nombrePages," pages est accessible uniquement avec un abonnement PedaClic Premium."]}),r.jsx("button",{onClick:a,className:"btn-overlay-premium",children:"Passer Premium  2 000 FCFA/mois"}),r.jsx("button",{onClick:n,className:"btn-overlay-back",children:"Retour  la bibliothque"})]})})})]})},See=()=>{const{currentUser:e}=rt(),t=st(),[n,a]=g.useState(null),l=d=>{a(d)},o=()=>{a(null)},u=()=>{t("/premium")};return n?r.jsx(_ee,{ebook:n,isPremium:e?.isPremium||!1,onBack:o,onGoPremium:u}):r.jsx(jee,{isPremium:e?.isPremium||!1,onReadEbook:l})},wee=()=>{const[e,t]=g.useState([]),[n,a]=g.useState(!0),[l,o]=g.useState(null),[u,d]=g.useState(null),[f,p]=g.useState(!1),[h,v]=g.useState(null),[b,x]=g.useState(re()),[j,N]=g.useState(!1),[S,C]=g.useState(null),[E,w]=g.useState(null),[z,k]=g.useState(null),[O,P]=g.useState(null),D=g.useRef(null),L=g.useRef(null),U=g.useRef(null),[$,B]=g.useState(null);function re(){return{titre:"",auteur:"",description:"",categorie:"manuel",niveau:"college",classe:"all",matiere:"",nombrePages:0,pagesApercu:5,annee:"",editeur:"",isbn:"",tags:[],ordre:0,isActive:!0}}g.useEffect(()=>{se()},[]);const se=async()=>{try{a(!0),o(null);const Y=await dee();t(Y),d(yee(Y))}catch(Y){o("Erreur lors du chargement des ebooks"),console.error(Y)}finally{a(!1)}},M=Y=>{const{name:oe,value:he,type:ge}=Y.target;x(ge==="number"?Q=>({...Q,[oe]:parseInt(he)||0}):ge==="checkbox"?Q=>({...Q,[oe]:Y.target.checked}):Q=>({...Q,[oe]:he}))},q=Y=>{const oe=Y.target.value.split(",").map(he=>he.trim()).filter(Boolean);x(he=>({...he,tags:oe}))},F=async Y=>{if(Y.preventDefault(),!b.titre.trim()){o("Le titre est obligatoire");return}if(!h&&!E){o("Le fichier PDF est obligatoire");return}try{N(!0),o(null),h?(await hee(h.id,b,E,z,O),C(` Ebook "${b.titre}" modifi avec succs`)):(await pee(b,E,z,O),C(` Ebook "${b.titre}" ajout avec succs`)),te(),await se(),setTimeout(()=>C(null),4e3)}catch(oe){o(oe.message||"Erreur lors de la sauvegarde")}finally{N(!1)}},R=Y=>{v(Y),x({titre:Y.titre,auteur:Y.auteur,description:Y.description,categorie:Y.categorie,niveau:Y.niveau,classe:Y.classe,matiere:Y.matiere||"",nombrePages:Y.nombrePages,pagesApercu:Y.pagesApercu,annee:Y.annee||"",editeur:Y.editeur||"",isbn:Y.isbn||"",tags:Y.tags||[],ordre:Y.ordre,isActive:Y.isActive}),p(!0),window.scrollTo({top:0,behavior:"smooth"})},K=async Y=>{try{await vee(Y),B(null),C(" Ebook supprim avec succs"),await se(),setTimeout(()=>C(null),4e3)}catch(oe){o(oe.message||"Erreur lors de la suppression")}},I=async(Y,oe)=>{try{await gee(Y,!oe),await se()}catch(he){o(he.message)}},te=()=>{x(re()),v(null),w(null),k(null),P(null),p(!1),D.current&&(D.current.value=""),L.current&&(L.current.value=""),U.current&&(U.current.value="")};return n?r.jsx("div",{className:"admin-ebooks",children:r.jsxs("div",{className:"admin-loading",children:[r.jsx("div",{className:"loading-spinner"}),r.jsx("p",{children:"Chargement des ebooks..."})]})}):r.jsxs("div",{className:"admin-ebooks",children:[r.jsxs("div",{className:"admin-ebooks-header",children:[r.jsx("h1",{children:" Gestion de la Bibliothque"}),r.jsx("button",{className:"btn-add-ebook",onClick:()=>{te(),p(!f)},children:f?" Fermer":"+ Ajouter un ebook"})]}),l&&r.jsxs("div",{className:"admin-alert error",children:[" ",l]}),S&&r.jsx("div",{className:"admin-alert success",children:S}),u&&r.jsxs("div",{className:"admin-stats-grid",children:[r.jsxs("div",{className:"stat-card",children:[r.jsx("span",{className:"stat-number",children:u.totalEbooks}),r.jsx("span",{className:"stat-label",children:"Total ebooks"})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("span",{className:"stat-number",children:u.ebooksActifs}),r.jsx("span",{className:"stat-label",children:"Actifs"})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("span",{className:"stat-number",children:u.totalVues}),r.jsx("span",{className:"stat-label",children:"Vues totales"})]}),r.jsxs("div",{className:"stat-card",children:[r.jsx("span",{className:"stat-number",children:u.totalTelechargements}),r.jsx("span",{className:"stat-label",children:"Tlchargements"})]})]}),f&&r.jsxs("div",{className:"admin-ebook-form-container",children:[r.jsx("h2",{children:h?" Modifier l'ebook":" Ajouter un ebook"}),r.jsxs("form",{onSubmit:F,className:"admin-ebook-form",children:[r.jsxs("div",{className:"form-row",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"titre",children:"Titre *"}),r.jsx("input",{id:"titre",name:"titre",type:"text",value:b.titre,onChange:M,placeholder:"Ex: Mathmatiques 3me - Programme complet",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"auteur",children:"Auteur(s) *"}),r.jsx("input",{id:"auteur",name:"auteur",type:"text",value:b.auteur,onChange:M,placeholder:"Ex: Pr. Diallo Moussa",required:!0})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",children:"Description *"}),r.jsx("textarea",{id:"description",name:"description",value:b.description,onChange:M,placeholder:"Dcrivez le contenu de cet ebook...",rows:3,required:!0})]}),r.jsxs("div",{className:"form-row form-row-3",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"categorie",children:"Catgorie *"}),r.jsx("select",{id:"categorie",name:"categorie",value:b.categorie,onChange:M,children:Object.keys(Gi).map(Y=>r.jsxs("option",{value:Y,children:[Hi[Y]," ",Gi[Y]]},Y))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"niveau",children:"Niveau *"}),r.jsxs("select",{id:"niveau",name:"niveau",value:b.niveau,onChange:M,children:[r.jsx("option",{value:"college",children:"Collge"}),r.jsx("option",{value:"lycee",children:"Lyce"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"classe",children:"Classe"}),r.jsxs("select",{id:"classe",name:"classe",value:b.classe,onChange:M,children:[r.jsx("option",{value:"all",children:"Toutes les classes"}),r.jsx("option",{value:"6eme",children:"6me"}),r.jsx("option",{value:"5eme",children:"5me"}),r.jsx("option",{value:"4eme",children:"4me"}),r.jsx("option",{value:"3eme",children:"3me"}),r.jsx("option",{value:"2nde",children:"2nde"}),r.jsx("option",{value:"1ere",children:"1re"}),r.jsx("option",{value:"Terminale",children:"Terminale"})]})]})]}),r.jsxs("div",{className:"form-row form-row-3",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"matiere",children:"Matire"}),r.jsxs("select",{id:"matiere",name:"matiere",value:b.matiere,onChange:M,children:[r.jsx("option",{value:"",children:"-- Slectionner --"}),dP.map(Y=>r.jsx("option",{value:Y,children:Y},Y))]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"annee",children:"Anne"}),r.jsx("input",{id:"annee",name:"annee",type:"text",value:b.annee,onChange:M,placeholder:"Ex: 2024-2025"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"editeur",children:"diteur"}),r.jsx("input",{id:"editeur",name:"editeur",type:"text",value:b.editeur,onChange:M,placeholder:"Ex: INEADE"})]})]}),r.jsxs("div",{className:"form-row form-row-3",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"nombrePages",children:"Nombre de pages *"}),r.jsx("input",{id:"nombrePages",name:"nombrePages",type:"number",value:b.nombrePages,onChange:M,min:"1",required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"pagesApercu",children:"Pages en aperu gratuit"}),r.jsx("input",{id:"pagesApercu",name:"pagesApercu",type:"number",value:b.pagesApercu,onChange:M,min:"1",max:"20"}),r.jsx("small",{children:"Nombre de pages visibles sans Premium (1-20)"})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"ordre",children:"Ordre d'affichage"}),r.jsx("input",{id:"ordre",name:"ordre",type:"number",value:b.ordre,onChange:M,min:"0"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"tags",children:"Tags (spars par des virgules)"}),r.jsx("input",{id:"tags",type:"text",value:b.tags?.join(", ")||"",onChange:q,placeholder:"Ex: BFEM, annales, mathmatiques, gomtrie"})]}),r.jsxs("div",{className:"form-files-section",children:[r.jsx("h3",{children:" Fichiers"}),r.jsxs("div",{className:"form-group file-group",children:[r.jsxs("label",{children:["Fichier PDF complet ",!h&&"*",h&&r.jsx("small",{children:"(laisser vide pour garder l'actuel)"})]}),r.jsx("input",{ref:D,type:"file",accept:".pdf",onChange:Y=>w(Y.target.files?.[0]||null),className:"file-input"}),E&&r.jsxs("span",{className:"file-info",children:[" ",E.name," (",qc(E.size),")"]})]}),r.jsxs("div",{className:"form-group file-group",children:[r.jsxs("label",{children:["Image de couverture",r.jsx("small",{children:"(JPG, PNG  recommand : 400560px)"})]}),r.jsx("input",{ref:L,type:"file",accept:"image/*",onChange:Y=>k(Y.target.files?.[0]||null),className:"file-input"}),z&&r.jsxs("span",{className:"file-info",children:[" ",z.name," (",qc(z.size),")"]})]}),r.jsxs("div",{className:"form-group file-group",children:[r.jsxs("label",{children:["PDF Aperu (premires pages uniquement)",r.jsx("small",{children:"(optionnel  sinon le PDF complet est affich aux non-Premium)"})]}),r.jsx("input",{ref:U,type:"file",accept:".pdf",onChange:Y=>P(Y.target.files?.[0]||null),className:"file-input"}),O&&r.jsxs("span",{className:"file-info",children:[" ",O.name," (",qc(O.size),")"]})]})]}),r.jsx("div",{className:"form-group checkbox-group",children:r.jsxs("label",{children:[r.jsx("input",{type:"checkbox",name:"isActive",checked:b.isActive,onChange:M}),"Ebook actif (visible dans la bibliothque)"]})}),r.jsxs("div",{className:"form-actions",children:[r.jsx("button",{type:"submit",className:"btn-save",disabled:j,children:j?" Enregistrement...":h?" Modifier l'ebook":" Ajouter l'ebook"}),r.jsx("button",{type:"button",className:"btn-cancel",onClick:te,children:"Annuler"})]})]})]}),r.jsxs("div",{className:"admin-ebooks-list",children:[r.jsxs("h2",{children:[" Liste des ebooks (",e.length,")"]}),e.length===0?r.jsxs("div",{className:"admin-empty",children:[r.jsx("p",{children:"Aucun ebook pour le moment."}),r.jsx("button",{className:"btn-add-ebook",onClick:()=>p(!0),children:"+ Ajouter le premier ebook"})]}):r.jsx("div",{className:"admin-ebooks-table-wrapper",children:r.jsxs("table",{className:"admin-ebooks-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Couverture"}),r.jsx("th",{children:"Titre / Auteur"}),r.jsx("th",{children:"Catgorie"}),r.jsx("th",{children:"Classe"}),r.jsx("th",{children:"Pages"}),r.jsx("th",{children:"Vues / DL"}),r.jsx("th",{children:"Statut"}),r.jsx("th",{children:"Actions"})]})}),r.jsx("tbody",{children:e.map(Y=>r.jsxs("tr",{className:Y.isActive?"":"row-inactive",children:[r.jsx("td",{className:"td-cover",children:Y.couvertureURL?r.jsx("img",{src:Y.couvertureURL,alt:"",className:"mini-cover"}):r.jsx("div",{className:"mini-cover-placeholder",children:Hi[Y.categorie]})}),r.jsxs("td",{className:"td-title",children:[r.jsx("strong",{children:Y.titre}),r.jsx("span",{className:"td-author",children:Y.auteur})]}),r.jsx("td",{children:r.jsxs("span",{className:"badge-category",children:[Hi[Y.categorie]," ",Gi[Y.categorie]]})}),r.jsx("td",{children:Y.classe==="all"?"Toutes":Y.classe}),r.jsx("td",{children:Y.nombrePages}),r.jsx("td",{children:r.jsxs("span",{className:"td-stats",children:[" ",Y.nombreVues,r.jsx("br",{})," ",Y.nombreTelechargements]})}),r.jsx("td",{children:r.jsx("button",{className:`btn-status ${Y.isActive?"active":"inactive"}`,onClick:()=>I(Y.id,Y.isActive),title:Y.isActive?"Dsactiver":"Activer",children:Y.isActive?" Actif":" Inactif"})}),r.jsxs("td",{className:"td-actions",children:[r.jsx("button",{className:"btn-edit",onClick:()=>R(Y),title:"Modifier",children:""}),$===Y.id?r.jsxs("div",{className:"delete-confirm",children:[r.jsx("span",{children:"Supprimer ?"}),r.jsx("button",{className:"btn-confirm-yes",onClick:()=>K(Y.id),children:"Oui"}),r.jsx("button",{className:"btn-confirm-no",onClick:()=>B(null),children:"Non"})]}):r.jsx("button",{className:"btn-delete",onClick:()=>B(Y.id),title:"Supprimer",children:""})]})]},Y.id))})]})})]})]})};function Cee(e){return e.toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}const Eee=({notif:e,onLire:t,onArchiver:n,onSupprimer:a,onNavigate:l})=>{const o=dm[e.type],u=e.statut==="non_lue";return r.jsxs("article",{className:`notif-page__item ${u?"notif-page__item--unread":""}`,"aria-label":`Notification : ${e.titre}`,children:[r.jsx("div",{className:"notif-page__item-icon",style:{background:o.couleur+"20",color:o.couleur},"aria-hidden":"true",children:o.icone}),r.jsxs("div",{className:"notif-page__item-body",children:[r.jsxs("div",{className:"notif-page__item-header",children:[r.jsx("h3",{className:"notif-page__item-titre",children:e.titre}),u&&r.jsx("span",{className:"notif-page__item-badge",children:"Nouvelle"})]}),r.jsx("p",{className:"notif-page__item-message",children:e.message}),r.jsxs("div",{className:"notif-page__item-meta",children:[e.emetteurNom&&r.jsxs("span",{className:"notif-page__item-emetteur",children:["De : ",e.emetteurNom]}),r.jsx("span",{className:"notif-page__item-date",children:Cee(e.createdAt)}),r.jsx("span",{className:"notif-page__item-type",style:{color:o.couleur},children:Tb[e.type]})]}),e.lienAction&&r.jsx("button",{className:"notif-page__item-action-btn",onClick:()=>l(e),children:e.labelAction||"Voir "})]}),r.jsxs("div",{className:"notif-page__item-actions",children:[u&&r.jsx("button",{className:"notif-page__action-btn notif-page__action-btn--read",onClick:()=>t(e.id),title:"Marquer comme lu","aria-label":"Marquer comme lu",children:""}),e.statut!=="archivee"&&r.jsx("button",{className:"notif-page__action-btn notif-page__action-btn--archive",onClick:()=>n(e.id),title:"Archiver","aria-label":"Archiver la notification",children:""}),r.jsx("button",{className:"notif-page__action-btn notif-page__action-btn--delete",onClick:()=>a(e.id),title:"Supprimer","aria-label":"Supprimer la notification",children:""})]})]})},Aee=()=>{const{currentUser:e}=rt(),t=st(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState("toutes"),[h,v]=g.useState("tous"),[b,x]=g.useState(!1),j=g.useCallback(async()=>{if(e){o(!0),d(null);try{const O=await T3(e.uid,{includeArchived:f==="archivee",limitCount:100});a(O)}catch(O){d("Impossible de charger les notifications."),console.error("[Phase 26] Erreur chargement notifications:",O)}finally{o(!1)}}},[e,f]);g.useEffect(()=>{j()},[j]);const N=n.filter(O=>{const P=f==="toutes"||O.statut===f,D=h==="tous"||O.type===h;return P&&D}),S=n.filter(O=>O.statut==="non_lue").length,C=async O=>{await _x(O),a(P=>P.map(D=>D.id===O?{...D,statut:"lue",luAt:new Date}:D))},E=async O=>{await R3(O),a(P=>P.map(D=>D.id===O?{...D,statut:"archivee"}:D))},w=async O=>{window.confirm("Supprimer cette notification ?")&&(await I3(O),a(P=>P.filter(D=>D.id!==O)))},z=async O=>{O.statut==="non_lue"&&await _x(O.id),O.lienAction&&t(O.lienAction)},k=async()=>{if(!(!e||b)){x(!0);try{await dA(e.uid),a(O=>O.map(P=>P.statut==="non_lue"?{...P,statut:"lue",luAt:new Date}:P))}finally{x(!1)}}};return r.jsxs("div",{className:"notif-page",children:[r.jsxs("div",{className:"notif-page__header",children:[r.jsxs("div",{className:"notif-page__header-left",children:[r.jsx("h1",{className:"notif-page__title",children:" Notifications"}),S>0&&r.jsxs("span",{className:"notif-page__unread-count",children:[S," non ",S>1?"lues":"lue"]})]}),S>0&&r.jsx("button",{className:"notif-page__mark-all-btn",onClick:k,disabled:b,children:b?"En cours":" Tout marquer comme lu"})]}),r.jsxs("div",{className:"notif-page__filters",children:[r.jsxs("div",{className:"notif-page__filter-group",children:[r.jsx("label",{className:"notif-page__filter-label",children:"Statut"}),r.jsx("div",{className:"notif-page__filter-tabs",children:["toutes","non_lue","lue","archivee"].map(O=>r.jsx("button",{className:`notif-page__filter-tab ${f===O?"notif-page__filter-tab--active":""}`,onClick:()=>p(O),children:O==="toutes"?"Toutes":O==="non_lue"?" Non lues":O==="lue"?" Lues":" Archives"},O))})]}),r.jsxs("div",{className:"notif-page__filter-group",children:[r.jsx("label",{className:"notif-page__filter-label",children:"Type"}),r.jsxs("select",{className:"notif-page__filter-select",value:h,onChange:O=>v(O.target.value),children:[r.jsx("option",{value:"tous",children:"Tous les types"}),Object.entries(Tb).map(([O,P])=>r.jsx("option",{value:O,children:P},O))]})]})]}),l?r.jsx("div",{className:"notif-page__loading",children:[1,2,3].map(O=>r.jsx("div",{className:"notif-page__skeleton"},O))}):u?r.jsxs("div",{className:"notif-page__error",children:[r.jsxs("p",{children:[" ",u]}),r.jsx("button",{onClick:j,className:"notif-page__retry-btn",children:"Ressayer"})]}):N.length===0?r.jsxs("div",{className:"notif-page__empty",children:[r.jsx("span",{className:"notif-page__empty-icon",children:""}),r.jsx("p",{className:"notif-page__empty-title",children:"Aucune notification"}),r.jsx("p",{className:"notif-page__empty-sub",children:f==="non_lue"?"Vous tes  jour, aucune notification non lue.":"Aucune notification correspondant  vos filtres."})]}):r.jsx("div",{className:"notif-page__list",children:N.map(O=>r.jsx(Eee,{notif:O,onLire:C,onArchiver:E,onSupprimer:w,onNavigate:z},O.id))})]})},eA={type:"annonce",titre:"",message:"",lienAction:"",labelAction:"",modeDestinataire:"role",destinataireEmail:"",destinataireId:"",groupeId:"",roleDestinataire:"eleve",canal:"les_deux"},tA=()=>{const{currentUser:e}=rt(),t=st(),[n,a]=g.useState(eA),[l,o]=g.useState([]),[u,d]=g.useState("idle"),[f,p]=g.useState(null),[h,v]=g.useState(0);g.useEffect(()=>{if(!e)return;const E=e.role==="admin"?ke(_e(X,"groupes_prof")):ke(_e(X,"groupes_prof"),Se("profId","==",e.uid));ze(E).then(w=>{o(w.docs.map(z=>({id:z.id,nom:z.data().nom,classe:z.data().classe,nombreInscrits:z.data().nombreInscrits??0})))})},[e]);const b=(C,E)=>{a(w=>({...w,[C]:E}))},x=C=>{const E=dm[C];a(w=>({...w,type:C,titre:E.titreDefaut,message:E.messageDefaut}))},j=()=>!(!n.titre.trim()||!n.message.trim()||n.modeDestinataire==="individuel"&&!n.destinataireEmail.trim()||n.modeDestinataire==="groupe"&&!n.groupeId),N=async()=>{if(!(!e||!j())){d("sending"),p(null);try{const C={type:n.type,titre:n.titre,message:n.message,lienAction:n.lienAction||void 0,labelAction:n.labelAction||void 0,emetteurId:e.uid,emetteurNom:e.displayName||e.email||"PedaClic",canal:n.canal};if(n.modeDestinataire==="individuel")await D3({...C,destinataireId:n.destinataireId||n.destinataireEmail,destinataireRole:"eleve",emailDestinataire:n.canal!=="in_app"?n.destinataireEmail:void 0,emailDestinatairNom:n.destinataireEmail}),v(1);else if(n.modeDestinataire==="groupe"){const E=await M3(n.groupeId,{...C,destinataireRole:"eleve"});v(E)}else{const E=await P3(n.roleDestinataire,C);v(E)}d("success")}catch(C){p(C instanceof Error?C.message:"Erreur inconnue"),d("error")}}},S=()=>{a(eA),d("idle"),p(null),v(0)};return u==="success"?r.jsx("div",{className:"notif-composer notif-composer--success",children:r.jsxs("div",{className:"notif-composer__success-card",children:[r.jsx("span",{className:"notif-composer__success-icon",children:""}),r.jsx("h2",{children:"Notification envoye !"}),r.jsxs("p",{children:[r.jsx("strong",{children:h})," destinataire",h>1?"s":""," notifi",h>1?"s":"","."]}),r.jsxs("div",{className:"notif-composer__success-actions",children:[r.jsx("button",{className:"notif-composer__btn notif-composer__btn--primary",onClick:S,children:" Nouvelle notification"}),r.jsx("button",{className:"notif-composer__btn notif-composer__btn--secondary",onClick:()=>t(-1),children:" Retour"})]})]})}):r.jsxs("div",{className:"notif-composer",children:[r.jsxs("div",{className:"notif-composer__header",children:[r.jsx("button",{className:"notif-composer__back-btn",onClick:()=>t(-1),children:" Retour"}),r.jsx("h1",{className:"notif-composer__title",children:" Envoyer une notification"})]}),r.jsxs("div",{className:"notif-composer__form",children:[r.jsxs("section",{className:"notif-composer__section",children:[r.jsx("h2",{className:"notif-composer__section-title",children:"1. Type de notification"}),r.jsx("div",{className:"notif-composer__type-grid",children:Object.entries(Tb).filter(([C])=>!["bienvenue","nouveau_abonnement","resultat_quiz"].includes(C)).map(([C,E])=>{const w=dm[C];return r.jsxs("button",{className:`notif-composer__type-card ${n.type===C?"notif-composer__type-card--active":""}`,onClick:()=>x(C),style:n.type===C?{borderColor:w.couleur,background:w.couleur+"12"}:{},children:[r.jsx("span",{className:"notif-composer__type-icon",children:w.icone}),r.jsx("span",{className:"notif-composer__type-label",children:E})]},C)})})]}),r.jsxs("section",{className:"notif-composer__section",children:[r.jsx("h2",{className:"notif-composer__section-title",children:"2. Destinataires"}),r.jsx("div",{className:"notif-composer__mode-tabs",children:[{value:"role",label:" Par rle"},{value:"groupe",label:" Groupe-classe"},{value:"individuel",label:" Individuel"}].map(({value:C,label:E})=>r.jsx("button",{className:`notif-composer__mode-tab ${n.modeDestinataire===C?"notif-composer__mode-tab--active":""}`,onClick:()=>b("modeDestinataire",C),children:E},C))}),n.modeDestinataire==="role"&&r.jsxs("div",{className:"notif-composer__field",children:[r.jsx("label",{className:"notif-composer__label",children:"Envoyer  :"}),r.jsx("div",{className:"notif-composer__role-grid",children:Object.entries(L3).map(([C,E])=>r.jsx("button",{className:`notif-composer__role-card ${n.roleDestinataire===C?"notif-composer__role-card--active":""}`,onClick:()=>b("roleDestinataire",C),children:E},C))})]}),n.modeDestinataire==="groupe"&&r.jsxs("div",{className:"notif-composer__field",children:[r.jsx("label",{className:"notif-composer__label",children:"Groupe-classe :"}),l.length===0?r.jsx("p",{className:"notif-composer__hint",children:"Aucun groupe-classe disponible."}):r.jsxs("select",{className:"notif-composer__select",value:n.groupeId,onChange:C=>b("groupeId",C.target.value),children:[r.jsx("option",{value:"",children:" Choisir un groupe "}),l.map(C=>r.jsxs("option",{value:C.id,children:[C.nom,"  ",C.classe," (",C.nombreInscrits," lves)"]},C.id))]})]}),n.modeDestinataire==="individuel"&&r.jsxs("div",{className:"notif-composer__field",children:[r.jsx("label",{className:"notif-composer__label",children:"Email du destinataire :"}),r.jsx("input",{type:"email",className:"notif-composer__input",placeholder:"eleve@exemple.sn",value:n.destinataireEmail,onChange:C=>b("destinataireEmail",C.target.value)}),r.jsx("p",{className:"notif-composer__hint",children:"L'utilisateur doit tre inscrit sur PedaClic."})]})]}),r.jsxs("section",{className:"notif-composer__section",children:[r.jsx("h2",{className:"notif-composer__section-title",children:"3. Contenu"}),r.jsxs("div",{className:"notif-composer__field",children:[r.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-titre",children:["Titre ",r.jsx("span",{className:"notif-composer__required",children:"*"})]}),r.jsx("input",{id:"notif-titre",type:"text",className:"notif-composer__input",placeholder:"Ex : Nouveau devoir de mathmatiques",value:n.titre,onChange:C=>b("titre",C.target.value),maxLength:100}),r.jsxs("span",{className:"notif-composer__char-count",children:[n.titre.length,"/100"]})]}),r.jsxs("div",{className:"notif-composer__field",children:[r.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-message",children:["Message ",r.jsx("span",{className:"notif-composer__required",children:"*"})]}),r.jsx("textarea",{id:"notif-message",className:"notif-composer__textarea",placeholder:"Rdigez votre message ici",value:n.message,onChange:C=>b("message",C.target.value),rows:4,maxLength:500}),r.jsxs("span",{className:"notif-composer__char-count",children:[n.message.length,"/500"]})]}),r.jsxs("div",{className:"notif-composer__field-row",children:[r.jsxs("div",{className:"notif-composer__field",children:[r.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-lien",children:["Lien d'action ",r.jsx("span",{className:"notif-composer__optional",children:"(optionnel)"})]}),r.jsx("input",{id:"notif-lien",type:"text",className:"notif-composer__input",placeholder:"/cours/abc123",value:n.lienAction,onChange:C=>b("lienAction",C.target.value)})]}),r.jsxs("div",{className:"notif-composer__field",children:[r.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-label",children:["Texte du bouton ",r.jsx("span",{className:"notif-composer__optional",children:"(optionnel)"})]}),r.jsx("input",{id:"notif-label",type:"text",className:"notif-composer__input",placeholder:"Voir le cours",value:n.labelAction,onChange:C=>b("labelAction",C.target.value)})]})]})]}),r.jsxs("section",{className:"notif-composer__section",children:[r.jsx("h2",{className:"notif-composer__section-title",children:"4. Canal d'envoi"}),r.jsx("div",{className:"notif-composer__canal-grid",children:[{value:"in_app",label:" In-app seulement",desc:"Cloche dans l'interface"},{value:"email",label:" Email seulement",desc:"Via Resend"},{value:"les_deux",label:" In-app + Email",desc:"Les deux canaux"}].map(({value:C,label:E,desc:w})=>r.jsxs("button",{className:`notif-composer__canal-card ${n.canal===C?"notif-composer__canal-card--active":""}`,onClick:()=>b("canal",C),children:[r.jsx("span",{className:"notif-composer__canal-label",children:E}),r.jsx("span",{className:"notif-composer__canal-desc",children:w})]},C))}),(n.canal==="email"||n.canal==="les_deux")&&n.modeDestinataire!=="individuel"&&r.jsx("p",{className:"notif-composer__canal-warning",children:" Pour l'envoi par email en mode groupe/rle, assurez-vous que Railway est bien dploy et que la cl API Resend est configure."})]}),u==="error"&&f&&r.jsxs("div",{className:"notif-composer__error",children:[" ",f]}),r.jsxs("div",{className:"notif-composer__footer",children:[r.jsx("button",{className:"notif-composer__btn notif-composer__btn--secondary",onClick:()=>t(-1),disabled:u==="sending",children:"Annuler"}),r.jsx("button",{className:"notif-composer__btn notif-composer__btn--primary",onClick:N,disabled:!j()||u==="sending",children:u==="sending"?" Envoi en cours":" Envoyer la notification"})]})]})]})},zee=()=>{const{currentUser:e}=rt(),t=e?.uid||"",n=e?.displayName||"Parent",[a,l]=g.useState([]),[o,u]=g.useState(null),[d,f]=g.useState(null),[p,h]=g.useState(!0),[v,b]=g.useState(!1),[x,j]=g.useState(null),[N,S]=g.useState(!1),[C,E]=g.useState(""),[w,z]=g.useState(!1),[k,O]=g.useState(null),[P,D]=g.useState(null),[L,U]=g.useState("apercu");g.useEffect(()=>{$()},[t]),g.useEffect(()=>{o&&B(o)},[o]);const $=async()=>{try{h(!0),j(null);const M=await gX(t);l(M),M.length===1&&u(M[0].enfantId)}catch(M){j("Erreur lors du chargement des enfants."),console.error(M)}finally{h(!1)}},B=async M=>{try{b(!0),j(null);const q=await bX(t,M);f(q)}catch(q){j(q.message||"Erreur lors du chargement du suivi."),f(null)}finally{b(!1)}},re=async M=>{if(M.preventDefault(),O(null),D(null),!C.trim()){O("Veuillez saisir le code d'invitation.");return}try{z(!0);const q=await vX(t,C);D(`${q.enfantNom} a t ajout avec succs !`),E(""),S(!1),await $(),u(q.enfantId)}catch(q){O(q.message||"Erreur lors de la liaison.")}finally{z(!1)}},se=async M=>{if(window.confirm(`tes-vous sr de vouloir retirer ${M.enfantNom} de votre suivi ? Cette action est irrversible.`))try{await xX(M.id,t),o===M.enfantId&&(u(null),f(null)),await $()}catch(F){j(F.message||"Erreur lors de la suppression.")}};return p?r.jsxs("div",{className:"parent-loading",children:[r.jsx("div",{className:"parent-spinner"}),r.jsx("p",{children:"Chargement de votre espace parent..."})]}):r.jsxs("div",{className:"parent-dashboard",children:[r.jsxs("header",{className:"parent-header",children:[r.jsxs("div",{className:"parent-header-info",children:[r.jsx("h1",{className:"parent-titre",children:" Espace Parent"}),r.jsxs("p",{className:"parent-bienvenue",children:["Bienvenue, ",r.jsx("strong",{children:n}),"  Suivez la progression de vos enfants"]})]}),r.jsx("button",{className:"parent-btn parent-btn-primary",onClick:()=>{S(!N),O(null),D(null)},children:" Ajouter un enfant"})]}),x&&r.jsxs("div",{className:"parent-alerte parent-alerte-erreur",children:[r.jsxs("span",{children:[" ",x]}),r.jsx("button",{onClick:()=>j(null),children:""})]}),P&&r.jsxs("div",{className:"parent-alerte parent-alerte-succes",children:[r.jsxs("span",{children:[" ",P]}),r.jsx("button",{onClick:()=>D(null),children:""})]}),N&&r.jsxs("div",{className:"parent-form-liaison",children:[r.jsx("h3",{children:" Lier un enfant  votre compte"}),r.jsx("p",{className:"parent-form-aide",children:"Demandez le code d'invitation  votre enfant. Il peut le trouver dans son profil sur PedaClic (format: PEDA-XXXX-XXXX)."}),r.jsxs("form",{onSubmit:re,className:"parent-form",children:[r.jsxs("div",{className:"parent-form-group",children:[r.jsx("label",{htmlFor:"code-invitation",children:"Code d'invitation"}),r.jsx("input",{id:"code-invitation",type:"text",placeholder:"PEDA-XXXX-XXXX",value:C,onChange:M=>E(M.target.value.toUpperCase()),maxLength:14,disabled:w,className:"parent-input"})]}),k&&r.jsxs("p",{className:"parent-form-erreur",children:[" ",k]}),r.jsxs("div",{className:"parent-form-actions",children:[r.jsx("button",{type:"submit",className:"parent-btn parent-btn-primary",disabled:w,children:w?"Vrification...":" Valider"}),r.jsx("button",{type:"button",className:"parent-btn parent-btn-secondary",onClick:()=>S(!1),children:"Annuler"})]})]})]}),a.length===0?r.jsxs("div",{className:"parent-empty-state",children:[r.jsx("div",{className:"parent-empty-icon",children:""}),r.jsx("h2",{children:"Aucun enfant li"}),r.jsx("p",{children:"Cliquez sur  Ajouter un enfant  et saisissez le code d'invitation de votre enfant pour commencer  suivre sa progression."}),r.jsx("button",{className:"parent-btn parent-btn-primary",onClick:()=>S(!0),children:" Ajouter mon premier enfant"})]}):r.jsxs("div",{className:"parent-content",children:[r.jsxs("aside",{className:"parent-sidebar",children:[r.jsx("h3",{className:"parent-sidebar-titre",children:"Mes enfants"}),r.jsx("ul",{className:"parent-enfants-liste",children:a.map(M=>r.jsxs("li",{className:`parent-enfant-card ${o===M.enfantId?"parent-enfant-actif":""}`,onClick:()=>u(M.enfantId),children:[r.jsx("div",{className:"parent-enfant-avatar",children:M.enfantNom.charAt(0).toUpperCase()}),r.jsxs("div",{className:"parent-enfant-info",children:[r.jsx("span",{className:"parent-enfant-nom",children:M.enfantNom}),M.enfantClasse&&r.jsx("span",{className:"parent-enfant-classe",children:M.enfantClasse})]}),r.jsx("button",{className:"parent-enfant-supprimer",onClick:q=>{q.stopPropagation(),se(M)},title:"Retirer cet enfant",children:""})]},M.id))})]}),r.jsx("main",{className:"parent-main",children:o?v?r.jsxs("div",{className:"parent-loading",children:[r.jsx("div",{className:"parent-spinner"}),r.jsx("p",{children:"Chargement du suivi..."})]}):d?r.jsxs("div",{className:"parent-dashboard-detail",children:[r.jsxs("div",{className:"parent-enfant-header",children:[r.jsxs("div",{className:"parent-enfant-header-info",children:[r.jsx("h2",{children:d.enfant.nom}),d.enfant.classe&&r.jsx("span",{className:"parent-badge",children:d.enfant.classe}),d.enfant.derniereConnexion&&r.jsxs("span",{className:"parent-derniere-connexion",children:["Dernire connexion : ",xx(d.enfant.derniereConnexion)]})]}),r.jsx("p",{className:"parent-message-motivation",children:wX(d.scoreGlobal)})]}),r.jsxs("div",{className:"parent-indicateurs",children:[r.jsxs("div",{className:"parent-card parent-card-score",children:[r.jsx("div",{className:"parent-card-icon",children:""}),r.jsxs("div",{className:"parent-card-content",children:[r.jsx("span",{className:"parent-card-label",children:"Score Global"}),r.jsxs("span",{className:`parent-card-value parent-score-${d.scoreGlobal>=60?"bon":d.scoreGlobal>=40?"moyen":"bas"}`,children:[d.scoreGlobal,"/100"]})]})]}),r.jsxs("div",{className:"parent-card parent-card-streak",children:[r.jsx("div",{className:"parent-card-icon",children:""}),r.jsxs("div",{className:"parent-card-content",children:[r.jsx("span",{className:"parent-card-label",children:"Streak"}),r.jsxs("span",{className:"parent-card-value",children:[d.streak.actuel," jour",d.streak.actuel>1?"s":""]})]})]}),r.jsxs("div",{className:"parent-card parent-card-lacunes",children:[r.jsx("div",{className:"parent-card-icon",children:""}),r.jsxs("div",{className:"parent-card-content",children:[r.jsx("span",{className:"parent-card-label",children:"Lacunes"}),r.jsxs("span",{className:"parent-card-value",children:[d.lacunes.length," matire",d.lacunes.length>1?"s":""]})]})]}),r.jsxs("div",{className:"parent-card parent-card-objectifs",children:[r.jsx("div",{className:"parent-card-icon",children:""}),r.jsxs("div",{className:"parent-card-content",children:[r.jsx("span",{className:"parent-card-label",children:"Objectifs"}),r.jsxs("span",{className:"parent-card-value",children:[d.objectifs.filter(M=>M.statut==="atteint").length,"/",d.objectifs.length]})]})]})]}),r.jsxs("div",{className:"parent-section parent-section-semaine",children:[r.jsx("h3",{children:" Activit de la semaine"}),r.jsx("div",{className:"parent-semaine-jours",children:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"].map((M,q)=>r.jsxs("div",{className:`parent-jour ${d.streak.semaineCourante[q]?"parent-jour-actif":"parent-jour-inactif"}`,children:[r.jsx("span",{className:"parent-jour-label",children:M}),r.jsx("span",{className:"parent-jour-icon",children:d.streak.semaineCourante[q]?"":""})]},M))})]}),r.jsxs("div",{className:"parent-onglets",children:[r.jsx("button",{className:`parent-onglet ${L==="apercu"?"parent-onglet-actif":""}`,onClick:()=>U("apercu"),children:" Aperu"}),r.jsxs("button",{className:`parent-onglet ${L==="lacunes"?"parent-onglet-actif":""}`,onClick:()=>U("lacunes"),children:[" Lacunes (",d.lacunes.length,")"]}),r.jsxs("button",{className:`parent-onglet ${L==="alertes"?"parent-onglet-actif":""}`,onClick:()=>U("alertes"),children:[" Alertes (",d.alertes.length,")"]}),r.jsx("button",{className:`parent-onglet ${L==="resume"?"parent-onglet-actif":""}`,onClick:()=>U("resume"),children:" Rsum"})]}),r.jsxs("div",{className:"parent-onglet-contenu",children:[L==="apercu"&&r.jsxs("div",{className:"parent-tab-apercu",children:[r.jsxs("div",{className:"parent-section",children:[r.jsx("h3",{children:" Derniers quiz passs"}),d.derniersQuiz.length===0?r.jsx("p",{className:"parent-vide",children:"Aucun quiz pass rcemment."}):r.jsx("div",{className:"parent-quiz-liste",children:d.derniersQuiz.map((M,q)=>r.jsxs("div",{className:`parent-quiz-item ${M.reussi?"parent-quiz-reussi":"parent-quiz-echoue"}`,children:[r.jsxs("div",{className:"parent-quiz-info",children:[r.jsx("span",{className:"parent-quiz-discipline",children:M.disciplineNom}),r.jsx("span",{className:"parent-quiz-titre",children:M.quizTitre})]}),r.jsxs("div",{className:"parent-quiz-score",children:[r.jsxs("span",{className:`parent-quiz-note ${M.reussi?"note-ok":"note-ko"}`,children:[M.noteSur20,"/20"]}),r.jsx("span",{className:"parent-quiz-statut",children:M.reussi?" Russi":" chou"})]}),r.jsx("span",{className:"parent-quiz-date",children:xx(M.datePassage)})]},q))})]}),r.jsxs("div",{className:"parent-section",children:[r.jsx("h3",{children:" Objectifs de la semaine"}),d.objectifs.length===0?r.jsx("p",{className:"parent-vide",children:"Aucun objectif cette semaine."}):r.jsx("div",{className:"parent-objectifs-liste",children:d.objectifs.map((M,q)=>r.jsxs("div",{className:"parent-objectif-item",children:[r.jsxs("div",{className:"parent-objectif-header",children:[r.jsx("span",{className:"parent-objectif-titre",children:M.titre}),r.jsx("span",{className:`parent-objectif-statut parent-statut-${M.statut}`,children:M.statut==="atteint"?" Atteint":M.statut==="en_cours"?" En cours":M.statut==="echoue"?" chou":" Non commenc"})]}),r.jsx("div",{className:"parent-progress-bar",children:r.jsx("div",{className:`parent-progress-fill parent-progress-${M.statut}`,style:{width:`${Math.min(M.progression/M.cible*100,100)}%`}})}),r.jsxs("span",{className:"parent-objectif-detail",children:[M.progression,"/",M.cible]})]},q))})]})]}),L==="lacunes"&&r.jsx("div",{className:"parent-tab-lacunes",children:d.lacunes.length===0?r.jsxs("div",{className:"parent-vide-section",children:[r.jsx("span",{className:"parent-vide-icon",children:""}),r.jsx("p",{children:"Aucune lacune dtecte ! Votre enfant est sur la bonne voie."})]}):r.jsx("div",{className:"parent-lacunes-liste",children:d.lacunes.map((M,q)=>r.jsxs("div",{className:"parent-lacune-item",style:{borderLeftColor:cf(M.niveauUrgence)},children:[r.jsxs("div",{className:"parent-lacune-header",children:[r.jsx("span",{className:"parent-lacune-discipline",children:M.disciplineNom}),r.jsx("span",{className:"parent-lacune-badge",style:{backgroundColor:cf(M.niveauUrgence),color:"#fff"},children:RM(M.niveauUrgence)})]}),r.jsxs("div",{className:"parent-lacune-details",children:[r.jsxs("span",{className:"parent-lacune-moyenne",children:["Moyenne : ",r.jsxs("strong",{children:[M.moyenne,"/20"]})]}),r.jsxs("span",{className:"parent-lacune-tendance",children:["Tendance : ",IM(M.tendance)," ",M.tendance==="hausse"?"En hausse":M.tendance==="baisse"?"En baisse":"Stable"]})]}),r.jsx("p",{className:"parent-lacune-conseil",children:M.niveauUrgence==="critique"?" Intervention recommande : discutez avec votre enfant et envisagez un soutien scolaire.":M.niveauUrgence==="important"?" Encouragez votre enfant  rviser cette matire rgulirement.":" Quelques rvisions suffiront pour consolider les acquis."})]},q))})}),L==="alertes"&&r.jsx("div",{className:"parent-tab-alertes",children:d.alertes.length===0?r.jsxs("div",{className:"parent-vide-section",children:[r.jsx("span",{className:"parent-vide-icon",children:""}),r.jsx("p",{children:"Aucune alerte pour le moment. Tout va bien !"})]}):r.jsx("div",{className:"parent-alertes-liste",children:d.alertes.map((M,q)=>r.jsxs("div",{className:`parent-alerte-item parent-alerte-${M.niveau}`,children:[r.jsxs("div",{className:"parent-alerte-header",children:[r.jsx("span",{className:"parent-alerte-titre",children:M.titre}),r.jsx("span",{className:"parent-alerte-badge",style:{backgroundColor:_X(M.niveau),color:"#fff"},children:SX(M.type)})]}),r.jsx("p",{className:"parent-alerte-message",children:M.message}),r.jsx("span",{className:"parent-alerte-date",children:xx(M.dateCreation)})]},q))})}),L==="resume"&&d.resume&&r.jsxs("div",{className:"parent-tab-resume",children:[r.jsxs("div",{className:"parent-resume-header",children:[r.jsxs("h3",{children:[" Rsum : ",d.resume.semaine]}),r.jsxs("span",{className:"parent-resume-evolution",children:["Score : ",d.resume.scoreGlobal,"/100"," ",qE(d.resume.evolutionScore)]})]}),r.jsxs("div",{className:"parent-resume-stats",children:[r.jsxs("div",{className:"parent-resume-stat",children:[r.jsx("span",{className:"parent-resume-stat-value",children:d.resume.nombreQuizSemaine}),r.jsx("span",{className:"parent-resume-stat-label",children:"Quiz passs"})]}),r.jsxs("div",{className:"parent-resume-stat",children:[r.jsxs("span",{className:"parent-resume-stat-value",children:[d.resume.joursActifsSemaine,"/7"]}),r.jsx("span",{className:"parent-resume-stat-label",children:"Jours actifs"})]}),r.jsxs("div",{className:"parent-resume-stat",children:[r.jsxs("span",{className:"parent-resume-stat-value",children:[d.resume.tempsEstimeMinutes," min"]}),r.jsx("span",{className:"parent-resume-stat-label",children:"Temps d'tude"})]}),r.jsxs("div",{className:"parent-resume-stat",children:[r.jsxs("span",{className:"parent-resume-stat-value",children:[d.resume.objectifsAtteints,"/",d.resume.objectifsTotal]}),r.jsx("span",{className:"parent-resume-stat-label",children:"Objectifs atteints"})]})]}),d.resume.evolutionDisciplines.length>0&&r.jsxs("div",{className:"parent-section",children:[r.jsx("h4",{children:" volution par matire"}),r.jsx("div",{className:"parent-evolution-liste",children:d.resume.evolutionDisciplines.map((M,q)=>r.jsxs("div",{className:"parent-evolution-item",children:[r.jsx("span",{className:"parent-evolution-discipline",children:M.disciplineNom}),r.jsxs("div",{className:"parent-evolution-scores",children:[r.jsxs("span",{className:"parent-evolution-prec",children:[M.moyenneSemainePrecedente,"/20"]}),r.jsx("span",{className:"parent-evolution-fleche",children:qE(M.evolution)}),r.jsxs("span",{className:"parent-evolution-courante",children:[M.moyenneSemaineCourante,"/20"]}),r.jsxs("span",{className:`parent-evolution-ecart ${M.ecart>0?"ecart-positif":M.ecart<0?"ecart-negatif":""}`,children:["(",M.ecart>0?"+":"",M.ecart,")"]})]})]},q))})]}),d.resume.disciplinesEnDifficulte.length>0&&r.jsxs("div",{className:"parent-section parent-section-warning",children:[r.jsx("h4",{children:" Matires ncessitant une attention"}),r.jsx("ul",{className:"parent-disciplines-difficulte",children:d.resume.disciplinesEnDifficulte.map((M,q)=>r.jsx("li",{children:M},q))})]})]}),L==="resume"&&!d.resume&&r.jsxs("div",{className:"parent-vide-section",children:[r.jsx("span",{className:"parent-vide-icon",children:""}),r.jsx("p",{children:"Le rsum sera disponible une fois que votre enfant aura pass des quiz."})]})]})]}):r.jsxs("div",{className:"parent-erreur-dashboard",children:[r.jsx("p",{children:" Impossible de charger le suivi. Veuillez ressayer."}),r.jsx("button",{className:"parent-btn parent-btn-primary",onClick:()=>o&&B(o),children:" Ressayer"})]}):r.jsx("div",{className:"parent-select-enfant",children:r.jsx("p",{children:" Slectionnez un enfant dans la liste pour voir son suivi."})})})]})]})},yj="compiled_ebooks";async function Oee(e,t,n,a){return(await Tt(_e(X,yj),{userId:e,titre:t,description:n,sections:a,createdAt:Oe.now()})).id}async function rA(e,t=30){const n=ke(_e(X,yj),Se("userId","==",e),Ke("createdAt","desc")),a=await ze(n),l=[];return a.forEach(o=>{l.length<t&&l.push({id:o.id,...o.data()})}),l}async function kee(e){await en(Ne(X,yj,e))}const Dee=({userId:e,history:t,onClose:n,onSaved:a,markdownToHtml:l})=>{const[o,u]=g.useState("select"),[d,f]=g.useState([]),[p,h]=g.useState(""),[v,b]=g.useState(""),[x,j]=g.useState(!1),[N,S]=g.useState(!1),[C,E]=g.useState(""),w=t.filter($=>$.type!=="quiz_auto"&&$.content);function z($){f(B=>B.some(se=>se.id===$.id)?B.filter(se=>se.id!==$.id):[...B,$])}function k($){$!==0&&f(B=>{const re=[...B];return[re[$-1],re[$]]=[re[$],re[$-1]],re})}function O($){f(B=>{if($===B.length-1)return B;const re=[...B];return[re[$],re[$+1]]=[re[$+1],re[$]],re})}const P=g.useCallback(($=!1)=>{const B=d.map((re,se)=>`
      <section class="ebook-section">
        <div class="section-header">
          <span class="section-num">${se+1}</span>
          <div class="section-meta">
            <h2 class="section-title">${re.chapitre}</h2>
            <p class="section-subtitle">
              ${ur[re.type]} &nbsp;&nbsp;
              ${re.discipline} &nbsp;&nbsp; Classe : ${re.classe}
            </p>
          </div>
        </div>
        <div class="section-body">${l(re.content||"")}</div>
      </section>`).join('<div class="page-break"></div>');return`<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>${p||"Ebook PedaClic"}</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Georgia', serif;
      font-size: 12pt;
      line-height: 1.75;
      color: #1a1a2e;
      background: #fff;
      padding: ${$?"0":"2rem"};
      max-width: 860px;
      margin: auto;
    }
    /*  Couverture  */
    .cover {
      min-height: ${$?"100vh":"280px"};
      background: linear-gradient(135deg, #1a56db 0%, #7c3aed 100%);
      border-radius: ${$?"0":"12px"};
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 3rem 2rem;
      color: #fff;
      margin-bottom: 2.5rem;
    }
    .cover-logo { font-size: 3rem; margin-bottom: 1rem; }
    .cover-title { font-size: 2rem; font-weight: 700; line-height: 1.2; margin-bottom: 0.75rem; }
    .cover-desc { font-size: 1rem; opacity: 0.85; max-width: 480px; }
    .cover-meta { margin-top: 1.5rem; font-size: 0.85rem; opacity: 0.7; }
    /*  Sommaire  */
    .toc {
      background: #f8faff;
      border: 1px solid #dbeafe;
      border-radius: 10px;
      padding: 1.5rem 2rem;
      margin-bottom: 2.5rem;
    }
    .toc h2 { font-size: 1.1rem; color: #1a56db; margin-bottom: 1rem; }
    .toc ol { padding-left: 1.25rem; }
    .toc li { padding: 0.3rem 0; font-size: 0.95rem; color: #374151; }
    .toc li span { color: #6b7280; font-size: 0.85rem; margin-left: 0.5rem; }
    /*  Sections  */
    .ebook-section { margin-bottom: 2.5rem; }
    .section-header {
      display: flex;
      gap: 1rem;
      align-items: flex-start;
      background: #eff6ff;
      border-left: 4px solid #1a56db;
      padding: 1rem 1.25rem;
      border-radius: 0 8px 8px 0;
      margin-bottom: 1.25rem;
    }
    .section-num {
      background: #1a56db;
      color: #fff;
      width: 32px; height: 32px;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-weight: 700; font-size: 0.9rem;
      flex-shrink: 0;
    }
    .section-title { font-size: 1.3rem; font-weight: 700; color: #1e3a8a; }
    .section-subtitle { font-size: 0.82rem; color: #6b7280; margin-top: 2px; }
    .section-body { padding: 0 0.5rem; }
    .section-body h1, .section-body h2 { color: #1a56db; margin: 1rem 0 0.5rem; }
    .section-body h3 { color: #4f46e5; margin: 0.75rem 0 0.4rem; }
    .section-body p { margin-bottom: 0.6rem; }
    .section-body ul, .section-body ol { margin: 0.4rem 0 0.8rem 1.5rem; }
    .section-body li { margin-bottom: 0.3rem; }
    .section-body strong { font-weight: 700; color: #111827; }
    .section-body em { font-style: italic; color: #374151; }
    .section-body code {
      font-family: 'Courier New', monospace;
      background: #f3f4f6;
      padding: 1px 5px;
      border-radius: 3px;
      font-size: 0.9em;
    }
    .section-body pre {
      background: #f3f4f6;
      padding: 0.75rem 1rem;
      border-radius: 6px;
      overflow-x: auto;
      margin: 0.8rem 0;
    }
    .section-body hr { border: none; border-top: 1px solid #e5e7eb; margin: 1rem 0; }
    /*  Sauts de page  */
    .page-break { page-break-after: always; break-after: page; height: 0; }
    /*  Pied de page  */
    .ebook-footer {
      margin-top: 3rem;
      text-align: center;
      font-size: 0.8rem;
      color: #9ca3af;
      border-top: 1px solid #e5e7eb;
      padding-top: 1rem;
    }
    @media print {
      body { padding: 0; max-width: none; }
      .cover { border-radius: 0; }
      @page { margin: 2cm; }
    }
  </style>
</head>
<body>
  <div class="cover">
    <div class="cover-logo"></div>
    <h1 class="cover-title">${p||"Ebook PedaClic"}</h1>
    ${v?`<p class="cover-desc">${v}</p>`:""}
    <p class="cover-meta">
      Gnr par PedaClic &nbsp;&nbsp;
      ${new Date().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}
    </p>
  </div>

  <div class="toc">
    <h2> Table des matires</h2>
    <ol>
      ${d.map(re=>`<li>${re.chapitre} <span> ${re.discipline}  ${re.classe}</span></li>`).join("")}
    </ol>
  </div>

  ${B}

  <div class="ebook-footer">
    PedaClic  L'cole en un clic &nbsp;&nbsp; www.pedaclic.sn
  </div>

  ${$?"<script>window.onload = () => window.print();<\/script>":""}
</body>
</html>`},[d,p,v,l]);function D(){const $=window.open("","_blank","width=920,height=720");$&&($.document.write(P(!0)),$.document.close())}function L(){const $=P(!1),B=`
<html xmlns:o="urn:schemas-microsoft-com:office:office"
      xmlns:w="urn:schemas-microsoft-com:office:word"
      xmlns="http://www.w3.org/TR/REC-html40">
<head><meta charset="utf-8"><title>${p}</title></head>
<body>${$}</body></html>`,re=new Blob(["\uFEFF",B],{type:"application/msword;charset=utf-8"}),se=URL.createObjectURL(re),M=document.createElement("a");M.href=se;const q=(p||"ebook_pedaclic").replace(/[^\w\u00C0-\u017E\s-]/g,"").replace(/\s+/g,"_").slice(0,60);M.download=`${q}.doc`,document.body.appendChild(M),M.click(),document.body.removeChild(M),URL.revokeObjectURL(se)}async function U(){if(!p.trim()){E("Veuillez donner un titre  l'ebook.");return}j(!0),E("");try{const $=d.map(B=>({contenuId:B.id,type:B.type,discipline:B.discipline,classe:B.classe,chapitre:B.chapitre,content:B.content}));await Oee(e,p,v,$),S(!0),a()}catch{E("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{j(!1)}}return o==="select"?r.jsx("div",{className:"ai-generator__modal-overlay",onClick:$=>{$.target===$.currentTarget&&n()},children:r.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:$=>$.stopPropagation(),children:[r.jsxs("div",{className:"ai-generator__modal-header",children:[r.jsxs("div",{className:"ai-generator__modal-title-block",children:[r.jsx("h2",{children:" Compiler un Ebook"}),r.jsx("span",{className:"ai-generator__modal-subtitle",children:"tape 1 / 3  Slectionner les chapitres  inclure"})]}),r.jsx("button",{className:"ai-generator__modal-close",onClick:n,children:""})]}),r.jsx("div",{className:"ai-generator__modal-body",children:w.length===0?r.jsx("p",{className:"ai-generator__empty",children:"Aucun contenu textuel sauvegard. Gnrez d'abord des cours, exercices ou sujets."}):r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"ebook-compiler__hint",children:"Cochez les chapitres  inclure dans l'ebook. Vous pourrez les rordonner ensuite."}),r.jsx("div",{className:"ebook-compiler__list",children:w.map($=>{const B=d.some(re=>re.id===$.id);return r.jsxs("label",{className:`ebook-compiler__item ${B?"ebook-compiler__item--selected":""}`,children:[r.jsx("input",{type:"checkbox",checked:B,onChange:()=>z($),className:"ebook-compiler__checkbox"}),r.jsx("div",{className:"ebook-compiler__item-icon",children:Ba[$.type]}),r.jsxs("div",{className:"ebook-compiler__item-info",children:[r.jsx("div",{className:"ebook-compiler__item-title",children:$.chapitre}),r.jsxs("div",{className:"ebook-compiler__item-meta",children:[ur[$.type],"  ",$.discipline,"  ",$.classe]})]}),B&&r.jsx("span",{className:"ebook-compiler__badge",children:""})]},$.id)})})]})}),r.jsxs("div",{className:"ai-generator__modal-footer",children:[r.jsx("button",{className:"btn btn--outline",onClick:n,children:"Annuler"}),r.jsx("button",{className:"btn btn--primary",onClick:()=>u("configure"),disabled:d.length===0,children:d.length===0?"Slectionnez au moins 1 chapitre":`Suivant  (${d.length} chapitre${d.length>1?"s":""})`})]})]})}):o==="configure"?r.jsx("div",{className:"ai-generator__modal-overlay",onClick:$=>{$.target===$.currentTarget&&n()},children:r.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:$=>$.stopPropagation(),children:[r.jsxs("div",{className:"ai-generator__modal-header",children:[r.jsxs("div",{className:"ai-generator__modal-title-block",children:[r.jsx("h2",{children:" Compiler un Ebook"}),r.jsx("span",{className:"ai-generator__modal-subtitle",children:"tape 2 / 3  Titre et ordre des chapitres"})]}),r.jsx("button",{className:"ai-generator__modal-close",onClick:n,children:""})]}),r.jsxs("div",{className:"ai-generator__modal-body",children:[r.jsxs("div",{className:"ebook-compiler__field",children:[r.jsx("label",{className:"ebook-compiler__label",children:"Titre de l'ebook *"}),r.jsx("input",{className:"ebook-compiler__input",type:"text",placeholder:"Ex : Cours de Mathmatiques  3me",value:p,onChange:$=>h($.target.value),autoFocus:!0})]}),r.jsxs("div",{className:"ebook-compiler__field",children:[r.jsx("label",{className:"ebook-compiler__label",children:"Description (optionnel)"}),r.jsx("textarea",{className:"ebook-compiler__textarea",rows:2,placeholder:"Ex : Recueil de cours et exercices pour la classe de 3me",value:v,onChange:$=>b($.target.value)})]}),r.jsxs("div",{className:"ebook-compiler__order-label",children:["Ordre des chapitres ",r.jsx("span",{children:"(glisser les flches pour rordonner)"})]}),r.jsx("div",{className:"ebook-compiler__order-list",children:d.map(($,B)=>r.jsxs("div",{className:"ebook-compiler__order-item",children:[r.jsx("span",{className:"ebook-compiler__order-num",children:B+1}),r.jsx("span",{className:"ebook-compiler__order-icon",children:Ba[$.type]}),r.jsxs("div",{className:"ebook-compiler__order-info",children:[r.jsx("div",{className:"ebook-compiler__order-title",children:$.chapitre}),r.jsxs("div",{className:"ebook-compiler__order-meta",children:[$.discipline,"  ",$.classe]})]}),r.jsxs("div",{className:"ebook-compiler__order-btns",children:[r.jsx("button",{type:"button",onClick:()=>k(B),disabled:B===0,title:"Monter",children:""}),r.jsx("button",{type:"button",onClick:()=>O(B),disabled:B===d.length-1,title:"Descendre",children:""})]})]},$.id))})]}),r.jsxs("div",{className:"ai-generator__modal-footer",children:[r.jsx("button",{className:"btn btn--outline",onClick:()=>u("select"),children:" Retour"}),r.jsx("button",{className:"btn btn--primary",onClick:()=>{if(!p.trim()){E("Titre requis.");return}E(""),u("preview")},children:"Aperu "})]}),C&&r.jsx("p",{className:"ebook-compiler__error",children:C})]})}):r.jsx("div",{className:"ai-generator__modal-overlay",onClick:$=>{$.target===$.currentTarget&&n()},children:r.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:$=>$.stopPropagation(),children:[r.jsxs("div",{className:"ai-generator__modal-header",children:[r.jsxs("div",{className:"ai-generator__modal-title-block",children:[r.jsxs("h2",{children:[" ",p]}),r.jsx("span",{className:"ai-generator__modal-subtitle",children:"tape 3 / 3  Aperu et tlchargement"})]}),r.jsxs("div",{className:"ai-generator__modal-header-actions",children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:D,title:"Enregistrer en PDF",children:" PDF"}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:L,title:"Tlcharger en Word",children:" Word"}),r.jsx("button",{className:"ai-generator__modal-close",onClick:n,children:""})]})]}),r.jsxs("div",{className:"ai-generator__modal-body",children:[r.jsxs("div",{className:"ebook-compiler__cover-preview",children:[r.jsx("span",{children:""}),r.jsxs("div",{children:[r.jsx("div",{className:"ebook-compiler__cover-title",children:p}),v&&r.jsx("div",{className:"ebook-compiler__cover-desc",children:v}),r.jsxs("div",{className:"ebook-compiler__cover-meta",children:[d.length," chapitre",d.length>1?"s":"","  PedaClic"]})]})]}),r.jsxs("div",{className:"ebook-compiler__toc",children:[r.jsx("div",{className:"ebook-compiler__toc-title",children:" Sommaire"}),r.jsx("ol",{children:d.map(($,B)=>r.jsxs("li",{children:[r.jsxs("span",{children:[B+1,". ",$.chapitre]}),r.jsxs("span",{className:"ebook-compiler__toc-meta",children:[$.discipline,"  ",$.classe]})]},$.id))})]}),N?r.jsx("div",{className:"ebook-compiler__success",children:" Ebook sauvegard avec succs dans votre bibliothque IA !"}):r.jsxs("div",{className:"ebook-compiler__save-row",children:[r.jsx("button",{className:"btn btn--primary btn--lg",onClick:U,disabled:x,children:x?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"spinner spinner--sm"})," Sauvegarde"]}):" Sauvegarder dans PedaClic"}),r.jsx("p",{className:"ebook-compiler__save-hint",children:"L'ebook sera accessible depuis votre Bibliothque."})]}),C&&r.jsx("p",{className:"ebook-compiler__error",children:C})]}),r.jsxs("div",{className:"ai-generator__modal-footer",children:[r.jsx("button",{className:"btn btn--outline",onClick:()=>u("configure"),children:" Modifier"}),r.jsx("button",{className:"btn btn--outline",onClick:n,children:"Fermer"})]})]})})},Mee=["6me","5me","4me","3me","2nde","1re","Terminale"],Pee=[30,45,60,90,120],Tee=()=>{const{currentUser:e}=rt(),[t,n]=g.useState(1),[a,l]=g.useState([]),[o,u]=g.useState(null),[d,f]=g.useState(""),[p,h]=g.useState(""),[v,b]=g.useState(""),[x,j]=g.useState(null),[N,S]=g.useState({}),[C,E]=g.useState(!1),[w,z]=g.useState(null),[k,O]=g.useState(null),[P,D]=g.useState(!1),[L,U]=g.useState(!1),[$,B]=g.useState(null),[re,se]=g.useState(!1),[M,q]=g.useState([]),[F,R]=g.useState(!1),[K,I]=g.useState(null),[te,Y]=g.useState(!1),[oe,he]=g.useState(!1),[ge,Q]=g.useState([]),[ve,Me]=g.useState(!1),[ce,Z]=g.useState(!0),H=g.useMemo(()=>{const J=new Map;return a.forEach(W=>{J.has(W.nom)||J.set(W.nom,W)}),Array.from(J.values())},[a]);g.useEffect(()=>{(async()=>{try{Z(!0);const W=ke(_e(X,"disciplines"),Ke("nom")),fe=await ze(W),je=[];fe.forEach(Te=>{const gt=Te.data();gt.nom&&gt.nom.trim()&&je.push({id:Te.id,nom:gt.nom||"",classe:gt.classe||"",niveau:gt.niveau||""})}),l(je)}catch(W){console.error("[AIGenerator] Erreur chargement disciplines:",W),O("Impossible de charger les disciplines.")}finally{Z(!1)}})()},[]);const de=J=>{u(J),O(null)},we=()=>{const J=[];if(o||J.push("discipline"),d||J.push("classe"),(!p||p<1)&&J.push("dure de la leon"),J.length>0){O(`Champs requis manquants : ${J.join(", ")}`);return}n(2),O(null)},qe=()=>{if(!v.trim()){O("Veuillez saisir le titre du chapitre.");return}n(3),O(null)},We=J=>{j(J),n(4),O(null)},Xe=()=>{t>1&&(n(J=>J-1),O(null),t===5&&(z(null),U(!1),B(null)))},nt=()=>{n(1),u(null),f(""),h(""),b(""),j(null),S({}),z(null),O(null),U(!1),B(null)},gr=async()=>{if(!o||!x||!v.trim()||!d){O("Paramtres incomplets. Veuillez reprendre depuis le dbut.");return}E(!0),O(null);try{const J={...N,duree:typeof p=="number"?p:void 0},W={type:x,discipline:o.nom,classe:d,chapitre:v.trim(),options:Object.keys(J).length>0?J:void 0},fe=await BZ(W);z(fe),n(5)}catch(J){const W=J instanceof Error?J.message:"Erreur inconnue";O(W)}finally{E(!1)}},Dr=async()=>{if(!(!e||!w||!o||!x)){D(!0),O(null);try{let J;const fe=a.find(Te=>Te.nom===o.nom&&Te.classe===d)?.id||o.id,je={type:x,discipline:o.nom,classe:d,chapitre:v.trim(),options:{...N,duree:typeof p=="number"?p:void 0}};w.type==="quiz"&&w.data.questions?J=await FZ(e.uid,je,w.data.questions,fe):J=await UZ(e.uid,je,w.data.content||"",fe),B(J),U(!0);try{const Te=await Cb(e.uid);q(Te)}catch{}}catch(J){const W=J instanceof Error?J.message:"Erreur de sauvegarde";O(W)}finally{D(!1)}}},ir=async()=>{if(e){R(!0);try{const J=await Cb(e.uid);q(J),se(!0)}catch(J){console.error("[AIGenerator] Erreur historique:",J)}finally{R(!1)}}},rn=J=>J.replace(/[^\w\u00C0-\u017E\s-]/g,"").trim().replace(/\s+/g,"_").slice(0,60)||"contenu_pedaclic",pe=(J,W)=>{const fe=URL.createObjectURL(J),je=document.createElement("a");je.href=fe,je.download=W,document.body.appendChild(je),je.click(),document.body.removeChild(je),URL.revokeObjectURL(fe)},Ce=(J,W)=>{const fe=Ur(J),je=`
<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office"
      xmlns:w="urn:schemas-microsoft-com:office:word"
      xmlns="http://www.w3.org/TR/REC-html40">
<head>
  <meta charset="utf-8">
  <title>${W}</title>
  <!--[if gte mso 9]><xml><w:WordDocument><w:View>Print</w:View><w:Zoom>100</w:Zoom></w:WordDocument></xml><![endif]-->
  <style>
    body { font-family: Arial, sans-serif; font-size: 12pt; line-height: 1.6; margin: 2cm; color: #1a1a1a; }
    h1 { font-size: 18pt; color: #1a56db; margin-bottom: 12pt; }
    h2 { font-size: 15pt; color: #1a56db; margin-top: 18pt; margin-bottom: 8pt; }
    h3 { font-size: 13pt; color: #333; margin-top: 14pt; }
    p  { margin-bottom: 8pt; }
    ul, ol { margin-left: 1cm; margin-bottom: 8pt; }
    li { margin-bottom: 4pt; }
    strong { font-weight: bold; }
    em { font-style: italic; }
    code { font-family: Courier New; background: #f5f5f5; padding: 1pt 3pt; }
    pre  { font-family: Courier New; background: #f5f5f5; padding: 8pt; margin: 8pt 0; }
    hr { border: none; border-top: 1px solid #ccc; margin: 12pt 0; }
  </style>
</head>
<body>
  <h1>${W}</h1>
  ${fe}
</body>
</html>`,Te=new Blob(["\uFEFF",je],{type:"application/msword;charset=utf-8"});pe(Te,`${rn(W)}.doc`)},Re=(J,W)=>{const fe=Ur(J),je=window.open("","_blank","width=900,height=700");je&&(je.document.write(`
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>${W}</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: Arial, sans-serif; font-size: 12pt; line-height: 1.7; color: #1a1a1a; padding: 2cm; max-width: 800px; margin: auto; }
    h1 { font-size: 20pt; color: #1a56db; margin-bottom: 14pt; padding-bottom: 6pt; border-bottom: 2px solid #1a56db; }
    h2 { font-size: 15pt; color: #1a56db; margin: 18pt 0 8pt; }
    h3 { font-size: 13pt; color: #333; margin: 14pt 0 6pt; }
    p  { margin-bottom: 8pt; }
    ul, ol { margin: 6pt 0 8pt 1.5cm; }
    li { margin-bottom: 4pt; }
    strong { font-weight: bold; }
    em { font-style: italic; }
    code { font-family: Courier New, monospace; background: #f5f5f5; padding: 1pt 4pt; border-radius: 3pt; font-size: 10pt; }
    pre  { font-family: Courier New, monospace; background: #f5f5f5; padding: 10pt; margin: 8pt 0; border-radius: 4pt; font-size: 10pt; white-space: pre-wrap; }
    hr { border: none; border-top: 1px solid #ddd; margin: 14pt 0; }
    .header-meta { font-size: 9pt; color: #888; margin-bottom: 18pt; }
    @media print {
      body { padding: 0; }
      @page { margin: 2cm; }
    }
  </style>
</head>
<body>
  <h1>${W}</h1>
  <p class="header-meta">PedaClic  Gnr le ${new Date().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}</p>
  ${fe}
  <script>window.onload = () => { window.print(); };<\/script>
</body>
</html>`),je.document.close())},He=async J=>{if(window.confirm("Supprimer ce contenu gnr ?"))try{await GZ(J),q(W=>W.filter(fe=>fe.id!==J))}catch(W){console.error("[AIGenerator] Erreur suppression:",W)}},lt=async()=>{if(e){Me(!0);try{const J=await rA(e.uid);Q(J),he(!0)}catch(J){console.error("[AIGenerator] Erreur chargement ebooks:",J)}finally{Me(!1)}}},Vt=async J=>{if(window.confirm("Supprimer cet ebook ?"))try{await kee(J),Q(W=>W.filter(fe=>fe.id!==J))}catch(W){console.error("[AIGenerator] Erreur suppression ebook:",W)}},Br=J=>{const W=J.sections.map((fe,je)=>`# ${je+1}. ${fe.chapitre}

**${ur[fe.type]}**  ${fe.discipline}  ${fe.classe}

${fe.content}`).join(`

---

`);I({id:J.id,userId:J.userId,type:"cours_complet",discipline:"Ebook compil",disciplineId:"",classe:"",chapitre:J.titre,content:W,createdAt:J.createdAt}),he(!1)},Ur=g.useCallback(J=>{if(!J)return"";let W=J.replace(/^### (.+)$/gm,"<h3>$1</h3>").replace(/^## (.+)$/gm,"<h2>$1</h2>").replace(/^# (.+)$/gm,"<h1>$1</h1>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/^- (.+)$/gm,"<li>$1</li>").replace(/^\d+\. (.+)$/gm,"<li>$1</li>").replace(/^---$/gm,"<hr />").replace(/```(\w*)\n([\s\S]*?)```/g,"<pre><code>$2</code></pre>").replace(/`(.+?)`/g,"<code>$1</code>").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br />");return W=W.replace(/(<li>.*?<\/li>(\s*<br \/>)?)+/g,fe=>"<ul>"+fe.replace(/<br \/>/g,"")+"</ul>"),`<p>${W}</p>`},[]);return e?e.isPremium?r.jsxs("div",{className:"ai-generator",children:[r.jsxs("div",{className:"ai-generator__header",children:[r.jsx("h1",{className:"ai-generator__title",children:" Gnrateur de Contenu IA"}),r.jsx("p",{className:"ai-generator__subtitle",children:"Crez des cours, exercices, quiz et sujets d'examen adapts au programme sngalais"}),r.jsxs("div",{className:"ai-generator__header-actions",children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:ir,disabled:F,children:F?" Chargement...":" Historique"}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>{ir(),Y(!0)},title:"Compiler plusieurs contenus en un ebook",children:" Compiler un Ebook"}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:lt,disabled:ve,title:"Voir mes ebooks compils",children:ve?"...":" Mes Ebooks"}),t>1&&r.jsx("button",{className:"btn btn--outline btn--sm",onClick:nt,children:" Recommencer"})]})]}),r.jsx("div",{className:"ai-generator__steps",children:[1,2,3,4,5].map(J=>r.jsxs("div",{className:`ai-generator__step-indicator ${J===t?"ai-generator__step-indicator--active":""} ${J<t?"ai-generator__step-indicator--done":""}`,children:[r.jsx("span",{className:"ai-generator__step-number",children:J<t?"":J}),r.jsxs("span",{className:"ai-generator__step-label",children:[J===1&&"Paramtres",J===2&&"Chapitre",J===3&&"Type",J===4&&"Options",J===5&&"Rsultat"]})]},J))}),k&&r.jsxs("div",{className:"ai-generator__error",children:[r.jsx("span",{className:"ai-generator__error-icon",children:""}),k,r.jsx("button",{className:"ai-generator__error-close",onClick:()=>O(null),children:""})]}),r.jsxs("div",{className:"ai-generator__content",children:[t===1&&r.jsxs("div",{className:"ai-generator__step-content",children:[r.jsx("h2",{className:"ai-generator__step-title",children:" Paramtres de la leon"}),r.jsxs("div",{className:"ai-generator__field",children:[r.jsxs("label",{className:"ai-generator__label",children:["Discipline ",r.jsx("span",{className:"ai-generator__required",children:"*"})]}),ce?r.jsxs("div",{className:"ai-generator__loading",children:[r.jsx("div",{className:"spinner"}),r.jsx("p",{children:"Chargement des disciplines..."})]}):H.length===0?r.jsx("div",{className:"ai-generator__empty",children:r.jsx("p",{children:"Aucune discipline disponible."})}):r.jsx("div",{className:"ai-generator__discipline-grid",children:H.map(J=>r.jsx("button",{className:`ai-generator__discipline-card ${o?.nom===J.nom?"ai-generator__discipline-card--selected":""}`,onClick:()=>de(J),children:r.jsx("span",{className:"ai-generator__discipline-name",children:J.nom})},J.id))})]}),r.jsxs("div",{className:"ai-generator__field",children:[r.jsxs("label",{className:"ai-generator__label",children:["Classe ",r.jsx("span",{className:"ai-generator__required",children:"*"})]}),r.jsx("div",{className:"ai-generator__classe-grid",children:Mee.map(J=>r.jsx("button",{className:`ai-generator__classe-btn ${d===J?"ai-generator__classe-btn--selected":""}`,onClick:()=>{f(J),O(null)},children:J},J))})]}),r.jsxs("div",{className:"ai-generator__field",children:[r.jsxs("label",{htmlFor:"dureeCours",className:"ai-generator__label",children:["Dure de la leon (minutes) ",r.jsx("span",{className:"ai-generator__required",children:"*"})]}),r.jsxs("div",{className:"ai-generator__duree-group",children:[r.jsx("div",{className:"ai-generator__duree-presets",children:Pee.map(J=>r.jsxs("button",{className:`ai-generator__duree-btn ${p===J?"ai-generator__duree-btn--selected":""}`,onClick:()=>{h(J),O(null)},children:[J," min"]},J))}),r.jsx("input",{id:"dureeCours",type:"number",className:"ai-generator__input ai-generator__input--small",min:"15",max:"300",step:"5",value:p,onChange:J=>{const W=parseInt(J.target.value);h(isNaN(W)?"":W),O(null)},placeholder:"Autre dure..."})]})]}),r.jsxs("div",{className:"ai-generator__nav",children:[r.jsx("div",{})," ",r.jsx("button",{className:"btn btn--primary",onClick:we,disabled:!o||!d||!p,children:"Continuer "})]})]}),t===2&&r.jsxs("div",{className:"ai-generator__step-content",children:[r.jsx("h2",{className:"ai-generator__step-title",children:" Prcisez le chapitre"}),r.jsxs("div",{className:"ai-generator__recap",children:[r.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),r.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),r.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),r.jsx("span",{className:"ai-generator__recap-value",children:d}),r.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),r.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]})]}),r.jsxs("div",{className:"ai-generator__field",children:[r.jsx("label",{htmlFor:"chapitre",className:"ai-generator__label",children:"Titre du chapitre ou du thme"}),r.jsx("input",{id:"chapitre",type:"text",className:"ai-generator__input",placeholder:"Ex: Les fonctions affines, Le rcit autobiographique, La tectonique des plaques...",value:v,onChange:J=>b(J.target.value),onKeyDown:J=>J.key==="Enter"&&qe(),autoFocus:!0})]}),r.jsxs("div",{className:"ai-generator__nav",children:[r.jsx("button",{className:"btn btn--outline",onClick:Xe,children:" Retour"}),r.jsx("button",{className:"btn btn--primary",onClick:qe,disabled:!v.trim(),children:"Continuer "})]})]}),t===3&&r.jsxs("div",{className:"ai-generator__step-content",children:[r.jsx("h2",{className:"ai-generator__step-title",children:" Quel type de contenu ?"}),r.jsxs("div",{className:"ai-generator__recap",children:[r.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),r.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),r.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),r.jsx("span",{className:"ai-generator__recap-value",children:d}),r.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),r.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]}),r.jsx("span",{className:"ai-generator__recap-label",children:"Chapitre :"}),r.jsx("span",{className:"ai-generator__recap-value",children:v})]}),r.jsx("div",{className:"ai-generator__type-grid",children:Object.keys(ur).map(J=>r.jsxs("button",{className:"ai-generator__type-card",onClick:()=>We(J),children:[r.jsx("span",{className:"ai-generator__type-icon",children:Ba[J]}),r.jsx("span",{className:"ai-generator__type-name",children:ur[J]}),r.jsx("span",{className:"ai-generator__type-desc",children:LZ[J]})]},J))}),r.jsx("div",{className:"ai-generator__nav",children:r.jsx("button",{className:"btn btn--outline",onClick:Xe,children:" Retour"})})]}),t===4&&r.jsxs("div",{className:"ai-generator__step-content",children:[r.jsx("h2",{className:"ai-generator__step-title",children:" Options de gnration"}),r.jsxs("div",{className:"ai-generator__recap",children:[r.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),r.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),r.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),r.jsx("span",{className:"ai-generator__recap-value",children:d}),r.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),r.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]}),r.jsx("span",{className:"ai-generator__recap-label",children:"Chapitre :"}),r.jsx("span",{className:"ai-generator__recap-value",children:v}),r.jsx("span",{className:"ai-generator__recap-label",children:"Type :"}),r.jsxs("span",{className:"ai-generator__recap-value",children:[x&&Ba[x]," ",x&&ur[x]]})]}),r.jsxs("div",{className:"ai-generator__options",children:[r.jsxs("div",{className:"ai-generator__field",children:[r.jsx("label",{className:"ai-generator__label",children:"Niveau de difficult"}),r.jsx("div",{className:"ai-generator__radio-group",children:["facile","moyen","difficile"].map(J=>r.jsxs("label",{className:"ai-generator__radio",children:[r.jsx("input",{type:"radio",name:"difficulte",value:J,checked:N.difficulte===J,onChange:()=>S(W=>({...W,difficulte:J}))}),r.jsxs("span",{className:"ai-generator__radio-label",children:[J==="facile"&&" Facile",J==="moyen"&&" Moyen",J==="difficile"&&" Difficile"]})]},J))})]}),x==="sujet_examen"&&r.jsxs("div",{className:"ai-generator__field",children:[r.jsx("label",{className:"ai-generator__label",children:"Type d'examen"}),r.jsx("div",{className:"ai-generator__radio-group",children:["BFEM","BAC"].map(J=>r.jsxs("label",{className:"ai-generator__radio",children:[r.jsx("input",{type:"radio",name:"typeExamen",value:J,checked:N.typeExamen===J,onChange:()=>S(W=>({...W,typeExamen:J}))}),r.jsx("span",{className:"ai-generator__radio-label",children:J})]},J))})]}),r.jsxs("div",{className:"ai-generator__field",children:[r.jsx("label",{htmlFor:"objectifs",className:"ai-generator__label",children:"Objectifs pdagogiques (optionnel)"}),r.jsx("textarea",{id:"objectifs",className:"ai-generator__textarea",rows:3,placeholder:"Ex: L'lve doit tre capable de rsoudre une quation du 1er degr...",value:N.objectifs||"",onChange:J=>S(W=>({...W,objectifs:J.target.value||void 0}))})]}),r.jsxs("div",{className:"ai-generator__field",children:[r.jsx("label",{htmlFor:"consignes",className:"ai-generator__label",children:"Consignes spciales (optionnel)"}),r.jsx("textarea",{id:"consignes",className:"ai-generator__textarea",rows:2,placeholder:"Ex: Inclure un exercice sur les statistiques, utiliser des exemples avec le football...",value:N.consignesSpeciales||"",onChange:J=>S(W=>({...W,consignesSpeciales:J.target.value||void 0}))})]})]}),r.jsxs("div",{className:"ai-generator__nav",children:[r.jsx("button",{className:"btn btn--outline",onClick:Xe,children:" Retour"}),r.jsx("button",{className:"btn btn--primary btn--lg",onClick:gr,disabled:C,children:C?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"spinner spinner--sm"}),"Gnration en cours..."]}):" Gnrer le contenu"})]}),C&&r.jsxs("div",{className:"ai-generator__generating",children:[r.jsxs("div",{className:"ai-generator__generating-animation",children:[r.jsx("span",{children:""}),r.jsx("span",{children:""}),r.jsx("span",{children:""})]}),r.jsxs("p",{children:["L'IA rdige votre"," ",x&&ur[x].toLowerCase(),"..."]}),r.jsx("p",{className:"ai-generator__generating-hint",children:"Cela peut prendre 15  30 secondes."})]})]}),t===5&&w&&r.jsxs("div",{className:"ai-generator__step-content",children:[r.jsx("h2",{className:"ai-generator__step-title",children:" Contenu gnr"}),r.jsxs("div",{className:"ai-generator__recap ai-generator__recap--success",children:[r.jsx("span",{className:"ai-generator__recap-label",children:"Type :"}),r.jsxs("span",{className:"ai-generator__recap-value",children:[x&&Ba[x]," ",x&&ur[x]]}),r.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),r.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),r.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),r.jsx("span",{className:"ai-generator__recap-value",children:d}),r.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),r.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]}),r.jsx("span",{className:"ai-generator__recap-label",children:"Chapitre :"}),r.jsx("span",{className:"ai-generator__recap-value",children:v})]}),r.jsxs("div",{className:"ai-generator__preview",children:[r.jsxs("div",{className:"ai-generator__preview-header",children:[r.jsx("h3",{children:"Prvisualisation"}),r.jsxs("div",{className:"ai-generator__preview-actions",children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>{const J=w.type==="quiz"?JSON.stringify(w.data.questions,null,2):w.data.content||"";navigator.clipboard.writeText(J),alert("Contenu copi dans le presse-papier !")},children:" Copier"}),w.type!=="quiz"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Re(w.data.content||"",`${ur[x]}  ${o?.nom} ${d}`),title:"Tlcharger en PDF (via impression)",children:" PDF"}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Ce(w.data.content||"",`${ur[x]}  ${o?.nom} ${d}`),title:"Tlcharger en Word (.doc)",children:" Word"})]})]})]}),r.jsx("div",{className:"ai-generator__preview-body",children:w.type==="quiz"&&w.data.questions?r.jsxs("div",{className:"ai-generator__quiz-preview",children:[r.jsxs("p",{className:"ai-generator__quiz-count",children:[w.data.questions.length," questions gnres"]}),w.data.questions.map((J,W)=>r.jsxs("div",{className:"ai-generator__quiz-item",children:[r.jsxs("div",{className:"ai-generator__quiz-question",children:[r.jsxs("strong",{children:["Q",W+1,"."]})," ",J.question,r.jsx("span",{className:`ai-generator__quiz-badge ai-generator__quiz-badge--${J.difficulte}`,children:J.difficulte})]}),r.jsx("div",{className:"ai-generator__quiz-options",children:J.options.map((fe,je)=>r.jsxs("div",{className:`ai-generator__quiz-option ${je===J.reponseCorrecte?"ai-generator__quiz-option--correct":""}`,children:[r.jsx("span",{className:"ai-generator__quiz-option-letter",children:String.fromCharCode(65+je)}),fe,je===J.reponseCorrecte&&" "]},je))}),J.explication&&r.jsxs("div",{className:"ai-generator__quiz-explanation",children:[" ",J.explication]})]},W))]}):r.jsx("div",{className:"ai-generator__markdown-preview",dangerouslySetInnerHTML:{__html:Ur(w.data.content||"")}})})]}),r.jsxs("div",{className:"ai-generator__actions",children:[L?r.jsxs("div",{className:"ai-generator__save-success",children:[r.jsx("span",{children:" Sauvegard avec succs !"}),w.type==="quiz"&&$&&r.jsx(Ge,{to:`/quiz/${$}`,className:"btn btn--outline btn--sm",children:" Voir le quiz"})]}):r.jsx("button",{className:"btn btn--primary btn--lg",onClick:Dr,disabled:P,children:P?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"spinner spinner--sm"}),"Sauvegarde..."]}):r.jsx(r.Fragment,{children:" Sauvegarder dans PedaClic"})}),r.jsx("button",{className:"btn btn--outline",onClick:nt,children:" Nouvelle gnration"})]})]})]}),K&&r.jsx("div",{className:"ai-generator__modal-overlay",onClick:()=>I(null),children:r.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:J=>J.stopPropagation(),children:[r.jsxs("div",{className:"ai-generator__modal-header",children:[r.jsxs("div",{className:"ai-generator__modal-title-block",children:[r.jsxs("h2",{children:[Ba[K.type]," ",ur[K.type]]}),r.jsxs("span",{className:"ai-generator__modal-subtitle",children:[K.discipline," (",K.classe,")  ",K.chapitre]})]}),r.jsxs("div",{className:"ai-generator__modal-header-actions",children:[K.type!=="quiz_auto"&&K.content&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Re(K.content,`${ur[K.type]}  ${K.discipline} ${K.classe}`),title:"Enregistrer en PDF",children:" PDF"}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Ce(K.content,`${ur[K.type]}  ${K.discipline} ${K.classe}`),title:"Tlcharger en Word",children:" Word"})]}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:async()=>{I(null),await ir()},title:"Retour  l'historique",children:" Historique"}),r.jsx("button",{className:"ai-generator__modal-close",onClick:()=>I(null),children:""})]})]}),r.jsx("div",{className:"ai-generator__modal-body",children:r.jsx("div",{className:"ai-generator__markdown-preview",dangerouslySetInnerHTML:{__html:Ur(K.content||"")}})})]})}),te&&r.jsx(Dee,{userId:e.uid,history:M,markdownToHtml:Ur,onClose:()=>Y(!1),onSaved:async()=>{const J=await rA(e.uid);Q(J)}}),oe&&r.jsx("div",{className:"ai-generator__modal-overlay",onClick:()=>he(!1),children:r.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:J=>J.stopPropagation(),children:[r.jsxs("div",{className:"ai-generator__modal-header",children:[r.jsx("h2",{children:" Mes Ebooks compils"}),r.jsxs("div",{className:"ai-generator__modal-header-actions",children:[r.jsx("button",{className:"btn btn--primary btn--sm",onClick:()=>{he(!1),Y(!0)},children:"+ Nouvel ebook"}),r.jsx("button",{className:"ai-generator__modal-close",onClick:()=>he(!1),children:""})]})]}),r.jsx("div",{className:"ai-generator__modal-body",children:ge.length===0?r.jsx("p",{className:"ai-generator__empty",children:`Vous n'avez pas encore compil d'ebook. Cliquez sur "Compiler un Ebook" pour commencer.`}):r.jsx("div",{className:"ebook-compiler__my-list",children:ge.map(J=>r.jsxs("div",{className:"ebook-compiler__my-item",children:[r.jsx("div",{className:"ebook-compiler__my-cover",children:""}),r.jsxs("div",{className:"ebook-compiler__my-info",children:[r.jsx("div",{className:"ebook-compiler__my-title",children:J.titre}),J.description&&r.jsx("div",{className:"ebook-compiler__my-desc",children:J.description}),r.jsxs("div",{className:"ebook-compiler__my-meta",children:[J.sections.length," chapitre",J.sections.length>1?"s":""," "," ",J.createdAt?.toDate?J.createdAt.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}):""]})]}),r.jsxs("div",{className:"ai-generator__history-actions",children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Br(J),title:"Lire l'ebook",children:" Lire"}),r.jsx("button",{className:"btn btn--danger btn--sm",onClick:()=>J.id&&Vt(J.id),title:"Supprimer",children:""})]})]},J.id))})})]})}),re&&r.jsx("div",{className:"ai-generator__modal-overlay",onClick:()=>se(!1),children:r.jsxs("div",{className:"ai-generator__modal",onClick:J=>J.stopPropagation(),children:[r.jsxs("div",{className:"ai-generator__modal-header",children:[r.jsx("h2",{children:" Historique des gnrations"}),r.jsx("button",{className:"ai-generator__modal-close",onClick:()=>se(!1),children:""})]}),r.jsx("div",{className:"ai-generator__modal-body",children:M.length===0?r.jsx("p",{className:"ai-generator__empty",children:"Aucun contenu gnr pour le moment."}):r.jsx("div",{className:"ai-generator__history-list",children:M.map(J=>r.jsxs("div",{className:"ai-generator__history-item",children:[r.jsxs("div",{className:"ai-generator__history-info",children:[r.jsxs("span",{className:"ai-generator__history-type",children:[Ba[J.type]," ",ur[J.type]]}),r.jsxs("span",{className:"ai-generator__history-details",children:[J.discipline," (",J.classe,")  ",J.chapitre]}),r.jsx("span",{className:"ai-generator__history-date",children:J.createdAt?.toDate?J.createdAt.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Date inconnue"})]}),r.jsxs("div",{className:"ai-generator__history-actions",children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>{I(J),se(!1)},title:"Lire le contenu",children:" Lire"}),J.type!=="quiz_auto"&&J.content&&r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Re(J.content,`${ur[J.type]}  ${J.discipline} ${J.classe}`),title:"PDF",children:""}),r.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Ce(J.content,`${ur[J.type]}  ${J.discipline} ${J.classe}`),title:"Word",children:""})]}),r.jsx("button",{className:"btn btn--danger btn--sm",onClick:()=>J.id&&He(J.id),title:"Supprimer",children:""})]})]},J.id))})})]})})]}):r.jsx("div",{className:"ai-generator",children:r.jsxs("div",{className:"ai-generator__gate",children:[r.jsx("div",{className:"ai-generator__gate-icon",children:""}),r.jsx("h2",{children:"Fonctionnalit Premium"}),r.jsx("p",{children:"Le gnrateur de contenu IA est rserv aux abonns Premium. Gnrez des cours, des exercices, des quiz et des sujets d'examen adapts au programme sngalais en un clic !"}),r.jsxs("div",{className:"ai-generator__gate-price",children:[r.jsx("span",{className:"price",children:"2 000 FCFA"}),r.jsx("span",{className:"period",children:"/mois"})]}),r.jsx(Ge,{to:"/premium",className:"btn btn--primary btn--lg",children:"Devenir Premium"})]})}):r.jsx("div",{className:"ai-generator",children:r.jsxs("div",{className:"ai-generator__gate",children:[r.jsx("div",{className:"ai-generator__gate-icon",children:""}),r.jsx("h2",{children:"Connexion requise"}),r.jsx("p",{children:"Vous devez tre connect pour accder au gnrateur de contenu IA."}),r.jsx(Ge,{to:"/connexion",className:"btn btn--primary",children:"Se connecter"})]})})},qee=()=>{const[e,t]=g.useState(null),[n,a]=g.useState(!1),[l,o]=g.useState(!1),[u,d]=g.useState(!1),f=()=>/iPhone|iPad|iPod/.test(navigator.userAgent)&&!window.MSStream,p=()=>window.matchMedia("(display-mode: standalone)").matches||navigator.standalone===!0,h=g.useCallback(()=>{try{return parseInt(localStorage.getItem("pedaclic_visit_count")||"0",10)}catch{return 0}},[]),v=g.useCallback(()=>{try{const N=h()+1;localStorage.setItem("pedaclic_visit_count",N.toString())}catch{}},[h]),b=()=>{try{const N=localStorage.getItem("pedaclic_install_dismissed_at");if(!N)return!1;const S=720*60*60*1e3;return Date.now()-parseInt(N,10)<S}catch{return!1}};g.useEffect(()=>{if(p()||b())return;v();const N=C=>{C.preventDefault(),t(C),h()>=1&&a(!0)};window.addEventListener("beforeinstallprompt",N),f()&&h()>=1&&(o(!0),a(!0));const S=()=>{a(!1),t(null)};return window.addEventListener("appinstalled",S),()=>{window.removeEventListener("beforeinstallprompt",N),window.removeEventListener("appinstalled",S)}},[h,v]);const x=async()=>{if(e){d(!0);try{await e.prompt();const{outcome:N}=await e.userChoice;N==="accepted"&&a(!1)}catch(N){console.error("Erreur installation PWA:",N)}finally{d(!1),t(null)}}},j=()=>{a(!1);try{localStorage.setItem("pedaclic_install_dismissed_at",Date.now().toString()),localStorage.removeItem("pedaclic_install_dismissed")}catch{}};return n?r.jsx("div",{className:"install-prompt",children:r.jsxs("div",{className:"install-prompt__container",children:[r.jsxs("div",{className:"install-prompt__content",children:[r.jsx("div",{className:"install-prompt__icon",children:r.jsx(iA,{size:24})}),r.jsxs("div",{className:"install-prompt__text",children:[r.jsx("h3",{className:"install-prompt__title",children:"Installer PedaClic"}),r.jsx("p",{className:"install-prompt__description",children:l?"Accde  tes cours mme sans connexion !":"Installe l'app pour un accs rapide, mme hors-ligne !"})]})]}),r.jsxs("div",{className:"install-prompt__actions",children:[!l&&e&&r.jsx("button",{className:"install-prompt__btn install-prompt__btn--primary",onClick:x,disabled:u,children:u?"Installation...":"Installer"}),l&&r.jsx("div",{className:"install-prompt__ios",children:r.jsxs("p",{className:"install-prompt__ios-text",children:["Appuie sur ",r.jsx(h3,{size:16,className:"install-prompt__ios-icon"})," puis",r.jsxs("span",{className:"install-prompt__ios-highlight",children:[r.jsx(Ec,{size:14})," Sur l'cran d'accueil"]})]})}),r.jsx("button",{className:"install-prompt__btn install-prompt__btn--close",onClick:j,"aria-label":"Fermer la bannire d'installation",children:r.jsx($i,{size:20})})]})]})}):null};function Ree(){const[e,t]=g.useState(typeof navigator<"u"?navigator.onLine:!0);return g.useEffect(()=>{const n=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",n),window.addEventListener("offline",a),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",a)}},[]),e}const Iee=()=>{const e=Ree(),[t,n]=g.useState(!1),[a,l]=g.useState(!1);return g.useEffect(()=>{if(!e)l(!0),n(!1);else if(a){n(!0);const o=setTimeout(()=>{n(!1),l(!1)},3e3);return()=>clearTimeout(o)}},[e,a]),e&&!t?null:r.jsx("div",{className:`network-indicator ${e?"network-indicator--online":"network-indicator--offline"}`,children:r.jsx("div",{className:"network-indicator__content",children:e?r.jsxs(r.Fragment,{children:[r.jsx(v3,{size:14}),r.jsx("span",{children:"Connexion rtablie"})]}):r.jsxs(r.Fragment,{children:[r.jsx(g3,{size:14}),r.jsx("span",{children:"Pas de connexion  mode hors-ligne"})]})})})},Lee=()=>(g.useEffect(()=>{YE();const e=setInterval(YE,600*1e3);return()=>clearInterval(e)},[]),r.jsxs(A3,{children:[r.jsx(qee,{}),r.jsx(Iee,{}),r.jsxs(Cq,{children:[r.jsx(Fe,{path:"/",element:r.jsx(mt,{children:r.jsx(G3,{})})}),r.jsx(Fe,{path:"/disciplines",element:r.jsx(mt,{children:r.jsx(H3,{})})}),r.jsx(Fe,{path:"/disciplines/:id",element:r.jsx(mt,{children:r.jsx(W3,{})})}),r.jsx(Fe,{path:"/quiz-gratuits",element:r.jsx(mt,{children:r.jsx(gR,{})})}),r.jsx(Fe,{path:"/ebooks",element:r.jsx(mt,{children:r.jsx(See,{})})}),r.jsx(Fe,{path:"/cours",element:r.jsx(mt,{children:r.jsx(FJ,{})})}),r.jsx(Fe,{path:"/cours/:coursId",element:r.jsx(mt,{children:r.jsx(ree,{})})}),r.jsx(Fe,{path:"/connexion",element:r.jsx(X3,{})}),r.jsx(Fe,{path:"/inscription",element:r.jsx(Z3,{})}),r.jsx(Fe,{path:"/mot-de-passe-oublie",element:r.jsx(J3,{})}),r.jsx(Fe,{path:"/premium/confirmation",element:r.jsx(l5,{})}),r.jsx(Fe,{path:"/premium",element:r.jsx(mt,{children:r.jsx(s5,{})})}),r.jsx(Fe,{path:"/quizzes",element:r.jsx(Xl,{allowedRoles:["eleve","prof","admin"],children:r.jsx(mt,{children:r.jsx(sR,{})})})}),r.jsx(Fe,{path:"/quiz/:quizId",element:r.jsx(mt,{children:r.jsx(kR,{})})}),r.jsx(Fe,{path:"/quiz-avance/:quizId",element:r.jsx(mt,{children:r.jsx(nR,{})})}),r.jsx(Fe,{path:"/generateur",element:r.jsx(mt,{children:r.jsx(Tee,{})})}),r.jsx(Fe,{path:"/eleve/dashboard",element:r.jsx(mt,{children:r.jsx(VX,{})})}),r.jsx(Fe,{path:"/eleve/suivi",element:r.jsx(mt,{children:r.jsx(YX,{})})}),r.jsx(Fe,{path:"/eleve/cahiers/:cahierId",element:r.jsx(Xl,{allowedRoles:["eleve","admin"],children:r.jsx(mt,{children:r.jsx(tJ,{})})})}),r.jsx(Fe,{path:"/parent/dashboard",element:r.jsx(Xl,{allowedRoles:["parent","admin"],children:r.jsx(mt,{children:r.jsx(zee,{})})})}),r.jsx(Fe,{path:"/prof/dashboard",element:r.jsx(mn,{children:r.jsx(mt,{children:r.jsx(ZX,{})})})}),r.jsx(Fe,{path:"/prof/cahiers",element:r.jsx(mn,{children:r.jsx(mt,{children:r.jsx(bZ,{})})})}),r.jsx(Fe,{path:"/prof/cahiers/:cahierId",element:r.jsx(mn,{children:r.jsx(mt,{children:r.jsx(kZ,{})})})}),r.jsx(Fe,{path:"/prof/cahiers/:cahierId/nouvelle",element:r.jsx(mn,{children:r.jsx(mt,{children:r.jsx(KE,{})})})}),r.jsx(Fe,{path:"/prof/cahiers/:cahierId/modifier/:entreeId",element:r.jsx(mn,{children:r.jsx(mt,{children:r.jsx(KE,{})})})}),r.jsx(Fe,{path:"/prof/sequences",element:r.jsx(mn,{children:r.jsx(mt,{children:r.jsx(fJ,{})})})}),r.jsx(Fe,{path:"/prof/sequences/nouvelle",element:r.jsx(mn,{children:r.jsx(mt,{children:r.jsx(WE,{})})})}),r.jsx(Fe,{path:"/prof/sequences/:id",element:r.jsx(mn,{children:r.jsx(mt,{children:r.jsx(EJ,{})})})}),r.jsx(Fe,{path:"/prof/sequences/:id/modifier",element:r.jsx(mn,{children:r.jsx(mt,{children:r.jsx(WE,{})})})}),r.jsx(Fe,{path:"/prof/cours",element:r.jsx(mn,{children:r.jsx(mt,{children:r.jsx(cee,{})})})}),r.jsx(Fe,{path:"/prof/cours/nouveau",element:r.jsx(mn,{children:r.jsx(mt,{children:r.jsx(JE,{})})})}),r.jsx(Fe,{path:"/prof/cours/:coursId/modifier",element:r.jsx(mn,{children:r.jsx(mt,{children:r.jsx(JE,{})})})}),r.jsx(Fe,{path:"/admin",element:r.jsx(dn,{children:r.jsx(fn,{children:r.jsx(u5,{})})})}),r.jsx(Fe,{path:"/admin/disciplines",element:r.jsx(dn,{children:r.jsx(fn,{children:r.jsx(d5,{})})})}),r.jsx(Fe,{path:"/admin/chapitres",element:r.jsx(dn,{children:r.jsx(fn,{children:r.jsx(m5,{})})})}),r.jsx(Fe,{path:"/admin/ressources",element:r.jsx(dn,{children:r.jsx(fn,{children:r.jsx(f5,{})})})}),r.jsx(Fe,{path:"/admin/quiz",element:r.jsx(dn,{children:r.jsx(fn,{children:r.jsx(b5,{})})})}),r.jsx(Fe,{path:"/admin/quiz/nouveau",element:r.jsx(dn,{children:r.jsx(fn,{children:r.jsx(q1,{})})})}),r.jsx(Fe,{path:"/admin/quiz/modifier/:quizId",element:r.jsx(dn,{children:r.jsx(fn,{children:r.jsx(q1,{})})})}),r.jsx(Fe,{path:"/admin/quiz-avance",element:r.jsx(dn,{children:r.jsx(fn,{children:r.jsx(W5,{})})})}),r.jsx(Fe,{path:"/admin/utilisateurs",element:r.jsx(dn,{children:r.jsx(fn,{children:r.jsx(E5,{})})})}),r.jsx(Fe,{path:"/admin/resultats",element:r.jsx(dn,{children:r.jsx(fn,{children:r.jsx(A5,{})})})}),r.jsx(Fe,{path:"/admin/settings",element:r.jsx(dn,{children:r.jsx(fn,{children:r.jsx(z5,{})})})}),r.jsx(Fe,{path:"/admin/ebooks",element:r.jsx(dn,{children:r.jsx(fn,{children:r.jsx(wee,{})})})}),r.jsx(Fe,{path:"/admin/premium",element:r.jsx(kd,{to:"/admin/utilisateurs?filter=premium",replace:!0})}),r.jsx(Fe,{path:"/notifications",element:r.jsx(Xl,{allowedRoles:["eleve","prof","admin","parent"],children:r.jsx(mt,{children:r.jsx(Aee,{})})})}),r.jsx(Fe,{path:"/prof/notifications/nouvelle",element:r.jsx(mn,{children:r.jsx(mt,{children:r.jsx(tA,{})})})}),r.jsx(Fe,{path:"/admin/notifications/nouvelle",element:r.jsx(dn,{children:r.jsx(fn,{children:r.jsx(tA,{})})})}),r.jsx(Fe,{path:"/cahiers",element:r.jsx(kd,{to:"/prof/cahiers",replace:!0})}),r.jsx(Fe,{path:"/sequences",element:r.jsx(kd,{to:"/prof/sequences",replace:!0})}),r.jsx(Fe,{path:"*",element:r.jsx(kd,{to:"/",replace:!0})})]})]})),mP=document.getElementById("root");if(!mP)throw new Error("L'lment #root n'existe pas");const $ee=w3.createRoot(mP);$ee.render(r.jsx(Eq.StrictMode,{children:r.jsx(Aq,{children:r.jsx(Lee,{})})}));
//# sourceMappingURL=index-ZFPvbV_v.js.map
