import{a as Nf,b as Bq,g as oi,r as g,u as Je,c as Lb,L as Le,d as xn,e as pA,f as hA,R as Uq,h as Fq,i as Ie,N as Ld,j as Gq,B as Hq}from"./vendor-react-BMsfgiGx.js";import{i as Vq,g as Qq,a as Yq,p as Kq,b as Wq,c as Xq,o as Zq,d as je,u as He,s as Dt,e as Jq,f as e3,h as t3,G as r3,j as n3,k as a3,l as Et,m as su,w as Ne,n as Ve,q as Ht,r as Ee,t as _e,v as Ce,x as Tn,T as Ae,y as Br,z as Sf,A as Pt,B as sr,C as Is,D as Ls,E as Mn,F as as,H as $b,I as i3,J as lu}from"./vendor-firebase-LntcAirY.js";import{H as Ax,B as hn,F as s3,G as $s,S as Zr,L as N1,a as l3,C as Bs,b as Oc,D as vA,c as gm,U as o3,d as c3,e as S1,X as Ki,M as u3,f as om,g as d3,P as m3,h as f3,i as p3,j as h3,k as Bb,l as cm,m as v3,n as g3,T as x3,I as b3,o as y3,Y as j3,A as ks,p as ao,q as Ut,Z as gA,r as xA,s as uo,t as ts,u as xm,v as Dc,w as bA,x as Ub,y as zx,E as lo,z as _3,J as w1,K as N3,N as S3,O as w3,R as C3,Q as E3,V as A3,W as Pc,_ as kx,$ as Tv,a0 as z3,a1 as k3,a2 as Ox,a3 as qv,a4 as Rv,a5 as O3,a6 as D3,a7 as P3,a8 as M3,a9 as T3}from"./vendor-icons-B5C-ccqU.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}})();var Iv={exports:{}},xc={};var C1;function q3(){if(C1)return xc;C1=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function n(a,l,o){var u=null;if(o!==void 0&&(u=""+o),l.key!==void 0&&(u=""+l.key),"key"in l){o={};for(var d in l)d!=="key"&&(o[d]=l[d])}else o=l;return l=o.ref,{$$typeof:e,type:a,key:u,ref:l!==void 0?l:null,props:o}}return xc.Fragment=r,xc.jsx=n,xc.jsxs=n,xc}var E1;function R3(){return E1||(E1=1,Iv.exports=q3()),Iv.exports}var t=R3(),Lv={exports:{}},bc={},$v={exports:{}},Bv={};var A1;function I3(){return A1||(A1=1,(function(e){function r(T,F){var I=T.length;T.push(F);e:for(;0<I;){var X=I-1>>>1,L=T[X];if(0<l(L,F))T[X]=F,T[I]=L,I=X;else break e}}function n(T){return T.length===0?null:T[0]}function a(T){if(T.length===0)return null;var F=T[0],I=T.pop();if(I!==F){T[0]=I;e:for(var X=0,L=T.length,ne=L>>>1;X<ne;){var K=2*(X+1)-1,oe=T[K],xe=K+1,ve=T[xe];if(0>l(oe,I))xe<L&&0>l(ve,oe)?(T[X]=ve,T[xe]=I,X=xe):(T[X]=oe,T[K]=I,X=K);else if(xe<L&&0>l(ve,I))T[X]=ve,T[xe]=I,X=xe;else break e}}return F}function l(T,F){var I=T.sortIndex-F.sortIndex;return I!==0?I:T.id-F.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var f=[],p=[],h=1,v=null,b=3,x=!1,j=!1,_=!1,C=!1,w=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function A(T){for(var F=n(p);F!==null;){if(F.callback===null)a(p);else if(F.startTime<=T)a(p),F.sortIndex=F.expirationTime,r(f,F);else break;F=n(p)}}function O(T){if(_=!1,A(T),!j)if(n(f)!==null)j=!0,k||(k=!0,R());else{var F=n(p);F!==null&&M(O,F.startTime-T)}}var k=!1,P=-1,D=5,B=-1;function U(){return C?!0:!(e.unstable_now()-B<D)}function $(){if(C=!1,k){var T=e.unstable_now();B=T;var F=!0;try{e:{j=!1,_&&(_=!1,E(P),P=-1),x=!0;var I=b;try{t:{for(A(T),v=n(f);v!==null&&!(v.expirationTime>T&&U());){var X=v.callback;if(typeof X=="function"){v.callback=null,b=v.priorityLevel;var L=X(v.expirationTime<=T);if(T=e.unstable_now(),typeof L=="function"){v.callback=L,A(T),F=!0;break t}v===n(f)&&a(f),A(T)}else a(f);v=n(f)}if(v!==null)F=!0;else{var ne=n(p);ne!==null&&M(O,ne.startTime-T),F=!1}}break e}finally{v=null,b=I,x=!1}F=void 0}}finally{F?R():k=!1}}}var R;if(typeof S=="function")R=function(){S($)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,ae=Y.port2;Y.port1.onmessage=$,R=function(){ae.postMessage(null)}}else R=function(){w($,0)};function M(T,F){P=w(function(){T(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(T){T.callback=null},e.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<T?Math.floor(1e3/T):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(T){switch(b){case 1:case 2:case 3:var F=3;break;default:F=b}var I=b;b=F;try{return T()}finally{b=I}},e.unstable_requestPaint=function(){C=!0},e.unstable_runWithPriority=function(T,F){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var I=b;b=T;try{return F()}finally{b=I}},e.unstable_scheduleCallback=function(T,F,I){var X=e.unstable_now();switch(typeof I=="object"&&I!==null?(I=I.delay,I=typeof I=="number"&&0<I?X+I:X):I=X,T){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=I+L,T={id:h++,callback:F,priorityLevel:T,startTime:I,expirationTime:L,sortIndex:-1},I>X?(T.sortIndex=I,r(p,T),n(f)===null&&T===n(p)&&(_?(E(P),P=-1):_=!0,M(O,I-X))):(T.sortIndex=L,r(f,T),j||x||(j=!0,k||(k=!0,R()))),T},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(T){var F=b;return function(){var I=b;b=F;try{return T.apply(this,arguments)}finally{b=I}}}})(Bv)),Bv}var z1;function L3(){return z1||(z1=1,$v.exports=I3()),$v.exports}var k1;function $3(){if(k1)return bc;k1=1;var e=L3(),r=Nf(),n=Bq();function a(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function u(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function d(i){if(i.tag===31){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function f(i){if(o(i)!==i)throw Error(a(188))}function p(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(a(188));return s!==i?null:i}for(var c=i,m=s;;){var y=c.return;if(y===null)break;var N=y.alternate;if(N===null){if(m=y.return,m!==null){c=m;continue}break}if(y.child===N.child){for(N=y.child;N;){if(N===c)return f(y),i;if(N===m)return f(y),s;N=N.sibling}throw Error(a(188))}if(c.return!==m.return)c=y,m=N;else{for(var z=!1,q=y.child;q;){if(q===c){z=!0,c=y,m=N;break}if(q===m){z=!0,m=y,c=N;break}q=q.sibling}if(!z){for(q=N.child;q;){if(q===c){z=!0,c=N,m=y;break}if(q===m){z=!0,m=N,c=y;break}q=q.sibling}if(!z)throw Error(a(189))}}if(c.alternate!==m)throw Error(a(190))}if(c.tag!==3)throw Error(a(188));return c.stateNode.current===c?i:s}function h(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=h(i),s!==null)return s;i=i.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),E=Symbol.for("react.consumer"),S=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),k=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),$=Symbol.iterator;function R(i){return i===null||typeof i!="object"?null:(i=$&&i[$]||i["@@iterator"],typeof i=="function"?i:null)}var Y=Symbol.for("react.client.reference");function ae(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Y?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case _:return"Fragment";case w:return"Profiler";case C:return"StrictMode";case O:return"Suspense";case k:return"SuspenseList";case B:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case j:return"Portal";case S:return i.displayName||"Context";case E:return(i._context.displayName||"Context")+".Consumer";case A:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case P:return s=i.displayName||null,s!==null?s:ae(i.type)||"Memo";case D:s=i._payload,i=i._init;try{return ae(i(s))}catch{}}return null}var M=Array.isArray,T=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I={pending:!1,data:null,method:null,action:null},X=[],L=-1;function ne(i){return{current:i}}function K(i){0>L||(i.current=X[L],X[L]=null,L--)}function oe(i,s){L++,X[L]=i.current,i.current=s}var xe=ne(null),ve=ne(null),H=ne(null),he=ne(null);function Me(i,s){switch(oe(H,s),oe(ve,i),oe(xe,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?VN(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=VN(s),i=QN(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}K(xe),oe(xe,i)}function ue(){K(xe),K(ve),K(H)}function Z(i){i.memoizedState!==null&&oe(he,i);var s=xe.current,c=QN(s,i.type);s!==c&&(oe(ve,i),oe(xe,c))}function V(i){ve.current===i&&(K(xe),K(ve)),he.current===i&&(K(he),pc._currentValue=I)}var me,we;function qe(i){if(me===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);me=s&&s[1]||"",we=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+me+i+we}var Xe=!1;function et(i,s){if(!i||Xe)return"";Xe=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(s){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(fe){var le=fe}Reflect.construct(i,[],ye)}else{try{ye.call()}catch(fe){le=fe}i.call(ye.prototype)}}else{try{throw Error()}catch(fe){le=fe}(ye=i())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(fe){if(fe&&le&&typeof fe.stack=="string")return[fe.stack,le.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var N=m.DetermineComponentFrameRoot(),z=N[0],q=N[1];if(z&&q){var G=z.split(`
`),se=q.split(`
`);for(y=m=0;m<G.length&&!G[m].includes("DetermineComponentFrameRoot");)m++;for(;y<se.length&&!se[y].includes("DetermineComponentFrameRoot");)y++;if(m===G.length||y===se.length)for(m=G.length-1,y=se.length-1;1<=m&&0<=y&&G[m]!==se[y];)y--;for(;1<=m&&0<=y;m--,y--)if(G[m]!==se[y]){if(m!==1||y!==1)do if(m--,y--,0>y||G[m]!==se[y]){var ge=`
`+G[m].replace(" at new "," at ");return i.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",i.displayName)),ge}while(1<=m&&0<=y);break}}}finally{Xe=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?qe(c):""}function it(i,s){switch(i.tag){case 26:case 27:case 5:return qe(i.type);case 16:return qe("Lazy");case 13:return i.child!==s&&s!==null?qe("Suspense Fallback"):qe("Suspense");case 19:return qe("SuspenseList");case 0:case 15:return et(i.type,!1);case 11:return et(i.type.render,!1);case 1:return et(i.type,!0);case 31:return qe("Activity");default:return""}}function jr(i){try{var s="",c=null;do s+=it(i,c),c=i,i=i.return;while(i);return s}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var Mr=Object.prototype.hasOwnProperty,cr=e.unstable_scheduleCallback,nn=e.unstable_cancelCallback,pe=e.unstable_shouldYield,ze=e.unstable_requestPaint,Re=e.unstable_now,Qe=e.unstable_getCurrentPriorityLevel,pt=e.unstable_ImmediatePriority,It=e.unstable_UserBlockingPriority,nr=e.unstable_NormalPriority,Gr=e.unstable_LowPriority,ee=e.unstable_IdlePriority,Pe=e.log,ct=e.unstable_setDisableYieldValue,J=null,ce=null;function Se(i){if(typeof Pe=="function"&&ct(i),ce&&typeof ce.setStrictMode=="function")try{ce.setStrictMode(J,i)}catch{}}var Ze=Math.clz32?Math.clz32:Gn,kr=Math.log,Fn=Math.LN2;function Gn(i){return i>>>=0,i===0?32:31-(kr(i)/Fn|0)|0}var ia=256,ol=262144,cl=4194304;function Ea(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ul(i,s,c){var m=i.pendingLanes;if(m===0)return 0;var y=0,N=i.suspendedLanes,z=i.pingedLanes;i=i.warmLanes;var q=m&134217727;return q!==0?(m=q&~N,m!==0?y=Ea(m):(z&=q,z!==0?y=Ea(z):c||(c=q&~i,c!==0&&(y=Ea(c))))):(q=m&~N,q!==0?y=Ea(q):z!==0?y=Ea(z):c||(c=m&~i,c!==0&&(y=Ea(c)))),y===0?0:s!==0&&s!==y&&(s&N)===0&&(N=y&-y,c=s&-s,N>=c||N===32&&(c&4194048)!==0)?s:y}function Hn(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function Np(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function te(){var i=cl;return cl<<=1,(cl&62914560)===0&&(cl=4194304),i}function Ue(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function ht(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function bn(i,s,c,m,y,N){var z=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var q=i.entanglements,G=i.expirationTimes,se=i.hiddenUpdates;for(c=z&~c;0<c;){var ge=31-Ze(c),ye=1<<ge;q[ge]=0,G[ge]=-1;var le=se[ge];if(le!==null)for(se[ge]=null,ge=0;ge<le.length;ge++){var fe=le[ge];fe!==null&&(fe.lane&=-536870913)}c&=~ye}m!==0&&dl(i,m,0),N!==0&&y===0&&i.tag!==0&&(i.suspendedLanes|=N&~(z&~s))}function dl(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var m=31-Ze(s);i.entangledLanes|=s,i.entanglements[m]=i.entanglements[m]|1073741824|c&261930}function us(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var m=31-Ze(c),y=1<<m;y&s|i[m]&s&&(i[m]|=s),c&=~y}}function kj(i,s){var c=s&-s;return c=(c&42)!==0?1:Sp(c),(c&(i.suspendedLanes|s))!==0?0:c}function Sp(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function wp(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Oj(){var i=F.p;return i!==0?i:(i=window.event,i===void 0?32:v1(i.type))}function Dj(i,s){var c=F.p;try{return F.p=i,s()}finally{F.p=c}}var xi=Math.random().toString(36).slice(2),_r="__reactFiber$"+xi,Hr="__reactProps$"+xi,ml="__reactContainer$"+xi,Cp="__reactEvents$"+xi,kM="__reactListeners$"+xi,OM="__reactHandles$"+xi,Pj="__reactResources$"+xi,zo="__reactMarker$"+xi;function Ep(i){delete i[_r],delete i[Hr],delete i[Cp],delete i[kM],delete i[OM]}function fl(i){var s=i[_r];if(s)return s;for(var c=i.parentNode;c;){if(s=c[ml]||c[_r]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=e1(i);i!==null;){if(c=i[_r])return c;i=e1(i)}return s}i=c,c=i.parentNode}return null}function pl(i){if(i=i[_r]||i[ml]){var s=i.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return i}return null}function ko(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(a(33))}function hl(i){var s=i[Pj];return s||(s=i[Pj]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function ur(i){i[zo]=!0}var Mj=new Set,Tj={};function ds(i,s){vl(i,s),vl(i+"Capture",s)}function vl(i,s){for(Tj[i]=s,i=0;i<s.length;i++)Mj.add(s[i])}var DM=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qj={},Rj={};function PM(i){return Mr.call(Rj,i)?!0:Mr.call(qj,i)?!1:DM.test(i)?Rj[i]=!0:(qj[i]=!0,!1)}function Eu(i,s,c){if(PM(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var m=s.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function Au(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function Aa(i,s,c,m){if(m===null)i.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+m)}}function yn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ij(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function MM(i,s,c){var m=Object.getOwnPropertyDescriptor(i.constructor.prototype,s);if(!i.hasOwnProperty(s)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var y=m.get,N=m.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return y.call(this)},set:function(z){c=""+z,N.call(this,z)}}),Object.defineProperty(i,s,{enumerable:m.enumerable}),{getValue:function(){return c},setValue:function(z){c=""+z},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function Ap(i){if(!i._valueTracker){var s=Ij(i)?"checked":"value";i._valueTracker=MM(i,s,""+i[s])}}function Lj(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),m="";return i&&(m=Ij(i)?i.checked?"true":"false":i.value),i=m,i!==c?(s.setValue(i),!0):!1}function zu(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var TM=/[\n"\\]/g;function jn(i){return i.replace(TM,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function zp(i,s,c,m,y,N,z,q){i.name="",z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?i.type=z:i.removeAttribute("type"),s!=null?z==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+yn(s)):i.value!==""+yn(s)&&(i.value=""+yn(s)):z!=="submit"&&z!=="reset"||i.removeAttribute("value"),s!=null?kp(i,z,yn(s)):c!=null?kp(i,z,yn(c)):m!=null&&i.removeAttribute("value"),y==null&&N!=null&&(i.defaultChecked=!!N),y!=null&&(i.checked=y&&typeof y!="function"&&typeof y!="symbol"),q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?i.name=""+yn(q):i.removeAttribute("name")}function $j(i,s,c,m,y,N,z,q){if(N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(i.type=N),s!=null||c!=null){if(!(N!=="submit"&&N!=="reset"||s!=null)){Ap(i);return}c=c!=null?""+yn(c):"",s=s!=null?""+yn(s):c,q||s===i.value||(i.value=s),i.defaultValue=s}m=m??y,m=typeof m!="function"&&typeof m!="symbol"&&!!m,i.checked=q?i.checked:!!m,i.defaultChecked=!!m,z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(i.name=z),Ap(i)}function kp(i,s,c){s==="number"&&zu(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function gl(i,s,c,m){if(i=i.options,s){s={};for(var y=0;y<c.length;y++)s["$"+c[y]]=!0;for(c=0;c<i.length;c++)y=s.hasOwnProperty("$"+i[c].value),i[c].selected!==y&&(i[c].selected=y),y&&m&&(i[c].defaultSelected=!0)}else{for(c=""+yn(c),s=null,y=0;y<i.length;y++){if(i[y].value===c){i[y].selected=!0,m&&(i[y].defaultSelected=!0);return}s!==null||i[y].disabled||(s=i[y])}s!==null&&(s.selected=!0)}}function Bj(i,s,c){if(s!=null&&(s=""+yn(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+yn(c):""}function Uj(i,s,c,m){if(s==null){if(m!=null){if(c!=null)throw Error(a(92));if(M(m)){if(1<m.length)throw Error(a(93));m=m[0]}c=m}c==null&&(c=""),s=c}c=yn(s),i.defaultValue=c,m=i.textContent,m===c&&m!==""&&m!==null&&(i.value=m),Ap(i)}function xl(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var qM=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Fj(i,s,c){var m=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?m?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":m?i.setProperty(s,c):typeof c!="number"||c===0||qM.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function Gj(i,s,c){if(s!=null&&typeof s!="object")throw Error(a(62));if(i=i.style,c!=null){for(var m in c)!c.hasOwnProperty(m)||s!=null&&s.hasOwnProperty(m)||(m.indexOf("--")===0?i.setProperty(m,""):m==="float"?i.cssFloat="":i[m]="");for(var y in s)m=s[y],s.hasOwnProperty(y)&&c[y]!==m&&Fj(i,y,m)}else for(var N in s)s.hasOwnProperty(N)&&Fj(i,N,s[N])}function Op(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var RM=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),IM=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ku(i){return IM.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function za(){}var Dp=null;function Pp(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var bl=null,yl=null;function Hj(i){var s=pl(i);if(s&&(i=s.stateNode)){var c=i[Hr]||null;e:switch(i=s.stateNode,s.type){case"input":if(zp(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+jn(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var m=c[s];if(m!==i&&m.form===i.form){var y=m[Hr]||null;if(!y)throw Error(a(90));zp(m,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(s=0;s<c.length;s++)m=c[s],m.form===i.form&&Lj(m)}break e;case"textarea":Bj(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&gl(i,!!c.multiple,s,!1)}}}var Mp=!1;function Vj(i,s,c){if(Mp)return i(s,c);Mp=!0;try{var m=i(s);return m}finally{if(Mp=!1,(bl!==null||yl!==null)&&(gd(),bl&&(s=bl,i=yl,yl=bl=null,Hj(s),i)))for(s=0;s<i.length;s++)Hj(i[s])}}function Oo(i,s){var c=i.stateNode;if(c===null)return null;var m=c[Hr]||null;if(m===null)return null;c=m[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(i=i.type,m=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!m;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(a(231,s,typeof c));return c}var ka=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tp=!1;if(ka)try{var Do={};Object.defineProperty(Do,"passive",{get:function(){Tp=!0}}),window.addEventListener("test",Do,Do),window.removeEventListener("test",Do,Do)}catch{Tp=!1}var bi=null,qp=null,Ou=null;function Qj(){if(Ou)return Ou;var i,s=qp,c=s.length,m,y="value"in bi?bi.value:bi.textContent,N=y.length;for(i=0;i<c&&s[i]===y[i];i++);var z=c-i;for(m=1;m<=z&&s[c-m]===y[N-m];m++);return Ou=y.slice(i,1<m?1-m:void 0)}function Du(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Pu(){return!0}function Yj(){return!1}function Vr(i){function s(c,m,y,N,z){this._reactName=c,this._targetInst=y,this.type=m,this.nativeEvent=N,this.target=z,this.currentTarget=null;for(var q in i)i.hasOwnProperty(q)&&(c=i[q],this[q]=c?c(N):N[q]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?Pu:Yj,this.isPropagationStopped=Yj,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Pu)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Pu)},persist:function(){},isPersistent:Pu}),s}var ms={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mu=Vr(ms),Po=v({},ms,{view:0,detail:0}),LM=Vr(Po),Rp,Ip,Mo,Tu=v({},Po,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$p,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Mo&&(Mo&&i.type==="mousemove"?(Rp=i.screenX-Mo.screenX,Ip=i.screenY-Mo.screenY):Ip=Rp=0,Mo=i),Rp)},movementY:function(i){return"movementY"in i?i.movementY:Ip}}),Kj=Vr(Tu),$M=v({},Tu,{dataTransfer:0}),BM=Vr($M),UM=v({},Po,{relatedTarget:0}),Lp=Vr(UM),FM=v({},ms,{animationName:0,elapsedTime:0,pseudoElement:0}),GM=Vr(FM),HM=v({},ms,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),VM=Vr(HM),QM=v({},ms,{data:0}),Wj=Vr(QM),YM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},KM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function XM(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=WM[i])?!!s[i]:!1}function $p(){return XM}var ZM=v({},Po,{key:function(i){if(i.key){var s=YM[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Du(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?KM[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$p,charCode:function(i){return i.type==="keypress"?Du(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Du(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),JM=Vr(ZM),eT=v({},Tu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xj=Vr(eT),tT=v({},Po,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$p}),rT=Vr(tT),nT=v({},ms,{propertyName:0,elapsedTime:0,pseudoElement:0}),aT=Vr(nT),iT=v({},Tu,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),sT=Vr(iT),lT=v({},ms,{newState:0,oldState:0}),oT=Vr(lT),cT=[9,13,27,32],Bp=ka&&"CompositionEvent"in window,To=null;ka&&"documentMode"in document&&(To=document.documentMode);var uT=ka&&"TextEvent"in window&&!To,Zj=ka&&(!Bp||To&&8<To&&11>=To),Jj=" ",e0=!1;function t0(i,s){switch(i){case"keyup":return cT.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function r0(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var jl=!1;function dT(i,s){switch(i){case"compositionend":return r0(s);case"keypress":return s.which!==32?null:(e0=!0,Jj);case"textInput":return i=s.data,i===Jj&&e0?null:i;default:return null}}function mT(i,s){if(jl)return i==="compositionend"||!Bp&&t0(i,s)?(i=Qj(),Ou=qp=bi=null,jl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Zj&&s.locale!=="ko"?null:s.data;default:return null}}var fT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function n0(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!fT[i.type]:s==="textarea"}function a0(i,s,c,m){bl?yl?yl.push(m):yl=[m]:bl=m,s=Sd(s,"onChange"),0<s.length&&(c=new Mu("onChange","change",null,c,m),i.push({event:c,listeners:s}))}var qo=null,Ro=null;function pT(i){$N(i,0)}function qu(i){var s=ko(i);if(Lj(s))return i}function i0(i,s){if(i==="change")return s}var s0=!1;if(ka){var Up;if(ka){var Fp="oninput"in document;if(!Fp){var l0=document.createElement("div");l0.setAttribute("oninput","return;"),Fp=typeof l0.oninput=="function"}Up=Fp}else Up=!1;s0=Up&&(!document.documentMode||9<document.documentMode)}function o0(){qo&&(qo.detachEvent("onpropertychange",c0),Ro=qo=null)}function c0(i){if(i.propertyName==="value"&&qu(Ro)){var s=[];a0(s,Ro,i,Pp(i)),Vj(pT,s)}}function hT(i,s,c){i==="focusin"?(o0(),qo=s,Ro=c,qo.attachEvent("onpropertychange",c0)):i==="focusout"&&o0()}function vT(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return qu(Ro)}function gT(i,s){if(i==="click")return qu(s)}function xT(i,s){if(i==="input"||i==="change")return qu(s)}function bT(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var an=typeof Object.is=="function"?Object.is:bT;function Io(i,s){if(an(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),m=Object.keys(s);if(c.length!==m.length)return!1;for(m=0;m<c.length;m++){var y=c[m];if(!Mr.call(s,y)||!an(i[y],s[y]))return!1}return!0}function u0(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function d0(i,s){var c=u0(i);i=0;for(var m;c;){if(c.nodeType===3){if(m=i+c.textContent.length,i<=s&&m>=s)return{node:c,offset:s-i};i=m}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=u0(c)}}function m0(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?m0(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function f0(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=zu(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=zu(i.document)}return s}function Gp(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var yT=ka&&"documentMode"in document&&11>=document.documentMode,_l=null,Hp=null,Lo=null,Vp=!1;function p0(i,s,c){var m=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Vp||_l==null||_l!==zu(m)||(m=_l,"selectionStart"in m&&Gp(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Lo&&Io(Lo,m)||(Lo=m,m=Sd(Hp,"onSelect"),0<m.length&&(s=new Mu("onSelect","select",null,s,c),i.push({event:s,listeners:m}),s.target=_l)))}function fs(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var Nl={animationend:fs("Animation","AnimationEnd"),animationiteration:fs("Animation","AnimationIteration"),animationstart:fs("Animation","AnimationStart"),transitionrun:fs("Transition","TransitionRun"),transitionstart:fs("Transition","TransitionStart"),transitioncancel:fs("Transition","TransitionCancel"),transitionend:fs("Transition","TransitionEnd")},Qp={},h0={};ka&&(h0=document.createElement("div").style,"AnimationEvent"in window||(delete Nl.animationend.animation,delete Nl.animationiteration.animation,delete Nl.animationstart.animation),"TransitionEvent"in window||delete Nl.transitionend.transition);function ps(i){if(Qp[i])return Qp[i];if(!Nl[i])return i;var s=Nl[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in h0)return Qp[i]=s[c];return i}var v0=ps("animationend"),g0=ps("animationiteration"),x0=ps("animationstart"),jT=ps("transitionrun"),_T=ps("transitionstart"),NT=ps("transitioncancel"),b0=ps("transitionend"),y0=new Map,Yp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Yp.push("scrollEnd");function Vn(i,s){y0.set(i,s),ds(s,[i])}var Ru=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},_n=[],Sl=0,Kp=0;function Iu(){for(var i=Sl,s=Kp=Sl=0;s<i;){var c=_n[s];_n[s++]=null;var m=_n[s];_n[s++]=null;var y=_n[s];_n[s++]=null;var N=_n[s];if(_n[s++]=null,m!==null&&y!==null){var z=m.pending;z===null?y.next=y:(y.next=z.next,z.next=y),m.pending=y}N!==0&&j0(c,y,N)}}function Lu(i,s,c,m){_n[Sl++]=i,_n[Sl++]=s,_n[Sl++]=c,_n[Sl++]=m,Kp|=m,i.lanes|=m,i=i.alternate,i!==null&&(i.lanes|=m)}function Wp(i,s,c,m){return Lu(i,s,c,m),$u(i)}function hs(i,s){return Lu(i,null,null,s),$u(i)}function j0(i,s,c){i.lanes|=c;var m=i.alternate;m!==null&&(m.lanes|=c);for(var y=!1,N=i.return;N!==null;)N.childLanes|=c,m=N.alternate,m!==null&&(m.childLanes|=c),N.tag===22&&(i=N.stateNode,i===null||i._visibility&1||(y=!0)),i=N,N=N.return;return i.tag===3?(N=i.stateNode,y&&s!==null&&(y=31-Ze(c),i=N.hiddenUpdates,m=i[y],m===null?i[y]=[s]:m.push(s),s.lane=c|536870912),N):null}function $u(i){if(50<lc)throw lc=0,iv=null,Error(a(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var wl={};function ST(i,s,c,m){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sn(i,s,c,m){return new ST(i,s,c,m)}function Xp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Oa(i,s){var c=i.alternate;return c===null?(c=sn(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function _0(i,s){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Bu(i,s,c,m,y,N){var z=0;if(m=i,typeof i=="function")Xp(i)&&(z=1);else if(typeof i=="string")z=zq(i,c,xe.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case B:return i=sn(31,c,s,y),i.elementType=B,i.lanes=N,i;case _:return vs(c.children,y,N,s);case C:z=8,y|=24;break;case w:return i=sn(12,c,s,y|2),i.elementType=w,i.lanes=N,i;case O:return i=sn(13,c,s,y),i.elementType=O,i.lanes=N,i;case k:return i=sn(19,c,s,y),i.elementType=k,i.lanes=N,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case S:z=10;break e;case E:z=9;break e;case A:z=11;break e;case P:z=14;break e;case D:z=16,m=null;break e}z=29,c=Error(a(130,i===null?"null":typeof i,"")),m=null}return s=sn(z,c,s,y),s.elementType=i,s.type=m,s.lanes=N,s}function vs(i,s,c,m){return i=sn(7,i,m,s),i.lanes=c,i}function Zp(i,s,c){return i=sn(6,i,null,s),i.lanes=c,i}function N0(i){var s=sn(18,null,null,0);return s.stateNode=i,s}function Jp(i,s,c){return s=sn(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var S0=new WeakMap;function Nn(i,s){if(typeof i=="object"&&i!==null){var c=S0.get(i);return c!==void 0?c:(s={value:i,source:s,stack:jr(s)},S0.set(i,s),s)}return{value:i,source:s,stack:jr(s)}}var Cl=[],El=0,Uu=null,$o=0,Sn=[],wn=0,yi=null,sa=1,la="";function Da(i,s){Cl[El++]=$o,Cl[El++]=Uu,Uu=i,$o=s}function w0(i,s,c){Sn[wn++]=sa,Sn[wn++]=la,Sn[wn++]=yi,yi=i;var m=sa;i=la;var y=32-Ze(m)-1;m&=~(1<<y),c+=1;var N=32-Ze(s)+y;if(30<N){var z=y-y%5;N=(m&(1<<z)-1).toString(32),m>>=z,y-=z,sa=1<<32-Ze(s)+y|c<<y|m,la=N+i}else sa=1<<N|c<<y|m,la=i}function eh(i){i.return!==null&&(Da(i,1),w0(i,1,0))}function th(i){for(;i===Uu;)Uu=Cl[--El],Cl[El]=null,$o=Cl[--El],Cl[El]=null;for(;i===yi;)yi=Sn[--wn],Sn[wn]=null,la=Sn[--wn],Sn[wn]=null,sa=Sn[--wn],Sn[wn]=null}function C0(i,s){Sn[wn++]=sa,Sn[wn++]=la,Sn[wn++]=yi,sa=s.id,la=s.overflow,yi=i}var Nr=null,zt=null,st=!1,ji=null,Cn=!1,rh=Error(a(519));function _i(i){var s=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Bo(Nn(s,i)),rh}function E0(i){var s=i.stateNode,c=i.type,m=i.memoizedProps;switch(s[_r]=i,s[Hr]=m,c){case"dialog":rt("cancel",s),rt("close",s);break;case"iframe":case"object":case"embed":rt("load",s);break;case"video":case"audio":for(c=0;c<cc.length;c++)rt(cc[c],s);break;case"source":rt("error",s);break;case"img":case"image":case"link":rt("error",s),rt("load",s);break;case"details":rt("toggle",s);break;case"input":rt("invalid",s),$j(s,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":rt("invalid",s);break;case"textarea":rt("invalid",s),Uj(s,m.value,m.defaultValue,m.children)}c=m.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||m.suppressHydrationWarning===!0||GN(s.textContent,c)?(m.popover!=null&&(rt("beforetoggle",s),rt("toggle",s)),m.onScroll!=null&&rt("scroll",s),m.onScrollEnd!=null&&rt("scrollend",s),m.onClick!=null&&(s.onclick=za),s=!0):s=!1,s||_i(i,!0)}function A0(i){for(Nr=i.return;Nr;)switch(Nr.tag){case 5:case 31:case 13:Cn=!1;return;case 27:case 3:Cn=!0;return;default:Nr=Nr.return}}function Al(i){if(i!==Nr)return!1;if(!st)return A0(i),st=!0,!1;var s=i.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||yv(i.type,i.memoizedProps)),c=!c),c&&zt&&_i(i),A0(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));zt=JN(i)}else if(s===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));zt=JN(i)}else s===27?(s=zt,qi(i.type)?(i=wv,wv=null,zt=i):zt=s):zt=Nr?An(i.stateNode.nextSibling):null;return!0}function gs(){zt=Nr=null,st=!1}function nh(){var i=ji;return i!==null&&(Wr===null?Wr=i:Wr.push.apply(Wr,i),ji=null),i}function Bo(i){ji===null?ji=[i]:ji.push(i)}var ah=ne(null),xs=null,Pa=null;function Ni(i,s,c){oe(ah,s._currentValue),s._currentValue=c}function Ma(i){i._currentValue=ah.current,K(ah)}function ih(i,s,c){for(;i!==null;){var m=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,m!==null&&(m.childLanes|=s)):m!==null&&(m.childLanes&s)!==s&&(m.childLanes|=s),i===c)break;i=i.return}}function sh(i,s,c,m){var y=i.child;for(y!==null&&(y.return=i);y!==null;){var N=y.dependencies;if(N!==null){var z=y.child;N=N.firstContext;e:for(;N!==null;){var q=N;N=y;for(var G=0;G<s.length;G++)if(q.context===s[G]){N.lanes|=c,q=N.alternate,q!==null&&(q.lanes|=c),ih(N.return,c,i),m||(z=null);break e}N=q.next}}else if(y.tag===18){if(z=y.return,z===null)throw Error(a(341));z.lanes|=c,N=z.alternate,N!==null&&(N.lanes|=c),ih(z,c,i),z=null}else z=y.child;if(z!==null)z.return=y;else for(z=y;z!==null;){if(z===i){z=null;break}if(y=z.sibling,y!==null){y.return=z.return,z=y;break}z=z.return}y=z}}function zl(i,s,c,m){i=null;for(var y=s,N=!1;y!==null;){if(!N){if((y.flags&524288)!==0)N=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var z=y.alternate;if(z===null)throw Error(a(387));if(z=z.memoizedProps,z!==null){var q=y.type;an(y.pendingProps.value,z.value)||(i!==null?i.push(q):i=[q])}}else if(y===he.current){if(z=y.alternate,z===null)throw Error(a(387));z.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(i!==null?i.push(pc):i=[pc])}y=y.return}i!==null&&sh(s,i,c,m),s.flags|=262144}function Fu(i){for(i=i.firstContext;i!==null;){if(!an(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function bs(i){xs=i,Pa=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Sr(i){return z0(xs,i)}function Gu(i,s){return xs===null&&bs(i),z0(i,s)}function z0(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Pa===null){if(i===null)throw Error(a(308));Pa=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Pa=Pa.next=s;return c}var wT=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,m){i.push(m)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},CT=e.unstable_scheduleCallback,ET=e.unstable_NormalPriority,Kt={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function lh(){return{controller:new wT,data:new Map,refCount:0}}function Uo(i){i.refCount--,i.refCount===0&&CT(ET,function(){i.controller.abort()})}var Fo=null,oh=0,kl=0,Ol=null;function AT(i,s){if(Fo===null){var c=Fo=[];oh=0,kl=dv(),Ol={status:"pending",value:void 0,then:function(m){c.push(m)}}}return oh++,s.then(k0,k0),s}function k0(){if(--oh===0&&Fo!==null){Ol!==null&&(Ol.status="fulfilled");var i=Fo;Fo=null,kl=0,Ol=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function zT(i,s){var c=[],m={status:"pending",value:null,reason:null,then:function(y){c.push(y)}};return i.then(function(){m.status="fulfilled",m.value=s;for(var y=0;y<c.length;y++)(0,c[y])(s)},function(y){for(m.status="rejected",m.reason=y,y=0;y<c.length;y++)(0,c[y])(void 0)}),m}var O0=T.S;T.S=function(i,s){pN=Re(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&AT(i,s),O0!==null&&O0(i,s)};var ys=ne(null);function ch(){var i=ys.current;return i!==null?i:wt.pooledCache}function Hu(i,s){s===null?oe(ys,ys.current):oe(ys,s.pool)}function D0(){var i=ch();return i===null?null:{parent:Kt._currentValue,pool:i}}var Dl=Error(a(460)),uh=Error(a(474)),Vu=Error(a(542)),Qu={then:function(){}};function P0(i){return i=i.status,i==="fulfilled"||i==="rejected"}function M0(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(za,za),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,q0(i),i;default:if(typeof s.status=="string")s.then(za,za);else{if(i=wt,i!==null&&100<i.shellSuspendCounter)throw Error(a(482));i=s,i.status="pending",i.then(function(m){if(s.status==="pending"){var y=s;y.status="fulfilled",y.value=m}},function(m){if(s.status==="pending"){var y=s;y.status="rejected",y.reason=m}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,q0(i),i}throw _s=s,Dl}}function js(i){try{var s=i._init;return s(i._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(_s=c,Dl):c}}var _s=null;function T0(){if(_s===null)throw Error(a(459));var i=_s;return _s=null,i}function q0(i){if(i===Dl||i===Vu)throw Error(a(483))}var Pl=null,Go=0;function Yu(i){var s=Go;return Go+=1,Pl===null&&(Pl=[]),M0(Pl,i,s)}function Ho(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Ku(i,s){throw s.$$typeof===b?Error(a(525)):(i=Object.prototype.toString.call(s),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function R0(i){function s(re,W){if(i){var ie=re.deletions;ie===null?(re.deletions=[W],re.flags|=16):ie.push(W)}}function c(re,W){if(!i)return null;for(;W!==null;)s(re,W),W=W.sibling;return null}function m(re){for(var W=new Map;re!==null;)re.key!==null?W.set(re.key,re):W.set(re.index,re),re=re.sibling;return W}function y(re,W){return re=Oa(re,W),re.index=0,re.sibling=null,re}function N(re,W,ie){return re.index=ie,i?(ie=re.alternate,ie!==null?(ie=ie.index,ie<W?(re.flags|=67108866,W):ie):(re.flags|=67108866,W)):(re.flags|=1048576,W)}function z(re){return i&&re.alternate===null&&(re.flags|=67108866),re}function q(re,W,ie,be){return W===null||W.tag!==6?(W=Zp(ie,re.mode,be),W.return=re,W):(W=y(W,ie),W.return=re,W)}function G(re,W,ie,be){var Be=ie.type;return Be===_?ge(re,W,ie.props.children,be,ie.key):W!==null&&(W.elementType===Be||typeof Be=="object"&&Be!==null&&Be.$$typeof===D&&js(Be)===W.type)?(W=y(W,ie.props),Ho(W,ie),W.return=re,W):(W=Bu(ie.type,ie.key,ie.props,null,re.mode,be),Ho(W,ie),W.return=re,W)}function se(re,W,ie,be){return W===null||W.tag!==4||W.stateNode.containerInfo!==ie.containerInfo||W.stateNode.implementation!==ie.implementation?(W=Jp(ie,re.mode,be),W.return=re,W):(W=y(W,ie.children||[]),W.return=re,W)}function ge(re,W,ie,be,Be){return W===null||W.tag!==7?(W=vs(ie,re.mode,be,Be),W.return=re,W):(W=y(W,ie),W.return=re,W)}function ye(re,W,ie){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Zp(""+W,re.mode,ie),W.return=re,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case x:return ie=Bu(W.type,W.key,W.props,null,re.mode,ie),Ho(ie,W),ie.return=re,ie;case j:return W=Jp(W,re.mode,ie),W.return=re,W;case D:return W=js(W),ye(re,W,ie)}if(M(W)||R(W))return W=vs(W,re.mode,ie,null),W.return=re,W;if(typeof W.then=="function")return ye(re,Yu(W),ie);if(W.$$typeof===S)return ye(re,Gu(re,W),ie);Ku(re,W)}return null}function le(re,W,ie,be){var Be=W!==null?W.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Be!==null?null:q(re,W,""+ie,be);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case x:return ie.key===Be?G(re,W,ie,be):null;case j:return ie.key===Be?se(re,W,ie,be):null;case D:return ie=js(ie),le(re,W,ie,be)}if(M(ie)||R(ie))return Be!==null?null:ge(re,W,ie,be,null);if(typeof ie.then=="function")return le(re,W,Yu(ie),be);if(ie.$$typeof===S)return le(re,W,Gu(re,ie),be);Ku(re,ie)}return null}function fe(re,W,ie,be,Be){if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return re=re.get(ie)||null,q(W,re,""+be,Be);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case x:return re=re.get(be.key===null?ie:be.key)||null,G(W,re,be,Be);case j:return re=re.get(be.key===null?ie:be.key)||null,se(W,re,be,Be);case D:return be=js(be),fe(re,W,ie,be,Be)}if(M(be)||R(be))return re=re.get(ie)||null,ge(W,re,be,Be,null);if(typeof be.then=="function")return fe(re,W,ie,Yu(be),Be);if(be.$$typeof===S)return fe(re,W,ie,Gu(W,be),Be);Ku(W,be)}return null}function Oe(re,W,ie,be){for(var Be=null,ut=null,Te=W,We=W=0,at=null;Te!==null&&We<ie.length;We++){Te.index>We?(at=Te,Te=null):at=Te.sibling;var dt=le(re,Te,ie[We],be);if(dt===null){Te===null&&(Te=at);break}i&&Te&&dt.alternate===null&&s(re,Te),W=N(dt,W,We),ut===null?Be=dt:ut.sibling=dt,ut=dt,Te=at}if(We===ie.length)return c(re,Te),st&&Da(re,We),Be;if(Te===null){for(;We<ie.length;We++)Te=ye(re,ie[We],be),Te!==null&&(W=N(Te,W,We),ut===null?Be=Te:ut.sibling=Te,ut=Te);return st&&Da(re,We),Be}for(Te=m(Te);We<ie.length;We++)at=fe(Te,re,We,ie[We],be),at!==null&&(i&&at.alternate!==null&&Te.delete(at.key===null?We:at.key),W=N(at,W,We),ut===null?Be=at:ut.sibling=at,ut=at);return i&&Te.forEach(function(Bi){return s(re,Bi)}),st&&Da(re,We),Be}function Ge(re,W,ie,be){if(ie==null)throw Error(a(151));for(var Be=null,ut=null,Te=W,We=W=0,at=null,dt=ie.next();Te!==null&&!dt.done;We++,dt=ie.next()){Te.index>We?(at=Te,Te=null):at=Te.sibling;var Bi=le(re,Te,dt.value,be);if(Bi===null){Te===null&&(Te=at);break}i&&Te&&Bi.alternate===null&&s(re,Te),W=N(Bi,W,We),ut===null?Be=Bi:ut.sibling=Bi,ut=Bi,Te=at}if(dt.done)return c(re,Te),st&&Da(re,We),Be;if(Te===null){for(;!dt.done;We++,dt=ie.next())dt=ye(re,dt.value,be),dt!==null&&(W=N(dt,W,We),ut===null?Be=dt:ut.sibling=dt,ut=dt);return st&&Da(re,We),Be}for(Te=m(Te);!dt.done;We++,dt=ie.next())dt=fe(Te,re,We,dt.value,be),dt!==null&&(i&&dt.alternate!==null&&Te.delete(dt.key===null?We:dt.key),W=N(dt,W,We),ut===null?Be=dt:ut.sibling=dt,ut=dt);return i&&Te.forEach(function($q){return s(re,$q)}),st&&Da(re,We),Be}function _t(re,W,ie,be){if(typeof ie=="object"&&ie!==null&&ie.type===_&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case x:e:{for(var Be=ie.key;W!==null;){if(W.key===Be){if(Be=ie.type,Be===_){if(W.tag===7){c(re,W.sibling),be=y(W,ie.props.children),be.return=re,re=be;break e}}else if(W.elementType===Be||typeof Be=="object"&&Be!==null&&Be.$$typeof===D&&js(Be)===W.type){c(re,W.sibling),be=y(W,ie.props),Ho(be,ie),be.return=re,re=be;break e}c(re,W);break}else s(re,W);W=W.sibling}ie.type===_?(be=vs(ie.props.children,re.mode,be,ie.key),be.return=re,re=be):(be=Bu(ie.type,ie.key,ie.props,null,re.mode,be),Ho(be,ie),be.return=re,re=be)}return z(re);case j:e:{for(Be=ie.key;W!==null;){if(W.key===Be)if(W.tag===4&&W.stateNode.containerInfo===ie.containerInfo&&W.stateNode.implementation===ie.implementation){c(re,W.sibling),be=y(W,ie.children||[]),be.return=re,re=be;break e}else{c(re,W);break}else s(re,W);W=W.sibling}be=Jp(ie,re.mode,be),be.return=re,re=be}return z(re);case D:return ie=js(ie),_t(re,W,ie,be)}if(M(ie))return Oe(re,W,ie,be);if(R(ie)){if(Be=R(ie),typeof Be!="function")throw Error(a(150));return ie=Be.call(ie),Ge(re,W,ie,be)}if(typeof ie.then=="function")return _t(re,W,Yu(ie),be);if(ie.$$typeof===S)return _t(re,W,Gu(re,ie),be);Ku(re,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,W!==null&&W.tag===6?(c(re,W.sibling),be=y(W,ie),be.return=re,re=be):(c(re,W),be=Zp(ie,re.mode,be),be.return=re,re=be),z(re)):c(re,W)}return function(re,W,ie,be){try{Go=0;var Be=_t(re,W,ie,be);return Pl=null,Be}catch(Te){if(Te===Dl||Te===Vu)throw Te;var ut=sn(29,Te,null,re.mode);return ut.lanes=be,ut.return=re,ut}}}var Ns=R0(!0),I0=R0(!1),Si=!1;function dh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function mh(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function wi(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Ci(i,s,c){var m=i.updateQueue;if(m===null)return null;if(m=m.shared,(ft&2)!==0){var y=m.pending;return y===null?s.next=s:(s.next=y.next,y.next=s),m.pending=s,s=$u(i),j0(i,null,c),s}return Lu(i,m,s,c),$u(i)}function Vo(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var m=s.lanes;m&=i.pendingLanes,c|=m,s.lanes=c,us(i,c)}}function fh(i,s){var c=i.updateQueue,m=i.alternate;if(m!==null&&(m=m.updateQueue,c===m)){var y=null,N=null;if(c=c.firstBaseUpdate,c!==null){do{var z={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};N===null?y=N=z:N=N.next=z,c=c.next}while(c!==null);N===null?y=N=s:N=N.next=s}else y=N=s;c={baseState:m.baseState,firstBaseUpdate:y,lastBaseUpdate:N,shared:m.shared,callbacks:m.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var ph=!1;function Qo(){if(ph){var i=Ol;if(i!==null)throw i}}function Yo(i,s,c,m){ph=!1;var y=i.updateQueue;Si=!1;var N=y.firstBaseUpdate,z=y.lastBaseUpdate,q=y.shared.pending;if(q!==null){y.shared.pending=null;var G=q,se=G.next;G.next=null,z===null?N=se:z.next=se,z=G;var ge=i.alternate;ge!==null&&(ge=ge.updateQueue,q=ge.lastBaseUpdate,q!==z&&(q===null?ge.firstBaseUpdate=se:q.next=se,ge.lastBaseUpdate=G))}if(N!==null){var ye=y.baseState;z=0,ge=se=G=null,q=N;do{var le=q.lane&-536870913,fe=le!==q.lane;if(fe?(nt&le)===le:(m&le)===le){le!==0&&le===kl&&(ph=!0),ge!==null&&(ge=ge.next={lane:0,tag:q.tag,payload:q.payload,callback:null,next:null});e:{var Oe=i,Ge=q;le=s;var _t=c;switch(Ge.tag){case 1:if(Oe=Ge.payload,typeof Oe=="function"){ye=Oe.call(_t,ye,le);break e}ye=Oe;break e;case 3:Oe.flags=Oe.flags&-65537|128;case 0:if(Oe=Ge.payload,le=typeof Oe=="function"?Oe.call(_t,ye,le):Oe,le==null)break e;ye=v({},ye,le);break e;case 2:Si=!0}}le=q.callback,le!==null&&(i.flags|=64,fe&&(i.flags|=8192),fe=y.callbacks,fe===null?y.callbacks=[le]:fe.push(le))}else fe={lane:le,tag:q.tag,payload:q.payload,callback:q.callback,next:null},ge===null?(se=ge=fe,G=ye):ge=ge.next=fe,z|=le;if(q=q.next,q===null){if(q=y.shared.pending,q===null)break;fe=q,q=fe.next,fe.next=null,y.lastBaseUpdate=fe,y.shared.pending=null}}while(!0);ge===null&&(G=ye),y.baseState=G,y.firstBaseUpdate=se,y.lastBaseUpdate=ge,N===null&&(y.shared.lanes=0),Oi|=z,i.lanes=z,i.memoizedState=ye}}function L0(i,s){if(typeof i!="function")throw Error(a(191,i));i.call(s)}function $0(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)L0(c[i],s)}var Ml=ne(null),Wu=ne(0);function B0(i,s){i=Fa,oe(Wu,i),oe(Ml,s),Fa=i|s.baseLanes}function hh(){oe(Wu,Fa),oe(Ml,Ml.current)}function vh(){Fa=Wu.current,K(Ml),K(Wu)}var ln=ne(null),En=null;function Ei(i){var s=i.alternate;oe(Vt,Vt.current&1),oe(ln,i),En===null&&(s===null||Ml.current!==null||s.memoizedState!==null)&&(En=i)}function gh(i){oe(Vt,Vt.current),oe(ln,i),En===null&&(En=i)}function U0(i){i.tag===22?(oe(Vt,Vt.current),oe(ln,i),En===null&&(En=i)):Ai()}function Ai(){oe(Vt,Vt.current),oe(ln,ln.current)}function on(i){K(ln),En===i&&(En=null),K(Vt)}var Vt=ne(0);function Xu(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Nv(c)||Sv(c)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Ta=0,Ye=null,yt=null,Wt=null,Zu=!1,Tl=!1,Ss=!1,Ju=0,Ko=0,ql=null,kT=0;function Lt(){throw Error(a(321))}function xh(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!an(i[c],s[c]))return!1;return!0}function bh(i,s,c,m,y,N){return Ta=N,Ye=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,T.H=i===null||i.memoizedState===null?w_:Mh,Ss=!1,N=c(m,y),Ss=!1,Tl&&(N=G0(s,c,m,y)),F0(i),N}function F0(i){T.H=Zo;var s=yt!==null&&yt.next!==null;if(Ta=0,Wt=yt=Ye=null,Zu=!1,Ko=0,ql=null,s)throw Error(a(300));i===null||Xt||(i=i.dependencies,i!==null&&Fu(i)&&(Xt=!0))}function G0(i,s,c,m){Ye=i;var y=0;do{if(Tl&&(ql=null),Ko=0,Tl=!1,25<=y)throw Error(a(301));if(y+=1,Wt=yt=null,i.updateQueue!=null){var N=i.updateQueue;N.lastEffect=null,N.events=null,N.stores=null,N.memoCache!=null&&(N.memoCache.index=0)}T.H=C_,N=s(c,m)}while(Tl);return N}function OT(){var i=T.H,s=i.useState()[0];return s=typeof s.then=="function"?Wo(s):s,i=i.useState()[0],(yt!==null?yt.memoizedState:null)!==i&&(Ye.flags|=1024),s}function yh(){var i=Ju!==0;return Ju=0,i}function jh(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function _h(i){if(Zu){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Zu=!1}Ta=0,Wt=yt=Ye=null,Tl=!1,Ko=Ju=0,ql=null}function Tr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wt===null?Ye.memoizedState=Wt=i:Wt=Wt.next=i,Wt}function Qt(){if(yt===null){var i=Ye.alternate;i=i!==null?i.memoizedState:null}else i=yt.next;var s=Wt===null?Ye.memoizedState:Wt.next;if(s!==null)Wt=s,yt=i;else{if(i===null)throw Ye.alternate===null?Error(a(467)):Error(a(310));yt=i,i={memoizedState:yt.memoizedState,baseState:yt.baseState,baseQueue:yt.baseQueue,queue:yt.queue,next:null},Wt===null?Ye.memoizedState=Wt=i:Wt=Wt.next=i}return Wt}function ed(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Wo(i){var s=Ko;return Ko+=1,ql===null&&(ql=[]),i=M0(ql,i,s),s=Ye,(Wt===null?s.memoizedState:Wt.next)===null&&(s=s.alternate,T.H=s===null||s.memoizedState===null?w_:Mh),i}function td(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Wo(i);if(i.$$typeof===S)return Sr(i)}throw Error(a(438,String(i)))}function Nh(i){var s=null,c=Ye.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var m=Ye.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(s={data:m.data.map(function(y){return y.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=ed(),Ye.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),m=0;m<i;m++)c[m]=U;return s.index++,c}function qa(i,s){return typeof s=="function"?s(i):s}function rd(i){var s=Qt();return Sh(s,yt,i)}function Sh(i,s,c){var m=i.queue;if(m===null)throw Error(a(311));m.lastRenderedReducer=c;var y=i.baseQueue,N=m.pending;if(N!==null){if(y!==null){var z=y.next;y.next=N.next,N.next=z}s.baseQueue=y=N,m.pending=null}if(N=i.baseState,y===null)i.memoizedState=N;else{s=y.next;var q=z=null,G=null,se=s,ge=!1;do{var ye=se.lane&-536870913;if(ye!==se.lane?(nt&ye)===ye:(Ta&ye)===ye){var le=se.revertLane;if(le===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),ye===kl&&(ge=!0);else if((Ta&le)===le){se=se.next,le===kl&&(ge=!0);continue}else ye={lane:0,revertLane:se.revertLane,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},G===null?(q=G=ye,z=N):G=G.next=ye,Ye.lanes|=le,Oi|=le;ye=se.action,Ss&&c(N,ye),N=se.hasEagerState?se.eagerState:c(N,ye)}else le={lane:ye,revertLane:se.revertLane,gesture:se.gesture,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},G===null?(q=G=le,z=N):G=G.next=le,Ye.lanes|=ye,Oi|=ye;se=se.next}while(se!==null&&se!==s);if(G===null?z=N:G.next=q,!an(N,i.memoizedState)&&(Xt=!0,ge&&(c=Ol,c!==null)))throw c;i.memoizedState=N,i.baseState=z,i.baseQueue=G,m.lastRenderedState=N}return y===null&&(m.lanes=0),[i.memoizedState,m.dispatch]}function wh(i){var s=Qt(),c=s.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=i;var m=c.dispatch,y=c.pending,N=s.memoizedState;if(y!==null){c.pending=null;var z=y=y.next;do N=i(N,z.action),z=z.next;while(z!==y);an(N,s.memoizedState)||(Xt=!0),s.memoizedState=N,s.baseQueue===null&&(s.baseState=N),c.lastRenderedState=N}return[N,m]}function H0(i,s,c){var m=Ye,y=Qt(),N=st;if(N){if(c===void 0)throw Error(a(407));c=c()}else c=s();var z=!an((yt||y).memoizedState,c);if(z&&(y.memoizedState=c,Xt=!0),y=y.queue,Ah(Y0.bind(null,m,y,i),[i]),y.getSnapshot!==s||z||Wt!==null&&Wt.memoizedState.tag&1){if(m.flags|=2048,Rl(9,{destroy:void 0},Q0.bind(null,m,y,c,s),null),wt===null)throw Error(a(349));N||(Ta&127)!==0||V0(m,s,c)}return c}function V0(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=Ye.updateQueue,s===null?(s=ed(),Ye.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function Q0(i,s,c,m){s.value=c,s.getSnapshot=m,K0(s)&&W0(i)}function Y0(i,s,c){return c(function(){K0(s)&&W0(i)})}function K0(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!an(i,c)}catch{return!0}}function W0(i){var s=hs(i,2);s!==null&&Xr(s,i,2)}function Ch(i){var s=Tr();if(typeof i=="function"){var c=i;if(i=c(),Ss){Se(!0);try{c()}finally{Se(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:i},s}function X0(i,s,c,m){return i.baseState=c,Sh(i,yt,typeof m=="function"?m:qa)}function DT(i,s,c,m,y){if(id(i))throw Error(a(485));if(i=s.action,i!==null){var N={payload:y,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(z){N.listeners.push(z)}};T.T!==null?c(!0):N.isTransition=!1,m(N),c=s.pending,c===null?(N.next=s.pending=N,Z0(s,N)):(N.next=c.next,s.pending=c.next=N)}}function Z0(i,s){var c=s.action,m=s.payload,y=i.state;if(s.isTransition){var N=T.T,z={};T.T=z;try{var q=c(y,m),G=T.S;G!==null&&G(z,q),J0(i,s,q)}catch(se){Eh(i,s,se)}finally{N!==null&&z.types!==null&&(N.types=z.types),T.T=N}}else try{N=c(y,m),J0(i,s,N)}catch(se){Eh(i,s,se)}}function J0(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(m){e_(i,s,m)},function(m){return Eh(i,s,m)}):e_(i,s,c)}function e_(i,s,c){s.status="fulfilled",s.value=c,t_(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,Z0(i,c)))}function Eh(i,s,c){var m=i.pending;if(i.pending=null,m!==null){m=m.next;do s.status="rejected",s.reason=c,t_(s),s=s.next;while(s!==m)}i.action=null}function t_(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function r_(i,s){return s}function n_(i,s){if(st){var c=wt.formState;if(c!==null){e:{var m=Ye;if(st){if(zt){t:{for(var y=zt,N=Cn;y.nodeType!==8;){if(!N){y=null;break t}if(y=An(y.nextSibling),y===null){y=null;break t}}N=y.data,y=N==="F!"||N==="F"?y:null}if(y){zt=An(y.nextSibling),m=y.data==="F!";break e}}_i(m)}m=!1}m&&(s=c[0])}}return c=Tr(),c.memoizedState=c.baseState=s,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r_,lastRenderedState:s},c.queue=m,c=__.bind(null,Ye,m),m.dispatch=c,m=Ch(!1),N=Ph.bind(null,Ye,!1,m.queue),m=Tr(),y={state:s,dispatch:null,action:i,pending:null},m.queue=y,c=DT.bind(null,Ye,y,N,c),y.dispatch=c,m.memoizedState=i,[s,c,!1]}function a_(i){var s=Qt();return i_(s,yt,i)}function i_(i,s,c){if(s=Sh(i,s,r_)[0],i=rd(qa)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var m=Wo(s)}catch(z){throw z===Dl?Vu:z}else m=s;s=Qt();var y=s.queue,N=y.dispatch;return c!==s.memoizedState&&(Ye.flags|=2048,Rl(9,{destroy:void 0},PT.bind(null,y,c),null)),[m,N,i]}function PT(i,s){i.action=s}function s_(i){var s=Qt(),c=yt;if(c!==null)return i_(s,c,i);Qt(),s=s.memoizedState,c=Qt();var m=c.queue.dispatch;return c.memoizedState=i,[s,m,!1]}function Rl(i,s,c,m){return i={tag:i,create:c,deps:m,inst:s,next:null},s=Ye.updateQueue,s===null&&(s=ed(),Ye.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(m=c.next,c.next=i,i.next=m,s.lastEffect=i),i}function l_(){return Qt().memoizedState}function nd(i,s,c,m){var y=Tr();Ye.flags|=i,y.memoizedState=Rl(1|s,{destroy:void 0},c,m===void 0?null:m)}function ad(i,s,c,m){var y=Qt();m=m===void 0?null:m;var N=y.memoizedState.inst;yt!==null&&m!==null&&xh(m,yt.memoizedState.deps)?y.memoizedState=Rl(s,N,c,m):(Ye.flags|=i,y.memoizedState=Rl(1|s,N,c,m))}function o_(i,s){nd(8390656,8,i,s)}function Ah(i,s){ad(2048,8,i,s)}function MT(i){Ye.flags|=4;var s=Ye.updateQueue;if(s===null)s=ed(),Ye.updateQueue=s,s.events=[i];else{var c=s.events;c===null?s.events=[i]:c.push(i)}}function c_(i){var s=Qt().memoizedState;return MT({ref:s,nextImpl:i}),function(){if((ft&2)!==0)throw Error(a(440));return s.impl.apply(void 0,arguments)}}function u_(i,s){return ad(4,2,i,s)}function d_(i,s){return ad(4,4,i,s)}function m_(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function f_(i,s,c){c=c!=null?c.concat([i]):null,ad(4,4,m_.bind(null,s,i),c)}function zh(){}function p_(i,s){var c=Qt();s=s===void 0?null:s;var m=c.memoizedState;return s!==null&&xh(s,m[1])?m[0]:(c.memoizedState=[i,s],i)}function h_(i,s){var c=Qt();s=s===void 0?null:s;var m=c.memoizedState;if(s!==null&&xh(s,m[1]))return m[0];if(m=i(),Ss){Se(!0);try{i()}finally{Se(!1)}}return c.memoizedState=[m,s],m}function kh(i,s,c){return c===void 0||(Ta&1073741824)!==0&&(nt&261930)===0?i.memoizedState=s:(i.memoizedState=c,i=vN(),Ye.lanes|=i,Oi|=i,c)}function v_(i,s,c,m){return an(c,s)?c:Ml.current!==null?(i=kh(i,c,m),an(i,s)||(Xt=!0),i):(Ta&42)===0||(Ta&1073741824)!==0&&(nt&261930)===0?(Xt=!0,i.memoizedState=c):(i=vN(),Ye.lanes|=i,Oi|=i,s)}function g_(i,s,c,m,y){var N=F.p;F.p=N!==0&&8>N?N:8;var z=T.T,q={};T.T=q,Ph(i,!1,s,c);try{var G=y(),se=T.S;if(se!==null&&se(q,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var ge=zT(G,m);Xo(i,s,ge,dn(i))}else Xo(i,s,m,dn(i))}catch(ye){Xo(i,s,{then:function(){},status:"rejected",reason:ye},dn())}finally{F.p=N,z!==null&&q.types!==null&&(z.types=q.types),T.T=z}}function TT(){}function Oh(i,s,c,m){if(i.tag!==5)throw Error(a(476));var y=x_(i).queue;g_(i,y,s,I,c===null?TT:function(){return b_(i),c(m)})}function x_(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:I,baseState:I,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:I},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qa,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function b_(i){var s=x_(i);s.next===null&&(s=i.alternate.memoizedState),Xo(i,s.next.queue,{},dn())}function Dh(){return Sr(pc)}function y_(){return Qt().memoizedState}function j_(){return Qt().memoizedState}function qT(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=dn();i=wi(c);var m=Ci(s,i,c);m!==null&&(Xr(m,s,c),Vo(m,s,c)),s={cache:lh()},i.payload=s;return}s=s.return}}function RT(i,s,c){var m=dn();c={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},id(i)?N_(s,c):(c=Wp(i,s,c,m),c!==null&&(Xr(c,i,m),S_(c,s,m)))}function __(i,s,c){var m=dn();Xo(i,s,c,m)}function Xo(i,s,c,m){var y={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(id(i))N_(s,y);else{var N=i.alternate;if(i.lanes===0&&(N===null||N.lanes===0)&&(N=s.lastRenderedReducer,N!==null))try{var z=s.lastRenderedState,q=N(z,c);if(y.hasEagerState=!0,y.eagerState=q,an(q,z))return Lu(i,s,y,0),wt===null&&Iu(),!1}catch{}if(c=Wp(i,s,y,m),c!==null)return Xr(c,i,m),S_(c,s,m),!0}return!1}function Ph(i,s,c,m){if(m={lane:2,revertLane:dv(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},id(i)){if(s)throw Error(a(479))}else s=Wp(i,c,m,2),s!==null&&Xr(s,i,2)}function id(i){var s=i.alternate;return i===Ye||s!==null&&s===Ye}function N_(i,s){Tl=Zu=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function S_(i,s,c){if((c&4194048)!==0){var m=s.lanes;m&=i.pendingLanes,c|=m,s.lanes=c,us(i,c)}}var Zo={readContext:Sr,use:td,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useLayoutEffect:Lt,useInsertionEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useSyncExternalStore:Lt,useId:Lt,useHostTransitionStatus:Lt,useFormState:Lt,useActionState:Lt,useOptimistic:Lt,useMemoCache:Lt,useCacheRefresh:Lt};Zo.useEffectEvent=Lt;var w_={readContext:Sr,use:td,useCallback:function(i,s){return Tr().memoizedState=[i,s===void 0?null:s],i},useContext:Sr,useEffect:o_,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,nd(4194308,4,m_.bind(null,s,i),c)},useLayoutEffect:function(i,s){return nd(4194308,4,i,s)},useInsertionEffect:function(i,s){nd(4,2,i,s)},useMemo:function(i,s){var c=Tr();s=s===void 0?null:s;var m=i();if(Ss){Se(!0);try{i()}finally{Se(!1)}}return c.memoizedState=[m,s],m},useReducer:function(i,s,c){var m=Tr();if(c!==void 0){var y=c(s);if(Ss){Se(!0);try{c(s)}finally{Se(!1)}}}else y=s;return m.memoizedState=m.baseState=y,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:y},m.queue=i,i=i.dispatch=RT.bind(null,Ye,i),[m.memoizedState,i]},useRef:function(i){var s=Tr();return i={current:i},s.memoizedState=i},useState:function(i){i=Ch(i);var s=i.queue,c=__.bind(null,Ye,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:zh,useDeferredValue:function(i,s){var c=Tr();return kh(c,i,s)},useTransition:function(){var i=Ch(!1);return i=g_.bind(null,Ye,i.queue,!0,!1),Tr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var m=Ye,y=Tr();if(st){if(c===void 0)throw Error(a(407));c=c()}else{if(c=s(),wt===null)throw Error(a(349));(nt&127)!==0||V0(m,s,c)}y.memoizedState=c;var N={value:c,getSnapshot:s};return y.queue=N,o_(Y0.bind(null,m,N,i),[i]),m.flags|=2048,Rl(9,{destroy:void 0},Q0.bind(null,m,N,c,s),null),c},useId:function(){var i=Tr(),s=wt.identifierPrefix;if(st){var c=la,m=sa;c=(m&~(1<<32-Ze(m)-1)).toString(32)+c,s="_"+s+"R_"+c,c=Ju++,0<c&&(s+="H"+c.toString(32)),s+="_"}else c=kT++,s="_"+s+"r_"+c.toString(32)+"_";return i.memoizedState=s},useHostTransitionStatus:Dh,useFormState:n_,useActionState:n_,useOptimistic:function(i){var s=Tr();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=Ph.bind(null,Ye,!0,c),c.dispatch=s,[i,s]},useMemoCache:Nh,useCacheRefresh:function(){return Tr().memoizedState=qT.bind(null,Ye)},useEffectEvent:function(i){var s=Tr(),c={impl:i};return s.memoizedState=c,function(){if((ft&2)!==0)throw Error(a(440));return c.impl.apply(void 0,arguments)}}},Mh={readContext:Sr,use:td,useCallback:p_,useContext:Sr,useEffect:Ah,useImperativeHandle:f_,useInsertionEffect:u_,useLayoutEffect:d_,useMemo:h_,useReducer:rd,useRef:l_,useState:function(){return rd(qa)},useDebugValue:zh,useDeferredValue:function(i,s){var c=Qt();return v_(c,yt.memoizedState,i,s)},useTransition:function(){var i=rd(qa)[0],s=Qt().memoizedState;return[typeof i=="boolean"?i:Wo(i),s]},useSyncExternalStore:H0,useId:y_,useHostTransitionStatus:Dh,useFormState:a_,useActionState:a_,useOptimistic:function(i,s){var c=Qt();return X0(c,yt,i,s)},useMemoCache:Nh,useCacheRefresh:j_};Mh.useEffectEvent=c_;var C_={readContext:Sr,use:td,useCallback:p_,useContext:Sr,useEffect:Ah,useImperativeHandle:f_,useInsertionEffect:u_,useLayoutEffect:d_,useMemo:h_,useReducer:wh,useRef:l_,useState:function(){return wh(qa)},useDebugValue:zh,useDeferredValue:function(i,s){var c=Qt();return yt===null?kh(c,i,s):v_(c,yt.memoizedState,i,s)},useTransition:function(){var i=wh(qa)[0],s=Qt().memoizedState;return[typeof i=="boolean"?i:Wo(i),s]},useSyncExternalStore:H0,useId:y_,useHostTransitionStatus:Dh,useFormState:s_,useActionState:s_,useOptimistic:function(i,s){var c=Qt();return yt!==null?X0(c,yt,i,s):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:Nh,useCacheRefresh:j_};C_.useEffectEvent=c_;function Th(i,s,c,m){s=i.memoizedState,c=c(m,s),c=c==null?s:v({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var qh={enqueueSetState:function(i,s,c){i=i._reactInternals;var m=dn(),y=wi(m);y.payload=s,c!=null&&(y.callback=c),s=Ci(i,y,m),s!==null&&(Xr(s,i,m),Vo(s,i,m))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var m=dn(),y=wi(m);y.tag=1,y.payload=s,c!=null&&(y.callback=c),s=Ci(i,y,m),s!==null&&(Xr(s,i,m),Vo(s,i,m))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=dn(),m=wi(c);m.tag=2,s!=null&&(m.callback=s),s=Ci(i,m,c),s!==null&&(Xr(s,i,c),Vo(s,i,c))}};function E_(i,s,c,m,y,N,z){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(m,N,z):s.prototype&&s.prototype.isPureReactComponent?!Io(c,m)||!Io(y,N):!0}function A_(i,s,c,m){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,m),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,m),s.state!==i&&qh.enqueueReplaceState(s,s.state,null)}function ws(i,s){var c=s;if("ref"in s){c={};for(var m in s)m!=="ref"&&(c[m]=s[m])}if(i=i.defaultProps){c===s&&(c=v({},c));for(var y in i)c[y]===void 0&&(c[y]=i[y])}return c}function z_(i){Ru(i)}function k_(i){console.error(i)}function O_(i){Ru(i)}function sd(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(m){setTimeout(function(){throw m})}}function D_(i,s,c){try{var m=i.onCaughtError;m(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Rh(i,s,c){return c=wi(c),c.tag=3,c.payload={element:null},c.callback=function(){sd(i,s)},c}function P_(i){return i=wi(i),i.tag=3,i}function M_(i,s,c,m){var y=c.type.getDerivedStateFromError;if(typeof y=="function"){var N=m.value;i.payload=function(){return y(N)},i.callback=function(){D_(s,c,m)}}var z=c.stateNode;z!==null&&typeof z.componentDidCatch=="function"&&(i.callback=function(){D_(s,c,m),typeof y!="function"&&(Di===null?Di=new Set([this]):Di.add(this));var q=m.stack;this.componentDidCatch(m.value,{componentStack:q!==null?q:""})})}function IT(i,s,c,m,y){if(c.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(s=c.alternate,s!==null&&zl(s,c,y,!0),c=ln.current,c!==null){switch(c.tag){case 31:case 13:return En===null?xd():c.alternate===null&&$t===0&&($t=3),c.flags&=-257,c.flags|=65536,c.lanes=y,m===Qu?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([m]):s.add(m),ov(i,m,y)),!1;case 22:return c.flags|=65536,m===Qu?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([m])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([m]):c.add(m)),ov(i,m,y)),!1}throw Error(a(435,c.tag))}return ov(i,m,y),xd(),!1}if(st)return s=ln.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=y,m!==rh&&(i=Error(a(422),{cause:m}),Bo(Nn(i,c)))):(m!==rh&&(s=Error(a(423),{cause:m}),Bo(Nn(s,c))),i=i.current.alternate,i.flags|=65536,y&=-y,i.lanes|=y,m=Nn(m,c),y=Rh(i.stateNode,m,y),fh(i,y),$t!==4&&($t=2)),!1;var N=Error(a(520),{cause:m});if(N=Nn(N,c),sc===null?sc=[N]:sc.push(N),$t!==4&&($t=2),s===null)return!0;m=Nn(m,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=y&-y,c.lanes|=i,i=Rh(c.stateNode,m,i),fh(c,i),!1;case 1:if(s=c.type,N=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(Di===null||!Di.has(N))))return c.flags|=65536,y&=-y,c.lanes|=y,y=P_(y),M_(y,i,c,m),fh(c,y),!1}c=c.return}while(c!==null);return!1}var Ih=Error(a(461)),Xt=!1;function wr(i,s,c,m){s.child=i===null?I0(s,null,c,m):Ns(s,i.child,c,m)}function T_(i,s,c,m,y){c=c.render;var N=s.ref;if("ref"in m){var z={};for(var q in m)q!=="ref"&&(z[q]=m[q])}else z=m;return bs(s),m=bh(i,s,c,z,N,y),q=yh(),i!==null&&!Xt?(jh(i,s,y),Ra(i,s,y)):(st&&q&&eh(s),s.flags|=1,wr(i,s,m,y),s.child)}function q_(i,s,c,m,y){if(i===null){var N=c.type;return typeof N=="function"&&!Xp(N)&&N.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=N,R_(i,s,N,m,y)):(i=Bu(c.type,null,m,s,s.mode,y),i.ref=s.ref,i.return=s,s.child=i)}if(N=i.child,!Vh(i,y)){var z=N.memoizedProps;if(c=c.compare,c=c!==null?c:Io,c(z,m)&&i.ref===s.ref)return Ra(i,s,y)}return s.flags|=1,i=Oa(N,m),i.ref=s.ref,i.return=s,s.child=i}function R_(i,s,c,m,y){if(i!==null){var N=i.memoizedProps;if(Io(N,m)&&i.ref===s.ref)if(Xt=!1,s.pendingProps=m=N,Vh(i,y))(i.flags&131072)!==0&&(Xt=!0);else return s.lanes=i.lanes,Ra(i,s,y)}return Lh(i,s,c,m,y)}function I_(i,s,c,m){var y=m.children,N=i!==null?i.memoizedState:null;if(i===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((s.flags&128)!==0){if(N=N!==null?N.baseLanes|c:c,i!==null){for(m=s.child=i.child,y=0;m!==null;)y=y|m.lanes|m.childLanes,m=m.sibling;m=y&~N}else m=0,s.child=null;return L_(i,s,N,c,m)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Hu(s,N!==null?N.cachePool:null),N!==null?B0(s,N):hh(),U0(s);else return m=s.lanes=536870912,L_(i,s,N!==null?N.baseLanes|c:c,c,m)}else N!==null?(Hu(s,N.cachePool),B0(s,N),Ai(),s.memoizedState=null):(i!==null&&Hu(s,null),hh(),Ai());return wr(i,s,y,c),s.child}function Jo(i,s){return i!==null&&i.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function L_(i,s,c,m,y){var N=ch();return N=N===null?null:{parent:Kt._currentValue,pool:N},s.memoizedState={baseLanes:c,cachePool:N},i!==null&&Hu(s,null),hh(),U0(s),i!==null&&zl(i,s,m,!0),s.childLanes=y,null}function ld(i,s){return s=cd({mode:s.mode,children:s.children},i.mode),s.ref=i.ref,i.child=s,s.return=i,s}function $_(i,s,c){return Ns(s,i.child,null,c),i=ld(s,s.pendingProps),i.flags|=2,on(s),s.memoizedState=null,i}function LT(i,s,c){var m=s.pendingProps,y=(s.flags&128)!==0;if(s.flags&=-129,i===null){if(st){if(m.mode==="hidden")return i=ld(s,m),s.lanes=536870912,Jo(null,i);if(gh(s),(i=zt)?(i=ZN(i,Cn),i=i!==null&&i.data==="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:yi!==null?{id:sa,overflow:la}:null,retryLane:536870912,hydrationErrors:null},c=N0(i),c.return=s,s.child=c,Nr=s,zt=null)):i=null,i===null)throw _i(s);return s.lanes=536870912,null}return ld(s,m)}var N=i.memoizedState;if(N!==null){var z=N.dehydrated;if(gh(s),y)if(s.flags&256)s.flags&=-257,s=$_(i,s,c);else if(s.memoizedState!==null)s.child=i.child,s.flags|=128,s=null;else throw Error(a(558));else if(Xt||zl(i,s,c,!1),y=(c&i.childLanes)!==0,Xt||y){if(m=wt,m!==null&&(z=kj(m,c),z!==0&&z!==N.retryLane))throw N.retryLane=z,hs(i,z),Xr(m,i,z),Ih;xd(),s=$_(i,s,c)}else i=N.treeContext,zt=An(z.nextSibling),Nr=s,st=!0,ji=null,Cn=!1,i!==null&&C0(s,i),s=ld(s,m),s.flags|=4096;return s}return i=Oa(i.child,{mode:m.mode,children:m.children}),i.ref=s.ref,s.child=i,i.return=s,i}function od(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(a(284));(i===null||i.ref!==c)&&(s.flags|=4194816)}}function Lh(i,s,c,m,y){return bs(s),c=bh(i,s,c,m,void 0,y),m=yh(),i!==null&&!Xt?(jh(i,s,y),Ra(i,s,y)):(st&&m&&eh(s),s.flags|=1,wr(i,s,c,y),s.child)}function B_(i,s,c,m,y,N){return bs(s),s.updateQueue=null,c=G0(s,m,c,y),F0(i),m=yh(),i!==null&&!Xt?(jh(i,s,N),Ra(i,s,N)):(st&&m&&eh(s),s.flags|=1,wr(i,s,c,N),s.child)}function U_(i,s,c,m,y){if(bs(s),s.stateNode===null){var N=wl,z=c.contextType;typeof z=="object"&&z!==null&&(N=Sr(z)),N=new c(m,N),s.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,N.updater=qh,s.stateNode=N,N._reactInternals=s,N=s.stateNode,N.props=m,N.state=s.memoizedState,N.refs={},dh(s),z=c.contextType,N.context=typeof z=="object"&&z!==null?Sr(z):wl,N.state=s.memoizedState,z=c.getDerivedStateFromProps,typeof z=="function"&&(Th(s,c,z,m),N.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(z=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),z!==N.state&&qh.enqueueReplaceState(N,N.state,null),Yo(s,m,N,y),Qo(),N.state=s.memoizedState),typeof N.componentDidMount=="function"&&(s.flags|=4194308),m=!0}else if(i===null){N=s.stateNode;var q=s.memoizedProps,G=ws(c,q);N.props=G;var se=N.context,ge=c.contextType;z=wl,typeof ge=="object"&&ge!==null&&(z=Sr(ge));var ye=c.getDerivedStateFromProps;ge=typeof ye=="function"||typeof N.getSnapshotBeforeUpdate=="function",q=s.pendingProps!==q,ge||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(q||se!==z)&&A_(s,N,m,z),Si=!1;var le=s.memoizedState;N.state=le,Yo(s,m,N,y),Qo(),se=s.memoizedState,q||le!==se||Si?(typeof ye=="function"&&(Th(s,c,ye,m),se=s.memoizedState),(G=Si||E_(s,c,G,m,le,se,z))?(ge||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(s.flags|=4194308)):(typeof N.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=m,s.memoizedState=se),N.props=m,N.state=se,N.context=z,m=G):(typeof N.componentDidMount=="function"&&(s.flags|=4194308),m=!1)}else{N=s.stateNode,mh(i,s),z=s.memoizedProps,ge=ws(c,z),N.props=ge,ye=s.pendingProps,le=N.context,se=c.contextType,G=wl,typeof se=="object"&&se!==null&&(G=Sr(se)),q=c.getDerivedStateFromProps,(se=typeof q=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(z!==ye||le!==G)&&A_(s,N,m,G),Si=!1,le=s.memoizedState,N.state=le,Yo(s,m,N,y),Qo();var fe=s.memoizedState;z!==ye||le!==fe||Si||i!==null&&i.dependencies!==null&&Fu(i.dependencies)?(typeof q=="function"&&(Th(s,c,q,m),fe=s.memoizedState),(ge=Si||E_(s,c,ge,m,le,fe,G)||i!==null&&i.dependencies!==null&&Fu(i.dependencies))?(se||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(m,fe,G),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(m,fe,G)),typeof N.componentDidUpdate=="function"&&(s.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof N.componentDidUpdate!="function"||z===i.memoizedProps&&le===i.memoizedState||(s.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||z===i.memoizedProps&&le===i.memoizedState||(s.flags|=1024),s.memoizedProps=m,s.memoizedState=fe),N.props=m,N.state=fe,N.context=G,m=ge):(typeof N.componentDidUpdate!="function"||z===i.memoizedProps&&le===i.memoizedState||(s.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||z===i.memoizedProps&&le===i.memoizedState||(s.flags|=1024),m=!1)}return N=m,od(i,s),m=(s.flags&128)!==0,N||m?(N=s.stateNode,c=m&&typeof c.getDerivedStateFromError!="function"?null:N.render(),s.flags|=1,i!==null&&m?(s.child=Ns(s,i.child,null,y),s.child=Ns(s,null,c,y)):wr(i,s,c,y),s.memoizedState=N.state,i=s.child):i=Ra(i,s,y),i}function F_(i,s,c,m){return gs(),s.flags|=256,wr(i,s,c,m),s.child}var $h={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bh(i){return{baseLanes:i,cachePool:D0()}}function Uh(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=un),i}function G_(i,s,c){var m=s.pendingProps,y=!1,N=(s.flags&128)!==0,z;if((z=N)||(z=i!==null&&i.memoizedState===null?!1:(Vt.current&2)!==0),z&&(y=!0,s.flags&=-129),z=(s.flags&32)!==0,s.flags&=-33,i===null){if(st){if(y?Ei(s):Ai(),(i=zt)?(i=ZN(i,Cn),i=i!==null&&i.data!=="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:yi!==null?{id:sa,overflow:la}:null,retryLane:536870912,hydrationErrors:null},c=N0(i),c.return=s,s.child=c,Nr=s,zt=null)):i=null,i===null)throw _i(s);return Sv(i)?s.lanes=32:s.lanes=536870912,null}var q=m.children;return m=m.fallback,y?(Ai(),y=s.mode,q=cd({mode:"hidden",children:q},y),m=vs(m,y,c,null),q.return=s,m.return=s,q.sibling=m,s.child=q,m=s.child,m.memoizedState=Bh(c),m.childLanes=Uh(i,z,c),s.memoizedState=$h,Jo(null,m)):(Ei(s),Fh(s,q))}var G=i.memoizedState;if(G!==null&&(q=G.dehydrated,q!==null)){if(N)s.flags&256?(Ei(s),s.flags&=-257,s=Gh(i,s,c)):s.memoizedState!==null?(Ai(),s.child=i.child,s.flags|=128,s=null):(Ai(),q=m.fallback,y=s.mode,m=cd({mode:"visible",children:m.children},y),q=vs(q,y,c,null),q.flags|=2,m.return=s,q.return=s,m.sibling=q,s.child=m,Ns(s,i.child,null,c),m=s.child,m.memoizedState=Bh(c),m.childLanes=Uh(i,z,c),s.memoizedState=$h,s=Jo(null,m));else if(Ei(s),Sv(q)){if(z=q.nextSibling&&q.nextSibling.dataset,z)var se=z.dgst;z=se,m=Error(a(419)),m.stack="",m.digest=z,Bo({value:m,source:null,stack:null}),s=Gh(i,s,c)}else if(Xt||zl(i,s,c,!1),z=(c&i.childLanes)!==0,Xt||z){if(z=wt,z!==null&&(m=kj(z,c),m!==0&&m!==G.retryLane))throw G.retryLane=m,hs(i,m),Xr(z,i,m),Ih;Nv(q)||xd(),s=Gh(i,s,c)}else Nv(q)?(s.flags|=192,s.child=i.child,s=null):(i=G.treeContext,zt=An(q.nextSibling),Nr=s,st=!0,ji=null,Cn=!1,i!==null&&C0(s,i),s=Fh(s,m.children),s.flags|=4096);return s}return y?(Ai(),q=m.fallback,y=s.mode,G=i.child,se=G.sibling,m=Oa(G,{mode:"hidden",children:m.children}),m.subtreeFlags=G.subtreeFlags&65011712,se!==null?q=Oa(se,q):(q=vs(q,y,c,null),q.flags|=2),q.return=s,m.return=s,m.sibling=q,s.child=m,Jo(null,m),m=s.child,q=i.child.memoizedState,q===null?q=Bh(c):(y=q.cachePool,y!==null?(G=Kt._currentValue,y=y.parent!==G?{parent:G,pool:G}:y):y=D0(),q={baseLanes:q.baseLanes|c,cachePool:y}),m.memoizedState=q,m.childLanes=Uh(i,z,c),s.memoizedState=$h,Jo(i.child,m)):(Ei(s),c=i.child,i=c.sibling,c=Oa(c,{mode:"visible",children:m.children}),c.return=s,c.sibling=null,i!==null&&(z=s.deletions,z===null?(s.deletions=[i],s.flags|=16):z.push(i)),s.child=c,s.memoizedState=null,c)}function Fh(i,s){return s=cd({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function cd(i,s){return i=sn(22,i,null,s),i.lanes=0,i}function Gh(i,s,c){return Ns(s,i.child,null,c),i=Fh(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function H_(i,s,c){i.lanes|=s;var m=i.alternate;m!==null&&(m.lanes|=s),ih(i.return,s,c)}function Hh(i,s,c,m,y,N){var z=i.memoizedState;z===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:m,tail:c,tailMode:y,treeForkCount:N}:(z.isBackwards=s,z.rendering=null,z.renderingStartTime=0,z.last=m,z.tail=c,z.tailMode=y,z.treeForkCount=N)}function V_(i,s,c){var m=s.pendingProps,y=m.revealOrder,N=m.tail;m=m.children;var z=Vt.current,q=(z&2)!==0;if(q?(z=z&1|2,s.flags|=128):z&=1,oe(Vt,z),wr(i,s,m,c),m=st?$o:0,!q&&i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&H_(i,c,s);else if(i.tag===19)H_(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(y){case"forwards":for(c=s.child,y=null;c!==null;)i=c.alternate,i!==null&&Xu(i)===null&&(y=c),c=c.sibling;c=y,c===null?(y=s.child,s.child=null):(y=c.sibling,c.sibling=null),Hh(s,!1,y,c,N,m);break;case"backwards":case"unstable_legacy-backwards":for(c=null,y=s.child,s.child=null;y!==null;){if(i=y.alternate,i!==null&&Xu(i)===null){s.child=y;break}i=y.sibling,y.sibling=c,c=y,y=i}Hh(s,!0,c,null,N,m);break;case"together":Hh(s,!1,null,null,void 0,m);break;default:s.memoizedState=null}return s.child}function Ra(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),Oi|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(zl(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(a(153));if(s.child!==null){for(i=s.child,c=Oa(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=Oa(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function Vh(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Fu(i)))}function $T(i,s,c){switch(s.tag){case 3:Me(s,s.stateNode.containerInfo),Ni(s,Kt,i.memoizedState.cache),gs();break;case 27:case 5:Z(s);break;case 4:Me(s,s.stateNode.containerInfo);break;case 10:Ni(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,gh(s),null;break;case 13:var m=s.memoizedState;if(m!==null)return m.dehydrated!==null?(Ei(s),s.flags|=128,null):(c&s.child.childLanes)!==0?G_(i,s,c):(Ei(s),i=Ra(i,s,c),i!==null?i.sibling:null);Ei(s);break;case 19:var y=(i.flags&128)!==0;if(m=(c&s.childLanes)!==0,m||(zl(i,s,c,!1),m=(c&s.childLanes)!==0),y){if(m)return V_(i,s,c);s.flags|=128}if(y=s.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),oe(Vt,Vt.current),m)break;return null;case 22:return s.lanes=0,I_(i,s,c,s.pendingProps);case 24:Ni(s,Kt,i.memoizedState.cache)}return Ra(i,s,c)}function Q_(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)Xt=!0;else{if(!Vh(i,c)&&(s.flags&128)===0)return Xt=!1,$T(i,s,c);Xt=(i.flags&131072)!==0}else Xt=!1,st&&(s.flags&1048576)!==0&&w0(s,$o,s.index);switch(s.lanes=0,s.tag){case 16:e:{var m=s.pendingProps;if(i=js(s.elementType),s.type=i,typeof i=="function")Xp(i)?(m=ws(i,m),s.tag=1,s=U_(null,s,i,m,c)):(s.tag=0,s=Lh(null,s,i,m,c));else{if(i!=null){var y=i.$$typeof;if(y===A){s.tag=11,s=T_(null,s,i,m,c);break e}else if(y===P){s.tag=14,s=q_(null,s,i,m,c);break e}}throw s=ae(i)||i,Error(a(306,s,""))}}return s;case 0:return Lh(i,s,s.type,s.pendingProps,c);case 1:return m=s.type,y=ws(m,s.pendingProps),U_(i,s,m,y,c);case 3:e:{if(Me(s,s.stateNode.containerInfo),i===null)throw Error(a(387));m=s.pendingProps;var N=s.memoizedState;y=N.element,mh(i,s),Yo(s,m,null,c);var z=s.memoizedState;if(m=z.cache,Ni(s,Kt,m),m!==N.cache&&sh(s,[Kt],c,!0),Qo(),m=z.element,N.isDehydrated)if(N={element:m,isDehydrated:!1,cache:z.cache},s.updateQueue.baseState=N,s.memoizedState=N,s.flags&256){s=F_(i,s,m,c);break e}else if(m!==y){y=Nn(Error(a(424)),s),Bo(y),s=F_(i,s,m,c);break e}else for(i=s.stateNode.containerInfo,i.nodeType===9?i=i.body:i=i.nodeName==="HTML"?i.ownerDocument.body:i,zt=An(i.firstChild),Nr=s,st=!0,ji=null,Cn=!0,c=I0(s,null,m,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(gs(),m===y){s=Ra(i,s,c);break e}wr(i,s,m,c)}s=s.child}return s;case 26:return od(i,s),i===null?(c=a1(s.type,null,s.pendingProps,null))?s.memoizedState=c:st||(c=s.type,i=s.pendingProps,m=wd(H.current).createElement(c),m[_r]=s,m[Hr]=i,Cr(m,c,i),ur(m),s.stateNode=m):s.memoizedState=a1(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Z(s),i===null&&st&&(m=s.stateNode=t1(s.type,s.pendingProps,H.current),Nr=s,Cn=!0,y=zt,qi(s.type)?(wv=y,zt=An(m.firstChild)):zt=y),wr(i,s,s.pendingProps.children,c),od(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&st&&((y=m=zt)&&(m=vq(m,s.type,s.pendingProps,Cn),m!==null?(s.stateNode=m,Nr=s,zt=An(m.firstChild),Cn=!1,y=!0):y=!1),y||_i(s)),Z(s),y=s.type,N=s.pendingProps,z=i!==null?i.memoizedProps:null,m=N.children,yv(y,N)?m=null:z!==null&&yv(y,z)&&(s.flags|=32),s.memoizedState!==null&&(y=bh(i,s,OT,null,null,c),pc._currentValue=y),od(i,s),wr(i,s,m,c),s.child;case 6:return i===null&&st&&((i=c=zt)&&(c=gq(c,s.pendingProps,Cn),c!==null?(s.stateNode=c,Nr=s,zt=null,i=!0):i=!1),i||_i(s)),null;case 13:return G_(i,s,c);case 4:return Me(s,s.stateNode.containerInfo),m=s.pendingProps,i===null?s.child=Ns(s,null,m,c):wr(i,s,m,c),s.child;case 11:return T_(i,s,s.type,s.pendingProps,c);case 7:return wr(i,s,s.pendingProps,c),s.child;case 8:return wr(i,s,s.pendingProps.children,c),s.child;case 12:return wr(i,s,s.pendingProps.children,c),s.child;case 10:return m=s.pendingProps,Ni(s,s.type,m.value),wr(i,s,m.children,c),s.child;case 9:return y=s.type._context,m=s.pendingProps.children,bs(s),y=Sr(y),m=m(y),s.flags|=1,wr(i,s,m,c),s.child;case 14:return q_(i,s,s.type,s.pendingProps,c);case 15:return R_(i,s,s.type,s.pendingProps,c);case 19:return V_(i,s,c);case 31:return LT(i,s,c);case 22:return I_(i,s,c,s.pendingProps);case 24:return bs(s),m=Sr(Kt),i===null?(y=ch(),y===null&&(y=wt,N=lh(),y.pooledCache=N,N.refCount++,N!==null&&(y.pooledCacheLanes|=c),y=N),s.memoizedState={parent:m,cache:y},dh(s),Ni(s,Kt,y)):((i.lanes&c)!==0&&(mh(i,s),Yo(s,null,null,c),Qo()),y=i.memoizedState,N=s.memoizedState,y.parent!==m?(y={parent:m,cache:m},s.memoizedState=y,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=y),Ni(s,Kt,m)):(m=N.cache,Ni(s,Kt,m),m!==y.cache&&sh(s,[Kt],c,!0))),wr(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(a(156,s.tag))}function Ia(i){i.flags|=4}function Qh(i,s,c,m,y){if((s=(i.mode&32)!==0)&&(s=!1),s){if(i.flags|=16777216,(y&335544128)===y)if(i.stateNode.complete)i.flags|=8192;else if(yN())i.flags|=8192;else throw _s=Qu,uh}else i.flags&=-16777217}function Y_(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!c1(s))if(yN())i.flags|=8192;else throw _s=Qu,uh}function ud(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?te():536870912,i.lanes|=s,Bl|=s)}function ec(i,s){if(!st)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:m.sibling=null}}function kt(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,m=0;if(s)for(var y=i.child;y!==null;)c|=y.lanes|y.childLanes,m|=y.subtreeFlags&65011712,m|=y.flags&65011712,y.return=i,y=y.sibling;else for(y=i.child;y!==null;)c|=y.lanes|y.childLanes,m|=y.subtreeFlags,m|=y.flags,y.return=i,y=y.sibling;return i.subtreeFlags|=m,i.childLanes=c,s}function BT(i,s,c){var m=s.pendingProps;switch(th(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kt(s),null;case 1:return kt(s),null;case 3:return c=s.stateNode,m=null,i!==null&&(m=i.memoizedState.cache),s.memoizedState.cache!==m&&(s.flags|=2048),Ma(Kt),ue(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(Al(s)?Ia(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,nh())),kt(s),null;case 26:var y=s.type,N=s.memoizedState;return i===null?(Ia(s),N!==null?(kt(s),Y_(s,N)):(kt(s),Qh(s,y,null,m,c))):N?N!==i.memoizedState?(Ia(s),kt(s),Y_(s,N)):(kt(s),s.flags&=-16777217):(i=i.memoizedProps,i!==m&&Ia(s),kt(s),Qh(s,y,i,m,c)),null;case 27:if(V(s),c=H.current,y=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==m&&Ia(s);else{if(!m){if(s.stateNode===null)throw Error(a(166));return kt(s),null}i=xe.current,Al(s)?E0(s):(i=t1(y,m,c),s.stateNode=i,Ia(s))}return kt(s),null;case 5:if(V(s),y=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==m&&Ia(s);else{if(!m){if(s.stateNode===null)throw Error(a(166));return kt(s),null}if(N=xe.current,Al(s))E0(s);else{var z=wd(H.current);switch(N){case 1:N=z.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:N=z.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":N=z.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":N=z.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":N=z.createElement("div"),N.innerHTML="<script><\/script>",N=N.removeChild(N.firstChild);break;case"select":N=typeof m.is=="string"?z.createElement("select",{is:m.is}):z.createElement("select"),m.multiple?N.multiple=!0:m.size&&(N.size=m.size);break;default:N=typeof m.is=="string"?z.createElement(y,{is:m.is}):z.createElement(y)}}N[_r]=s,N[Hr]=m;e:for(z=s.child;z!==null;){if(z.tag===5||z.tag===6)N.appendChild(z.stateNode);else if(z.tag!==4&&z.tag!==27&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===s)break e;for(;z.sibling===null;){if(z.return===null||z.return===s)break e;z=z.return}z.sibling.return=z.return,z=z.sibling}s.stateNode=N;e:switch(Cr(N,y,m),y){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&Ia(s)}}return kt(s),Qh(s,s.type,i===null?null:i.memoizedProps,s.pendingProps,c),null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==m&&Ia(s);else{if(typeof m!="string"&&s.stateNode===null)throw Error(a(166));if(i=H.current,Al(s)){if(i=s.stateNode,c=s.memoizedProps,m=null,y=Nr,y!==null)switch(y.tag){case 27:case 5:m=y.memoizedProps}i[_r]=s,i=!!(i.nodeValue===c||m!==null&&m.suppressHydrationWarning===!0||GN(i.nodeValue,c)),i||_i(s,!0)}else i=wd(i).createTextNode(m),i[_r]=s,s.stateNode=i}return kt(s),null;case 31:if(c=s.memoizedState,i===null||i.memoizedState!==null){if(m=Al(s),c!==null){if(i===null){if(!m)throw Error(a(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(557));i[_r]=s}else gs(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;kt(s),i=!1}else c=nh(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=c),i=!0;if(!i)return s.flags&256?(on(s),s):(on(s),null);if((s.flags&128)!==0)throw Error(a(558))}return kt(s),null;case 13:if(m=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(y=Al(s),m!==null&&m.dehydrated!==null){if(i===null){if(!y)throw Error(a(318));if(y=s.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(a(317));y[_r]=s}else gs(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;kt(s),y=!1}else y=nh(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=y),y=!0;if(!y)return s.flags&256?(on(s),s):(on(s),null)}return on(s),(s.flags&128)!==0?(s.lanes=c,s):(c=m!==null,i=i!==null&&i.memoizedState!==null,c&&(m=s.child,y=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(y=m.alternate.memoizedState.cachePool.pool),N=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(N=m.memoizedState.cachePool.pool),N!==y&&(m.flags|=2048)),c!==i&&c&&(s.child.flags|=8192),ud(s,s.updateQueue),kt(s),null);case 4:return ue(),i===null&&hv(s.stateNode.containerInfo),kt(s),null;case 10:return Ma(s.type),kt(s),null;case 19:if(K(Vt),m=s.memoizedState,m===null)return kt(s),null;if(y=(s.flags&128)!==0,N=m.rendering,N===null)if(y)ec(m,!1);else{if($t!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(N=Xu(i),N!==null){for(s.flags|=128,ec(m,!1),i=N.updateQueue,s.updateQueue=i,ud(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)_0(c,i),c=c.sibling;return oe(Vt,Vt.current&1|2),st&&Da(s,m.treeForkCount),s.child}i=i.sibling}m.tail!==null&&Re()>hd&&(s.flags|=128,y=!0,ec(m,!1),s.lanes=4194304)}else{if(!y)if(i=Xu(N),i!==null){if(s.flags|=128,y=!0,i=i.updateQueue,s.updateQueue=i,ud(s,i),ec(m,!0),m.tail===null&&m.tailMode==="hidden"&&!N.alternate&&!st)return kt(s),null}else 2*Re()-m.renderingStartTime>hd&&c!==536870912&&(s.flags|=128,y=!0,ec(m,!1),s.lanes=4194304);m.isBackwards?(N.sibling=s.child,s.child=N):(i=m.last,i!==null?i.sibling=N:s.child=N,m.last=N)}return m.tail!==null?(i=m.tail,m.rendering=i,m.tail=i.sibling,m.renderingStartTime=Re(),i.sibling=null,c=Vt.current,oe(Vt,y?c&1|2:c&1),st&&Da(s,m.treeForkCount),i):(kt(s),null);case 22:case 23:return on(s),vh(),m=s.memoizedState!==null,i!==null?i.memoizedState!==null!==m&&(s.flags|=8192):m&&(s.flags|=8192),m?(c&536870912)!==0&&(s.flags&128)===0&&(kt(s),s.subtreeFlags&6&&(s.flags|=8192)):kt(s),c=s.updateQueue,c!==null&&ud(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),m=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(m=s.memoizedState.cachePool.pool),m!==c&&(s.flags|=2048),i!==null&&K(ys),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Ma(Kt),kt(s),null;case 25:return null;case 30:return null}throw Error(a(156,s.tag))}function UT(i,s){switch(th(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Ma(Kt),ue(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return V(s),null;case 31:if(s.memoizedState!==null){if(on(s),s.alternate===null)throw Error(a(340));gs()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 13:if(on(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(a(340));gs()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return K(Vt),null;case 4:return ue(),null;case 10:return Ma(s.type),null;case 22:case 23:return on(s),vh(),i!==null&&K(ys),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Ma(Kt),null;case 25:return null;default:return null}}function K_(i,s){switch(th(s),s.tag){case 3:Ma(Kt),ue();break;case 26:case 27:case 5:V(s);break;case 4:ue();break;case 31:s.memoizedState!==null&&on(s);break;case 13:on(s);break;case 19:K(Vt);break;case 10:Ma(s.type);break;case 22:case 23:on(s),vh(),i!==null&&K(ys);break;case 24:Ma(Kt)}}function tc(i,s){try{var c=s.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var y=m.next;c=y;do{if((c.tag&i)===i){m=void 0;var N=c.create,z=c.inst;m=N(),z.destroy=m}c=c.next}while(c!==y)}}catch(q){gt(s,s.return,q)}}function zi(i,s,c){try{var m=s.updateQueue,y=m!==null?m.lastEffect:null;if(y!==null){var N=y.next;m=N;do{if((m.tag&i)===i){var z=m.inst,q=z.destroy;if(q!==void 0){z.destroy=void 0,y=s;var G=c,se=q;try{se()}catch(ge){gt(y,G,ge)}}}m=m.next}while(m!==N)}}catch(ge){gt(s,s.return,ge)}}function W_(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{$0(s,c)}catch(m){gt(i,i.return,m)}}}function X_(i,s,c){c.props=ws(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(m){gt(i,s,m)}}function rc(i,s){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var m=i.stateNode;break;case 30:m=i.stateNode;break;default:m=i.stateNode}typeof c=="function"?i.refCleanup=c(m):c.current=m}}catch(y){gt(i,s,y)}}function oa(i,s){var c=i.ref,m=i.refCleanup;if(c!==null)if(typeof m=="function")try{m()}catch(y){gt(i,s,y)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(y){gt(i,s,y)}else c.current=null}function Z_(i){var s=i.type,c=i.memoizedProps,m=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&m.focus();break e;case"img":c.src?m.src=c.src:c.srcSet&&(m.srcset=c.srcSet)}}catch(y){gt(i,i.return,y)}}function Yh(i,s,c){try{var m=i.stateNode;uq(m,i.type,c,s),m[Hr]=s}catch(y){gt(i,i.return,y)}}function J_(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&qi(i.type)||i.tag===4}function Kh(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||J_(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&qi(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Wh(i,s,c){var m=i.tag;if(m===5||m===6)i=i.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(i),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=za));else if(m!==4&&(m===27&&qi(i.type)&&(c=i.stateNode,s=null),i=i.child,i!==null))for(Wh(i,s,c),i=i.sibling;i!==null;)Wh(i,s,c),i=i.sibling}function dd(i,s,c){var m=i.tag;if(m===5||m===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(m!==4&&(m===27&&qi(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(dd(i,s,c),i=i.sibling;i!==null;)dd(i,s,c),i=i.sibling}function eN(i){var s=i.stateNode,c=i.memoizedProps;try{for(var m=i.type,y=s.attributes;y.length;)s.removeAttributeNode(y[0]);Cr(s,m,c),s[_r]=i,s[Hr]=c}catch(N){gt(i,i.return,N)}}var La=!1,Zt=!1,Xh=!1,tN=typeof WeakSet=="function"?WeakSet:Set,dr=null;function FT(i,s){if(i=i.containerInfo,xv=Dd,i=f0(i),Gp(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var m=c.getSelection&&c.getSelection();if(m&&m.rangeCount!==0){c=m.anchorNode;var y=m.anchorOffset,N=m.focusNode;m=m.focusOffset;try{c.nodeType,N.nodeType}catch{c=null;break e}var z=0,q=-1,G=-1,se=0,ge=0,ye=i,le=null;t:for(;;){for(var fe;ye!==c||y!==0&&ye.nodeType!==3||(q=z+y),ye!==N||m!==0&&ye.nodeType!==3||(G=z+m),ye.nodeType===3&&(z+=ye.nodeValue.length),(fe=ye.firstChild)!==null;)le=ye,ye=fe;for(;;){if(ye===i)break t;if(le===c&&++se===y&&(q=z),le===N&&++ge===m&&(G=z),(fe=ye.nextSibling)!==null)break;ye=le,le=ye.parentNode}ye=fe}c=q===-1||G===-1?null:{start:q,end:G}}else c=null}c=c||{start:0,end:0}}else c=null;for(bv={focusedElem:i,selectionRange:c},Dd=!1,dr=s;dr!==null;)if(s=dr,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,dr=i;else for(;dr!==null;){switch(s=dr,N=s.alternate,i=s.flags,s.tag){case 0:if((i&4)!==0&&(i=s.updateQueue,i=i!==null?i.events:null,i!==null))for(c=0;c<i.length;c++)y=i[c],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&N!==null){i=void 0,c=s,y=N.memoizedProps,N=N.memoizedState,m=c.stateNode;try{var Oe=ws(c.type,y);i=m.getSnapshotBeforeUpdate(Oe,N),m.__reactInternalSnapshotBeforeUpdate=i}catch(Ge){gt(c,c.return,Ge)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)_v(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":_v(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(a(163))}if(i=s.sibling,i!==null){i.return=s.return,dr=i;break}dr=s.return}}function rN(i,s,c){var m=c.flags;switch(c.tag){case 0:case 11:case 15:Ba(i,c),m&4&&tc(5,c);break;case 1:if(Ba(i,c),m&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(z){gt(c,c.return,z)}else{var y=ws(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(y,s,i.__reactInternalSnapshotBeforeUpdate)}catch(z){gt(c,c.return,z)}}m&64&&W_(c),m&512&&rc(c,c.return);break;case 3:if(Ba(i,c),m&64&&(i=c.updateQueue,i!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{$0(i,s)}catch(z){gt(c,c.return,z)}}break;case 27:s===null&&m&4&&eN(c);case 26:case 5:Ba(i,c),s===null&&m&4&&Z_(c),m&512&&rc(c,c.return);break;case 12:Ba(i,c);break;case 31:Ba(i,c),m&4&&iN(i,c);break;case 13:Ba(i,c),m&4&&sN(i,c),m&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=ZT.bind(null,c),xq(i,c))));break;case 22:if(m=c.memoizedState!==null||La,!m){s=s!==null&&s.memoizedState!==null||Zt,y=La;var N=Zt;La=m,(Zt=s)&&!N?Ua(i,c,(c.subtreeFlags&8772)!==0):Ba(i,c),La=y,Zt=N}break;case 30:break;default:Ba(i,c)}}function nN(i){var s=i.alternate;s!==null&&(i.alternate=null,nN(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&Ep(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Mt=null,Qr=!1;function $a(i,s,c){for(c=c.child;c!==null;)aN(i,s,c),c=c.sibling}function aN(i,s,c){if(ce&&typeof ce.onCommitFiberUnmount=="function")try{ce.onCommitFiberUnmount(J,c)}catch{}switch(c.tag){case 26:Zt||oa(c,s),$a(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Zt||oa(c,s);var m=Mt,y=Qr;qi(c.type)&&(Mt=c.stateNode,Qr=!1),$a(i,s,c),dc(c.stateNode),Mt=m,Qr=y;break;case 5:Zt||oa(c,s);case 6:if(m=Mt,y=Qr,Mt=null,$a(i,s,c),Mt=m,Qr=y,Mt!==null)if(Qr)try{(Mt.nodeType===9?Mt.body:Mt.nodeName==="HTML"?Mt.ownerDocument.body:Mt).removeChild(c.stateNode)}catch(N){gt(c,s,N)}else try{Mt.removeChild(c.stateNode)}catch(N){gt(c,s,N)}break;case 18:Mt!==null&&(Qr?(i=Mt,WN(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),Kl(i)):WN(Mt,c.stateNode));break;case 4:m=Mt,y=Qr,Mt=c.stateNode.containerInfo,Qr=!0,$a(i,s,c),Mt=m,Qr=y;break;case 0:case 11:case 14:case 15:zi(2,c,s),Zt||zi(4,c,s),$a(i,s,c);break;case 1:Zt||(oa(c,s),m=c.stateNode,typeof m.componentWillUnmount=="function"&&X_(c,s,m)),$a(i,s,c);break;case 21:$a(i,s,c);break;case 22:Zt=(m=Zt)||c.memoizedState!==null,$a(i,s,c),Zt=m;break;default:$a(i,s,c)}}function iN(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{Kl(i)}catch(c){gt(s,s.return,c)}}}function sN(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Kl(i)}catch(c){gt(s,s.return,c)}}function GT(i){switch(i.tag){case 31:case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new tN),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new tN),s;default:throw Error(a(435,i.tag))}}function md(i,s){var c=GT(i);s.forEach(function(m){if(!c.has(m)){c.add(m);var y=JT.bind(null,i,m);m.then(y,y)}})}function Yr(i,s){var c=s.deletions;if(c!==null)for(var m=0;m<c.length;m++){var y=c[m],N=i,z=s,q=z;e:for(;q!==null;){switch(q.tag){case 27:if(qi(q.type)){Mt=q.stateNode,Qr=!1;break e}break;case 5:Mt=q.stateNode,Qr=!1;break e;case 3:case 4:Mt=q.stateNode.containerInfo,Qr=!0;break e}q=q.return}if(Mt===null)throw Error(a(160));aN(N,z,y),Mt=null,Qr=!1,N=y.alternate,N!==null&&(N.return=null),y.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)lN(s,i),s=s.sibling}var Qn=null;function lN(i,s){var c=i.alternate,m=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Yr(s,i),Kr(i),m&4&&(zi(3,i,i.return),tc(3,i),zi(5,i,i.return));break;case 1:Yr(s,i),Kr(i),m&512&&(Zt||c===null||oa(c,c.return)),m&64&&La&&(i=i.updateQueue,i!==null&&(m=i.callbacks,m!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?m:c.concat(m))));break;case 26:var y=Qn;if(Yr(s,i),Kr(i),m&512&&(Zt||c===null||oa(c,c.return)),m&4){var N=c!==null?c.memoizedState:null;if(m=i.memoizedState,c===null)if(m===null)if(i.stateNode===null){e:{m=i.type,c=i.memoizedProps,y=y.ownerDocument||y;t:switch(m){case"title":N=y.getElementsByTagName("title")[0],(!N||N[zo]||N[_r]||N.namespaceURI==="http://www.w3.org/2000/svg"||N.hasAttribute("itemprop"))&&(N=y.createElement(m),y.head.insertBefore(N,y.querySelector("head > title"))),Cr(N,m,c),N[_r]=i,ur(N),m=N;break e;case"link":var z=l1("link","href",y).get(m+(c.href||""));if(z){for(var q=0;q<z.length;q++)if(N=z[q],N.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&N.getAttribute("rel")===(c.rel==null?null:c.rel)&&N.getAttribute("title")===(c.title==null?null:c.title)&&N.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){z.splice(q,1);break t}}N=y.createElement(m),Cr(N,m,c),y.head.appendChild(N);break;case"meta":if(z=l1("meta","content",y).get(m+(c.content||""))){for(q=0;q<z.length;q++)if(N=z[q],N.getAttribute("content")===(c.content==null?null:""+c.content)&&N.getAttribute("name")===(c.name==null?null:c.name)&&N.getAttribute("property")===(c.property==null?null:c.property)&&N.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&N.getAttribute("charset")===(c.charSet==null?null:c.charSet)){z.splice(q,1);break t}}N=y.createElement(m),Cr(N,m,c),y.head.appendChild(N);break;default:throw Error(a(468,m))}N[_r]=i,ur(N),m=N}i.stateNode=m}else o1(y,i.type,i.stateNode);else i.stateNode=s1(y,m,i.memoizedProps);else N!==m?(N===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):N.count--,m===null?o1(y,i.type,i.stateNode):s1(y,m,i.memoizedProps)):m===null&&i.stateNode!==null&&Yh(i,i.memoizedProps,c.memoizedProps)}break;case 27:Yr(s,i),Kr(i),m&512&&(Zt||c===null||oa(c,c.return)),c!==null&&m&4&&Yh(i,i.memoizedProps,c.memoizedProps);break;case 5:if(Yr(s,i),Kr(i),m&512&&(Zt||c===null||oa(c,c.return)),i.flags&32){y=i.stateNode;try{xl(y,"")}catch(Oe){gt(i,i.return,Oe)}}m&4&&i.stateNode!=null&&(y=i.memoizedProps,Yh(i,y,c!==null?c.memoizedProps:y)),m&1024&&(Xh=!0);break;case 6:if(Yr(s,i),Kr(i),m&4){if(i.stateNode===null)throw Error(a(162));m=i.memoizedProps,c=i.stateNode;try{c.nodeValue=m}catch(Oe){gt(i,i.return,Oe)}}break;case 3:if(Ad=null,y=Qn,Qn=Cd(s.containerInfo),Yr(s,i),Qn=y,Kr(i),m&4&&c!==null&&c.memoizedState.isDehydrated)try{Kl(s.containerInfo)}catch(Oe){gt(i,i.return,Oe)}Xh&&(Xh=!1,oN(i));break;case 4:m=Qn,Qn=Cd(i.stateNode.containerInfo),Yr(s,i),Kr(i),Qn=m;break;case 12:Yr(s,i),Kr(i);break;case 31:Yr(s,i),Kr(i),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,md(i,m)));break;case 13:Yr(s,i),Kr(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(pd=Re()),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,md(i,m)));break;case 22:y=i.memoizedState!==null;var G=c!==null&&c.memoizedState!==null,se=La,ge=Zt;if(La=se||y,Zt=ge||G,Yr(s,i),Zt=ge,La=se,Kr(i),m&8192)e:for(s=i.stateNode,s._visibility=y?s._visibility&-2:s._visibility|1,y&&(c===null||G||La||Zt||Cs(i)),c=null,s=i;;){if(s.tag===5||s.tag===26){if(c===null){G=c=s;try{if(N=G.stateNode,y)z=N.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none";else{q=G.stateNode;var ye=G.memoizedProps.style,le=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;q.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(Oe){gt(G,G.return,Oe)}}}else if(s.tag===6){if(c===null){G=s;try{G.stateNode.nodeValue=y?"":G.memoizedProps}catch(Oe){gt(G,G.return,Oe)}}}else if(s.tag===18){if(c===null){G=s;try{var fe=G.stateNode;y?XN(fe,!0):XN(G.stateNode,!1)}catch(Oe){gt(G,G.return,Oe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}m&4&&(m=i.updateQueue,m!==null&&(c=m.retryQueue,c!==null&&(m.retryQueue=null,md(i,c))));break;case 19:Yr(s,i),Kr(i),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,md(i,m)));break;case 30:break;case 21:break;default:Yr(s,i),Kr(i)}}function Kr(i){var s=i.flags;if(s&2){try{for(var c,m=i.return;m!==null;){if(J_(m)){c=m;break}m=m.return}if(c==null)throw Error(a(160));switch(c.tag){case 27:var y=c.stateNode,N=Kh(i);dd(i,N,y);break;case 5:var z=c.stateNode;c.flags&32&&(xl(z,""),c.flags&=-33);var q=Kh(i);dd(i,q,z);break;case 3:case 4:var G=c.stateNode.containerInfo,se=Kh(i);Wh(i,se,G);break;default:throw Error(a(161))}}catch(ge){gt(i,i.return,ge)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function oN(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;oN(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Ba(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)rN(i,s.alternate,s),s=s.sibling}function Cs(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:zi(4,s,s.return),Cs(s);break;case 1:oa(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&X_(s,s.return,c),Cs(s);break;case 27:dc(s.stateNode);case 26:case 5:oa(s,s.return),Cs(s);break;case 22:s.memoizedState===null&&Cs(s);break;case 30:Cs(s);break;default:Cs(s)}i=i.sibling}}function Ua(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var m=s.alternate,y=i,N=s,z=N.flags;switch(N.tag){case 0:case 11:case 15:Ua(y,N,c),tc(4,N);break;case 1:if(Ua(y,N,c),m=N,y=m.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(se){gt(m,m.return,se)}if(m=N,y=m.updateQueue,y!==null){var q=m.stateNode;try{var G=y.shared.hiddenCallbacks;if(G!==null)for(y.shared.hiddenCallbacks=null,y=0;y<G.length;y++)L0(G[y],q)}catch(se){gt(m,m.return,se)}}c&&z&64&&W_(N),rc(N,N.return);break;case 27:eN(N);case 26:case 5:Ua(y,N,c),c&&m===null&&z&4&&Z_(N),rc(N,N.return);break;case 12:Ua(y,N,c);break;case 31:Ua(y,N,c),c&&z&4&&iN(y,N);break;case 13:Ua(y,N,c),c&&z&4&&sN(y,N);break;case 22:N.memoizedState===null&&Ua(y,N,c),rc(N,N.return);break;case 30:break;default:Ua(y,N,c)}s=s.sibling}}function Zh(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Uo(c))}function Jh(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Uo(i))}function Yn(i,s,c,m){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)cN(i,s,c,m),s=s.sibling}function cN(i,s,c,m){var y=s.flags;switch(s.tag){case 0:case 11:case 15:Yn(i,s,c,m),y&2048&&tc(9,s);break;case 1:Yn(i,s,c,m);break;case 3:Yn(i,s,c,m),y&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Uo(i)));break;case 12:if(y&2048){Yn(i,s,c,m),i=s.stateNode;try{var N=s.memoizedProps,z=N.id,q=N.onPostCommit;typeof q=="function"&&q(z,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(G){gt(s,s.return,G)}}else Yn(i,s,c,m);break;case 31:Yn(i,s,c,m);break;case 13:Yn(i,s,c,m);break;case 23:break;case 22:N=s.stateNode,z=s.alternate,s.memoizedState!==null?N._visibility&2?Yn(i,s,c,m):nc(i,s):N._visibility&2?Yn(i,s,c,m):(N._visibility|=2,Il(i,s,c,m,(s.subtreeFlags&10256)!==0||!1)),y&2048&&Zh(z,s);break;case 24:Yn(i,s,c,m),y&2048&&Jh(s.alternate,s);break;default:Yn(i,s,c,m)}}function Il(i,s,c,m,y){for(y=y&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var N=i,z=s,q=c,G=m,se=z.flags;switch(z.tag){case 0:case 11:case 15:Il(N,z,q,G,y),tc(8,z);break;case 23:break;case 22:var ge=z.stateNode;z.memoizedState!==null?ge._visibility&2?Il(N,z,q,G,y):nc(N,z):(ge._visibility|=2,Il(N,z,q,G,y)),y&&se&2048&&Zh(z.alternate,z);break;case 24:Il(N,z,q,G,y),y&&se&2048&&Jh(z.alternate,z);break;default:Il(N,z,q,G,y)}s=s.sibling}}function nc(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,m=s,y=m.flags;switch(m.tag){case 22:nc(c,m),y&2048&&Zh(m.alternate,m);break;case 24:nc(c,m),y&2048&&Jh(m.alternate,m);break;default:nc(c,m)}s=s.sibling}}var ac=8192;function Ll(i,s,c){if(i.subtreeFlags&ac)for(i=i.child;i!==null;)uN(i,s,c),i=i.sibling}function uN(i,s,c){switch(i.tag){case 26:Ll(i,s,c),i.flags&ac&&i.memoizedState!==null&&kq(c,Qn,i.memoizedState,i.memoizedProps);break;case 5:Ll(i,s,c);break;case 3:case 4:var m=Qn;Qn=Cd(i.stateNode.containerInfo),Ll(i,s,c),Qn=m;break;case 22:i.memoizedState===null&&(m=i.alternate,m!==null&&m.memoizedState!==null?(m=ac,ac=16777216,Ll(i,s,c),ac=m):Ll(i,s,c));break;default:Ll(i,s,c)}}function dN(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function ic(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var m=s[c];dr=m,fN(m,i)}dN(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)mN(i),i=i.sibling}function mN(i){switch(i.tag){case 0:case 11:case 15:ic(i),i.flags&2048&&zi(9,i,i.return);break;case 3:ic(i);break;case 12:ic(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,fd(i)):ic(i);break;default:ic(i)}}function fd(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var m=s[c];dr=m,fN(m,i)}dN(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:zi(8,s,s.return),fd(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,fd(s));break;default:fd(s)}i=i.sibling}}function fN(i,s){for(;dr!==null;){var c=dr;switch(c.tag){case 0:case 11:case 15:zi(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var m=c.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Uo(c.memoizedState.cache)}if(m=c.child,m!==null)m.return=c,dr=m;else e:for(c=i;dr!==null;){m=dr;var y=m.sibling,N=m.return;if(nN(m),m===c){dr=null;break e}if(y!==null){y.return=N,dr=y;break e}dr=N}}}var HT={getCacheForType:function(i){var s=Sr(Kt),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c},cacheSignal:function(){return Sr(Kt).controller.signal}},VT=typeof WeakMap=="function"?WeakMap:Map,ft=0,wt=null,tt=null,nt=0,vt=0,cn=null,ki=!1,$l=!1,ev=!1,Fa=0,$t=0,Oi=0,Es=0,tv=0,un=0,Bl=0,sc=null,Wr=null,rv=!1,pd=0,pN=0,hd=1/0,vd=null,Di=null,ar=0,Pi=null,Ul=null,Ga=0,nv=0,av=null,hN=null,lc=0,iv=null;function dn(){return(ft&2)!==0&&nt!==0?nt&-nt:T.T!==null?dv():Oj()}function vN(){if(un===0)if((nt&536870912)===0||st){var i=ol;ol<<=1,(ol&3932160)===0&&(ol=262144),un=i}else un=536870912;return i=ln.current,i!==null&&(i.flags|=32),un}function Xr(i,s,c){(i===wt&&(vt===2||vt===9)||i.cancelPendingCommit!==null)&&(Fl(i,0),Mi(i,nt,un,!1)),ht(i,c),((ft&2)===0||i!==wt)&&(i===wt&&((ft&2)===0&&(Es|=c),$t===4&&Mi(i,nt,un,!1)),ca(i))}function gN(i,s,c){if((ft&6)!==0)throw Error(a(327));var m=!c&&(s&127)===0&&(s&i.expiredLanes)===0||Hn(i,s),y=m?KT(i,s):lv(i,s,!0),N=m;do{if(y===0){$l&&!m&&Mi(i,s,0,!1);break}else{if(c=i.current.alternate,N&&!QT(c)){y=lv(i,s,!1),N=!1;continue}if(y===2){if(N=s,i.errorRecoveryDisabledLanes&N)var z=0;else z=i.pendingLanes&-536870913,z=z!==0?z:z&536870912?536870912:0;if(z!==0){s=z;e:{var q=i;y=sc;var G=q.current.memoizedState.isDehydrated;if(G&&(Fl(q,z).flags|=256),z=lv(q,z,!1),z!==2){if(ev&&!G){q.errorRecoveryDisabledLanes|=N,Es|=N,y=4;break e}N=Wr,Wr=y,N!==null&&(Wr===null?Wr=N:Wr.push.apply(Wr,N))}y=z}if(N=!1,y!==2)continue}}if(y===1){Fl(i,0),Mi(i,s,0,!0);break}e:{switch(m=i,N=y,N){case 0:case 1:throw Error(a(345));case 4:if((s&4194048)!==s)break;case 6:Mi(m,s,un,!ki);break e;case 2:Wr=null;break;case 3:case 5:break;default:throw Error(a(329))}if((s&62914560)===s&&(y=pd+300-Re(),10<y)){if(Mi(m,s,un,!ki),ul(m,0,!0)!==0)break e;Ga=s,m.timeoutHandle=YN(xN.bind(null,m,c,Wr,vd,rv,s,un,Es,Bl,ki,N,"Throttled",-0,0),y);break e}xN(m,c,Wr,vd,rv,s,un,Es,Bl,ki,N,null,-0,0)}}break}while(!0);ca(i)}function xN(i,s,c,m,y,N,z,q,G,se,ge,ye,le,fe){if(i.timeoutHandle=-1,ye=s.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:za},uN(s,N,ye);var Oe=(N&62914560)===N?pd-Re():(N&4194048)===N?pN-Re():0;if(Oe=Oq(ye,Oe),Oe!==null){Ga=N,i.cancelPendingCommit=Oe(CN.bind(null,i,s,N,c,m,y,z,q,G,ge,ye,null,le,fe)),Mi(i,N,z,!se);return}}CN(i,s,N,c,m,y,z,q,G)}function QT(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var m=0;m<c.length;m++){var y=c[m],N=y.getSnapshot;y=y.value;try{if(!an(N(),y))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Mi(i,s,c,m){s&=~tv,s&=~Es,i.suspendedLanes|=s,i.pingedLanes&=~s,m&&(i.warmLanes|=s),m=i.expirationTimes;for(var y=s;0<y;){var N=31-Ze(y),z=1<<N;m[N]=-1,y&=~z}c!==0&&dl(i,c,s)}function gd(){return(ft&6)===0?(oc(0),!1):!0}function sv(){if(tt!==null){if(vt===0)var i=tt.return;else i=tt,Pa=xs=null,_h(i),Pl=null,Go=0,i=tt;for(;i!==null;)K_(i.alternate,i),i=i.return;tt=null}}function Fl(i,s){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,fq(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),Ga=0,sv(),wt=i,tt=c=Oa(i.current,null),nt=s,vt=0,cn=null,ki=!1,$l=Hn(i,s),ev=!1,Bl=un=tv=Es=Oi=$t=0,Wr=sc=null,rv=!1,(s&8)!==0&&(s|=s&32);var m=i.entangledLanes;if(m!==0)for(i=i.entanglements,m&=s;0<m;){var y=31-Ze(m),N=1<<y;s|=i[y],m&=~N}return Fa=s,Iu(),c}function bN(i,s){Ye=null,T.H=Zo,s===Dl||s===Vu?(s=T0(),vt=3):s===uh?(s=T0(),vt=4):vt=s===Ih?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,cn=s,tt===null&&($t=1,sd(i,Nn(s,i.current)))}function yN(){var i=ln.current;return i===null?!0:(nt&4194048)===nt?En===null:(nt&62914560)===nt||(nt&536870912)!==0?i===En:!1}function jN(){var i=T.H;return T.H=Zo,i===null?Zo:i}function _N(){var i=T.A;return T.A=HT,i}function xd(){$t=4,ki||(nt&4194048)!==nt&&ln.current!==null||($l=!0),(Oi&134217727)===0&&(Es&134217727)===0||wt===null||Mi(wt,nt,un,!1)}function lv(i,s,c){var m=ft;ft|=2;var y=jN(),N=_N();(wt!==i||nt!==s)&&(vd=null,Fl(i,s)),s=!1;var z=$t;e:do try{if(vt!==0&&tt!==null){var q=tt,G=cn;switch(vt){case 8:sv(),z=6;break e;case 3:case 2:case 9:case 6:ln.current===null&&(s=!0);var se=vt;if(vt=0,cn=null,Gl(i,q,G,se),c&&$l){z=0;break e}break;default:se=vt,vt=0,cn=null,Gl(i,q,G,se)}}YT(),z=$t;break}catch(ge){bN(i,ge)}while(!0);return s&&i.shellSuspendCounter++,Pa=xs=null,ft=m,T.H=y,T.A=N,tt===null&&(wt=null,nt=0,Iu()),z}function YT(){for(;tt!==null;)NN(tt)}function KT(i,s){var c=ft;ft|=2;var m=jN(),y=_N();wt!==i||nt!==s?(vd=null,hd=Re()+500,Fl(i,s)):$l=Hn(i,s);e:do try{if(vt!==0&&tt!==null){s=tt;var N=cn;t:switch(vt){case 1:vt=0,cn=null,Gl(i,s,N,1);break;case 2:case 9:if(P0(N)){vt=0,cn=null,SN(s);break}s=function(){vt!==2&&vt!==9||wt!==i||(vt=7),ca(i)},N.then(s,s);break e;case 3:vt=7;break e;case 4:vt=5;break e;case 7:P0(N)?(vt=0,cn=null,SN(s)):(vt=0,cn=null,Gl(i,s,N,7));break;case 5:var z=null;switch(tt.tag){case 26:z=tt.memoizedState;case 5:case 27:var q=tt;if(z?c1(z):q.stateNode.complete){vt=0,cn=null;var G=q.sibling;if(G!==null)tt=G;else{var se=q.return;se!==null?(tt=se,bd(se)):tt=null}break t}}vt=0,cn=null,Gl(i,s,N,5);break;case 6:vt=0,cn=null,Gl(i,s,N,6);break;case 8:sv(),$t=6;break e;default:throw Error(a(462))}}WT();break}catch(ge){bN(i,ge)}while(!0);return Pa=xs=null,T.H=m,T.A=y,ft=c,tt!==null?0:(wt=null,nt=0,Iu(),$t)}function WT(){for(;tt!==null&&!pe();)NN(tt)}function NN(i){var s=Q_(i.alternate,i,Fa);i.memoizedProps=i.pendingProps,s===null?bd(i):tt=s}function SN(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=B_(c,s,s.pendingProps,s.type,void 0,nt);break;case 11:s=B_(c,s,s.pendingProps,s.type.render,s.ref,nt);break;case 5:_h(s);default:K_(c,s),s=tt=_0(s,Fa),s=Q_(c,s,Fa)}i.memoizedProps=i.pendingProps,s===null?bd(i):tt=s}function Gl(i,s,c,m){Pa=xs=null,_h(s),Pl=null,Go=0;var y=s.return;try{if(IT(i,y,s,c,nt)){$t=1,sd(i,Nn(c,i.current)),tt=null;return}}catch(N){if(y!==null)throw tt=y,N;$t=1,sd(i,Nn(c,i.current)),tt=null;return}s.flags&32768?(st||m===1?i=!0:$l||(nt&536870912)!==0?i=!1:(ki=i=!0,(m===2||m===9||m===3||m===6)&&(m=ln.current,m!==null&&m.tag===13&&(m.flags|=16384))),wN(s,i)):bd(s)}function bd(i){var s=i;do{if((s.flags&32768)!==0){wN(s,ki);return}i=s.return;var c=BT(s.alternate,s,Fa);if(c!==null){tt=c;return}if(s=s.sibling,s!==null){tt=s;return}tt=s=i}while(s!==null);$t===0&&($t=5)}function wN(i,s){do{var c=UT(i.alternate,i);if(c!==null){c.flags&=32767,tt=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){tt=i;return}tt=i=c}while(i!==null);$t=6,tt=null}function CN(i,s,c,m,y,N,z,q,G){i.cancelPendingCommit=null;do yd();while(ar!==0);if((ft&6)!==0)throw Error(a(327));if(s!==null){if(s===i.current)throw Error(a(177));if(N=s.lanes|s.childLanes,N|=Kp,bn(i,c,N,z,q,G),i===wt&&(tt=wt=null,nt=0),Ul=s,Pi=i,Ga=c,nv=N,av=y,hN=m,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,eq(nr,function(){return ON(),null})):(i.callbackNode=null,i.callbackPriority=0),m=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||m){m=T.T,T.T=null,y=F.p,F.p=2,z=ft,ft|=4;try{FT(i,s,c)}finally{ft=z,F.p=y,T.T=m}}ar=1,EN(),AN(),zN()}}function EN(){if(ar===1){ar=0;var i=Pi,s=Ul,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=T.T,T.T=null;var m=F.p;F.p=2;var y=ft;ft|=4;try{lN(s,i);var N=bv,z=f0(i.containerInfo),q=N.focusedElem,G=N.selectionRange;if(z!==q&&q&&q.ownerDocument&&m0(q.ownerDocument.documentElement,q)){if(G!==null&&Gp(q)){var se=G.start,ge=G.end;if(ge===void 0&&(ge=se),"selectionStart"in q)q.selectionStart=se,q.selectionEnd=Math.min(ge,q.value.length);else{var ye=q.ownerDocument||document,le=ye&&ye.defaultView||window;if(le.getSelection){var fe=le.getSelection(),Oe=q.textContent.length,Ge=Math.min(G.start,Oe),_t=G.end===void 0?Ge:Math.min(G.end,Oe);!fe.extend&&Ge>_t&&(z=_t,_t=Ge,Ge=z);var re=d0(q,Ge),W=d0(q,_t);if(re&&W&&(fe.rangeCount!==1||fe.anchorNode!==re.node||fe.anchorOffset!==re.offset||fe.focusNode!==W.node||fe.focusOffset!==W.offset)){var ie=ye.createRange();ie.setStart(re.node,re.offset),fe.removeAllRanges(),Ge>_t?(fe.addRange(ie),fe.extend(W.node,W.offset)):(ie.setEnd(W.node,W.offset),fe.addRange(ie))}}}}for(ye=[],fe=q;fe=fe.parentNode;)fe.nodeType===1&&ye.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof q.focus=="function"&&q.focus(),q=0;q<ye.length;q++){var be=ye[q];be.element.scrollLeft=be.left,be.element.scrollTop=be.top}}Dd=!!xv,bv=xv=null}finally{ft=y,F.p=m,T.T=c}}i.current=s,ar=2}}function AN(){if(ar===2){ar=0;var i=Pi,s=Ul,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=T.T,T.T=null;var m=F.p;F.p=2;var y=ft;ft|=4;try{rN(i,s.alternate,s)}finally{ft=y,F.p=m,T.T=c}}ar=3}}function zN(){if(ar===4||ar===3){ar=0,ze();var i=Pi,s=Ul,c=Ga,m=hN;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?ar=5:(ar=0,Ul=Pi=null,kN(i,i.pendingLanes));var y=i.pendingLanes;if(y===0&&(Di=null),wp(c),s=s.stateNode,ce&&typeof ce.onCommitFiberRoot=="function")try{ce.onCommitFiberRoot(J,s,void 0,(s.current.flags&128)===128)}catch{}if(m!==null){s=T.T,y=F.p,F.p=2,T.T=null;try{for(var N=i.onRecoverableError,z=0;z<m.length;z++){var q=m[z];N(q.value,{componentStack:q.stack})}}finally{T.T=s,F.p=y}}(Ga&3)!==0&&yd(),ca(i),y=i.pendingLanes,(c&261930)!==0&&(y&42)!==0?i===iv?lc++:(lc=0,iv=i):lc=0,oc(0)}}function kN(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Uo(s)))}function yd(){return EN(),AN(),zN(),ON()}function ON(){if(ar!==5)return!1;var i=Pi,s=nv;nv=0;var c=wp(Ga),m=T.T,y=F.p;try{F.p=32>c?32:c,T.T=null,c=av,av=null;var N=Pi,z=Ga;if(ar=0,Ul=Pi=null,Ga=0,(ft&6)!==0)throw Error(a(331));var q=ft;if(ft|=4,mN(N.current),cN(N,N.current,z,c),ft=q,oc(0,!1),ce&&typeof ce.onPostCommitFiberRoot=="function")try{ce.onPostCommitFiberRoot(J,N)}catch{}return!0}finally{F.p=y,T.T=m,kN(i,s)}}function DN(i,s,c){s=Nn(c,s),s=Rh(i.stateNode,s,2),i=Ci(i,s,2),i!==null&&(ht(i,2),ca(i))}function gt(i,s,c){if(i.tag===3)DN(i,i,c);else for(;s!==null;){if(s.tag===3){DN(s,i,c);break}else if(s.tag===1){var m=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Di===null||!Di.has(m))){i=Nn(c,i),c=P_(2),m=Ci(s,c,2),m!==null&&(M_(c,m,s,i),ht(m,2),ca(m));break}}s=s.return}}function ov(i,s,c){var m=i.pingCache;if(m===null){m=i.pingCache=new VT;var y=new Set;m.set(s,y)}else y=m.get(s),y===void 0&&(y=new Set,m.set(s,y));y.has(c)||(ev=!0,y.add(c),i=XT.bind(null,i,s,c),s.then(i,i))}function XT(i,s,c){var m=i.pingCache;m!==null&&m.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,wt===i&&(nt&c)===c&&($t===4||$t===3&&(nt&62914560)===nt&&300>Re()-pd?(ft&2)===0&&Fl(i,0):tv|=c,Bl===nt&&(Bl=0)),ca(i)}function PN(i,s){s===0&&(s=te()),i=hs(i,s),i!==null&&(ht(i,s),ca(i))}function ZT(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),PN(i,c)}function JT(i,s){var c=0;switch(i.tag){case 31:case 13:var m=i.stateNode,y=i.memoizedState;y!==null&&(c=y.retryLane);break;case 19:m=i.stateNode;break;case 22:m=i.stateNode._retryCache;break;default:throw Error(a(314))}m!==null&&m.delete(s),PN(i,c)}function eq(i,s){return cr(i,s)}var jd=null,Hl=null,cv=!1,_d=!1,uv=!1,Ti=0;function ca(i){i!==Hl&&i.next===null&&(Hl===null?jd=Hl=i:Hl=Hl.next=i),_d=!0,cv||(cv=!0,rq())}function oc(i,s){if(!uv&&_d){uv=!0;do for(var c=!1,m=jd;m!==null;){if(i!==0){var y=m.pendingLanes;if(y===0)var N=0;else{var z=m.suspendedLanes,q=m.pingedLanes;N=(1<<31-Ze(42|i)+1)-1,N&=y&~(z&~q),N=N&201326741?N&201326741|1:N?N|2:0}N!==0&&(c=!0,RN(m,N))}else N=nt,N=ul(m,m===wt?N:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(N&3)===0||Hn(m,N)||(c=!0,RN(m,N));m=m.next}while(c);uv=!1}}function tq(){MN()}function MN(){_d=cv=!1;var i=0;Ti!==0&&mq()&&(i=Ti);for(var s=Re(),c=null,m=jd;m!==null;){var y=m.next,N=TN(m,s);N===0?(m.next=null,c===null?jd=y:c.next=y,y===null&&(Hl=c)):(c=m,(i!==0||(N&3)!==0)&&(_d=!0)),m=y}ar!==0&&ar!==5||oc(i),Ti!==0&&(Ti=0)}function TN(i,s){for(var c=i.suspendedLanes,m=i.pingedLanes,y=i.expirationTimes,N=i.pendingLanes&-62914561;0<N;){var z=31-Ze(N),q=1<<z,G=y[z];G===-1?((q&c)===0||(q&m)!==0)&&(y[z]=Np(q,s)):G<=s&&(i.expiredLanes|=q),N&=~q}if(s=wt,c=nt,c=ul(i,i===s?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),m=i.callbackNode,c===0||i===s&&(vt===2||vt===9)||i.cancelPendingCommit!==null)return m!==null&&m!==null&&nn(m),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||Hn(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(m!==null&&nn(m),wp(c)){case 2:case 8:c=It;break;case 32:c=nr;break;case 268435456:c=ee;break;default:c=nr}return m=qN.bind(null,i),c=cr(c,m),i.callbackPriority=s,i.callbackNode=c,s}return m!==null&&m!==null&&nn(m),i.callbackPriority=2,i.callbackNode=null,2}function qN(i,s){if(ar!==0&&ar!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(yd()&&i.callbackNode!==c)return null;var m=nt;return m=ul(i,i===wt?m:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),m===0?null:(gN(i,m,s),TN(i,Re()),i.callbackNode!=null&&i.callbackNode===c?qN.bind(null,i):null)}function RN(i,s){if(yd())return null;gN(i,s,!0)}function rq(){pq(function(){(ft&6)!==0?cr(pt,tq):MN()})}function dv(){if(Ti===0){var i=kl;i===0&&(i=ia,ia<<=1,(ia&261888)===0&&(ia=256)),Ti=i}return Ti}function IN(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:ku(""+i)}function LN(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function nq(i,s,c,m,y){if(s==="submit"&&c&&c.stateNode===y){var N=IN((y[Hr]||null).action),z=m.submitter;z&&(s=(s=z[Hr]||null)?IN(s.formAction):z.getAttribute("formAction"),s!==null&&(N=s,z=null));var q=new Mu("action","action",null,m,y);i.push({event:q,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Ti!==0){var G=z?LN(y,z):new FormData(y);Oh(c,{pending:!0,data:G,method:y.method,action:N},null,G)}}else typeof N=="function"&&(q.preventDefault(),G=z?LN(y,z):new FormData(y),Oh(c,{pending:!0,data:G,method:y.method,action:N},N,G))},currentTarget:y}]})}}for(var mv=0;mv<Yp.length;mv++){var fv=Yp[mv],aq=fv.toLowerCase(),iq=fv[0].toUpperCase()+fv.slice(1);Vn(aq,"on"+iq)}Vn(v0,"onAnimationEnd"),Vn(g0,"onAnimationIteration"),Vn(x0,"onAnimationStart"),Vn("dblclick","onDoubleClick"),Vn("focusin","onFocus"),Vn("focusout","onBlur"),Vn(jT,"onTransitionRun"),Vn(_T,"onTransitionStart"),Vn(NT,"onTransitionCancel"),Vn(b0,"onTransitionEnd"),vl("onMouseEnter",["mouseout","mouseover"]),vl("onMouseLeave",["mouseout","mouseover"]),vl("onPointerEnter",["pointerout","pointerover"]),vl("onPointerLeave",["pointerout","pointerover"]),ds("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ds("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ds("onBeforeInput",["compositionend","keypress","textInput","paste"]),ds("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ds("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ds("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sq=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cc));function $N(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var m=i[c],y=m.event;m=m.listeners;e:{var N=void 0;if(s)for(var z=m.length-1;0<=z;z--){var q=m[z],G=q.instance,se=q.currentTarget;if(q=q.listener,G!==N&&y.isPropagationStopped())break e;N=q,y.currentTarget=se;try{N(y)}catch(ge){Ru(ge)}y.currentTarget=null,N=G}else for(z=0;z<m.length;z++){if(q=m[z],G=q.instance,se=q.currentTarget,q=q.listener,G!==N&&y.isPropagationStopped())break e;N=q,y.currentTarget=se;try{N(y)}catch(ge){Ru(ge)}y.currentTarget=null,N=G}}}}function rt(i,s){var c=s[Cp];c===void 0&&(c=s[Cp]=new Set);var m=i+"__bubble";c.has(m)||(BN(s,i,2,!1),c.add(m))}function pv(i,s,c){var m=0;s&&(m|=4),BN(c,i,m,s)}var Nd="_reactListening"+Math.random().toString(36).slice(2);function hv(i){if(!i[Nd]){i[Nd]=!0,Mj.forEach(function(c){c!=="selectionchange"&&(sq.has(c)||pv(c,!1,i),pv(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Nd]||(s[Nd]=!0,pv("selectionchange",!1,s))}}function BN(i,s,c,m){switch(v1(s)){case 2:var y=Mq;break;case 8:y=Tq;break;default:y=kv}c=y.bind(null,s,c,i),y=void 0,!Tp||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(y=!0),m?y!==void 0?i.addEventListener(s,c,{capture:!0,passive:y}):i.addEventListener(s,c,!0):y!==void 0?i.addEventListener(s,c,{passive:y}):i.addEventListener(s,c,!1)}function vv(i,s,c,m,y){var N=m;if((s&1)===0&&(s&2)===0&&m!==null)e:for(;;){if(m===null)return;var z=m.tag;if(z===3||z===4){var q=m.stateNode.containerInfo;if(q===y)break;if(z===4)for(z=m.return;z!==null;){var G=z.tag;if((G===3||G===4)&&z.stateNode.containerInfo===y)return;z=z.return}for(;q!==null;){if(z=fl(q),z===null)return;if(G=z.tag,G===5||G===6||G===26||G===27){m=N=z;continue e}q=q.parentNode}}m=m.return}Vj(function(){var se=N,ge=Pp(c),ye=[];e:{var le=y0.get(i);if(le!==void 0){var fe=Mu,Oe=i;switch(i){case"keypress":if(Du(c)===0)break e;case"keydown":case"keyup":fe=JM;break;case"focusin":Oe="focus",fe=Lp;break;case"focusout":Oe="blur",fe=Lp;break;case"beforeblur":case"afterblur":fe=Lp;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=Kj;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=BM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=rT;break;case v0:case g0:case x0:fe=GM;break;case b0:fe=aT;break;case"scroll":case"scrollend":fe=LM;break;case"wheel":fe=sT;break;case"copy":case"cut":case"paste":fe=VM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=Xj;break;case"toggle":case"beforetoggle":fe=oT}var Ge=(s&4)!==0,_t=!Ge&&(i==="scroll"||i==="scrollend"),re=Ge?le!==null?le+"Capture":null:le;Ge=[];for(var W=se,ie;W!==null;){var be=W;if(ie=be.stateNode,be=be.tag,be!==5&&be!==26&&be!==27||ie===null||re===null||(be=Oo(W,re),be!=null&&Ge.push(uc(W,be,ie))),_t)break;W=W.return}0<Ge.length&&(le=new fe(le,Oe,null,c,ge),ye.push({event:le,listeners:Ge}))}}if((s&7)===0){e:{if(le=i==="mouseover"||i==="pointerover",fe=i==="mouseout"||i==="pointerout",le&&c!==Dp&&(Oe=c.relatedTarget||c.fromElement)&&(fl(Oe)||Oe[ml]))break e;if((fe||le)&&(le=ge.window===ge?ge:(le=ge.ownerDocument)?le.defaultView||le.parentWindow:window,fe?(Oe=c.relatedTarget||c.toElement,fe=se,Oe=Oe?fl(Oe):null,Oe!==null&&(_t=o(Oe),Ge=Oe.tag,Oe!==_t||Ge!==5&&Ge!==27&&Ge!==6)&&(Oe=null)):(fe=null,Oe=se),fe!==Oe)){if(Ge=Kj,be="onMouseLeave",re="onMouseEnter",W="mouse",(i==="pointerout"||i==="pointerover")&&(Ge=Xj,be="onPointerLeave",re="onPointerEnter",W="pointer"),_t=fe==null?le:ko(fe),ie=Oe==null?le:ko(Oe),le=new Ge(be,W+"leave",fe,c,ge),le.target=_t,le.relatedTarget=ie,be=null,fl(ge)===se&&(Ge=new Ge(re,W+"enter",Oe,c,ge),Ge.target=ie,Ge.relatedTarget=_t,be=Ge),_t=be,fe&&Oe)t:{for(Ge=lq,re=fe,W=Oe,ie=0,be=re;be;be=Ge(be))ie++;be=0;for(var Be=W;Be;Be=Ge(Be))be++;for(;0<ie-be;)re=Ge(re),ie--;for(;0<be-ie;)W=Ge(W),be--;for(;ie--;){if(re===W||W!==null&&re===W.alternate){Ge=re;break t}re=Ge(re),W=Ge(W)}Ge=null}else Ge=null;fe!==null&&UN(ye,le,fe,Ge,!1),Oe!==null&&_t!==null&&UN(ye,_t,Oe,Ge,!0)}}e:{if(le=se?ko(se):window,fe=le.nodeName&&le.nodeName.toLowerCase(),fe==="select"||fe==="input"&&le.type==="file")var ut=i0;else if(n0(le))if(s0)ut=xT;else{ut=vT;var Te=hT}else fe=le.nodeName,!fe||fe.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?se&&Op(se.elementType)&&(ut=i0):ut=gT;if(ut&&(ut=ut(i,se))){a0(ye,ut,c,ge);break e}Te&&Te(i,le,se),i==="focusout"&&se&&le.type==="number"&&se.memoizedProps.value!=null&&kp(le,"number",le.value)}switch(Te=se?ko(se):window,i){case"focusin":(n0(Te)||Te.contentEditable==="true")&&(_l=Te,Hp=se,Lo=null);break;case"focusout":Lo=Hp=_l=null;break;case"mousedown":Vp=!0;break;case"contextmenu":case"mouseup":case"dragend":Vp=!1,p0(ye,c,ge);break;case"selectionchange":if(yT)break;case"keydown":case"keyup":p0(ye,c,ge)}var We;if(Bp)e:{switch(i){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else jl?t0(i,c)&&(at="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(at="onCompositionStart");at&&(Zj&&c.locale!=="ko"&&(jl||at!=="onCompositionStart"?at==="onCompositionEnd"&&jl&&(We=Qj()):(bi=ge,qp="value"in bi?bi.value:bi.textContent,jl=!0)),Te=Sd(se,at),0<Te.length&&(at=new Wj(at,i,null,c,ge),ye.push({event:at,listeners:Te}),We?at.data=We:(We=r0(c),We!==null&&(at.data=We)))),(We=uT?dT(i,c):mT(i,c))&&(at=Sd(se,"onBeforeInput"),0<at.length&&(Te=new Wj("onBeforeInput","beforeinput",null,c,ge),ye.push({event:Te,listeners:at}),Te.data=We)),nq(ye,i,se,c,ge)}$N(ye,s)})}function uc(i,s,c){return{instance:i,listener:s,currentTarget:c}}function Sd(i,s){for(var c=s+"Capture",m=[];i!==null;){var y=i,N=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||N===null||(y=Oo(i,c),y!=null&&m.unshift(uc(i,y,N)),y=Oo(i,s),y!=null&&m.push(uc(i,y,N))),i.tag===3)return m;i=i.return}return[]}function lq(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function UN(i,s,c,m,y){for(var N=s._reactName,z=[];c!==null&&c!==m;){var q=c,G=q.alternate,se=q.stateNode;if(q=q.tag,G!==null&&G===m)break;q!==5&&q!==26&&q!==27||se===null||(G=se,y?(se=Oo(c,N),se!=null&&z.unshift(uc(c,se,G))):y||(se=Oo(c,N),se!=null&&z.push(uc(c,se,G)))),c=c.return}z.length!==0&&i.push({event:s,listeners:z})}var oq=/\r\n?/g,cq=/\u0000|\uFFFD/g;function FN(i){return(typeof i=="string"?i:""+i).replace(oq,`
`).replace(cq,"")}function GN(i,s){return s=FN(s),FN(i)===s}function jt(i,s,c,m,y,N){switch(c){case"children":typeof m=="string"?s==="body"||s==="textarea"&&m===""||xl(i,m):(typeof m=="number"||typeof m=="bigint")&&s!=="body"&&xl(i,""+m);break;case"className":Au(i,"class",m);break;case"tabIndex":Au(i,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Au(i,c,m);break;case"style":Gj(i,m,N);break;case"data":if(s!=="object"){Au(i,"data",m);break}case"src":case"href":if(m===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){i.removeAttribute(c);break}m=ku(""+m),i.setAttribute(c,m);break;case"action":case"formAction":if(typeof m=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof N=="function"&&(c==="formAction"?(s!=="input"&&jt(i,s,"name",y.name,y,null),jt(i,s,"formEncType",y.formEncType,y,null),jt(i,s,"formMethod",y.formMethod,y,null),jt(i,s,"formTarget",y.formTarget,y,null)):(jt(i,s,"encType",y.encType,y,null),jt(i,s,"method",y.method,y,null),jt(i,s,"target",y.target,y,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){i.removeAttribute(c);break}m=ku(""+m),i.setAttribute(c,m);break;case"onClick":m!=null&&(i.onclick=za);break;case"onScroll":m!=null&&rt("scroll",i);break;case"onScrollEnd":m!=null&&rt("scrollend",i);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(a(61));if(c=m.__html,c!=null){if(y.children!=null)throw Error(a(60));i.innerHTML=c}}break;case"multiple":i.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":i.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){i.removeAttribute("xlink:href");break}c=ku(""+m),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(c,""+m):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":m===!0?i.setAttribute(c,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(c,m):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?i.setAttribute(c,m):i.removeAttribute(c);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?i.removeAttribute(c):i.setAttribute(c,m);break;case"popover":rt("beforetoggle",i),rt("toggle",i),Eu(i,"popover",m);break;case"xlinkActuate":Aa(i,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":Aa(i,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":Aa(i,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":Aa(i,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":Aa(i,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":Aa(i,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":Aa(i,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":Aa(i,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":Aa(i,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":Eu(i,"is",m);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=RM.get(c)||c,Eu(i,c,m))}}function gv(i,s,c,m,y,N){switch(c){case"style":Gj(i,m,N);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(a(61));if(c=m.__html,c!=null){if(y.children!=null)throw Error(a(60));i.innerHTML=c}}break;case"children":typeof m=="string"?xl(i,m):(typeof m=="number"||typeof m=="bigint")&&xl(i,""+m);break;case"onScroll":m!=null&&rt("scroll",i);break;case"onScrollEnd":m!=null&&rt("scrollend",i);break;case"onClick":m!=null&&(i.onclick=za);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Tj.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(y=c.endsWith("Capture"),s=c.slice(2,y?c.length-7:void 0),N=i[Hr]||null,N=N!=null?N[c]:null,typeof N=="function"&&i.removeEventListener(s,N,y),typeof m=="function")){typeof N!="function"&&N!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,m,y);break e}c in i?i[c]=m:m===!0?i.setAttribute(c,""):Eu(i,c,m)}}}function Cr(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":rt("error",i),rt("load",i);var m=!1,y=!1,N;for(N in c)if(c.hasOwnProperty(N)){var z=c[N];if(z!=null)switch(N){case"src":m=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:jt(i,s,N,z,c,null)}}y&&jt(i,s,"srcSet",c.srcSet,c,null),m&&jt(i,s,"src",c.src,c,null);return;case"input":rt("invalid",i);var q=N=z=y=null,G=null,se=null;for(m in c)if(c.hasOwnProperty(m)){var ge=c[m];if(ge!=null)switch(m){case"name":y=ge;break;case"type":z=ge;break;case"checked":G=ge;break;case"defaultChecked":se=ge;break;case"value":N=ge;break;case"defaultValue":q=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(a(137,s));break;default:jt(i,s,m,ge,c,null)}}$j(i,N,q,G,se,z,y,!1);return;case"select":rt("invalid",i),m=z=N=null;for(y in c)if(c.hasOwnProperty(y)&&(q=c[y],q!=null))switch(y){case"value":N=q;break;case"defaultValue":z=q;break;case"multiple":m=q;default:jt(i,s,y,q,c,null)}s=N,c=z,i.multiple=!!m,s!=null?gl(i,!!m,s,!1):c!=null&&gl(i,!!m,c,!0);return;case"textarea":rt("invalid",i),N=y=m=null;for(z in c)if(c.hasOwnProperty(z)&&(q=c[z],q!=null))switch(z){case"value":m=q;break;case"defaultValue":y=q;break;case"children":N=q;break;case"dangerouslySetInnerHTML":if(q!=null)throw Error(a(91));break;default:jt(i,s,z,q,c,null)}Uj(i,m,y,N);return;case"option":for(G in c)c.hasOwnProperty(G)&&(m=c[G],m!=null)&&(G==="selected"?i.selected=m&&typeof m!="function"&&typeof m!="symbol":jt(i,s,G,m,c,null));return;case"dialog":rt("beforetoggle",i),rt("toggle",i),rt("cancel",i),rt("close",i);break;case"iframe":case"object":rt("load",i);break;case"video":case"audio":for(m=0;m<cc.length;m++)rt(cc[m],i);break;case"image":rt("error",i),rt("load",i);break;case"details":rt("toggle",i);break;case"embed":case"source":case"link":rt("error",i),rt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in c)if(c.hasOwnProperty(se)&&(m=c[se],m!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:jt(i,s,se,m,c,null)}return;default:if(Op(s)){for(ge in c)c.hasOwnProperty(ge)&&(m=c[ge],m!==void 0&&gv(i,s,ge,m,c,void 0));return}}for(q in c)c.hasOwnProperty(q)&&(m=c[q],m!=null&&jt(i,s,q,m,c,null))}function uq(i,s,c,m){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,N=null,z=null,q=null,G=null,se=null,ge=null;for(fe in c){var ye=c[fe];if(c.hasOwnProperty(fe)&&ye!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":G=ye;default:m.hasOwnProperty(fe)||jt(i,s,fe,null,m,ye)}}for(var le in m){var fe=m[le];if(ye=c[le],m.hasOwnProperty(le)&&(fe!=null||ye!=null))switch(le){case"type":N=fe;break;case"name":y=fe;break;case"checked":se=fe;break;case"defaultChecked":ge=fe;break;case"value":z=fe;break;case"defaultValue":q=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(a(137,s));break;default:fe!==ye&&jt(i,s,le,fe,m,ye)}}zp(i,z,q,G,se,ge,N,y);return;case"select":fe=z=q=le=null;for(N in c)if(G=c[N],c.hasOwnProperty(N)&&G!=null)switch(N){case"value":break;case"multiple":fe=G;default:m.hasOwnProperty(N)||jt(i,s,N,null,m,G)}for(y in m)if(N=m[y],G=c[y],m.hasOwnProperty(y)&&(N!=null||G!=null))switch(y){case"value":le=N;break;case"defaultValue":q=N;break;case"multiple":z=N;default:N!==G&&jt(i,s,y,N,m,G)}s=q,c=z,m=fe,le!=null?gl(i,!!c,le,!1):!!m!=!!c&&(s!=null?gl(i,!!c,s,!0):gl(i,!!c,c?[]:"",!1));return;case"textarea":fe=le=null;for(q in c)if(y=c[q],c.hasOwnProperty(q)&&y!=null&&!m.hasOwnProperty(q))switch(q){case"value":break;case"children":break;default:jt(i,s,q,null,m,y)}for(z in m)if(y=m[z],N=c[z],m.hasOwnProperty(z)&&(y!=null||N!=null))switch(z){case"value":le=y;break;case"defaultValue":fe=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(a(91));break;default:y!==N&&jt(i,s,z,y,m,N)}Bj(i,le,fe);return;case"option":for(var Oe in c)le=c[Oe],c.hasOwnProperty(Oe)&&le!=null&&!m.hasOwnProperty(Oe)&&(Oe==="selected"?i.selected=!1:jt(i,s,Oe,null,m,le));for(G in m)le=m[G],fe=c[G],m.hasOwnProperty(G)&&le!==fe&&(le!=null||fe!=null)&&(G==="selected"?i.selected=le&&typeof le!="function"&&typeof le!="symbol":jt(i,s,G,le,m,fe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ge in c)le=c[Ge],c.hasOwnProperty(Ge)&&le!=null&&!m.hasOwnProperty(Ge)&&jt(i,s,Ge,null,m,le);for(se in m)if(le=m[se],fe=c[se],m.hasOwnProperty(se)&&le!==fe&&(le!=null||fe!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(a(137,s));break;default:jt(i,s,se,le,m,fe)}return;default:if(Op(s)){for(var _t in c)le=c[_t],c.hasOwnProperty(_t)&&le!==void 0&&!m.hasOwnProperty(_t)&&gv(i,s,_t,void 0,m,le);for(ge in m)le=m[ge],fe=c[ge],!m.hasOwnProperty(ge)||le===fe||le===void 0&&fe===void 0||gv(i,s,ge,le,m,fe);return}}for(var re in c)le=c[re],c.hasOwnProperty(re)&&le!=null&&!m.hasOwnProperty(re)&&jt(i,s,re,null,m,le);for(ye in m)le=m[ye],fe=c[ye],!m.hasOwnProperty(ye)||le===fe||le==null&&fe==null||jt(i,s,ye,le,m,fe)}function HN(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function dq(){if(typeof performance.getEntriesByType=="function"){for(var i=0,s=0,c=performance.getEntriesByType("resource"),m=0;m<c.length;m++){var y=c[m],N=y.transferSize,z=y.initiatorType,q=y.duration;if(N&&q&&HN(z)){for(z=0,q=y.responseEnd,m+=1;m<c.length;m++){var G=c[m],se=G.startTime;if(se>q)break;var ge=G.transferSize,ye=G.initiatorType;ge&&HN(ye)&&(G=G.responseEnd,z+=ge*(G<q?1:(q-se)/(G-se)))}if(--m,s+=8*(N+z)/(y.duration/1e3),i++,10<i)break}}if(0<i)return s/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var xv=null,bv=null;function wd(i){return i.nodeType===9?i:i.ownerDocument}function VN(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function QN(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function yv(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var jv=null;function mq(){var i=window.event;return i&&i.type==="popstate"?i===jv?!1:(jv=i,!0):(jv=null,!1)}var YN=typeof setTimeout=="function"?setTimeout:void 0,fq=typeof clearTimeout=="function"?clearTimeout:void 0,KN=typeof Promise=="function"?Promise:void 0,pq=typeof queueMicrotask=="function"?queueMicrotask:typeof KN<"u"?function(i){return KN.resolve(null).then(i).catch(hq)}:YN;function hq(i){setTimeout(function(){throw i})}function qi(i){return i==="head"}function WN(i,s){var c=s,m=0;do{var y=c.nextSibling;if(i.removeChild(c),y&&y.nodeType===8)if(c=y.data,c==="/$"||c==="/&"){if(m===0){i.removeChild(y),Kl(s);return}m--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")m++;else if(c==="html")dc(i.ownerDocument.documentElement);else if(c==="head"){c=i.ownerDocument.head,dc(c);for(var N=c.firstChild;N;){var z=N.nextSibling,q=N.nodeName;N[zo]||q==="SCRIPT"||q==="STYLE"||q==="LINK"&&N.rel.toLowerCase()==="stylesheet"||c.removeChild(N),N=z}}else c==="body"&&dc(i.ownerDocument.body);c=y}while(c);Kl(s)}function XN(i,s){var c=i;i=0;do{var m=c.nextSibling;if(c.nodeType===1?s?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(s?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(i===0)break;i--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||i++;c=m}while(c)}function _v(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":_v(c),Ep(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function vq(i,s,c,m){for(;i.nodeType===1;){var y=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!m&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(m){if(!i[zo])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(N=i.getAttribute("rel"),N==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(N!==y.rel||i.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||i.getAttribute("title")!==(y.title==null?null:y.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(N=i.getAttribute("src"),(N!==(y.src==null?null:y.src)||i.getAttribute("type")!==(y.type==null?null:y.type)||i.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&N&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var N=y.name==null?null:""+y.name;if(y.type==="hidden"&&i.getAttribute("name")===N)return i}else return i;if(i=An(i.nextSibling),i===null)break}return null}function gq(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=An(i.nextSibling),i===null))return null;return i}function ZN(i,s){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!s||(i=An(i.nextSibling),i===null))return null;return i}function Nv(i){return i.data==="$?"||i.data==="$~"}function Sv(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function xq(i,s){var c=i.ownerDocument;if(i.data==="$~")i._reactRetry=s;else if(i.data!=="$?"||c.readyState!=="loading")s();else{var m=function(){s(),c.removeEventListener("DOMContentLoaded",m)};c.addEventListener("DOMContentLoaded",m),i._reactRetry=m}}function An(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return i}var wv=null;function JN(i){i=i.nextSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"||c==="/&"){if(s===0)return An(i.nextSibling);s--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||s++}i=i.nextSibling}return null}function e1(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(s===0)return i;s--}else c!=="/$"&&c!=="/&"||s++}i=i.previousSibling}return null}function t1(i,s,c){switch(s=wd(c),i){case"html":if(i=s.documentElement,!i)throw Error(a(452));return i;case"head":if(i=s.head,!i)throw Error(a(453));return i;case"body":if(i=s.body,!i)throw Error(a(454));return i;default:throw Error(a(451))}}function dc(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);Ep(i)}var zn=new Map,r1=new Set;function Cd(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ha=F.d;F.d={f:bq,r:yq,D:jq,C:_q,L:Nq,m:Sq,X:Cq,S:wq,M:Eq};function bq(){var i=Ha.f(),s=gd();return i||s}function yq(i){var s=pl(i);s!==null&&s.tag===5&&s.type==="form"?b_(s):Ha.r(i)}var Vl=typeof document>"u"?null:document;function n1(i,s,c){var m=Vl;if(m&&typeof s=="string"&&s){var y=jn(s);y='link[rel="'+i+'"][href="'+y+'"]',typeof c=="string"&&(y+='[crossorigin="'+c+'"]'),r1.has(y)||(r1.add(y),i={rel:i,crossOrigin:c,href:s},m.querySelector(y)===null&&(s=m.createElement("link"),Cr(s,"link",i),ur(s),m.head.appendChild(s)))}}function jq(i){Ha.D(i),n1("dns-prefetch",i,null)}function _q(i,s){Ha.C(i,s),n1("preconnect",i,s)}function Nq(i,s,c){Ha.L(i,s,c);var m=Vl;if(m&&i&&s){var y='link[rel="preload"][as="'+jn(s)+'"]';s==="image"&&c&&c.imageSrcSet?(y+='[imagesrcset="'+jn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(y+='[imagesizes="'+jn(c.imageSizes)+'"]')):y+='[href="'+jn(i)+'"]';var N=y;switch(s){case"style":N=Ql(i);break;case"script":N=Yl(i)}zn.has(N)||(i=v({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),zn.set(N,i),m.querySelector(y)!==null||s==="style"&&m.querySelector(mc(N))||s==="script"&&m.querySelector(fc(N))||(s=m.createElement("link"),Cr(s,"link",i),ur(s),m.head.appendChild(s)))}}function Sq(i,s){Ha.m(i,s);var c=Vl;if(c&&i){var m=s&&typeof s.as=="string"?s.as:"script",y='link[rel="modulepreload"][as="'+jn(m)+'"][href="'+jn(i)+'"]',N=y;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":N=Yl(i)}if(!zn.has(N)&&(i=v({rel:"modulepreload",href:i},s),zn.set(N,i),c.querySelector(y)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(fc(N)))return}m=c.createElement("link"),Cr(m,"link",i),ur(m),c.head.appendChild(m)}}}function wq(i,s,c){Ha.S(i,s,c);var m=Vl;if(m&&i){var y=hl(m).hoistableStyles,N=Ql(i);s=s||"default";var z=y.get(N);if(!z){var q={loading:0,preload:null};if(z=m.querySelector(mc(N)))q.loading=5;else{i=v({rel:"stylesheet",href:i,"data-precedence":s},c),(c=zn.get(N))&&Cv(i,c);var G=z=m.createElement("link");ur(G),Cr(G,"link",i),G._p=new Promise(function(se,ge){G.onload=se,G.onerror=ge}),G.addEventListener("load",function(){q.loading|=1}),G.addEventListener("error",function(){q.loading|=2}),q.loading|=4,Ed(z,s,m)}z={type:"stylesheet",instance:z,count:1,state:q},y.set(N,z)}}}function Cq(i,s){Ha.X(i,s);var c=Vl;if(c&&i){var m=hl(c).hoistableScripts,y=Yl(i),N=m.get(y);N||(N=c.querySelector(fc(y)),N||(i=v({src:i,async:!0},s),(s=zn.get(y))&&Ev(i,s),N=c.createElement("script"),ur(N),Cr(N,"link",i),c.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},m.set(y,N))}}function Eq(i,s){Ha.M(i,s);var c=Vl;if(c&&i){var m=hl(c).hoistableScripts,y=Yl(i),N=m.get(y);N||(N=c.querySelector(fc(y)),N||(i=v({src:i,async:!0,type:"module"},s),(s=zn.get(y))&&Ev(i,s),N=c.createElement("script"),ur(N),Cr(N,"link",i),c.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},m.set(y,N))}}function a1(i,s,c,m){var y=(y=H.current)?Cd(y):null;if(!y)throw Error(a(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Ql(c.href),c=hl(y).hoistableStyles,m=c.get(s),m||(m={type:"style",instance:null,count:0,state:null},c.set(s,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Ql(c.href);var N=hl(y).hoistableStyles,z=N.get(i);if(z||(y=y.ownerDocument||y,z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},N.set(i,z),(N=y.querySelector(mc(i)))&&!N._p&&(z.instance=N,z.state.loading=5),zn.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},zn.set(i,c),N||Aq(y,i,c,z.state))),s&&m===null)throw Error(a(528,""));return z}if(s&&m!==null)throw Error(a(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Yl(c),c=hl(y).hoistableScripts,m=c.get(s),m||(m={type:"script",instance:null,count:0,state:null},c.set(s,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,i))}}function Ql(i){return'href="'+jn(i)+'"'}function mc(i){return'link[rel="stylesheet"]['+i+"]"}function i1(i){return v({},i,{"data-precedence":i.precedence,precedence:null})}function Aq(i,s,c,m){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?m.loading=1:(s=i.createElement("link"),m.preload=s,s.addEventListener("load",function(){return m.loading|=1}),s.addEventListener("error",function(){return m.loading|=2}),Cr(s,"link",c),ur(s),i.head.appendChild(s))}function Yl(i){return'[src="'+jn(i)+'"]'}function fc(i){return"script[async]"+i}function s1(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var m=i.querySelector('style[data-href~="'+jn(c.href)+'"]');if(m)return s.instance=m,ur(m),m;var y=v({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return m=(i.ownerDocument||i).createElement("style"),ur(m),Cr(m,"style",y),Ed(m,c.precedence,i),s.instance=m;case"stylesheet":y=Ql(c.href);var N=i.querySelector(mc(y));if(N)return s.state.loading|=4,s.instance=N,ur(N),N;m=i1(c),(y=zn.get(y))&&Cv(m,y),N=(i.ownerDocument||i).createElement("link"),ur(N);var z=N;return z._p=new Promise(function(q,G){z.onload=q,z.onerror=G}),Cr(N,"link",m),s.state.loading|=4,Ed(N,c.precedence,i),s.instance=N;case"script":return N=Yl(c.src),(y=i.querySelector(fc(N)))?(s.instance=y,ur(y),y):(m=c,(y=zn.get(N))&&(m=v({},c),Ev(m,y)),i=i.ownerDocument||i,y=i.createElement("script"),ur(y),Cr(y,"link",m),i.head.appendChild(y),s.instance=y);case"void":return null;default:throw Error(a(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(m=s.instance,s.state.loading|=4,Ed(m,c.precedence,i));return s.instance}function Ed(i,s,c){for(var m=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=m.length?m[m.length-1]:null,N=y,z=0;z<m.length;z++){var q=m[z];if(q.dataset.precedence===s)N=q;else if(N!==y)break}N?N.parentNode.insertBefore(i,N.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function Cv(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function Ev(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var Ad=null;function l1(i,s,c){if(Ad===null){var m=new Map,y=Ad=new Map;y.set(c,m)}else y=Ad,m=y.get(c),m||(m=new Map,y.set(c,m));if(m.has(i))return m;for(m.set(i,null),c=c.getElementsByTagName(i),y=0;y<c.length;y++){var N=c[y];if(!(N[zo]||N[_r]||i==="link"&&N.getAttribute("rel")==="stylesheet")&&N.namespaceURI!=="http://www.w3.org/2000/svg"){var z=N.getAttribute(s)||"";z=i+z;var q=m.get(z);q?q.push(N):m.set(z,[N])}}return m}function o1(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function zq(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(i=s.disabled,typeof s.precedence=="string"&&i==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function c1(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function kq(i,s,c,m){if(c.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var y=Ql(m.href),N=s.querySelector(mc(y));if(N){s=N._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(i.count++,i=zd.bind(i),s.then(i,i)),c.state.loading|=4,c.instance=N,ur(N);return}N=s.ownerDocument||s,m=i1(m),(y=zn.get(y))&&Cv(m,y),N=N.createElement("link"),ur(N);var z=N;z._p=new Promise(function(q,G){z.onload=q,z.onerror=G}),Cr(N,"link",m),c.instance=N}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(i.count++,c=zd.bind(i),s.addEventListener("load",c),s.addEventListener("error",c))}}var Av=0;function Oq(i,s){return i.stylesheets&&i.count===0&&Od(i,i.stylesheets),0<i.count||0<i.imgCount?function(c){var m=setTimeout(function(){if(i.stylesheets&&Od(i,i.stylesheets),i.unsuspend){var N=i.unsuspend;i.unsuspend=null,N()}},6e4+s);0<i.imgBytes&&Av===0&&(Av=62500*dq());var y=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Od(i,i.stylesheets),i.unsuspend)){var N=i.unsuspend;i.unsuspend=null,N()}},(i.imgBytes>Av?50:800)+s);return i.unsuspend=c,function(){i.unsuspend=null,clearTimeout(m),clearTimeout(y)}}:null}function zd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Od(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var kd=null;function Od(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,kd=new Map,s.forEach(Dq,i),kd=null,zd.call(i))}function Dq(i,s){if(!(s.state.loading&4)){var c=kd.get(i);if(c)var m=c.get(null);else{c=new Map,kd.set(i,c);for(var y=i.querySelectorAll("link[data-precedence],style[data-precedence]"),N=0;N<y.length;N++){var z=y[N];(z.nodeName==="LINK"||z.getAttribute("media")!=="not all")&&(c.set(z.dataset.precedence,z),m=z)}m&&c.set(null,m)}y=s.instance,z=y.getAttribute("data-precedence"),N=c.get(z)||m,N===m&&c.set(null,y),c.set(z,y),this.count++,m=zd.bind(this),y.addEventListener("load",m),y.addEventListener("error",m),N?N.parentNode.insertBefore(y,N.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(y,i.firstChild)),s.state.loading|=4}}var pc={$$typeof:S,Provider:null,Consumer:null,_currentValue:I,_currentValue2:I,_threadCount:0};function Pq(i,s,c,m,y,N,z,q,G){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ue(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ue(0),this.hiddenUpdates=Ue(null),this.identifierPrefix=m,this.onUncaughtError=y,this.onCaughtError=N,this.onRecoverableError=z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function u1(i,s,c,m,y,N,z,q,G,se,ge,ye){return i=new Pq(i,s,c,z,G,se,ge,ye,q),s=1,N===!0&&(s|=24),N=sn(3,null,null,s),i.current=N,N.stateNode=i,s=lh(),s.refCount++,i.pooledCache=s,s.refCount++,N.memoizedState={element:m,isDehydrated:c,cache:s},dh(N),i}function d1(i){return i?(i=wl,i):wl}function m1(i,s,c,m,y,N){y=d1(y),m.context===null?m.context=y:m.pendingContext=y,m=wi(s),m.payload={element:c},N=N===void 0?null:N,N!==null&&(m.callback=N),c=Ci(i,m,s),c!==null&&(Xr(c,i,s),Vo(c,i,s))}function f1(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function zv(i,s){f1(i,s),(i=i.alternate)&&f1(i,s)}function p1(i){if(i.tag===13||i.tag===31){var s=hs(i,67108864);s!==null&&Xr(s,i,67108864),zv(i,67108864)}}function h1(i){if(i.tag===13||i.tag===31){var s=dn();s=Sp(s);var c=hs(i,s);c!==null&&Xr(c,i,s),zv(i,s)}}var Dd=!0;function Mq(i,s,c,m){var y=T.T;T.T=null;var N=F.p;try{F.p=2,kv(i,s,c,m)}finally{F.p=N,T.T=y}}function Tq(i,s,c,m){var y=T.T;T.T=null;var N=F.p;try{F.p=8,kv(i,s,c,m)}finally{F.p=N,T.T=y}}function kv(i,s,c,m){if(Dd){var y=Ov(m);if(y===null)vv(i,s,m,Pd,c),g1(i,m);else if(Rq(y,i,s,c,m))m.stopPropagation();else if(g1(i,m),s&4&&-1<qq.indexOf(i)){for(;y!==null;){var N=pl(y);if(N!==null)switch(N.tag){case 3:if(N=N.stateNode,N.current.memoizedState.isDehydrated){var z=Ea(N.pendingLanes);if(z!==0){var q=N;for(q.pendingLanes|=2,q.entangledLanes|=2;z;){var G=1<<31-Ze(z);q.entanglements[1]|=G,z&=~G}ca(N),(ft&6)===0&&(hd=Re()+500,oc(0))}}break;case 31:case 13:q=hs(N,2),q!==null&&Xr(q,N,2),gd(),zv(N,2)}if(N=Ov(m),N===null&&vv(i,s,m,Pd,c),N===y)break;y=N}y!==null&&m.stopPropagation()}else vv(i,s,m,null,c)}}function Ov(i){return i=Pp(i),Dv(i)}var Pd=null;function Dv(i){if(Pd=null,i=fl(i),i!==null){var s=o(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=u(s),i!==null)return i;i=null}else if(c===31){if(i=d(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Pd=i,null}function v1(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Qe()){case pt:return 2;case It:return 8;case nr:case Gr:return 32;case ee:return 268435456;default:return 32}default:return 32}}var Pv=!1,Ri=null,Ii=null,Li=null,hc=new Map,vc=new Map,$i=[],qq="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function g1(i,s){switch(i){case"focusin":case"focusout":Ri=null;break;case"dragenter":case"dragleave":Ii=null;break;case"mouseover":case"mouseout":Li=null;break;case"pointerover":case"pointerout":hc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":vc.delete(s.pointerId)}}function gc(i,s,c,m,y,N){return i===null||i.nativeEvent!==N?(i={blockedOn:s,domEventName:c,eventSystemFlags:m,nativeEvent:N,targetContainers:[y]},s!==null&&(s=pl(s),s!==null&&p1(s)),i):(i.eventSystemFlags|=m,s=i.targetContainers,y!==null&&s.indexOf(y)===-1&&s.push(y),i)}function Rq(i,s,c,m,y){switch(s){case"focusin":return Ri=gc(Ri,i,s,c,m,y),!0;case"dragenter":return Ii=gc(Ii,i,s,c,m,y),!0;case"mouseover":return Li=gc(Li,i,s,c,m,y),!0;case"pointerover":var N=y.pointerId;return hc.set(N,gc(hc.get(N)||null,i,s,c,m,y)),!0;case"gotpointercapture":return N=y.pointerId,vc.set(N,gc(vc.get(N)||null,i,s,c,m,y)),!0}return!1}function x1(i){var s=fl(i.target);if(s!==null){var c=o(s);if(c!==null){if(s=c.tag,s===13){if(s=u(c),s!==null){i.blockedOn=s,Dj(i.priority,function(){h1(c)});return}}else if(s===31){if(s=d(c),s!==null){i.blockedOn=s,Dj(i.priority,function(){h1(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Md(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=Ov(i.nativeEvent);if(c===null){c=i.nativeEvent;var m=new c.constructor(c.type,c);Dp=m,c.target.dispatchEvent(m),Dp=null}else return s=pl(c),s!==null&&p1(s),i.blockedOn=c,!1;s.shift()}return!0}function b1(i,s,c){Md(i)&&c.delete(s)}function Iq(){Pv=!1,Ri!==null&&Md(Ri)&&(Ri=null),Ii!==null&&Md(Ii)&&(Ii=null),Li!==null&&Md(Li)&&(Li=null),hc.forEach(b1),vc.forEach(b1)}function Td(i,s){i.blockedOn===s&&(i.blockedOn=null,Pv||(Pv=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Iq)))}var qd=null;function y1(i){qd!==i&&(qd=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){qd===i&&(qd=null);for(var s=0;s<i.length;s+=3){var c=i[s],m=i[s+1],y=i[s+2];if(typeof m!="function"){if(Dv(m||c)===null)continue;break}var N=pl(c);N!==null&&(i.splice(s,3),s-=3,Oh(N,{pending:!0,data:y,method:c.method,action:m},m,y))}}))}function Kl(i){function s(G){return Td(G,i)}Ri!==null&&Td(Ri,i),Ii!==null&&Td(Ii,i),Li!==null&&Td(Li,i),hc.forEach(s),vc.forEach(s);for(var c=0;c<$i.length;c++){var m=$i[c];m.blockedOn===i&&(m.blockedOn=null)}for(;0<$i.length&&(c=$i[0],c.blockedOn===null);)x1(c),c.blockedOn===null&&$i.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(m=0;m<c.length;m+=3){var y=c[m],N=c[m+1],z=y[Hr]||null;if(typeof N=="function")z||y1(c);else if(z){var q=null;if(N&&N.hasAttribute("formAction")){if(y=N,z=N[Hr]||null)q=z.formAction;else if(Dv(y)!==null)continue}else q=z.action;typeof q=="function"?c[m+1]=q:(c.splice(m,3),m-=3),y1(c)}}}function j1(){function i(N){N.canIntercept&&N.info==="react-transition"&&N.intercept({handler:function(){return new Promise(function(z){return y=z})},focusReset:"manual",scroll:"manual"})}function s(){y!==null&&(y(),y=null),m||setTimeout(c,20)}function c(){if(!m&&!navigation.transition){var N=navigation.currentEntry;N&&N.url!=null&&navigation.navigate(N.url,{state:N.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,y=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(c,100),function(){m=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),y!==null&&(y(),y=null)}}}function Mv(i){this._internalRoot=i}Rd.prototype.render=Mv.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(a(409));var c=s.current,m=dn();m1(c,m,i,s,null,null)},Rd.prototype.unmount=Mv.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;m1(i.current,2,null,i,null,null),gd(),s[ml]=null}};function Rd(i){this._internalRoot=i}Rd.prototype.unstable_scheduleHydration=function(i){if(i){var s=Oj();i={blockedOn:null,target:i,priority:s};for(var c=0;c<$i.length&&s!==0&&s<$i[c].priority;c++);$i.splice(c,0,i),c===0&&x1(i)}};var _1=r.version;if(_1!=="19.2.4")throw Error(a(527,_1,"19.2.4"));F.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=p(s),i=i!==null?h(i):null,i=i===null?null:i.stateNode,i};var Lq={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:T,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Id=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Id.isDisabled&&Id.supportsFiber)try{J=Id.inject(Lq),ce=Id}catch{}}return bc.createRoot=function(i,s){if(!l(i))throw Error(a(299));var c=!1,m="",y=z_,N=k_,z=O_;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(m=s.identifierPrefix),s.onUncaughtError!==void 0&&(y=s.onUncaughtError),s.onCaughtError!==void 0&&(N=s.onCaughtError),s.onRecoverableError!==void 0&&(z=s.onRecoverableError)),s=u1(i,1,!1,null,null,c,m,null,y,N,z,j1),i[ml]=s.current,hv(i),new Mv(s)},bc.hydrateRoot=function(i,s,c){if(!l(i))throw Error(a(299));var m=!1,y="",N=z_,z=k_,q=O_,G=null;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onUncaughtError!==void 0&&(N=c.onUncaughtError),c.onCaughtError!==void 0&&(z=c.onCaughtError),c.onRecoverableError!==void 0&&(q=c.onRecoverableError),c.formState!==void 0&&(G=c.formState)),s=u1(i,1,!0,s,c??null,m,y,G,N,z,q,j1),s.context=d1(null),c=s.current,m=dn(),m=Sp(m),y=wi(m),y.callback=null,Ci(c,y,m),c=m,s.current.lanes=c,ht(s,c),ca(s),i[ml]=s.current,hv(i),new Rd(s)},bc.version="19.2.4",bc}var O1;function B3(){if(O1)return Lv.exports;O1=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),Lv.exports=$3(),Lv.exports}var U3=B3();const F3=oi(U3),G3={apiKey:"AIzaSyDgk_1graNBFkIURTJnyLZTZ1nyxi7slUo",authDomain:"pedaclic.firebaseapp.com",projectId:"pedaclic",storageBucket:"pedaclic.firebasestorage.app",messagingSenderId:"863649621890",appId:"1:863649621890:web:6ab56a8c8db111e3a9119b"},Fb=Vq(G3),to=Qq(Fb),Q=Yq(Fb,{localCache:Kq({tabManager:Xq()})}),er=Wq(Fb),H3=Object.freeze(Object.defineProperty({__proto__:null,auth:to,db:Q,storage:er},Symbol.toStringTag,{value:"Module"})),D1={"auth/email-already-in-use":"Cette adresse email est dj utilise.","auth/invalid-email":"Adresse email invalide.","auth/operation-not-allowed":"Opration non autorise.","auth/weak-password":"Le mot de passe doit contenir au moins 6 caractres.","auth/user-disabled":"Ce compte a t dsactiv.","auth/user-not-found":"Aucun compte associ  cette adresse email.","auth/wrong-password":"Mot de passe incorrect.","auth/too-many-requests":"Trop de tentatives. Veuillez ressayer plus tard.","auth/network-request-failed":"Erreur de connexion. Vrifiez votre connexion internet.",default:"Une erreur est survenue. Veuillez ressayer."},Uv=e=>D1[e]||D1.default,yA=g.createContext(null),V3=({children:e})=>{const[r,n]=g.useState(null),[a,l]=g.useState(!0),o=async x=>{try{const j=await Et(je(Q,"users",x));if(j.exists()){const _=j.data();return{uid:x,email:_.email,displayName:_.displayName,role:_.role,isPremium:_.isPremium||!1,subscriptionEnd:_.subscriptionEnd?.toDate()||null,subscriptionPlan:_.subscriptionPlan||void 0,coursChoisis:_.coursChoisis||[],photoURL:_.photoURL,createdAt:_.createdAt?.toDate()||new Date,lastLogin:_.lastLogin?.toDate()}}return null}catch(j){return console.error("Erreur lors de la rcupration des donnes utilisateur:",j),null}},u=async(x,j)=>{const _=je(Q,"users",x.uid);(await Et(_)).exists()?await He(_,{lastLogin:Dt()}):await su(_,{email:x.email,displayName:x.displayName||j?.displayName||"",role:j?.role||"eleve",isPremium:!1,photoURL:x.photoURL,createdAt:Dt(),lastLogin:Dt()})},d=async(x,j)=>{try{const _=await a3(to,x,j);await u(_.user)}catch(_){throw new Error(Uv(_.code))}},f=async x=>{try{if(x.password!==x.confirmPassword)throw new Error("Les mots de passe ne correspondent pas.");const j=await e3(to,x.email,x.password);await t3(j.user,{displayName:x.displayName}),await u(j.user,{displayName:x.displayName,role:x.role})}catch(j){throw j.message?j:new Error(Uv(j.code))}},p=async x=>{try{const j=new r3;j.setCustomParameters({prompt:"select_account"});const _=await n3(to,j);await u(_.user,{role:x??"eleve"})}catch(j){throw new Error(Uv(j.code))}},h=async()=>{try{await Jq(to),n(null)}catch{throw new Error("Erreur lors de la dconnexion.")}},v=async x=>{if(!r)throw new Error("Aucun utilisateur connect.");try{const j=je(Q,"users",r.uid);await He(j,{...x,updatedAt:Dt()}),n(_=>_?{..._,...x}:null)}catch{throw new Error("Erreur lors de la mise  jour du profil.")}};g.useEffect(()=>{const x=Zq(to,async j=>{if(j){const _=await o(j.uid);n(_)}else n(null);l(!1)});return()=>x()},[]);const b={currentUser:r,loading:a,login:d,loginWithGoogle:p,register:f,logout:h,updateProfile:v};return t.jsx(yA.Provider,{value:b,children:a?t.jsxs("div",{className:"loading-container",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement..."})]}):e})},Ke=()=>{const e=g.useContext(yA);if(!e)throw new Error("useAuth doit tre utilis  l'intrieur d'un AuthProvider");return e},Fi=({children:e,allowedRoles:r,requirePremium:n=!1})=>{const{currentUser:a,loading:l}=Ke();return l?t.jsxs("div",{className:"loading-container",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Vrification des autorisations..."})]}):a?r&&!r.includes(a.role)?t.jsxs("div",{className:"error-container",children:[t.jsx("h2",{children:"Accs non autoris"}),t.jsx("p",{children:"Vous n'avez pas les permissions ncessaires pour accder  cette page."}),t.jsx("a",{href:"/",className:"btn btn-primary",children:"Retour  l'accueil"})]}):n&&!a.isPremium?t.jsxs("div",{className:"error-container premium-required",children:[t.jsx("h2",{children:"Contenu Premium"}),t.jsx("p",{children:"Cette ressource est rserve aux abonns Premium."}),t.jsxs("div",{className:"premium-cta",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Ds 10 000 FCFA / 3 mois"}),"  Accs illimit"]}),t.jsx("a",{href:"/premium",className:"btn btn-premium",children:"Devenir Premium"})]})]}):t.jsx(t.Fragment,{children:e}):t.jsxs("div",{className:"error-container",children:[t.jsx("h2",{children:"Accs refus"}),t.jsx("p",{children:"Vous devez tre connect pour accder  cette page."}),t.jsx("a",{href:"/connexion",className:"btn btn-primary",children:"Se connecter"})]})},qr=({children:e})=>t.jsx(Fi,{allowedRoles:["admin"],children:e}),Kn=({children:e})=>t.jsx(Fi,{allowedRoles:["admin","prof"],children:e}),Q3="http://localhost:3001",Sa="notifications";function jA(e,r){return{id:e,destinataireId:r.destinataireId,destinataireRole:r.destinataireRole,type:r.type,titre:r.titre,message:r.message,lienAction:r.lienAction,labelAction:r.labelAction,emetteurId:r.emetteurId,emetteurNom:r.emetteurNom,entiteId:r.entiteId,entiteType:r.entiteType,statut:r.statut,canal:r.canal,emailEnvoye:r.emailEnvoye,emailErreur:r.emailErreur,createdAt:r.createdAt?.toDate()??new Date,luAt:r.luAt?.toDate()??void 0}}async function Y3(e){return(await Pt(_e(Q,Sa),{destinataireId:e.destinataireId,destinataireRole:e.destinataireRole,type:e.type,titre:e.titre,message:e.message,lienAction:e.lienAction??null,labelAction:e.labelAction??null,emetteurId:e.emetteurId??null,emetteurNom:e.emetteurNom??null,entiteId:e.entiteId??null,entiteType:e.entiteType??null,statut:"non_lue",canal:e.canal,emailEnvoye:!1,createdAt:Ae.now()})).id}async function K3(e){try{const r=await fetch(`${Q3}/api/notifications/send-email`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok){const a=await r.text();return{success:!1,error:`HTTP ${r.status}: ${a}`}}return await r.json()}catch(r){return{success:!1,error:r instanceof Error?r.message:"Erreur rseau inconnue"}}}async function W3(e){const r=await Y3(e);let n=!1,a;if((e.canal==="email"||e.canal==="les_deux")&&e.emailDestinataire){const l=await K3({to:e.emailDestinataire,toName:e.emailDestinatairNom,type:e.type,titre:e.titre,message:e.message,lienAction:e.lienAction,labelAction:e.labelAction,emetteurNom:e.emetteurNom});n=l.success,a=l.error,await He(je(Q,Sa,r),{emailEnvoye:n,emailErreur:a??null})}return{notifId:r,emailEnvoye:n,emailErreur:a}}async function X3(e,r){const n=Ee(_e(Q,"inscriptions_groupe"),Ne("groupeId","==",e),Ne("statut","==","actif")),a=await Ce(n);let l=0;const o=Tn(Q);return a.docs.forEach(u=>{const d=u.data().eleveId,f=je(_e(Q,Sa));o.set(f,{destinataireId:d,destinataireRole:"eleve",type:r.type,titre:r.titre,message:r.message,lienAction:r.lienAction??null,labelAction:r.labelAction??null,emetteurId:r.emetteurId??null,emetteurNom:r.emetteurNom??null,entiteId:r.entiteId??null,entiteType:r.entiteType??null,statut:"non_lue",canal:r.canal,emailEnvoye:!1,createdAt:Ae.now()}),l++}),await o.commit(),l}async function Z3(e,r){const n=e==="tous"?Ee(_e(Q,"users"),Ht(500)):Ee(_e(Q,"users"),Ne("role","==",e),Ht(500)),a=await Ce(n);let l=0;const o=Tn(Q);return a.docs.forEach(u=>{const d=u.data(),f=je(_e(Q,Sa));o.set(f,{destinataireId:u.id,destinataireRole:d.role??e,type:r.type,titre:r.titre,message:r.message,lienAction:r.lienAction??null,labelAction:r.labelAction??null,emetteurId:r.emetteurId??null,emetteurNom:r.emetteurNom??null,entiteId:r.entiteId??null,entiteType:r.entiteType??null,statut:"non_lue",canal:r.canal,emailEnvoye:!1,createdAt:Ae.now()}),l++}),await o.commit(),l}async function J3(e,r={}){const{includeArchived:n=!1,limitCount:a=50}=r,l=[Ne("destinataireId","==",e),Ve("createdAt","desc"),Ht(a)];n||l.splice(1,0,Ne("statut","!=","archivee"));const o=Ee(_e(Q,Sa),...l);return(await Ce(o)).docs.map(d=>jA(d.id,d.data()))}function e5(e,r){const n=Ee(_e(Q,Sa),Ne("destinataireId","==",e),Ne("statut","==","non_lue"),Ve("createdAt","desc"),Ht(20));return Sf(n,a=>{const l=a.docs.map(o=>jA(o.id,o.data()));r(l)})}async function Dx(e){await He(je(Q,Sa,e),{statut:"lue",luAt:Ae.now()})}async function _A(e){const r=Ee(_e(Q,Sa),Ne("destinataireId","==",e),Ne("statut","==","non_lue")),n=await Ce(r),a=Tn(Q);n.docs.forEach(l=>{a.update(l.ref,{statut:"lue",luAt:Ae.now()})}),await a.commit()}async function t5(e){await He(je(Q,Sa,e),{statut:"archivee"})}async function r5(e){await Br(je(Q,Sa,e))}const bm={nouveau_cours:{titreDefaut:"Nouveau cours disponible",messageDefaut:"Un nouveau cours vient d'tre publi dans votre matire.",icone:"",couleur:"#2563eb"},resultat_quiz:{titreDefaut:"Rsultat de votre quiz",messageDefaut:"Votre rsultat au quiz est disponible.",icone:"",couleur:"#10b981"},rappel_echeance:{titreDefaut:"Rappel d'chance",messageDefaut:"N'oubliez pas votre examen approche.",icone:"",couleur:"#f59e0b"},message_prof:{titreDefaut:"Message de votre professeur",messageDefaut:"",icone:"",couleur:"#8b5cf6"},annonce:{titreDefaut:"Annonce importante",messageDefaut:"",icone:"",couleur:"#ef4444"},nouveau_abonnement:{titreDefaut:"Abonnement Premium activ ",messageDefaut:"Votre abonnement Premium PedaClic est maintenant actif. Profitez de tous les contenus !",icone:"",couleur:"#f59e0b"},bienvenue:{titreDefaut:"Bienvenue sur PedaClic !",messageDefaut:"Bienvenue sur PedaClic, la plateforme ducative sngalaise. Commencez votre apprentissage ds maintenant !",icone:"",couleur:"#10b981"}},Gb={nouveau_cours:" Nouveau cours",resultat_quiz:" Rsultat quiz",rappel_echeance:" Rappel chance",message_prof:" Message prof",annonce:" Annonce",nouveau_abonnement:" Abonnement",bienvenue:" Bienvenue"},n5={eleve:" lves",parent:" Parents",prof:" Professeurs",admin:" Admins",tous:" Tous les utilisateurs"};function a5(e){const n=new Date().getTime()-e.getTime(),a=Math.floor(n/6e4),l=Math.floor(a/60),o=Math.floor(l/24);return a<1?" l'instant":a<60?`Il y a ${a} min`:l<24?`Il y a ${l}h`:o===1?"Hier":o<7?`Il y a ${o} jours`:e.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})}const i5=()=>{const{currentUser:e}=Ke(),r=Je(),[n,a]=g.useState([]),[l,o]=g.useState(!1),[u,d]=g.useState(!1),f=g.useRef(null);g.useEffect(()=>{if(!e)return;const x=e5(e.uid,j=>a(j));return()=>x()},[e]),g.useEffect(()=>{function x(j){f.current&&!f.current.contains(j.target)&&o(!1)}return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const p=n.length,h=g.useCallback(async x=>{await Dx(x.id),o(!1),x.lienAction&&r(x.lienAction)},[r]),v=g.useCallback(async()=>{if(!(!e||u)){d(!0);try{await _A(e.uid)}finally{d(!1)}}},[e,u]),b=()=>{o(!1),r("/notifications")};return e?t.jsxs("div",{className:"notif-bell",ref:f,children:[t.jsxs("button",{className:"notif-bell__btn",onClick:()=>o(x=>!x),"aria-label":`Notifications${p>0?`  ${p} non lues`:""}`,"aria-expanded":l,"aria-haspopup":"true",children:[t.jsx("span",{className:"notif-bell__icon","aria-hidden":"true",children:""}),p>0&&t.jsx("span",{className:"notif-bell__badge","aria-hidden":"true",children:p>99?"99+":p})]}),l&&t.jsxs("div",{className:"notif-bell__dropdown",role:"dialog","aria-label":"Notifications rcentes",children:[t.jsxs("div",{className:"notif-bell__dropdown-header",children:[t.jsxs("h3",{className:"notif-bell__dropdown-title",children:[" Notifications",p>0&&t.jsxs("span",{className:"notif-bell__dropdown-count",children:[p," nouvelles"]})]}),p>0&&t.jsx("button",{className:"notif-bell__mark-all-btn",onClick:v,disabled:u,children:u?"":"Tout lire"})]}),t.jsx("div",{className:"notif-bell__list",children:n.length===0?t.jsxs("div",{className:"notif-bell__empty",children:[t.jsx("span",{className:"notif-bell__empty-icon",children:""}),t.jsx("p",{children:"Tout est  jour !"})]}):n.slice(0,5).map(x=>{const j=bm[x.type];return t.jsxs("button",{className:`notif-bell__item ${x.statut==="non_lue"?"notif-bell__item--unread":""}`,onClick:()=>h(x),children:[t.jsx("span",{className:"notif-bell__item-icon",style:{background:j.couleur+"20",color:j.couleur},"aria-hidden":"true",children:j.icone}),t.jsxs("div",{className:"notif-bell__item-content",children:[t.jsx("p",{className:"notif-bell__item-titre",children:x.titre}),t.jsx("p",{className:"notif-bell__item-message",children:x.message}),t.jsx("p",{className:"notif-bell__item-date",children:a5(x.createdAt)})]}),x.statut==="non_lue"&&t.jsx("span",{className:"notif-bell__item-dot","aria-hidden":"true"})]},x.id)})}),t.jsx("div",{className:"notif-bell__dropdown-footer",children:t.jsx("button",{className:"notif-bell__see-all-btn",onClick:b,children:"Voir toutes les notifications "})})]})]}):null},s5=()=>{const{currentUser:e,logout:r,loading:n}=Ke(),a=Je(),l=Lb(),[o,u]=g.useState(!1),[d,f]=g.useState(!1),[p,h]=g.useState(!1),[v,b]=g.useState(null),x=g.useRef(null),j=[{path:"/",label:"Accueil",icon:t.jsx(Ax,{size:18})},{path:"/disciplines",label:"Disciplines",icon:t.jsx(hn,{size:18})},{path:"/ebooks",label:"Bibliothque",icon:t.jsx(hn,{size:18})},{path:"/mediatheque",label:"Mdiathque",icon:t.jsx(s3,{size:18})},{path:"/quiz-gratuits",label:"Quiz",icon:t.jsx($s,{size:18}),requireAuth:!1},{path:"/quizzes",label:"Quiz Avancs",icon:t.jsx($s,{size:18}),requireAuth:!0,requirePremium:!0},{path:"/premium",label:"Premium",icon:t.jsx(Zr,{size:18}),hideIfPremium:!0},{path:e?.role==="eleve"?"/eleve/dashboard":e?.role==="prof"?"/prof/dashboard":"/admin",label:"Tableau de bord",icon:t.jsx(N1,{size:18}),requireAuth:!0},{path:"/generateur",label:"Gnrateur IA",icon:t.jsx(l3,{size:18}),requireAuth:!0,requirePremium:!0},{path:"/parent/dashboard",label:"Espace Parent",icon:t.jsx(Bs,{size:18}),requireAuth:!0,requireRole:["parent"]}];g.useEffect(()=>{const P=D=>{x.current&&!x.current.contains(D.target)&&f(!1)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]),g.useEffect(()=>{const P=B=>{B.preventDefault(),b(B)},D=()=>b(null);return window.addEventListener("beforeinstallprompt",P),window.addEventListener("appinstalled",D),()=>{window.removeEventListener("beforeinstallprompt",P),window.removeEventListener("appinstalled",D)}},[]);const _=g.useCallback(async()=>{if(!v)return;await v.prompt();const{outcome:P}=await v.userChoice;P==="accepted"&&b(null)},[v]);g.useEffect(()=>{u(!1),f(!1)},[l.pathname]),g.useEffect(()=>(o?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[o]);const C=async()=>{try{h(!0),await r(),f(!1),a("/")}catch(P){console.error("Erreur lors de la dconnexion:",P)}finally{h(!1)}},w=()=>{u(!o)},E=()=>{f(!d)},S=P=>!(P.requireAuth&&!e||P.requirePremium&&e&&!e.isPremium||P.hideIfPremium&&(e?.isPremium||e?.role==="admin")||P.requireRole&&e&&!P.requireRole.includes(e.role)),A=P=>P==="/"?l.pathname==="/":l.pathname.startsWith(P),O=P=>({admin:"Administrateur",prof:"Professeur",eleve:"lve",parent:"Parent"})[P]||P,k=()=>e?e.displayName?e.displayName.split(" ").map(D=>D[0]).join("").toUpperCase().slice(0,2):e.email[0].toUpperCase():"?";return t.jsxs("header",{className:"header",children:[t.jsxs("div",{className:"header__container",children:[t.jsxs(Le,{to:"/",className:"header__logo",children:[t.jsx($s,{className:"header__logo-icon",size:32}),t.jsxs("div",{className:"header__logo-text",children:[t.jsx("span",{className:"header__logo-name",children:"PedaClic"}),t.jsx("span",{className:"header__logo-tagline",children:"L'cole en un clic"})]})]}),t.jsx("nav",{className:"header__nav header__nav--desktop",children:t.jsx("ul",{className:"header__nav-list",children:j.map(P=>S(P)&&t.jsx("li",{className:"header__nav-item",children:t.jsxs(Le,{to:P.path,className:`header__nav-link ${A(P.path)?"header__nav-link--active":""} ${P.hideIfPremium?"header__nav-link--premium-cta":""}`,children:[P.icon,t.jsx("span",{children:P.label}),P.requirePremium&&t.jsx(Oc,{size:14,className:"header__premium-badge"})]})},P.path))})}),t.jsxs("div",{className:"header__actions",children:[v&&t.jsxs("button",{className:"header__install-btn",onClick:_,title:"Installer PedaClic sur cet appareil",children:[t.jsx(vA,{size:16}),t.jsx("span",{children:"Installer"})]}),n?t.jsx("div",{className:"header__loading",children:t.jsx("div",{className:"header__spinner"})}):e?t.jsxs(t.Fragment,{children:[t.jsx(i5,{}),t.jsxs("div",{className:"header__user",ref:x,children:[e.isPremium&&t.jsxs("span",{className:"header__premium-tag",children:[t.jsx(Oc,{size:14}),"Premium"]}),t.jsxs("button",{className:"header__user-button",onClick:E,"aria-expanded":d,"aria-haspopup":"true",children:[t.jsx("div",{className:"header__avatar",children:e.photoURL?t.jsx("img",{src:e.photoURL,alt:e.displayName||"Avatar",className:"header__avatar-img"}):t.jsx("span",{className:"header__avatar-initials",children:k()})}),t.jsx("span",{className:"header__user-name",children:e.displayName||e.email.split("@")[0]}),t.jsx(gm,{size:16,className:`header__chevron ${d?"header__chevron--open":""}`})]}),d&&t.jsxs("div",{className:"header__dropdown",children:[t.jsxs("div",{className:"header__dropdown-header",children:[t.jsx("p",{className:"header__dropdown-email",children:e.email}),t.jsx("span",{className:`header__dropdown-role header__dropdown-role--${e.role}`,children:O(e.role)})]}),t.jsx("div",{className:"header__dropdown-divider"}),t.jsxs("nav",{className:"header__dropdown-nav",children:[t.jsxs(Le,{to:e.role==="eleve"?"/eleve/dashboard":e.role==="prof"?"/prof/dashboard":"/admin",className:"header__dropdown-link",children:[t.jsx(N1,{size:18}),t.jsx("span",{children:"Tableau de bord"})]}),e.role==="eleve"&&t.jsxs(Le,{to:"/eleve/suivi",className:"header__dropdown-link",children:[t.jsx(Bs,{size:18}),t.jsx("span",{children:"Mes points  amliorer"})]}),e.role==="parent"&&t.jsxs(Le,{to:"/parent/dashboard",className:"header__dropdown-link",children:[t.jsx(Bs,{size:18}),t.jsx("span",{children:"Espace Parent"})]}),t.jsxs(Le,{to:"/profil",className:"header__dropdown-link",children:[t.jsx(o3,{size:18}),t.jsx("span",{children:"Mon profil"})]}),e.role==="admin"&&t.jsxs(Le,{to:"/admin",className:"header__dropdown-link",children:[t.jsx(c3,{size:18}),t.jsx("span",{children:"Administration"})]}),!e.isPremium&&t.jsxs(Le,{to:"/premium",className:"header__dropdown-link header__dropdown-link--premium",children:[t.jsx(Oc,{size:18}),t.jsx("span",{children:"Passer Premium"})]})]}),t.jsx("div",{className:"header__dropdown-divider"}),t.jsxs("button",{className:"header__dropdown-logout",onClick:C,disabled:p,children:[t.jsx(S1,{size:18}),t.jsx("span",{children:p?"Dconnexion...":"Se dconnecter"})]})]})]})]}):t.jsxs("div",{className:"header__auth-buttons",children:[t.jsx(Le,{to:"/connexion",className:"header__btn header__btn--outline",children:"Connexion"}),t.jsx(Le,{to:"/inscription",className:"header__btn header__btn--primary",children:"S'inscrire"})]}),t.jsx("button",{className:"header__mobile-toggle",onClick:w,"aria-label":o?"Fermer le menu":"Ouvrir le menu","aria-expanded":o,children:o?t.jsx(Ki,{size:24}):t.jsx(u3,{size:24})})]})]}),t.jsxs("div",{className:`header__mobile-menu ${o?"header__mobile-menu--open":""}`,children:[t.jsx("div",{className:"header__mobile-overlay",onClick:()=>u(!1)}),t.jsxs("div",{className:"header__mobile-content",children:[t.jsx("nav",{className:"header__mobile-nav",children:t.jsx("ul",{className:"header__mobile-list",children:j.map(P=>S(P)&&t.jsx("li",{className:"header__mobile-item",children:t.jsxs(Le,{to:P.path,className:`header__mobile-link ${A(P.path)?"header__mobile-link--active":""} ${P.hideIfPremium?"header__mobile-link--premium-cta":""}`,children:[P.icon,t.jsx("span",{children:P.label}),P.requirePremium&&t.jsx(Oc,{size:14,className:"header__premium-badge"})]})},P.path))})}),!e&&t.jsxs("div",{className:"header__mobile-auth",children:[t.jsx(Le,{to:"/connexion",className:"header__btn header__btn--outline header__btn--block",children:"Connexion"}),t.jsx(Le,{to:"/inscription",className:"header__btn header__btn--primary header__btn--block",children:"S'inscrire"})]}),e&&t.jsxs("div",{className:"header__mobile-user",children:[t.jsxs("div",{className:"header__mobile-user-info",children:[t.jsx("div",{className:"header__avatar header__avatar--large",children:e.photoURL?t.jsx("img",{src:e.photoURL,alt:e.displayName||"Avatar",className:"header__avatar-img"}):t.jsx("span",{className:"header__avatar-initials",children:k()})}),t.jsxs("div",{className:"header__mobile-user-details",children:[t.jsx("p",{className:"header__mobile-user-name",children:e.displayName||e.email.split("@")[0]}),t.jsx("p",{className:"header__mobile-user-email",children:e.email})]})]}),t.jsxs("button",{className:"header__mobile-logout",onClick:C,disabled:p,children:[t.jsx(S1,{size:18}),t.jsx("span",{children:p?"Dconnexion...":"Se dconnecter"})]})]})]})]})]})},l5=()=>{const e=new Date().getFullYear(),{currentUser:r}=Ke(),a=[{label:"Accueil",path:"/"},{label:"Disciplines",path:"/disciplines"},{label:"Quiz Avancs",path:"/quizzes"},{label:"Tarifs",path:"/premium"},{label:"Tableau de bord",path:(()=>{if(!r)return"/connexion";switch(r.role){case"eleve":return"/eleve/dashboard";case"prof":return"/prof/dashboard";case"parent":return"/parent/dashboard";case"admin":return"/admin";default:return"/connexion"}})()}],l=[{label:"Cours en ligne",path:"/cours",badge:"Nouveau",icon:t.jsx(v3,{size:14})},{label:"Exercices corrigs",path:"/disciplines"},{label:"Annales examens",path:"/disciplines"},{label:"Fiches de rvision",path:"/disciplines"}],o=[{name:"Facebook",url:"https://facebook.com/pedaclic",icon:t.jsx(g3,{size:20})},{name:"Twitter",url:"https://twitter.com/pedaclic",icon:t.jsx(x3,{size:20})},{name:"Instagram",url:"https://instagram.com/pedaclic",icon:t.jsx(b3,{size:20})},{name:"LinkedIn",url:"https://linkedin.com/company/pedaclic",icon:t.jsx(y3,{size:20})},{name:"YouTube",url:"https://youtube.com/@pedaclic",icon:t.jsx(j3,{size:20})}];return t.jsxs("footer",{className:"footer",children:[t.jsx("div",{className:"footer__main",children:t.jsxs("div",{className:"footer__container",children:[t.jsxs("div",{className:"footer__column footer__column--about",children:[t.jsxs(Le,{to:"/",className:"footer__logo",children:[t.jsx($s,{className:"footer__logo-icon",size:36}),t.jsxs("div",{className:"footer__logo-text",children:[t.jsx("span",{className:"footer__logo-name",children:"PedaClic"}),t.jsx("span",{className:"footer__logo-tagline",children:"L'cole en un clic"})]})]}),t.jsx("p",{className:"footer__description",children:"PedaClic est la plateforme ducative de rfrence au Sngal. Nous accompagnons les lves du collge au lyce avec des cours, exercices et quiz de qualit."}),t.jsxs("div",{className:"footer__stats",children:[t.jsxs("div",{className:"footer__stat",children:[t.jsx(hn,{size:18}),t.jsx("span",{children:"500+ cours"})]}),t.jsxs("div",{className:"footer__stat",children:[t.jsx(om,{size:18}),t.jsx("span",{children:"10 000+ lves"})]})]})]}),t.jsxs("div",{className:"footer__column",children:[t.jsxs("h3",{className:"footer__title",children:[t.jsx("span",{className:"footer__title-icon",children:""}),"Plateforme"]}),t.jsx("nav",{className:"footer__nav",children:t.jsx("ul",{className:"footer__list",children:a.map((u,d)=>t.jsx("li",{className:"footer__item",children:t.jsx(Le,{to:u.path,className:"footer__link",children:u.label})},d))})})]}),t.jsxs("div",{className:"footer__column",children:[t.jsxs("h3",{className:"footer__title",children:[t.jsx("span",{className:"footer__title-icon",children:""}),"Ressources"]}),t.jsx("nav",{className:"footer__nav",children:t.jsx("ul",{className:"footer__list",children:l.map((u,d)=>t.jsx("li",{className:"footer__item",children:t.jsxs(Le,{to:u.path,className:`footer__link${u.badge?" footer__link--new":""}`,children:[u.icon&&t.jsx("span",{className:"footer__link-icon",children:u.icon}),u.label,u.badge&&t.jsx("span",{className:"footer__badge",children:u.badge})]})},d))})})]}),t.jsxs("div",{className:"footer__column",children:[t.jsxs("h3",{className:"footer__title",children:[t.jsx("span",{className:"footer__title-icon",children:""}),"Contact"]}),t.jsxs("div",{className:"footer__contact",children:[t.jsxs("a",{href:"mailto:contact@pedaclic.sn",className:"footer__contact-item",children:[t.jsx(d3,{size:16,className:"footer__contact-icon"}),t.jsx("span",{children:"contact@pedaclic.sn"})]}),t.jsxs("a",{href:"tel:+221770000000",className:"footer__contact-item",children:[t.jsx(m3,{size:16,className:"footer__contact-icon"}),t.jsx("span",{children:"+221 77 000 00 00"})]}),t.jsxs("div",{className:"footer__contact-item",children:[t.jsx(f3,{size:16,className:"footer__contact-icon"}),t.jsx("span",{children:"Dakar, Sngal"})]})]}),t.jsxs("div",{className:"footer__social",children:[t.jsx("h4",{className:"footer__social-title",children:"Suivez-nous"}),t.jsx("div",{className:"footer__social-links",children:o.map((u,d)=>t.jsx("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",className:"footer__social-link",title:u.name,children:u.icon},d))})]})]})]})}),t.jsx("div",{className:"footer__bottom",children:t.jsxs("div",{className:"footer__container footer__bottom-content",children:[t.jsxs("p",{className:"footer__copyright",children:[" ",e," PedaClic. Tous droits rservs."]}),t.jsxs("p",{className:"footer__made-with",children:["Fait avec ",t.jsx(p3,{size:14,className:"footer__heart"})," au Sngal "]}),t.jsxs("nav",{className:"footer__legal",children:[t.jsxs(Le,{to:"/mentions-legales",className:"footer__legal-link",children:[t.jsx(h3,{size:14})," Mentions lgales"]}),t.jsxs(Le,{to:"/confidentialite",className:"footer__legal-link",children:[t.jsx(Bb,{size:14})," Confidentialit"]}),t.jsxs(Le,{to:"/aide",className:"footer__legal-link",children:[t.jsx(cm,{size:14})," Aide"]})]})]})})]})},lt=({children:e,hideHeader:r=!1,hideFooter:n=!1,className:a=""})=>t.jsxs("div",{className:"layout",children:[!r&&t.jsx(s5,{}),t.jsx("main",{className:`layout__main ${r?"":"layout__main--with-header"} ${a}`,children:e}),!n&&t.jsx(l5,{})]}),o5=()=>{const{currentUser:e}=Ke();return t.jsxs("div",{className:"home-page",children:[t.jsxs("section",{className:"home-page__hero",children:[t.jsxs("div",{className:"home-page__hero-content",children:[t.jsxs("div",{className:"home-page__hero-badge",children:[t.jsx(Zr,{size:14}),t.jsx("span",{children:"Plateforme N1 au Sngal"})]}),t.jsxs("h1",{className:"home-page__hero-title",children:["Russis tes examens avec",t.jsx("span",{className:"home-page__hero-highlight",children:" PedaClic"})]}),t.jsx("p",{className:"home-page__hero-subtitle",children:"La plateforme ducative qui accompagne les lves sngalais du collge au lyce avec des cours, exercices et quiz de qualit."}),t.jsx("div",{className:"home-page__hero-cta",children:e?t.jsxs(Le,{to:e.role==="eleve"?"/eleve/dashboard":e.role==="prof"?"/prof/dashboard":"/admin",className:"home-page__btn home-page__btn--primary",children:["  Accder  mon espace",t.jsx(ks,{size:20})]}):t.jsxs(t.Fragment,{children:[t.jsxs(Le,{to:"/register",className:"home-page__btn home-page__btn--primary",children:["Commencer gratuitement",t.jsx(ks,{size:20})]}),t.jsxs(Le,{to:"/disciplines",className:"home-page__btn home-page__btn--outline",children:[t.jsx(ao,{size:18}),"Dcouvrir les cours"]})]})}),t.jsxs("div",{className:"home-page__hero-stats",children:[t.jsxs("div",{className:"home-page__hero-stat",children:[t.jsx("strong",{children:"10 000+"}),t.jsx("span",{children:"lves inscrits"})]}),t.jsxs("div",{className:"home-page__hero-stat",children:[t.jsx("strong",{children:"500+"}),t.jsx("span",{children:"Cours disponibles"})]}),t.jsxs("div",{className:"home-page__hero-stat",children:[t.jsx("strong",{children:"95%"}),t.jsx("span",{children:"Taux de russite"})]})]})]}),t.jsx("div",{className:"home-page__hero-image",children:t.jsxs("div",{className:"home-page__hero-illustration",children:[t.jsx($s,{size:120}),t.jsx("div",{className:"home-page__hero-floating home-page__hero-floating--1",children:""}),t.jsx("div",{className:"home-page__hero-floating home-page__hero-floating--2",children:""}),t.jsx("div",{className:"home-page__hero-floating home-page__hero-floating--3",children:""})]})})]}),t.jsx("section",{className:"home-page__levels",children:t.jsxs("div",{className:"home-page__container",children:[t.jsx("h2",{className:"home-page__section-title",children:"Tous les niveaux, toutes les matires"}),t.jsx("p",{className:"home-page__section-subtitle",children:"Du collge au lyce, prpare tes examens avec confiance"}),t.jsxs("div",{className:"home-page__levels-grid",children:[t.jsxs(Le,{to:"/disciplines?niveau=college",className:"home-page__level-card",children:[t.jsx("div",{className:"home-page__level-icon home-page__level-icon--college",children:""}),t.jsx("h3",{children:"Collge"}),t.jsx("p",{children:"6me  3me"}),t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx(Ut,{size:16})," Prparation au BFEM"]}),t.jsxs("li",{children:[t.jsx(Ut,{size:16})," 9 matires disponibles"]}),t.jsxs("li",{children:[t.jsx(Ut,{size:16})," Exercices corrigs"]})]}),t.jsxs("span",{className:"home-page__level-link",children:["Voir les cours ",t.jsx(ks,{size:16})]})]}),t.jsxs(Le,{to:"/disciplines?niveau=lycee",className:"home-page__level-card",children:[t.jsx("div",{className:"home-page__level-icon home-page__level-icon--lycee",children:""}),t.jsx("h3",{children:"Lyce"}),t.jsx("p",{children:"2nde  Terminale"}),t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx(Ut,{size:16})," Prparation au BAC"]}),t.jsxs("li",{children:[t.jsx(Ut,{size:16})," 12 matires disponibles"]}),t.jsxs("li",{children:[t.jsx(Ut,{size:16})," Annales d'examens"]})]}),t.jsxs("span",{className:"home-page__level-link",children:["Voir les cours ",t.jsx(ks,{size:16})]})]})]})]})}),t.jsx("section",{className:"home-page__features",children:t.jsxs("div",{className:"home-page__container",children:[t.jsx("h2",{className:"home-page__section-title",children:"Pourquoi choisir PedaClic ?"}),t.jsx("p",{className:"home-page__section-subtitle",children:"Des outils modernes pour une ducation de qualit"}),t.jsxs("div",{className:"home-page__features-grid",children:[t.jsxs("div",{className:"home-page__feature-card",children:[t.jsx("div",{className:"home-page__feature-icon",children:t.jsx(hn,{size:28})}),t.jsx("h3",{children:"Cours complets"}),t.jsx("p",{children:"Des cours structurs et conformes au programme sngalais, rdigs par des enseignants expriments."})]}),t.jsxs("div",{className:"home-page__feature-card",children:[t.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--secondary",children:t.jsx(gA,{size:28})}),t.jsx("h3",{children:"Quiz interactifs"}),t.jsx("p",{children:"Testez vos connaissances avec des quiz adapts  chaque niveau et obtenez un feedback instantan."})]}),t.jsxs("div",{className:"home-page__feature-card",children:[t.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--warning",children:t.jsx(xA,{size:28})}),t.jsx("h3",{children:"Suivi de progression"}),t.jsx("p",{children:"Visualisez vos progrs et identifiez vos points faibles pour cibler vos rvisions."})]}),t.jsxs("div",{className:"home-page__feature-card",children:[t.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--success",children:t.jsx(Bb,{size:28})}),t.jsx("h3",{children:"Contenu vrifi"}),t.jsx("p",{children:"Tous nos contenus sont valids par des professeurs certifis pour garantir leur qualit."})]}),t.jsxs("div",{className:"home-page__feature-card",children:[t.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--info",children:t.jsx(uo,{size:28})}),t.jsx("h3",{children:"Accessible 24/7"}),t.jsx("p",{children:"tudiez  votre rythme, o que vous soyez, sur ordinateur, tablette ou smartphone."})]}),t.jsxs("div",{className:"home-page__feature-card",children:[t.jsx("div",{className:"home-page__feature-icon home-page__feature-icon--premium",children:t.jsx(ts,{size:28})}),t.jsx("h3",{children:"Certificats"}),t.jsx("p",{children:"Obtenez des certificats de russite pour valoriser vos comptences acquises."})]})]})]})}),t.jsx("section",{className:"home-page__premium",children:t.jsx("div",{className:"home-page__container",children:t.jsxs("div",{className:"home-page__premium-content",children:[t.jsxs("div",{className:"home-page__premium-text",children:[t.jsx("span",{className:"home-page__premium-badge",children:" Premium"}),t.jsx("h2",{children:"Passez  la vitesse suprieure"}),t.jsxs("p",{children:["Accdez  tous les quiz, exercices corrigs et ressources exclusives pour seulement ",t.jsx("strong",{children:"2 000 FCFA/mois"}),"."]}),t.jsxs("ul",{className:"home-page__premium-features",children:[t.jsxs("li",{children:[t.jsx(Ut,{size:18})," Quiz illimits dans toutes les matires"]}),t.jsxs("li",{children:[t.jsx(Ut,{size:18})," Corrections dtailles des exercices"]}),t.jsxs("li",{children:[t.jsx(Ut,{size:18})," Annales des examens (BFEM, BAC)"]}),t.jsxs("li",{children:[t.jsx(Ut,{size:18})," Support prioritaire"]})]}),t.jsxs(Le,{to:"/premium",className:"home-page__btn home-page__btn--premium",children:["Dcouvrir Premium",t.jsx(ks,{size:20})]})]}),t.jsx("div",{className:"home-page__premium-pricing",children:t.jsxs("div",{className:"home-page__pricing-card",children:[t.jsx("span",{className:"home-page__pricing-popular",children:"Plus populaire"}),t.jsx("h3",{children:"Accs illimit 6 mois"}),t.jsxs("div",{className:"home-page__pricing-price",children:[t.jsx("span",{className:"home-page__pricing-amount",children:"20 000"}),t.jsx("span",{className:"home-page__pricing-currency",children:"FCFA"}),t.jsx("span",{className:"home-page__pricing-period",children:"/6 mois"})]}),t.jsx("p",{className:"home-page__pricing-save",children:"conomisez 10 000 FCFA vs 23 mois"}),t.jsx(Le,{to:"/premium",className:"home-page__btn home-page__btn--primary home-page__btn--block",children:"Choisir ce plan"})]})})]})})}),t.jsx("section",{className:"home-page__testimonials",children:t.jsxs("div",{className:"home-page__container",children:[t.jsx("h2",{className:"home-page__section-title",children:"Ce qu'en disent nos lves"}),t.jsxs("div",{className:"home-page__testimonials-grid",children:[t.jsxs("div",{className:"home-page__testimonial-card",children:[t.jsx("div",{className:"home-page__testimonial-stars",children:[1,2,3,4,5].map(r=>t.jsx(Zr,{size:16,fill:"#f59e0b",color:"#f59e0b"},r))}),t.jsx("p",{className:"home-page__testimonial-text",children:`"Grce  PedaClic, j'ai obtenu mon BFEM avec mention. Les quiz m'ont vraiment aid  me prparer !"`}),t.jsxs("div",{className:"home-page__testimonial-author",children:[t.jsx("div",{className:"home-page__testimonial-avatar",children:"FA"}),t.jsxs("div",{children:[t.jsx("strong",{children:"Fatou Adara"}),t.jsx("span",{children:"lve en 3me - Dakar"})]})]})]}),t.jsxs("div",{className:"home-page__testimonial-card",children:[t.jsx("div",{className:"home-page__testimonial-stars",children:[1,2,3,4,5].map(r=>t.jsx(Zr,{size:16,fill:"#f59e0b",color:"#f59e0b"},r))}),t.jsx("p",{className:"home-page__testimonial-text",children:`"Les cours de maths sont trs bien expliqus. J'ai enfin compris les quations du second degr !"`}),t.jsxs("div",{className:"home-page__testimonial-author",children:[t.jsx("div",{className:"home-page__testimonial-avatar",children:"MD"}),t.jsxs("div",{children:[t.jsx("strong",{children:"Moussa Diallo"}),t.jsx("span",{children:"lve en Terminale S - This"})]})]})]}),t.jsxs("div",{className:"home-page__testimonial-card",children:[t.jsx("div",{className:"home-page__testimonial-stars",children:[1,2,3,4,5].map(r=>t.jsx(Zr,{size:16,fill:"#f59e0b",color:"#f59e0b"},r))}),t.jsx("p",{className:"home-page__testimonial-text",children:`"Je recommande PedaClic  tous les parents. Ma fille a beaucoup progress depuis qu'elle l'utilise."`}),t.jsxs("div",{className:"home-page__testimonial-author",children:[t.jsx("div",{className:"home-page__testimonial-avatar",children:"AN"}),t.jsxs("div",{children:[t.jsx("strong",{children:"Aminata Ndiaye"}),t.jsx("span",{children:"Parent d'lve - Saint-Louis"})]})]})]})]})]})}),t.jsx("section",{className:"home-page__final-cta",children:t.jsxs("div",{className:"home-page__container",children:[t.jsx("h2",{children:"Prt  russir ?"}),t.jsx("p",{children:"Rejoignez les milliers d'lves qui font confiance  PedaClic"}),!e&&t.jsxs(Le,{to:"/register",className:"home-page__btn home-page__btn--large",children:["Crer mon compte gratuit",t.jsx(ks,{size:24})]})]})})]})},NA=[{value:"6eme",label:"6me"},{value:"5eme",label:"5me"},{value:"4eme",label:"4me"},{value:"3eme",label:"3me"}],SA=[{value:"2nde",label:"2nde"},{value:"1ere",label:"1re"},{value:"Terminale",label:"Terminale"}],wA=[{value:"debutant",label:"Dbutant"},{value:"intermediaire",label:"Intermdiaire"},{value:"avance",label:"Avanc"}],CA={college:"Collge",lycee:"Lyce",formation_libre:"Formation libre"};function P1(e){switch(e){case"college":return NA;case"lycee":return SA;case"formation_libre":return wA;default:return[]}}function EA(e){return[...NA,...SA,...wA].find(n=>n.value===e)?.label||e}const M1=[{niveau:"college",icon:"",label:"Collge",color:"#2b6cb0",bgLight:"#ebf8ff"},{niveau:"lycee",icon:"",label:"Lyce",color:"#975a16",bgLight:"#fefcbf"},{niveau:"formation_libre",icon:"",label:"Formation libre",color:"#276749",bgLight:"#f0fff4"}],c5=()=>{const[e,r]=g.useState("college"),[n,a]=g.useState([]),[l,o]=g.useState(!0),u=Je();g.useEffect(()=>{const p=Ee(_e(Q,"disciplines"),Ve("ordre")),h=Sf(p,v=>{const b=v.docs.map(x=>({id:x.id,...x.data(),createdAt:x.data().createdAt?.toDate()||new Date,updatedAt:x.data().updatedAt?.toDate()||new Date}));a(b),o(!1)});return()=>h()},[]);const d=n.filter(p=>p.niveau===e),f=M1.find(p=>p.niveau===e);return t.jsxs("div",{style:{maxWidth:"1100px",margin:"0 auto",padding:"24px"},children:[t.jsxs("div",{style:{marginBottom:"32px",textAlign:"center"},children:[t.jsx("h1",{style:{fontSize:"1.8rem",fontWeight:700,color:"#1a365d",marginBottom:"8px"},children:" Disciplines"}),t.jsx("p",{style:{color:"#718096",fontSize:"1rem"},children:"Explorez les disciplines disponibles sur PedaClic"})]}),t.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"12px",marginBottom:"32px",flexWrap:"wrap"},children:M1.map(p=>{const h=e===p.niveau;return t.jsxs("button",{onClick:()=>r(p.niveau),style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 28px",borderRadius:"12px",border:`2px solid ${h?p.color:"#e2e8f0"}`,background:h?p.bgLight:"#fff",color:h?p.color:"#718096",fontSize:"1rem",fontWeight:h?700:500,cursor:"pointer",transition:"all 0.25s ease",boxShadow:h?`0 2px 8px ${p.color}20`:"none"},children:[t.jsx("span",{style:{fontSize:"1.2rem"},children:p.icon}),p.label]},p.niveau)})}),l&&t.jsx("div",{style:{textAlign:"center",padding:"48px",color:"#a0aec0"},children:"Chargement des disciplines..."}),!l&&d.length===0&&t.jsxs("div",{style:{textAlign:"center",padding:"48px",background:"#f7fafc",borderRadius:"12px",border:"1px dashed #e2e8f0"},children:[t.jsx("p",{style:{fontSize:"2rem",marginBottom:"8px"},children:""}),t.jsxs("p",{style:{color:"#a0aec0",fontSize:"1rem"},children:["Aucune discipline disponible en ",CA[e]," pour le moment."]})]}),!l&&d.length>0&&t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"20px"},children:d.map(p=>t.jsxs("div",{onClick:()=>u(`/disciplines/${p.id}`),style:{background:"#fff",borderRadius:"12px",padding:"24px",border:"1px solid #e2e8f0",boxShadow:"0 2px 6px rgba(0,0,0,0.05)",cursor:"pointer",transition:"all 0.2s ease",borderTop:`3px solid ${p.couleur||f.color}`},onMouseEnter:h=>{h.currentTarget.style.transform="translateY(-2px)",h.currentTarget.style.boxShadow="0 6px 16px rgba(0,0,0,0.1)"},onMouseLeave:h=>{h.currentTarget.style.transform="translateY(0)",h.currentTarget.style.boxShadow="0 2px 6px rgba(0,0,0,0.05)"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"12px"},children:[t.jsx("span",{style:{fontSize:"1.8rem"},children:p.icone||""}),t.jsx("h3",{style:{fontSize:"1.1rem",fontWeight:600,color:"#2d3748",margin:0},children:p.nom})]}),p.description&&t.jsx("p",{style:{fontSize:"0.875rem",color:"#718096",marginBottom:"12px",lineHeight:1.5},children:p.description.length>100?`${p.description.slice(0,100)}...`:p.description}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",marginBottom:"8px"},children:t.jsx("span",{style:{display:"inline-block",padding:"2px 10px",borderRadius:"10px",fontSize:"0.75rem",fontWeight:500,background:f.bgLight,color:f.color},children:EA(p.classe)})}),p.coefficient!==void 0&&t.jsxs("p",{style:{fontSize:"0.8rem",color:"#a0aec0"},children:["Coefficient : ",p.coefficient]})]},p.id))})]})},yc="disciplines",T1=e=>{const r=e.data();return{id:e.id,nom:r.nom,niveau:r.niveau,classe:r.classe,ordre:r.ordre,coefficient:r.coefficient,couleur:r.couleur,icone:r.icone,description:r.description,createdAt:r.createdAt?.toDate()||new Date,updatedAt:r.updatedAt?.toDate()}},is={async getAll(e){try{const r=[Ve("ordre","asc")];e?.niveau&&r.unshift(Ne("niveau","==",e.niveau)),e?.classe&&r.unshift(Ne("classe","==",e.classe));const n=Ee(_e(Q,yc),...r);return(await Ce(n)).docs.map(T1)}catch(r){throw console.error("Erreur lors de la rcupration des disciplines:",r),new Error("Impossible de rcuprer les disciplines")}},async getById(e){try{const r=je(Q,yc,e),n=await Et(r);return n.exists()?T1(n):null}catch(r){throw console.error("Erreur lors de la rcupration de la discipline:",r),new Error("Impossible de rcuprer la discipline")}},async getByNiveau(e){return this.getAll({niveau:e})},async getByClasse(e){return this.getAll({classe:e})},async create(e){try{return(await Pt(_e(Q,yc),{...e,createdAt:Dt(),updatedAt:Dt()})).id}catch(r){throw console.error("Erreur lors de la cration de la discipline:",r),new Error("Impossible de crer la discipline")}},async update(e,r){try{const n=je(Q,yc,e);await He(n,{...r,updatedAt:Dt()})}catch(n){throw console.error("Erreur lors de la mise  jour de la discipline:",n),new Error("Impossible de mettre  jour la discipline")}},async delete(e){try{const r=je(Q,yc,e);await Br(r)}catch(r){throw console.error("Erreur lors de la suppression de la discipline:",r),new Error("Impossible de supprimer la discipline")}},async exists(e){return await this.getById(e)!==null},async countByNiveau(e){return(await this.getByNiveau(e)).length}},u5="modulepreload",d5=function(e){return"/"+e},q1={},R1=function(r,n,a){let l=Promise.resolve();if(n&&n.length>0){let f=function(p){return Promise.all(p.map(h=>Promise.resolve(h).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=u?.nonce||u?.getAttribute("nonce");l=f(n.map(p=>{if(p=d5(p),p in q1)return;q1[p]=!0;const h=p.endsWith(".css"),v=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${v}`))return;const b=document.createElement("link");if(b.rel=h?"stylesheet":u5,h||(b.as="script"),b.crossOrigin="",b.href=p,d&&b.setAttribute("nonce",d),document.head.appendChild(b),h)return new Promise((x,j)=>{b.addEventListener("load",x),b.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return l.then(u=>{for(const d of u||[])d.status==="rejected"&&o(d.reason);return r().catch(o)})},As="ressources",m5="ressources",I1=e=>{const r=e.data();return{id:e.id,disciplineId:r.disciplineId,titre:r.titre,type:r.type,contenu:r.contenu,description:r.description,isPremium:r.isPremium||!1,ordre:r.ordre||0,chapitre:r.chapitre,fichierURL:r.fichierURL,fichierNom:r.fichierNom,dureeEstimee:r.dureeEstimee,duree:r.duree,tags:r.tags||[],actif:r.actif!==!1,urlExterne:r.urlExterne,chapitreId:r.chapitreId,auteurId:r.auteurId,createdAt:r.createdAt?.toDate()||new Date,updatedAt:r.updatedAt?.toDate()}},f5=e=>{const r=Date.now(),n=e.split(".").pop();return`${e.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9]/g,"_")}_${r}.${n}`},fa={async getAll(e,r){try{const n=[Ve("ordre","asc")];e?.disciplineId&&n.unshift(Ne("disciplineId","==",e.disciplineId)),e?.chapitreId&&n.unshift(Ne("chapitre","==",e.chapitreId)),e?.type&&n.unshift(Ne("type","==",e.type)),e?.isPremium!==void 0&&n.unshift(Ne("isPremium","==",e.isPremium)),e?.auteurId&&n.unshift(Ne("auteurId","==",e.auteurId)),r&&n.push(Ht(r));const a=Ee(_e(Q,As),...n);return(await Ce(a)).docs.map(I1)}catch(n){throw console.error("Erreur lors de la rcupration des ressources:",n),new Error("Impossible de rcuprer les ressources")}},async getById(e){try{const r=je(Q,As,e),n=await Et(r);return n.exists()?I1(n):null}catch(r){throw console.error("Erreur lors de la rcupration de la ressource:",r),new Error("Impossible de rcuprer la ressource")}},async getByDiscipline(e){return this.getAll({disciplineId:e})},async getByChapitre(e){return this.getAll({chapitreId:e})},async getByType(e){return this.getAll({type:e})},async getPremium(){return this.getAll({isPremium:!0})},async getFree(){return this.getAll({isPremium:!1})},async create(e,r){try{const n={...e,auteurId:r,createdAt:Dt(),updatedAt:Dt()};return Object.keys(n).forEach(l=>{n[l]===void 0&&delete n[l]}),(await Pt(_e(Q,As),n)).id}catch(n){throw console.error("Erreur lors de la cration de la ressource:",n),new Error("Impossible de crer la ressource")}},async update(e,r){try{const n={...r,updatedAt:Dt()};Object.keys(n).forEach(l=>{n[l]===void 0&&delete n[l]});const a=je(Q,As,e);await He(a,n)}catch(n){throw console.error("Erreur lors de la mise  jour de la ressource:",n),new Error("Impossible de mettre  jour la ressource")}},async delete(e){try{const r=await this.getById(e);r?.fichierURL&&await this.deleteFile(r.fichierURL);const n=je(Q,As,e);await Br(n)}catch(r){throw console.error("Erreur lors de la suppression de la ressource:",r),new Error("Impossible de supprimer la ressource")}},async deleteByDiscipline(e){try{const r=await this.getByDiscipline(e),n=Tn(Q);for(const a of r){a.fichierURL&&await this.deleteFile(a.fichierURL);const l=je(Q,As,a.id);n.delete(l)}await n.commit()}catch(r){throw console.error("Erreur lors de la suppression des ressources:",r),new Error("Impossible de supprimer les ressources")}},async uploadFile(e,r){try{const n=f5(e.name),a=`${m5}/${r}/${n}`,l=sr(er,a);return await Ls(l,e),await Mn(l)}catch(n){throw console.error("Erreur lors de l'upload du fichier:",n),new Error("Impossible d'uploader le fichier")}},async deleteFile(e){try{const r=sr(er,e);await Is(r)}catch(r){console.warn("Fichier non trouv ou dj supprim:",r)}},async reorder(e,r){try{const n=Tn(Q);r.forEach((a,l)=>{const o=je(Q,As,a);n.update(o,{ordre:l+1,updatedAt:Dt()})}),await n.commit()}catch(n){throw console.error("Erreur lors de la rorganisation des ressources:",n),new Error("Impossible de rorganiser les ressources")}},async togglePremium(e,r){await this.update(e,{isPremium:r})},async toggleActive(e,r){await this.update(e,{actif:r})},async countByType(e){return(await this.getByType(e)).length},async getStats(){try{const e=await this.getAll(),r={total:e.length,premium:e.filter(n=>n.isPremium).length,gratuit:e.filter(n=>!n.isPremium).length,parType:{cours:0,exercice:0,video:0,document:0,quiz:0}};return e.forEach(n=>{r.parType[n.type]!==void 0&&r.parType[n.type]++}),r}catch(e){throw console.error("Erreur lors du calcul des statistiques:",e),new Error("Impossible de calculer les statistiques")}}},p5=()=>{const{id:e}=xn(),r=Je(),[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState([]),[f,p]=g.useState(!0),[h,v]=g.useState(null),[b,x]=g.useState("tous"),[j,_]=g.useState(new Set),C=g.useCallback(async()=>{if(e)try{p(!0),v(null);const B=await is.getById(e);if(!B){v("Discipline introuvable."),p(!1);return}a(B);const U=await fa.getAll({disciplineId:e}),$=new Map,R=[];for(const ae of U){const M=ae.chapitre||ae.chapitreId;M?($.has(M)||$.set(M,[]),$.get(M).push(ae)):R.push(ae)}const Y=Array.from($.entries()).map(([ae,M])=>({chapitreNom:ae,ressources:M.sort((T,F)=>T.ordre-F.ordre)})).sort((ae,M)=>ae.chapitreNom.localeCompare(M.chapitreNom,"fr"));o(Y),d(R),Y.length>0&&_(new Set([Y[0].chapitreNom]))}catch(B){console.error("Erreur chargement discipline:",B),v("Impossible de charger les donnes. Ressayez plus tard.")}finally{p(!1)}},[e]);g.useEffect(()=>{C()},[C]);const w=B=>{_(U=>{const $=new Set(U);return $.has(B)?$.delete(B):$.add(B),$})},E=B=>b==="tous"?B:B.filter(U=>U.type===b),S=B=>{switch(B){case"cours":return"";case"exercice":return"";case"video":return"";case"document":return"";case"quiz":return"";default:return""}},A=B=>{switch(B){case"cours":return"Cours";case"exercice":return"Exercice";case"video":return"Vido";case"document":return"Document";case"quiz":return"Quiz";default:return B}},O=B=>{switch(B){case"cours":return"#3b82f6";case"exercice":return"#10b981";case"video":return"#f59e0b";case"document":return"#8b5cf6";case"quiz":return"#ef4444";default:return"#6b7280"}},k=B=>B==="college"?"Collge":"Lyce";if(f)return t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"4rem 1rem",minHeight:"50vh"},children:[t.jsx("div",{style:{width:"48px",height:"48px",border:"4px solid #e5e7eb",borderTopColor:"#2563eb",borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),t.jsx("p",{style:{marginTop:"1rem",color:"#6b7280"},children:"Chargement de la discipline..."}),t.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"})]});if(h||!n)return t.jsxs("div",{style:{maxWidth:"600px",margin:"3rem auto",padding:"2rem",textAlign:"center",background:"#fef2f2",borderRadius:"12px",border:"1px solid #fecaca"},children:[t.jsx("span",{style:{fontSize:"3rem"},children:""}),t.jsx("h2",{style:{color:"#991b1b",margin:"1rem 0 0.5rem"},children:h||"Discipline introuvable"}),t.jsx("p",{style:{color:"#b91c1c",marginBottom:"1.5rem"},children:"Vrifiez le lien ou retournez  la liste des disciplines."}),t.jsx("button",{onClick:()=>r("/disciplines"),style:{padding:"0.75rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"1rem",fontWeight:600},children:" Retour aux disciplines"})]});const P=[...l.flatMap(B=>B.ressources),...u],D=[...new Set(P.map(B=>B.type))];return t.jsxs("div",{style:{maxWidth:"900px",margin:"0 auto",padding:"1.5rem 1rem"},children:[t.jsxs("nav",{style:{marginBottom:"1.5rem",fontSize:"0.875rem",color:"#6b7280"},children:[t.jsx(Le,{to:"/",style:{color:"#2563eb",textDecoration:"none"},children:"Accueil"}),t.jsx("span",{style:{margin:"0 0.5rem"},children:"/"}),t.jsx(Le,{to:"/disciplines",style:{color:"#2563eb",textDecoration:"none"},children:"Disciplines"}),t.jsx("span",{style:{margin:"0 0.5rem"},children:"/"}),t.jsx("span",{style:{color:"#374151"},children:n.nom})]}),t.jsxs("header",{style:{background:"linear-gradient(135deg, #1e40af 0%, #3b82f6 100%)",borderRadius:"16px",padding:"2rem",color:"#fff",marginBottom:"2rem"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.75rem"},children:[t.jsx("span",{style:{fontSize:"2.5rem"},children:n.icone||""}),t.jsxs("div",{children:[t.jsx("h1",{style:{fontSize:"1.75rem",fontWeight:700,margin:0},children:n.nom}),n.description&&t.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.9,fontSize:"0.95rem"},children:n.description})]})]}),t.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap",marginTop:"1rem"},children:[t.jsxs("span",{style:{background:"rgba(255,255,255,0.2)",padding:"0.35rem 0.75rem",borderRadius:"20px",fontSize:"0.8rem",fontWeight:600},children:[" ",k(n.niveau),"  ",n.classe]}),t.jsxs("span",{style:{background:"rgba(255,255,255,0.2)",padding:"0.35rem 0.75rem",borderRadius:"20px",fontSize:"0.8rem",fontWeight:600},children:[" ",P.length," ressource",P.length!==1?"s":""]}),n.coefficient&&t.jsxs("span",{style:{background:"rgba(255,255,255,0.2)",padding:"0.35rem 0.75rem",borderRadius:"20px",fontSize:"0.8rem",fontWeight:600},children:[" Coeff. ",n.coefficient]})]})]}),D.length>1&&t.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginBottom:"1.5rem"},children:[t.jsxs("button",{onClick:()=>x("tous"),style:{padding:"0.5rem 1rem",borderRadius:"20px",border:b==="tous"?"2px solid #2563eb":"1px solid #d1d5db",background:b==="tous"?"#2563eb":"#fff",color:b==="tous"?"#fff":"#374151",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:["Tous (",P.length,")"]}),D.map(B=>{const U=P.filter(R=>R.type===B).length,$=b===B;return t.jsxs("button",{onClick:()=>x(B),style:{padding:"0.5rem 1rem",borderRadius:"20px",border:$?`2px solid ${O(B)}`:"1px solid #d1d5db",background:$?O(B):"#fff",color:$?"#fff":"#374151",cursor:"pointer",fontSize:"0.85rem",fontWeight:600,transition:"all 0.2s"},children:[S(B)," ",A(B)," (",U,")"]},B)})]}),l.length===0&&u.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"3rem 1rem",background:"#f9fafb",borderRadius:"12px",border:"1px solid #e5e7eb"},children:[t.jsx("span",{style:{fontSize:"3rem"},children:""}),t.jsx("h3",{style:{color:"#374151",margin:"1rem 0 0.5rem"},children:"Aucune ressource disponible"}),t.jsx("p",{style:{color:"#6b7280"},children:"Les cours et exercices pour cette discipline seront bientt ajouts."})]}):t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[l.map(B=>{const U=E(B.ressources);if(U.length===0&&b!=="tous")return null;const $=j.has(B.chapitreNom),R=b==="tous"?B.ressources:U;return t.jsxs("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e5e7eb",overflow:"hidden",transition:"box-shadow 0.2s",boxShadow:$?"0 4px 12px rgba(0,0,0,0.08)":"none"},children:[t.jsx("button",{onClick:()=>w(B.chapitreNom),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1rem 1.25rem",background:$?"#f0f5ff":"#fff",border:"none",cursor:"pointer",textAlign:"left",transition:"background 0.2s"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[t.jsx("span",{style:{fontSize:"1.25rem",transform:$?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s"},children:""}),t.jsxs("div",{children:[t.jsx("span",{style:{fontWeight:700,color:"#1f2937",fontSize:"1rem"},children:B.chapitreNom}),t.jsxs("span",{style:{display:"block",fontSize:"0.75rem",color:"#6b7280",marginTop:"2px"},children:[B.ressources.length," ressource",B.ressources.length!==1?"s":""]})]})]})}),$&&t.jsx("div",{style:{padding:"0 1.25rem 1rem",display:"flex",flexDirection:"column",gap:"0.5rem"},children:R.map(Y=>t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #f3f4f6",transition:"background 0.15s",cursor:"pointer"},onMouseEnter:ae=>ae.currentTarget.style.background="#eef2ff",onMouseLeave:ae=>ae.currentTarget.style.background="#f9fafb",children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flex:1},children:[t.jsx("span",{style:{fontSize:"1.2rem"},children:S(Y.type)}),t.jsxs("div",{children:[t.jsx("span",{style:{fontWeight:600,color:"#1f2937",fontSize:"0.9rem"},children:Y.titre}),Y.description&&t.jsx("span",{style:{display:"block",fontSize:"0.75rem",color:"#9ca3af",marginTop:"2px"},children:Y.description})]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexShrink:0},children:[t.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#fff",background:O(Y.type)},children:A(Y.type)}),Y.isPremium&&t.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#92400e",background:"#fef3c7",border:"1px solid #fde68a"},children:" Premium"}),Y.dureeEstimee&&t.jsxs("span",{style:{fontSize:"0.75rem",color:"#6b7280"},children:[" ",Y.dureeEstimee," min"]})]})]},Y.id))})]},B.chapitreNom)}),E(u).length>0&&t.jsxs("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e5e7eb",padding:"1rem 1.25rem"},children:[t.jsx("h3",{style:{fontSize:"1rem",fontWeight:700,color:"#374151",marginBottom:"0.75rem"},children:" Autres ressources"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:E(u).map(B=>t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #f3f4f6"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[t.jsx("span",{style:{fontSize:"1.2rem"},children:S(B.type)}),t.jsx("span",{style:{fontWeight:600,color:"#1f2937",fontSize:"0.9rem"},children:B.titre})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#fff",background:O(B.type)},children:A(B.type)}),B.isPremium&&t.jsx("span",{style:{padding:"0.2rem 0.6rem",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,color:"#92400e",background:"#fef3c7",border:"1px solid #fde68a"},children:" Premium"})]})]},B.id))})]})]}),t.jsx("div",{style:{marginTop:"2rem",textAlign:"center"},children:t.jsx(Le,{to:"/disciplines",style:{display:"inline-block",padding:"0.75rem 1.5rem",background:"#f3f4f6",color:"#374151",borderRadius:"8px",textDecoration:"none",fontWeight:600,transition:"background 0.2s"},children:" Retour aux disciplines"})})]})},h5=()=>{const{login:e,loginWithGoogle:r}=Ke(),n=Je(),l=Lb().state?.from||"/",[o,u]=g.useState({email:"",password:""}),[d,f]=g.useState(!1),[p,h]=g.useState(!1),[v,b]=g.useState(""),[x,j]=g.useState(!1),_=S=>{const{name:A,value:O}=S.target;u(k=>({...k,[A]:O})),v&&b("")},C=()=>o.email.trim()?o.password?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email)?!0:(b("Veuillez entrer une adresse email valide."),!1):(b("Veuillez entrer votre mot de passe."),!1):(b("Veuillez entrer votre adresse email."),!1),w=async S=>{if(S.preventDefault(),!!C()){f(!0),b("");try{await e(o.email,o.password),n(l,{replace:!0})}catch(A){A instanceof Error?b(A.message):b("Une erreur est survenue lors de la connexion.")}finally{f(!1)}}},E=async()=>{h(!0),b("");try{await r(),n(l,{replace:!0})}catch(S){S instanceof Error&&b(S.message)}finally{h(!1)}};return t.jsx("div",{className:"auth-page",children:t.jsxs("div",{className:"auth-container",children:[t.jsxs("div",{className:"auth-card",children:[t.jsxs("div",{className:"auth-header",children:[t.jsxs(Le,{to:"/",className:"auth-logo",children:[t.jsx("div",{className:"auth-logo__icon",children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})})}),t.jsx("span",{children:"PedaClic"})]}),t.jsx("h1",{className:"auth-title",children:"Connexion"}),t.jsx("p",{className:"auth-subtitle",children:"Accdez  votre espace d'apprentissage"})]}),v&&t.jsxs("div",{className:"auth-error",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("path",{d:"M12 8v4M12 16h.01"})]}),t.jsx("span",{children:v})]}),t.jsxs("form",{onSubmit:w,className:"auth-form",children:[t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"email",className:"auth-label",children:"Adresse email"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("input",{type:"email",id:"email",name:"email",value:o.email,onChange:_,placeholder:"exemple@email.com",className:"auth-input",autoComplete:"email",disabled:d})]})]}),t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"password",className:"auth-label",children:"Mot de passe"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:[t.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",strokeWidth:"2"}),t.jsx("path",{strokeWidth:"2",d:"M7 11V7a5 5 0 0110 0v4"})]}),t.jsx("input",{type:x?"text":"password",id:"password",name:"password",value:o.password,onChange:_,placeholder:"Votre mot de passe",className:"auth-input",autoComplete:"current-password",disabled:d}),t.jsx("button",{type:"button",className:"auth-password-toggle",onClick:()=>j(!x),"aria-label":x?"Masquer le mot de passe":"Afficher le mot de passe",children:x?t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),t.jsx("div",{className:"auth-forgot",children:t.jsx(Le,{to:"/mot-de-passe-oublie",className:"auth-forgot-link",children:"Mot de passe oubli ?"})}),t.jsx("button",{type:"submit",className:"auth-button",disabled:d,children:d?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"auth-button-spinner"}),"Connexion en cours..."]}):"Se connecter"})]}),t.jsx("div",{className:"auth-divider",children:t.jsx("span",{children:"ou"})}),t.jsx("button",{type:"button",className:"auth-google-btn",onClick:E,disabled:d||p,children:p?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"auth-button-spinner auth-button-spinner--dark"}),"Connexion en cours"]}):t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"auth-google-icon",viewBox:"0 0 24 24","aria-hidden":"true",children:[t.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),t.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),t.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z"}),t.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continuer avec Google"]})}),t.jsxs("p",{className:"auth-switch",children:["Pas encore de compte ?"," ",t.jsx(Le,{to:"/inscription",className:"auth-switch-link",children:"Crer un compte"})]})]}),t.jsxs("div",{className:"auth-welcome",children:[t.jsx("h2",{children:"Bienvenue sur PedaClic !"}),t.jsx("p",{children:"L'cole en un clic - Accdez  des milliers de cours, exercices et quiz."}),t.jsxs("ul",{className:"auth-features",children:[t.jsxs("li",{children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Cours du programme sngalais"]}),t.jsxs("li",{children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Exercices interactifs"]}),t.jsxs("li",{children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Quiz pour tester vos connaissances"]}),t.jsxs("li",{children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:t.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Suivi de progression"]})]})]})]})})},v5=()=>{const{register:e,loginWithGoogle:r}=Ke(),n=Je(),[a,l]=g.useState({email:"",password:"",confirmPassword:"",displayName:"",role:"eleve"}),[o,u]=g.useState(!1),[d,f]=g.useState(""),[p,h]=g.useState(!1),[v,b]=g.useState(!1),[x,j]=g.useState(!1),[_,C]=g.useState(!1),w=O=>{const{name:k,value:P}=O.target;l(D=>({...D,[k]:P})),d&&f("")},E=()=>a.displayName.trim()?a.displayName.trim().length<2?(f("Le nom doit contenir au moins 2 caractres."),!1):a.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)?a.password?a.password.length<6?(f("Le mot de passe doit contenir au moins 6 caractres."),!1):a.password!==a.confirmPassword?(f("Les mots de passe ne correspondent pas."),!1):x?!0:(f("Veuillez accepter les conditions d'utilisation."),!1):(f("Veuillez entrer un mot de passe."),!1):(f("Veuillez entrer une adresse email valide."),!1):(f("Veuillez entrer votre adresse email."),!1):(f("Veuillez entrer votre nom complet."),!1),S=async O=>{if(O.preventDefault(),!!E()){u(!0),f("");try{await e(a),n("/disciplines",{replace:!0})}catch(k){k instanceof Error?f(k.message):f("Une erreur est survenue lors de l'inscription.")}finally{u(!1)}}},A=async()=>{if(!x){f("Veuillez accepter les conditions d'utilisation.");return}C(!0),f("");try{await r(a.role),n("/disciplines",{replace:!0})}catch(O){O instanceof Error&&f(O.message)}finally{C(!1)}};return t.jsx("div",{className:"auth-page",children:t.jsxs("div",{className:"auth-container",children:[t.jsxs("div",{className:"auth-card auth-card--register",children:[t.jsxs("div",{className:"auth-header",children:[t.jsxs(Le,{to:"/",className:"auth-logo",children:[t.jsx("div",{className:"auth-logo__icon",children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})})}),t.jsx("span",{children:"PedaClic"})]}),t.jsx("h1",{className:"auth-title",children:"Crer un compte"}),t.jsx("p",{className:"auth-subtitle",children:"Rejoignez PedaClic et commencez  apprendre"})]}),d&&t.jsxs("div",{className:"auth-error",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("path",{d:"M12 8v4M12 16h.01"})]}),t.jsx("span",{children:d})]}),t.jsxs("form",{onSubmit:S,className:"auth-form",children:[t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"displayName",className:"auth-label",children:"Nom complet"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),t.jsx("input",{type:"text",id:"displayName",name:"displayName",value:a.displayName,onChange:w,placeholder:"Amadou Diallo",className:"auth-input",autoComplete:"name",disabled:o})]})]}),t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"email",className:"auth-label",children:"Adresse email"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("input",{type:"email",id:"email",name:"email",value:a.email,onChange:w,placeholder:"exemple@email.com",className:"auth-input",autoComplete:"email",disabled:o})]})]}),t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{className:"auth-label",children:"Je suis :"}),t.jsxs("div",{className:"auth-role-selector",children:[t.jsxs("label",{className:`auth-role-option ${a.role==="eleve"?"auth-role-option--selected":""}`,children:[t.jsx("input",{type:"radio",name:"role",value:"eleve",checked:a.role==="eleve",onChange:w,className:"auth-role-input",disabled:o}),t.jsxs("div",{className:"auth-role-content",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 14l9-5-9-5-9 5 9 5z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"})]}),t.jsx("span",{children:"lve"})]})]}),t.jsxs("label",{className:`auth-role-option ${a.role==="prof"?"auth-role-option--selected":""}`,children:[t.jsx("input",{type:"radio",name:"role",value:"prof",checked:a.role==="prof",onChange:w,className:"auth-role-input",disabled:o}),t.jsxs("div",{className:"auth-role-content",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),t.jsx("span",{children:"Professeur"})]})]}),t.jsxs("label",{className:`auth-role-option ${a.role==="parent"?"auth-role-option--selected":""}`,children:[t.jsx("input",{type:"radio",name:"role",value:"parent",checked:a.role==="parent",onChange:w,className:"auth-role-input",disabled:o}),t.jsxs("div",{className:"auth-role-content",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})}),t.jsx("span",{children:"Parent d'lve"})]})]})]})]}),t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"password",className:"auth-label",children:"Mot de passe"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:[t.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",strokeWidth:"2"}),t.jsx("path",{strokeWidth:"2",d:"M7 11V7a5 5 0 0110 0v4"})]}),t.jsx("input",{type:p?"text":"password",id:"password",name:"password",value:a.password,onChange:w,placeholder:"Minimum 6 caractres",className:"auth-input",autoComplete:"new-password",disabled:o}),t.jsx("button",{type:"button",className:"auth-password-toggle",onClick:()=>h(!p),"aria-label":p?"Masquer":"Afficher",children:p?t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),t.jsx("p",{className:"auth-hint",children:"Au moins 6 caractres avec des lettres et des chiffres"})]}),t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"confirmPassword",className:"auth-label",children:"Confirmer le mot de passe"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),t.jsx("input",{type:v?"text":"password",id:"confirmPassword",name:"confirmPassword",value:a.confirmPassword,onChange:w,placeholder:"Retapez votre mot de passe",className:"auth-input",autoComplete:"new-password",disabled:o}),t.jsx("button",{type:"button",className:"auth-password-toggle",onClick:()=>b(!v),"aria-label":v?"Masquer":"Afficher",children:v?t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),t.jsx("div",{className:"auth-checkbox-field",children:t.jsxs("label",{className:"auth-checkbox-label",children:[t.jsx("input",{type:"checkbox",checked:x,onChange:O=>j(O.target.checked),className:"auth-checkbox",disabled:o}),t.jsx("span",{className:"auth-checkbox-custom"}),t.jsxs("span",{children:["J'accepte les"," ",t.jsx(Le,{to:"/cgu",target:"_blank",className:"auth-link",children:"conditions d'utilisation"})," ","et la"," ",t.jsx(Le,{to:"/confidentialite",target:"_blank",className:"auth-link",children:"politique de confidentialit"})]})]})}),t.jsx("button",{type:"submit",className:"auth-button",disabled:o,children:o?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"auth-button-spinner"}),"Cration du compte..."]}):"Crer mon compte"})]}),t.jsx("div",{className:"auth-divider",children:t.jsx("span",{children:"ou"})}),t.jsx("button",{type:"button",className:"auth-google-btn",onClick:A,disabled:o||_,children:_?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"auth-button-spinner auth-button-spinner--dark"}),"Cration du compte"]}):t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:"auth-google-icon",viewBox:"0 0 24 24","aria-hidden":"true",children:[t.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),t.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),t.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z"}),t.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"S'inscrire avec Google"]})}),t.jsx("p",{className:"auth-google-hint",children:"Le rle slectionn ci-dessus sera utilis pour votre compte Google."}),t.jsxs("p",{className:"auth-switch",children:["Dj un compte ?"," ",t.jsx(Le,{to:"/connexion",className:"auth-switch-link",children:"Se connecter"})]})]}),t.jsxs("div",{className:"auth-welcome auth-welcome--register",children:[t.jsx("h2",{children:"Rejoignez la communaut PedaClic"}),t.jsx("p",{children:"Des milliers d'lves et professeurs sngalais nous font dj confiance."}),t.jsxs("div",{className:"auth-stats",children:[t.jsxs("div",{className:"auth-stat",children:[t.jsx("span",{className:"auth-stat-number",children:"10 000+"}),t.jsx("span",{className:"auth-stat-label",children:"lves inscrits"})]}),t.jsxs("div",{className:"auth-stat",children:[t.jsx("span",{className:"auth-stat-number",children:"500+"}),t.jsx("span",{className:"auth-stat-label",children:"Cours disponibles"})]}),t.jsxs("div",{className:"auth-stat",children:[t.jsx("span",{className:"auth-stat-number",children:"95%"}),t.jsx("span",{className:"auth-stat-label",children:"Taux de satisfaction"})]})]}),t.jsxs("div",{className:"auth-testimonial",children:[t.jsx("p",{className:"auth-testimonial-text",children:`"Grce  PedaClic, j'ai amlior mes notes en mathmatiques de 4 points !"`}),t.jsx("p",{className:"auth-testimonial-author",children:" Fatou N., lve de 3me  Dakar"})]})]})]})})},g5=()=>{const e=async b=>{const{sendPasswordResetEmail:x}=await R1(async()=>{const{sendPasswordResetEmail:_}=await import("./vendor-firebase-LntcAirY.js").then(C=>C.K);return{sendPasswordResetEmail:_}},[]),{auth:j}=await R1(async()=>{const{auth:_}=await Promise.resolve().then(()=>H3);return{auth:_}},void 0);await x(j,b)},[r,n]=g.useState(""),[a,l]=g.useState(!1),[o,u]=g.useState(""),[d,f]=g.useState(!1),p=()=>r.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)?!0:(u("Veuillez entrer une adresse email valide."),!1):(u("Veuillez entrer votre adresse email."),!1),h=async b=>{if(b.preventDefault(),!!p()){l(!0),u("");try{await e(r),f(!0)}catch(x){x instanceof Error?u(x.message):u("Une erreur est survenue. Veuillez ressayer.")}finally{l(!1)}}},v=()=>{f(!1),n(""),u("")};return t.jsx("div",{className:"auth-page",children:t.jsx("div",{className:"auth-container auth-container--centered",children:t.jsxs("div",{className:"auth-card auth-card--narrow",children:[t.jsx("div",{className:"auth-header",children:t.jsxs(Le,{to:"/",className:"auth-logo",children:[t.jsx("div",{className:"auth-logo__icon",children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"})})}),t.jsx("span",{children:"PedaClic"})]})}),d?t.jsxs("div",{className:"auth-success-content",children:[t.jsx("div",{className:"auth-success-icon",children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),t.jsx("h1",{className:"auth-title",children:"Email envoy !"}),t.jsxs("p",{className:"auth-subtitle",children:["Nous avons envoy un lien de rinitialisation  ",t.jsx("strong",{children:r})]}),t.jsxs("div",{className:"auth-instructions",children:[t.jsx("p",{children:"Vrifiez votre bote de rception et cliquez sur le lien pour rinitialiser votre mot de passe."}),t.jsxs("p",{className:"auth-instructions-note",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("path",{d:"M12 16v-4M12 8h.01"})]}),"Si vous ne voyez pas l'email, vrifiez votre dossier spam."]})]}),t.jsxs("div",{className:"auth-success-actions",children:[t.jsx(Le,{to:"/connexion",className:"auth-button",children:"Retour  la connexion"}),t.jsx("button",{type:"button",className:"auth-button auth-button--outline",onClick:v,children:"Renvoyer l'email"})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"auth-icon",children:t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),t.jsx("h1",{className:"auth-title",children:"Mot de passe oubli ?"}),t.jsx("p",{className:"auth-subtitle",children:"Pas de panique ! Entrez votre email et nous vous enverrons un lien pour rinitialiser votre mot de passe."}),o&&t.jsxs("div",{className:"auth-error",children:[t.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("path",{d:"M12 8v4M12 16h.01"})]}),t.jsx("span",{children:o})]}),t.jsxs("form",{onSubmit:h,className:"auth-form",children:[t.jsxs("div",{className:"auth-field",children:[t.jsx("label",{htmlFor:"email",className:"auth-label",children:"Adresse email"}),t.jsxs("div",{className:"auth-input-wrapper",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"auth-input-icon",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.jsx("input",{type:"email",id:"email",value:r,onChange:b=>{n(b.target.value),o&&u("")},placeholder:"exemple@email.com",className:"auth-input",autoComplete:"email",disabled:a,autoFocus:!0})]})]}),t.jsx("button",{type:"submit",className:"auth-button",disabled:a,children:a?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"auth-button-spinner"}),"Envoi en cours..."]}):"Envoyer le lien"})]}),t.jsx("div",{className:"auth-back",children:t.jsxs(Le,{to:"/connexion",className:"auth-back-link",children:[t.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Retour  la connexion"]})})]})]})})})},AA="https://api.pedaclic.sn",Va={a_la_carte_1:{label:"1 cours",montant:1e3,duree:"1 mois",description:"Choisissez 1 cours par discipline et niveau"},a_la_carte_3:{label:"3 cours",montant:2e3,duree:"1 mois",description:"Choisissez 3 cours par discipline et niveau"},a_la_carte_7:{label:"7 cours",montant:5e3,duree:"1 mois",description:"Choisissez 7 cours par discipline et niveau"},a_la_carte_tous:{label:"Tous les contenus",montant:25e3,duree:"9 mois",description:"Accs  l'intgralit du catalogue pendant 9 mois"},illimite_3m:{label:"3 mois",montant:1e4,duree:"3 mois",description:"Accs illimit aux cours, quiz et ressources pendant 3 mois"},illimite_6m:{label:"6 mois",montant:2e4,duree:"6 mois",description:"Accs illimit pendant 6 mois  conomisez 10 000 FCFA !"},illimite_1an:{label:"1 an",montant:3e4,duree:"1 an",description:"Accs illimit toute l'anne  conomisez 30 000 FCFA !"}};async function x5(e){const r=await fetch(`${AA}/api/moneroo/initiate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok){const a=await r.json().catch(()=>({}));throw new Error(a.error||`Erreur serveur (${r.status})`)}const n=await r.json();if(!n.success||!n.checkoutUrl)throw new Error("Rponse invalide du serveur de paiement");return n}async function b5(e){const r=await fetch(`${AA}/api/moneroo/verify/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error(`Erreur vrification paiement (${r.status})`);return r.json()}function y5(e){window.location.href=e}function j5(){const e=new URLSearchParams(window.location.search);return{paymentId:e.get("paymentId"),paymentStatus:e.get("paymentStatus"),status:e.get("status")}}const _5=[{icone:"",titre:"Cours complets",description:"Accs illimit  tous les cours du programme sngalais 6me  Terminale"},{icone:"",titre:"Quiz illimits",description:"Tous les quiz par matire avec corrections dtailles et explications"},{icone:"",titre:"Gnrateur IA",description:"Gnration de cours, fiches de rvision et valuations par intelligence artificielle"},{icone:"",titre:"Suivi de progression",description:"Tableaux de bord analytiques pour suivre les performances en temps rel"},{icone:"",titre:"Bibliothque ebooks",description:"Accs  tous les manuels et ressources pdagogiques numriques"},{icone:"",titre:"Notifications",description:"Alertes personnalises pour devoirs, valuations et rappels scolaires"}],N5=[{nom:"Wave",couleur:"#1976D2",emoji:""},{nom:"Orange Money",couleur:"#FF6B00",emoji:""},{nom:"Free Money",couleur:"#E30613",emoji:""},{nom:"FLASH",couleur:"#6B21A8",emoji:""},{nom:"Carte Bancaire",couleur:"#059669",emoji:""}];function S5(){const e=Je(),{currentUser:r}=Ke(),[n,a]=g.useState("a_la_carte"),[l,o]=g.useState("a_la_carte_3"),[u,d]=g.useState(!1),[f,p]=g.useState(null),h=r?.isPremium===!0;async function v(){if(!r){e("/login?redirect=/premium");return}d(!0),p(null);try{const b=await x5({plan:l,userId:r.uid,userEmail:r.email||"",userFirstName:r.displayName?.split(" ")[0]||"lve",userLastName:r.displayName?.split(" ")[1]||"PedaClic"});y5(b.checkoutUrl)}catch(b){p(b instanceof Error?b.message:"Une erreur est survenue. Veuillez ressayer."),d(!1)}}return t.jsxs("div",{className:"premium-page",children:[t.jsx("header",{className:"premium-hero",children:t.jsxs("div",{className:"premium-hero__content",children:[t.jsx("span",{className:"premium-hero__badge",children:" PREMIUM"}),t.jsx("h1",{className:"premium-hero__titre",children:"Dbloque tout PedaClic"}),t.jsxs("p",{className:"premium-hero__sous-titre",children:["Accde  tous les cours, quiz et ressources du programme sngalais.",t.jsx("br",{}),"Du 6me au BAC  ",t.jsx("strong",{children:"L'cole en un clic !"})]})]})}),t.jsxs("div",{className:"premium-contenu",children:[h&&t.jsxs("section",{className:"premium-abonne",children:[t.jsx("div",{className:"premium-abonne__icone",children:""}),t.jsx("h2",{children:"Tu es dj abonn Premium !"}),t.jsx("p",{children:"Ton abonnement est actif. Profite de tous les contenus exclusifs."}),t.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/dashboard"),children:"Aller au tableau de bord"})]}),!h&&t.jsxs("section",{className:"premium-plans",children:[t.jsx("h2",{className:"premium-section__titre",children:"Choisir un abonnement"}),t.jsxs("div",{className:"premium-pricing__tabs",style:{marginBottom:"1.5rem"},children:[t.jsx("button",{type:"button",className:`premium-pricing__tab ${n==="a_la_carte"?"premium-pricing__tab--active":""}`,onClick:()=>{a("a_la_carte"),o("a_la_carte_3")},children:" Cours  la carte"}),t.jsx("button",{type:"button",className:`premium-pricing__tab ${n==="illimite"?"premium-pricing__tab--active":""}`,onClick:()=>{a("illimite"),o("illimite_6m")},children:" Accs illimit"})]}),t.jsx("div",{className:"premium-plans__grille",style:{gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))"},children:n==="a_la_carte"?t.jsx(t.Fragment,{children:["a_la_carte_1","a_la_carte_3","a_la_carte_7","a_la_carte_tous"].map(b=>t.jsxs("div",{className:`premium-plan-card ${l===b?"premium-plan-card--actif":""} ${b==="a_la_carte_3"?"premium-plan-card--populaire":""}`,onClick:()=>o(b),role:"button",tabIndex:0,onKeyDown:x=>x.key==="Enter"&&o(b),children:[b==="a_la_carte_3"&&t.jsx("div",{className:"premium-plan-card__badge-populaire",children:"Populaire"}),t.jsx("div",{className:"premium-plan-card__select",children:t.jsx("span",{className:l===b?"premium-plan-card__radio--actif":"premium-plan-card__radio"})}),t.jsxs("div",{className:"premium-plan-card__header",children:[t.jsx("span",{className:"premium-plan-card__icone",children:""}),t.jsx("h3",{className:"premium-plan-card__nom",children:Va[b].label})]}),t.jsxs("div",{className:"premium-plan-card__prix",children:[t.jsx("span",{className:"premium-plan-card__montant",children:Va[b].montant.toLocaleString("fr-FR")}),t.jsxs("span",{className:"premium-plan-card__devise",children:["FCFA / ",Va[b].duree]})]}),t.jsx("p",{className:"premium-plan-card__description",children:Va[b].description})]},b))}):t.jsx(t.Fragment,{children:["illimite_3m","illimite_6m","illimite_1an"].map(b=>t.jsxs("div",{className:`premium-plan-card ${l===b?"premium-plan-card--actif":""} ${b==="illimite_6m"?"premium-plan-card--populaire":""}`,onClick:()=>o(b),role:"button",tabIndex:0,onKeyDown:x=>x.key==="Enter"&&o(b),children:[b==="illimite_6m"&&t.jsx("div",{className:"premium-plan-card__badge-populaire",children:" Meilleure offre"}),t.jsx("div",{className:"premium-plan-card__select",children:t.jsx("span",{className:l===b?"premium-plan-card__radio--actif":"premium-plan-card__radio"})}),t.jsxs("div",{className:"premium-plan-card__header",children:[t.jsx("span",{className:"premium-plan-card__icone",children:""}),t.jsx("h3",{className:"premium-plan-card__nom",children:Va[b].label})]}),t.jsxs("div",{className:"premium-plan-card__prix",children:[t.jsx("span",{className:"premium-plan-card__montant",children:Va[b].montant.toLocaleString("fr-FR")}),t.jsxs("span",{className:"premium-plan-card__devise",children:["FCFA / ",Va[b].duree]})]}),b==="illimite_6m"&&t.jsx("div",{className:"premium-plan-card__economie",children:" conomisez 10 000 FCFA vs 23 mois"}),b==="illimite_1an"&&t.jsx("div",{className:"premium-plan-card__economie",children:" conomisez 30 000 FCFA vs 43 mois"}),t.jsx("p",{className:"premium-plan-card__description",children:Va[b].description})]},b))})}),f&&t.jsxs("div",{className:"premium-erreur",role:"alert",children:[" ",f]}),t.jsxs("div",{className:"premium-paiement",children:[t.jsx("button",{className:"premium-btn premium-btn--principal",onClick:v,disabled:u,"aria-busy":u,children:u?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"premium-spinner","aria-hidden":"true"})," Redirection en cours"]}):t.jsxs(t.Fragment,{children:[" S'abonner  ",Va[l]?.montant.toLocaleString("fr-FR")," FCFA"]})}),t.jsx("p",{className:"premium-paiement__securite",children:" Paiement 100% scuris via Moneroo"}),t.jsxs("div",{className:"premium-moyens-paiement",children:[t.jsx("p",{className:"premium-moyens-paiement__titre",children:"Moyens de paiement accepts :"}),t.jsx("div",{className:"premium-moyens-paiement__liste",children:N5.map(b=>t.jsxs("span",{className:"premium-moyen-badge",style:{borderColor:b.couleur,color:b.couleur},title:b.nom,children:[b.emoji," ",b.nom]},b.nom))})]})]})]}),t.jsxs("section",{className:"premium-avantages",children:[t.jsx("h2",{className:"premium-section__titre",children:"Ce qui est inclus"}),t.jsx("div",{className:"premium-avantages__grille",children:_5.map(b=>t.jsxs("div",{className:"premium-avantage-card",children:[t.jsx("span",{className:"premium-avantage-card__icone",children:b.icone}),t.jsxs("div",{className:"premium-avantage-card__texte",children:[t.jsx("h3",{children:b.titre}),t.jsx("p",{children:b.description})]})]},b.titre))})]}),t.jsxs("section",{className:"premium-faq",children:[t.jsx("h2",{className:"premium-section__titre",children:"Questions frquentes"}),t.jsxs("div",{className:"premium-faq__liste",children:[t.jsxs("div",{className:"premium-faq__item",children:[t.jsx("h3",{children:"Comment payer avec Wave ou Orange Money ?"}),t.jsx("p",{children:`Clique sur "S'abonner", tu seras redirig vers la page de paiement Moneroo. Choisis ton moyen de paiement prfr et suis les instructions.`})]}),t.jsxs("div",{className:"premium-faq__item",children:[t.jsx("h3",{children:"Mon accs est activ quand ?"}),t.jsx("p",{children:"L'accs Premium est activ automatiquement ds la confirmation de ton paiement, en quelques secondes."})]}),t.jsxs("div",{className:"premium-faq__item",children:[t.jsx("h3",{children:"Puis-je annuler mon abonnement ?"}),t.jsx("p",{children:"Oui. Contacte-nous via WhatsApp ou email. L'accs reste actif jusqu' la fin de la priode paye."})]}),t.jsxs("div",{className:"premium-faq__item",children:[t.jsx("h3",{children:"L'abonnement est-il renouvel automatiquement ?"}),t.jsx("p",{children:"Non. Tu recevras une notification avant l'expiration pour renouveler si tu le souhaites."})]})]})]})]})]})}const $n="cours_en_ligne",tl="cours_sections";function w5(e){const r=[/(?:youtube\.com\/watch\?v=)([^&\n?#]+)/,/(?:youtu\.be\/)([^&\n?#]+)/,/(?:youtube\.com\/embed\/)([^&\n?#]+)/];for(const n of r){const a=e.match(n);if(a)return a[1]}return null}async function zA(e){let r=Ee(_e(Q,$n),Ne("statut","==","publie"),Ve("updatedAt","desc"),Ht(50));return(await Ce(r)).docs.map(l=>({id:l.id,...l.data()}))}async function kA(e){const r=await Et(je(Q,$n,e));return r.exists()?{id:r.id,...r.data()}:null}async function C5(e){const r=Ee(_e(Q,$n),Ne("profId","==",e),Ve("updatedAt","desc"));return(await Ce(r)).docs.map(a=>({id:a.id,...a.data()}))}async function E5(){const e=Ee(_e(Q,$n),Ve("updatedAt","desc"),Ht(200));return(await Ce(e)).docs.map(n=>({id:n.id,...n.data()}))}async function A5(e,r,n){const a=Ae.now();return(await Pt(_e(Q,$n),{...n,profId:e,profNom:r,statut:n.statut??"brouillon",nombreInscrits:0,nombreSections:0,createdAt:a,updatedAt:a})).id}async function z5(e,r){await He(je(Q,$n,e),{...r,updatedAt:Ae.now()})}async function Px(e){await He(je(Q,$n,e),{statut:"publie",publieAt:Ae.now(),updatedAt:Ae.now()})}async function k5(e){await He(je(Q,$n,e),{statut:"archive",updatedAt:Ae.now()})}async function O5(e){const r=Tn(Q);(await Ce(Ee(_e(Q,tl),Ne("coursId","==",e)))).docs.forEach(a=>r.delete(a.ref)),r.delete(je(Q,$n,e)),await r.commit()}async function OA(e){const r=Ee(_e(Q,tl),Ne("coursId","==",e),Ve("ordre","asc"));return(await Ce(r)).docs.map(a=>({id:a.id,...a.data()}))}async function D5(e,r){const n=Tn(Q),a=Ae.now(),l=je(_e(Q,tl));return n.set(l,{...r,coursId:e,blocs:r.blocs??[],createdAt:a,updatedAt:a}),n.update(je(Q,$n,e),{nombreSections:as(1),updatedAt:a}),await n.commit(),l.id}async function L1(e,r){const n=Ae.now();let a={...r,updatedAt:n};r.blocs&&(a.dureeEstimee=DA(r.blocs)),await He(je(Q,tl,e),a)}async function P5(e,r){const n=Tn(Q),a=Ae.now();n.delete(je(Q,tl,e)),n.update(je(Q,$n,r),{nombreSections:as(-1),updatedAt:a}),await n.commit()}async function M5(e){const r=Tn(Q),n=Ae.now();e.forEach(({id:a,ordre:l})=>{r.update(je(Q,tl,a),{ordre:l,updatedAt:n})}),await r.commit()}async function T5(e,r){const n=r.map((a,l)=>({...a,ordre:l}));await He(je(Q,tl,e),{blocs:n,dureeEstimee:DA(n),updatedAt:Ae.now()})}function DA(e){let r=0;return e.forEach(n=>{switch(n.type){case"texte":r+=Math.max(1,Math.ceil(n.contenu.split(" ").length/200));break;case"video":r+=5;break;case"quiz":r+=2;break;case"exercice":r+=n.difficulte==="difficile"?10:n.difficulte==="moyen"?5:3;break;case"image":case"encadre":r+=1;break}}),Math.max(1,r)}async function q5(e){await He(je(Q,$n,e),{nombreInscrits:as(1)})}const R5=[{id:"illimite_3m",nom:"3 mois",description:"Accs illimit  tous les cours",prix:1e4,duree:"3 mois",nombreCoursMax:null,accesIllimite:!0},{id:"illimite_6m",nom:"6 mois",description:"Accs illimit  tous les cours",prix:2e4,duree:"6 mois",economie:"10 000 FCFA vs 23 mois",popular:!0,nombreCoursMax:null,accesIllimite:!0},{id:"illimite_1an",nom:"1 an",description:"Accs illimit  tous les cours",prix:3e4,duree:"12 mois",economie:"30 000 FCFA vs 43 mois",nombreCoursMax:null,accesIllimite:!0}],PA=[{id:"a_la_carte_1",nom:"1 cours",description:"Choisissez 1 cours par discipline et niveau",prix:1e3,duree:"1 mois",nombreCoursMax:1,accesIllimite:!1},{id:"a_la_carte_3",nom:"3 cours",description:"Choisissez 3 cours par discipline et niveau",prix:2e3,duree:"1 mois",nombreCoursMax:3,accesIllimite:!1},{id:"a_la_carte_7",nom:"7 cours",description:"Choisissez 7 cours par discipline et niveau",prix:5e3,duree:"1 mois",nombreCoursMax:7,accesIllimite:!1},{id:"a_la_carte_tous",nom:"Tous les contenus",description:"Accs  l'intgralit du catalogue",prix:25e3,duree:"9 mois",nombreCoursMax:null,accesIllimite:!0}],MA=[...PA,...R5];function Hb(e){return e.startsWith("a_la_carte_")}function I5(e){return MA.find(n=>n.id===e)?.nombreCoursMax??null}function L5(e){const r=MA.find(n=>n.id===e);return r?r.accesIllimite:["mensuel","annuel","illimite_3m","illimite_6m","illimite_1an"].includes(e)}async function $5(e,r){await He(je(Q,"users",e),{coursChoisis:r,updatedAt:Dt()})}function B5(e,r,n,a){return r?L5(n||"illimite_6m")||!Hb(n||"illimite_6m")?!0:a.includes(e):!1}const wa=["6me","5me","4me","3me","2nde","1re","Terminale"],$1=["2023-2024","2024-2025","2025-2026","2026-2027"],U5=["#2563eb","#7c3aed","#059669","#d97706","#dc2626","#0891b2","#db2777","#65a30d"],Wi={cours:{label:"Cours",emoji:"",color:"#3b82f6"},exercices:{label:"Exercices",emoji:"",color:"#8b5cf6"},correction:{label:"Correction",emoji:"",color:"#10b981"},devoir_surveille:{label:"Devoir surveill",emoji:"",color:"#f59e0b"},devoir_maison:{label:"Devoir  la maison",emoji:"",color:"#6366f1"},travaux_pratiques:{label:"Travaux pratiques",emoji:"",color:"#14b8a6"},evaluation:{label:"valuation",emoji:"",color:"#ef4444"},revision:{label:"Rvision",emoji:"",color:"#f97316"}},Rc={realise:{label:"Ralis",color:"#059669",bg:"#d1fae5"},planifie:{label:"Planifi",color:"#d97706",bg:"#fef3c7"},annule:{label:"Annul",color:"#dc2626",bg:"#fee2e2"},reporte:{label:"Report",color:"#2563eb",bg:"#dbeafe"}},TA={interro:"Interrogation",ds:"Devoir Surveill",examen:"Examen",oral:"Oral",autre:"Autre"},qA={devoir:{label:"Devoir  corriger",emoji:""},evaluation:{label:"valuation  prparer",emoji:""},notes:{label:"Notes  saisir",emoji:""},cours:{label:"Cours  prparer",emoji:""},personnalise:{label:"Rappel personnalis",emoji:""}},F5=["Communiquer  l'crit","Communiquer  l'oral","Raisonner et rsoudre des problmes","Chercher et s'informer","Modliser","Reprsenter","Calculer et algorithmiser","Analyser et interprter","Exprimenter et observer","Cooprer et mutualiser"],Mx={texte:{label:"Texte",emoji:"",description:"Paragraphe format"},image:{label:"Image",emoji:"",description:"Image avec lgende"},video:{label:"Vido",emoji:"",description:"Vido YouTube"},encadre:{label:"Encadr",emoji:"",description:"Dfinition, remarque, astuce..."},quiz:{label:"Quiz",emoji:"",description:"Question  choix multiple"},exercice:{label:"Exercice",emoji:"",description:"Problme avec correction"}},RA={definition:{label:"Dfinition",emoji:"",bg:"#eff6ff",border:"#2563eb",color:"#1d4ed8"},remarque:{label:"Remarque",emoji:"",bg:"#fefce8",border:"#ca8a04",color:"#854d0e"},attention:{label:"Attention",emoji:"",bg:"#fef2f2",border:"#dc2626",color:"#991b1b"},astuce:{label:"Astuce",emoji:"",bg:"#f0fdf4",border:"#16a34a",color:"#15803d"},exemple:{label:"Exemple",emoji:"",bg:"#f8fafc",border:"#64748b",color:"#475569"}},Uc=wa.map(e=>({valeur:e,label:e==="3me"?"3me (BFEM)":e==="Terminale"?"Terminale (BAC)":e})),G5={brouillon:{label:"Brouillon",couleur:"#6b7280",bg:"#f3f4f6"},publie:{label:"Publi",couleur:"#16a34a",bg:"#f0fdf4"},archive:{label:"Archiv",couleur:"#9ca3af",bg:"#f9fafb"}},H5={"6eme":1,"6me":1,"5eme":2,"5me":2,"4eme":3,"4me":3,"3eme":4,"3me":4,"2nde":5,seconde:5,"1ere":6,"1re":6,terminale:7};function B1(e){const r=e.toLowerCase().trim();return H5[r]??99}function Ca(){const[e,r]=g.useState([]),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null);return g.useEffect(()=>{let f=!1;async function p(){o(!0),d(null);try{const h=Ee(_e(Q,"disciplines"),Ve("ordre")),v=await Ce(h);if(f)return;const b=new Set,x=new Set;v.forEach(C=>{const w=C.data();w.nom&&typeof w.nom=="string"&&b.add(w.nom.trim()),w.classe&&typeof w.classe=="string"&&x.add(w.classe.trim())});const j=Array.from(b).sort((C,w)=>C.localeCompare(w,"fr")).map(C=>({valeur:C,label:C})),_=Array.from(x).sort((C,w)=>{const E=B1(C),S=B1(w);return E!==S?E-S:C.localeCompare(w,"fr")}).map(C=>({valeur:C,label:C}));r(j),a(_)}catch(h){f||(console.error("[useDisciplinesOptions] Erreur Firestore :",h),d("Impossible de charger les matires/niveaux."))}finally{f||o(!1)}}return p(),()=>{f=!0}},[]),{matieres:e,niveaux:n,loading:l,error:u}}function V5(){const{currentUser:e}=Ke(),r=Je(),{matieres:n}=Ca(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,f]=g.useState(!1),[p,h]=g.useState(""),[v,b]=g.useState(""),[x,j]=g.useState(e?.coursChoisis??[]),_=e?.subscriptionPlan,C=I5(_||"a_la_carte_1"),w=Hb(_||"a_la_carte_1"),E=PA.find(P=>P.id===_);g.useEffect(()=>{S()},[]);async function S(){u(!0);try{const P=await zA();l(P)}catch{l([])}finally{u(!1)}}const A=a.filter(P=>!(p&&P.matiere!==p||v&&P.niveau!==v));function O(P){if(!C)return;x.indexOf(P)>=0?j(x.filter(B=>B!==P)):x.length<C&&j([...x,P])}async function k(){if(e){f(!0);try{await $5(e.uid,x),r("/dashboard",{state:{message:"Vos cours ont t mis  jour."}})}catch{f(!1)}}}return e?.isPremium?!w||C===null?t.jsx("div",{className:"cours-catalogue",children:t.jsxs("div",{className:"cours-catalogue__hero",children:[t.jsx("h1",{children:"Accs illimit"}),t.jsx("p",{children:"Votre formule vous donne accs  tous les cours. Aucun choix  faire !"}),t.jsx(Le,{to:"/cours",className:"btn btn--primary",children:"Voir le catalogue"})]})}):t.jsxs("div",{className:"cours-catalogue",children:[t.jsxs("section",{className:"cours-catalogue__hero",children:[t.jsx("h1",{className:"cours-catalogue__hero-titre",children:" Mes cours  la carte"}),t.jsxs("p",{className:"cours-catalogue__hero-sous-titre",children:["Choisissez jusqu' ",t.jsxs("strong",{children:[C," cours"]})," parmi le catalogue. Filtrez par discipline et niveau."]}),t.jsxs("div",{className:"premium-cours-choice__plan",children:[t.jsxs("span",{className:"badge badge--premium",children:[E?.nom,"  ",E?.prix.toLocaleString("fr-FR")," FCFA / ",E?.duree]}),t.jsxs("span",{className:"premium-cours-choice__count",children:[x.length," / ",C," cours slectionns"]})]})]}),t.jsx("section",{className:"cours-catalogue__filtres",children:t.jsxs("div",{className:"cours-catalogue__filtres-inner",children:[t.jsxs("select",{value:p,onChange:P=>h(P.target.value),className:"cours-catalogue__select","aria-label":"Filtrer par matire",children:[t.jsx("option",{value:"",children:"Toutes les matires"}),n.map(P=>t.jsx("option",{value:P.valeur,children:P.label},P.valeur))]}),t.jsxs("select",{value:v,onChange:P=>b(P.target.value),className:"cours-catalogue__select","aria-label":"Filtrer par niveau",children:[t.jsx("option",{value:"",children:"Tous les niveaux"}),Uc.map(P=>t.jsx("option",{value:P.valeur,children:P.label},P.valeur))]})]})}),t.jsx("main",{className:"cours-catalogue__contenu",children:o?t.jsx("div",{className:"cours-catalogue__grille","aria-busy":"true",children:[1,2,3,4].map(P=>t.jsxs("div",{className:"cours-card cours-card--skeleton",children:[t.jsx("div",{className:"skeleton cours-card__cover"}),t.jsxs("div",{className:"cours-card__body",children:[t.jsx("div",{className:"skeleton",style:{height:16,width:"60%",marginBottom:8}}),t.jsx("div",{className:"skeleton",style:{height:20,marginBottom:8}})]})]},P))}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"premium-cours-choice__actions",children:[t.jsx("button",{className:"btn-primary",onClick:k,disabled:d,children:d?"Enregistrement...":" Enregistrer mes choix"}),t.jsx(Le,{to:"/cours",className:"btn-secondary",children:"Voir le catalogue"})]}),t.jsx("div",{className:"cours-catalogue__grille",children:A.map(P=>{const D=x.includes(P.id),B=x.length<(C||0)||D,U=Uc.find($=>$.valeur===P.niveau)?.label??P.niveau;return t.jsxs("article",{className:`cours-card ${D?"cours-card--selected":""}`,onClick:()=>B&&O(P.id),role:"button",tabIndex:0,onKeyDown:$=>$.key==="Enter"&&B&&O(P.id),children:[t.jsxs("div",{className:"cours-card__cover",children:[P.couvertureUrl?t.jsx("img",{src:P.couvertureUrl,alt:P.titre,loading:"lazy"}):t.jsx("div",{className:"cours-card__cover-placeholder",children:t.jsx("span",{children:P.matiere.charAt(0)})}),t.jsx("span",{className:`cours-card__badge ${D?"cours-card__badge--premium":"cours-card__badge--gratuit"}`,children:D?" Slectionn":"Cliquer pour ajouter"})]}),t.jsxs("div",{className:"cours-card__body",children:[t.jsxs("div",{className:"cours-card__meta",children:[t.jsx("span",{className:"cours-card__matiere",children:P.matiere}),t.jsx("span",{className:"cours-card__niveau",children:U})]}),t.jsx("h3",{className:"cours-card__titre",children:P.titre}),t.jsx("p",{className:"cours-card__description",children:P.description})]})]},P.id)})}),A.length===0&&!o&&t.jsxs("div",{className:"cours-catalogue__vide",children:[t.jsx("span",{children:""}),t.jsx("h3",{children:"Aucun cours trouv"}),t.jsx("p",{children:"Modifiez vos filtres ou consultez le catalogue complet."})]})]})})]}):t.jsx("div",{className:"cours-catalogue",children:t.jsxs("div",{className:"cours-catalogue__hero",children:[t.jsx("h1",{children:"Choix des cours"}),t.jsx("p",{children:"Cette page est rserve aux abonns Premium."}),t.jsx(Le,{to:"/premium",className:"btn btn--primary",children:"Dcouvrir Premium"})]})})}function Q5(){const e=Je(),[r,n]=g.useState("chargement"),[a,l]=g.useState(null);return g.useEffect(()=>{async function o(){const{paymentId:u,paymentStatus:d}=j5();if(!u){e("/premium");return}if(d==="failed"||d==="cancelled"){n("echec"),l("Le paiement a t annul ou a chou. Aucun montant n'a t dbit.");return}try{const f=await b5(u);f.status==="success"?n("succes"):f.status==="pending"?n("attente"):(n("echec"),l("Le paiement n'a pas pu tre confirm. Contactez le support si le montant a t dbit."))}catch{n("attente")}}o()},[e]),r==="chargement"?t.jsx("div",{className:"premium-confirmation",children:t.jsxs("div",{className:"premium-confirmation__card",children:[t.jsx("div",{className:"premium-spinner premium-spinner--lg","aria-label":"Vrification en cours"}),t.jsx("h2",{children:"Vrification du paiement"}),t.jsx("p",{children:"Merci de patienter quelques secondes."})]})}):r==="succes"?t.jsx("div",{className:"premium-confirmation",children:t.jsxs("div",{className:"premium-confirmation__card premium-confirmation__card--succes",children:[t.jsx("div",{className:"premium-confirmation__icone premium-confirmation__icone--succes",children:""}),t.jsx("h1",{children:"Bienvenue dans Premium ! "}),t.jsxs("p",{className:"premium-confirmation__message",children:["Ton abonnement est activ. Tu as maintenant accs  ",t.jsx("strong",{children:"tous les cours, quiz et ressources"})," de PedaClic."]}),t.jsxs("div",{className:"premium-confirmation__actions",children:[t.jsx("button",{className:"premium-btn premium-btn--principal",onClick:()=>e("/dashboard"),children:" Accder au tableau de bord"}),t.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/cours"),children:" Voir les cours"})]})]})}):r==="attente"?t.jsx("div",{className:"premium-confirmation",children:t.jsxs("div",{className:"premium-confirmation__card premium-confirmation__card--attente",children:[t.jsx("div",{className:"premium-confirmation__icone premium-confirmation__icone--attente",children:""}),t.jsx("h1",{children:"Paiement en cours de traitement"}),t.jsx("p",{className:"premium-confirmation__message",children:"Ton paiement est en cours de vrification. Ton accs Premium sera activ automatiquement ds confirmation (gnralement moins de 5 minutes)."}),t.jsx("p",{className:"premium-confirmation__message",children:"Tu recevras une notification ds que c'est prt. Tu peux fermer cette page."}),t.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/dashboard"),children:"Aller au tableau de bord"})]})}):t.jsx("div",{className:"premium-confirmation",children:t.jsxs("div",{className:"premium-confirmation__card premium-confirmation__card--echec",children:[t.jsx("div",{className:"premium-confirmation__icone premium-confirmation__icone--echec",children:""}),t.jsx("h1",{children:"Paiement non abouti"}),t.jsx("p",{className:"premium-confirmation__message",children:a||"Une erreur est survenue lors du paiement."}),t.jsxs("div",{className:"premium-confirmation__actions",children:[t.jsx("button",{className:"premium-btn premium-btn--principal",onClick:()=>e("/premium"),children:" Ressayer"}),t.jsx("button",{className:"premium-btn premium-btn--secondaire",onClick:()=>e("/dashboard"),children:"Retour au tableau de bord"})]})]})})}const Y5=[{title:"Principal",items:[{id:"dashboard",label:"Tableau de bord",icon:"",href:"/admin"},{id:"disciplines",label:"Disciplines",icon:"",href:"/admin/disciplines"},{id:"chapitres",label:"Chapitres",icon:"",href:"/admin/chapitres"},{id:"ressources",label:"Ressources",icon:"",href:"/admin/ressources"},{id:"cours",label:"Cours en ligne",icon:"",href:"/prof/cours"},{id:"ebooks",label:"Bibliothque Ebooks",icon:"",href:"/admin/ebooks"},{id:"mediatheque",label:"Mdiathque",icon:"",href:"/mediatheque"}]},{title:"valuation",items:[{id:"quiz",label:"Quiz",icon:"",href:"/admin/quiz"},{id:"quiz-avance",label:"Quiz Avancs",icon:"",href:"/admin/quiz-avance"},{id:"resultats",label:"Rsultats",icon:"",href:"/admin/resultats"}]},{title:"Utilisateurs",items:[{id:"utilisateurs",label:"Tous les utilisateurs",icon:"",href:"/admin/utilisateurs"},{id:"premium",label:"Abonns Premium",icon:"",href:"/admin/premium"}]},{title:"Outils IA",items:[{id:"generateur",label:"Gnrateur IA",icon:"",href:"/generateur"}]},{title:"Paramtres",items:[{id:"settings",label:"Configuration",icon:"",href:"/admin/settings"}]}],mn=({children:e,currentPage:r="dashboard"})=>{const{currentUser:n,logout:a}=Ke(),[l,o]=g.useState(!0),[u,d]=g.useState(!1),f=Lb(),p=async()=>{try{d(!0),await a(),window.location.href="/connexion"}catch(x){console.error("Erreur lors de la dconnexion:",x),d(!1)}},h=()=>n?.displayName?n.displayName.split(" ").map(x=>x[0]).join("").toUpperCase().slice(0,2):"AD",v=()=>{switch(n?.role){case"admin":return"Administrateur";case"prof":return"Professeur";case"eleve":return"lve";default:return"Utilisateur"}},b=x=>x.href==="/admin"?f.pathname==="/admin"||f.pathname==="/admin/":f.pathname.startsWith(x.href);return t.jsxs("div",{className:"admin-layout",children:[t.jsxs("aside",{className:`admin-sidebar ${l?"":"admin-sidebar--collapsed"}`,children:[t.jsx("header",{className:"admin-sidebar__header",children:t.jsxs(Le,{to:"/",className:"admin-sidebar__logo",children:[t.jsx("div",{className:"admin-sidebar__logo-icon",children:""}),t.jsx("span",{children:"PedaClic"})]})}),t.jsx("nav",{className:"admin-sidebar__nav",children:Y5.map((x,j)=>t.jsxs("div",{className:"admin-nav__section",children:[t.jsx("h3",{className:"admin-nav__title",children:x.title}),t.jsx("ul",{className:"admin-nav__list",children:x.items.map(_=>t.jsx("li",{className:"admin-nav__item",children:t.jsxs(Le,{to:_.href,className:`admin-nav__link ${b(_)?"admin-nav__link--active":""}`,children:[t.jsx("span",{className:"admin-nav__icon",children:_.icon}),t.jsx("span",{className:"admin-nav__label",children:_.label})]})},_.id))})]},j))}),t.jsx("footer",{className:"admin-sidebar__footer",children:t.jsxs("div",{className:"admin-user",children:[t.jsx("div",{className:"admin-user__avatar",children:h()}),t.jsxs("div",{className:"admin-user__info",children:[t.jsx("div",{className:"admin-user__name",children:n?.displayName||"Administrateur"}),t.jsx("div",{className:"admin-user__role",children:v()})]}),t.jsx("button",{onClick:p,disabled:u,className:"admin-logout-btn",title:"Se dconnecter",children:u?"...":""})]})})]}),t.jsxs("main",{className:"admin-content",children:[t.jsx("button",{className:"admin-sidebar-toggle",onClick:()=>o(!l),"aria-label":"Toggle sidebar",children:""}),e]}),t.jsx("style",{children:`
        /* Bouton de dconnexion */
        .admin-logout-btn {
          width: 36px;
          height: 36px;
          border: none;
          background: rgba(255, 255, 255, 0.1);
          color: white;
          border-radius: var(--radius-md);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all var(--transition-base);
          font-size: var(--text-lg);
        }

        .admin-logout-btn:hover {
          background: rgba(255, 255, 255, 0.2);
        }

        .admin-logout-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        /* Bouton toggle sidebar (mobile) */
        .admin-sidebar-toggle {
          display: none;
          position: fixed;
          top: var(--spacing-md);
          left: var(--spacing-md);
          z-index: var(--z-fixed);
          width: 44px;
          height: 44px;
          border: none;
          background: var(--color-primary);
          color: white;
          border-radius: var(--radius-md);
          cursor: pointer;
          font-size: var(--text-xl);
        }

        @media (max-width: 768px) {
          .admin-sidebar-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
          }

          .admin-sidebar {
            transform: translateX(-100%);
            transition: transform var(--transition-base);
          }

          .admin-sidebar:not(.admin-sidebar--collapsed) {
            transform: translateX(0);
          }

          .admin-content {
            padding-top: calc(var(--spacing-xl) + 44px);
          }
        }

        /* Animation de la sidebar rduite */
        .admin-sidebar--collapsed {
          width: 80px;
        }

        .admin-sidebar--collapsed .admin-nav__label,
        .admin-sidebar--collapsed .admin-nav__title,
        .admin-sidebar--collapsed .admin-sidebar__logo span,
        .admin-sidebar--collapsed .admin-user__info {
          display: none;
        }

        .admin-sidebar--collapsed .admin-sidebar__logo {
          justify-content: center;
        }
      `})]})},Ui="chapitres",K5=e=>Object.fromEntries(Object.entries(e).filter(([,r])=>r!==void 0)),Fv=e=>{const r=e.data();return{id:e.id,disciplineId:r.disciplineId,numero:r.numero,titre:r.titre,description:r.description,objectifs:r.objectifs||[],dureeEstimee:r.dureeEstimee,isPremium:r.isPremium||!1,actif:r.actif!==!1,createdAt:r.createdAt?.toDate()||new Date,updatedAt:r.updatedAt?.toDate()}},Gi={async getByDiscipline(e){try{const r=Ee(_e(Q,Ui),Ne("disciplineId","==",e),Ve("numero","asc"));return(await Ce(r)).docs.map(Fv)}catch(r){throw console.error("Erreur lors de la rcupration des chapitres:",r),new Error("Impossible de rcuprer les chapitres")}},async getAll(){try{const e=Ee(_e(Q,Ui),Ve("numero","asc"));return(await Ce(e)).docs.map(Fv)}catch(e){throw console.error("Erreur lors de la rcupration des chapitres:",e),new Error("Impossible de rcuprer les chapitres")}},async getById(e){try{const r=je(Q,Ui,e),n=await Et(r);return n.exists()?Fv(n):null}catch(r){throw console.error("Erreur lors de la rcupration du chapitre:",r),new Error("Impossible de rcuprer le chapitre")}},async create(e){try{return(await Pt(_e(Q,Ui),{...e,actif:e.actif!==!1,createdAt:Dt(),updatedAt:Dt()})).id}catch(r){throw console.error("Erreur lors de la cration du chapitre:",r),new Error("Impossible de crer le chapitre")}},async update(e,r){try{const n=je(Q,Ui,e),a=K5({...r,updatedAt:Dt()});await He(n,a)}catch(n){throw console.error("Erreur lors de la mise  jour du chapitre:",n),new Error("Impossible de mettre  jour le chapitre")}},async delete(e){try{const r=je(Q,Ui,e);await Br(r)}catch(r){throw console.error("Erreur lors de la suppression du chapitre:",r),new Error("Impossible de supprimer le chapitre")}},async deleteByDiscipline(e){try{const r=await this.getByDiscipline(e),n=Tn(Q);r.forEach(a=>{const l=je(Q,Ui,a.id);n.delete(l)}),await n.commit()}catch(r){throw console.error("Erreur lors de la suppression des chapitres:",r),new Error("Impossible de supprimer les chapitres")}},async reorder(e,r){try{const n=Tn(Q);r.forEach((a,l)=>{const o=je(Q,Ui,a);n.update(o,{numero:l+1,updatedAt:Dt()})}),await n.commit()}catch(n){throw console.error("Erreur lors de la rorganisation des chapitres:",n),new Error("Impossible de rorganiser les chapitres")}},async toggleActive(e,r){await this.update(e,{actif:r})},async countByDiscipline(e){return(await this.getByDiscipline(e)).length},async getNextNumero(e){return await this.countByDiscipline(e)+1}},W5=()=>{const{currentUser:e}=Ke(),r=Je(),[n,a]=g.useState({totalDisciplines:0,totalChapitres:0,totalRessources:0,ressourcesPremium:0,ressourcesGratuites:0,totalCours:0,totalQuiz:0,totalQuizAvances:0,ressourcesParType:{cours:0,exercice:0,video:0,document:0,quiz:0}}),[l,o]=g.useState(!0),[u,d]=g.useState(null);return g.useEffect(()=>{(async()=>{try{o(!0),d(null);const[p,h,v,b,x,j]=await Promise.all([is.getAll(),Gi.getAll(),fa.getStats(),Ce(_e(Q,"quizzes")),Ce(_e(Q,"quizzes_v2")),Ce(_e(Q,"cours_en_ligne"))]);a({totalDisciplines:p.length,totalChapitres:h.length,totalRessources:v.total,ressourcesPremium:v.premium,ressourcesGratuites:v.gratuit,totalCours:j.size,totalQuiz:b.size,totalQuizAvances:x.size,ressourcesParType:v.parType})}catch(p){console.error("Erreur lors du chargement des statistiques:",p),d("Impossible de charger les statistiques")}finally{o(!1)}})()},[]),t.jsxs("div",{className:"admin-dashboard",children:[t.jsx("header",{className:"admin-page-header",children:t.jsxs("div",{className:"admin-page-header__info",children:[t.jsx("h1",{className:"admin-page-header__title",children:"Tableau de bord"}),t.jsxs("p",{className:"admin-page-header__subtitle",children:["Bienvenue, ",e?.displayName||"Administrateur"," ! Grez votre contenu pdagogique depuis cette interface."]})]})}),u&&t.jsxs("div",{className:"alert alert--error",children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:u})})]}),l?t.jsxs("div",{className:"loading-container",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement des statistiques..."})]}):t.jsxs(t.Fragment,{children:[t.jsxs("section",{className:"stats-grid",children:[t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/admin/disciplines"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&r("/admin/disciplines"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--primary",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalDisciplines}),t.jsx("div",{className:"stat-card__label",children:"Disciplines"})]})]}),t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/admin/chapitres"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&r("/admin/chapitres"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--secondary",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalChapitres}),t.jsx("div",{className:"stat-card__label",children:"Chapitres"})]})]}),t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/admin/ressources"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&r("/admin/ressources"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--info",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalRessources}),t.jsx("div",{className:"stat-card__label",children:"Ressources"})]})]}),t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/admin/ressources"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&r("/admin/ressources"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--warning",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.ressourcesPremium}),t.jsx("div",{className:"stat-card__label",children:"Ressources Premium"})]})]}),t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/prof/cours"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&r("/prof/cours"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--primary",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalCours}),t.jsx("div",{className:"stat-card__label",children:"Cours en ligne"})]})]}),t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/admin/quiz"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&r("/admin/quiz"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--quiz",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalQuiz}),t.jsx("div",{className:"stat-card__label",children:"Quiz"})]})]}),t.jsxs("div",{className:"stat-card stat-card--clickable",onClick:()=>r("/admin/quiz-avance"),role:"button",tabIndex:0,onKeyDown:f=>f.key==="Enter"&&r("/admin/quiz-avance"),children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--advanced",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalQuizAvances}),t.jsx("div",{className:"stat-card__label",children:"Quiz Avancs"})]})]})]}),t.jsxs("section",{className:"content-card",children:[t.jsx("div",{className:"content-card__header",children:t.jsx("h2",{children:"Rpartition des ressources par type"})}),t.jsx("div",{className:"content-card__body",children:t.jsxs("div",{className:"resource-type-grid",children:[t.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>r("/admin/ressources"),role:"button",tabIndex:0,children:[t.jsx("div",{className:"resource-item__icon resource-item__icon--cours",children:""}),t.jsxs("div",{className:"resource-type-info",children:[t.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.cours}),t.jsx("span",{className:"resource-type-label",children:"Cours"})]})]}),t.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>r("/admin/ressources"),role:"button",tabIndex:0,children:[t.jsx("div",{className:"resource-item__icon resource-item__icon--exercice",children:""}),t.jsxs("div",{className:"resource-type-info",children:[t.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.exercice}),t.jsx("span",{className:"resource-type-label",children:"Exercices"})]})]}),t.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>r("/admin/ressources"),role:"button",tabIndex:0,children:[t.jsx("div",{className:"resource-item__icon resource-item__icon--video",children:""}),t.jsxs("div",{className:"resource-type-info",children:[t.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.video}),t.jsx("span",{className:"resource-type-label",children:"Vidos"})]})]}),t.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>r("/admin/ressources"),role:"button",tabIndex:0,children:[t.jsx("div",{className:"resource-item__icon resource-item__icon--document",children:""}),t.jsxs("div",{className:"resource-type-info",children:[t.jsx("span",{className:"resource-type-value",children:n.ressourcesParType.document}),t.jsx("span",{className:"resource-type-label",children:"Documents"})]})]}),t.jsxs("div",{className:"resource-type-item resource-type-item--clickable",onClick:()=>r("/admin/quiz"),role:"button",tabIndex:0,children:[t.jsx("div",{className:"resource-item__icon resource-item__icon--quiz",children:""}),t.jsxs("div",{className:"resource-type-info",children:[t.jsx("span",{className:"resource-type-value",children:n.totalQuiz+n.totalQuizAvances}),t.jsx("span",{className:"resource-type-label",children:"Quiz (tous)"})]})]})]})})]}),t.jsxs("section",{className:"content-card",style:{marginTop:"var(--spacing-xl)"},children:[t.jsx("div",{className:"content-card__header",children:t.jsx("h2",{children:"Actions rapides"})}),t.jsx("div",{className:"content-card__body",children:t.jsxs("div",{className:"quick-actions-grid",children:[t.jsxs("a",{href:"/admin/disciplines",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Grer les disciplines"}),t.jsx("p",{children:"Ajouter, modifier ou supprimer des matires"})]})]}),t.jsxs("a",{href:"/admin/chapitres",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Grer les chapitres"}),t.jsx("p",{children:"Organiser le contenu par chapitres"})]})]}),t.jsxs("a",{href:"/admin/ressources",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Grer les ressources"}),t.jsx("p",{children:"Cours, exercices, vidos et documents"})]})]}),t.jsxs("a",{href:"/admin/quiz",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Grer les quiz"}),t.jsx("p",{children:"Crer et modifier des quiz pour les lves"})]})]}),t.jsxs("a",{href:"/admin/quiz-avance",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Quiz avancs"}),t.jsx("p",{children:"Quiz interactifs avec niveaux de difficult"})]})]}),t.jsxs("a",{href:"/admin/utilisateurs",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Grer les utilisateurs"}),t.jsx("p",{children:"lves, professeurs et administrateurs"})]})]}),t.jsxs("a",{href:"/prof/cahiers",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Cahier de Textes"}),t.jsx("p",{children:"Planifier et suivre l'enseignement"})]})]}),t.jsxs("a",{href:"/prof/sequences",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Squences Pdagogiques"}),t.jsx("p",{children:"Crer et organiser des squences de cours"})]})]}),t.jsxs("a",{href:"/prof/cours",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Cours en ligne"}),t.jsx("p",{children:"Crer et grer les cours en ligne"})]})]}),t.jsxs("a",{href:"/mediatheque",className:"quick-action-card",children:[t.jsx("div",{className:"quick-action-icon",children:""}),t.jsxs("div",{className:"quick-action-content",children:[t.jsx("h3",{children:"Mdiathque"}),t.jsx("p",{children:"Vidos, podcasts et webinaires pdagogiques"})]})]})]})})]})]}),t.jsx("style",{children:`
        /* ====== Stat cards cliquables ====== */
        /* Curseur pointer + effet hover sur les cartes de statistiques */
        .stat-card--clickable {
          cursor: pointer;
          transition: all 0.2s ease;
        }
        .stat-card--clickable:hover {
          transform: translateY(-3px);
          box-shadow: var(--shadow-lg, 0 8px 24px rgba(0,0,0,0.12));
          border-color: var(--color-primary, #3182ce);
        }
        .stat-card--clickable:active {
          transform: translateY(-1px);
        }

        /* Icne quiz (violet) */
        .stat-card__icon--quiz {
          background: #f3e8ff;
          color: #7c3aed;
        }
        /* Icne quiz avanc (rose) */
        .stat-card__icon--advanced {
          background: #fce7f3;
          color: #db2777;
        }

        /* ====== Grille des types de ressources ====== */
        .resource-type-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
          gap: var(--spacing-lg);
        }

        .resource-type-item {
          display: flex;
          align-items: center;
          gap: var(--spacing-md);
          padding: var(--spacing-md);
          background: var(--color-bg-secondary);
          border-radius: var(--radius-lg);
        }

        /* Cartes de rpartition cliquables */
        .resource-type-item--clickable {
          cursor: pointer;
          transition: all 0.2s ease;
          border: 1px solid transparent;
        }
        .resource-type-item--clickable:hover {
          border-color: var(--color-primary, #3182ce);
          box-shadow: 0 2px 8px rgba(0,0,0,0.08);
          transform: translateY(-2px);
        }

        .resource-type-info {
          display: flex;
          flex-direction: column;
        }

        .resource-type-value {
          font-size: var(--text-2xl);
          font-weight: var(--font-bold);
          color: var(--color-text);
        }

        .resource-type-label {
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        /* ====== Actions rapides ====== */
        .quick-actions-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
          gap: var(--spacing-lg);
        }

        .quick-action-card {
          display: flex;
          align-items: flex-start;
          gap: var(--spacing-lg);
          padding: var(--spacing-lg);
          background: var(--color-bg-secondary);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-lg);
          text-decoration: none;
          color: inherit;
          transition: all var(--transition-base);
        }

        .quick-action-card:hover {
          border-color: var(--color-primary);
          box-shadow: var(--shadow-md);
          transform: translateY(-2px);
        }

        .quick-action-icon {
          font-size: 2rem;
          line-height: 1;
        }

        .quick-action-content h3 {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          margin-bottom: var(--spacing-xs);
          color: var(--color-text);
        }

        .quick-action-content p {
          font-size: var(--text-sm);
          color: var(--color-text-light);
          margin: 0;
        }

        @media (max-width: 768px) {
          .resource-type-grid,
          .quick-actions-grid {
            grid-template-columns: 1fr;
          }
        }
      `})]})},Fe={container:{maxWidth:"900px",margin:"0 auto",padding:"24px"},title:{fontSize:"1.5rem",fontWeight:700,color:"#1a365d",marginBottom:"24px"},form:{background:"#ffffff",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",marginBottom:"32px",border:"1px solid #e2e8f0"},formTitle:{fontSize:"1.1rem",fontWeight:600,color:"#2d3748",marginBottom:"20px",paddingBottom:"12px",borderBottom:"2px solid #3182ce"},formGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"16px",marginBottom:"20px"},fieldGroup:{display:"flex",flexDirection:"column",gap:"6px"},label:{fontSize:"0.875rem",fontWeight:600,color:"#4a5568"},labelOptional:{fontSize:"0.75rem",fontWeight:400,color:"#a0aec0",marginLeft:"4px"},input:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"0.95rem",outline:"none",transition:"border-color 0.2s"},select:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"0.95rem",background:"#fff",cursor:"pointer"},textarea:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"0.95rem",minHeight:"80px",resize:"vertical",fontFamily:"inherit"},btnPrimary:{padding:"12px 28px",background:"#3182ce",color:"#fff",border:"none",borderRadius:"8px",fontSize:"0.95rem",fontWeight:600,cursor:"pointer",transition:"background 0.2s"},btnSecondary:{padding:"12px 28px",background:"#e2e8f0",color:"#4a5568",border:"none",borderRadius:"8px",fontSize:"0.95rem",fontWeight:600,cursor:"pointer",marginLeft:"12px"},btnDanger:{padding:"6px 14px",background:"#fed7d7",color:"#c53030",border:"1px solid #fc8181",borderRadius:"6px",fontSize:"0.8rem",cursor:"pointer"},btnEdit:{padding:"6px 14px",background:"#ebf8ff",color:"#2b6cb0",border:"1px solid #90cdf4",borderRadius:"6px",fontSize:"0.8rem",cursor:"pointer",marginRight:"8px"},card:{background:"#fff",borderRadius:"10px",padding:"16px 20px",boxShadow:"0 1px 4px rgba(0,0,0,0.06)",border:"1px solid #e2e8f0",display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},badge:{display:"inline-block",padding:"3px 10px",borderRadius:"12px",fontSize:"0.75rem",fontWeight:600},badgeCollege:{background:"#ebf8ff",color:"#2b6cb0"},badgeLycee:{background:"#fefcbf",color:"#975a16"},badgeFormationLibre:{background:"#f0fff4",color:"#276749"},tabs:{display:"flex",gap:"8px",marginBottom:"20px",flexWrap:"wrap"},tab:{padding:"8px 20px",borderRadius:"8px",border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontSize:"0.9rem",fontWeight:500,transition:"all 0.2s"},tabActive:{background:"#3182ce",color:"#fff",borderColor:"#3182ce"}},Gv={nom:"",niveau:"college",classe:"6eme",ordre:0,coefficient:void 0,couleur:"",icone:"",description:""},X5=()=>{const[e,r]=g.useState([]),[n,a]=g.useState(Gv),[l,o]=g.useState(null),[u,d]=g.useState(!1),[f,p]=g.useState("all");g.useEffect(()=>{const E=Ee(_e(Q,"disciplines"),Ve("nom")),S=Sf(E,A=>{const O=A.docs.map(k=>({id:k.id,...k.data(),createdAt:k.data().createdAt?.toDate()||new Date,updatedAt:k.data().updatedAt?.toDate()||new Date}));r(O)});return()=>S()},[]);const h=g.useCallback(E=>{const S=P1(E)[0]?.value||"6eme";a(A=>({...A,niveau:E,classe:S,coefficient:E==="formation_libre"?void 0:A.coefficient}))},[]),v=async E=>{if(E.preventDefault(),!!n.nom.trim()){d(!0);try{const S={nom:n.nom.trim(),niveau:n.niveau,classe:n.classe,ordre:n.ordre,...n.coefficient!==void 0&&{coefficient:n.coefficient},couleur:n.couleur||"",icone:n.icone||"",description:n.description||"",updatedAt:Ae.now()};l?await He(je(Q,"disciplines",l),S):await Pt(_e(Q,"disciplines"),{...S,createdAt:Ae.now()}),a(Gv),o(null)}catch(S){console.error("Erreur lors de la sauvegarde :",S),alert("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{d(!1)}}},b=E=>{a({nom:E.nom,niveau:E.niveau,classe:E.classe,ordre:E.ordre,coefficient:E.coefficient,couleur:E.couleur||"",icone:E.icone||"",description:E.description||""}),o(E.id)},x=async(E,S)=>{if(window.confirm(`Supprimer la discipline "${S}" ? Cette action est irrversible.`))try{await Br(je(Q,"disciplines",E))}catch(A){console.error("Erreur lors de la suppression :",A)}},j=()=>{a(Gv),o(null)},_=P1(n.niveau),C=f==="all"?e:e.filter(E=>E.niveau===f),w=E=>({...Fe.badge,...E==="college"?Fe.badgeCollege:{},...E==="lycee"?Fe.badgeLycee:{},...E==="formation_libre"?Fe.badgeFormationLibre:{}});return t.jsxs("div",{style:Fe.container,children:[t.jsx("h2",{style:Fe.title,children:" Gestion des Disciplines"}),t.jsxs("form",{style:Fe.form,onSubmit:v,children:[t.jsx("h3",{style:Fe.formTitle,children:l?" Modifier la discipline":" Ajouter une discipline"}),t.jsxs("div",{style:Fe.formGrid,children:[t.jsxs("div",{style:Fe.fieldGroup,children:[t.jsx("label",{style:Fe.label,children:"Nom de la discipline"}),t.jsx("input",{type:"text",style:Fe.input,value:n.nom,onChange:E=>a({...n,nom:E.target.value}),placeholder:"Ex : Cuisine sngalaise, Couture, Franais...",required:!0})]}),t.jsxs("div",{style:Fe.fieldGroup,children:[t.jsx("label",{style:Fe.label,children:"Niveau"}),t.jsxs("select",{style:Fe.select,value:n.niveau,onChange:E=>h(E.target.value),children:[t.jsx("option",{value:"college",children:" Collge"}),t.jsx("option",{value:"lycee",children:" Lyce"}),t.jsx("option",{value:"formation_libre",children:" Formation libre"})]})]}),t.jsxs("div",{style:Fe.fieldGroup,children:[t.jsx("label",{style:Fe.label,children:n.niveau==="formation_libre"?"Niveau de formation":"Classe"}),t.jsx("select",{style:Fe.select,value:n.classe,onChange:E=>a({...n,classe:E.target.value}),children:_.map(({value:E,label:S})=>t.jsx("option",{value:E,children:S},E))})]}),t.jsxs("div",{style:Fe.fieldGroup,children:[t.jsx("label",{style:Fe.label,children:"Ordre d'affichage"}),t.jsx("input",{type:"number",style:Fe.input,value:n.ordre,onChange:E=>a({...n,ordre:Number(E.target.value)}),placeholder:"Ex : 1",min:"0"})]}),t.jsxs("div",{style:Fe.fieldGroup,children:[t.jsxs("label",{style:Fe.label,children:["Coefficient",n.niveau==="formation_libre"&&t.jsx("span",{style:Fe.labelOptional,children:"(optionnel)"})]}),t.jsx("input",{type:"number",style:Fe.input,value:n.coefficient??"",onChange:E=>a({...n,coefficient:E.target.value?Number(E.target.value):void 0}),placeholder:n.niveau==="formation_libre"?"Non requis":"Ex : 3",min:"1",max:"10",required:n.niveau!=="formation_libre"})]}),t.jsxs("div",{style:Fe.fieldGroup,children:[t.jsxs("label",{style:Fe.label,children:["Couleur",t.jsx("span",{style:Fe.labelOptional,children:"(optionnel)"})]}),t.jsx("input",{type:"color",style:{...Fe.input,maxWidth:"80px",padding:"4px",height:"40px"},value:n.couleur||"#3182ce",onChange:E=>a({...n,couleur:E.target.value})})]})]}),t.jsxs("div",{style:{...Fe.fieldGroup,marginBottom:"20px"},children:[t.jsxs("label",{style:Fe.label,children:["Description",t.jsx("span",{style:Fe.labelOptional,children:"(optionnel)"})]}),t.jsx("textarea",{style:Fe.textarea,value:n.description,onChange:E=>a({...n,description:E.target.value}),placeholder:"Brve description de la discipline..."})]}),t.jsxs("div",{style:{...Fe.fieldGroup,marginBottom:"20px"},children:[t.jsxs("label",{style:Fe.label,children:["Icne (emoji)",t.jsx("span",{style:Fe.labelOptional,children:"(optionnel)"})]}),t.jsx("input",{type:"text",style:{...Fe.input,maxWidth:"120px"},value:n.icone,onChange:E=>a({...n,icone:E.target.value}),placeholder:""})]}),t.jsxs("div",{children:[t.jsx("button",{type:"submit",style:Fe.btnPrimary,disabled:u,children:u?"Enregistrement...":l?"Mettre  jour":"Ajouter la discipline"}),l&&t.jsx("button",{type:"button",style:Fe.btnSecondary,onClick:j,children:"Annuler"})]})]}),t.jsxs("div",{children:[t.jsxs("h3",{style:Fe.formTitle,children:[" Disciplines existantes (",C.length,")"]}),t.jsxs("div",{style:Fe.tabs,children:[t.jsx("button",{style:{...Fe.tab,...f==="all"?Fe.tabActive:{}},onClick:()=>p("all"),children:"Toutes"}),t.jsx("button",{style:{...Fe.tab,...f==="college"?Fe.tabActive:{}},onClick:()=>p("college"),children:" Collge"}),t.jsx("button",{style:{...Fe.tab,...f==="lycee"?Fe.tabActive:{}},onClick:()=>p("lycee"),children:" Lyce"}),t.jsx("button",{style:{...Fe.tab,...f==="formation_libre"?Fe.tabActive:{}},onClick:()=>p("formation_libre"),children:" Formation libre"})]}),C.length===0?t.jsx("p",{style:{color:"#a0aec0",fontStyle:"italic",textAlign:"center",padding:"32px"},children:"Aucune discipline trouve pour ce filtre."}):C.map(E=>t.jsxs("div",{style:Fe.card,children:[t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[E.icone&&t.jsx("span",{style:{fontSize:"1.2rem"},children:E.icone}),t.jsx("strong",{style:{fontSize:"1rem",color:"#2d3748"},children:E.nom}),t.jsx("span",{style:w(E.niveau),children:CA[E.niveau]})]}),t.jsxs("div",{style:{fontSize:"0.85rem",color:"#718096"},children:[E.niveau==="formation_libre"?"Niveau":"Classe"," :"," ",EA(E.classe),E.coefficient!==void 0&&t.jsxs("span",{style:{marginLeft:"12px"},children:["| Coeff : ",E.coefficient]})]})]}),t.jsxs("div",{style:{display:"flex",gap:"4px"},children:[t.jsx("button",{style:Fe.btnEdit,onClick:()=>b(E),children:"Modifier"}),t.jsx("button",{style:Fe.btnDanger,onClick:()=>x(E.id,E.nom),children:"Supprimer"})]})]},E.id))]})]})},U1={numero:1,titre:"",description:"",objectifs:[],dureeEstimee:0,isPremium:!1,actif:!0},Z5=()=>{const[e,r]=g.useState([]),[n,a]=g.useState([]),[l,o]=g.useState(""),[u,d]=g.useState(!0),[f,p]=g.useState(!1),[h,v]=g.useState(!1),[b,x]=g.useState(null),[j,_]=g.useState(null),[C,w]=g.useState(null),[E,S]=g.useState(!1),[A,O]=g.useState(!1),[k,P]=g.useState(null),[D,B]=g.useState(null),[U,$]=g.useState({...U1,disciplineId:""}),[R,Y]=g.useState({}),[ae,M]=g.useState(""),T=g.useCallback(async()=>{try{d(!0);const V=await is.getAll();r(V),V.length>0&&!l&&o(V[0].id)}catch(V){console.error("Erreur lors du chargement des disciplines:",V),_("Impossible de charger les disciplines.")}finally{d(!1)}},[l]),F=g.useCallback(async()=>{if(!l){a([]);return}try{p(!0);const V=await Gi.getByDiscipline(l);a(V)}catch(V){console.error("Erreur lors du chargement des chapitres:",V),_("Impossible de charger les chapitres.")}finally{p(!1)}},[l]);g.useEffect(()=>{T()},[T]),g.useEffect(()=>{F()},[F]);const I=()=>{const V={};return U.disciplineId||(V.disciplineId="Veuillez slectionner une discipline"),U.titre.trim()?U.titre.length<3&&(V.titre="Le titre doit contenir au moins 3 caractres"):V.titre="Le titre du chapitre est requis",U.numero<1&&(V.numero="Le numro doit tre suprieur  0"),Y(V),Object.keys(V).length===0},X=V=>{o(V),_(null)},L=async()=>{const V=await Gi.getNextNumero(l);P(null),$({...U1,disciplineId:l,numero:V}),Y({}),M(""),S(!0)},ne=V=>{P(V),$({disciplineId:V.disciplineId,numero:V.numero,titre:V.titre,description:V.description,objectifs:V.objectifs||[],dureeEstimee:V.dureeEstimee,isPremium:V.isPremium,actif:V.actif}),Y({}),M(""),S(!0)},K=V=>{B(V),O(!0)},oe=()=>{S(!1),O(!1),P(null),B(null),Y({}),M("")},xe=V=>{const{name:me,value:we,type:qe}=V.target,Xe=V.target.checked;$(et=>({...et,[me]:qe==="checkbox"?Xe:qe==="number"?Number(we):we})),R[me]&&Y(et=>({...et,[me]:void 0}))},ve=()=>{ae.trim()&&($(V=>({...V,objectifs:[...V.objectifs||[],ae.trim()]})),M(""))},H=V=>{$(me=>({...me,objectifs:(me.objectifs||[]).filter((we,qe)=>qe!==V)}))},he=async V=>{if(V.preventDefault(),!!I())try{v(!0),_(null),k?(await Gi.update(k.id,U),w("Chapitre modifi avec succs !")):(await Gi.create(U),w("Chapitre cr avec succs !")),oe(),await F(),setTimeout(()=>w(null),3e3)}catch(me){console.error("Erreur lors de la sauvegarde:",me),_("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{v(!1)}},Me=async()=>{if(D)try{x(D.id),await Gi.delete(D.id),w("Chapitre supprim avec succs !"),oe(),await F(),setTimeout(()=>w(null),3e3)}catch(V){console.error("Erreur lors de la suppression:",V),_("Erreur lors de la suppression. Veuillez ressayer.")}finally{x(null)}},ue=async V=>{try{await Gi.toggleActive(V.id,!V.actif),await F(),w(V.actif?"Chapitre dsactiv":"Chapitre activ"),setTimeout(()=>w(null),2e3)}catch{_("Erreur lors de la mise  jour")}},Z=V=>{const me=e.find(we=>we.id===V);return me?me.nom:"Non trouve"};return t.jsxs("div",{className:"chapitre-manager",children:[t.jsxs("header",{className:"admin-page-header",children:[t.jsxs("div",{className:"admin-page-header__info",children:[t.jsx("h1",{className:"admin-page-header__title",children:"Gestion des Chapitres"}),t.jsx("p",{className:"admin-page-header__subtitle",children:"Organisez le contenu pdagogique par chapitres"})]}),t.jsx("div",{className:"admin-page-header__actions",children:t.jsxs("button",{onClick:L,className:"btn btn--primary",disabled:!l||u,children:[t.jsx("span",{children:""}),"Nouveau chapitre"]})})]}),j&&t.jsxs("div",{className:"alert alert--error",children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:j})}),t.jsx("button",{onClick:()=>_(null),className:"alert__close",children:""})]}),C&&t.jsxs("div",{className:"alert alert--success",children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:C})})]}),t.jsx("div",{className:"content-card",style:{marginBottom:"var(--spacing-lg)"},children:t.jsx("div",{className:"content-card__body",children:t.jsxs("div",{className:"discipline-selector",children:[t.jsx("label",{className:"form-label",children:"Slectionner une discipline :"}),u?t.jsx("p",{className:"text-muted",children:"Chargement des disciplines..."}):e.length===0?t.jsxs("p",{className:"text-muted",children:["Aucune discipline disponible.",t.jsx("a",{href:"/admin/disciplines",children:" Crer une discipline"})]}):t.jsx("div",{className:"discipline-tabs",children:e.map(V=>t.jsxs("button",{className:`discipline-tab ${l===V.id?"discipline-tab--active":""}`,onClick:()=>X(V.id),style:{"--discipline-color":V.couleur||"#2563eb"},children:[t.jsx("span",{className:"discipline-tab__icon",children:V.icone||""}),t.jsx("span",{className:"discipline-tab__name",children:V.nom}),t.jsx("span",{className:"discipline-tab__class",children:V.classe})]},V.id))})]})})}),t.jsxs("div",{className:"admin-table-container",children:[t.jsx("div",{className:"admin-table-header",children:t.jsxs("h2",{className:"admin-table-title",children:["Chapitres ",l&&`- ${Z(l)}`,n.length>0&&` (${n.length})`]})}),f?t.jsxs("div",{className:"loading-container",style:{padding:"var(--spacing-2xl)"},children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement des chapitres..."})]}):l?n.length===0?t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{className:"empty-state__icon",children:""}),t.jsx("h3",{className:"empty-state__title",children:"Aucun chapitre"}),t.jsx("p",{className:"empty-state__message",children:"Cette discipline n'a pas encore de chapitres."}),t.jsx("button",{onClick:L,className:"btn btn--primary",children:"Crer le premier chapitre"})]}):t.jsx("div",{className:"chapitres-list",children:n.map(V=>t.jsxs("div",{className:`chapitre-card ${V.actif?"":"chapitre-card--inactive"}`,children:[t.jsx("div",{className:"chapitre-card__number",children:V.numero}),t.jsxs("div",{className:"chapitre-card__content",children:[t.jsxs("h3",{className:"chapitre-card__title",children:[V.titre,V.isPremium&&t.jsx("span",{className:"badge badge--premium",children:"Premium"}),!V.actif&&t.jsx("span",{className:"badge badge--warning",children:"Inactif"})]}),V.description&&t.jsx("p",{className:"chapitre-card__description",children:V.description}),t.jsxs("div",{className:"chapitre-card__meta",children:[V.dureeEstimee&&t.jsxs("span",{children:[" ",V.dureeEstimee,"h estime"]}),V.objectifs&&V.objectifs.length>0&&t.jsxs("span",{children:[" ",V.objectifs.length," objectif(s)"]})]})]}),t.jsxs("div",{className:"chapitre-card__actions",children:[t.jsx("button",{onClick:()=>ue(V),className:`table-action-btn ${V.actif?"table-action-btn--view":"table-action-btn--edit"}`,title:V.actif?"Dsactiver":"Activer",children:V.actif?"":""}),t.jsx("button",{onClick:()=>ne(V),className:"table-action-btn table-action-btn--edit",title:"Modifier",children:""}),t.jsx("button",{onClick:()=>K(V),className:"table-action-btn table-action-btn--delete",title:"Supprimer",disabled:b===V.id,children:b===V.id?"":""})]})]},V.id))}):t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{className:"empty-state__icon",children:""}),t.jsx("h3",{className:"empty-state__title",children:"Slectionnez une discipline"}),t.jsx("p",{className:"empty-state__message",children:"Choisissez une discipline ci-dessus pour voir ses chapitres."})]})]}),E&&t.jsx("div",{className:"modal-overlay",onClick:oe,children:t.jsxs("div",{className:"modal modal--lg",onClick:V=>V.stopPropagation(),children:[t.jsxs("div",{className:"modal__header",children:[t.jsx("h2",{className:"modal__title",children:k?"Modifier le chapitre":"Nouveau chapitre"}),t.jsx("button",{onClick:oe,className:"modal__close",children:""})]}),t.jsxs("form",{onSubmit:he,children:[t.jsxs("div",{className:"modal__body",children:[!k&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label form-label--required",children:"Discipline"}),t.jsxs("select",{name:"disciplineId",className:`form-select ${R.disciplineId?"form-select--error":""}`,value:U.disciplineId,onChange:xe,children:[t.jsx("option",{value:"",children:"Slectionner une discipline"}),e.map(V=>t.jsxs("option",{value:V.id,children:[V.icone," ",V.nom," (",V.classe,")"]},V.id))]}),R.disciplineId&&t.jsx("span",{className:"form-error",children:R.disciplineId})]}),t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",style:{flex:"0 0 100px"},children:[t.jsx("label",{className:"form-label form-label--required",children:"N"}),t.jsx("input",{type:"number",name:"numero",className:`form-input ${R.numero?"form-input--error":""}`,min:"1",value:U.numero,onChange:xe}),R.numero&&t.jsx("span",{className:"form-error",children:R.numero})]}),t.jsxs("div",{className:"form-group",style:{flex:1},children:[t.jsx("label",{className:"form-label form-label--required",children:"Titre du chapitre"}),t.jsx("input",{type:"text",name:"titre",className:`form-input ${R.titre?"form-input--error":""}`,placeholder:"Ex: Les fractions, La Rvolution franaise...",value:U.titre,onChange:xe}),R.titre&&t.jsx("span",{className:"form-error",children:R.titre})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Description"}),t.jsx("textarea",{name:"description",className:"form-textarea",rows:3,placeholder:"Description du chapitre...",value:U.description||"",onChange:xe})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Objectifs pdagogiques"}),t.jsxs("div",{className:"objectifs-input",children:[t.jsx("input",{type:"text",className:"form-input",placeholder:"Ajouter un objectif...",value:ae,onChange:V=>M(V.target.value),onKeyPress:V=>V.key==="Enter"&&(V.preventDefault(),ve())}),t.jsx("button",{type:"button",onClick:ve,className:"btn btn--outline btn--sm",children:"Ajouter"})]}),U.objectifs&&U.objectifs.length>0&&t.jsx("ul",{className:"objectifs-list",children:U.objectifs.map((V,me)=>t.jsxs("li",{className:"objectif-item",children:[t.jsxs("span",{children:[" ",V]}),t.jsx("button",{type:"button",onClick:()=>H(me),className:"objectif-remove",children:""})]},me))})]}),t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Dure estime (heures)"}),t.jsx("input",{type:"number",name:"dureeEstimee",className:"form-input",min:"0",step:"0.5",placeholder:"Ex: 2",value:U.dureeEstimee||"",onChange:xe})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Options"}),t.jsxs("div",{className:"form-options",children:[t.jsxs("label",{className:"form-checkbox",children:[t.jsx("input",{type:"checkbox",name:"isPremium",checked:U.isPremium,onChange:xe}),t.jsx("span",{children:"Contenu Premium "})]}),t.jsxs("label",{className:"form-checkbox",children:[t.jsx("input",{type:"checkbox",name:"actif",checked:U.actif!==!1,onChange:xe}),t.jsx("span",{children:"Chapitre actif"})]})]})]})]})]}),t.jsxs("div",{className:"modal__footer",children:[t.jsx("button",{type:"button",onClick:oe,className:"btn btn--outline",disabled:h,children:"Annuler"}),t.jsx("button",{type:"submit",className:"btn btn--primary",disabled:h,children:h?"Enregistrement...":k?"Mettre  jour":"Crer le chapitre"})]})]})]})}),A&&D&&t.jsx("div",{className:"modal-overlay",onClick:oe,children:t.jsxs("div",{className:"modal",onClick:V=>V.stopPropagation(),children:[t.jsxs("div",{className:"modal__header",children:[t.jsx("h2",{className:"modal__title",children:"Confirmer la suppression"}),t.jsx("button",{onClick:oe,className:"modal__close",children:""})]}),t.jsxs("div",{className:"modal__body",children:[t.jsxs("p",{children:["Supprimer le chapitre ",t.jsxs("strong",{children:[D.numero,". ",D.titre]})," ?"]}),t.jsxs("div",{className:"alert alert--warning",style:{marginTop:"var(--spacing-md)"},children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:"Les ressources associes ne seront pas supprimes automatiquement."})})]})]}),t.jsxs("div",{className:"modal__footer",children:[t.jsx("button",{onClick:oe,className:"btn btn--outline",children:"Annuler"}),t.jsx("button",{onClick:Me,className:"btn btn--danger",disabled:b!==null,children:b?"Suppression...":"Supprimer"})]})]})}),t.jsx("style",{children:`
        /* Slecteur de discipline */
        .discipline-tabs {
          display: flex;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
          margin-top: var(--spacing-md);
        }

        .discipline-tab {
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          padding: var(--spacing-sm) var(--spacing-md);
          border: 2px solid var(--color-border);
          border-radius: var(--radius-lg);
          background: white;
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .discipline-tab:hover {
          border-color: var(--discipline-color, var(--color-primary));
        }

        .discipline-tab--active {
          border-color: var(--discipline-color, var(--color-primary));
          background: color-mix(in srgb, var(--discipline-color, var(--color-primary)) 10%, white);
        }

        .discipline-tab__icon {
          font-size: var(--text-lg);
        }

        .discipline-tab__name {
          font-weight: var(--font-medium);
        }

        .discipline-tab__class {
          font-size: var(--text-xs);
          color: var(--color-text-light);
          background: var(--color-bg-secondary);
          padding: 2px 6px;
          border-radius: var(--radius-sm);
        }

        /* Liste des chapitres */
        .chapitres-list {
          display: flex;
          flex-direction: column;
          gap: var(--spacing-md);
          padding: var(--spacing-lg);
        }

        .chapitre-card {
          display: flex;
          align-items: center;
          gap: var(--spacing-lg);
          padding: var(--spacing-lg);
          background: var(--color-bg-secondary);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-lg);
          transition: all var(--transition-base);
        }

        .chapitre-card:hover {
          border-color: var(--color-primary);
          box-shadow: var(--shadow-md);
        }

        .chapitre-card--inactive {
          opacity: 0.6;
          background: var(--color-bg-tertiary);
        }

        .chapitre-card__number {
          width: 48px;
          height: 48px;
          background: var(--color-primary);
          color: white;
          border-radius: var(--radius-md);
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: var(--text-xl);
          font-weight: var(--font-bold);
          flex-shrink: 0;
        }

        .chapitre-card__content {
          flex: 1;
          min-width: 0;
        }

        .chapitre-card__title {
          font-size: var(--text-base);
          font-weight: var(--font-semibold);
          margin-bottom: var(--spacing-xs);
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
        }

        .chapitre-card__description {
          font-size: var(--text-sm);
          color: var(--color-text-light);
          margin: 0 0 var(--spacing-sm);
        }

        .chapitre-card__meta {
          display: flex;
          gap: var(--spacing-lg);
          font-size: var(--text-xs);
          color: var(--color-text-lighter);
        }

        .chapitre-card__actions {
          display: flex;
          gap: var(--spacing-sm);
        }

        /* Formulaire: Ligne */
        .form-row {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: var(--spacing-lg);
        }

        @media (max-width: 600px) {
          .form-row {
            grid-template-columns: 1fr;
          }
        }

        /* Objectifs */
        .objectifs-input {
          display: flex;
          gap: var(--spacing-sm);
        }

        .objectifs-list {
          list-style: none;
          margin-top: var(--spacing-md);
        }

        .objectif-item {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: var(--spacing-sm) var(--spacing-md);
          background: var(--color-bg-secondary);
          border-radius: var(--radius-md);
          margin-bottom: var(--spacing-xs);
        }

        .objectif-remove {
          background: none;
          border: none;
          cursor: pointer;
          color: var(--color-error);
          opacity: 0.7;
        }

        .objectif-remove:hover {
          opacity: 1;
        }

        /* Options */
        .form-options {
          display: flex;
          flex-direction: column;
          gap: var(--spacing-sm);
          margin-top: var(--spacing-sm);
        }
      `})]})},$d=[{value:"cours",label:"Cours",icon:"",color:"#2563eb"},{value:"exercice",label:"Exercice",icon:"",color:"#10b981"},{value:"video",label:"Vido",icon:"",color:"#ef4444"},{value:"document",label:"Document",icon:"",color:"#f59e0b"},{value:"quiz",label:"Quiz",icon:"",color:"#8b5cf6"}],Bd={cours:[".pdf",".doc",".docx",".ppt",".pptx"],exercice:[".pdf",".doc",".docx"],video:[".mp4",".webm",".mov",".avi"],document:[".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx"],quiz:[".json",".pdf"]},Hv=50,F1={titre:"",type:"cours",description:"",contenu:"",chapitre:"",ordre:1,isPremium:!1,actif:!0,tags:[],duree:void 0,urlExterne:""},J5=()=>{const{currentUser:e}=Ke(),[r,n]=g.useState([]),[a,l]=g.useState([]),[o,u]=g.useState([]),[d,f]=g.useState([]),[p,h]=g.useState(""),[v,b]=g.useState(""),[x,j]=g.useState(""),[_,C]=g.useState(""),[w,E]=g.useState(""),[S,A]=g.useState(!0),[O,k]=g.useState(!1),[P,D]=g.useState(!1),[B,U]=g.useState(!1),[$,R]=g.useState(null),[Y,ae]=g.useState(!1),[M,T]=g.useState(0),[F,I]=g.useState(null),[X,L]=g.useState(null),[ne,K]=g.useState(!1),[oe,xe]=g.useState(!1),[ve,H]=g.useState(!1),[he,Me]=g.useState(null),[ue,Z]=g.useState(null),[V,me]=g.useState(null),[we,qe]=g.useState({...F1,disciplineId:""}),[Xe,et]=g.useState({}),[it,jr]=g.useState(null),[Mr,cr]=g.useState(null),nn=g.useRef(null),[pe,ze]=g.useState(""),Re=g.useCallback(async()=>{try{A(!0);const te=await is.getAll();n(te),te.length>0&&!p&&h(te[0].id)}catch(te){console.error("Erreur lors du chargement des disciplines:",te),I("Impossible de charger les disciplines.")}finally{A(!1)}},[p]),Qe=g.useCallback(async()=>{if(!p){l([]);return}try{k(!0);const te=await Gi.getByDiscipline(p);l(te)}catch(te){console.error("Erreur lors du chargement des chapitres:",te)}finally{k(!1)}},[p]),pt=g.useCallback(async()=>{if(!p){u([]),f([]);return}try{D(!0);const te=await fa.getByDiscipline(p);u(te),f(te)}catch(te){console.error("Erreur lors du chargement des ressources:",te),I("Impossible de charger les ressources.")}finally{D(!1)}},[p]);g.useEffect(()=>{Re()},[Re]),g.useEffect(()=>{Qe()},[Qe]),g.useEffect(()=>{pt()},[pt]),g.useEffect(()=>{let te=[...o];if(v&&(te=te.filter(Ue=>Ue.chapitre===v)),x&&(te=te.filter(Ue=>Ue.type===x)),_==="premium"?te=te.filter(Ue=>Ue.isPremium):_==="free"&&(te=te.filter(Ue=>!Ue.isPremium)),w){const Ue=w.toLowerCase();te=te.filter(ht=>ht.titre.toLowerCase().includes(Ue)||ht.description?.toLowerCase().includes(Ue)||ht.tags?.some(bn=>bn.toLowerCase().includes(Ue)))}f(te)},[o,v,x,_,w]);const It=()=>{const te={};if(we.disciplineId||(te.disciplineId="Veuillez slectionner une discipline"),we.titre.trim()?we.titre.length<3&&(te.titre="Le titre doit contenir au moins 3 caractres"):te.titre="Le titre est requis",we.type||(te.type="Veuillez slectionner un type de ressource"),it){const Ue="."+it.name.split(".").pop()?.toLowerCase(),ht=Bd[we.type];ht.includes(Ue)||(te.fichier=`Extension non autorise. Extensions acceptes : ${ht.join(", ")}`),it.size/(1024*1024)>Hv&&(te.fichier=`Le fichier est trop volumineux (max ${Hv} Mo)`)}return et(te),Object.keys(te).length===0},nr=te=>{h(te),b(""),I(null)},Gr=()=>{Me(null),qe({...F1,disciplineId:p}),et({}),jr(null),cr(null),ze(""),K(!0)},ee=te=>{Me(te),qe({disciplineId:te.disciplineId,titre:te.titre,type:te.type,description:te.description,contenu:te.contenu,chapitre:te.chapitre||"",ordre:te.ordre,isPremium:te.isPremium,actif:te.actif,tags:te.tags||[],duree:te.duree,urlExterne:te.urlExterne||""}),et({}),jr(null),cr(te.fichierURL||null),ze(""),K(!0)},Pe=te=>{me(te),H(!0)},ct=te=>{Z(te),xe(!0)},J=()=>{K(!1),xe(!1),H(!1),Me(null),Z(null),me(null),et({}),jr(null),cr(null),ze("")},ce=te=>{const{name:Ue,value:ht,type:bn}=te.target,dl=te.target.checked;qe(us=>({...us,[Ue]:bn==="checkbox"?dl:bn==="number"?Number(ht):ht})),Xe[Ue]&&et(us=>({...us,[Ue]:void 0}))},Se=te=>{const Ue=te.target.files?.[0];if(Ue)if(jr(Ue),et(ht=>({...ht,fichier:void 0})),Ue.type.startsWith("image/")||Ue.type.startsWith("video/")){const ht=new FileReader;ht.onloadend=()=>{cr(ht.result)},ht.readAsDataURL(Ue)}else cr(null)},Ze=()=>{jr(null),cr(null),nn.current&&(nn.current.value="")},kr=()=>{pe.trim()&&!we.tags?.includes(pe.trim())&&(qe(te=>({...te,tags:[...te.tags||[],pe.trim()]})),ze(""))},Fn=te=>{qe(Ue=>({...Ue,tags:(Ue.tags||[]).filter((ht,bn)=>bn!==te)}))},Gn=async te=>{if(te.preventDefault(),!!It())try{U(!0),I(null);let Ue=he?.fichierURL,ht=he?.fichierNom;if(it){ae(!0);const dl=he?.id||`temp_${Date.now()}`;Ue=await fa.uploadFile(it,dl),ht=it?.name||"fichier",ae(!1)}const bn={...we,fichierURL:Ue,fichierNom:ht};he?(await fa.update(he.id,bn),L("Ressource modifie avec succs !")):(await fa.create(bn,"admin"),L("Ressource cre avec succs !")),J(),await pt(),setTimeout(()=>L(null),3e3)}catch(Ue){console.error("Erreur lors de la sauvegarde:",Ue),I("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{U(!1),ae(!1),T(0)}},ia=async()=>{if(ue)try{R(ue.id),ue.fichierURL&&await fa.deleteFile(ue.fichierURL),await fa.delete(ue.id),L("Ressource supprime avec succs !"),J(),await pt(),setTimeout(()=>L(null),3e3)}catch(te){console.error("Erreur lors de la suppression:",te),I("Erreur lors de la suppression. Veuillez ressayer.")}finally{R(null)}},ol=async te=>{try{await fa.togglePremium(te.id,!te.isPremium),await pt(),L(te.isPremium?"Ressource passe en gratuit":"Ressource passe en Premium"),setTimeout(()=>L(null),2e3)}catch{I("Erreur lors de la mise  jour")}},cl=async te=>{try{await fa.toggleActive(te.id,te.actif===!1),await pt(),L(te.actif!==!1?"Ressource dsactive":"Ressource active"),setTimeout(()=>L(null),2e3)}catch{I("Erreur lors de la mise  jour")}},Ea=te=>{const Ue=r.find(ht=>ht.id===te);return Ue?Ue.nom:"Non trouve"},ul=te=>{const Ue=a.find(ht=>ht.id===te);return Ue?`${Ue.numero}. ${Ue.titre}`:""},Hn=te=>$d.find(Ue=>Ue.value===te)||$d[0],Np=te=>te<1024?te+" o":te<1024*1024?(te/1024).toFixed(1)+" Ko":(te/(1024*1024)).toFixed(1)+" Mo";return t.jsxs("div",{className:"resource-manager",children:[t.jsxs("header",{className:"admin-page-header",children:[t.jsxs("div",{className:"admin-page-header__info",children:[t.jsx("h1",{className:"admin-page-header__title",children:"Gestion des Ressources"}),t.jsx("p",{className:"admin-page-header__subtitle",children:"Grez les cours, exercices, vidos et documents pdagogiques"})]}),t.jsx("div",{className:"admin-page-header__actions",children:t.jsxs("button",{onClick:Gr,className:"btn btn--primary",disabled:!p||S,children:[t.jsx("span",{children:""}),"Nouvelle ressource"]})})]}),F&&t.jsxs("div",{className:"alert alert--error",children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:F})}),t.jsx("button",{onClick:()=>I(null),className:"alert__close",children:""})]}),X&&t.jsxs("div",{className:"alert alert--success",children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:X})})]}),t.jsx("div",{className:"content-card",style:{marginBottom:"var(--spacing-lg)"},children:t.jsx("div",{className:"content-card__body",children:t.jsxs("div",{className:"discipline-selector",children:[t.jsx("label",{className:"form-label",children:"Slectionner une discipline :"}),S?t.jsx("p",{className:"text-muted",children:"Chargement des disciplines..."}):r.length===0?t.jsxs("p",{className:"text-muted",children:["Aucune discipline disponible.",t.jsx("a",{href:"/admin/disciplines",children:" Crer une discipline"})]}):t.jsx("div",{className:"discipline-tabs",children:r.map(te=>t.jsxs("button",{className:`discipline-tab ${p===te.id?"discipline-tab--active":""}`,onClick:()=>nr(te.id),style:{"--discipline-color":te.couleur||"#2563eb"},children:[t.jsx("span",{className:"discipline-tab__icon",children:te.icone||""}),t.jsx("span",{className:"discipline-tab__name",children:te.nom}),t.jsx("span",{className:"discipline-tab__class",children:te.classe})]},te.id))})]})})}),t.jsxs("div",{className:"admin-table-container",children:[t.jsxs("div",{className:"admin-table-header",children:[t.jsxs("h2",{className:"admin-table-title",children:["Ressources ",p&&`- ${Ea(p)}`,d.length>0&&` (${d.length})`]}),t.jsxs("div",{className:"admin-table-actions",children:[t.jsxs("div",{className:"search-input",children:[t.jsx("span",{className:"search-input__icon",children:""}),t.jsx("input",{type:"text",className:"search-input__field",placeholder:"Rechercher...",value:w,onChange:te=>E(te.target.value)})]}),t.jsxs("select",{className:"form-select form-select--sm",value:v,onChange:te=>b(te.target.value),disabled:O||a.length===0,children:[t.jsx("option",{value:"",children:"Tous les chapitres"}),a.map(te=>t.jsxs("option",{value:te.id,children:[te.numero,". ",te.titre]},te.id))]}),t.jsxs("select",{className:"form-select form-select--sm",value:x,onChange:te=>j(te.target.value),children:[t.jsx("option",{value:"",children:"Tous les types"}),$d.map(te=>t.jsxs("option",{value:te.value,children:[te.icon," ",te.label]},te.value))]}),t.jsxs("select",{className:"form-select form-select--sm",value:_,onChange:te=>C(te.target.value),children:[t.jsx("option",{value:"",children:"Tous"}),t.jsx("option",{value:"premium",children:" Premium"}),t.jsx("option",{value:"free",children:"Gratuit"})]})]})]}),P?t.jsxs("div",{className:"loading-container",style:{padding:"var(--spacing-2xl)"},children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement des ressources..."})]}):p?d.length===0?t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{className:"empty-state__icon",children:""}),t.jsx("h3",{className:"empty-state__title",children:"Aucune ressource"}),t.jsx("p",{className:"empty-state__message",children:w||x||_||v?"Aucune ressource ne correspond aux critres de recherche.":"Cette discipline n'a pas encore de ressources."}),!w&&!x&&!_&&!v&&t.jsx("button",{onClick:Gr,className:"btn btn--primary",children:"Crer la premire ressource"})]}):t.jsx("div",{className:"resource-list",style:{padding:"var(--spacing-lg)"},children:d.map(te=>{const Ue=Hn(te.type);return t.jsxs("div",{className:"resource-item",children:[t.jsx("div",{className:`resource-item__icon resource-item__icon--${te.type}`,style:{backgroundColor:`${Ue.color}15`,color:Ue.color},children:Ue.icon}),t.jsxs("div",{className:"resource-item__content",children:[t.jsxs("div",{className:"resource-item__title",children:[te.titre,te.isPremium&&t.jsx("span",{className:"badge badge--premium",children:"Premium"}),!te.actif&&t.jsx("span",{className:"badge badge--warning",children:"Inactif"})]}),t.jsxs("div",{className:"resource-item__meta",children:[t.jsx("span",{children:Ue.label}),te.chapitre&&t.jsxs("span",{children:[" ",ul(te.chapitre)]}),te.duree&&t.jsxs("span",{children:[" ",te.duree," min"]}),te.fichierNom&&t.jsxs("span",{children:[" ",te.fichierNom]}),te.tags&&te.tags.length>0&&t.jsxs("span",{children:[" ",te.tags.join(", ")]})]})]}),t.jsxs("div",{className:"resource-item__actions",children:[t.jsx("button",{onClick:()=>ol(te),className:`table-action-btn ${te.isPremium?"table-action-btn--warning":"table-action-btn--view"}`,title:te.isPremium?"Passer en gratuit":"Passer en Premium",children:te.isPremium?"":""}),t.jsx("button",{onClick:()=>cl(te),className:`table-action-btn ${te.actif!==!1?"table-action-btn--view":"table-action-btn--warning"}`,title:te.actif!==!1?"Dsactiver":"Activer",children:te.actif!==!1?"":""}),(te.fichierURL||te.urlExterne)&&t.jsx("button",{onClick:()=>Pe(te),className:"table-action-btn table-action-btn--view",title:"Prvisualiser",children:""}),t.jsx("button",{onClick:()=>ee(te),className:"table-action-btn table-action-btn--edit",title:"Modifier",children:""}),t.jsx("button",{onClick:()=>ct(te),className:"table-action-btn table-action-btn--delete",title:"Supprimer",disabled:$===te.id,children:$===te.id?"":""})]})]},te.id)})}):t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{className:"empty-state__icon",children:""}),t.jsx("h3",{className:"empty-state__title",children:"Slectionnez une discipline"}),t.jsx("p",{className:"empty-state__message",children:"Choisissez une discipline ci-dessus pour voir ses ressources."})]})]}),ne&&t.jsx("div",{className:"modal-overlay",onClick:J,children:t.jsxs("div",{className:"modal modal--xl",onClick:te=>te.stopPropagation(),children:[t.jsxs("div",{className:"modal__header",children:[t.jsx("h2",{className:"modal__title",children:he?"Modifier la ressource":"Nouvelle ressource"}),t.jsx("button",{onClick:J,className:"modal__close",children:""})]}),t.jsxs("form",{onSubmit:Gn,children:[t.jsxs("div",{className:"modal__body",children:[!he&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label form-label--required",children:"Discipline"}),t.jsxs("select",{name:"disciplineId",className:`form-select ${Xe.disciplineId?"form-select--error":""}`,value:we.disciplineId,onChange:ce,children:[t.jsx("option",{value:"",children:"Slectionner une discipline"}),r.map(te=>t.jsxs("option",{value:te.id,children:[te.icone," ",te.nom," (",te.classe,")"]},te.id))]}),Xe.disciplineId&&t.jsx("span",{className:"form-error",children:Xe.disciplineId})]}),t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",style:{flex:2},children:[t.jsx("label",{className:"form-label form-label--required",children:"Titre"}),t.jsx("input",{type:"text",name:"titre",className:`form-input ${Xe.titre?"form-input--error":""}`,placeholder:"Ex: Introduction aux fractions",value:we.titre,onChange:ce}),Xe.titre&&t.jsx("span",{className:"form-error",children:Xe.titre})]}),t.jsxs("div",{className:"form-group",style:{flex:1},children:[t.jsx("label",{className:"form-label form-label--required",children:"Type"}),t.jsx("select",{name:"type",className:`form-select ${Xe.type?"form-select--error":""}`,value:we.type,onChange:ce,children:$d.map(te=>t.jsxs("option",{value:te.value,children:[te.icon," ",te.label]},te.value))}),Xe.type&&t.jsx("span",{className:"form-error",children:Xe.type})]})]}),t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Chapitre (optionnel)"}),t.jsxs("select",{name:"chapitre",className:"form-select",value:we.chapitre||we.chapitreId||"",onChange:ce,disabled:O,children:[t.jsx("option",{value:"",children:"Aucun chapitre"}),a.map(te=>t.jsxs("option",{value:te.id,children:[te.numero,". ",te.titre]},te.id))]})]}),t.jsxs("div",{className:"form-group",style:{flex:"0 0 120px"},children:[t.jsx("label",{className:"form-label",children:"Ordre"}),t.jsx("input",{type:"number",name:"ordre",className:"form-input",min:"1",value:we.ordre,onChange:ce})]}),t.jsxs("div",{className:"form-group",style:{flex:"0 0 120px"},children:[t.jsx("label",{className:"form-label",children:"Dure (min)"}),t.jsx("input",{type:"number",name:"duree",className:"form-input",min:"0",placeholder:"Ex: 30",value:we.duree||"",onChange:ce})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Description"}),t.jsx("textarea",{name:"description",className:"form-textarea",rows:3,placeholder:"Description de la ressource...",value:we.description||"",onChange:ce})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{className:"form-label",children:["Fichier",t.jsxs("span",{className:"form-helper",style:{marginLeft:"var(--spacing-sm)"},children:["(",Bd[we.type].join(", ")," - max ",Hv," Mo)"]})]}),t.jsxs("div",{className:"file-upload",children:[t.jsx("input",{ref:nn,type:"file",accept:Bd[we.type].join(","),onChange:Se,className:"file-upload__input",id:"file-input"}),!it&&!Mr?t.jsxs("label",{htmlFor:"file-input",className:"file-upload__dropzone",children:[t.jsx("div",{className:"file-upload__icon",children:""}),t.jsx("p",{className:"file-upload__text",children:"Cliquez ou glissez un fichier ici"}),t.jsx("p",{className:"file-upload__hint",children:Bd[we.type].join(", ")})]}):t.jsxs("div",{className:"file-upload__preview",children:[it?.type.startsWith("image/")&&Mr&&t.jsx("img",{src:Mr,alt:"Aperu",className:"file-preview__image"}),it?.type.startsWith("video/")&&Mr&&t.jsx("video",{src:Mr,controls:!0,className:"file-preview__video"}),!it?.type.startsWith("image/")&&!it?.type.startsWith("video/")&&t.jsx("div",{className:"file-preview__document",children:t.jsx("span",{className:"file-preview__icon",children:Hn(we.type).icon})}),t.jsxs("div",{className:"file-preview__info",children:[t.jsx("p",{className:"file-preview__name",children:it?.name||he?.fichierNom}),it&&t.jsx("p",{className:"file-preview__size",children:Np(it.size)})]}),t.jsx("button",{type:"button",onClick:Ze,className:"file-preview__remove",children:""})]})]}),Xe.fichier&&t.jsx("span",{className:"form-error",children:Xe.fichier}),Y&&t.jsxs("div",{className:"upload-progress",children:[t.jsx("div",{className:"upload-progress__bar",style:{width:`${M}%`}}),t.jsxs("span",{className:"upload-progress__text",children:[M,"%"]})]})]}),we.type==="video"&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"URL externe (YouTube, Vimeo...)"}),t.jsx("input",{type:"url",name:"urlExterne",className:"form-input",placeholder:"https://www.youtube.com/watch?v=...",value:we.urlExterne||"",onChange:ce}),t.jsx("span",{className:"form-helper",children:"Alternative  l'upload de fichier"})]}),we.type==="cours"&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Contenu du cours"}),t.jsx("textarea",{name:"contenu",className:"form-textarea",rows:6,placeholder:"Saisissez le contenu du cours ici...",value:we.contenu||"",onChange:ce}),t.jsx("span",{className:"form-helper",children:"Optionnel si vous uploadez un fichier"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Tags"}),t.jsxs("div",{className:"tags-input",children:[t.jsx("input",{type:"text",className:"form-input",placeholder:"Ajouter un tag...",value:pe,onChange:te=>ze(te.target.value),onKeyPress:te=>te.key==="Enter"&&(te.preventDefault(),kr())}),t.jsx("button",{type:"button",onClick:kr,className:"btn btn--outline btn--sm",children:"Ajouter"})]}),we.tags&&we.tags.length>0&&t.jsx("div",{className:"tags-list",children:we.tags.map((te,Ue)=>t.jsxs("span",{className:"tag",children:[te,t.jsx("button",{type:"button",onClick:()=>Fn(Ue),className:"tag__remove",children:""})]},Ue))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Options"}),t.jsxs("div",{className:"form-options",children:[t.jsxs("label",{className:"form-checkbox",children:[t.jsx("input",{type:"checkbox",name:"isPremium",checked:we.isPremium,onChange:ce}),t.jsx("span",{children:"Contenu Premium "})]}),t.jsxs("label",{className:"form-checkbox",children:[t.jsx("input",{type:"checkbox",name:"actif",checked:we.actif!==!1,onChange:ce}),t.jsx("span",{children:"Ressource active"})]})]})]})]}),t.jsxs("div",{className:"modal__footer",children:[t.jsx("button",{type:"button",onClick:J,className:"btn btn--outline",disabled:B||Y,children:"Annuler"}),t.jsx("button",{type:"submit",className:"btn btn--primary",disabled:B||Y,children:B||Y?Y?`Upload ${M}%...`:"Enregistrement...":he?"Mettre  jour":"Crer la ressource"})]})]})]})}),ve&&V&&t.jsx("div",{className:"modal-overlay",onClick:J,children:t.jsxs("div",{className:"modal modal--xl",onClick:te=>te.stopPropagation(),children:[t.jsxs("div",{className:"modal__header",children:[t.jsxs("h2",{className:"modal__title",children:[Hn(V.type).icon," ",V.titre]}),t.jsx("button",{onClick:J,className:"modal__close",children:""})]}),t.jsxs("div",{className:"modal__body",children:[V.type==="video"&&V.urlExterne?t.jsx("div",{className:"preview-video",children:t.jsx("iframe",{src:V.urlExterne.replace("watch?v=","embed/"),title:V.titre,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}):V.fichierURL?t.jsx("div",{className:"preview-file",children:V.fichierURL.match(/\.(jpg|jpeg|png|gif|webp)$/i)?t.jsx("img",{src:V.fichierURL,alt:V.titre}):V.fichierURL.match(/\.(mp4|webm)$/i)?t.jsx("video",{src:V.fichierURL,controls:!0}):V.fichierURL.match(/\.pdf$/i)?t.jsx("iframe",{src:V.fichierURL,title:V.titre}):t.jsxs("div",{className:"preview-download",children:[t.jsx("span",{className:"preview-download__icon",children:Hn(V.type).icon}),t.jsx("p",{children:V.fichierNom}),t.jsx("a",{href:V.fichierURL,target:"_blank",rel:"noopener noreferrer",className:"btn btn--primary",children:"Tlcharger"})]})}):V.contenu?t.jsx("div",{className:"preview-content",children:t.jsx("p",{children:V.contenu})}):t.jsx("div",{className:"preview-empty",children:t.jsx("p",{children:"Aucun contenu  prvisualiser"})}),t.jsxs("div",{className:"preview-info",children:[V.description&&t.jsx("p",{className:"preview-description",children:V.description}),t.jsxs("div",{className:"preview-meta",children:[t.jsxs("span",{children:["Type : ",Hn(V.type).label]}),V.duree&&t.jsxs("span",{children:["Dure : ",V.duree," min"]}),V.isPremium&&t.jsx("span",{className:"badge badge--premium",children:"Premium"})]})]})]})]})}),oe&&ue&&t.jsx("div",{className:"modal-overlay",onClick:J,children:t.jsxs("div",{className:"modal",onClick:te=>te.stopPropagation(),children:[t.jsxs("div",{className:"modal__header",children:[t.jsx("h2",{className:"modal__title",children:"Confirmer la suppression"}),t.jsx("button",{onClick:J,className:"modal__close",children:""})]}),t.jsxs("div",{className:"modal__body",children:[t.jsxs("p",{children:["Supprimer la ressource ",t.jsx("strong",{children:ue.titre})," ?"]}),ue.fichierURL&&t.jsxs("div",{className:"alert alert--warning",style:{marginTop:"var(--spacing-md)"},children:[t.jsx("span",{className:"alert__icon",children:""}),t.jsx("div",{className:"alert__content",children:t.jsx("p",{className:"alert__message",children:"Le fichier associ sera galement supprim de faon permanente."})})]})]}),t.jsxs("div",{className:"modal__footer",children:[t.jsx("button",{onClick:J,className:"btn btn--outline",children:"Annuler"}),t.jsx("button",{onClick:ia,className:"btn btn--danger",disabled:$!==null,children:$?"Suppression...":"Supprimer"})]})]})}),t.jsx("style",{children:`
        /* ==================== SLECTEUR DE DISCIPLINE ==================== */
        
        .discipline-tabs {
          display: flex;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
          margin-top: var(--spacing-md);
        }

        .discipline-tab {
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          padding: var(--spacing-sm) var(--spacing-md);
          border: 2px solid var(--color-border);
          border-radius: var(--radius-lg);
          background: white;
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .discipline-tab:hover {
          border-color: var(--discipline-color, var(--color-primary));
        }

        .discipline-tab--active {
          border-color: var(--discipline-color, var(--color-primary));
          background: color-mix(in srgb, var(--discipline-color, var(--color-primary)) 10%, white);
        }

        .discipline-tab__icon {
          font-size: var(--text-lg);
        }

        .discipline-tab__name {
          font-weight: var(--font-medium);
        }

        .discipline-tab__class {
          font-size: var(--text-xs);
          color: var(--color-text-light);
          background: var(--color-bg-secondary);
          padding: 2px 6px;
          border-radius: var(--radius-sm);
        }

        /* ==================== FORMULAIRE ==================== */
        
        .form-row {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
          gap: var(--spacing-lg);
        }

        .form-options {
          display: flex;
          flex-wrap: wrap;
          gap: var(--spacing-lg);
          margin-top: var(--spacing-sm);
        }

        .form-select--sm {
          padding: var(--spacing-sm) var(--spacing-md);
          font-size: var(--text-sm);
          min-width: 140px;
        }

        /* ==================== UPLOAD DE FICHIER ==================== */
        
        .file-upload {
          position: relative;
        }

        .file-upload__input {
          position: absolute;
          opacity: 0;
          pointer-events: none;
        }

        .file-upload__dropzone {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: var(--spacing-xl);
          border: 2px dashed var(--color-border);
          border-radius: var(--radius-lg);
          background: var(--color-bg-secondary);
          cursor: pointer;
          transition: all var(--transition-base);
        }

        .file-upload__dropzone:hover {
          border-color: var(--color-primary);
          background: rgba(37, 99, 235, 0.05);
        }

        .file-upload__icon {
          font-size: 48px;
          margin-bottom: var(--spacing-md);
        }

        .file-upload__text {
          font-weight: var(--font-medium);
          margin-bottom: var(--spacing-xs);
        }

        .file-upload__hint {
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        .file-upload__preview {
          display: flex;
          align-items: center;
          gap: var(--spacing-lg);
          padding: var(--spacing-md);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-lg);
          background: var(--color-bg-secondary);
        }

        .file-preview__image,
        .file-preview__video {
          width: 120px;
          height: 80px;
          object-fit: cover;
          border-radius: var(--radius-md);
        }

        .file-preview__document {
          width: 80px;
          height: 80px;
          background: white;
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .file-preview__icon {
          font-size: 32px;
        }

        .file-preview__info {
          flex: 1;
        }

        .file-preview__name {
          font-weight: var(--font-medium);
          margin-bottom: var(--spacing-xs);
          word-break: break-all;
        }

        .file-preview__size {
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        .file-preview__remove {
          width: 32px;
          height: 32px;
          border: none;
          background: var(--color-error);
          color: white;
          border-radius: 50%;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all var(--transition-base);
        }

        .file-preview__remove:hover {
          background: #dc2626;
          transform: scale(1.1);
        }

        /* ==================== BARRE DE PROGRESSION ==================== */
        
        .upload-progress {
          margin-top: var(--spacing-md);
          height: 8px;
          background: var(--color-bg-tertiary);
          border-radius: var(--radius-full);
          overflow: hidden;
          position: relative;
        }

        .upload-progress__bar {
          height: 100%;
          background: linear-gradient(90deg, var(--color-primary), var(--color-secondary));
          border-radius: var(--radius-full);
          transition: width var(--transition-base);
        }

        .upload-progress__text {
          position: absolute;
          right: var(--spacing-sm);
          top: 50%;
          transform: translateY(-50%);
          font-size: var(--text-xs);
          font-weight: var(--font-semibold);
          color: var(--color-text);
        }

        /* ==================== TAGS ==================== */
        
        .tags-input {
          display: flex;
          gap: var(--spacing-sm);
        }

        .tags-list {
          display: flex;
          flex-wrap: wrap;
          gap: var(--spacing-sm);
          margin-top: var(--spacing-md);
        }

        .tag {
          display: inline-flex;
          align-items: center;
          gap: var(--spacing-xs);
          padding: var(--spacing-xs) var(--spacing-sm);
          background: var(--color-bg-tertiary);
          border-radius: var(--radius-full);
          font-size: var(--text-sm);
          color: var(--color-text);
        }

        .tag__remove {
          width: 18px;
          height: 18px;
          border: none;
          background: transparent;
          color: var(--color-text-light);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          border-radius: 50%;
          transition: all var(--transition-base);
        }

        .tag__remove:hover {
          background: var(--color-error);
          color: white;
        }

        /* ==================== PRVISUALISATION ==================== */
        
        .preview-video {
          position: relative;
          padding-bottom: 56.25%;
          height: 0;
          overflow: hidden;
          border-radius: var(--radius-lg);
        }

        .preview-video iframe {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          border: none;
        }

        .preview-file {
          text-align: center;
        }

        .preview-file img,
        .preview-file video {
          max-width: 100%;
          max-height: 60vh;
          border-radius: var(--radius-lg);
        }

        .preview-file iframe {
          width: 100%;
          height: 60vh;
          border: none;
          border-radius: var(--radius-lg);
        }

        .preview-download {
          padding: var(--spacing-2xl);
          text-align: center;
        }

        .preview-download__icon {
          font-size: 64px;
          display: block;
          margin-bottom: var(--spacing-lg);
        }

        .preview-content {
          padding: var(--spacing-lg);
          background: var(--color-bg-secondary);
          border-radius: var(--radius-lg);
          white-space: pre-wrap;
        }

        .preview-empty {
          padding: var(--spacing-2xl);
          text-align: center;
          color: var(--color-text-light);
        }

        .preview-info {
          margin-top: var(--spacing-lg);
          padding-top: var(--spacing-lg);
          border-top: 1px solid var(--color-border);
        }

        .preview-description {
          color: var(--color-text-light);
          margin-bottom: var(--spacing-md);
        }

        .preview-meta {
          display: flex;
          flex-wrap: wrap;
          gap: var(--spacing-lg);
          font-size: var(--text-sm);
          color: var(--color-text-light);
        }

        /* ==================== RESSOURCES - AFFICHAGE CARTE ==================== */
        
        .resource-item__title {
          display: flex;
          align-items: center;
          gap: var(--spacing-sm);
          flex-wrap: wrap;
        }

        /* ==================== ACTION WARNING ==================== */
        
        .table-action-btn--warning {
          color: var(--color-warning);
        }

        /* ==================== RESPONSIVE ==================== */
        
        @media (max-width: 768px) {
          .form-row {
            grid-template-columns: 1fr;
          }

          .admin-table-actions {
            flex-direction: column;
            align-items: stretch;
          }

          .search-input__field {
            width: 100%;
          }

          .file-upload__preview {
            flex-direction: column;
            text-align: center;
          }

          .preview-meta {
            flex-direction: column;
            gap: var(--spacing-sm);
          }
        }
      `})]})},IA=_e(Q,"quizzes"),LA=async e=>{try{let r=Ee(IA,Ve("titre","asc"));e?.disciplineId;let a=(await Ce(r)).docs.map(l=>({id:l.id,...l.data()}));return e?.isPremium,e?.difficulte,a}catch(r){throw console.error("Erreur lors de la rcupration des quiz :",r),r}},eR=async e=>{try{const r=await Et(je(Q,"quizzes",e));return r.exists()?{id:r.id,...r.data()}:null}catch(r){throw console.error("Erreur lors de la rcupration du quiz :",r),r}},tR=async e=>{try{return(await Pt(IA,{...e,createdAt:Ae.now(),updatedAt:Ae.now()})).id}catch(r){throw console.error("Erreur lors de la cration du quiz :",r),r}},rR=async(e,r)=>{try{await He(je(Q,"quizzes",e),{...r,updatedAt:Ae.now()})}catch(n){throw console.error("Erreur lors de la mise  jour du quiz :",n),n}},nR=async e=>{try{await Br(je(Q,"quizzes",e))}catch(r){throw console.error("Erreur lors de la suppression du quiz :",r),r}},aR=()=>`q_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,G1=()=>({id:aR(),question:"",options:["","","",""],reponseCorrecte:0,explication:"",difficulte:"moyen",points:1}),H1=e=>{const r=e.questions||[],n=r.reduce((l,o)=>l+(o.points||1),0),a={facile:r.filter(l=>l.difficulte==="facile").length,moyen:r.filter(l=>l.difficulte==="moyen").length,difficile:r.filter(l=>l.difficulte==="difficile").length};return{nombreQuestions:r.length,totalPoints:n,parDifficulte:a,duree:e.duree||0}},iR=()=>{const[e,r]=g.useState([]),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState(null),[h,v]=g.useState(""),[b,x]=g.useState(""),[j,_]=g.useState(""),[C,w]=g.useState(""),[E,S]=g.useState(!1),[A,O]=g.useState("list"),[k,P]=g.useState(null),[D,B]=g.useState({disciplineId:"",titre:"",questions:[],duree:15,isPremium:!1,noteMinimale:50}),[U,$]=g.useState(null),[R,Y]=g.useState(!1),[ae,M]=g.useState(null),[T,F]=g.useState(null),[I,X]=g.useState({}),[L,ne]=g.useState(!1),K=g.useCallback(async()=>{o(!0),d(null);try{const[pe,ze]=await Promise.all([LA(),is.getAll()]);r(pe),a(ze.map(Re=>({id:Re.id,nom:Re.nom||Re.name||Re.id})))}catch(pe){d("Erreur lors du chargement des donnes."),console.error(pe)}finally{o(!1)}},[]);g.useEffect(()=>{K()},[K]),g.useEffect(()=>{if(f){const pe=setTimeout(()=>p(null),4e3);return()=>clearTimeout(pe)}},[f]);const oe=e.filter(pe=>{if(h){const ze=h.toLowerCase();if(!pe.titre.toLowerCase().includes(ze))return!1}return!(b&&pe.disciplineId!==b||j==="true"&&!pe.isPremium||j==="false"&&pe.isPremium||C&&!pe.questions?.some(Re=>Re.difficulte===C))}),xe=()=>{P(null),B({disciplineId:"",titre:"",questions:[G1()],duree:15,isPremium:!1,noteMinimale:50}),$(null),O("form")},ve=pe=>{P(pe),B({disciplineId:pe.disciplineId,titre:pe.titre,questions:pe.questions||[],duree:pe.duree||15,isPremium:pe.isPremium||!1,noteMinimale:pe.noteMinimale||50}),$(null),O("form")},H=async()=>{if(!D.titre.trim()){d("Le titre du quiz est obligatoire.");return}if(!D.disciplineId){d("Veuillez slectionner une discipline.");return}if(D.questions.length===0){d("Le quiz doit contenir au moins une question.");return}for(let pe=0;pe<D.questions.length;pe++){const ze=D.questions[pe];if(!ze.question.trim()){d(`La question ${pe+1} n'a pas d'nonc.`);return}if(ze.options.filter(Qe=>!Qe.trim()).length>0){d(`La question ${pe+1} a des options vides.`);return}}Y(!0),d(null);try{k?(await rR(k.id,D),p("Quiz mis  jour avec succs !")):(await tR(D),p("Quiz cr avec succs !")),await K(),O("list")}catch(pe){d("Erreur lors de la sauvegarde du quiz."),console.error(pe)}finally{Y(!1)}},he=async pe=>{try{await nR(pe),p("Quiz supprim avec succs."),M(null),await K()}catch(ze){d("Erreur lors de la suppression du quiz."),console.error(ze)}},Me=()=>{const pe=G1();B(ze=>({...ze,questions:[...ze.questions,pe]})),$(pe.id)},ue=pe=>{const ze=D.questions.find(It=>It.id===pe);if(!ze)return;const Re={...ze,id:`q_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,question:`${ze.question} (copie)`},Qe=D.questions.findIndex(It=>It.id===pe),pt=[...D.questions];pt.splice(Qe+1,0,Re),B(It=>({...It,questions:pt})),$(Re.id)},Z=pe=>{B(ze=>({...ze,questions:ze.questions.filter(Re=>Re.id!==pe)})),U===pe&&$(null)},V=(pe,ze,Re)=>{B(Qe=>({...Qe,questions:Qe.questions.map(pt=>pt.id===pe?{...pt,[ze]:Re}:pt)}))},me=(pe,ze,Re)=>{B(Qe=>({...Qe,questions:Qe.questions.map(pt=>pt.id===pe?{...pt,options:pt.options.map((It,nr)=>nr===ze?Re:It)}:pt)}))},we=pe=>{F(pe),X({}),ne(!1),O("preview")},qe=(pe,ze)=>{L||X(Re=>({...Re,[pe]:ze}))},Xe=()=>{ne(!0)},et=pe=>n.find(ze=>ze.id===pe)?.nom||pe,it=({level:pe})=>{const ze={facile:"quiz-badge-facile",moyen:"quiz-badge-moyen",difficile:"quiz-badge-difficile"};return t.jsx("span",{className:`quiz-badge ${ze[pe]||"quiz-badge-moyen"}`,children:pe.charAt(0).toUpperCase()+pe.slice(1)})},jr=()=>t.jsxs(t.Fragment,{children:[u&&t.jsxs("div",{className:"admin-message admin-message-error",children:[t.jsx(xm,{size:18}),t.jsx("span",{children:u}),t.jsx("button",{onClick:()=>d(null),className:"admin-message-close",children:t.jsx(Ki,{size:16})})]}),f&&t.jsxs("div",{className:"admin-message admin-message-success",children:[t.jsx(Ut,{size:18}),t.jsx("span",{children:f})]})]}),Mr=()=>t.jsxs("div",{className:"quiz-manager",children:[t.jsxs("div",{className:"admin-header",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"admin-title",children:[t.jsx(hn,{size:24})," Gestion des Quiz"]}),t.jsxs("p",{className:"admin-subtitle",children:[e.length," quiz au total  ",oe.length," affich(s)"]})]}),t.jsxs("button",{className:"admin-btn admin-btn-primary",onClick:xe,children:[t.jsx(Dc,{size:18})," Nouveau Quiz"]})]}),t.jsxs("div",{className:"admin-toolbar",children:[t.jsxs("div",{className:"admin-search-wrapper",children:[t.jsx(bA,{size:18,className:"admin-search-icon"}),t.jsx("input",{type:"text",className:"admin-search-input",placeholder:"Rechercher un quiz...",value:h,onChange:pe=>v(pe.target.value)})]}),t.jsxs("button",{className:`admin-btn admin-btn-outline ${E?"active":""}`,onClick:()=>S(!E),children:[t.jsx(Ub,{size:16})," Filtres",E?t.jsx(zx,{size:14}):t.jsx(gm,{size:14})]})]}),E&&t.jsxs("div",{className:"admin-filters-panel",children:[t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Discipline"}),t.jsxs("select",{className:"admin-select",value:b,onChange:pe=>x(pe.target.value),children:[t.jsx("option",{value:"",children:"Toutes les disciplines"}),n.map(pe=>t.jsx("option",{value:pe.id,children:pe.nom},pe.id))]})]}),t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Accs"}),t.jsxs("select",{className:"admin-select",value:j,onChange:pe=>_(pe.target.value),children:[t.jsx("option",{value:"",children:"Tous"}),t.jsx("option",{value:"false",children:"Gratuit"}),t.jsx("option",{value:"true",children:"Premium"})]})]}),t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Difficult"}),t.jsxs("select",{className:"admin-select",value:C,onChange:pe=>w(pe.target.value),children:[t.jsx("option",{value:"",children:"Toutes"}),t.jsx("option",{value:"facile",children:"Facile"}),t.jsx("option",{value:"moyen",children:"Moyen"}),t.jsx("option",{value:"difficile",children:"Difficile"})]})]}),t.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{x(""),_(""),w(""),v("")},children:"Rinitialiser"})]}),l?t.jsxs("div",{className:"admin-loading",children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement des quiz..."})]}):oe.length===0?t.jsxs("div",{className:"admin-empty-state",children:[t.jsx(cm,{size:48}),t.jsx("h3",{children:"Aucun quiz trouv"}),t.jsx("p",{children:e.length===0?"Crez votre premier quiz pour vos lves.":"Aucun quiz ne correspond  vos filtres."}),e.length===0&&t.jsxs("button",{className:"admin-btn admin-btn-primary",onClick:xe,children:[t.jsx(Dc,{size:18})," Crer un quiz"]})]}):t.jsx("div",{className:"quiz-grid",children:oe.map(pe=>{const ze=H1(pe);return t.jsxs("div",{className:"quiz-card",children:[t.jsxs("div",{className:"quiz-card-header",children:[t.jsxs("div",{className:"quiz-card-title-row",children:[t.jsx("h3",{className:"quiz-card-title",children:pe.titre}),pe.isPremium&&t.jsxs("span",{className:"quiz-badge quiz-badge-premium",children:[t.jsx(Zr,{size:12})," Premium"]})]}),t.jsx("span",{className:"quiz-card-discipline",children:et(pe.disciplineId)})]}),t.jsxs("div",{className:"quiz-card-stats",children:[t.jsxs("div",{className:"quiz-stat",children:[t.jsx(cm,{size:14}),t.jsxs("span",{children:[ze.nombreQuestions," question(s)"]})]}),t.jsxs("div",{className:"quiz-stat",children:[t.jsx(ts,{size:14}),t.jsxs("span",{children:[ze.totalPoints," pts"]})]}),t.jsxs("div",{className:"quiz-stat",children:[t.jsx(uo,{size:14}),t.jsxs("span",{children:[ze.duree," min"]})]})]}),t.jsxs("div",{className:"quiz-card-difficulty",children:[ze.parDifficulte.facile>0&&t.jsx(it,{level:"facile"}),ze.parDifficulte.moyen>0&&t.jsx(it,{level:"moyen"}),ze.parDifficulte.difficile>0&&t.jsx(it,{level:"difficile"})]}),t.jsxs("div",{className:"quiz-card-actions",children:[t.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>we(pe),title:"Prvisualiser",children:[t.jsx(lo,{size:14})," Aperu"]}),t.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>ve(pe),title:"Modifier",children:[t.jsx(_3,{size:14})," Modifier"]}),ae===pe.id?t.jsxs("div",{className:"quiz-delete-confirm",children:[t.jsx("button",{className:"admin-btn admin-btn-sm admin-btn-danger",onClick:()=>he(pe.id),children:"Confirmer"}),t.jsx("button",{className:"admin-btn admin-btn-sm admin-btn-ghost",onClick:()=>M(null),children:"Annuler"})]}):t.jsx("button",{className:"admin-btn admin-btn-sm admin-btn-danger-outline",onClick:()=>M(pe.id),title:"Supprimer",children:t.jsx(w1,{size:14})})]})]},pe.id)})})]}),cr=()=>t.jsxs("div",{className:"quiz-manager",children:[t.jsxs("div",{className:"admin-header",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"admin-title",children:[t.jsx(hn,{size:24}),k?"Modifier le quiz":"Nouveau quiz"]}),t.jsxs("p",{className:"admin-subtitle",children:[D.questions.length," question(s) ajoute(s)"]})]}),t.jsxs("div",{className:"admin-header-actions",children:[t.jsxs("button",{className:"admin-btn admin-btn-ghost",onClick:()=>O("list"),children:[t.jsx(Ki,{size:18})," Annuler"]}),t.jsxs("button",{className:"admin-btn admin-btn-primary",onClick:H,disabled:R,children:[t.jsx(N3,{size:18})," ",R?"Enregistrement...":"Enregistrer"]})]})]}),t.jsxs("div",{className:"admin-card quiz-form-section",children:[t.jsx("h3",{className:"quiz-form-section-title",children:"Informations gnrales"}),t.jsxs("div",{className:"quiz-form-grid",children:[t.jsxs("div",{className:"admin-form-group quiz-form-full",children:[t.jsx("label",{className:"admin-label",children:"Titre du quiz *"}),t.jsx("input",{type:"text",className:"admin-input",placeholder:"Ex : Quiz - Les Misrables, Chapitre 1",value:D.titre,onChange:pe=>B(ze=>({...ze,titre:pe.target.value}))})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Discipline *"}),t.jsxs("select",{className:"admin-select",value:D.disciplineId,onChange:pe=>B(ze=>({...ze,disciplineId:pe.target.value})),children:[t.jsx("option",{value:"",children:"-- Slectionner --"}),n.map(pe=>t.jsx("option",{value:pe.id,children:pe.nom},pe.id))]})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Dure (minutes)"}),t.jsx("input",{type:"number",className:"admin-input",min:1,max:180,value:D.duree,onChange:pe=>B(ze=>({...ze,duree:parseInt(pe.target.value)||15}))})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Note minimale (%)"}),t.jsx("input",{type:"number",className:"admin-input",min:0,max:100,value:D.noteMinimale,onChange:pe=>B(ze=>({...ze,noteMinimale:parseInt(pe.target.value)||50}))})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Accs"}),t.jsxs("div",{className:`quiz-toggle ${D.isPremium?"quiz-toggle-active":""}`,onClick:()=>B(pe=>({...pe,isPremium:!pe.isPremium})),children:[t.jsx(Zr,{size:16}),t.jsx("span",{children:D.isPremium?"Premium (2 000 FCFA/mois)":"Gratuit"})]})]})]})]}),t.jsxs("div",{className:"admin-card quiz-form-section",children:[t.jsxs("div",{className:"quiz-questions-header",children:[t.jsxs("h3",{className:"quiz-form-section-title",children:["Questions (",D.questions.length,")"]}),t.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-primary",onClick:Me,children:[t.jsx(Dc,{size:14})," Ajouter une question"]})]}),D.questions.length===0?t.jsxs("div",{className:"admin-empty-state",style:{padding:"2rem"},children:[t.jsx(cm,{size:36}),t.jsx("p",{children:'Aucune question. Cliquez sur "Ajouter une question" pour commencer.'})]}):t.jsx("div",{className:"quiz-questions-list",children:D.questions.map((pe,ze)=>t.jsxs("div",{className:`quiz-question-item ${U===pe.id?"expanded":""}`,children:[t.jsxs("div",{className:"quiz-question-header",onClick:()=>$(U===pe.id?null:pe.id),children:[t.jsxs("div",{className:"quiz-question-header-left",children:[t.jsx(S3,{size:16,className:"quiz-grip-icon"}),t.jsxs("span",{className:"quiz-question-number",children:["Q",ze+1]}),t.jsx("span",{className:"quiz-question-preview",children:pe.question||"Question sans nonc..."})]}),t.jsxs("div",{className:"quiz-question-header-right",children:[t.jsx(it,{level:pe.difficulte||"moyen"}),t.jsxs("span",{className:"quiz-question-points",children:[pe.points," pt(s)"]}),U===pe.id?t.jsx(zx,{size:16}):t.jsx(gm,{size:16})]})]}),U===pe.id&&t.jsxs("div",{className:"quiz-question-body",children:[t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"nonc de la question *"}),t.jsx("textarea",{className:"admin-textarea",rows:2,placeholder:"Ex : Quel est le personnage principal du roman ?",value:pe.question,onChange:Re=>V(pe.id,"question",Re.target.value)})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Options de rponse (cliquez sur la bonne rponse)"}),t.jsx("div",{className:"quiz-options-grid",children:pe.options.map((Re,Qe)=>t.jsxs("div",{className:`quiz-option-item ${pe.reponseCorrecte===Qe?"quiz-option-correct":""}`,children:[t.jsx("button",{type:"button",className:`quiz-option-radio ${pe.reponseCorrecte===Qe?"active":""}`,onClick:()=>V(pe.id,"reponseCorrecte",Qe),title:pe.reponseCorrecte===Qe?"Bonne rponse":"Marquer comme bonne rponse",children:pe.reponseCorrecte===Qe?t.jsx(Ut,{size:16}):t.jsx("span",{className:"quiz-option-letter",children:String.fromCharCode(65+Qe)})}),t.jsx("input",{type:"text",className:"admin-input",placeholder:`Option ${String.fromCharCode(65+Qe)}`,value:Re,onChange:pt=>me(pe.id,Qe,pt.target.value)})]},Qe))})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Explication (affiche aprs rponse)"}),t.jsx("textarea",{className:"admin-textarea",rows:2,placeholder:"Ex : Jean Valjean est le protagoniste du roman de Victor Hugo...",value:pe.explication,onChange:Re=>V(pe.id,"explication",Re.target.value)})]}),t.jsxs("div",{className:"quiz-question-meta",children:[t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Difficult"}),t.jsxs("select",{className:"admin-select",value:pe.difficulte,onChange:Re=>V(pe.id,"difficulte",Re.target.value),children:[t.jsx("option",{value:"facile",children:"Facile"}),t.jsx("option",{value:"moyen",children:"Moyen"}),t.jsx("option",{value:"difficile",children:"Difficile"})]})]}),t.jsxs("div",{className:"admin-form-group",children:[t.jsx("label",{className:"admin-label",children:"Points"}),t.jsx("input",{type:"number",className:"admin-input",min:1,max:10,value:pe.points,onChange:Re=>V(pe.id,"points",parseInt(Re.target.value)||1)})]})]}),t.jsxs("div",{className:"quiz-question-actions",children:[t.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>ue(pe.id),children:[t.jsx(w3,{size:14})," Dupliquer"]}),t.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-danger-outline",onClick:()=>Z(pe.id),children:[t.jsx(w1,{size:14})," Supprimer"]})]})]})]},pe.id))}),D.questions.length>0&&t.jsx("div",{className:"quiz-add-question-bottom",children:t.jsxs("button",{className:"admin-btn admin-btn-outline",onClick:Me,children:[t.jsx(Dc,{size:16})," Ajouter une question"]})})]})]}),nn=()=>{if(!T)return null;const pe=H1(T);let ze=0,Re=0;return L&&T.questions.forEach(Qe=>{Re+=Qe.points||1,I[Qe.id]===Qe.reponseCorrecte&&(ze+=Qe.points||1)}),t.jsxs("div",{className:"quiz-manager",children:[t.jsxs("div",{className:"admin-header",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"admin-title",children:[t.jsx(lo,{size:24})," Prvisualisation : ",T.titre]}),t.jsxs("p",{className:"admin-subtitle",children:[et(T.disciplineId),"  ",pe.nombreQuestions," questions  ",pe.duree," min"]})]}),t.jsxs("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{O("list"),F(null)},children:[t.jsx(Ki,{size:18})," Fermer"]})]}),L&&t.jsxs("div",{className:`quiz-preview-score ${ze/Re>=(T.noteMinimale||50)/100?"success":"fail"}`,children:[t.jsx(ts,{size:32}),t.jsxs("div",{children:[t.jsxs("h3",{children:["Score : ",ze,"/",Re," (",Math.round(ze/Re*100),"%)"]}),t.jsxs("p",{children:["Note minimale : ",T.noteMinimale||50,"% "," ",ze/Re>=(T.noteMinimale||50)/100?" Russi !":" Non russi"]})]})]}),t.jsx("div",{className:"quiz-preview-questions",children:T.questions.map((Qe,pt)=>{const It=I[Qe.id],nr=It===Qe.reponseCorrecte;return t.jsxs("div",{className:"admin-card quiz-preview-question",children:[t.jsxs("div",{className:"quiz-preview-question-header",children:[t.jsxs("span",{className:"quiz-question-number",children:["Q",pt+1]}),t.jsx(it,{level:Qe.difficulte||"moyen"}),t.jsxs("span",{className:"quiz-question-points",children:[Qe.points," pt(s)"]})]}),t.jsx("p",{className:"quiz-preview-question-text",children:Qe.question}),t.jsx("div",{className:"quiz-preview-options",children:Qe.options.map((Gr,ee)=>{let Pe="quiz-preview-option";return L?ee===Qe.reponseCorrecte?Pe+=" correct":ee===It&&!nr&&(Pe+=" incorrect"):It===ee&&(Pe+=" selected"),t.jsxs("button",{className:Pe,onClick:()=>qe(Qe.id,ee),disabled:L,children:[t.jsx("span",{className:"quiz-preview-option-letter",children:String.fromCharCode(65+ee)}),t.jsx("span",{children:Gr}),L&&ee===Qe.reponseCorrecte&&t.jsx(Ut,{size:16,className:"quiz-preview-check"})]},ee)})}),L&&Qe.explication&&t.jsxs("div",{className:"quiz-preview-explication",children:[t.jsx("strong",{children:"Explication :"})," ",Qe.explication]})]},Qe.id)})}),!L&&t.jsx("div",{className:"quiz-preview-submit",children:t.jsxs("button",{className:"admin-btn admin-btn-primary admin-btn-lg",onClick:Xe,disabled:Object.keys(I).length<T.questions.length,children:[t.jsx(Ut,{size:18})," Soumettre (",Object.keys(I).length,"/",T.questions.length,")"]})})]})};return t.jsxs("div",{className:"admin-container",children:[jr(),A==="list"&&Mr(),A==="form"&&cr(),A==="preview"&&nn()]})},$A=_e(Q,"users"),sR=_e(Q,"quizResults"),lR=async e=>{try{let r=Ee($A,Ve("displayName","asc"));e?.role;let a=(await Ce(r)).docs.map(l=>({uid:l.id,...l.data()}));return e?.isPremium,e?.isActive,e?.search,a}catch(r){throw console.error("Erreur lors de la rcupration des utilisateurs :",r),r}},oR=async(e,r)=>{try{await He(je(Q,"users",e),{role:r,updatedAt:Ae.now()})}catch(n){throw console.error("Erreur lors de la mise  jour du rle :",n),n}},cR=async(e,r)=>{try{const n={isPremium:r,updatedAt:Ae.now()};if(r){const a=new Date;a.setDate(a.getDate()+30),n.subscriptionEnd=Ae.fromDate(a)}else n.subscriptionEnd=null;await He(je(Q,"users",e),n)}catch(n){throw console.error("Erreur lors de la mise  jour du statut Premium :",n),n}},uR=async(e,r)=>{try{await He(je(Q,"users",e),{isActive:r,updatedAt:Ae.now()})}catch(n){throw console.error("Erreur lors du changement de statut du compte :",n),n}},dR=async e=>{try{const r=Ee(sR,Ne("userId","==",e)),a=(await Ce(r)).docs.map(f=>({id:f.id,...f.data()})),l=a.length,o=a.filter(f=>f.reussi).length,u=l>0?Math.round(a.reduce((f,p)=>f+p.score,0)/l):0,d=a.length>0?new Date(Math.max(...a.map(f=>{const p=f.datePassage;return p?.toDate?p.toDate().getTime():new Date(p).getTime()}))):null;return{totalQuizPasses:l,scoresMoyens:u,quizReussis:o,dernierQuiz:d}}catch(r){return console.error("Erreur lors du calcul des statistiques :",r),{totalQuizPasses:0,scoresMoyens:0,quizReussis:0,dernierQuiz:null}}},mR=async()=>{try{const r=(await Ce($A)).docs.map(n=>n.data());return{total:r.length,admins:r.filter(n=>n.role==="admin").length,profs:r.filter(n=>n.role==="prof").length,eleves:r.filter(n=>n.role==="eleve").length,premium:r.filter(n=>n.isPremium).length,actifs:r.filter(n=>n.isActive!==!1).length}}catch(e){throw console.error("Erreur lors du calcul des stats globales :",e),e}},fR=()=>{const[e,r]=g.useState([]),[n,a]=g.useState(null),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState(null),[h,v]=g.useState(""),[b,x]=g.useState(""),[j,_]=g.useState(""),[C,w]=g.useState(""),[E,S]=g.useState(!1),[A]=pA();g.useEffect(()=>{A.get("filter")==="premium"&&_("true")},[A]);const[O,k]=g.useState(null),[P,D]=g.useState(null),[B,U]=g.useState(!1),[$,R]=g.useState(null),[Y,ae]=g.useState(null),M=g.useCallback(async()=>{o(!0),d(null);try{const[H,he]=await Promise.all([lR(),mR()]);r(H),a(he)}catch(H){d("Erreur lors du chargement des utilisateurs."),console.error(H)}finally{o(!1)}},[]);g.useEffect(()=>{M()},[M]),g.useEffect(()=>{if(f){const H=setTimeout(()=>p(null),4e3);return()=>clearTimeout(H)}},[f]);const T=e.filter(H=>{if(h){const he=h.toLowerCase();if(!H.displayName?.toLowerCase().includes(he)&&!H.email?.toLowerCase().includes(he))return!1}return!(b&&H.role!==b||j==="true"&&!H.isPremium||j==="false"&&H.isPremium||C==="true"&&H.isActive===!1||C==="false"&&H.isActive!==!1)}),F=async H=>{k(H),U(!0);try{const he=await dR(H.uid);D(he)}catch(he){console.error("Erreur lors du chargement des statistiques :",he),D(null)}finally{U(!1)}},I=async()=>{if(Y){R(Y.userId);try{switch(Y.type){case"role":await oR(Y.userId,Y.value),p("Rle mis  jour avec succs.");break;case"premium":await cR(Y.userId,Y.value),p(Y.value?"Statut Premium activ (30 jours).":"Statut Premium dsactiv.");break;case"active":await uR(Y.userId,Y.value),p(Y.value?"Compte ractiv.":"Compte dsactiv.");break}await M()}catch(H){d("Erreur lors de l'excution de l'action."),console.error(H)}finally{R(null),ae(null)}}},X=({role:H})=>{const he={admin:{icon:t.jsx(Bb,{size:12}),className:"user-badge-admin",label:"Admin"},prof:{icon:t.jsx($s,{size:12}),className:"user-badge-prof",label:"Professeur"},eleve:{icon:t.jsx(hn,{size:12}),className:"user-badge-eleve",label:"lve"}},Me=he[H]||he.eleve;return t.jsxs("span",{className:`user-badge ${Me.className}`,children:[Me.icon," ",Me.label]})},L=H=>H?(H?.toDate?H.toDate():new Date(H)).toLocaleDateString("fr-SN",{day:"2-digit",month:"short",year:"numeric"}):"N/A",ne=H=>H?H.charAt(0).toUpperCase():"?",K=()=>t.jsxs(t.Fragment,{children:[u&&t.jsxs("div",{className:"admin-message admin-message-error",children:[t.jsx(xm,{size:18}),t.jsx("span",{children:u}),t.jsx("button",{onClick:()=>d(null),className:"admin-message-close",children:t.jsx(Ki,{size:16})})]}),f&&t.jsxs("div",{className:"admin-message admin-message-success",children:[t.jsx(Ut,{size:18}),t.jsx("span",{children:f})]})]}),oe=()=>{if(!n)return null;const H=[{label:"Total",value:n.total,icon:t.jsx(om,{size:20}),color:"stat-blue"},{label:"lves",value:n.eleves,icon:t.jsx(hn,{size:20}),color:"stat-green"},{label:"Professeurs",value:n.profs,icon:t.jsx($s,{size:20}),color:"stat-purple"},{label:"Premium",value:n.premium,icon:t.jsx(Zr,{size:20}),color:"stat-gold"}];return t.jsx("div",{className:"user-stats-grid",children:H.map(he=>t.jsxs("div",{className:`user-stat-card ${he.color}`,children:[t.jsx("div",{className:"user-stat-icon",children:he.icon}),t.jsxs("div",{className:"user-stat-info",children:[t.jsx("span",{className:"user-stat-value",children:he.value}),t.jsx("span",{className:"user-stat-label",children:he.label})]})]},he.label))})},xe=()=>Y?t.jsx("div",{className:"admin-modal-overlay",onClick:()=>ae(null),children:t.jsxs("div",{className:"admin-modal",onClick:H=>H.stopPropagation(),children:[t.jsxs("div",{className:"admin-modal-header",children:[t.jsx("h3",{children:"Confirmer l'action"}),t.jsx("button",{className:"admin-modal-close",onClick:()=>ae(null),children:t.jsx(Ki,{size:20})})]}),t.jsx("div",{className:"admin-modal-body",children:t.jsx("p",{children:Y.label})}),t.jsxs("div",{className:"admin-modal-footer",children:[t.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>ae(null),children:"Annuler"}),t.jsx("button",{className:"admin-btn admin-btn-primary",onClick:I,disabled:$===Y.userId,children:$===Y.userId?"En cours...":"Confirmer"})]})]})}):null,ve=()=>O?t.jsx("div",{className:"admin-modal-overlay",onClick:()=>k(null),children:t.jsxs("div",{className:"admin-modal admin-modal-lg",onClick:H=>H.stopPropagation(),children:[t.jsxs("div",{className:"admin-modal-header",children:[t.jsx("h3",{children:"Dtail de l'utilisateur"}),t.jsx("button",{className:"admin-modal-close",onClick:()=>k(null),children:t.jsx(Ki,{size:20})})]}),t.jsxs("div",{className:"admin-modal-body",children:[t.jsxs("div",{className:"user-detail-profile",children:[t.jsx("div",{className:"user-detail-avatar",children:ne(O.displayName)}),t.jsxs("div",{className:"user-detail-info",children:[t.jsx("h4",{children:O.displayName||"Sans nom"}),t.jsx("p",{children:O.email}),t.jsxs("div",{className:"user-detail-badges",children:[t.jsx(X,{role:O.role}),O.isPremium&&t.jsxs("span",{className:"user-badge user-badge-premium",children:[t.jsx(Zr,{size:12})," Premium"]}),t.jsx("span",{className:`user-badge ${O.isActive!==!1?"user-badge-active":"user-badge-inactive"}`,children:O.isActive!==!1?"Actif":"Dsactiv"})]})]})]}),t.jsxs("div",{className:"user-detail-dates",children:[t.jsxs("div",{children:[t.jsx("span",{className:"user-detail-date-label",children:"Inscription"}),t.jsx("span",{children:L(O.createdAt)})]}),O.isPremium&&O.subscriptionEnd&&t.jsxs("div",{children:[t.jsx("span",{className:"user-detail-date-label",children:"Premium jusqu'au"}),t.jsx("span",{children:L(O.subscriptionEnd)})]})]}),t.jsxs("div",{className:"user-detail-stats-section",children:[t.jsxs("h4",{children:[t.jsx(Bs,{size:18})," Statistiques"]}),B?t.jsxs("div",{className:"admin-loading",style:{padding:"1rem"},children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement des statistiques..."})]}):P?t.jsxs("div",{className:"user-detail-stats-grid",children:[t.jsxs("div",{className:"user-detail-stat",children:[t.jsx(hn,{size:20}),t.jsx("span",{className:"user-detail-stat-value",children:P.totalQuizPasses}),t.jsx("span",{className:"user-detail-stat-label",children:"Quiz passs"})]}),t.jsxs("div",{className:"user-detail-stat",children:[t.jsx(Pc,{size:20}),t.jsxs("span",{className:"user-detail-stat-value",children:[P.scoresMoyens,"%"]}),t.jsx("span",{className:"user-detail-stat-label",children:"Score moyen"})]}),t.jsxs("div",{className:"user-detail-stat",children:[t.jsx(ts,{size:20}),t.jsx("span",{className:"user-detail-stat-value",children:P.quizReussis}),t.jsx("span",{className:"user-detail-stat-label",children:"Quiz russis"})]}),t.jsxs("div",{className:"user-detail-stat",children:[t.jsx(uo,{size:20}),t.jsx("span",{className:"user-detail-stat-value",children:P.dernierQuiz?L(P.dernierQuiz):"Aucun"}),t.jsx("span",{className:"user-detail-stat-label",children:"Dernier quiz"})]})]}):t.jsx("p",{className:"user-detail-no-stats",children:"Aucune statistique disponible."})]})]})]})}):null;return t.jsxs("div",{className:"admin-container",children:[K(),xe(),ve(),t.jsxs("div",{className:"user-manager",children:[t.jsxs("div",{className:"admin-header",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"admin-title",children:[t.jsx(om,{size:24})," Gestion des Utilisateurs"]}),t.jsxs("p",{className:"admin-subtitle",children:[e.length," utilisateur(s) au total  ",T.length," affich(s)"]})]}),t.jsxs("button",{className:"admin-btn admin-btn-outline",onClick:M,children:[t.jsx(C3,{size:16})," Actualiser"]})]}),oe(),t.jsxs("div",{className:"admin-toolbar",children:[t.jsxs("div",{className:"admin-search-wrapper",children:[t.jsx(bA,{size:18,className:"admin-search-icon"}),t.jsx("input",{type:"text",className:"admin-search-input",placeholder:"Rechercher par nom ou email...",value:h,onChange:H=>v(H.target.value)})]}),t.jsxs("button",{className:`admin-btn admin-btn-outline ${E?"active":""}`,onClick:()=>S(!E),children:[t.jsx(Ub,{size:16})," Filtres",E?t.jsx(zx,{size:14}):t.jsx(gm,{size:14})]})]}),E&&t.jsxs("div",{className:"admin-filters-panel",children:[t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Rle"}),t.jsxs("select",{className:"admin-select",value:b,onChange:H=>x(H.target.value),children:[t.jsx("option",{value:"",children:"Tous les rles"}),t.jsx("option",{value:"admin",children:"Admin"}),t.jsx("option",{value:"prof",children:"Professeur"}),t.jsx("option",{value:"eleve",children:"lve"})]})]}),t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Abonnement"}),t.jsxs("select",{className:"admin-select",value:j,onChange:H=>_(H.target.value),children:[t.jsx("option",{value:"",children:"Tous"}),t.jsx("option",{value:"true",children:"Premium"}),t.jsx("option",{value:"false",children:"Gratuit"})]})]}),t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Statut"}),t.jsxs("select",{className:"admin-select",value:C,onChange:H=>w(H.target.value),children:[t.jsx("option",{value:"",children:"Tous"}),t.jsx("option",{value:"true",children:"Actifs"}),t.jsx("option",{value:"false",children:"Dsactivs"})]})]}),t.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{x(""),_(""),w(""),v("")},children:"Rinitialiser"})]}),l?t.jsxs("div",{className:"admin-loading",children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement des utilisateurs..."})]}):T.length===0?t.jsxs("div",{className:"admin-empty-state",children:[t.jsx(om,{size:48}),t.jsx("h3",{children:"Aucun utilisateur trouv"}),t.jsx("p",{children:e.length===0?"Aucun utilisateur n'est encore inscrit.":"Aucun utilisateur ne correspond  vos filtres."})]}):t.jsx("div",{className:"user-table-wrapper",children:t.jsxs("table",{className:"user-table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Utilisateur"}),t.jsx("th",{children:"Rle"}),t.jsx("th",{children:"Abonnement"}),t.jsx("th",{children:"Statut"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:T.map(H=>t.jsxs("tr",{className:H.isActive===!1?"user-row-inactive":"",children:[t.jsx("td",{children:t.jsxs("div",{className:"user-cell-info",children:[t.jsx("div",{className:"user-avatar-sm",children:ne(H.displayName)}),t.jsxs("div",{children:[t.jsx("span",{className:"user-cell-name",children:H.displayName||"Sans nom"}),t.jsx("span",{className:"user-cell-email",children:H.email})]})]})}),t.jsx("td",{children:t.jsxs("select",{className:"admin-select admin-select-sm",value:H.role,onChange:he=>ae({type:"role",userId:H.uid,value:he.target.value,label:`Changer le rle de "${H.displayName||H.email}" en "${he.target.value}" ?`}),children:[t.jsx("option",{value:"eleve",children:"lve"}),t.jsx("option",{value:"prof",children:"Professeur"}),t.jsx("option",{value:"admin",children:"Admin"})]})}),t.jsx("td",{children:t.jsx("button",{className:`user-premium-toggle ${H.isPremium?"active":""}`,onClick:()=>ae({type:"premium",userId:H.uid,value:!H.isPremium,label:H.isPremium?`Dsactiver le statut Premium de "${H.displayName||H.email}" ?`:`Activer le statut Premium de "${H.displayName||H.email}" pour 30 jours ?`}),disabled:$===H.uid,children:H.isPremium?t.jsxs(t.Fragment,{children:[t.jsx(Oc,{size:14})," Premium"]}):t.jsxs(t.Fragment,{children:[t.jsx(Zr,{size:14})," Gratuit"]})})}),t.jsx("td",{children:t.jsx("button",{className:`user-status-toggle ${H.isActive!==!1?"active":"inactive"}`,onClick:()=>ae({type:"active",userId:H.uid,value:H.isActive===!1,label:H.isActive===!1?`Ractiver le compte de "${H.displayName||H.email}" ?`:`Dsactiver le compte de "${H.displayName||H.email}" ?`}),disabled:$===H.uid,children:H.isActive!==!1?t.jsxs(t.Fragment,{children:[t.jsx(E3,{size:14})," Actif"]}):t.jsxs(t.Fragment,{children:[t.jsx(A3,{size:14})," Dsactiv"]})})}),t.jsx("td",{children:t.jsxs("button",{className:"admin-btn admin-btn-sm admin-btn-outline",onClick:()=>F(H),title:"Voir les statistiques",children:[t.jsx(lo,{size:14})," Dtail"]})})]},H.uid))})]})})]})]})},pR=()=>{const[e,r]=g.useState([]),[n,a]=g.useState(null),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState(""),[h,v]=g.useState(""),[b,x]=g.useState(""),[j,_]=g.useState(!1),C=g.useCallback(async()=>{try{o(!0),d(null);const O=await Ce(_e(Q,"users")),k=new Map;O.docs.forEach(oe=>{const xe=oe.data();k.set(oe.id,{name:xe.displayName||"Sans nom",email:xe.email||""})});const P=await Ce(_e(Q,"quizzes")),D=new Map;P.docs.forEach(oe=>{const xe=oe.data();D.set(oe.id,{titre:xe.titre||xe.quizTitre||"Quiz sans titre",discipline:xe.disciplineNom||xe.matiereNom||""})});const B=await Ce(_e(Q,"quizzes_v2")),U=new Map;B.docs.forEach(oe=>{const xe=oe.data();U.set(oe.id,{titre:xe.titre||"Quiz avanc sans titre",discipline:xe.disciplineNom||""})});const $=[];try{(await Ce(Ee(_e(Q,"quiz_results"),Ve("datePassage","desc"),Ht(200)))).docs.forEach(xe=>{const ve=xe.data(),H=k.get(ve.userId)||{name:"Inconnu",email:""},he=D.get(ve.quizId)||{titre:ve.quizTitre||"Quiz",discipline:ve.disciplineNom||""},Me=ve.pourcentage??(ve.totalPoints>0?Math.round(ve.score/ve.totalPoints*100):ve.score>0?Math.round(ve.score/20*100):0);$.push({id:xe.id,quizId:ve.quizId||"",quizTitre:he.titre,userId:ve.userId||"",userName:H.name,userEmail:H.email,score:ve.score||0,scoreMax:ve.totalPoints||20,pourcentage:Me,reussi:ve.reussi??Me>=50,tempsEcoule:ve.tempsEcoule||0,datePassage:ve.datePassage?.toDate?.()||new Date,type:"classique",disciplineNom:he.discipline})})}catch(oe){console.warn("Pas de rsultats v1 ou index manquant:",oe)}const R=[];try{(await Ce(Ee(_e(Q,"quiz_results_v2"),Ve("datePassage","desc"),Ht(200)))).docs.forEach(xe=>{const ve=xe.data(),H=k.get(ve.userId)||{name:"Inconnu",email:""},he=U.get(ve.quizId)||{titre:ve.quizTitre||"Quiz avanc",discipline:ve.disciplineNom||""},Me=ve.scoreMax>0?Math.round(ve.score/ve.scoreMax*100):0;R.push({id:xe.id,quizId:ve.quizId||"",quizTitre:he.titre,userId:ve.userId||"",userName:H.name,userEmail:H.email,score:ve.score||0,scoreMax:ve.scoreMax||0,pourcentage:Me,reussi:ve.reussi??Me>=50,tempsEcoule:ve.tempsTotal||ve.tempsEcoule||0,datePassage:ve.datePassage?.toDate?.()||new Date,type:"avance",disciplineNom:he.discipline})})}catch(oe){console.warn("Pas de rsultats v2 ou index manquant:",oe)}const Y=[...$,...R].sort((oe,xe)=>xe.datePassage.getTime()-oe.datePassage.getTime());r(Y);const ae=new Date,M=new Date(ae.getFullYear(),ae.getMonth(),ae.getDate()),T=new Date(M.getTime()-10080*60*1e3),F=Y.length,I=F>0?Math.round(Y.reduce((oe,xe)=>oe+xe.pourcentage,0)/F):0,X=F>0?Math.round(Y.filter(oe=>oe.reussi).length/F*100):0,L=F>0?Math.round(Y.reduce((oe,xe)=>oe+xe.tempsEcoule,0)/F):0,ne=Y.filter(oe=>oe.datePassage>=M).length,K=Y.filter(oe=>oe.datePassage>=T).length;a({totalResultats:F,moyenneGenerale:I,tauxReussite:X,tempsEcouleMoyen:L,resultatsAujourdHui:ne,resultats7Jours:K})}catch(O){console.error("Erreur chargement rsultats:",O),d("Impossible de charger les rsultats. Vrifiez votre connexion.")}finally{o(!1)}},[]);g.useEffect(()=>{C()},[C]);const w=e.filter(O=>{if(f&&O.type!==f||h==="true"&&!O.reussi||h==="false"&&O.reussi)return!1;if(b){const k=b.toLowerCase();if(!O.userName.toLowerCase().includes(k)&&!O.userEmail.toLowerCase().includes(k)&&!O.quizTitre.toLowerCase().includes(k)&&!O.disciplineNom.toLowerCase().includes(k))return!1}return!0}),E=O=>{if(O<60)return`${O}s`;const k=Math.floor(O/60),P=O%60;return P>0?`${k}min ${P}s`:`${k}min`},S=O=>O.toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),A=O=>O>=80?"results-score--excellent":O>=60?"results-score--bien":O>=40?"results-score--moyen":"results-score--faible";return t.jsxs("div",{className:"results-admin",children:[t.jsxs("div",{className:"admin-page-header",children:[t.jsxs("div",{className:"admin-page-header__info",children:[t.jsx("h1",{className:"admin-page-header__title",children:" Rsultats des Quiz"}),t.jsx("p",{className:"admin-page-header__subtitle",children:"Vue d'ensemble des performances des lves"})]}),t.jsx("div",{className:"admin-page-header__actions",children:t.jsx("button",{className:"admin-btn admin-btn-secondary",onClick:C,children:" Actualiser"})})]}),n&&t.jsxs("div",{className:"stats-grid",children:[t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--primary",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.totalResultats}),t.jsx("div",{className:"stat-card__label",children:"Rsultats totaux"})]})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--secondary",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsxs("div",{className:"stat-card__value",children:[n.moyenneGenerale,"%"]}),t.jsx("div",{className:"stat-card__label",children:"Moyenne gnrale"})]})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--warning",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsxs("div",{className:"stat-card__value",children:[n.tauxReussite,"%"]}),t.jsx("div",{className:"stat-card__label",children:"Taux de russite"})]})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("div",{className:"stat-card__icon stat-card__icon--info",children:""}),t.jsxs("div",{className:"stat-card__content",children:[t.jsx("div",{className:"stat-card__value",children:n.resultatsAujourdHui}),t.jsx("div",{className:"stat-card__label",children:"Aujourd'hui"})]})]})]}),t.jsxs("div",{className:"admin-toolbar",children:[t.jsxs("div",{className:"admin-search",children:[t.jsx("span",{className:"admin-search-icon",children:""}),t.jsx("input",{type:"text",className:"admin-search-input",placeholder:"Rechercher par lve, quiz ou discipline...",value:b,onChange:O=>x(O.target.value)})]}),t.jsx("button",{className:`admin-btn admin-btn-ghost ${j?"active":""}`,onClick:()=>_(!j),children:" Filtres"})]}),j&&t.jsxs("div",{className:"admin-filters-panel",children:[t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Type de quiz"}),t.jsxs("select",{className:"admin-select",value:f,onChange:O=>p(O.target.value),children:[t.jsx("option",{value:"",children:"Tous les types"}),t.jsx("option",{value:"classique",children:"Classique (v1)"}),t.jsx("option",{value:"avance",children:"Avanc (v2)"})]})]}),t.jsxs("div",{className:"admin-filter-group",children:[t.jsx("label",{className:"admin-filter-label",children:"Rsultat"}),t.jsxs("select",{className:"admin-select",value:h,onChange:O=>v(O.target.value),children:[t.jsx("option",{value:"",children:"Tous"}),t.jsx("option",{value:"true",children:"Russis"}),t.jsx("option",{value:"false",children:"chous"})]})]}),t.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:()=>{p(""),v(""),x("")},children:"Rinitialiser"})]}),l?t.jsxs("div",{className:"admin-loading",children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement des rsultats..."})]}):u?t.jsxs("div",{className:"admin-error",children:[t.jsxs("p",{children:[" ",u]}),t.jsx("button",{className:"admin-btn admin-btn-primary",onClick:C,children:"Ressayer"})]}):w.length===0?t.jsxs("div",{className:"admin-empty-state",children:[t.jsx("span",{style:{fontSize:"3rem"},children:""}),t.jsx("h3",{children:"Aucun rsultat trouv"}),t.jsx("p",{children:e.length===0?"Aucun lve n'a encore pass de quiz.":"Aucun rsultat ne correspond  vos filtres."})]}):t.jsxs("div",{className:"results-table-wrapper",children:[t.jsxs("table",{className:"results-table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"lve"}),t.jsx("th",{children:"Quiz"}),t.jsx("th",{children:"Type"}),t.jsx("th",{children:"Score"}),t.jsx("th",{children:"Rsultat"}),t.jsx("th",{children:"Dure"}),t.jsx("th",{children:"Date"})]})}),t.jsx("tbody",{children:w.map(O=>t.jsxs("tr",{children:[t.jsx("td",{children:t.jsxs("div",{className:"results-cell-user",children:[t.jsx("span",{className:"results-cell-name",children:O.userName}),t.jsx("span",{className:"results-cell-email",children:O.userEmail})]})}),t.jsx("td",{children:t.jsxs("div",{className:"results-cell-quiz",children:[t.jsx("span",{className:"results-cell-quiz-title",children:O.quizTitre}),O.disciplineNom&&t.jsx("span",{className:"results-cell-discipline",children:O.disciplineNom})]})}),t.jsx("td",{children:t.jsx("span",{className:`results-badge results-badge--${O.type}`,children:O.type==="classique"?" Classique":" Avanc"})}),t.jsxs("td",{children:[t.jsxs("span",{className:`results-score ${A(O.pourcentage)}`,children:[O.pourcentage,"%"]}),t.jsxs("span",{className:"results-score-detail",children:[O.score,"/",O.scoreMax]})]}),t.jsx("td",{children:t.jsx("span",{className:`results-status ${O.reussi?"results-status--success":"results-status--fail"}`,children:O.reussi?" Russi":" chou"})}),t.jsx("td",{className:"results-cell-duration",children:E(O.tempsEcoule)}),t.jsx("td",{className:"results-cell-date",children:S(O.datePassage)})]},`${O.type}-${O.id}`))})]}),t.jsx("div",{className:"results-footer",children:t.jsxs("p",{children:[w.length," rsultat",w.length>1?"s":""," affich",w.length>1?"s":"",w.length!==e.length&&` sur ${e.length} au total`]})})]})]})},Wl={siteName:"PedaClic",siteDescription:"L'cole en un clic  Plateforme ducative sngalaise",contactEmail:"contact@pedaclic.sn",contactPhone:"+221 XX XXX XX XX",premium3m:1e4,premium6m:2e4,premium1an:3e4,quizDureeDefaut:15,quizNoteMinimale:10,quizTentativesMax:3,maintenanceMode:!1,maintenanceMessage:"PedaClic est en maintenance. Nous revenons bientt !",cahierPdfExport:!0},hR=()=>{const[e,r]=g.useState(Wl),[n,a]=g.useState(Wl),[l,o]=g.useState(!0),[u,d]=g.useState(!1),[f,p]=g.useState(null),[h,v]=g.useState(null),[b,x]=g.useState(!1),j=g.useCallback(async()=>{try{o(!0),p(null);const S=je(Q,"settings","platform"),A=await Et(S);if(A.exists()){const O=A.data(),k={...Wl,...O};r(k),a(k)}else r(Wl),a(Wl)}catch(S){console.error("Erreur chargement paramtres:",S),p("Impossible de charger les paramtres.")}finally{o(!1)}},[]);g.useEffect(()=>{j()},[j]),g.useEffect(()=>{if(h){const S=setTimeout(()=>v(null),4e3);return()=>clearTimeout(S)}},[h]),g.useEffect(()=>{const S=JSON.stringify(e)!==JSON.stringify(n);x(S)},[e,n]);const _=(S,A)=>{r(O=>({...O,[S]:A}))},C=async()=>{try{if(d(!0),p(null),e.premium3m<0||e.premium6m<0||e.premium1an<0){p("Les tarifs ne peuvent pas tre ngatifs.");return}if(e.quizNoteMinimale<0||e.quizNoteMinimale>20){p("La note minimale doit tre entre 0 et 20.");return}const S=je(Q,"settings","platform");await su(S,{...e,updatedAt:Dt()}),a(e),x(!1),v("Paramtres sauvegards avec succs !")}catch(S){console.error("Erreur sauvegarde paramtres:",S),p("Impossible de sauvegarder les paramtres.")}finally{d(!1)}},w=()=>{r(n),x(!1)},E=()=>{window.confirm("Rinitialiser tous les paramtres aux valeurs par dfaut ?")&&r(Wl)};return l?t.jsxs("div",{className:"admin-loading",children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement des paramtres..."})]}):t.jsxs("div",{className:"settings-admin",children:[t.jsxs("div",{className:"admin-page-header",children:[t.jsxs("div",{className:"admin-page-header__info",children:[t.jsx("h1",{className:"admin-page-header__title",children:" Configuration"}),t.jsx("p",{className:"admin-page-header__subtitle",children:"Paramtres gnraux de la plateforme PedaClic"})]}),t.jsxs("div",{className:"admin-page-header__actions",children:[b&&t.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:w,children:"Annuler"}),t.jsx("button",{className:"admin-btn admin-btn-primary",onClick:C,disabled:!b||u,children:u?" Sauvegarde...":" Sauvegarder"})]})]}),b&&t.jsx("div",{className:"settings-unsaved-banner",children:" Vous avez des modifications non sauvegardes."}),f&&t.jsxs("div",{className:"admin-alert admin-alert--error",children:[" ",f]}),h&&t.jsxs("div",{className:"admin-alert admin-alert--success",children:[" ",h]}),t.jsxs("div",{className:"settings-section",children:[t.jsxs("div",{className:"settings-section__header",children:[t.jsx("h2",{className:"settings-section__title",children:" Informations gnrales"}),t.jsx("p",{className:"settings-section__description",children:"Informations de base de la plateforme"})]}),t.jsxs("div",{className:"settings-grid",children:[t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Nom du site"}),t.jsx("input",{type:"text",className:"admin-input",value:e.siteName,onChange:S=>_("siteName",S.target.value)})]}),t.jsxs("div",{className:"settings-field settings-field--full",children:[t.jsx("label",{className:"settings-label",children:"Description"}),t.jsx("input",{type:"text",className:"admin-input",value:e.siteDescription,onChange:S=>_("siteDescription",S.target.value)})]}),t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Email de contact"}),t.jsx("input",{type:"email",className:"admin-input",value:e.contactEmail,onChange:S=>_("contactEmail",S.target.value)})]}),t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Tlphone"}),t.jsx("input",{type:"tel",className:"admin-input",value:e.contactPhone,onChange:S=>_("contactPhone",S.target.value)})]})]})]}),t.jsxs("div",{className:"settings-section",children:[t.jsxs("div",{className:"settings-section__header",children:[t.jsx("h2",{className:"settings-section__title",children:" Tarifs Premium"}),t.jsx("p",{className:"settings-section__description",children:"Montants des abonnements en FCFA"})]}),t.jsxs("div",{className:"settings-grid",children:[t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Accs illimit 3 mois (FCFA)"}),t.jsx("input",{type:"number",className:"admin-input",value:e.premium3m,onChange:S=>_("premium3m",parseInt(S.target.value)||0),min:0,step:500})]}),t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Accs illimit 6 mois (FCFA)"}),t.jsx("input",{type:"number",className:"admin-input",value:e.premium6m,onChange:S=>_("premium6m",parseInt(S.target.value)||0),min:0,step:1e3}),t.jsxs("span",{className:"settings-hint",children:["conomie vs 23 mois : ",(e.premium3m*2-e.premium6m).toLocaleString("fr-FR")," FCFA"]})]}),t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Accs illimit 1 an (FCFA)"}),t.jsx("input",{type:"number",className:"admin-input",value:e.premium1an,onChange:S=>_("premium1an",parseInt(S.target.value)||0),min:0,step:1e3}),t.jsxs("span",{className:"settings-hint",children:["conomie vs 43 mois : ",(e.premium3m*4-e.premium1an).toLocaleString("fr-FR")," FCFA"]})]})]})]}),t.jsxs("div",{className:"settings-section",children:[t.jsxs("div",{className:"settings-section__header",children:[t.jsx("h2",{className:"settings-section__title",children:" Paramtres des Quiz"}),t.jsx("p",{className:"settings-section__description",children:"Valeurs par dfaut pour la cration de quiz"})]}),t.jsxs("div",{className:"settings-grid",children:[t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Dure par dfaut (minutes)"}),t.jsx("input",{type:"number",className:"admin-input",value:e.quizDureeDefaut,onChange:S=>_("quizDureeDefaut",parseInt(S.target.value)||0),min:1,max:120})]}),t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Note minimale pour russir (/20)"}),t.jsx("input",{type:"number",className:"admin-input",value:e.quizNoteMinimale,onChange:S=>_("quizNoteMinimale",parseInt(S.target.value)||0),min:0,max:20})]}),t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Tentatives max par quiz"}),t.jsx("input",{type:"number",className:"admin-input",value:e.quizTentativesMax,onChange:S=>_("quizTentativesMax",parseInt(S.target.value)||0),min:1,max:10}),t.jsx("span",{className:"settings-hint",children:"0 = illimit"})]})]})]}),t.jsxs("div",{className:"settings-section",children:[t.jsxs("div",{className:"settings-section__header",children:[t.jsx("h2",{className:"settings-section__title",children:" Cahier de Textes"}),t.jsx("p",{className:"settings-section__description",children:"Options des fonctionnalits du cahier de textes pour les professeurs"})]}),t.jsx("div",{className:"settings-grid",children:t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Export PDF du cahier"}),t.jsxs("div",{className:"settings-toggle-wrapper",children:[t.jsx("button",{className:`settings-toggle ${e.cahierPdfExport?"settings-toggle--active":""}`,onClick:()=>_("cahierPdfExport",!e.cahierPdfExport),children:t.jsx("span",{className:"settings-toggle__knob"})}),t.jsx("span",{className:`settings-toggle-label ${e.cahierPdfExport?"settings-toggle-label--active":""}`,children:e.cahierPdfExport?" Export PDF activ":" Export PDF dsactiv"})]}),t.jsx("span",{className:"settings-hint",children:'Affiche le bouton " PDF" dans les cahiers de textes des professeurs'})]})})]}),t.jsxs("div",{className:"settings-section",children:[t.jsxs("div",{className:"settings-section__header",children:[t.jsx("h2",{className:"settings-section__title",children:" Mode Maintenance"}),t.jsx("p",{className:"settings-section__description",children:"Activer pour bloquer l'accs au site pendant les mises  jour"})]}),t.jsxs("div",{className:"settings-grid",children:[t.jsxs("div",{className:"settings-field",children:[t.jsx("label",{className:"settings-label",children:"Mode maintenance"}),t.jsxs("div",{className:"settings-toggle-wrapper",children:[t.jsx("button",{className:`settings-toggle ${e.maintenanceMode?"settings-toggle--active":""}`,onClick:()=>_("maintenanceMode",!e.maintenanceMode),children:t.jsx("span",{className:"settings-toggle__knob"})}),t.jsx("span",{className:`settings-toggle-label ${e.maintenanceMode?"settings-toggle-label--active":""}`,children:e.maintenanceMode?" Maintenance active":" Site en ligne"})]})]}),t.jsxs("div",{className:"settings-field settings-field--full",children:[t.jsx("label",{className:"settings-label",children:"Message affich aux visiteurs"}),t.jsx("textarea",{className:"admin-input admin-textarea",rows:3,value:e.maintenanceMessage,onChange:S=>_("maintenanceMessage",S.target.value),disabled:!e.maintenanceMode})]})]})]}),t.jsxs("div",{className:"settings-actions",children:[t.jsx("button",{className:"admin-btn admin-btn-ghost",onClick:E,children:" Rinitialiser aux valeurs par dfaut"}),t.jsx("button",{className:"admin-btn admin-btn-primary",onClick:C,disabled:!b||u,children:u?" Sauvegarde...":" Sauvegarder les modifications"})]})]})},vR=["#000000","#1f2937","#374151","#6b7280","#dc2626","#ef4444","#f97316","#d97706","#eab308","#65a30d","#059669","#14b8a6","#2563eb","#3b82f6","#0891b2","#7c3aed","#db2777","#ec4899","#be185d","#9333ea","#ffffff","#f3f4f6","#fef3c7","#dbeafe"],gR=["#fef08a","#fde68a","#fef3c7","#bbf7d0","#d1fae5","#a7f3d0","#bfdbfe","#dbeafe","#c7d2fe","#fecaca","#fee2e2","#fde8e8","#e9d5ff","#f3e8ff","#d8b4fe","#fed7aa","#ffedd5","#fce7f3","transparent","#ffffff"],xR=["#f0fdf4","#ecfdf5","#f0f9ff","#eff6ff","#faf5ff","#fdf2f8","#fff7ed","#fffbeb","#fef2f2","#f9fafb","#f3f4f6","transparent"],bR=[{tag:"p",label:" Paragraphe"},{tag:"h1",label:"H1  Titre 1"},{tag:"h2",label:"H2  Titre 2"},{tag:"h3",label:"H3  Titre 3"},{tag:"h4",label:"H4  Titre 4"},{tag:"pre",label:"</> Code"},{tag:"blockquote",label:" Citation"}],yR=[{value:"1",label:"Trs petit"},{value:"2",label:"Petit"},{value:"3",label:"Normal"},{value:"4",label:"Grand"},{value:"5",label:"Trs grand"},{value:"6",label:"norme"}],jR=["headinglevel","fontsize","separator","bold","italic","underline","strikethrough","separator","color","highlight","blockBg","separator","alignLeft","alignCenter","alignRight","alignJustify","separator","bulletList","numberedList","indent","outdent","separator","subscript","superscript","link","clean"],ba=({value:e,onChange:r,placeholder:n="Saisissez votre texte...",minHeight:a=120,maxHeight:l=500,toolbar:o=jR,disabled:u=!1,className:d=""})=>{const f=g.useRef(null),p=g.useRef(!1),[h,v]=g.useState(!1),[b,x]=g.useState(!1),[j,_]=g.useState(!1);g.useEffect(()=>{f.current&&!p.current&&f.current.innerHTML!==e&&(f.current.innerHTML=e||""),p.current=!1},[e]);const C=g.useCallback(()=>{f.current&&(p.current=!0,r(f.current.innerHTML))},[r]),w=g.useCallback((k,P)=>{f.current?.focus(),document.execCommand(k,!1,P),C()},[C]),E=g.useCallback(k=>{f.current?.focus();const P=window.getSelection();if(!P||!f.current)return;let D=P.anchorNode;for(;D&&D!==f.current;){if(D.nodeType===Node.ELEMENT_NODE){const B=D,U=B.tagName;if(["P","DIV","H1","H2","H3","H4","LI","BLOCKQUOTE","PRE"].includes(U)){B.style.backgroundColor=k==="transparent"?"":k,C();return}}D=D.parentNode}document.execCommand("hiliteColor",!1,k==="transparent"?"transparent":k),C()},[C]),S=g.useCallback(()=>{const k=prompt("URL du lien :","https://");k&&w("createLink",k)},[w]),A=g.useCallback(()=>{w("removeFormat"),w("formatBlock","p")},[w]);g.useEffect(()=>{const k=()=>{v(!1),x(!1),_(!1)};return document.addEventListener("click",k),()=>document.removeEventListener("click",k)},[]);const O=(k,P)=>{switch(k){case"separator":return t.jsx("span",{className:"rte-separator"},`sep-${P}`);case"bold":return t.jsx("button",{type:"button",className:"rte-btn",title:"Gras (Ctrl+B)",onMouseDown:D=>{D.preventDefault(),w("bold")},children:t.jsx("strong",{children:"G"})},"bold");case"italic":return t.jsx("button",{type:"button",className:"rte-btn",title:"Italique (Ctrl+I)",onMouseDown:D=>{D.preventDefault(),w("italic")},children:t.jsx("em",{children:"I"})},"italic");case"underline":return t.jsx("button",{type:"button",className:"rte-btn",title:"Soulign (Ctrl+U)",onMouseDown:D=>{D.preventDefault(),w("underline")},children:t.jsx("u",{children:"S"})},"underline");case"strikethrough":return t.jsx("button",{type:"button",className:"rte-btn",title:"Barr",onMouseDown:D=>{D.preventDefault(),w("strikeThrough")},children:t.jsx("s",{children:"R"})},"strike");case"headinglevel":return t.jsxs("select",{className:"rte-select",title:"Niveau de titre",defaultValue:"",onChange:D=>{const B=D.target.value;f.current?.focus(),document.execCommand("formatBlock",!1,B),C(),D.target.value=""},children:[t.jsx("option",{value:"",disabled:!0,children:"Titre"}),bR.map(D=>t.jsx("option",{value:D.tag,children:D.label},D.tag))]},"headinglevel");case"fontsize":return t.jsxs("select",{className:"rte-select",title:"Taille de police",defaultValue:"",onChange:D=>{const B=D.target.value;f.current?.focus(),document.execCommand("fontSize",!1,B),C(),D.target.value=""},children:[t.jsx("option",{value:"",disabled:!0,children:"Taille"}),yR.map(D=>t.jsx("option",{value:D.value,children:D.label},D.value))]},"fontsize");case"color":return t.jsxs("span",{className:"rte-dropdown-wrapper",onClick:D=>D.stopPropagation(),children:[t.jsx("button",{type:"button",className:"rte-btn",title:"Couleur du texte",onClick:()=>{v(D=>!D),x(!1),_(!1)},children:t.jsx("span",{style:{borderBottom:"3px solid #dc2626",paddingBottom:1},children:"A"})}),h&&t.jsx("div",{className:"rte-color-picker rte-color-picker--grid",children:vR.map(D=>t.jsx("button",{type:"button",className:"rte-color-swatch",style:{backgroundColor:D,border:D==="#ffffff"||D==="#f3f4f6"?"1px solid #d1d5db":"1px solid transparent"},title:D,onMouseDown:B=>{B.preventDefault(),w("foreColor",D),v(!1)}},D))})]},"color");case"highlight":return t.jsxs("span",{className:"rte-dropdown-wrapper",onClick:D=>D.stopPropagation(),children:[t.jsx("button",{type:"button",className:"rte-btn",title:"Fond de texte (surlignage)",onClick:()=>{x(D=>!D),v(!1),_(!1)},children:t.jsx("span",{style:{backgroundColor:"#fef08a",padding:"0 3px",borderRadius:2},children:"A"})}),b&&t.jsx("div",{className:"rte-color-picker rte-color-picker--grid",children:gR.map((D,B)=>t.jsx("button",{type:"button",className:"rte-color-swatch",style:{backgroundColor:D==="transparent"?"#fff":D,border:"1px solid #d1d5db"},title:D==="transparent"?"Aucun fond":D,onMouseDown:U=>{U.preventDefault(),w("hiliteColor",D==="transparent"?"transparent":D),x(!1)},children:D==="transparent"?t.jsx("span",{style:{fontSize:10,color:"#6b7280"},children:""}):null},B))})]},"highlight");case"blockBg":return t.jsxs("span",{className:"rte-dropdown-wrapper",onClick:D=>D.stopPropagation(),children:[t.jsx("button",{type:"button",className:"rte-btn",title:"Trame de fond du paragraphe",onClick:()=>{_(D=>!D),v(!1),x(!1)},children:t.jsx("span",{style:{background:"linear-gradient(135deg, #dbeafe 40%, #d1fae5 100%)",padding:"0 3px",borderRadius:2},children:""})}),j&&t.jsx("div",{className:"rte-color-picker rte-color-picker--grid",children:xR.map((D,B)=>t.jsx("button",{type:"button",className:"rte-color-swatch rte-color-swatch--block",style:{backgroundColor:D==="transparent"?"#fff":D,border:"1px solid #d1d5db"},title:D==="transparent"?"Aucun fond":"Fond de bloc",onMouseDown:U=>{U.preventDefault(),E(D),_(!1)},children:D==="transparent"?t.jsx("span",{style:{fontSize:10,color:"#6b7280"},children:""}):null},B))})]},"blockbg");case"alignLeft":return t.jsx("button",{type:"button",className:"rte-btn",title:"Aligner  gauche",onMouseDown:D=>{D.preventDefault(),w("justifyLeft")},children:t.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:t.jsx("path",{d:"M2 12.5a.5.5 0 010-1h7a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h11a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h7a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h11a.5.5 0 010 1H2z"})})},"alignL");case"alignCenter":return t.jsx("button",{type:"button",className:"rte-btn",title:"Centrer",onMouseDown:D=>{D.preventDefault(),w("justifyCenter")},children:t.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:t.jsx("path",{d:"M4 12.5a.5.5 0 010-1h8a.5.5 0 010 1H4zm-2-3a.5.5 0 010-1h12a.5.5 0 010 1H2zm2-3a.5.5 0 010-1h8a.5.5 0 010 1H4zm-2-3a.5.5 0 010-1h12a.5.5 0 010 1H2z"})})},"alignC");case"alignRight":return t.jsx("button",{type:"button",className:"rte-btn",title:"Aligner  droite",onMouseDown:D=>{D.preventDefault(),w("justifyRight")},children:t.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:t.jsx("path",{d:"M14 12.5a.5.5 0 010-1H7a.5.5 0 010 1h7zm0-3a.5.5 0 010-1H3a.5.5 0 010 1h11zm0-3a.5.5 0 010-1H7a.5.5 0 010 1h7zm0-3a.5.5 0 010-1H3a.5.5 0 010 1h11z"})})},"alignR");case"alignJustify":return t.jsx("button",{type:"button",className:"rte-btn",title:"Justifier",onMouseDown:D=>{D.preventDefault(),w("justifyFull")},children:t.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 16 16",children:t.jsx("path",{d:"M2 12.5a.5.5 0 010-1h12a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h12a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h12a.5.5 0 010 1H2zm0-3a.5.5 0 010-1h12a.5.5 0 010 1H2z"})})},"alignJ");case"bulletList":return t.jsx("button",{type:"button",className:"rte-btn",title:"Liste  puces",onMouseDown:D=>{D.preventDefault(),w("insertUnorderedList")},children:""},"ul");case"numberedList":return t.jsx("button",{type:"button",className:"rte-btn",title:"Liste numrote",onMouseDown:D=>{D.preventDefault(),w("insertOrderedList")},children:"1"},"ol");case"indent":return t.jsx("button",{type:"button",className:"rte-btn",title:"Augmenter le retrait",onMouseDown:D=>{D.preventDefault(),w("indent")},children:""},"indent");case"outdent":return t.jsx("button",{type:"button",className:"rte-btn",title:"Diminuer le retrait",onMouseDown:D=>{D.preventDefault(),w("outdent")},children:""},"outdent");case"blockquote":return t.jsx("button",{type:"button",className:"rte-btn",title:"Citation",onMouseDown:D=>{D.preventDefault(),w("formatBlock","blockquote")},children:""},"blockquote");case"subscript":return t.jsxs("button",{type:"button",className:"rte-btn",title:"Indice",onMouseDown:D=>{D.preventDefault(),w("subscript")},children:["X",t.jsx("sub",{children:""})]},"sub");case"superscript":return t.jsxs("button",{type:"button",className:"rte-btn",title:"Exposant",onMouseDown:D=>{D.preventDefault(),w("superscript")},children:["X",t.jsx("sup",{children:""})]},"sup");case"link":return t.jsx("button",{type:"button",className:"rte-btn",title:"Insrer un lien",onMouseDown:D=>{D.preventDefault(),S()},children:""},"link");case"clean":return t.jsx("button",{type:"button",className:"rte-btn rte-btn-clean",title:"Effacer le formatage",onMouseDown:D=>{D.preventDefault(),A()},children:""},"clean");default:return null}};return t.jsxs("div",{className:`rte-container ${u?"rte-disabled":""} ${d}`,children:[!u&&t.jsx("div",{className:"rte-toolbar",children:o.map((k,P)=>O(k,P))}),t.jsx("div",{ref:f,className:"rte-editor",contentEditable:!u,onInput:C,onBlur:C,"data-placeholder":n,style:{minHeight:`${a}px`,maxHeight:`${l}px`},suppressContentEditableWarning:!0})]})},mo={qcm_unique:"QCM  Choix unique",qcm_multiple:"QCM  Choix multiple",drag_drop:"Glisser-Dposer",mise_en_relation:"Mise en relation",essai:"Essai / Rdaction"},ym={qcm_unique:"",qcm_multiple:"",drag_drop:"",mise_en_relation:"",essai:""},jm={qcm_unique:"#2563eb",qcm_multiple:"#7c3aed",drag_drop:"#059669",mise_en_relation:"#d97706",essai:"#dc2626"};function Jt(e="id"){return`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function _R(e,r){const n={id:Jt("q"),type:e,enonce:"",difficulte:"moyen",points:2,ordre:r};switch(e){case"qcm_unique":return{...n,typeData:{options:[{id:Jt("opt"),texte:"",isCorrect:!0},{id:Jt("opt"),texte:"",isCorrect:!1},{id:Jt("opt"),texte:"",isCorrect:!1},{id:Jt("opt"),texte:"",isCorrect:!1}]}};case"qcm_multiple":return{...n,typeData:{options:[{id:Jt("opt"),texte:"",isCorrect:!0},{id:Jt("opt"),texte:"",isCorrect:!0},{id:Jt("opt"),texte:"",isCorrect:!1},{id:Jt("opt"),texte:"",isCorrect:!1}],scoringPartiel:!0}};case"drag_drop":return{...n,typeData:{items:[{id:Jt("item"),texte:"",ordreCorrect:1},{id:Jt("item"),texte:"",ordreCorrect:2},{id:Jt("item"),texte:"",ordreCorrect:3}],consigneOrdre:"Remettez les lments dans le bon ordre"}};case"mise_en_relation":return{...n,typeData:{paires:[{id:Jt("pair"),gauche:"",droite:""},{id:Jt("pair"),gauche:"",droite:""},{id:Jt("pair"),gauche:"",droite:""}]}};case"essai":return{...n,points:5,typeData:{nombreMotsMin:50,nombreMotsMax:500,motsCles:[],correctionMode:"manuelle"}}}}const ou="quizzes_v2",NR="quiz_results_v2";async function SR(e,r){try{const n=await Pt(_e(Q,ou),{...e,auteurId:r,createdAt:Dt(),updatedAt:Dt()});return console.log(" Quiz avanc cr :",n.id),n.id}catch(n){throw console.error(" Erreur cration quiz avanc :",n),new Error("Impossible de crer le quiz")}}async function wR(e,r){try{const n=je(Q,ou,e);await He(n,{...r,updatedAt:Dt()}),console.log(" Quiz avanc mis  jour :",e)}catch(n){throw console.error(" Erreur mise  jour quiz :",n),new Error("Impossible de mettre  jour le quiz")}}async function CR(e){try{await Br(je(Q,ou,e)),console.log(" Quiz avanc supprim :",e)}catch(r){throw console.error(" Erreur suppression quiz :",r),new Error("Impossible de supprimer le quiz")}}async function BA(e){try{const r=await Et(je(Q,ou,e));if(!r.exists())return null;const n=r.data();return{id:r.id,...n,createdAt:n.createdAt?.toDate()||new Date,updatedAt:n.updatedAt?.toDate()||void 0}}catch(r){throw console.error(" Erreur rcupration quiz :",r),new Error("Impossible de rcuprer le quiz")}}async function UA(){try{const e=Ee(_e(Q,ou),Ve("createdAt","desc"));return(await Ce(e)).docs.map(n=>{const a=n.data();return{id:n.id,...a,createdAt:a.createdAt?.toDate()||new Date,updatedAt:a.updatedAt?.toDate()||void 0}})}catch(e){throw console.error(" Erreur rcupration tous les quiz :",e),new Error("Impossible de rcuprer les quiz")}}function ER(e,r){let n=0,a=0;const l=[];for(const o of e.questions){a+=o.points;const u=r.find(v=>v.questionId===o.id);if(!u){l.push({questionId:o.id,type:o.type,pointsObtenus:0,pointsMax:o.points,isCorrect:!1});continue}let d=0,f=!1,p=!1,h=!1;switch(o.type){case"qcm_unique":{const b=o.typeData.options.find(x=>x.isCorrect);b&&u.selectedOptionId===b.id&&(d=o.points,f=!0);break}case"qcm_multiple":{const v=o.typeData,b=v.options.filter(w=>w.isCorrect).map(w=>w.id),x=v.options.filter(w=>!w.isCorrect).map(w=>w.id),j=u.selectedOptionIds||[],_=j.some(w=>x.includes(w)),C=j.filter(w=>b.includes(w)).length;!_&&C===b.length?(d=o.points,f=!0):v.scoringPartiel&&C>0&&!_&&(d=Math.round(o.points*C/b.length*100)/100,p=!0);break}case"drag_drop":{const v=o.typeData,b=u.ordrePropose||[],x=v.items.sort((_,C)=>_.ordreCorrect-C.ordreCorrect).map(_=>_.id);let j=0;for(let _=0;_<x.length;_++)b[_]===x[_]&&j++;j===x.length?(d=o.points,f=!0):j>0&&(d=Math.round(o.points*j/x.length*100)/100,p=!0);break}case"mise_en_relation":{const v=o.typeData,b=u.relationsProposees||{};let x=0;for(const j of v.paires)b[j.id]===j.id&&x++;x===v.paires.length?(d=o.points,f=!0):x>0&&(d=Math.round(o.points*x/v.paires.length*100)/100,p=!0);break}case"essai":{const v=o.typeData,b=u.texteReponse||"";if(v.correctionMode==="mots_cles"&&v.motsCles.length>0){const x=b.toLowerCase().replace(/<[^>]*>/g,"");let j=0,_=0;for(const C of v.motsCles)j+=C.poids,x.includes(C.mot.toLowerCase())&&(_+=C.poids);j>0&&(d=Math.round(o.points*_/j*100)/100,f=_===j,p=_>0&&_<j)}else h=!0;break}}n+=d,l.push({questionId:o.id,type:o.type,pointsObtenus:d,pointsMax:o.points,isCorrect:f,isPartiel:p,correctionManuelleRequise:h})}return{score:n,scoreMax:a,details:l}}async function AR(e,r,n,a){try{const{score:l,scoreMax:o,details:u}=ER(e,n),d=o>0?Math.round(l/o*20*100)/100:0,f=u.some(v=>v.correctionManuelleRequise),p={quizId:e.id,userId:r,reponses:n,score:l,scoreMax:o,note20:d,tempsEcoule:a,datePassage:new Date,reussi:d>=e.noteMinimale,correctionManuelle:f,detailsParQuestion:u},h=await Pt(_e(Q,NR),{...p,datePassage:Dt()});return console.log(" Rsultat quiz enregistr :",h.id),{id:h.id,...p}}catch(l){throw console.error(" Erreur soumission quiz :",l),new Error("Impossible d'enregistrer le rsultat")}}const zR=({existingQuiz:e,disciplines:r,auteurId:n,onSave:a,onCancel:l})=>{const[o,u]=g.useState(e?.titre||""),[d,f]=g.useState(e?.description||""),[p,h]=g.useState(e?.disciplineId||""),[v,b]=g.useState(e?.duree||30),[x,j]=g.useState(e?.isPremium??!0),[_,C]=g.useState(e?.noteMinimale||10),[w,E]=g.useState(e?.melangerQuestions??!1),[S,A]=g.useState(e?.melangerOptions??!1),[O,k]=g.useState(e?.afficherCorrection??!0),[P,D]=g.useState(e?.tentativesMax||0),[B,U]=g.useState(e?.questions||[]),[$,R]=g.useState(null),[Y,ae]=g.useState(!1),[M,T]=g.useState(null),[F,I]=g.useState(!1),X=g.useCallback(H=>{const he=_R(H,B.length+1);U(Me=>[...Me,he]),R(B.length),I(!1)},[B.length]),L=g.useCallback(H=>{confirm("Supprimer cette question ?")&&(U(he=>he.filter((ue,Z)=>Z!==H).map((ue,Z)=>({...ue,ordre:Z+1}))),R(null))},[]),ne=g.useCallback(H=>{U(he=>{const Me=he[H],ue={...JSON.parse(JSON.stringify(Me)),id:Jt("q"),ordre:he.length+1};return[...he,ue]})},[]),K=g.useCallback((H,he)=>{U(Me=>{const ue=[...Me],Z=he==="up"?H-1:H+1;return Z<0||Z>=ue.length?Me:([ue[H],ue[Z]]=[ue[Z],ue[H]],ue.map((V,me)=>({...V,ordre:me+1})))}),R(he==="up"?$!==null?$-1:null:$!==null?$+1:null)},[$]),oe=g.useCallback((H,he)=>{U(Me=>Me.map((ue,Z)=>Z===H?{...ue,...he}:ue))},[]),xe=async()=>{if(!o.trim()){T("Le titre est obligatoire");return}if(!p){T("Slectionnez une discipline");return}if(B.length===0){T("Ajoutez au moins une question");return}for(let H=0;H<B.length;H++)if(!B[H].enonce.replace(/<[^>]*>/g,"").trim()){T(`La question ${H+1} n'a pas d'nonc`),R(H);return}T(null),ae(!0);try{const H={disciplineId:p,titre:o.trim(),description:d.trim()||void 0,questions:B,duree:v,isPremium:x,noteMinimale:_,melangerQuestions:w,melangerOptions:S,afficherCorrection:O,tentativesMax:P};let he;e?.id?(await wR(e.id,H),he=e.id):he=await SR(H,n),a?.(he)}catch(H){T(H.message||"Erreur lors de la sauvegarde")}finally{ae(!1)}},ve=B.reduce((H,he)=>H+he.points,0);return t.jsxs("div",{className:"quiz-editor",children:[t.jsxs("div",{className:"quiz-editor__header",children:[t.jsx("h2",{children:e?" Modifier le quiz":" Nouveau quiz avanc"}),t.jsxs("div",{className:"quiz-editor__header-actions",children:[t.jsxs("span",{className:"quiz-editor__score-badge",children:["Score total : ",ve," pts"]}),t.jsxs("span",{className:"quiz-editor__count-badge",children:[B.length," question",B.length>1?"s":""]})]})]}),M&&t.jsxs("div",{className:"quiz-editor__error",children:[" ",M,t.jsx("button",{onClick:()=>T(null),children:""})]}),t.jsxs("div",{className:"quiz-editor__section",children:[t.jsx("h3",{className:"quiz-editor__section-title",children:" Paramtres du quiz"}),t.jsxs("div",{className:"quiz-editor__grid",children:[t.jsxs("div",{className:"quiz-editor__field quiz-editor__field--full",children:[t.jsx("label",{children:"Titre du quiz *"}),t.jsx("input",{type:"text",value:o,onChange:H=>u(H.target.value),placeholder:"Ex: valuation Chapitre 3  Les fonctions",className:"quiz-editor__input"})]}),t.jsxs("div",{className:"quiz-editor__field",children:[t.jsx("label",{children:"Discipline *"}),t.jsxs("select",{value:p,onChange:H=>h(H.target.value),className:"quiz-editor__select",children:[t.jsx("option",{value:"",children:" Slectionner "}),r.map(H=>t.jsxs("option",{value:H.id,children:[H.nom," (",H.classe,")"]},H.id))]})]}),t.jsxs("div",{className:"quiz-editor__field",children:[t.jsx("label",{children:"Dure (minutes)"}),t.jsx("input",{type:"number",value:v,onChange:H=>b(Number(H.target.value)),min:1,max:180,className:"quiz-editor__input"})]}),t.jsxs("div",{className:"quiz-editor__field",children:[t.jsx("label",{children:"Note minimale (/20)"}),t.jsx("input",{type:"number",value:_,onChange:H=>C(Number(H.target.value)),min:0,max:20,className:"quiz-editor__input"})]}),t.jsxs("div",{className:"quiz-editor__field",children:[t.jsx("label",{children:"Tentatives max (0 = illimit)"}),t.jsx("input",{type:"number",value:P,onChange:H=>D(Number(H.target.value)),min:0,max:10,className:"quiz-editor__input"})]}),t.jsxs("div",{className:"quiz-editor__field quiz-editor__field--full",children:[t.jsx("label",{children:"Description (optionnel)"}),t.jsx(ba,{value:d,onChange:f,placeholder:"Dcrivez le contenu et les objectifs de ce quiz...",minHeight:80,toolbar:["bold","italic","underline","color","bulletList"]})]})]}),t.jsxs("div",{className:"quiz-editor__options-row",children:[t.jsxs("label",{className:"quiz-editor__checkbox",children:[t.jsx("input",{type:"checkbox",checked:x,onChange:H=>j(H.target.checked)}),t.jsx("span",{children:" Premium"})]}),t.jsxs("label",{className:"quiz-editor__checkbox",children:[t.jsx("input",{type:"checkbox",checked:w,onChange:H=>E(H.target.checked)}),t.jsx("span",{children:" Mlanger les questions"})]}),t.jsxs("label",{className:"quiz-editor__checkbox",children:[t.jsx("input",{type:"checkbox",checked:S,onChange:H=>A(H.target.checked)}),t.jsx("span",{children:" Mlanger les options QCM"})]}),t.jsxs("label",{className:"quiz-editor__checkbox",children:[t.jsx("input",{type:"checkbox",checked:O,onChange:H=>k(H.target.checked)}),t.jsx("span",{children:" Afficher la correction"})]})]})]}),t.jsxs("div",{className:"quiz-editor__section",children:[t.jsx("h3",{className:"quiz-editor__section-title",children:" Questions"}),t.jsx("div",{className:"quiz-editor__questions-list",children:B.map((H,he)=>t.jsx(kR,{question:H,index:he,isActive:$===he,onToggle:()=>R($===he?null:he),onUpdate:Me=>oe(he,Me),onDelete:()=>L(he),onDuplicate:()=>ne(he),onMoveUp:()=>K(he,"up"),onMoveDown:()=>K(he,"down"),isFirst:he===0,isLast:he===B.length-1},H.id))}),t.jsxs("div",{className:"quiz-editor__add-wrapper",children:[t.jsx("button",{type:"button",className:"quiz-editor__add-btn",onClick:()=>I(!F),children:"+ Ajouter une question"}),F&&t.jsx("div",{className:"quiz-editor__add-menu",children:Object.keys(mo).map(H=>t.jsxs("button",{type:"button",className:"quiz-editor__add-menu-item",onClick:()=>X(H),children:[t.jsx("span",{className:"quiz-editor__type-badge",style:{backgroundColor:jm[H]},children:ym[H]}),t.jsx("span",{children:mo[H]})]},H))})]})]}),t.jsxs("div",{className:"quiz-editor__actions",children:[t.jsx("button",{type:"button",className:"quiz-editor__btn quiz-editor__btn--secondary",onClick:l,disabled:Y,children:"Annuler"}),t.jsx("button",{type:"button",className:"quiz-editor__btn quiz-editor__btn--primary",onClick:xe,disabled:Y||B.length===0,children:Y?" Sauvegarde...":e?" Mettre  jour":" Crer le quiz"})]})]})},kR=({question:e,index:r,isActive:n,onToggle:a,onUpdate:l,onDelete:o,onDuplicate:u,onMoveUp:d,onMoveDown:f,isFirst:p,isLast:h})=>{const v=jm[e.type],b=ym[e.type],x=mo[e.type],j=_=>{const C=_.replace(/<[^>]*>/g,"").trim();return C.length>80?C.substring(0,80)+"...":C||"(sans nonc)"};return t.jsxs("div",{className:`question-editor ${n?"question-editor--active":""}`,style:{borderLeftColor:v},children:[t.jsxs("div",{className:"question-editor__header",onClick:a,children:[t.jsxs("div",{className:"question-editor__header-left",children:[t.jsx("span",{className:"question-editor__number",children:r+1}),t.jsxs("span",{className:"question-editor__type-badge",style:{backgroundColor:v},children:[b," ",x]}),!n&&t.jsx("span",{className:"question-editor__preview",children:j(e.enonce)})]}),t.jsxs("div",{className:"question-editor__header-right",children:[t.jsxs("span",{className:"question-editor__points",children:[e.points," pts"]}),t.jsx("span",{className:"question-editor__toggle",children:n?"":""})]})]}),n&&t.jsxs("div",{className:"question-editor__body",children:[t.jsxs("div",{className:"question-editor__toolbar",children:[t.jsx("button",{type:"button",onClick:d,disabled:p,title:"Monter",children:""}),t.jsx("button",{type:"button",onClick:f,disabled:h,title:"Descendre",children:""}),t.jsx("button",{type:"button",onClick:u,title:"Dupliquer",children:""}),t.jsx("button",{type:"button",onClick:o,className:"btn-danger",title:"Supprimer",children:""})]}),t.jsxs("div",{className:"question-editor__field",children:[t.jsx("label",{children:"nonc de la question *"}),t.jsx(ba,{value:e.enonce,onChange:_=>l({enonce:_}),placeholder:"Saisissez l'nonc de la question...",minHeight:100})]}),t.jsxs("div",{className:"question-editor__params",children:[t.jsxs("div",{className:"question-editor__param",children:[t.jsx("label",{children:"Difficult"}),t.jsxs("select",{value:e.difficulte,onChange:_=>l({difficulte:_.target.value}),children:[t.jsx("option",{value:"facile",children:" Facile"}),t.jsx("option",{value:"moyen",children:" Moyen"}),t.jsx("option",{value:"difficile",children:" Difficile"})]})]}),t.jsxs("div",{className:"question-editor__param",children:[t.jsx("label",{children:"Points"}),t.jsx("input",{type:"number",value:e.points,onChange:_=>l({points:Number(_.target.value)}),min:1,max:20})]})]}),t.jsxs("div",{className:"question-editor__type-specific",children:[e.type==="qcm_unique"&&t.jsx(OR,{data:e.typeData,onChange:_=>l({typeData:_})}),e.type==="qcm_multiple"&&t.jsx(DR,{data:e.typeData,onChange:_=>l({typeData:_})}),e.type==="drag_drop"&&t.jsx(PR,{data:e.typeData,onChange:_=>l({typeData:_})}),e.type==="mise_en_relation"&&t.jsx(MR,{data:e.typeData,onChange:_=>l({typeData:_})}),e.type==="essai"&&t.jsx(TR,{data:e.typeData,onChange:_=>l({typeData:_})})]}),t.jsxs("div",{className:"question-editor__field",children:[t.jsx("label",{children:"Explication (affiche aprs correction, optionnel)"}),t.jsx(ba,{value:e.explication||"",onChange:_=>l({explication:_}),placeholder:"Expliquez la bonne rponse...",minHeight:60,toolbar:["bold","italic","color","link"]})]})]})]})},OR=({data:e,onChange:r})=>{const n=(o,u)=>{const d=e.options.map((f,p)=>p===o?{...f,...u}:u.isCorrect===!0?{...f,isCorrect:!1}:f);r({options:d})},a=()=>{e.options.length>=6||r({options:[...e.options,{id:Jt("opt"),texte:"",isCorrect:!1}]})},l=o=>{e.options.length<=2||r({options:e.options.filter((u,d)=>d!==o)})};return t.jsxs("div",{className:"type-editor",children:[t.jsx("label",{className:"type-editor__label",children:" Options (slectionnez la bonne rponse)"}),e.options.map((o,u)=>t.jsxs("div",{className:"type-editor__option-row",children:[t.jsx("input",{type:"radio",name:`qcm_unique_${o.id}`,checked:o.isCorrect,onChange:()=>n(u,{isCorrect:!0}),className:"type-editor__radio",title:"Bonne rponse"}),t.jsx("div",{className:"type-editor__option-text",children:t.jsx(ba,{value:o.texte,onChange:d=>n(u,{texte:d}),placeholder:`Option ${u+1}...`,minHeight:40,toolbar:["bold","italic","color","subscript","superscript"]})}),o.isCorrect&&t.jsx("span",{className:"type-editor__correct-badge",children:""}),t.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.options.length<=2,title:"Supprimer cette option",children:""})]},o.id)),e.options.length<6&&t.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter une option"})]})},DR=({data:e,onChange:r})=>{const n=(o,u)=>{const d=e.options.map((f,p)=>p===o?{...f,...u}:f);r({...e,options:d})},a=()=>{e.options.length>=8||r({...e,options:[...e.options,{id:Jt("opt"),texte:"",isCorrect:!1}]})},l=o=>{e.options.length<=2||r({...e,options:e.options.filter((u,d)=>d!==o)})};return t.jsxs("div",{className:"type-editor",children:[t.jsx("label",{className:"type-editor__label",children:" Options (cochez toutes les bonnes rponses)"}),e.options.map((o,u)=>t.jsxs("div",{className:"type-editor__option-row",children:[t.jsx("input",{type:"checkbox",checked:o.isCorrect,onChange:d=>n(u,{isCorrect:d.target.checked}),className:"type-editor__checkbox",title:"Bonne rponse"}),t.jsx("div",{className:"type-editor__option-text",children:t.jsx(ba,{value:o.texte,onChange:d=>n(u,{texte:d}),placeholder:`Option ${u+1}...`,minHeight:40,toolbar:["bold","italic","color","subscript","superscript"]})}),o.isCorrect&&t.jsx("span",{className:"type-editor__correct-badge",children:""}),t.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.options.length<=2,children:""})]},o.id)),e.options.length<8&&t.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter une option"}),t.jsxs("label",{className:"type-editor__sub-option",children:[t.jsx("input",{type:"checkbox",checked:e.scoringPartiel,onChange:o=>r({...e,scoringPartiel:o.target.checked})}),t.jsx("span",{children:"Accorder des points partiels (proportionnel aux bonnes rponses trouves)"})]})]})},PR=({data:e,onChange:r})=>{const n=(o,u)=>{const d=e.items.map((f,p)=>p===o?{...f,...u}:f);r({...e,items:d})},a=()=>{e.items.length>=10||r({...e,items:[...e.items,{id:Jt("item"),texte:"",ordreCorrect:e.items.length+1}]})},l=o=>{if(e.items.length<=2)return;const u=e.items.filter((d,f)=>f!==o).map((d,f)=>({...d,ordreCorrect:f+1}));r({...e,items:u})};return t.jsxs("div",{className:"type-editor",children:[t.jsx("label",{className:"type-editor__label",children:" lments  rordonner (dans l'ordre correct)"}),t.jsx("p",{className:"type-editor__hint",children:"Saisissez les lments dans l'ordre correct. Ils seront mlangs automatiquement pour l'lve."}),t.jsxs("div",{className:"type-editor__field-inline",children:[t.jsx("label",{children:"Consigne :"}),t.jsx("input",{type:"text",value:e.consigneOrdre,onChange:o=>r({...e,consigneOrdre:o.target.value}),placeholder:"Ex: Classez du plus ancien au plus rcent",className:"type-editor__input"})]}),e.items.map((o,u)=>t.jsxs("div",{className:"type-editor__drag-row",children:[t.jsx("span",{className:"type-editor__drag-number",children:u+1}),t.jsx("div",{className:"type-editor__option-text",children:t.jsx(ba,{value:o.texte,onChange:d=>n(u,{texte:d}),placeholder:`lment ${u+1}...`,minHeight:40,toolbar:["bold","italic","color"]})}),t.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.items.length<=2,children:""})]},o.id)),e.items.length<10&&t.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter un lment"})]})},MR=({data:e,onChange:r})=>{const n=(o,u)=>{const d=e.paires.map((f,p)=>p===o?{...f,...u}:f);r({paires:d})},a=()=>{e.paires.length>=8||r({paires:[...e.paires,{id:Jt("pair"),gauche:"",droite:""}]})},l=o=>{e.paires.length<=2||r({paires:e.paires.filter((u,d)=>d!==o)})};return t.jsxs("div",{className:"type-editor",children:[t.jsx("label",{className:"type-editor__label",children:" Paires  relier (gauche  droite)"}),t.jsx("p",{className:"type-editor__hint",children:"Saisissez les correspondances correctes. La colonne droite sera mlange pour l'lve."}),t.jsxs("div",{className:"type-editor__relation-header",children:[t.jsx("span",{children:"Colonne A (gauche)"}),t.jsx("span",{}),t.jsx("span",{children:"Colonne B (droite)"}),t.jsx("span",{})]}),e.paires.map((o,u)=>t.jsxs("div",{className:"type-editor__relation-row",children:[t.jsx("div",{className:"type-editor__relation-cell",children:t.jsx(ba,{value:o.gauche,onChange:d=>n(u,{gauche:d}),placeholder:`lment A${u+1}...`,minHeight:40,toolbar:["bold","italic","color"]})}),t.jsx("span",{className:"type-editor__relation-arrow",children:""}),t.jsx("div",{className:"type-editor__relation-cell",children:t.jsx(ba,{value:o.droite,onChange:d=>n(u,{droite:d}),placeholder:`lment B${u+1}...`,minHeight:40,toolbar:["bold","italic","color"]})}),t.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),disabled:e.paires.length<=2,children:""})]},o.id)),e.paires.length<8&&t.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:a,children:"+ Ajouter une paire"})]})},TR=({data:e,onChange:r})=>{const n=()=>{r({...e,motsCles:[...e.motsCles,{mot:"",poids:1,obligatoire:!1}]})},a=(o,u)=>{const d=e.motsCles.map((f,p)=>p===o?{...f,...u}:f);r({...e,motsCles:d})},l=o=>{r({...e,motsCles:e.motsCles.filter((u,d)=>d!==o)})};return t.jsxs("div",{className:"type-editor",children:[t.jsx("label",{className:"type-editor__label",children:" Paramtres de l'essai"}),t.jsxs("div",{className:"type-editor__params-row",children:[t.jsxs("div",{className:"type-editor__param-inline",children:[t.jsx("label",{children:"Mots minimum :"}),t.jsx("input",{type:"number",value:e.nombreMotsMin||"",onChange:o=>r({...e,nombreMotsMin:Number(o.target.value)||void 0}),min:0,placeholder:"Ex: 50"})]}),t.jsxs("div",{className:"type-editor__param-inline",children:[t.jsx("label",{children:"Mots maximum :"}),t.jsx("input",{type:"number",value:e.nombreMotsMax||"",onChange:o=>r({...e,nombreMotsMax:Number(o.target.value)||void 0}),min:0,placeholder:"Ex: 500"})]})]}),t.jsxs("div",{className:"type-editor__field-inline",children:[t.jsx("label",{children:"Mode de correction :"}),t.jsxs("select",{value:e.correctionMode,onChange:o=>r({...e,correctionMode:o.target.value}),children:[t.jsx("option",{value:"manuelle",children:" Manuelle (par le prof)"}),t.jsx("option",{value:"mots_cles",children:" Par mots-cls (automatique)"}),t.jsx("option",{value:"semi_auto",children:" Semi-automatique (mots-cls + validation prof)"})]})]}),(e.correctionMode==="mots_cles"||e.correctionMode==="semi_auto")&&t.jsxs("div",{className:"type-editor__keywords",children:[t.jsx("label",{className:"type-editor__sub-label",children:"Mots-cls attendus"}),e.motsCles.map((o,u)=>t.jsxs("div",{className:"type-editor__keyword-row",children:[t.jsx("input",{type:"text",value:o.mot,onChange:d=>a(u,{mot:d.target.value}),placeholder:"Mot ou expression...",className:"type-editor__keyword-input"}),t.jsxs("select",{value:o.poids,onChange:d=>a(u,{poids:Number(d.target.value)}),className:"type-editor__keyword-weight",children:[t.jsx("option",{value:1,children:"Poids 1"}),t.jsx("option",{value:2,children:"Poids 2"}),t.jsx("option",{value:3,children:"Poids 3"}),t.jsx("option",{value:4,children:"Poids 4"}),t.jsx("option",{value:5,children:"Poids 5"})]}),t.jsxs("label",{className:"type-editor__keyword-required",children:[t.jsx("input",{type:"checkbox",checked:o.obligatoire,onChange:d=>a(u,{obligatoire:d.target.checked})}),t.jsx("span",{children:"Obligatoire"})]}),t.jsx("button",{type:"button",className:"type-editor__remove-btn",onClick:()=>l(u),children:""})]},u)),t.jsx("button",{type:"button",className:"type-editor__add-btn",onClick:n,children:"+ Ajouter un mot-cl"})]}),t.jsxs("div",{className:"type-editor__field-block",children:[t.jsx("label",{children:"Rponse modle (optionnel  pour le prof)"}),t.jsx(ba,{value:e.reponseModele||"",onChange:o=>r({...e,reponseModele:o}),placeholder:"Saisissez une rponse modle...",minHeight:80})]})]})},V1=()=>{const{quizId:e}=xn(),r=Je(),{currentUser:n}=Ke(),[a,l]=g.useState([]),[o,u]=g.useState(void 0),[d,f]=g.useState(!0),[p,h]=g.useState(null);return g.useEffect(()=>{(async()=>{try{f(!0);const b=await is.getAll();if(l(b.map(x=>({id:x.id,nom:x.nom,classe:x.classe||""}))),e){const x=await BA(e);x?u(x):h("Quiz introuvable")}}catch(b){console.error("Erreur chargement donnes:",b),h(b.message||"Erreur de chargement")}finally{f(!1)}})()},[e]),d?t.jsx("div",{style:{textAlign:"center",padding:"3rem"},children:t.jsx("p",{children:" Chargement..."})}):p?t.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[t.jsxs("p",{style:{color:"#dc2626"},children:[" ",p]}),t.jsx("button",{onClick:()=>r(-1),children:" Retour"})]}):t.jsx(zR,{existingQuiz:o?{...o,id:o.id}:void 0,disciplines:a,auteurId:n?.uid||"",onSave:v=>{alert(" Quiz sauvegard avec succs !"),r("/admin/quiz")},onCancel:()=>r(-1)})},qR=()=>{const e=Je(),{currentUser:r}=Ke(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState(null);g.useEffect(()=>{h()},[]);const h=async()=>{try{o(!0),d(null);const _=await UA();a(_)}catch(_){console.error("Erreur chargement quiz:",_),d("Impossible de charger les quiz")}finally{o(!1)}},v=async _=>{try{await CR(_),a(C=>C.filter(w=>w.id!==_)),p(null)}catch(C){console.error("Erreur suppression:",C),alert("Erreur lors de la suppression : "+C.message)}},b=_=>{const C={};return _.questions.forEach(w=>{C[w.type]=(C[w.type]||0)+1}),Object.entries(C).map(([w,E])=>`${E} ${mo[w]||w}`).join(", ")},x=_=>_?(_.toDate?_.toDate():new Date(_)).toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric"}):"",j=_=>_.questions.reduce((C,w)=>C+w.points,0);return t.jsxs("div",{style:{padding:"1.5rem"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",flexWrap:"wrap",gap:"1rem"},children:[t.jsxs("div",{children:[t.jsx("h1",{style:{fontSize:"1.5rem",fontWeight:700,color:"#1f2937",margin:0},children:" Quiz Avancs (Multi-types)"}),t.jsxs("p",{style:{color:"#6b7280",margin:"0.25rem 0 0",fontSize:"0.9rem"},children:[n.length," quiz cr",n.length!==1?"s":""]})]}),t.jsx("button",{onClick:()=>e("/admin/quiz/nouveau"),style:{padding:"0.7rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.9rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:" Nouveau quiz avanc"})]}),u&&t.jsxs("div",{style:{padding:"1rem",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",color:"#991b1b",marginBottom:"1rem"},children:[" ",u,t.jsx("button",{onClick:h,style:{marginLeft:"1rem",padding:"0.3rem 0.8rem",background:"#fff",border:"1px solid #d1d5db",borderRadius:"6px",cursor:"pointer"},children:" Ressayer"})]}),l&&t.jsx("div",{style:{textAlign:"center",padding:"3rem",color:"#6b7280"},children:" Chargement des quiz..."}),!l&&n.length===0&&!u&&t.jsxs("div",{style:{textAlign:"center",padding:"3rem",background:"#f9fafb",borderRadius:"12px",border:"1px solid #e5e7eb"},children:[t.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),t.jsx("h3",{style:{color:"#374151",marginBottom:"0.5rem"},children:"Aucun quiz avanc"}),t.jsx("p",{style:{color:"#6b7280",marginBottom:"1.5rem"},children:"Crez votre premier quiz multi-types avec l'diteur riche !"}),t.jsx("button",{onClick:()=>e("/admin/quiz/nouveau"),style:{padding:"0.7rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:" Crer un quiz"})]}),!l&&n.length>0&&t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:n.map(_=>t.jsx("div",{style:{background:"#fff",borderRadius:"12px",border:"1px solid #e5e7eb",padding:"1.25rem",boxShadow:"0 1px 3px rgba(0,0,0,0.04)",transition:"box-shadow 0.2s"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:"1rem"},children:[t.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[t.jsx("h3",{style:{fontSize:"1.05rem",fontWeight:700,color:"#1f2937",margin:0},children:_.titre}),_.isPremium&&t.jsx("span",{style:{padding:"0.15rem 0.5rem",background:"#fef3c7",color:"#92400e",borderRadius:"12px",fontSize:"0.7rem",fontWeight:600,border:"1px solid #fde68a"},children:" Premium"})]}),t.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.4rem",marginBottom:"0.5rem"},children:[t.jsxs("span",{style:{padding:"0.2rem 0.6rem",background:"#eff6ff",color:"#1d4ed8",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500},children:[" ",_.questions.length," question",_.questions.length!==1?"s":""]}),t.jsxs("span",{style:{padding:"0.2rem 0.6rem",background:"#f0fdf4",color:"#166534",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500},children:[" ",j(_)," pts"]}),t.jsxs("span",{style:{padding:"0.2rem 0.6rem",background:"#fdf4ff",color:"#86198f",borderRadius:"12px",fontSize:"0.75rem",fontWeight:500},children:[" ",_.duree," min"]})]}),t.jsxs("p",{style:{fontSize:"0.8rem",color:"#6b7280",margin:0},children:["Types : ",b(_)]}),t.jsxs("p",{style:{fontSize:"0.75rem",color:"#9ca3af",margin:"0.25rem 0 0"},children:["Cr le ",x(_.createdAt)]})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,flexWrap:"wrap"},children:[t.jsx("button",{onClick:()=>e(`/quiz-avance/${_.id}`),title:"Tester le quiz",style:{padding:"0.5rem 0.9rem",background:"#f0fdf4",color:"#166534",border:"1px solid #bbf7d0",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Tester"}),t.jsx("button",{onClick:()=>e(`/admin/quiz/modifier/${_.id}`),title:"Modifier le quiz",style:{padding:"0.5rem 0.9rem",background:"#eff6ff",color:"#1d4ed8",border:"1px solid #bfdbfe",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Modifier"}),t.jsx("button",{onClick:()=>{const C=`${window.location.origin}/quiz-avance/${_.id}`;navigator.clipboard.writeText(C).then(()=>{alert(` Lien copi !

`+C+`

Partagez ce lien aux lves.`)})},title:"Copier le lien pour les lves",style:{padding:"0.5rem 0.9rem",background:"#fdf4ff",color:"#86198f",border:"1px solid #e9d5ff",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Lien"}),f===_.id?t.jsxs("div",{style:{display:"flex",gap:"0.3rem"},children:[t.jsx("button",{onClick:()=>v(_.id),style:{padding:"0.5rem 0.7rem",background:"#dc2626",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:" Confirmer"}),t.jsx("button",{onClick:()=>p(null),style:{padding:"0.5rem 0.7rem",background:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontSize:"0.8rem"},children:""})]}):t.jsx("button",{onClick:()=>p(_.id),title:"Supprimer le quiz",style:{padding:"0.5rem 0.9rem",background:"#fef2f2",color:"#991b1b",border:"1px solid #fecaca",borderRadius:"8px",cursor:"pointer",fontWeight:600,fontSize:"0.8rem"},children:""})]})]})},_.id))})]})},RR=({quiz:e,userId:r,onComplete:n,onQuit:a})=>{const l=g.useMemo(()=>{let D=[...e.questions];return e.melangerQuestions&&(D=D.sort(()=>Math.random()-.5)),D},[e]),[o,u]=g.useState(0),[d,f]=g.useState(new Map),[p,h]=g.useState(e.duree*60),[v,b]=g.useState(!1),[x,j]=g.useState(null),[_,C]=g.useState(!1),w=g.useRef(Date.now());g.useEffect(()=>{if(x)return;const D=setInterval(()=>{h(B=>B<=1?(clearInterval(D),k(),0):B-1)},1e3);return()=>clearInterval(D)},[x]);const E=D=>{const B=Math.floor(D/60),U=D%60;return`${B.toString().padStart(2,"0")}:${U.toString().padStart(2,"0")}`},S=l[o],A=g.useCallback((D,B)=>{f(U=>{const $=new Map(U),R=$.get(D)||{questionId:D,type:S.type};return $.set(D,{...R,...B}),$})},[S]),O=D=>{D>=0&&D<l.length&&u(D)},k=async()=>{C(!1),b(!0);try{const D=Array.from(d.values()),B=Math.round((Date.now()-w.current)/1e3),U=await AR(e,r,D,B);j(U),n?.(U)}catch(D){alert("Erreur lors de la soumission : "+D.message)}finally{b(!1)}},P=d.size;return x?t.jsx("div",{className:"quiz-player quiz-player--results",children:t.jsxs("div",{className:"quiz-results",children:[t.jsxs("div",{className:`quiz-results__header ${x.reussi?"quiz-results__header--success":"quiz-results__header--fail"}`,children:[t.jsx("div",{className:"quiz-results__emoji",children:x.reussi?"":""}),t.jsx("h2",{children:x.reussi?"Flicitations !":"Quiz termin"}),t.jsxs("div",{className:"quiz-results__score",children:[t.jsxs("span",{className:"quiz-results__note",children:[x.note20,"/20"]}),t.jsxs("span",{className:"quiz-results__detail",children:[x.score,"/",x.scoreMax," points"]})]}),t.jsxs("div",{className:"quiz-results__time",children:[" Temps : ",E(x.tempsEcoule)]}),x.correctionManuelle&&t.jsx("p",{className:"quiz-results__pending",children:" Ce quiz contient des questions  correction manuelle. Votre note finale pourra tre ajuste par le professeur."})]}),e.afficherCorrection&&t.jsxs("div",{className:"quiz-results__details",children:[t.jsx("h3",{children:" Dtail des rponses"}),l.map((D,B)=>{const U=x.detailsParQuestion.find($=>$.questionId===D.id);return t.jsxs("div",{className:`quiz-results__question ${U?.isCorrect?"quiz-results__question--correct":U?.isPartiel?"quiz-results__question--partial":"quiz-results__question--wrong"}`,children:[t.jsxs("div",{className:"quiz-results__q-header",children:[t.jsxs("span",{children:["Q",B+1," "," ",t.jsxs("span",{style:{color:jm[D.type]},children:[ym[D.type]," ",mo[D.type]]})]}),t.jsxs("span",{className:"quiz-results__q-score",children:[U?.pointsObtenus||0,"/",U?.pointsMax||D.points," pts",U?.isCorrect&&" ",U?.isPartiel&&" ",!U?.isCorrect&&!U?.isPartiel&&" "]})]}),t.jsx("div",{className:"quiz-results__q-enonce",dangerouslySetInnerHTML:{__html:D.enonce}}),D.explication&&t.jsxs("div",{className:"quiz-results__q-explanation",children:[t.jsx("strong",{children:" Explication :"}),t.jsx("div",{dangerouslySetInnerHTML:{__html:D.explication}})]})]},D.id)})]}),t.jsx("div",{className:"quiz-results__actions",children:t.jsx("button",{className:"quiz-player__btn quiz-player__btn--primary",onClick:a,children:"Retour au tableau de bord"})})]})}):t.jsxs("div",{className:"quiz-player",children:[t.jsxs("div",{className:"quiz-player__topbar",children:[t.jsxs("div",{className:"quiz-player__info",children:[t.jsx("span",{className:"quiz-player__title",children:e.titre}),t.jsxs("span",{className:"quiz-player__progress",children:["Question ",o+1,"/",l.length]})]}),t.jsxs("div",{className:"quiz-player__topbar-right",children:[t.jsxs("span",{className:`quiz-player__timer ${p<60?"quiz-player__timer--danger":p<300?"quiz-player__timer--warning":""}`,children:[" ",E(p)]}),t.jsxs("span",{className:"quiz-player__answered",children:[P,"/",l.length," rpondue",P>1?"s":""]})]})]}),t.jsx("div",{className:"quiz-player__progress-bar",children:t.jsx("div",{className:"quiz-player__progress-fill",style:{width:`${(o+1)/l.length*100}%`}})}),t.jsxs("div",{className:"quiz-player__question-area",children:[t.jsxs("div",{className:"quiz-player__question-meta",children:[t.jsxs("span",{className:"quiz-player__type-badge",style:{backgroundColor:jm[S.type]},children:[ym[S.type]," ",mo[S.type]]}),t.jsxs("span",{className:"quiz-player__points",children:[S.points," point",S.points>1?"s":""]})]}),t.jsx("div",{className:"quiz-player__enonce",dangerouslySetInnerHTML:{__html:S.enonce}}),t.jsxs("div",{className:"quiz-player__answer-area",children:[S.type==="qcm_unique"&&t.jsx(IR,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D),melangerOptions:e.melangerOptions}),S.type==="qcm_multiple"&&t.jsx(LR,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D),melangerOptions:e.melangerOptions}),S.type==="drag_drop"&&t.jsx($R,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D)}),S.type==="mise_en_relation"&&t.jsx(BR,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D)}),S.type==="essai"&&t.jsx(UR,{question:S,reponse:d.get(S.id),onUpdate:D=>A(S.id,D)})]})]}),t.jsxs("div",{className:"quiz-player__nav",children:[t.jsx("button",{className:"quiz-player__btn quiz-player__btn--secondary",onClick:()=>O(o-1),disabled:o===0,children:" Prcdent"}),t.jsx("div",{className:"quiz-player__pagination",children:l.map((D,B)=>t.jsx("button",{className:`quiz-player__page-dot ${B===o?"quiz-player__page-dot--current":""} ${d.has(D.id)?"quiz-player__page-dot--answered":""}`,onClick:()=>O(B),title:`Question ${B+1}`,children:B+1},D.id))}),o<l.length-1?t.jsx("button",{className:"quiz-player__btn quiz-player__btn--primary",onClick:()=>O(o+1),children:"Suivant "}):t.jsx("button",{className:"quiz-player__btn quiz-player__btn--submit",onClick:()=>C(!0),disabled:v,children:v?" Envoi...":" Soumettre le quiz"})]}),_&&t.jsx("div",{className:"quiz-player__modal-overlay",children:t.jsxs("div",{className:"quiz-player__modal",children:[t.jsx("h3",{children:"Soumettre le quiz ?"}),t.jsxs("p",{children:["Vous avez rpondu  ",t.jsx("strong",{children:P})," question",P>1?"s":""," sur"," ",t.jsx("strong",{children:l.length}),"."]}),P<l.length&&t.jsxs("p",{className:"quiz-player__modal-warning",children:[" ",l.length-P," question",l.length-P>1?"s":""," sans rponse !"]}),t.jsxs("div",{className:"quiz-player__modal-actions",children:[t.jsx("button",{className:"quiz-player__btn quiz-player__btn--secondary",onClick:()=>C(!1),children:"Continuer le quiz"}),t.jsx("button",{className:"quiz-player__btn quiz-player__btn--submit",onClick:k,children:"Confirmer la soumission"})]})]})})]})},IR=({question:e,reponse:r,onUpdate:n,melangerOptions:a})=>{const l=e.typeData,o=g.useMemo(()=>a?[...l.options].sort(()=>Math.random()-.5):l.options,[l.options,a]);return t.jsx("div",{className:"player-qcm",children:o.map(u=>t.jsxs("label",{className:`player-qcm__option ${r?.selectedOptionId===u.id?"player-qcm__option--selected":""}`,children:[t.jsx("input",{type:"radio",name:`q_${e.id}`,checked:r?.selectedOptionId===u.id,onChange:()=>n({selectedOptionId:u.id})}),t.jsx("div",{className:"player-qcm__text",dangerouslySetInnerHTML:{__html:u.texte}})]},u.id))})},LR=({question:e,reponse:r,onUpdate:n,melangerOptions:a})=>{const l=e.typeData,o=g.useMemo(()=>a?[...l.options].sort(()=>Math.random()-.5):l.options,[l.options,a]),u=r?.selectedOptionIds||[],d=f=>{const p=u.includes(f)?u.filter(h=>h!==f):[...u,f];n({selectedOptionIds:p})};return t.jsxs("div",{className:"player-qcm",children:[t.jsx("p",{className:"player-qcm__hint",children:"Plusieurs rponses possibles"}),o.map(f=>t.jsxs("label",{className:`player-qcm__option ${u.includes(f.id)?"player-qcm__option--selected":""}`,children:[t.jsx("input",{type:"checkbox",checked:u.includes(f.id),onChange:()=>d(f.id)}),t.jsx("div",{className:"player-qcm__text",dangerouslySetInnerHTML:{__html:f.texte}})]},f.id))]})},$R=({question:e,reponse:r,onUpdate:n})=>{const a=e.typeData,[l,o]=g.useState(()=>r?.ordrePropose?r.ordrePropose.map(b=>a.items.find(x=>x.id===b)).filter(Boolean):[...a.items].sort(()=>Math.random()-.5)),[u,d]=g.useState(null);g.useEffect(()=>{n({ordrePropose:l.map(b=>b.id)})},[l]);const f=b=>{d(b)},p=(b,x)=>{if(b.preventDefault(),u===null||u===x)return;const j=[...l],[_]=j.splice(u,1);j.splice(x,0,_),o(j),d(x)},h=()=>{d(null)},v=(b,x)=>{const j=x==="up"?b-1:b+1;if(j<0||j>=l.length)return;const _=[...l];[_[b],_[j]]=[_[j],_[b]],o(_)};return t.jsxs("div",{className:"player-dragdrop",children:[t.jsx("p",{className:"player-dragdrop__consigne",children:a.consigneOrdre}),t.jsx("div",{className:"player-dragdrop__list",children:l.map((b,x)=>t.jsxs("div",{className:`player-dragdrop__item ${u===x?"player-dragdrop__item--dragging":""}`,draggable:!0,onDragStart:()=>f(x),onDragOver:j=>p(j,x),onDragEnd:h,children:[t.jsx("span",{className:"player-dragdrop__handle",children:""}),t.jsx("span",{className:"player-dragdrop__number",children:x+1}),t.jsx("div",{className:"player-dragdrop__text",dangerouslySetInnerHTML:{__html:b.texte}}),t.jsxs("div",{className:"player-dragdrop__mobile-btns",children:[t.jsx("button",{type:"button",onClick:()=>v(x,"up"),disabled:x===0,children:""}),t.jsx("button",{type:"button",onClick:()=>v(x,"down"),disabled:x===l.length-1,children:""})]})]},b.id))})]})},BR=({question:e,reponse:r,onUpdate:n})=>{const a=e.typeData,l=g.useMemo(()=>[...a.paires].sort(()=>Math.random()-.5),[a.paires]),[o,u]=g.useState(r?.relationsProposees||{}),[d,f]=g.useState(null);g.useEffect(()=>{n({relationsProposees:o})},[o]);const p=x=>{f(x)},h=x=>{d&&(u(j=>({...j,[d]:x})),f(null))},v=x=>{u(j=>{const _={...j};return delete _[x],_})},b=new Set(Object.values(o));return t.jsxs("div",{className:"player-relation",children:[t.jsx("p",{className:"player-relation__hint",children:"Cliquez sur un lment  gauche puis sur son correspondant  droite"}),t.jsxs("div",{className:"player-relation__columns",children:[t.jsxs("div",{className:"player-relation__col",children:[t.jsx("h4",{className:"player-relation__col-title",children:"Colonne A"}),a.paires.map(x=>t.jsxs("div",{className:`player-relation__item player-relation__item--left ${d===x.id?"player-relation__item--selected":""} ${o[x.id]?"player-relation__item--matched":""}`,onClick:()=>{o[x.id]?v(x.id):p(x.id)},children:[t.jsx("div",{dangerouslySetInnerHTML:{__html:x.gauche}}),o[x.id]&&t.jsx("span",{className:"player-relation__linked",children:""})]},x.id))]}),t.jsxs("div",{className:"player-relation__col",children:[t.jsx("h4",{className:"player-relation__col-title",children:"Colonne B"}),l.map(x=>t.jsxs("div",{className:`player-relation__item player-relation__item--right ${b.has(x.id)?"player-relation__item--matched":""} ${d&&!b.has(x.id)?"player-relation__item--clickable":""}`,onClick:()=>{d&&!b.has(x.id)&&h(x.id)},children:[t.jsx("div",{dangerouslySetInnerHTML:{__html:x.droite}}),b.has(x.id)&&t.jsx("span",{className:"player-relation__linked",children:""})]},x.id))]})]})]})},UR=({question:e,reponse:r,onUpdate:n})=>{const a=e.typeData,[l,o]=g.useState(r?.texteReponse||""),u=l.replace(/<[^>]*>/g,"").trim().split(/\s+/).filter(Boolean).length;return g.useEffect(()=>{n({texteReponse:l})},[l]),t.jsxs("div",{className:"player-essai",children:[t.jsxs("div",{className:"player-essai__info",children:[a.nombreMotsMin&&t.jsxs("span",{className:u<a.nombreMotsMin?"player-essai__warning":"",children:["Minimum : ",a.nombreMotsMin," mots"]}),a.nombreMotsMax&&t.jsxs("span",{className:u>a.nombreMotsMax?"player-essai__warning":"",children:["Maximum : ",a.nombreMotsMax," mots"]}),t.jsxs("span",{className:"player-essai__count",children:[u," mot",u>1?"s":""]})]}),t.jsx("textarea",{className:"player-essai__textarea",value:l,onChange:d=>o(d.target.value),placeholder:"Rdigez votre rponse ici...",rows:10})]})},FR=()=>{const{quizId:e}=xn(),r=Je(),{currentUser:n}=Ke(),[a,l]=g.useState(null),[o,u]=g.useState(!0),[d,f]=g.useState(null);return g.useEffect(()=>{(async()=>{if(!e){f("ID du quiz manquant"),u(!1);return}try{const h=await BA(e);if(!h){f("Quiz introuvable");return}if(h.isPremium&&!n?.isPremium){f("Ce quiz est rserv aux abonns Premium");return}l(h)}catch(h){console.error("Erreur chargement quiz:",h),f(h.message||"Impossible de charger le quiz")}finally{u(!1)}})()},[e,n]),o?t.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[t.jsx("div",{style:{fontSize:"2rem",marginBottom:"1rem"},children:""}),t.jsx("p",{children:"Chargement du quiz..."})]}):d?t.jsx("div",{style:{textAlign:"center",padding:"3rem",maxWidth:"500px",margin:"2rem auto"},children:t.jsxs("div",{style:{padding:"2rem",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"12px"},children:[t.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:""}),t.jsx("p",{style:{color:"#991b1b",fontWeight:600,marginBottom:"1rem"},children:d}),d.includes("Premium")&&t.jsx("button",{onClick:()=>r("/premium"),style:{padding:"0.6rem 1.5rem",background:"#2563eb",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",marginRight:"0.5rem",fontWeight:600},children:" Devenir Premium"}),t.jsx("button",{onClick:()=>r(-1),style:{padding:"0.6rem 1.5rem",background:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:" Retour"})]})}):a?t.jsx(RR,{quiz:a,userId:n?.uid||"",onComplete:p=>{console.log(" Quiz termin  Note:",p.note20,"/20")},onQuit:()=>r("/dashboard")}):t.jsxs("div",{style:{textAlign:"center",padding:"3rem"},children:[t.jsx("p",{children:"Quiz introuvable"}),t.jsx("button",{onClick:()=>r(-1),children:" Retour"})]})},GR=e=>{if(!e?.length)return{label:"",color:"#9ca3af"};const r=e.map(a=>a.difficulte),n=r.reduce((a,l)=>a+(l==="facile"?1:l==="moyen"?2:3),0)/r.length;return n<1.5?{label:"Facile",color:"#059669"}:n<2.5?{label:"Moyen",color:"#d97706"}:{label:"Difficile",color:"#dc2626"}},HR=e=>e?.reduce((r,n)=>r+(n.points??0),0)??0,VR=()=>{const e=Je(),{currentUser:r}=Ke(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(""),[f,p]=g.useState("");g.useEffect(()=>{(async()=>{try{const b=await UA();a(b)}catch{d("Impossible de charger les quiz.")}finally{o(!1)}})()},[]);const h=n.filter(v=>v.titre.toLowerCase().includes(f.toLowerCase())||(v.description??"").toLowerCase().includes(f.toLowerCase()));return t.jsxs("div",{style:{maxWidth:1100,margin:"0 auto",padding:"2rem 1rem"},children:[t.jsxs("div",{style:{marginBottom:"2rem"},children:[t.jsx("h1",{style:{fontSize:"1.8rem",fontWeight:800,color:"#1f2937",margin:"0 0 0.4rem"},children:" Quiz disponibles"}),t.jsx("p",{style:{color:"#6b7280",fontSize:"0.95rem",margin:0},children:"Testez vos connaissances avec nos quiz interactifs"})]}),t.jsx("div",{style:{marginBottom:"1.5rem"},children:t.jsx("input",{type:"text",placeholder:"Rechercher un quiz...",value:f,onChange:v=>p(v.target.value),style:{width:"100%",maxWidth:400,padding:"0.6rem 1rem",border:"1.5px solid #e5e7eb",borderRadius:10,fontSize:"0.9rem",outline:"none",boxSizing:"border-box"}})}),l&&t.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"#6b7280"},children:[t.jsx("div",{style:{width:36,height:36,border:"3px solid #e5e7eb",borderTopColor:"#2563eb",borderRadius:"50%",animation:"spin 0.8s linear infinite",margin:"0 auto 1rem"}}),"Chargement des quiz..."]}),u&&t.jsxs("div",{style:{background:"#fee2e2",color:"#dc2626",padding:"0.9rem 1.2rem",borderRadius:10,marginBottom:"1.5rem"},children:[" ",u]}),!l&&!u&&h.length===0&&t.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"#9ca3af"},children:[t.jsx("div",{style:{fontSize:"3rem",marginBottom:"0.75rem",opacity:.4},children:""}),t.jsx("p",{style:{margin:0},children:f?"Aucun quiz ne correspond  votre recherche.":"Aucun quiz disponible pour le moment."})]}),!l&&!u&&h.length>0&&t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"1.25rem"},children:h.map(v=>{const b=GR(v.questions),x=HR(v.questions),j=v.questions?.length??0,_=v.isPremium,C=!_||r?.isPremium;return t.jsxs("div",{onClick:()=>C&&e(`/quiz-avance/${v.id}`),style:{background:"white",borderRadius:14,boxShadow:"0 2px 10px rgba(0,0,0,0.08)",padding:"1.25rem",cursor:C?"pointer":"default",opacity:C?1:.65,transition:"transform 0.15s, box-shadow 0.15s",border:"1.5px solid #f3f4f6",display:"flex",flexDirection:"column",gap:"0.6rem",position:"relative"},onMouseEnter:w=>{C&&(w.currentTarget.style.transform="translateY(-3px)",w.currentTarget.style.boxShadow="0 6px 20px rgba(0,0,0,0.12)")},onMouseLeave:w=>{w.currentTarget.style.transform="",w.currentTarget.style.boxShadow="0 2px 10px rgba(0,0,0,0.08)"},children:[_&&t.jsx("span",{style:{position:"absolute",top:12,right:12,background:"#fef3c7",color:"#d97706",fontSize:"0.7rem",fontWeight:700,padding:"0.15rem 0.5rem",borderRadius:20},children:" Premium"}),t.jsx("h3",{style:{fontSize:"1.05rem",fontWeight:700,color:"#1f2937",margin:0,lineHeight:1.3,paddingRight:_?"4rem":0},children:v.titre}),v.description&&t.jsx("p",{style:{fontSize:"0.82rem",color:"#6b7280",margin:0,lineHeight:1.5,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},dangerouslySetInnerHTML:{__html:v.description}}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginTop:"0.25rem"},children:[t.jsxs("span",{style:{fontSize:"0.75rem",background:"#eff6ff",color:"#2563eb",padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:600},children:[" ",j," question",j>1?"s":""]}),t.jsxs("span",{style:{fontSize:"0.75rem",background:"#f3f4f6",color:"#374151",padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:600},children:[" ",v.duree," min"]}),x>0&&t.jsxs("span",{style:{fontSize:"0.75rem",background:"#f0fdf4",color:"#059669",padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:600},children:[" ",x," pts"]}),t.jsx("span",{style:{fontSize:"0.75rem",background:"#fafafa",color:b.color,padding:"0.2rem 0.55rem",borderRadius:20,fontWeight:700,border:`1px solid ${b.color}30`},children:b.label})]}),t.jsx("button",{disabled:!C,onClick:w=>{w.stopPropagation(),C&&e(`/quiz-avance/${v.id}`)},style:{marginTop:"auto",padding:"0.55rem 1rem",background:C?"#2563eb":"#e5e7eb",color:C?"white":"#9ca3af",border:"none",borderRadius:8,fontWeight:600,fontSize:"0.85rem",cursor:C?"pointer":"not-allowed",transition:"background 0.15s"},children:C?" Commencer le quiz":" Premium requis"})]},v.id)})}),!l&&h.length>0&&t.jsxs("p",{style:{textAlign:"center",color:"#9ca3af",fontSize:"0.8rem",marginTop:"2rem"},children:[h.length," quiz",(h.length>1,"")," disponible",h.length>1?"s":""]})]})},QR="quizzes",YR="quizzes_v2",Q1=50;function KR(e){const r=e.data();return{id:e.id,titre:r.titre||"Quiz sans titre",description:r.description||"",matiere:r.matiere||r.disciplineId||"",niveau:r.niveau||"",classe:r.classe||"",nombreQuestions:Array.isArray(r.questions)?r.questions.length:0,duree:r.duree||void 0,difficulte:r.difficulte||"moyen",source:"quizzes",isPremium:!1,createdAt:r.createdAt||void 0}}function WR(e){const r=e.data();return{id:e.id,titre:r.titre||"Quiz sans titre",description:r.description||"",matiere:r.matiere||"",niveau:r.niveau||"",classe:r.classe||"",nombreQuestions:Array.isArray(r.questions)?r.questions.length:0,duree:r.dureeEstimee||void 0,difficulte:r.difficulte||"moyen",source:"quizzes_v2",isPremium:!1,createdAt:r.createdAt||void 0}}async function FA(){const[e,r]=await Promise.all([Ce(Ee(_e(Q,QR),Ne("isPremium","==",!1),Ve("createdAt","desc"),Ht(Q1))),Ce(Ee(_e(Q,YR),Ne("isPremium","==",!1),Ve("createdAt","desc"),Ht(Q1)))]),n=e.docs.map(KR),a=r.docs.map(WR);return[...n,...a].sort((l,o)=>{const u=l.createdAt?.toMillis()??0;return(o.createdAt?.toMillis()??0)-u})}async function XR(){return(await FA()).slice(0,3)}const ZR={facile:{label:"Facile",color:"#059669",bg:"#d1fae5"},moyen:{label:"Moyen",color:"#d97706",bg:"#fef3c7"},difficile:{label:"Difficile",color:"#dc2626",bg:"#fee2e2"}},JR=({quiz:e,onJouer:r,estConnecte:n})=>{const a=ZR[e.difficulte??"moyen"];return t.jsxs("div",{className:"qg-card",onClick:()=>r(e),children:[t.jsxs("div",{className:"qg-card__header",children:[t.jsx("span",{className:`qg-card__source qg-card__source--${e.source}`,children:e.source==="quizzes_v2"?" Quiz avanc":" Quiz"}),t.jsx("span",{className:"qg-card__difficulte",style:{color:a.color,background:a.bg},children:a.label})]}),t.jsx("h3",{className:"qg-card__titre",children:e.titre}),e.description&&t.jsx("p",{className:"qg-card__description",children:e.description}),t.jsxs("div",{className:"qg-card__meta",children:[e.matiere&&t.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.matiere]}),e.classe&&t.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.classe]}),t.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.nombreQuestions," question",e.nombreQuestions>1?"s":""]}),e.duree&&t.jsxs("span",{className:"qg-card__meta-item",children:[" ",e.duree," min"]})]}),t.jsx("button",{className:"qg-card__btn",children:n?" Commencer":" Aperu"})]})},e6=()=>t.jsxs("div",{className:"qg-banniere qg-banniere--inscription",children:[t.jsx("div",{className:"qg-banniere__icone",children:""}),t.jsxs("div",{className:"qg-banniere__texte",children:[t.jsx("h3",{children:"Connectez-vous pour accder  tous les quiz gratuits"}),t.jsx("p",{children:"Crez un compte gratuitement et commencez  vous entraner ds maintenant."})]}),t.jsxs("div",{className:"qg-banniere__actions",children:[t.jsx(Le,{to:"/inscription",className:"btn btn-primary",children:"Crer un compte gratuit"}),t.jsx(Le,{to:"/connexion",className:"btn btn-secondary",children:"Se connecter"})]})]}),t6=()=>t.jsxs("div",{className:"qg-banniere qg-banniere--premium",children:[t.jsx("div",{className:"qg-banniere__icone",children:""}),t.jsxs("div",{className:"qg-banniere__texte",children:[t.jsx("h3",{children:"Dbloquez les Quiz Avancs Premium"}),t.jsx("p",{children:"Accdez  des centaines de quiz avancs avec corrections dtailles, suivi de progression et bien plus encore."}),t.jsxs("p",{className:"qg-banniere__prix",children:[t.jsx("strong",{children:"Ds 10 000 FCFA / 3 mois"}),"  Accs illimit"]})]}),t.jsx(Le,{to:"/premium",className:"btn btn-premium",children:" Devenir Premium"})]}),r6=()=>{const e=Je(),{currentUser:r}=Ke(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(""),[f,p]=g.useState(""),[h,v]=g.useState(""),[b,x]=g.useState(""),{matieres:j}=Ca(),_=!!r,C=r?.isPremium??!1,w=r?.role==="prof"||r?.role==="admin";g.useEffect(()=>{(async()=>{o(!0),d("");try{const O=_?await FA():await XR();a(O)}catch(O){console.error("Erreur chargement quiz gratuits:",O),d("Impossible de charger les quiz. Veuillez ressayer.")}finally{o(!1)}})()},[_]);const E=n.filter(A=>{const O=!b||A.titre.toLowerCase().includes(b.toLowerCase())||A.matiere.toLowerCase().includes(b.toLowerCase()),k=!f||A.matiere.toLowerCase().includes(f.toLowerCase()),P=!h||(A.niveau??"").toLowerCase().includes(h.toLowerCase())||(A.classe??"").toLowerCase().includes(h.toLowerCase());return O&&k&&P}),S=A=>{if(!_){e("/connexion");return}A.source==="quizzes_v2"?e(`/quiz-avance/${A.id}`):e(`/quiz/${A.id}`)};return t.jsxs("div",{className:"qg-page",children:[t.jsxs("div",{className:"qg-hero",children:[t.jsxs("div",{className:"qg-hero__content",children:[t.jsx("h1",{className:"qg-hero__titre",children:" Quiz Gratuits"}),t.jsx("p",{className:"qg-hero__sous-titre",children:"Entranez-vous gratuitement avec nos quiz de rvision pour tous les niveaux du collge au lyce."}),t.jsxs("div",{className:"qg-hero__stats",children:[t.jsxs("span",{className:"qg-hero__stat",children:[t.jsx("strong",{children:n.length}),_?" quiz disponibles":"+ quiz"]}),t.jsxs("span",{className:"qg-hero__stat",children:[t.jsx("strong",{children:"100%"})," gratuit"]}),t.jsxs("span",{className:"qg-hero__stat",children:[t.jsx("strong",{children:"6me"}),"  ",t.jsx("strong",{children:"Terminale"})]})]})]}),(C||w)&&t.jsx(Le,{to:"/quizzes",className:"qg-hero__lien-premium",children:" Voir les Quiz Premium "})]}),t.jsxs("div",{className:"qg-filtres",children:[t.jsx("div",{className:"qg-filtres__recherche",children:t.jsx("input",{type:"text",placeholder:" Rechercher un quiz...",value:b,onChange:A=>x(A.target.value),className:"qg-filtres__input"})}),t.jsxs("select",{value:f,onChange:A=>p(A.target.value),className:"qg-filtres__select",children:[t.jsx("option",{value:"",children:"Toutes les matires"}),j.map(A=>t.jsx("option",{value:A.valeur,children:A.label},A.valeur))]}),(f||h||b)&&t.jsx("button",{className:"qg-filtres__reset",onClick:()=>{p(""),v(""),x("")},children:" Rinitialiser"})]}),t.jsxs("div",{className:"qg-contenu",children:[l&&t.jsxs("div",{className:"qg-loading",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement des quiz..."})]}),!l&&u&&t.jsxs("div",{className:"qg-erreur",children:[t.jsxs("p",{children:[" ",u]}),t.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-secondary",children:"Ressayer"})]}),!l&&!u&&t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"qg-compteur",children:[E.length," quiz",E.length>1?"s":"",f?` en ${f}`:"",_?"":" (aperu  connectez-vous pour tout voir)"]}),E.length>0?t.jsx("div",{className:"qg-grille",children:E.map(A=>t.jsx(JR,{quiz:A,onJouer:S,estConnecte:_},`${A.source}-${A.id}`))}):t.jsxs("div",{className:"qg-vide",children:[t.jsx("p",{children:" Aucun quiz trouv pour ces critres."}),t.jsx("button",{onClick:()=>{p(""),x("")},className:"btn btn-secondary",children:"Voir tous les quiz"})]}),!_&&t.jsx(e6,{}),_&&!C&&!w&&t.jsx(t6,{})]})]})]})},GA=_e(Q,"quiz_results"),Vb=_e(Q,"progressions"),n6=async e=>{try{const r=await Pt(GA,{...e,datePassage:Ae.now()});return e.reussi&&await c6(e.userId,e.disciplineId,e.disciplineNom,e.quizId),r.id}catch(r){throw console.error("Erreur lors de la sauvegarde du rsultat :",r),r}},wf=async(e,r)=>{try{let n=Ee(GA,Ne("userId","==",e),Ve("datePassage","desc"));return r&&(n=Ee(n,Ht(r))),(await Ce(n)).docs.map(l=>({id:l.id,...l.data()}))}catch(n){throw console.error("Erreur rcupration historique :",n),n}},a6=async e=>{try{const r=await wf(e);if(r.length===0)return{totalQuizPasses:0,totalQuizReussis:0,moyenneGenerale:0,tempsTotal:0,meilleurScore:0,serieReussites:0,meilleureSerieReussites:0};const n=r.reduce((h,v)=>h+v.pourcentage,0),a=Math.round(n/r.length),l=Math.max(...r.map(h=>h.pourcentage)),o=r.reduce((h,v)=>h+(v.tempsEcoule||0),0),u=r.filter(h=>h.reussi).length;let d=0,f=0;for(const h of r)h.reussi?(d++,f=Math.max(f,d)):d=0;let p=0;for(const h of r)if(h.reussi)p++;else break;return{totalQuizPasses:r.length,totalQuizReussis:u,moyenneGenerale:a,tempsTotal:o,meilleurScore:l,serieReussites:p,meilleureSerieReussites:Math.max(f,p)}}catch(r){return console.error("Erreur calcul stats :",r),{totalQuizPasses:0,totalQuizReussis:0,moyenneGenerale:0,tempsTotal:0,meilleurScore:0,serieReussites:0,meilleureSerieReussites:0}}},i6=async e=>{try{const r=await wf(e);if(r.length===0)return[];const n={};for(const a of r){const l=a.disciplineId;n[l]||(n[l]=[]),n[l].push(a)}return Object.entries(n).map(([a,l])=>{const o=Math.round(l.reduce((v,b)=>v+b.pourcentage,0)/l.length),u=Math.max(...l.map(v=>v.pourcentage)),d=l[0].pourcentage,f=l.filter(v=>v.reussi).length,p=l.reduce((v,b)=>v+(b.tempsEcoule||0),0);let h="stable";if(l.length>=4){const v=l.slice(0,3),b=l.slice(3,6),x=v.reduce((_,C)=>_+C.pourcentage,0)/v.length,j=b.reduce((_,C)=>_+C.pourcentage,0)/b.length;x-j>5?h="up":j-x>5&&(h="down")}return{disciplineId:a,disciplineNom:l[0].disciplineNom||a,nombreQuiz:l.length,moyenne:o,meilleurScore:u,dernierScore:d,quizReussis:f,tempsTotal:p,tendance:h}})}catch(r){return console.error("Erreur progression par discipline :",r),[]}},s6=async(e,r)=>{try{return(await wf(e,r||20)).reverse().map(a=>({date:(a.datePassage?.toDate?a.datePassage.toDate():new Date(a.datePassage)).toLocaleDateString("fr-SN",{day:"2-digit",month:"2-digit"}),score:a.pourcentage,discipline:a.disciplineNom||a.disciplineId}))}catch(n){return console.error("Erreur donnes temporelles :",n),[]}},l6=async(e,r,n)=>{const a=`${e}_${r}`,l=je(Vb,a),o=await Et(l);if(o.exists())return{...o.data()};const[u,d]=await Promise.all([Y1("ressources",r),Y1("quizzes",r)]),f={userId:e,disciplineId:r,disciplineNom:n,ressourcesVues:[],quizReussis:[],totalRessources:u,totalQuiz:d,pourcentage:0,dernierAcces:Ae.now(),createdAt:Ae.now(),updatedAt:Ae.now()};return await su(l,f),f},Y1=async(e,r)=>{try{const n=Ee(_e(Q,e),Ne("disciplineId","==",r));return(await Ce(n)).size}catch{return 0}},o6=e=>{if(e.totalRessources+e.totalQuiz===0)return 0;const n=e.totalRessources>0?e.ressourcesVues.length/e.totalRessources*40:0,a=e.totalQuiz>0?e.quizReussis.length/e.totalQuiz*60:0;return e.totalRessources===0?Math.min(100,Math.round(e.quizReussis.length/e.totalQuiz*100)):e.totalQuiz===0?Math.min(100,Math.round(e.ressourcesVues.length/e.totalRessources*100)):Math.min(100,Math.round(n+a))},c6=async(e,r,n,a)=>{try{const l=`${e}_${r}`,o=je(Vb,l),u=await l6(e,r,n);if(u.quizReussis.includes(a))return await He(o,{dernierAcces:Ae.now()}),u;const d=[...u.quizReussis,a],f={...u,quizReussis:d,dernierAcces:Ae.now(),updatedAt:Ae.now(),pourcentage:0};return f.pourcentage=o6(f),await su(o,f),f}catch(l){throw console.error("Erreur enregistrement quiz russi :",l),l}},u6=async e=>{try{const r=Ee(Vb,Ne("userId","==",e));return(await Ce(r)).docs.map(a=>a.data())}catch(r){return console.error("Erreur rcupration progressions :",r),[]}},d6=async e=>{try{const r=await u6(e),n=await HA(e),a=r.reduce((d,f)=>d+f.ressourcesVues.length,0),l=r.reduce((d,f)=>d+f.quizReussis.length,0),o=r.length>0?Math.round(r.reduce((d,f)=>d+f.pourcentage,0)/r.length):0,u=r.filter(d=>d.pourcentage>=100).length;return{totalRessourcesVues:a,totalQuizReussis:l,pourcentageMoyen:o,disciplinesCommencees:r.length,disciplinesCompletees:u,streakActuel:n.streakActuel,meilleurStreak:n.meilleurStreak,parDiscipline:r}}catch(r){return console.error("Erreur progression globale :",r),{totalRessourcesVues:0,totalQuizReussis:0,pourcentageMoyen:0,disciplinesCommencees:0,disciplinesCompletees:0,streakActuel:0,meilleurStreak:0,parDiscipline:[]}}},m6=()=>new Date().toISOString().split("T")[0],f6=()=>{const e=new Date;return e.setDate(e.getDate()-1),e.toISOString().split("T")[0]},HA=async e=>{try{const r=je(Q,"users",e),n=await Et(r);if(!n.exists())return{streakActuel:0,meilleurStreak:0,dernierJourAcces:""};const a=n.data();return{streakActuel:a.streakActuel||0,meilleurStreak:a.meilleurStreak||0,dernierJourAcces:a.dernierJourAcces||""}}catch(r){return console.error("Erreur rcupration streak :",r),{streakActuel:0,meilleurStreak:0,dernierJourAcces:""}}},p6=async e=>{try{const r=je(Q,"users",e),n=await HA(e),a=m6();if(n.dernierJourAcces===a)return n;const l=f6();let o;n.dernierJourAcces===l?o=n.streakActuel+1:o=1;const u=Math.max(n.meilleurStreak,o);return await He(r,{streakActuel:o,meilleurStreak:u,dernierJourAcces:a}),{streakActuel:o,meilleurStreak:u,dernierJourAcces:a}}catch(r){return console.error("Erreur mise  jour streak :",r),{streakActuel:0,meilleurStreak:0,dernierJourAcces:""}}},h6=(e,r,n)=>{const a=n?.totalRessourcesVues||0;n?.totalQuizReussis;const l=n?.disciplinesCompletees||0;n?.streakActuel;const o=n?.meilleurStreak||0,u=n?.disciplinesCommencees||0;return[{id:"premier_pas",nom:"Premier pas ",description:"Consulter votre premire ressource",icone:"",condition:"1 ressource consulte",categorie:"ressources",obtenu:a>=1},{id:"lecteur_assidu",nom:"Lecteur assidu ",description:"Consulter 10 ressources",icone:"",condition:"10 ressources consultes",categorie:"ressources",obtenu:a>=10},{id:"bibliophile",nom:"Bibliophile ",description:"Consulter 25 ressources",icone:"",condition:"25 ressources consultes",categorie:"ressources",obtenu:a>=25},{id:"savant",nom:"Savant ",description:"Consulter 50 ressources",icone:"",condition:"50 ressources consultes",categorie:"ressources",obtenu:a>=50},{id:"premier_quiz",nom:"Apprenti ",description:"Passer votre premier quiz",icone:"",condition:"1 quiz pass",categorie:"quiz",obtenu:e.totalQuizPasses>=1},{id:"challenger",nom:"Challenger ",description:"Russir 5 quiz",icone:"",condition:"5 quiz russis",categorie:"quiz",obtenu:e.totalQuizReussis>=5},{id:"dix_quiz",nom:"Dcathlon ",description:"Passer 10 quiz",icone:"",condition:"10 quiz passs",categorie:"quiz",obtenu:e.totalQuizPasses>=10},{id:"cinquante_quiz",nom:"Marathonien ",description:"Passer 50 quiz",icone:"",condition:"50 quiz passs",categorie:"quiz",obtenu:e.totalQuizPasses>=50},{id:"score_parfait",nom:"Score parfait ",description:"Obtenir 100%  un quiz",icone:"",condition:"100%  un quiz",categorie:"performance",obtenu:e.meilleurScore>=100},{id:"moyenne_80",nom:"Excellent ",description:"Moyenne gnrale de 80%+",icone:"",condition:"Moyenne  80% (min. 5 quiz)",categorie:"performance",obtenu:e.moyenneGenerale>=80&&e.totalQuizPasses>=5},{id:"serie_5",nom:"Imbattable ",description:"5 quiz russis d'affile",icone:"",condition:"Srie de 5 russites",categorie:"performance",obtenu:e.meilleureSerieReussites>=5},{id:"serie_10",nom:"Lgende ",description:"10 quiz russis d'affile",icone:"",condition:"Srie de 10 russites",categorie:"performance",obtenu:e.meilleureSerieReussites>=10},{id:"maitre",nom:"Matre ",description:"Complter 100% d'une discipline",icone:"",condition:"1 discipline  100%",categorie:"discipline",obtenu:l>=1},{id:"explorateur_teranga",nom:"Explorateur Teranga ",description:"Commencer 3 disciplines diffrentes",icone:"",condition:"3 disciplines commences",categorie:"discipline",obtenu:u>=3||r.length>=3},{id:"touche_a_tout",nom:"Touche--tout ",description:"Commencer 5 disciplines diffrentes",icone:"",condition:"5 disciplines commences",categorie:"discipline",obtenu:u>=5||r.length>=5},{id:"en_feu_3",nom:"Rgulier ",description:"3 jours de connexion conscutifs",icone:"",condition:"3 jours conscutifs",categorie:"streak",obtenu:o>=3},{id:"en_feu_7",nom:"En feu ",description:"7 jours de connexion conscutifs",icone:"",condition:"7 jours conscutifs",categorie:"streak",obtenu:o>=7},{id:"en_feu_30",nom:"Infatigable ",description:"30 jours de connexion conscutifs",icone:"",condition:"30 jours conscutifs",categorie:"streak",obtenu:o>=30},{id:"diamant",nom:"Diamant ",description:"50 ressources + 20 quiz russis",icone:"",condition:"50 ressources + 20 quiz",categorie:"performance",obtenu:a>=50&&e.totalQuizReussis>=20}]},VA=e=>{if(e<60)return`${e} s`;const r=Math.floor(e/60),n=e%60;return n>0?`${r} min ${n.toString().padStart(2,"0")} s`:`${r} min`},ro=e=>e>=80?"#10b981":e>=60?"#3b82f6":e>=40?"#f59e0b":"#ef4444",QA=e=>e>=80?"Excellent":e>=60?"Bien":e>=40?"Passable":" amliorer",v6=()=>{const{quizId:e}=xn(),r=Je(),{currentUser:n}=Ke(),[a,l]=g.useState(null),[o,u]=g.useState(""),[d,f]=g.useState(!0),[p,h]=g.useState(null),[v,b]=g.useState("intro"),[x,j]=g.useState(0),[_,C]=g.useState({}),[w,E]=g.useState(0),[S,A]=g.useState(0),O=g.useRef(null),[k,P]=g.useState(0),[D,B]=g.useState(0),[U,$]=g.useState(0),[R,Y]=g.useState(!1),[ae,M]=g.useState(!1);g.useEffect(()=>{(async()=>{if(!e){h("ID du quiz manquant."),f(!1);return}try{const H=await eR(e);if(!H){h("Quiz introuvable."),f(!1);return}l(H),E(H.duree*60);try{const Me=(await is.getAll()).find(ue=>ue.id===H.disciplineId);u(Me?.nom||H.disciplineId)}catch{u(H.disciplineId)}}catch(H){h("Erreur lors du chargement du quiz."),console.error(H)}finally{f(!1)}})()},[e]),g.useEffect(()=>{if(v==="playing")return O.current=setInterval(()=>{E(ve=>ve<=1?(clearInterval(O.current),X(),0):ve-1),A(ve=>ve+1)},1e3),()=>{O.current&&clearInterval(O.current)}},[v]);const T=()=>{b("playing"),j(0),C({}),A(0),a&&E(a.duree*60)},F=(ve,H)=>{C(he=>({...he,[ve]:H}))},I=ve=>{a&&ve>=0&&ve<a.questions.length&&j(ve)},X=g.useCallback(async()=>{if(!a||!n||v==="review")return;O.current&&clearInterval(O.current);let ve=0,H=0,he=0;a.questions.forEach(Z=>{const V=Z.points||1;H+=V,_[Z.id]===Z.reponseCorrecte&&(ve+=V,he++)});const Me=H>0?Math.round(ve/H*100):0,ue=Me>=(a.noteMinimale||50);P(ve),B(H),$(he),b("review"),Y(!0);try{const Z={quizId:a.id,quizTitre:a.titre,disciplineId:a.disciplineId,disciplineNom:o,userId:n.uid,reponses:a.questions.map(V=>_[V.id]??-1),tempsEcoule:S,score:ve,totalPoints:H,pourcentage:Me,reussi:ue,nombreQuestions:a.questions.length,bonnesReponses:he};await n6(Z),M(!0)}catch(Z){console.error("Erreur lors de la sauvegarde :",Z)}finally{Y(!1)}},[a,n,_,S,o,v]),L=ve=>{const H=Math.floor(ve/60),he=ve%60;return`${H.toString().padStart(2,"0")}:${he.toString().padStart(2,"0")}`},ne=()=>{if(!a)return"";const ve=a.duree*60,H=w/ve;return H<=.1?"timer-critical":H<=.25?"timer-warning":""},K=Object.keys(_).length;if(d)return t.jsxs("div",{className:"quiz-player-loading",children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement du quiz..."})]});if(p||!a)return t.jsxs("div",{className:"quiz-player-error",children:[t.jsx(xm,{size:48}),t.jsx("h3",{children:p||"Quiz introuvable"}),t.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>r("/eleve/dashboard"),children:[t.jsx(Ax,{size:18})," Retour au tableau de bord"]})]});if(a.isPremium&&!n?.isPremium)return t.jsx("div",{className:"quiz-player-locked",children:t.jsxs("div",{className:"qp-locked-card",children:[t.jsx(kx,{size:48}),t.jsx("h3",{children:"Quiz Premium"}),t.jsx("p",{children:"Ce quiz est rserv aux abonns Premium."}),t.jsxs("p",{className:"qp-locked-price",children:[" partir de ",t.jsx("strong",{children:"2 000 FCFA/mois"})]}),t.jsxs("div",{className:"qp-locked-actions",children:[t.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>r("/premium"),children:[t.jsx(Zr,{size:18})," Devenir Premium"]}),t.jsxs("button",{className:"qp-btn qp-btn-outline",onClick:()=>r("/eleve/dashboard"),children:[t.jsx(Tv,{size:18})," Retour"]})]})]})});if(v==="intro")return t.jsx("div",{className:"quiz-player-intro",children:t.jsxs("div",{className:"qp-intro-card",children:[t.jsxs("div",{className:"qp-intro-header",children:[t.jsxs("button",{className:"qp-back-btn",onClick:()=>r(-1),children:[t.jsx(Tv,{size:20})," Retour"]}),a.isPremium&&t.jsxs("span",{className:"qp-badge qp-badge-premium",children:[t.jsx(Zr,{size:12})," Premium"]})]}),t.jsxs("div",{className:"qp-intro-content",children:[t.jsx("h1",{className:"qp-intro-title",children:a.titre}),t.jsx("span",{className:"qp-intro-discipline",children:o}),t.jsxs("div",{className:"qp-intro-stats",children:[t.jsxs("div",{className:"qp-intro-stat",children:[t.jsx(hn,{size:20}),t.jsxs("div",{children:[t.jsx("span",{className:"qp-intro-stat-value",children:a.questions.length}),t.jsx("span",{className:"qp-intro-stat-label",children:"Questions"})]})]}),t.jsxs("div",{className:"qp-intro-stat",children:[t.jsx(uo,{size:20}),t.jsxs("div",{children:[t.jsxs("span",{className:"qp-intro-stat-value",children:[a.duree," min"]}),t.jsx("span",{className:"qp-intro-stat-label",children:"Dure"})]})]}),t.jsxs("div",{className:"qp-intro-stat",children:[t.jsx(ts,{size:20}),t.jsxs("div",{children:[t.jsxs("span",{className:"qp-intro-stat-value",children:[a.noteMinimale||50,"%"]}),t.jsx("span",{className:"qp-intro-stat-label",children:"Note min."})]})]})]}),t.jsxs("div",{className:"qp-intro-instructions",children:[t.jsx("h3",{children:"Instructions"}),t.jsxs("ul",{children:[t.jsx("li",{children:"Rpondez  toutes les questions dans le temps imparti"}),t.jsx("li",{children:"Chaque question a une seule bonne rponse"}),t.jsx("li",{children:"Vous pouvez naviguer entre les questions"}),t.jsx("li",{children:"Le quiz est soumis automatiquement quand le temps est coul"}),t.jsxs("li",{children:["Il faut obtenir au moins ",a.noteMinimale||50,"% pour russir"]})]})]})]}),t.jsxs("button",{className:"qp-btn qp-btn-start",onClick:T,children:[t.jsx(ao,{size:20})," Commencer le quiz"]})]})});if(v==="playing"){const ve=a.questions[x];return t.jsxs("div",{className:"quiz-player-game",children:[t.jsxs("div",{className:"qp-game-header",children:[t.jsxs("div",{className:"qp-game-info",children:[t.jsx("span",{className:"qp-game-title",children:a.titre}),t.jsx("span",{className:"qp-game-discipline",children:o})]}),t.jsxs("div",{className:`qp-timer ${ne()}`,children:[t.jsx(z3,{size:18}),t.jsx("span",{children:L(w)})]})]}),t.jsx("div",{className:"qp-progress-bar",children:t.jsx("div",{className:"qp-progress-fill",style:{width:`${(x+1)/a.questions.length*100}%`}})}),t.jsxs("div",{className:"qp-game-content",children:[t.jsxs("div",{className:"qp-question-header",children:[t.jsxs("span",{className:"qp-question-number",children:["Question ",x+1,"/",a.questions.length]}),t.jsxs("span",{className:"qp-question-points",children:[ve.points||1," pt(s)"]})]}),t.jsx("h2",{className:"qp-question-text",children:ve.question}),t.jsx("div",{className:"qp-options-list",children:ve.options.map((H,he)=>t.jsxs("button",{className:`qp-option ${_[ve.id]===he?"selected":""}`,onClick:()=>F(ve.id,he),children:[t.jsx("span",{className:"qp-option-letter",children:String.fromCharCode(65+he)}),t.jsx("span",{className:"qp-option-text",children:H}),_[ve.id]===he&&t.jsx(Ut,{size:18,className:"qp-option-check"})]},he))})]}),t.jsxs("div",{className:"qp-game-footer",children:[t.jsx("div",{className:"qp-question-indicators",children:a.questions.map((H,he)=>t.jsx("button",{className:`qp-indicator ${he===x?"active":""} ${_[H.id]!==void 0?"answered":""}`,onClick:()=>I(he),children:he+1},H.id))}),t.jsxs("div",{className:"qp-nav-buttons",children:[t.jsxs("button",{className:"qp-btn qp-btn-outline",onClick:()=>I(x-1),disabled:x===0,children:[t.jsx(Tv,{size:16})," Prcdent"]}),x<a.questions.length-1?t.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>I(x+1),children:["Suivant ",t.jsx(ks,{size:16})]}):t.jsxs("button",{className:"qp-btn qp-btn-submit",onClick:X,disabled:K<a.questions.length,children:[t.jsx(Ut,{size:16}),"Soumettre (",K,"/",a.questions.length,")"]})]})]})]})}const oe=D>0?Math.round(k/D*100):0,xe=oe>=(a.noteMinimale||50);return t.jsxs("div",{className:"quiz-player-review",children:[t.jsxs("div",{className:`qp-score-card ${xe?"success":"fail"}`,children:[t.jsx("div",{className:"qp-score-icon",children:xe?t.jsx(ts,{size:48}):t.jsx(xm,{size:48})}),t.jsx("h2",{className:"qp-score-title",children:xe?"Flicitations ! ":"Continuez vos efforts ! "}),t.jsxs("div",{className:"qp-score-circle",style:{borderColor:ro(oe)},children:[t.jsxs("span",{className:"qp-score-value",children:[oe,"%"]}),t.jsx("span",{className:"qp-score-label",children:QA(oe)})]}),t.jsxs("div",{className:"qp-score-details",children:[t.jsxs("div",{className:"qp-score-detail",children:[t.jsxs("span",{children:[U,"/",a.questions.length]}),t.jsx("small",{children:"Bonnes rponses"})]}),t.jsxs("div",{className:"qp-score-detail",children:[t.jsxs("span",{children:[k,"/",D]}),t.jsx("small",{children:"Points"})]}),t.jsxs("div",{className:"qp-score-detail",children:[t.jsx("span",{children:VA(S)}),t.jsx("small",{children:"Temps"})]})]}),R&&t.jsx("p",{className:"qp-saving",children:"Sauvegarde en cours..."}),ae&&t.jsx("p",{className:"qp-saved",children:" Rsultat sauvegard"})]}),t.jsxs("div",{className:"qp-review-actions",children:[t.jsxs("button",{className:"qp-btn qp-btn-primary",onClick:()=>r("/eleve/dashboard"),children:[t.jsx(Ax,{size:18})," Tableau de bord"]}),t.jsxs("button",{className:"qp-btn qp-btn-outline",onClick:T,children:[t.jsx(k3,{size:18})," Recommencer"]})]}),t.jsxs("div",{className:"qp-review-questions",children:[t.jsx("h3",{className:"qp-review-title",children:"Correction dtaille"}),a.questions.map((ve,H)=>{const he=_[ve.id],Me=he===ve.reponseCorrecte;return t.jsxs("div",{className:`qp-review-question ${Me?"correct":"incorrect"}`,children:[t.jsxs("div",{className:"qp-review-question-header",children:[t.jsxs("span",{className:"qp-review-q-number",children:["Q",H+1]}),Me?t.jsxs("span",{className:"qp-review-badge correct",children:[t.jsx(Ut,{size:14})," Correct"]}):t.jsxs("span",{className:"qp-review-badge incorrect",children:[t.jsx(Ox,{size:14})," Incorrect"]}),t.jsxs("span",{className:"qp-review-q-points",children:[Me?ve.points||1:0,"/",ve.points||1," pt(s)"]})]}),t.jsx("p",{className:"qp-review-q-text",children:ve.question}),t.jsx("div",{className:"qp-review-options",children:ve.options.map((ue,Z)=>{let V="qp-review-option";return Z===ve.reponseCorrecte&&(V+=" correct-answer"),Z===he&&!Me&&(V+=" wrong-answer"),t.jsxs("div",{className:V,children:[t.jsx("span",{className:"qp-review-option-letter",children:String.fromCharCode(65+Z)}),t.jsx("span",{children:ue}),Z===ve.reponseCorrecte&&t.jsx(Ut,{size:14,className:"qp-review-check"}),Z===he&&!Me&&t.jsx(Ox,{size:14,className:"qp-review-x"})]},Z)})}),ve.explication&&t.jsxs("div",{className:"qp-review-explication",children:[t.jsx("strong",{children:" Explication :"})," ",ve.explication]})]},ve.id)})]})]})};function YA(e){var r,n,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var l=e.length;for(r=0;r<l;r++)e[r]&&(n=YA(e[r]))&&(a&&(a+=" "),a+=n)}else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}function St(){for(var e,r,n=0,a="",l=arguments.length;n<l;n++)(e=arguments[n])&&(r=YA(e))&&(a&&(a+=" "),a+=r);return a}var g6=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Qb(e){if(typeof e!="string")return!1;var r=g6;return r.includes(e)}var x6=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],b6=new Set(x6);function KA(e){return typeof e!="string"?!1:b6.has(e)}function WA(e){return typeof e=="string"&&e.startsWith("data-")}function ea(e){if(typeof e!="object"||e===null)return{};var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(KA(n)||WA(n))&&(r[n]=e[n]);return r}function cu(e){if(e==null)return null;if(g.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var r=e.props;return ea(r)}return typeof e=="object"&&!Array.isArray(e)?ea(e):null}function Lr(e){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(KA(n)||WA(n)||Qb(n))&&(r[n]=e[n]);return r}function y6(e){return e==null?null:g.isValidElement(e)?Lr(e.props):typeof e=="object"&&!Array.isArray(e)?Lr(e):null}var j6=["children","width","height","viewBox","className","style","title","desc"];function Tx(){return Tx=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Tx.apply(null,arguments)}function _6(e,r){if(e==null)return{};var n,a,l=N6(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function N6(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var XA=g.forwardRef((e,r)=>{var{children:n,width:a,height:l,viewBox:o,className:u,style:d,title:f,desc:p}=e,h=_6(e,j6),v=o||{width:a,height:l,x:0,y:0},b=St("recharts-surface",u);return g.createElement("svg",Tx({},Lr(h),{className:b,width:a,height:l,style:d,viewBox:"".concat(v.x," ").concat(v.y," ").concat(v.width," ").concat(v.height),ref:r}),g.createElement("title",null,f),g.createElement("desc",null,p),n)}),S6=["children","className"];function qx(){return qx=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},qx.apply(null,arguments)}function w6(e,r){if(e==null)return{};var n,a,l=C6(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function C6(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var qn=g.forwardRef((e,r)=>{var{children:n,className:a}=e,l=w6(e,S6),o=St("recharts-layer",a);return g.createElement("g",qx({className:o},Lr(l),{ref:r}),n)}),E6=g.createContext(null);function At(e){return function(){return e}}const ZA=Math.cos,_m=Math.sin,na=Math.sqrt,Nm=Math.PI,Cf=2*Nm,Rx=Math.PI,Ix=2*Rx,Os=1e-6,A6=Ix-Os;function JA(e){this._+=e[0];for(let r=1,n=e.length;r<n;++r)this._+=arguments[r]+e[r]}function z6(e){let r=Math.floor(e);if(!(r>=0))throw new Error(`invalid digits: ${e}`);if(r>15)return JA;const n=10**r;return function(a){this._+=a[0];for(let l=1,o=a.length;l<o;++l)this._+=Math.round(arguments[l]*n)/n+a[l]}}class k6{constructor(r){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=r==null?JA:z6(r)}moveTo(r,n){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(r,n){this._append`L${this._x1=+r},${this._y1=+n}`}quadraticCurveTo(r,n,a,l){this._append`Q${+r},${+n},${this._x1=+a},${this._y1=+l}`}bezierCurveTo(r,n,a,l,o,u){this._append`C${+r},${+n},${+a},${+l},${this._x1=+o},${this._y1=+u}`}arcTo(r,n,a,l,o){if(r=+r,n=+n,a=+a,l=+l,o=+o,o<0)throw new Error(`negative radius: ${o}`);let u=this._x1,d=this._y1,f=a-r,p=l-n,h=u-r,v=d-n,b=h*h+v*v;if(this._x1===null)this._append`M${this._x1=r},${this._y1=n}`;else if(b>Os)if(!(Math.abs(v*f-p*h)>Os)||!o)this._append`L${this._x1=r},${this._y1=n}`;else{let x=a-u,j=l-d,_=f*f+p*p,C=x*x+j*j,w=Math.sqrt(_),E=Math.sqrt(b),S=o*Math.tan((Rx-Math.acos((_+b-C)/(2*w*E)))/2),A=S/E,O=S/w;Math.abs(A-1)>Os&&this._append`L${r+A*h},${n+A*v}`,this._append`A${o},${o},0,0,${+(v*x>h*j)},${this._x1=r+O*f},${this._y1=n+O*p}`}}arc(r,n,a,l,o,u){if(r=+r,n=+n,a=+a,u=!!u,a<0)throw new Error(`negative radius: ${a}`);let d=a*Math.cos(l),f=a*Math.sin(l),p=r+d,h=n+f,v=1^u,b=u?l-o:o-l;this._x1===null?this._append`M${p},${h}`:(Math.abs(this._x1-p)>Os||Math.abs(this._y1-h)>Os)&&this._append`L${p},${h}`,a&&(b<0&&(b=b%Ix+Ix),b>A6?this._append`A${a},${a},0,1,${v},${r-d},${n-f}A${a},${a},0,1,${v},${this._x1=p},${this._y1=h}`:b>Os&&this._append`A${a},${a},0,${+(b>=Rx)},${v},${this._x1=r+a*Math.cos(o)},${this._y1=n+a*Math.sin(o)}`)}rect(r,n,a,l){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+n}h${a=+a}v${+l}h${-a}Z`}toString(){return this._}}function Yb(e){let r=3;return e.digits=function(n){if(!arguments.length)return r;if(n==null)r=null;else{const a=Math.floor(n);if(!(a>=0))throw new RangeError(`invalid digits: ${n}`);r=a}return e},()=>new k6(r)}function Kb(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ez(e){this._context=e}ez.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;default:this._context.lineTo(e,r);break}}};function Ef(e){return new ez(e)}function tz(e){return e[0]}function rz(e){return e[1]}function nz(e,r){var n=At(!0),a=null,l=Ef,o=null,u=Yb(d);e=typeof e=="function"?e:e===void 0?tz:At(e),r=typeof r=="function"?r:r===void 0?rz:At(r);function d(f){var p,h=(f=Kb(f)).length,v,b=!1,x;for(a==null&&(o=l(x=u())),p=0;p<=h;++p)!(p<h&&n(v=f[p],p,f))===b&&((b=!b)?o.lineStart():o.lineEnd()),b&&o.point(+e(v,p,f),+r(v,p,f));if(x)return o=null,x+""||null}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:At(+f),d):e},d.y=function(f){return arguments.length?(r=typeof f=="function"?f:At(+f),d):r},d.defined=function(f){return arguments.length?(n=typeof f=="function"?f:At(!!f),d):n},d.curve=function(f){return arguments.length?(l=f,a!=null&&(o=l(a)),d):l},d.context=function(f){return arguments.length?(f==null?a=o=null:o=l(a=f),d):a},d}function Ud(e,r,n){var a=null,l=At(!0),o=null,u=Ef,d=null,f=Yb(p);e=typeof e=="function"?e:e===void 0?tz:At(+e),r=typeof r=="function"?r:At(r===void 0?0:+r),n=typeof n=="function"?n:n===void 0?rz:At(+n);function p(v){var b,x,j,_=(v=Kb(v)).length,C,w=!1,E,S=new Array(_),A=new Array(_);for(o==null&&(d=u(E=f())),b=0;b<=_;++b){if(!(b<_&&l(C=v[b],b,v))===w)if(w=!w)x=b,d.areaStart(),d.lineStart();else{for(d.lineEnd(),d.lineStart(),j=b-1;j>=x;--j)d.point(S[j],A[j]);d.lineEnd(),d.areaEnd()}w&&(S[b]=+e(C,b,v),A[b]=+r(C,b,v),d.point(a?+a(C,b,v):S[b],n?+n(C,b,v):A[b]))}if(E)return d=null,E+""||null}function h(){return nz().defined(l).curve(u).context(o)}return p.x=function(v){return arguments.length?(e=typeof v=="function"?v:At(+v),a=null,p):e},p.x0=function(v){return arguments.length?(e=typeof v=="function"?v:At(+v),p):e},p.x1=function(v){return arguments.length?(a=v==null?null:typeof v=="function"?v:At(+v),p):a},p.y=function(v){return arguments.length?(r=typeof v=="function"?v:At(+v),n=null,p):r},p.y0=function(v){return arguments.length?(r=typeof v=="function"?v:At(+v),p):r},p.y1=function(v){return arguments.length?(n=v==null?null:typeof v=="function"?v:At(+v),p):n},p.lineX0=p.lineY0=function(){return h().x(e).y(r)},p.lineY1=function(){return h().x(e).y(n)},p.lineX1=function(){return h().x(a).y(r)},p.defined=function(v){return arguments.length?(l=typeof v=="function"?v:At(!!v),p):l},p.curve=function(v){return arguments.length?(u=v,o!=null&&(d=u(o)),p):u},p.context=function(v){return arguments.length?(v==null?o=d=null:d=u(o=v),p):o},p}class az{constructor(r,n){this._context=r,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(r,n){switch(r=+r,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+r)/2,this._y0,this._x0,n,r,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,r,this._y0,r,n);break}}this._x0=r,this._y0=n}}function O6(e){return new az(e,!0)}function D6(e){return new az(e,!1)}const Wb={draw(e,r){const n=na(r/Nm);e.moveTo(n,0),e.arc(0,0,n,0,Cf)}},P6={draw(e,r){const n=na(r/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},iz=na(1/3),M6=iz*2,T6={draw(e,r){const n=na(r/M6),a=n*iz;e.moveTo(0,-n),e.lineTo(a,0),e.lineTo(0,n),e.lineTo(-a,0),e.closePath()}},q6={draw(e,r){const n=na(r),a=-n/2;e.rect(a,a,n,n)}},R6=.8908130915292852,sz=_m(Nm/10)/_m(7*Nm/10),I6=_m(Cf/10)*sz,L6=-ZA(Cf/10)*sz,$6={draw(e,r){const n=na(r*R6),a=I6*n,l=L6*n;e.moveTo(0,-n),e.lineTo(a,l);for(let o=1;o<5;++o){const u=Cf*o/5,d=ZA(u),f=_m(u);e.lineTo(f*n,-d*n),e.lineTo(d*a-f*l,f*a+d*l)}e.closePath()}},Vv=na(3),B6={draw(e,r){const n=-na(r/(Vv*3));e.moveTo(0,n*2),e.lineTo(-Vv*n,-n),e.lineTo(Vv*n,-n),e.closePath()}},kn=-.5,On=na(3)/2,Lx=1/na(12),U6=(Lx/2+1)*3,F6={draw(e,r){const n=na(r/U6),a=n/2,l=n*Lx,o=a,u=n*Lx+n,d=-o,f=u;e.moveTo(a,l),e.lineTo(o,u),e.lineTo(d,f),e.lineTo(kn*a-On*l,On*a+kn*l),e.lineTo(kn*o-On*u,On*o+kn*u),e.lineTo(kn*d-On*f,On*d+kn*f),e.lineTo(kn*a+On*l,kn*l-On*a),e.lineTo(kn*o+On*u,kn*u-On*o),e.lineTo(kn*d+On*f,kn*f-On*d),e.closePath()}};function G6(e,r){let n=null,a=Yb(l);e=typeof e=="function"?e:At(e||Wb),r=typeof r=="function"?r:At(r===void 0?64:+r);function l(){let o;if(n||(n=o=a()),e.apply(this,arguments).draw(n,+r.apply(this,arguments)),o)return n=null,o+""||null}return l.type=function(o){return arguments.length?(e=typeof o=="function"?o:At(o),l):e},l.size=function(o){return arguments.length?(r=typeof o=="function"?o:At(+o),l):r},l.context=function(o){return arguments.length?(n=o??null,l):n},l}function Sm(){}function wm(e,r,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+r)/6,(e._y0+4*e._y1+n)/6)}function lz(e){this._context=e}lz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:wm(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:wm(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function H6(e){return new lz(e)}function oz(e){this._context=e}oz.prototype={areaStart:Sm,areaEnd:Sm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._x2=e,this._y2=r;break;case 1:this._point=2,this._x3=e,this._y3=r;break;case 2:this._point=3,this._x4=e,this._y4=r,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+r)/6);break;default:wm(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function V6(e){return new oz(e)}function cz(e){this._context=e}cz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+r)/6;this._line?this._context.lineTo(n,a):this._context.moveTo(n,a);break;case 3:this._point=4;default:wm(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function Q6(e){return new cz(e)}function uz(e){this._context=e}uz.prototype={areaStart:Sm,areaEnd:Sm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,r){e=+e,r=+r,this._point?this._context.lineTo(e,r):(this._point=1,this._context.moveTo(e,r))}};function Y6(e){return new uz(e)}function K1(e){return e<0?-1:1}function W1(e,r,n){var a=e._x1-e._x0,l=r-e._x1,o=(e._y1-e._y0)/(a||l<0&&-0),u=(n-e._y1)/(l||a<0&&-0),d=(o*l+u*a)/(a+l);return(K1(o)+K1(u))*Math.min(Math.abs(o),Math.abs(u),.5*Math.abs(d))||0}function X1(e,r){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-r)/2:r}function Qv(e,r,n){var a=e._x0,l=e._y0,o=e._x1,u=e._y1,d=(o-a)/3;e._context.bezierCurveTo(a+d,l+d*r,o-d,u-d*n,o,u)}function Cm(e){this._context=e}Cm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Qv(this,this._t0,X1(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){var n=NaN;if(e=+e,r=+r,!(e===this._x1&&r===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;break;case 2:this._point=3,Qv(this,X1(this,n=W1(this,e,r)),n);break;default:Qv(this,this._t0,n=W1(this,e,r));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r,this._t0=n}}};function dz(e){this._context=new mz(e)}(dz.prototype=Object.create(Cm.prototype)).point=function(e,r){Cm.prototype.point.call(this,r,e)};function mz(e){this._context=e}mz.prototype={moveTo:function(e,r){this._context.moveTo(r,e)},closePath:function(){this._context.closePath()},lineTo:function(e,r){this._context.lineTo(r,e)},bezierCurveTo:function(e,r,n,a,l,o){this._context.bezierCurveTo(r,e,a,n,o,l)}};function K6(e){return new Cm(e)}function W6(e){return new dz(e)}function fz(e){this._context=e}fz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,r=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],r[0]):this._context.moveTo(e[0],r[0]),n===2)this._context.lineTo(e[1],r[1]);else for(var a=Z1(e),l=Z1(r),o=0,u=1;u<n;++o,++u)this._context.bezierCurveTo(a[0][o],l[0][o],a[1][o],l[1][o],e[u],r[u]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,r){this._x.push(+e),this._y.push(+r)}};function Z1(e){var r,n=e.length-1,a,l=new Array(n),o=new Array(n),u=new Array(n);for(l[0]=0,o[0]=2,u[0]=e[0]+2*e[1],r=1;r<n-1;++r)l[r]=1,o[r]=4,u[r]=4*e[r]+2*e[r+1];for(l[n-1]=2,o[n-1]=7,u[n-1]=8*e[n-1]+e[n],r=1;r<n;++r)a=l[r]/o[r-1],o[r]-=a,u[r]-=a*u[r-1];for(l[n-1]=u[n-1]/o[n-1],r=n-2;r>=0;--r)l[r]=(u[r]-l[r+1])/o[r];for(o[n-1]=(e[n]+l[n-1])/2,r=0;r<n-1;++r)o[r]=2*e[r+1]-l[r+1];return[l,o]}function X6(e){return new fz(e)}function Af(e,r){this._context=e,this._t=r}Af.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,r),this._context.lineTo(e,r);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,r)}break}}this._x=e,this._y=r}};function Z6(e){return new Af(e,.5)}function J6(e){return new Af(e,0)}function eI(e){return new Af(e,1)}function Hs(e,r){if((u=e.length)>1)for(var n=1,a,l,o=e[r[0]],u,d=o.length;n<u;++n)for(l=o,o=e[r[n]],a=0;a<d;++a)o[a][1]+=o[a][0]=isNaN(l[a][1])?l[a][0]:l[a][1]}function $x(e){for(var r=e.length,n=new Array(r);--r>=0;)n[r]=r;return n}function tI(e,r){return e[r]}function rI(e){const r=[];return r.key=e,r}function nI(){var e=At([]),r=$x,n=Hs,a=tI;function l(o){var u=Array.from(e.apply(this,arguments),rI),d,f=u.length,p=-1,h;for(const v of o)for(d=0,++p;d<f;++d)(u[d][p]=[0,+a(v,u[d].key,p,o)]).data=v;for(d=0,h=Kb(r(u));d<f;++d)u[h[d]].index=d;return n(u,h),u}return l.keys=function(o){return arguments.length?(e=typeof o=="function"?o:At(Array.from(o)),l):e},l.value=function(o){return arguments.length?(a=typeof o=="function"?o:At(+o),l):a},l.order=function(o){return arguments.length?(r=o==null?$x:typeof o=="function"?o:At(Array.from(o)),l):r},l.offset=function(o){return arguments.length?(n=o??Hs,l):n},l}function aI(e,r){if((a=e.length)>0){for(var n,a,l=0,o=e[0].length,u;l<o;++l){for(u=n=0;n<a;++n)u+=e[n][l][1]||0;if(u)for(n=0;n<a;++n)e[n][l][1]/=u}Hs(e,r)}}function iI(e,r){if((l=e.length)>0){for(var n=0,a=e[r[0]],l,o=a.length;n<o;++n){for(var u=0,d=0;u<l;++u)d+=e[u][n][1]||0;a[n][1]+=a[n][0]=-d/2}Hs(e,r)}}function sI(e,r){if(!(!((u=e.length)>0)||!((o=(l=e[r[0]]).length)>0))){for(var n=0,a=1,l,o,u;a<o;++a){for(var d=0,f=0,p=0;d<u;++d){for(var h=e[r[d]],v=h[a][1]||0,b=h[a-1][1]||0,x=(v-b)/2,j=0;j<d;++j){var _=e[r[j]],C=_[a][1]||0,w=_[a-1][1]||0;x+=C-w}f+=v,p+=x*v}l[a-1][1]+=l[a-1][0]=n,f&&(n-=p/f)}l[a-1][1]+=l[a-1][0]=n,Hs(e,r)}}var Yv={},Kv={},J1;function lI(){return J1||(J1=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return n==="__proto__"}e.isUnsafeProperty=r})(Kv)),Kv}var Wv={},eS;function pz(){return eS||(eS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}e.isDeepKey=r})(Wv)),Wv}var Xv={},tS;function Xb(){return tS||(tS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return typeof n=="string"||typeof n=="symbol"?n:Object.is(n?.valueOf?.(),-0)?"-0":String(n)}e.toKey=r})(Xv)),Xv}var Zv={},Jv={},rS;function oI(){return rS||(rS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){if(n==null)return"";if(typeof n=="string")return n;if(Array.isArray(n))return n.map(r).join(",");const a=String(n);return a==="0"&&Object.is(Number(n),-0)?"-0":a}e.toString=r})(Jv)),Jv}var nS;function Zb(){return nS||(nS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=oI(),n=Xb();function a(l){if(Array.isArray(l))return l.map(n.toKey);if(typeof l=="symbol")return[l];l=r.toString(l);const o=[],u=l.length;if(u===0)return o;let d=0,f="",p="",h=!1;for(l.charCodeAt(0)===46&&(o.push(""),d++);d<u;){const v=l[d];p?v==="\\"&&d+1<u?(d++,f+=l[d]):v===p?p="":f+=v:h?v==='"'||v==="'"?p=v:v==="]"?(h=!1,o.push(f),f=""):f+=v:v==="["?(h=!0,f&&(o.push(f),f="")):v==="."?f&&(o.push(f),f=""):f+=v,d++}return f&&o.push(f),o}e.toPath=a})(Zv)),Zv}var aS;function Jb(){return aS||(aS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=lI(),n=pz(),a=Xb(),l=Zb();function o(d,f,p){if(d==null)return p;switch(typeof f){case"string":{if(r.isUnsafeProperty(f))return p;const h=d[f];return h===void 0?n.isDeepKey(f)?o(d,l.toPath(f),p):p:h}case"number":case"symbol":{typeof f=="number"&&(f=a.toKey(f));const h=d[f];return h===void 0?p:h}default:{if(Array.isArray(f))return u(d,f,p);if(Object.is(f?.valueOf(),-0)?f="-0":f=String(f),r.isUnsafeProperty(f))return p;const h=d[f];return h===void 0?p:h}}}function u(d,f,p){if(f.length===0)return p;let h=d;for(let v=0;v<f.length;v++){if(h==null||r.isUnsafeProperty(f[v]))return p;h=h[f[v]]}return h===void 0?p:h}e.get=o})(Yv)),Yv}var eg,iS;function cI(){return iS||(iS=1,eg=Jb().get),eg}var uI=cI();const fo=oi(uI);var dI=4;function Yi(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dI,n=10**r,a=Math.round(e*n)/n;return Object.is(a,-0)?0:a}function Ft(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return e.reduce((l,o,u)=>{var d=n[u-1];return typeof d=="string"?l+d+o:d!==void 0?l+Yi(d)+o:l+o},"")}var Jr=e=>e===0?0:e>0?1:-1,ya=e=>typeof e=="number"&&e!=+e,Vs=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,De=e=>(typeof e=="number"||e instanceof Number)&&!ya(e),ja=e=>De(e)||typeof e=="string",mI=0,Fc=e=>{var r=++mI;return"".concat(e||"").concat(r)},ta=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!De(r)&&typeof r!="string")return a;var o;if(Vs(r)){if(n==null)return a;var u=r.indexOf("%");o=n*parseFloat(r.slice(0,u))/100}else o=+r;return ya(o)&&(o=a),l&&n!=null&&o>n&&(o=n),o},hz=e=>{if(!Array.isArray(e))return!1;for(var r=e.length,n={},a=0;a<r;a++)if(!n[String(e[a])])n[String(e[a])]=!0;else return!0;return!1};function Gt(e,r,n){return De(e)&&De(r)?Yi(e+n*(r-e)):r}function vz(e,r,n){if(!(!e||!e.length))return e.find(a=>a&&(typeof r=="function"?r(a):fo(a,r))===n)}var Rt=e=>e===null||typeof e>"u",uu=e=>Rt(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function en(e){return e!=null}function rl(){}var fI=["type","size","sizeType"];function Bx(){return Bx=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Bx.apply(null,arguments)}function sS(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function lS(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?sS(Object(n),!0).forEach(function(a){pI(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sS(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function pI(e,r,n){return(r=hI(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function hI(e){var r=vI(e,"string");return typeof r=="symbol"?r:r+""}function vI(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function gI(e,r){if(e==null)return{};var n,a,l=xI(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function xI(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var gz={symbolCircle:Wb,symbolCross:P6,symbolDiamond:T6,symbolSquare:q6,symbolStar:$6,symbolTriangle:B6,symbolWye:F6},bI=Math.PI/180,yI=e=>{var r="symbol".concat(uu(e));return gz[r]||Wb},jI=(e,r,n)=>{if(r==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var a=18*bI;return 1.25*e*e*(Math.tan(a)-Math.tan(a*2)*Math.tan(a)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},_I=(e,r)=>{gz["symbol".concat(uu(e))]=r},xz=e=>{var{type:r="circle",size:n=64,sizeType:a="area"}=e,l=gI(e,fI),o=lS(lS({},l),{},{type:r,size:n,sizeType:a}),u="circle";typeof r=="string"&&(u=r);var d=()=>{var b=yI(u),x=G6().type(b).size(jI(n,a,u)),j=x();if(j!==null)return j},{className:f,cx:p,cy:h}=o,v=Lr(o);return De(p)&&De(h)&&De(n)?g.createElement("path",Bx({},v,{className:St("recharts-symbols",f),transform:"translate(".concat(p,", ").concat(h,")"),d:d()})):null};xz.registerSymbol=_I;var bz=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,ey=(e,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(g.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(l=>{Qb(l)&&(a[l]=(o=>n[l](n,o)))}),a},NI=(e,r,n)=>a=>(e(r,n,a),null),ty=(e,r,n)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var a=null;return Object.keys(e).forEach(l=>{var o=e[l];Qb(l)&&typeof o=="function"&&(a||(a={}),a[l]=NI(o,r,n))}),a};function oS(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function SI(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?oS(Object(n),!0).forEach(function(a){wI(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oS(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function wI(e,r,n){return(r=CI(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function CI(e){var r=EI(e,"string");return typeof r=="symbol"?r:r+""}function EI(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Ur(e,r){var n=SI({},e),a=r,l=Object.keys(r),o=l.reduce((u,d)=>(u[d]===void 0&&a[d]!==void 0&&(u[d]=a[d]),u),n);return o}var tg={},rg={},cS;function AI(){return cS||(cS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n,a){const l=new Map;for(let o=0;o<n.length;o++){const u=n[o],d=a(u,o,n);l.has(d)||l.set(d,u)}return Array.from(l.values())}e.uniqBy=r})(rg)),rg}var ng={},uS;function zI(){return uS||(uS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n,a){return function(...l){return n.apply(this,l.slice(0,a))}}e.ary=r})(ng)),ng}var ag={},dS;function yz(){return dS||(dS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return n}e.identity=r})(ag)),ag}var ig={},sg={},lg={},mS;function kI(){return mS||(mS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return Number.isSafeInteger(n)&&n>=0}e.isLength=r})(lg)),lg}var fS;function ry(){return fS||(fS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=kI();function n(a){return a!=null&&typeof a!="function"&&r.isLength(a.length)}e.isArrayLike=n})(sg)),sg}var og={},pS;function OI(){return pS||(pS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return typeof n=="object"&&n!==null}e.isObjectLike=r})(og)),og}var hS;function DI(){return hS||(hS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=ry(),n=OI();function a(l){return n.isObjectLike(l)&&r.isArrayLike(l)}e.isArrayLikeObject=a})(ig)),ig}var cg={},ug={},vS;function PI(){return vS||(vS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Jb();function n(a){return function(l){return r.get(l,a)}}e.property=n})(ug)),ug}var dg={},mg={},fg={},pg={},gS;function jz(){return gS||(gS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return n!==null&&(typeof n=="object"||typeof n=="function")}e.isObject=r})(pg)),pg}var hg={},xS;function _z(){return xS||(xS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return n==null||typeof n!="object"&&typeof n!="function"}e.isPrimitive=r})(hg)),hg}var vg={},bS;function Nz(){return bS||(bS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n,a){return n===a||Number.isNaN(n)&&Number.isNaN(a)}e.isEqualsSameValueZero=r})(vg)),vg}var yS;function MI(){return yS||(yS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=jz(),n=_z(),a=Nz();function l(h,v,b){return typeof b!="function"?l(h,v,()=>{}):o(h,v,function x(j,_,C,w,E,S){const A=b(j,_,C,w,E,S);return A!==void 0?!!A:o(j,_,x,S)},new Map)}function o(h,v,b,x){if(v===h)return!0;switch(typeof v){case"object":return u(h,v,b,x);case"function":return Object.keys(v).length>0?o(h,{...v},b,x):a.isEqualsSameValueZero(h,v);default:return r.isObject(h)?typeof v=="string"?v==="":!0:a.isEqualsSameValueZero(h,v)}}function u(h,v,b,x){if(v==null)return!0;if(Array.isArray(v))return f(h,v,b,x);if(v instanceof Map)return d(h,v,b,x);if(v instanceof Set)return p(h,v,b,x);const j=Object.keys(v);if(h==null||n.isPrimitive(h))return j.length===0;if(j.length===0)return!0;if(x?.has(v))return x.get(v)===h;x?.set(v,h);try{for(let _=0;_<j.length;_++){const C=j[_];if(!n.isPrimitive(h)&&!(C in h)||v[C]===void 0&&h[C]!==void 0||v[C]===null&&h[C]!==null||!b(h[C],v[C],C,h,v,x))return!1}return!0}finally{x?.delete(v)}}function d(h,v,b,x){if(v.size===0)return!0;if(!(h instanceof Map))return!1;for(const[j,_]of v.entries()){const C=h.get(j);if(b(C,_,j,h,v,x)===!1)return!1}return!0}function f(h,v,b,x){if(v.length===0)return!0;if(!Array.isArray(h))return!1;const j=new Set;for(let _=0;_<v.length;_++){const C=v[_];let w=!1;for(let E=0;E<h.length;E++){if(j.has(E))continue;const S=h[E];let A=!1;if(b(S,C,_,h,v,x)&&(A=!0),A){j.add(E),w=!0;break}}if(!w)return!1}return!0}function p(h,v,b,x){return v.size===0?!0:h instanceof Set?f([...h],[...v],b,x):!1}e.isMatchWith=l,e.isSetMatch=p})(fg)),fg}var jS;function Sz(){return jS||(jS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=MI();function n(a,l){return r.isMatchWith(a,l,()=>{})}e.isMatch=n})(mg)),mg}var gg={},xg={},bg={},_S;function TI(){return _S||(_S=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return Object.getOwnPropertySymbols(n).filter(a=>Object.prototype.propertyIsEnumerable.call(n,a))}e.getSymbols=r})(bg)),bg}var yg={},NS;function ny(){return NS||(NS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}e.getTag=r})(yg)),yg}var jg={},SS;function wz(){return SS||(SS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r="[object RegExp]",n="[object String]",a="[object Number]",l="[object Boolean]",o="[object Arguments]",u="[object Symbol]",d="[object Date]",f="[object Map]",p="[object Set]",h="[object Array]",v="[object Function]",b="[object ArrayBuffer]",x="[object Object]",j="[object Error]",_="[object DataView]",C="[object Uint8Array]",w="[object Uint8ClampedArray]",E="[object Uint16Array]",S="[object Uint32Array]",A="[object BigUint64Array]",O="[object Int8Array]",k="[object Int16Array]",P="[object Int32Array]",D="[object BigInt64Array]",B="[object Float32Array]",U="[object Float64Array]";e.argumentsTag=o,e.arrayBufferTag=b,e.arrayTag=h,e.bigInt64ArrayTag=D,e.bigUint64ArrayTag=A,e.booleanTag=l,e.dataViewTag=_,e.dateTag=d,e.errorTag=j,e.float32ArrayTag=B,e.float64ArrayTag=U,e.functionTag=v,e.int16ArrayTag=k,e.int32ArrayTag=P,e.int8ArrayTag=O,e.mapTag=f,e.numberTag=a,e.objectTag=x,e.regexpTag=r,e.setTag=p,e.stringTag=n,e.symbolTag=u,e.uint16ArrayTag=E,e.uint32ArrayTag=S,e.uint8ArrayTag=C,e.uint8ClampedArrayTag=w})(jg)),jg}var _g={},wS;function qI(){return wS||(wS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}e.isTypedArray=r})(_g)),_g}var CS;function Cz(){return CS||(CS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=TI(),n=ny(),a=wz(),l=_z(),o=qI();function u(h,v){return d(h,void 0,h,new Map,v)}function d(h,v,b,x=new Map,j=void 0){const _=j?.(h,v,b,x);if(_!==void 0)return _;if(l.isPrimitive(h))return h;if(x.has(h))return x.get(h);if(Array.isArray(h)){const C=new Array(h.length);x.set(h,C);for(let w=0;w<h.length;w++)C[w]=d(h[w],w,b,x,j);return Object.hasOwn(h,"index")&&(C.index=h.index),Object.hasOwn(h,"input")&&(C.input=h.input),C}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const C=new RegExp(h.source,h.flags);return C.lastIndex=h.lastIndex,C}if(h instanceof Map){const C=new Map;x.set(h,C);for(const[w,E]of h)C.set(w,d(E,w,b,x,j));return C}if(h instanceof Set){const C=new Set;x.set(h,C);for(const w of h)C.add(d(w,void 0,b,x,j));return C}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(o.isTypedArray(h)){const C=new(Object.getPrototypeOf(h)).constructor(h.length);x.set(h,C);for(let w=0;w<h.length;w++)C[w]=d(h[w],w,b,x,j);return C}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const C=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return x.set(h,C),f(C,h,b,x,j),C}if(typeof File<"u"&&h instanceof File){const C=new File([h],h.name,{type:h.type});return x.set(h,C),f(C,h,b,x,j),C}if(typeof Blob<"u"&&h instanceof Blob){const C=new Blob([h],{type:h.type});return x.set(h,C),f(C,h,b,x,j),C}if(h instanceof Error){const C=new h.constructor;return x.set(h,C),C.message=h.message,C.name=h.name,C.stack=h.stack,C.cause=h.cause,f(C,h,b,x,j),C}if(h instanceof Boolean){const C=new Boolean(h.valueOf());return x.set(h,C),f(C,h,b,x,j),C}if(h instanceof Number){const C=new Number(h.valueOf());return x.set(h,C),f(C,h,b,x,j),C}if(h instanceof String){const C=new String(h.valueOf());return x.set(h,C),f(C,h,b,x,j),C}if(typeof h=="object"&&p(h)){const C=Object.create(Object.getPrototypeOf(h));return x.set(h,C),f(C,h,b,x,j),C}return h}function f(h,v,b=h,x,j){const _=[...Object.keys(v),...r.getSymbols(v)];for(let C=0;C<_.length;C++){const w=_[C],E=Object.getOwnPropertyDescriptor(h,w);(E==null||E.writable)&&(h[w]=d(v[w],w,b,x,j))}}function p(h){switch(n.getTag(h)){case a.argumentsTag:case a.arrayTag:case a.arrayBufferTag:case a.dataViewTag:case a.booleanTag:case a.dateTag:case a.float32ArrayTag:case a.float64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.mapTag:case a.numberTag:case a.objectTag:case a.regexpTag:case a.setTag:case a.stringTag:case a.symbolTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=u,e.cloneDeepWithImpl=d,e.copyProperties=f})(xg)),xg}var ES;function RI(){return ES||(ES=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Cz();function n(a){return r.cloneDeepWithImpl(a,void 0,a,new Map,void 0)}e.cloneDeep=n})(gg)),gg}var AS;function II(){return AS||(AS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Sz(),n=RI();function a(l){return l=n.cloneDeep(l),o=>r.isMatch(o,l)}e.matches=a})(dg)),dg}var Ng={},Sg={},wg={},zS;function LI(){return zS||(zS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Cz(),n=ny(),a=wz();function l(o,u){return r.cloneDeepWith(o,(d,f,p,h)=>{const v=u?.(d,f,p,h);if(v!==void 0)return v;if(typeof o=="object"){if(n.getTag(o)===a.objectTag&&typeof o.constructor!="function"){const b={};return h.set(o,b),r.copyProperties(b,o,p,h),b}switch(Object.prototype.toString.call(o)){case a.numberTag:case a.stringTag:case a.booleanTag:{const b=new o.constructor(o?.valueOf());return r.copyProperties(b,o),b}case a.argumentsTag:{const b={};return r.copyProperties(b,o),b.length=o.length,b[Symbol.iterator]=o[Symbol.iterator],b}default:return}}})}e.cloneDeepWith=l})(wg)),wg}var kS;function $I(){return kS||(kS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=LI();function n(a){return r.cloneDeepWith(a)}e.cloneDeep=n})(Sg)),Sg}var Cg={},Eg={},OS;function Ez(){return OS||(OS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=/^(?:0|[1-9]\d*)$/;function n(a,l=Number.MAX_SAFE_INTEGER){switch(typeof a){case"number":return Number.isInteger(a)&&a>=0&&a<l;case"symbol":return!1;case"string":return r.test(a)}}e.isIndex=n})(Eg)),Eg}var Ag={},DS;function BI(){return DS||(DS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=ny();function n(a){return a!==null&&typeof a=="object"&&r.getTag(a)==="[object Arguments]"}e.isArguments=n})(Ag)),Ag}var PS;function UI(){return PS||(PS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=pz(),n=Ez(),a=BI(),l=Zb();function o(u,d){let f;if(Array.isArray(d)?f=d:typeof d=="string"&&r.isDeepKey(d)&&u?.[d]==null?f=l.toPath(d):f=[d],f.length===0)return!1;let p=u;for(let h=0;h<f.length;h++){const v=f[h];if((p==null||!Object.hasOwn(p,v))&&!((Array.isArray(p)||a.isArguments(p))&&n.isIndex(v)&&v<p.length))return!1;p=p[v]}return!0}e.has=o})(Cg)),Cg}var MS;function FI(){return MS||(MS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Sz(),n=Xb(),a=$I(),l=Jb(),o=UI();function u(d,f){switch(typeof d){case"object":{Object.is(d?.valueOf(),-0)&&(d="-0");break}case"number":{d=n.toKey(d);break}}return f=a.cloneDeep(f),function(p){const h=l.get(p,d);return h===void 0?o.has(p,d):f===void 0?h===void 0:r.isMatch(h,f)}}e.matchesProperty=u})(Ng)),Ng}var TS;function GI(){return TS||(TS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=yz(),n=PI(),a=II(),l=FI();function o(u){if(u==null)return r.identity;switch(typeof u){case"function":return u;case"object":return Array.isArray(u)&&u.length===2?l.matchesProperty(u[0],u[1]):a.matches(u);case"string":case"symbol":case"number":return n.property(u)}}e.iteratee=o})(cg)),cg}var qS;function HI(){return qS||(qS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=AI(),n=zI(),a=yz(),l=DI(),o=GI();function u(d,f=a.identity){return l.isArrayLikeObject(d)?r.uniqBy(Array.from(d),n.ary(o.iteratee(f),1)):[]}e.uniqBy=u})(tg)),tg}var zg,RS;function VI(){return RS||(RS=1,zg=HI().uniqBy),zg}var QI=VI();const IS=oi(QI);function YI(e,r,n){return r===!0?IS(e,n):typeof r=="function"?IS(e,r):e}var kg={exports:{}},Og={},Dg={exports:{}},Pg={};var LS;function KI(){if(LS)return Pg;LS=1;var e=Nf();function r(v,b){return v===b&&(v!==0||1/v===1/b)||v!==v&&b!==b}var n=typeof Object.is=="function"?Object.is:r,a=e.useState,l=e.useEffect,o=e.useLayoutEffect,u=e.useDebugValue;function d(v,b){var x=b(),j=a({inst:{value:x,getSnapshot:b}}),_=j[0].inst,C=j[1];return o(function(){_.value=x,_.getSnapshot=b,f(_)&&C({inst:_})},[v,x,b]),l(function(){return f(_)&&C({inst:_}),v(function(){f(_)&&C({inst:_})})},[v]),u(x),x}function f(v){var b=v.getSnapshot;v=v.value;try{var x=b();return!n(v,x)}catch{return!0}}function p(v,b){return b()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:d;return Pg.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,Pg}var $S;function WI(){return $S||($S=1,Dg.exports=KI()),Dg.exports}var BS;function XI(){if(BS)return Og;BS=1;var e=Nf(),r=WI();function n(p,h){return p===h&&(p!==0||1/p===1/h)||p!==p&&h!==h}var a=typeof Object.is=="function"?Object.is:n,l=r.useSyncExternalStore,o=e.useRef,u=e.useEffect,d=e.useMemo,f=e.useDebugValue;return Og.useSyncExternalStoreWithSelector=function(p,h,v,b,x){var j=o(null);if(j.current===null){var _={hasValue:!1,value:null};j.current=_}else _=j.current;j=d(function(){function w(k){if(!E){if(E=!0,S=k,k=b(k),x!==void 0&&_.hasValue){var P=_.value;if(x(P,k))return A=P}return A=k}if(P=A,a(S,k))return P;var D=b(k);return x!==void 0&&x(P,D)?(S=k,P):(S=k,A=D)}var E=!1,S,A,O=v===void 0?null:v;return[function(){return w(h())},O===null?void 0:function(){return w(O())}]},[h,v,b,x]);var C=l(p,j[0],j[1]);return u(function(){_.hasValue=!0,_.value=C},[C]),f(C),C},Og}var US;function ZI(){return US||(US=1,kg.exports=XI()),kg.exports}var JI=ZI(),ay=g.createContext(null),e4=e=>e,Yt=()=>{var e=g.useContext(ay);return e?e.store.dispatch:e4},um=()=>{},t4=()=>um,r4=(e,r)=>e===r;function $e(e){var r=g.useContext(ay),n=g.useMemo(()=>r?a=>{if(a!=null)return e(a)}:um,[r,e]);return JI.useSyncExternalStoreWithSelector(r?r.subscription.addNestedSub:t4,r?r.store.getState:um,r?r.store.getState:um,n,r4)}function n4(e,r=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(r)}function a4(e,r=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(r)}function i4(e,r="expected all items to be functions, instead received the following types: "){if(!e.every(n=>typeof n=="function")){const n=e.map(a=>typeof a=="function"?`function ${a.name||"unnamed"}()`:typeof a).join(", ");throw new TypeError(`${r}[${n}]`)}}var FS=e=>Array.isArray(e)?e:[e];function s4(e){const r=Array.isArray(e[0])?e[0]:e;return i4(r,"createSelector expects all input-selectors to be functions, but received the following types: "),r}function l4(e,r){const n=[],{length:a}=e;for(let l=0;l<a;l++)n.push(e[l].apply(null,r));return n}var o4=class{constructor(e){this.value=e}deref(){return this.value}},c4=typeof WeakRef<"u"?WeakRef:o4,u4=0,GS=1;function Fd(){return{s:u4,v:void 0,o:null,p:null}}function Az(e,r={}){let n=Fd();const{resultEqualityCheck:a}=r;let l,o=0;function u(){let d=n;const{length:f}=arguments;for(let v=0,b=f;v<b;v++){const x=arguments[v];if(typeof x=="function"||typeof x=="object"&&x!==null){let j=d.o;j===null&&(d.o=j=new WeakMap);const _=j.get(x);_===void 0?(d=Fd(),j.set(x,d)):d=_}else{let j=d.p;j===null&&(d.p=j=new Map);const _=j.get(x);_===void 0?(d=Fd(),j.set(x,d)):d=_}}const p=d;let h;if(d.s===GS)h=d.v;else if(h=e.apply(null,arguments),o++,a){const v=l?.deref?.()??l;v!=null&&a(v,h)&&(h=v,o!==0&&o--),l=typeof h=="object"&&h!==null||typeof h=="function"?new c4(h):h}return p.s=GS,p.v=h,h}return u.clearCache=()=>{n=Fd(),u.resetResultsCount()},u.resultsCount=()=>o,u.resetResultsCount=()=>{o=0},u}function d4(e,...r){const n=typeof e=="function"?{memoize:e,memoizeOptions:r}:e,a=(...l)=>{let o=0,u=0,d,f={},p=l.pop();typeof p=="object"&&(f=p,p=l.pop()),n4(p,`createSelector expects an output function after the inputs, but received: [${typeof p}]`);const h={...n,...f},{memoize:v,memoizeOptions:b=[],argsMemoize:x=Az,argsMemoizeOptions:j=[]}=h,_=FS(b),C=FS(j),w=s4(l),E=v(function(){return o++,p.apply(null,arguments)},..._),S=x(function(){u++;const O=l4(w,arguments);return d=E.apply(null,O),d},...C);return Object.assign(S,{resultFunc:p,memoizedResultFunc:E,dependencies:w,dependencyRecomputations:()=>u,resetDependencyRecomputations:()=>{u=0},lastResult:()=>d,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:v,argsMemoize:x})};return Object.assign(a,{withTypes:()=>a}),a}var de=d4(Az),m4=Object.assign((e,r=de)=>{a4(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const n=Object.keys(e),a=n.map(o=>e[o]);return r(a,(...o)=>o.reduce((u,d,f)=>(u[n[f]]=d,u),{}))},{withTypes:()=>m4}),Mg={},Tg={},qg={},HS;function f4(){return HS||(HS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return typeof a=="symbol"?1:a===null?2:a===void 0?3:a!==a?4:0}const n=(a,l,o)=>{if(a!==l){const u=r(a),d=r(l);if(u===d&&u===0){if(a<l)return o==="desc"?1:-1;if(a>l)return o==="desc"?-1:1}return o==="desc"?d-u:u-d}return 0};e.compareValues=n})(qg)),qg}var Rg={},Ig={},VS;function zz(){return VS||(VS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return typeof n=="symbol"||n instanceof Symbol}e.isSymbol=r})(Ig)),Ig}var QS;function p4(){return QS||(QS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=zz(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function l(o,u){return Array.isArray(o)?!1:typeof o=="number"||typeof o=="boolean"||o==null||r.isSymbol(o)?!0:typeof o=="string"&&(a.test(o)||!n.test(o))||u!=null&&Object.hasOwn(u,o)}e.isKey=l})(Rg)),Rg}var YS;function h4(){return YS||(YS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=f4(),n=p4(),a=Zb();function l(o,u,d,f){if(o==null)return[];d=f?void 0:d,Array.isArray(o)||(o=Object.values(o)),Array.isArray(u)||(u=u==null?[null]:[u]),u.length===0&&(u=[null]),Array.isArray(d)||(d=d==null?[]:[d]),d=d.map(x=>String(x));const p=(x,j)=>{let _=x;for(let C=0;C<j.length&&_!=null;++C)_=_[j[C]];return _},h=(x,j)=>j==null||x==null?j:typeof x=="object"&&"key"in x?Object.hasOwn(j,x.key)?j[x.key]:p(j,x.path):typeof x=="function"?x(j):Array.isArray(x)?p(j,x):typeof j=="object"?j[x]:j,v=u.map(x=>(Array.isArray(x)&&x.length===1&&(x=x[0]),x==null||typeof x=="function"||Array.isArray(x)||n.isKey(x)?x:{key:x,path:a.toPath(x)}));return o.map(x=>({original:x,criteria:v.map(j=>h(j,x))})).slice().sort((x,j)=>{for(let _=0;_<v.length;_++){const C=r.compareValues(x.criteria[_],j.criteria[_],d[_]);if(C!==0)return C}return 0}).map(x=>x.original)}e.orderBy=l})(Tg)),Tg}var Lg={},KS;function v4(){return KS||(KS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n,a=1){const l=[],o=Math.floor(a),u=(d,f)=>{for(let p=0;p<d.length;p++){const h=d[p];Array.isArray(h)&&f<o?u(h,f+1):l.push(h)}};return u(n,0),l}e.flatten=r})(Lg)),Lg}var $g={},WS;function kz(){return WS||(WS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Ez(),n=ry(),a=jz(),l=Nz();function o(u,d,f){return a.isObject(f)&&(typeof d=="number"&&n.isArrayLike(f)&&r.isIndex(d)&&d<f.length||typeof d=="string"&&d in f)?l.isEqualsSameValueZero(f[d],u):!1}e.isIterateeCall=o})($g)),$g}var XS;function g4(){return XS||(XS=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=h4(),n=v4(),a=kz();function l(o,...u){const d=u.length;return d>1&&a.isIterateeCall(o,u[0],u[1])?u=[]:d>2&&a.isIterateeCall(u[0],u[1],u[2])&&(u=[u[0]]),r.orderBy(o,n.flatten(u),["asc"])}e.sortBy=l})(Mg)),Mg}var Bg,ZS;function x4(){return ZS||(ZS=1,Bg=g4().sortBy),Bg}var b4=x4();const zf=oi(b4);var Oz=e=>e.legend.settings,y4=e=>e.legend.size,j4=e=>e.legend.payload;de([j4,Oz],(e,r)=>{var{itemSorter:n}=r,a=e.flat(1);return n?zf(a,n):a});var Gd=1;function _4(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[r,n]=g.useState({height:0,left:0,top:0,width:0}),a=g.useCallback(l=>{if(l!=null){var o=l.getBoundingClientRect(),u={height:o.height,left:o.left,top:o.top,width:o.width};(Math.abs(u.height-r.height)>Gd||Math.abs(u.left-r.left)>Gd||Math.abs(u.top-r.top)>Gd||Math.abs(u.width-r.width)>Gd)&&n({height:u.height,left:u.left,top:u.top,width:u.width})}},[r.width,r.height,r.top,r.left,...e]);return[r,a]}function Er(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var N4=typeof Symbol=="function"&&Symbol.observable||"@@observable",JS=N4,Ug=()=>Math.random().toString(36).substring(7).split("").join("."),S4={INIT:`@@redux/INIT${Ug()}`,REPLACE:`@@redux/REPLACE${Ug()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Ug()}`},Em=S4;function iy(e){if(typeof e!="object"||e===null)return!1;let r=e;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r||Object.getPrototypeOf(e)===null}function Dz(e,r,n){if(typeof e!="function")throw new Error(Er(2));if(typeof r=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Er(0));if(typeof r=="function"&&typeof n>"u"&&(n=r,r=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Er(1));return n(Dz)(e,r)}let a=e,l=r,o=new Map,u=o,d=0,f=!1;function p(){u===o&&(u=new Map,o.forEach((C,w)=>{u.set(w,C)}))}function h(){if(f)throw new Error(Er(3));return l}function v(C){if(typeof C!="function")throw new Error(Er(4));if(f)throw new Error(Er(5));let w=!0;p();const E=d++;return u.set(E,C),function(){if(w){if(f)throw new Error(Er(6));w=!1,p(),u.delete(E),o=null}}}function b(C){if(!iy(C))throw new Error(Er(7));if(typeof C.type>"u")throw new Error(Er(8));if(typeof C.type!="string")throw new Error(Er(17));if(f)throw new Error(Er(9));try{f=!0,l=a(l,C)}finally{f=!1}return(o=u).forEach(E=>{E()}),C}function x(C){if(typeof C!="function")throw new Error(Er(10));a=C,b({type:Em.REPLACE})}function j(){const C=v;return{subscribe(w){if(typeof w!="object"||w===null)throw new Error(Er(11));function E(){const A=w;A.next&&A.next(h())}return E(),{unsubscribe:C(E)}},[JS](){return this}}}return b({type:Em.INIT}),{dispatch:b,subscribe:v,getState:h,replaceReducer:x,[JS]:j}}function w4(e){Object.keys(e).forEach(r=>{const n=e[r];if(typeof n(void 0,{type:Em.INIT})>"u")throw new Error(Er(12));if(typeof n(void 0,{type:Em.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Er(13))})}function Pz(e){const r=Object.keys(e),n={};for(let o=0;o<r.length;o++){const u=r[o];typeof e[u]=="function"&&(n[u]=e[u])}const a=Object.keys(n);let l;try{w4(n)}catch(o){l=o}return function(u={},d){if(l)throw l;let f=!1;const p={};for(let h=0;h<a.length;h++){const v=a[h],b=n[v],x=u[v],j=b(x,d);if(typeof j>"u")throw d&&d.type,new Error(Er(14));p[v]=j,f=f||j!==x}return f=f||a.length!==Object.keys(u).length,f?p:u}}function Am(...e){return e.length===0?r=>r:e.length===1?e[0]:e.reduce((r,n)=>(...a)=>r(n(...a)))}function C4(...e){return r=>(n,a)=>{const l=r(n,a);let o=()=>{throw new Error(Er(15))};const u={getState:l.getState,dispatch:(f,...p)=>o(f,...p)},d=e.map(f=>f(u));return o=Am(...d)(l.dispatch),{...l,dispatch:o}}}function Mz(e){return iy(e)&&"type"in e&&typeof e.type=="string"}var Tz=Symbol.for("immer-nothing"),ew=Symbol.for("immer-draftable"),$r=Symbol.for("immer-state");function Wn(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var pn=Object,po=pn.getPrototypeOf,zm="constructor",kf="prototype",Ux="configurable",km="enumerable",dm="writable",Gc="value",ti=e=>!!e&&!!e[$r];function ra(e){return e?qz(e)||Df(e)||!!e[ew]||!!e[zm]?.[ew]||Pf(e)||Mf(e):!1}var E4=pn[kf][zm].toString(),tw=new WeakMap;function qz(e){if(!e||!sy(e))return!1;const r=po(e);if(r===null||r===pn[kf])return!0;const n=pn.hasOwnProperty.call(r,zm)&&r[zm];if(n===Object)return!0;if(!no(n))return!1;let a=tw.get(n);return a===void 0&&(a=Function.toString.call(n),tw.set(n,a)),a===E4}function Of(e,r,n=!0){du(e)===0?(n?Reflect.ownKeys(e):pn.keys(e)).forEach(l=>{r(l,e[l],e)}):e.forEach((a,l)=>r(l,a,e))}function du(e){const r=e[$r];return r?r.type_:Df(e)?1:Pf(e)?2:Mf(e)?3:0}var rw=(e,r,n=du(e))=>n===2?e.has(r):pn[kf].hasOwnProperty.call(e,r),Fx=(e,r,n=du(e))=>n===2?e.get(r):e[r],Om=(e,r,n,a=du(e))=>{a===2?e.set(r,n):a===3?e.add(n):e[r]=n};function A4(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}var Df=Array.isArray,Pf=e=>e instanceof Map,Mf=e=>e instanceof Set,sy=e=>typeof e=="object",no=e=>typeof e=="function",Fg=e=>typeof e=="boolean";function z4(e){const r=+e;return Number.isInteger(r)&&String(r)===e}var Qa=e=>e.copy_||e.base_,ly=e=>e.modified_?e.copy_:e.base_;function Gx(e,r){if(Pf(e))return new Map(e);if(Mf(e))return new Set(e);if(Df(e))return Array[kf].slice.call(e);const n=qz(e);if(r===!0||r==="class_only"&&!n){const a=pn.getOwnPropertyDescriptors(e);delete a[$r];let l=Reflect.ownKeys(a);for(let o=0;o<l.length;o++){const u=l[o],d=a[u];d[dm]===!1&&(d[dm]=!0,d[Ux]=!0),(d.get||d.set)&&(a[u]={[Ux]:!0,[dm]:!0,[km]:d[km],[Gc]:e[u]})}return pn.create(po(e),a)}else{const a=po(e);if(a!==null&&n)return{...e};const l=pn.create(a);return pn.assign(l,e)}}function oy(e,r=!1){return Tf(e)||ti(e)||!ra(e)||(du(e)>1&&pn.defineProperties(e,{set:Hd,add:Hd,clear:Hd,delete:Hd}),pn.freeze(e),r&&Of(e,(n,a)=>{oy(a,!0)},!1)),e}function k4(){Wn(2)}var Hd={[Gc]:k4};function Tf(e){return e===null||!sy(e)?!0:pn.isFrozen(e)}var Dm="MapSet",Hx="Patches",nw="ArrayMethods",Rz={};function Qs(e){const r=Rz[e];return r||Wn(0,e),r}var aw=e=>!!Rz[e],Hc,Iz=()=>Hc,O4=(e,r)=>({drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:aw(Dm)?Qs(Dm):void 0,arrayMethodsPlugin_:aw(nw)?Qs(nw):void 0});function iw(e,r){r&&(e.patchPlugin_=Qs(Hx),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function Vx(e){Qx(e),e.drafts_.forEach(D4),e.drafts_=null}function Qx(e){e===Hc&&(Hc=e.parent_)}var sw=e=>Hc=O4(Hc,e);function D4(e){const r=e[$r];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function lw(e,r){r.unfinalizedDrafts_=r.drafts_.length;const n=r.drafts_[0];if(e!==void 0&&e!==n){n[$r].modified_&&(Vx(r),Wn(4)),ra(e)&&(e=ow(r,e));const{patchPlugin_:l}=r;l&&l.generateReplacementPatches_(n[$r].base_,e,r)}else e=ow(r,n);return P4(r,e,!0),Vx(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==Tz?e:void 0}function ow(e,r){if(Tf(r))return r;const n=r[$r];if(!n)return Pm(r,e.handledSet_,e);if(!qf(n,e))return r;if(!n.modified_)return n.base_;if(!n.finalized_){const{callbacks_:a}=n;if(a)for(;a.length>0;)a.pop()(e);Bz(n,e)}return n.copy_}function P4(e,r,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&oy(r,n)}function Lz(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var qf=(e,r)=>e.scope_===r,M4=[];function $z(e,r,n,a){const l=Qa(e),o=e.type_;if(a!==void 0&&Fx(l,a,o)===r){Om(l,a,n,o);return}if(!e.draftLocations_){const d=e.draftLocations_=new Map;Of(l,(f,p)=>{if(ti(p)){const h=d.get(p)||[];h.push(f),d.set(p,h)}})}const u=e.draftLocations_.get(r)??M4;for(const d of u)Om(l,d,n,o)}function T4(e,r,n){e.callbacks_.push(function(l){const o=r;if(!o||!qf(o,l))return;l.mapSetPlugin_?.fixSetContents(o);const u=ly(o);$z(e,o.draft_??o,u,n),Bz(o,l)})}function Bz(e,r){if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(e.assigned_?.size??0)>0)){const{patchPlugin_:a}=r;if(a){const l=a.getPath(e);l&&a.generatePatches_(e,l,r)}Lz(e)}}function q4(e,r,n){const{scope_:a}=e;if(ti(n)){const l=n[$r];qf(l,a)&&l.callbacks_.push(function(){mm(e);const u=ly(l);$z(e,n,u,r)})}else ra(n)&&e.callbacks_.push(function(){const o=Qa(e);e.type_===3?o.has(n)&&Pm(n,a.handledSet_,a):Fx(o,r,e.type_)===n&&a.drafts_.length>1&&(e.assigned_.get(r)??!1)===!0&&e.copy_&&Pm(Fx(e.copy_,r,e.type_),a.handledSet_,a)})}function Pm(e,r,n){return!n.immer_.autoFreeze_&&n.unfinalizedDrafts_<1||ti(e)||r.has(e)||!ra(e)||Tf(e)||(r.add(e),Of(e,(a,l)=>{if(ti(l)){const o=l[$r];if(qf(o,n)){const u=ly(o);Om(e,a,u,e.type_),Lz(o)}}else ra(l)&&Pm(l,r,n)})),e}function R4(e,r){const n=Df(e),a={type_:n?1:0,scope_:r?r.scope_:Iz(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let l=a,o=Mm;n&&(l=[a],o=Vc);const{revoke:u,proxy:d}=Proxy.revocable(l,o);return a.draft_=d,a.revoke_=u,[d,a]}var Mm={get(e,r){if(r===$r)return e;let n=e.scope_.arrayMethodsPlugin_;const a=e.type_===1&&typeof r=="string";if(a&&n?.isArrayOperationMethod(r))return n.createMethodInterceptor(e,r);const l=Qa(e);if(!rw(l,r,e.type_))return I4(e,l,r);const o=l[r];if(e.finalized_||!ra(o)||a&&e.operationMethod&&n?.isMutatingArrayMethod(e.operationMethod)&&z4(r))return o;if(o===Gg(e.base_,r)){mm(e);const u=e.type_===1?+r:r,d=Kx(e.scope_,o,e,u);return e.copy_[u]=d}return o},has(e,r){return r in Qa(e)},ownKeys(e){return Reflect.ownKeys(Qa(e))},set(e,r,n){const a=Uz(Qa(e),r);if(a?.set)return a.set.call(e.draft_,n),!0;if(!e.modified_){const l=Gg(Qa(e),r),o=l?.[$r];if(o&&o.base_===n)return e.copy_[r]=n,e.assigned_.set(r,!1),!0;if(A4(n,l)&&(n!==void 0||rw(e.base_,r,e.type_)))return!0;mm(e),Yx(e)}return e.copy_[r]===n&&(n!==void 0||r in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=n,e.assigned_.set(r,!0),q4(e,r,n)),!0},deleteProperty(e,r){return mm(e),Gg(e.base_,r)!==void 0||r in e.base_?(e.assigned_.set(r,!1),Yx(e)):e.assigned_.delete(r),e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const n=Qa(e),a=Reflect.getOwnPropertyDescriptor(n,r);return a&&{[dm]:!0,[Ux]:e.type_!==1||r!=="length",[km]:a[km],[Gc]:n[r]}},defineProperty(){Wn(11)},getPrototypeOf(e){return po(e.base_)},setPrototypeOf(){Wn(12)}},Vc={};for(let e in Mm){let r=Mm[e];Vc[e]=function(){const n=arguments;return n[0]=n[0][0],r.apply(this,n)}}Vc.deleteProperty=function(e,r){return Vc.set.call(this,e,r,void 0)};Vc.set=function(e,r,n){return Mm.set.call(this,e[0],r,n,e[0])};function Gg(e,r){const n=e[$r];return(n?Qa(n):e)[r]}function I4(e,r,n){const a=Uz(r,n);return a?Gc in a?a[Gc]:a.get?.call(e.draft_):void 0}function Uz(e,r){if(!(r in e))return;let n=po(e);for(;n;){const a=Object.getOwnPropertyDescriptor(n,r);if(a)return a;n=po(n)}}function Yx(e){e.modified_||(e.modified_=!0,e.parent_&&Yx(e.parent_))}function mm(e){e.copy_||(e.assigned_=new Map,e.copy_=Gx(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var L4=class{constructor(r){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(n,a,l)=>{if(no(n)&&!no(a)){const u=a;a=n;const d=this;return function(p=u,...h){return d.produce(p,v=>a.call(this,v,...h))}}no(a)||Wn(6),l!==void 0&&!no(l)&&Wn(7);let o;if(ra(n)){const u=sw(this),d=Kx(u,n,void 0);let f=!0;try{o=a(d),f=!1}finally{f?Vx(u):Qx(u)}return iw(u,l),lw(o,u)}else if(!n||!sy(n)){if(o=a(n),o===void 0&&(o=n),o===Tz&&(o=void 0),this.autoFreeze_&&oy(o,!0),l){const u=[],d=[];Qs(Hx).generateReplacementPatches_(n,o,{patches_:u,inversePatches_:d}),l(u,d)}return o}else Wn(1,n)},this.produceWithPatches=(n,a)=>{if(no(n))return(d,...f)=>this.produceWithPatches(d,p=>n(p,...f));let l,o;return[this.produce(n,a,(d,f)=>{l=d,o=f}),l,o]},Fg(r?.autoFreeze)&&this.setAutoFreeze(r.autoFreeze),Fg(r?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(r.useStrictShallowCopy),Fg(r?.useStrictIteration)&&this.setUseStrictIteration(r.useStrictIteration)}createDraft(r){ra(r)||Wn(8),ti(r)&&(r=Jn(r));const n=sw(this),a=Kx(n,r,void 0);return a[$r].isManual_=!0,Qx(n),a}finishDraft(r,n){const a=r&&r[$r];(!a||!a.isManual_)&&Wn(9);const{scope_:l}=a;return iw(l,n),lw(void 0,l)}setAutoFreeze(r){this.autoFreeze_=r}setUseStrictShallowCopy(r){this.useStrictShallowCopy_=r}setUseStrictIteration(r){this.useStrictIteration_=r}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(r,n){let a;for(a=n.length-1;a>=0;a--){const o=n[a];if(o.path.length===0&&o.op==="replace"){r=o.value;break}}a>-1&&(n=n.slice(a+1));const l=Qs(Hx).applyPatches_;return ti(r)?l(r,n):this.produce(r,o=>l(o,n))}};function Kx(e,r,n,a){const[l,o]=Pf(r)?Qs(Dm).proxyMap_(r,n):Mf(r)?Qs(Dm).proxySet_(r,n):R4(r,n);return(n?.scope_??Iz()).drafts_.push(l),o.callbacks_=n?.callbacks_??[],o.key_=a,n&&a!==void 0?T4(n,o,a):o.callbacks_.push(function(f){f.mapSetPlugin_?.fixSetContents(o);const{patchPlugin_:p}=f;o.modified_&&p&&p.generatePatches_(o,[],f)}),l}function Jn(e){return ti(e)||Wn(10,e),Fz(e)}function Fz(e){if(!ra(e)||Tf(e))return e;const r=e[$r];let n,a=!0;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,n=Gx(e,r.scope_.immer_.useStrictShallowCopy_),a=r.scope_.immer_.shouldUseStrictIteration()}else n=Gx(e,!0);return Of(n,(l,o)=>{Om(n,l,Fz(o))},a),r&&(r.finalized_=!1),n}var $4=new L4,Gz=$4.produce;function Hz(e){return({dispatch:n,getState:a})=>l=>o=>typeof o=="function"?o(n,a,e):l(o)}var B4=Hz(),U4=Hz,F4=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Am:Am.apply(null,arguments)};function Rn(e,r){function n(...a){if(r){let l=r(...a);if(!l)throw new Error(vn(0));return{type:e,payload:l.payload,..."meta"in l&&{meta:l.meta},..."error"in l&&{error:l.error}}}return{type:e,payload:a[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=a=>Mz(a)&&a.type===e,n}var Vz=class Mc extends Array{constructor(...r){super(...r),Object.setPrototypeOf(this,Mc.prototype)}static get[Symbol.species](){return Mc}concat(...r){return super.concat.apply(this,r)}prepend(...r){return r.length===1&&Array.isArray(r[0])?new Mc(...r[0].concat(this)):new Mc(...r.concat(this))}};function cw(e){return ra(e)?Gz(e,()=>{}):e}function Vd(e,r,n){return e.has(r)?e.get(r):e.set(r,n(r)).get(r)}function G4(e){return typeof e=="boolean"}var H4=()=>function(r){const{thunk:n=!0,immutableCheck:a=!0,serializableCheck:l=!0,actionCreatorCheck:o=!0}=r??{};let u=new Vz;return n&&(G4(n)?u.push(B4):u.push(U4(n.extraArgument))),u},Qz="RTK_autoBatch",Tt=()=>e=>({payload:e,meta:{[Qz]:!0}}),uw=e=>r=>{setTimeout(r,e)},Yz=(e={type:"raf"})=>r=>(...n)=>{const a=r(...n);let l=!0,o=!1,u=!1;const d=new Set,f=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:uw(10):e.type==="callback"?e.queueNotification:uw(e.timeout),p=()=>{u=!1,o&&(o=!1,d.forEach(h=>h()))};return Object.assign({},a,{subscribe(h){const v=()=>l&&h(),b=a.subscribe(v);return d.add(h),()=>{b(),d.delete(h)}},dispatch(h){try{return l=!h?.meta?.[Qz],o=!l,o&&(u||(u=!0,f(p))),a.dispatch(h)}finally{l=!0}}})},V4=e=>function(n){const{autoBatch:a=!0}=n??{};let l=new Vz(e);return a&&l.push(Yz(typeof a=="object"?a:void 0)),l};function Q4(e){const r=H4(),{reducer:n=void 0,middleware:a,devTools:l=!0,preloadedState:o=void 0,enhancers:u=void 0}=e||{};let d;if(typeof n=="function")d=n;else if(iy(n))d=Pz(n);else throw new Error(vn(1));let f;typeof a=="function"?f=a(r):f=r();let p=Am;l&&(p=F4({trace:!1,...typeof l=="object"&&l}));const h=C4(...f),v=V4(h);let b=typeof u=="function"?u(v):v();const x=p(...b);return Dz(d,o,x)}function Kz(e){const r={},n=[];let a;const l={addCase(o,u){const d=typeof o=="string"?o:o.type;if(!d)throw new Error(vn(28));if(d in r)throw new Error(vn(29));return r[d]=u,l},addAsyncThunk(o,u){return u.pending&&(r[o.pending.type]=u.pending),u.rejected&&(r[o.rejected.type]=u.rejected),u.fulfilled&&(r[o.fulfilled.type]=u.fulfilled),u.settled&&n.push({matcher:o.settled,reducer:u.settled}),l},addMatcher(o,u){return n.push({matcher:o,reducer:u}),l},addDefaultCase(o){return a=o,l}};return e(l),[r,n,a]}function Y4(e){return typeof e=="function"}function K4(e,r){let[n,a,l]=Kz(r),o;if(Y4(e))o=()=>cw(e());else{const d=cw(e);o=()=>d}function u(d=o(),f){let p=[n[f.type],...a.filter(({matcher:h})=>h(f)).map(({reducer:h})=>h)];return p.filter(h=>!!h).length===0&&(p=[l]),p.reduce((h,v)=>{if(v)if(ti(h)){const x=v(h,f);return x===void 0?h:x}else{if(ra(h))return Gz(h,b=>v(b,f));{const b=v(h,f);if(b===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return b}}return h},d)}return u.getInitialState=o,u}var W4="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",X4=(e=21)=>{let r="",n=e;for(;n--;)r+=W4[Math.random()*64|0];return r},Z4=Symbol.for("rtk-slice-createasyncthunk");function J4(e,r){return`${e}/${r}`}function eL({creators:e}={}){const r=e?.asyncThunk?.[Z4];return function(a){const{name:l,reducerPath:o=l}=a;if(!l)throw new Error(vn(11));const u=(typeof a.reducers=="function"?a.reducers(rL()):a.reducers)||{},d=Object.keys(u),f={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},p={addCase(S,A){const O=typeof S=="string"?S:S.type;if(!O)throw new Error(vn(12));if(O in f.sliceCaseReducersByType)throw new Error(vn(13));return f.sliceCaseReducersByType[O]=A,p},addMatcher(S,A){return f.sliceMatchers.push({matcher:S,reducer:A}),p},exposeAction(S,A){return f.actionCreators[S]=A,p},exposeCaseReducer(S,A){return f.sliceCaseReducersByName[S]=A,p}};d.forEach(S=>{const A=u[S],O={reducerName:S,type:J4(l,S),createNotation:typeof a.reducers=="function"};aL(A)?sL(O,A,p,r):nL(O,A,p)});function h(){const[S={},A=[],O=void 0]=typeof a.extraReducers=="function"?Kz(a.extraReducers):[a.extraReducers],k={...S,...f.sliceCaseReducersByType};return K4(a.initialState,P=>{for(let D in k)P.addCase(D,k[D]);for(let D of f.sliceMatchers)P.addMatcher(D.matcher,D.reducer);for(let D of A)P.addMatcher(D.matcher,D.reducer);O&&P.addDefaultCase(O)})}const v=S=>S,b=new Map,x=new WeakMap;let j;function _(S,A){return j||(j=h()),j(S,A)}function C(){return j||(j=h()),j.getInitialState()}function w(S,A=!1){function O(P){let D=P[S];return typeof D>"u"&&A&&(D=Vd(x,O,C)),D}function k(P=v){const D=Vd(b,A,()=>new WeakMap);return Vd(D,P,()=>{const B={};for(const[U,$]of Object.entries(a.selectors??{}))B[U]=tL($,P,()=>Vd(x,P,C),A);return B})}return{reducerPath:S,getSelectors:k,get selectors(){return k(O)},selectSlice:O}}const E={name:l,reducer:_,actions:f.actionCreators,caseReducers:f.sliceCaseReducersByName,getInitialState:C,...w(o),injectInto(S,{reducerPath:A,...O}={}){const k=A??o;return S.inject({reducerPath:k,reducer:_},O),{...E,...w(k,!0)}}};return E}}function tL(e,r,n,a){function l(o,...u){let d=r(o);return typeof d>"u"&&a&&(d=n()),e(d,...u)}return l.unwrapped=e,l}var rn=eL();function rL(){function e(r,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:r,...n}}return e.withTypes=()=>e,{reducer(r){return Object.assign({[r.name](...n){return r(...n)}}[r.name],{_reducerDefinitionType:"reducer"})},preparedReducer(r,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:r,reducer:n}},asyncThunk:e}}function nL({type:e,reducerName:r,createNotation:n},a,l){let o,u;if("reducer"in a){if(n&&!iL(a))throw new Error(vn(17));o=a.reducer,u=a.prepare}else o=a;l.addCase(e,o).exposeCaseReducer(r,o).exposeAction(r,u?Rn(e,u):Rn(e))}function aL(e){return e._reducerDefinitionType==="asyncThunk"}function iL(e){return e._reducerDefinitionType==="reducerWithPrepare"}function sL({type:e,reducerName:r},n,a,l){if(!l)throw new Error(vn(18));const{payloadCreator:o,fulfilled:u,pending:d,rejected:f,settled:p,options:h}=n,v=l(e,o,h);a.exposeAction(r,v),u&&a.addCase(v.fulfilled,u),d&&a.addCase(v.pending,d),f&&a.addCase(v.rejected,f),p&&a.addMatcher(v.settled,p),a.exposeCaseReducer(r,{fulfilled:u||Qd,pending:d||Qd,rejected:f||Qd,settled:p||Qd})}function Qd(){}var lL="task",Wz="listener",Xz="completed",cy="cancelled",oL=`task-${cy}`,cL=`task-${Xz}`,Wx=`${Wz}-${cy}`,uL=`${Wz}-${Xz}`,Rf=class{constructor(e){this.code=e,this.message=`${lL} ${cy} (reason: ${e})`}name="TaskAbortError";message},uy=(e,r)=>{if(typeof e!="function")throw new TypeError(vn(32))},Tm=()=>{},Zz=(e,r=Tm)=>(e.catch(r),e),Jz=(e,r)=>(e.addEventListener("abort",r,{once:!0}),()=>e.removeEventListener("abort",r)),Us=e=>{if(e.aborted)throw new Rf(e.reason)};function ek(e,r){let n=Tm;return new Promise((a,l)=>{const o=()=>l(new Rf(e.reason));if(e.aborted){o();return}n=Jz(e,o),r.finally(()=>n()).then(a,l)}).finally(()=>{n=Tm})}var dL=async(e,r)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof Rf?"cancelled":"rejected",error:n}}finally{r?.()}},qm=e=>r=>Zz(ek(e,r).then(n=>(Us(e),n))),tk=e=>{const r=qm(e);return n=>r(new Promise(a=>setTimeout(a,n)))},{assign:oo}=Object,dw={},If="listenerMiddleware",mL=(e,r)=>{const n=a=>Jz(e,()=>a.abort(e.reason));return(a,l)=>{uy(a);const o=new AbortController;n(o);const u=dL(async()=>{Us(e),Us(o.signal);const d=await a({pause:qm(o.signal),delay:tk(o.signal),signal:o.signal});return Us(o.signal),d},()=>o.abort(cL));return l?.autoJoin&&r.push(u.catch(Tm)),{result:qm(e)(u),cancel(){o.abort(oL)}}}},fL=(e,r)=>{const n=async(a,l)=>{Us(r);let o=()=>{};const d=[new Promise((f,p)=>{let h=e({predicate:a,effect:(v,b)=>{b.unsubscribe(),f([v,b.getState(),b.getOriginalState()])}});o=()=>{h(),p()}})];l!=null&&d.push(new Promise(f=>setTimeout(f,l,null)));try{const f=await ek(r,Promise.race(d));return Us(r),f}finally{o()}};return(a,l)=>Zz(n(a,l))},rk=e=>{let{type:r,actionCreator:n,matcher:a,predicate:l,effect:o}=e;if(r)l=Rn(r).match;else if(n)r=n.type,l=n.match;else if(a)l=a;else if(!l)throw new Error(vn(21));return uy(o),{predicate:l,type:r,effect:o}},nk=oo(e=>{const{type:r,predicate:n,effect:a}=rk(e);return{id:X4(),effect:a,type:r,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(vn(22))}}},{withTypes:()=>nk}),mw=(e,r)=>{const{type:n,effect:a,predicate:l}=rk(r);return Array.from(e.values()).find(o=>(typeof n=="string"?o.type===n:o.predicate===l)&&o.effect===a)},Xx=e=>{e.pending.forEach(r=>{r.abort(Wx)})},pL=(e,r)=>()=>{for(const n of r.keys())Xx(n);e.clear()},fw=(e,r,n)=>{try{e(r,n)}catch(a){setTimeout(()=>{throw a},0)}},ak=oo(Rn(`${If}/add`),{withTypes:()=>ak}),hL=Rn(`${If}/removeAll`),ik=oo(Rn(`${If}/remove`),{withTypes:()=>ik}),vL=(...e)=>{console.error(`${If}/error`,...e)},mu=(e={})=>{const r=new Map,n=new Map,a=x=>{const j=n.get(x)??0;n.set(x,j+1)},l=x=>{const j=n.get(x)??1;j===1?n.delete(x):n.set(x,j-1)},{extra:o,onError:u=vL}=e;uy(u);const d=x=>(x.unsubscribe=()=>r.delete(x.id),r.set(x.id,x),j=>{x.unsubscribe(),j?.cancelActive&&Xx(x)}),f=x=>{const j=mw(r,x)??nk(x);return d(j)};oo(f,{withTypes:()=>f});const p=x=>{const j=mw(r,x);return j&&(j.unsubscribe(),x.cancelActive&&Xx(j)),!!j};oo(p,{withTypes:()=>p});const h=async(x,j,_,C)=>{const w=new AbortController,E=fL(f,w.signal),S=[];try{x.pending.add(w),a(x),await Promise.resolve(x.effect(j,oo({},_,{getOriginalState:C,condition:(A,O)=>E(A,O).then(Boolean),take:E,delay:tk(w.signal),pause:qm(w.signal),extra:o,signal:w.signal,fork:mL(w.signal,S),unsubscribe:x.unsubscribe,subscribe:()=>{r.set(x.id,x)},cancelActiveListeners:()=>{x.pending.forEach((A,O,k)=>{A!==w&&(A.abort(Wx),k.delete(A))})},cancel:()=>{w.abort(Wx),x.pending.delete(w)},throwIfCancelled:()=>{Us(w.signal)}})))}catch(A){A instanceof Rf||fw(u,A,{raisedBy:"effect"})}finally{await Promise.all(S),w.abort(uL),l(x),x.pending.delete(w)}},v=pL(r,n);return{middleware:x=>j=>_=>{if(!Mz(_))return j(_);if(ak.match(_))return f(_.payload);if(hL.match(_)){v();return}if(ik.match(_))return p(_.payload);let C=x.getState();const w=()=>{if(C===dw)throw new Error(vn(23));return C};let E;try{if(E=j(_),r.size>0){const S=x.getState(),A=Array.from(r.values());for(const O of A){let k=!1;try{k=O.predicate(_,S,C)}catch(P){k=!1,fw(u,P,{raisedBy:"predicate"})}k&&h(O,_,x,w)}}}finally{C=dw}return E},startListening:f,stopListening:p,clearListeners:v}};function vn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var gL={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},sk=rn({name:"chartLayout",initialState:gL,reducers:{setLayout(e,r){e.layoutType=r.payload},setChartSize(e,r){e.width=r.payload.width,e.height=r.payload.height},setMargin(e,r){var n,a,l,o;e.margin.top=(n=r.payload.top)!==null&&n!==void 0?n:0,e.margin.right=(a=r.payload.right)!==null&&a!==void 0?a:0,e.margin.bottom=(l=r.payload.bottom)!==null&&l!==void 0?l:0,e.margin.left=(o=r.payload.left)!==null&&o!==void 0?o:0},setScale(e,r){e.scale=r.payload}}}),{setMargin:xL,setLayout:bL,setChartSize:yL,setScale:jL}=sk.actions,_L=sk.reducer;function lk(e,r,n){return Array.isArray(e)&&e&&r+n!==0?e.slice(r,n+1):e}function ot(e){return Number.isFinite(e)}function _a(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function pw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function io(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?pw(Object(n),!0).forEach(function(a){NL(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function NL(e,r,n){return(r=SL(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function SL(e){var r=wL(e,"string");return typeof r=="symbol"?r:r+""}function wL(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function tr(e,r,n){return Rt(e)||Rt(r)?n:ja(r)?fo(e,r,n):typeof r=="function"?r(e):n}var CL=(e,r,n)=>{if(r&&n){var{width:a,height:l}=n,{align:o,verticalAlign:u,layout:d}=r;if((d==="vertical"||d==="horizontal"&&u==="middle")&&o!=="center"&&De(e[o]))return io(io({},e),{},{[o]:e[o]+(a||0)});if((d==="horizontal"||d==="vertical"&&o==="center")&&u!=="middle"&&De(e[u]))return io(io({},e),{},{[u]:e[u]+(l||0)})}return e},ci=(e,r)=>e==="horizontal"&&r==="xAxis"||e==="vertical"&&r==="yAxis"||e==="centric"&&r==="angleAxis"||e==="radial"&&r==="radiusAxis",ok=(e,r,n,a)=>{if(a)return e.map(d=>d.coordinate);var l,o,u=e.map(d=>(d.coordinate===r&&(l=!0),d.coordinate===n&&(o=!0),d.coordinate));return l||u.push(r),o||u.push(n),u},ck=(e,r,n)=>{if(!e)return null;var{duplicateDomain:a,type:l,range:o,scale:u,realScaleType:d,isCategorical:f,categoricalDomain:p,tickCount:h,ticks:v,niceTicks:b,axisType:x}=e;if(!u)return null;var j=d==="scaleBand"&&u.bandwidth?u.bandwidth()/2:2,_=l==="category"&&u.bandwidth?u.bandwidth()/j:0;if(_=x==="angleAxis"&&o&&o.length>=2?Jr(o[0]-o[1])*2*_:_,v||b){var C=(v||b||[]).map((w,E)=>{var S=a?a.indexOf(w):w,A=u.map(S);return ot(A)?{coordinate:A+_,value:w,offset:_,index:E}:null}).filter(en);return C}return f&&p?p.map((w,E)=>{var S=u.map(w);return ot(S)?{coordinate:S+_,value:w,index:E,offset:_}:null}).filter(en):u.ticks&&h!=null?u.ticks(h).map((w,E)=>{var S=u.map(w);return ot(S)?{coordinate:S+_,value:w,index:E,offset:_}:null}).filter(en):u.domain().map((w,E)=>{var S=u.map(w);return ot(S)?{coordinate:S+_,value:a?a[w]:w,index:E,offset:_}:null}).filter(en)},EL=(e,r)=>{if(!r||r.length!==2||!De(r[0])||!De(r[1]))return e;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),l=[e[0],e[1]];return(!De(e[0])||e[0]<n)&&(l[0]=n),(!De(e[1])||e[1]>a)&&(l[1]=a),l[0]>a&&(l[0]=a),l[1]<n&&(l[1]=n),l},AL=e=>{var r,n=e.length;if(!(n<=0)){var a=(r=e[0])===null||r===void 0?void 0:r.length;if(!(a==null||a<=0))for(var l=0;l<a;++l)for(var o=0,u=0,d=0;d<n;++d){var f=e[d],p=f?.[l];if(p!=null){var h=p[1],v=p[0],b=ya(h)?v:h;b>=0?(p[0]=o,o+=b,p[1]=o):(p[0]=u,u+=b,p[1]=u)}}}},zL=e=>{var r,n=e.length;if(!(n<=0)){var a=(r=e[0])===null||r===void 0?void 0:r.length;if(!(a==null||a<=0))for(var l=0;l<a;++l)for(var o=0,u=0;u<n;++u){var d=e[u],f=d?.[l];if(f!=null){var p=ya(f[1])?f[0]:f[1];p>=0?(f[0]=o,o+=p,f[1]=o):(f[0]=0,f[1]=0)}}}},kL={sign:AL,expand:aI,none:Hs,silhouette:iI,wiggle:sI,positive:zL},OL=(e,r,n)=>{var a,l=(a=kL[n])!==null&&a!==void 0?a:Hs,o=nI().keys(r).value((d,f)=>Number(tr(d,f,0))).order($x).offset(l),u=o(e);return u.forEach((d,f)=>{d.forEach((p,h)=>{var v=tr(e[h],r[f],0);Array.isArray(v)&&v.length===2&&De(v[0])&&De(v[1])&&(p[0]=v[0],p[1]=v[1])})}),u};function DL(e){return e==null?void 0:String(e)}function hw(e){var{axis:r,ticks:n,bandSize:a,entry:l,index:o,dataKey:u}=e;if(r.type==="category"){if(!r.allowDuplicatedCategory&&r.dataKey&&!Rt(l[r.dataKey])){var d=vz(n,"value",l[r.dataKey]);if(d)return d.coordinate+a/2}return n!=null&&n[o]?n[o].coordinate+a/2:null}var f=tr(l,Rt(u)?r.dataKey:u),p=r.scale.map(f);return De(p)?p:null}var vw=e=>{var{axis:r,ticks:n,offset:a,bandSize:l,entry:o,index:u}=e;if(r.type==="category")return n[u]?n[u].coordinate+a:null;var d=tr(o,r.dataKey,r.scale.domain()[u]);if(Rt(d))return null;var f=r.scale.map(d);return De(f)?f-l/2+a:null},PL=e=>{var{numericAxis:r}=e,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),l=Math.max(n[0],n[1]);return a<=0&&l>=0?0:l<0?l:a}return n[0]},ML=e=>{var r=e.flat(2).filter(De);return[Math.min(...r),Math.max(...r)]},TL=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],qL=(e,r,n)=>{if(e!=null)return TL(Object.keys(e).reduce((a,l)=>{var o=e[l];if(!o)return a;var{stackedData:u}=o,d=u.reduce((f,p)=>{var h=lk(p,r,n),v=ML(h);return!ot(v[0])||!ot(v[1])?f:[Math.min(f[0],v[0]),Math.max(f[1],v[1])]},[1/0,-1/0]);return[Math.min(d[0],a[0]),Math.max(d[1],a[1])]},[1/0,-1/0]))},gw=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,xw=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,ho=(e,r,n)=>{if(e&&e.scale&&e.scale.bandwidth){var a=e.scale.bandwidth();if(!n||a>0)return a}if(e&&r&&r.length>=2){for(var l=zf(r,h=>h.coordinate),o=1/0,u=1,d=l.length;u<d;u++){var f=l[u],p=l[u-1];o=Math.min((f?.coordinate||0)-(p?.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0};function bw(e){var{tooltipEntrySettings:r,dataKey:n,payload:a,value:l,name:o}=e;return io(io({},r),{},{dataKey:n,payload:a,value:l,name:o})}function Lf(e,r){if(e)return String(e);if(typeof r=="string")return r}var RL=(e,r)=>{if(r==="horizontal")return e.chartX;if(r==="vertical")return e.chartY},IL=(e,r)=>r==="centric"?e.angle:e.radius,ui=e=>e.layout.width,di=e=>e.layout.height,LL=e=>e.layout.scale,uk=e=>e.layout.margin,$f=de(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Bf=de(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),$L="data-recharts-item-index",BL="data-recharts-item-id",fu=60;function yw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Yd(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?yw(Object(n),!0).forEach(function(a){UL(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function UL(e,r,n){return(r=FL(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function FL(e){var r=GL(e,"string");return typeof r=="symbol"?r:r+""}function GL(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var HL=e=>e.brush.height;function VL(e){var r=Bf(e);return r.reduce((n,a)=>{if(a.orientation==="left"&&!a.mirror&&!a.hide){var l=typeof a.width=="number"?a.width:fu;return n+l}return n},0)}function QL(e){var r=Bf(e);return r.reduce((n,a)=>{if(a.orientation==="right"&&!a.mirror&&!a.hide){var l=typeof a.width=="number"?a.width:fu;return n+l}return n},0)}function YL(e){var r=$f(e);return r.reduce((n,a)=>a.orientation==="top"&&!a.mirror&&!a.hide?n+a.height:n,0)}function KL(e){var r=$f(e);return r.reduce((n,a)=>a.orientation==="bottom"&&!a.mirror&&!a.hide?n+a.height:n,0)}var gr=de([ui,di,uk,HL,VL,QL,YL,KL,Oz,y4],(e,r,n,a,l,o,u,d,f,p)=>{var h={left:(n.left||0)+l,right:(n.right||0)+o},v={top:(n.top||0)+u,bottom:(n.bottom||0)+d},b=Yd(Yd({},v),h),x=b.bottom;b.bottom+=a,b=CL(b,f,p);var j=e-b.left-b.right,_=r-b.top-b.bottom;return Yd(Yd({brushBottom:x},b),{},{width:Math.max(j,0),height:Math.max(_,0)})}),WL=de(gr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),dy=de(ui,di,(e,r)=>({x:0,y:0,width:e,height:r})),XL=g.createContext(null),Pr=()=>g.useContext(XL)!=null,Uf=e=>e.brush,Ff=de([Uf,gr,uk],(e,r,n)=>({height:e.height,x:De(e.x)?e.x:r.left,y:De(e.y)?e.y:r.top+r.height+r.brushBottom-(n?.bottom||0),width:De(e.width)?e.width:r.width})),Hg={},Vg={},Qg={},jw;function ZL(){return jw||(jw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n,a,{signal:l,edges:o}={}){let u,d=null;const f=o!=null&&o.includes("leading"),p=o==null||o.includes("trailing"),h=()=>{d!==null&&(n.apply(u,d),u=void 0,d=null)},v=()=>{p&&h(),_()};let b=null;const x=()=>{b!=null&&clearTimeout(b),b=setTimeout(()=>{b=null,v()},a)},j=()=>{b!==null&&(clearTimeout(b),b=null)},_=()=>{j(),u=void 0,d=null},C=()=>{h()},w=function(...E){if(l?.aborted)return;u=this,d=E;const S=b==null;x(),f&&S&&h()};return w.schedule=x,w.cancel=_,w.flush=C,l?.addEventListener("abort",_,{once:!0}),w}e.debounce=r})(Qg)),Qg}var _w;function JL(){return _w||(_w=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=ZL();function n(a,l=0,o={}){typeof o!="object"&&(o={});const{leading:u=!1,trailing:d=!0,maxWait:f}=o,p=Array(2);u&&(p[0]="leading"),d&&(p[1]="trailing");let h,v=null;const b=r.debounce(function(..._){h=a.apply(this,_),v=null},l,{edges:p}),x=function(..._){return f!=null&&(v===null&&(v=Date.now()),Date.now()-v>=f)?(h=a.apply(this,_),v=Date.now(),b.cancel(),b.schedule(),h):(b.apply(this,_),h)},j=()=>(b.flush(),h);return x.cancel=b.cancel,x.flush=j,x}e.debounce=n})(Vg)),Vg}var Nw;function e8(){return Nw||(Nw=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=JL();function n(a,l=0,o={}){const{leading:u=!0,trailing:d=!0}=o;return r.debounce(a,l,{leading:u,maxWait:l,trailing:d})}e.throttle=n})(Hg)),Hg}var Yg,Sw;function t8(){return Sw||(Sw=1,Yg=e8().throttle),Yg}var r8=t8();const n8=oi(r8);var Rm=function(r,n){for(var a=arguments.length,l=new Array(a>2?a-2:0),o=2;o<a;o++)l[o-2]=arguments[o];if(typeof console<"u"&&console.warn&&(n===void 0&&console.warn("LogUtils requires an error message argument"),!r))if(n===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=0;console.warn(n.replace(/%s/g,()=>l[u++]))}},ha={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},dk=(e,r,n)=>{var{width:a=ha.width,height:l=ha.height,aspect:o,maxHeight:u}=n,d=Vs(a)?e:Number(a),f=Vs(l)?r:Number(l);return o&&o>0&&(d?f=d/o:f&&(d=f*o),u&&f!=null&&f>u&&(f=u)),{calculatedWidth:d,calculatedHeight:f}},a8={width:0,height:0,overflow:"visible"},i8={width:0,overflowX:"visible"},s8={height:0,overflowY:"visible"},l8={},o8=e=>{var{width:r,height:n}=e,a=Vs(r),l=Vs(n);return a&&l?a8:a?i8:l?s8:l8};function c8(e){var{width:r,height:n,aspect:a}=e,l=r,o=n;return l===void 0&&o===void 0?(l=ha.width,o=ha.height):l===void 0?l=a&&a>0?void 0:ha.width:o===void 0&&(o=a&&a>0?void 0:ha.height),{width:l,height:o}}function Zx(){return Zx=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Zx.apply(null,arguments)}function ww(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Cw(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?ww(Object(n),!0).forEach(function(a){u8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ww(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function u8(e,r,n){return(r=d8(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function d8(e){var r=m8(e,"string");return typeof r=="symbol"?r:r+""}function m8(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var mk=g.createContext(ha.initialDimension);function f8(e){return _a(e.width)&&_a(e.height)}function fk(e){var{children:r,width:n,height:a}=e,l=g.useMemo(()=>({width:n,height:a}),[n,a]);return f8(l)?g.createElement(mk.Provider,{value:l},r):null}var my=()=>g.useContext(mk),p8=g.forwardRef((e,r)=>{var{aspect:n,initialDimension:a=ha.initialDimension,width:l,height:o,minWidth:u=ha.minWidth,minHeight:d,maxHeight:f,children:p,debounce:h=ha.debounce,id:v,className:b,onResize:x,style:j={}}=e,_=g.useRef(null),C=g.useRef();C.current=x,g.useImperativeHandle(r,()=>_.current);var[w,E]=g.useState({containerWidth:a.width,containerHeight:a.height}),S=g.useCallback((D,B)=>{E(U=>{var $=Math.round(D),R=Math.round(B);return U.containerWidth===$&&U.containerHeight===R?U:{containerWidth:$,containerHeight:R}})},[]);g.useEffect(()=>{if(_.current==null||typeof ResizeObserver>"u")return rl;var D=R=>{var Y,ae=R[0];if(ae!=null){var{width:M,height:T}=ae.contentRect;S(M,T),(Y=C.current)===null||Y===void 0||Y.call(C,M,T)}};h>0&&(D=n8(D,h,{trailing:!0,leading:!1}));var B=new ResizeObserver(D),{width:U,height:$}=_.current.getBoundingClientRect();return S(U,$),B.observe(_.current),()=>{B.disconnect()}},[S,h]);var{containerWidth:A,containerHeight:O}=w;Rm(!n||n>0,"The aspect(%s) must be greater than zero.",n);var{calculatedWidth:k,calculatedHeight:P}=dk(A,O,{width:l,height:o,aspect:n,maxHeight:f});return Rm(k!=null&&k>0||P!=null&&P>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,k,P,l,o,u,d,n),g.createElement("div",{id:v?"".concat(v):void 0,className:St("recharts-responsive-container",b),style:Cw(Cw({},j),{},{width:l,height:o,minWidth:u,minHeight:d,maxHeight:f}),ref:_},g.createElement("div",{style:o8({width:l,height:o})},g.createElement(fk,{width:k,height:P},p)))}),Ew=g.forwardRef((e,r)=>{var n=my();if(_a(n.width)&&_a(n.height))return e.children;var{width:a,height:l}=c8({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:o,calculatedHeight:u}=dk(void 0,void 0,{width:a,height:l,aspect:e.aspect,maxHeight:e.maxHeight});return De(o)&&De(u)?g.createElement(fk,{width:o,height:u},e.children):g.createElement(p8,Zx({},e,{width:a,height:l,ref:r}))});function fy(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var Gf=()=>{var e,r=Pr(),n=$e(WL),a=$e(Ff),l=(e=$e(Uf))===null||e===void 0?void 0:e.padding;return!r||!a||!l?n:{width:a.width-l.left-l.right,height:a.height-l.top-l.bottom,x:l.left,y:l.top}},h8={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},pk=()=>{var e;return(e=$e(gr))!==null&&e!==void 0?e:h8},hk=()=>$e(ui),vk=()=>$e(di),bt=e=>e.layout.layoutType,nl=()=>$e(bt),gk=()=>{var e=nl();if(e==="horizontal"||e==="vertical")return e},xk=e=>{var r=e.layout.layoutType;if(r==="centric"||r==="radial")return r},v8=()=>{var e=nl();return e!==void 0},pu=e=>{var r=Yt(),n=Pr(),{width:a,height:l}=e,o=my(),u=a,d=l;return o&&(u=o.width>0?o.width:a,d=o.height>0?o.height:l),g.useEffect(()=>{!n&&_a(u)&&_a(d)&&r(yL({width:u,height:d}))},[r,n,u,d]),null},bk=Symbol.for("immer-nothing"),Aw=Symbol.for("immer-draftable"),gn=Symbol.for("immer-state");function Xn(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Qc=Object.getPrototypeOf;function vo(e){return!!e&&!!e[gn]}function Ys(e){return e?yk(e)||Array.isArray(e)||!!e[Aw]||!!e.constructor?.[Aw]||hu(e)||Vf(e):!1}var g8=Object.prototype.constructor.toString(),zw=new WeakMap;function yk(e){if(!e||typeof e!="object")return!1;const r=Object.getPrototypeOf(e);if(r===null||r===Object.prototype)return!0;const n=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let a=zw.get(n);return a===void 0&&(a=Function.toString.call(n),zw.set(n,a)),a===g8}function Im(e,r,n=!0){Hf(e)===0?(n?Reflect.ownKeys(e):Object.keys(e)).forEach(l=>{r(l,e[l],e)}):e.forEach((a,l)=>r(l,a,e))}function Hf(e){const r=e[gn];return r?r.type_:Array.isArray(e)?1:hu(e)?2:Vf(e)?3:0}function Jx(e,r){return Hf(e)===2?e.has(r):Object.prototype.hasOwnProperty.call(e,r)}function jk(e,r,n){const a=Hf(e);a===2?e.set(r,n):a===3?e.add(n):e[r]=n}function x8(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}function hu(e){return e instanceof Map}function Vf(e){return e instanceof Set}function Ds(e){return e.copy_||e.base_}function eb(e,r){if(hu(e))return new Map(e);if(Vf(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=yk(e);if(r===!0||r==="class_only"&&!n){const a=Object.getOwnPropertyDescriptors(e);delete a[gn];let l=Reflect.ownKeys(a);for(let o=0;o<l.length;o++){const u=l[o],d=a[u];d.writable===!1&&(d.writable=!0,d.configurable=!0),(d.get||d.set)&&(a[u]={configurable:!0,writable:!0,enumerable:d.enumerable,value:e[u]})}return Object.create(Qc(e),a)}else{const a=Qc(e);if(a!==null&&n)return{...e};const l=Object.create(a);return Object.assign(l,e)}}function py(e,r=!1){return Qf(e)||vo(e)||!Ys(e)||(Hf(e)>1&&Object.defineProperties(e,{set:Kd,add:Kd,clear:Kd,delete:Kd}),Object.freeze(e),r&&Object.values(e).forEach(n=>py(n,!0))),e}function b8(){Xn(2)}var Kd={value:b8};function Qf(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var y8={};function Ks(e){const r=y8[e];return r||Xn(0,e),r}var Yc;function _k(){return Yc}function j8(e,r){return{drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function kw(e,r){r&&(Ks("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function tb(e){rb(e),e.drafts_.forEach(_8),e.drafts_=null}function rb(e){e===Yc&&(Yc=e.parent_)}function Ow(e){return Yc=j8(Yc,e)}function _8(e){const r=e[gn];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function Dw(e,r){r.unfinalizedDrafts_=r.drafts_.length;const n=r.drafts_[0];return e!==void 0&&e!==n?(n[gn].modified_&&(tb(r),Xn(4)),Ys(e)&&(e=Lm(r,e),r.parent_||$m(r,e)),r.patches_&&Ks("Patches").generateReplacementPatches_(n[gn].base_,e,r.patches_,r.inversePatches_)):e=Lm(r,n,[]),tb(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==bk?e:void 0}function Lm(e,r,n){if(Qf(r))return r;const a=e.immer_.shouldUseStrictIteration(),l=r[gn];if(!l)return Im(r,(o,u)=>Pw(e,l,r,o,u,n),a),r;if(l.scope_!==e)return r;if(!l.modified_)return $m(e,l.base_,!0),l.base_;if(!l.finalized_){l.finalized_=!0,l.scope_.unfinalizedDrafts_--;const o=l.copy_;let u=o,d=!1;l.type_===3&&(u=new Set(o),o.clear(),d=!0),Im(u,(f,p)=>Pw(e,l,o,f,p,n,d),a),$m(e,o,!1),n&&e.patches_&&Ks("Patches").generatePatches_(l,n,e.patches_,e.inversePatches_)}return l.copy_}function Pw(e,r,n,a,l,o,u){if(l==null||typeof l!="object"&&!u)return;const d=Qf(l);if(!(d&&!u)){if(vo(l)){const f=o&&r&&r.type_!==3&&!Jx(r.assigned_,a)?o.concat(a):void 0,p=Lm(e,l,f);if(jk(n,a,p),vo(p))e.canAutoFreeze_=!1;else return}else u&&n.add(l);if(Ys(l)&&!d){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||r&&r.base_&&r.base_[a]===l&&d)return;Lm(e,l),(!r||!r.scope_.parent_)&&typeof a!="symbol"&&(hu(n)?n.has(a):Object.prototype.propertyIsEnumerable.call(n,a))&&$m(e,l)}}}function $m(e,r,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&py(r,n)}function N8(e,r){const n=Array.isArray(e),a={type_:n?1:0,scope_:r?r.scope_:_k(),modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let l=a,o=hy;n&&(l=[a],o=Kc);const{revoke:u,proxy:d}=Proxy.revocable(l,o);return a.draft_=d,a.revoke_=u,d}var hy={get(e,r){if(r===gn)return e;const n=Ds(e);if(!Jx(n,r))return S8(e,n,r);const a=n[r];return e.finalized_||!Ys(a)?a:a===Kg(e.base_,r)?(Wg(e),e.copy_[r]=ab(a,e)):a},has(e,r){return r in Ds(e)},ownKeys(e){return Reflect.ownKeys(Ds(e))},set(e,r,n){const a=Nk(Ds(e),r);if(a?.set)return a.set.call(e.draft_,n),!0;if(!e.modified_){const l=Kg(Ds(e),r),o=l?.[gn];if(o&&o.base_===n)return e.copy_[r]=n,e.assigned_[r]=!1,!0;if(x8(n,l)&&(n!==void 0||Jx(e.base_,r)))return!0;Wg(e),nb(e)}return e.copy_[r]===n&&(n!==void 0||r in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=n,e.assigned_[r]=!0),!0},deleteProperty(e,r){return Kg(e.base_,r)!==void 0||r in e.base_?(e.assigned_[r]=!1,Wg(e),nb(e)):delete e.assigned_[r],e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const n=Ds(e),a=Reflect.getOwnPropertyDescriptor(n,r);return a&&{writable:!0,configurable:e.type_!==1||r!=="length",enumerable:a.enumerable,value:n[r]}},defineProperty(){Xn(11)},getPrototypeOf(e){return Qc(e.base_)},setPrototypeOf(){Xn(12)}},Kc={};Im(hy,(e,r)=>{Kc[e]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});Kc.deleteProperty=function(e,r){return Kc.set.call(this,e,r,void 0)};Kc.set=function(e,r,n){return hy.set.call(this,e[0],r,n,e[0])};function Kg(e,r){const n=e[gn];return(n?Ds(n):e)[r]}function S8(e,r,n){const a=Nk(r,n);return a?"value"in a?a.value:a.get?.call(e.draft_):void 0}function Nk(e,r){if(!(r in e))return;let n=Qc(e);for(;n;){const a=Object.getOwnPropertyDescriptor(n,r);if(a)return a;n=Qc(n)}}function nb(e){e.modified_||(e.modified_=!0,e.parent_&&nb(e.parent_))}function Wg(e){e.copy_||(e.copy_=eb(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var w8=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(r,n,a)=>{if(typeof r=="function"&&typeof n!="function"){const o=n;n=r;const u=this;return function(f=o,...p){return u.produce(f,h=>n.call(this,h,...p))}}typeof n!="function"&&Xn(6),a!==void 0&&typeof a!="function"&&Xn(7);let l;if(Ys(r)){const o=Ow(this),u=ab(r,void 0);let d=!0;try{l=n(u),d=!1}finally{d?tb(o):rb(o)}return kw(o,a),Dw(l,o)}else if(!r||typeof r!="object"){if(l=n(r),l===void 0&&(l=r),l===bk&&(l=void 0),this.autoFreeze_&&py(l,!0),a){const o=[],u=[];Ks("Patches").generateReplacementPatches_(r,l,o,u),a(o,u)}return l}else Xn(1,r)},this.produceWithPatches=(r,n)=>{if(typeof r=="function")return(u,...d)=>this.produceWithPatches(u,f=>r(f,...d));let a,l;return[this.produce(r,n,(u,d)=>{a=u,l=d}),a,l]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Ys(e)||Xn(8),vo(e)&&(e=C8(e));const r=Ow(this),n=ab(e,void 0);return n[gn].isManual_=!0,rb(r),n}finishDraft(e,r){const n=e&&e[gn];(!n||!n.isManual_)&&Xn(9);const{scope_:a}=n;return kw(a,r),Dw(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){const l=r[n];if(l.path.length===0&&l.op==="replace"){e=l.value;break}}n>-1&&(r=r.slice(n+1));const a=Ks("Patches").applyPatches_;return vo(e)?a(e,r):this.produce(e,l=>a(l,r))}};function ab(e,r){const n=hu(e)?Ks("MapSet").proxyMap_(e,r):Vf(e)?Ks("MapSet").proxySet_(e,r):N8(e,r);return(r?r.scope_:_k()).drafts_.push(n),n}function C8(e){return vo(e)||Xn(10,e),Sk(e)}function Sk(e){if(!Ys(e)||Qf(e))return e;const r=e[gn];let n,a=!0;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,n=eb(e,r.scope_.immer_.useStrictShallowCopy_),a=r.scope_.immer_.shouldUseStrictIteration()}else n=eb(e,!0);return Im(n,(l,o)=>{jk(n,l,Sk(o))},a),r&&(r.finalized_=!1),n}var E8=new w8;E8.produce;var A8={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},wk=rn({name:"legend",initialState:A8,reducers:{setLegendSize(e,r){e.size.width=r.payload.width,e.size.height=r.payload.height},setLegendSettings(e,r){e.settings.align=r.payload.align,e.settings.layout=r.payload.layout,e.settings.verticalAlign=r.payload.verticalAlign,e.settings.itemSorter=r.payload.itemSorter},addLegendPayload:{reducer(e,r){e.payload.push(r.payload)},prepare:Tt()},replaceLegendPayload:{reducer(e,r){var{prev:n,next:a}=r.payload,l=Jn(e).payload.indexOf(n);l>-1&&(e.payload[l]=a)},prepare:Tt()},removeLegendPayload:{reducer(e,r){var n=Jn(e).payload.indexOf(r.payload);n>-1&&e.payload.splice(n,1)},prepare:Tt()}}}),{setLegendSize:Rte,setLegendSettings:Ite,addLegendPayload:z8,replaceLegendPayload:k8,removeLegendPayload:O8}=wk.actions,D8=wk.reducer;function ib(){return ib=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ib.apply(null,arguments)}function Mw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function jc(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Mw(Object(n),!0).forEach(function(a){P8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function P8(e,r,n){return(r=M8(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function M8(e){var r=T8(e,"string");return typeof r=="symbol"?r:r+""}function T8(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function q8(e){return Array.isArray(e)&&ja(e[0])&&ja(e[1])?e.join(" ~ "):e}var Xl={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},R8=e=>{var{separator:r=Xl.separator,contentStyle:n,itemStyle:a,labelStyle:l=Xl.labelStyle,payload:o,formatter:u,itemSorter:d,wrapperClassName:f,labelClassName:p,label:h,labelFormatter:v,accessibilityLayer:b=Xl.accessibilityLayer}=e,x=()=>{if(o&&o.length){var O={padding:0,margin:0},k=(d?zf(o,d):o).map((P,D)=>{if(P.type==="none")return null;var B=P.formatter||u||q8,{value:U,name:$}=P,R=U,Y=$;if(B){var ae=B(U,$,P,D,o);if(Array.isArray(ae))[R,Y]=ae;else if(ae!=null)R=ae;else return null}var M=jc(jc({},Xl.itemStyle),{},{color:P.color||Xl.itemStyle.color},a);return g.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(D),style:M},ja(Y)?g.createElement("span",{className:"recharts-tooltip-item-name"},Y):null,ja(Y)?g.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,g.createElement("span",{className:"recharts-tooltip-item-value"},R),g.createElement("span",{className:"recharts-tooltip-item-unit"},P.unit||""))});return g.createElement("ul",{className:"recharts-tooltip-item-list",style:O},k)}return null},j=jc(jc({},Xl.contentStyle),n),_=jc({margin:0},l),C=!Rt(h),w=C?h:"",E=St("recharts-default-tooltip",f),S=St("recharts-tooltip-label",p);C&&v&&o!==void 0&&o!==null&&(w=v(h,o));var A=b?{role:"status","aria-live":"assertive"}:{};return g.createElement("div",ib({className:E,style:j},A),g.createElement("p",{className:S,style:_},g.isValidElement(w)?w:"".concat(w)),x())},_c="recharts-tooltip-wrapper",I8={visibility:"hidden"};function L8(e){var{coordinate:r,translateX:n,translateY:a}=e;return St(_c,{["".concat(_c,"-right")]:De(n)&&r&&De(r.x)&&n>=r.x,["".concat(_c,"-left")]:De(n)&&r&&De(r.x)&&n<r.x,["".concat(_c,"-bottom")]:De(a)&&r&&De(r.y)&&a>=r.y,["".concat(_c,"-top")]:De(a)&&r&&De(r.y)&&a<r.y})}function Tw(e){var{allowEscapeViewBox:r,coordinate:n,key:a,offset:l,position:o,reverseDirection:u,tooltipDimension:d,viewBox:f,viewBoxDimension:p}=e;if(o&&De(o[a]))return o[a];var h=n[a]-d-(l>0?l:0),v=n[a]+l;if(r[a])return u[a]?h:v;var b=f[a];if(b==null)return 0;if(u[a]){var x=h,j=b;return x<j?Math.max(v,b):Math.max(h,b)}if(p==null)return 0;var _=v+d,C=b+p;return _>C?Math.max(h,b):Math.max(v,b)}function $8(e){var{translateX:r,translateY:n,useTranslate3d:a}=e;return{transform:a?"translate3d(".concat(r,"px, ").concat(n,"px, 0)"):"translate(".concat(r,"px, ").concat(n,"px)")}}function B8(e){var{allowEscapeViewBox:r,coordinate:n,offsetTop:a,offsetLeft:l,position:o,reverseDirection:u,tooltipBox:d,useTranslate3d:f,viewBox:p}=e,h,v,b;return d.height>0&&d.width>0&&n?(v=Tw({allowEscapeViewBox:r,coordinate:n,key:"x",offset:l,position:o,reverseDirection:u,tooltipDimension:d.width,viewBox:p,viewBoxDimension:p.width}),b=Tw({allowEscapeViewBox:r,coordinate:n,key:"y",offset:a,position:o,reverseDirection:u,tooltipDimension:d.height,viewBox:p,viewBoxDimension:p.height}),h=$8({translateX:v,translateY:b,useTranslate3d:f})):h=I8,{cssProperties:h,cssClasses:L8({translateX:v,translateY:b,coordinate:n})}}function qw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Wd(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?qw(Object(n),!0).forEach(function(a){sb(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function sb(e,r,n){return(r=U8(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function U8(e){var r=F8(e,"string");return typeof r=="symbol"?r:r+""}function F8(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}class G8 extends g.PureComponent{constructor(){super(...arguments),sb(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),sb(this,"handleKeyDown",r=>{if(r.key==="Escape"){var n,a,l,o;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==null&&n!==void 0?n:0,y:(l=(o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==null&&l!==void 0?l:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var r,n;this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:l,children:o,coordinate:u,hasPayload:d,isAnimationActive:f,offset:p,position:h,reverseDirection:v,useTranslate3d:b,viewBox:x,wrapperStyle:j,lastBoundingBox:_,innerRef:C,hasPortalFromProps:w}=this.props,E=typeof p=="number"?p:p.x,S=typeof p=="number"?p:p.y,{cssClasses:A,cssProperties:O}=B8({allowEscapeViewBox:n,coordinate:u,offsetLeft:E,offsetTop:S,position:h,reverseDirection:v,tooltipBox:{height:_.height,width:_.width},useTranslate3d:b,viewBox:x}),k=w?{}:Wd(Wd({transition:f&&r?"transform ".concat(a,"ms ").concat(l):void 0},O),{},{pointerEvents:"none",visibility:!this.state.dismissed&&r&&d?"visible":"hidden",position:"absolute",top:0,left:0}),P=Wd(Wd({},k),{},{visibility:!this.state.dismissed&&r&&d?"visible":"hidden"},j);return g.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:A,style:P,ref:C},o)}}var Ck=()=>{var e;return(e=$e(r=>r.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function lb(){return lb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},lb.apply(null,arguments)}function Rw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Iw(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Rw(Object(n),!0).forEach(function(a){H8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function H8(e,r,n){return(r=V8(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function V8(e){var r=Q8(e,"string");return typeof r=="symbol"?r:r+""}function Q8(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Lw={curveBasisClosed:V6,curveBasisOpen:Q6,curveBasis:H6,curveBumpX:O6,curveBumpY:D6,curveLinearClosed:Y6,curveLinear:Ef,curveMonotoneX:K6,curveMonotoneY:W6,curveNatural:X6,curveStep:Z6,curveStepAfter:eI,curveStepBefore:J6},Bm=e=>ot(e.x)&&ot(e.y),$w=e=>e.base!=null&&Bm(e.base)&&Bm(e),Nc=e=>e.x,Sc=e=>e.y,Y8=(e,r)=>{if(typeof e=="function")return e;var n="curve".concat(uu(e));if((n==="curveMonotone"||n==="curveBump")&&r){var a=Lw["".concat(n).concat(r==="vertical"?"Y":"X")];if(a)return a}return Lw[n]||Ef},Bw={connectNulls:!1,type:"linear"},K8=e=>{var{type:r=Bw.type,points:n=[],baseLine:a,layout:l,connectNulls:o=Bw.connectNulls}=e,u=Y8(r,l),d=o?n.filter(Bm):n;if(Array.isArray(a)){var f,p=n.map((j,_)=>Iw(Iw({},j),{},{base:a[_]}));l==="vertical"?f=Ud().y(Sc).x1(Nc).x0(j=>j.base.x):f=Ud().x(Nc).y1(Sc).y0(j=>j.base.y);var h=f.defined($w).curve(u),v=o?p.filter($w):p;return h(v)}var b;l==="vertical"&&De(a)?b=Ud().y(Sc).x1(Nc).x0(a):De(a)?b=Ud().x(Nc).y1(Sc).y0(a):b=nz().x(Nc).y(Sc);var x=b.defined(Bm).curve(u);return x(d)},Ek=e=>{var{className:r,points:n,path:a,pathRef:l}=e,o=nl();if((!n||!n.length)&&!a)return null;var u={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||o,connectNulls:e.connectNulls},d=n&&n.length?K8(u):a;return g.createElement("path",lb({},ea(e),ey(e),{className:St("recharts-curve",r),d:d===null?void 0:d,ref:l}))},W8=["x","y","top","left","width","height","className"];function ob(){return ob=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ob.apply(null,arguments)}function Uw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function X8(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Uw(Object(n),!0).forEach(function(a){Z8(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Z8(e,r,n){return(r=J8(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function J8(e){var r=e$(e,"string");return typeof r=="symbol"?r:r+""}function e$(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function t$(e,r){if(e==null)return{};var n,a,l=r$(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function r$(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var n$=(e,r,n,a,l,o)=>"M".concat(e,",").concat(l,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(n),a$=e=>{var{x:r=0,y:n=0,top:a=0,left:l=0,width:o=0,height:u=0,className:d}=e,f=t$(e,W8),p=X8({x:r,y:n,top:a,left:l,width:o,height:u},f);return!De(r)||!De(n)||!De(o)||!De(u)||!De(a)||!De(l)?null:g.createElement("path",ob({},Lr(p),{className:St("recharts-cross",d),d:n$(r,n,o,u,a,l)}))};function i$(e,r,n,a){var l=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?r.x-l:n.left+.5,y:e==="horizontal"?n.top+.5:r.y-l,width:e==="horizontal"?a:n.width-1,height:e==="horizontal"?n.height-1:a}}function Fw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Gw(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Fw(Object(n),!0).forEach(function(a){s$(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function s$(e,r,n){return(r=l$(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function l$(e){var r=o$(e,"string");return typeof r=="symbol"?r:r+""}function o$(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var c$=e=>e.replace(/([A-Z])/g,r=>"-".concat(r.toLowerCase())),Ak=(e,r,n)=>e.map(a=>"".concat(c$(a)," ").concat(r,"ms ").concat(n)).join(","),u$=(e,r)=>[Object.keys(e),Object.keys(r)].reduce((n,a)=>n.filter(l=>a.includes(l))),Wc=(e,r)=>Object.keys(r).reduce((n,a)=>Gw(Gw({},n),{},{[a]:e(a,r[a])}),{});function Hw(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function ir(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Hw(Object(n),!0).forEach(function(a){d$(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hw(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function d$(e,r,n){return(r=m$(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function m$(e){var r=f$(e,"string");return typeof r=="symbol"?r:r+""}function f$(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Um=(e,r,n)=>e+(r-e)*n,cb=e=>{var{from:r,to:n}=e;return r!==n},zk=(e,r,n)=>{var a=Wc((l,o)=>{if(cb(o)){var[u,d]=e(o.from,o.to,o.velocity);return ir(ir({},o),{},{from:u,velocity:d})}return o},r);return n<1?Wc((l,o)=>cb(o)&&a[l]!=null?ir(ir({},o),{},{velocity:Um(o.velocity,a[l].velocity,n),from:Um(o.from,a[l].from,n)}):o,r):zk(e,a,n-1)};function p$(e,r,n,a,l,o){var u,d=a.reduce((b,x)=>ir(ir({},b),{},{[x]:{from:e[x],velocity:0,to:r[x]}}),{}),f=()=>Wc((b,x)=>x.from,d),p=()=>!Object.values(d).filter(cb).length,h=null,v=b=>{u||(u=b);var x=b-u,j=x/n.dt;d=zk(n,d,j),l(ir(ir(ir({},e),r),f())),u=b,p()||(h=o.setTimeout(v))};return()=>(h=o.setTimeout(v),()=>{var b;(b=h)===null||b===void 0||b()})}function h$(e,r,n,a,l,o,u){var d=null,f=l.reduce((v,b)=>{var x=e[b],j=r[b];return x==null||j==null?v:ir(ir({},v),{},{[b]:[x,j]})},{}),p,h=v=>{p||(p=v);var b=(v-p)/a,x=Wc((_,C)=>Um(...C,n(b)),f);if(o(ir(ir(ir({},e),r),x)),b<1)d=u.setTimeout(h);else{var j=Wc((_,C)=>Um(...C,n(1)),f);o(ir(ir(ir({},e),r),j))}};return()=>(d=u.setTimeout(h),()=>{var v;(v=d)===null||v===void 0||v()})}const v$=(e,r,n,a,l,o)=>{var u=u$(e,r);return n==null?()=>(l(ir(ir({},e),r)),()=>{}):n.isStepper===!0?p$(e,r,n,u,l,o):h$(e,r,n,a,u,l,o)};var Fm=1e-4,kk=(e,r)=>[0,3*e,3*r-6*e,3*e-3*r+1],Ok=(e,r)=>e.map((n,a)=>n*r**a).reduce((n,a)=>n+a),Vw=(e,r)=>n=>{var a=kk(e,r);return Ok(a,n)},g$=(e,r)=>n=>{var a=kk(e,r),l=[...a.map((o,u)=>o*u).slice(1),0];return Ok(l,n)},x$=e=>{var r,n=e.split("(");if(n.length!==2||n[0]!=="cubic-bezier")return null;var a=(r=n[1])===null||r===void 0||(r=r.split(")")[0])===null||r===void 0?void 0:r.split(",");if(a==null||a.length!==4)return null;var l=a.map(o=>parseFloat(o));return[l[0],l[1],l[2],l[3]]},b$=function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];if(n.length===1)switch(n[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var l=x$(n[0]);if(l)return l}}return n.length===4?n:[0,0,1,1]},y$=(e,r,n,a)=>{var l=Vw(e,n),o=Vw(r,a),u=g$(e,n),d=p=>p>1?1:p<0?0:p,f=p=>{for(var h=p>1?1:p,v=h,b=0;b<8;++b){var x=l(v)-h,j=u(v);if(Math.abs(x-h)<Fm||j<Fm)return o(v);v=d(v-x/j)}return o(v)};return f.isStepper=!1,f},Qw=function(){return y$(...b$(...arguments))},j$=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:a=8,dt:l=17}=r,o=(u,d,f)=>{var p=-(u-d)*n,h=f*a,v=f+(p-h)*l/1e3,b=f*l/1e3+u;return Math.abs(b-d)<Fm&&Math.abs(v)<Fm?[d,0]:[b,v]};return o.isStepper=!0,o.dt=l,o},_$=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Qw(e);case"spring":return j$();default:if(e.split("(")[0]==="cubic-bezier")return Qw(e)}return typeof e=="function"?e:null};function N$(e){var r,n=()=>null,a=!1,l=null,o=u=>{if(!a){if(Array.isArray(u)){if(!u.length)return;var d=u,[f,...p]=d;if(typeof f=="number"){l=e.setTimeout(o.bind(null,p),f);return}o(f),l=e.setTimeout(o.bind(null,p));return}typeof u=="string"&&(r=u,n(r)),typeof u=="object"&&(r=u,n(r)),typeof u=="function"&&u()}};return{stop:()=>{a=!0},start:u=>{a=!1,l&&(l(),l=null),o(u)},subscribe:u=>(n=u,()=>{n=()=>null}),getTimeoutController:()=>e}}class S${setTimeout(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=performance.now(),l=null,o=u=>{u-a>=n?r(u):typeof requestAnimationFrame=="function"&&(l=requestAnimationFrame(o))};return l=requestAnimationFrame(o),()=>{l!=null&&cancelAnimationFrame(l)}}}function w$(){return N$(new S$)}var C$=g.createContext(w$);function E$(e,r){var n=g.useContext(C$);return g.useMemo(()=>r??n(e),[e,r,n])}var A$=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Yf={isSsr:A$()},z$={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},Yw={t:0},Xg={t:1};function Kf(e){var r=Ur(e,z$),{isActive:n,canBegin:a,duration:l,easing:o,begin:u,onAnimationEnd:d,onAnimationStart:f,children:p}=r,h=n==="auto"?!Yf.isSsr:n,v=E$(r.animationId,r.animationManager),[b,x]=g.useState(h?Yw:Xg),j=g.useRef(null);return g.useEffect(()=>{h||x(Xg)},[h]),g.useEffect(()=>{if(!h||!a)return rl;var _=v$(Yw,Xg,_$(o),l,x,v.getTimeoutController()),C=()=>{j.current=_()};return v.start([f,u,C,l,d]),()=>{v.stop(),j.current&&j.current(),d()}},[h,a,l,o,u,f,d,v]),p(b.t)}function Wf(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=g.useRef(Fc(r)),a=g.useRef(e);return a.current!==e&&(n.current=Fc(r),a.current=e),n.current}var k$=["radius"],O$=["radius"],Kw,Ww,Xw,Zw,Jw,eC,tC,rC,nC,aC;function iC(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function sC(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?iC(Object(n),!0).forEach(function(a){D$(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iC(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function D$(e,r,n){return(r=P$(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function P$(e){var r=M$(e,"string");return typeof r=="symbol"?r:r+""}function M$(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Gm(){return Gm=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Gm.apply(null,arguments)}function lC(e,r){if(e==null)return{};var n,a,l=T$(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function T$(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function ua(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}var oC=(e,r,n,a,l)=>{var o=Yi(n),u=Yi(a),d=Math.min(Math.abs(o)/2,Math.abs(u)/2),f=u>=0?1:-1,p=o>=0?1:-1,h=u>=0&&o>=0||u<0&&o<0?1:0,v;if(d>0&&Array.isArray(l)){for(var b=[0,0,0,0],x=0,j=4;x<j;x++){var _,C=(_=l[x])!==null&&_!==void 0?_:0;b[x]=C>d?d:C}v=Ft(Kw||(Kw=ua(["M",",",""])),e,r+f*b[0]),b[0]>0&&(v+=Ft(Ww||(Ww=ua(["A ",",",",0,0,",",",",",""])),b[0],b[0],h,e+p*b[0],r)),v+=Ft(Xw||(Xw=ua(["L ",",",""])),e+n-p*b[1],r),b[1]>0&&(v+=Ft(Zw||(Zw=ua(["A ",",",",0,0,",`,
        `,",",""])),b[1],b[1],h,e+n,r+f*b[1])),v+=Ft(Jw||(Jw=ua(["L ",",",""])),e+n,r+a-f*b[2]),b[2]>0&&(v+=Ft(eC||(eC=ua(["A ",",",",0,0,",`,
        `,",",""])),b[2],b[2],h,e+n-p*b[2],r+a)),v+=Ft(tC||(tC=ua(["L ",",",""])),e+p*b[3],r+a),b[3]>0&&(v+=Ft(rC||(rC=ua(["A ",",",",0,0,",`,
        `,",",""])),b[3],b[3],h,e,r+a-f*b[3])),v+="Z"}else if(d>0&&l===+l&&l>0){var w=Math.min(d,l);v=Ft(nC||(nC=ua(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,r+f*w,w,w,h,e+p*w,r,e+n-p*w,r,w,w,h,e+n,r+f*w,e+n,r+a-f*w,w,w,h,e+n-p*w,r+a,e+p*w,r+a,w,w,h,e,r+a-f*w)}else v=Ft(aC||(aC=ua(["M ",","," h "," v "," h "," Z"])),e,r,n,a,-n);return v},cC={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Dk=e=>{var r=Ur(e,cC),n=g.useRef(null),[a,l]=g.useState(-1);g.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var F=n.current.getTotalLength();F&&l(F)}catch{}},[]);var{x:o,y:u,width:d,height:f,radius:p,className:h}=r,{animationEasing:v,animationDuration:b,animationBegin:x,isAnimationActive:j,isUpdateAnimationActive:_}=r,C=g.useRef(d),w=g.useRef(f),E=g.useRef(o),S=g.useRef(u),A=g.useMemo(()=>({x:o,y:u,width:d,height:f,radius:p}),[o,u,d,f,p]),O=Wf(A,"rectangle-");if(o!==+o||u!==+u||d!==+d||f!==+f||d===0||f===0)return null;var k=St("recharts-rectangle",h);if(!_){var P=Lr(r),{radius:D}=P,B=lC(P,k$);return g.createElement("path",Gm({},B,{x:Yi(o),y:Yi(u),width:Yi(d),height:Yi(f),radius:typeof p=="number"?p:void 0,className:k,d:oC(o,u,d,f,p)}))}var U=C.current,$=w.current,R=E.current,Y=S.current,ae="0px ".concat(a===-1?1:a,"px"),M="".concat(a,"px 0px"),T=Ak(["strokeDasharray"],b,typeof v=="string"?v:cC.animationEasing);return g.createElement(Kf,{animationId:O,key:O,canBegin:a>0,duration:b,easing:v,isActive:_,begin:x},F=>{var I=Gt(U,d,F),X=Gt($,f,F),L=Gt(R,o,F),ne=Gt(Y,u,F);n.current&&(C.current=I,w.current=X,E.current=L,S.current=ne);var K;j?F>0?K={transition:T,strokeDasharray:M}:K={strokeDasharray:ae}:K={strokeDasharray:M};var oe=Lr(r),{radius:xe}=oe,ve=lC(oe,O$);return g.createElement("path",Gm({},ve,{radius:typeof p=="number"?p:void 0,className:k,d:oC(L,ne,I,X,p),ref:n,style:sC(sC({},K),r.style)}))})};function uC(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function dC(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?uC(Object(n),!0).forEach(function(a){q$(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uC(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function q$(e,r,n){return(r=R$(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function R$(e){var r=I$(e,"string");return typeof r=="symbol"?r:r+""}function I$(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Hm=Math.PI/180,L$=e=>e*180/Math.PI,zr=(e,r,n,a)=>({x:e+Math.cos(-Hm*a)*n,y:r+Math.sin(-Hm*a)*n}),$$=function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(r-(a.left||0)-(a.right||0)),Math.abs(n-(a.top||0)-(a.bottom||0)))/2},B$=(e,r)=>{var{x:n,y:a}=e,{x:l,y:o}=r;return Math.sqrt((n-l)**2+(a-o)**2)},U$=(e,r)=>{var{x:n,y:a}=e,{cx:l,cy:o}=r,u=B$({x:n,y:a},{x:l,y:o});if(u<=0)return{radius:u,angle:0};var d=(n-l)/u,f=Math.acos(d);return a>o&&(f=2*Math.PI-f),{radius:u,angle:L$(f),angleInRadian:f}},F$=e=>{var{startAngle:r,endAngle:n}=e,a=Math.floor(r/360),l=Math.floor(n/360),o=Math.min(a,l);return{startAngle:r-o*360,endAngle:n-o*360}},G$=(e,r)=>{var{startAngle:n,endAngle:a}=r,l=Math.floor(n/360),o=Math.floor(a/360),u=Math.min(l,o);return e+u*360},H$=(e,r)=>{var{chartX:n,chartY:a}=e,{radius:l,angle:o}=U$({x:n,y:a},r),{innerRadius:u,outerRadius:d}=r;if(l<u||l>d||l===0)return null;var{startAngle:f,endAngle:p}=F$(r),h=o,v;if(f<=p){for(;h>p;)h-=360;for(;h<f;)h+=360;v=h>=f&&h<=p}else{for(;h>f;)h-=360;for(;h<p;)h+=360;v=h>=p&&h<=f}return v?dC(dC({},r),{},{radius:l,angle:G$(h,r)}):null};function Pk(e){var{cx:r,cy:n,radius:a,startAngle:l,endAngle:o}=e,u=zr(r,n,a,l),d=zr(r,n,a,o);return{points:[u,d],cx:r,cy:n,radius:a,startAngle:l,endAngle:o}}var mC,fC,pC,hC,vC,gC,xC;function ub(){return ub=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ub.apply(null,arguments)}function Ms(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}var V$=(e,r)=>{var n=Jr(r-e),a=Math.min(Math.abs(r-e),359.999);return n*a},Xd=e=>{var{cx:r,cy:n,radius:a,angle:l,sign:o,isExternal:u,cornerRadius:d,cornerIsExternal:f}=e,p=d*(u?1:-1)+a,h=Math.asin(d/p)/Hm,v=f?l:l+o*h,b=zr(r,n,p,v),x=zr(r,n,a,v),j=f?l-o*h:l,_=zr(r,n,p*Math.cos(h*Hm),j);return{center:b,circleTangency:x,lineTangency:_,theta:h}},Mk=e=>{var{cx:r,cy:n,innerRadius:a,outerRadius:l,startAngle:o,endAngle:u}=e,d=V$(o,u),f=o+d,p=zr(r,n,l,o),h=zr(r,n,l,f),v=Ft(mC||(mC=Ms(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),p.x,p.y,l,l,+(Math.abs(d)>180),+(o>f),h.x,h.y);if(a>0){var b=zr(r,n,a,o),x=zr(r,n,a,f);v+=Ft(fC||(fC=Ms(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),x.x,x.y,a,a,+(Math.abs(d)>180),+(o<=f),b.x,b.y)}else v+=Ft(pC||(pC=Ms(["L ",","," Z"])),r,n);return v},Q$=e=>{var{cx:r,cy:n,innerRadius:a,outerRadius:l,cornerRadius:o,forceCornerRadius:u,cornerIsExternal:d,startAngle:f,endAngle:p}=e,h=Jr(p-f),{circleTangency:v,lineTangency:b,theta:x}=Xd({cx:r,cy:n,radius:l,angle:f,sign:h,cornerRadius:o,cornerIsExternal:d}),{circleTangency:j,lineTangency:_,theta:C}=Xd({cx:r,cy:n,radius:l,angle:p,sign:-h,cornerRadius:o,cornerIsExternal:d}),w=d?Math.abs(f-p):Math.abs(f-p)-x-C;if(w<0)return u?Ft(hC||(hC=Ms(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),b.x,b.y,o,o,o*2,o,o,-o*2):Mk({cx:r,cy:n,innerRadius:a,outerRadius:l,startAngle:f,endAngle:p});var E=Ft(vC||(vC=Ms(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),b.x,b.y,o,o,+(h<0),v.x,v.y,l,l,+(w>180),+(h<0),j.x,j.y,o,o,+(h<0),_.x,_.y);if(a>0){var{circleTangency:S,lineTangency:A,theta:O}=Xd({cx:r,cy:n,radius:a,angle:f,sign:h,isExternal:!0,cornerRadius:o,cornerIsExternal:d}),{circleTangency:k,lineTangency:P,theta:D}=Xd({cx:r,cy:n,radius:a,angle:p,sign:-h,isExternal:!0,cornerRadius:o,cornerIsExternal:d}),B=d?Math.abs(f-p):Math.abs(f-p)-O-D;if(B<0&&o===0)return"".concat(E,"L").concat(r,",").concat(n,"Z");E+=Ft(gC||(gC=Ms(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),P.x,P.y,o,o,+(h<0),k.x,k.y,a,a,+(B>180),+(h>0),S.x,S.y,o,o,+(h<0),A.x,A.y)}else E+=Ft(xC||(xC=Ms(["L",",","Z"])),r,n);return E},Y$={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Tk=e=>{var r=Ur(e,Y$),{cx:n,cy:a,innerRadius:l,outerRadius:o,cornerRadius:u,forceCornerRadius:d,cornerIsExternal:f,startAngle:p,endAngle:h,className:v}=r;if(o<l||p===h)return null;var b=St("recharts-sector",v),x=o-l,j=ta(u,x,0,!0),_;return j>0&&Math.abs(p-h)<360?_=Q$({cx:n,cy:a,innerRadius:l,outerRadius:o,cornerRadius:Math.min(j,x/2),forceCornerRadius:d,cornerIsExternal:f,startAngle:p,endAngle:h}):_=Mk({cx:n,cy:a,innerRadius:l,outerRadius:o,startAngle:p,endAngle:h}),g.createElement("path",ub({},Lr(r),{className:b,d:_}))};function K$(e,r,n){if(e==="horizontal")return[{x:r.x,y:n.top},{x:r.x,y:n.top+n.height}];if(e==="vertical")return[{x:n.left,y:r.y},{x:n.left+n.width,y:r.y}];if(bz(r)){if(e==="centric"){var{cx:a,cy:l,innerRadius:o,outerRadius:u,angle:d}=r,f=zr(a,l,o,d),p=zr(a,l,u,d);return[{x:f.x,y:f.y},{x:p.x,y:p.y}]}return Pk(r)}}var Zg={},Jg={},ex={},bC;function W$(){return bC||(bC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=zz();function n(a){return r.isSymbol(a)?NaN:Number(a)}e.toNumber=n})(ex)),ex}var yC;function X$(){return yC||(yC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=W$();function n(a){return a?(a=r.toNumber(a),a===1/0||a===-1/0?(a<0?-1:1)*Number.MAX_VALUE:a===a?a:0):a===0?a:0}e.toFinite=n})(Jg)),Jg}var jC;function Z$(){return jC||(jC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=kz(),n=X$();function a(l,o,u){u&&typeof u!="number"&&r.isIterateeCall(l,o,u)&&(o=u=void 0),l=n.toFinite(l),o===void 0?(o=l,l=0):o=n.toFinite(o),u=u===void 0?l<o?1:-1:n.toFinite(u);const d=Math.max(Math.ceil((o-l)/(u||1)),0),f=new Array(d);for(let p=0;p<d;p++)f[p]=l,l+=u;return f}e.range=a})(Zg)),Zg}var tx,_C;function J$(){return _C||(_C=1,tx=Z$().range),tx}var e7=J$();const qk=oi(e7);function Xi(e,r){return e==null||r==null?NaN:e<r?-1:e>r?1:e>=r?0:NaN}function t7(e,r){return e==null||r==null?NaN:r<e?-1:r>e?1:r>=e?0:NaN}function vy(e){let r,n,a;e.length!==2?(r=Xi,n=(d,f)=>Xi(e(d),f),a=(d,f)=>e(d)-f):(r=e===Xi||e===t7?e:r7,n=e,a=e);function l(d,f,p=0,h=d.length){if(p<h){if(r(f,f)!==0)return h;do{const v=p+h>>>1;n(d[v],f)<0?p=v+1:h=v}while(p<h)}return p}function o(d,f,p=0,h=d.length){if(p<h){if(r(f,f)!==0)return h;do{const v=p+h>>>1;n(d[v],f)<=0?p=v+1:h=v}while(p<h)}return p}function u(d,f,p=0,h=d.length){const v=l(d,f,p,h-1);return v>p&&a(d[v-1],f)>-a(d[v],f)?v-1:v}return{left:l,center:u,right:o}}function r7(){return 0}function Rk(e){return e===null?NaN:+e}function*n7(e,r){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const a7=vy(Xi),vu=a7.right;vy(Rk).center;class NC extends Map{constructor(r,n=l7){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),r!=null)for(const[a,l]of r)this.set(a,l)}get(r){return super.get(SC(this,r))}has(r){return super.has(SC(this,r))}set(r,n){return super.set(i7(this,r),n)}delete(r){return super.delete(s7(this,r))}}function SC({_intern:e,_key:r},n){const a=r(n);return e.has(a)?e.get(a):n}function i7({_intern:e,_key:r},n){const a=r(n);return e.has(a)?e.get(a):(e.set(a,n),n)}function s7({_intern:e,_key:r},n){const a=r(n);return e.has(a)&&(n=e.get(a),e.delete(a)),n}function l7(e){return e!==null&&typeof e=="object"?e.valueOf():e}function o7(e=Xi){if(e===Xi)return Ik;if(typeof e!="function")throw new TypeError("compare is not a function");return(r,n)=>{const a=e(r,n);return a||a===0?a:(e(n,n)===0)-(e(r,r)===0)}}function Ik(e,r){return(e==null||!(e>=e))-(r==null||!(r>=r))||(e<r?-1:e>r?1:0)}const c7=Math.sqrt(50),u7=Math.sqrt(10),d7=Math.sqrt(2);function Vm(e,r,n){const a=(r-e)/Math.max(0,n),l=Math.floor(Math.log10(a)),o=a/Math.pow(10,l),u=o>=c7?10:o>=u7?5:o>=d7?2:1;let d,f,p;return l<0?(p=Math.pow(10,-l)/u,d=Math.round(e*p),f=Math.round(r*p),d/p<e&&++d,f/p>r&&--f,p=-p):(p=Math.pow(10,l)*u,d=Math.round(e/p),f=Math.round(r/p),d*p<e&&++d,f*p>r&&--f),f<d&&.5<=n&&n<2?Vm(e,r,n*2):[d,f,p]}function db(e,r,n){if(r=+r,e=+e,n=+n,!(n>0))return[];if(e===r)return[e];const a=r<e,[l,o,u]=a?Vm(r,e,n):Vm(e,r,n);if(!(o>=l))return[];const d=o-l+1,f=new Array(d);if(a)if(u<0)for(let p=0;p<d;++p)f[p]=(o-p)/-u;else for(let p=0;p<d;++p)f[p]=(o-p)*u;else if(u<0)for(let p=0;p<d;++p)f[p]=(l+p)/-u;else for(let p=0;p<d;++p)f[p]=(l+p)*u;return f}function mb(e,r,n){return r=+r,e=+e,n=+n,Vm(e,r,n)[2]}function fb(e,r,n){r=+r,e=+e,n=+n;const a=r<e,l=a?mb(r,e,n):mb(e,r,n);return(a?-1:1)*(l<0?1/-l:l)}function wC(e,r){let n;for(const a of e)a!=null&&(n<a||n===void 0&&a>=a)&&(n=a);return n}function CC(e,r){let n;for(const a of e)a!=null&&(n>a||n===void 0&&a>=a)&&(n=a);return n}function Lk(e,r,n=0,a=1/0,l){if(r=Math.floor(r),n=Math.floor(Math.max(0,n)),a=Math.floor(Math.min(e.length-1,a)),!(n<=r&&r<=a))return e;for(l=l===void 0?Ik:o7(l);a>n;){if(a-n>600){const f=a-n+1,p=r-n+1,h=Math.log(f),v=.5*Math.exp(2*h/3),b=.5*Math.sqrt(h*v*(f-v)/f)*(p-f/2<0?-1:1),x=Math.max(n,Math.floor(r-p*v/f+b)),j=Math.min(a,Math.floor(r+(f-p)*v/f+b));Lk(e,r,x,j,l)}const o=e[r];let u=n,d=a;for(wc(e,n,r),l(e[a],o)>0&&wc(e,n,a);u<d;){for(wc(e,u,d),++u,--d;l(e[u],o)<0;)++u;for(;l(e[d],o)>0;)--d}l(e[n],o)===0?wc(e,n,d):(++d,wc(e,d,a)),d<=r&&(n=d+1),r<=d&&(a=d-1)}return e}function wc(e,r,n){const a=e[r];e[r]=e[n],e[n]=a}function m7(e,r,n){if(e=Float64Array.from(n7(e)),!(!(a=e.length)||isNaN(r=+r))){if(r<=0||a<2)return CC(e);if(r>=1)return wC(e);var a,l=(a-1)*r,o=Math.floor(l),u=wC(Lk(e,o).subarray(0,o+1)),d=CC(e.subarray(o+1));return u+(d-u)*(l-o)}}function f7(e,r,n=Rk){if(!(!(a=e.length)||isNaN(r=+r))){if(r<=0||a<2)return+n(e[0],0,e);if(r>=1)return+n(e[a-1],a-1,e);var a,l=(a-1)*r,o=Math.floor(l),u=+n(e[o],o,e),d=+n(e[o+1],o+1,e);return u+(d-u)*(l-o)}}function p7(e,r,n){e=+e,r=+r,n=(l=arguments.length)<2?(r=e,e=0,1):l<3?1:+n;for(var a=-1,l=Math.max(0,Math.ceil((r-e)/n))|0,o=new Array(l);++a<l;)o[a]=e+a*n;return o}function Bn(e,r){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(r).domain(e);break}return this}function mi(e,r){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof r=="function"?this.interpolator(r):this.range(r);break}}return this}const pb=Symbol("implicit");function gy(){var e=new NC,r=[],n=[],a=pb;function l(o){let u=e.get(o);if(u===void 0){if(a!==pb)return a;e.set(o,u=r.push(o)-1)}return n[u%n.length]}return l.domain=function(o){if(!arguments.length)return r.slice();r=[],e=new NC;for(const u of o)e.has(u)||e.set(u,r.push(u)-1);return l},l.range=function(o){return arguments.length?(n=Array.from(o),l):n.slice()},l.unknown=function(o){return arguments.length?(a=o,l):a},l.copy=function(){return gy(r,n).unknown(a)},Bn.apply(l,arguments),l}function xy(){var e=gy().unknown(void 0),r=e.domain,n=e.range,a=0,l=1,o,u,d=!1,f=0,p=0,h=.5;delete e.unknown;function v(){var b=r().length,x=l<a,j=x?l:a,_=x?a:l;o=(_-j)/Math.max(1,b-f+p*2),d&&(o=Math.floor(o)),j+=(_-j-o*(b-f))*h,u=o*(1-f),d&&(j=Math.round(j),u=Math.round(u));var C=p7(b).map(function(w){return j+o*w});return n(x?C.reverse():C)}return e.domain=function(b){return arguments.length?(r(b),v()):r()},e.range=function(b){return arguments.length?([a,l]=b,a=+a,l=+l,v()):[a,l]},e.rangeRound=function(b){return[a,l]=b,a=+a,l=+l,d=!0,v()},e.bandwidth=function(){return u},e.step=function(){return o},e.round=function(b){return arguments.length?(d=!!b,v()):d},e.padding=function(b){return arguments.length?(f=Math.min(1,p=+b),v()):f},e.paddingInner=function(b){return arguments.length?(f=Math.min(1,b),v()):f},e.paddingOuter=function(b){return arguments.length?(p=+b,v()):p},e.align=function(b){return arguments.length?(h=Math.max(0,Math.min(1,b)),v()):h},e.copy=function(){return xy(r(),[a,l]).round(d).paddingInner(f).paddingOuter(p).align(h)},Bn.apply(v(),arguments)}function $k(e){var r=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return $k(r())},e}function h7(){return $k(xy.apply(null,arguments).paddingInner(1))}function by(e,r,n){e.prototype=r.prototype=n,n.constructor=e}function Bk(e,r){var n=Object.create(e.prototype);for(var a in r)n[a]=r[a];return n}function gu(){}var Xc=.7,Qm=1/Xc,co="\\s*([+-]?\\d+)\\s*",Zc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ga="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",v7=/^#([0-9a-f]{3,8})$/,g7=new RegExp(`^rgb\\(${co},${co},${co}\\)$`),x7=new RegExp(`^rgb\\(${ga},${ga},${ga}\\)$`),b7=new RegExp(`^rgba\\(${co},${co},${co},${Zc}\\)$`),y7=new RegExp(`^rgba\\(${ga},${ga},${ga},${Zc}\\)$`),j7=new RegExp(`^hsl\\(${Zc},${ga},${ga}\\)$`),_7=new RegExp(`^hsla\\(${Zc},${ga},${ga},${Zc}\\)$`),EC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};by(gu,Jc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:AC,formatHex:AC,formatHex8:N7,formatHsl:S7,formatRgb:zC,toString:zC});function AC(){return this.rgb().formatHex()}function N7(){return this.rgb().formatHex8()}function S7(){return Uk(this).formatHsl()}function zC(){return this.rgb().formatRgb()}function Jc(e){var r,n;return e=(e+"").trim().toLowerCase(),(r=v7.exec(e))?(n=r[1].length,r=parseInt(r[1],16),n===6?kC(r):n===3?new tn(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):n===8?Zd(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):n===4?Zd(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=g7.exec(e))?new tn(r[1],r[2],r[3],1):(r=x7.exec(e))?new tn(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=b7.exec(e))?Zd(r[1],r[2],r[3],r[4]):(r=y7.exec(e))?Zd(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=j7.exec(e))?PC(r[1],r[2]/100,r[3]/100,1):(r=_7.exec(e))?PC(r[1],r[2]/100,r[3]/100,r[4]):EC.hasOwnProperty(e)?kC(EC[e]):e==="transparent"?new tn(NaN,NaN,NaN,0):null}function kC(e){return new tn(e>>16&255,e>>8&255,e&255,1)}function Zd(e,r,n,a){return a<=0&&(e=r=n=NaN),new tn(e,r,n,a)}function w7(e){return e instanceof gu||(e=Jc(e)),e?(e=e.rgb(),new tn(e.r,e.g,e.b,e.opacity)):new tn}function hb(e,r,n,a){return arguments.length===1?w7(e):new tn(e,r,n,a??1)}function tn(e,r,n,a){this.r=+e,this.g=+r,this.b=+n,this.opacity=+a}by(tn,hb,Bk(gu,{brighter(e){return e=e==null?Qm:Math.pow(Qm,e),new tn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Xc:Math.pow(Xc,e),new tn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new tn(Fs(this.r),Fs(this.g),Fs(this.b),Ym(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:OC,formatHex:OC,formatHex8:C7,formatRgb:DC,toString:DC}));function OC(){return`#${Ts(this.r)}${Ts(this.g)}${Ts(this.b)}`}function C7(){return`#${Ts(this.r)}${Ts(this.g)}${Ts(this.b)}${Ts((isNaN(this.opacity)?1:this.opacity)*255)}`}function DC(){const e=Ym(this.opacity);return`${e===1?"rgb(":"rgba("}${Fs(this.r)}, ${Fs(this.g)}, ${Fs(this.b)}${e===1?")":`, ${e})`}`}function Ym(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Fs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ts(e){return e=Fs(e),(e<16?"0":"")+e.toString(16)}function PC(e,r,n,a){return a<=0?e=r=n=NaN:n<=0||n>=1?e=r=NaN:r<=0&&(e=NaN),new Zn(e,r,n,a)}function Uk(e){if(e instanceof Zn)return new Zn(e.h,e.s,e.l,e.opacity);if(e instanceof gu||(e=Jc(e)),!e)return new Zn;if(e instanceof Zn)return e;e=e.rgb();var r=e.r/255,n=e.g/255,a=e.b/255,l=Math.min(r,n,a),o=Math.max(r,n,a),u=NaN,d=o-l,f=(o+l)/2;return d?(r===o?u=(n-a)/d+(n<a)*6:n===o?u=(a-r)/d+2:u=(r-n)/d+4,d/=f<.5?o+l:2-o-l,u*=60):d=f>0&&f<1?0:u,new Zn(u,d,f,e.opacity)}function E7(e,r,n,a){return arguments.length===1?Uk(e):new Zn(e,r,n,a??1)}function Zn(e,r,n,a){this.h=+e,this.s=+r,this.l=+n,this.opacity=+a}by(Zn,E7,Bk(gu,{brighter(e){return e=e==null?Qm:Math.pow(Qm,e),new Zn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Xc:Math.pow(Xc,e),new Zn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*r,l=2*n-a;return new tn(rx(e>=240?e-240:e+120,l,a),rx(e,l,a),rx(e<120?e+240:e-120,l,a),this.opacity)},clamp(){return new Zn(MC(this.h),Jd(this.s),Jd(this.l),Ym(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ym(this.opacity);return`${e===1?"hsl(":"hsla("}${MC(this.h)}, ${Jd(this.s)*100}%, ${Jd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function MC(e){return e=(e||0)%360,e<0?e+360:e}function Jd(e){return Math.max(0,Math.min(1,e||0))}function rx(e,r,n){return(e<60?r+(n-r)*e/60:e<180?n:e<240?r+(n-r)*(240-e)/60:r)*255}const yy=e=>()=>e;function A7(e,r){return function(n){return e+n*r}}function z7(e,r,n){return e=Math.pow(e,n),r=Math.pow(r,n)-e,n=1/n,function(a){return Math.pow(e+a*r,n)}}function k7(e){return(e=+e)==1?Fk:function(r,n){return n-r?z7(r,n,e):yy(isNaN(r)?n:r)}}function Fk(e,r){var n=r-e;return n?A7(e,n):yy(isNaN(e)?r:e)}const TC=(function e(r){var n=k7(r);function a(l,o){var u=n((l=hb(l)).r,(o=hb(o)).r),d=n(l.g,o.g),f=n(l.b,o.b),p=Fk(l.opacity,o.opacity);return function(h){return l.r=u(h),l.g=d(h),l.b=f(h),l.opacity=p(h),l+""}}return a.gamma=e,a})(1);function O7(e,r){r||(r=[]);var n=e?Math.min(r.length,e.length):0,a=r.slice(),l;return function(o){for(l=0;l<n;++l)a[l]=e[l]*(1-o)+r[l]*o;return a}}function D7(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function P7(e,r){var n=r?r.length:0,a=e?Math.min(n,e.length):0,l=new Array(a),o=new Array(n),u;for(u=0;u<a;++u)l[u]=yo(e[u],r[u]);for(;u<n;++u)o[u]=r[u];return function(d){for(u=0;u<a;++u)o[u]=l[u](d);return o}}function M7(e,r){var n=new Date;return e=+e,r=+r,function(a){return n.setTime(e*(1-a)+r*a),n}}function Km(e,r){return e=+e,r=+r,function(n){return e*(1-n)+r*n}}function T7(e,r){var n={},a={},l;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(l in r)l in e?n[l]=yo(e[l],r[l]):a[l]=r[l];return function(o){for(l in n)a[l]=n[l](o);return a}}var vb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nx=new RegExp(vb.source,"g");function q7(e){return function(){return e}}function R7(e){return function(r){return e(r)+""}}function I7(e,r){var n=vb.lastIndex=nx.lastIndex=0,a,l,o,u=-1,d=[],f=[];for(e=e+"",r=r+"";(a=vb.exec(e))&&(l=nx.exec(r));)(o=l.index)>n&&(o=r.slice(n,o),d[u]?d[u]+=o:d[++u]=o),(a=a[0])===(l=l[0])?d[u]?d[u]+=l:d[++u]=l:(d[++u]=null,f.push({i:u,x:Km(a,l)})),n=nx.lastIndex;return n<r.length&&(o=r.slice(n),d[u]?d[u]+=o:d[++u]=o),d.length<2?f[0]?R7(f[0].x):q7(r):(r=f.length,function(p){for(var h=0,v;h<r;++h)d[(v=f[h]).i]=v.x(p);return d.join("")})}function yo(e,r){var n=typeof r,a;return r==null||n==="boolean"?yy(r):(n==="number"?Km:n==="string"?(a=Jc(r))?(r=a,TC):I7:r instanceof Jc?TC:r instanceof Date?M7:D7(r)?O7:Array.isArray(r)?P7:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?T7:Km)(e,r)}function jy(e,r){return e=+e,r=+r,function(n){return Math.round(e*(1-n)+r*n)}}function L7(e,r){r===void 0&&(r=e,e=yo);for(var n=0,a=r.length-1,l=r[0],o=new Array(a<0?0:a);n<a;)o[n]=e(l,l=r[++n]);return function(u){var d=Math.max(0,Math.min(a-1,Math.floor(u*=a)));return o[d](u-d)}}function $7(e){return function(){return e}}function Wm(e){return+e}var qC=[0,1];function Ir(e){return e}function gb(e,r){return(r-=e=+e)?function(n){return(n-e)/r}:$7(isNaN(r)?NaN:.5)}function B7(e,r){var n;return e>r&&(n=e,e=r,r=n),function(a){return Math.max(e,Math.min(r,a))}}function U7(e,r,n){var a=e[0],l=e[1],o=r[0],u=r[1];return l<a?(a=gb(l,a),o=n(u,o)):(a=gb(a,l),o=n(o,u)),function(d){return o(a(d))}}function F7(e,r,n){var a=Math.min(e.length,r.length)-1,l=new Array(a),o=new Array(a),u=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),r=r.slice().reverse());++u<a;)l[u]=gb(e[u],e[u+1]),o[u]=n(r[u],r[u+1]);return function(d){var f=vu(e,d,1,a)-1;return o[f](l[f](d))}}function xu(e,r){return r.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Xf(){var e=qC,r=qC,n=yo,a,l,o,u=Ir,d,f,p;function h(){var b=Math.min(e.length,r.length);return u!==Ir&&(u=B7(e[0],e[b-1])),d=b>2?F7:U7,f=p=null,v}function v(b){return b==null||isNaN(b=+b)?o:(f||(f=d(e.map(a),r,n)))(a(u(b)))}return v.invert=function(b){return u(l((p||(p=d(r,e.map(a),Km)))(b)))},v.domain=function(b){return arguments.length?(e=Array.from(b,Wm),h()):e.slice()},v.range=function(b){return arguments.length?(r=Array.from(b),h()):r.slice()},v.rangeRound=function(b){return r=Array.from(b),n=jy,h()},v.clamp=function(b){return arguments.length?(u=b?!0:Ir,h()):u!==Ir},v.interpolate=function(b){return arguments.length?(n=b,h()):n},v.unknown=function(b){return arguments.length?(o=b,v):o},function(b,x){return a=b,l=x,h()}}function _y(){return Xf()(Ir,Ir)}function G7(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Xm(e,r){if(!isFinite(e)||e===0)return null;var n=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"),a=e.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+e.slice(n+1)]}function go(e){return e=Xm(Math.abs(e)),e?e[1]:NaN}function H7(e,r){return function(n,a){for(var l=n.length,o=[],u=0,d=e[0],f=0;l>0&&d>0&&(f+d+1>a&&(d=Math.max(1,a-f)),o.push(n.substring(l-=d,l+d)),!((f+=d+1)>a));)d=e[u=(u+1)%e.length];return o.reverse().join(r)}}function V7(e){return function(r){return r.replace(/[0-9]/g,function(n){return e[+n]})}}var Q7=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function eu(e){if(!(r=Q7.exec(e)))throw new Error("invalid format: "+e);var r;return new Ny({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}eu.prototype=Ny.prototype;function Ny(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Ny.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Y7(e){e:for(var r=e.length,n=1,a=-1,l;n<r;++n)switch(e[n]){case".":a=l=n;break;case"0":a===0&&(a=n),l=n;break;default:if(!+e[n])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(l+1):e}var Zm;function K7(e,r){var n=Xm(e,r);if(!n)return Zm=void 0,e.toPrecision(r);var a=n[0],l=n[1],o=l-(Zm=Math.max(-8,Math.min(8,Math.floor(l/3)))*3)+1,u=a.length;return o===u?a:o>u?a+new Array(o-u+1).join("0"):o>0?a.slice(0,o)+"."+a.slice(o):"0."+new Array(1-o).join("0")+Xm(e,Math.max(0,r+o-1))[0]}function RC(e,r){var n=Xm(e,r);if(!n)return e+"";var a=n[0],l=n[1];return l<0?"0."+new Array(-l).join("0")+a:a.length>l+1?a.slice(0,l+1)+"."+a.slice(l+1):a+new Array(l-a.length+2).join("0")}const IC={"%":(e,r)=>(e*100).toFixed(r),b:e=>Math.round(e).toString(2),c:e=>e+"",d:G7,e:(e,r)=>e.toExponential(r),f:(e,r)=>e.toFixed(r),g:(e,r)=>e.toPrecision(r),o:e=>Math.round(e).toString(8),p:(e,r)=>RC(e*100,r),r:RC,s:K7,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function LC(e){return e}var $C=Array.prototype.map,BC=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function W7(e){var r=e.grouping===void 0||e.thousands===void 0?LC:H7($C.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",l=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?LC:V7($C.call(e.numerals,String)),u=e.percent===void 0?"%":e.percent+"",d=e.minus===void 0?"":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function p(v,b){v=eu(v);var x=v.fill,j=v.align,_=v.sign,C=v.symbol,w=v.zero,E=v.width,S=v.comma,A=v.precision,O=v.trim,k=v.type;k==="n"?(S=!0,k="g"):IC[k]||(A===void 0&&(A=12),O=!0,k="g"),(w||x==="0"&&j==="=")&&(w=!0,x="0",j="=");var P=(b&&b.prefix!==void 0?b.prefix:"")+(C==="$"?n:C==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():""),D=(C==="$"?a:/[%p]/.test(k)?u:"")+(b&&b.suffix!==void 0?b.suffix:""),B=IC[k],U=/[defgprs%]/.test(k);A=A===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function $(R){var Y=P,ae=D,M,T,F;if(k==="c")ae=B(R)+ae,R="";else{R=+R;var I=R<0||1/R<0;if(R=isNaN(R)?f:B(Math.abs(R),A),O&&(R=Y7(R)),I&&+R==0&&_!=="+"&&(I=!1),Y=(I?_==="("?_:d:_==="-"||_==="("?"":_)+Y,ae=(k==="s"&&!isNaN(R)&&Zm!==void 0?BC[8+Zm/3]:"")+ae+(I&&_==="("?")":""),U){for(M=-1,T=R.length;++M<T;)if(F=R.charCodeAt(M),48>F||F>57){ae=(F===46?l+R.slice(M+1):R.slice(M))+ae,R=R.slice(0,M);break}}}S&&!w&&(R=r(R,1/0));var X=Y.length+R.length+ae.length,L=X<E?new Array(E-X+1).join(x):"";switch(S&&w&&(R=r(L+R,L.length?E-ae.length:1/0),L=""),j){case"<":R=Y+R+ae+L;break;case"=":R=Y+L+R+ae;break;case"^":R=L.slice(0,X=L.length>>1)+Y+R+ae+L.slice(X);break;default:R=L+Y+R+ae;break}return o(R)}return $.toString=function(){return v+""},$}function h(v,b){var x=Math.max(-8,Math.min(8,Math.floor(go(b)/3)))*3,j=Math.pow(10,-x),_=p((v=eu(v),v.type="f",v),{suffix:BC[8+x/3]});return function(C){return _(j*C)}}return{format:p,formatPrefix:h}}var em,Sy,Gk;X7({thousands:",",grouping:[3],currency:["$",""]});function X7(e){return em=W7(e),Sy=em.format,Gk=em.formatPrefix,em}function Z7(e){return Math.max(0,-go(Math.abs(e)))}function J7(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(go(r)/3)))*3-go(Math.abs(e)))}function eB(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,go(r)-go(e))+1}function Hk(e,r,n,a){var l=fb(e,r,n),o;switch(a=eu(a??",f"),a.type){case"s":{var u=Math.max(Math.abs(e),Math.abs(r));return a.precision==null&&!isNaN(o=J7(l,u))&&(a.precision=o),Gk(a,u)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(o=eB(l,Math.max(Math.abs(e),Math.abs(r))))&&(a.precision=o-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(o=Z7(l))&&(a.precision=o-(a.type==="%")*2);break}}return Sy(a)}function ss(e){var r=e.domain;return e.ticks=function(n){var a=r();return db(a[0],a[a.length-1],n??10)},e.tickFormat=function(n,a){var l=r();return Hk(l[0],l[l.length-1],n??10,a)},e.nice=function(n){n==null&&(n=10);var a=r(),l=0,o=a.length-1,u=a[l],d=a[o],f,p,h=10;for(d<u&&(p=u,u=d,d=p,p=l,l=o,o=p);h-- >0;){if(p=mb(u,d,n),p===f)return a[l]=u,a[o]=d,r(a);if(p>0)u=Math.floor(u/p)*p,d=Math.ceil(d/p)*p;else if(p<0)u=Math.ceil(u*p)/p,d=Math.floor(d*p)/p;else break;f=p}return e},e}function Vk(){var e=_y();return e.copy=function(){return xu(e,Vk())},Bn.apply(e,arguments),ss(e)}function Qk(e){var r;function n(a){return a==null||isNaN(a=+a)?r:a}return n.invert=n,n.domain=n.range=function(a){return arguments.length?(e=Array.from(a,Wm),n):e.slice()},n.unknown=function(a){return arguments.length?(r=a,n):r},n.copy=function(){return Qk(e).unknown(r)},e=arguments.length?Array.from(e,Wm):[0,1],ss(n)}function Yk(e,r){e=e.slice();var n=0,a=e.length-1,l=e[n],o=e[a],u;return o<l&&(u=n,n=a,a=u,u=l,l=o,o=u),e[n]=r.floor(l),e[a]=r.ceil(o),e}function UC(e){return Math.log(e)}function FC(e){return Math.exp(e)}function tB(e){return-Math.log(-e)}function rB(e){return-Math.exp(-e)}function nB(e){return isFinite(e)?+("1e"+e):e<0?0:e}function aB(e){return e===10?nB:e===Math.E?Math.exp:r=>Math.pow(e,r)}function iB(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),r=>Math.log(r)/e)}function GC(e){return(r,n)=>-e(-r,n)}function wy(e){const r=e(UC,FC),n=r.domain;let a=10,l,o;function u(){return l=iB(a),o=aB(a),n()[0]<0?(l=GC(l),o=GC(o),e(tB,rB)):e(UC,FC),r}return r.base=function(d){return arguments.length?(a=+d,u()):a},r.domain=function(d){return arguments.length?(n(d),u()):n()},r.ticks=d=>{const f=n();let p=f[0],h=f[f.length-1];const v=h<p;v&&([p,h]=[h,p]);let b=l(p),x=l(h),j,_;const C=d==null?10:+d;let w=[];if(!(a%1)&&x-b<C){if(b=Math.floor(b),x=Math.ceil(x),p>0){for(;b<=x;++b)for(j=1;j<a;++j)if(_=b<0?j/o(-b):j*o(b),!(_<p)){if(_>h)break;w.push(_)}}else for(;b<=x;++b)for(j=a-1;j>=1;--j)if(_=b>0?j/o(-b):j*o(b),!(_<p)){if(_>h)break;w.push(_)}w.length*2<C&&(w=db(p,h,C))}else w=db(b,x,Math.min(x-b,C)).map(o);return v?w.reverse():w},r.tickFormat=(d,f)=>{if(d==null&&(d=10),f==null&&(f=a===10?"s":","),typeof f!="function"&&(!(a%1)&&(f=eu(f)).precision==null&&(f.trim=!0),f=Sy(f)),d===1/0)return f;const p=Math.max(1,a*d/r.ticks().length);return h=>{let v=h/o(Math.round(l(h)));return v*a<a-.5&&(v*=a),v<=p?f(h):""}},r.nice=()=>n(Yk(n(),{floor:d=>o(Math.floor(l(d))),ceil:d=>o(Math.ceil(l(d)))})),r}function Kk(){const e=wy(Xf()).domain([1,10]);return e.copy=()=>xu(e,Kk()).base(e.base()),Bn.apply(e,arguments),e}function HC(e){return function(r){return Math.sign(r)*Math.log1p(Math.abs(r/e))}}function VC(e){return function(r){return Math.sign(r)*Math.expm1(Math.abs(r))*e}}function Cy(e){var r=1,n=e(HC(r),VC(r));return n.constant=function(a){return arguments.length?e(HC(r=+a),VC(r)):r},ss(n)}function Wk(){var e=Cy(Xf());return e.copy=function(){return xu(e,Wk()).constant(e.constant())},Bn.apply(e,arguments)}function QC(e){return function(r){return r<0?-Math.pow(-r,e):Math.pow(r,e)}}function sB(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function lB(e){return e<0?-e*e:e*e}function Ey(e){var r=e(Ir,Ir),n=1;function a(){return n===1?e(Ir,Ir):n===.5?e(sB,lB):e(QC(n),QC(1/n))}return r.exponent=function(l){return arguments.length?(n=+l,a()):n},ss(r)}function Ay(){var e=Ey(Xf());return e.copy=function(){return xu(e,Ay()).exponent(e.exponent())},Bn.apply(e,arguments),e}function oB(){return Ay.apply(null,arguments).exponent(.5)}function YC(e){return Math.sign(e)*e*e}function cB(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function Xk(){var e=_y(),r=[0,1],n=!1,a;function l(o){var u=cB(e(o));return isNaN(u)?a:n?Math.round(u):u}return l.invert=function(o){return e.invert(YC(o))},l.domain=function(o){return arguments.length?(e.domain(o),l):e.domain()},l.range=function(o){return arguments.length?(e.range((r=Array.from(o,Wm)).map(YC)),l):r.slice()},l.rangeRound=function(o){return l.range(o).round(!0)},l.round=function(o){return arguments.length?(n=!!o,l):n},l.clamp=function(o){return arguments.length?(e.clamp(o),l):e.clamp()},l.unknown=function(o){return arguments.length?(a=o,l):a},l.copy=function(){return Xk(e.domain(),r).round(n).clamp(e.clamp()).unknown(a)},Bn.apply(l,arguments),ss(l)}function Zk(){var e=[],r=[],n=[],a;function l(){var u=0,d=Math.max(1,r.length);for(n=new Array(d-1);++u<d;)n[u-1]=f7(e,u/d);return o}function o(u){return u==null||isNaN(u=+u)?a:r[vu(n,u)]}return o.invertExtent=function(u){var d=r.indexOf(u);return d<0?[NaN,NaN]:[d>0?n[d-1]:e[0],d<n.length?n[d]:e[e.length-1]]},o.domain=function(u){if(!arguments.length)return e.slice();e=[];for(let d of u)d!=null&&!isNaN(d=+d)&&e.push(d);return e.sort(Xi),l()},o.range=function(u){return arguments.length?(r=Array.from(u),l()):r.slice()},o.unknown=function(u){return arguments.length?(a=u,o):a},o.quantiles=function(){return n.slice()},o.copy=function(){return Zk().domain(e).range(r).unknown(a)},Bn.apply(o,arguments)}function Jk(){var e=0,r=1,n=1,a=[.5],l=[0,1],o;function u(f){return f!=null&&f<=f?l[vu(a,f,0,n)]:o}function d(){var f=-1;for(a=new Array(n);++f<n;)a[f]=((f+1)*r-(f-n)*e)/(n+1);return u}return u.domain=function(f){return arguments.length?([e,r]=f,e=+e,r=+r,d()):[e,r]},u.range=function(f){return arguments.length?(n=(l=Array.from(f)).length-1,d()):l.slice()},u.invertExtent=function(f){var p=l.indexOf(f);return p<0?[NaN,NaN]:p<1?[e,a[0]]:p>=n?[a[n-1],r]:[a[p-1],a[p]]},u.unknown=function(f){return arguments.length&&(o=f),u},u.thresholds=function(){return a.slice()},u.copy=function(){return Jk().domain([e,r]).range(l).unknown(o)},Bn.apply(ss(u),arguments)}function eO(){var e=[.5],r=[0,1],n,a=1;function l(o){return o!=null&&o<=o?r[vu(e,o,0,a)]:n}return l.domain=function(o){return arguments.length?(e=Array.from(o),a=Math.min(e.length,r.length-1),l):e.slice()},l.range=function(o){return arguments.length?(r=Array.from(o),a=Math.min(e.length,r.length-1),l):r.slice()},l.invertExtent=function(o){var u=r.indexOf(o);return[e[u-1],e[u]]},l.unknown=function(o){return arguments.length?(n=o,l):n},l.copy=function(){return eO().domain(e).range(r).unknown(n)},Bn.apply(l,arguments)}const ax=new Date,ix=new Date;function lr(e,r,n,a){function l(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return l.floor=o=>(e(o=new Date(+o)),o),l.ceil=o=>(e(o=new Date(o-1)),r(o,1),e(o),o),l.round=o=>{const u=l(o),d=l.ceil(o);return o-u<d-o?u:d},l.offset=(o,u)=>(r(o=new Date(+o),u==null?1:Math.floor(u)),o),l.range=(o,u,d)=>{const f=[];if(o=l.ceil(o),d=d==null?1:Math.floor(d),!(o<u)||!(d>0))return f;let p;do f.push(p=new Date(+o)),r(o,d),e(o);while(p<o&&o<u);return f},l.filter=o=>lr(u=>{if(u>=u)for(;e(u),!o(u);)u.setTime(u-1)},(u,d)=>{if(u>=u)if(d<0)for(;++d<=0;)for(;r(u,-1),!o(u););else for(;--d>=0;)for(;r(u,1),!o(u););}),n&&(l.count=(o,u)=>(ax.setTime(+o),ix.setTime(+u),e(ax),e(ix),Math.floor(n(ax,ix))),l.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?l.filter(a?u=>a(u)%o===0:u=>l.count(0,u)%o===0):l)),l}const Jm=lr(()=>{},(e,r)=>{e.setTime(+e+r)},(e,r)=>r-e);Jm.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?lr(r=>{r.setTime(Math.floor(r/e)*e)},(r,n)=>{r.setTime(+r+n*e)},(r,n)=>(n-r)/e):Jm);Jm.range;const Wa=1e3,Pn=Wa*60,Xa=Pn*60,ri=Xa*24,zy=ri*7,KC=ri*30,sx=ri*365,qs=lr(e=>{e.setTime(e-e.getMilliseconds())},(e,r)=>{e.setTime(+e+r*Wa)},(e,r)=>(r-e)/Wa,e=>e.getUTCSeconds());qs.range;const ky=lr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Wa)},(e,r)=>{e.setTime(+e+r*Pn)},(e,r)=>(r-e)/Pn,e=>e.getMinutes());ky.range;const Oy=lr(e=>{e.setUTCSeconds(0,0)},(e,r)=>{e.setTime(+e+r*Pn)},(e,r)=>(r-e)/Pn,e=>e.getUTCMinutes());Oy.range;const Dy=lr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Wa-e.getMinutes()*Pn)},(e,r)=>{e.setTime(+e+r*Xa)},(e,r)=>(r-e)/Xa,e=>e.getHours());Dy.range;const Py=lr(e=>{e.setUTCMinutes(0,0,0)},(e,r)=>{e.setTime(+e+r*Xa)},(e,r)=>(r-e)/Xa,e=>e.getUTCHours());Py.range;const bu=lr(e=>e.setHours(0,0,0,0),(e,r)=>e.setDate(e.getDate()+r),(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Pn)/ri,e=>e.getDate()-1);bu.range;const Zf=lr(e=>{e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r)},(e,r)=>(r-e)/ri,e=>e.getUTCDate()-1);Zf.range;const tO=lr(e=>{e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r)},(e,r)=>(r-e)/ri,e=>Math.floor(e/ri));tO.range;function al(e){return lr(r=>{r.setDate(r.getDate()-(r.getDay()+7-e)%7),r.setHours(0,0,0,0)},(r,n)=>{r.setDate(r.getDate()+n*7)},(r,n)=>(n-r-(n.getTimezoneOffset()-r.getTimezoneOffset())*Pn)/zy)}const Jf=al(0),ef=al(1),uB=al(2),dB=al(3),xo=al(4),mB=al(5),fB=al(6);Jf.range;ef.range;uB.range;dB.range;xo.range;mB.range;fB.range;function il(e){return lr(r=>{r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-e)%7),r.setUTCHours(0,0,0,0)},(r,n)=>{r.setUTCDate(r.getUTCDate()+n*7)},(r,n)=>(n-r)/zy)}const ep=il(0),tf=il(1),pB=il(2),hB=il(3),bo=il(4),vB=il(5),gB=il(6);ep.range;tf.range;pB.range;hB.range;bo.range;vB.range;gB.range;const My=lr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,r)=>{e.setMonth(e.getMonth()+r)},(e,r)=>r.getMonth()-e.getMonth()+(r.getFullYear()-e.getFullYear())*12,e=>e.getMonth());My.range;const Ty=lr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCMonth(e.getUTCMonth()+r)},(e,r)=>r.getUTCMonth()-e.getUTCMonth()+(r.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Ty.range;const ni=lr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r)},(e,r)=>r.getFullYear()-e.getFullYear(),e=>e.getFullYear());ni.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:lr(r=>{r.setFullYear(Math.floor(r.getFullYear()/e)*e),r.setMonth(0,1),r.setHours(0,0,0,0)},(r,n)=>{r.setFullYear(r.getFullYear()+n*e)});ni.range;const ai=lr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r)},(e,r)=>r.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ai.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:lr(r=>{r.setUTCFullYear(Math.floor(r.getUTCFullYear()/e)*e),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,n)=>{r.setUTCFullYear(r.getUTCFullYear()+n*e)});ai.range;function rO(e,r,n,a,l,o){const u=[[qs,1,Wa],[qs,5,5*Wa],[qs,15,15*Wa],[qs,30,30*Wa],[o,1,Pn],[o,5,5*Pn],[o,15,15*Pn],[o,30,30*Pn],[l,1,Xa],[l,3,3*Xa],[l,6,6*Xa],[l,12,12*Xa],[a,1,ri],[a,2,2*ri],[n,1,zy],[r,1,KC],[r,3,3*KC],[e,1,sx]];function d(p,h,v){const b=h<p;b&&([p,h]=[h,p]);const x=v&&typeof v.range=="function"?v:f(p,h,v),j=x?x.range(p,+h+1):[];return b?j.reverse():j}function f(p,h,v){const b=Math.abs(h-p)/v,x=vy(([,,C])=>C).right(u,b);if(x===u.length)return e.every(fb(p/sx,h/sx,v));if(x===0)return Jm.every(Math.max(fb(p,h,v),1));const[j,_]=u[b/u[x-1][2]<u[x][2]/b?x-1:x];return j.every(_)}return[d,f]}const[xB,bB]=rO(ai,Ty,ep,tO,Py,Oy),[yB,jB]=rO(ni,My,Jf,bu,Dy,ky);function lx(e){if(0<=e.y&&e.y<100){var r=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return r.setFullYear(e.y),r}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ox(e){if(0<=e.y&&e.y<100){var r=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return r.setUTCFullYear(e.y),r}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Cc(e,r,n){return{y:e,m:r,d:n,H:0,M:0,S:0,L:0}}function _B(e){var r=e.dateTime,n=e.date,a=e.time,l=e.periods,o=e.days,u=e.shortDays,d=e.months,f=e.shortMonths,p=Ec(l),h=Ac(l),v=Ec(o),b=Ac(o),x=Ec(u),j=Ac(u),_=Ec(d),C=Ac(d),w=Ec(f),E=Ac(f),S={a:F,A:I,b:X,B:L,c:null,d:t2,e:t2,f:HB,g:t9,G:n9,H:UB,I:FB,j:GB,L:nO,m:VB,M:QB,p:ne,q:K,Q:a2,s:i2,S:YB,u:KB,U:WB,V:XB,w:ZB,W:JB,x:null,X:null,y:e9,Y:r9,Z:a9,"%":n2},A={a:oe,A:xe,b:ve,B:H,c:null,d:r2,e:r2,f:o9,g:x9,G:y9,H:i9,I:s9,j:l9,L:iO,m:c9,M:u9,p:he,q:Me,Q:a2,s:i2,S:d9,u:m9,U:f9,V:p9,w:h9,W:v9,x:null,X:null,y:g9,Y:b9,Z:j9,"%":n2},O={a:U,A:$,b:R,B:Y,c:ae,d:JC,e:JC,f:IB,g:ZC,G:XC,H:e2,I:e2,j:MB,L:RB,m:PB,M:TB,p:B,q:DB,Q:$B,s:BB,S:qB,u:EB,U:AB,V:zB,w:CB,W:kB,x:M,X:T,y:ZC,Y:XC,Z:OB,"%":LB};S.x=k(n,S),S.X=k(a,S),S.c=k(r,S),A.x=k(n,A),A.X=k(a,A),A.c=k(r,A);function k(ue,Z){return function(V){var me=[],we=-1,qe=0,Xe=ue.length,et,it,jr;for(V instanceof Date||(V=new Date(+V));++we<Xe;)ue.charCodeAt(we)===37&&(me.push(ue.slice(qe,we)),(it=WC[et=ue.charAt(++we)])!=null?et=ue.charAt(++we):it=et==="e"?" ":"0",(jr=Z[et])&&(et=jr(V,it)),me.push(et),qe=we+1);return me.push(ue.slice(qe,we)),me.join("")}}function P(ue,Z){return function(V){var me=Cc(1900,void 0,1),we=D(me,ue,V+="",0),qe,Xe;if(we!=V.length)return null;if("Q"in me)return new Date(me.Q);if("s"in me)return new Date(me.s*1e3+("L"in me?me.L:0));if(Z&&!("Z"in me)&&(me.Z=0),"p"in me&&(me.H=me.H%12+me.p*12),me.m===void 0&&(me.m="q"in me?me.q:0),"V"in me){if(me.V<1||me.V>53)return null;"w"in me||(me.w=1),"Z"in me?(qe=ox(Cc(me.y,0,1)),Xe=qe.getUTCDay(),qe=Xe>4||Xe===0?tf.ceil(qe):tf(qe),qe=Zf.offset(qe,(me.V-1)*7),me.y=qe.getUTCFullYear(),me.m=qe.getUTCMonth(),me.d=qe.getUTCDate()+(me.w+6)%7):(qe=lx(Cc(me.y,0,1)),Xe=qe.getDay(),qe=Xe>4||Xe===0?ef.ceil(qe):ef(qe),qe=bu.offset(qe,(me.V-1)*7),me.y=qe.getFullYear(),me.m=qe.getMonth(),me.d=qe.getDate()+(me.w+6)%7)}else("W"in me||"U"in me)&&("w"in me||(me.w="u"in me?me.u%7:"W"in me?1:0),Xe="Z"in me?ox(Cc(me.y,0,1)).getUTCDay():lx(Cc(me.y,0,1)).getDay(),me.m=0,me.d="W"in me?(me.w+6)%7+me.W*7-(Xe+5)%7:me.w+me.U*7-(Xe+6)%7);return"Z"in me?(me.H+=me.Z/100|0,me.M+=me.Z%100,ox(me)):lx(me)}}function D(ue,Z,V,me){for(var we=0,qe=Z.length,Xe=V.length,et,it;we<qe;){if(me>=Xe)return-1;if(et=Z.charCodeAt(we++),et===37){if(et=Z.charAt(we++),it=O[et in WC?Z.charAt(we++):et],!it||(me=it(ue,V,me))<0)return-1}else if(et!=V.charCodeAt(me++))return-1}return me}function B(ue,Z,V){var me=p.exec(Z.slice(V));return me?(ue.p=h.get(me[0].toLowerCase()),V+me[0].length):-1}function U(ue,Z,V){var me=x.exec(Z.slice(V));return me?(ue.w=j.get(me[0].toLowerCase()),V+me[0].length):-1}function $(ue,Z,V){var me=v.exec(Z.slice(V));return me?(ue.w=b.get(me[0].toLowerCase()),V+me[0].length):-1}function R(ue,Z,V){var me=w.exec(Z.slice(V));return me?(ue.m=E.get(me[0].toLowerCase()),V+me[0].length):-1}function Y(ue,Z,V){var me=_.exec(Z.slice(V));return me?(ue.m=C.get(me[0].toLowerCase()),V+me[0].length):-1}function ae(ue,Z,V){return D(ue,r,Z,V)}function M(ue,Z,V){return D(ue,n,Z,V)}function T(ue,Z,V){return D(ue,a,Z,V)}function F(ue){return u[ue.getDay()]}function I(ue){return o[ue.getDay()]}function X(ue){return f[ue.getMonth()]}function L(ue){return d[ue.getMonth()]}function ne(ue){return l[+(ue.getHours()>=12)]}function K(ue){return 1+~~(ue.getMonth()/3)}function oe(ue){return u[ue.getUTCDay()]}function xe(ue){return o[ue.getUTCDay()]}function ve(ue){return f[ue.getUTCMonth()]}function H(ue){return d[ue.getUTCMonth()]}function he(ue){return l[+(ue.getUTCHours()>=12)]}function Me(ue){return 1+~~(ue.getUTCMonth()/3)}return{format:function(ue){var Z=k(ue+="",S);return Z.toString=function(){return ue},Z},parse:function(ue){var Z=P(ue+="",!1);return Z.toString=function(){return ue},Z},utcFormat:function(ue){var Z=k(ue+="",A);return Z.toString=function(){return ue},Z},utcParse:function(ue){var Z=P(ue+="",!0);return Z.toString=function(){return ue},Z}}}var WC={"-":"",_:" ",0:"0"},xr=/^\s*\d+/,NB=/^%/,SB=/[\\^$*+?|[\]().{}]/g;function mt(e,r,n){var a=e<0?"-":"",l=(a?-e:e)+"",o=l.length;return a+(o<n?new Array(n-o+1).join(r)+l:l)}function wB(e){return e.replace(SB,"\\$&")}function Ec(e){return new RegExp("^(?:"+e.map(wB).join("|")+")","i")}function Ac(e){return new Map(e.map((r,n)=>[r.toLowerCase(),n]))}function CB(e,r,n){var a=xr.exec(r.slice(n,n+1));return a?(e.w=+a[0],n+a[0].length):-1}function EB(e,r,n){var a=xr.exec(r.slice(n,n+1));return a?(e.u=+a[0],n+a[0].length):-1}function AB(e,r,n){var a=xr.exec(r.slice(n,n+2));return a?(e.U=+a[0],n+a[0].length):-1}function zB(e,r,n){var a=xr.exec(r.slice(n,n+2));return a?(e.V=+a[0],n+a[0].length):-1}function kB(e,r,n){var a=xr.exec(r.slice(n,n+2));return a?(e.W=+a[0],n+a[0].length):-1}function XC(e,r,n){var a=xr.exec(r.slice(n,n+4));return a?(e.y=+a[0],n+a[0].length):-1}function ZC(e,r,n){var a=xr.exec(r.slice(n,n+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function OB(e,r,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(n,n+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function DB(e,r,n){var a=xr.exec(r.slice(n,n+1));return a?(e.q=a[0]*3-3,n+a[0].length):-1}function PB(e,r,n){var a=xr.exec(r.slice(n,n+2));return a?(e.m=a[0]-1,n+a[0].length):-1}function JC(e,r,n){var a=xr.exec(r.slice(n,n+2));return a?(e.d=+a[0],n+a[0].length):-1}function MB(e,r,n){var a=xr.exec(r.slice(n,n+3));return a?(e.m=0,e.d=+a[0],n+a[0].length):-1}function e2(e,r,n){var a=xr.exec(r.slice(n,n+2));return a?(e.H=+a[0],n+a[0].length):-1}function TB(e,r,n){var a=xr.exec(r.slice(n,n+2));return a?(e.M=+a[0],n+a[0].length):-1}function qB(e,r,n){var a=xr.exec(r.slice(n,n+2));return a?(e.S=+a[0],n+a[0].length):-1}function RB(e,r,n){var a=xr.exec(r.slice(n,n+3));return a?(e.L=+a[0],n+a[0].length):-1}function IB(e,r,n){var a=xr.exec(r.slice(n,n+6));return a?(e.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function LB(e,r,n){var a=NB.exec(r.slice(n,n+1));return a?n+a[0].length:-1}function $B(e,r,n){var a=xr.exec(r.slice(n));return a?(e.Q=+a[0],n+a[0].length):-1}function BB(e,r,n){var a=xr.exec(r.slice(n));return a?(e.s=+a[0],n+a[0].length):-1}function t2(e,r){return mt(e.getDate(),r,2)}function UB(e,r){return mt(e.getHours(),r,2)}function FB(e,r){return mt(e.getHours()%12||12,r,2)}function GB(e,r){return mt(1+bu.count(ni(e),e),r,3)}function nO(e,r){return mt(e.getMilliseconds(),r,3)}function HB(e,r){return nO(e,r)+"000"}function VB(e,r){return mt(e.getMonth()+1,r,2)}function QB(e,r){return mt(e.getMinutes(),r,2)}function YB(e,r){return mt(e.getSeconds(),r,2)}function KB(e){var r=e.getDay();return r===0?7:r}function WB(e,r){return mt(Jf.count(ni(e)-1,e),r,2)}function aO(e){var r=e.getDay();return r>=4||r===0?xo(e):xo.ceil(e)}function XB(e,r){return e=aO(e),mt(xo.count(ni(e),e)+(ni(e).getDay()===4),r,2)}function ZB(e){return e.getDay()}function JB(e,r){return mt(ef.count(ni(e)-1,e),r,2)}function e9(e,r){return mt(e.getFullYear()%100,r,2)}function t9(e,r){return e=aO(e),mt(e.getFullYear()%100,r,2)}function r9(e,r){return mt(e.getFullYear()%1e4,r,4)}function n9(e,r){var n=e.getDay();return e=n>=4||n===0?xo(e):xo.ceil(e),mt(e.getFullYear()%1e4,r,4)}function a9(e){var r=e.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+mt(r/60|0,"0",2)+mt(r%60,"0",2)}function r2(e,r){return mt(e.getUTCDate(),r,2)}function i9(e,r){return mt(e.getUTCHours(),r,2)}function s9(e,r){return mt(e.getUTCHours()%12||12,r,2)}function l9(e,r){return mt(1+Zf.count(ai(e),e),r,3)}function iO(e,r){return mt(e.getUTCMilliseconds(),r,3)}function o9(e,r){return iO(e,r)+"000"}function c9(e,r){return mt(e.getUTCMonth()+1,r,2)}function u9(e,r){return mt(e.getUTCMinutes(),r,2)}function d9(e,r){return mt(e.getUTCSeconds(),r,2)}function m9(e){var r=e.getUTCDay();return r===0?7:r}function f9(e,r){return mt(ep.count(ai(e)-1,e),r,2)}function sO(e){var r=e.getUTCDay();return r>=4||r===0?bo(e):bo.ceil(e)}function p9(e,r){return e=sO(e),mt(bo.count(ai(e),e)+(ai(e).getUTCDay()===4),r,2)}function h9(e){return e.getUTCDay()}function v9(e,r){return mt(tf.count(ai(e)-1,e),r,2)}function g9(e,r){return mt(e.getUTCFullYear()%100,r,2)}function x9(e,r){return e=sO(e),mt(e.getUTCFullYear()%100,r,2)}function b9(e,r){return mt(e.getUTCFullYear()%1e4,r,4)}function y9(e,r){var n=e.getUTCDay();return e=n>=4||n===0?bo(e):bo.ceil(e),mt(e.getUTCFullYear()%1e4,r,4)}function j9(){return"+0000"}function n2(){return"%"}function a2(e){return+e}function i2(e){return Math.floor(+e/1e3)}var Zl,lO,oO;_9({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function _9(e){return Zl=_B(e),lO=Zl.format,Zl.parse,oO=Zl.utcFormat,Zl.utcParse,Zl}function N9(e){return new Date(e)}function S9(e){return e instanceof Date?+e:+new Date(+e)}function qy(e,r,n,a,l,o,u,d,f,p){var h=_y(),v=h.invert,b=h.domain,x=p(".%L"),j=p(":%S"),_=p("%I:%M"),C=p("%I %p"),w=p("%a %d"),E=p("%b %d"),S=p("%B"),A=p("%Y");function O(k){return(f(k)<k?x:d(k)<k?j:u(k)<k?_:o(k)<k?C:a(k)<k?l(k)<k?w:E:n(k)<k?S:A)(k)}return h.invert=function(k){return new Date(v(k))},h.domain=function(k){return arguments.length?b(Array.from(k,S9)):b().map(N9)},h.ticks=function(k){var P=b();return e(P[0],P[P.length-1],k??10)},h.tickFormat=function(k,P){return P==null?O:p(P)},h.nice=function(k){var P=b();return(!k||typeof k.range!="function")&&(k=r(P[0],P[P.length-1],k??10)),k?b(Yk(P,k)):h},h.copy=function(){return xu(h,qy(e,r,n,a,l,o,u,d,f,p))},h}function w9(){return Bn.apply(qy(yB,jB,ni,My,Jf,bu,Dy,ky,qs,lO).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function C9(){return Bn.apply(qy(xB,bB,ai,Ty,ep,Zf,Py,Oy,qs,oO).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function tp(){var e=0,r=1,n,a,l,o,u=Ir,d=!1,f;function p(v){return v==null||isNaN(v=+v)?f:u(l===0?.5:(v=(o(v)-n)*l,d?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,r]=v,n=o(e=+e),a=o(r=+r),l=n===a?0:1/(a-n),p):[e,r]},p.clamp=function(v){return arguments.length?(d=!!v,p):d},p.interpolator=function(v){return arguments.length?(u=v,p):u};function h(v){return function(b){var x,j;return arguments.length?([x,j]=b,u=v(x,j),p):[u(0),u(1)]}}return p.range=h(yo),p.rangeRound=h(jy),p.unknown=function(v){return arguments.length?(f=v,p):f},function(v){return o=v,n=v(e),a=v(r),l=n===a?0:1/(a-n),p}}function ls(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function cO(){var e=ss(tp()(Ir));return e.copy=function(){return ls(e,cO())},mi.apply(e,arguments)}function uO(){var e=wy(tp()).domain([1,10]);return e.copy=function(){return ls(e,uO()).base(e.base())},mi.apply(e,arguments)}function dO(){var e=Cy(tp());return e.copy=function(){return ls(e,dO()).constant(e.constant())},mi.apply(e,arguments)}function Ry(){var e=Ey(tp());return e.copy=function(){return ls(e,Ry()).exponent(e.exponent())},mi.apply(e,arguments)}function E9(){return Ry.apply(null,arguments).exponent(.5)}function mO(){var e=[],r=Ir;function n(a){if(a!=null&&!isNaN(a=+a))return r((vu(e,a,1)-1)/(e.length-1))}return n.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let l of a)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Xi),n},n.interpolator=function(a){return arguments.length?(r=a,n):r},n.range=function(){return e.map((a,l)=>r(l/(e.length-1)))},n.quantiles=function(a){return Array.from({length:a+1},(l,o)=>m7(e,o/a))},n.copy=function(){return mO(r).domain(e)},mi.apply(n,arguments)}function rp(){var e=0,r=.5,n=1,a=1,l,o,u,d,f,p=Ir,h,v=!1,b;function x(_){return isNaN(_=+_)?b:(_=.5+((_=+h(_))-o)*(a*_<a*o?d:f),p(v?Math.max(0,Math.min(1,_)):_))}x.domain=function(_){return arguments.length?([e,r,n]=_,l=h(e=+e),o=h(r=+r),u=h(n=+n),d=l===o?0:.5/(o-l),f=o===u?0:.5/(u-o),a=o<l?-1:1,x):[e,r,n]},x.clamp=function(_){return arguments.length?(v=!!_,x):v},x.interpolator=function(_){return arguments.length?(p=_,x):p};function j(_){return function(C){var w,E,S;return arguments.length?([w,E,S]=C,p=L7(_,[w,E,S]),x):[p(0),p(.5),p(1)]}}return x.range=j(yo),x.rangeRound=j(jy),x.unknown=function(_){return arguments.length?(b=_,x):b},function(_){return h=_,l=_(e),o=_(r),u=_(n),d=l===o?0:.5/(o-l),f=o===u?0:.5/(u-o),a=o<l?-1:1,x}}function fO(){var e=ss(rp()(Ir));return e.copy=function(){return ls(e,fO())},mi.apply(e,arguments)}function pO(){var e=wy(rp()).domain([.1,1,10]);return e.copy=function(){return ls(e,pO()).base(e.base())},mi.apply(e,arguments)}function hO(){var e=Cy(rp());return e.copy=function(){return ls(e,hO()).constant(e.constant())},mi.apply(e,arguments)}function Iy(){var e=Ey(rp());return e.copy=function(){return ls(e,Iy()).exponent(e.exponent())},mi.apply(e,arguments)}function A9(){return Iy.apply(null,arguments).exponent(.5)}const Tc=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:xy,scaleDiverging:fO,scaleDivergingLog:pO,scaleDivergingPow:Iy,scaleDivergingSqrt:A9,scaleDivergingSymlog:hO,scaleIdentity:Qk,scaleImplicit:pb,scaleLinear:Vk,scaleLog:Kk,scaleOrdinal:gy,scalePoint:h7,scalePow:Ay,scaleQuantile:Zk,scaleQuantize:Jk,scaleRadial:Xk,scaleSequential:cO,scaleSequentialLog:uO,scaleSequentialPow:Ry,scaleSequentialQuantile:mO,scaleSequentialSqrt:E9,scaleSequentialSymlog:dO,scaleSqrt:oB,scaleSymlog:Wk,scaleThreshold:eO,scaleTime:w9,scaleUtc:C9,tickFormat:Hk},Symbol.toStringTag,{value:"Module"}));var fi=e=>e.chartData,vO=de([fi],e=>{var r=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:r,dataStartIndex:0}}),Ly=(e,r,n,a)=>a?vO(e):fi(e),z9=(e,r,n)=>n?vO(e):fi(e);function ii(e){if(Array.isArray(e)&&e.length===2){var[r,n]=e;if(ot(r)&&ot(n))return!0}return!1}function s2(e,r,n){return n?e:[Math.min(e[0],r[0]),Math.max(e[1],r[1])]}function gO(e,r){if(r&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[n,a]=e,l,o;if(ot(n))l=n;else if(typeof n=="function")return;if(ot(a))o=a;else if(typeof a=="function")return;var u=[l,o];if(ii(u))return u}}function k9(e,r,n){if(!(!n&&r==null)){if(typeof e=="function"&&r!=null)try{var a=e(r,n);if(ii(a))return s2(a,r,n)}catch{}if(Array.isArray(e)&&e.length===2){var[l,o]=e,u,d;if(l==="auto")r!=null&&(u=Math.min(...r));else if(De(l))u=l;else if(typeof l=="function")try{r!=null&&(u=l(r?.[0]))}catch{}else if(typeof l=="string"&&gw.test(l)){var f=gw.exec(l);if(f==null||f[1]==null||r==null)u=void 0;else{var p=+f[1];u=r[0]-p}}else u=r?.[0];if(o==="auto")r!=null&&(d=Math.max(...r));else if(De(o))d=o;else if(typeof o=="function")try{r!=null&&(d=o(r?.[1]))}catch{}else if(typeof o=="string"&&xw.test(o)){var h=xw.exec(o);if(h==null||h[1]==null||r==null)d=void 0;else{var v=+h[1];d=r[1]+v}}else d=r?.[1];var b=[u,d];if(ii(b))return r==null?b:s2(b,r,n)}}}var jo=1e9,O9={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},By,qt=!0,In="[DecimalError] ",Gs=In+"Invalid argument: ",$y=In+"Exponent out of range: ",_o=Math.floor,Ps=Math.pow,D9=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fn,hr=1e7,Ot=7,xO=9007199254740991,rf=_o(xO/Ot),ke={};ke.absoluteValue=ke.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ke.comparedTo=ke.cmp=function(e){var r,n,a,l,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(a=o.d.length,l=e.d.length,r=0,n=a<l?a:l;r<n;++r)if(o.d[r]!==e.d[r])return o.d[r]>e.d[r]^o.s<0?1:-1;return a===l?0:a>l^o.s<0?1:-1};ke.decimalPlaces=ke.dp=function(){var e=this,r=e.d.length-1,n=(r-e.e)*Ot;if(r=e.d[r],r)for(;r%10==0;r/=10)n--;return n<0?0:n};ke.dividedBy=ke.div=function(e){return Ja(this,new this.constructor(e))};ke.dividedToIntegerBy=ke.idiv=function(e){var r=this,n=r.constructor;return Ct(Ja(r,new n(e),0,1),n.precision)};ke.equals=ke.eq=function(e){return!this.cmp(e)};ke.exponent=function(){return rr(this)};ke.greaterThan=ke.gt=function(e){return this.cmp(e)>0};ke.greaterThanOrEqualTo=ke.gte=function(e){return this.cmp(e)>=0};ke.isInteger=ke.isint=function(){return this.e>this.d.length-2};ke.isNegative=ke.isneg=function(){return this.s<0};ke.isPositive=ke.ispos=function(){return this.s>0};ke.isZero=function(){return this.s===0};ke.lessThan=ke.lt=function(e){return this.cmp(e)<0};ke.lessThanOrEqualTo=ke.lte=function(e){return this.cmp(e)<1};ke.logarithm=ke.log=function(e){var r,n=this,a=n.constructor,l=a.precision,o=l+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(fn))throw Error(In+"NaN");if(n.s<1)throw Error(In+(n.s?"NaN":"-Infinity"));return n.eq(fn)?new a(0):(qt=!1,r=Ja(tu(n,o),tu(e,o),o),qt=!0,Ct(r,l))};ke.minus=ke.sub=function(e){var r=this;return e=new r.constructor(e),r.s==e.s?jO(r,e):bO(r,(e.s=-e.s,e))};ke.modulo=ke.mod=function(e){var r,n=this,a=n.constructor,l=a.precision;if(e=new a(e),!e.s)throw Error(In+"NaN");return n.s?(qt=!1,r=Ja(n,e,0,1).times(e),qt=!0,n.minus(r)):Ct(new a(n),l)};ke.naturalExponential=ke.exp=function(){return yO(this)};ke.naturalLogarithm=ke.ln=function(){return tu(this)};ke.negated=ke.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ke.plus=ke.add=function(e){var r=this;return e=new r.constructor(e),r.s==e.s?bO(r,e):jO(r,(e.s=-e.s,e))};ke.precision=ke.sd=function(e){var r,n,a,l=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Gs+e);if(r=rr(l)+1,a=l.d.length-1,n=a*Ot+1,a=l.d[a],a){for(;a%10==0;a/=10)n--;for(a=l.d[0];a>=10;a/=10)n++}return e&&r>n?r:n};ke.squareRoot=ke.sqrt=function(){var e,r,n,a,l,o,u,d=this,f=d.constructor;if(d.s<1){if(!d.s)return new f(0);throw Error(In+"NaN")}for(e=rr(d),qt=!1,l=Math.sqrt(+d),l==0||l==1/0?(r=va(d.d),(r.length+e)%2==0&&(r+="0"),l=Math.sqrt(r),e=_o((e+1)/2)-(e<0||e%2),l==1/0?r="5e"+e:(r=l.toExponential(),r=r.slice(0,r.indexOf("e")+1)+e),a=new f(r)):a=new f(l.toString()),n=f.precision,l=u=n+3;;)if(o=a,a=o.plus(Ja(d,o,u+2)).times(.5),va(o.d).slice(0,u)===(r=va(a.d)).slice(0,u)){if(r=r.slice(u-3,u+1),l==u&&r=="4999"){if(Ct(o,n+1,0),o.times(o).eq(d)){a=o;break}}else if(r!="9999")break;u+=4}return qt=!0,Ct(a,n)};ke.times=ke.mul=function(e){var r,n,a,l,o,u,d,f,p,h=this,v=h.constructor,b=h.d,x=(e=new v(e)).d;if(!h.s||!e.s)return new v(0);for(e.s*=h.s,n=h.e+e.e,f=b.length,p=x.length,f<p&&(o=b,b=x,x=o,u=f,f=p,p=u),o=[],u=f+p,a=u;a--;)o.push(0);for(a=p;--a>=0;){for(r=0,l=f+a;l>a;)d=o[l]+x[a]*b[l-a-1]+r,o[l--]=d%hr|0,r=d/hr|0;o[l]=(o[l]+r)%hr|0}for(;!o[--u];)o.pop();return r?++n:o.shift(),e.d=o,e.e=n,qt?Ct(e,v.precision):e};ke.toDecimalPlaces=ke.todp=function(e,r){var n=this,a=n.constructor;return n=new a(n),e===void 0?n:(Na(e,0,jo),r===void 0?r=a.rounding:Na(r,0,8),Ct(n,e+rr(n)+1,r))};ke.toExponential=function(e,r){var n,a=this,l=a.constructor;return e===void 0?n=Ws(a,!0):(Na(e,0,jo),r===void 0?r=l.rounding:Na(r,0,8),a=Ct(new l(a),e+1,r),n=Ws(a,!0,e+1)),n};ke.toFixed=function(e,r){var n,a,l=this,o=l.constructor;return e===void 0?Ws(l):(Na(e,0,jo),r===void 0?r=o.rounding:Na(r,0,8),a=Ct(new o(l),e+rr(l)+1,r),n=Ws(a.abs(),!1,e+rr(a)+1),l.isneg()&&!l.isZero()?"-"+n:n)};ke.toInteger=ke.toint=function(){var e=this,r=e.constructor;return Ct(new r(e),rr(e)+1,r.rounding)};ke.toNumber=function(){return+this};ke.toPower=ke.pow=function(e){var r,n,a,l,o,u,d=this,f=d.constructor,p=12,h=+(e=new f(e));if(!e.s)return new f(fn);if(d=new f(d),!d.s){if(e.s<1)throw Error(In+"Infinity");return d}if(d.eq(fn))return d;if(a=f.precision,e.eq(fn))return Ct(d,a);if(r=e.e,n=e.d.length-1,u=r>=n,o=d.s,u){if((n=h<0?-h:h)<=xO){for(l=new f(fn),r=Math.ceil(a/Ot+4),qt=!1;n%2&&(l=l.times(d),o2(l.d,r)),n=_o(n/2),n!==0;)d=d.times(d),o2(d.d,r);return qt=!0,e.s<0?new f(fn).div(l):Ct(l,a)}}else if(o<0)throw Error(In+"NaN");return o=o<0&&e.d[Math.max(r,n)]&1?-1:1,d.s=1,qt=!1,l=e.times(tu(d,a+p)),qt=!0,l=yO(l),l.s=o,l};ke.toPrecision=function(e,r){var n,a,l=this,o=l.constructor;return e===void 0?(n=rr(l),a=Ws(l,n<=o.toExpNeg||n>=o.toExpPos)):(Na(e,1,jo),r===void 0?r=o.rounding:Na(r,0,8),l=Ct(new o(l),e,r),n=rr(l),a=Ws(l,e<=n||n<=o.toExpNeg,e)),a};ke.toSignificantDigits=ke.tosd=function(e,r){var n=this,a=n.constructor;return e===void 0?(e=a.precision,r=a.rounding):(Na(e,1,jo),r===void 0?r=a.rounding:Na(r,0,8)),Ct(new a(n),e,r)};ke.toString=ke.valueOf=ke.val=ke.toJSON=ke[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,r=rr(e),n=e.constructor;return Ws(e,r<=n.toExpNeg||r>=n.toExpPos)};function bO(e,r){var n,a,l,o,u,d,f,p,h=e.constructor,v=h.precision;if(!e.s||!r.s)return r.s||(r=new h(e)),qt?Ct(r,v):r;if(f=e.d,p=r.d,u=e.e,l=r.e,f=f.slice(),o=u-l,o){for(o<0?(a=f,o=-o,d=p.length):(a=p,l=u,d=f.length),u=Math.ceil(v/Ot),d=u>d?u+1:d+1,o>d&&(o=d,a.length=1),a.reverse();o--;)a.push(0);a.reverse()}for(d=f.length,o=p.length,d-o<0&&(o=d,a=p,p=f,f=a),n=0;o;)n=(f[--o]=f[o]+p[o]+n)/hr|0,f[o]%=hr;for(n&&(f.unshift(n),++l),d=f.length;f[--d]==0;)f.pop();return r.d=f,r.e=l,qt?Ct(r,v):r}function Na(e,r,n){if(e!==~~e||e<r||e>n)throw Error(Gs+e)}function va(e){var r,n,a,l=e.length-1,o="",u=e[0];if(l>0){for(o+=u,r=1;r<l;r++)a=e[r]+"",n=Ot-a.length,n&&(o+=Hi(n)),o+=a;u=e[r],a=u+"",n=Ot-a.length,n&&(o+=Hi(n))}else if(u===0)return"0";for(;u%10===0;)u/=10;return o+u}var Ja=(function(){function e(a,l){var o,u=0,d=a.length;for(a=a.slice();d--;)o=a[d]*l+u,a[d]=o%hr|0,u=o/hr|0;return u&&a.unshift(u),a}function r(a,l,o,u){var d,f;if(o!=u)f=o>u?1:-1;else for(d=f=0;d<o;d++)if(a[d]!=l[d]){f=a[d]>l[d]?1:-1;break}return f}function n(a,l,o){for(var u=0;o--;)a[o]-=u,u=a[o]<l[o]?1:0,a[o]=u*hr+a[o]-l[o];for(;!a[0]&&a.length>1;)a.shift()}return function(a,l,o,u){var d,f,p,h,v,b,x,j,_,C,w,E,S,A,O,k,P,D,B=a.constructor,U=a.s==l.s?1:-1,$=a.d,R=l.d;if(!a.s)return new B(a);if(!l.s)throw Error(In+"Division by zero");for(f=a.e-l.e,P=R.length,O=$.length,x=new B(U),j=x.d=[],p=0;R[p]==($[p]||0);)++p;if(R[p]>($[p]||0)&&--f,o==null?E=o=B.precision:u?E=o+(rr(a)-rr(l))+1:E=o,E<0)return new B(0);if(E=E/Ot+2|0,p=0,P==1)for(h=0,R=R[0],E++;(p<O||h)&&E--;p++)S=h*hr+($[p]||0),j[p]=S/R|0,h=S%R|0;else{for(h=hr/(R[0]+1)|0,h>1&&(R=e(R,h),$=e($,h),P=R.length,O=$.length),A=P,_=$.slice(0,P),C=_.length;C<P;)_[C++]=0;D=R.slice(),D.unshift(0),k=R[0],R[1]>=hr/2&&++k;do h=0,d=r(R,_,P,C),d<0?(w=_[0],P!=C&&(w=w*hr+(_[1]||0)),h=w/k|0,h>1?(h>=hr&&(h=hr-1),v=e(R,h),b=v.length,C=_.length,d=r(v,_,b,C),d==1&&(h--,n(v,P<b?D:R,b))):(h==0&&(d=h=1),v=R.slice()),b=v.length,b<C&&v.unshift(0),n(_,v,C),d==-1&&(C=_.length,d=r(R,_,P,C),d<1&&(h++,n(_,P<C?D:R,C))),C=_.length):d===0&&(h++,_=[0]),j[p++]=h,d&&_[0]?_[C++]=$[A]||0:(_=[$[A]],C=1);while((A++<O||_[0]!==void 0)&&E--)}return j[0]||j.shift(),x.e=f,Ct(x,u?o+rr(x)+1:o)}})();function yO(e,r){var n,a,l,o,u,d,f=0,p=0,h=e.constructor,v=h.precision;if(rr(e)>16)throw Error($y+rr(e));if(!e.s)return new h(fn);for(qt=!1,d=v,u=new h(.03125);e.abs().gte(.1);)e=e.times(u),p+=5;for(a=Math.log(Ps(2,p))/Math.LN10*2+5|0,d+=a,n=l=o=new h(fn),h.precision=d;;){if(l=Ct(l.times(e),d),n=n.times(++f),u=o.plus(Ja(l,n,d)),va(u.d).slice(0,d)===va(o.d).slice(0,d)){for(;p--;)o=Ct(o.times(o),d);return h.precision=v,r==null?(qt=!0,Ct(o,v)):o}o=u}}function rr(e){for(var r=e.e*Ot,n=e.d[0];n>=10;n/=10)r++;return r}function cx(e,r,n){if(r>e.LN10.sd())throw qt=!0,n&&(e.precision=n),Error(In+"LN10 precision limit exceeded");return Ct(new e(e.LN10),r)}function Hi(e){for(var r="";e--;)r+="0";return r}function tu(e,r){var n,a,l,o,u,d,f,p,h,v=1,b=10,x=e,j=x.d,_=x.constructor,C=_.precision;if(x.s<1)throw Error(In+(x.s?"NaN":"-Infinity"));if(x.eq(fn))return new _(0);if(r==null?(qt=!1,p=C):p=r,x.eq(10))return r==null&&(qt=!0),cx(_,p);if(p+=b,_.precision=p,n=va(j),a=n.charAt(0),o=rr(x),Math.abs(o)<15e14){for(;a<7&&a!=1||a==1&&n.charAt(1)>3;)x=x.times(e),n=va(x.d),a=n.charAt(0),v++;o=rr(x),a>1?(x=new _("0."+n),o++):x=new _(a+"."+n.slice(1))}else return f=cx(_,p+2,C).times(o+""),x=tu(new _(a+"."+n.slice(1)),p-b).plus(f),_.precision=C,r==null?(qt=!0,Ct(x,C)):x;for(d=u=x=Ja(x.minus(fn),x.plus(fn),p),h=Ct(x.times(x),p),l=3;;){if(u=Ct(u.times(h),p),f=d.plus(Ja(u,new _(l),p)),va(f.d).slice(0,p)===va(d.d).slice(0,p))return d=d.times(2),o!==0&&(d=d.plus(cx(_,p+2,C).times(o+""))),d=Ja(d,new _(v),p),_.precision=C,r==null?(qt=!0,Ct(d,C)):d;d=f,l+=2}}function l2(e,r){var n,a,l;for((n=r.indexOf("."))>-1&&(r=r.replace(".","")),(a=r.search(/e/i))>0?(n<0&&(n=a),n+=+r.slice(a+1),r=r.substring(0,a)):n<0&&(n=r.length),a=0;r.charCodeAt(a)===48;)++a;for(l=r.length;r.charCodeAt(l-1)===48;)--l;if(r=r.slice(a,l),r){if(l-=a,n=n-a-1,e.e=_o(n/Ot),e.d=[],a=(n+1)%Ot,n<0&&(a+=Ot),a<l){for(a&&e.d.push(+r.slice(0,a)),l-=Ot;a<l;)e.d.push(+r.slice(a,a+=Ot));r=r.slice(a),a=Ot-r.length}else a-=l;for(;a--;)r+="0";if(e.d.push(+r),qt&&(e.e>rf||e.e<-rf))throw Error($y+n)}else e.s=0,e.e=0,e.d=[0];return e}function Ct(e,r,n){var a,l,o,u,d,f,p,h,v=e.d;for(u=1,o=v[0];o>=10;o/=10)u++;if(a=r-u,a<0)a+=Ot,l=r,p=v[h=0];else{if(h=Math.ceil((a+1)/Ot),o=v.length,h>=o)return e;for(p=o=v[h],u=1;o>=10;o/=10)u++;a%=Ot,l=a-Ot+u}if(n!==void 0&&(o=Ps(10,u-l-1),d=p/o%10|0,f=r<0||v[h+1]!==void 0||p%o,f=n<4?(d||f)&&(n==0||n==(e.s<0?3:2)):d>5||d==5&&(n==4||f||n==6&&(a>0?l>0?p/Ps(10,u-l):0:v[h-1])%10&1||n==(e.s<0?8:7))),r<1||!v[0])return f?(o=rr(e),v.length=1,r=r-o-1,v[0]=Ps(10,(Ot-r%Ot)%Ot),e.e=_o(-r/Ot)||0):(v.length=1,v[0]=e.e=e.s=0),e;if(a==0?(v.length=h,o=1,h--):(v.length=h+1,o=Ps(10,Ot-a),v[h]=l>0?(p/Ps(10,u-l)%Ps(10,l)|0)*o:0),f)for(;;)if(h==0){(v[0]+=o)==hr&&(v[0]=1,++e.e);break}else{if(v[h]+=o,v[h]!=hr)break;v[h--]=0,o=1}for(a=v.length;v[--a]===0;)v.pop();if(qt&&(e.e>rf||e.e<-rf))throw Error($y+rr(e));return e}function jO(e,r){var n,a,l,o,u,d,f,p,h,v,b=e.constructor,x=b.precision;if(!e.s||!r.s)return r.s?r.s=-r.s:r=new b(e),qt?Ct(r,x):r;if(f=e.d,v=r.d,a=r.e,p=e.e,f=f.slice(),u=p-a,u){for(h=u<0,h?(n=f,u=-u,d=v.length):(n=v,a=p,d=f.length),l=Math.max(Math.ceil(x/Ot),d)+2,u>l&&(u=l,n.length=1),n.reverse(),l=u;l--;)n.push(0);n.reverse()}else{for(l=f.length,d=v.length,h=l<d,h&&(d=l),l=0;l<d;l++)if(f[l]!=v[l]){h=f[l]<v[l];break}u=0}for(h&&(n=f,f=v,v=n,r.s=-r.s),d=f.length,l=v.length-d;l>0;--l)f[d++]=0;for(l=v.length;l>u;){if(f[--l]<v[l]){for(o=l;o&&f[--o]===0;)f[o]=hr-1;--f[o],f[l]+=hr}f[l]-=v[l]}for(;f[--d]===0;)f.pop();for(;f[0]===0;f.shift())--a;return f[0]?(r.d=f,r.e=a,qt?Ct(r,x):r):new b(0)}function Ws(e,r,n){var a,l=rr(e),o=va(e.d),u=o.length;return r?(n&&(a=n-u)>0?o=o.charAt(0)+"."+o.slice(1)+Hi(a):u>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(l<0?"e":"e+")+l):l<0?(o="0."+Hi(-l-1)+o,n&&(a=n-u)>0&&(o+=Hi(a))):l>=u?(o+=Hi(l+1-u),n&&(a=n-l-1)>0&&(o=o+"."+Hi(a))):((a=l+1)<u&&(o=o.slice(0,a)+"."+o.slice(a)),n&&(a=n-u)>0&&(l+1===u&&(o+="."),o+=Hi(a))),e.s<0?"-"+o:o}function o2(e,r){if(e.length>r)return e.length=r,!0}function _O(e){var r,n,a;function l(o){var u=this;if(!(u instanceof l))return new l(o);if(u.constructor=l,o instanceof l){u.s=o.s,u.e=o.e,u.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(Gs+o);if(o>0)u.s=1;else if(o<0)o=-o,u.s=-1;else{u.s=0,u.e=0,u.d=[0];return}if(o===~~o&&o<1e7){u.e=0,u.d=[o];return}return l2(u,o.toString())}else if(typeof o!="string")throw Error(Gs+o);if(o.charCodeAt(0)===45?(o=o.slice(1),u.s=-1):u.s=1,D9.test(o))l2(u,o);else throw Error(Gs+o)}if(l.prototype=ke,l.ROUND_UP=0,l.ROUND_DOWN=1,l.ROUND_CEIL=2,l.ROUND_FLOOR=3,l.ROUND_HALF_UP=4,l.ROUND_HALF_DOWN=5,l.ROUND_HALF_EVEN=6,l.ROUND_HALF_CEIL=7,l.ROUND_HALF_FLOOR=8,l.clone=_O,l.config=l.set=P9,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],r=0;r<a.length;)e.hasOwnProperty(n=a[r++])||(e[n]=this[n]);return l.config(e),l}function P9(e){if(!e||typeof e!="object")throw Error(In+"Object expected");var r,n,a,l=["precision",1,jo,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(r=0;r<l.length;r+=3)if((a=e[n=l[r]])!==void 0)if(_o(a)===a&&a>=l[r+1]&&a<=l[r+2])this[n]=a;else throw Error(Gs+n+": "+a);if((a=e[n="LN10"])!==void 0)if(a==Math.LN10)this[n]=new this(a);else throw Error(Gs+n+": "+a);return this}var By=_O(O9);fn=new By(1);const xt=By;function NO(e){var r;return e===0?r=1:r=Math.floor(new xt(e).abs().log(10).toNumber())+1,r}function SO(e,r,n){for(var a=new xt(e),l=0,o=[];a.lt(r)&&l<1e5;)o.push(a.toNumber()),a=a.add(n),l++;return o}var wO=e=>{var[r,n]=e,[a,l]=[r,n];return r>n&&([a,l]=[n,r]),[a,l]},CO=(e,r,n)=>{if(e.lte(0))return new xt(0);var a=NO(e.toNumber()),l=new xt(10).pow(a),o=e.div(l),u=a!==1?.05:.1,d=new xt(Math.ceil(o.div(u).toNumber())).add(n).mul(u),f=d.mul(l);return r?new xt(f.toNumber()):new xt(Math.ceil(f.toNumber()))},M9=(e,r,n)=>{var a=new xt(1),l=new xt(e);if(!l.isint()&&n){var o=Math.abs(e);o<1?(a=new xt(10).pow(NO(e)-1),l=new xt(Math.floor(l.div(a).toNumber())).mul(a)):o>1&&(l=new xt(Math.floor(e)))}else e===0?l=new xt(Math.floor((r-1)/2)):n||(l=new xt(Math.floor(e)));for(var u=Math.floor((r-1)/2),d=[],f=0;f<r;f++)d.push(l.add(new xt(f-u).mul(a)).toNumber());return d},EO=function(r,n,a,l){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-r)/(a-1)))return{step:new xt(0),tickMin:new xt(0),tickMax:new xt(0)};var u=CO(new xt(n).sub(r).div(a-1),l,o),d;r<=0&&n>=0?d=new xt(0):(d=new xt(r).add(n).div(2),d=d.sub(new xt(d).mod(u)));var f=Math.ceil(d.sub(r).div(u).toNumber()),p=Math.ceil(new xt(n).sub(d).div(u).toNumber()),h=f+p+1;return h>a?EO(r,n,a,l,o+1):(h<a&&(p=n>0?p+(a-h):p,f=n>0?f:f+(a-h)),{step:u,tickMin:d.sub(new xt(f).mul(u)),tickMax:d.add(new xt(p).mul(u))})},T9=function(r){var[n,a]=r,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,u=Math.max(l,2),[d,f]=wO([n,a]);if(d===-1/0||f===1/0){var p=f===1/0?[d,...Array(l-1).fill(1/0)]:[...Array(l-1).fill(-1/0),f];return n>a?p.reverse():p}if(d===f)return M9(d,l,o);var{step:h,tickMin:v,tickMax:b}=EO(d,f,u,o,0),x=SO(v,b.add(new xt(.1).mul(h)),h);return n>a?x.reverse():x},q9=function(r,n){var[a,l]=r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[u,d]=wO([a,l]);if(u===-1/0||d===1/0)return[a,l];if(u===d)return[u];var f=Math.max(n,2),p=CO(new xt(d).sub(u).div(f-1),o,0),h=[...SO(new xt(u),new xt(d),p),d];return o===!1&&(h=h.map(v=>Math.round(v))),a>l?h.reverse():h},AO=e=>e.rootProps.maxBarSize,R9=e=>e.rootProps.barGap,zO=e=>e.rootProps.barCategoryGap,I9=e=>e.rootProps.barSize,np=e=>e.rootProps.stackOffset,kO=e=>e.rootProps.reverseStackOrder,Uy=e=>e.options.chartName,Fy=e=>e.rootProps.syncId,OO=e=>e.rootProps.syncMethod,Gy=e=>e.options.eventEmitter,vr={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},zs={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},da={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},ap=(e,r)=>{if(!(!e||!r))return e!=null&&e.reversed?[r[1],r[0]]:r};function ip(e,r,n){if(n!=="auto")return n;if(e!=null)return ci(e,r)?"category":"number"}function c2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function nf(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?c2(Object(n),!0).forEach(function(a){L9(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function L9(e,r,n){return(r=$9(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function $9(e){var r=B9(e,"string");return typeof r=="symbol"?r:r+""}function B9(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var u2={allowDataOverflow:zs.allowDataOverflow,allowDecimals:zs.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:zs.angleAxisId,includeHidden:!1,name:void 0,reversed:zs.reversed,scale:zs.scale,tick:zs.tick,tickCount:void 0,ticks:void 0,type:zs.type,unit:void 0},d2={allowDataOverflow:da.allowDataOverflow,allowDecimals:da.allowDecimals,allowDuplicatedCategory:da.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:da.radiusAxisId,includeHidden:da.includeHidden,name:void 0,reversed:da.reversed,scale:da.scale,tick:da.tick,tickCount:da.tickCount,ticks:void 0,type:da.type,unit:void 0},U9=(e,r)=>{if(r!=null)return e.polarAxis.angleAxis[r]},Hy=de([U9,xk],(e,r)=>{var n;if(e!=null)return e;var a=(n=ip(r,"angleAxis",u2.type))!==null&&n!==void 0?n:"category";return nf(nf({},u2),{},{type:a})}),F9=(e,r)=>e.polarAxis.radiusAxis[r],Vy=de([F9,xk],(e,r)=>{var n;if(e!=null)return e;var a=(n=ip(r,"radiusAxis",d2.type))!==null&&n!==void 0?n:"category";return nf(nf({},d2),{},{type:a})}),sp=e=>e.polarOptions,Qy=de([ui,di,gr],$$),DO=de([sp,Qy],(e,r)=>{if(e!=null)return ta(e.innerRadius,r,0)}),PO=de([sp,Qy],(e,r)=>{if(e!=null)return ta(e.outerRadius,r,r*.8)}),G9=e=>{if(e==null)return[0,0];var{startAngle:r,endAngle:n}=e;return[r,n]},MO=de([sp],G9);de([Hy,MO],ap);var TO=de([Qy,DO,PO],(e,r,n)=>{if(!(e==null||r==null||n==null))return[r,n]});de([Vy,TO],ap);var qO=de([bt,sp,DO,PO,ui,di],(e,r,n,a,l,o)=>{if(!(e!=="centric"&&e!=="radial"||r==null||n==null||a==null)){var{cx:u,cy:d,startAngle:f,endAngle:p}=r;return{cx:ta(u,l,l/2),cy:ta(d,o,o/2),innerRadius:n,outerRadius:a,startAngle:f,endAngle:p,clockWise:!1}}}),br=(e,r)=>r,lp=(e,r,n)=>n;function Yy(e){return e?.id}function RO(e,r,n){var{chartData:a=[]}=r,{allowDuplicatedCategory:l,dataKey:o}=n,u=new Map;return e.forEach(d=>{var f,p=(f=d.data)!==null&&f!==void 0?f:a;if(!(p==null||p.length===0)){var h=Yy(d);p.forEach((v,b)=>{var x=o==null||l?b:String(tr(v,o,null)),j=tr(v,d.dataKey,0),_;u.has(x)?_=u.get(x):_={},Object.assign(_,{[h]:j}),u.set(x,_)})}}),Array.from(u.values())}function op(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var cp=(e,r)=>e===r?!0:e==null||r==null?!1:e[0]===r[0]&&e[1]===r[1];function up(e,r){return Array.isArray(e)&&Array.isArray(r)&&e.length===0&&r.length===0?!0:e===r}function H9(e,r){if(e.length===r.length){for(var n=0;n<e.length;n++)if(e[n]!==r[n])return!1;return!0}return!1}var yr=e=>{var r=bt(e);return r==="horizontal"?"xAxis":r==="vertical"?"yAxis":r==="centric"?"angleAxis":"radiusAxis"},No=e=>e.tooltip.settings.axisId;function V9(e){if(e in Tc)return Tc[e]();var r="scale".concat(uu(e));if(r in Tc)return Tc[r]()}function m2(e){var r=e.ticks,n=e.bandwidth,a=e.range(),l=[Math.min(...a),Math.max(...a)];return{domain:()=>e.domain(),range:(function(o){function u(){return o.apply(this,arguments)}return u.toString=function(){return o.toString()},u})(()=>l),rangeMin:()=>l[0],rangeMax:()=>l[1],isInRange(o){var u=l[0],d=l[1];return u<=d?o>=u&&o<=d:o>=d&&o<=u},bandwidth:n?()=>n.call(e):void 0,ticks:r?o=>r.call(e,o):void 0,map:(o,u)=>{var d=e(o);if(d!=null){if(e.bandwidth&&u!==null&&u!==void 0&&u.position){var f=e.bandwidth();switch(u.position){case"middle":d+=f/2;break;case"end":d+=f;break}}return d}}}}function f2(e,r,n){if(typeof e=="function")return m2(e.copy().domain(r).range(n));if(e!=null){var a=V9(e);if(a!=null)return a.domain(r).range(n),m2(a)}}var Q9=(e,r)=>{if(r!=null)switch(e){case"linear":{if(!ii(r)){for(var n,a,l=0;l<r.length;l++){var o=r[l];ot(o)&&((n===void 0||o<n)&&(n=o),(a===void 0||o>a)&&(a=o))}return n!==void 0&&a!==void 0?[n,a]:void 0}return r}default:return r}};function p2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function af(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?p2(Object(n),!0).forEach(function(a){Y9(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function Y9(e,r,n){return(r=K9(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function K9(e){var r=W9(e,"string");return typeof r=="symbol"?r:r+""}function W9(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var xb=[0,"auto"],mr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},IO=(e,r)=>e.cartesianAxis.xAxis[r],pi=(e,r)=>{var n=IO(e,r);return n??mr},fr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:xb,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:fu},LO=(e,r)=>e.cartesianAxis.yAxis[r],hi=(e,r)=>{var n=LO(e,r);return n??fr},X9={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Ky=(e,r)=>{var n=e.cartesianAxis.zAxis[r];return n??X9},Fr=(e,r,n)=>{switch(r){case"xAxis":return pi(e,n);case"yAxis":return hi(e,n);case"zAxis":return Ky(e,n);case"angleAxis":return Hy(e,n);case"radiusAxis":return Vy(e,n);default:throw new Error("Unexpected axis type: ".concat(r))}},Z9=(e,r,n)=>{switch(r){case"xAxis":return pi(e,n);case"yAxis":return hi(e,n);default:throw new Error("Unexpected axis type: ".concat(r))}},yu=(e,r,n)=>{switch(r){case"xAxis":return pi(e,n);case"yAxis":return hi(e,n);case"angleAxis":return Hy(e,n);case"radiusAxis":return Vy(e,n);default:throw new Error("Unexpected axis type: ".concat(r))}},$O=e=>e.graphicalItems.cartesianItems.some(r=>r.type==="bar")||e.graphicalItems.polarItems.some(r=>r.type==="radialBar");function BO(e,r){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===r;case"yAxis":return"yAxisId"in n&&n.yAxisId===r;case"zAxis":return"zAxisId"in n&&n.zAxisId===r;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===r;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===r;default:return!1}}}var dp=e=>e.graphicalItems.cartesianItems,J9=de([br,lp],BO),UO=(e,r,n)=>e.filter(n).filter(a=>r?.includeHidden===!0?!0:!a.hide),ju=de([dp,Fr,J9],UO,{memoizeOptions:{resultEqualityCheck:up}}),FO=de([ju],e=>e.filter(r=>r.type==="area"||r.type==="bar").filter(op)),GO=e=>e.filter(r=>!("stackId"in r)||r.stackId===void 0),eU=de([ju],GO),HO=e=>e.map(r=>r.data).filter(Boolean).flat(1),tU=de([ju],HO,{memoizeOptions:{resultEqualityCheck:up}}),VO=(e,r)=>{var{chartData:n=[],dataStartIndex:a,dataEndIndex:l}=r;return e.length>0?e:n.slice(a,l+1)},Wy=de([tU,Ly],VO),QO=(e,r,n)=>r?.dataKey!=null?e.map(a=>({value:tr(a,r.dataKey)})):n.length>0?n.map(a=>a.dataKey).flatMap(a=>e.map(l=>({value:tr(l,a)}))):e.map(a=>({value:a})),mp=de([Wy,Fr,ju],QO);function YO(e,r){switch(e){case"xAxis":return r.direction==="x";case"yAxis":return r.direction==="y";default:return!1}}function fm(e){if(ja(e)||e instanceof Date){var r=Number(e);if(ot(r))return r}}function h2(e){if(Array.isArray(e)){var r=[fm(e[0]),fm(e[1])];return ii(r)?r:void 0}var n=fm(e);if(n!=null)return[n,n]}function si(e){return e.map(fm).filter(en)}function rU(e,r,n){return!n||typeof r!="number"||ya(r)?[]:n.length?si(n.flatMap(a=>{var l=tr(e,a.dataKey),o,u;if(Array.isArray(l)?[o,u]=l:o=u=l,!(!ot(o)||!ot(u)))return[r-o,r+u]})):[]}var or=e=>{var r=yr(e),n=No(e);return yu(e,r,n)},_u=de([or],e=>e?.dataKey),nU=de([FO,Ly,or],RO),KO=(e,r,n,a)=>{var l={},o=r.reduce((u,d)=>{if(d.stackId==null)return u;var f=u[d.stackId];return f==null&&(f=[]),f.push(d),u[d.stackId]=f,u},l);return Object.fromEntries(Object.entries(o).map(u=>{var[d,f]=u,p=a?[...f].reverse():f,h=p.map(Yy);return[d,{stackedData:OL(e,h,n),graphicalItems:p}]}))},bb=de([nU,FO,np,kO],KO),WO=(e,r,n,a)=>{var{dataStartIndex:l,dataEndIndex:o}=r;if(a==null&&n!=="zAxis"){var u=qL(e,l,o);if(!(u!=null&&u[0]===0&&u[1]===0))return u}},aU=de([Fr],e=>e.allowDataOverflow),Xy=e=>{var r;if(e==null||!("domain"in e))return xb;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var n=si(e.ticks);return[Math.min(...n),Math.max(...n)]}if(e.type==="category")return e.ticks.map(String)}return(r=e?.domain)!==null&&r!==void 0?r:xb},XO=de([Fr],Xy),ZO=de([XO,aU],gO),iU=de([bb,fi,br,ZO],WO,{memoizeOptions:{resultEqualityCheck:cp}}),Zy=e=>e.errorBars,sU=(e,r,n)=>e.flatMap(a=>r[a.id]).filter(Boolean).filter(a=>YO(n,a)),sf=function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var l=n.filter(Boolean);if(l.length!==0){var o=l.flat(),u=Math.min(...o),d=Math.max(...o);return[u,d]}},JO=(e,r,n,a,l)=>{var o,u;if(n.length>0&&e.forEach(d=>{n.forEach(f=>{var p,h,v=(p=a[f.id])===null||p===void 0?void 0:p.filter(w=>YO(l,w)),b=tr(d,(h=r.dataKey)!==null&&h!==void 0?h:f.dataKey),x=rU(d,b,v);if(x.length>=2){var j=Math.min(...x),_=Math.max(...x);(o==null||j<o)&&(o=j),(u==null||_>u)&&(u=_)}var C=h2(b);C!=null&&(o=o==null?C[0]:Math.min(o,C[0]),u=u==null?C[1]:Math.max(u,C[1]))})}),r?.dataKey!=null&&e.forEach(d=>{var f=h2(tr(d,r.dataKey));f!=null&&(o=o==null?f[0]:Math.min(o,f[0]),u=u==null?f[1]:Math.max(u,f[1]))}),ot(o)&&ot(u))return[o,u]},lU=de([Wy,Fr,eU,Zy,br],JO,{memoizeOptions:{resultEqualityCheck:cp}});function oU(e){var{value:r}=e;if(ja(r)||r instanceof Date)return r}var cU=(e,r,n)=>{var a=e.map(oU).filter(l=>l!=null);return n&&(r.dataKey==null||r.allowDuplicatedCategory&&hz(a))?qk(0,e.length):r.allowDuplicatedCategory?a:Array.from(new Set(a))},eD=e=>e.referenceElements.dots,So=(e,r,n)=>e.filter(a=>a.ifOverflow==="extendDomain").filter(a=>r==="xAxis"?a.xAxisId===n:a.yAxisId===n),uU=de([eD,br,lp],So),tD=e=>e.referenceElements.areas,dU=de([tD,br,lp],So),rD=e=>e.referenceElements.lines,mU=de([rD,br,lp],So),nD=(e,r)=>{if(e!=null){var n=si(e.map(a=>r==="xAxis"?a.x:a.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},fU=de(uU,br,nD),aD=(e,r)=>{if(e!=null){var n=si(e.flatMap(a=>[r==="xAxis"?a.x1:a.y1,r==="xAxis"?a.x2:a.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},pU=de([dU,br],aD);function hU(e){var r;if(e.x!=null)return si([e.x]);var n=(r=e.segment)===null||r===void 0?void 0:r.map(a=>a.x);return n==null||n.length===0?[]:si(n)}function vU(e){var r;if(e.y!=null)return si([e.y]);var n=(r=e.segment)===null||r===void 0?void 0:r.map(a=>a.y);return n==null||n.length===0?[]:si(n)}var iD=(e,r)=>{if(e!=null){var n=e.flatMap(a=>r==="xAxis"?hU(a):vU(a));if(n.length!==0)return[Math.min(...n),Math.max(...n)]}},gU=de([mU,br],iD),xU=de(fU,gU,pU,(e,r,n)=>sf(e,n,r)),sD=(e,r,n,a,l,o,u,d)=>{if(n!=null)return n;var f=u==="vertical"&&d==="xAxis"||u==="horizontal"&&d==="yAxis",p=f?sf(a,o,l):sf(o,l);return k9(r,p,e.allowDataOverflow)},bU=de([Fr,XO,ZO,iU,lU,xU,bt,br],sD,{memoizeOptions:{resultEqualityCheck:cp}}),yU=[0,1],lD=(e,r,n,a,l,o,u)=>{if(!((e==null||n==null||n.length===0)&&u===void 0)){var{dataKey:d,type:f}=e,p=ci(r,o);if(p&&d==null){var h;return qk(0,(h=n?.length)!==null&&h!==void 0?h:0)}return f==="category"?cU(a,e,p):l==="expand"?yU:u}},Jy=de([Fr,bt,Wy,mp,np,br,bU],lD);function jU(e){return e in Tc}var oD=(e,r,n)=>{if(e!=null){var{scale:a,type:l}=e;if(a==="auto")return l==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":l==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(uu(a));return jU(o)?o:"point"}}},wo=de([Fr,$O,Uy],oD);function ej(e,r,n,a){if(!(n==null||a==null))return typeof e.scale=="function"?f2(e.scale,n,a):f2(r,n,a)}var cD=(e,r,n)=>{var a=Xy(r);if(!(n!=="auto"&&n!=="linear")){if(r!=null&&r.tickCount&&Array.isArray(a)&&(a[0]==="auto"||a[1]==="auto")&&ii(e))return T9(e,r.tickCount,r.allowDecimals);if(r!=null&&r.tickCount&&r.type==="number"&&ii(e))return q9(e,r.tickCount,r.allowDecimals)}},tj=de([Jy,yu,wo],cD),uD=(e,r,n,a)=>{if(a!=="angleAxis"&&e?.type==="number"&&ii(r)&&Array.isArray(n)&&n.length>0){var l,o,u=r[0],d=(l=n[0])!==null&&l!==void 0?l:0,f=r[1],p=(o=n[n.length-1])!==null&&o!==void 0?o:0;return[Math.min(u,d),Math.max(f,p)]}return r},_U=de([Fr,Jy,tj,br],uD),NU=de(mp,Fr,(e,r)=>{if(!(!r||r.type!=="number")){var n=1/0,a=Array.from(si(e.map(v=>v.value))).sort((v,b)=>v-b),l=a[0],o=a[a.length-1];if(l==null||o==null)return 1/0;var u=o-l;if(u===0)return 1/0;for(var d=0;d<a.length-1;d++){var f=a[d],p=a[d+1];if(!(f==null||p==null)){var h=p-f;n=Math.min(n,h)}}return n/u}}),dD=de(NU,bt,zO,gr,(e,r,n,a,l)=>l,(e,r,n,a,l)=>{if(!ot(e))return 0;var o=r==="vertical"?a.height:a.width;if(l==="gap")return e*o/2;if(l==="no-gap"){var u=ta(n,e*o),d=e*o/2;return d-u-(d-u)/o*u}return 0}),SU=(e,r,n)=>{var a=pi(e,r);return a==null||typeof a.padding!="string"?0:dD(e,"xAxis",r,n,a.padding)},wU=(e,r,n)=>{var a=hi(e,r);return a==null||typeof a.padding!="string"?0:dD(e,"yAxis",r,n,a.padding)},CU=de(pi,SU,(e,r)=>{var n,a;if(e==null)return{left:0,right:0};var{padding:l}=e;return typeof l=="string"?{left:r,right:r}:{left:((n=l.left)!==null&&n!==void 0?n:0)+r,right:((a=l.right)!==null&&a!==void 0?a:0)+r}}),EU=de(hi,wU,(e,r)=>{var n,a;if(e==null)return{top:0,bottom:0};var{padding:l}=e;return typeof l=="string"?{top:r,bottom:r}:{top:((n=l.top)!==null&&n!==void 0?n:0)+r,bottom:((a=l.bottom)!==null&&a!==void 0?a:0)+r}}),AU=de([gr,CU,Ff,Uf,(e,r,n)=>n],(e,r,n,a,l)=>{var{padding:o}=a;return l?[o.left,n.width-o.right]:[e.left+r.left,e.left+e.width-r.right]}),zU=de([gr,bt,EU,Ff,Uf,(e,r,n)=>n],(e,r,n,a,l,o)=>{var{padding:u}=l;return o?[a.height-u.bottom,u.top]:r==="horizontal"?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),Nu=(e,r,n,a)=>{var l;switch(r){case"xAxis":return AU(e,n,a);case"yAxis":return zU(e,n,a);case"zAxis":return(l=Ky(e,n))===null||l===void 0?void 0:l.range;case"angleAxis":return MO(e);case"radiusAxis":return TO(e,n);default:return}},mD=de([Fr,Nu],ap),kU=de([wo,_U],Q9),fp=de([Fr,wo,kU,mD],ej);de([ju,Zy,br],sU);function fD(e,r){return e.id<r.id?-1:e.id>r.id?1:0}var pp=(e,r)=>r,hp=(e,r,n)=>n,OU=de($f,pp,hp,(e,r,n)=>e.filter(a=>a.orientation===r).filter(a=>a.mirror===n).sort(fD)),DU=de(Bf,pp,hp,(e,r,n)=>e.filter(a=>a.orientation===r).filter(a=>a.mirror===n).sort(fD)),pD=(e,r)=>({width:e.width,height:r.height}),PU=(e,r)=>{var n=typeof r.width=="number"?r.width:fu;return{width:n,height:e.height}},hD=de(gr,pi,pD),MU=(e,r,n)=>{switch(r){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}},TU=(e,r,n)=>{switch(r){case"left":return e.left;case"right":return n-e.right;default:return 0}},qU=de(di,gr,OU,pp,hp,(e,r,n,a,l)=>{var o={},u;return n.forEach(d=>{var f=pD(r,d);u==null&&(u=MU(r,a,e));var p=a==="top"&&!l||a==="bottom"&&l;o[d.id]=u-Number(p)*f.height,u+=(p?-1:1)*f.height}),o}),RU=de(ui,gr,DU,pp,hp,(e,r,n,a,l)=>{var o={},u;return n.forEach(d=>{var f=PU(r,d);u==null&&(u=TU(r,a,e));var p=a==="left"&&!l||a==="right"&&l;o[d.id]=u-Number(p)*f.width,u+=(p?-1:1)*f.width}),o}),IU=(e,r)=>{var n=pi(e,r);if(n!=null)return qU(e,n.orientation,n.mirror)},LU=de([gr,pi,IU,(e,r)=>r],(e,r,n,a)=>{if(r!=null){var l=n?.[a];return l==null?{x:e.left,y:0}:{x:e.left,y:l}}}),$U=(e,r)=>{var n=hi(e,r);if(n!=null)return RU(e,n.orientation,n.mirror)},BU=de([gr,hi,$U,(e,r)=>r],(e,r,n,a)=>{if(r!=null){var l=n?.[a];return l==null?{x:0,y:e.top}:{x:l,y:e.top}}}),vD=de(gr,hi,(e,r)=>{var n=typeof r.width=="number"?r.width:fu;return{width:n,height:e.height}}),v2=(e,r,n)=>{switch(r){case"xAxis":return hD(e,n).width;case"yAxis":return vD(e,n).height;default:return}},gD=(e,r,n,a)=>{if(n!=null){var{allowDuplicatedCategory:l,type:o,dataKey:u}=n,d=ci(e,a),f=r.map(p=>p.value);if(u&&d&&o==="category"&&l&&hz(f))return f}},rj=de([bt,mp,Fr,br],gD),xD=(e,r,n,a)=>{if(!(n==null||n.dataKey==null)){var{type:l,scale:o}=n,u=ci(e,a);if(u&&(l==="number"||o!=="auto"))return r.map(d=>d.value)}},nj=de([bt,mp,yu,br],xD),g2=de([bt,Z9,wo,fp,rj,nj,Nu,tj,br],(e,r,n,a,l,o,u,d,f)=>{if(r!=null){var p=ci(e,f);return{angle:r.angle,interval:r.interval,minTickGap:r.minTickGap,orientation:r.orientation,tick:r.tick,tickCount:r.tickCount,tickFormatter:r.tickFormatter,ticks:r.ticks,type:r.type,unit:r.unit,axisType:f,categoricalDomain:o,duplicateDomain:l,isCategorical:p,niceTicks:d,range:u,realScaleType:n,scale:a}}}),UU=(e,r,n,a,l,o,u,d,f)=>{if(!(r==null||a==null)){var p=ci(e,f),{type:h,ticks:v,tickCount:b}=r,x=n==="scaleBand"&&typeof a.bandwidth=="function"?a.bandwidth()/2:2,j=h==="category"&&a.bandwidth?a.bandwidth()/x:0;j=f==="angleAxis"&&o!=null&&o.length>=2?Jr(o[0]-o[1])*2*j:j;var _=v||l;return _?_.map((C,w)=>{var E=u?u.indexOf(C):C,S=a.map(E);return ot(S)?{index:w,coordinate:S+j,value:C,offset:j}:null}).filter(en):p&&d?d.map((C,w)=>{var E=a.map(C);return ot(E)?{coordinate:E+j,value:C,index:w,offset:j}:null}).filter(en):a.ticks?a.ticks(b).map((C,w)=>{var E=a.map(C);return ot(E)?{coordinate:E+j,value:C,index:w,offset:j}:null}).filter(en):a.domain().map((C,w)=>{var E=a.map(C);return ot(E)?{coordinate:E+j,value:u?u[C]:C,index:w,offset:j}:null}).filter(en)}},bD=de([bt,yu,wo,fp,tj,Nu,rj,nj,br],UU),FU=(e,r,n,a,l,o,u)=>{if(!(r==null||n==null||a==null||a[0]===a[1])){var d=ci(e,u),{tickCount:f}=r,p=0;return p=u==="angleAxis"&&a?.length>=2?Jr(a[0]-a[1])*2*p:p,d&&o?o.map((h,v)=>{var b=n.map(h);return ot(b)?{coordinate:b+p,value:h,index:v,offset:p}:null}).filter(en):n.ticks?n.ticks(f).map((h,v)=>{var b=n.map(h);return ot(b)?{coordinate:b+p,value:h,index:v,offset:p}:null}).filter(en):n.domain().map((h,v)=>{var b=n.map(h);return ot(b)?{coordinate:b+p,value:l?l[h]:h,index:v,offset:p}:null}).filter(en)}},rs=de([bt,yu,fp,Nu,rj,nj,br],FU),ns=de(Fr,fp,(e,r)=>{if(!(e==null||r==null))return af(af({},e),{},{scale:r})}),GU=de([Fr,wo,Jy,mD],ej);de((e,r,n)=>Ky(e,n),GU,(e,r)=>{if(!(e==null||r==null))return af(af({},e),{},{scale:r})});var HU=de([bt,$f,Bf],(e,r,n)=>{switch(e){case"horizontal":return r.some(a=>a.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(a=>a.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),yD=e=>e.options.defaultTooltipEventType,jD=e=>e.options.validateTooltipEventTypes;function _D(e,r,n){if(e==null)return r;var a=e?"axis":"item";return n==null?r:n.includes(a)?a:r}function aj(e,r){var n=yD(e),a=jD(e);return _D(r,n,a)}function VU(e){return $e(r=>aj(r,e))}var ND=(e,r)=>{var n,a=Number(r);if(!(ya(a)||r==null))return a>=0?e==null||(n=e[a])===null||n===void 0?void 0:n.value:void 0},QU=e=>e.tooltip.settings,Qi={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},YU={itemInteraction:{click:Qi,hover:Qi},axisInteraction:{click:Qi,hover:Qi},keyboardInteraction:Qi,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},SD=rn({name:"tooltip",initialState:YU,reducers:{addTooltipEntrySettings:{reducer(e,r){e.tooltipItemPayloads.push(r.payload)},prepare:Tt()},replaceTooltipEntrySettings:{reducer(e,r){var{prev:n,next:a}=r.payload,l=Jn(e).tooltipItemPayloads.indexOf(n);l>-1&&(e.tooltipItemPayloads[l]=a)},prepare:Tt()},removeTooltipEntrySettings:{reducer(e,r){var n=Jn(e).tooltipItemPayloads.indexOf(r.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},prepare:Tt()},setTooltipSettingsState(e,r){e.settings=r.payload},setActiveMouseOverItemIndex(e,r){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=r.payload.activeIndex,e.itemInteraction.hover.dataKey=r.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=r.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=r.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,r){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=r.payload.activeIndex,e.itemInteraction.click.dataKey=r.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=r.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=r.payload.activeCoordinate},setMouseOverAxisIndex(e,r){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=r.payload.activeIndex,e.axisInteraction.hover.dataKey=r.payload.activeDataKey,e.axisInteraction.hover.coordinate=r.payload.activeCoordinate},setMouseClickAxisIndex(e,r){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=r.payload.activeIndex,e.axisInteraction.click.dataKey=r.payload.activeDataKey,e.axisInteraction.click.coordinate=r.payload.activeCoordinate},setSyncInteraction(e,r){e.syncInteraction=r.payload},setKeyboardInteraction(e,r){e.keyboardInteraction.active=r.payload.active,e.keyboardInteraction.index=r.payload.activeIndex,e.keyboardInteraction.coordinate=r.payload.activeCoordinate}}}),{addTooltipEntrySettings:KU,replaceTooltipEntrySettings:WU,removeTooltipEntrySettings:XU,setTooltipSettingsState:ZU,setActiveMouseOverItemIndex:wD,mouseLeaveItem:JU,mouseLeaveChart:CD,setActiveClickItemIndex:eF,setMouseOverAxisIndex:ED,setMouseClickAxisIndex:tF,setSyncInteraction:yb,setKeyboardInteraction:jb}=SD.actions,rF=SD.reducer;function x2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function tm(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?x2(Object(n),!0).forEach(function(a){nF(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function nF(e,r,n){return(r=aF(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function aF(e){var r=iF(e,"string");return typeof r=="symbol"?r:r+""}function iF(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function sF(e,r,n){return r==="axis"?n==="click"?e.axisInteraction.click:e.axisInteraction.hover:n==="click"?e.itemInteraction.click:e.itemInteraction.hover}function lF(e){return e.index!=null}var AD=(e,r,n,a)=>{if(r==null)return Qi;var l=sF(e,r,n);if(l==null)return Qi;if(l.active)return l;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var o=e.settings.active===!0;if(lF(l)){if(o)return tm(tm({},l),{},{active:!0})}else if(a!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:a,graphicalItemId:void 0};return tm(tm({},Qi),{},{coordinate:l.coordinate})};function oF(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var r=e.valueOf();return Number.isFinite(r)?r:void 0}var n=Number(e);return Number.isFinite(n)?n:void 0}function cF(e,r){var n=oF(e),a=r[0],l=r[1];if(n===void 0)return!1;var o=Math.min(a,l),u=Math.max(a,l);return n>=o&&n<=u}function uF(e,r,n){if(n==null||r==null)return!0;var a=tr(e,r);return a==null||!ii(n)?!0:cF(a,n)}var ij=(e,r,n,a)=>{var l=e?.index;if(l==null)return null;var o=Number(l);if(!ot(o))return l;var u=0,d=1/0;r.length>0&&(d=r.length-1);var f=Math.max(u,Math.min(o,d)),p=r[f];return p==null||uF(p,n,a)?String(f):null},zD=(e,r,n,a,l,o,u)=>{if(o!=null){var d=u[0],f=d?.getPosition(o);if(f!=null)return f;var p=l?.[Number(o)];if(p)return n==="horizontal"?{x:p.coordinate,y:(a.top+r)/2}:{x:(a.left+e)/2,y:p.coordinate}}},kD=(e,r,n,a)=>{if(r==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var l;if(n==="hover"?l=e.itemInteraction.hover.graphicalItemId:l=e.itemInteraction.click.graphicalItemId,l==null&&a!=null){var o=e.tooltipItemPayloads[0];return o!=null?[o]:[]}return e.tooltipItemPayloads.filter(u=>{var d;return((d=u.settings)===null||d===void 0?void 0:d.graphicalItemId)===l})},OD=e=>e.options.tooltipPayloadSearcher,Co=e=>e.tooltip;function b2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function y2(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?b2(Object(n),!0).forEach(function(a){dF(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function dF(e,r,n){return(r=mF(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function mF(e){var r=fF(e,"string");return typeof r=="symbol"?r:r+""}function fF(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function pF(e,r){return e??r}var DD=(e,r,n,a,l,o,u)=>{if(!(r==null||o==null)){var{chartData:d,computedData:f,dataStartIndex:p,dataEndIndex:h}=n,v=[];return e.reduce((b,x)=>{var j,{dataDefinedOnItem:_,settings:C}=x,w=pF(_,d),E=Array.isArray(w)?lk(w,p,h):w,S=(j=C?.dataKey)!==null&&j!==void 0?j:a,A=C?.nameKey,O;if(a&&Array.isArray(E)&&!Array.isArray(E[0])&&u==="axis"?O=vz(E,a,l):O=o(E,r,f,A),Array.isArray(O))O.forEach(P=>{var D=y2(y2({},C),{},{name:P.name,unit:P.unit,color:void 0,fill:void 0});b.push(bw({tooltipEntrySettings:D,dataKey:P.dataKey,payload:P.payload,value:tr(P.payload,P.dataKey),name:P.name}))});else{var k;b.push(bw({tooltipEntrySettings:C,dataKey:S,payload:O,value:tr(O,S),name:(k=tr(O,A))!==null&&k!==void 0?k:C?.name}))}return b},v)}},sj=de([or,$O,Uy],oD),hF=de([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,r)=>[...e,...r]),vF=de([yr,No],BO),Eo=de([hF,or,vF],UO,{memoizeOptions:{resultEqualityCheck:up}}),gF=de([Eo],e=>e.filter(op)),xF=de([Eo],HO,{memoizeOptions:{resultEqualityCheck:up}}),Ao=de([xF,fi],VO),bF=de([gF,fi,or],RO),lj=de([Ao,or,Eo],QO),PD=de([or],Xy),yF=de([or],e=>e.allowDataOverflow),MD=de([PD,yF],gO),jF=de([Eo],e=>e.filter(op)),_F=de([bF,jF,np,kO],KO),NF=de([_F,fi,yr,MD],WO),SF=de([Eo],GO),wF=de([Ao,or,SF,Zy,yr],JO,{memoizeOptions:{resultEqualityCheck:cp}}),CF=de([eD,yr,No],So),EF=de([CF,yr],nD),AF=de([tD,yr,No],So),zF=de([AF,yr],aD),kF=de([rD,yr,No],So),OF=de([kF,yr],iD),DF=de([EF,OF,zF],sf),PF=de([or,PD,MD,NF,wF,DF,bt,yr],sD),Su=de([or,bt,Ao,lj,np,yr,PF],lD),MF=de([Su,or,sj],cD),TF=de([or,Su,MF,yr],uD),TD=e=>{var r=yr(e),n=No(e),a=!1;return Nu(e,r,n,a)},qD=de([or,TD],ap),RD=de([or,sj,TF,qD],ej),qF=de([bt,lj,or,yr],gD),RF=de([bt,lj,or,yr],xD),IF=(e,r,n,a,l,o,u,d)=>{if(r){var{type:f}=r,p=ci(e,d);if(a){var h=n==="scaleBand"&&a.bandwidth?a.bandwidth()/2:2,v=f==="category"&&a.bandwidth?a.bandwidth()/h:0;return v=d==="angleAxis"&&l!=null&&l?.length>=2?Jr(l[0]-l[1])*2*v:v,p&&u?u.map((b,x)=>{var j=a.map(b);return ot(j)?{coordinate:j+v,value:b,index:x,offset:v}:null}).filter(en):a.domain().map((b,x)=>{var j=a.map(b);return ot(j)?{coordinate:j+v,value:o?o[b]:b,index:x,offset:v}:null}).filter(en)}}},vi=de([bt,or,sj,RD,TD,qF,RF,yr],IF),oj=de([yD,jD,QU],(e,r,n)=>_D(n.shared,e,r)),ID=e=>e.tooltip.settings.trigger,cj=e=>e.tooltip.settings.defaultIndex,wu=de([Co,oj,ID,cj],AD),Xs=de([wu,Ao,_u,Su],ij),LD=de([vi,Xs],ND),$D=de([wu],e=>{if(e)return e.dataKey});de([wu],e=>{if(e)return e.graphicalItemId});var BD=de([Co,oj,ID,cj],kD),LF=de([ui,di,bt,gr,vi,cj,BD],zD),$F=de([wu,LF],(e,r)=>e!=null&&e.coordinate?e.coordinate:r),BF=de([wu],e=>{var r;return(r=e?.active)!==null&&r!==void 0?r:!1}),UF=de([BD,Xs,fi,_u,LD,OD,oj],DD),FF=de([UF],e=>{if(e!=null){var r=e.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(r))}});function j2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function _2(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?j2(Object(n),!0).forEach(function(a){GF(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function GF(e,r,n){return(r=HF(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function HF(e){var r=VF(e,"string");return typeof r=="symbol"?r:r+""}function VF(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var QF=()=>$e(or),YF=()=>{var e=QF(),r=$e(vi),n=$e(RD);return ho(!e||!n?void 0:_2(_2({},e),{},{scale:n}),r)};function N2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Jl(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?N2(Object(n),!0).forEach(function(a){KF(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function KF(e,r,n){return(r=WF(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function WF(e){var r=XF(e,"string");return typeof r=="symbol"?r:r+""}function XF(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var ZF=(e,r,n,a)=>{var l=r.find(o=>o&&o.index===n);if(l){if(e==="horizontal")return{x:l.coordinate,y:a.chartY};if(e==="vertical")return{x:a.chartX,y:l.coordinate}}return{x:0,y:0}},JF=(e,r,n,a)=>{var l=r.find(p=>p&&p.index===n);if(l){if(e==="centric"){var o=l.coordinate,{radius:u}=a;return Jl(Jl(Jl({},a),zr(a.cx,a.cy,u,o)),{},{angle:o,radius:u})}var d=l.coordinate,{angle:f}=a;return Jl(Jl(Jl({},a),zr(a.cx,a.cy,d,f)),{},{angle:f,radius:d})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function eG(e,r){var{chartX:n,chartY:a}=e;return n>=r.left&&n<=r.left+r.width&&a>=r.top&&a<=r.top+r.height}var UD=(e,r,n,a,l)=>{var o,u=(o=r?.length)!==null&&o!==void 0?o:0;if(u<=1||e==null)return 0;if(a==="angleAxis"&&l!=null&&Math.abs(Math.abs(l[1]-l[0])-360)<=1e-6)for(var d=0;d<u;d++){var f,p,h,v,b,x=d>0?(f=n[d-1])===null||f===void 0?void 0:f.coordinate:(p=n[u-1])===null||p===void 0?void 0:p.coordinate,j=(h=n[d])===null||h===void 0?void 0:h.coordinate,_=d>=u-1?(v=n[0])===null||v===void 0?void 0:v.coordinate:(b=n[d+1])===null||b===void 0?void 0:b.coordinate,C=void 0;if(!(x==null||j==null||_==null))if(Jr(j-x)!==Jr(_-j)){var w=[];if(Jr(_-j)===Jr(l[1]-l[0])){C=_;var E=j+l[1]-l[0];w[0]=Math.min(E,(E+x)/2),w[1]=Math.max(E,(E+x)/2)}else{C=x;var S=_+l[1]-l[0];w[0]=Math.min(j,(S+j)/2),w[1]=Math.max(j,(S+j)/2)}var A=[Math.min(j,(C+j)/2),Math.max(j,(C+j)/2)];if(e>A[0]&&e<=A[1]||e>=w[0]&&e<=w[1]){var O;return(O=n[d])===null||O===void 0?void 0:O.index}}else{var k=Math.min(x,_),P=Math.max(x,_);if(e>(k+j)/2&&e<=(P+j)/2){var D;return(D=n[d])===null||D===void 0?void 0:D.index}}}else if(r)for(var B=0;B<u;B++){var U=r[B];if(U!=null){var $=r[B+1],R=r[B-1];if(B===0&&$!=null&&e<=(U.coordinate+$.coordinate)/2||B===u-1&&R!=null&&e>(U.coordinate+R.coordinate)/2||B>0&&B<u-1&&R!=null&&$!=null&&e>(U.coordinate+R.coordinate)/2&&e<=(U.coordinate+$.coordinate)/2)return U.index}}return-1},tG=()=>$e(Uy),uj=(e,r)=>r,FD=(e,r,n)=>n,dj=(e,r,n,a)=>a,rG=de(vi,e=>zf(e,r=>r.coordinate)),mj=de([Co,uj,FD,dj],AD),fj=de([mj,Ao,_u,Su],ij),nG=(e,r,n)=>{if(r!=null){var a=Co(e);return r==="axis"?n==="hover"?a.axisInteraction.hover.dataKey:a.axisInteraction.click.dataKey:n==="hover"?a.itemInteraction.hover.dataKey:a.itemInteraction.click.dataKey}},GD=de([Co,uj,FD,dj],kD),lf=de([ui,di,bt,gr,vi,dj,GD],zD),aG=de([mj,lf],(e,r)=>{var n;return(n=e.coordinate)!==null&&n!==void 0?n:r}),HD=de([vi,fj],ND),iG=de([GD,fj,fi,_u,HD,OD,uj],DD),sG=de([mj,fj],(e,r)=>({isActive:e.active&&r!=null,activeIndex:r})),lG=(e,r,n,a,l,o,u)=>{if(!(!e||!n||!a||!l)&&eG(e,u)){var d=RL(e,r),f=UD(d,o,l,n,a),p=ZF(r,l,f,e);return{activeIndex:String(f),activeCoordinate:p}}},oG=(e,r,n,a,l,o,u)=>{if(!(!e||!a||!l||!o||!n)){var d=H$(e,n);if(d){var f=IL(d,r),p=UD(f,u,o,a,l),h=JF(r,o,p,d);return{activeIndex:String(p),activeCoordinate:h}}}},cG=(e,r,n,a,l,o,u,d)=>{if(!(!e||!r||!a||!l||!o))return r==="horizontal"||r==="vertical"?lG(e,r,a,l,o,u,d):oG(e,r,n,a,l,o,u)},uG=de(e=>e.zIndex.zIndexMap,(e,r)=>r,(e,r,n)=>n,(e,r,n)=>{if(r!=null){var a=e[r];if(a!=null)return n?a.panoramaElement:a.element}}),dG=de(e=>e.zIndex.zIndexMap,e=>{var r=Object.keys(e).map(a=>parseInt(a,10)).concat(Object.values(vr)),n=Array.from(new Set(r));return n.sort((a,l)=>a-l)},{memoizeOptions:{resultEqualityCheck:H9}});function S2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function w2(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?S2(Object(n),!0).forEach(function(a){mG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function mG(e,r,n){return(r=fG(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function fG(e){var r=pG(e,"string");return typeof r=="symbol"?r:r+""}function pG(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var hG={},vG={zIndexMap:Object.values(vr).reduce((e,r)=>w2(w2({},e),{},{[r]:{element:void 0,panoramaElement:void 0,consumers:0}}),hG)},gG=new Set(Object.values(vr));function xG(e){return gG.has(e)}var VD=rn({name:"zIndex",initialState:vG,reducers:{registerZIndexPortal:{reducer:(e,r)=>{var{zIndex:n}=r.payload;e.zIndexMap[n]?e.zIndexMap[n].consumers+=1:e.zIndexMap[n]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Tt()},unregisterZIndexPortal:{reducer:(e,r)=>{var{zIndex:n}=r.payload;e.zIndexMap[n]&&(e.zIndexMap[n].consumers-=1,e.zIndexMap[n].consumers<=0&&!xG(n)&&delete e.zIndexMap[n])},prepare:Tt()},registerZIndexPortalElement:{reducer:(e,r)=>{var{zIndex:n,element:a,isPanorama:l}=r.payload;e.zIndexMap[n]?l?e.zIndexMap[n].panoramaElement=a:e.zIndexMap[n].element=a:e.zIndexMap[n]={consumers:0,element:l?void 0:a,panoramaElement:l?a:void 0}},prepare:Tt()},unregisterZIndexPortalElement:{reducer:(e,r)=>{var{zIndex:n}=r.payload;e.zIndexMap[n]&&(r.payload.isPanorama?e.zIndexMap[n].panoramaElement=void 0:e.zIndexMap[n].element=void 0)},prepare:Tt()}}}),{registerZIndexPortal:bG,unregisterZIndexPortal:yG,registerZIndexPortalElement:jG,unregisterZIndexPortalElement:_G}=VD.actions,NG=VD.reducer;function Un(e){var{zIndex:r,children:n}=e,a=v8(),l=a&&r!==void 0&&r!==0,o=Pr(),u=Yt();g.useLayoutEffect(()=>l?(u(bG({zIndex:r})),()=>{u(yG({zIndex:r}))}):rl,[u,r,l]);var d=$e(f=>uG(f,r,o));return l?d?hA.createPortal(n,d):null:n}function _b(){return _b=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_b.apply(null,arguments)}function C2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function rm(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?C2(Object(n),!0).forEach(function(a){SG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function SG(e,r,n){return(r=wG(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function wG(e){var r=CG(e,"string");return typeof r=="symbol"?r:r+""}function CG(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function EG(e){var{cursor:r,cursorComp:n,cursorProps:a}=e;return g.isValidElement(r)?g.cloneElement(r,a):g.createElement(n,a)}function AG(e){var r,{coordinate:n,payload:a,index:l,offset:o,tooltipAxisBandSize:u,layout:d,cursor:f,tooltipEventType:p,chartName:h}=e,v=n,b=a,x=l;if(!f||!v||h!=="ScatterChart"&&p!=="axis")return null;var j,_,C;if(h==="ScatterChart")j=v,_=a$,C=vr.cursorLine;else if(h==="BarChart")j=i$(d,v,o,u),_=Dk,C=vr.cursorRectangle;else if(d==="radial"&&bz(v)){var{cx:w,cy:E,radius:S,startAngle:A,endAngle:O}=Pk(v);j={cx:w,cy:E,startAngle:A,endAngle:O,innerRadius:S,outerRadius:S},_=Tk,C=vr.cursorLine}else j={points:K$(d,v,o)},_=Ek,C=vr.cursorLine;var k=typeof f=="object"&&"className"in f?f.className:void 0,P=rm(rm(rm(rm({stroke:"#ccc",pointerEvents:"none"},o),j),cu(f)),{},{payload:b,payloadIndex:x,className:St("recharts-tooltip-cursor",k)});return g.createElement(Un,{zIndex:(r=e.zIndex)!==null&&r!==void 0?r:C},g.createElement(EG,{cursor:f,cursorComp:_,cursorProps:P}))}function zG(e){var r=YF(),n=pk(),a=nl(),l=tG();return r==null||n==null||a==null||l==null?null:g.createElement(AG,_b({},e,{offset:n,layout:a,tooltipAxisBandSize:r,chartName:l}))}var QD=g.createContext(null),kG=()=>g.useContext(QD),ux={exports:{}},E2;function OG(){return E2||(E2=1,(function(e){var r=Object.prototype.hasOwnProperty,n="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(n=!1));function l(f,p,h){this.fn=f,this.context=p,this.once=h||!1}function o(f,p,h,v,b){if(typeof h!="function")throw new TypeError("The listener must be a function");var x=new l(h,v||f,b),j=n?n+p:p;return f._events[j]?f._events[j].fn?f._events[j]=[f._events[j],x]:f._events[j].push(x):(f._events[j]=x,f._eventsCount++),f}function u(f,p){--f._eventsCount===0?f._events=new a:delete f._events[p]}function d(){this._events=new a,this._eventsCount=0}d.prototype.eventNames=function(){var p=[],h,v;if(this._eventsCount===0)return p;for(v in h=this._events)r.call(h,v)&&p.push(n?v.slice(1):v);return Object.getOwnPropertySymbols?p.concat(Object.getOwnPropertySymbols(h)):p},d.prototype.listeners=function(p){var h=n?n+p:p,v=this._events[h];if(!v)return[];if(v.fn)return[v.fn];for(var b=0,x=v.length,j=new Array(x);b<x;b++)j[b]=v[b].fn;return j},d.prototype.listenerCount=function(p){var h=n?n+p:p,v=this._events[h];return v?v.fn?1:v.length:0},d.prototype.emit=function(p,h,v,b,x,j){var _=n?n+p:p;if(!this._events[_])return!1;var C=this._events[_],w=arguments.length,E,S;if(C.fn){switch(C.once&&this.removeListener(p,C.fn,void 0,!0),w){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,h),!0;case 3:return C.fn.call(C.context,h,v),!0;case 4:return C.fn.call(C.context,h,v,b),!0;case 5:return C.fn.call(C.context,h,v,b,x),!0;case 6:return C.fn.call(C.context,h,v,b,x,j),!0}for(S=1,E=new Array(w-1);S<w;S++)E[S-1]=arguments[S];C.fn.apply(C.context,E)}else{var A=C.length,O;for(S=0;S<A;S++)switch(C[S].once&&this.removeListener(p,C[S].fn,void 0,!0),w){case 1:C[S].fn.call(C[S].context);break;case 2:C[S].fn.call(C[S].context,h);break;case 3:C[S].fn.call(C[S].context,h,v);break;case 4:C[S].fn.call(C[S].context,h,v,b);break;default:if(!E)for(O=1,E=new Array(w-1);O<w;O++)E[O-1]=arguments[O];C[S].fn.apply(C[S].context,E)}}return!0},d.prototype.on=function(p,h,v){return o(this,p,h,v,!1)},d.prototype.once=function(p,h,v){return o(this,p,h,v,!0)},d.prototype.removeListener=function(p,h,v,b){var x=n?n+p:p;if(!this._events[x])return this;if(!h)return u(this,x),this;var j=this._events[x];if(j.fn)j.fn===h&&(!b||j.once)&&(!v||j.context===v)&&u(this,x);else{for(var _=0,C=[],w=j.length;_<w;_++)(j[_].fn!==h||b&&!j[_].once||v&&j[_].context!==v)&&C.push(j[_]);C.length?this._events[x]=C.length===1?C[0]:C:u(this,x)}return this},d.prototype.removeAllListeners=function(p){var h;return p?(h=n?n+p:p,this._events[h]&&u(this,h)):(this._events=new a,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=n,d.EventEmitter=d,e.exports=d})(ux)),ux.exports}var DG=OG();const PG=oi(DG);var ru=new PG,Nb="recharts.syncEvent.tooltip",A2="recharts.syncEvent.brush",YD=(e,r)=>{if(r&&Array.isArray(e)){var n=Number.parseInt(r,10);if(!ya(n))return e[n]}},MG={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},KD=rn({name:"options",initialState:MG,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),TG=KD.reducer,{createEventEmitter:qG}=KD.actions;function RG(e){return e.tooltip.syncInteraction}var IG={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},WD=rn({name:"chartData",initialState:IG,reducers:{setChartData(e,r){if(e.chartData=r.payload,r.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}r.payload.length>0&&e.dataEndIndex!==r.payload.length-1&&(e.dataEndIndex=r.payload.length-1)},setComputedData(e,r){e.computedData=r.payload},setDataStartEndIndexes(e,r){var{startIndex:n,endIndex:a}=r.payload;n!=null&&(e.dataStartIndex=n),a!=null&&(e.dataEndIndex=a)}}}),{setChartData:z2,setDataStartEndIndexes:LG,setComputedData:Lte}=WD.actions,$G=WD.reducer,BG=["x","y"];function k2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function eo(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?k2(Object(n),!0).forEach(function(a){UG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function UG(e,r,n){return(r=FG(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function FG(e){var r=GG(e,"string");return typeof r=="symbol"?r:r+""}function GG(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function HG(e,r){if(e==null)return{};var n,a,l=VG(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function VG(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function QG(){var e=$e(Fy),r=$e(Gy),n=Yt(),a=$e(OO),l=$e(vi),o=nl(),u=Gf(),d=$e(f=>f.rootProps.className);g.useEffect(()=>{if(e==null)return rl;var f=(p,h,v)=>{if(r!==v&&e===p){if(a==="index"){var b;if(u&&h!==null&&h!==void 0&&(b=h.payload)!==null&&b!==void 0&&b.coordinate&&h.payload.sourceViewBox){var x=h.payload.coordinate,{x:j,y:_}=x,C=HG(x,BG),{x:w,y:E,width:S,height:A}=h.payload.sourceViewBox,O=eo(eo({},C),{},{x:u.x+(S?(j-w)/S:0)*u.width,y:u.y+(A?(_-E)/A:0)*u.height});n(eo(eo({},h),{},{payload:eo(eo({},h.payload),{},{coordinate:O})}))}else n(h);return}if(l!=null){var k;if(typeof a=="function"){var P={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},D=a(l,P);k=l[D]}else a==="value"&&(k=l.find(T=>String(T.value)===h.payload.label));var{coordinate:B}=h.payload;if(k==null||h.payload.active===!1||B==null||u==null){n(yb({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:U,y:$}=B,R=Math.min(U,u.x+u.width),Y=Math.min($,u.y+u.height),ae={x:o==="horizontal"?k.coordinate:R,y:o==="horizontal"?Y:k.coordinate},M=yb({active:h.payload.active,coordinate:ae,dataKey:h.payload.dataKey,index:String(k.index),label:h.payload.label,sourceViewBox:h.payload.sourceViewBox,graphicalItemId:h.payload.graphicalItemId});n(M)}}};return ru.on(Nb,f),()=>{ru.off(Nb,f)}},[d,n,r,e,a,l,o,u])}function YG(){var e=$e(Fy),r=$e(Gy),n=Yt();g.useEffect(()=>{if(e==null)return rl;var a=(l,o,u)=>{r!==u&&e===l&&n(LG(o))};return ru.on(A2,a),()=>{ru.off(A2,a)}},[n,r,e])}function KG(){var e=Yt();g.useEffect(()=>{e(qG())},[e]),QG(),YG()}function WG(e,r,n,a,l,o){var u=$e(x=>nG(x,e,r)),d=$e(Gy),f=$e(Fy),p=$e(OO),h=$e(RG),v=h?.active,b=Gf();g.useEffect(()=>{if(!v&&f!=null&&d!=null){var x=yb({active:o,coordinate:n,dataKey:u,index:l,label:typeof a=="number"?String(a):a,sourceViewBox:b,graphicalItemId:void 0});ru.emit(Nb,f,x,d)}},[v,n,u,l,a,d,f,p,o,b])}function O2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function D2(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?O2(Object(n),!0).forEach(function(a){XG(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function XG(e,r,n){return(r=ZG(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function ZG(e){var r=JG(e,"string");return typeof r=="symbol"?r:r+""}function JG(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function eH(e){return e.dataKey}function tH(e,r){return g.isValidElement(e)?g.cloneElement(e,r):typeof e=="function"?g.createElement(e,r):g.createElement(R8,r)}var P2=[],rH={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function M2(e){var r,n,a=Ur(e,rH),{active:l,allowEscapeViewBox:o,animationDuration:u,animationEasing:d,content:f,filterNull:p,isAnimationActive:h,offset:v,payloadUniqBy:b,position:x,reverseDirection:j,useTranslate3d:_,wrapperStyle:C,cursor:w,shared:E,trigger:S,defaultIndex:A,portal:O,axisId:k}=a,P=Yt(),D=typeof A=="number"?String(A):A;g.useEffect(()=>{P(ZU({shared:E,trigger:S,axisId:k,active:l,defaultIndex:D}))},[P,E,S,k,l,D]);var B=Gf(),U=Ck(),$=VU(E),{activeIndex:R,isActive:Y}=(r=$e(he=>sG(he,$,S,D)))!==null&&r!==void 0?r:{},ae=$e(he=>iG(he,$,S,D)),M=$e(he=>HD(he,$,S,D)),T=$e(he=>aG(he,$,S,D)),F=ae,I=kG(),X=(n=l??Y)!==null&&n!==void 0?n:!1,[L,ne]=_4([F,X]),K=$==="axis"?M:void 0;WG($,S,T,K,R,X);var oe=O??I;if(oe==null||B==null||$==null)return null;var xe=F??P2;X||(xe=P2),p&&xe.length&&(xe=YI(xe.filter(he=>he.value!=null&&(he.hide!==!0||a.includeHidden)),b,eH));var ve=xe.length>0,H=g.createElement(G8,{allowEscapeViewBox:o,animationDuration:u,animationEasing:d,isAnimationActive:h,active:X,coordinate:T,hasPayload:ve,offset:v,position:x,reverseDirection:j,useTranslate3d:_,viewBox:B,wrapperStyle:C,lastBoundingBox:L,innerRef:ne,hasPortalFromProps:!!O},tH(f,D2(D2({},a),{},{payload:xe,label:K,active:X,activeIndex:R,coordinate:T,accessibilityLayer:U})));return g.createElement(g.Fragment,null,hA.createPortal(H,oe),X&&g.createElement(zG,{cursor:w,tooltipEventType:$,coordinate:T,payload:xe,index:R}))}var pj=e=>null;pj.displayName="Cell";function nH(e,r,n){return(r=aH(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function aH(e){var r=iH(e,"string");return typeof r=="symbol"?r:r+""}function iH(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}class sH{constructor(r){nH(this,"cache",new Map),this.maxSize=r}get(r){var n=this.cache.get(r);return n!==void 0&&(this.cache.delete(r),this.cache.set(r,n)),n}set(r,n){if(this.cache.has(r))this.cache.delete(r);else if(this.cache.size>=this.maxSize){var a=this.cache.keys().next().value;a!=null&&this.cache.delete(a)}this.cache.set(r,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function T2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function lH(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?T2(Object(n),!0).forEach(function(a){oH(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function oH(e,r,n){return(r=cH(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function cH(e){var r=uH(e,"string");return typeof r=="symbol"?r:r+""}function uH(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var dH={cacheSize:2e3,enableCache:!0},XD=lH({},dH),q2=new sH(XD.cacheSize),mH={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},R2="recharts_measurement_span";function fH(e,r){var n=r.fontSize||"",a=r.fontFamily||"",l=r.fontWeight||"",o=r.fontStyle||"",u=r.letterSpacing||"",d=r.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(a,"|").concat(l,"|").concat(o,"|").concat(u,"|").concat(d)}var I2=(e,r)=>{try{var n=document.getElementById(R2);n||(n=document.createElement("span"),n.setAttribute("id",R2),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,mH,r),n.textContent="".concat(e);var a=n.getBoundingClientRect();return{width:a.width,height:a.height}}catch{return{width:0,height:0}}},Ic=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r==null||Yf.isSsr)return{width:0,height:0};if(!XD.enableCache)return I2(r,n);var a=fH(r,n),l=q2.get(a);if(l)return l;var o=I2(r,n);return q2.set(a,o),o},ZD;function pH(e,r,n){return(r=hH(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function hH(e){var r=vH(e,"string");return typeof r=="symbol"?r:r+""}function vH(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var L2=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,$2=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,gH=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,xH=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,bH={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},yH=["cm","mm","pt","pc","in","Q","px"];function jH(e){return yH.includes(e)}var so="NaN";function _H(e,r){return e*bH[r]}class Ar{static parse(r){var n,[,a,l]=(n=xH.exec(r))!==null&&n!==void 0?n:[];return a==null?Ar.NaN:new Ar(parseFloat(a),l??"")}constructor(r,n){this.num=r,this.unit=n,this.num=r,this.unit=n,ya(r)&&(this.unit=""),n!==""&&!gH.test(n)&&(this.num=NaN,this.unit=""),jH(n)&&(this.num=_H(r,n),this.unit="px")}add(r){return this.unit!==r.unit?new Ar(NaN,""):new Ar(this.num+r.num,this.unit)}subtract(r){return this.unit!==r.unit?new Ar(NaN,""):new Ar(this.num-r.num,this.unit)}multiply(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new Ar(NaN,""):new Ar(this.num*r.num,this.unit||r.unit)}divide(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new Ar(NaN,""):new Ar(this.num/r.num,this.unit||r.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ya(this.num)}}ZD=Ar;pH(Ar,"NaN",new ZD(NaN,""));function JD(e){if(e==null||e.includes(so))return so;for(var r=e;r.includes("*")||r.includes("/");){var n,[,a,l,o]=(n=L2.exec(r))!==null&&n!==void 0?n:[],u=Ar.parse(a??""),d=Ar.parse(o??""),f=l==="*"?u.multiply(d):u.divide(d);if(f.isNaN())return so;r=r.replace(L2,f.toString())}for(;r.includes("+")||/.-\d+(?:\.\d+)?/.test(r);){var p,[,h,v,b]=(p=$2.exec(r))!==null&&p!==void 0?p:[],x=Ar.parse(h??""),j=Ar.parse(b??""),_=v==="+"?x.add(j):x.subtract(j);if(_.isNaN())return so;r=r.replace($2,_.toString())}return r}var B2=/\(([^()]*)\)/;function NH(e){for(var r=e,n;(n=B2.exec(r))!=null;){var[,a]=n;r=r.replace(B2,JD(a))}return r}function SH(e){var r=e.replace(/\s+/g,"");return r=NH(r),r=JD(r),r}function wH(e){try{return SH(e)}catch{return so}}function dx(e){var r=wH(e.slice(5,-1));return r===so?"":r}var CH=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],EH=["dx","dy","angle","className","breakAll"];function Sb(){return Sb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Sb.apply(null,arguments)}function U2(e,r){if(e==null)return{};var n,a,l=AH(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function AH(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var eP=/[ \f\n\r\t\v\u2028\u2029]+/,tP=e=>{var{children:r,breakAll:n,style:a}=e;try{var l=[];Rt(r)||(n?l=r.toString().split(""):l=r.toString().split(eP));var o=l.map(d=>({word:d,width:Ic(d,a).width})),u=n?0:Ic("",a).width;return{wordsWithComputedWidth:o,spaceWidth:u}}catch{return null}};function zH(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var rP=(e,r,n,a)=>e.reduce((l,o)=>{var{word:u,width:d}=o,f=l[l.length-1];if(f&&d!=null&&(r==null||a||f.width+d+n<Number(r)))f.words.push(u),f.width+=d+n;else{var p={words:[u],width:d};l.push(p)}return l},[]),nP=e=>e.reduce((r,n)=>r.width>n.width?r:n),kH="",F2=(e,r,n,a,l,o,u,d)=>{var f=e.slice(0,r),p=tP({breakAll:n,style:a,children:f+kH});if(!p)return[!1,[]];var h=rP(p.wordsWithComputedWidth,o,u,d),v=h.length>l||nP(h).width>Number(o);return[v,h]},OH=(e,r,n,a,l)=>{var{maxLines:o,children:u,style:d,breakAll:f}=e,p=De(o),h=String(u),v=rP(r,a,n,l);if(!p||l)return v;var b=v.length>o||nP(v).width>Number(a);if(!b)return v;for(var x=0,j=h.length-1,_=0,C;x<=j&&_<=h.length-1;){var w=Math.floor((x+j)/2),E=w-1,[S,A]=F2(h,E,f,d,o,a,n,l),[O]=F2(h,w,f,d,o,a,n,l);if(!S&&!O&&(x=w+1),S&&O&&(j=w-1),!S&&O){C=A;break}_++}return C||v},G2=e=>{var r=Rt(e)?[]:e.toString().split(eP);return[{words:r,width:void 0}]},DH=e=>{var{width:r,scaleToFit:n,children:a,style:l,breakAll:o,maxLines:u}=e;if((r||n)&&!Yf.isSsr){var d,f,p=tP({breakAll:o,children:a,style:l});if(p){var{wordsWithComputedWidth:h,spaceWidth:v}=p;d=h,f=v}else return G2(a);return OH({breakAll:o,children:a,maxLines:u,style:l},d,f,r,!!n)}return G2(a)},aP="#808080",PH={angle:0,breakAll:!1,capHeight:"0.71em",fill:aP,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},hj=g.forwardRef((e,r)=>{var n=Ur(e,PH),{x:a,y:l,lineHeight:o,capHeight:u,fill:d,scaleToFit:f,textAnchor:p,verticalAnchor:h}=n,v=U2(n,CH),b=g.useMemo(()=>DH({breakAll:v.breakAll,children:v.children,maxLines:v.maxLines,scaleToFit:f,style:v.style,width:v.width}),[v.breakAll,v.children,v.maxLines,f,v.style,v.width]),{dx:x,dy:j,angle:_,className:C,breakAll:w}=v,E=U2(v,EH);if(!ja(a)||!ja(l)||b.length===0)return null;var S=Number(a)+(De(x)?x:0),A=Number(l)+(De(j)?j:0);if(!ot(S)||!ot(A))return null;var O;switch(h){case"start":O=dx("calc(".concat(u,")"));break;case"middle":O=dx("calc(".concat((b.length-1)/2," * -").concat(o," + (").concat(u," / 2))"));break;default:O=dx("calc(".concat(b.length-1," * -").concat(o,")"));break}var k=[],P=b[0];if(f&&P!=null){var D=P.width,{width:B}=v;k.push("scale(".concat(De(B)&&De(D)?B/D:1,")"))}return _&&k.push("rotate(".concat(_,", ").concat(S,", ").concat(A,")")),k.length&&(E.transform=k.join(" ")),g.createElement("text",Sb({},Lr(E),{ref:r,x:S,y:A,className:St("recharts-text",C),textAnchor:p,fill:d.includes("url")?aP:d}),b.map((U,$)=>{var R=U.words.join(w?"":" ");return g.createElement("tspan",{x:S,dy:$===0?O:o,key:"".concat(R,"-").concat($)},R)}))});hj.displayName="Text";function H2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function ma(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?H2(Object(n),!0).forEach(function(a){MH(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function MH(e,r,n){return(r=TH(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function TH(e){var r=qH(e,"string");return typeof r=="symbol"?r:r+""}function qH(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var RH=e=>{var{viewBox:r,position:n,offset:a=0,parentViewBox:l}=e,{x:o,y:u,height:d,upperWidth:f,lowerWidth:p}=fy(r),h=o,v=o+(f-p)/2,b=(h+v)/2,x=(f+p)/2,j=h+f/2,_=d>=0?1:-1,C=_*a,w=_>0?"end":"start",E=_>0?"start":"end",S=f>=0?1:-1,A=S*a,O=S>0?"end":"start",k=S>0?"start":"end",P=l;if(n==="top"){var D={x:h+f/2,y:u-C,horizontalAnchor:"middle",verticalAnchor:w};return P&&(D.height=Math.max(u-P.y,0),D.width=f),D}if(n==="bottom"){var B={x:v+p/2,y:u+d+C,horizontalAnchor:"middle",verticalAnchor:E};return P&&(B.height=Math.max(P.y+P.height-(u+d),0),B.width=p),B}if(n==="left"){var U={x:b-A,y:u+d/2,horizontalAnchor:O,verticalAnchor:"middle"};return P&&(U.width=Math.max(U.x-P.x,0),U.height=d),U}if(n==="right"){var $={x:b+x+A,y:u+d/2,horizontalAnchor:k,verticalAnchor:"middle"};return P&&($.width=Math.max(P.x+P.width-$.x,0),$.height=d),$}var R=P?{width:x,height:d}:{};return n==="insideLeft"?ma({x:b+A,y:u+d/2,horizontalAnchor:k,verticalAnchor:"middle"},R):n==="insideRight"?ma({x:b+x-A,y:u+d/2,horizontalAnchor:O,verticalAnchor:"middle"},R):n==="insideTop"?ma({x:h+f/2,y:u+C,horizontalAnchor:"middle",verticalAnchor:E},R):n==="insideBottom"?ma({x:v+p/2,y:u+d-C,horizontalAnchor:"middle",verticalAnchor:w},R):n==="insideTopLeft"?ma({x:h+A,y:u+C,horizontalAnchor:k,verticalAnchor:E},R):n==="insideTopRight"?ma({x:h+f-A,y:u+C,horizontalAnchor:O,verticalAnchor:E},R):n==="insideBottomLeft"?ma({x:v+A,y:u+d-C,horizontalAnchor:k,verticalAnchor:w},R):n==="insideBottomRight"?ma({x:v+p-A,y:u+d-C,horizontalAnchor:O,verticalAnchor:w},R):n&&typeof n=="object"&&(De(n.x)||Vs(n.x))&&(De(n.y)||Vs(n.y))?ma({x:o+ta(n.x,x),y:u+ta(n.y,d),horizontalAnchor:"end",verticalAnchor:"end"},R):ma({x:j,y:u+d/2,horizontalAnchor:"middle",verticalAnchor:"middle"},R)},IH=["labelRef"],LH=["content"];function V2(e,r){if(e==null)return{};var n,a,l=$H(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function $H(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function Q2(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function qc(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Q2(Object(n),!0).forEach(function(a){BH(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q2(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function BH(e,r,n){return(r=UH(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function UH(e){var r=FH(e,"string");return typeof r=="symbol"?r:r+""}function FH(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Ya(){return Ya=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ya.apply(null,arguments)}var iP=g.createContext(null),GH=e=>{var{x:r,y:n,upperWidth:a,lowerWidth:l,width:o,height:u,children:d}=e,f=g.useMemo(()=>({x:r,y:n,upperWidth:a,lowerWidth:l,width:o,height:u}),[r,n,a,l,o,u]);return g.createElement(iP.Provider,{value:f},d)},sP=()=>{var e=g.useContext(iP),r=Gf();return e||(r?fy(r):void 0)},HH=g.createContext(null),VH=()=>{var e=g.useContext(HH),r=$e(qO);return e||r},QH=e=>{var{value:r,formatter:n}=e,a=Rt(e.children)?r:e.children;return typeof n=="function"?n(a):a},vj=e=>e!=null&&typeof e=="function",YH=(e,r)=>{var n=Jr(r-e),a=Math.min(Math.abs(r-e),360);return n*a},KH=(e,r,n,a,l)=>{var{offset:o,className:u}=e,{cx:d,cy:f,innerRadius:p,outerRadius:h,startAngle:v,endAngle:b,clockWise:x}=l,j=(p+h)/2,_=YH(v,b),C=_>=0?1:-1,w,E;switch(r){case"insideStart":w=v+C*o,E=x;break;case"insideEnd":w=b-C*o,E=!x;break;case"end":w=b+C*o,E=x;break;default:throw new Error("Unsupported position ".concat(r))}E=_<=0?E:!E;var S=zr(d,f,j,w),A=zr(d,f,j,w+(E?1:-1)*359),O="M".concat(S.x,",").concat(S.y,`
    A`).concat(j,",").concat(j,",0,1,").concat(E?0:1,`,
    `).concat(A.x,",").concat(A.y),k=Rt(e.id)?Fc("recharts-radial-line-"):e.id;return g.createElement("text",Ya({},a,{dominantBaseline:"central",className:St("recharts-radial-bar-label",u)}),g.createElement("defs",null,g.createElement("path",{id:k,d:O})),g.createElement("textPath",{xlinkHref:"#".concat(k)},n))},WH=(e,r,n)=>{var{cx:a,cy:l,innerRadius:o,outerRadius:u,startAngle:d,endAngle:f}=e,p=(d+f)/2;if(n==="outside"){var{x:h,y:v}=zr(a,l,u+r,p);return{x:h,y:v,textAnchor:h>=a?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:a,y:l,textAnchor:"middle",verticalAnchor:"end"};var b=(o+u)/2,{x,y:j}=zr(a,l,b,p);return{x,y:j,textAnchor:"middle",verticalAnchor:"middle"}},pm=e=>e!=null&&"cx"in e&&De(e.cx),XH={angle:0,offset:5,zIndex:vr.label,position:"middle",textBreakAll:!1};function ZH(e){if(!pm(e))return e;var{cx:r,cy:n,outerRadius:a}=e,l=a*2;return{x:r-a,y:n-a,width:l,upperWidth:l,lowerWidth:l,height:l}}function Vi(e){var r=Ur(e,XH),{viewBox:n,parentViewBox:a,position:l,value:o,children:u,content:d,className:f="",textBreakAll:p,labelRef:h}=r,v=VH(),b=sP(),x=l==="center"?b:v??b,j,_,C;n==null?j=x:pm(n)?j=n:j=fy(n);var w=ZH(j);if(!j||Rt(o)&&Rt(u)&&!g.isValidElement(d)&&typeof d!="function")return null;var E=qc(qc({},r),{},{viewBox:j});if(g.isValidElement(d)){var{labelRef:S}=E,A=V2(E,IH);return g.cloneElement(d,A)}if(typeof d=="function"){var{content:O}=E,k=V2(E,LH);if(_=g.createElement(d,k),g.isValidElement(_))return _}else _=QH(r);var P=Lr(r);if(pm(j)){if(l==="insideStart"||l==="insideEnd"||l==="end")return KH(r,l,_,P,j);C=WH(j,r.offset,r.position)}else{if(!w)return null;var D=RH({viewBox:w,position:l,offset:r.offset,parentViewBox:pm(a)?void 0:a});C=qc(qc({x:D.x,y:D.y,textAnchor:D.horizontalAnchor,verticalAnchor:D.verticalAnchor},D.width!==void 0?{width:D.width}:{}),D.height!==void 0?{height:D.height}:{})}return g.createElement(Un,{zIndex:r.zIndex},g.createElement(hj,Ya({ref:h,className:St("recharts-label",f)},P,C,{textAnchor:zH(P.textAnchor)?P.textAnchor:C.textAnchor,breakAll:p}),_))}Vi.displayName="Label";var JH=(e,r,n)=>{if(!e)return null;var a={viewBox:r,labelRef:n};return e===!0?g.createElement(Vi,Ya({key:"label-implicit"},a)):ja(e)?g.createElement(Vi,Ya({key:"label-implicit",value:e},a)):g.isValidElement(e)?e.type===Vi?g.cloneElement(e,qc({key:"label-implicit"},a)):g.createElement(Vi,Ya({key:"label-implicit",content:e},a)):vj(e)?g.createElement(Vi,Ya({key:"label-implicit",content:e},a)):e&&typeof e=="object"?g.createElement(Vi,Ya({},e,{key:"label-implicit"},a)):null};function eV(e){var{label:r,labelRef:n}=e,a=sP();return JH(r,a,n)||null}var mx={},fx={},Y2;function tV(){return Y2||(Y2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return n[n.length-1]}e.last=r})(fx)),fx}var px={},K2;function rV(){return K2||(K2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){return Array.isArray(n)?n:Array.from(n)}e.toArray=r})(px)),px}var W2;function nV(){return W2||(W2=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=tV(),n=rV(),a=ry();function l(o){if(a.isArrayLike(o))return r.last(n.toArray(o))}e.last=l})(mx)),mx}var hx,X2;function aV(){return X2||(X2=1,hx=nV().last),hx}var iV=aV();const sV=oi(iV);var lV=["valueAccessor"],oV=["dataKey","clockWise","id","textBreakAll","zIndex"];function of(){return of=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},of.apply(null,arguments)}function Z2(e,r){if(e==null)return{};var n,a,l=cV(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function cV(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var uV=e=>Array.isArray(e.value)?sV(e.value):e.value,lP=g.createContext(void 0),oP=lP.Provider,cP=g.createContext(void 0);cP.Provider;function dV(){return g.useContext(lP)}function mV(){return g.useContext(cP)}function hm(e){var{valueAccessor:r=uV}=e,n=Z2(e,lV),{dataKey:a,clockWise:l,id:o,textBreakAll:u,zIndex:d}=n,f=Z2(n,oV),p=dV(),h=mV(),v=p||h;return!v||!v.length?null:g.createElement(Un,{zIndex:d??vr.label},g.createElement(qn,{className:"recharts-label-list"},v.map((b,x)=>{var j,_=Rt(a)?r(b,x):tr(b.payload,a),C=Rt(o)?{}:{id:"".concat(o,"-").concat(x)};return g.createElement(Vi,of({key:"label-".concat(x)},Lr(b),f,C,{fill:(j=n.fill)!==null&&j!==void 0?j:b.fill,parentViewBox:b.parentViewBox,value:_,textBreakAll:u,viewBox:b.viewBox,index:x,zIndex:0}))})))}hm.displayName="LabelList";function uP(e){var{label:r}=e;return r?r===!0?g.createElement(hm,{key:"labelList-implicit"}):g.isValidElement(r)||vj(r)?g.createElement(hm,{key:"labelList-implicit",content:r}):typeof r=="object"?g.createElement(hm,of({key:"labelList-implicit"},r,{type:String(r.type)})):null:null}function wb(){return wb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},wb.apply(null,arguments)}var dP=e=>{var{cx:r,cy:n,r:a,className:l}=e,o=St("recharts-dot",l);return De(r)&&De(n)&&De(a)?g.createElement("circle",wb({},ea(e),ey(e),{className:o,cx:r,cy:n,r:a})):null},fV={radiusAxis:{},angleAxis:{}},mP=rn({name:"polarAxis",initialState:fV,reducers:{addRadiusAxis(e,r){e.radiusAxis[r.payload.id]=r.payload},removeRadiusAxis(e,r){delete e.radiusAxis[r.payload.id]},addAngleAxis(e,r){e.angleAxis[r.payload.id]=r.payload},removeAngleAxis(e,r){delete e.angleAxis[r.payload.id]}}}),{addRadiusAxis:$te,removeRadiusAxis:Bte,addAngleAxis:Ute,removeAngleAxis:Fte}=mP.actions,pV=mP.reducer;function hV(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var vx={exports:{}},Nt={};var J2;function vV(){if(J2)return Nt;J2=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),b=Symbol.for("react.view_transition"),x=Symbol.for("react.client.reference");function j(_){if(typeof _=="object"&&_!==null){var C=_.$$typeof;switch(C){case e:switch(_=_.type,_){case n:case l:case a:case f:case p:case b:return _;default:switch(_=_&&_.$$typeof,_){case u:case d:case v:case h:return _;case o:return _;default:return C}}case r:return C}}}return Nt.ContextConsumer=o,Nt.ContextProvider=u,Nt.Element=e,Nt.ForwardRef=d,Nt.Fragment=n,Nt.Lazy=v,Nt.Memo=h,Nt.Portal=r,Nt.Profiler=l,Nt.StrictMode=a,Nt.Suspense=f,Nt.SuspenseList=p,Nt.isContextConsumer=function(_){return j(_)===o},Nt.isContextProvider=function(_){return j(_)===u},Nt.isElement=function(_){return typeof _=="object"&&_!==null&&_.$$typeof===e},Nt.isForwardRef=function(_){return j(_)===d},Nt.isFragment=function(_){return j(_)===n},Nt.isLazy=function(_){return j(_)===v},Nt.isMemo=function(_){return j(_)===h},Nt.isPortal=function(_){return j(_)===r},Nt.isProfiler=function(_){return j(_)===l},Nt.isStrictMode=function(_){return j(_)===a},Nt.isSuspense=function(_){return j(_)===f},Nt.isSuspenseList=function(_){return j(_)===p},Nt.isValidElementType=function(_){return typeof _=="string"||typeof _=="function"||_===n||_===l||_===a||_===f||_===p||typeof _=="object"&&_!==null&&(_.$$typeof===v||_.$$typeof===h||_.$$typeof===u||_.$$typeof===o||_.$$typeof===d||_.$$typeof===x||_.getModuleId!==void 0)},Nt.typeOf=j,Nt}var eE;function gV(){return eE||(eE=1,vx.exports=vV()),vx.exports}var xV=gV(),tE=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",rE=null,gx=null,fP=e=>{if(e===rE&&Array.isArray(gx))return gx;var r=[];return g.Children.forEach(e,n=>{Rt(n)||(xV.isFragment(n)?r=r.concat(fP(n.props.children)):r.push(n))}),gx=r,rE=e,r};function bV(e,r){var n=[],a=[];return Array.isArray(r)?a=r.map(l=>tE(l)):a=[tE(r)],fP(e).forEach(l=>{var o=fo(l,"type.displayName")||fo(l,"type.name");o&&a.indexOf(o)!==-1&&n.push(l)}),n}var pP=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,xx={},nE;function yV(){return nE||(nE=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(n){if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const l=n[Symbol.toStringTag];return l==null||!Object.getOwnPropertyDescriptor(n,Symbol.toStringTag)?.writable?!1:n.toString()===`[object ${l}]`}let a=n;for(;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(n)===a}e.isPlainObject=r})(xx)),xx}var bx,aE;function jV(){return aE||(aE=1,bx=yV().isPlainObject),bx}var _V=jV();const NV=oi(_V);var iE,sE,lE,oE,cE;function uE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function dE(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?uE(Object(n),!0).forEach(function(a){SV(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function SV(e,r,n){return(r=wV(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function wV(e){var r=CV(e,"string");return typeof r=="symbol"?r:r+""}function CV(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function cf(){return cf=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},cf.apply(null,arguments)}function zc(e,r){return r||(r=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(r)}}))}var mE=(e,r,n,a,l)=>{var o=n-a,u;return u=Ft(iE||(iE=zc(["M ",",",""])),e,r),u+=Ft(sE||(sE=zc(["L ",",",""])),e+n,r),u+=Ft(lE||(lE=zc(["L ",",",""])),e+n-o/2,r+l),u+=Ft(oE||(oE=zc(["L ",",",""])),e+n-o/2-a,r+l),u+=Ft(cE||(cE=zc(["L ",","," Z"])),e,r),u},EV={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},AV=e=>{var r=Ur(e,EV),{x:n,y:a,upperWidth:l,lowerWidth:o,height:u,className:d}=r,{animationEasing:f,animationDuration:p,animationBegin:h,isUpdateAnimationActive:v}=r,b=g.useRef(null),[x,j]=g.useState(-1),_=g.useRef(l),C=g.useRef(o),w=g.useRef(u),E=g.useRef(n),S=g.useRef(a),A=Wf(e,"trapezoid-");if(g.useEffect(()=>{if(b.current&&b.current.getTotalLength)try{var ae=b.current.getTotalLength();ae&&j(ae)}catch{}},[]),n!==+n||a!==+a||l!==+l||o!==+o||u!==+u||l===0&&o===0||u===0)return null;var O=St("recharts-trapezoid",d);if(!v)return g.createElement("g",null,g.createElement("path",cf({},Lr(r),{className:O,d:mE(n,a,l,o,u)})));var k=_.current,P=C.current,D=w.current,B=E.current,U=S.current,$="0px ".concat(x===-1?1:x,"px"),R="".concat(x,"px 0px"),Y=Ak(["strokeDasharray"],p,f);return g.createElement(Kf,{animationId:A,key:A,canBegin:x>0,duration:p,easing:f,isActive:v,begin:h},ae=>{var M=Gt(k,l,ae),T=Gt(P,o,ae),F=Gt(D,u,ae),I=Gt(B,n,ae),X=Gt(U,a,ae);b.current&&(_.current=M,C.current=T,w.current=F,E.current=I,S.current=X);var L=ae>0?{transition:Y,strokeDasharray:R}:{strokeDasharray:$};return g.createElement("path",cf({},Lr(r),{className:O,d:mE(I,X,M,T,F),ref:b,style:dE(dE({},L),r.style)}))})},zV=["option","shapeType","activeClassName"];function kV(e,r){if(e==null)return{};var n,a,l=OV(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function OV(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function fE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function uf(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?fE(Object(n),!0).forEach(function(a){DV(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function DV(e,r,n){return(r=PV(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function PV(e){var r=MV(e,"string");return typeof r=="symbol"?r:r+""}function MV(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function TV(e,r){return uf(uf({},r),e)}function qV(e,r){return e==="symbols"}function pE(e){var{shapeType:r,elementProps:n}=e;switch(r){case"rectangle":return g.createElement(Dk,n);case"trapezoid":return g.createElement(AV,n);case"sector":return g.createElement(Tk,n);case"symbols":if(qV(r))return g.createElement(xz,n);break;case"curve":return g.createElement(Ek,n);default:return null}}function RV(e){return g.isValidElement(e)?e.props:e}function hP(e){var{option:r,shapeType:n,activeClassName:a="recharts-active-shape"}=e,l=kV(e,zV),o;if(g.isValidElement(r))o=g.cloneElement(r,uf(uf({},l),RV(r)));else if(typeof r=="function")o=r(l,l.index);else if(NV(r)&&typeof r!="boolean"){var u=TV(r,l);o=g.createElement(pE,{shapeType:n,elementProps:u})}else{var d=l;o=g.createElement(pE,{shapeType:n,elementProps:d})}return l.isActive?g.createElement(qn,{className:a},o):o}var vP=(e,r,n)=>{var a=Yt();return(l,o)=>u=>{e?.(l,o,u),a(wD({activeIndex:String(o),activeDataKey:r,activeCoordinate:l.tooltipPosition,activeGraphicalItemId:n}))}},gP=e=>{var r=Yt();return(n,a)=>l=>{e?.(n,a,l),r(JU())}},xP=(e,r,n)=>{var a=Yt();return(l,o)=>u=>{e?.(l,o,u),a(eF({activeIndex:String(o),activeDataKey:r,activeCoordinate:l.tooltipPosition,activeGraphicalItemId:n}))}};function bP(e){var{tooltipEntrySettings:r}=e,n=Yt(),a=Pr(),l=g.useRef(null);return g.useLayoutEffect(()=>{a||(l.current===null?n(KU(r)):l.current!==r&&n(WU({prev:l.current,next:r})),l.current=r)},[r,n,a]),g.useLayoutEffect(()=>()=>{l.current&&(n(XU(l.current)),l.current=null)},[n]),null}function yP(e){var{legendPayload:r}=e,n=Yt(),a=Pr(),l=g.useRef(null);return g.useLayoutEffect(()=>{a||(l.current===null?n(z8(r)):l.current!==r&&n(k8({prev:l.current,next:r})),l.current=r)},[n,a,r]),g.useLayoutEffect(()=>()=>{l.current&&(n(O8(l.current)),l.current=null)},[n]),null}var yx,IV=()=>{var[e]=g.useState(()=>Fc("uid-"));return e},LV=(yx=Uq.useId)!==null&&yx!==void 0?yx:IV;function $V(e,r){var n=LV();return r||(e?"".concat(e,"-").concat(n):n)}var BV=g.createContext(void 0),jP=e=>{var{id:r,type:n,children:a}=e,l=$V("recharts-".concat(n),r);return g.createElement(BV.Provider,{value:l},a(l))},UV={cartesianItems:[],polarItems:[]},_P=rn({name:"graphicalItems",initialState:UV,reducers:{addCartesianGraphicalItem:{reducer(e,r){e.cartesianItems.push(r.payload)},prepare:Tt()},replaceCartesianGraphicalItem:{reducer(e,r){var{prev:n,next:a}=r.payload,l=Jn(e).cartesianItems.indexOf(n);l>-1&&(e.cartesianItems[l]=a)},prepare:Tt()},removeCartesianGraphicalItem:{reducer(e,r){var n=Jn(e).cartesianItems.indexOf(r.payload);n>-1&&e.cartesianItems.splice(n,1)},prepare:Tt()},addPolarGraphicalItem:{reducer(e,r){e.polarItems.push(r.payload)},prepare:Tt()},removePolarGraphicalItem:{reducer(e,r){var n=Jn(e).polarItems.indexOf(r.payload);n>-1&&e.polarItems.splice(n,1)},prepare:Tt()}}}),{addCartesianGraphicalItem:FV,replaceCartesianGraphicalItem:GV,removeCartesianGraphicalItem:HV,addPolarGraphicalItem:Gte,removePolarGraphicalItem:Hte}=_P.actions,VV=_P.reducer,QV=e=>{var r=Yt(),n=g.useRef(null);return g.useLayoutEffect(()=>{n.current===null?r(FV(e)):n.current!==e&&r(GV({prev:n.current,next:e})),n.current=e},[r,e]),g.useLayoutEffect(()=>()=>{n.current&&(r(HV(n.current)),n.current=null)},[r]),null},NP=g.memo(QV),YV=["points"];function hE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function jx(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?hE(Object(n),!0).forEach(function(a){KV(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function KV(e,r,n){return(r=WV(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function WV(e){var r=XV(e,"string");return typeof r=="symbol"?r:r+""}function XV(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function df(){return df=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},df.apply(null,arguments)}function ZV(e,r){if(e==null)return{};var n,a,l=JV(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function JV(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function eQ(e){var{option:r,dotProps:n,className:a}=e;if(g.isValidElement(r))return g.cloneElement(r,n);if(typeof r=="function")return r(n);var l=St(a,typeof r!="boolean"?r.className:""),o=n??{},{points:u}=o,d=ZV(o,YV);return g.createElement(dP,df({},d,{className:l}))}function tQ(e,r){return e==null?!1:r?!0:e.length===1}function rQ(e){var{points:r,dot:n,className:a,dotClassName:l,dataKey:o,baseProps:u,needClip:d,clipPathId:f,zIndex:p=vr.scatter}=e;if(!tQ(r,n))return null;var h=pP(n),v=y6(n),b=r.map((j,_)=>{var C,w,E=jx(jx(jx({r:3},u),v),{},{index:_,cx:(C=j.x)!==null&&C!==void 0?C:void 0,cy:(w=j.y)!==null&&w!==void 0?w:void 0,dataKey:o,value:j.value,payload:j.payload,points:r});return g.createElement(eQ,{key:"dot-".concat(_),option:n,dotProps:E,className:l})}),x={};return d&&f!=null&&(x.clipPath="url(#clipPath-".concat(h?"":"dots-").concat(f,")")),g.createElement(Un,{zIndex:p},g.createElement(qn,df({className:a},x),b))}function vE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function gE(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?vE(Object(n),!0).forEach(function(a){nQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function nQ(e,r,n){return(r=aQ(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function aQ(e){var r=iQ(e,"string");return typeof r=="symbol"?r:r+""}function iQ(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var SP=0,sQ={xAxis:{},yAxis:{},zAxis:{}},wP=rn({name:"cartesianAxis",initialState:sQ,reducers:{addXAxis:{reducer(e,r){e.xAxis[r.payload.id]=r.payload},prepare:Tt()},replaceXAxis:{reducer(e,r){var{prev:n,next:a}=r.payload;e.xAxis[n.id]!==void 0&&(n.id!==a.id&&delete e.xAxis[n.id],e.xAxis[a.id]=a)},prepare:Tt()},removeXAxis:{reducer(e,r){delete e.xAxis[r.payload.id]},prepare:Tt()},addYAxis:{reducer(e,r){e.yAxis[r.payload.id]=r.payload},prepare:Tt()},replaceYAxis:{reducer(e,r){var{prev:n,next:a}=r.payload;e.yAxis[n.id]!==void 0&&(n.id!==a.id&&delete e.yAxis[n.id],e.yAxis[a.id]=a)},prepare:Tt()},removeYAxis:{reducer(e,r){delete e.yAxis[r.payload.id]},prepare:Tt()},addZAxis:{reducer(e,r){e.zAxis[r.payload.id]=r.payload},prepare:Tt()},replaceZAxis:{reducer(e,r){var{prev:n,next:a}=r.payload;e.zAxis[n.id]!==void 0&&(n.id!==a.id&&delete e.zAxis[n.id],e.zAxis[a.id]=a)},prepare:Tt()},removeZAxis:{reducer(e,r){delete e.zAxis[r.payload.id]},prepare:Tt()},updateYAxisWidth(e,r){var{id:n,width:a}=r.payload,l=e.yAxis[n];if(l){var o,u=l.widthHistory||[];if(u.length===3&&u[0]===u[2]&&a===u[1]&&a!==l.width&&Math.abs(a-((o=u[0])!==null&&o!==void 0?o:0))<=1)return;var d=[...u,a].slice(-3);e.yAxis[n]=gE(gE({},l),{},{width:a,widthHistory:d})}}}}),{addXAxis:lQ,replaceXAxis:oQ,removeXAxis:cQ,addYAxis:uQ,replaceYAxis:dQ,removeYAxis:mQ,addZAxis:Vte,replaceZAxis:Qte,removeZAxis:Yte,updateYAxisWidth:fQ}=wP.actions,pQ=wP.reducer,hQ=de([gr],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),vQ=de([hQ,ui,di],(e,r,n)=>{if(!(!e||r==null||n==null))return{x:e.left,y:e.top,width:Math.max(0,r-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),gj=()=>$e(vQ),gQ=()=>$e(FF);function xE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function _x(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?xE(Object(n),!0).forEach(function(a){xQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function xQ(e,r,n){return(r=bQ(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function bQ(e){var r=yQ(e,"string");return typeof r=="symbol"?r:r+""}function yQ(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var jQ=e=>{var{point:r,childIndex:n,mainColor:a,activeDot:l,dataKey:o,clipPath:u}=e;if(l===!1||r.x==null||r.y==null)return null;var d={index:n,dataKey:o,cx:r.x,cy:r.y,r:4,fill:a??"none",strokeWidth:2,stroke:"#fff",payload:r.payload,value:r.value},f=_x(_x(_x({},d),cu(l)),ey(l)),p;return g.isValidElement(l)?p=g.cloneElement(l,f):typeof l=="function"?p=l(f):p=g.createElement(dP,f),g.createElement(qn,{className:"recharts-active-dot",clipPath:u},p)};function _Q(e){var{points:r,mainColor:n,activeDot:a,itemDataKey:l,clipPath:o,zIndex:u=vr.activeDot}=e,d=$e(Xs),f=gQ();if(r==null||f==null)return null;var p=r.find(h=>f.includes(h.payload));return Rt(p)?null:g.createElement(Un,{zIndex:u},g.createElement(jQ,{point:p,childIndex:Number(d),mainColor:n,dataKey:l,activeDot:a,clipPath:o}))}var bE=(e,r,n)=>{var a=n??e;if(!Rt(a))return ta(a,r,0)},NQ=(e,r,n)=>{var a={},l=e.filter(op),o=e.filter(p=>p.stackId==null),u=l.reduce((p,h)=>{var v=p[h.stackId];return v==null&&(v=[]),v.push(h),p[h.stackId]=v,p},a),d=Object.entries(u).map(p=>{var h,[v,b]=p,x=b.map(_=>_.dataKey),j=bE(r,n,(h=b[0])===null||h===void 0?void 0:h.barSize);return{stackId:v,dataKeys:x,barSize:j}}),f=o.map(p=>{var h=[p.dataKey].filter(b=>b!=null),v=bE(r,n,p.barSize);return{stackId:void 0,dataKeys:h,barSize:v}});return[...d,...f]};function yE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function nm(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?yE(Object(n),!0).forEach(function(a){SQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function SQ(e,r,n){return(r=wQ(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function wQ(e){var r=CQ(e,"string");return typeof r=="symbol"?r:r+""}function CQ(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function EQ(e,r,n,a,l){var o,u=a.length;if(!(u<1)){var d=ta(e,n,0,!0),f,p=[];if(ot((o=a[0])===null||o===void 0?void 0:o.barSize)){var h=!1,v=n/u,b=a.reduce((E,S)=>E+(S.barSize||0),0);b+=(u-1)*d,b>=n&&(b-=(u-1)*d,d=0),b>=n&&v>0&&(h=!0,v*=.9,b=u*v);var x=(n-b)/2>>0,j={offset:x-d,size:0};f=a.reduce((E,S)=>{var A,O={stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:j.offset+j.size+d,size:h?v:(A=S.barSize)!==null&&A!==void 0?A:0}},k=[...E,O];return j=O.position,k},p)}else{var _=ta(r,n,0,!0);n-2*_-(u-1)*d<=0&&(d=0);var C=(n-2*_-(u-1)*d)/u;C>1&&(C>>=0);var w=ot(l)?Math.min(C,l):C;f=a.reduce((E,S,A)=>[...E,{stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:_+(C+d)*A+(C-w)/2,size:w}}],p)}return f}}var AQ=(e,r,n,a,l,o,u)=>{var d=Rt(u)?r:u,f=EQ(n,a,l!==o?l:o,e,d);return l!==o&&f!=null&&(f=f.map(p=>nm(nm({},p),{},{position:nm(nm({},p.position),{},{offset:p.position.offset-l/2})}))),f},zQ=(e,r)=>{var n=Yy(r);if(!(!e||n==null||r==null)){var{stackId:a}=r;if(a!=null){var l=e[a];if(l){var{stackedData:o}=l;if(o)return o.find(u=>u.key===n)}}}},kQ=(e,r)=>{if(!(e==null||r==null)){var n=e.find(a=>a.stackId===r.stackId&&r.dataKey!=null&&a.dataKeys.includes(r.dataKey));if(n!=null)return n.position}};function OQ(e,r){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&ot(e.zIndex)?e.zIndex:r}var DQ=e=>{var{chartData:r}=e,n=Yt(),a=Pr();return g.useEffect(()=>a?()=>{}:(n(z2(r)),()=>{n(z2(void 0))}),[r,n,a]),null},jE={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},CP=rn({name:"brush",initialState:jE,reducers:{setBrushSettings(e,r){return r.payload==null?jE:r.payload}}}),{setBrushSettings:Kte}=CP.actions,PQ=CP.reducer;function MQ(e){return(e%180+180)%180}var TQ=function(r){var{width:n,height:a}=r,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=MQ(l),u=o*Math.PI/180,d=Math.atan(a/n),f=u>d&&u<Math.PI-d?a/Math.sin(u):n/Math.cos(u);return Math.abs(f)},qQ={dots:[],areas:[],lines:[]},EP=rn({name:"referenceElements",initialState:qQ,reducers:{addDot:(e,r)=>{e.dots.push(r.payload)},removeDot:(e,r)=>{var n=Jn(e).dots.findIndex(a=>a===r.payload);n!==-1&&e.dots.splice(n,1)},addArea:(e,r)=>{e.areas.push(r.payload)},removeArea:(e,r)=>{var n=Jn(e).areas.findIndex(a=>a===r.payload);n!==-1&&e.areas.splice(n,1)},addLine:(e,r)=>{e.lines.push(r.payload)},removeLine:(e,r)=>{var n=Jn(e).lines.findIndex(a=>a===r.payload);n!==-1&&e.lines.splice(n,1)}}}),{addDot:Wte,removeDot:Xte,addArea:Zte,removeArea:Jte,addLine:ere,removeLine:tre}=EP.actions,RQ=EP.reducer,IQ=g.createContext(void 0),LQ=e=>{var{children:r}=e,[n]=g.useState("".concat(Fc("recharts"),"-clip")),a=gj();if(a==null)return null;var{x:l,y:o,width:u,height:d}=a;return g.createElement(IQ.Provider,{value:n},g.createElement("defs",null,g.createElement("clipPath",{id:n},g.createElement("rect",{x:l,y:o,height:d,width:u}))),r)};function AP(e,r){if(r<1)return[];if(r===1)return e;for(var n=[],a=0;a<e.length;a+=r){var l=e[a];l!==void 0&&n.push(l)}return n}function $Q(e,r,n){var a={width:e.width+r.width,height:e.height+r.height};return TQ(a,n)}function BQ(e,r,n){var a=n==="width",{x:l,y:o,width:u,height:d}=e;return r===1?{start:a?l:o,end:a?l+u:o+d}:{start:a?l+u:o+d,end:a?l:o}}function nu(e,r,n,a,l){if(e*r<e*a||e*r>e*l)return!1;var o=n();return e*(r-e*o/2-a)>=0&&e*(r+e*o/2-l)<=0}function UQ(e,r){return AP(e,r+1)}function FQ(e,r,n,a,l){for(var o=(a||[]).slice(),{start:u,end:d}=r,f=0,p=1,h=u,v=function(){var j=a?.[f];if(j===void 0)return{v:AP(a,p)};var _=f,C,w=()=>(C===void 0&&(C=n(j,_)),C),E=j.coordinate,S=f===0||nu(e,E,w,h,d);S||(f=0,h=u,p+=1),S&&(h=E+e*(w()/2+l),f+=p)},b;p<=o.length;)if(b=v(),b)return b.v;return[]}function GQ(e,r,n,a,l){var o=(a||[]).slice(),u=o.length;if(u===0)return[];for(var{start:d,end:f}=r,p=1;p<=u;p++){for(var h=(u-1)%p,v=d,b=!0,x=function(){var A=a[_];if(A==null)return 0;var O=_,k,P=()=>(k===void 0&&(k=n(A,O)),k),D=A.coordinate,B=_===h||nu(e,D,P,v,f);if(!B)return b=!1,1;B&&(v=D+e*(P()/2+l))},j,_=h;_<u&&(j=x(),!(j!==0&&j===1));_+=p);if(b){for(var C=[],w=h;w<u;w+=p){var E=a[w];E!=null&&C.push(E)}return C}}return[]}function _E(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Or(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?_E(Object(n),!0).forEach(function(a){HQ(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_E(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function HQ(e,r,n){return(r=VQ(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function VQ(e){var r=QQ(e,"string");return typeof r=="symbol"?r:r+""}function QQ(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function YQ(e,r,n,a,l){for(var o=(a||[]).slice(),u=o.length,{start:d}=r,{end:f}=r,p=function(b){var x=o[b];if(x==null)return 1;var j=x,_,C=()=>(_===void 0&&(_=n(x,b)),_);if(b===u-1){var w=e*(j.coordinate+e*C()/2-f);o[b]=j=Or(Or({},j),{},{tickCoord:w>0?j.coordinate-w*e:j.coordinate})}else o[b]=j=Or(Or({},j),{},{tickCoord:j.coordinate});if(j.tickCoord!=null){var E=nu(e,j.tickCoord,C,d,f);E&&(f=j.tickCoord-e*(C()/2+l),o[b]=Or(Or({},j),{},{isShow:!0}))}},h=u-1;h>=0;h--)p(h);return o}function KQ(e,r,n,a,l,o){var u=(a||[]).slice(),d=u.length,{start:f,end:p}=r;if(o){var h=a[d-1];if(h!=null){var v=n(h,d-1),b=e*(h.coordinate+e*v/2-p);if(u[d-1]=h=Or(Or({},h),{},{tickCoord:b>0?h.coordinate-b*e:h.coordinate}),h.tickCoord!=null){var x=nu(e,h.tickCoord,()=>v,f,p);x&&(p=h.tickCoord-e*(v/2+l),u[d-1]=Or(Or({},h),{},{isShow:!0}))}}}for(var j=o?d-1:d,_=function(E){var S=u[E];if(S==null)return 1;var A=S,O,k=()=>(O===void 0&&(O=n(S,E)),O);if(E===0){var P=e*(A.coordinate-e*k()/2-f);u[E]=A=Or(Or({},A),{},{tickCoord:P<0?A.coordinate-P*e:A.coordinate})}else u[E]=A=Or(Or({},A),{},{tickCoord:A.coordinate});if(A.tickCoord!=null){var D=nu(e,A.tickCoord,k,f,p);D&&(f=A.tickCoord+e*(k()/2+l),u[E]=Or(Or({},A),{},{isShow:!0}))}},C=0;C<j;C++)_(C);return u}function xj(e,r,n){var{tick:a,ticks:l,viewBox:o,minTickGap:u,orientation:d,interval:f,tickFormatter:p,unit:h,angle:v}=e;if(!l||!l.length||!a)return[];if(De(f)||Yf.isSsr){var b;return(b=UQ(l,De(f)?f:0))!==null&&b!==void 0?b:[]}var x=[],j=d==="top"||d==="bottom"?"width":"height",_=h&&j==="width"?Ic(h,{fontSize:r,letterSpacing:n}):{width:0,height:0},C=(O,k)=>{var P=typeof p=="function"?p(O.value,k):O.value;return j==="width"?$Q(Ic(P,{fontSize:r,letterSpacing:n}),_,v):Ic(P,{fontSize:r,letterSpacing:n})[j]},w=l[0],E=l[1],S=l.length>=2&&w!=null&&E!=null?Jr(E.coordinate-w.coordinate):1,A=BQ(o,S,j);return f==="equidistantPreserveStart"?FQ(S,A,C,l,u):f==="equidistantPreserveEnd"?GQ(S,A,C,l,u):(f==="preserveStart"||f==="preserveStartEnd"?x=KQ(S,A,C,l,u,f==="preserveStartEnd"):x=YQ(S,A,C,l,u),x.filter(O=>O.isShow))}var WQ=e=>{var{ticks:r,label:n,labelGapWithTick:a=5,tickSize:l=0,tickMargin:o=0}=e,u=0;if(r){Array.from(r).forEach(h=>{if(h){var v=h.getBoundingClientRect();v.width>u&&(u=v.width)}});var d=n?n.getBoundingClientRect().width:0,f=l+o,p=u+f+d+(n?a:0);return Math.round(p)}return 0},XQ=["axisLine","width","height","className","hide","ticks","axisType"];function ZQ(e,r){if(e==null)return{};var n,a,l=JQ(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function JQ(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function Zs(){return Zs=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Zs.apply(null,arguments)}function NE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Bt(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?NE(Object(n),!0).forEach(function(a){eY(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function eY(e,r,n){return(r=tY(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function tY(e){var r=rY(e,"string");return typeof r=="symbol"?r:r+""}function rY(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var ei={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:vr.axis};function nY(e){var{x:r,y:n,width:a,height:l,orientation:o,mirror:u,axisLine:d,otherSvgProps:f}=e;if(!d)return null;var p=Bt(Bt(Bt({},f),ea(d)),{},{fill:"none"});if(o==="top"||o==="bottom"){var h=+(o==="top"&&!u||o==="bottom"&&u);p=Bt(Bt({},p),{},{x1:r,y1:n+h*l,x2:r+a,y2:n+h*l})}else{var v=+(o==="left"&&!u||o==="right"&&u);p=Bt(Bt({},p),{},{x1:r+v*a,y1:n,x2:r+v*a,y2:n+l})}return g.createElement("line",Zs({},p,{className:St("recharts-cartesian-axis-line",fo(d,"className"))}))}function aY(e,r,n,a,l,o,u,d,f){var p,h,v,b,x,j,_=d?-1:1,C=e.tickSize||u,w=De(e.tickCoord)?e.tickCoord:e.coordinate;switch(o){case"top":p=h=e.coordinate,b=n+ +!d*l,v=b-_*C,j=v-_*f,x=w;break;case"left":v=b=e.coordinate,h=r+ +!d*a,p=h-_*C,x=p-_*f,j=w;break;case"right":v=b=e.coordinate,h=r+ +d*a,p=h+_*C,x=p+_*f,j=w;break;default:p=h=e.coordinate,b=n+ +d*l,v=b+_*C,j=v+_*f,x=w;break}return{line:{x1:p,y1:v,x2:h,y2:b},tick:{x,y:j}}}function iY(e,r){switch(e){case"left":return r?"start":"end";case"right":return r?"end":"start";default:return"middle"}}function sY(e,r){switch(e){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}function lY(e){var{option:r,tickProps:n,value:a}=e,l,o=St(n.className,"recharts-cartesian-axis-tick-value");if(g.isValidElement(r))l=g.cloneElement(r,Bt(Bt({},n),{},{className:o}));else if(typeof r=="function")l=r(Bt(Bt({},n),{},{className:o}));else{var u="recharts-cartesian-axis-tick-value";typeof r!="boolean"&&(u=St(u,hV(r))),l=g.createElement(hj,Zs({},n,{className:u}),a)}return l}var oY=g.forwardRef((e,r)=>{var{ticks:n=[],tick:a,tickLine:l,stroke:o,tickFormatter:u,unit:d,padding:f,tickTextProps:p,orientation:h,mirror:v,x:b,y:x,width:j,height:_,tickSize:C,tickMargin:w,fontSize:E,letterSpacing:S,getTicksConfig:A,events:O,axisType:k}=e,P=xj(Bt(Bt({},A),{},{ticks:n}),E,S),D=iY(h,v),B=sY(h,v),U=ea(A),$=cu(a),R={};typeof l=="object"&&(R=l);var Y=Bt(Bt({},U),{},{fill:"none"},R),ae=P.map(F=>Bt({entry:F},aY(F,b,x,j,_,h,C,v,w))),M=ae.map(F=>{var{entry:I,line:X}=F;return g.createElement(qn,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(I.value,"-").concat(I.coordinate,"-").concat(I.tickCoord)},l&&g.createElement("line",Zs({},Y,X,{className:St("recharts-cartesian-axis-tick-line",fo(l,"className"))})))}),T=ae.map((F,I)=>{var X,L,{entry:ne,tick:K}=F,oe=Bt(Bt(Bt(Bt({verticalAnchor:B},U),{},{textAnchor:D,stroke:"none",fill:o},K),{},{index:I,payload:ne,visibleTicksCount:P.length,tickFormatter:u,padding:f},p),{},{angle:(X=(L=p?.angle)!==null&&L!==void 0?L:U.angle)!==null&&X!==void 0?X:0}),xe=Bt(Bt({},oe),$);return g.createElement(qn,Zs({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(ne.value,"-").concat(ne.coordinate,"-").concat(ne.tickCoord)},ty(O,ne,I)),a&&g.createElement(lY,{option:a,tickProps:xe,value:"".concat(typeof u=="function"?u(ne.value,I):ne.value).concat(d||"")}))});return g.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(k,"-ticks")},T.length>0&&g.createElement(Un,{zIndex:vr.label},g.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(k,"-tick-labels"),ref:r},T)),M.length>0&&g.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(k,"-tick-lines")},M))}),cY=g.forwardRef((e,r)=>{var{axisLine:n,width:a,height:l,className:o,hide:u,ticks:d,axisType:f}=e,p=ZQ(e,XQ),[h,v]=g.useState(""),[b,x]=g.useState(""),j=g.useRef(null);g.useImperativeHandle(r,()=>({getCalculatedWidth:()=>{var C;return WQ({ticks:j.current,label:(C=e.labelRef)===null||C===void 0?void 0:C.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var _=g.useCallback(C=>{if(C){var w=C.getElementsByClassName("recharts-cartesian-axis-tick-value");j.current=w;var E=w[0];if(E){var S=window.getComputedStyle(E),A=S.fontSize,O=S.letterSpacing;(A!==h||O!==b)&&(v(A),x(O))}}},[h,b]);return u||a!=null&&a<=0||l!=null&&l<=0?null:g.createElement(Un,{zIndex:e.zIndex},g.createElement(qn,{className:St("recharts-cartesian-axis",o)},g.createElement(nY,{x:e.x,y:e.y,width:a,height:l,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:ea(e)}),g.createElement(oY,{ref:_,axisType:f,events:p,fontSize:h,getTicksConfig:e,height:e.height,letterSpacing:b,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:d,unit:e.unit,width:e.width,x:e.x,y:e.y}),g.createElement(GH,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},g.createElement(eV,{label:e.label,labelRef:e.labelRef}),e.children)))}),bj=g.forwardRef((e,r)=>{var n=Ur(e,ei);return g.createElement(cY,Zs({},n,{ref:r}))});bj.displayName="CartesianAxis";var uY=["x1","y1","x2","y2","key"],dY=["offset"],mY=["xAxisId","yAxisId"],fY=["xAxisId","yAxisId"];function SE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Dr(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?SE(Object(n),!0).forEach(function(a){pY(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function pY(e,r,n){return(r=hY(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function hY(e){var r=vY(e,"string");return typeof r=="symbol"?r:r+""}function vY(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Rs(){return Rs=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Rs.apply(null,arguments)}function mf(e,r){if(e==null)return{};var n,a,l=gY(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function gY(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var xY=e=>{var{fill:r}=e;if(!r||r==="none")return null;var{fillOpacity:n,x:a,y:l,width:o,height:u,ry:d}=e;return g.createElement("rect",{x:a,y:l,ry:d,width:o,height:u,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function zP(e){var{option:r,lineItemProps:n}=e,a;if(g.isValidElement(r))a=g.cloneElement(r,n);else if(typeof r=="function")a=r(n);else{var l,{x1:o,y1:u,x2:d,y2:f,key:p}=n,h=mf(n,uY),v=(l=ea(h))!==null&&l!==void 0?l:{},{offset:b}=v,x=mf(v,dY);a=g.createElement("line",Rs({},x,{x1:o,y1:u,x2:d,y2:f,fill:"none",key:p}))}return a}function bY(e){var{x:r,width:n,horizontal:a=!0,horizontalPoints:l}=e;if(!a||!l||!l.length)return null;var{xAxisId:o,yAxisId:u}=e,d=mf(e,mY),f=l.map((p,h)=>{var v=Dr(Dr({},d),{},{x1:r,y1:p,x2:r+n,y2:p,key:"line-".concat(h),index:h});return g.createElement(zP,{key:"line-".concat(h),option:a,lineItemProps:v})});return g.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function yY(e){var{y:r,height:n,vertical:a=!0,verticalPoints:l}=e;if(!a||!l||!l.length)return null;var{xAxisId:o,yAxisId:u}=e,d=mf(e,fY),f=l.map((p,h)=>{var v=Dr(Dr({},d),{},{x1:p,y1:r,x2:p,y2:r+n,key:"line-".concat(h),index:h});return g.createElement(zP,{option:a,lineItemProps:v,key:"line-".concat(h)})});return g.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function jY(e){var{horizontalFill:r,fillOpacity:n,x:a,y:l,width:o,height:u,horizontalPoints:d,horizontal:f=!0}=e;if(!f||!r||!r.length||d==null)return null;var p=d.map(v=>Math.round(v+l-l)).sort((v,b)=>v-b);l!==p[0]&&p.unshift(0);var h=p.map((v,b)=>{var x=p[b+1],j=x==null,_=j?l+u-v:x-v;if(_<=0)return null;var C=b%r.length;return g.createElement("rect",{key:"react-".concat(b),y:v,x:a,height:_,width:o,stroke:"none",fill:r[C],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return g.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function _Y(e){var{vertical:r=!0,verticalFill:n,fillOpacity:a,x:l,y:o,width:u,height:d,verticalPoints:f}=e;if(!r||!n||!n.length)return null;var p=f.map(v=>Math.round(v+l-l)).sort((v,b)=>v-b);l!==p[0]&&p.unshift(0);var h=p.map((v,b)=>{var x=p[b+1],j=x==null,_=j?l+u-v:x-v;if(_<=0)return null;var C=b%n.length;return g.createElement("rect",{key:"react-".concat(b),x:v,y:o,width:_,height:d,stroke:"none",fill:n[C],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return g.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var NY=(e,r)=>{var{xAxis:n,width:a,height:l,offset:o}=e;return ok(xj(Dr(Dr(Dr({},ei),n),{},{ticks:ck(n),viewBox:{x:0,y:0,width:a,height:l}})),o.left,o.left+o.width,r)},SY=(e,r)=>{var{yAxis:n,width:a,height:l,offset:o}=e;return ok(xj(Dr(Dr(Dr({},ei),n),{},{ticks:ck(n),viewBox:{x:0,y:0,width:a,height:l}})),o.top,o.top+o.height,r)},wY={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:vr.grid};function Cb(e){var r=hk(),n=vk(),a=pk(),l=Dr(Dr({},Ur(e,wY)),{},{x:De(e.x)?e.x:a.left,y:De(e.y)?e.y:a.top,width:De(e.width)?e.width:a.width,height:De(e.height)?e.height:a.height}),{xAxisId:o,yAxisId:u,x:d,y:f,width:p,height:h,syncWithTicks:v,horizontalValues:b,verticalValues:x}=l,j=Pr(),_=$e(B=>g2(B,"xAxis",o,j)),C=$e(B=>g2(B,"yAxis",u,j));if(!_a(p)||!_a(h)||!De(d)||!De(f))return null;var w=l.verticalCoordinatesGenerator||NY,E=l.horizontalCoordinatesGenerator||SY,{horizontalPoints:S,verticalPoints:A}=l;if((!S||!S.length)&&typeof E=="function"){var O=b&&b.length,k=E({yAxis:C?Dr(Dr({},C),{},{ticks:O?b:C.ticks}):void 0,width:r??p,height:n??h,offset:a},O?!0:v);Rm(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof k,"]")),Array.isArray(k)&&(S=k)}if((!A||!A.length)&&typeof w=="function"){var P=x&&x.length,D=w({xAxis:_?Dr(Dr({},_),{},{ticks:P?x:_.ticks}):void 0,width:r??p,height:n??h,offset:a},P?!0:v);Rm(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(A=D)}return g.createElement(Un,{zIndex:l.zIndex},g.createElement("g",{className:"recharts-cartesian-grid"},g.createElement(xY,{fill:l.fill,fillOpacity:l.fillOpacity,x:l.x,y:l.y,width:l.width,height:l.height,ry:l.ry}),g.createElement(jY,Rs({},l,{horizontalPoints:S})),g.createElement(_Y,Rs({},l,{verticalPoints:A})),g.createElement(bY,Rs({},l,{offset:a,horizontalPoints:S,xAxis:_,yAxis:C})),g.createElement(yY,Rs({},l,{offset:a,verticalPoints:A,xAxis:_,yAxis:C}))))}Cb.displayName="CartesianGrid";var CY={},kP=rn({name:"errorBars",initialState:CY,reducers:{addErrorBar:(e,r)=>{var{itemId:n,errorBar:a}=r.payload;e[n]||(e[n]=[]),e[n].push(a)},replaceErrorBar:(e,r)=>{var{itemId:n,prev:a,next:l}=r.payload;e[n]&&(e[n]=e[n].map(o=>o.dataKey===a.dataKey&&o.direction===a.direction?l:o))},removeErrorBar:(e,r)=>{var{itemId:n,errorBar:a}=r.payload;e[n]&&(e[n]=e[n].filter(l=>l.dataKey!==a.dataKey||l.direction!==a.direction))}}}),{addErrorBar:rre,replaceErrorBar:nre,removeErrorBar:are}=kP.actions,EY=kP.reducer,AY=["children"];function zY(e,r){if(e==null)return{};var n,a,l=kY(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function kY(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var OY={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},DY=g.createContext(OY);function OP(e){var{children:r}=e,n=zY(e,AY);return g.createElement(DY.Provider,{value:n},r)}function yj(e,r){var n,a,l=$e(p=>pi(p,e)),o=$e(p=>hi(p,r)),u=(n=l?.allowDataOverflow)!==null&&n!==void 0?n:mr.allowDataOverflow,d=(a=o?.allowDataOverflow)!==null&&a!==void 0?a:fr.allowDataOverflow,f=u||d;return{needClip:f,needClipX:u,needClipY:d}}function DP(e){var{xAxisId:r,yAxisId:n,clipPathId:a}=e,l=gj(),{needClipX:o,needClipY:u,needClip:d}=yj(r,n);if(!d||!l)return null;var{x:f,y:p,width:h,height:v}=l;return g.createElement("clipPath",{id:"clipPath-".concat(a)},g.createElement("rect",{x:o?f:f-h/2,y:u?p:p-v/2,width:o?h:h*2,height:u?v:v*2}))}var PP=(e,r,n,a)=>ns(e,"xAxis",r,a),MP=(e,r,n,a)=>rs(e,"xAxis",r,a),TP=(e,r,n,a)=>ns(e,"yAxis",n,a),qP=(e,r,n,a)=>rs(e,"yAxis",n,a),PY=de([bt,PP,TP,MP,qP],(e,r,n,a,l)=>ci(e,"xAxis")?ho(r,a,!1):ho(n,l,!1)),MY=(e,r,n,a,l)=>l;function TY(e){return e.type==="line"}var qY=de([dp,MY],(e,r)=>e.filter(TY).find(n=>n.id===r)),RY=de([bt,PP,TP,MP,qP,qY,PY,Ly],(e,r,n,a,l,o,u,d)=>{var{chartData:f,dataStartIndex:p,dataEndIndex:h}=d;if(!(o==null||r==null||n==null||a==null||l==null||a.length===0||l.length===0||u==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:v,data:b}=o,x;if(b!=null&&b.length>0?x=b:x=f?.slice(p,h+1),x!=null)return SK({layout:e,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:l,dataKey:v,bandSize:u,displayedData:x})}});function IY(e){var r=cu(e),n=3,a=2;if(r!=null){var{r:l,strokeWidth:o}=r,u=Number(l),d=Number(o);return(Number.isNaN(u)||u<0)&&(u=n),(Number.isNaN(d)||d<0)&&(d=a),{r:u,strokeWidth:d}}return{r:n,strokeWidth:a}}var Nx={exports:{}},Sx={};var wE;function LY(){if(wE)return Sx;wE=1;var e=Nf();function r(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var n=typeof Object.is=="function"?Object.is:r,a=e.useSyncExternalStore,l=e.useRef,o=e.useEffect,u=e.useMemo,d=e.useDebugValue;return Sx.useSyncExternalStoreWithSelector=function(f,p,h,v,b){var x=l(null);if(x.current===null){var j={hasValue:!1,value:null};x.current=j}else j=x.current;x=u(function(){function C(O){if(!w){if(w=!0,E=O,O=v(O),b!==void 0&&j.hasValue){var k=j.value;if(b(k,O))return S=k}return S=O}if(k=S,n(E,O))return k;var P=v(O);return b!==void 0&&b(k,P)?(E=O,k):(E=O,S=P)}var w=!1,E,S,A=h===void 0?null:h;return[function(){return C(p())},A===null?void 0:function(){return C(A())}]},[p,h,v,b]);var _=a(f,x[0],x[1]);return o(function(){j.hasValue=!0,j.value=_},[_]),d(_),_},Sx}var CE;function $Y(){return CE||(CE=1,Nx.exports=LY()),Nx.exports}$Y();function BY(e){e()}function UY(){let e=null,r=null;return{clear(){e=null,r=null},notify(){BY(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){const n=[];let a=e;for(;a;)n.push(a),a=a.next;return n},subscribe(n){let a=!0;const l=r={callback:n,next:null,prev:r};return l.prev?l.prev.next=l:e=l,function(){!a||e===null||(a=!1,l.next?l.next.prev=l.prev:r=l.prev,l.prev?l.prev.next=l.next:e=l.next)}}}}var EE={notify(){},get:()=>[]};function FY(e,r){let n,a=EE,l=0,o=!1;function u(_){h();const C=a.subscribe(_);let w=!1;return()=>{w||(w=!0,C(),v())}}function d(){a.notify()}function f(){j.onStateChange&&j.onStateChange()}function p(){return o}function h(){l++,n||(n=e.subscribe(f),a=UY())}function v(){l--,n&&l===0&&(n(),n=void 0,a.clear(),a=EE)}function b(){o||(o=!0,h())}function x(){o&&(o=!1,v())}const j={addNestedSub:u,notifyNestedSubs:d,handleChangeWrapper:f,isSubscribed:p,trySubscribe:b,tryUnsubscribe:x,getListeners:()=>a};return j}var GY=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",HY=GY(),VY=()=>typeof navigator<"u"&&navigator.product==="ReactNative",QY=VY(),YY=()=>HY||QY?g.useLayoutEffect:g.useEffect,KY=YY();function AE(e,r){return e===r?e!==0||r!==0||1/e===1/r:e!==e&&r!==r}function WY(e,r){if(AE(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;const n=Object.keys(e),a=Object.keys(r);if(n.length!==a.length)return!1;for(let l=0;l<n.length;l++)if(!Object.prototype.hasOwnProperty.call(r,n[l])||!AE(e[n[l]],r[n[l]]))return!1;return!0}var XY=Symbol.for("react-redux-context"),ZY=typeof globalThis<"u"?globalThis:{};function JY(){if(!g.createContext)return{};const e=ZY[XY]??=new Map;let r=e.get(g.createContext);return r||(r=g.createContext(null),e.set(g.createContext,r)),r}var eK=JY();function tK(e){const{children:r,context:n,serverState:a,store:l}=e,o=g.useMemo(()=>{const f=FY(l);return{store:l,subscription:f,getServerState:a?()=>a:void 0}},[l,a]),u=g.useMemo(()=>l.getState(),[l]);KY(()=>{const{subscription:f}=o;return f.onStateChange=f.notifyNestedSubs,f.trySubscribe(),u!==l.getState()&&f.notifyNestedSubs(),()=>{f.tryUnsubscribe(),f.onStateChange=void 0}},[o,u]);const d=n||eK;return g.createElement(d.Provider,{value:o},r)}var rK=tK,nK=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function aK(e,r){return e==null&&r==null?!0:typeof e=="number"&&typeof r=="number"?e===r||e!==e&&r!==r:e===r}function vp(e,r){var n=new Set([...Object.keys(e),...Object.keys(r)]);for(var a of n)if(nK.has(a)){if(e[a]==null&&r[a]==null)continue;if(!WY(e[a],r[a]))return!1}else if(!aK(e[a],r[a]))return!1;return!0}var iK=["id"],sK=["type","layout","connectNulls","needClip","shape"],lK=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function au(){return au=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},au.apply(null,arguments)}function zE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function pa(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?zE(Object(n),!0).forEach(function(a){oK(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function oK(e,r,n){return(r=cK(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function cK(e){var r=uK(e,"string");return typeof r=="symbol"?r:r+""}function uK(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function jj(e,r){if(e==null)return{};var n,a,l=dK(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function dK(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var mK=e=>{var{dataKey:r,name:n,stroke:a,legendType:l,hide:o}=e;return[{inactive:o,dataKey:r,type:l,color:a,value:Lf(n,r),payload:e}]},fK=g.memo(e=>{var{dataKey:r,data:n,stroke:a,strokeWidth:l,fill:o,name:u,hide:d,unit:f,tooltipType:p,id:h}=e,v={dataDefinedOnItem:n,getPosition:rl,settings:{stroke:a,strokeWidth:l,fill:o,dataKey:r,nameKey:void 0,name:Lf(u,r),hide:d,type:p,color:a,unit:f,graphicalItemId:h}};return g.createElement(bP,{tooltipEntrySettings:v})}),RP=(e,r)=>"".concat(r,"px ").concat(e-r,"px");function pK(e,r){for(var n=e.length%2!==0?[...e,0]:e,a=[],l=0;l<r;++l)a=[...a,...n];return a}var hK=(e,r,n)=>{var a=n.reduce((x,j)=>x+j);if(!a)return RP(r,e);for(var l=Math.floor(e/a),o=e%a,u=r-e,d=[],f=0,p=0;f<n.length;p+=(h=n[f])!==null&&h!==void 0?h:0,++f){var h,v=n[f];if(v!=null&&p+v>o){d=[...n.slice(0,f),o-p];break}}var b=d.length%2===0?[0,u]:[u];return[...pK(n,l),...d,...b].map(x=>"".concat(x,"px")).join(", ")};function vK(e){var{clipPathId:r,points:n,props:a}=e,{dot:l,dataKey:o,needClip:u}=a,{id:d}=a,f=jj(a,iK),p=ea(f);return g.createElement(rQ,{points:n,dot:l,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:o,baseProps:p,needClip:u,clipPathId:r})}function gK(e){var{showLabels:r,children:n,points:a}=e,l=g.useMemo(()=>a?.map(o=>{var u,d,f={x:(u=o.x)!==null&&u!==void 0?u:0,y:(d=o.y)!==null&&d!==void 0?d:0,width:0,lowerWidth:0,upperWidth:0,height:0};return pa(pa({},f),{},{value:o.value,payload:o.payload,viewBox:f,parentViewBox:void 0,fill:void 0})}),[a]);return g.createElement(oP,{value:r?l:void 0},n)}function kE(e){var{clipPathId:r,pathRef:n,points:a,strokeDasharray:l,props:o}=e,{type:u,layout:d,connectNulls:f,needClip:p,shape:h}=o,v=jj(o,sK),b=pa(pa({},Lr(v)),{},{fill:"none",className:"recharts-line-curve",clipPath:p?"url(#clipPath-".concat(r,")"):void 0,points:a,type:u,layout:d,connectNulls:f,strokeDasharray:l??o.strokeDasharray});return g.createElement(g.Fragment,null,a?.length>1&&g.createElement(hP,au({shapeType:"curve",option:h},b,{pathRef:n})),g.createElement(vK,{points:a,clipPathId:r,props:o}))}function xK(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function bK(e){var{clipPathId:r,props:n,pathRef:a,previousPointsRef:l,longestAnimatedLengthRef:o}=e,{points:u,strokeDasharray:d,isAnimationActive:f,animationBegin:p,animationDuration:h,animationEasing:v,animateNewValues:b,width:x,height:j,onAnimationEnd:_,onAnimationStart:C}=n,w=l.current,E=Wf(u,"recharts-line-"),S=g.useRef(E),[A,O]=g.useState(!1),k=!A,P=g.useCallback(()=>{typeof _=="function"&&_(),O(!1)},[_]),D=g.useCallback(()=>{typeof C=="function"&&C(),O(!0)},[C]),B=xK(a.current),U=g.useRef(0);S.current!==E&&(U.current=o.current,S.current=E);var $=U.current;return g.createElement(gK,{points:u,showLabels:k},n.children,g.createElement(Kf,{animationId:E,begin:p,duration:h,isActive:f,easing:v,onAnimationEnd:P,onAnimationStart:D,key:E},R=>{var Y=Gt($,B+$,R),ae=Math.min(Y,B),M;if(f)if(d){var T="".concat(d).split(/[,\s]+/gim).map(X=>parseFloat(X));M=hK(ae,B,T)}else M=RP(B,ae);else M=d==null?void 0:String(d);if(R>0&&B>0&&(l.current=u,o.current=Math.max(o.current,ae)),w){var F=w.length/u.length,I=R===1?u:u.map((X,L)=>{var ne=Math.floor(L*F);if(w[ne]){var K=w[ne];return pa(pa({},X),{},{x:Gt(K.x,X.x,R),y:Gt(K.y,X.y,R)})}return b?pa(pa({},X),{},{x:Gt(x*2,X.x,R),y:Gt(j/2,X.y,R)}):pa(pa({},X),{},{x:X.x,y:X.y})});return l.current=I,g.createElement(kE,{props:n,points:I,clipPathId:r,pathRef:a,strokeDasharray:M})}return g.createElement(kE,{props:n,points:u,clipPathId:r,pathRef:a,strokeDasharray:M})}),g.createElement(uP,{label:n.label}))}function yK(e){var{clipPathId:r,props:n}=e,a=g.useRef(null),l=g.useRef(0),o=g.useRef(null);return g.createElement(bK,{props:n,clipPathId:r,previousPointsRef:a,longestAnimatedLengthRef:l,pathRef:o})}var jK=(e,r)=>{var n,a;return{x:(n=e.x)!==null&&n!==void 0?n:void 0,y:(a=e.y)!==null&&a!==void 0?a:void 0,value:e.value,errorVal:tr(e.payload,r)}};class _K extends g.Component{render(){var{hide:r,dot:n,points:a,className:l,xAxisId:o,yAxisId:u,top:d,left:f,width:p,height:h,id:v,needClip:b,zIndex:x}=this.props;if(r)return null;var j=St("recharts-line",l),_=v,{r:C,strokeWidth:w}=IY(n),E=pP(n),S=C*2+w,A=b?"url(#clipPath-".concat(E?"":"dots-").concat(_,")"):void 0;return g.createElement(Un,{zIndex:x},g.createElement(qn,{className:j},b&&g.createElement("defs",null,g.createElement(DP,{clipPathId:_,xAxisId:o,yAxisId:u}),!E&&g.createElement("clipPath",{id:"clipPath-dots-".concat(_)},g.createElement("rect",{x:f-S/2,y:d-S/2,width:p+S,height:h+S}))),g.createElement(OP,{xAxisId:o,yAxisId:u,data:a,dataPointFormatter:jK,errorBarOffset:0},g.createElement(yK,{props:this.props,clipPathId:_}))),g.createElement(_Q,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:A}))}}var IP={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:vr.line,type:"linear"};function NK(e){var r=Ur(e,IP),{activeDot:n,animateNewValues:a,animationBegin:l,animationDuration:o,animationEasing:u,connectNulls:d,dot:f,hide:p,isAnimationActive:h,label:v,legendType:b,xAxisId:x,yAxisId:j,id:_}=r,C=jj(r,lK),{needClip:w}=yj(x,j),E=gj(),S=nl(),A=Pr(),O=$e(U=>RY(U,x,j,A,_));if(S!=="horizontal"&&S!=="vertical"||O==null||E==null)return null;var{height:k,width:P,x:D,y:B}=E;return g.createElement(_K,au({},C,{id:_,connectNulls:d,dot:f,activeDot:n,animateNewValues:a,animationBegin:l,animationDuration:o,animationEasing:u,isAnimationActive:h,hide:p,label:v,legendType:b,xAxisId:x,yAxisId:j,points:O,layout:S,height:k,width:P,left:D,top:B,needClip:w}))}function SK(e){var{layout:r,xAxis:n,yAxis:a,xAxisTicks:l,yAxisTicks:o,dataKey:u,bandSize:d,displayedData:f}=e;return f.map((p,h)=>{var v=tr(p,u);if(r==="horizontal"){var b=hw({axis:n,ticks:l,bandSize:d,entry:p,index:h}),x=Rt(v)?null:a.scale.map(v);return{x:b,y:x??null,value:v,payload:p}}var j=Rt(v)?null:n.scale.map(v),_=hw({axis:a,ticks:o,bandSize:d,entry:p,index:h});return j==null||_==null?null:{x:j,y:_,value:v,payload:p}}).filter(Boolean)}function wK(e){var r=Ur(e,IP),n=Pr();return g.createElement(jP,{id:r.id,type:"line"},a=>g.createElement(g.Fragment,null,g.createElement(yP,{legendPayload:mK(r)}),g.createElement(fK,{dataKey:r.dataKey,data:r.data,stroke:r.stroke,strokeWidth:r.strokeWidth,fill:r.fill,name:r.name,hide:r.hide,unit:r.unit,tooltipType:r.tooltipType,id:a}),g.createElement(NP,{type:"line",id:a,data:r.data,xAxisId:r.xAxisId,yAxisId:r.yAxisId,zAxisId:0,dataKey:r.dataKey,hide:r.hide,isPanorama:n}),g.createElement(NK,au({},r,{id:a}))))}var LP=g.memo(wK,vp);LP.displayName="Line";function sl(e,r){var n,a;return(n=(a=e.graphicalItems.cartesianItems.find(l=>l.id===r))===null||a===void 0?void 0:a.xAxisId)!==null&&n!==void 0?n:SP}function ll(e,r){var n,a;return(n=(a=e.graphicalItems.cartesianItems.find(l=>l.id===r))===null||a===void 0?void 0:a.yAxisId)!==null&&n!==void 0?n:SP}var CK="Invariant failed";function EK(e,r){throw new Error(CK)}function Eb(){return Eb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Eb.apply(null,arguments)}function ff(e){return g.createElement(hP,Eb({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var AK=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a,l)=>{if(De(r))return r;var o=De(a)||Rt(a);return o?r(a,l):(o||EK(),n)}},zK=(e,r,n)=>n,kK=(e,r)=>r,Cu=de([dp,kK],(e,r)=>e.filter(n=>n.type==="bar").find(n=>n.id===r)),OK=de([Cu],e=>e?.maxBarSize),DK=(e,r,n,a)=>a,PK=de([bt,dp,sl,ll,zK],(e,r,n,a,l)=>r.filter(o=>e==="horizontal"?o.xAxisId===n:o.yAxisId===a).filter(o=>o.isPanorama===l).filter(o=>o.hide===!1).filter(o=>o.type==="bar")),MK=(e,r,n)=>{var a=bt(e),l=sl(e,r),o=ll(e,r);if(!(l==null||o==null))return a==="horizontal"?bb(e,"yAxis",o,n):bb(e,"xAxis",l,n)},TK=(e,r)=>{var n=bt(e),a=sl(e,r),l=ll(e,r);if(!(a==null||l==null))return n==="horizontal"?v2(e,"xAxis",a):v2(e,"yAxis",l)},qK=de([PK,I9,TK],NQ),RK=(e,r,n)=>{var a,l,o=Cu(e,r);if(o==null)return 0;var u=sl(e,r),d=ll(e,r);if(u==null||d==null)return 0;var f=bt(e),p=AO(e),{maxBarSize:h}=o,v=Rt(h)?p:h,b,x;return f==="horizontal"?(b=ns(e,"xAxis",u,n),x=rs(e,"xAxis",u,n)):(b=ns(e,"yAxis",d,n),x=rs(e,"yAxis",d,n)),(a=(l=ho(b,x,!0))!==null&&l!==void 0?l:v)!==null&&a!==void 0?a:0},$P=(e,r,n)=>{var a=bt(e),l=sl(e,r),o=ll(e,r);if(!(l==null||o==null)){var u,d;return a==="horizontal"?(u=ns(e,"xAxis",l,n),d=rs(e,"xAxis",l,n)):(u=ns(e,"yAxis",o,n),d=rs(e,"yAxis",o,n)),ho(u,d)}},IK=de([qK,AO,R9,zO,RK,$P,OK],AQ),LK=(e,r,n)=>{var a=sl(e,r);if(a!=null)return ns(e,"xAxis",a,n)},$K=(e,r,n)=>{var a=ll(e,r);if(a!=null)return ns(e,"yAxis",a,n)},BK=(e,r,n)=>{var a=sl(e,r);if(a!=null)return rs(e,"xAxis",a,n)},UK=(e,r,n)=>{var a=ll(e,r);if(a!=null)return rs(e,"yAxis",a,n)},FK=de([IK,Cu],kQ),GK=de([MK,Cu],zQ),HK=de([gr,dy,LK,$K,BK,UK,FK,bt,z9,$P,GK,Cu,DK],(e,r,n,a,l,o,u,d,f,p,h,v,b)=>{var{chartData:x,dataStartIndex:j,dataEndIndex:_}=f;if(!(v==null||u==null||r==null||d!=="horizontal"&&d!=="vertical"||n==null||a==null||l==null||o==null||p==null)){var{data:C}=v,w;if(C!=null&&C.length>0?w=C:w=x?.slice(j,_+1),w!=null)return bW({layout:d,barSettings:v,pos:u,parentViewBox:r,bandSize:p,xAxis:n,yAxis:a,xAxisTicks:l,yAxisTicks:o,stackedData:h,displayedData:w,offset:e,cells:b,dataStartIndex:j})}}),VK=["index"];function Ab(){return Ab=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ab.apply(null,arguments)}function QK(e,r){if(e==null)return{};var n,a,l=YK(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function YK(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var BP=g.createContext(void 0),KK=e=>{var r=g.useContext(BP);if(r!=null)return r.stackId;if(e!=null)return DL(e)},WK=(e,r)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(r),XK=e=>{var r=g.useContext(BP);if(r!=null){var{stackId:n}=r;return"url(#".concat(WK(n,e),")")}},UP=e=>{var{index:r}=e,n=QK(e,VK),a=XK(r);return g.createElement(qn,Ab({className:"recharts-bar-stack-layer",clipPath:a},n))},ZK=["onMouseEnter","onMouseLeave","onClick"],JK=["value","background","tooltipPosition"],eW=["id"],tW=["onMouseEnter","onClick","onMouseLeave"];function li(){return li=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},li.apply(null,arguments)}function OE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function Rr(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?OE(Object(n),!0).forEach(function(a){rW(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function rW(e,r,n){return(r=nW(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function nW(e){var r=aW(e,"string");return typeof r=="symbol"?r:r+""}function aW(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function pf(e,r){if(e==null)return{};var n,a,l=iW(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function iW(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var sW=e=>{var{dataKey:r,name:n,fill:a,legendType:l,hide:o}=e;return[{inactive:o,dataKey:r,type:l,color:a,value:Lf(n,r),payload:e}]},lW=g.memo(e=>{var{dataKey:r,stroke:n,strokeWidth:a,fill:l,name:o,hide:u,unit:d,tooltipType:f,id:p}=e,h={dataDefinedOnItem:void 0,getPosition:rl,settings:{stroke:n,strokeWidth:a,fill:l,dataKey:r,nameKey:void 0,name:Lf(o,r),hide:u,type:f,color:l,unit:d,graphicalItemId:p}};return g.createElement(bP,{tooltipEntrySettings:h})});function oW(e){var r=$e(Xs),{data:n,dataKey:a,background:l,allOtherBarProps:o}=e,{onMouseEnter:u,onMouseLeave:d,onClick:f}=o,p=pf(o,ZK),h=vP(u,a,o.id),v=gP(d),b=xP(f,a,o.id);if(!l||n==null)return null;var x=cu(l);return g.createElement(Un,{zIndex:OQ(l,vr.barBackground)},n.map((j,_)=>{var{value:C,background:w,tooltipPosition:E}=j,S=pf(j,JK);if(!w)return null;var A=h(j,_),O=v(j,_),k=b(j,_),P=Rr(Rr(Rr(Rr(Rr({option:l,isActive:String(_)===r},S),{},{fill:"#eee"},w),x),ty(p,j,_)),{},{onMouseEnter:A,onMouseLeave:O,onClick:k,dataKey:a,index:_,className:"recharts-bar-background-rectangle"});return g.createElement(ff,li({key:"background-bar-".concat(_)},P))}))}function cW(e){var{showLabels:r,children:n,rects:a}=e,l=a?.map(o=>{var u={x:o.x,y:o.y,width:o.width,lowerWidth:o.width,upperWidth:o.width,height:o.height};return Rr(Rr({},u),{},{value:o.value,payload:o.payload,parentViewBox:o.parentViewBox,viewBox:u,fill:o.fill})});return g.createElement(oP,{value:r?l:void 0},n)}function uW(e){var{shape:r,activeBar:n,baseProps:a,entry:l,index:o,dataKey:u}=e,d=$e(Xs),f=$e($D),p=n&&String(o)===d&&(f==null||u===f),h=p?n:r;return p?g.createElement(Un,{zIndex:vr.activeBar},g.createElement(UP,{index:o},g.createElement(ff,li({},a,{name:String(a.name)},l,{isActive:p,option:h,index:o,dataKey:u})))):g.createElement(ff,li({},a,{name:String(a.name)},l,{isActive:p,option:h,index:o,dataKey:u}))}function dW(e){var{shape:r,baseProps:n,entry:a,index:l,dataKey:o}=e;return g.createElement(ff,li({},n,{name:String(n.name)},a,{isActive:!1,option:r,index:l,dataKey:o}))}function mW(e){var r,{data:n,props:a}=e,l=(r=ea(a))!==null&&r!==void 0?r:{},{id:o}=l,u=pf(l,eW),{shape:d,dataKey:f,activeBar:p}=a,{onMouseEnter:h,onClick:v,onMouseLeave:b}=a,x=pf(a,tW),j=vP(h,f,o),_=gP(b),C=xP(v,f,o);return n?g.createElement(g.Fragment,null,n.map((w,E)=>g.createElement(UP,li({index:E,key:"rectangle-".concat(w?.x,"-").concat(w?.y,"-").concat(w?.value,"-").concat(E),className:"recharts-bar-rectangle"},ty(x,w,E),{onMouseEnter:j(w,E),onMouseLeave:_(w,E),onClick:C(w,E)}),p?g.createElement(uW,{shape:d,activeBar:p,baseProps:u,entry:w,index:E,dataKey:f}):g.createElement(dW,{shape:d,baseProps:u,entry:w,index:E,dataKey:f})))):null}function fW(e){var{props:r,previousRectanglesRef:n}=e,{data:a,layout:l,isAnimationActive:o,animationBegin:u,animationDuration:d,animationEasing:f,onAnimationEnd:p,onAnimationStart:h}=r,v=n.current,b=Wf(r,"recharts-bar-"),[x,j]=g.useState(!1),_=!x,C=g.useCallback(()=>{typeof p=="function"&&p(),j(!1)},[p]),w=g.useCallback(()=>{typeof h=="function"&&h(),j(!0)},[h]);return g.createElement(cW,{showLabels:_,rects:a},g.createElement(Kf,{animationId:b,begin:u,duration:d,isActive:o,easing:f,onAnimationEnd:C,onAnimationStart:w,key:b},E=>{var S=E===1?a:a?.map((A,O)=>{var k=v&&v[O];if(k)return Rr(Rr({},A),{},{x:Gt(k.x,A.x,E),y:Gt(k.y,A.y,E),width:Gt(k.width,A.width,E),height:Gt(k.height,A.height,E)});if(l==="horizontal"){var P=Gt(0,A.height,E),D=Gt(A.stackedBarStart,A.y,E);return Rr(Rr({},A),{},{y:D,height:P})}var B=Gt(0,A.width,E),U=Gt(A.stackedBarStart,A.x,E);return Rr(Rr({},A),{},{width:B,x:U})});return E>0&&(n.current=S??null),S==null?null:g.createElement(qn,null,g.createElement(mW,{props:r,data:S}))}),g.createElement(uP,{label:r.label}),r.children)}function pW(e){var r=g.useRef(null);return g.createElement(fW,{previousRectanglesRef:r,props:e})}var FP=0,hW=(e,r)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:tr(e,r)}};class vW extends g.PureComponent{render(){var{hide:r,data:n,dataKey:a,className:l,xAxisId:o,yAxisId:u,needClip:d,background:f,id:p}=this.props;if(r||n==null)return null;var h=St("recharts-bar",l),v=p;return g.createElement(qn,{className:h,id:p},d&&g.createElement("defs",null,g.createElement(DP,{clipPathId:v,xAxisId:o,yAxisId:u})),g.createElement(qn,{className:"recharts-bar-rectangles",clipPath:d?"url(#clipPath-".concat(v,")"):void 0},g.createElement(oW,{data:n,dataKey:a,background:f,allOtherBarProps:this.props}),g.createElement(pW,this.props)))}}var gW={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:FP,xAxisId:0,yAxisId:0,zIndex:vr.bar};function xW(e){var{xAxisId:r,yAxisId:n,hide:a,legendType:l,minPointSize:o,activeBar:u,animationBegin:d,animationDuration:f,animationEasing:p,isAnimationActive:h}=e,{needClip:v}=yj(r,n),b=nl(),x=Pr(),j=bV(e.children,pj),_=$e(E=>HK(E,e.id,x,j));if(b!=="vertical"&&b!=="horizontal")return null;var C,w=_?.[0];return w==null||w.height==null||w.width==null?C=0:C=b==="vertical"?w.height/2:w.width/2,g.createElement(OP,{xAxisId:r,yAxisId:n,data:_,dataPointFormatter:hW,errorBarOffset:C},g.createElement(vW,li({},e,{layout:b,needClip:v,data:_,xAxisId:r,yAxisId:n,hide:a,legendType:l,minPointSize:o,activeBar:u,animationBegin:d,animationDuration:f,animationEasing:p,isAnimationActive:h})))}function bW(e){var{layout:r,barSettings:{dataKey:n,minPointSize:a},pos:l,bandSize:o,xAxis:u,yAxis:d,xAxisTicks:f,yAxisTicks:p,stackedData:h,displayedData:v,offset:b,cells:x,parentViewBox:j,dataStartIndex:_}=e,C=r==="horizontal"?d:u,w=h?C.scale.domain():null,E=PL({numericAxis:C}),S=C.scale.map(E);return v.map((A,O)=>{var k,P,D,B,U,$;if(h){var R=h[O+_];if(R==null)return null;k=EL(R,w)}else k=tr(A,n),Array.isArray(k)||(k=[E,k]);var Y=AK(a,FP)(k[1],O);if(r==="horizontal"){var ae,M=d.scale.map(k[0]),T=d.scale.map(k[1]);if(M==null||T==null)return null;P=vw({axis:u,ticks:f,bandSize:o,offset:l.offset,entry:A,index:O}),D=(ae=T??M)!==null&&ae!==void 0?ae:void 0,B=l.size;var F=M-T;if(U=ya(F)?0:F,$={x:P,y:b.top,width:B,height:b.height},Math.abs(Y)>0&&Math.abs(U)<Math.abs(Y)){var I=Jr(U||Y)*(Math.abs(Y)-Math.abs(U));D-=I,U+=I}}else{var X=u.scale.map(k[0]),L=u.scale.map(k[1]);if(X==null||L==null)return null;if(P=X,D=vw({axis:d,ticks:p,bandSize:o,offset:l.offset,entry:A,index:O}),B=L-X,U=l.size,$={x:b.left,y:D,width:b.width,height:U},Math.abs(Y)>0&&Math.abs(B)<Math.abs(Y)){var ne=Jr(B||Y)*(Math.abs(Y)-Math.abs(B));B+=ne}}if(P==null||D==null||B==null||U==null)return null;var K=Rr(Rr({},A),{},{stackedBarStart:S,x:P,y:D,width:B,height:U,value:h?k:k[1],payload:A,background:$,tooltipPosition:{x:P+B/2,y:D+U/2},parentViewBox:j},x&&x[O]&&x[O].props);return K}).filter(Boolean)}function yW(e){var r=Ur(e,gW),n=KK(r.stackId),a=Pr();return g.createElement(jP,{id:r.id,type:"bar"},l=>g.createElement(g.Fragment,null,g.createElement(yP,{legendPayload:sW(r)}),g.createElement(lW,{dataKey:r.dataKey,stroke:r.stroke,strokeWidth:r.strokeWidth,fill:r.fill,name:r.name,hide:r.hide,unit:r.unit,tooltipType:r.tooltipType,id:l}),g.createElement(NP,{type:"bar",id:l,data:void 0,xAxisId:r.xAxisId,yAxisId:r.yAxisId,zAxisId:0,dataKey:r.dataKey,stackId:n,hide:r.hide,barSize:r.barSize,minPointSize:r.minPointSize,maxBarSize:r.maxBarSize,isPanorama:a}),g.createElement(Un,{zIndex:r.zIndex},g.createElement(xW,li({},r,{id:l})))))}var GP=g.memo(yW,vp);GP.displayName="Bar";var jW=["domain","range"],_W=["domain","range"];function DE(e,r){if(e==null)return{};var n,a,l=NW(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function NW(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function PE(e,r){return e===r?!0:Array.isArray(e)&&e.length===2&&Array.isArray(r)&&r.length===2?e[0]===r[0]&&e[1]===r[1]:!1}function HP(e,r){if(e===r)return!0;var{domain:n,range:a}=e,l=DE(e,jW),{domain:o,range:u}=r,d=DE(r,_W);return!PE(n,o)||!PE(a,u)?!1:vp(l,d)}var SW=["type"],wW=["dangerouslySetInnerHTML","ticks","scale"],CW=["id","scale"];function zb(){return zb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},zb.apply(null,arguments)}function ME(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function TE(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?ME(Object(n),!0).forEach(function(a){EW(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ME(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function EW(e,r,n){return(r=AW(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function AW(e){var r=zW(e,"string");return typeof r=="symbol"?r:r+""}function zW(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function kb(e,r){if(e==null)return{};var n,a,l=kW(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function kW(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function OW(e){var r=Yt(),n=g.useRef(null),a=gk(),{type:l}=e,o=kb(e,SW),u=ip(a,"xAxis",l),d=g.useMemo(()=>{if(u!=null)return TE(TE({},o),{},{type:u})},[o,u]);return g.useLayoutEffect(()=>{d!=null&&(n.current===null?r(lQ(d)):n.current!==d&&r(oQ({prev:n.current,next:d})),n.current=d)},[d,r]),g.useLayoutEffect(()=>()=>{n.current&&(r(cQ(n.current)),n.current=null)},[r]),null}var DW=e=>{var{xAxisId:r,className:n}=e,a=$e(dy),l=Pr(),o="xAxis",u=$e(w=>bD(w,o,r,l)),d=$e(w=>hD(w,r)),f=$e(w=>LU(w,r)),p=$e(w=>IO(w,r));if(d==null||f==null||p==null)return null;var{dangerouslySetInnerHTML:h,ticks:v,scale:b}=e,x=kb(e,wW),{id:j,scale:_}=p,C=kb(p,CW);return g.createElement(bj,zb({},x,C,{x:f.x,y:f.y,width:d.width,height:d.height,className:St("recharts-".concat(o," ").concat(o),n),viewBox:a,ticks:u,axisType:o}))},PW={allowDataOverflow:mr.allowDataOverflow,allowDecimals:mr.allowDecimals,allowDuplicatedCategory:mr.allowDuplicatedCategory,angle:mr.angle,axisLine:ei.axisLine,height:mr.height,hide:!1,includeHidden:mr.includeHidden,interval:mr.interval,label:!1,minTickGap:mr.minTickGap,mirror:mr.mirror,orientation:mr.orientation,padding:mr.padding,reversed:mr.reversed,scale:mr.scale,tick:mr.tick,tickCount:mr.tickCount,tickLine:ei.tickLine,tickSize:ei.tickSize,type:mr.type,xAxisId:0},MW=e=>{var r=Ur(e,PW);return g.createElement(g.Fragment,null,g.createElement(OW,{allowDataOverflow:r.allowDataOverflow,allowDecimals:r.allowDecimals,allowDuplicatedCategory:r.allowDuplicatedCategory,angle:r.angle,dataKey:r.dataKey,domain:r.domain,height:r.height,hide:r.hide,id:r.xAxisId,includeHidden:r.includeHidden,interval:r.interval,minTickGap:r.minTickGap,mirror:r.mirror,name:r.name,orientation:r.orientation,padding:r.padding,reversed:r.reversed,scale:r.scale,tick:r.tick,tickCount:r.tickCount,tickFormatter:r.tickFormatter,ticks:r.ticks,type:r.type,unit:r.unit}),g.createElement(DW,r))},Ob=g.memo(MW,HP);Ob.displayName="XAxis";var TW=["type"],qW=["dangerouslySetInnerHTML","ticks","scale"],RW=["id","scale"];function Db(){return Db=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Db.apply(null,arguments)}function qE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function RE(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?qE(Object(n),!0).forEach(function(a){IW(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function IW(e,r,n){return(r=LW(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function LW(e){var r=$W(e,"string");return typeof r=="symbol"?r:r+""}function $W(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Pb(e,r){if(e==null)return{};var n,a,l=BW(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function BW(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function UW(e){var r=Yt(),n=g.useRef(null),a=gk(),{type:l}=e,o=Pb(e,TW),u=ip(a,"yAxis",l),d=g.useMemo(()=>{if(u!=null)return RE(RE({},o),{},{type:u})},[u,o]);return g.useLayoutEffect(()=>{d!=null&&(n.current===null?r(uQ(d)):n.current!==d&&r(dQ({prev:n.current,next:d})),n.current=d)},[d,r]),g.useLayoutEffect(()=>()=>{n.current&&(r(mQ(n.current)),n.current=null)},[r]),null}function FW(e){var{yAxisId:r,className:n,width:a,label:l}=e,o=g.useRef(null),u=g.useRef(null),d=$e(dy),f=Pr(),p=Yt(),h="yAxis",v=$e(k=>vD(k,r)),b=$e(k=>BU(k,r)),x=$e(k=>bD(k,h,r,f)),j=$e(k=>LO(k,r));if(g.useLayoutEffect(()=>{if(!(a!=="auto"||!v||vj(l)||g.isValidElement(l)||j==null)){var k=o.current;if(k){var P=k.getCalculatedWidth();Math.round(v.width)!==Math.round(P)&&p(fQ({id:r,width:P}))}}},[x,v,p,l,r,a,j]),v==null||b==null||j==null)return null;var{dangerouslySetInnerHTML:_,ticks:C,scale:w}=e,E=Pb(e,qW),{id:S,scale:A}=j,O=Pb(j,RW);return g.createElement(bj,Db({},E,O,{ref:o,labelRef:u,x:b.x,y:b.y,tickTextProps:a==="auto"?{width:void 0}:{width:a},width:v.width,height:v.height,className:St("recharts-".concat(h," ").concat(h),n),viewBox:d,ticks:x,axisType:h}))}var GW={allowDataOverflow:fr.allowDataOverflow,allowDecimals:fr.allowDecimals,allowDuplicatedCategory:fr.allowDuplicatedCategory,angle:fr.angle,axisLine:ei.axisLine,hide:!1,includeHidden:fr.includeHidden,interval:fr.interval,label:!1,minTickGap:fr.minTickGap,mirror:fr.mirror,orientation:fr.orientation,padding:fr.padding,reversed:fr.reversed,scale:fr.scale,tick:fr.tick,tickCount:fr.tickCount,tickLine:ei.tickLine,tickSize:ei.tickSize,type:fr.type,width:fr.width,yAxisId:0},HW=e=>{var r=Ur(e,GW);return g.createElement(g.Fragment,null,g.createElement(UW,{interval:r.interval,id:r.yAxisId,scale:r.scale,type:r.type,domain:r.domain,allowDataOverflow:r.allowDataOverflow,dataKey:r.dataKey,allowDuplicatedCategory:r.allowDuplicatedCategory,allowDecimals:r.allowDecimals,tickCount:r.tickCount,padding:r.padding,includeHidden:r.includeHidden,reversed:r.reversed,ticks:r.ticks,width:r.width,orientation:r.orientation,mirror:r.mirror,hide:r.hide,unit:r.unit,name:r.name,angle:r.angle,minTickGap:r.minTickGap,tick:r.tick,tickFormatter:r.tickFormatter}),g.createElement(FW,r))},Mb=g.memo(HW,HP);Mb.displayName="YAxis";var VW=(e,r)=>r,_j=de([VW,bt,qO,yr,qD,vi,rG,gr],cG),Nj=e=>{var r=e.currentTarget.getBoundingClientRect(),n=r.width/e.currentTarget.offsetWidth,a=r.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-r.left)/n),chartY:Math.round((e.clientY-r.top)/a)}},VP=Rn("mouseClick"),QP=mu();QP.startListening({actionCreator:VP,effect:(e,r)=>{var n=e.payload,a=_j(r.getState(),Nj(n));a?.activeIndex!=null&&r.dispatch(tF({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}});var Tb=Rn("mouseMove"),YP=mu(),am=null;YP.startListening({actionCreator:Tb,effect:(e,r)=>{var n=e.payload;am!==null&&cancelAnimationFrame(am);var a=Nj(n);am=requestAnimationFrame(()=>{var l=r.getState(),o=aj(l,l.tooltip.settings.shared);if(o==="axis"){var u=_j(l,a);u?.activeIndex!=null?r.dispatch(ED({activeIndex:u.activeIndex,activeDataKey:void 0,activeCoordinate:u.activeCoordinate})):r.dispatch(CD())}am=null})}});function QW(e,r){return r instanceof HTMLElement?"HTMLElement <".concat(r.tagName,' class="').concat(r.className,'">'):r===window?"global.window":e==="children"&&typeof r=="object"&&r!==null?"<<CHILDREN>>":r}var IE={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},KP=rn({name:"rootProps",initialState:IE,reducers:{updateOptions:(e,r)=>{var n;e.accessibilityLayer=r.payload.accessibilityLayer,e.barCategoryGap=r.payload.barCategoryGap,e.barGap=(n=r.payload.barGap)!==null&&n!==void 0?n:IE.barGap,e.barSize=r.payload.barSize,e.maxBarSize=r.payload.maxBarSize,e.stackOffset=r.payload.stackOffset,e.syncId=r.payload.syncId,e.syncMethod=r.payload.syncMethod,e.className=r.payload.className,e.baseValue=r.payload.baseValue,e.reverseStackOrder=r.payload.reverseStackOrder}}}),YW=KP.reducer,{updateOptions:KW}=KP.actions,WW=null,XW={updatePolarOptions:(e,r)=>r.payload},WP=rn({name:"polarOptions",initialState:WW,reducers:XW}),{updatePolarOptions:ire}=WP.actions,ZW=WP.reducer,XP=Rn("keyDown"),ZP=Rn("focus"),Sj=mu();Sj.startListening({actionCreator:XP,effect:(e,r)=>{var n=r.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:l}=n.tooltip,o=e.payload;if(!(o!=="ArrowRight"&&o!=="ArrowLeft"&&o!=="Enter")){var u=ij(l,Ao(n),_u(n),Su(n)),d=u==null?-1:Number(u);if(!(!Number.isFinite(d)||d<0)){var f=vi(n);if(o==="Enter"){var p=lf(n,"axis","hover",String(l.index));r.dispatch(jb({active:!l.active,activeIndex:l.index,activeCoordinate:p}));return}var h=HU(n),v=h==="left-to-right"?1:-1,b=o==="ArrowRight"?1:-1,x=d+b*v;if(!(f==null||x>=f.length||x<0)){var j=lf(n,"axis","hover",String(x));r.dispatch(jb({active:!0,activeIndex:x.toString(),activeCoordinate:j}))}}}}}});Sj.startListening({actionCreator:ZP,effect:(e,r)=>{var n=r.getState(),a=n.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:l}=n.tooltip;if(!l.active&&l.index==null){var o="0",u=lf(n,"axis","hover",String(o));r.dispatch(jb({active:!0,activeIndex:o,activeCoordinate:u}))}}}});var Dn=Rn("externalEvent"),JP=mu(),wx=new Map;JP.startListening({actionCreator:Dn,effect:(e,r)=>{var{handler:n,reactEvent:a}=e.payload;if(n!=null){a.persist();var l=a.type,o=wx.get(l);o!==void 0&&cancelAnimationFrame(o);var u=requestAnimationFrame(()=>{try{var d=r.getState(),f={activeCoordinate:$F(d),activeDataKey:$D(d),activeIndex:Xs(d),activeLabel:LD(d),activeTooltipIndex:Xs(d),isTooltipActive:BF(d)};n(f,a)}finally{wx.delete(l)}});wx.set(l,u)}}});var JW=de([Co],e=>e.tooltipItemPayloads),eX=de([JW,(e,r)=>r,(e,r,n)=>n],(e,r,n)=>{if(r!=null){var a=e.find(o=>o.settings.graphicalItemId===n);if(a!=null){var{getPosition:l}=a;if(l!=null)return l(r)}}}),eM=Rn("touchMove"),tM=mu();tM.startListening({actionCreator:eM,effect:(e,r)=>{var n=e.payload;if(!(n.touches==null||n.touches.length===0)){var a=r.getState(),l=aj(a,a.tooltip.settings.shared);if(l==="axis"){var o=n.touches[0];if(o==null)return;var u=_j(a,Nj({clientX:o.clientX,clientY:o.clientY,currentTarget:n.currentTarget}));u?.activeIndex!=null&&r.dispatch(ED({activeIndex:u.activeIndex,activeDataKey:void 0,activeCoordinate:u.activeCoordinate}))}else if(l==="item"){var d,f=n.touches[0];if(document.elementFromPoint==null||f==null)return;var p=document.elementFromPoint(f.clientX,f.clientY);if(!p||!p.getAttribute)return;var h=p.getAttribute($L),v=(d=p.getAttribute(BL))!==null&&d!==void 0?d:void 0,b=Eo(a).find(_=>_.id===v);if(h==null||b==null||v==null)return;var{dataKey:x}=b,j=eX(a,h,v);r.dispatch(wD({activeDataKey:x,activeIndex:h,activeCoordinate:j,activeGraphicalItemId:v}))}}}});var tX=Pz({brush:PQ,cartesianAxis:pQ,chartData:$G,errorBars:EY,graphicalItems:VV,layout:_L,legend:D8,options:TG,polarAxis:pV,polarOptions:ZW,referenceElements:RQ,rootProps:YW,tooltip:rF,zIndex:NG}),rX=function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return Q4({reducer:tX,preloadedState:r,middleware:a=>{var l;return a({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((l="es6")!==null&&l!==void 0?l:"")}).concat([QP.middleware,YP.middleware,Sj.middleware,JP.middleware,tM.middleware])},enhancers:a=>{var l=a;return typeof a=="function"&&(l=a()),l.concat(Yz({type:"raf"}))},devTools:{serialize:{replacer:QW},name:"recharts-".concat(n)}})};function nX(e){var{preloadedState:r,children:n,reduxStoreName:a}=e,l=Pr(),o=g.useRef(null);if(l)return n;o.current==null&&(o.current=rX(r,a));var u=ay;return g.createElement(rK,{context:u,store:o.current},n)}function aX(e){var{layout:r,margin:n}=e,a=Yt(),l=Pr();return g.useEffect(()=>{l||(a(bL(r)),a(xL(n)))},[a,l,r,n]),null}var iX=g.memo(aX,vp);function sX(e){var r=Yt();return g.useEffect(()=>{r(KW(e))},[r,e]),null}function LE(e){var{zIndex:r,isPanorama:n}=e,a=g.useRef(null),l=Yt();return g.useLayoutEffect(()=>(a.current&&l(jG({zIndex:r,element:a.current,isPanorama:n})),()=>{l(_G({zIndex:r,isPanorama:n}))}),[l,r,n]),g.createElement("g",{tabIndex:-1,ref:a})}function $E(e){var{children:r,isPanorama:n}=e,a=$e(dG);if(!a||a.length===0)return r;var l=a.filter(u=>u<0),o=a.filter(u=>u>0);return g.createElement(g.Fragment,null,l.map(u=>g.createElement(LE,{key:u,zIndex:u,isPanorama:n})),r,o.map(u=>g.createElement(LE,{key:u,zIndex:u,isPanorama:n})))}var lX=["children"];function oX(e,r){if(e==null)return{};var n,a,l=cX(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function cX(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}function hf(){return hf=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},hf.apply(null,arguments)}var uX={width:"100%",height:"100%",display:"block"},dX=g.forwardRef((e,r)=>{var n=hk(),a=vk(),l=Ck();if(!_a(n)||!_a(a))return null;var{children:o,otherAttributes:u,title:d,desc:f}=e,p,h;return u!=null&&(typeof u.tabIndex=="number"?p=u.tabIndex:p=l?0:void 0,typeof u.role=="string"?h=u.role:h=l?"application":void 0),g.createElement(XA,hf({},u,{title:d,desc:f,role:h,tabIndex:p,width:n,height:a,style:uX,ref:r}),o)}),mX=e=>{var{children:r}=e,n=$e(Ff);if(!n)return null;var{width:a,height:l,y:o,x:u}=n;return g.createElement(XA,{width:a,height:l,x:u,y:o},r)},BE=g.forwardRef((e,r)=>{var{children:n}=e,a=oX(e,lX),l=Pr();return l?g.createElement(mX,null,g.createElement($E,{isPanorama:!0},n)):g.createElement(dX,hf({ref:r},a),g.createElement($E,{isPanorama:!1},n))});function fX(){var e=Yt(),[r,n]=g.useState(null),a=$e(LL);return g.useEffect(()=>{if(r!=null){var l=r.getBoundingClientRect(),o=l.width/r.offsetWidth;ot(o)&&o!==a&&e(jL(o))}},[r,e,a]),n}function UE(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,a)}return n}function pX(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?UE(Object(n),!0).forEach(function(a){hX(e,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UE(Object(n)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))})}return e}function hX(e,r,n){return(r=vX(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function vX(e){var r=gX(e,"string");return typeof r=="symbol"?r:r+""}function gX(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var a=n.call(e,r);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Zi(){return Zi=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Zi.apply(null,arguments)}var xX=()=>(KG(),null);function vf(e){if(typeof e=="number")return e;if(typeof e=="string"){var r=parseFloat(e);if(!Number.isNaN(r))return r}return 0}var bX=g.forwardRef((e,r)=>{var n,a,l=g.useRef(null),[o,u]=g.useState({containerWidth:vf((n=e.style)===null||n===void 0?void 0:n.width),containerHeight:vf((a=e.style)===null||a===void 0?void 0:a.height)}),d=g.useCallback((p,h)=>{u(v=>{var b=Math.round(p),x=Math.round(h);return v.containerWidth===b&&v.containerHeight===x?v:{containerWidth:b,containerHeight:x}})},[]),f=g.useCallback(p=>{if(typeof r=="function"&&r(p),p!=null&&typeof ResizeObserver<"u"){var{width:h,height:v}=p.getBoundingClientRect();d(h,v);var b=j=>{var _=j[0];if(_!=null){var{width:C,height:w}=_.contentRect;d(C,w)}},x=new ResizeObserver(b);x.observe(p),l.current=x}},[r,d]);return g.useEffect(()=>()=>{var p=l.current;p?.disconnect()},[d]),g.createElement(g.Fragment,null,g.createElement(pu,{width:o.containerWidth,height:o.containerHeight}),g.createElement("div",Zi({ref:f},e)))}),yX=g.forwardRef((e,r)=>{var{width:n,height:a}=e,[l,o]=g.useState({containerWidth:vf(n),containerHeight:vf(a)}),u=g.useCallback((f,p)=>{o(h=>{var v=Math.round(f),b=Math.round(p);return h.containerWidth===v&&h.containerHeight===b?h:{containerWidth:v,containerHeight:b}})},[]),d=g.useCallback(f=>{if(typeof r=="function"&&r(f),f!=null){var{width:p,height:h}=f.getBoundingClientRect();u(p,h)}},[r,u]);return g.createElement(g.Fragment,null,g.createElement(pu,{width:l.containerWidth,height:l.containerHeight}),g.createElement("div",Zi({ref:d},e)))}),jX=g.forwardRef((e,r)=>{var{width:n,height:a}=e;return g.createElement(g.Fragment,null,g.createElement(pu,{width:n,height:a}),g.createElement("div",Zi({ref:r},e)))}),_X=g.forwardRef((e,r)=>{var{width:n,height:a}=e;return typeof n=="string"||typeof a=="string"?g.createElement(yX,Zi({},e,{ref:r})):typeof n=="number"&&typeof a=="number"?g.createElement(jX,Zi({},e,{width:n,height:a,ref:r})):g.createElement(g.Fragment,null,g.createElement(pu,{width:n,height:a}),g.createElement("div",Zi({ref:r},e)))});function NX(e){return e?bX:_X}var SX=g.forwardRef((e,r)=>{var{children:n,className:a,height:l,onClick:o,onContextMenu:u,onDoubleClick:d,onMouseDown:f,onMouseEnter:p,onMouseLeave:h,onMouseMove:v,onMouseUp:b,onTouchEnd:x,onTouchMove:j,onTouchStart:_,style:C,width:w,responsive:E,dispatchTouchEvents:S=!0}=e,A=g.useRef(null),O=Yt(),[k,P]=g.useState(null),[D,B]=g.useState(null),U=fX(),$=my(),R=$?.width>0?$.width:w,Y=$?.height>0?$.height:l,ae=g.useCallback(ue=>{U(ue),typeof r=="function"&&r(ue),P(ue),B(ue),ue!=null&&(A.current=ue)},[U,r,P,B]),M=g.useCallback(ue=>{O(VP(ue)),O(Dn({handler:o,reactEvent:ue}))},[O,o]),T=g.useCallback(ue=>{O(Tb(ue)),O(Dn({handler:p,reactEvent:ue}))},[O,p]),F=g.useCallback(ue=>{O(CD()),O(Dn({handler:h,reactEvent:ue}))},[O,h]),I=g.useCallback(ue=>{O(Tb(ue)),O(Dn({handler:v,reactEvent:ue}))},[O,v]),X=g.useCallback(()=>{O(ZP())},[O]),L=g.useCallback(ue=>{O(XP(ue.key))},[O]),ne=g.useCallback(ue=>{O(Dn({handler:u,reactEvent:ue}))},[O,u]),K=g.useCallback(ue=>{O(Dn({handler:d,reactEvent:ue}))},[O,d]),oe=g.useCallback(ue=>{O(Dn({handler:f,reactEvent:ue}))},[O,f]),xe=g.useCallback(ue=>{O(Dn({handler:b,reactEvent:ue}))},[O,b]),ve=g.useCallback(ue=>{O(Dn({handler:_,reactEvent:ue}))},[O,_]),H=g.useCallback(ue=>{S&&O(eM(ue)),O(Dn({handler:j,reactEvent:ue}))},[O,S,j]),he=g.useCallback(ue=>{O(Dn({handler:x,reactEvent:ue}))},[O,x]),Me=NX(E);return g.createElement(QD.Provider,{value:k},g.createElement(E6.Provider,{value:D},g.createElement(Me,{width:R??C?.width,height:Y??C?.height,className:St("recharts-wrapper",a),style:pX({position:"relative",cursor:"default",width:R,height:Y},C),onClick:M,onContextMenu:ne,onDoubleClick:K,onFocus:X,onKeyDown:L,onMouseDown:oe,onMouseEnter:T,onMouseLeave:F,onMouseMove:I,onMouseUp:xe,onTouchEnd:he,onTouchMove:H,onTouchStart:ve,ref:ae},g.createElement(xX,null),n)))}),wX=["width","height","responsive","children","className","style","compact","title","desc"];function CX(e,r){if(e==null)return{};var n,a,l=EX(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}function EX(e,r){if(e==null)return{};var n={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)!==-1)continue;n[a]=e[a]}return n}var AX=g.forwardRef((e,r)=>{var{width:n,height:a,responsive:l,children:o,className:u,style:d,compact:f,title:p,desc:h}=e,v=CX(e,wX),b=ea(v);return f?g.createElement(g.Fragment,null,g.createElement(pu,{width:n,height:a}),g.createElement(BE,{otherAttributes:b,title:p,desc:h},o)):g.createElement(SX,{className:u,style:d,width:n,height:a,responsive:l??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},g.createElement(BE,{otherAttributes:b,title:p,desc:h,ref:r},g.createElement(LQ,null,o)))});function qb(){return qb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},qb.apply(null,arguments)}var zX={top:5,right:5,bottom:5,left:5},kX={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:zX,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},rM=g.forwardRef(function(r,n){var a,l=Ur(r.categoricalChartProps,kX),{chartName:o,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,categoricalChartProps:p}=r,h={chartName:o,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,eventEmitter:void 0};return g.createElement(nX,{preloadedState:{options:h},reduxStoreName:(a=p.id)!==null&&a!==void 0?a:o},g.createElement(DQ,{chartData:p.data}),g.createElement(iX,{layout:l.layout,margin:l.margin}),g.createElement(sX,{baseValue:l.baseValue,accessibilityLayer:l.accessibilityLayer,barCategoryGap:l.barCategoryGap,maxBarSize:l.maxBarSize,stackOffset:l.stackOffset,barGap:l.barGap,barSize:l.barSize,syncId:l.syncId,syncMethod:l.syncMethod,className:l.className,reverseStackOrder:l.reverseStackOrder}),g.createElement(AX,qb({},l,{ref:n})))}),OX=["axis"],DX=g.forwardRef((e,r)=>g.createElement(rM,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:OX,tooltipPayloadSearcher:YD,categoricalChartProps:e,ref:r})),PX=["axis","item"],MX=g.forwardRef((e,r)=>g.createElement(rM,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:PX,tooltipPayloadSearcher:YD,categoricalChartProps:e,ref:r}));const TX=8,qX=12,RX=14,IX=1;function wj(e){return e instanceof Ae?e.toDate():e instanceof Date?e:e?.seconds?new Date(e.seconds*1e3):new Date(e)}function FE(e,r){return e.getFullYear()===r.getFullYear()&&e.getMonth()===r.getMonth()&&e.getDate()===r.getDate()}function gp(){const e=new Date,r=e.getDay(),n=r===0?-6:1-r,a=new Date(e);return a.setDate(e.getDate()+n),a.setHours(0,0,0,0),a}function LX(){const e=gp(),r=new Date(e);return r.setDate(e.getDate()+6),r.setHours(23,59,59,999),r}function Cx(e,r){return Math.floor(Math.abs(r.getTime()-e.getTime())/864e5)}async function xp(e){try{const r=Ee(_e(Q,"quiz_results"),Ne("userId","==",e),Ve("datePassage","desc"));return(await Ce(r)).docs.map(a=>({id:a.id,...a.data()}))}catch(r){return console.error("Erreur rcupration rsultats lve:",r),[]}}async function $X(e){try{const r=await xp(e);if(r.length===0)return[];const n=new Map;r.forEach(o=>{const u=o.disciplineId;n.has(u)||n.set(u,[]),n.get(u).push(o)});const a=[];n.forEach((o,u)=>{if(o.length<IX)return;const d=o.map(C=>C.pourcentage/100*20),f=d.reduce((C,w)=>C+w,0)/d.length;if(f>=RX)return;let p="stable";if(d.length>=3){const C=d.slice(0,2),w=d.slice(2,4),E=C.reduce((O,k)=>O+k,0)/C.length,S=w.reduce((O,k)=>O+k,0)/w.length,A=E-S;A>1.5?p="hausse":A<-1.5&&(p="baisse")}let h="modere";f<TX?h="critique":f<qX&&(h="important");const v=d[0],b=Math.max(...d),x=Math.min(...d),j=wj(o[0].datePassage),_=o[0].disciplineNom||"Discipline inconnue";a.push({id:`lacune_${u}`,disciplineId:u,disciplineNom:_,moyenne:Math.round(f*10)/10,nombreQuiz:o.length,tendance:p,niveauUrgence:h,dernierQuizDate:j,scoreDetails:{dernierScore:Math.round(v*10)/10,meilleurScore:Math.round(b*10)/10,pireScore:Math.round(x*10)/10}})});const l={critique:0,important:1,modere:2};return a.sort((o,u)=>{const d=l[o.niveauUrgence]-l[u.niveauUrgence];return d!==0?d:o.moyenne-u.moyenne}),a}catch(r){return console.error("Erreur dtection lacunes:",r),[]}}function BX(e){const r=[];let n=1;return e.forEach(a=>{const{id:l,disciplineNom:o,niveauUrgence:u,moyenne:d,tendance:f}=a;switch(u){case"critique":r.push({id:`reco_cours_${l}`,lacuneId:l,type:"revoir_cours",titre:` Revoir les cours de ${o}`,description:`Ta moyenne est de ${d}/20 en ${o}. Il est important de reprendre les bases. Consulte les cours disponibles et prends des notes.`,disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date}),r.push({id:`reco_quiz_${l}`,lacuneId:l,type:"refaire_quiz",titre:` Refaire les quiz de ${o}`,description:"Aprs avoir rvis, refais les quiz pour vrifier ta comprhension. Vise au moins 12/20 !",disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date});break;case"important":r.push({id:`reco_exercice_${l}`,lacuneId:l,type:"exercice_cible",titre:` Exercices cibls en ${o}`,description:`Avec ${d}/20 de moyenne, concentre-toi sur les exercices pratiques. ${f==="hausse"?"Tu progresses, continue !":"Un effort supplmentaire est ncessaire."}`,disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date}),r.push({id:`reco_cours2_${l}`,lacuneId:l,type:"revoir_cours",titre:` Rviser les points cls en ${o}`,description:"Identifie les concepts qui te posent problme et revois-les attentivement.",disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date});break;case"modere":r.push({id:`reco_consolider_${l}`,lacuneId:l,type:"refaire_quiz",titre:` Consolider tes acquis en ${o}`,description:`Tu es proche du niveau attendu (${d}/20). Un quiz supplmentaire devrait suffire pour atteindre 14/20 !`,disciplineNom:o,priorite:n++,completee:!1,dateCreation:new Date});break}}),r}async function UX(e){try{const r=await xp(e);if(r.length===0)return{userId:e,streakActuel:0,meilleurStreak:0,dernierJourActif:null,totalJoursActifs:0,semaineCourante:[!1,!1,!1,!1,!1,!1,!1],historiqueHebdo:[]};const n=new Set;r.forEach(_=>{const C=wj(_.datePassage),w=`${C.getFullYear()}-${C.getMonth()}-${C.getDate()}`;n.add(w)});const a=Array.from(n).map(_=>{const[C,w,E]=_.split("-").map(Number);return new Date(C,w,E)}).sort((_,C)=>C.getTime()-_.getTime()),l=a.length,o=a[0];let u=0;const d=new Date;d.setHours(0,0,0,0);const f=a[0];if(Cx(f,d)<=1){u=1;for(let _=1;_<a.length&&Cx(a[_],a[_-1])===1;_++)u++}let h=0,v=1;for(let _=1;_<a.length;_++)Cx(a[_],a[_-1])===1?v++:(h=Math.max(h,v),v=1);h=Math.max(h,v,u);const b=gp(),x=[];for(let _=0;_<7;_++){const C=new Date(b);C.setDate(b.getDate()+_);const w=a.some(E=>FE(E,C));x.push(w)}const j=[];for(let _=0;_<4;_++){const C=new Date(b);C.setDate(b.getDate()-_*7);let w=0;for(let S=0;S<7;S++){const A=new Date(C);A.setDate(C.getDate()+S),a.some(O=>FE(O,A))&&w++}const E=Math.ceil((C.getDate()+new Date(C.getFullYear(),C.getMonth(),1).getDay())/7);j.push({semaine:_===0?"Cette sem.":`Sem. -${_}`,joursActifs:w})}return{userId:e,streakActuel:u,meilleurStreak:h,dernierJourActif:o,totalJoursActifs:l,semaineCourante:x,historiqueHebdo:j.reverse()}}catch(r){return console.error("Erreur calcul streak:",r),{userId:e,streakActuel:0,meilleurStreak:0,dernierJourActif:null,totalJoursActifs:0,semaineCourante:[!1,!1,!1,!1,!1,!1,!1],historiqueHebdo:[]}}}function FX(e,r,n){const a=[],l=gp(),o=LX(),u=r.length>2?5:3;if(a.push({id:`obj_quiz_${e}_${l.getTime()}`,userId:e,titre:`Passer ${u} quiz cette semaine`,description:`Entrane-toi en passant au moins ${u} quiz pour progresser dans tes matires.`,type:"quiz_count",cible:u,progression:0,statut:"en_cours",dateDebut:l,dateFin:o,recompense:' Badge "Travailleur"'}),r.length>0){const f=r[0],p=Math.min(f.moyenne+3,14);a.push({id:`obj_score_${e}_${l.getTime()}`,userId:e,titre:`Atteindre ${Math.round(p)}/20 en ${f.disciplineNom}`,description:`Ta moyenne actuelle est de ${f.moyenne}/20. Vise ${Math.round(p)}/20 lors de ton prochain quiz !`,type:"score_min",cible:Math.round(p),progression:Math.round(f.moyenne),statut:"en_cours",disciplineId:f.disciplineId,disciplineNom:f.disciplineNom,dateDebut:l,dateFin:o,recompense:' Badge "En progrs"'})}const d=n.streakActuel>=5?7:n.streakActuel+2;return a.push({id:`obj_streak_${e}_${l.getTime()}`,userId:e,titre:`Maintenir un streak de ${d} jours`,description:`Tu es actuellement  ${n.streakActuel} jour(s) conscutif(s). Continue !`,type:"streak",cible:d,progression:n.streakActuel,statut:n.streakActuel>=d?"atteint":"en_cours",dateDebut:l,dateFin:o,recompense:' Badge "Flamme"'}),a}function GX(e,r,n,a){let l=0;if(a.length>0){const v=a.reduce((b,x)=>b+x.pourcentage/100*20,0)/a.length;l=Math.min(v/20*100,100)}let o=100;const u=e.filter(v=>v.niveauUrgence==="critique").length,d=e.filter(v=>v.niveauUrgence==="important").length;o-=u*25,o-=d*15,o=Math.max(o,0);const f=Math.min(r.streakActuel/7*100,100);let p=0;n.length>0&&(p=n.filter(b=>b.statut==="atteint").length/n.length*100);const h=l*.4+o*.25+f*.2+p*.15;return Math.round(Math.min(Math.max(h,0),100))}function HX(e,r,n){const a=gp(),l=r.filter(o=>wj(o.datePassage)>=a);return e.map(o=>{const u={...o};switch(o.type){case"quiz_count":u.progression=l.length;break;case"score_min":if(o.disciplineId){const d=l.filter(f=>f.disciplineId===o.disciplineId);if(d.length>0){const f=Math.max(...d.map(p=>p.pourcentage));u.progression=Math.round(f/100*20)}}break;case"streak":u.progression=n.streakActuel;break}return u.progression>=u.cible&&(u.statut="atteint"),u})}async function Cj(e){try{const r=await $X(e),n=BX(r),a=await UX(e);let l=FX(e,r,a);const o=await xp(e);l=HX(l,o,a);const u=GX(r,a,l,o);return{lacunes:r,recommandations:n,streak:a,objectifs:l,scoreGlobal:u}}catch(r){return console.error("Erreur suivi complet:",r),{lacunes:[],recommandations:[],streak:{userId:e,streakActuel:0,meilleurStreak:0,dernierJourActif:null,totalJoursActifs:0,semaineCourante:[!1,!1,!1,!1,!1,!1,!1],historiqueHebdo:[]},objectifs:[],scoreGlobal:0}}}function gf(e){switch(e){case"critique":return"#ef4444";case"important":return"#f59e0b";case"modere":return"#eab308";case"info":return"#10b981";default:return"#6b7280"}}function nM(e){switch(e){case"critique":return"Critique";case"important":return"Important";case"modere":return"Modr";case"info":return"Info";default:return"Inconnu"}}function aM(e){switch(e){case"hausse":return"";case"baisse":return"";case"stable":return"";default:return""}}function VX(e){return e>=80?"Excellent travail ! Continue comme a, tu es sur la bonne voie ! ":e>=60?"Bon travail ! Quelques efforts supplmentaires et tu seras au top ! ":e>=40?"Tu peux faire mieux ! Suis les recommandations pour progresser. ":e>=20?"Courage ! Chaque effort compte. Commence par les recommandations prioritaires. ":"C'est le moment de se lancer ! Passe ton premier quiz pour commencer. "}function QX(e){return e.cible===0?0:Math.min(Math.round(e.progression/e.cible*100),100)}const YX="PEDA",KX=4,WX=5,XX=40,iM=5;function Za(e){return e instanceof Ae?e.toDate():e instanceof Date?e:e?.seconds?new Date(e.seconds*1e3):new Date(e)}function sM(e){const r=new Date,n=r.getDay(),a=n===0?-6:1-n,l=new Date(r);return l.setDate(r.getDate()+a),l.setHours(0,0,0,0),l}function ZX(e){const r=sM(),n=new Date(r);return n.setDate(r.getDate()+6),n.setHours(23,59,59,999),n}function GE(e){const r=["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"];return`${e.getDate()} ${r[e.getMonth()]}`}function lM(e,r){return Math.floor(Math.abs(r.getTime()-e.getTime())/864e5)}async function JX(e){try{const r="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let n="",a="";for(let u=0;u<KX;u++)n+=r.charAt(Math.floor(Math.random()*r.length)),a+=r.charAt(Math.floor(Math.random()*r.length));const l=`${YX}-${n}-${a}`,o=je(Q,"users",e);return await He(o,{codeParent:l,codeParentGenere:new Date}),l}catch(r){throw console.error("Erreur gnration code invitation:",r),new Error("Impossible de gnrer le code d'invitation")}}async function eZ(e){try{const r=je(Q,"users",e),n=await Et(r);if(!n.exists())throw new Error("lve introuvable");const a=n.data();return a.codeParent?a.codeParent:await JX(e)}catch(r){throw console.error("Erreur rcupration code invitation:",r),new Error("Impossible de rcuprer le code d'invitation")}}async function tZ(e,r){try{const n=r.trim().toUpperCase(),a=_e(Q,"users"),l=Ee(a,Ne("codeParent","==",n),Ne("role","==","eleve"),Ht(1)),o=await Ce(l);if(o.empty)throw new Error("Code d'invitation invalide. Vrifiez le code et ressayez.");const u=o.docs[0],d=u.data(),f=u.id,p=_e(Q,"liens_parent_enfant"),h=Ee(p,Ne("parentId","==",e),Ne("enfantId","==",f),Ne("statut","==","actif"),Ht(1));if(!(await Ce(h)).empty)throw new Error("Cet enfant est dj li  votre compte.");const b={parentId:e,enfantId:f,enfantNom:d.displayName||d.email,enfantEmail:d.email,enfantClasse:d.classe||void 0,codeInvitation:n,statut:"actif",dateCreation:new Date};return{id:(await Pt(p,b)).id,...b}}catch(n){throw console.error("Erreur liaison parent-enfant:",n),n}}async function rZ(e){try{const r=_e(Q,"liens_parent_enfant"),n=Ee(r,Ne("parentId","==",e),Ne("statut","==","actif"),Ve("dateCreation","desc"));return(await Ce(n)).docs.map(l=>({id:l.id,...l.data(),dateCreation:Za(l.data().dateCreation),dateDerniereConsultation:l.data().dateDerniereConsultation?Za(l.data().dateDerniereConsultation):void 0}))}catch(r){return console.error("Erreur rcupration enfants lis:",r),[]}}async function nZ(e,r){try{const n=je(Q,"liens_parent_enfant",e),a=await Et(n);if(!a.exists())throw new Error("Lien introuvable");if(a.data().parentId!==r)throw new Error("Action non autorise");await He(n,{statut:"revoque",dateRevocation:new Date})}catch(n){throw console.error("Erreur rvocation lien:",n),n}}async function aZ(e,r){try{const n=_e(Q,"liens_parent_enfant"),a=Ee(n,Ne("parentId","==",e),Ne("enfantId","==",r),Ne("statut","==","actif"),Ht(1)),l=await Ce(a);if(l.empty)throw new Error("Vous n'tes pas autoris  consulter le suivi de cet enfant.");const o=je(Q,"users",r),u=await Et(o);if(!u.exists())throw new Error("Profil de l'enfant introuvable.");const d=u.data(),f=await Cj(r),p=await xp(r),h=p.slice(0,iM).map(j=>({quizTitre:j.quizTitre||"Quiz",disciplineNom:j.disciplineNom||"Discipline",pourcentage:j.pourcentage,noteSur20:Math.round(j.pourcentage/100*20*10)/10,reussi:j.reussi,datePassage:Za(j.datePassage)})),v=await iZ(e,r,d.displayName||d.email,f.lacunes,f.streak,f.scoreGlobal,p),b=sZ(r,d.displayName||d.email,f,p),x=l.docs[0];return await He(je(Q,"liens_parent_enfant",x.id),{dateDerniereConsultation:new Date}),{enfant:{id:r,nom:d.displayName||d.email,email:d.email,classe:d.classe||void 0,derniereConnexion:d.lastLogin?Za(d.lastLogin):void 0},scoreGlobal:f.scoreGlobal,streak:{actuel:f.streak.streakActuel,meilleur:f.streak.meilleurStreak,semaineCourante:f.streak.semaineCourante},lacunes:f.lacunes.map(j=>({disciplineNom:j.disciplineNom,moyenne:j.moyenne,niveauUrgence:j.niveauUrgence,tendance:j.tendance})),objectifs:f.objectifs.map(j=>({titre:j.titre,progression:j.progression,cible:j.cible,statut:j.statut})),derniersQuiz:h,resume:b,alertes:v}}catch(n){throw console.error("Erreur dashboard parent:",n),n}}async function iZ(e,r,n,a,l,o,u){const d=[],f=new Date;if(a.filter(h=>h.niveauUrgence==="critique").forEach(h=>{d.push({id:`alerte_parent_lacune_${h.id}`,parentId:e,enfantId:r,enfantNom:n,type:"lacune_critique",niveau:"critique",titre:` Alerte critique en ${h.disciplineNom}`,message:`${n} a une moyenne de ${h.moyenne}/20 en ${h.disciplineNom}. Un suivi rapproch est recommand.`,lue:!1,dateCreation:f})}),l.dernierJourActif){const h=lM(Za(l.dernierJourActif),f);h>=WX&&d.push({id:`alerte_parent_inactif_${r}`,parentId:e,enfantId:r,enfantNom:n,type:"inactivite",niveau:"important",titre:` ${n} est inactif`,message:`${n} n'a pas utilis PedaClic depuis ${h} jours. Un petit encouragement pourrait aider !`,lue:!1,dateCreation:f})}else u.length===0&&d.push({id:`alerte_parent_jamais_actif_${r}`,parentId:e,enfantId:r,enfantNom:n,type:"inactivite",niveau:"modere",titre:` ${n} n'a pas encore commenc`,message:`${n} n'a pas encore pass de quiz sur PedaClic. Encouragez-le  commencer !`,lue:!1,dateCreation:f});o<XX&&u.length>0&&d.push({id:`alerte_parent_score_${r}`,parentId:e,enfantId:r,enfantNom:n,type:"score_bas",niveau:"important",titre:` Score global bas : ${o}/100`,message:`Le score de sant global de ${n} est de ${o}/100. Des efforts supplmentaires sont ncessaires dans plusieurs matires.`,lue:!1,dateCreation:f}),a.filter(h=>h.tendance==="hausse").forEach(h=>{d.push({id:`alerte_parent_progression_${h.id}`,parentId:e,enfantId:r,enfantNom:n,type:"progression",niveau:"info",titre:` Progression en ${h.disciplineNom}`,message:`Bonne nouvelle ! ${n} montre une tendance  la hausse en ${h.disciplineNom}.`,lue:!1,dateCreation:f})}),l.streakActuel>=5&&d.push({id:`alerte_parent_streak_${r}`,parentId:e,enfantId:r,enfantNom:n,type:"objectif_atteint",niveau:"info",titre:` Streak de ${l.streakActuel} jours !`,message:`Flicitations ! ${n} maintient un streak de ${l.streakActuel} jours conscutifs de travail.`,lue:!1,dateCreation:f});const p={critique:0,important:1,modere:2,info:3};return d.sort((h,v)=>p[h.niveau]-p[v.niveau]),d}function sZ(e,r,n,a){const l=sM(),o=ZX(),u=new Date(l);u.setDate(u.getDate()-7);const d=new Date(o);d.setDate(d.getDate()-7);const f=a.filter(A=>{const O=Za(A.datePassage);return O>=l&&O<=o}),p=a.filter(A=>{const O=Za(A.datePassage);return O>=u&&O<=d}),h=f.slice(0,iM).map(A=>({quizTitre:A.quizTitre||"Quiz",disciplineNom:A.disciplineNom||"Discipline",pourcentage:A.pourcentage,noteSur20:Math.round(A.pourcentage/100*20*10)/10,reussi:A.reussi,datePassage:Za(A.datePassage)})),v=lZ(f,p),b=new Set;f.forEach(A=>{const O=Za(A.datePassage);b.add(`${O.getFullYear()}-${O.getMonth()}-${O.getDate()}`)});const x=f.reduce((A,O)=>A+(O.tempsEcoule||5),0);let j=0;if(p.length>0){const A=p.reduce((O,k)=>O+k.pourcentage,0)/p.length;j=Math.round(A)}let _="stable";const C=n.scoreGlobal-j;C>5?_="hausse":C<-5&&(_="baisse");const w=n.lacunes.filter(A=>A.niveauUrgence==="critique"||A.niveauUrgence==="important").map(A=>A.disciplineNom),E=n.objectifs.filter(A=>A.statut==="atteint").length,S=`${GE(l)} - ${GE(o)} ${o.getFullYear()}`;return{enfantId:e,enfantNom:r,semaine:S,dateDebut:l,dateFin:o,scoreGlobal:n.scoreGlobal,scoreGlobalPrecedent:j,evolutionScore:_,nombreQuizSemaine:f.length,tempsEstimeMinutes:Math.round(x),joursActifsSemaine:b.size,streakActuel:n.streak.streakActuel,derniersQuiz:h,evolutionDisciplines:v,lacunesCritiques:n.lacunes.filter(A=>A.niveauUrgence==="critique").length,lacunesImportantes:n.lacunes.filter(A=>A.niveauUrgence==="important").length,disciplinesEnDifficulte:w,objectifsAtteints:E,objectifsTotal:n.objectifs.length}}function lZ(e,r){const n=new Map;e.forEach(o=>{n.has(o.disciplineId)||n.set(o.disciplineId,{scores:[],nom:o.disciplineNom||"Discipline"}),n.get(o.disciplineId).scores.push(o.pourcentage)});const a=new Map;r.forEach(o=>{a.has(o.disciplineId)||a.set(o.disciplineId,[]),a.get(o.disciplineId).push(o.pourcentage)});const l=[];return n.forEach((o,u)=>{const d=o.scores.reduce((j,_)=>j+_,0)/o.scores.length,f=a.get(u)||[],p=f.length>0?f.reduce((j,_)=>j+_,0)/f.length:d,h=Math.round(d/100*20*10)/10,v=Math.round(p/100*20*10)/10,b=Math.round((h-v)*10)/10;let x="stable";b>1?x="hausse":b<-1&&(x="baisse"),l.push({disciplineNom:o.nom,disciplineId:u,moyenneSemainePrecedente:v,moyenneSemaineCourante:h,evolution:x,ecart:b})}),l}function oZ(e){return gf(e)}function cZ(e){return{lacune_critique:"Lacune critique",inactivite:"Inactivit",streak_perdu:"Streak perdu",objectif_atteint:"Objectif atteint",progression:"Progression",score_bas:"Score bas",nouveau_quiz:"Nouveau quiz"}[e]||"Alerte"}function HE(e){switch(e){case"hausse":return"";case"baisse":return"";case"stable":return"";default:return""}}function uZ(e){return e>=80?"Votre enfant fait un excellent travail ! Continuez  l'encourager. ":e>=60?"De bons rsultats ! Quelques efforts supplmentaires et ce sera parfait. ":e>=40?"Des progrs sont possibles. Encouragez votre enfant  suivre les recommandations. ":e>=20?"Votre enfant a besoin de soutien. Un suivi rgulier est recommand. ":"Il est temps de commencer ! Encouragez votre enfant  passer ses premiers quiz. "}function Ex(e){const n=lM(e,new Date);return n===0?"Aujourd'hui":n===1?"Hier":n<7?`Il y a ${n} jours`:n<30?`Il y a ${Math.floor(n/7)} semaine(s)`:`Il y a ${Math.floor(n/30)} mois`}const dZ="PROF",mZ=4,im="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",oM=8,fZ=7,pZ=16;function Js(e){return e instanceof Ae?e.toDate():e instanceof Date?e:e?.seconds?new Ae(e.seconds,e.nanoseconds||0).toDate():new Date(e)}function hZ(e,r){return Math.floor(Math.abs(r.getTime()-e.getTime())/864e5)}async function cM(){let e=0;const r=10;for(;e<r;){let n="",a="";for(let d=0;d<mZ;d++)n+=im.charAt(Math.floor(Math.random()*im.length)),a+=im.charAt(Math.floor(Math.random()*im.length));const l=`${dZ}-${n}-${a}`,o=Ee(_e(Q,"groupes_prof"),Ne("codeInvitation","==",l),Ht(1));if((await Ce(o)).empty)return l;e++}throw new Error("Impossible de gnrer un code unique aprs plusieurs tentatives")}async function vZ(e,r,n){try{const a=await cM(),l={profId:e,profNom:r,nom:n.nom.trim(),description:n.description?.trim()||"",matiereId:n.matiereId,matiereNom:n.matiereNom,classeNiveau:n.classeNiveau,codeInvitation:a,nombreInscrits:0,statut:"actif",anneeScolaire:n.anneeScolaire,dateCreation:new Date,dateMiseAJour:new Date},o=await Pt(_e(Q,"groupes_prof"),l);return console.log(` Groupe "${n.nom}" cr avec code: ${a}`),{id:o.id,...l}}catch(a){throw console.error(" Erreur cration groupe:",a),new Error("Impossible de crer le groupe. Ressayez.")}}async function uM(e){try{const r=Ee(_e(Q,"groupes_prof"),Ne("profId","==",e),Ve("dateCreation","desc"));return(await Ce(r)).docs.map(a=>({id:a.id,...a.data(),dateCreation:Js(a.data().dateCreation),dateMiseAJour:a.data().dateMiseAJour?Js(a.data().dateMiseAJour):void 0}))}catch(r){throw console.error(" Erreur rcupration groupes:",r),new Error("Impossible de charger vos groupes.")}}async function gZ(e){try{const r=await Et(je(Q,"groupes_prof",e));if(!r.exists())return null;const n=r.data();return{id:r.id,...n,dateCreation:Js(n.dateCreation),dateMiseAJour:n.dateMiseAJour?Js(n.dateMiseAJour):void 0}}catch(r){return console.error(" Erreur rcupration groupe:",r),null}}async function dM(e,r){try{const n=je(Q,"groupes_prof",e);await He(n,{...r,dateMiseAJour:new Date}),console.log(` Groupe ${e} mis  jour`)}catch(n){throw console.error(" Erreur modification groupe:",n),new Error("Impossible de modifier le groupe.")}}async function xZ(e){try{const r=Tn(Q),n=Ee(_e(Q,"inscriptions_groupe"),Ne("groupeId","==",e));(await Ce(n)).docs.forEach(l=>r.delete(l.ref)),r.delete(je(Q,"groupes_prof",e)),await r.commit(),console.log(` Groupe ${e} et ses inscriptions supprims`)}catch(r){throw console.error(" Erreur suppression groupe:",r),new Error("Impossible de supprimer le groupe.")}}async function bZ(e){await dM(e,{statut:"archive"})}async function yZ(e){try{const r=await cM();return await He(je(Q,"groupes_prof",e),{codeInvitation:r,dateMiseAJour:new Date}),console.log(` Nouveau code pour groupe ${e}: ${r}`),r}catch(r){throw console.error(" Erreur rgnration code:",r),new Error("Impossible de rgnrer le code.")}}async function jZ(e,r,n,a){try{const l=a.trim().toUpperCase(),o=Ee(_e(Q,"groupes_prof"),Ne("codeInvitation","==",l),Ht(1)),u=await Ce(o);if(u.empty)throw new Error("Code d'invitation invalide. Vrifiez le code et ressayez.");const d=u.docs[0],f=d.data();if(f.statut!=="actif")throw new Error("Ce groupe n'accepte plus de nouvelles inscriptions.");const p=Ee(_e(Q,"inscriptions_groupe"),Ne("groupeId","==",d.id),Ne("eleveId","==",e),Ne("statut","==","actif"),Ht(1));if(!(await Ce(p)).empty)throw new Error("Tu es dj inscrit(e) dans ce groupe.");const v={groupeId:d.id,eleveId:e,eleveNom:r,eleveEmail:n,statut:"actif",dateInscription:new Date},b=await Pt(_e(Q,"inscriptions_groupe"),v);return await He(je(Q,"groupes_prof",d.id),{nombreInscrits:as(1),dateMiseAJour:new Date}),console.log(` lve ${r} inscrit au groupe "${f.nom}"`),{id:b.id,...v}}catch(l){throw console.error(" Erreur inscription groupe:",l),l}}async function bp(e,r="actif"){try{const n=Ee(_e(Q,"inscriptions_groupe"),Ne("groupeId","==",e),Ne("statut","==",r),Ve("dateInscription","asc"));return(await Ce(n)).docs.map(l=>({id:l.id,...l.data(),dateInscription:Js(l.data().dateInscription),dateRetrait:l.data().dateRetrait?Js(l.data().dateRetrait):void 0}))}catch(n){throw console.error(" Erreur rcupration lves groupe:",n),new Error("Impossible de charger les lves du groupe.")}}async function _Z(e){try{const r=Ee(_e(Q,"inscriptions_groupe"),Ne("eleveId","==",e),Ne("statut","==","actif")),n=await Ce(r);if(n.empty)return[];const a=[];for(const l of n.docs){const o=l.data().groupeId,u=await gZ(o);u&&u.statut==="actif"&&a.push(u)}return a}catch(r){return console.error(" Erreur rcupration groupes lve:",r),[]}}async function NZ(e,r){try{await He(je(Q,"inscriptions_groupe",e),{statut:"retire",dateRetrait:new Date}),await He(je(Q,"groupes_prof",r),{nombreInscrits:as(-1),dateMiseAJour:new Date}),console.log(" lve retir du groupe")}catch(n){throw console.error(" Erreur retrait lve:",n),new Error("Impossible de retirer l'lve du groupe.")}}async function Ej(e){try{const n=(await bp(e)).map(b=>b.eleveId);if(n.length===0)return{groupeId:e,nombreEleves:0,moyenneClasse:0,tauxReussite:0,tauxParticipation:0,totalQuizPasses:0,elevesEnDifficulte:0,meilleureNote:0,pireNote:0,derniereMiseAJour:new Date};const a=[],l=[];for(let b=0;b<n.length;b+=10)l.push(n.slice(b,b+10));for(const b of l){const x=Ee(_e(Q,"quiz_results"),Ne("userId","in",b));(await Ce(x)).docs.forEach(_=>a.push({id:_.id,..._.data()}))}const o=new Map;for(const b of a){const x=b.userId;o.has(x)||o.set(x,{total:0,somme:0,reussis:0});const j=o.get(x);j.total++,j.somme+=b.score||0,(b.score||0)>=10&&j.reussis++}let u=0,d=0,f=0,p=0,h=20,v=0;for(const[,b]of o){const x=b.total>0?b.somme/b.total:0;u+=x,d++,v+=b.total,x<oM&&f++,x>p&&(p=x),x<h&&(h=x)}return d===0&&(h=0),{groupeId:e,nombreEleves:n.length,moyenneClasse:d>0?Math.round(u/d*10)/10:0,tauxReussite:v>0?Math.round(Array.from(o.values()).reduce((b,x)=>b+x.reussis,0)/v*100):0,tauxParticipation:Math.round(d/n.length*100),totalQuizPasses:v,elevesEnDifficulte:f,meilleureNote:Math.round(p*10)/10,pireNote:Math.round(h*10)/10,derniereMiseAJour:new Date}}catch(r){throw console.error(" Erreur calcul stats groupe:",r),new Error("Impossible de calculer les statistiques du groupe.")}}async function SZ(e){try{const r=await bp(e);if(r.length===0)return[];const n=[];for(const a of r)try{const l=await Cj(a.eleveId),o=Ee(_e(Q,"quiz_results"),Ne("userId","==",a.eleveId),Ve("datePassage","desc")),d=(await Ce(o)).docs.map(x=>x.data());let f=0,p=0,h;if(d.length>0){const x=d.reduce((j,_)=>j+(_.score||0),0);f=Math.round(x/d.length*10)/10,p=Math.round(d.filter(j=>(j.score||0)>=10).length/d.length*100),h=Js(d[0].datePassage)}let v="stable";if(d.length>=4){const x=d.slice(0,Math.ceil(d.length/2)),j=d.slice(Math.ceil(d.length/2)),_=x.reduce((w,E)=>w+(E.score||0),0)/x.length,C=j.reduce((w,E)=>w+(E.score||0),0)/j.length;_-C>1?v="hausse":C-_>1&&(v="baisse")}const b=l.lacunes.map(x=>({disciplineNom:x.disciplineNom,chapitre:x.chapitre,moyenne:x.moyenne,niveauUrgence:x.niveauUrgence}));n.push({eleveId:a.eleveId,eleveNom:a.eleveNom,eleveEmail:a.eleveEmail,moyenne:f,totalQuiz:d.length,tauxReussite:p,scoreGlobal:l.scoreGlobal,streak:{actuel:l.streak.streakActuel,meilleur:l.streak.meilleurStreak},lacunes:b,dernierQuiz:h,tendance:v})}catch(l){console.warn(` Suivi incomplet pour lve ${a.eleveNom}:`,l),n.push({eleveId:a.eleveId,eleveNom:a.eleveNom,eleveEmail:a.eleveEmail,moyenne:0,totalQuiz:0,tauxReussite:0,scoreGlobal:0,streak:{actuel:0,meilleur:0},lacunes:[],tendance:"stable"})}return n.sort((a,l)=>l.moyenne-a.moyenne),n}catch(r){throw console.error(" Erreur stats lves groupe:",r),new Error("Impossible de charger les statistiques des lves.")}}async function wZ(e,r,n){try{const l=(await bp(e)).map(x=>x.eleveId);if(l.length===0)return null;let o=null,u="quiz_results";if(n!=="quizzes_v2"){if(n!=="quizzes"){const x=await Et(je(Q,"quizzes_v2",r));if(x.exists())o=x.data(),u="quiz_results_v2";else{const j=await Et(je(Q,"quizzes",r));j.exists()&&(o=j.data(),u="quiz_results")}}}if(!o)return null;const d=[],f=[];for(let x=0;x<l.length;x+=10)f.push(l.slice(x,x+10));for(const x of f){const j=Ee(_e(Q,u),Ne("quizId","==",r),Ne("userId","in",x));(await Ce(j)).docs.forEach(C=>d.push(C.data()))}if(d.length===0)return null;const p=u==="quiz_results_v2",h=d.map(x=>p?x.note20||(x.scoreMax>0?x.score/x.scoreMax*20:0):x.score||0),v=d.map(x=>x.tempsEcoule||0),b=[];if(p&&o.questions)for(let x=0;x<o.questions.length;x++){const j=o.questions[x];let _=0,C=0;for(const S of d){const A=S.detailsParQuestion?.find(O=>O.questionId===j.id);A&&(C++,A.isCorrect||_++)}const w=C>0?Math.round(_/C*100):0,E=j.enonce?.replace(/<[^>]*>/g,"").trim()||`Question ${x+1}`;b.push({questionIndex:x,questionTexte:E,tauxEchec:w,reponseCorrecte:"Voir correction dtaille",reponsesFrequentes:[]})}else if(o.questions)for(let x=0;x<o.questions.length;x++){const j=o.questions[x];let _=0;const C=new Map;for(const S of d){const A=S.reponses?.[x];A!==void 0&&(C.set(A,(C.get(A)||0)+1),A!==j.reponseCorrecte&&_++)}const w=Math.round(_/d.length*100),E=Array.from(C.entries()).filter(([S])=>S!==j.reponseCorrecte).map(([S,A])=>({reponse:j.options?.[S]||`Option ${S+1}`,nombre:A})).sort((S,A)=>A.nombre-S.nombre);b.push({questionIndex:x,questionTexte:j.question,tauxEchec:w,reponseCorrecte:j.options?.[j.reponseCorrecte]||"N/A",reponsesFrequentes:E})}return b.sort((x,j)=>j.tauxEchec-x.tauxEchec),{quizId:r,quizTitre:o.titre||"Quiz sans titre",disciplineNom:o.disciplineNom||o.matiereNom||"",totalPassages:d.length,moyenneScore:Math.round(h.reduce((x,j)=>x+j,0)/h.length*10)/10,tauxReussite:Math.round(h.filter(x=>x>=10).length/h.length*100),tempsEcouleMoyen:Math.round(v.reduce((x,j)=>x+j,0)/v.length),questionsRatees:b}}catch(a){return console.error(" Erreur analyse quiz groupe:",a),null}}async function CZ(e){try{const r=[];try{const n=Ee(_e(Q,"quizzes"),Ne("disciplineId","==",e),Ve("createdAt","desc"));(await Ce(n)).docs.forEach(l=>{r.push({id:l.id,titre:l.data().titre||"Quiz sans titre",source:"quizzes"})})}catch(n){console.warn(" Recherche quizzes choue (index manquant ?):",n)}try{const n=Ee(_e(Q,"quizzes_v2"),Ne("disciplineId","==",e),Ve("createdAt","desc"));(await Ce(n)).docs.forEach(l=>{r.push({id:l.id,titre:l.data().titre||"Quiz avanc sans titre",source:"quizzes_v2"})})}catch(n){console.warn(" Recherche quizzes_v2 choue (index manquant ?):",n)}return console.log(` ${r.length} quiz trouv(s) pour discipline ${e}`),r}catch(r){return console.error(" Erreur rcupration quiz par matire:",r),[]}}function EZ(e,r){const n=[],a=new Date;for(const o of e){if(o.totalQuiz>0&&o.moyenne<oM&&n.push({id:`diff-${o.eleveId}`,type:"difficulte",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:r,message:`${o.eleveNom} a une moyenne de ${o.moyenne}/20. Lacunes : ${o.lacunes.map(u=>u.disciplineNom).join(", ")||"non dtectes"}.`,niveauUrgence:o.moyenne<5?"critique":"important",dateCreation:a}),o.dernierQuiz){const u=hZ(o.dernierQuiz,a);u>=fZ&&n.push({id:`inact-${o.eleveId}`,type:"inactivite",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:r,message:`${o.eleveNom} n'a pas fait de quiz depuis ${u} jours.`,niveauUrgence:u>=14?"important":"info",dateCreation:a})}else o.totalQuiz===0&&n.push({id:`inact-${o.eleveId}`,type:"inactivite",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:r,message:`${o.eleveNom} n'a encore pass aucun quiz.`,niveauUrgence:"info",dateCreation:a});o.tendance==="baisse"&&o.totalQuiz>=4&&n.push({id:`baisse-${o.eleveId}`,type:"baisse",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:r,message:`${o.eleveNom} est en baisse de rsultats (tendance ngative).`,niveauUrgence:"important",dateCreation:a}),o.moyenne>=pZ&&o.totalQuiz>=3&&n.push({id:`felicite-${o.eleveId}`,type:"felicitation",eleveNom:o.eleveNom,eleveId:o.eleveId,groupeNom:r,message:`${o.eleveNom} excelle avec ${o.moyenne}/20 ! `,niveauUrgence:"info",dateCreation:a})}const l={critique:0,important:1,info:2};return n.sort((o,u)=>l[o.niveauUrgence]-l[u.niveauUrgence]),n}function AZ(e,r){const n=["Nom","Email","Moyenne (/20)","Quiz passs","Taux russite (%)","Streak (jours)","Lacunes principales","Tendance"],a=e.map(o=>{const u=o.lacunes.map(d=>`${d.disciplineNom} (${d.moyenne}/20)`).join(" | ")||"Aucune";return[`"${o.eleveNom}"`,`"${o.eleveEmail}"`,o.moyenne.toString(),o.totalQuiz.toString(),o.tauxReussite.toString(),o.streak.actuel.toString(),`"${u}"`,o.tendance].join(",")});return"\uFEFF"+[n.join(","),...a].join(`
`)}function zZ(e,r){const n=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(n),l=document.createElement("a");l.href=a,l.download=`${r}.csv`,l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)}const kZ=()=>{const{currentUser:e}=Ke(),[r,n]=g.useState([]),[a,l]=g.useState(!1),[o,u]=g.useState(""),[d,f]=g.useState(!0),[p,h]=g.useState(!1),[v,b]=g.useState(null),[x,j]=g.useState(null),_=g.useCallback(async()=>{if(e?.uid)try{f(!0);const w=await _Z(e.uid);n(w)}catch(w){console.error("Erreur chargement groupes:",w)}finally{f(!1)}},[e?.uid]);g.useEffect(()=>{_()},[_]);const C=async w=>{if(w.preventDefault(),!(!e?.uid||!o.trim()))try{h(!0),b(null),j(null),await jZ(e.uid,e.displayName||e.email||"lve",e.email||"",o),j("Tu as rejoint le groupe avec succs ! "),u(""),l(!1),await _(),setTimeout(()=>j(null),5e3)}catch(E){b(E.message||"Impossible de rejoindre le groupe.")}finally{h(!1)}};return t.jsxs("div",{className:"rejoindre-groupe-section",children:[t.jsxs("div",{className:"rejoindre-groupe-header",children:[t.jsx("h3",{children:" Mes groupes-classes"}),t.jsx("button",{className:"prof-btn prof-btn-primary prof-btn-sm",onClick:()=>l(!a),children:a?" Annuler":" Rejoindre un groupe"})]}),v&&t.jsxs("div",{className:"prof-alert prof-alert-error",children:[" ",v,t.jsx("button",{onClick:()=>b(null),className:"prof-alert-close",children:""})]}),x&&t.jsx("div",{className:"prof-alert",style:{background:"#d1fae5",border:"1px solid #a7f3d0",color:"#065f46"},children:x}),a&&t.jsxs("div",{className:"groupe-form-container",style:{marginBottom:"1rem"},children:[t.jsx("p",{style:{marginBottom:"0.75rem",color:"#6b7280",fontSize:"0.875rem"},children:"Saisis le code donn par ton professeur (format: PROF-XXXX-XXXX)"}),t.jsxs("form",{onSubmit:C,style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[t.jsx("input",{type:"text",placeholder:"PROF-XXXX-XXXX",value:o,onChange:w=>u(w.target.value.toUpperCase()),maxLength:14,disabled:p,className:"prof-input",style:{flex:1,maxWidth:"280px",fontFamily:"monospace",letterSpacing:"2px"}}),t.jsx("button",{type:"submit",className:"prof-btn prof-btn-primary",disabled:p||o.length<14,children:p?" Vrification...":" Rejoindre"})]})]}),d?t.jsx("p",{style:{color:"#9ca3af",textAlign:"center",padding:"1rem"},children:"Chargement..."}):r.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"2rem",color:"#9ca3af"},children:[t.jsx("p",{children:"Tu n'es inscrit(e) dans aucun groupe-classe."}),t.jsx("p",{style:{fontSize:"0.875rem"},children:"Demande  ton professeur un code d'invitation pour rejoindre son groupe."})]}):t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:r.map(w=>t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[t.jsxs("div",{children:[t.jsx("strong",{style:{color:"#1f2937"},children:w.nom}),t.jsxs("span",{style:{display:"block",fontSize:"0.75rem",color:"#9ca3af"},children:[w.matiereNom,"  Prof: ",w.profNom]})]}),t.jsx("span",{style:{fontSize:"0.875rem",color:"#10b981",fontWeight:600},children:" Inscrit(e)"})]},w.id))})]})},OZ=e=>e>=80?"#10b981":e>=60?"#3b82f6":e>=40?"#f59e0b":e>0?"#ef4444":"#d1d5db",VE=({pourcentage:e,label:r,size:n="md",showPercent:a=!0,color:l,showCheck:o=!0,className:u=""})=>{const[d,f]=g.useState(0);g.useEffect(()=>{const x=setTimeout(()=>{f(Math.min(100,Math.max(0,e)))},100);return()=>clearTimeout(x)},[e]);const h={sm:"4px",md:"8px",lg:"12px"}[n],v=l||OZ(e),b=e>=100;return t.jsxs("div",{className:`progress-bar-wrapper ${u}`,children:[(r||a)&&t.jsxs("div",{className:"progress-bar-header",children:[r&&t.jsx("span",{className:"progress-bar-label",children:r}),a&&t.jsxs("span",{className:"progress-bar-percent",style:{color:v},children:[b&&o?" ":"",e,"%"]})]}),t.jsx("div",{className:"progress-bar-track",style:{height:h},children:t.jsx("div",{className:"progress-bar-fill",style:{width:`${d}%`,backgroundColor:v,height:"100%"}})})]})},DZ=()=>{const e=Je(),{currentUser:r}=Ke(),[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState([]),[f,p]=g.useState([]),[h,v]=g.useState([]),[b,x]=g.useState(null),[j,_]=g.useState([]),[C,w]=g.useState("all"),[E,S]=g.useState(!0),[A,O]=g.useState("overview"),[k,P]=g.useState(null),[D,B]=g.useState(!1),[U,$]=g.useState(!1),R=async()=>{if(r){B(!0);try{const I=await eZ(r.uid);P(I)}catch(I){console.error("Erreur gnration code parent :",I)}finally{B(!1)}}},Y=()=>{k&&(navigator.clipboard.writeText(k),$(!0),setTimeout(()=>$(!1),2e3))};if(g.useEffect(()=>{(async()=>{if(r){S(!0);try{await p6(r.uid);const[X,L,ne,K,oe,xe]=await Promise.all([a6(r.uid),i6(r.uid),s6(r.uid,20),wf(r.uid,10),LA().catch(()=>[]),d6(r.uid)]);a(X),o(L),d(ne),p(K),v(oe),x(xe);const ve=h6(X,L,xe);_(ve)}catch(X){console.error("Erreur chargement dashboard :",X)}finally{S(!1)}}})()},[r]),E)return t.jsxs("div",{className:"sd-loading",children:[t.jsx("div",{className:"admin-spinner"}),t.jsx("p",{children:"Chargement de votre tableau de bord..."})]});const ae=j.filter(I=>I.obtenu),M=j.length,T=r?.displayName||r?.email?.split("@")[0]||"lve",F=C==="all"?j:j.filter(I=>I.categorie===C);return t.jsxs("div",{className:"student-dashboard",children:[t.jsxs("div",{className:"sd-welcome",children:[t.jsxs("div",{className:"sd-welcome-text",children:[t.jsxs("h1",{children:["Bienvenue, ",T," "]}),t.jsx("p",{children:n&&n.totalQuizPasses>0?`Vous avez pass ${n.totalQuizPasses} quiz avec une moyenne de ${n.moyenneGenerale}%. Continuez !`:"Commencez par consulter une ressource ou passer un quiz !"})]}),t.jsxs("div",{className:"sd-welcome-badges-row",children:[r?.isPremium&&t.jsxs("span",{className:"sd-premium-badge",children:[t.jsx(Zr,{size:14})," Premium"]}),b&&b.streakActuel>0&&t.jsxs("span",{className:"sd-streak-badge",children:[" ",b.streakActuel," jour",b.streakActuel>1?"s":""]})]})]}),t.jsxs("div",{className:"sd-stats-grid",children:[t.jsxs("div",{className:"sd-stat-card",children:[t.jsx("div",{className:"sd-stat-icon",style:{background:"#eff6ff",color:"#3b82f6"},children:t.jsx(hn,{size:22})}),t.jsxs("div",{className:"sd-stat-content",children:[t.jsx("span",{className:"sd-stat-value",children:n?.totalQuizPasses||0}),t.jsx("span",{className:"sd-stat-label",children:"Quiz passs"})]})]}),t.jsxs("div",{className:"sd-stat-card",children:[t.jsx("div",{className:"sd-stat-icon",style:{background:"#f0fdf4",color:"#10b981"},children:t.jsx(qv,{size:22})}),t.jsxs("div",{className:"sd-stat-content",children:[t.jsxs("span",{className:"sd-stat-value",style:{color:ro(n?.moyenneGenerale||0)},children:[n?.moyenneGenerale||0,"%"]}),t.jsx("span",{className:"sd-stat-label",children:"Moyenne gnrale"})]})]}),t.jsxs("div",{className:"sd-stat-card",children:[t.jsx("div",{className:"sd-stat-icon",style:{background:"#fef3c7",color:"#d97706"},children:t.jsx(lo,{size:22})}),t.jsxs("div",{className:"sd-stat-content",children:[t.jsx("span",{className:"sd-stat-value",children:b?.totalRessourcesVues||0}),t.jsx("span",{className:"sd-stat-label",children:"Ressources vues"})]})]}),t.jsxs("div",{className:"sd-stat-card",children:[t.jsx("div",{className:"sd-stat-icon",style:{background:"#fef2f2",color:"#ef4444"},children:t.jsx(gA,{size:22})}),t.jsxs("div",{className:"sd-stat-content",children:[t.jsxs("span",{className:"sd-stat-value",children:[b?.streakActuel||0," "]}),t.jsx("span",{className:"sd-stat-label",children:"Jours conscutifs"})]})]}),t.jsxs("div",{className:"sd-stat-card",children:[t.jsx("div",{className:"sd-stat-icon",style:{background:"#fefce8",color:"#f59e0b"},children:t.jsx(xA,{size:22})}),t.jsxs("div",{className:"sd-stat-content",children:[t.jsxs("span",{className:"sd-stat-value",children:[n?.meilleurScore||0,"%"]}),t.jsx("span",{className:"sd-stat-label",children:"Meilleur score"})]})]}),t.jsxs("div",{className:"sd-stat-card",children:[t.jsx("div",{className:"sd-stat-icon",style:{background:"#f0f9ff",color:"#0ea5e9"},children:t.jsx(ts,{size:22})}),t.jsxs("div",{className:"sd-stat-content",children:[t.jsxs("span",{className:"sd-stat-value",children:[b?.disciplinesCompletees||0,"/",b?.disciplinesCommencees||0]}),t.jsx("span",{className:"sd-stat-label",children:"Disciplines compltes"})]})]})]}),t.jsxs("div",{className:"sd-chart-card",style:{marginBottom:"1.5rem"},children:[t.jsx("h3",{className:"sd-section-title",children:" Code Parent"}),t.jsx("p",{style:{color:"#6b7280",fontSize:"0.9rem",marginBottom:"1rem"},children:"Partagez ce code avec vos parents pour qu'ils puissent suivre votre progression."}),k?t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[t.jsx("span",{style:{fontFamily:"monospace",fontSize:"1.4rem",fontWeight:700,letterSpacing:"0.1em",background:"#eff6ff",color:"#2563eb",padding:"0.75rem 1.5rem",borderRadius:"12px",border:"2px dashed #93c5fd",userSelect:"all"},children:k}),t.jsx("button",{className:"sd-btn",onClick:Y,style:{display:"inline-flex",alignItems:"center",gap:"0.4rem",background:U?"#10b981":"#f3f4f6",color:U?"#fff":"#374151",border:"none",padding:"0.6rem 1rem",borderRadius:"8px",cursor:"pointer",fontWeight:500,transition:"all 0.2s"},children:U?" Copi !":" Copier"})]}):t.jsx("button",{className:"sd-btn sd-btn-primary",onClick:R,disabled:D,style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:D?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"admin-spinner",style:{width:"16px",height:"16px"}})," Gnration..."]}):t.jsx(t.Fragment,{children:" Gnrer mon code"})})]}),t.jsx("div",{className:"sd-chart-card",style:{marginBottom:"1.5rem"},children:t.jsx(kZ,{})}),t.jsxs("div",{className:"sd-chart-card",style:{marginBottom:"1.5rem"},children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(hn,{size:18})," Cours en ligne"]}),t.jsx("p",{style:{color:"#6b7280",fontSize:"0.9rem",marginBottom:"1rem"},children:"Des cours complets du programme sngalais, accessibles partout."}),t.jsxs("button",{className:"sd-btn sd-btn-primary",onClick:()=>e("/cours"),style:{display:"inline-flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx(ao,{size:16})," Accder aux cours"]})]}),t.jsxs("div",{className:"sd-tabs",children:[t.jsxs("button",{className:`sd-tab ${A==="overview"?"active":""}`,onClick:()=>O("overview"),children:[t.jsx(Bs,{size:16})," Vue d'ensemble"]}),t.jsxs("button",{className:`sd-tab ${A==="progression"?"active":""}`,onClick:()=>O("progression"),children:[t.jsx(Pc,{size:16})," Progression"]}),t.jsxs("button",{className:`sd-tab ${A==="history"?"active":""}`,onClick:()=>O("history"),children:[t.jsx(Rv,{size:16})," Historique"]}),t.jsxs("button",{className:`sd-tab ${A==="badges"?"active":""}`,onClick:()=>O("badges"),children:[t.jsx(ts,{size:16})," Badges (",ae.length,"/",M,")"]})]}),A==="overview"&&t.jsxs("div",{className:"sd-overview",children:[u.length>1&&t.jsxs("div",{className:"sd-chart-card",children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(Pc,{size:18})," volution de vos scores"]}),t.jsx("div",{className:"sd-chart-container",children:t.jsx(Ew,{width:"100%",height:280,children:t.jsxs(DX,{data:u,children:[t.jsx(Cb,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),t.jsx(Ob,{dataKey:"date",tick:{fontSize:12,fill:"#6b7280"},tickLine:!1}),t.jsx(Mb,{domain:[0,100],tick:{fontSize:12,fill:"#6b7280"},tickLine:!1,unit:"%"}),t.jsx(M2,{formatter:I=>[`${I}%`,"Score"],labelFormatter:I=>`Date : ${I}`,contentStyle:{borderRadius:"8px",border:"1px solid #e5e7eb",boxShadow:"0 4px 6px rgba(0,0,0,0.07)"}}),t.jsx(LP,{type:"monotone",dataKey:"score",stroke:"#3b82f6",strokeWidth:2.5,dot:{r:4,fill:"#3b82f6",stroke:"#fff",strokeWidth:2},activeDot:{r:6}})]})})})]}),l.length>0&&t.jsxs("div",{className:"sd-chart-card",children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(Bs,{size:18})," Moyennes par discipline"]}),t.jsx("div",{className:"sd-chart-container",children:t.jsx(Ew,{width:"100%",height:280,children:t.jsxs(MX,{data:l,layout:"vertical",children:[t.jsx(Cb,{strokeDasharray:"3 3",stroke:"#e5e7eb",horizontal:!1}),t.jsx(Ob,{type:"number",domain:[0,100],tick:{fontSize:12,fill:"#6b7280"},unit:"%"}),t.jsx(Mb,{type:"category",dataKey:"disciplineNom",width:120,tick:{fontSize:12,fill:"#374151"}}),t.jsx(M2,{formatter:I=>[`${I}%`,"Moyenne"],contentStyle:{borderRadius:"8px",border:"1px solid #e5e7eb",boxShadow:"0 4px 6px rgba(0,0,0,0.07)"}}),t.jsx(GP,{dataKey:"moyenne",radius:[0,6,6,0],barSize:24,children:l.map((I,X)=>t.jsx(pj,{fill:ro(I.moyenne)},X))})]})})})]}),h.length>0&&t.jsxs("div",{className:"sd-chart-card",children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(ao,{size:18})," Quiz disponibles"]}),t.jsx("div",{className:"sd-quiz-grid",children:h.slice(0,6).map(I=>{const X=I.isPremium&&!r?.isPremium;return t.jsxs("div",{className:`sd-quiz-card ${X?"locked":""}`,onClick:()=>!X&&e(`/quiz/${I.id}`),children:[I.isPremium&&t.jsxs("span",{className:"sd-quiz-badge-premium",children:[X?t.jsx(kx,{size:10}):t.jsx(Zr,{size:10})," Premium"]}),t.jsx("h4",{className:"sd-quiz-title",children:I.titre}),t.jsxs("div",{className:"sd-quiz-meta",children:[t.jsxs("span",{children:[t.jsx(hn,{size:12})," ",I.questions.length," questions"]}),t.jsxs("span",{children:[t.jsx(uo,{size:12})," ",I.duree," min"]})]}),!X&&t.jsxs("button",{className:"sd-quiz-play-btn",children:[t.jsx(ao,{size:14})," Commencer"]}),X&&t.jsxs("button",{className:"sd-quiz-unlock-btn",onClick:L=>{L.stopPropagation(),e("/premium")},children:[t.jsx(kx,{size:14})," Dbloquer"]})]},I.id)})})]}),n&&n.totalQuizPasses===0&&(!b||b.totalRessourcesVues===0)&&t.jsxs("div",{className:"sd-empty-state",children:[t.jsx(qv,{size:48}),t.jsx("h3",{children:"Commencez votre parcours !"}),t.jsx("p",{children:"Consultez une ressource ou passez un quiz pour voir votre progression."}),h.length>0&&t.jsxs("button",{className:"sd-btn sd-btn-primary",onClick:()=>e(`/quiz/${h[0].id}`),children:[t.jsx(ao,{size:18})," Passer un quiz"]})]})]}),A==="progression"&&t.jsxs("div",{className:"sd-progression",children:[t.jsxs("div",{className:"sd-chart-card sd-prog-summary",children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(Pc,{size:18})," Avancement global"]}),t.jsx(VE,{pourcentage:b?.pourcentageMoyen||0,label:"Progression moyenne",size:"lg",showCheck:!0}),t.jsxs("div",{className:"sd-prog-stats-row",children:[t.jsxs("div",{className:"sd-prog-stat-item",children:[t.jsx("span",{className:"sd-prog-stat-number",children:b?.totalRessourcesVues||0}),t.jsx("span",{className:"sd-prog-stat-text",children:"Ressources consultes"})]}),t.jsxs("div",{className:"sd-prog-stat-item",children:[t.jsx("span",{className:"sd-prog-stat-number",children:b?.totalQuizReussis||0}),t.jsx("span",{className:"sd-prog-stat-text",children:"Quiz russis"})]}),t.jsxs("div",{className:"sd-prog-stat-item",children:[t.jsx("span",{className:"sd-prog-stat-number",children:b?.disciplinesCommencees||0}),t.jsx("span",{className:"sd-prog-stat-text",children:"Disciplines"})]}),t.jsxs("div",{className:"sd-prog-stat-item",children:[t.jsxs("span",{className:"sd-prog-stat-number",children:[" ",b?.streakActuel||0]}),t.jsxs("span",{className:"sd-prog-stat-text",children:["Streak (max: ",b?.meilleurStreak||0,")"]})]})]})]}),b&&b.parDiscipline.length>0?t.jsxs("div",{className:"sd-chart-card",children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(Bs,{size:18})," Par discipline"]}),t.jsx("div",{className:"sd-prog-disciplines",children:b.parDiscipline.map(I=>t.jsxs("div",{className:"sd-prog-disc-card",children:[t.jsxs("div",{className:"sd-prog-disc-header",children:[t.jsx("span",{className:"sd-prog-disc-name",children:I.disciplineNom}),I.pourcentage>=100&&t.jsx("span",{className:"sd-prog-complete-tag",children:" Complt"})]}),t.jsx(VE,{pourcentage:I.pourcentage,size:"md",showPercent:!0}),t.jsxs("div",{className:"sd-prog-disc-details",children:[t.jsxs("span",{children:[t.jsx(lo,{size:12})," ",I.ressourcesVues.length,"/",I.totalRessources," ressources"]}),t.jsxs("span",{children:[t.jsx(Ut,{size:12})," ",I.quizReussis.length,"/",I.totalQuiz," quiz russis"]})]})]},I.disciplineId))})]}):t.jsxs("div",{className:"sd-empty-state",children:[t.jsx(lo,{size:48}),t.jsx("h3",{children:"Aucune progression enregistre"}),t.jsx("p",{children:"Consultez des ressources ou passez des quiz pour voir votre avancement ici."})]}),l.length>0&&t.jsxs("div",{className:"sd-chart-card",children:[t.jsxs("h3",{className:"sd-section-title",children:[t.jsx(qv,{size:18})," Performance quiz par discipline"]}),t.jsx("div",{className:"sd-disc-list",children:l.map(I=>t.jsxs("div",{className:"sd-disc-card",children:[t.jsxs("div",{className:"sd-disc-header",children:[t.jsx("span",{className:"sd-disc-name",children:I.disciplineNom}),t.jsxs("span",{className:"sd-disc-tendance",children:[I.tendance==="up"&&t.jsx(Pc,{size:16,className:"tendance-up"}),I.tendance==="down"&&t.jsx(O3,{size:16,className:"tendance-down"}),I.tendance==="stable"&&t.jsx(D3,{size:16,className:"tendance-stable"})]})]}),t.jsxs("div",{className:"sd-disc-stats",children:[t.jsxs("div",{className:"sd-disc-stat",children:[t.jsxs("span",{className:"sd-disc-stat-value",style:{color:ro(I.moyenne)},children:[I.moyenne,"%"]}),t.jsx("span",{className:"sd-disc-stat-label",children:"Moyenne"})]}),t.jsxs("div",{className:"sd-disc-stat",children:[t.jsx("span",{className:"sd-disc-stat-value",children:I.nombreQuiz}),t.jsx("span",{className:"sd-disc-stat-label",children:"Quiz"})]}),t.jsxs("div",{className:"sd-disc-stat",children:[t.jsxs("span",{className:"sd-disc-stat-value",children:[I.meilleurScore,"%"]}),t.jsx("span",{className:"sd-disc-stat-label",children:"Meilleur"})]}),t.jsxs("div",{className:"sd-disc-stat",children:[t.jsxs("span",{className:"sd-disc-stat-value",children:[I.quizReussis,"/",I.nombreQuiz]}),t.jsx("span",{className:"sd-disc-stat-label",children:"Russis"})]})]}),t.jsx("div",{className:"sd-disc-bar",children:t.jsx("div",{className:"sd-disc-bar-fill",style:{width:`${I.moyenne}%`,background:ro(I.moyenne)}})})]},I.disciplineId))})]})]}),A==="history"&&t.jsx("div",{className:"sd-history",children:f.length===0?t.jsxs("div",{className:"sd-empty-state",children:[t.jsx(Rv,{size:48}),t.jsx("h3",{children:"Aucun quiz pass"}),t.jsx("p",{children:"Votre historique apparatra ici aprs avoir pass des quiz."})]}):t.jsx("div",{className:"sd-history-list",children:f.map(I=>{const X=I.datePassage?.toDate?I.datePassage.toDate():new Date(I.datePassage);return t.jsxs("div",{className:`sd-history-item ${I.reussi?"success":"fail"}`,children:[t.jsx("div",{className:`sd-history-icon ${I.reussi?"success":"fail"}`,children:I.reussi?t.jsx(Ut,{size:20}):t.jsx(Ox,{size:20})}),t.jsxs("div",{className:"sd-history-content",children:[t.jsxs("div",{className:"sd-history-top",children:[t.jsx("span",{className:"sd-history-title",children:I.quizTitre}),t.jsx("span",{className:"sd-history-discipline",children:I.disciplineNom})]}),t.jsxs("div",{className:"sd-history-meta",children:[t.jsxs("span",{children:[t.jsx(Rv,{size:12}),X.toLocaleDateString("fr-SN",{day:"2-digit",month:"long",year:"numeric"})]}),t.jsxs("span",{children:[t.jsx(uo,{size:12})," ",VA(I.tempsEcoule)]}),t.jsxs("span",{children:[t.jsx(Ut,{size:12})," ",I.bonnesReponses,"/",I.nombreQuestions]})]})]}),t.jsxs("div",{className:"sd-history-score",style:{color:ro(I.pourcentage)},children:[t.jsxs("span",{className:"sd-history-score-value",children:[I.pourcentage,"%"]}),t.jsx("span",{className:"sd-history-score-label",children:QA(I.pourcentage)})]})]},I.id)})})}),A==="badges"&&t.jsxs("div",{className:"sd-badges",children:[t.jsxs("div",{className:"sd-badges-summary",children:[t.jsxs("div",{className:"sd-badges-circle",children:[t.jsx("span",{className:"sd-badges-count",children:ae.length}),t.jsxs("span",{className:"sd-badges-total",children:["/ ",M]})]}),t.jsx("p",{children:"badges obtenus"}),t.jsx("div",{className:"sd-badges-progress",children:t.jsx("div",{className:"sd-badges-progress-fill",style:{width:`${ae.length/M*100}%`}})})]}),t.jsx("div",{className:"sd-badges-filters",children:[{key:"all",label:"Tous"},{key:"ressources",label:" Ressources"},{key:"quiz",label:" Quiz"},{key:"performance",label:" Performance"},{key:"discipline",label:" Disciplines"},{key:"streak",label:" Streak"}].map(I=>t.jsx("button",{className:`sd-badge-filter-btn ${C===I.key?"active":""}`,onClick:()=>w(I.key),children:I.label},I.key))}),t.jsx("div",{className:"sd-badges-grid",children:F.map(I=>t.jsxs("div",{className:`sd-badge-card ${I.obtenu?"obtained":"locked"}`,children:[t.jsx("span",{className:"sd-badge-icon",children:I.icone}),t.jsx("h4",{className:"sd-badge-name",children:I.nom}),t.jsx("p",{className:"sd-badge-description",children:I.description}),t.jsx("span",{className:"sd-badge-condition",children:I.condition}),I.obtenu&&t.jsx("span",{className:"sd-badge-obtained-tag",children:" Obtenu"}),t.jsx("span",{className:"sd-badge-category",children:I.categorie})]},I.id))}),F.length===0&&t.jsxs("div",{className:"sd-empty-state",style:{marginTop:"1rem"},children:[t.jsx(Ub,{size:36}),t.jsx("h3",{children:"Aucun badge dans cette catgorie"}),t.jsx("p",{children:"Essayez un autre filtre."})]})]})]})},PZ=()=>{const{currentUser:e}=Ke(),r=Je(),[n,a]=g.useState(null),[l,o]=g.useState(!0),[u,d]=g.useState(null),f=["L","M","M","J","V","S","D"],p=g.useCallback(async()=>{if(e?.uid)try{o(!0),d(null);const S=await Cj(e.uid);a(S)}catch(S){console.error("Erreur chargement suivi:",S),d("Impossible de charger ton suivi. Vrifie ta connexion et ressaie.")}finally{o(!1)}},[e?.uid]);g.useEffect(()=>{p()},[p]);const h=(()=>{const S=new Date().getDay();return S===0?6:S-1})();if(l)return t.jsx("div",{className:"suivi-page",children:t.jsx("div",{className:"suivi-container",children:t.jsxs("div",{className:"suivi-loading",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{className:"suivi-loading-text",children:"Analyse de ta progression en cours..."})]})})});if(u)return t.jsx("div",{className:"suivi-page",children:t.jsx("div",{className:"suivi-container",children:t.jsxs("div",{className:"suivi-error",children:[t.jsx("p",{className:"suivi-error-title",children:" Erreur de chargement"}),t.jsx("p",{className:"suivi-error-text",children:u}),t.jsx("button",{className:"suivi-btn-retry",onClick:p,children:" Ressayer"})]})})});if(!n)return null;const{lacunes:v,recommandations:b,streak:x,objectifs:j,scoreGlobal:_}=n,C=2*Math.PI*40,w=C-_/100*C,E=_>=60?"#10b981":_>=30?"#f59e0b":"#ef4444";return t.jsx("div",{className:"suivi-page",children:t.jsxs("div",{className:"suivi-container",children:[t.jsx("div",{className:"suivi-header",children:t.jsxs("div",{className:"suivi-header-content",children:[t.jsxs("div",{children:[t.jsx("h1",{children:" Mes points  amliorer"}),t.jsx("p",{className:"suivi-motivation",children:VX(_)})]}),t.jsxs("div",{className:"score-global-circle",children:[t.jsxs("svg",{className:"score-circle-svg",viewBox:"0 0 100 100",children:[t.jsx("circle",{className:"score-circle-bg",cx:"50",cy:"50",r:"40"}),t.jsx("circle",{className:"score-circle-progress",cx:"50",cy:"50",r:"40",stroke:E,strokeDasharray:C,strokeDashoffset:w}),t.jsx("text",{className:"score-circle-text",x:"50",y:"50",children:_})]}),t.jsx("span",{className:"score-global-label",children:"Score global"})]})]})}),t.jsxs("div",{className:"streak-card",children:[t.jsxs("div",{className:"streak-header",children:[t.jsx("span",{className:"streak-flamme",children:x.streakActuel>0?"":""}),t.jsxs("div",{children:[t.jsx("div",{className:"streak-nombre",children:x.streakActuel}),t.jsx("div",{className:"streak-label",children:x.streakActuel<=1?"jour conscutif":"jours conscutifs"})]})]}),t.jsx("div",{className:"streak-semaine",children:f.map((S,A)=>t.jsxs("div",{className:"streak-jour",children:[t.jsx("span",{className:"streak-jour-label",children:S}),t.jsx("div",{className:`streak-jour-indicateur ${x.semaineCourante[A]?"actif":"inactif"} ${A===h?"aujourd-hui":""}`,children:x.semaineCourante[A]?"":""})]},A))}),t.jsxs("div",{className:"streak-stats",children:[t.jsxs("div",{className:"streak-stat",children:[t.jsx("span",{className:"streak-stat-icon",children:""}),t.jsx("span",{className:"streak-stat-value",children:x.meilleurStreak}),t.jsx("span",{className:"streak-stat-label",children:"record"})]}),t.jsxs("div",{className:"streak-stat",children:[t.jsx("span",{className:"streak-stat-icon",children:""}),t.jsx("span",{className:"streak-stat-value",children:x.totalJoursActifs}),t.jsx("span",{className:"streak-stat-label",children:"jours actifs au total"})]}),x.dernierJourActif&&t.jsxs("div",{className:"streak-stat",children:[t.jsx("span",{className:"streak-stat-icon",children:""}),t.jsxs("span",{className:"streak-stat-label",children:["Dernier quiz : ",new Date(x.dernierJourActif).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})]})]})]})]}),t.jsxs("h2",{className:"suivi-section-title",children:[" Objectifs de la semaine",t.jsx("span",{className:"suivi-section-badge",children:j.length})]}),j.length>0?t.jsx("div",{className:"objectifs-grid",children:j.map(S=>{const A=QX(S);return t.jsxs("div",{className:`objectif-card ${S.statut==="atteint"?"atteint":""}`,children:[t.jsxs("div",{className:"objectif-header",children:[t.jsx("span",{className:"objectif-titre",children:S.titre}),S.recompense&&t.jsx("span",{className:"objectif-recompense",children:S.recompense})]}),t.jsx("p",{className:"objectif-description",children:S.description}),t.jsxs("div",{className:"objectif-progress",children:[t.jsxs("div",{className:"objectif-progress-labels",children:[t.jsxs("span",{className:"objectif-progress-value",children:[S.progression," / ",S.cible]}),t.jsxs("span",{className:"objectif-progress-cible",children:[A,"%"]})]}),t.jsx("div",{className:"objectif-progress-track",children:t.jsx("div",{className:`objectif-progress-fill ${S.statut==="atteint"?"atteint":""}`,style:{width:`${A}%`}})})]}),t.jsx("p",{className:`objectif-statut ${S.statut}`,children:S.statut==="atteint"?" Objectif atteint !":S.statut==="en_cours"?" En cours...":" Non commenc"})]},S.id)})}):t.jsxs("div",{className:"suivi-empty",children:[t.jsx("div",{className:"suivi-empty-icon",children:""}),t.jsx("p",{className:"suivi-empty-title",children:"Pas encore d'objectifs"}),t.jsx("p",{className:"suivi-empty-text",children:"Passe ton premier quiz pour dbloquer tes objectifs hebdomadaires !"})]}),t.jsxs("h2",{className:"suivi-section-title",children:[" Points faibles dtects",v.length>0&&t.jsx("span",{className:"suivi-section-badge",children:v.length})]}),v.length>0?t.jsx("div",{className:"lacunes-grid",children:v.map(S=>t.jsxs("div",{className:`lacune-card ${S.niveauUrgence}`,children:[t.jsxs("div",{className:"lacune-card-header",children:[t.jsx("span",{className:"lacune-discipline",children:S.disciplineNom}),t.jsx("span",{className:`lacune-badge ${S.niveauUrgence}`,children:nM(S.niveauUrgence)})]}),t.jsxs("div",{className:"lacune-score-bar",children:[t.jsxs("div",{className:"lacune-score-labels",children:[t.jsxs("span",{className:"lacune-score-value",style:{color:gf(S.niveauUrgence)},children:[S.moyenne,"/20"]}),t.jsx("span",{className:"lacune-score-objectif",children:"Objectif : 14/20"})]}),t.jsx("div",{className:"lacune-progress-track",children:t.jsx("div",{className:`lacune-progress-fill ${S.niveauUrgence}`,style:{width:`${S.moyenne/20*100}%`}})})]}),t.jsxs("div",{className:"lacune-details",children:[t.jsxs("span",{className:"lacune-detail-tag",children:[aM(S.tendance)," ",S.tendance]}),t.jsxs("span",{className:"lacune-detail-tag",children:[" ",S.nombreQuiz," quiz"]}),t.jsxs("span",{className:"lacune-detail-tag",children:["Dernier : ",S.scoreDetails.dernierScore,"/20"]})]})]},S.id))}):t.jsxs("div",{className:"suivi-empty",children:[t.jsx("div",{className:"suivi-empty-icon",children:""}),t.jsx("p",{className:"suivi-empty-title",children:"Aucune lacune dtecte !"}),t.jsx("p",{className:"suivi-empty-text",children:_>0?"Toutes tes moyennes sont au-dessus de 14/20. Bravo, continue !":"Passe des quiz pour que l'analyse puisse commencer."}),t.jsx("button",{className:"suivi-cta-btn",onClick:()=>r("/disciplines"),style:{marginTop:"1rem"},children:" Voir les disciplines"})]}),b.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("h2",{className:"suivi-section-title",children:[" Recommandations personnalises",t.jsx("span",{className:"suivi-section-badge",children:b.length})]}),t.jsx("div",{className:"recommandations-list",children:b.map(S=>t.jsxs("div",{className:"recommandation-card",children:[t.jsx("div",{className:"recommandation-priorite",children:S.priorite}),t.jsxs("div",{className:"recommandation-content",children:[t.jsx("p",{className:"recommandation-titre",children:S.titre}),t.jsx("p",{className:"recommandation-description",children:S.description}),t.jsx("span",{className:"recommandation-discipline-tag",children:S.disciplineNom})]})]},S.id))})]}),t.jsx("div",{style:{textAlign:"center",marginTop:"1rem",marginBottom:"2rem"},children:t.jsx("button",{className:"suivi-cta-btn",onClick:()=>r("/disciplines"),children:" Passer un quiz maintenant"})})]})})},MZ=()=>{const e=new Date,r=e.getFullYear(),a=e.getMonth()>=9?r:r-1,l=[];for(let o=-1;o<=3;o++){const u=a+o;l.push(`${u}-${u+1}`)}return l},QE=MZ(),kc=()=>{const e=new Date,r=e.getFullYear(),a=e.getMonth()>=9?r:r-1;return`${a}-${a+1}`},YE=[{value:"6eme",label:"6me"},{value:"5eme",label:"5me"},{value:"4eme",label:"4me"},{value:"3eme",label:"3me"},{value:"2nde",label:"2nde"},{value:"1ere",label:"1re"},{value:"Terminale",label:"Terminale"}],TZ=({onSelectGroupe:e})=>{const{currentUser:r}=Ke(),[n,a]=g.useState([]),[l,o]=g.useState(new Map),[u,d]=g.useState([]),[f,p]=g.useState(!0),[h,v]=g.useState(null),[b,x]=g.useState(!1),[j,_]=g.useState(!1),[C,w]=g.useState(null),[E,S]=g.useState(null),[A,O]=g.useState(null),[k,P]=g.useState(!1),[D,B]=g.useState(null),[U,$]=g.useState({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:"6eme",anneeScolaire:kc()}),[R,Y]=g.useState({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:"6eme",anneeScolaire:kc()}),[ae,M]=g.useState("actif");g.useEffect(()=>{(async()=>{try{const V=await is.getAll();d(V.map(me=>({id:me.id,nom:me.nom,classe:me.classe||""})))}catch(V){console.warn(" Impossible de charger les disciplines:",V)}})()},[]);const T=g.useCallback(async()=>{if(r?.uid)try{p(!0),v(null);const Z=await uM(r.uid);a(Z);const V=new Map;for(const me of Z)if(me.statut==="actif")try{const we=await Ej(me.id);V.set(me.id,we)}catch{console.warn(`Stats indisponibles pour ${me.nom}`)}o(V)}catch(Z){console.error("Erreur chargement groupes:",Z),v("Impossible de charger vos groupes. Vrifiez votre connexion.")}finally{p(!1)}},[r?.uid]);g.useEffect(()=>{T()},[T]);const F=(Z,V=!1)=>{const me=u.find(qe=>qe.id===Z),we=me?`${me.nom}${me.classe?` (${me.classe})`:""}`:"";V?Y(qe=>({...qe,matiereId:Z,matiereNom:we})):$(qe=>({...qe,matiereId:Z,matiereNom:we}))},I=async Z=>{if(Z.preventDefault(),!(!r?.uid||!U.nom.trim()||!U.matiereId))try{_(!0),await vZ(r.uid,r.displayName||r.email||"Professeur",U),$({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:"6eme",anneeScolaire:kc()}),x(!1),B("Groupe cr avec succs !"),setTimeout(()=>B(null),3e3),await T()}catch(V){v(V.message||"Erreur lors de la cration du groupe.")}finally{_(!1)}},X=Z=>{O(Z),Y({nom:Z.nom,description:Z.description||"",matiereId:Z.matiereId,matiereNom:Z.matiereNom,classeNiveau:Z.classeNiveau,anneeScolaire:Z.anneeScolaire}),x(!1)},L=()=>{O(null),Y({nom:"",description:"",matiereId:"",matiereNom:"",classeNiveau:"6eme",anneeScolaire:kc()})},ne=async Z=>{if(Z.preventDefault(),!(!A||!R.nom.trim()||!R.matiereId))try{P(!0),await dM(A.id,{nom:R.nom.trim(),description:R.description?.trim()||"",matiereId:R.matiereId,matiereNom:R.matiereNom,classeNiveau:R.classeNiveau,anneeScolaire:R.anneeScolaire}),O(null),B("Groupe modifi avec succs !"),setTimeout(()=>B(null),3e3),await T()}catch(V){v(V.message||"Erreur lors de la modification du groupe.")}finally{P(!1)}},K=async Z=>{try{await navigator.clipboard.writeText(Z),w(Z),setTimeout(()=>w(null),2e3)}catch{const V=document.createElement("textarea");V.value=Z,document.body.appendChild(V),V.select(),document.execCommand("copy"),document.body.removeChild(V),w(Z),setTimeout(()=>w(null),2e3)}},oe=async Z=>{try{await xZ(Z),S(null),await T()}catch(V){v(V.message)}},xe=async Z=>{try{await bZ(Z),await T()}catch(V){v(V.message)}},ve=async Z=>{try{await yZ(Z),await T()}catch(V){v(V.message)}},H=(Z,V)=>{$(me=>({...me,[Z]:V}))},he=(Z,V)=>{Y(me=>({...me,[Z]:V}))},Me=n.filter(Z=>ae==="tous"?!0:Z.statut===ae),ue=(Z,V,me)=>t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:Z,children:"Discipline / Matire *"}),t.jsxs("select",{id:Z,value:V,onChange:we=>me(we.target.value),className:"prof-select",required:!0,children:[t.jsx("option",{value:"",children:" Slectionner une discipline "}),u.map(we=>t.jsxs("option",{value:we.id,children:[we.nom,we.classe?` (${we.classe})`:""]},we.id))]}),u.length===0&&t.jsx("small",{style:{color:"#f59e0b",marginTop:"0.25rem",display:"block"},children:" Aucune discipline trouve. Crez des disciplines dans l'espace admin."})]});return f?t.jsxs("div",{className:"prof-loading",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement de vos groupes-classes..."})]}):t.jsxs("div",{className:"groupe-manager",children:[t.jsxs("div",{className:"groupe-manager-header",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"groupe-manager-titre",children:"Mes groupes-classes"}),t.jsxs("p",{className:"groupe-manager-subtitle",children:[n.length," groupe",n.length!==1?"s":"","  Anne ",kc()]})]}),t.jsx("button",{className:"prof-btn prof-btn-primary",onClick:()=>{x(!b),A&&L()},children:b?" Annuler":" Nouveau groupe"})]}),h&&t.jsxs("div",{className:"prof-alert prof-alert-error",children:[t.jsx("span",{children:""})," ",h,t.jsx("button",{onClick:()=>v(null),className:"prof-alert-close",children:""})]}),D&&t.jsxs("div",{className:"prof-alert prof-alert-success",children:[t.jsx("span",{children:""})," ",D,t.jsx("button",{onClick:()=>B(null),className:"prof-alert-close",children:""})]}),b&&t.jsxs("div",{className:"groupe-form-container",children:[t.jsx("h3",{children:"Crer un nouveau groupe-classe"}),t.jsxs("form",{onSubmit:I,className:"groupe-form",children:[t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"groupe-nom",children:"Nom du groupe *"}),t.jsx("input",{id:"groupe-nom",type:"text",placeholder:"Ex: 3me A - Maths 2025",value:U.nom,onChange:Z=>H("nom",Z.target.value),required:!0,className:"prof-input",maxLength:60})]}),t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"groupe-desc",children:"Description (optionnelle)"}),t.jsx("input",{id:"groupe-desc",type:"text",placeholder:"Ex: Cours du mardi et jeudi matin",value:U.description||"",onChange:Z=>H("description",Z.target.value),className:"prof-input",maxLength:120})]}),t.jsxs("div",{className:"prof-form-row",children:[t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"groupe-niveau",children:"Niveau de classe *"}),t.jsx("select",{id:"groupe-niveau",value:U.classeNiveau,onChange:Z=>H("classeNiveau",Z.target.value),className:"prof-select",children:YE.map(Z=>t.jsx("option",{value:Z.value,children:Z.label},Z.value))})]}),t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"groupe-annee",children:"Anne scolaire *"}),t.jsx("select",{id:"groupe-annee",value:U.anneeScolaire,onChange:Z=>H("anneeScolaire",Z.target.value),className:"prof-select",children:QE.map(Z=>t.jsx("option",{value:Z,children:Z},Z))})]})]}),ue("groupe-discipline",U.matiereId,Z=>F(Z,!1)),t.jsx("div",{className:"prof-form-actions",children:t.jsx("button",{type:"submit",className:"prof-btn prof-btn-primary",disabled:j||!U.nom.trim()||!U.matiereId,children:j?" Cration...":" Crer le groupe"})})]})]}),A&&t.jsxs("div",{className:"groupe-form-container",style:{borderLeft:"4px solid #f59e0b"},children:[t.jsxs("h3",{children:[" Modifier le groupe : ",A.nom]}),t.jsxs("form",{onSubmit:ne,className:"groupe-form",children:[t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"edit-groupe-nom",children:"Nom du groupe *"}),t.jsx("input",{id:"edit-groupe-nom",type:"text",value:R.nom,onChange:Z=>he("nom",Z.target.value),required:!0,className:"prof-input",maxLength:60})]}),t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"edit-groupe-desc",children:"Description (optionnelle)"}),t.jsx("input",{id:"edit-groupe-desc",type:"text",value:R.description||"",onChange:Z=>he("description",Z.target.value),className:"prof-input",maxLength:120})]}),t.jsxs("div",{className:"prof-form-row",children:[t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"edit-groupe-niveau",children:"Niveau de classe *"}),t.jsx("select",{id:"edit-groupe-niveau",value:R.classeNiveau,onChange:Z=>he("classeNiveau",Z.target.value),className:"prof-select",children:YE.map(Z=>t.jsx("option",{value:Z.value,children:Z.label},Z.value))})]}),t.jsxs("div",{className:"prof-form-group",children:[t.jsx("label",{htmlFor:"edit-groupe-annee",children:"Anne scolaire *"}),t.jsx("select",{id:"edit-groupe-annee",value:R.anneeScolaire,onChange:Z=>he("anneeScolaire",Z.target.value),className:"prof-select",children:QE.map(Z=>t.jsx("option",{value:Z,children:Z},Z))})]})]}),ue("edit-groupe-discipline",R.matiereId,Z=>F(Z,!0)),t.jsxs("div",{className:"prof-form-actions",style:{display:"flex",gap:"0.75rem"},children:[t.jsx("button",{type:"submit",className:"prof-btn prof-btn-primary",disabled:k||!R.nom.trim()||!R.matiereId,children:k?" Enregistrement...":" Enregistrer"}),t.jsx("button",{type:"button",className:"prof-btn prof-btn-secondary",onClick:L,disabled:k,children:" Annuler"})]})]})]}),t.jsxs("div",{className:"groupe-filtres",children:[t.jsxs("button",{className:`prof-filtre-btn ${ae==="actif"?"active":""}`,onClick:()=>M("actif"),children:["Actifs (",n.filter(Z=>Z.statut==="actif").length,")"]}),t.jsxs("button",{className:`prof-filtre-btn ${ae==="archive"?"active":""}`,onClick:()=>M("archive"),children:["Archivs (",n.filter(Z=>Z.statut==="archive").length,")"]}),t.jsxs("button",{className:`prof-filtre-btn ${ae==="tous"?"active":""}`,onClick:()=>M("tous"),children:["Tous (",n.length,")"]})]}),Me.length===0?t.jsxs("div",{className:"prof-empty-state",children:[t.jsx("div",{className:"prof-empty-icon",children:""}),t.jsx("h3",{children:ae==="archive"?"Aucun groupe archiv":"Aucun groupe-classe cr"}),t.jsx("p",{children:ae==="archive"?"Vos groupes archivs apparatront ici.":"Crez votre premier groupe-classe pour commencer  suivre vos lves."}),ae!=="archive"&&t.jsx("button",{className:"prof-btn prof-btn-primary",onClick:()=>x(!0),children:" Crer mon premier groupe"})]}):t.jsx("div",{className:"groupe-grid",children:Me.map(Z=>{const V=l.get(Z.id),me=A?.id===Z.id;return t.jsxs("div",{className:`groupe-card ${Z.statut==="archive"?"groupe-card-archive":""} ${me?"groupe-card-editing":""}`,children:[t.jsxs("div",{className:"groupe-card-header",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"groupe-card-titre",children:Z.nom}),t.jsx("span",{className:"groupe-card-matiere",children:Z.matiereNom})]}),t.jsx("span",{className:`groupe-badge groupe-badge-${Z.statut}`,children:Z.statut==="actif"?" Actif":" Archiv"})]}),Z.description&&t.jsx("p",{style:{color:"#6b7280",fontSize:"0.85rem",margin:"0.25rem 0 0.5rem"},children:Z.description}),t.jsxs("div",{className:"groupe-card-infos",children:[t.jsxs("span",{children:[" ",Z.classeNiveau]}),t.jsxs("span",{children:[" ",Z.anneeScolaire]}),t.jsxs("span",{children:[" ",Z.nombreInscrits," lve",Z.nombreInscrits!==1?"s":""]})]}),t.jsxs("div",{className:"groupe-card-code",children:[t.jsx("span",{className:"groupe-code-label",children:"Code d'invitation :"}),t.jsxs("div",{className:"groupe-code-box",children:[t.jsx("code",{className:"groupe-code-value",children:Z.codeInvitation}),t.jsx("button",{className:"prof-btn-icon",onClick:we=>{we.stopPropagation(),K(Z.codeInvitation)},title:"Copier le code",children:C===Z.codeInvitation?"":""}),Z.statut==="actif"&&t.jsx("button",{className:"prof-btn-icon",onClick:we=>{we.stopPropagation(),ve(Z.id)},title:"Rgnrer le code",children:""})]})]}),V&&V.nombreEleves>0&&t.jsxs("div",{className:"groupe-card-stats",children:[t.jsxs("div",{className:"groupe-stat-item",children:[t.jsx("span",{className:"groupe-stat-value",children:V.moyenneClasse}),t.jsx("span",{className:"groupe-stat-label",children:"Moyenne"})]}),t.jsxs("div",{className:"groupe-stat-item",children:[t.jsxs("span",{className:"groupe-stat-value",children:[V.tauxReussite,"%"]}),t.jsx("span",{className:"groupe-stat-label",children:"Russite"})]}),t.jsxs("div",{className:"groupe-stat-item",children:[t.jsx("span",{className:"groupe-stat-value",children:V.elevesEnDifficulte}),t.jsx("span",{className:"groupe-stat-label",children:"En difficult"})]})]}),t.jsxs("div",{className:"groupe-card-actions",children:[Z.statut==="actif"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"prof-btn prof-btn-primary prof-btn-sm",onClick:()=>e(Z),children:" Voir dtails"}),t.jsx("button",{className:"prof-btn prof-btn-warning prof-btn-sm",onClick:()=>X(Z),style:{background:"#fef3c7",color:"#92400e",border:"1px solid #fbbf24"},children:" Modifier"}),t.jsx("button",{className:"prof-btn prof-btn-secondary prof-btn-sm",onClick:()=>xe(Z.id),children:" Archiver"})]}),E===Z.id?t.jsxs("div",{className:"groupe-confirm-suppression",children:[t.jsx("span",{children:"Confirmer ?"}),t.jsx("button",{className:"prof-btn prof-btn-danger prof-btn-sm",onClick:()=>oe(Z.id),children:"Oui, supprimer"}),t.jsx("button",{className:"prof-btn prof-btn-secondary prof-btn-sm",onClick:()=>S(null),children:"Non"})]}):t.jsx("button",{className:"prof-btn prof-btn-danger prof-btn-sm",onClick:()=>S(Z.id),children:" Supprimer"})]})]},Z.id)})})]})},qZ=({groupe:e,onRetour:r})=>{const[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState([]),[f,p]=g.useState([]),[h,v]=g.useState(null),[b,x]=g.useState(!0),[j,_]=g.useState(null),[C,w]=g.useState("apercu"),[E,S]=g.useState("moyenne_desc"),[A,O]=g.useState(null),[k,P]=g.useState(null),[D,B]=g.useState(!1),[U,$]=g.useState(null),R=g.useCallback(async()=>{try{x(!0),_(null);const[L,ne,K]=await Promise.all([Ej(e.id),SZ(e.id),CZ(e.matiereId)]);a(L),o(ne),p(K);const oe=EZ(ne,e.nom);d(oe)}catch(L){console.error("Erreur chargement dtail groupe:",L),_("Impossible de charger les donnes du groupe.")}finally{x(!1)}},[e.id,e.matiereId,e.nom]);g.useEffect(()=>{R()},[R]);const Y=async L=>{try{B(!0),P(L);const ne=await wZ(e.id,L);v(ne)}catch(ne){console.error("Erreur analyse quiz:",ne)}finally{B(!1)}},ae=()=>{const L=AZ(l,e.nom),ne=`PedaClic_${e.nom.replace(/\s+/g,"_")}_${new Date().toISOString().slice(0,10)}`;zZ(L,ne)},M=async L=>{try{$(L);const K=(await bp(e.id)).find(oe=>oe.eleveId===L);K&&(await NZ(K.id,e.id),await R())}catch(ne){_(ne.message)}finally{$(null)}},T=[...l].sort((L,ne)=>{switch(E){case"moyenne_desc":return ne.moyenne-L.moyenne;case"moyenne_asc":return L.moyenne-ne.moyenne;case"nom":return L.eleveNom.localeCompare(ne.eleveNom);case"streak":return ne.streak.actuel-L.streak.actuel;case"quiz_count":return ne.totalQuiz-L.totalQuiz;default:return 0}}),F=L=>L>=16?"prof-note-excellent":L>=12?"prof-note-bien":L>=10?"prof-note-passable":L>=8?"prof-note-insuffisant":"prof-note-critique",I=L=>{switch(L){case"hausse":return"";case"baisse":return"";default:return""}},X=L=>{switch(L){case"difficulte":return"";case"inactivite":return"";case"baisse":return"";case"felicitation":return"";default:return""}};return b?t.jsxs("div",{className:"prof-loading",children:[t.jsx("div",{className:"spinner"}),t.jsxs("p",{children:['Chargement des donnes de "',e.nom,'"...']})]}):t.jsxs("div",{className:"groupe-detail",children:[t.jsxs("div",{className:"groupe-detail-header",children:[t.jsx("button",{className:"prof-btn prof-btn-secondary",onClick:r,children:" Retour aux groupes"}),t.jsxs("div",{className:"groupe-detail-titre-section",children:[t.jsx("h2",{className:"groupe-detail-titre",children:e.nom}),t.jsxs("p",{className:"groupe-detail-subtitle",children:[e.matiereNom,"  ",e.classeNiveau,"  ",e.anneeScolaire]})]}),t.jsx("button",{className:"prof-btn prof-btn-secondary",onClick:ae,children:" Export CSV"})]}),j&&t.jsxs("div",{className:"prof-alert prof-alert-error",children:[" ",j,t.jsx("button",{onClick:()=>_(null),className:"prof-alert-close",children:""})]}),t.jsx("div",{className:"groupe-detail-onglets",children:[{id:"apercu",label:" Aperu",count:null},{id:"eleves",label:" lves",count:l.length},{id:"quiz",label:" Quiz",count:f.length},{id:"alertes",label:" Alertes",count:u.length}].map(L=>t.jsxs("button",{className:`groupe-onglet ${C===L.id?"active":""}`,onClick:()=>w(L.id),children:[L.label,L.count!==null&&L.count>0&&t.jsx("span",{className:"groupe-onglet-badge",children:L.count})]},L.id))}),C==="apercu"&&n&&t.jsxs("div",{className:"groupe-apercu",children:[t.jsxs("div",{className:"groupe-stats-grid",children:[t.jsxs("div",{className:"groupe-stat-card",children:[t.jsx("div",{className:"groupe-stat-card-icon",children:""}),t.jsxs("div",{className:"groupe-stat-card-content",children:[t.jsxs("span",{className:`groupe-stat-card-value ${F(n.moyenneClasse)}`,children:[n.moyenneClasse,"/20"]}),t.jsx("span",{className:"groupe-stat-card-label",children:"Moyenne classe"})]})]}),t.jsxs("div",{className:"groupe-stat-card",children:[t.jsx("div",{className:"groupe-stat-card-icon",children:""}),t.jsxs("div",{className:"groupe-stat-card-content",children:[t.jsxs("span",{className:"groupe-stat-card-value",children:[n.tauxReussite,"%"]}),t.jsx("span",{className:"groupe-stat-card-label",children:"Taux de russite"})]})]}),t.jsxs("div",{className:"groupe-stat-card",children:[t.jsx("div",{className:"groupe-stat-card-icon",children:""}),t.jsxs("div",{className:"groupe-stat-card-content",children:[t.jsx("span",{className:"groupe-stat-card-value",children:n.nombreEleves}),t.jsx("span",{className:"groupe-stat-card-label",children:"lves inscrits"})]})]}),t.jsxs("div",{className:"groupe-stat-card",children:[t.jsx("div",{className:"groupe-stat-card-icon",children:""}),t.jsxs("div",{className:"groupe-stat-card-content",children:[t.jsx("span",{className:"groupe-stat-card-value",children:n.totalQuizPasses}),t.jsx("span",{className:"groupe-stat-card-label",children:"Quiz passs"})]})]}),t.jsxs("div",{className:"groupe-stat-card",children:[t.jsx("div",{className:"groupe-stat-card-icon",children:""}),t.jsxs("div",{className:"groupe-stat-card-content",children:[t.jsxs("span",{className:"groupe-stat-card-value",children:[n.tauxParticipation,"%"]}),t.jsx("span",{className:"groupe-stat-card-label",children:"Participation"})]})]}),t.jsxs("div",{className:"groupe-stat-card",children:[t.jsx("div",{className:"groupe-stat-card-icon",children:""}),t.jsxs("div",{className:"groupe-stat-card-content",children:[t.jsx("span",{className:`groupe-stat-card-value ${n.elevesEnDifficulte>0?"prof-note-critique":"prof-note-excellent"}`,children:n.elevesEnDifficulte}),t.jsx("span",{className:"groupe-stat-card-label",children:"En difficult"})]})]})]}),t.jsx("div",{className:"groupe-apercu-notes",children:t.jsxs("div",{className:"groupe-note-range",children:[t.jsx("span",{className:"groupe-note-range-label",children:"Plage des notes :"}),t.jsxs("span",{className:"prof-note-critique",children:[n.pireNote,"/20"]}),t.jsx("div",{className:"groupe-note-barre",children:t.jsx("div",{className:"groupe-note-barre-fill",style:{left:`${n.pireNote/20*100}%`,width:`${(n.meilleureNote-n.pireNote)/20*100}%`}})}),t.jsxs("span",{className:"prof-note-excellent",children:[n.meilleureNote,"/20"]})]})}),l.length>=3&&t.jsxs("div",{className:"groupe-apercu-classement",children:[t.jsxs("div",{className:"groupe-classement-section",children:[t.jsx("h4",{children:" Top 3"}),l.slice(0,3).map((L,ne)=>t.jsxs("div",{className:"groupe-classement-item",children:[t.jsx("span",{className:"groupe-classement-rang",children:ne===0?"":ne===1?"":""}),t.jsx("span",{className:"groupe-classement-nom",children:L.eleveNom}),t.jsxs("span",{className:`groupe-classement-note ${F(L.moyenne)}`,children:[L.moyenne,"/20"]})]},L.eleveId))]}),t.jsxs("div",{className:"groupe-classement-section",children:[t.jsx("h4",{children:"  surveiller"}),l.filter(L=>L.moyenne<8&&L.totalQuiz>0).slice(0,3).map(L=>t.jsxs("div",{className:"groupe-classement-item",children:[t.jsx("span",{className:"groupe-classement-rang",children:""}),t.jsx("span",{className:"groupe-classement-nom",children:L.eleveNom}),t.jsxs("span",{className:`groupe-classement-note ${F(L.moyenne)}`,children:[L.moyenne,"/20"]})]},L.eleveId)),l.filter(L=>L.moyenne<8&&L.totalQuiz>0).length===0&&t.jsx("p",{className:"groupe-classement-vide",children:"Aucun lve en difficult "})]})]})]}),C==="eleves"&&t.jsxs("div",{className:"groupe-eleves",children:[t.jsxs("div",{className:"groupe-eleves-toolbar",children:[t.jsx("label",{htmlFor:"tri-eleves",children:"Trier par :"}),t.jsxs("select",{id:"tri-eleves",value:E,onChange:L=>S(L.target.value),className:"prof-select prof-select-sm",children:[t.jsx("option",{value:"moyenne_desc",children:"Moyenne ()"}),t.jsx("option",{value:"moyenne_asc",children:"Moyenne ()"}),t.jsx("option",{value:"nom",children:"Nom (A-Z)"}),t.jsx("option",{value:"streak",children:"Streak ()"}),t.jsx("option",{value:"quiz_count",children:"Quiz passs ()"})]}),t.jsxs("span",{className:"groupe-eleves-count",children:[l.length," lve",l.length!==1?"s":""]})]}),l.length===0?t.jsxs("div",{className:"prof-empty-state",children:[t.jsx("div",{className:"prof-empty-icon",children:""}),t.jsx("h3",{children:"Aucun lve inscrit"}),t.jsxs("p",{children:["Partagez le code ",t.jsx("strong",{children:e.codeInvitation}),"  vos lves."]})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"groupe-eleves-table-wrapper",children:t.jsxs("table",{className:"groupe-eleves-table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"#"}),t.jsx("th",{children:"lve"}),t.jsx("th",{children:"Moyenne"}),t.jsx("th",{children:"Quiz"}),t.jsx("th",{children:"Russite"}),t.jsx("th",{children:"Streak"}),t.jsx("th",{children:"Tendance"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:T.map((L,ne)=>t.jsxs("tr",{className:`${A===L.eleveId?"groupe-eleve-row-active":""}`,children:[t.jsx("td",{className:"groupe-eleve-rang",children:ne+1}),t.jsx("td",{className:"groupe-eleve-nom-cell",children:t.jsxs("div",{children:[t.jsx("strong",{children:L.eleveNom}),t.jsx("span",{className:"groupe-eleve-email",children:L.eleveEmail})]})}),t.jsx("td",{children:t.jsxs("span",{className:`groupe-note-badge ${F(L.moyenne)}`,children:[L.moyenne,"/20"]})}),t.jsx("td",{children:L.totalQuiz}),t.jsxs("td",{children:[L.tauxReussite,"%"]}),t.jsx("td",{children:t.jsxs("span",{className:"groupe-streak",children:[" ",L.streak.actuel,"j"]})}),t.jsxs("td",{children:[I(L.tendance)," ",L.tendance]}),t.jsxs("td",{className:"groupe-eleve-actions",children:[t.jsx("button",{className:"prof-btn-icon",onClick:()=>O(A===L.eleveId?null:L.eleveId),title:"Voir dtails",children:A===L.eleveId?"":""}),t.jsx("button",{className:"prof-btn-icon prof-btn-icon-danger",onClick:()=>M(L.eleveId),disabled:U===L.eleveId,title:"Retirer du groupe",children:U===L.eleveId?"":""})]})]},L.eleveId))})]})}),A&&(()=>{const L=l.find(ne=>ne.eleveId===A);return L?t.jsxs("div",{className:"groupe-eleve-detail",children:[t.jsxs("div",{className:"groupe-eleve-detail-header",children:[t.jsxs("h3",{children:[" Dtail  ",L.eleveNom]}),t.jsx("button",{className:"prof-btn-icon",onClick:()=>O(null),children:""})]}),t.jsxs("div",{className:"groupe-eleve-detail-grid",children:[t.jsxs("div",{className:"groupe-eleve-detail-card",children:[t.jsx("h4",{children:"Score global"}),t.jsx("div",{className:"groupe-eleve-score-circle",children:t.jsxs("span",{className:F(L.scoreGlobal/5),children:[L.scoreGlobal,"/100"]})})]}),t.jsxs("div",{className:"groupe-eleve-detail-card",children:[t.jsx("h4",{children:" Streak"}),t.jsxs("p",{children:["Actuel : ",t.jsxs("strong",{children:[L.streak.actuel," jour",L.streak.actuel!==1?"s":""]})]}),t.jsxs("p",{children:["Meilleur : ",L.streak.meilleur," jours"]})]}),t.jsxs("div",{className:"groupe-eleve-detail-card groupe-eleve-detail-card-wide",children:[t.jsx("h4",{children:" Lacunes dtectes"}),L.lacunes.length===0?t.jsx("p",{className:"text-muted",children:"Aucune lacune dtecte "}):t.jsx("ul",{className:"groupe-lacunes-liste",children:L.lacunes.map((ne,K)=>t.jsxs("li",{className:`groupe-lacune-item groupe-lacune-${ne.niveauUrgence}`,children:[t.jsxs("span",{className:"groupe-lacune-nom",children:[ne.disciplineNom,ne.chapitre&&`  ${ne.chapitre}`]}),t.jsxs("span",{className:"groupe-lacune-moyenne",children:[ne.moyenne,"/20"]}),t.jsx("span",{className:`groupe-lacune-badge groupe-lacune-badge-${ne.niveauUrgence}`,children:ne.niveauUrgence})]},K))})]})]})]}):null})()]})]}),C==="quiz"&&t.jsxs("div",{className:"groupe-quiz",children:[t.jsxs("div",{className:"groupe-quiz-selector",children:[t.jsx("label",{htmlFor:"select-quiz",children:"Slectionner un quiz  analyser :"}),t.jsxs("select",{id:"select-quiz",value:k||"",onChange:L=>{L.target.value&&Y(L.target.value)},className:"prof-select",children:[t.jsx("option",{value:"",children:" Choisir un quiz "}),f.map(L=>t.jsx("option",{value:L.id,children:L.titre},L.id))]})]}),!k&&t.jsxs("div",{className:"prof-empty-state",children:[t.jsx("div",{className:"prof-empty-icon",children:""}),t.jsx("h3",{children:"Analyse par quiz"}),t.jsx("p",{children:"Slectionnez un quiz pour voir les statistiques dtailles et les questions les plus rates."})]}),D&&t.jsxs("div",{className:"prof-loading",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Analyse en cours..."})]}),h&&!D&&t.jsxs("div",{className:"groupe-quiz-resultats",children:[t.jsxs("div",{className:"groupe-quiz-stats-header",children:[t.jsx("h3",{children:h.quizTitre}),t.jsxs("div",{className:"groupe-quiz-stats-grid",children:[t.jsxs("div",{className:"groupe-stat-mini",children:[t.jsx("span",{className:"groupe-stat-mini-value",children:h.totalPassages}),t.jsx("span",{className:"groupe-stat-mini-label",children:"Passages"})]}),t.jsxs("div",{className:"groupe-stat-mini",children:[t.jsxs("span",{className:`groupe-stat-mini-value ${F(h.moyenneScore)}`,children:[h.moyenneScore,"/20"]}),t.jsx("span",{className:"groupe-stat-mini-label",children:"Moyenne"})]}),t.jsxs("div",{className:"groupe-stat-mini",children:[t.jsxs("span",{className:"groupe-stat-mini-value",children:[h.tauxReussite,"%"]}),t.jsx("span",{className:"groupe-stat-mini-label",children:"Russite"})]}),t.jsxs("div",{className:"groupe-stat-mini",children:[t.jsxs("span",{className:"groupe-stat-mini-value",children:[Math.floor(h.tempsEcouleMoyen/60),"min"]}),t.jsx("span",{className:"groupe-stat-mini-label",children:"Temps moyen"})]})]})]}),t.jsxs("div",{className:"groupe-quiz-questions",children:[t.jsx("h4",{children:" Questions les plus rates"}),h.questionsRatees.filter(L=>L.tauxEchec>30).map((L,ne)=>t.jsxs("div",{className:"groupe-quiz-question-card",children:[t.jsxs("div",{className:"groupe-quiz-question-header",children:[t.jsxs("span",{className:"groupe-quiz-question-num",children:["Q",L.questionIndex+1]}),t.jsxs("span",{className:"groupe-quiz-question-echec",children:[L.tauxEchec,"% d'chec"]})]}),t.jsx("p",{className:"groupe-quiz-question-texte",children:L.questionTexte}),t.jsx("div",{className:"groupe-quiz-question-reponse",children:t.jsxs("span",{className:"groupe-quiz-bonne-reponse",children:[" Bonne rponse : ",L.reponseCorrecte]})}),L.reponsesFrequentes.length>0&&t.jsxs("div",{className:"groupe-quiz-mauvaises-reponses",children:[t.jsx("span",{children:"Erreurs frquentes :"}),L.reponsesFrequentes.slice(0,2).map((K,oe)=>t.jsxs("span",{className:"groupe-quiz-mauvaise-reponse",children:[" ",K.reponse," (",K.nombre," lve",K.nombre>1?"s":"",")"]},oe))]})]},ne)),h.questionsRatees.filter(L=>L.tauxEchec>30).length===0&&t.jsx("p",{className:"text-muted",children:"Toutes les questions ont un taux de russite suprieur  70% "})]})]})]}),C==="alertes"&&t.jsx("div",{className:"groupe-alertes",children:u.length===0?t.jsxs("div",{className:"prof-empty-state",children:[t.jsx("div",{className:"prof-empty-icon",children:""}),t.jsx("h3",{children:"Aucune alerte"}),t.jsx("p",{children:"Tous vos lves se portent bien ! Les alertes apparatront ici quand un lve aura besoin d'attention."})]}):t.jsx("div",{className:"groupe-alertes-liste",children:u.map(L=>t.jsxs("div",{className:`groupe-alerte-card groupe-alerte-${L.niveauUrgence}`,children:[t.jsxs("div",{className:"groupe-alerte-header",children:[t.jsx("span",{className:"groupe-alerte-emoji",children:X(L.type)}),t.jsx("span",{className:"groupe-alerte-eleve",children:L.eleveNom}),t.jsx("span",{className:`groupe-alerte-badge groupe-alerte-badge-${L.niveauUrgence}`,children:L.niveauUrgence})]}),t.jsx("p",{className:"groupe-alerte-message",children:L.message}),t.jsx("button",{className:"prof-btn prof-btn-secondary prof-btn-sm",onClick:()=>{w("eleves"),O(L.eleveId)},children:" Voir dtail"})]},L.id))})})]})},RZ=()=>{const{currentUser:e}=Ke(),r=Je(),[n,a]=g.useState("overview"),[l,o]=g.useState(null),[u,d]=g.useState(0),[f,p]=g.useState(0),[h,v]=g.useState(0),[b,x]=g.useState(0),[j,_]=g.useState([]),[C,w]=g.useState(!0),E=g.useCallback(async()=>{if(e?.uid)try{w(!0);const k=(await uM(e.uid)).filter(R=>R.statut==="actif");d(k.length);let P=0,D=0,B=0,U=0;const $=[];for(const R of k)try{const Y=await Ej(R.id);P+=Y.nombreEleves,Y.nombreEleves>0&&(D+=Y.moyenneClasse,B++),U+=Y.elevesEnDifficulte,$.push({...R,stats:Y})}catch{$.push({...R})}p(P),v(B>0?Math.round(D/B*10)/10:0),x(U),_($)}catch(O){console.error("Erreur chargement rsum prof:",O)}finally{w(!1)}},[e?.uid]);g.useEffect(()=>{E()},[E]);const S=O=>{o(O),a("detail")},A=()=>{o(null),a("groupes"),E()};return C?t.jsxs("div",{className:"prof-loading",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement de votre espace professeur..."})]}):t.jsxs("div",{className:"prof-dashboard",children:[t.jsx("header",{className:"prof-dashboard-header",children:t.jsxs("div",{children:[t.jsx("h1",{className:"prof-dashboard-titre",children:"Tableau de bord Professeur"}),t.jsxs("p",{className:"prof-dashboard-subtitle",children:["Bienvenue, ",e?.displayName||"Professeur"," "]})]})}),n!=="detail"&&t.jsxs("nav",{className:"prof-nav",children:[t.jsx("button",{className:`prof-nav-btn ${n==="overview"?"active":""}`,onClick:()=>a("overview"),children:" Vue d'ensemble"}),t.jsx("button",{className:`prof-nav-btn ${n==="groupes"?"active":""}`,onClick:()=>a("groupes"),children:" Mes groupes-classes"}),t.jsx("button",{className:"prof-nav-btn",onClick:()=>r("/prof/cahiers"),children:" Cahier de textes"}),t.jsx("button",{className:"prof-nav-btn",onClick:()=>r("/prof/sequences"),children:" Squences pdagogiques"}),t.jsx("button",{className:"prof-nav-btn",onClick:()=>r("/prof/cours"),children:" Cours en ligne"})]}),n==="overview"&&t.jsxs("div",{className:"prof-overview",children:[t.jsxs("div",{className:"prof-overview-cards",children:[t.jsxs("div",{className:"prof-overview-card prof-overview-card-clickable",onClick:()=>a("groupes"),children:[t.jsx("div",{className:"prof-overview-card-icon",children:""}),t.jsxs("div",{className:"prof-overview-card-content",children:[t.jsx("span",{className:"prof-overview-card-value",children:u}),t.jsxs("span",{className:"prof-overview-card-label",children:["Groupe",u!==1?"s":""," actif",u!==1?"s":""]})]})]}),t.jsxs("div",{className:"prof-overview-card",children:[t.jsx("div",{className:"prof-overview-card-icon",children:""}),t.jsxs("div",{className:"prof-overview-card-content",children:[t.jsx("span",{className:"prof-overview-card-value",children:f}),t.jsxs("span",{className:"prof-overview-card-label",children:["lve",f!==1?"s":""," inscrit",f!==1?"s":""]})]})]}),t.jsxs("div",{className:"prof-overview-card",children:[t.jsx("div",{className:"prof-overview-card-icon",children:""}),t.jsxs("div",{className:"prof-overview-card-content",children:[t.jsxs("span",{className:"prof-overview-card-value",children:[h,"/20"]}),t.jsx("span",{className:"prof-overview-card-label",children:"Moyenne gnrale"})]})]}),t.jsxs("div",{className:"prof-overview-card",children:[t.jsx("div",{className:"prof-overview-card-icon",children:""}),t.jsxs("div",{className:"prof-overview-card-content",children:[t.jsx("span",{className:`prof-overview-card-value ${b>0?"prof-note-critique":""}`,children:b}),t.jsxs("span",{className:"prof-overview-card-label",children:["lve",b!==1?"s":""," en difficult"]})]})]})]}),j.length===0?t.jsxs("div",{className:"prof-empty-state",children:[t.jsx("div",{className:"prof-empty-icon",children:""}),t.jsx("h3",{children:"Bienvenue sur votre espace Professeur !"}),t.jsx("p",{children:"Crez votre premier groupe-classe pour commencer  suivre vos lves."}),t.jsx("button",{className:"prof-btn prof-btn-primary",onClick:()=>a("groupes"),children:" Crer un groupe-classe"})]}):t.jsxs("div",{className:"prof-overview-groupes",children:[t.jsx("h2",{children:"Mes groupes"}),t.jsx("div",{className:"prof-overview-groupes-grid",children:j.map(O=>t.jsxs("div",{className:"prof-overview-groupe-card",onClick:()=>S(O),children:[t.jsxs("div",{className:"prof-overview-groupe-header",children:[t.jsx("h3",{children:O.nom}),t.jsx("span",{className:"prof-overview-groupe-matiere",children:O.matiereNom})]}),O.stats&&t.jsxs("div",{className:"prof-overview-groupe-stats",children:[t.jsxs("div",{children:[t.jsx("span",{className:"prof-overview-groupe-stat-value",children:O.stats.nombreEleves}),t.jsx("span",{className:"prof-overview-groupe-stat-label",children:"lves"})]}),t.jsxs("div",{children:[t.jsxs("span",{className:"prof-overview-groupe-stat-value",children:[O.stats.moyenneClasse,"/20"]}),t.jsx("span",{className:"prof-overview-groupe-stat-label",children:"Moyenne"})]}),t.jsxs("div",{children:[t.jsxs("span",{className:"prof-overview-groupe-stat-value",children:[O.stats.tauxReussite,"%"]}),t.jsx("span",{className:"prof-overview-groupe-stat-label",children:"Russite"})]})]}),t.jsx("span",{className:"prof-overview-groupe-arrow",children:""})]},O.id))})]})]}),n==="groupes"&&t.jsx(TZ,{onSelectGroupe:S}),n==="detail"&&l&&t.jsx(qZ,{groupe:l,onRetour:A})]})},os="cahiers_textes",aa="entrees_cahier",IZ="groupes_prof",LZ="ebooks";async function $Z(e,r){const n=[Ne("profId","==",e),Ve("updatedAt","desc")],a=Ee(_e(Q,os),...n);return(await Ce(a)).docs.map(o=>({groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...o.data(),id:o.id}))}const mM=e=>$Z(e);async function BZ(){const e=Ee(_e(Q,os),Ve("updatedAt","desc"),Ht(100));return(await Ce(e)).docs.map(n=>({groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...n.data(),id:n.id}))}function UZ(e,r,n,a){const l=[Ne("profId","==",e),Ve("updatedAt","desc")];r&&l.splice(1,0,Ne("anneeScolaire","==",r));const o=Ee(_e(Q,os),...l);return Sf(o,u=>{n(u.docs.map(d=>({groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...d.data(),id:d.id})))},a)}async function fM(e){const r=await Et(je(Q,os,e));return r.exists()?{groupeIds:[],groupeNoms:[],isPartage:!1,isArchived:!1,...r.data(),id:r.id}:null}const pM=e=>WZ(e);async function FZ(e){const r=await Et(je(Q,aa,e));return r.exists()?{id:r.id,...r.data()}:null}async function GZ(e,r,n,a){const l=`${Date.now()}_${n.name}`,o=`cahiers/${e}/${r}/${l}`,u=sr(er,o),d=lu(u,n);return new Promise((f,p)=>{d.on("state_changed",h=>{},p,async()=>{const h=await Mn(d.snapshot.ref);f({id:l,nom:n.name,url:h,type:n.type,taille:n.size,mimeType:n.type,uploadedAt:new Date().toISOString()})})})}async function KE(e,r,n){await He(je(Q,aa,e),{piecesJointes:$b(...n),updatedAt:Ae.now()})}async function HZ(e,r,n){const a=r.find(l=>l.url===n);try{a?.id&&await Is(sr(er,`cahiers/${a.id}`))}catch{}a&&await He(je(Q,aa,e),{piecesJointes:i3(a),updatedAt:Ae.now()})}async function VZ(e,r){const n=Ae.now(),a=r.titre?.trim()||`${r.matiere} ${r.classe} ${r.anneeScolaire}`;return(await Pt(_e(Q,os),{profId:e,titre:a,matiere:r.matiere,classe:r.classe,anneeScolaire:r.anneeScolaire,description:r.description||"",couleur:r.couleur,nombreSeancesPrevu:r.nombreSeancesPrevu,nombreSeancesRealise:0,isArchived:!1,groupeIds:r.groupeIds??[],groupeNoms:r.groupeNoms??[],isPartage:r.isPartage??!1,createdAt:n,updatedAt:n})).id}async function xf(e,r){const n={...r};if("matiere"in r&&"classe"in r&&!("id"in r)){const a=r;a.titre?.trim()||(n.titre=`${a.matiere} ${a.classe} ${a.anneeScolaire}`)}await He(je(Q,os,e),{...n,updatedAt:Ae.now()})}async function QZ(e){await Br(je(Q,os,e))}async function YZ(e){const r=await Et(je(Q,os,e));if(!r.exists())return null;const n=r.data();return n.isPartage?{id:r.id,...n}:null}async function hM(e){const r=Ee(_e(Q,IZ),Ne("profId","==",e),Ve("nom","asc"));return(await Ce(r)).docs.map(a=>({id:a.id,...a.data()}))}async function KZ(){return(await Ce(_e(Q,LZ))).docs.map(r=>({id:r.id,...r.data()}))}async function WZ(e){const r=Ee(_e(Q,aa),Ne("cahierId","==",e),Ve("ordre","asc"));return(await Ce(r)).docs.map(a=>({id:a.id,...a.data()}))}const XZ=async(e,r,n)=>{const a=Ae.fromDate(new Date(r,n,1)),l=Ae.fromDate(new Date(r,n+1,0,23,59,59)),o=Ee(_e(Q,aa),Ne("cahierId","==",e),Ne("date",">=",a),Ne("date","<=",l),Ve("date","asc"));return(await Ce(o)).docs.map(d=>({id:d.id,...d.data()}))},ZZ=async(e,r)=>{const n=[Ne("profId","==",e),Ne("isMarqueEvaluation","==",!0),Ve("date","desc")];r&&n.unshift(Ne("cahierId","==",r));const a=Ee(_e(Q,aa),...n);return(await Ce(a)).docs.map(o=>({id:o.id,...o.data()}))},JZ=async e=>{const n=(await Ce(Ee(_e(Q,aa),Ne("cahierId","==",e)))).docs.map(u=>u.data()),a=n.length,l={realise:0,planifie:0,annule:0,reporte:0},o={};for(const u of n){const d=u.statut;d in l&&l[d]++,u.typeContenu&&(o[u.typeContenu]=(o[u.typeContenu]??0)+1)}return{total:a,...l,parType:o,tauxRealisation:a>0?Math.round(l.realise/a*100):0}};async function eJ(e){const r=Ee(_e(Q,aa),Ne("cahierId","==",e),Ne("statut","==","realise"),Ve("date","desc"));return(await Ce(r)).docs.map(a=>({id:a.id,...a.data()}))}async function tJ(e,r,n){const a=Ae.now();let l;if(typeof e=="string"){const u=n;l={cahierId:e,profId:r,date:Ae.fromDate(new Date(u.date)),heureDebut:u.heureDebut||"",heureFin:u.heureFin||"",chapitre:u.chapitre,typeContenu:u.typeContenu,contenu:u.contenu,objectifs:u.objectifs||"",competences:u.competences||[],statut:u.statut,motifAnnulation:u.motifAnnulation||"",dateReport:u.dateReport?Ae.fromDate(new Date(u.dateReport)):null,notesPrivees:u.notesPrivees||"",isMarqueEvaluation:u.isMarqueEvaluation,typeEvaluation:u.typeEvaluation||null,dateEvaluationPrevue:u.dateEvaluationPrevue?Ae.fromDate(new Date(u.dateEvaluationPrevue)):null,statutEvaluation:u.statutEvaluation,ordre:Date.now(),piecesJointes:[],liens:[],ebooksLies:[],contenuIA:[]}}else l={liens:[],ebooksLies:[],piecesJointes:[],contenuIA:[],...e};return(await Pt(_e(Q,aa),{...l,createdAt:a,updatedAt:a})).id}async function Lc(e,r,n){let a;if(typeof r=="string"&&n){const l=n;a={date:Ae.fromDate(new Date(l.date)),heureDebut:l.heureDebut||"",heureFin:l.heureFin||"",chapitre:l.chapitre,typeContenu:l.typeContenu,contenu:l.contenu,objectifs:l.objectifs||"",competences:l.competences||[],statut:l.statut,motifAnnulation:l.motifAnnulation||"",dateReport:l.dateReport?Ae.fromDate(new Date(l.dateReport)):null,notesPrivees:l.notesPrivees||"",isMarqueEvaluation:l.isMarqueEvaluation,typeEvaluation:l.typeEvaluation||null,dateEvaluationPrevue:l.dateEvaluationPrevue?Ae.fromDate(new Date(l.dateEvaluationPrevue)):null,statutEvaluation:l.statutEvaluation}}else a={...r};await He(je(Q,aa,e),{...a,updatedAt:Ae.now()})}async function rJ(e){await Br(je(Q,aa,e))}const WE=()=>({classe:"3me",matiere:"Mathmatiques",anneeScolaire:"2025-2026",titre:"",description:"",couleur:"#2563eb",nombreSeancesPrevu:30,groupeIds:[],groupeNoms:[],isPartage:!1}),nJ=()=>{const{currentUser:e}=Ke(),r=Je(),[n]=pA(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,f]=g.useState("2025-2026"),[p,h]=g.useState(!1),[v,b]=g.useState(null),[x,j]=g.useState(WE()),[_,C]=g.useState(!1),[w,E]=g.useState(""),{matieres:S,loading:A}=Ca(),[O,k]=g.useState([]),[P,D]=g.useState([]);if(!e?.isPremium&&e?.role!=="admin")return t.jsx("div",{className:"cahier-textes-page",children:t.jsxs("div",{className:"premium-gate",children:[t.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),t.jsx("h2",{children:"Cahier de Textes Numrique"}),t.jsxs("p",{children:["Cette fonctionnalit est rserve aux enseignants Premium.",t.jsx("br",{}),"Passez au Premium pour organiser, planifier et suivre votre enseignement."]}),t.jsx("button",{className:"btn-primary",onClick:()=>r("/premium"),children:" Passer au Premium  2 000 FCFA/mois"})]})});g.useEffect(()=>{if(!e?.uid)return;u(!0);const M=UZ(e.uid,d||void 0,T=>{l(T),u(!1)},T=>{console.error("Erreur chargement cahiers:",T),u(!1)});return()=>M()},[e?.uid,d]),g.useEffect(()=>{if(!e?.uid)return;hM(e.uid).then(k).catch(I=>console.error("Erreur chargement groupes:",I));const M=n.get("groupeId"),T=n.get("groupeNom"),F=n.get("classe");M&&T&&(D([M]),j(I=>({...I,classe:F||I.classe,groupeIds:[M],groupeNoms:[T]})),b(null),E(""),h(!0))},[e?.uid]);const B=()=>{b(null),j(WE()),D([]),E(""),h(!0)},U=(M,T)=>{T.stopPropagation(),b(M),D(M.groupeIds??[]),j({classe:M.classe,matiere:M.matiere,anneeScolaire:M.anneeScolaire,titre:M.titre,description:M.description||"",couleur:M.couleur,nombreSeancesPrevu:M.nombreSeancesPrevu,groupeIds:M.groupeIds??[],groupeNoms:M.groupeNoms??[],isPartage:M.isPartage??!1}),E(""),h(!0)},$=M=>{D(T=>{const F=T.includes(M)?T.filter(X=>X!==M):[...T,M],I=F.map(X=>O.find(L=>L.id===X)?.nom??"").filter(Boolean);return j(X=>({...X,groupeIds:F,groupeNoms:I})),F})},R=async M=>{if(M.preventDefault(),!!e?.uid){C(!0),E("");try{v?await xf(v.id,x):await VZ(e.uid,x),h(!1)}catch(T){const F=T instanceof Error?T.message:String(T);E("Erreur : "+F)}finally{C(!1)}}},Y=async(M,T)=>{if(T.stopPropagation(),!!confirm(`Supprimer le cahier "${M.titre}" et toutes ses entres ?`))try{await QZ(M.id),l(F=>F.filter(I=>I.id!==M.id))}catch{alert("Erreur lors de la suppression.")}},ae=M=>M.nombreSeancesPrevu>0?Math.min(100,Math.round(M.nombreSeancesRealise/M.nombreSeancesPrevu*100)):0;return t.jsxs("div",{className:"cahier-textes-page",children:[t.jsxs("div",{className:"cahier-page-header",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"cahier-page-title",children:" Cahier de Textes"}),t.jsx("p",{className:"cahier-page-subtitle",children:"Organisez et planifiez votre enseignement"})]}),t.jsx("button",{className:"btn-primary",onClick:B,children:"+ Nouveau cahier"})]}),t.jsxs("div",{className:"cahier-filtres",children:[t.jsx("label",{style:{fontSize:"0.85rem",color:"#6b7280",fontWeight:600},children:"Anne scolaire :"}),t.jsxs("select",{className:"filtre-select",value:d,onChange:M=>f(M.target.value),children:[t.jsx("option",{value:"",children:"Toutes les annes"}),$1.map(M=>t.jsx("option",{value:M,children:M},M))]})]}),o?t.jsx("div",{className:"loading-spinner",children:t.jsx("div",{className:"spinner-circle"})}):a.length===0?t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{style:{fontSize:"3rem",opacity:.3,marginBottom:"0.75rem"},children:""}),t.jsxs("h3",{children:["Aucun cahier pour ",d||"cette priode"]}),t.jsx("p",{children:"Crez votre premier cahier de textes pour commencer  planifier votre enseignement."}),t.jsx("button",{className:"btn-primary",onClick:B,style:{marginTop:"1rem"},children:"+ Crer mon premier cahier"})]}):t.jsx("div",{className:"cahiers-grid",children:a.map(M=>{const T=ae(M);return t.jsxs("div",{className:"cahier-card",onClick:()=>r(`/prof/cahiers/${M.id}`),children:[t.jsx("div",{style:{height:4,background:M.couleur,borderRadius:"12px 12px 0 0"}}),t.jsx("div",{className:"cahier-card-header",children:t.jsxs("div",{style:{flex:1},children:[t.jsx("h3",{className:"cahier-card-titre",children:M.titre}),t.jsxs("div",{className:"cahier-card-meta",children:[t.jsx("span",{className:"badge-classe",children:M.classe}),t.jsx("span",{className:"badge-matiere",children:M.matiere}),t.jsx("span",{className:"badge-annee",children:M.anneeScolaire})]}),(M.groupeIds?.length??0)>0&&t.jsxs("span",{className:`badge-partage ${M.isPartage?"actif":""}`,style:{marginTop:6,display:"inline-flex"},children:[M.isPartage?" Partag avec":" Li "," ",M.groupeIds.length," groupe",M.groupeIds.length>1?"s":""]})]})}),t.jsxs("div",{className:"cahier-card-body",children:[M.description&&t.jsxs("p",{style:{fontSize:"0.82rem",color:"#6b7280",margin:"0 0 0.75rem",lineHeight:1.5},children:[M.description.substring(0,80),M.description.length>80?"...":""]}),t.jsxs("div",{className:"progression-bar-wrap",children:[t.jsxs("div",{className:"progression-label",children:[t.jsx("span",{children:"Progression"}),t.jsxs("span",{style:{fontWeight:700,color:M.couleur},children:[T,"%"]})]}),t.jsx("div",{className:"progression-bar-bg",children:t.jsx("div",{className:"progression-bar-fill",style:{width:`${T}%`,background:M.couleur}})}),t.jsxs("div",{style:{fontSize:"0.72rem",color:"#9ca3af",marginTop:"0.3rem"},children:[M.nombreSeancesRealise," / ",M.nombreSeancesPrevu," sances ralises"]})]})]}),t.jsxs("div",{className:"cahier-card-footer",children:[t.jsxs("span",{style:{fontSize:"0.75rem",color:"#9ca3af"},children:["Mis  jour le ",M.updatedAt?.toDate().toLocaleDateString("fr-FR")||""]}),t.jsxs("div",{className:"cahier-actions",children:[t.jsx("button",{className:"btn-icon",onClick:F=>U(M,F),title:"Modifier",children:""}),t.jsx("button",{className:"btn-icon",onClick:F=>Y(M,F),title:"Supprimer",style:{color:"#ef4444"},children:""})]})]})]},M.id)})}),p&&t.jsx("div",{className:"modal-overlay",onClick:()=>h(!1),children:t.jsxs("div",{className:"modal-content",onClick:M=>M.stopPropagation(),children:[t.jsxs("h2",{className:"modal-title",children:[" ",v?"Modifier le cahier":"Nouveau cahier de textes"]}),t.jsxs("form",{onSubmit:R,children:[t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Classe *"}),t.jsx("select",{className:"form-select",value:x.classe,onChange:M=>j(T=>({...T,classe:M.target.value})),required:!0,children:wa.map(M=>t.jsx("option",{value:M,children:M},M))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Matire *"}),t.jsxs("select",{className:"form-select",value:x.matiere,onChange:M=>j(T=>({...T,matiere:M.target.value})),required:!0,disabled:A,children:[t.jsx("option",{value:"",children:A?"Chargement":" Slectionner "}),S.map(M=>t.jsx("option",{value:M.valeur,children:M.label},M.valeur)),x.matiere&&!S.find(M=>M.valeur===x.matiere)&&t.jsx("option",{value:x.matiere,children:x.matiere})]})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Anne scolaire *"}),t.jsx("select",{className:"form-select",value:x.anneeScolaire,onChange:M=>j(T=>({...T,anneeScolaire:M.target.value})),children:$1.map(M=>t.jsx("option",{value:M,children:M},M))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Titre personnalis"}),t.jsx("input",{className:"form-input",placeholder:`Ex: Maths 3me A - ${x.anneeScolaire}`,value:x.titre,onChange:M=>j(T=>({...T,titre:M.target.value}))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Nombre de sances prvues"}),t.jsx("input",{type:"number",className:"form-input",min:"1",max:"200",value:x.nombreSeancesPrevu,onChange:M=>j(T=>({...T,nombreSeancesPrevu:Number(M.target.value)}))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Description / Objectifs (optionnel)"}),t.jsx("textarea",{className:"form-textarea",placeholder:"Objectifs gnraux, groupe classe, notes...",value:x.description,onChange:M=>j(T=>({...T,description:M.target.value})),rows:2})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Couleur du cahier"}),t.jsx("div",{className:"couleur-picker",children:U5.map(M=>t.jsx("div",{className:`couleur-option ${x.couleur===M?"selected":""}`,style:{background:M},onClick:()=>j(T=>({...T,couleur:M})),title:M},M))})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{className:"form-label",children:["Groupes classes lis"," ",t.jsx("span",{style:{fontWeight:400,color:"#9ca3af"},children:"(optionnel)"})]}),O.length===0?t.jsxs("p",{style:{fontSize:"0.82rem",color:"#9ca3af",margin:0},children:["Aucun groupe cr."," ",t.jsx("button",{type:"button",style:{background:"none",border:"none",color:"#2563eb",cursor:"pointer",padding:0,fontSize:"0.82rem"},onClick:()=>r("/prof/groupes"),children:"Crer un groupe "})]}):t.jsx("div",{className:"groupe-selector",children:O.map(M=>{const T=P.includes(M.id);return t.jsxs("div",{className:`groupe-option ${T?"selected":""}`,onClick:()=>$(M.id),children:[t.jsx("input",{type:"checkbox",checked:T,readOnly:!0,tabIndex:-1}),t.jsxs("span",{children:[t.jsx("strong",{children:M.nom}),"  ",M.classe," (",M.anneeScolaire,")"]})]},M.id)})}),P.length>0&&t.jsx("div",{className:"groupes-tags",children:P.map(M=>{const T=O.find(F=>F.id===M);return T?t.jsxs("span",{className:"groupe-tag",children:[T.nom,t.jsx("button",{type:"button",onClick:()=>$(M),"aria-label":`Retirer ${T.nom}`,children:""})]},M):null})}),P.length>0&&t.jsxs("label",{className:"toggle-partage",style:{marginTop:10},children:[t.jsx("input",{type:"checkbox",checked:x.isPartage??!1,onChange:M=>j(T=>({...T,isPartage:M.target.checked}))}),t.jsx("span",{children:" Rendre visible aux lves des groupes lis"})]})]}),w&&t.jsx("div",{style:{color:"#dc2626",fontSize:"0.85rem",marginBottom:"0.75rem",background:"#fee2e2",padding:"0.5rem 0.75rem",borderRadius:8},children:w}),t.jsxs("div",{className:"modal-footer",children:[t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>h(!1),children:"Annuler"}),t.jsx("button",{type:"submit",className:"btn-primary",disabled:_,children:_?"Enregistrement...":v?"Mettre  jour":"Crer le cahier"})]})]})]})})]})},aJ=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],iJ=["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],sJ=(e,r,n)=>{const a=new Date(e,r,1),l=new Date(e,r+1,0);let o=a.getDay()-1;o<0&&(o=6);const u=new Date,d=[];for(let p=o-1;p>=0;p--){const h=new Date(e,r,-p);d.push({date:h,isCurrentMonth:!1,isToday:!1,entrees:[]})}for(let p=1;p<=l.getDate();p++){const h=new Date(e,r,p),v=h.toDateString()===u.toDateString(),b=n.filter(x=>{const j=x.date.toDate();return j.getFullYear()===e&&j.getMonth()===r&&j.getDate()===p});d.push({date:h,isCurrentMonth:!0,isToday:v,entrees:b})}let f=1;for(;d.length<42;){const p=new Date(e,r+1,f++);d.push({date:p,isCurrentMonth:!1,isToday:!1,entrees:[]})}return d},lJ=({cahierId:e})=>{const r=Je(),n=new Date,[a,l]=g.useState(n.getFullYear()),[o,u]=g.useState(n.getMonth()),[d,f]=g.useState([]),[p,h]=g.useState(!1),[v,b]=g.useState(null),[x,j]=g.useState({x:0,y:0});g.useEffect(()=>{(async()=>{h(!0);try{const A=await XZ(e,a,o);f(A)}catch(A){console.error("Erreur chargement entres calendrier:",A)}finally{h(!1)}})()},[e,a,o]);const _=sJ(a,o,d),C=()=>{o===0?(l(S=>S-1),u(11)):u(S=>S-1)},w=()=>{o===11?(l(S=>S+1),u(0)):u(S=>S+1)},E=(S,A)=>{if(!S.isCurrentMonth||S.entrees.length===0)return;const O=A.target.getBoundingClientRect();j({x:O.left,y:O.bottom+window.scrollY+8}),b(S)};return t.jsxs("div",{className:"cahier-calendar",onClick:()=>b(null),children:[t.jsxs("div",{className:"calendar-nav",children:[t.jsx("button",{className:"calendar-nav-btn",onClick:C,"aria-label":"Mois prcdent",children:""}),t.jsxs("span",{className:"calendar-nav-title",children:[iJ[o]," ",a,p&&" ..."]}),t.jsx("button",{className:"calendar-nav-btn",onClick:w,"aria-label":"Mois suivant",children:""})]}),t.jsx("div",{className:"calendar-weekdays",children:aJ.map(S=>t.jsx("div",{className:"calendar-weekday",children:S},S))}),t.jsx("div",{className:"calendar-grid",onClick:S=>S.stopPropagation(),children:_.map((S,A)=>t.jsxs("div",{className:`calendar-day ${S.isCurrentMonth?"":"other-month"} ${S.isToday?"today":""} ${v?.date.toDateString()===S.date.toDateString()?"selected":""}`,onClick:O=>E(S,O),children:[t.jsx("div",{className:"calendar-day-num",children:S.date.getDate()}),t.jsxs("div",{className:"calendar-day-events",children:[S.entrees.slice(0,3).map(O=>{const k=Wi[O.typeContenu];return t.jsxs("div",{className:"calendar-event-dot",style:{background:k.color},title:O.chapitre,children:[k.emoji," ",O.chapitre.substring(0,12)]},O.id)}),S.entrees.length>3&&t.jsxs("div",{className:"calendar-more",children:["+",S.entrees.length-3]})]})]},A))}),t.jsx("div",{className:"calendar-legend",children:Object.entries(Wi).slice(0,5).map(([S,A])=>t.jsxs("div",{className:"legend-item",children:[t.jsx("div",{className:"legend-dot",style:{background:A.color}}),A.label]},S))}),v&&v.entrees.length>0&&t.jsxs("div",{className:"calendar-day-popup",style:{top:x.y,left:Math.min(x.x,window.innerWidth-300)},onClick:S=>S.stopPropagation(),children:[t.jsxs("div",{className:"calendar-day-popup-title",children:[" ",v.date.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"})]}),v.entrees.map(S=>{const A=Wi[S.typeContenu];return t.jsxs("div",{className:"calendar-popup-entree",onClick:()=>r(`/prof/cahiers/${e}/modifier/${S.id}`),children:[t.jsx("span",{className:"calendar-popup-entree-type",children:A.emoji}),t.jsxs("div",{className:"calendar-popup-entree-info",children:[t.jsx("div",{className:"calendar-popup-entree-chapitre",children:S.chapitre}),S.heureDebut&&t.jsxs("div",{className:"calendar-popup-entree-heure",children:[S.heureDebut,S.heureFin?`  ${S.heureFin}`:""]})]})]},S.id)})]})]})},yp="rappels_prof",oJ=async(e,r)=>(await Pt(_e(Q,yp),{profId:e,titre:r.titre,description:r.description||"",typeRappel:r.typeRappel,dateRappel:Ae.fromDate(new Date(r.dateRappel)),recurrence:r.recurrence,priorite:r.priorite,cahierId:r.cahierId||null,isLu:!1,isDone:!1,createdAt:Ae.now()})).id,cJ=async e=>{const r=Ee(_e(Q,yp),Ne("profId","==",e),Ne("isDone","==",!1),Ve("dateRappel","asc"));return(await Ce(r)).docs.map(a=>({id:a.id,...a.data()}))},uJ=async(e,r)=>{await He(je(Q,yp,e),{isDone:r,isLu:r})},dJ=async e=>{await Br(je(Q,yp,e))},XE=()=>({titre:"",description:"",typeRappel:"personnalise",dateRappel:new Date(Date.now()+36e5).toISOString().slice(0,16),recurrence:"unique",priorite:"normale"}),sm=({profId:e,cahierId:r})=>{const[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(!1),[f,p]=g.useState(XE()),[h,v]=g.useState(!1),b=async()=>{try{o(!0);const S=await cJ(e);a(S)}catch(S){console.error("Erreur rappels:",S)}finally{o(!1)}};g.useEffect(()=>{b()},[e]);const x=async S=>{if(S.preventDefault(),!!f.titre.trim()){v(!0);try{await oJ(e,{...f,cahierId:r}),d(!1),p(XE()),await b()}catch(A){console.error("Erreur cration rappel:",A)}finally{v(!1)}}},j=async S=>{await uJ(S,!0),a(A=>A.filter(O=>O.id!==S))},_=async S=>{confirm("Supprimer ce rappel ?")&&(await dJ(S),a(A=>A.filter(O=>O.id!==S)))},C=new Date,w=n.filter(S=>S.dateRappel.toDate()<=C),E=n.filter(S=>S.dateRappel.toDate()>C);return t.jsxs("div",{style:{background:"white",borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",overflow:"hidden"},children:[t.jsxs("div",{style:{padding:"1rem 1.25rem",borderBottom:"1px solid #f3f4f6",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[t.jsx("span",{style:{fontSize:"1.1rem"},children:""}),t.jsx("span",{style:{fontWeight:700,fontSize:"0.95rem",color:"#1f2937"},children:"Rappels"}),w.length>0&&t.jsx("span",{style:{background:"#dc2626",color:"white",borderRadius:20,padding:"1px 7px",fontSize:"0.7rem",fontWeight:700},children:w.length})]}),t.jsx("button",{className:"btn-primary",style:{padding:"0.35rem 0.75rem",fontSize:"0.8rem"},onClick:()=>d(S=>!S),children:"+ Ajouter"})]}),u&&t.jsxs("form",{onSubmit:x,style:{padding:"1rem 1.25rem",borderBottom:"1px solid #f3f4f6",background:"#f9fafb"},children:[t.jsx("div",{className:"form-group",children:t.jsx("input",{className:"form-input",placeholder:"Titre du rappel *",value:f.titre,onChange:S=>p(A=>({...A,titre:S.target.value})),required:!0})}),t.jsx("div",{className:"form-group",children:t.jsx("select",{className:"form-select",value:f.typeRappel,onChange:S=>p(A=>({...A,typeRappel:S.target.value})),children:Object.entries(qA).map(([S,A])=>t.jsxs("option",{value:S,children:[A.emoji," ",A.label]},S))})}),t.jsx("div",{className:"form-group",children:t.jsx("input",{type:"datetime-local",className:"form-input",value:f.dateRappel,onChange:S=>p(A=>({...A,dateRappel:S.target.value})),required:!0})}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsxs("select",{className:"form-select",value:f.priorite,onChange:S=>p(A=>({...A,priorite:S.target.value})),children:[t.jsx("option",{value:"normale",children:"Normale"}),t.jsx("option",{value:"urgente",children:" Urgente"})]}),t.jsxs("select",{className:"form-select",value:f.recurrence,onChange:S=>p(A=>({...A,recurrence:S.target.value})),children:[t.jsx("option",{value:"unique",children:"Une fois"}),t.jsx("option",{value:"hebdomadaire",children:"Hebdo"})]})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.75rem"},children:[t.jsx("button",{type:"submit",className:"btn-primary",disabled:h,style:{flex:1},children:h?"...":"Enregistrer"}),t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>d(!1),children:"Annuler"})]})]}),t.jsx("div",{style:{padding:"0.75rem 1.25rem"},children:l?t.jsx("div",{style:{textAlign:"center",color:"#9ca3af",padding:"1rem",fontSize:"0.85rem"},children:"Chargement..."}):n.length===0?t.jsxs("div",{style:{textAlign:"center",color:"#9ca3af",padding:"1rem",fontSize:"0.85rem"},children:[t.jsx("div",{children:""}),t.jsx("div",{children:"Aucun rappel actif"})]}):t.jsxs(t.Fragment,{children:[w.length>0&&t.jsxs("div",{style:{marginBottom:"0.75rem"},children:[t.jsx("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"#dc2626",textTransform:"uppercase",marginBottom:"0.4rem"},children:" En retard"}),w.map(S=>t.jsx(ZE,{rappel:S,onDone:j,onDelete:_},S.id))]}),E.length>0&&t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"0.7rem",fontWeight:700,color:"#6b7280",textTransform:"uppercase",marginBottom:"0.4rem"},children:" venir"}),E.slice(0,5).map(S=>t.jsx(ZE,{rappel:S,onDone:j,onDelete:_},S.id))]})]})})]})},ZE=({rappel:e,onDone:r,onDelete:n})=>{const a=qA[e.typeRappel],l=e.dateRappel.toDate(),o=e.priorite==="urgente",u=l<=new Date;return t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"0.5rem",padding:"0.5rem 0",borderBottom:"1px solid #f9fafb"},children:[t.jsx("button",{onClick:()=>r(e.id),style:{width:20,height:20,border:`2px solid ${o?"#dc2626":"#d1d5db"}`,borderRadius:4,background:"white",cursor:"pointer",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center",marginTop:2},title:"Marquer termin"}),t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsxs("div",{style:{fontSize:"0.82rem",fontWeight:600,color:u?"#dc2626":"#1f2937",display:"flex",alignItems:"center",gap:"0.3rem"},children:[a.emoji," ",e.titre,o&&t.jsx("span",{style:{fontSize:"0.65rem",color:"#dc2626"},children:""})]}),t.jsxs("div",{style:{fontSize:"0.72rem",color:"#9ca3af",marginTop:2},children:[l.toLocaleDateString("fr-FR",{day:"numeric",month:"short"}),"  ",l.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]}),t.jsx("button",{onClick:()=>n(e.id),style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af",fontSize:"0.9rem",flexShrink:0},title:"Supprimer",children:""})]})},mJ=({profId:e,cahierId:r})=>{const n=Je(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,f]=g.useState("tous");g.useEffect(()=>{(async()=>{u(!0);try{const x=await ZZ(e,r);l(x)}catch(x){console.error("Erreur signets:",x)}finally{u(!1)}})()},[e,r]);const p=async(b,x)=>{try{await Lc(b.id,{statutEvaluation:x}),l(j=>j.map(_=>_.id===b.id?{..._,statutEvaluation:x}:_))}catch(j){console.error("Erreur mise  jour statut:",j)}},h=d==="tous"?a:a.filter(b=>b.statutEvaluation===d),v=[{value:"tous",label:"Tous",color:"#6b7280"},{value:"a_evaluer",label:" valuer",color:"#d97706"},{value:"evaluation_creee",label:"Cre",color:"#2563eb"},{value:"evaluation_terminee",label:"Termine",color:"#059669"}];return t.jsxs("div",{children:[t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem",flexWrap:"wrap",gap:"0.5rem"},children:t.jsxs("h3",{style:{fontSize:"1.1rem",fontWeight:700,color:"#1f2937",margin:0},children:[" Signets d'valuation (",a.length,")"]})}),t.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.25rem",flexWrap:"wrap"},children:v.map(b=>t.jsx("button",{onClick:()=>f(b.value),style:{padding:"0.3rem 0.85rem",borderRadius:20,border:`1.5px solid ${d===b.value?b.color:"#e5e7eb"}`,background:d===b.value?b.color:"white",color:d===b.value?"white":"#4b5563",fontSize:"0.8rem",fontWeight:600,cursor:"pointer",transition:"all 0.15s"},children:b.label},b.value))}),o?t.jsx("div",{style:{textAlign:"center",color:"#9ca3af",padding:"2rem"},children:"Chargement..."}):h.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"2.5rem",color:"#9ca3af"},children:[t.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:""}),t.jsx("div",{style:{fontWeight:600,color:"#6b7280",marginBottom:"0.25rem"},children:"Aucun signet trouv"}),t.jsx("div",{style:{fontSize:"0.85rem"},children:"Marquez des entres pour valuation depuis l'diteur de sance."})]}):t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:h.map(b=>{const x=Wi[b.typeContenu];return Rc[b.statut],t.jsxs("div",{style:{background:"white",borderRadius:10,boxShadow:"0 2px 8px rgba(0,0,0,0.07)",padding:"1rem",borderLeft:"4px solid #f59e0b"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:"0.5rem",marginBottom:"0.5rem"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"0.9rem",fontWeight:700,color:"#1f2937"},children:b.chapitre}),t.jsx("div",{style:{fontSize:"0.78rem",color:"#9ca3af",marginTop:"0.15rem"},children:b.date.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})})]}),t.jsx("button",{onClick:()=>n(`/prof/cahiers/${r}/modifier/${b.id}`),style:{background:"none",border:"none",cursor:"pointer",color:"#2563eb",fontSize:"0.8rem",fontWeight:600,whiteSpace:"nowrap"},children:" Modifier"})]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.75rem"},children:[t.jsxs("span",{style:{padding:"0.15rem 0.6rem",borderRadius:20,fontSize:"0.72rem",fontWeight:600,background:x.color+"22",color:x.color},children:[x.emoji," ",x.label]}),b.typeEvaluation&&t.jsxs("span",{style:{padding:"0.15rem 0.6rem",borderRadius:20,fontSize:"0.72rem",fontWeight:600,background:"#fef3c7",color:"#92400e"},children:[" ",TA[b.typeEvaluation]]}),b.dateEvaluationPrevue&&t.jsxs("span",{style:{padding:"0.15rem 0.6rem",borderRadius:20,fontSize:"0.72rem",background:"#f3f4f6",color:"#4b5563"},children:[" ",b.dateEvaluationPrevue.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"short"})]})]}),t.jsx("div",{style:{display:"flex",gap:"0.4rem",flexWrap:"wrap"},children:["a_evaluer","evaluation_creee","evaluation_terminee"].map(j=>{const _=b.statutEvaluation===j,C={a_evaluer:" valuer",evaluation_creee:"Cre",evaluation_terminee:" Termine"},w={a_evaluer:"#d97706",evaluation_creee:"#2563eb",evaluation_terminee:"#059669"};return t.jsx("button",{onClick:()=>p(b,j),style:{padding:"0.25rem 0.7rem",borderRadius:20,border:`1.5px solid ${_?w[j]:"#e5e7eb"}`,background:_?w[j]:"white",color:_?"white":"#6b7280",fontSize:"0.72rem",fontWeight:600,cursor:"pointer"},children:C[j]},j)})})]},b.id)})})]})},fJ=({cahier:e})=>{const[r,n]=g.useState(null),[a,l]=g.useState(!0);g.useEffect(()=>{(async()=>{try{const d=await JZ(e.id);n(d)}catch{}finally{l(!1)}})()},[e.id]);const o=e.nombreSeancesPrevu>0?Math.min(100,Math.round(e.nombreSeancesRealise/e.nombreSeancesPrevu*100)):0;return a?t.jsx("div",{style:{padding:"1rem",textAlign:"center",color:"#9ca3af",fontSize:"0.85rem"},children:"Chargement des stats..."}):r?t.jsxs("div",{style:{background:"white",borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",padding:"1.25rem"},children:[t.jsx("div",{style:{fontWeight:700,fontSize:"0.95rem",color:"#1f2937",marginBottom:"1.25rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:" Statistiques du cahier"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem",marginBottom:"1.25rem"},children:[t.jsx(lm,{value:r.total,label:"Sances total",color:"#2563eb",bg:"#dbeafe"}),t.jsx(lm,{value:r.realise,label:"Ralises",color:"#059669",bg:"#d1fae5"}),t.jsx(lm,{value:r.planifie,label:"Planifies",color:"#d97706",bg:"#fef3c7"}),t.jsx(lm,{value:`${r.tauxRealisation}%`,label:"Taux de ralisation",color:"#7c3aed",bg:"#ede9fe"})]}),t.jsxs("div",{style:{marginBottom:"1.25rem"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.4rem"},children:[t.jsx("span",{children:"Progression du programme"}),t.jsxs("span",{style:{fontWeight:700,color:e.couleur},children:[o,"%"]})]}),t.jsx("div",{style:{height:8,background:"#e5e7eb",borderRadius:10,overflow:"hidden"},children:t.jsx("div",{style:{height:"100%",width:`${o}%`,background:e.couleur,borderRadius:10,transition:"width 0.5s ease"}})}),t.jsxs("div",{style:{fontSize:"0.75rem",color:"#9ca3af",marginTop:"0.3rem"},children:[e.nombreSeancesRealise," / ",e.nombreSeancesPrevu," sances prvues"]})]}),Object.keys(r.parType).length>0&&t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"0.78rem",fontWeight:700,color:"#9ca3af",textTransform:"uppercase",marginBottom:"0.6rem"},children:"Rpartition par type"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.4rem"},children:Object.entries(r.parType).sort((u,d)=>d[1]-u[1]).map(([u,d])=>{const f=Wi[u];if(!f)return null;const p=r.total>0?Math.round(d/r.total*100):0;return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.78rem",color:"#4b5563",marginBottom:"0.2rem"},children:[t.jsxs("span",{children:[f.emoji," ",f.label]}),t.jsxs("span",{style:{fontWeight:600},children:[d," (",p,"%)"]})]}),t.jsx("div",{style:{height:4,background:"#f3f4f6",borderRadius:10,overflow:"hidden"},children:t.jsx("div",{style:{height:"100%",width:`${p}%`,background:f.color,borderRadius:10}})})]},u)})})]})]}):null},lm=({value:e,label:r,color:n,bg:a})=>t.jsxs("div",{style:{background:a,borderRadius:10,padding:"0.75rem",textAlign:"center"},children:[t.jsx("div",{style:{fontSize:"1.5rem",fontWeight:800,color:n},children:e}),t.jsx("div",{style:{fontSize:"0.72rem",color:"#6b7280",marginTop:"0.15rem"},children:r})]});function JE(e){const r=new Date(e),n=r.getDay(),a=n===0?-6:1-n;return r.setDate(r.getDate()+a),r.setHours(0,0,0,0),r}function pJ(e){const r=new Date(e);return r.setDate(r.getDate()+6),r}function eA(e){const r=new Date(e),n=pJ(r),a={day:"numeric",month:"short"};return`${r.toLocaleDateString("fr-FR",a)}  ${n.toLocaleDateString("fr-FR",a)}`}function tA(e){const[r,n]=e.split("-");return new Date(Number(r),Number(n)-1).toLocaleDateString("fr-FR",{month:"long",year:"numeric"})}const hJ=()=>{const{cahierId:e}=xn(),{currentUser:r}=Ke(),n=Je(),[a,l]=g.useState(null),[o,u]=g.useState([]),[d,f]=g.useState(!0),[p,h]=g.useState(!0),[v,b]=g.useState("liste"),[x,j]=g.useState("tous"),[_,C]=g.useState("tous"),[w,E]=g.useState("tous"),[S,A]=g.useState(null),[O,k]=g.useState("asc"),[P,D]=g.useState(!0),[B,U]=g.useState(!1);g.useEffect(()=>{Et(je(Q,"settings","platform")).then(L=>{if(L.exists()){const ne=L.data();D(ne.cahierPdfExport!==!1)}}).catch(()=>{})},[]),g.useEffect(()=>{if(!e)return;(async()=>{f(!0);try{const ne=await fM(e);if(!ne){n("/prof/cahiers");return}l(ne)}finally{f(!1)}})()},[e,n]);const $=g.useCallback(async()=>{if(e){h(!0);try{const L=await pM(e);u(L)}finally{h(!1)}}},[e]);g.useEffect(()=>{$()},[$]);const R=async L=>{if(confirm(`Supprimer la sance "${L.chapitre}" ?`))try{await rJ(L.id);const ne=o.filter(oe=>oe.id!==L.id);u(ne);const K=ne.filter(oe=>oe.statut==="realise").length;await xf(e,{nombreSeancesRealise:K}),l(oe=>oe&&{...oe,nombreSeancesRealise:K})}catch{alert("Erreur lors de la suppression.")}},Y=async(L,ne)=>{try{await Lc(L.id,{statut:ne});const K=o.map(xe=>xe.id===L.id?{...xe,statut:ne}:xe);u(K);const oe=K.filter(xe=>xe.statut==="realise").length;await xf(e,{nombreSeancesRealise:oe}),l(xe=>xe&&{...xe,nombreSeancesRealise:oe})}catch{alert("Erreur mise  jour statut.")}},ae=g.useCallback(()=>{U(!0),setTimeout(()=>{window.print(),U(!1)},100)},[]),M=g.useMemo(()=>Array.from(new Set(o.map(L=>{const ne=L.date.toDate();return`${ne.getFullYear()}-${String(ne.getMonth()+1).padStart(2,"0")}`}))).sort(),[o]),T=g.useMemo(()=>{const L=w==="tous"?o:o.filter(K=>{const oe=K.date.toDate();return`${oe.getFullYear()}-${String(oe.getMonth()+1).padStart(2,"0")}`===w}),ne=new Map;return L.forEach(K=>{const xe=JE(K.date.toDate()).toISOString().slice(0,10);ne.set(xe,(ne.get(xe)||0)+1)}),Array.from(ne.entries()).sort(([K],[oe])=>K.localeCompare(oe)).map(([K,oe])=>({start:K,count:oe}))},[o,w]),F=g.useMemo(()=>{const L=new Map;return o.forEach(ne=>{const K=ne.date.toDate(),oe=`${K.getFullYear()}-${String(K.getMonth()+1).padStart(2,"0")}`;L.set(oe,(L.get(oe)||0)+1)}),L},[o]),I=g.useMemo(()=>o.filter(L=>{const ne=L.date.toDate(),K=x==="tous"||L.statut===x,oe=_==="tous"||L.typeContenu===_;let xe=!0;w!=="tous"&&(xe=`${ne.getFullYear()}-${String(ne.getMonth()+1).padStart(2,"0")}`===w);let ve=!0;return S&&(ve=JE(ne).toISOString().slice(0,10)===S),K&&oe&&xe&&ve}).sort((L,ne)=>{const K=L.date.toMillis()-ne.date.toMillis();return O==="asc"?K:-K}),[o,x,_,w,S,O]);if(d)return t.jsx("div",{className:"loading-spinner",children:t.jsx("div",{className:"spinner-circle"})});if(!a)return null;const X=a.nombreSeancesPrevu>0?Math.round(o.filter(L=>L.statut==="realise").length/a.nombreSeancesPrevu*100):0;return t.jsxs("div",{className:"cahier-detail-page",id:"cahier-detail-print-zone",children:[t.jsxs("div",{className:"cahier-detail-header",children:[t.jsx("button",{className:"btn-retour no-print",onClick:()=>n("/prof/cahiers"),title:"Retour  la liste",children:" Retour"}),t.jsx("div",{className:"cahier-detail-couleur-barre",style:{background:a.couleur}}),t.jsxs("div",{className:"cahier-detail-info",children:[t.jsx("h1",{className:"cahier-detail-titre",children:a.titre}),t.jsxs("div",{className:"cahier-detail-badges",children:[t.jsx("span",{className:"badge-classe",children:a.classe}),t.jsx("span",{className:"badge-matiere",children:a.matiere}),t.jsx("span",{className:"badge-annee",children:a.anneeScolaire}),a.isPartage&&t.jsx("span",{className:"badge-partage",children:" Partag"})]}),a.description&&t.jsx("p",{className:"cahier-detail-description",children:a.description}),t.jsxs("div",{className:"cahier-detail-progression",children:[t.jsx("div",{className:"progression-bar-bg",style:{width:200},children:t.jsx("div",{className:"progression-bar-fill",style:{width:`${X}%`,background:a.couleur}})}),t.jsxs("span",{className:"progression-pct",children:[o.filter(L=>L.statut==="realise").length," / ",a.nombreSeancesPrevu," sances (",X,"%)"]})]})]}),t.jsxs("div",{className:"cahier-detail-actions no-print",children:[P&&t.jsxs("button",{className:"btn-pdf",onClick:ae,disabled:B,title:"Tlcharger en PDF",children:[B?"":""," PDF"]}),t.jsx("button",{className:"btn-primary",onClick:()=>n(`/prof/cahiers/${e}/nouvelle`),children:"+ Nouvelle sance"})]})]}),t.jsx("div",{className:"view-tabs no-print",children:[{id:"liste",label:" Liste"},{id:"calendrier",label:" Calendrier"},{id:"signets",label:" Signets"},{id:"stats",label:" Statistiques"}].map(L=>t.jsx("button",{className:`view-tab ${v===L.id?"active":""}`,onClick:()=>b(L.id),children:L.label},L.id))}),v==="calendrier"&&t.jsxs("div",{className:"cahier-detail-layout",children:[t.jsx("div",{children:t.jsx(lJ,{cahierId:a.id})}),t.jsx("div",{children:t.jsx(sm,{profId:r.uid,cahierId:a.id})})]}),v==="signets"&&t.jsxs("div",{className:"cahier-detail-layout",children:[t.jsx(mJ,{profId:r.uid,cahierId:a.id}),t.jsx(sm,{profId:r.uid,cahierId:a.id})]}),v==="stats"&&t.jsxs("div",{className:"cahier-detail-layout",children:[t.jsx(fJ,{cahier:{...a,nombreSeancesRealise:o.filter(L=>L.statut==="realise").length}}),t.jsx(sm,{profId:r.uid,cahierId:a.id})]}),v==="liste"&&t.jsxs("div",{className:"cahier-three-col-layout",children:[t.jsxs("aside",{className:"cahier-nav-sidebar no-print",children:[t.jsxs("div",{className:"nav-sidebar-header",children:[t.jsx("span",{className:"nav-sidebar-icon",children:""}),t.jsx("span",{className:"nav-sidebar-title",children:"Navigation"})]}),t.jsxs("button",{className:`nav-month-item ${w==="tous"?"active":""}`,onClick:()=>{E("tous"),A(null)},children:[t.jsx("span",{children:"Tout afficher"}),t.jsx("span",{className:"nav-count-badge",children:o.length})]}),M.length>0&&t.jsx("div",{className:"nav-months-list",children:M.map(L=>t.jsxs("button",{className:`nav-month-item ${w===L?"active":""}`,onClick:()=>{E(L),A(null)},children:[t.jsx("span",{className:"nav-month-label",children:tA(L)}),t.jsx("span",{className:"nav-count-badge",children:F.get(L)||0})]},L))}),w!=="tous"&&T.length>0&&t.jsxs("div",{className:"nav-weeks-section",children:[t.jsx("div",{className:"nav-weeks-header",children:"Semaines"}),t.jsxs("button",{className:`nav-week-item ${S===null?"active":""}`,onClick:()=>A(null),children:[t.jsx("span",{children:"Tout le mois"}),t.jsx("span",{className:"nav-count-badge nav-count-badge--sm",children:F.get(w)||0})]}),T.map(L=>t.jsxs("button",{className:`nav-week-item ${S===L.start?"active":""}`,onClick:()=>A(L.start),children:[t.jsx("span",{className:"nav-week-label",children:eA(L.start)}),t.jsx("span",{className:"nav-count-badge nav-count-badge--sm",children:L.count})]},L.start))]}),o.length===0&&t.jsx("p",{className:"nav-sidebar-empty",children:"Aucune sance pour l'instant"})]}),t.jsxs("div",{className:"cahier-content-col",children:[t.jsxs("div",{className:"entrees-controls no-print",children:[t.jsx("div",{className:"entrees-statut-filters",children:["tous","realise","planifie","annule","reporte"].map(L=>{const ne=L==="tous"?null:Rc[L];return t.jsx("button",{className:`statut-chip ${x===L?"active":""}`,style:x===L&&ne?{borderColor:ne.color,background:ne.bg,color:ne.color}:{},onClick:()=>j(L),children:L==="tous"?"Tous":ne?.label},L)})}),t.jsxs("div",{className:"entrees-right-controls",children:[t.jsxs("select",{className:"filtre-select",value:_,onChange:L=>C(L.target.value),children:[t.jsx("option",{value:"tous",children:"Tous types"}),Object.entries(Wi).map(([L,ne])=>t.jsxs("option",{value:L,children:[ne.emoji," ",ne.label]},L))]}),t.jsx("button",{className:"btn-sort",onClick:()=>k(L=>L==="asc"?"desc":"asc"),title:O==="asc"?"Ordre croissant (cliquer pour inverser)":"Ordre dcroissant (cliquer pour inverser)",children:O==="asc"?" Plus ancien":" Plus rcent"})]})]}),(w!=="tous"||S||x!=="tous"||_!=="tous")&&t.jsxs("div",{className:"filtre-actif-bar no-print",children:[t.jsxs("span",{className:"filtre-actif-label",children:[I.length," sance",I.length!==1?"s":"",S?`  Semaine du ${eA(S)}`:"",w!=="tous"&&!S?`  ${tA(w)}`:""]}),t.jsx("button",{className:"filtre-actif-reset",onClick:()=>{j("tous"),C("tous"),E("tous"),A(null)},children:" Rinitialiser"})]}),p&&I.length===0?t.jsx("div",{className:"loading-spinner",children:t.jsx("div",{className:"spinner-circle"})}):I.length===0?t.jsxs("div",{className:"empty-state",children:[t.jsx("div",{style:{fontSize:"2.5rem",opacity:.3,marginBottom:"0.5rem"},children:""}),t.jsx("h3",{children:x!=="tous"||_!=="tous"||w!=="tous"?"Aucune sance correspondant aux filtres":"Aucune sance pour l'instant"}),x==="tous"&&_==="tous"&&w==="tous"&&t.jsx("button",{className:"btn-primary",onClick:()=>n(`/prof/cahiers/${e}/nouvelle`),style:{marginTop:"1rem"},children:"+ Ajouter la premire sance"})]}):t.jsx("div",{className:"entrees-list",children:I.map((L,ne)=>{const K=Wi[L.typeContenu],oe=Rc[L.statut],xe=L.date.toDate();return t.jsxs("div",{className:"entree-card",style:{borderLeftColor:K.color},onClick:()=>n(`/prof/cahiers/${e}/modifier/${L.id}`),children:[t.jsx("div",{className:"entree-num",children:t.jsx("span",{style:{background:K.color},children:O==="asc"?ne+1:I.length-ne})}),t.jsxs("div",{className:"entree-card-inner",children:[t.jsxs("div",{className:"entree-card-top",children:[t.jsxs("div",{className:"entree-card-gauche",children:[t.jsxs("div",{className:"entree-date",children:[" ",xe.toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),L.heureDebut&&t.jsxs("span",{className:"entree-heure",children:[" ",L.heureDebut,L.heureFin?`  ${L.heureFin}`:""]})]}),t.jsx("h3",{className:"entree-chapitre",children:L.chapitre}),t.jsxs("div",{className:"entree-badges",children:[t.jsxs("span",{className:"entree-type-badge",style:{background:K.color},children:[K.emoji," ",K.label]}),t.jsx("span",{className:"entree-statut-badge",style:{background:oe.bg,color:oe.color},children:oe.label}),L.isMarqueEvaluation&&t.jsx("span",{className:"signet-badge",children:" valuation"}),L.piecesJointes&&L.piecesJointes.length>0&&t.jsxs("span",{className:"badge-pj",children:[" ",L.piecesJointes.length]})]})]}),t.jsxs("div",{className:"entree-actions no-print",children:[t.jsx("button",{className:"btn-icon",onClick:ve=>{ve.stopPropagation(),n(`/prof/cahiers/${e}/modifier/${L.id}`)},title:"Modifier",children:""}),t.jsx("button",{className:"btn-icon btn-icon--danger",onClick:ve=>{ve.stopPropagation(),R(L)},title:"Supprimer",children:""})]})]}),L.contenu&&t.jsx("div",{className:"entree-contenu-preview",dangerouslySetInnerHTML:{__html:L.contenu}}),L.objectifs&&t.jsxs("div",{className:"entree-objectifs",children:[" ",t.jsx("em",{children:L.objectifs})]}),t.jsxs("div",{className:"entree-card-footer no-print",children:[t.jsx("div",{className:"entree-statuts-rapides",children:["realise","planifie","annule"].map(ve=>{const H=Rc[ve],he=L.statut===ve;return t.jsx("button",{className:`statut-quick-btn ${he?"active":""}`,style:he?{borderColor:H.color,background:H.bg,color:H.color}:{},onClick:Me=>{Me.stopPropagation(),Y(L,ve)},children:H.label},ve)})}),L.notesPrivees&&t.jsx("span",{className:"entree-has-notes",title:"Contient des notes prives",children:" Notes prives"})]})]})]},L.id)})})]}),t.jsx("div",{className:"cahier-sidebar-right no-print",children:t.jsx(sm,{profId:r.uid,cahierId:a.id})})]})]})};function vJ(e){return{video:"",article:"",exercice:"",autre:""}[e]??""}function gJ(e){const r=/(?:youtube\.com\/watch\?v=|youtu\.be\/)([A-Za-z0-9_\-]{11})/,n=e.match(r);return n?n[1]:null}const xJ=({onAjouter:e,onAnnuler:r})=>{const[n,a]=g.useState(""),[l,o]=g.useState(""),[u,d]=g.useState("article"),[f,p]=g.useState(""),[h,v]=g.useState("");function b(j){o(j),(j.includes("youtube.com")||j.includes("youtu.be"))&&d("video")}function x(){if(!n.trim()){v("Le titre est requis.");return}if(!l.trim()||!l.startsWith("http://")&&!l.startsWith("https://")){v("Entrez une URL valide commenant par https://");return}const j={id:String(Date.now()),titre:n.trim(),url:l.trim(),type:u,description:f.trim()||void 0};e(j)}return t.jsxs("div",{className:"lien-form",children:[t.jsx("input",{type:"text",placeholder:"Titre du lien *",value:n,onChange:j=>a(j.target.value),"aria-label":"Titre du lien"}),t.jsx("input",{type:"url",placeholder:"https://... *",value:l,onChange:j=>b(j.target.value),"aria-label":"URL du lien"}),t.jsxs("select",{value:u,onChange:j=>d(j.target.value),"aria-label":"Type de lien",children:[t.jsx("option",{value:"article",children:" Article"}),t.jsx("option",{value:"video",children:" Vido"}),t.jsx("option",{value:"exercice",children:" Exercice"}),t.jsx("option",{value:"autre",children:" Autre"})]}),t.jsx("textarea",{placeholder:"Description (optionnelle)",value:f,onChange:j=>p(j.target.value),rows:2,"aria-label":"Description du lien"}),h&&t.jsx("p",{style:{color:"#dc2626",fontSize:"0.8rem",margin:0},children:h}),t.jsxs("div",{className:"lien-form-actions",children:[t.jsx("button",{className:"btn-secondary",onClick:r,type:"button",children:"Annuler"}),t.jsx("button",{className:"btn-pedaclic",onClick:x,type:"button",children:" Ajouter"})]})]})},bJ=({videoId:e})=>t.jsx("div",{className:"youtube-embed",children:t.jsx("iframe",{src:`https://www.youtube.com/embed/${e}`,title:"Vido YouTube",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy"})}),vM=({liens:e,onChange:r,readonly:n=!1})=>{const[a,l]=g.useState(!1);function o(d){r([...e,d]),l(!1)}function u(d){r(e.filter(f=>f.id!==d))}return t.jsxs("section",{className:"liens-section","aria-label":"Liens externes",children:[t.jsx("h4",{children:" Liens et ressources"}),e.length>0&&t.jsx("div",{className:"liens-liste",children:e.map(d=>{const f=gJ(d.url);return t.jsxs("div",{className:"lien-card",children:[t.jsx("span",{className:"lien-icone","aria-hidden":"true",children:vJ(d.type)}),t.jsxs("div",{className:"lien-infos",children:[t.jsx("a",{href:d.url,target:"_blank",rel:"noopener noreferrer",className:"lien-titre",title:d.url,children:d.titre}),d.description&&t.jsx("p",{className:"lien-description",children:d.description}),f&&t.jsx(bJ,{videoId:f})]}),!n&&t.jsx("button",{className:"lien-suppr",onClick:()=>u(d.id),title:"Supprimer ce lien",type:"button","aria-label":`Supprimer le lien ${d.titre}`,children:""})]},d.id)})}),e.length===0&&!n&&t.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 12px"},children:"Aucun lien ajout. Ajoutez des ressources pour enrichir cette sance."}),!n&&t.jsx(t.Fragment,{children:a?t.jsx(xJ,{onAjouter:o,onAnnuler:()=>l(!1)}):t.jsx("button",{className:"btn-secondary",onClick:()=>l(!0),type:"button",children:" Ajouter un lien"})})]})},yJ=({selectedIds:e,onSelect:r,onFermer:n})=>{const[a,l]=g.useState(""),[o,u]=g.useState([]),[d,f]=g.useState(!0),[p,h]=g.useState("");g.useEffect(()=>{async function x(){try{const j=await KZ();u(j)}catch{h("Impossible de charger la bibliothque.")}finally{f(!1)}}x()},[]);const v=g.useMemo(()=>{const x=a.toLowerCase().trim();return x?o.filter(j=>j.titre.toLowerCase().includes(x)||j.auteur.toLowerCase().includes(x)||j.categorie.toLowerCase().includes(x)):o},[o,a]);function b(x){x.target===x.currentTarget&&n()}return t.jsx("div",{className:"ebook-selector-overlay",onClick:b,role:"dialog","aria-modal":"true","aria-label":"Slectionner un ebook",children:t.jsxs("div",{className:"ebook-selector-panel",children:[t.jsxs("div",{className:"ebook-selector-header",children:[t.jsx("h3",{children:" Bibliothque PedaClic"}),t.jsx("button",{onClick:n,"aria-label":"Fermer",style:{background:"none",border:"none",fontSize:"1.3rem",cursor:"pointer",color:"#6b7280"},type:"button",children:""})]}),t.jsx("div",{className:"ebook-search",children:t.jsx("input",{type:"search",placeholder:" Rechercher par titre, auteur ou catgorie...",value:a,onChange:x=>l(x.target.value),autoFocus:!0,"aria-label":"Recherche ebook"})}),t.jsxs("div",{className:"ebook-liste",children:[d&&t.jsx("p",{style:{color:"#6b7280",textAlign:"center"},children:" Chargement de la bibliothque"}),p&&t.jsx("p",{style:{color:"#dc2626",textAlign:"center"},children:p}),!d&&!p&&v.length===0&&t.jsx("p",{style:{color:"#9ca3af",textAlign:"center"},children:"Aucun ebook ne correspond  votre recherche."}),!d&&v.map(x=>{const j=e.includes(x.id);return t.jsxs("button",{type:"button",className:`ebook-item ${j?"selected":""}`,onClick:()=>!j&&r(x),disabled:j,"aria-pressed":j,"aria-label":`${j?"Dj li : ":""}${x.titre}`,children:[x.couvertureUrl?t.jsx("img",{src:x.couvertureUrl,alt:`Couverture de ${x.titre}`,loading:"lazy"}):t.jsx("div",{style:{width:36,height:48,background:"#e5e7eb",borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.2rem",flexShrink:0},"aria-hidden":"true",children:""}),t.jsxs("div",{className:"ebook-item-info",children:[t.jsx("div",{className:"ebook-item-titre",children:x.titre}),t.jsxs("div",{className:"ebook-item-meta",children:[x.auteur,"  ",x.categorie]}),j&&t.jsx("div",{style:{fontSize:"0.75rem",color:"#2563eb",marginTop:2},children:" Dj li  cette sance"})]})]},x.id)})]})]})})},gM=({ebooksLies:e,onChange:r,readonly:n=!1})=>{const[a,l]=g.useState(!1),o=e.map(f=>f.ebookId);function u(f){const p={ebookId:f.id,titre:f.titre,categorie:f.categorie,auteur:f.auteur};r([...e,p]),l(!1)}function d(f){r(e.filter(p=>p.ebookId!==f))}return t.jsxs("section",{"aria-label":"Ebooks lis  la sance",style:{marginTop:16},children:[t.jsx("h4",{style:{fontSize:"0.95rem",fontWeight:600,color:"#111827",margin:"0 0 8px"},children:" Ebooks de la bibliothque"}),e.length>0&&t.jsx("div",{className:"ebooks-lies",children:e.map(f=>t.jsxs("span",{className:"ebook-chip",children:[t.jsxs("a",{href:`/bibliotheque/${f.ebookId}`,className:"ebook-chip",style:{textDecoration:"none"},title:`Lire : ${f.titre}`,children:[" ",f.titre]}),!n&&t.jsx("button",{onClick:()=>d(f.ebookId),title:`Retirer ${f.titre}`,type:"button","aria-label":`Retirer l'ebook ${f.titre}`,children:""})]},f.ebookId))}),e.length===0&&!n&&t.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 8px"},children:"Aucun ebook li. Associez un ebook de la bibliothque  cette sance."}),!n&&t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>l(!0),style:{marginTop:8},children:" Choisir dans la bibliothque"}),a&&t.jsx(yJ,{selectedIds:o,onSelect:u,onFermer:()=>l(!1)})]})},xM="https://api.pedaclic.sn",jJ=12e4,_J=1,pr={cours_complet:"Cours complet",fiche_revision:"Fiche de rvision",exercices_corriges:"Exercices corrigs",quiz_auto:"Quiz auto-gnr",sujet_examen:"Sujet type examen",evaluation_personnalisee:"valuation personnalise"},NJ={cours_complet:"Un cours structur avec introduction, dveloppement et conclusion adapt au programme sngalais.",fiche_revision:"Synthse des points cls pour rviser efficacement avant un examen.",exercices_corriges:"Srie d'exercices progressifs avec corrections dtailles tape par tape.",quiz_auto:"10 questions QCM avec 4 options, corrections et explications. Sauvegard directement comme quiz jouable.",sujet_examen:"Sujet conforme au format officiel BFEM ou BAC avec barme.",evaluation_personnalisee:"valuation sur mesure avec barme /20 et corrig-type."},Ka={cours_complet:"",fiche_revision:"",exercices_corriges:"",quiz_auto:"",sujet_examen:"",evaluation_personnalisee:""};async function SJ(e,r,n=jJ){const a=new AbortController,l=setTimeout(()=>a.abort(),n);try{const o=await fetch(e,{...r,signal:a.signal});return clearTimeout(l),o}catch(o){throw clearTimeout(l),o.name==="AbortError"?new Error(`La gnration a pris trop de temps (>${n/1e3}s). Le serveur est peut-tre surcharg. Veuillez ressayer dans quelques instants.`):o}}async function bM(e,r=_J){try{return await e()}catch(n){if(r<=0)throw n;return console.warn(`[aiGeneratorService] chec, nouvelle tentative dans 3s... (${r} restante(s))`),await new Promise(a=>setTimeout(a,3e3)),bM(e,r-1)}}async function rA(){try{(await fetch(`${xM}/api/health`,{method:"GET"})).ok&&console.log("[aiGeneratorService] Ping Railway OK")}catch{}}async function wJ(e){const r=JSON.stringify(e),n={method:"POST",headers:{"Content-Type":"application/json"},body:r},a=await bM(()=>SJ(`${xM}/api/generate`,n)).catch(o=>{throw console.error("[aiGeneratorService] Erreur gnration:",o),o instanceof TypeError&&o.message.includes("fetch")?new Error("Impossible de contacter le serveur. Vrifiez votre connexion internet."):o});if(!a.ok){const u=(await a.json().catch(()=>({}))).error||`Erreur serveur (${a.status})`;throw new Error(u)}const l=await a.json();if(!l.success)throw new Error(l.error||"La gnration a chou.");return l}async function CJ(e,r,n,a){try{const l=await Pt(_e(Q,"generated_content"),{userId:e,type:r.type,discipline:r.discipline,disciplineId:a,classe:r.classe,chapitre:r.chapitre,content:n,options:r.options||null,createdAt:Ae.now()});return console.log("[aiGeneratorService] Contenu sauvegard:",l.id),l.id}catch(l){throw console.error("[aiGeneratorService] Erreur sauvegarde contenu:",l),new Error("Erreur lors de la sauvegarde du contenu gnr.")}}async function EJ(e,r,n,a){try{const l=n.map((d,f)=>({id:`q_${Date.now()}_${f}`,question:d.question,options:d.options,reponseCorrecte:d.reponseCorrecte,explication:d.explication||"",difficulte:d.difficulte||"moyen",points:d.points||2})),o={disciplineId:a,titre:`Quiz IA  ${r.chapitre}`,description:`Quiz auto-gnr pour ${r.discipline} (${r.classe})  Chapitre : ${r.chapitre}`,questions:l,duree:15,isPremium:!0,noteMinimale:10,auteurId:e,source:"ia_generator",createdAt:Ae.now()},u=await Pt(_e(Q,"quizzes"),o);return console.log("[aiGeneratorService] Quiz sauvegard:",u.id),u.id}catch(l){throw console.error("[aiGeneratorService] Erreur sauvegarde quiz:",l),new Error("Erreur lors de la sauvegarde du quiz gnr.")}}async function Rb(e,r=20){try{const n=Ee(_e(Q,"generated_content"),Ne("userId","==",e),Ve("createdAt","desc")),a=await Ce(n),l=[];return a.forEach(o=>{l.length<r&&l.push({id:o.id,...o.data()})}),l}catch(n){throw console.error("[aiGeneratorService] Erreur chargement historique:",n),new Error("Erreur lors du chargement de l'historique.")}}async function AJ(e){try{await Br(je(Q,"generated_content",e)),console.log("[aiGeneratorService] Contenu supprim:",e)}catch(r){throw console.error("[aiGeneratorService] Erreur suppression:",r),new Error("Erreur lors de la suppression du contenu.")}}const zJ=({userId:e,selectedIds:r,onSelect:n,onFermer:a})=>{const[l,o]=g.useState(""),[u,d]=g.useState([]),[f,p]=g.useState(!0),[h,v]=g.useState("");g.useEffect(()=>{async function j(){try{const _=await Rb(e,50);d(_)}catch{v("Impossible de charger les contenus gnrs.")}finally{p(!1)}}j()},[e]);const b=g.useMemo(()=>{const j=l.toLowerCase().trim();return j?u.filter(_=>_.chapitre.toLowerCase().includes(j)||_.discipline.toLowerCase().includes(j)||_.classe.toLowerCase().includes(j)||pr[_.type]?.toLowerCase().includes(j)):u},[u,l]);function x(j){j.target===j.currentTarget&&a()}return t.jsx("div",{className:"ebook-selector-overlay",onClick:x,role:"dialog","aria-modal":"true","aria-label":"Slectionner un contenu IA",children:t.jsxs("div",{className:"ebook-selector-panel",children:[t.jsxs("div",{className:"ebook-selector-header",children:[t.jsx("h3",{children:" Contenus gnrs par l'IA"}),t.jsx("button",{onClick:a,"aria-label":"Fermer",type:"button",style:{background:"none",border:"none",fontSize:"1.3rem",cursor:"pointer",color:"#6b7280"},children:""})]}),t.jsx("div",{className:"ebook-search",children:t.jsx("input",{type:"search",placeholder:" Rechercher par chapitre, discipline ou classe",value:l,onChange:j=>o(j.target.value),autoFocus:!0,"aria-label":"Recherche contenu IA"})}),t.jsxs("div",{className:"ebook-liste",children:[f&&t.jsx("p",{style:{color:"#6b7280",textAlign:"center"},children:" Chargement"}),h&&t.jsx("p",{style:{color:"#dc2626",textAlign:"center"},children:h}),!f&&!h&&b.length===0&&t.jsx("p",{style:{color:"#9ca3af",textAlign:"center"},children:"Aucun contenu ne correspond  votre recherche."}),!f&&b.map(j=>{const _=j.id?r.includes(j.id):!1,C=j.createdAt?.toDate?j.createdAt.toDate().toLocaleDateString("fr-FR"):"";return t.jsxs("button",{type:"button",className:`ebook-item ${_?"selected":""}`,onClick:()=>!_&&n(j),disabled:_,"aria-pressed":_,children:[t.jsx("div",{style:{width:36,height:48,background:"#eff6ff",borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.4rem",flexShrink:0},"aria-hidden":"true",children:Ka[j.type]}),t.jsxs("div",{className:"ebook-item-info",children:[t.jsx("div",{className:"ebook-item-titre",children:j.chapitre}),t.jsxs("div",{className:"ebook-item-meta",children:[pr[j.type],"  ",j.discipline,"  ",j.classe,C&&`  ${C}`]}),_&&t.jsx("div",{style:{fontSize:"0.75rem",color:"#2563eb",marginTop:2},children:" Dj li  cette sance"})]})]},j.id)})]})]})})},kJ=({userId:e,contenuIA:r,onChange:n,readonly:a=!1})=>{const[l,o]=g.useState(!1),u=r.map(p=>p.contenuId);function d(p){if(!p.id)return;const h={contenuId:p.id,type:p.type,discipline:p.discipline,classe:p.classe,chapitre:p.chapitre,createdAt:p.createdAt?.toDate?p.createdAt.toDate().toISOString():void 0};n([...r,h]),o(!1)}function f(p){n(r.filter(h=>h.contenuId!==p))}return t.jsxs("section",{"aria-label":"Contenus IA lis  la sance",style:{marginTop:16},children:[t.jsx("h4",{style:{fontSize:"0.95rem",fontWeight:600,color:"#111827",margin:"0 0 8px"},children:" Contenus gnrs par l'IA"}),r.length>0&&t.jsx("div",{className:"ebooks-lies",children:r.map(p=>t.jsxs("span",{className:"ebook-chip ebook-chip--ia",children:[t.jsxs("span",{title:`${p.discipline}  ${p.classe}  ${p.chapitre}`,children:[Ka[p.type]??""," ",p.chapitre]}),!a&&t.jsx("button",{onClick:()=>f(p.contenuId),title:`Retirer : ${p.chapitre}`,type:"button","aria-label":`Retirer le contenu ${p.chapitre}`,children:""})]},p.contenuId))}),r.length===0&&!a&&t.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 8px"},children:"Aucun contenu IA li. Associez un contenu gnr  cette sance."}),!a&&t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>o(!0),style:{marginTop:8},children:" Choisir un contenu IA"}),l&&t.jsx(zJ,{userId:e,selectedIds:u,onSelect:d,onFermer:()=>o(!1)})]})},OJ=()=>({date:new Date().toISOString().slice(0,10),heureDebut:"",heureFin:"",chapitre:"",typeContenu:"cours",contenu:"",objectifs:"",competences:[],statut:"realise",motifAnnulation:"",dateReport:"",notesPrivees:"",isMarqueEvaluation:!1,typeEvaluation:"",dateEvaluationPrevue:"",statutEvaluation:"a_evaluer"}),nA=()=>{const{cahierId:e,entreeId:r}=xn(),{currentUser:n}=Ke(),a=Je(),[l,o]=g.useState(null),[u,d]=g.useState(null),[f,p]=g.useState(OJ()),[h,v]=g.useState([]),[b,x]=g.useState(!0),[j,_]=g.useState(!1),[C,w]=g.useState(!1),[E,S]=g.useState(""),[A,O]=g.useState([]),[k,P]=g.useState([]),[D,B]=g.useState([]),U=!!r;g.useEffect(()=>{if(!e)return;(async()=>{x(!0);try{const T=await fM(e);if(!T){a("/prof/cahiers");return}if(o(T),U&&r){const F=await FZ(r);F&&(d(F),v(F.piecesJointes||[]),O(F.liens??[]),P(F.ebooksLies??[]),B(F.contenuIA??[]),p({date:F.date.toDate().toISOString().slice(0,10),heureDebut:F.heureDebut||"",heureFin:F.heureFin||"",chapitre:F.chapitre,typeContenu:F.typeContenu,contenu:F.contenu,objectifs:F.objectifs||"",competences:F.competences||[],statut:F.statut,motifAnnulation:F.motifAnnulation||"",dateReport:F.dateReport?F.dateReport.toDate().toISOString().slice(0,10):"",notesPrivees:F.notesPrivees||"",isMarqueEvaluation:F.isMarqueEvaluation,typeEvaluation:F.typeEvaluation||"",dateEvaluationPrevue:F.dateEvaluationPrevue?F.dateEvaluationPrevue.toDate().toISOString().slice(0,10):"",statutEvaluation:F.statutEvaluation||"a_evaluer"}))}}finally{x(!1)}})()},[e,r]);const $=M=>{p(T=>({...T,competences:T.competences.includes(M)?T.competences.filter(F=>F!==M):[...T.competences,M]}))},R=async M=>{if(!M.target.files?.length||!n?.uid||!e)return;const T=M.target.files[0];if(T.size>10*1024*1024){alert("Fichier trop volumineux (max 10 Mo)");return}w(!0);try{const F=await GZ(n.uid,e,T),I=[...h,F];v(I),U&&r&&u&&await KE(r,h,[F])}catch{alert("Erreur upload fichier.")}finally{w(!1),M.target.value=""}},Y=async M=>{if(!r){v(T=>T.filter(F=>F.url!==M));return}try{await HZ(r,h,M),v(T=>T.filter(F=>F.url!==M))}catch{alert("Erreur suppression fichier.")}},ae=async M=>{if(M.preventDefault(),!f.chapitre.trim()){S("Le chapitre est obligatoire.");return}if(!f.date){S("La date est obligatoire.");return}if(!(!n?.uid||!e)){_(!0),S("");try{if(U&&r)await Lc(r,e,f),await Lc(r,{liens:A,ebooksLies:k,contenuIA:D});else{const I=await tJ(e,n.uid,f);h.length>0&&await KE(I,[],h),(A.length>0||k.length>0||D.length>0)&&await Lc(I,{liens:A,ebooksLies:k,contenuIA:D})}const F=(await pM(e)).filter(I=>I.statut==="realise").length;await xf(e,{nombreSeancesRealise:F}),a(`/prof/cahiers/${e}`)}catch(T){const F=T instanceof Error?T.message:String(T);S("Erreur : "+F)}finally{_(!1)}}};return b?t.jsx("div",{className:"loading-spinner",children:t.jsx("div",{className:"spinner-circle"})}):l?t.jsxs("div",{className:"entree-editor-page",children:[t.jsxs("div",{className:"editor-header",children:[t.jsx("button",{onClick:()=>a(`/prof/cahiers/${e}`),style:{background:"none",border:"none",cursor:"pointer",color:"#6b7280",fontSize:"1.2rem"},children:""}),t.jsxs("div",{children:[t.jsx("h1",{style:{fontSize:"1.4rem",fontWeight:700,color:"#1f2937",margin:"0 0 0.2rem"},children:U?" Modifier la sance":" Nouvelle sance"}),t.jsxs("div",{style:{fontSize:"0.85rem",color:"#6b7280"},children:[l.titre,"  ",l.classe,"  ",l.matiere]})]})]}),t.jsxs("form",{onSubmit:ae,children:[t.jsxs("div",{className:"editor-card",children:[t.jsx("div",{className:"editor-section-title",children:" Informations de la sance"}),t.jsxs("div",{className:"form-row",style:{gridTemplateColumns:"1.5fr 1fr 1fr"},children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Date *"}),t.jsx("input",{type:"date",className:"form-input",value:f.date,onChange:M=>p(T=>({...T,date:M.target.value})),required:!0})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Heure dbut"}),t.jsx("input",{type:"time",className:"form-input",value:f.heureDebut,onChange:M=>p(T=>({...T,heureDebut:M.target.value}))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Heure fin"}),t.jsx("input",{type:"time",className:"form-input",value:f.heureFin,onChange:M=>p(T=>({...T,heureFin:M.target.value}))})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Chapitre / Titre de la sance *"}),t.jsx("input",{className:"form-input",placeholder:"Ex: Chapitre 3  Les fonctions affines",value:f.chapitre,onChange:M=>p(T=>({...T,chapitre:M.target.value})),required:!0})]}),t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Type de sance"}),t.jsx("select",{className:"form-select",value:f.typeContenu,onChange:M=>p(T=>({...T,typeContenu:M.target.value})),children:Object.entries(Wi).map(([M,T])=>t.jsxs("option",{value:M,children:[T.emoji," ",T.label]},M))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Statut"}),t.jsx("select",{className:"form-select",value:f.statut,onChange:M=>p(T=>({...T,statut:M.target.value})),children:Object.entries(Rc).map(([M,T])=>t.jsx("option",{value:M,children:T.label},M))})]})]}),f.statut==="annule"&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Motif d'annulation"}),t.jsx("input",{className:"form-input",placeholder:"Ex: Grve enseignants, sortie scolaire...",value:f.motifAnnulation,onChange:M=>p(T=>({...T,motifAnnulation:M.target.value}))})]}),f.statut==="reporte"&&t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Nouvelle date (report)"}),t.jsx("input",{type:"date",className:"form-input",value:f.dateReport,onChange:M=>p(T=>({...T,dateReport:M.target.value}))})]})]}),t.jsxs("div",{className:"editor-card",children:[t.jsx("div",{className:"editor-section-title",children:" Contenu de la sance"}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Contenu (mise en forme riche)"}),t.jsx(ba,{value:f.contenu,onChange:M=>p(T=>({...T,contenu:M})),placeholder:"Dcrivez le contenu enseign, les exemples traits, les formules vues...",minHeight:220,maxHeight:600})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Objectifs pdagogiques"}),t.jsx("textarea",{className:"form-textarea",placeholder:"Ex: L'lve sera capable de rsoudre une quation du second degr...",value:f.objectifs,onChange:M=>p(T=>({...T,objectifs:M.target.value})),rows:2})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Comptences vises"}),t.jsx("div",{className:"competences-container",children:F5.map(M=>t.jsx("button",{type:"button",className:`competence-tag ${f.competences.includes(M)?"selected":""}`,onClick:()=>$(M),children:M},M))})]})]}),t.jsxs("div",{className:"editor-card",children:[t.jsx("div",{className:"editor-section-title",children:" Signet d'valuation"}),t.jsxs("div",{className:"signet-section",children:[t.jsxs("div",{className:"signet-toggle",onClick:()=>p(M=>({...M,isMarqueEvaluation:!M.isMarqueEvaluation})),children:[t.jsx("div",{className:`toggle-switch ${f.isMarqueEvaluation?"on":""}`}),t.jsxs("div",{children:[t.jsx("div",{style:{fontWeight:600,fontSize:"0.9rem",color:"#1f2937"},children:"Marquer pour valuation"}),t.jsx("div",{style:{fontSize:"0.78rem",color:"#6b7280"},children:"Ce contenu sera valu ultrieurement"})]})]}),f.isMarqueEvaluation&&t.jsx("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Type d'valuation"}),t.jsxs("select",{className:"form-select",value:f.typeEvaluation,onChange:M=>p(T=>({...T,typeEvaluation:M.target.value})),children:[t.jsx("option",{value:"",children:"Choisir..."}),Object.entries(TA).map(([M,T])=>t.jsx("option",{value:M,children:T},M))]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{className:"form-label",children:"Date prvue d'valuation"}),t.jsx("input",{type:"date",className:"form-input",value:f.dateEvaluationPrevue,onChange:M=>p(T=>({...T,dateEvaluationPrevue:M.target.value}))})]})]})})]})]}),t.jsxs("div",{className:"editor-card",children:[t.jsx("div",{className:"editor-section-title",children:" Pices jointes"}),h.length>0&&t.jsx("div",{className:"pieces-jointes-list",children:h.map(M=>t.jsxs("div",{className:"piece-jointe-item",children:[t.jsx("span",{children:""}),t.jsx("a",{href:M.url,target:"_blank",rel:"noopener noreferrer",children:M.nom}),t.jsxs("span",{style:{color:"#9ca3af",fontSize:"0.75rem"},children:["(",Math.round((M.taille??0)/1024)," Ko)"]}),t.jsx("button",{type:"button",onClick:()=>Y(M.url),style:{background:"none",border:"none",cursor:"pointer",color:"#ef4444",marginLeft:"auto"},children:""})]},M.url))}),t.jsxs("label",{className:"upload-zone",children:[C?"Envoi en cours...":" Cliquer pour ajouter un fichier (PDF, image  max 10 Mo)",t.jsx("input",{type:"file",style:{display:"none"},accept:".pdf,.jpg,.jpeg,.png,.doc,.docx,.ppt,.pptx",onChange:R,disabled:C})]})]}),t.jsxs("div",{className:"editor-card",children:[t.jsx("div",{className:"editor-section-title",children:" Ressources enrichies"}),t.jsx("p",{style:{fontSize:"0.82rem",color:"#6b7280",margin:"0 0 4px"},children:"Ajoutez des liens ou des ebooks pour enrichir cette sance."}),t.jsx(vM,{liens:A,onChange:O}),t.jsx(gM,{ebooksLies:k,onChange:P}),t.jsx(kJ,{userId:n.uid,contenuIA:D,onChange:B})]}),t.jsxs("div",{className:"editor-card",children:[t.jsx("div",{className:"editor-section-title",children:" Notes prives"}),t.jsx("textarea",{className:"form-textarea",placeholder:"Notes personnelles (non visibles par l'administration)...",value:f.notesPrivees,onChange:M=>p(T=>({...T,notesPrivees:M.target.value})),rows:3}),t.jsx("div",{style:{fontSize:"0.75rem",color:"#9ca3af",marginTop:"0.25rem"},children:"Ces notes sont uniquement visibles par vous."})]}),E&&t.jsx("div",{style:{color:"#dc2626",background:"#fee2e2",padding:"0.75rem 1rem",borderRadius:8,marginBottom:"1rem",fontSize:"0.85rem"},children:E}),t.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end",paddingBottom:"2rem"},children:[t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>a(`/prof/cahiers/${e}`),children:"Annuler"}),t.jsx("button",{type:"submit",className:"btn-primary",disabled:j,style:{minWidth:160},children:j?"Enregistrement...":U?" Mettre  jour":" Enregistrer la sance"})]})]})]}):null},DJ=50*1024*1024,PJ="image/jpeg,image/png,image/gif,image/webp,audio/mpeg,audio/wav,audio/ogg,video/mp4";function MJ(e){return e.startsWith("image/")?"image":e.startsWith("audio/")?"audio":e.startsWith("video/")?"video":"autre"}function yM(e){return e<1024?`${e} o`:e<1024*1024?`${(e/1024).toFixed(1)} Ko`:`${(e/1024/1024).toFixed(1)} Mo`}const TJ=({src:e,alt:r,onFermer:n})=>t.jsx("div",{className:"image-fullscreen-overlay",onClick:n,role:"dialog","aria-modal":"true","aria-label":"Image en plein cran",children:t.jsx("img",{src:e,alt:r})}),qJ=({pj:e,onSupprimer:r,readonly:n=!1})=>{const[a,l]=g.useState(!1);return t.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,overflow:"hidden",marginBottom:10,background:"#fff"},children:[e.type==="image"&&t.jsxs(t.Fragment,{children:[t.jsx("img",{src:e.url,alt:e.nom,className:"media-image",onClick:()=>l(!0),style:{maxWidth:"100%",display:"block"},loading:"lazy"}),a&&t.jsx(TJ,{src:e.url,alt:e.nom,onFermer:()=>l(!1)})]}),e.type==="audio"&&t.jsx("div",{className:"media-player",children:t.jsxs("audio",{controls:!0,preload:"metadata",children:[t.jsx("source",{src:e.url,type:e.mimeType}),"Votre navigateur ne supporte pas la lecture audio."]})}),e.type==="video"&&t.jsx("div",{className:"media-player",children:t.jsxs("video",{controls:!0,preload:"none",playsInline:!0,children:[t.jsx("source",{src:e.url,type:e.mimeType}),"Votre navigateur ne supporte pas la lecture vido."]})}),(e.type==="pdf"||e.type==="autre")&&t.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center",gap:8,padding:"10px 14px",textDecoration:"none",color:"#2563eb"},children:[" ",e.nom]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 12px",background:"#f9fafb",borderTop:"1px solid #f3f4f6"},children:[t.jsxs("span",{style:{fontSize:"0.78rem",color:"#6b7280",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[e.nom,e.taille&&`  ${yM(e.taille)}`]}),!n&&r&&t.jsx("button",{type:"button",onClick:()=>r(e.id),title:"Supprimer ce fichier",style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af",fontSize:"1rem",padding:"0 4px"},"aria-label":`Supprimer ${e.nom}`,children:""})]})]})},RJ=({piecesJointes:e,entreeId:r,profId:n,onChange:a,readonly:l=!1})=>{const o=g.useRef(null),[u,d]=g.useState(null),[f,p]=g.useState("");async function h(b){const x=b.target.files?.[0];if(!x)return;if(x.size>DJ){p(`Fichier trop volumineux (max 50 Mo). Ce fichier fait ${yM(x.size)}.`);return}p("");const j=`${Date.now()}_${x.name}`,_=`cahiers/${n}/${r}/${j}`,C=sr(er,_),w=lu(C,x);w.on("state_changed",E=>{const S=Math.round(E.bytesTransferred/E.totalBytes*100);d(S)},E=>{p(`Erreur d'envoi : ${E.message}`),d(null)},async()=>{const E=await Mn(w.snapshot.ref),S=MJ(x.type),A={id:String(Date.now()),nom:x.name,url:E,type:S,taille:x.size,mimeType:x.type};a([...e,A]),d(null),o.current&&(o.current.value="")})}function v(b){a(e.filter(x=>x.id!==b))}return t.jsxs("section",{"aria-label":"Fichiers mdias",style:{marginTop:20},children:[t.jsx("h4",{style:{fontSize:"0.95rem",fontWeight:600,color:"#111827",margin:"0 0 12px"},children:" Fichiers mdias"}),e.map(b=>t.jsx(qJ,{pj:b,onSupprimer:v,readonly:l},b.id)),e.length===0&&!l&&t.jsx("p",{style:{fontSize:"0.85rem",color:"#9ca3af",margin:"0 0 12px"},children:"Aucun fichier ajout. Formats accepts : images, audio, vido (max 50 Mo)."}),!l&&t.jsxs(t.Fragment,{children:[u!==null&&t.jsxs("div",{style:{marginBottom:12},children:[t.jsx("div",{style:{height:8,background:"#e5e7eb",borderRadius:9999,overflow:"hidden"},children:t.jsx("div",{style:{height:"100%",width:`${u}%`,background:"#2563eb",transition:"width 0.3s ease"},role:"progressbar","aria-valuenow":u,"aria-valuemin":0,"aria-valuemax":100})}),t.jsxs("p",{style:{fontSize:"0.8rem",color:"#6b7280",margin:"4px 0 0"},children:["Envoi en cours ",u,"%"]})]}),f&&t.jsxs("p",{style:{fontSize:"0.8rem",color:"#dc2626",margin:"0 0 8px"},children:[" ",f]}),t.jsx("input",{ref:o,type:"file",accept:PJ,onChange:h,style:{display:"none"},"aria-label":"Choisir un fichier mdia"}),t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>o.current?.click(),disabled:u!==null,children:" Ajouter un fichier (image / audio / vido)"}),t.jsx("p",{style:{fontSize:"0.75rem",color:"#9ca3af",marginTop:6},children:"Max 50 Mo  JPG, PNG, GIF, WebP, MP3, WAV, OGG, MP4"})]})]})};function IJ(e){return e.toDate().toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}const LJ=()=>{const{cahierId:e}=xn(),r=Je(),[n,a]=g.useState(null),[l,o]=g.useState([]),[u,d]=g.useState(!0),[f,p]=g.useState(""),[h,v]=g.useState(null);g.useEffect(()=>{async function x(){if(e){d(!0);try{const j=await YZ(e);if(!j){p("Ce cahier n'est pas accessible ou n'existe pas.");return}a(j);const _=await eJ(e);o(_)}catch{p("Une erreur est survenue lors du chargement.")}finally{d(!1)}}}x()},[e]);function b(x){v(j=>j===x?null:x)}return u?t.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"#6b7280"},children:[t.jsx("div",{style:{fontSize:"2rem"},children:""}),t.jsx("p",{children:"Chargement du cahier de textes"})]}):f||!n?t.jsxs("div",{style:{textAlign:"center",padding:"60px 20px"},children:[t.jsx("div",{style:{fontSize:"2.5rem"},children:""}),t.jsx("p",{style:{color:"#dc2626",fontWeight:600},children:f||"Accs non autoris"}),t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>r(-1),style:{marginTop:12},children:" Retour"})]}):t.jsxs("main",{style:{maxWidth:760,margin:"0 auto",padding:"20px 16px"},children:[t.jsxs("header",{className:"eleve-cahier-header",children:[t.jsx("button",{type:"button",onClick:()=>r(-1),style:{background:"rgba(255,255,255,0.2)",border:"none",color:"#fff",cursor:"pointer",borderRadius:8,padding:"4px 10px",fontSize:"0.85rem",marginBottom:10,display:"inline-flex",alignItems:"center",gap:4},children:" Retour"}),t.jsx("h1",{children:n.titre}),t.jsxs("p",{children:[n.matiere,"  ",n.classe,"  ",n.anneeScolaire]}),t.jsx("span",{className:"badge-lecture-seule",children:" Lecture seule  Sances ralises"})]}),n.description&&t.jsx("div",{style:{background:"#f0f9ff",border:"1px solid #bae6fd",borderRadius:10,padding:14,marginBottom:20,fontSize:"0.9rem",color:"#0c4a6e"},children:n.description}),t.jsx("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:16},children:l.length===0?"Aucune sance ralise pour l'instant.":`${l.length} sance${l.length>1?"s":""} ralise${l.length>1?"s":""}`}),l.length===0&&t.jsxs("div",{className:"eleve-vide",children:[t.jsx("span",{className:"emoji",children:""}),t.jsx("p",{children:"Votre professeur n'a pas encore enregistr de sance ralise."}),t.jsx("p",{style:{fontSize:"0.8rem"},children:"Revenez plus tard !"})]}),l.map(x=>{const j=h===x.id,_=(x.piecesJointes?.length??0)>0,C=(x.liens?.length??0)>0,w=(x.ebooksLies?.length??0)>0;return t.jsxs("article",{className:"seance-card-eleve",children:[t.jsxs("button",{type:"button",onClick:()=>b(x.id),style:{width:"100%",background:"none",border:"none",cursor:"pointer",textAlign:"left",padding:0},"aria-expanded":j,"aria-controls":`seance-corps-${x.id}`,children:[t.jsxs("div",{className:"seance-card-eleve-date",children:[" ",IJ(x.date),x.heureDebut?`  ${x.heureDebut}${x.heureFin?`  ${x.heureFin}`:""}`:""]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("h3",{style:{margin:0},children:x.chapitre}),t.jsx("span",{style:{fontSize:"1.1rem",transition:"transform 0.2s",transform:j?"rotate(180deg)":"rotate(0)",display:"inline-block"},"aria-hidden":"true",children:""})]}),t.jsxs("div",{style:{display:"flex",gap:6,marginTop:6,flexWrap:"wrap"},children:[C&&t.jsx("span",{style:{fontSize:"0.72rem",background:"#eff6ff",color:"#2563eb",padding:"2px 8px",borderRadius:9999},children:" Ressources"}),w&&t.jsx("span",{style:{fontSize:"0.72rem",background:"#fef3c7",color:"#92400e",padding:"2px 8px",borderRadius:9999},children:" Ebooks"}),_&&t.jsx("span",{style:{fontSize:"0.72rem",background:"#f0fdf4",color:"#16a34a",padding:"2px 8px",borderRadius:9999},children:" Mdias"})]})]}),j&&t.jsxs("div",{id:`seance-corps-${x.id}`,style:{marginTop:14,borderTop:"1px solid #f3f4f6",paddingTop:14},children:[x.objectifs&&t.jsxs("div",{style:{background:"#f0fdf4",border:"1px solid #bbf7d0",borderRadius:8,padding:10,fontSize:"0.875rem",color:"#166534",marginBottom:12},children:[t.jsx("strong",{children:" Objectifs :"})," ",x.objectifs]}),t.jsx("div",{className:"seance-card-eleve-contenu",children:x.contenu}),C&&t.jsx(vM,{liens:x.liens??[],onChange:()=>{},readonly:!0}),w&&t.jsx(gM,{ebooksLies:x.ebooksLies??[],onChange:()=>{},readonly:!0}),_&&t.jsx(RJ,{piecesJointes:x.piecesJointes??[],entreeId:x.id,profId:"",onChange:()=>{},readonly:!0})]})]},x.id)})]})},cs="sequences_pedagogiques",$J="entrees_cahier";function jM(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function jp(e){return e.filter(r=>r.estEvaluation&&r.typeEvaluation).map(r=>({id:r.id,titre:r.titre,type:r.typeEvaluation,seanceNumero:r.numero,noteMax:r.noteMax??20,coefficient:r.coefficient??1,datePrevue:r.datePrevue}))}async function BJ(e){const r=Ee(_e(Q,cs),Ne("profId","==",e),Ve("updatedAt","desc"));return(await Ce(r)).docs.map(a=>({id:a.id,...a.data()}))}async function iu(e){const r=await Et(je(Q,cs,e));return r.exists()?{id:r.id,...r.data()}:null}async function UJ(e,r){const n=Ae.now(),a=r.seances.map(u=>({...u,id:u.id||jM(),exporterVersCahier:u.exporterVersCahier??!0,entreesCahierIds:u.entreesCahierIds??[]})),l=jp(a);return(await Pt(_e(Q,cs),{...r,profId:e,seances:a,evaluationsPrevues:l,statut:r.statut??"brouillon",genereeParIA:r.genereeParIA??!1,competences:r.competences??[],createdAt:n,updatedAt:n})).id}async function FJ(e,r){const n={...r,updatedAt:Ae.now()};r.seances&&(n.evaluationsPrevues=jp(r.seances)),await He(je(Q,cs,e),n)}async function GJ(e,r){await He(je(Q,cs,e),{statut:r,updatedAt:Ae.now()})}async function _M(e){await Br(je(Q,cs,e))}async function HJ(e,r){const n=await iu(e);if(!n)throw new Error(`Squence ${e} introuvable`);const a=Ae.now(),l=n.seances.map(u=>({...u,id:jM(),exporterVersCahier:!0,entreesCahierIds:[],datePrevue:void 0}));return(await Pt(_e(Q,cs),{titre:`[Copie] ${n.titre}`,description:n.description,niveau:n.niveau,matiere:n.matiere,theme:n.theme,competences:n.competences,objectifGeneral:n.objectifGeneral,prerequis:n.prerequis,nombreSeances:n.nombreSeances,dureeSeanceMinutes:n.dureeSeanceMinutes,trimestre:n.trimestre,seances:l,evaluationsPrevues:jp(l),genereeParIA:n.genereeParIA,profId:r,statut:"brouillon",groupeClasseId:void 0,groupeClasseNom:void 0,cahierDeTextesId:void 0,cahierDeTextesNom:void 0,createdAt:a,updatedAt:a})).id}async function VJ(e){const{sequenceId:r,cahierDeTextesId:n,profId:a,datesParSeance:l}=e,o=await iu(r);if(!o)throw new Error(`Squence ${r} introuvable`);const u=Ae.now(),d=[],f=[],p=Object.keys(l),h=[...o.seances];for(const v of p){const b=h.findIndex(_=>_.id===v);if(b===-1){f.push(v);continue}const x=h[b],j=l[v];try{const _={cahierId:n,profId:a,date:j,chapitre:x.titre,typeContenu:"cours",contenu:x.contenu,objectifs:x.objectifSpecifique,statut:"planifie",notesPrivees:x.ressources.length>0?`Ressources : ${x.ressources.join(" | ")}`:void 0,isMarqueEvaluation:!1,ordre:b,liens:[],ebooksLies:[],piecesJointes:[]},C=await Pt(_e(Q,$J),{..._,createdAt:u,updatedAt:u});d.push(C.id),h[b]={...x,exporterVersCahier:!1,entreesCahierIds:[...x.entreesCahierIds??[],C.id]}}catch(_){console.error(`[exporterVersCahier] Erreur sance ${v}:`,_),f.push(v)}}return d.length>0&&await He(je(Q,cs,r),{seances:h,evaluationsPrevues:jp(h),cahierDeTextesId:n,cahierDeTextesNom:o.cahierDeTextesNom??"",exporteAt:u,updatedAt:u}),{nbExportees:d.length,idsEntrees:d,erreurs:f}}function QJ(e,r){return e.filter(n=>{if(r.matiere&&n.matiere!==r.matiere||r.niveau&&n.niveau!==r.niveau||r.statut&&n.statut!==r.statut||r.groupeClasseId&&n.groupeClasseId!==r.groupeClasseId)return!1;if(r.recherche){const a=r.recherche.toLowerCase();if(!(n.titre.toLowerCase().includes(a)||n.matiere.toLowerCase().includes(a)||n.theme.toLowerCase().includes(a)||n.description.toLowerCase().includes(a)))return!1}return!0})}const bf={cours:"Cours",td:"TD",tp:"TP",evaluation:"valuation",revision:"Rvision",projet:"Projet",correction:"Correction"},Aj={formative:"Formative",sommative:"Sommative",diagnostique:"Diagnostique",devoir:"Devoir sur table",composition:"Composition (BFEM/BAC)",interrogation:"Interrogation"},_p={brouillon:{label:"Brouillon",couleur:"#6b7280"},active:{label:"En cours",couleur:"#2563eb"},terminee:{label:"Termine",couleur:"#16a34a"},archivee:{label:"Archive",couleur:"#9ca3af"}},YJ=[{valeur:"6eme",label:"6me"},{valeur:"5eme",label:"5me"},{valeur:"4eme",label:"4me"},{valeur:"3eme",label:"3me (BFEM)"},{valeur:"2nde",label:"2nde"},{valeur:"1ere",label:"1re"},{valeur:"terminale",label:"Terminale (BAC)"}],yf=[30,45,55,60,90,120],KJ=({statut:e})=>{const{label:r}=_p[e];return t.jsxs("span",{className:`statut-badge statut-badge--${e}`,children:[t.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:"currentColor",display:"inline-block"}}),r]})},WJ=({sequence:e,onView:r,onEdit:n,onDuplicate:a,onDelete:l})=>{const o=e.seances.filter(u=>u.estEvaluation).length;return t.jsxs("article",{className:"sequence-card",onClick:r,role:"button",tabIndex:0,onKeyDown:u=>u.key==="Enter"&&r(),children:[t.jsxs("div",{className:"sequence-card__badges",children:[t.jsx(KJ,{statut:e.statut}),e.genereeParIA&&t.jsx("span",{className:"badge-ia",children:" IA"})]}),t.jsx("h3",{className:"sequence-card__title",children:e.titre}),t.jsxs("div",{className:"sequence-card__meta",children:[t.jsx("span",{className:"sequence-card__meta-chip",children:e.matiere}),t.jsx("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:e.niveau}),e.trimestre&&t.jsxs("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:["T",e.trimestre]})]}),e.description&&t.jsx("p",{className:"sequence-card__desc",children:e.description}),t.jsxs("div",{className:"sequence-card__footer",children:[t.jsxs("span",{className:"sequence-card__seances-count",children:[" ",e.seances.length," sance",e.seances.length>1?"s":"",o>0&&`   ${o} val.`]}),e.groupeClasseNom&&t.jsxs("span",{className:"sequence-card__groupe",children:[" ",e.groupeClasseNom]})]}),t.jsxs("div",{className:"sequence-card__actions",onClick:u=>u.stopPropagation(),children:[t.jsx("button",{className:"sequence-card__action-btn",onClick:n,title:"Modifier","aria-label":"Modifier la squence",children:""}),t.jsx("button",{className:"sequence-card__action-btn",onClick:a,title:"Dupliquer","aria-label":"Dupliquer la squence",children:""}),t.jsx("button",{className:"sequence-card__action-btn sequence-card__action-btn--danger",onClick:l,title:"Supprimer","aria-label":"Supprimer la squence",children:""})]})]})},XJ=()=>{const e=Je(),{currentUser:r}=Ke(),{matieres:n}=Ca(),[a,l]=g.useState([]),[o,u]=g.useState(!0),[d,f]=g.useState(null),[p,h]=g.useState(null),[v,b]=g.useState({matiere:"",niveau:"",statut:"",recherche:""}),x=g.useCallback(async()=>{if(r?.uid){u(!0),f(null);try{const S=await BJ(r.uid);l(S)}catch(S){console.error("[SequencesPage] Chargement:",S),f("Impossible de charger vos squences. Vrifiez votre connexion.")}finally{u(!1)}}},[r?.uid]);if(g.useEffect(()=>{x()},[x]),!r?.isPremium&&r?.role!=="admin")return t.jsxs("div",{className:"premium-gate",children:[t.jsx("span",{className:"premium-gate__icon",children:""}),t.jsx("h2",{className:"premium-gate__title",children:"Fonctionnalit Premium"}),t.jsx("p",{className:"premium-gate__text",children:"Le Gnrateur de Squences Pdagogiques est rserv aux enseignants Premium. Passez  Premium pour crer des squences structures et les exporter vers votre Cahier de Textes."}),t.jsx("button",{className:"btn-primary",onClick:()=>e("/prof/premium"),children:" Passer  Premium  2 000 FCFA/mois"})]});const j=QJ(a,v),_=n.length>0?n.map(S=>S.valeur):[...new Set(a.map(S=>S.matiere))].sort(),C=async S=>{if(window.confirm(`Supprimer la squence "${S.titre}" ?

Cette action est irrversible.`)){h(S.id);try{await _M(S.id),l(O=>O.filter(k=>k.id!==S.id))}catch(O){console.error("[SequencesPage] Suppression:",O),f("Erreur lors de la suppression. Ressayez.")}finally{h(null)}}},w=async S=>{if(r?.uid){h(S.id);try{const A=await HJ(S.id,r.uid);e(`/prof/sequences/${A}/modifier`)}catch(A){console.error("[SequencesPage] Duplication:",A),f("Erreur lors de la duplication. Ressayez."),h(null)}}},E={total:a.length,active:a.filter(S=>S.statut==="active").length,terminee:a.filter(S=>S.statut==="terminee").length,ia:a.filter(S=>S.genereeParIA).length};return t.jsxs("div",{className:"sequences-page",children:[t.jsxs("div",{className:"sequences-page__header",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"sequences-page__title",children:" Squences Pdagogiques"}),t.jsxs("p",{className:"sequences-page__subtitle",children:[E.total," squence",E.total>1?"s":"",E.active>0&&`  ${E.active} en cours`,E.ia>0&&`  ${E.ia} assiste${E.ia>1?"s":""} par IA`]})]}),t.jsx("button",{className:"sequences-page__btn-new",onClick:()=>e("/prof/sequences/nouvelle"),children:"+ Nouvelle squence"})]}),d&&t.jsxs("div",{className:"error-banner",role:"alert",children:[" ",d,t.jsx("button",{onClick:x,style:{marginLeft:"auto",background:"none",border:"none",cursor:"pointer",color:"#dc2626",fontWeight:600},children:"Ressayer"})]}),t.jsxs("div",{className:"sequences-filters",role:"search",children:[t.jsx("input",{type:"search",className:"sequences-filters__search",placeholder:" Rechercher une squence...",value:v.recherche??"",onChange:S=>b(A=>({...A,recherche:S.target.value})),"aria-label":"Rechercher une squence"}),t.jsxs("select",{className:"sequences-filters__select",value:v.matiere??"",onChange:S=>b(A=>({...A,matiere:S.target.value})),"aria-label":"Filtrer par matire",children:[t.jsx("option",{value:"",children:"Toutes les matires"}),_.map(S=>t.jsx("option",{value:S,children:S},S))]}),t.jsxs("select",{className:"sequences-filters__select",value:v.niveau??"",onChange:S=>b(A=>({...A,niveau:S.target.value})),"aria-label":"Filtrer par niveau",children:[t.jsx("option",{value:"",children:"Tous les niveaux"}),wa.map(S=>t.jsx("option",{value:S,children:S},S))]}),t.jsxs("select",{className:"sequences-filters__select",value:v.statut??"",onChange:S=>b(A=>({...A,statut:S.target.value})),"aria-label":"Filtrer par statut",children:[t.jsx("option",{value:"",children:"Tous les statuts"}),Object.entries(_p).map(([S,{label:A}])=>t.jsx("option",{value:S,children:A},S))]})]}),o?t.jsx("div",{className:"sequences-grid",children:[1,2,3].map(S=>t.jsxs("div",{className:"sequence-card",style:{minHeight:180},children:[t.jsx("div",{className:"skeleton",style:{height:20,width:"40%",marginBottom:10}}),t.jsx("div",{className:"skeleton",style:{height:22,width:"80%",marginBottom:8}}),t.jsx("div",{className:"skeleton",style:{height:14,width:"60%"}})]},S))}):t.jsx("div",{className:"sequences-grid",role:"list",children:j.length===0?t.jsxs("div",{className:"sequences-empty",children:[t.jsx("span",{className:"sequences-empty__icon",children:""}),t.jsx("p",{className:"sequences-empty__text",children:a.length===0?"Aucune squence pour l'instant":"Aucune squence ne correspond  vos filtres"}),t.jsx("p",{className:"sequences-empty__hint",children:a.length===0?'Cliquez sur "+ Nouvelle squence" pour commencer':"Modifiez ou effacez les filtres pour voir plus de rsultats"})]}):j.map(S=>t.jsx("div",{role:"listitem",style:{opacity:p===S.id?.6:1},children:t.jsx(WJ,{sequence:S,onView:()=>e(`/prof/sequences/${S.id}`),onEdit:()=>e(`/prof/sequences/${S.id}/modifier`),onDuplicate:()=>w(S),onDelete:()=>C(S)})},S.id))})]})},ZJ="https://votre-app.railway.app",JJ=["cours","td","tp","evaluation","revision","projet","correction"],eee=["formative","sommative","diagnostique","devoir","composition","interrogation"];function tee(e){return JJ.includes(e)?e:"cours"}function ree(e){if(e)return eee.includes(e)?e:"formative"}function nee(e){if(!e||typeof e!="object")throw new Error("Rponse IA invalide : non-objet");if(!Array.isArray(e.seances)||e.seances.length===0)throw new Error("Rponse IA invalide : tableau seances absent ou vide");const r=e.seances.map((n,a)=>({numero:Number(n.numero)||a+1,titre:String(n.titre??`Sance ${a+1}`),dureeMinutes:Number(n.dureeMinutes)||55,objectifSpecifique:String(n.objectifSpecifique??""),contenu:String(n.contenu??""),ressources:Array.isArray(n.ressources)?n.ressources.map(String):[],typeActivite:tee(String(n.typeActivite??"cours")),estEvaluation:!!n.estEvaluation,typeEvaluation:ree(n.typeEvaluation),noteMax:typeof n.noteMax=="number"?n.noteMax:void 0,coefficient:typeof n.coefficient=="number"?n.coefficient:void 0}));return{titre:String(e.titre??""),description:String(e.description??""),objectifGeneral:String(e.objectifGeneral??""),prerequis:String(e.prerequis??""),competences:Array.isArray(e.competences)?e.competences.map(String):[],seances:r}}function aee(){return`Tu es un expert en ingnierie pdagogique pour le systme ducatif sngalais 
(programme du Ministre de l'ducation Nationale du Sngal).

Tu gnres des squences pdagogiques structures pour des professeurs du secondaire 
(collges et lyces sngalais, niveaux 6me  Terminale).

RPONDRE UNIQUEMENT EN JSON valide. Aucun texte avant ou aprs le JSON.
Aucune balise markdown, aucun \`\`\`json.

Structure JSON attendue :
{
  "titre": "string",
  "description": "string (2-3 phrases contextuelles)",
  "objectifGeneral": "string (formulation en termes de comptences, verbes d'action)",
  "prerequis": "string (connaissances ncessaires avant cette squence)",
  "competences": ["string", "string", ...],
  "seances": [
    {
      "numero": 1,
      "titre": "string",
      "dureeMinutes": 55,
      "objectifSpecifique": "string (verbe d'action + contenu)",
      "contenu": "string (droulement dtaill de la sance)",
      "ressources": ["string", ...],
      "typeActivite": "cours|td|tp|evaluation|revision|projet|correction",
      "estEvaluation": false,
      "typeEvaluation": null,
      "noteMax": null,
      "coefficient": null
    }
  ]
}

Rgles :
- Respecte les programmes officiels sngalais
- Les trimestres au Sngal : 1er (Oct-Dc), 2me (Jan-Mars), 3me (Avr-Juin)
- Inclure des sances de rvision avant les valuations
- Pour les valuations (estEvaluation=true), prciser typeEvaluation
- Les contenus doivent tre adapts aux ralits sngalaises (exemples locaux)
- Note maximale habituelle : 20 (systme franais)
- Niveaux  fort enjeu : 3me (BFEM), Terminale (BAC)
- Langue : franais`}async function iee(e){const r=`
Gnre une squence pdagogique complte pour :
- Matire : ${e.matiere}
- Niveau : ${e.niveau}
- Thme/Chapitre : ${e.theme}
- Nombre de sances : ${e.nombreSeances}
- Dure par sance : ${e.dureeSeanceMinutes} minutes
${e.trimestre?`- Trimestre : ${e.trimestre}me trimestre`:""}
${e.instructionsSupplementaires?`- Instructions supplmentaires : ${e.instructionsSupplementaires}`:""}

Distribue intelligemment les sances : cours  TD/TP  rvision  valuation.
Assure-toi que les objectifs spcifiques sont progressifs et mesurables.
  `.trim();let n;try{n=await fetch(`${ZJ}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({systemPrompt:aee(),userPrompt:r,maxTokens:4e3})})}catch{throw new Error("Impossible de contacter le serveur IA. Vrifiez votre connexion Internet.")}if(!n.ok){const d=await n.text().catch(()=>"Erreur inconnue");throw new Error(`Erreur serveur IA (${n.status}) : ${d}`)}const a=await n.json(),l=a.content??a.result??a.text??"";if(!l)throw new Error("Rponse IA vide  le serveur a renvoy un contenu vide.");const o=l.replace(/^```json\s*/i,"").replace(/^```\s*/,"").replace(/```\s*$/,"").trim();let u;try{u=JSON.parse(o)}catch{throw new Error(`Rponse IA non parsable : ${o.substring(0,200)}...`)}return nee(u)}function NM(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function see(e){return{id:NM(),numero:e,titre:"",dureeMinutes:55,objectifSpecifique:"",contenu:"",ressources:[],typeActivite:"cours",estEvaluation:!1,exporterVersCahier:!0,entreesCahierIds:[]}}const lee=({seance:e,onChange:r,onDelete:n,onMoveUp:a,onMoveDown:l,isFirst:o,isLast:u})=>{const[d,f]=g.useState(e.titre===""),[p,h]=g.useState(""),v=j=>r({...e,...j}),b=()=>{const j=p.trim();j&&(v({ressources:[...e.ressources,j]}),h(""))},x=j=>v({ressources:e.ressources.filter((_,C)=>C!==j)});return t.jsxs("div",{className:"seance-card",children:[t.jsxs("div",{className:"seance-card__header",onClick:()=>f(j=>!j),children:[t.jsx("div",{className:`seance-card__numero${e.estEvaluation?" seance-card__numero--eval":""}`,children:e.numero}),t.jsx("span",{className:"seance-card__header-title",children:e.titre||`Sance ${e.numero} (sans titre)`}),t.jsxs("div",{className:"seance-card__header-badges",children:[t.jsx("span",{className:`type-activite-badge type-activite-badge--${e.typeActivite}`,children:bf[e.typeActivite]}),t.jsxs("span",{style:{fontSize:"0.75rem",color:"#64748b"},children:[e.dureeMinutes,"min"]})]}),t.jsx("span",{className:`seance-card__toggle-icon${d?" seance-card__toggle-icon--open":""}`,children:""})]}),d&&t.jsxs("div",{className:"seance-card__body",children:[t.jsxs("div",{className:"editor-form-grid",children:[t.jsxs("div",{className:"form-group editor-form-grid--full",children:[t.jsxs("label",{children:["Titre de la sance ",t.jsx("span",{className:"required",children:"*"})]}),t.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Introduction aux vecteurs",value:e.titre,onChange:j=>v({titre:j.target.value})})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Type d'activit"}),t.jsx("select",{className:"form-control",value:e.typeActivite,onChange:j=>v({typeActivite:j.target.value,estEvaluation:j.target.value==="evaluation"?!0:e.estEvaluation}),children:Object.entries(bf).map(([j,_])=>t.jsx("option",{value:j,children:_},j))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Dure (minutes)"}),t.jsxs("select",{className:"form-control",value:e.dureeMinutes,onChange:j=>v({dureeMinutes:Number(j.target.value)}),children:[yf.map(j=>t.jsxs("option",{value:j,children:[j," min"]},j)),t.jsx("option",{value:e.dureeMinutes,children:yf.includes(e.dureeMinutes)?null:`${e.dureeMinutes} min (personnalis)`})]})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Objectif spcifique"}),t.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Ex : L'lve sera capable de calculer le module d'un vecteur",value:e.objectifSpecifique,onChange:j=>v({objectifSpecifique:j.target.value}),rows:2})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Contenu / Droulement"}),t.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Dcrivez le droulement de la sance : activits, tapes, mthodes...",value:e.contenu,onChange:j=>v({contenu:j.target.value}),rows:4})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Supports / Ressources"}),e.ressources.length>0&&t.jsx("div",{className:"timeline-card__ressources",style:{marginBottom:6},children:e.ressources.map((j,_)=>t.jsxs("span",{className:"ressource-chip",style:{cursor:"pointer"},onClick:()=>x(_),title:"Cliquer pour supprimer",children:[j," "]},_))}),t.jsxs("div",{className:"competence-input-row",children:[t.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Manuel p.42, GeoGebra, Calculatrice...",value:p,onChange:j=>h(j.target.value),onKeyDown:j=>j.key==="Enter"&&(j.preventDefault(),b())}),t.jsx("button",{type:"button",className:"btn-add-competence",onClick:b,children:"+ Ajouter"})]})]}),t.jsx("div",{className:"form-group",children:t.jsxs("label",{style:{flexDirection:"row",alignItems:"center",display:"flex",gap:8},children:[t.jsx("input",{type:"checkbox",checked:e.estEvaluation,onChange:j=>v({estEvaluation:j.target.checked,typeEvaluation:j.target.checked?e.typeEvaluation??"formative":void 0}),style:{width:16,height:16,accentColor:"#2563eb"}}),"Cette sance est une valuation"]})}),e.estEvaluation&&t.jsxs("div",{className:"editor-form-grid",style:{background:"#fef2f2",padding:12,borderRadius:8,border:"1px solid #fecaca"},children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Type d'valuation"}),t.jsx("select",{className:"form-control",value:e.typeEvaluation??"formative",onChange:j=>v({typeEvaluation:j.target.value}),children:Object.entries(Aj).map(([j,_])=>t.jsx("option",{value:j,children:_},j))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Note maximale"}),t.jsx("input",{type:"number",className:"form-control",min:1,max:100,value:e.noteMax??20,onChange:j=>v({noteMax:Number(j.target.value)})})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Coefficient"}),t.jsx("input",{type:"number",className:"form-control",min:1,max:10,step:.5,value:e.coefficient??1,onChange:j=>v({coefficient:Number(j.target.value)})})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{style:{flexDirection:"row",alignItems:"center",display:"flex",gap:8},children:[t.jsx("input",{type:"checkbox",checked:e.exporterVersCahier,onChange:j=>v({exporterVersCahier:j.target.checked}),style:{width:16,height:16,accentColor:"#2563eb"}}),"Inclure dans l'export vers le Cahier de Textes"]}),e.entreesCahierIds&&e.entreesCahierIds.length>0&&t.jsxs("span",{className:"export-seance-row__exported",style:{marginTop:4},children:[" Dj exporte (",e.entreesCahierIds.length," entre",e.entreesCahierIds.length>1?"s":"",")"]})]}),t.jsxs("div",{className:"seance-card__actions",children:[t.jsx("button",{type:"button",className:"btn-seance-action btn-secondary",onClick:a,disabled:o,title:"Monter",children:""}),t.jsx("button",{type:"button",className:"btn-seance-action btn-secondary",onClick:l,disabled:u,title:"Descendre",children:""}),t.jsx("button",{type:"button",className:"btn-seance-action btn-seance-action--delete",onClick:n,children:" Supprimer cette sance"})]})]})]})},oee=({onSequenceGeneree:e,defaultMatiere:r,defaultNiveau:n,matieres:a})=>{const[l,o]=g.useState(r??""),[u,d]=g.useState(n??""),[f,p]=g.useState(""),[h,v]=g.useState(8),[b,x]=g.useState(55),[j,_]=g.useState(1),[C,w]=g.useState(""),[E,S]=g.useState(!1),[A,O]=g.useState({type:"idle",message:""}),k=async()=>{if(!l||!u||!f){O({type:"error",message:"Veuillez remplir la matire, le niveau et le thme."});return}S(!0),O({type:"loading",message:"L'IA gnre votre squence... (30-45 secondes)"});try{const P=await iee({matiere:l,niveau:u,theme:f,nombreSeances:h,dureeSeanceMinutes:b,trimestre:j,instructionsSupplementaires:C||void 0}),D=P.seances.map(B=>({...B,ressources:B.ressources??[]}));e({titre:P.titre,description:P.description,objectifGeneral:P.objectifGeneral,prerequis:P.prerequis,competences:P.competences,seances:D}),O({type:"success",message:` Squence gnre avec ${D.length} sances ! Vrifiez et compltez les informations.`})}catch(P){const D=P instanceof Error?P.message:"Erreur inconnue";O({type:"error",message:`Erreur IA : ${D}`})}finally{S(!1)}};return t.jsxs("div",{className:"ia-panel",children:[t.jsx("h3",{className:"ia-panel__title",children:" Gnration assiste par IA"}),t.jsx("p",{className:"ia-panel__subtitle",children:"Dcrivez votre squence et Claude gnre la structure complte"}),t.jsxs("div",{className:"ia-panel__form-grid",children:[t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{children:["Matire ",t.jsx("span",{className:"required",children:"*"})]}),t.jsxs("select",{className:"form-control",value:l,onChange:P=>o(P.target.value),children:[t.jsx("option",{value:"",children:"Slectionner..."}),a.map(P=>t.jsx("option",{value:P,children:P},P))]})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{children:["Niveau ",t.jsx("span",{className:"required",children:"*"})]}),t.jsxs("select",{className:"form-control",value:u,onChange:P=>d(P.target.value),children:[t.jsx("option",{value:"",children:"Slectionner..."}),wa.map(P=>t.jsx("option",{value:P,children:P},P))]})]}),t.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[t.jsxs("label",{children:["Thme / Chapitre ",t.jsx("span",{className:"required",children:"*"})]}),t.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Les fonctions affines, La photosynthse, La Rvolution franaise...",value:f,onChange:P=>p(P.target.value)})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Nombre de sances"}),t.jsx("input",{type:"number",className:"form-control",min:2,max:25,value:h,onChange:P=>v(Number(P.target.value))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Dure par sance"}),t.jsx("select",{className:"form-control",value:b,onChange:P=>x(Number(P.target.value)),children:yf.map(P=>t.jsxs("option",{value:P,children:[P," min"]},P))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Trimestre"}),t.jsxs("select",{className:"form-control",value:j,onChange:P=>_(Number(P.target.value)),children:[t.jsx("option",{value:1,children:"1er trimestre (OctDc)"}),t.jsx("option",{value:2,children:"2me trimestre (JanMars)"}),t.jsx("option",{value:3,children:"3me trimestre (AvrJuin)"})]})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Instructions supplmentaires (optionnel)"}),t.jsx("textarea",{className:"ia-panel__instructions",placeholder:"Ex : Insister sur la rsolution graphique, Inclure un TP sur GeoGebra, Prvoir une sance de remdiation...",value:C,onChange:P=>w(P.target.value),rows:2})]}),t.jsxs("button",{type:"button",className:"ia-panel__btn-generate",onClick:k,disabled:E,children:[E?t.jsx("span",{className:"spinner"}):"",E?"Gnration en cours...":"Gnrer avec l'IA"]}),A.type!=="idle"&&t.jsxs("div",{className:`ia-panel__status ia-panel__status--${A.type}`,children:[A.type==="loading"&&t.jsx("span",{className:"spinner spinner--blue"}),A.message]})]})},aA=()=>{const e=Je(),{id:r}=xn(),{currentUser:n}=Ke(),{matieres:a}=Ca(),l=!!r,[o,u]=g.useState({titre:"",description:"",niveau:"",matiere:"",theme:"",competences:[],objectifGeneral:"",prerequis:"",nombreSeances:6,dureeSeanceMinutes:55,seances:[],evaluationsPrevues:[],statut:"brouillon",genereeParIA:!1,trimestre:void 0,groupeClasseId:void 0,groupeClasseNom:void 0,cahierDeTextesId:void 0,cahierDeTextesNom:void 0}),[d,f]=g.useState([]),[p,h]=g.useState([]),[v,b]=g.useState([]),[x,j]=g.useState(l),[_,C]=g.useState(!1),[w,E]=g.useState(null),[S,A]=g.useState(null),[O,k]=g.useState(""),[P,D]=g.useState(!l);g.useEffect(()=>{(async()=>{if(!n?.uid)return;const[X,L]=await Promise.all([mM(n.uid).catch(()=>[]),hM(n.uid).catch(()=>[])]);if(h(X),b(L),l&&r){j(!0);try{const ne=await iu(r);if(!ne){E("Squence introuvable.");return}if(ne.profId!==n.uid){E("Accs non autoris.");return}u({titre:ne.titre,description:ne.description,niveau:ne.niveau,matiere:ne.matiere,theme:ne.theme,competences:ne.competences,objectifGeneral:ne.objectifGeneral,prerequis:ne.prerequis,nombreSeances:ne.nombreSeances,dureeSeanceMinutes:ne.dureeSeanceMinutes,statut:ne.statut,genereeParIA:ne.genereeParIA,trimestre:ne.trimestre,groupeClasseId:ne.groupeClasseId,groupeClasseNom:ne.groupeClasseNom,cahierDeTextesId:ne.cahierDeTextesId,cahierDeTextesNom:ne.cahierDeTextesNom}),f(ne.seances)}catch{E("Erreur de chargement. Ressayez.")}finally{j(!1)}}})()},[n?.uid,r,l]);const B=()=>{f(I=>[...I,see(I.length+1)])},U=(I,X)=>{f(L=>L.map((ne,K)=>K===I?X:ne))},$=I=>{f(X=>X.filter((L,ne)=>ne!==I).map((L,ne)=>({...L,numero:ne+1})))},R=I=>{I!==0&&f(X=>{const L=[...X];return[L[I-1],L[I]]=[L[I],L[I-1]],L.map((ne,K)=>({...ne,numero:K+1}))})},Y=I=>{f(X=>{if(I===X.length-1)return X;const L=[...X];return[L[I],L[I+1]]=[L[I+1],L[I]],L.map((ne,K)=>({...ne,numero:K+1}))})},ae=()=>{const I=O.trim();I&&(u(X=>({...X,competences:[...X.competences??[],I]})),k(""))},M=I=>{u(X=>({...X,competences:(X.competences??[]).filter((L,ne)=>ne!==I)}))},T=I=>{u(L=>({...L,titre:I.titre,description:I.description,objectifGeneral:I.objectifGeneral,prerequis:I.prerequis,competences:I.competences,genereeParIA:!0}));const X=I.seances.map(L=>({...L,id:NM(),exporterVersCahier:!0,entreesCahierIds:[]}));f(X),D(!1),window.scrollTo({top:0,behavior:"smooth"})},F=async()=>{if(!n?.uid)return;if(!o.titre?.trim()){E("Le titre est obligatoire.");return}if(!o.matiere?.trim()){E("La matire est obligatoire.");return}if(!o.niveau?.trim()){E("Le niveau est obligatoire.");return}const I=d.find(K=>!K.titre.trim());if(I){E(`La sance n${I.numero} n'a pas de titre.`);return}C(!0),E(null);const X=v.find(K=>K.id===o.groupeClasseId),L=p.find(K=>K.id===o.cahierDeTextesId),ne={titre:o.titre.trim(),description:o.description?.trim()??"",niveau:o.niveau,matiere:o.matiere.trim(),theme:o.theme?.trim()??"",competences:o.competences??[],objectifGeneral:o.objectifGeneral?.trim()??"",prerequis:o.prerequis?.trim()??"",nombreSeances:d.length,dureeSeanceMinutes:o.dureeSeanceMinutes??55,statut:o.statut??"brouillon",genereeParIA:o.genereeParIA??!1,trimestre:o.trimestre??null,seances:d,evaluationsPrevues:[],groupeClasseId:o.groupeClasseId||null,groupeClasseNom:X?.nom||o.groupeClasseNom||null,cahierDeTextesId:o.cahierDeTextesId||null,cahierDeTextesNom:L?.titre||o.cahierDeTextesNom||null};try{if(l&&r)await FJ(r,ne),A("Squence mise  jour avec succs !"),setTimeout(()=>e(`/prof/sequences/${r}`),1200);else{const K=await UJ(n.uid,ne);A("Squence cre avec succs !"),setTimeout(()=>e(`/prof/sequences/${K}`),1200)}}catch(K){console.error("[SequenceEditorPage] Sauvegarde:",K),E("Erreur lors de la sauvegarde. Ressayez.")}finally{C(!1)}};return x?t.jsxs("div",{className:"sequence-editor",children:[t.jsx("div",{className:"skeleton",style:{height:30,width:"50%",marginBottom:20}}),t.jsx("div",{className:"skeleton",style:{height:200,borderRadius:12}})]}):t.jsxs("div",{className:"sequence-editor",children:[t.jsxs("div",{className:"sequence-editor__header",children:[t.jsxs("p",{className:"sequence-editor__breadcrumb",children:[t.jsx("a",{onClick:()=>e("/prof/sequences"),style:{cursor:"pointer"},children:" Squences"})," / ",l?"Modifier":"Nouvelle squence"]}),t.jsx("h1",{className:"sequence-editor__title",children:l?" Modifier la squence":" Nouvelle squence"})]}),w&&t.jsxs("div",{className:"error-banner",role:"alert",children:[" ",w]}),S&&t.jsxs("div",{className:"success-banner",role:"status",children:[" ",S]}),t.jsx("div",{style:{marginBottom:8},children:t.jsx("button",{type:"button",className:"btn-secondary",style:{marginBottom:12},onClick:()=>D(I=>!I),children:P?" Masquer":" Gnrer avec l'IA"})}),P&&t.jsx(oee,{onSequenceGeneree:T,defaultMatiere:o.matiere,defaultNiveau:o.niveau,matieres:a.map(I=>I.valeur)}),t.jsxs("section",{className:"editor-section",children:[t.jsx("h2",{className:"editor-section__title",children:" Informations gnrales"}),t.jsxs("div",{className:"editor-form-grid",children:[t.jsxs("div",{className:"form-group editor-form-grid--full",children:[t.jsxs("label",{children:["Titre de la squence ",t.jsx("span",{className:"required",children:"*"})]}),t.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Les fonctions affines  Terminale S",value:o.titre??"",onChange:I=>u(X=>({...X,titre:I.target.value})),required:!0})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{children:["Matire ",t.jsx("span",{className:"required",children:"*"})]}),t.jsxs("select",{className:"form-control",value:o.matiere??"",onChange:I=>u(X=>({...X,matiere:I.target.value})),children:[t.jsx("option",{value:"",children:"Slectionner..."}),a.map(I=>t.jsx("option",{value:I.valeur,children:I.label},I.valeur))]})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{children:["Niveau ",t.jsx("span",{className:"required",children:"*"})]}),t.jsxs("select",{className:"form-control",value:o.niveau??"",onChange:I=>u(X=>({...X,niveau:I.target.value})),children:[t.jsx("option",{value:"",children:"Slectionner..."}),wa.map(I=>t.jsx("option",{value:I,children:I},I))]})]}),t.jsxs("div",{className:"form-group editor-form-grid--full",children:[t.jsx("label",{children:"Thme / Chapitre du programme"}),t.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Chapitre 4  Les vecteurs du plan",value:o.theme??"",onChange:I=>u(X=>({...X,theme:I.target.value}))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Trimestre"}),t.jsxs("select",{className:"form-control",value:o.trimestre??"",onChange:I=>u(X=>({...X,trimestre:I.target.value?Number(I.target.value):void 0})),children:[t.jsx("option",{value:"",children:"Non prcis"}),t.jsx("option",{value:"1",children:"1er trimestre (OctDc)"}),t.jsx("option",{value:"2",children:"2me trimestre (JanMars)"}),t.jsx("option",{value:"3",children:"3me trimestre (AvrJuin)"})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Dure standard d'une sance"}),t.jsx("select",{className:"form-control",value:o.dureeSeanceMinutes??55,onChange:I=>u(X=>({...X,dureeSeanceMinutes:Number(I.target.value)})),children:yf.map(I=>t.jsxs("option",{value:I,children:[I," minutes"]},I))})]}),t.jsxs("div",{className:"form-group editor-form-grid--full",children:[t.jsx("label",{children:"Description / Contexte"}),t.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Contexte de la squence dans le programme, niveau de la classe, prrequis globaux...",value:o.description??"",onChange:I=>u(X=>({...X,description:I.target.value})),rows:3})]}),t.jsxs("div",{className:"form-group editor-form-grid--full",children:[t.jsx("label",{children:"Objectif gnral"}),t.jsx("textarea",{className:"form-control form-control--textarea",placeholder:" la fin de cette squence, les lves seront capables de...",value:o.objectifGeneral??"",onChange:I=>u(X=>({...X,objectifGeneral:I.target.value})),rows:2})]}),t.jsxs("div",{className:"form-group editor-form-grid--full",children:[t.jsx("label",{children:"Prrequis"}),t.jsx("textarea",{className:"form-control form-control--textarea",placeholder:"Connaissances ncessaires avant cette squence...",value:o.prerequis??"",onChange:I=>u(X=>({...X,prerequis:I.target.value})),rows:2})]})]}),t.jsxs("div",{className:"form-group",style:{marginTop:14},children:[t.jsx("label",{children:"Comptences vises"}),t.jsx("div",{className:"competences-list",children:(o.competences??[]).map((I,X)=>t.jsxs("span",{className:"competence-tag",children:[I,t.jsx("button",{type:"button",className:"competence-tag__remove",onClick:()=>M(X),"aria-label":"Supprimer la comptence",children:""})]},X))}),t.jsxs("div",{className:"competence-input-row",children:[t.jsx("input",{type:"text",className:"form-control",placeholder:"Ex : Rsoudre une quation du second degr",value:O,onChange:I=>k(I.target.value),onKeyDown:I=>I.key==="Enter"&&(I.preventDefault(),ae())}),t.jsx("button",{type:"button",className:"btn-add-competence",onClick:ae,children:"+ Ajouter"})]})]})]}),t.jsxs("section",{className:"editor-section",children:[t.jsx("h2",{className:"editor-section__title",children:" Liens optionnels"}),t.jsxs("div",{className:"editor-form-grid",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Groupe-classe"}),t.jsxs("select",{className:"form-control",value:o.groupeClasseId??"",onChange:I=>u(X=>({...X,groupeClasseId:I.target.value||void 0})),children:[t.jsx("option",{value:"",children:"Aucun groupe"}),v.map(I=>t.jsxs("option",{value:I.id,children:[I.nom,"  ",I.classe]},I.id))]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Cahier de Textes"}),t.jsxs("select",{className:"form-control",value:o.cahierDeTextesId??"",onChange:I=>u(X=>({...X,cahierDeTextesId:I.target.value||void 0})),children:[t.jsx("option",{value:"",children:" Aucun cahier "}),p.filter(I=>o.matiere&&o.niveau?I.matiere===o.matiere&&I.classe===o.niveau:o.matiere?I.matiere===o.matiere:o.niveau?I.classe===o.niveau:!0).map(I=>t.jsxs("option",{value:I.id,children:[I.titre,"  ",I.classe,"  ",I.anneeScolaire]},I.id))]}),o.niveau&&o.matiere&&p.filter(I=>I.classe===o.niveau&&I.matiere===o.matiere).length===0&&t.jsxs("p",{style:{fontSize:"0.8rem",color:"#f59e0b",marginTop:6},children:[" Aucun cahier pour ",o.matiere,"  ",o.niveau,"."," ",t.jsx("a",{href:"/prof/cahiers",style:{color:"#2563eb",textDecoration:"underline"},children:"Crer un cahier"})]}),(!o.niveau||!o.matiere)&&p.length>0&&t.jsx("p",{style:{fontSize:"0.8rem",color:"#94a3b8",marginTop:6},children:" Slectionnez la matire et le niveau pour filtrer les cahiers."})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"Statut"}),t.jsxs("select",{className:"form-control",value:o.statut??"brouillon",onChange:I=>u(X=>({...X,statut:I.target.value})),children:[t.jsx("option",{value:"brouillon",children:"Brouillon"}),t.jsx("option",{value:"active",children:"En cours"}),t.jsx("option",{value:"terminee",children:"Termine"}),t.jsx("option",{value:"archivee",children:"Archive"})]})]})]})]}),t.jsxs("section",{className:"editor-section",children:[t.jsxs("div",{className:"seances-editor__header",children:[t.jsx("h2",{className:"editor-section__title",style:{margin:0},children:" Sances"}),t.jsxs("span",{className:"seances-editor__count",children:[d.length," sance",d.length>1?"s":"",d.filter(I=>I.estEvaluation).length>0&&`  ${d.filter(I=>I.estEvaluation).length} val.`]})]}),t.jsx("div",{className:"seances-list",children:d.length===0?t.jsx("p",{style:{color:"#94a3b8",fontSize:"0.875rem",textAlign:"center",padding:"20px 0"},children:"Aucune sance. Utilisez le bouton ci-dessous ou gnrez avec l'IA."}):d.map((I,X)=>t.jsx(lee,{seance:I,onChange:L=>U(X,L),onDelete:()=>$(X),onMoveUp:()=>R(X),onMoveDown:()=>Y(X),isFirst:X===0,isLast:X===d.length-1},I.id))}),t.jsx("button",{type:"button",className:"btn-add-seance",style:{marginTop:14},onClick:B,children:"+ Ajouter une sance"})]}),t.jsxs("div",{style:{position:"sticky",bottom:16,display:"flex",justifyContent:"flex-end",gap:10,background:"rgba(248,250,252,0.95)",backdropFilter:"blur(6px)",padding:"12px 0",zIndex:10},children:[t.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>e("/prof/sequences"),disabled:_,children:"Annuler"}),t.jsx("button",{type:"button",className:"btn-primary",onClick:F,disabled:_,children:_?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner"})," Enregistrement..."]}):l?" Mettre  jour":" Crer la squence"})]})]})},cee=({statut:e})=>{const{label:r}=_p[e];return t.jsxs("span",{className:`statut-badge statut-badge--${e}`,children:[t.jsx("span",{style:{width:6,height:6,borderRadius:"50%",background:"currentColor",display:"inline-block"}}),r]})},uee=({sequence:e,cahiers:r,profId:n,onClose:a,onSuccess:l})=>{const[o,u]=g.useState(e.cahierDeTextesId??(r.length===1?r[0].id:"")),[d,f]=g.useState(()=>{const w=new Date().toISOString().split("T")[0],E={};return e.seances.forEach(S=>{E[S.id]=w}),E}),[p,h]=g.useState(()=>{const w={};return e.seances.forEach(E=>{w[E.id]=E.exporterVersCahier&&(!E.entreesCahierIds||E.entreesCahierIds.length===0)}),w}),[v,b]=g.useState(!1),[x,j]=g.useState(null),_=Object.values(p).filter(Boolean).length,C=async()=>{if(!o){j("Veuillez slectionner un Cahier de Textes.");return}if(_===0){j("Slectionnez au moins une sance  exporter.");return}b(!0),j(null);const w={};e.seances.filter(E=>p[E.id]).forEach(E=>{const S=d[E.id];if(S){const A=Ae.fromDate(new Date(S+"T08:00:00"));w[E.id]=A}});try{const E=await VJ({sequenceId:e.id,cahierDeTextesId:o,profId:n,datesParSeance:w});E.erreurs.length>0&&j(`${E.erreurs.length} sance(s) n'ont pas pu tre exportes.`),l(E.nbExportees)}catch(E){const S=E instanceof Error?E.message:"Erreur inconnue";j(`Erreur d'export : ${S}`)}finally{b(!1)}};return g.useEffect(()=>{const w=E=>{E.key==="Escape"&&a()};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[a]),t.jsx("div",{className:"export-modal__overlay",onClick:w=>w.target===w.currentTarget&&a(),children:t.jsxs("div",{className:"export-modal",role:"dialog","aria-modal":"true","aria-labelledby":"export-modal-title",children:[t.jsxs("div",{className:"export-modal__header",children:[t.jsx("h2",{className:"export-modal__title",id:"export-modal-title",children:" Exporter vers le Cahier de Textes"}),t.jsx("button",{className:"export-modal__close",onClick:a,"aria-label":"Fermer",children:""})]}),t.jsxs("div",{className:"export-modal__body",children:[t.jsxs("div",{className:"form-group",style:{marginBottom:16},children:[t.jsxs("label",{style:{fontWeight:600,marginBottom:6,display:"block"},children:["Cahier de Textes cible ",t.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.length===0?t.jsx("p",{style:{color:"#dc2626",fontSize:"0.875rem"},children:"Aucun Cahier de Textes trouv. Crez-en un d'abord."}):t.jsxs("select",{className:"form-control",value:o,onChange:w=>u(w.target.value),children:[t.jsx("option",{value:"",children:"Slectionner un cahier..."}),r.map(w=>t.jsxs("option",{value:w.id,children:[w.titre,"  ",w.classe," (",w.anneeScolaire,")"]},w.id))]})]}),t.jsx("p",{style:{fontSize:"0.8125rem",color:"#64748b",marginBottom:12},children:"Slectionnez les sances  exporter et assignez leur une date. Chaque sance deviendra une entre dans le Cahier de Textes."}),e.seances.map(w=>{const E=(w.entreesCahierIds?.length??0)>0;return t.jsxs("div",{className:"export-seance-row",children:[t.jsx("input",{type:"checkbox",className:"export-seance-row__check",checked:!!p[w.id],onChange:S=>h(A=>({...A,[w.id]:S.target.checked})),id:`export-${w.id}`,"aria-label":`Exporter la sance ${w.numero}`}),t.jsxs("div",{className:"export-seance-row__info",children:[t.jsx("label",{htmlFor:`export-${w.id}`,style:{cursor:"pointer"},children:t.jsxs("div",{className:"export-seance-row__titre",children:[w.numero,". ",w.titre||`Sance ${w.numero}`]})}),t.jsxs("div",{className:"export-seance-row__type",children:[bf[w.typeActivite],"  ",w.dureeMinutes,"min",E&&t.jsx("span",{className:"export-seance-row__exported",style:{marginLeft:6},children:" Dj exporte"})]})]}),t.jsx("input",{type:"date",className:"export-seance-row__date",value:d[w.id]??"",onChange:S=>f(A=>({...A,[w.id]:S.target.value})),disabled:!p[w.id],"aria-label":`Date pour la sance ${w.numero}`})]},w.id)}),x&&t.jsxs("div",{className:"error-banner",style:{marginTop:12},children:[" ",x]})]}),t.jsxs("div",{className:"export-modal__footer",children:[t.jsx("button",{type:"button",className:"btn-secondary",onClick:a,disabled:v,children:"Annuler"}),t.jsx("button",{type:"button",className:"btn-success",onClick:C,disabled:v||_===0||!o,children:v?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner"})," Export en cours..."]}):` Exporter ${_} sance${_>1?"s":""}`})]})]})})},dee=()=>{const e=Je(),{id:r}=xn(),{currentUser:n}=Ke(),[a,l]=g.useState(null),[o,u]=g.useState([]),[d,f]=g.useState(!0),[p,h]=g.useState(null),[v,b]=g.useState(null),[x,j]=g.useState("seances"),[_,C]=g.useState(!1);g.useEffect(()=>{(async()=>{if(!(!n?.uid||!r)){f(!0);try{const[k,P]=await Promise.all([iu(r),mM(n.uid)]);if(!k){h("Squence introuvable.");return}if(k.profId!==n.uid){h("Accs non autoris.");return}l(k),u(P)}catch{h("Erreur de chargement.")}finally{f(!1)}}})()},[n?.uid,r]);const w=async()=>{if(!(!a||!window.confirm(`Supprimer "${a.titre}" ?
Cette action est irrversible.`)))try{await _M(a.id),e("/prof/sequences")}catch{h("Erreur lors de la suppression.")}},E=async O=>{if(a)try{await GJ(a.id,O),l(k=>k?{...k,statut:O}:null)}catch{h("Erreur de mise  jour du statut.")}},S=O=>{C(!1),b(` ${O} sance${O>1?"s":""} exporte${O>1?"s":""} vers le Cahier de Textes !`),r&&iu(r).then(k=>k&&l(k)).catch(()=>null),setTimeout(()=>b(null),5e3)};if(d)return t.jsxs("div",{className:"sequence-detail",children:[t.jsx("div",{className:"skeleton",style:{height:28,width:"50%",marginBottom:20}}),t.jsx("div",{className:"skeleton",style:{height:180,borderRadius:12,marginBottom:20}}),t.jsx("div",{className:"skeleton",style:{height:400,borderRadius:12}})]});if(p||!a)return t.jsxs("div",{className:"sequence-detail",children:[t.jsxs("div",{className:"error-banner",children:[" ",p??"Squence introuvable."]}),t.jsx("button",{className:"btn-secondary",onClick:()=>e("/prof/sequences"),children:" Retour"})]});const A=YJ.find(O=>O.valeur===a.niveau)?.label??a.niveau;return t.jsxs("div",{className:"sequence-detail",children:[_&&t.jsx(uee,{sequence:a,cahiers:o,profId:n.uid,onClose:()=>C(!1),onSuccess:S}),p&&t.jsxs("div",{className:"error-banner",role:"alert",children:[" ",p]}),v&&t.jsx("div",{className:"success-banner",role:"status",children:v}),t.jsxs("div",{className:"sequence-detail__header",children:[t.jsxs("p",{style:{fontSize:"0.8125rem",color:"#64748b",marginBottom:8},children:[t.jsx("a",{onClick:()=>e("/prof/sequences"),style:{color:"#2563eb",cursor:"pointer",fontWeight:500},children:" Squences"})," / ",a.titre]}),t.jsxs("div",{className:"sequence-detail__header-top",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"sequence-detail__title",children:a.titre}),t.jsxs("div",{className:"sequence-detail__meta",style:{marginTop:8},children:[t.jsx(cee,{statut:a.statut}),a.genereeParIA&&t.jsx("span",{className:"badge-ia",children:" IA"}),t.jsx("span",{className:"sequence-card__meta-chip",children:a.matiere}),t.jsx("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:A}),a.trimestre&&t.jsxs("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:["T",a.trimestre]}),a.groupeClasseNom&&t.jsxs("span",{className:"sequence-card__meta-chip sequence-card__meta-chip--grey",children:[" ",a.groupeClasseNom]})]})]}),t.jsxs("div",{className:"sequence-detail__actions",children:[t.jsx("select",{className:"form-control",style:{width:"auto",fontSize:"0.8rem"},value:a.statut,onChange:O=>E(O.target.value),"aria-label":"Changer le statut",children:Object.entries(_p).map(([O,{label:k}])=>t.jsx("option",{value:O,children:k},O))}),t.jsx("button",{className:"btn-success",onClick:()=>C(!0),title:"Exporter les sances vers le Cahier de Textes",children:" Exporter"}),t.jsx("button",{className:"btn-secondary",onClick:()=>e(`/prof/sequences/${a.id}/modifier`),children:" Modifier"}),t.jsx("button",{className:"btn-danger",onClick:w,children:""})]})]}),a.objectifGeneral&&t.jsxs("div",{className:"sequence-detail__objectif",children:[t.jsx("strong",{children:" Objectif :"})," ",a.objectifGeneral]}),t.jsxs("div",{style:{display:"flex",gap:16,marginTop:12,flexWrap:"wrap",fontSize:"0.8125rem",color:"#64748b"},children:[t.jsxs("span",{children:[" ",a.seances.length," sances"]}),t.jsxs("span",{children:[" ",a.evaluationsPrevues.length," valuation",a.evaluationsPrevues.length>1?"s":""]}),t.jsxs("span",{children:[" ",a.seances.reduce((O,k)=>O+k.dureeMinutes,0)," min total"]}),a.cahierDeTextesNom&&t.jsxs("span",{children:[" ",a.cahierDeTextesNom]}),a.exporteAt&&t.jsxs("span",{children:[" Export le ",a.exporteAt.toDate().toLocaleDateString("fr-FR")]})]})]}),t.jsxs("div",{className:"sequence-tabs",role:"tablist",children:[t.jsxs("button",{role:"tab",className:`sequence-tab${x==="seances"?" sequence-tab--active":""}`,onClick:()=>j("seances"),"aria-selected":x==="seances",children:[" Sances (",a.seances.length,")"]}),t.jsxs("button",{role:"tab",className:`sequence-tab${x==="evaluations"?" sequence-tab--active":""}`,onClick:()=>j("evaluations"),"aria-selected":x==="evaluations",children:[" valuations (",a.evaluationsPrevues.length,")"]}),t.jsx("button",{role:"tab",className:`sequence-tab${x==="infos"?" sequence-tab--active":""}`,onClick:()=>j("infos"),"aria-selected":x==="infos",children:" Dtails"})]}),x==="seances"&&t.jsx("div",{role:"tabpanel",children:a.seances.length===0?t.jsxs("div",{className:"sequences-empty",children:[t.jsx("span",{className:"sequences-empty__icon",children:""}),t.jsx("p",{className:"sequences-empty__text",children:"Aucune sance planifie"}),t.jsx("button",{className:"btn-primary",onClick:()=>e(`/prof/sequences/${a.id}/modifier`),children:" Ajouter des sances"})]}):t.jsx("div",{className:"sequence-timeline",children:a.seances.map(O=>t.jsx(mee,{seance:O},O.id))})}),x==="evaluations"&&t.jsxs("div",{role:"tabpanel",className:"evaluations-panel",children:[t.jsx("h3",{className:"evaluations-panel__title",children:" valuations prvues"}),a.evaluationsPrevues.length===0?t.jsx("p",{style:{color:"#94a3b8",fontSize:"0.875rem"},children:'Aucune valuation marque dans cette squence. Modifiez une sance et cochez "Cette sance est une valuation".'}):a.evaluationsPrevues.map(O=>t.jsxs("div",{className:"evaluation-row",children:[t.jsxs("div",{className:"evaluation-row__numero",children:["S",O.seanceNumero]}),t.jsxs("div",{className:"evaluation-row__info",children:[t.jsx("div",{className:"evaluation-row__titre",children:O.titre}),t.jsxs("div",{className:"evaluation-row__type",children:[Aj[O.type],O.datePrevue&&`  ${O.datePrevue.toDate().toLocaleDateString("fr-FR")}`]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"evaluation-row__note",children:["/",O.noteMax]}),t.jsxs("div",{className:"evaluation-row__coeff",children:["Coeff. ",O.coefficient]})]})]},O.id))]}),x==="infos"&&t.jsx("div",{role:"tabpanel",children:t.jsxs("div",{className:"editor-section",children:[a.competences.length>0&&t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:700,color:"#374151",marginBottom:8},children:"Comptences vises"}),t.jsx("div",{className:"competences-list",children:a.competences.map((O,k)=>t.jsx("span",{className:"competence-tag",children:O},k))})]}),a.prerequis&&t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:700,color:"#374151",marginBottom:6},children:"Prrequis"}),t.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",lineHeight:1.6},children:a.prerequis})]}),a.description&&t.jsxs("div",{style:{marginBottom:16},children:[t.jsx("h4",{style:{fontSize:"0.875rem",fontWeight:700,color:"#374151",marginBottom:6},children:"Description"}),t.jsx("p",{style:{fontSize:"0.875rem",color:"#64748b",lineHeight:1.6},children:a.description})]}),t.jsxs("div",{style:{borderTop:"1px solid #f1f5f9",paddingTop:12,fontSize:"0.8rem",color:"#94a3b8"},children:[t.jsxs("p",{children:["Cre le ",a.createdAt.toDate().toLocaleDateString("fr-FR")]}),t.jsxs("p",{children:["Modifie le ",a.updatedAt.toDate().toLocaleDateString("fr-FR")]}),a.genereeParIA&&t.jsx("p",{children:" Gnre avec l'IA Claude"})]})]})})]})},mee=({seance:e})=>{const[r,n]=g.useState(!1),a=(e.entreesCahierIds?.length??0)>0;return t.jsx("div",{className:`timeline-item${e.estEvaluation?" timeline-item--eval":""}`,children:t.jsxs("div",{className:"timeline-card",children:[t.jsxs("div",{className:"timeline-card__header",onClick:()=>n(l=>!l),style:{cursor:"pointer"},children:[t.jsxs("h3",{className:"timeline-card__title",children:[e.numero,". ",e.titre||`Sance ${e.numero}`]}),t.jsxs("div",{className:"timeline-card__meta",children:[t.jsx("span",{className:`type-activite-badge type-activite-badge--${e.typeActivite}`,children:bf[e.typeActivite]}),t.jsxs("span",{className:"timeline-card__duree",children:[e.dureeMinutes,"min"]}),a&&t.jsx("span",{className:"export-seance-row__exported",children:" Exporte"}),t.jsx("span",{style:{color:"#94a3b8",fontSize:"0.7rem"},children:r?"":""})]})]}),e.objectifSpecifique&&t.jsxs("p",{className:"timeline-card__objectif",children:[" ",e.objectifSpecifique]}),r&&t.jsxs(t.Fragment,{children:[e.contenu&&t.jsx("p",{className:"timeline-card__contenu",style:{marginTop:8},children:e.contenu}),e.ressources.length>0&&t.jsx("div",{className:"timeline-card__ressources",children:e.ressources.map((l,o)=>t.jsx("span",{className:"ressource-chip",children:l},o))}),e.estEvaluation&&e.typeEvaluation&&t.jsxs("div",{style:{marginTop:10,padding:"8px 12px",background:"#fef2f2",borderRadius:6,fontSize:"0.8rem",color:"#dc2626"},children:[" ",Aj[e.typeEvaluation],e.noteMax&&`  /${e.noteMax}`,e.coefficient&&`  Coeff. ${e.coefficient}`]})]})]})})};function fee({cours:e,onClick:r}){const n=e.dureeEstimee>=60?`${Math.floor(e.dureeEstimee/60)}h${e.dureeEstimee%60>0?e.dureeEstimee%60:""}`:`${e.dureeEstimee} min`,a=Uc.find(l=>l.valeur===e.niveau)?.label??e.niveau;return t.jsxs("article",{className:"cours-card",onClick:r,role:"button",tabIndex:0,onKeyDown:l=>l.key==="Enter"&&r(),"aria-label":`Cours : ${e.titre}`,children:[t.jsxs("div",{className:"cours-card__cover",children:[e.couvertureUrl?t.jsx("img",{src:e.couvertureUrl,alt:e.titre,loading:"lazy"}):t.jsx("div",{className:"cours-card__cover-placeholder",children:t.jsx("span",{children:e.matiere.charAt(0)})}),e.isPremium&&t.jsx("span",{className:"cours-card__badge cours-card__badge--premium",children:" Premium"}),!e.isPremium&&t.jsx("span",{className:"cours-card__badge cours-card__badge--gratuit",children:" Gratuit"})]}),t.jsxs("div",{className:"cours-card__body",children:[t.jsxs("div",{className:"cours-card__meta",children:[t.jsx("span",{className:"cours-card__matiere",children:e.matiere}),t.jsx("span",{className:"cours-card__niveau",children:a})]}),t.jsx("h3",{className:"cours-card__titre",children:e.titre}),t.jsx("p",{className:"cours-card__description",children:e.description}),t.jsxs("div",{className:"cours-card__footer",children:[t.jsxs("span",{className:"cours-card__prof",children:[" ",e.profNom]}),t.jsxs("div",{className:"cours-card__stats",children:[t.jsxs("span",{children:[" ",e.nombreSections," section",e.nombreSections>1?"s":""]}),t.jsxs("span",{children:[" ",n]}),t.jsxs("span",{children:[" ",e.nombreInscrits]})]})]})]})]})}function pee(){const e=Je(),{currentUser:r}=Ke(),{matieres:n}=Ca(),a=r?.subscriptionPlan,l=r?.isPremium&&a&&Hb(a),[o,u]=g.useState([]),[d,f]=g.useState([]),[p,h]=g.useState(!0),[v,b]=g.useState(null),[x,j]=g.useState({matiere:"",niveau:"",recherche:"",isPremium:""});g.useEffect(()=>{_()},[]);async function _(){h(!0),b(null);try{const S=await zA();u(S),f(S)}catch(S){console.error("[CoursPage] Erreur chargement :",S),b("Impossible de charger les cours. Vrifiez votre connexion.")}finally{h(!1)}}const C=g.useCallback(S=>{j(S);let A=[...o];if(S.matiere&&(A=A.filter(O=>O.matiere===S.matiere)),S.niveau&&(A=A.filter(O=>O.niveau===S.niveau)),S.isPremium!==""&&S.isPremium!==void 0&&(A=A.filter(O=>O.isPremium===S.isPremium)),S.recherche){const O=S.recherche.toLowerCase();A=A.filter(k=>k.titre.toLowerCase().includes(O)||k.description.toLowerCase().includes(O)||k.matiere.toLowerCase().includes(O)||k.tags.some(P=>P.toLowerCase().includes(O)))}f(A)},[o]),w=()=>{j({matiere:"",niveau:"",recherche:"",isPremium:""}),f(o)},E=!!(x.matiere||x.niveau||x.recherche||x.isPremium!=="");return t.jsxs("div",{className:"cours-catalogue",children:[t.jsx("section",{className:"cours-catalogue__hero","aria-label":"Introduction aux cours",children:t.jsxs("div",{className:"cours-catalogue__hero-content",children:[t.jsx("h1",{className:"cours-catalogue__hero-titre",children:" Cours en ligne"}),t.jsx("p",{className:"cours-catalogue__hero-sous-titre",children:"Des cours complets du programme sngalais  de la 6me au Bac. Crs par vos professeurs, accessibles partout, mme hors-ligne."}),l&&t.jsx("button",{className:"btn-primary",onClick:()=>e("/premium/mes-cours"),style:{marginTop:"1rem"},children:" Choisir mes cours"}),t.jsxs("div",{className:"cours-catalogue__hero-stats","aria-label":"Statistiques de la plateforme",children:[t.jsxs("div",{className:"cours-catalogue__stat",children:[t.jsx("span",{className:"cours-catalogue__stat-val",children:o.length}),t.jsx("span",{className:"cours-catalogue__stat-label",children:"Cours disponibles"})]}),t.jsxs("div",{className:"cours-catalogue__stat",children:[t.jsx("span",{className:"cours-catalogue__stat-val",children:o.filter(S=>!S.isPremium).length}),t.jsx("span",{className:"cours-catalogue__stat-label",children:"Cours gratuits"})]}),t.jsxs("div",{className:"cours-catalogue__stat",children:[t.jsx("span",{className:"cours-catalogue__stat-val",children:[...new Set(o.map(S=>S.matiere))].length}),t.jsx("span",{className:"cours-catalogue__stat-label",children:"Matires"})]})]})]})}),t.jsx("section",{className:"cours-catalogue__filtres","aria-label":"Filtres de recherche",children:t.jsxs("div",{className:"cours-catalogue__filtres-inner",children:[t.jsxs("div",{className:"cours-catalogue__search",children:[t.jsx("span",{className:"cours-catalogue__search-icon","aria-hidden":"true",children:""}),t.jsx("input",{type:"search",placeholder:"Rechercher un cours, une matire, un tag...",value:x.recherche,onChange:S=>C({...x,recherche:S.target.value}),className:"cours-catalogue__search-input","aria-label":"Rechercher dans les cours"})]}),t.jsxs("select",{value:x.matiere,onChange:S=>C({...x,matiere:S.target.value}),className:"cours-catalogue__select","aria-label":"Filtrer par matire",children:[t.jsx("option",{value:"",children:"Toutes les matires"}),n.map(S=>t.jsx("option",{value:S.valeur,children:S.label},S.valeur))]}),t.jsxs("select",{value:x.niveau,onChange:S=>C({...x,niveau:S.target.value}),className:"cours-catalogue__select","aria-label":"Filtrer par niveau",children:[t.jsx("option",{value:"",children:"Tous les niveaux"}),wa.map(S=>t.jsx("option",{value:S,children:S},S))]}),t.jsxs("select",{value:String(x.isPremium),onChange:S=>{const A=S.target.value===""?"":S.target.value==="true";C({...x,isPremium:A})},className:"cours-catalogue__select","aria-label":"Filtrer par accs",children:[t.jsx("option",{value:"",children:"Tous les accs"}),t.jsx("option",{value:"false",children:" Gratuits"}),t.jsx("option",{value:"true",children:" Premium"})]}),E&&t.jsx("button",{className:"btn-secondary btn--sm",onClick:w,"aria-label":"Effacer les filtres",children:" Effacer les filtres"})]})}),t.jsxs("main",{className:"cours-catalogue__contenu",children:[v&&t.jsxs("div",{className:"error-banner",role:"alert",children:[" ",v,t.jsx("button",{className:"btn-link",onClick:_,children:"Ressayer"})]}),p&&t.jsx("div",{className:"cours-catalogue__grille","aria-busy":"true","aria-label":"Chargement des cours",children:[1,2,3,4,5,6].map(S=>t.jsxs("div",{className:"cours-card cours-card--skeleton",children:[t.jsx("div",{className:"skeleton cours-card__cover"}),t.jsxs("div",{className:"cours-card__body",children:[t.jsx("div",{className:"skeleton",style:{height:16,width:"60%",marginBottom:8}}),t.jsx("div",{className:"skeleton",style:{height:20,marginBottom:8}}),t.jsx("div",{className:"skeleton",style:{height:14,width:"80%"}})]})]},S))}),!p&&d.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"cours-catalogue__compteur","aria-live":"polite",children:[d.length," cours trouv",d.length>1?"s":"",E&&" pour ces critres"]}),t.jsx("div",{className:"cours-catalogue__grille",children:d.map(S=>t.jsx(fee,{cours:S,onClick:()=>e(`/cours/${S.id}`)},S.id))})]}),!p&&d.length===0&&!v&&t.jsxs("div",{className:"cours-catalogue__vide",role:"status",children:[t.jsx("span",{"aria-hidden":"true",children:""}),t.jsx("h3",{children:"Aucun cours trouv"}),t.jsx("p",{children:E?"Essayez de modifier ou supprimer vos filtres.":"Les cours seront disponibles bientt. Revenez dans quelques jours !"}),E&&t.jsx("button",{className:"btn-secondary",onClick:w,children:"Afficher tous les cours"})]})]})]})}const el="progression_cours";async function iA(e,r){const n=Ee(_e(Q,el),Ne("userId","==",e),Ne("coursId","==",r)),a=await Ce(n);if(a.empty)return null;const l=a.docs[0];return{id:l.id,...l.data()}}async function hee(e){const r=Ee(_e(Q,el),Ne("coursId","==",e));return(await Ce(r)).docs.map(a=>({id:a.id,...a.data()}))}async function vee(e,r){const n=Ae.now(),a=await Pt(_e(Q,el),{userId:e,coursId:r,sectionsLues:[],reponsesQuiz:[],pourcentageProgression:0,scoreQuiz:0,tentativesQuiz:0,debutLe:n,dernierAcces:n,estTermine:!1});return await q5(r),a.id}async function gee(e,r,n){const a=await Et(je(Q,el,e));if(!a.exists())return;const l=a.data();if(l.sectionsLues.includes(r))return;const o=[...l.sectionsLues,r],u=Math.round(o.length/n*100),d=o.length>=n;await He(je(Q,el,e),{sectionsLues:$b(r),pourcentageProgression:u,estTermine:d,dernierAcces:Ae.now()})}async function xee(e,r){const n=await Et(je(Q,el,e));if(!n.exists())return;const a=n.data(),l=a.reponsesQuiz??[];if(l.some(p=>p.blocId===r.blocId))return;const u=[...l,r],d=u.filter(p=>p.estCorrecte).length,f=u.length>0?Math.round(d/u.length*100):0;await He(je(Q,el,e),{reponsesQuiz:$b(r),scoreQuiz:f,tentativesQuiz:a.tentativesQuiz+1,dernierAcces:Ae.now()})}function bee(e){if(e.length===0)return{nombreInscrits:0,nombreTermines:0,tauxCompletion:0,progressionMoyenne:0,scoreMoyen:0};const r=e.filter(l=>l.estTermine).length,n=Math.round(e.reduce((l,o)=>l+o.pourcentageProgression,0)/e.length),a=Math.round(e.reduce((l,o)=>l+o.scoreQuiz,0)/e.length);return{nombreInscrits:e.length,nombreTermines:r,tauxCompletion:Math.round(r/e.length*100),progressionMoyenne:n,scoreMoyen:a}}function yee({bloc:e}){const r=e.contenu.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/^- (.+)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)/gs,"<ul>$1</ul>").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br/>");return t.jsx("div",{className:"bloc-texte",dangerouslySetInnerHTML:{__html:`<p>${r}</p>`}})}function jee({bloc:e}){return t.jsxs("figure",{className:"bloc-image",children:[t.jsx("img",{src:e.url,alt:e.alt,loading:"lazy"}),e.legende&&t.jsx("figcaption",{children:e.legende})]})}function _ee({bloc:e}){const r=w5(e.urlYoutube);return r?t.jsxs("div",{className:"bloc-video",children:[e.titre&&t.jsxs("h4",{className:"bloc-video__titre",children:[" ",e.titre]}),e.description&&t.jsx("p",{className:"bloc-video__description",children:e.description}),t.jsx("div",{className:"bloc-video__embed",children:t.jsx("iframe",{src:`https://www.youtube.com/embed/${r}`,title:e.titre||"Vido pdagogique",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy"})})]}):null}function Nee({bloc:e}){const r=RA[e.variante];return t.jsxs("div",{className:"bloc-encadre",style:{background:r.bg,borderLeftColor:r.border,color:r.color},children:[t.jsxs("p",{className:"bloc-encadre__titre",children:[r.emoji," ",e.titre]}),t.jsx("p",{className:"bloc-encadre__contenu",children:e.contenu})]})}function See({bloc:e,onReponse:r,reponseExistante:n}){const[a,l]=g.useState(n??null),o=a!==null;function u(d,f){o||(l(d),r(d,f))}return t.jsxs("div",{className:"bloc-quiz",children:[t.jsxs("p",{className:"bloc-quiz__question",children:[" ",e.question]}),t.jsx("div",{className:"bloc-quiz__options",children:e.options.map(d=>{let f="";return o&&(d.id===a?f=d.estCorrecte?"correct":"incorrect":d.estCorrecte&&(f="attendu")),t.jsxs("button",{className:`bloc-quiz__option bloc-quiz__option--${f||"neutre"}`,onClick:()=>u(d.id,d.estCorrecte),disabled:o,"aria-pressed":d.id===a,children:[f==="correct"&&" ",f==="incorrect"&&" ",f==="attendu"&&" ",d.texte]},d.id)})}),o&&e.explication&&t.jsxs("div",{className:"bloc-quiz__explication",children:[" ",t.jsx("strong",{children:"Explication :"})," ",e.explication]})]})}function wee({bloc:e}){const[r,n]=g.useState(!1),a={facile:"#16a34a",moyen:"#ca8a04",difficile:"#dc2626"};return t.jsxs("div",{className:"bloc-exercice",children:[t.jsxs("div",{className:"bloc-exercice__header",children:[t.jsx("span",{className:"bloc-exercice__titre",children:" Exercice"}),t.jsxs("span",{className:"bloc-exercice__difficulte",style:{color:a[e.difficulte]},children:[e.difficulte.charAt(0).toUpperCase()+e.difficulte.slice(1),e.points&&`  ${e.points} pt${e.points>1?"s":""}`]})]}),t.jsx("p",{className:"bloc-exercice__enonce",children:e.enonce}),r?t.jsxs("div",{className:"bloc-exercice__correction",children:[t.jsx("p",{className:"bloc-exercice__correction-titre",children:" Correction"}),t.jsx("p",{children:e.correction})]}):t.jsx("button",{className:"btn-secondary btn--sm",onClick:()=>n(!0),children:" Voir la correction"})]})}function Cee({bloc:e,isPremiumVerrou:r,onReponseQuiz:n,reponseExistante:a}){if(r)return t.jsxs("div",{className:"bloc-premium-verrou","aria-label":"Contenu Premium",children:[t.jsx("span",{children:""}),t.jsx("p",{children:"Ce contenu est rserv aux abonns Premium."})]});switch(e.type){case"texte":return t.jsx(yee,{bloc:e});case"image":return t.jsx(jee,{bloc:e});case"video":return t.jsx(_ee,{bloc:e});case"encadre":return t.jsx(Nee,{bloc:e});case"quiz":return t.jsx(See,{bloc:e,reponseExistante:a,onReponse:(l,o)=>n(e.id,l,o)});case"exercice":return t.jsx(wee,{bloc:e});default:return null}}function Eee(){const{coursId:e}=xn(),r=Je(),{currentUser:n}=Ke(),a=n?.isPremium??!1,l=a&&B5(e||"",a,n?.subscriptionPlan,n?.coursChoisis??[]),[o,u]=g.useState(null),[d,f]=g.useState([]),[p,h]=g.useState(null),[v,b]=g.useState(null),[x,j]=g.useState(!0),[_,C]=g.useState(null),w=g.useRef(null);g.useEffect(()=>{e&&E()},[e,n]);async function E(){if(e){j(!0),C(null);try{const[U,$]=await Promise.all([kA(e),OA(e)]);if(!U||U.statut!=="publie"){C("Ce cours n'est pas disponible."),j(!1);return}if(u(U),f($),$.length>0&&b($[0].id),n){let R=await iA(n.uid,e);R||(await vee(n.uid,e),R=await iA(n.uid,e)),h(R)}}catch(U){console.error("[CoursDetailPage] Erreur chargement :",U),C("Erreur de chargement. Vrifiez votre connexion.")}finally{j(!1)}}}function S(U){const $=U.blocs.filter(M=>M.type==="quiz");if($.length===0)return!0;const R=p?.reponsesQuiz.filter(M=>$.some(T=>T.id===M.blocId))??[];return R.length<$.length?!1:R.filter(M=>M.estCorrecte).length/$.length*100>=60}async function A(U){if(!n||!p||!o||p.sectionsLues.includes(U))return;const $=d.find(R=>R.id===U);if($&&!S($)){C("Russissez les quiz de cette section (60% minimum) pour continuer.");return}try{await gee(p.id,U,o.nombreSections),h(R=>R?{...R,sectionsLues:[...R.sectionsLues,U],pourcentageProgression:Math.round((R.sectionsLues.length+1)/o.nombreSections*100)}:null)}catch(R){console.error("[CoursDetailPage] Erreur marquer section :",R)}}async function O(U,$,R){if(!(!n||!p))try{await xee(p.id,{blocId:U,optionChoisieId:$,estCorrecte:R,reponduAt:Ae.now()})}catch(Y){console.error("[CoursDetailPage] Erreur enregistrement quiz :",Y)}}function k(U){return!!(U.estGratuite||U.ordre===1||!o?.isPremium||l)}if(x)return t.jsxs("div",{className:"cours-detail__loading","aria-busy":"true",children:[t.jsx("div",{className:"spinner spinner--blue"}),t.jsx("p",{children:"Chargement du cours..."})]});if(_||!o)return t.jsxs("div",{className:"cours-detail__erreur",role:"alert",children:[t.jsx("span",{"aria-hidden":"true",children:""}),t.jsx("p",{children:_??"Cours introuvable."}),t.jsx("button",{className:"btn-secondary",onClick:()=>r("/cours"),children:" Retour au catalogue"})]});const P=Uc.find(U=>U.valeur===o.niveau)?.label??o.niveau,D=d.find(U=>U.id===v),B=D?k(D):!1;return t.jsxs("div",{className:"cours-detail",children:[t.jsxs("header",{className:"cours-detail__header",children:[t.jsxs("p",{className:"cours-detail__breadcrumb",children:[t.jsx("button",{className:"btn-link",onClick:()=>r("/cours"),children:" Cours"})," / ",t.jsx("span",{children:o.matiere})," / ",t.jsx("span",{children:o.titre})]}),t.jsxs("div",{className:"cours-detail__header-grid",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"cours-detail__badges",children:[t.jsx("span",{className:"badge badge--matiere",children:o.matiere}),t.jsx("span",{className:"badge badge--niveau",children:P}),o.isPremium?t.jsx("span",{className:"badge badge--premium",children:" Premium"}):t.jsx("span",{className:"badge badge--gratuit",children:" Gratuit"})]}),t.jsx("h1",{className:"cours-detail__titre",children:o.titre}),t.jsx("p",{className:"cours-detail__description",children:o.description}),t.jsxs("p",{className:"cours-detail__prof",children:[" Cours de ",t.jsx("strong",{children:o.profNom})]}),o.objectifs.length>0&&t.jsxs("div",{className:"cours-detail__objectifs",children:[t.jsx("h3",{children:" Objectifs du cours"}),t.jsx("ul",{children:o.objectifs.map((U,$)=>t.jsx("li",{children:U},$))})]})]}),n&&p&&t.jsxs("div",{className:"cours-detail__progression-card",children:[t.jsx("h3",{children:" Ma progression"}),t.jsx("div",{className:"progression-bar",children:t.jsx("div",{className:"progression-bar__fill",style:{width:`${p.pourcentageProgression}%`},role:"progressbar","aria-valuenow":p.pourcentageProgression,"aria-valuemin":0,"aria-valuemax":100})}),t.jsxs("p",{className:"progression-bar__label",children:[p.pourcentageProgression,"%  ",p.sectionsLues.length,"/",o.nombreSections," section",o.nombreSections>1?"s":""," lue",p.sectionsLues.length>1?"s":""]}),p.scoreQuiz>0&&t.jsxs("p",{className:"progression-bar__score",children:[" Score quiz : ",t.jsxs("strong",{children:[p.scoreQuiz,"%"]})]}),p.estTermine&&t.jsx("div",{className:"cours-detail__termine-badge",children:" Cours termin !"})]})]})]}),t.jsxs("div",{className:"cours-detail__layout",children:[t.jsxs("nav",{className:"cours-detail__sidebar","aria-label":"Sections du cours",children:[t.jsx("h2",{className:"cours-detail__sidebar-titre",children:" Sections"}),t.jsx("ol",{className:"cours-detail__sections-liste",children:d.map(U=>{const $=p?.sectionsLues.includes(U.id)??!1,R=U.id===v,Y=k(U);return t.jsx("li",{children:t.jsxs("button",{className:["cours-detail__section-btn",R?"cours-detail__section-btn--active":"",$?"cours-detail__section-btn--lue":"",Y?"":"cours-detail__section-btn--verrou"].join(" "),onClick:()=>b(U.id),"aria-current":R?"true":void 0,children:[t.jsx("span",{className:"cours-detail__section-icone","aria-hidden":"true",children:Y?$?"":`${U.ordre}.`:""}),t.jsx("span",{className:"cours-detail__section-nom",children:U.titre}),t.jsxs("span",{className:"cours-detail__section-duree",children:[U.dureeEstimee," min"]})]})},U.id)})})]}),t.jsx("main",{className:"cours-detail__contenu",ref:w,"aria-live":"polite",children:D?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"cours-detail__section-header",children:[t.jsxs("h2",{className:"cours-detail__section-titre",children:[D.ordre,". ",D.titre]}),t.jsxs("span",{className:"cours-detail__section-duree-label",children:[" ",D.dureeEstimee," min de lecture"]})]}),B?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"cours-detail__blocs",children:D.blocs.sort((U,$)=>U.ordre-$.ordre).map(U=>{const $=U.isPremium&&!a&&!D.estGratuite,R=p?.reponsesQuiz.find(Y=>Y.blocId===U.id)?.optionChoisieId;return t.jsx("div",{className:`cours-detail__bloc cours-detail__bloc--${U.type}`,children:t.jsx(Cee,{bloc:U,isPremiumVerrou:$,onReponseQuiz:O,reponseExistante:R})},U.id)})}),n&&!p?.sectionsLues.includes(D.id)&&t.jsx("div",{className:"cours-detail__action-lu",children:t.jsx("button",{className:"btn-primary",onClick:()=>A(D.id),children:" Marquer cette section comme lue"})}),t.jsxs("div",{className:"cours-detail__nav-sections",children:[!S(D)&&D.blocs.some(U=>U.type==="quiz")&&t.jsx("p",{className:"cours-detail__quiz-requis",role:"alert",children:" Russissez les quiz de cette section (60% minimum) pour passer  la suite."}),D.ordre>1&&t.jsx("button",{className:"btn-secondary",onClick:()=>{const U=d.find($=>$.ordre===D.ordre-1);U&&b(U.id)},children:" Section prcdente"}),D.ordre<d.length&&t.jsx("button",{className:"btn-primary",onClick:()=>{if(!S(D)&&D.blocs.some($=>$.type==="quiz"))return;const U=d.find($=>$.ordre===D.ordre+1);U&&b(U.id)},children:"Section suivante "})]})]}):t.jsxs("div",{className:"cours-detail__premium-gate",children:[t.jsx("span",{className:"cours-detail__premium-gate-icon","aria-hidden":"true",children:""}),t.jsx("h3",{children:"Contenu Premium"}),t.jsxs("p",{children:["Cette section ncessite un abonnement Premium PedaClic.",t.jsx("br",{}),"Formules  partir de ",t.jsx("strong",{children:"1 000 FCFA/mois"})," (1 cours) jusqu' l'accs illimit (ds 10 000 FCFA / 3 mois)."]}),n?t.jsxs("div",{className:"cours-detail__premium-gate-actions",children:[t.jsx("button",{className:"btn-primary",onClick:()=>r("/premium"),children:" Dcouvrir les formules"}),n.isPremium&&t.jsx("button",{className:"btn-secondary",onClick:()=>r("/premium/mes-cours"),children:" Choisir mes cours"})]}):t.jsx("button",{className:"btn-primary",onClick:()=>r("/connexion"),children:"Se connecter pour accder"})]})]}):t.jsx("div",{className:"cours-detail__vide-section",role:"status",children:t.jsx("p",{children:"Slectionnez une section dans le menu de gauche pour commencer."})})})]})]})}const Aee=["image/jpeg","image/png","image/gif","image/webp"],zee=".jpg,.jpeg,.png,.gif,.webp",SM=({storagePath:e,existingUrl:r,onUploadComplete:n,onUploadStart:a,onUploadError:l,placeholder:o="Glissez une image ici ou cliquez pour parcourir",disabled:u=!1,maxSizeMo:d=5})=>{const[f,p]=g.useState({status:"idle",progress:0,errorMessage:null,previewUrl:r||null}),[h,v]=g.useState(!1),b=g.useRef(null),x=g.useCallback(U=>{if(!Aee.includes(U.type))return`Type non support : ${U.type}. Utilisez JPG, PNG, GIF ou WebP.`;const $=U.size/(1024*1024);return $>d?`Fichier trop lourd : ${$.toFixed(1)} Mo (max ${d} Mo).`:null},[d]),j=U=>{const $=Date.now(),R=U.split(".").pop()?.toLowerCase()||"jpg";return`${U.replace(/\.[^/.]+$/,"").replace(/[^a-zA-Z0-9_-]/g,"_").slice(0,30)}_${$}.${R}`},_=g.useCallback(async U=>{const $=x(U);if($){p(F=>({...F,status:"error",errorMessage:$})),l?.($);return}const R=URL.createObjectURL(U);p({status:"uploading",progress:0,errorMessage:null,previewUrl:R}),a?.();const Y=j(U.name),ae=`${e}/${Y}`,M=sr(er,ae),T=lu(M,U,{contentType:U.type,customMetadata:{uploadedBy:"pedaclic-prof",originalName:U.name}});T.on("state_changed",F=>{const I=Math.round(F.bytesTransferred/F.totalBytes*100);p(X=>({...X,progress:I}))},F=>{URL.revokeObjectURL(R);const I=`Erreur upload : ${F.message}`;p(X=>({...X,status:"error",errorMessage:I,previewUrl:r||null})),l?.(I)},async()=>{URL.revokeObjectURL(R);try{const F=await Mn(T.snapshot.ref);p({status:"success",progress:100,errorMessage:null,previewUrl:F}),n(F)}catch{const I="Impossible de rcuprer l'URL de tlchargement.";p(X=>({...X,status:"error",errorMessage:I})),l?.(I)}})},[e,r,x,a,n,l]),C=U=>{const $=U.target.files?.[0];$&&_($),U.target.value=""},w=U=>{U.preventDefault(),u||v(!0)},E=U=>{U.preventDefault(),v(!1)},S=U=>{if(U.preventDefault(),v(!1),u)return;const $=U.dataTransfer.files?.[0];$&&_($)},A=async()=>{f.previewUrl&&(p({status:"idle",progress:0,errorMessage:null,previewUrl:null}),n(""))},{status:O,progress:k,errorMessage:P,previewUrl:D}=f,B=O==="uploading";return t.jsxs("div",{className:`image-uploader ${h?"image-uploader--drag-over":""} ${u?"image-uploader--disabled":""}`,children:[D&&t.jsxs("div",{className:"image-uploader__preview",children:[t.jsx("img",{src:D,alt:"Aperu",className:"image-uploader__preview-img"}),B&&t.jsx("div",{className:"image-uploader__overlay",children:t.jsx("div",{className:"image-uploader__spinner"})}),!B&&!u&&t.jsx("button",{type:"button",className:"image-uploader__remove-btn",onClick:A,title:"Supprimer l'image","aria-label":"Supprimer l'image",children:""})]}),!D&&t.jsxs("div",{className:"image-uploader__dropzone",onDragOver:w,onDragLeave:E,onDrop:S,onClick:()=>!u&&b.current?.click(),role:"button",tabIndex:u?-1:0,"aria-label":"Zone d'upload d'image",onKeyDown:U=>{(U.key==="Enter"||U.key===" ")&&!u&&b.current?.click()},children:[t.jsx("span",{className:"image-uploader__icon","aria-hidden":"true",children:""}),t.jsx("p",{className:"image-uploader__text",children:o}),t.jsxs("p",{className:"image-uploader__subtext",children:["JPG, PNG, GIF, WebP  max ",d," Mo"]}),t.jsx("button",{type:"button",className:"image-uploader__browse-btn",disabled:u,tabIndex:-1,"aria-hidden":"true",children:"Parcourir"})]}),B&&t.jsxs("div",{className:"image-uploader__progress",role:"progressbar","aria-valuenow":k,"aria-valuemin":0,"aria-valuemax":100,children:[t.jsx("div",{className:"image-uploader__progress-bar",style:{width:`${k}%`}}),t.jsxs("span",{className:"image-uploader__progress-text",children:["Upload en cours ",k,"%"]})]}),O==="success"&&t.jsx("p",{className:"image-uploader__success",children:" Image uploade avec succs"}),P&&t.jsxs("p",{className:"image-uploader__error",role:"alert",children:[" ",P]}),t.jsx("input",{ref:b,type:"file",accept:zee,onChange:C,disabled:u||B,style:{display:"none"},"aria-hidden":"true"})]})},vm=()=>crypto.randomUUID();function kee(e,r){const n={id:vm(),type:e,ordre:r,isPremium:!1};switch(e){case"texte":return{...n,type:"texte",contenu:""};case"image":return{...n,type:"image",url:"",alt:"",legende:""};case"video":return{...n,type:"video",urlYoutube:"",titre:"",description:""};case"encadre":return{...n,type:"encadre",variante:"definition",titre:"Dfinition",contenu:""};case"quiz":return{...n,type:"quiz",question:"",options:[{id:vm(),texte:"",estCorrecte:!0},{id:vm(),texte:"",estCorrecte:!1}],explication:""};case"exercice":return{...n,type:"exercice",enonce:"",correction:"",difficulte:"moyen"}}}function Oee({bloc:e,index:r,total:n,onUpdate:a,onDelete:l,onMoveUp:o,onMoveDown:u,isDragging:d,onDragStart:f,onDragOver:p,onDrop:h,onDragEnd:v,dragOverIndex:b,storageBasePath:x,onBlocUploadStart:j,onBlocUploadEnd:_}){const C=Mx[e.type],w=b===r;function E(){switch(e.type){case"texte":return t.jsx("textarea",{className:"editor-bloc__textarea",placeholder:"Texte du paragraphe (Markdown : **gras**, *italique*, - liste)",value:e.contenu,onChange:S=>a({...e,contenu:S.target.value}),rows:4});case"image":return t.jsxs("div",{className:"editor-bloc__form-grid",children:[t.jsx(SM,{storagePath:`${x}/bloc-${r}`,existingUrl:e.url,placeholder:"Glissez l'image ici ou cliquez",onUploadStart:()=>j(r),onUploadComplete:S=>{a({...e,url:S}),_(r)},onUploadError:()=>_(r),maxSizeMo:5}),t.jsx("input",{type:"text",placeholder:"Texte alternatif (accessibilit)",value:e.alt,onChange:S=>a({...e,alt:S.target.value}),className:"editor-bloc__input"}),t.jsx("input",{type:"text",placeholder:"Lgende (optionnelle)",value:e.legende??"",onChange:S=>a({...e,legende:S.target.value}),className:"editor-bloc__input"})]});case"video":return t.jsxs("div",{className:"editor-bloc__form-grid",children:[t.jsx("input",{type:"url",placeholder:"URL YouTube (ex: https://www.youtube.com/watch?v=...)",value:e.urlYoutube,onChange:S=>a({...e,urlYoutube:S.target.value}),className:"editor-bloc__input"}),t.jsx("input",{type:"text",placeholder:"Titre de la vido",value:e.titre,onChange:S=>a({...e,titre:S.target.value}),className:"editor-bloc__input"}),t.jsx("input",{type:"text",placeholder:"Description courte (optionnelle)",value:e.description??"",onChange:S=>a({...e,description:S.target.value}),className:"editor-bloc__input"})]});case"encadre":return t.jsxs("div",{className:"editor-bloc__form-grid",children:[t.jsx("select",{value:e.variante,onChange:S=>a({...e,variante:S.target.value}),className:"editor-bloc__select",children:Object.entries(RA).map(([S,A])=>t.jsxs("option",{value:S,children:[A.emoji," ",A.label]},S))}),t.jsx("input",{type:"text",placeholder:"Titre de l'encadr",value:e.titre,onChange:S=>a({...e,titre:S.target.value}),className:"editor-bloc__input"}),t.jsx("textarea",{placeholder:"Contenu de l'encadr",value:e.contenu,onChange:S=>a({...e,contenu:S.target.value}),className:"editor-bloc__textarea",rows:3})]});case"quiz":{const S=e;return t.jsxs("div",{className:"editor-bloc__form-grid",children:[t.jsx("input",{type:"text",placeholder:"Question",value:S.question,onChange:A=>a({...S,question:A.target.value}),className:"editor-bloc__input"}),t.jsxs("div",{className:"editor-bloc__quiz-options",children:[S.options.map((A,O)=>t.jsxs("div",{className:"editor-bloc__quiz-option",children:[t.jsx("input",{type:"radio",name:`quiz-correct-${e.id}`,checked:A.estCorrecte,onChange:()=>a({...S,options:S.options.map((k,P)=>({...k,estCorrecte:P===O}))}),title:"Marquer comme bonne rponse"}),t.jsx("input",{type:"text",placeholder:`Option ${O+1}`,value:A.texte,onChange:k=>a({...S,options:S.options.map((P,D)=>D===O?{...P,texte:k.target.value}:P)}),className:"editor-bloc__input"}),S.options.length>2&&t.jsx("button",{type:"button",className:"btn-icon btn-icon--danger",onClick:()=>a({...S,options:S.options.filter((k,P)=>P!==O)}),title:"Supprimer cette option",children:""})]},A.id)),S.options.length<4&&t.jsx("button",{type:"button",className:"btn-link",onClick:()=>a({...S,options:[...S.options,{id:vm(),texte:"",estCorrecte:!1}]}),children:"+ Ajouter une option"})]}),t.jsx("input",{type:"text",placeholder:"Explication aprs rponse (optionnelle)",value:S.explication??"",onChange:A=>a({...S,explication:A.target.value}),className:"editor-bloc__input"})]})}case"exercice":return t.jsxs("div",{className:"editor-bloc__form-grid",children:[t.jsx("textarea",{placeholder:"nonc de l'exercice",value:e.enonce,onChange:S=>a({...e,enonce:S.target.value}),className:"editor-bloc__textarea",rows:3}),t.jsx("textarea",{placeholder:"Correction (masque pour l'lve jusqu'au clic)",value:e.correction,onChange:S=>a({...e,correction:S.target.value}),className:"editor-bloc__textarea editor-bloc__textarea--correction",rows:3}),t.jsxs("div",{className:"editor-bloc__row",children:[t.jsxs("select",{value:e.difficulte,onChange:S=>a({...e,difficulte:S.target.value}),className:"editor-bloc__select",children:[t.jsx("option",{value:"facile",children:"Facile"}),t.jsx("option",{value:"moyen",children:"Moyen"}),t.jsx("option",{value:"difficile",children:"Difficile"})]}),t.jsx("input",{type:"number",placeholder:"Points (opt.)",value:e.points??"",onChange:S=>a({...e,points:Number(S.target.value)||void 0}),className:"editor-bloc__input editor-bloc__input--sm",min:1})]})]});default:return null}}return t.jsxs("div",{className:["editor-bloc",d?"editor-bloc--dragging":"",w?"editor-bloc--drag-over":""].join(" "),draggable:!0,onDragStart:S=>f(S,r),onDragOver:S=>p(S,r),onDrop:S=>h(S,r),onDragEnd:v,children:[t.jsxs("div",{className:"editor-bloc__header",children:[t.jsx("span",{className:"editor-bloc__drag-handle",title:"Dplacer","aria-hidden":"true",children:""}),t.jsxs("span",{className:"editor-bloc__type-label",children:[C.emoji," ",C.label]}),t.jsxs("label",{className:"editor-bloc__premium-toggle",title:"Rserver aux abonns Premium",children:[t.jsx("input",{type:"checkbox",checked:e.isPremium,onChange:S=>a({...e,isPremium:S.target.checked})}),t.jsx("span",{children:" Premium"})]}),t.jsxs("div",{className:"editor-bloc__actions",children:[t.jsx("button",{type:"button",className:"btn-icon",onClick:o,disabled:r===0,title:"Monter","aria-label":"Monter ce bloc",children:""}),t.jsx("button",{type:"button",className:"btn-icon",onClick:u,disabled:r===n-1,title:"Descendre","aria-label":"Descendre ce bloc",children:""}),t.jsx("button",{type:"button",className:"btn-icon btn-icon--danger",onClick:l,title:"Supprimer ce bloc","aria-label":"Supprimer ce bloc",children:""})]})]}),t.jsx("div",{className:"editor-bloc__form",children:E()})]})}function sA(){const{coursId:e}=xn(),r=Je(),{currentUser:n}=Ke(),a=!!e,{matieres:l}=Ca(),[o]=g.useState(()=>je(_e(Q,"cours_en_ligne")).id),u=`cours-images/${a?e:o}`,[d,f]=g.useState({titre:"",description:"",matiere:"Mathmatiques",niveau:"3me",classe:"",isPremium:!1,statut:"brouillon",couvertureUrl:"",dureeEstimee:0,objectifs:[""],prerequis:"",tags:[],cahierTextesId:""}),[p,h]=g.useState([]),[v,b]=g.useState(null),[x,j]=g.useState([]),[_,C]=g.useState(""),w=g.useRef(null),[E,S]=g.useState(null),A=g.useRef(null),[O,k]=g.useState(null),[P,D]=g.useState(null),[B,U]=g.useState(!1),[$,R]=g.useState(!1),[Y,ae]=g.useState(null),[M,T]=g.useState(null),[F,I]=g.useState("infos"),[X,L]=g.useState([]),[ne,K]=g.useState(!1),[oe,xe]=g.useState({});ne||Object.values(oe).some(Boolean),g.useEffect(()=>{a&&e&&ve(e)},[e]),g.useEffect(()=>{n?.role==="admin"&&BZ().then(J=>L(J.map(ce=>({id:ce.id,titre:ce.titre})))).catch(()=>{})},[n?.role]);async function ve(J){U(!0);try{const[ce,Se]=await Promise.all([kA(J),OA(J)]);ce&&f({titre:ce.titre,description:ce.description,matiere:ce.matiere,niveau:ce.niveau,classe:ce.classe??"",cahierTextesId:ce.cahierTextesId??"",isPremium:ce.isPremium,statut:ce.statut,couvertureUrl:ce.couvertureUrl??"",dureeEstimee:ce.dureeEstimee,objectifs:ce.objectifs.length>0?ce.objectifs:[""],prerequis:ce.prerequis??"",tags:ce.tags}),h(Se),Se.length>0&&(b(Se[0].id),j(Se[0].blocs),C(Se[0].titre))}catch{ae("Erreur de chargement du cours.")}finally{U(!1)}}g.useEffect(()=>{if(!v)return;const J=p.find(ce=>ce.id===v);J&&(j([...J.blocs].sort((ce,Se)=>ce.ordre-Se.ordre)),C(J.titre))},[v]);const H=(J,ce)=>f(Se=>({...Se,[J]:ce})),he=(J,ce)=>{const Se=[...d.objectifs];Se[J]=ce,H("objectifs",Se)},Me=()=>H("objectifs",[...d.objectifs,""]),ue=J=>H("objectifs",d.objectifs.filter((ce,Se)=>Se!==J)),[Z,V]=g.useState(""),me=()=>{const J=Z.trim();J&&!d.tags.includes(J)&&H("tags",[...d.tags,J]),V("")},we=J=>H("tags",d.tags.filter(ce=>ce!==J));async function qe(J=!1){if(n){if(!d.titre.trim()){ae("Le titre du cours est obligatoire.");return}R(!0),ae(null);try{const ce={...d,objectifs:d.objectifs.filter(Se=>Se.trim()),statut:J?"publie":d.statut,cahierTextesId:d.cahierTextesId?.trim()||void 0};if(a&&e)await z5(e,ce),J&&await Px(e),Xe(J?" Cours publi !":" Cours sauvegard.");else{const Se=n.displayName??"Professeur",Ze=await A5(n.uid,Se,ce);J&&await Px(Ze),Xe(" Cours cr ! Ajoutez maintenant vos sections."),r(`/prof/cours/${Ze}/modifier`)}}catch(ce){console.error("[CoursEditorPage] Erreur sauvegarde :",ce),ae("Erreur lors de la sauvegarde. Ressayez.")}finally{R(!1)}}}function Xe(J){T(J),setTimeout(()=>T(null),4e3)}async function et(){if(!e){ae("Sauvegardez d'abord le cours pour ajouter des sections.");return}const J=p.length+1,ce=`Section ${J}`;try{const Se=await D5(e,{titre:ce,ordre:J,blocs:[],dureeEstimee:0,estGratuite:J===1}),Ze=Ae.now(),kr={id:Se,coursId:e,titre:ce,ordre:J,blocs:[],dureeEstimee:0,estGratuite:J===1,createdAt:Ze,updatedAt:Ze};h(Fn=>[...Fn,kr]),b(Se),j([]),C(ce)}catch{ae("Erreur lors de la cration de la section.")}}async function it(J){if(e&&confirm("Supprimer cette section et tous ses blocs ?"))try{await P5(J,e);const ce=p.filter(Se=>Se.id!==J).map((Se,Ze)=>({...Se,ordre:Ze+1}));h(ce),v===J&&b(ce[0]?.id??null)}catch{ae("Erreur lors de la suppression.")}}async function jr(){if(v)try{await L1(v,{titre:_}),h(J=>J.map(ce=>ce.id===v?{...ce,titre:_}:ce))}catch{ae("Erreur lors de la mise  jour du titre.")}}function Mr(J,ce){w.current=ce,J.dataTransfer.effectAllowed="move"}function cr(J,ce){J.preventDefault(),J.dataTransfer.dropEffect="move",S(ce)}async function nn(J,ce){J.preventDefault(),S(null);const Se=w.current;if(Se===null||Se===ce)return;const Ze=[...p],[kr]=Ze.splice(Se,1);Ze.splice(ce,0,kr);const Fn=Ze.map((Gn,ia)=>({...Gn,ordre:ia+1}));h(Fn);try{await M5(Fn.map(Gn=>({id:Gn.id,ordre:Gn.ordre})))}catch{ae("Erreur lors du rordonnancement. Rechargez la page.")}w.current=null}function pe(J){const ce=kee(J,x.length),Se=[...x,ce];j(Se),nr(Se)}function ze(J,ce){const Se=x.map((Ze,kr)=>kr===J?ce:Ze);j(Se),nr(Se)}function Re(J){const ce=x.filter((Se,Ze)=>Ze!==J);j(ce),nr(ce)}function Qe(J){if(J===0)return;const ce=[...x];[ce[J-1],ce[J]]=[ce[J],ce[J-1]],j(ce),nr(ce)}function pt(J){if(J===x.length-1)return;const ce=[...x];[ce[J],ce[J+1]]=[ce[J+1],ce[J]],j(ce),nr(ce)}const It=g.useRef(null);function nr(J){v&&(It.current&&clearTimeout(It.current),It.current=setTimeout(async()=>{try{await T5(v,J),h(ce=>ce.map(Se=>Se.id===v?{...Se,blocs:J}:Se))}catch(ce){console.error("[CoursEditorPage] Erreur sauvegarde blocs :",ce)}},1500))}function Gr(J,ce){A.current=ce,D(ce),J.dataTransfer.effectAllowed="move"}function ee(J,ce){J.preventDefault(),J.dataTransfer.dropEffect="move",k(ce)}function Pe(J,ce){J.preventDefault(),k(null),D(null);const Se=A.current;if(Se===null||Se===ce)return;const Ze=[...x],[kr]=Ze.splice(Se,1);Ze.splice(ce,0,kr);const Fn=Ze.map((Gn,ia)=>({...Gn,ordre:ia}));j(Fn),nr(Fn),A.current=null}function ct(){k(null),D(null),A.current=null}return B?t.jsxs("div",{className:"cours-editor__loading","aria-busy":"true",children:[t.jsx("div",{className:"spinner spinner--blue"}),t.jsx("p",{children:"Chargement de l'diteur..."})]}):t.jsxs("div",{className:"cours-editor",children:[t.jsxs("header",{className:"cours-editor__header",children:[t.jsxs("p",{className:"cours-editor__breadcrumb",children:[t.jsx("button",{className:"btn-link",onClick:()=>r("/prof/cours"),children:" Mes cours"})," / ",a?"Modifier le cours":"Nouveau cours"]}),t.jsxs("div",{className:"cours-editor__header-actions",children:[t.jsx("h1",{className:"cours-editor__titre",children:a?" Modifier le cours":" Nouveau cours"}),t.jsxs("div",{className:"cours-editor__btn-group",children:[t.jsx("button",{className:"btn-secondary",onClick:()=>r("/prof/cours"),disabled:$,children:"Annuler"}),t.jsx("button",{className:"btn-secondary",onClick:()=>qe(!1),disabled:$,children:$?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner"})," Sauvegarde..."]}):" Sauvegarder"}),t.jsx("button",{className:"btn-primary",onClick:()=>qe(!0),disabled:$||d.statut==="publie",children:d.statut==="publie"?" Publi":" Publier"})]})]}),Y&&t.jsxs("div",{className:"error-banner",role:"alert",children:[" ",Y]}),M&&t.jsx("div",{className:"success-banner",role:"status",children:M})]}),t.jsxs("div",{className:"cours-editor__tabs",role:"tablist",children:[t.jsx("button",{className:`cours-editor__tab ${F==="infos"?"cours-editor__tab--active":""}`,onClick:()=>I("infos"),role:"tab","aria-selected":F==="infos",children:" Informations du cours"}),t.jsxs("button",{className:`cours-editor__tab ${F==="sections"?"cours-editor__tab--active":""}`,onClick:()=>I("sections"),role:"tab","aria-selected":F==="sections",disabled:!a&&!e,children:[" Sections et contenu ",p.length>0&&`(${p.length})`]})]}),F==="infos"&&t.jsxs("section",{className:"cours-editor__form","aria-label":"Informations du cours",children:[t.jsxs("div",{className:"cours-editor__card",children:[t.jsx("h2",{className:"cours-editor__card-titre",children:" Informations gnrales"}),t.jsxs("div",{className:"cours-editor__form-grid",children:[t.jsxs("div",{className:"cours-editor__field cours-editor__field--full",children:[t.jsx("label",{htmlFor:"titre",children:"Titre du cours *"}),t.jsx("input",{id:"titre",type:"text",value:d.titre,onChange:J=>H("titre",J.target.value),placeholder:"Ex : Les fonctions affines  Terminale S",className:"cours-editor__input",required:!0})]}),t.jsxs("div",{className:"cours-editor__field cours-editor__field--full",children:[t.jsx("label",{htmlFor:"description",children:"Description *"}),t.jsx("textarea",{id:"description",value:d.description,onChange:J=>H("description",J.target.value),placeholder:"Description courte affiche dans le catalogue",className:"cours-editor__textarea",rows:3})]}),t.jsxs("div",{className:"cours-editor__field",children:[t.jsx("label",{htmlFor:"matiere",children:"Matire *"}),t.jsx("select",{id:"matiere",value:d.matiere,onChange:J=>H("matiere",J.target.value),className:"cours-editor__select",children:l.map(J=>t.jsx("option",{value:J.valeur,children:J.label},J.valeur))})]}),t.jsxs("div",{className:"cours-editor__field",children:[t.jsx("label",{htmlFor:"niveau",children:"Niveau *"}),t.jsx("select",{id:"niveau",value:d.niveau,onChange:J=>H("niveau",J.target.value),className:"cours-editor__select",children:wa.map(J=>t.jsx("option",{value:J,children:J},J))})]}),t.jsxs("div",{className:"cours-editor__field",children:[t.jsx("label",{htmlFor:"classe",children:"Classe (optionnelle)"}),t.jsx("input",{id:"classe",type:"text",value:d.classe??"",onChange:J=>H("classe",J.target.value),placeholder:"Ex : 3me A, TS, L2",className:"cours-editor__input"})]}),n?.role==="admin"&&X.length>0&&t.jsxs("div",{className:"cours-editor__field cours-editor__field--full",children:[t.jsx("label",{htmlFor:"cahierTextesId",children:" Lier  un cahier de textes"}),t.jsxs("select",{id:"cahierTextesId",value:d.cahierTextesId??"",onChange:J=>H("cahierTextesId",J.target.value),className:"cours-editor__select",children:[t.jsx("option",{value:"",children:" Aucun "}),X.map(J=>t.jsx("option",{value:J.id,children:J.titre},J.id))]}),t.jsx("span",{className:"cours-editor__label-hint",children:"Si le cahier n'existe pas, crez-le d'abord dans Cahier de Textes."})]}),t.jsxs("div",{className:"cours-editor__field",children:[t.jsxs("label",{htmlFor:"couverture",children:[" Image de couverture",t.jsx("span",{className:"cours-editor__label-hint",children:"(JPG, PNG, WebP  max 5 Mo)"})]}),t.jsx(SM,{storagePath:`${u}/couverture`,existingUrl:d.couvertureUrl,placeholder:"Glissez l'image de couverture ici ou cliquez",disabled:$,onUploadStart:()=>K(!0),onUploadComplete:J=>{H("couvertureUrl",J),K(!1)},onUploadError:J=>{console.error("[Phase 25] Erreur couverture:",J),K(!1)},maxSizeMo:5}),ne&&t.jsx("p",{className:"cours-editor__upload-hint",children:" Upload en cours, patientez avant d'enregistrer"})]}),t.jsx("div",{className:"cours-editor__field cours-editor__field--full",children:t.jsxs("label",{className:"cours-editor__toggle-label",children:[t.jsx("input",{type:"checkbox",checked:d.isPremium,onChange:J=>H("isPremium",J.target.checked)}),t.jsx("span",{children:" Cours Premium  Les sections (sauf la 1re) ncessitent un abonnement"})]})})]})]}),t.jsxs("div",{className:"cours-editor__card",children:[t.jsx("h2",{className:"cours-editor__card-titre",children:" Objectifs pdagogiques"}),d.objectifs.map((J,ce)=>t.jsxs("div",{className:"cours-editor__objectif-row",children:[t.jsx("input",{type:"text",value:J,onChange:Se=>he(ce,Se.target.value),placeholder:`Objectif ${ce+1} (ex : Savoir calculer une drive)`,className:"cours-editor__input"}),d.objectifs.length>1&&t.jsx("button",{type:"button",className:"btn-icon btn-icon--danger",onClick:()=>ue(ce),title:"Supprimer cet objectif",children:""})]},ce)),t.jsx("button",{type:"button",className:"btn-link",onClick:Me,children:"+ Ajouter un objectif"})]}),t.jsxs("div",{className:"cours-editor__card",children:[t.jsx("h2",{className:"cours-editor__card-titre",children:" Prrequis et tags"}),t.jsxs("div",{className:"cours-editor__field",children:[t.jsx("label",{htmlFor:"prerequis",children:"Prrequis conseills"}),t.jsx("input",{id:"prerequis",type:"text",value:d.prerequis??"",onChange:J=>H("prerequis",J.target.value),placeholder:"Ex : Matriser les quations du 2nd degr",className:"cours-editor__input"})]}),t.jsxs("div",{className:"cours-editor__field",children:[t.jsx("label",{children:"Tags (aide  la recherche)"}),t.jsxs("div",{className:"cours-editor__tags-wrapper",children:[d.tags.map(J=>t.jsxs("span",{className:"cours-editor__tag",children:[J,t.jsx("button",{type:"button",onClick:()=>we(J),"aria-label":`Supprimer le tag ${J}`,children:""})]},J)),t.jsxs("div",{className:"cours-editor__tag-input-row",children:[t.jsx("input",{type:"text",value:Z,onChange:J=>V(J.target.value),onKeyDown:J=>J.key==="Enter"&&(J.preventDefault(),me()),placeholder:"Ajouter un tag...",className:"cours-editor__input cours-editor__input--sm"}),t.jsx("button",{type:"button",className:"btn-secondary btn--sm",onClick:me,children:"+ Tag"})]})]})]})]})]}),F==="sections"&&t.jsx("section",{className:"cours-editor__sections","aria-label":"diteur de sections",children:a?t.jsxs("div",{className:"cours-editor__sections-layout",children:[t.jsxs("aside",{className:"cours-editor__sections-sidebar",children:[t.jsxs("div",{className:"cours-editor__sections-sidebar-header",children:[t.jsx("h2",{children:" Sections"}),t.jsx("button",{className:"btn-primary btn--sm",onClick:et,children:"+ Ajouter"})]}),p.length===0?t.jsx("p",{className:"cours-editor__sections-empty-hint",children:'Aucune section. Cliquez sur "+ Ajouter" pour commencer.'}):t.jsx("ol",{className:"cours-editor__sections-liste",children:p.map((J,ce)=>t.jsxs("li",{className:["cours-editor__section-item",J.id===v?"cours-editor__section-item--active":"",E===ce?"cours-editor__section-item--drag-over":""].join(" "),draggable:!0,onDragStart:Se=>Mr(Se,ce),onDragOver:Se=>cr(Se,ce),onDrop:Se=>nn(Se,ce),onDragEnd:()=>S(null),children:[t.jsx("span",{className:"cours-editor__section-drag","aria-hidden":"true",children:""}),t.jsxs("button",{className:"cours-editor__section-btn",onClick:()=>b(J.id),"aria-current":J.id===v?"true":void 0,children:[t.jsx("span",{className:"cours-editor__section-ordre",children:J.ordre}),t.jsxs("span",{className:"cours-editor__section-nom",children:[J.titre,J.estGratuite&&t.jsx("span",{className:"cours-editor__section-gratuite",title:"Section gratuite",children:"G"})]}),t.jsxs("span",{className:"cours-editor__section-blocs-count",children:[J.blocs.length," bloc",J.blocs.length>1?"s":""]})]}),t.jsx("button",{className:"btn-icon btn-icon--danger btn-icon--xs",onClick:()=>it(J.id),title:"Supprimer cette section","aria-label":`Supprimer la section ${J.titre}`,children:""})]},J.id))})]}),v?t.jsxs("div",{className:"cours-editor__section-content",children:[t.jsxs("div",{className:"cours-editor__section-titre-row",children:[t.jsx("input",{type:"text",value:_,onChange:J=>C(J.target.value),onBlur:jr,className:"cours-editor__section-titre-input",placeholder:"Titre de la section","aria-label":"Titre de la section"}),t.jsxs("label",{className:"cours-editor__toggle-label",children:[t.jsx("input",{type:"checkbox",checked:p.find(J=>J.id===v)?.estGratuite??!1,onChange:async J=>{try{await L1(v,{estGratuite:J.target.checked}),h(ce=>ce.map(Se=>Se.id===v?{...Se,estGratuite:J.target.checked}:Se))}catch{}}}),t.jsx("span",{children:"Gratuite"})]})]}),t.jsxs("div",{className:"cours-editor__palette","aria-label":"Ajouter un bloc",children:[t.jsx("span",{className:"cours-editor__palette-label",children:"Ajouter un bloc :"}),Object.keys(Mx).map(J=>{const ce=Mx[J];return t.jsxs("button",{className:"cours-editor__palette-btn",onClick:()=>pe(J),title:ce.description,children:[ce.emoji," ",ce.label]},J)})]}),x.length===0?t.jsxs("div",{className:"cours-editor__blocs-empty",children:[t.jsx("p",{children:" Aucun bloc dans cette section."}),t.jsx("p",{children:"Utilisez la palette ci-dessus pour ajouter du contenu."})]}):t.jsx("div",{className:"cours-editor__blocs-liste","aria-label":"Blocs de la section",children:x.map((J,ce)=>t.jsx(Oee,{bloc:J,index:ce,total:x.length,onUpdate:Se=>ze(ce,Se),onDelete:()=>Re(ce),onMoveUp:()=>Qe(ce),onMoveDown:()=>pt(ce),isDragging:P===ce,onDragStart:Gr,onDragOver:ee,onDrop:Pe,onDragEnd:ct,dragOverIndex:O,storageBasePath:`${u}/section-${v}`,onBlocUploadStart:Se=>{const Ze=`${v}-${Se}`;xe(kr=>({...kr,[Ze]:!0}))},onBlocUploadEnd:Se=>{const Ze=`${v}-${Se}`;xe(kr=>({...kr,[Ze]:!1}))}},J.id))})]}):t.jsx("div",{className:"cours-editor__section-content-empty",children:t.jsx("p",{children:"Slectionnez ou crez une section pour commencer  diter."})})]}):t.jsxs("div",{className:"cours-editor__sections-empty",children:[t.jsx("p",{children:"Sauvegardez d'abord les informations du cours pour ajouter des sections."}),t.jsx("button",{className:"btn-primary",onClick:()=>I("infos"),children:" Revenir aux informations"})]})})]})}function Dee({cours:e,onModifier:r,onPublier:n,onArchiver:a,onSupprimer:l,onVoirStats:o}){const u=G5[e.statut],d=Uc.find(f=>f.valeur===e.niveau)?.label??e.niveau;return t.jsxs("article",{className:"prof-cours-card",children:[t.jsxs("div",{className:"prof-cours-card__header",children:[t.jsxs("div",{className:"prof-cours-card__header-left",children:[t.jsx("span",{className:"prof-cours-card__statut",style:{color:u.couleur,background:u.bg},children:u.label}),e.isPremium&&t.jsx("span",{className:"badge badge--premium",children:" Premium"})]}),t.jsxs("div",{className:"prof-cours-card__actions",children:[t.jsx("button",{className:"btn-icon",onClick:r,title:"Modifier","aria-label":`Modifier ${e.titre}`,children:""}),e.statut==="brouillon"&&t.jsx("button",{className:"btn-icon btn-icon--success",onClick:n,title:"Publier","aria-label":`Publier ${e.titre}`,children:""}),e.statut==="publie"&&t.jsx("button",{className:"btn-icon",onClick:a,title:"Archiver","aria-label":`Archiver ${e.titre}`,children:""}),t.jsx("button",{className:"btn-icon btn-icon--info",onClick:o,title:"Voir les statistiques","aria-label":`Statistiques de ${e.titre}`,children:""}),t.jsx("button",{className:"btn-icon btn-icon--danger",onClick:l,title:"Supprimer","aria-label":`Supprimer ${e.titre}`,children:""})]})]}),t.jsxs("div",{className:"prof-cours-card__body",children:[t.jsx("h3",{className:"prof-cours-card__titre",children:e.titre}),t.jsx("p",{className:"prof-cours-card__description",children:e.description}),t.jsxs("div",{className:"prof-cours-card__meta",children:[t.jsx("span",{className:"badge badge--matiere",children:e.matiere}),t.jsx("span",{className:"badge badge--niveau",children:d}),e.classe&&t.jsx("span",{className:"badge badge--classe",children:e.classe})]})]}),t.jsxs("div",{className:"prof-cours-card__footer",children:[t.jsxs("span",{title:"Sections",children:[" ",e.nombreSections," section",e.nombreSections>1?"s":""]}),t.jsxs("span",{title:"Dure estime",children:[" ",e.dureeEstimee," min"]}),t.jsxs("span",{title:"lves inscrits",children:[" ",e.nombreInscrits," lve",e.nombreInscrits>1?"s":""]})]})]})}function Pee({cours:e,onClose:r}){const[n,a]=g.useState(null),[l,o]=g.useState(!0);g.useEffect(()=>{u()},[e.id]);async function u(){try{const d=await hee(e.id);a(bee(d))}catch(d){console.error("[StatsModal] Erreur :",d)}finally{o(!1)}}return t.jsx("div",{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":`Statistiques du cours : ${e.titre}`,onClick:d=>{d.target===d.currentTarget&&r()},children:t.jsxs("div",{className:"modal-content",children:[t.jsxs("div",{className:"modal-header",children:[t.jsxs("h2",{children:[" Statistiques  ",e.titre]}),t.jsx("button",{className:"btn-icon",onClick:r,"aria-label":"Fermer",children:""})]}),t.jsx("div",{className:"modal-body",children:l?t.jsxs("div",{className:"modal-loading",children:[t.jsx("div",{className:"spinner spinner--blue"}),t.jsx("p",{children:"Chargement des statistiques..."})]}):n?t.jsxs("div",{className:"stats-grid",children:[t.jsxs("div",{className:"stats-card",children:[t.jsx("span",{className:"stats-card__val",children:n.nombreInscrits}),t.jsx("span",{className:"stats-card__label",children:"lves inscrits"})]}),t.jsxs("div",{className:"stats-card stats-card--success",children:[t.jsx("span",{className:"stats-card__val",children:n.nombreTermines}),t.jsx("span",{className:"stats-card__label",children:"Cours termins"})]}),t.jsxs("div",{className:"stats-card stats-card--info",children:[t.jsxs("span",{className:"stats-card__val",children:[n.tauxCompletion,"%"]}),t.jsx("span",{className:"stats-card__label",children:"Taux de compltion"})]}),t.jsxs("div",{className:"stats-card",children:[t.jsxs("span",{className:"stats-card__val",children:[n.progressionMoyenne,"%"]}),t.jsx("span",{className:"stats-card__label",children:"Progression moyenne"})]}),t.jsxs("div",{className:"stats-card stats-card--primary",children:[t.jsxs("span",{className:"stats-card__val",children:[n.scoreMoyen,"%"]}),t.jsx("span",{className:"stats-card__label",children:"Score moyen aux quiz"})]}),t.jsxs("div",{className:"stats-progress-bar-wrapper",children:[t.jsx("label",{children:"Progression globale des lves"}),t.jsx("div",{className:"progression-bar",children:t.jsx("div",{className:"progression-bar__fill",style:{width:`${n.progressionMoyenne}%`}})})]})]}):t.jsx("p",{className:"modal-vide",children:"Aucune donne disponible pour ce cours."})})]})})}function Mee(){const e=Je(),{currentUser:r}=Ke(),[n,a]=g.useState([]),[l,o]=g.useState([]),[u,d]=g.useState(!0),[f,p]=g.useState(null),[h,v]=g.useState(null),[b,x]=g.useState(""),[j,_]=g.useState(null);g.useEffect(()=>{r&&C()},[r]);async function C(){if(r){d(!0),p(null);try{const k=r.role==="admin"?await E5():await C5(r.uid);a(k),o(k)}catch{p("Impossible de charger les cours.")}finally{d(!1)}}}function w(k){x(k),o(k?n.filter(P=>P.statut===k):n)}async function E(k){if(confirm("Publier ce cours dans le catalogue ?"))try{await Px(k),a(P=>P.map(D=>D.id===k?{...D,statut:"publie"}:D)),o(P=>P.map(D=>D.id===k?{...D,statut:"publie"}:D)),O(" Cours publi dans le catalogue !")}catch{p("Erreur lors de la publication.")}}async function S(k){if(confirm("Archiver ce cours ? Il ne sera plus visible dans le catalogue."))try{await k5(k),a(P=>P.map(D=>D.id===k?{...D,statut:"archive"}:D)),o(P=>P.map(D=>D.id===k?{...D,statut:"archive"}:D)),O(" Cours archiv.")}catch{p("Erreur lors de l'archivage.")}}async function A(k,P){if(confirm(`Supprimer dfinitivement le cours "${P}" et tout son contenu ? Cette action est irrversible.`))try{await O5(k);const D=n.filter(B=>B.id!==k);a(D),o(D.filter(B=>!b||B.statut===b)),O(" Cours supprim.")}catch{p("Erreur lors de la suppression.")}}function O(k){v(k),setTimeout(()=>v(null),4e3)}return t.jsxs("div",{className:"prof-cours-page",children:[t.jsxs("header",{className:"prof-cours-page__header",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"prof-cours-page__titre",children:" Mes cours en ligne"}),t.jsx("p",{className:"prof-cours-page__sous-titre",children:r?.role==="admin"?"Grez tous les cours de la plateforme. Seul l'admin peut crer des cours.":"Consultez les cours publis par vos collgues."})]}),r?.role==="admin"&&t.jsx("button",{className:"btn-primary",onClick:()=>e("/prof/cours/nouveau"),children:" Crer un cours"})]}),f&&t.jsxs("div",{className:"error-banner",role:"alert",children:[" ",f]}),h&&t.jsx("div",{className:"success-banner",role:"status",children:h}),!u&&n.length>0&&t.jsxs("div",{className:"prof-cours-page__stats","aria-label":"Rsum de mes cours",children:[t.jsxs("div",{className:"prof-cours-page__stat",children:[t.jsx("span",{className:"prof-cours-page__stat-val",children:n.length}),t.jsx("span",{children:"Total"})]}),t.jsxs("div",{className:"prof-cours-page__stat",children:[t.jsx("span",{className:"prof-cours-page__stat-val",style:{color:"#16a34a"},children:n.filter(k=>k.statut==="publie").length}),t.jsx("span",{children:"Publis"})]}),t.jsxs("div",{className:"prof-cours-page__stat",children:[t.jsx("span",{className:"prof-cours-page__stat-val",style:{color:"#ca8a04"},children:n.filter(k=>k.statut==="brouillon").length}),t.jsx("span",{children:"Brouillons"})]}),t.jsxs("div",{className:"prof-cours-page__stat",children:[t.jsx("span",{className:"prof-cours-page__stat-val",style:{color:"#2563eb"},children:n.reduce((k,P)=>k+P.nombreInscrits,0)}),t.jsx("span",{children:"lves inscrits"})]})]}),!u&&n.length>0&&t.jsx("div",{className:"prof-cours-page__filtres",role:"tablist","aria-label":"Filtrer par statut",children:[{val:"",label:`Tous (${n.length})`},{val:"publie",label:`Publis (${n.filter(k=>k.statut==="publie").length})`},{val:"brouillon",label:`Brouillons (${n.filter(k=>k.statut==="brouillon").length})`},{val:"archive",label:`Archivs (${n.filter(k=>k.statut==="archive").length})`}].map(k=>t.jsx("button",{className:`prof-cours-page__filtre-btn ${b===k.val?"prof-cours-page__filtre-btn--active":""}`,onClick:()=>w(k.val),role:"tab","aria-selected":b===k.val,children:k.label},k.val))}),t.jsxs("main",{className:"prof-cours-page__grille",children:[u&&t.jsx("div",{className:"prof-cours-page__grille-inner","aria-busy":"true",children:[1,2,3].map(k=>t.jsxs("div",{className:"prof-cours-card prof-cours-card--skeleton",children:[t.jsx("div",{className:"skeleton",style:{height:20,marginBottom:12}}),t.jsx("div",{className:"skeleton",style:{height:16,width:"60%",marginBottom:8}}),t.jsx("div",{className:"skeleton",style:{height:14,width:"80%"}})]},k))}),!u&&l.length>0&&t.jsx("div",{className:"prof-cours-page__grille-inner",children:l.map(k=>t.jsx(Dee,{cours:k,onModifier:()=>e(`/prof/cours/${k.id}/modifier`),onPublier:()=>E(k.id),onArchiver:()=>S(k.id),onSupprimer:()=>A(k.id,k.titre),onVoirStats:()=>_(k)},k.id))}),!u&&l.length===0&&t.jsxs("div",{className:"prof-cours-page__vide",role:"status",children:[t.jsx("span",{"aria-hidden":"true",children:""}),t.jsx("h3",{children:n.length===0&&r?.role==="admin"?"Aucun cours sur la plateforme.":"Aucun cours dans cette catgorie."}),n.length===0&&r?.role==="admin"&&t.jsx("button",{className:"btn-primary",onClick:()=>e("/prof/cours/nouveau"),children:" Crer mon premier cours"})]})]}),j&&t.jsx(Pee,{cours:j,onClose:()=>_(null)})]})}const Ji={manuel:"Manuels scolaires",annale:"Annales corriges",guide:"Guides de rvision",litterature:"Culture gnrale & Littrature",fiche:"Fiches de lectures"},es={manuel:"",annale:"",guide:"",litterature:"",fiche:""},gi="ebooks";async function Tee(){try{const e=Ee(_e(Q,gi),Ne("isActive","==",!0),Ve("ordre","asc"));return(await Ce(e)).docs.map(n=>({id:n.id,...n.data(),createdAt:n.data().createdAt?.toDate()||new Date,updatedAt:n.data().updatedAt?.toDate()||null}))}catch(e){throw console.error(" Erreur rcupration ebooks:",e),e}}async function qee(){try{const e=Ee(_e(Q,gi),Ve("ordre","asc"));return(await Ce(e)).docs.map(n=>({id:n.id,...n.data(),createdAt:n.data().createdAt?.toDate()||new Date,updatedAt:n.data().updatedAt?.toDate()||null}))}catch(e){throw console.error(" Erreur rcupration ebooks admin:",e),e}}async function Ree(e){try{const r=await Et(je(Q,gi,e));return r.exists()?{id:r.id,...r.data(),createdAt:r.data().createdAt?.toDate()||new Date,updatedAt:r.data().updatedAt?.toDate()||null}:null}catch(r){throw console.error(" Erreur rcupration ebook:",r),r}}function Iee(e,r){let n=[...e];if(r.categorie&&r.categorie!=="all"&&(n=n.filter(a=>a.categorie===r.categorie)),r.niveau&&r.niveau!=="all"&&(n=n.filter(a=>a.niveau===r.niveau)),r.classe&&r.classe!=="all"&&(n=n.filter(a=>a.classe===r.classe||a.classe==="all")),r.matiere&&(n=n.filter(a=>a.matiere?.toLowerCase().includes(r.matiere.toLowerCase()))),r.recherche){const a=r.recherche.toLowerCase();n=n.filter(l=>l.titre.toLowerCase().includes(a)||l.auteur.toLowerCase().includes(a)||l.description.toLowerCase().includes(a)||l.tags?.some(o=>o.toLowerCase().includes(a)))}return n}async function Lee(e,r,n,a,l){try{const o=sr(er,`ebooks/pdf/${Date.now()}_${r.name}`);await Ls(o,r);const u=await Mn(o);let d="";if(n){const v=sr(er,`ebooks/covers/${Date.now()}_${n.name}`);await Ls(v,n),d=await Mn(v)}let f="";if(a){const v=sr(er,`ebooks/previews/${Date.now()}_${a.name}`);await Ls(v,a),f=await Mn(v)}const p={...e,fichierURL:u,couvertureURL:d,aperuURL:f,tailleFichier:r.size,nombreTelechargements:0,nombreVues:0,uploadedBy:l||"admin",createdAt:Dt(),updatedAt:Dt()},h=await Pt(_e(Q,gi),p);return console.log(` Ebook ajout : ${e.titre} (ID: ${h.id})`),h.id}catch(o){throw console.error(" Erreur ajout ebook:",o),o}}async function $ee(e,r,n,a,l){try{const o={...r,updatedAt:Dt()};if(n){const u=sr(er,`ebooks/pdf/${Date.now()}_${n.name}`);await Ls(u,n),o.fichierURL=await Mn(u),o.tailleFichier=n.size}if(a){const u=sr(er,`ebooks/covers/${Date.now()}_${a.name}`);await Ls(u,a),o.couvertureURL=await Mn(u)}if(l){const u=sr(er,`ebooks/previews/${Date.now()}_${l.name}`);await Ls(u,l),o.aperuURL=await Mn(u)}await He(je(Q,gi,e),o),console.log(` Ebook mis  jour : ${e}`)}catch(o){throw console.error(" Erreur mise  jour ebook:",o),o}}async function Bee(e){try{const r=await Ree(e);if(!r)throw new Error("Ebook introuvable");try{if(r.fichierURL){const n=sr(er,r.fichierURL);await Is(n)}if(r.couvertureURL){const n=sr(er,r.couvertureURL);await Is(n)}if(r.aperuURL){const n=sr(er,r.aperuURL);await Is(n)}}catch{console.warn(" Fichiers Storage non supprims (peut-tre dj supprims)")}await Br(je(Q,gi,e)),console.log(` Ebook supprim : ${e}`)}catch(r){throw console.error(" Erreur suppression ebook:",r),r}}async function Uee(e,r){try{await He(je(Q,gi,e),{isActive:r,updatedAt:Dt()})}catch(n){throw console.error(" Erreur toggle ebook:",n),n}}async function Fee(e){try{await He(je(Q,gi,e),{nombreVues:as(1)})}catch(r){console.error(" Erreur incrment vues:",r)}}async function Gee(e){try{await He(je(Q,gi,e),{nombreTelechargements:as(1)})}catch(r){console.error(" Erreur incrment tlchargements:",r)}}function Hee(e){const r={totalEbooks:e.length,totalTelechargements:0,totalVues:0,parCategorie:{manuel:0,annale:0,guide:0,litterature:0,fiche:0},ebooksActifs:0};return e.forEach(n=>{r.totalTelechargements+=n.nombreTelechargements||0,r.totalVues+=n.nombreVues||0,r.parCategorie[n.categorie]=(r.parCategorie[n.categorie]||0)+1,n.isActive&&r.ebooksActifs++}),r}function $c(e){return e<1024?`${e} o`:e<1024*1024?`${(e/1024).toFixed(1)} Ko`:`${(e/(1024*1024)).toFixed(1)} Mo`}const wM=["Mathmatiques","Physique-Chimie","SVT","Franais","Anglais","Histoire-Gographie","Philosophie","conomie","Comptabilit","ducation civique","Arabe","Espagnol","Informatique"],lA="Ce contenu est rserv aux utilisateurs Premium.",Vee=({isPremium:e,onReadEbook:r})=>{const[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState({categorie:"all",niveau:"all",classe:"all",matiere:"",recherche:""}),[h,v]=g.useState("grid");g.useEffect(()=>{b()},[]);const b=async()=>{try{o(!0),d(null);const w=await Tee();a(w)}catch(w){d(e?"Erreur lors du chargement de la bibliothque":lA),console.error(w)}finally{o(!1)}},x=g.useMemo(()=>Iee(n,f),[n,f]),j=g.useMemo(()=>{const w={all:n.length};return n.forEach(E=>{w[E.categorie]=(w[E.categorie]||0)+1}),w},[n]),_=(w,E)=>{p(S=>({...S,[w]:E}))},C=()=>{p({categorie:"all",niveau:"all",classe:"all",matiere:"",recherche:""})};if(l)return t.jsx("div",{className:"ebook-library",children:t.jsxs("div",{className:"ebook-loading",children:[t.jsx("div",{className:"loading-spinner"}),t.jsx("p",{children:"Chargement de la bibliothque..."})]})});if(u){const w=u===lA;return t.jsx("div",{className:"ebook-library",children:t.jsxs("div",{className:"ebook-error",children:[t.jsxs("p",{children:[" ",u]}),w?t.jsx("a",{href:"/premium",className:"btn-retry",children:"Passer  Premium"}):t.jsx("button",{onClick:b,className:"btn-retry",children:"Ressayer"})]})})}return t.jsxs("div",{className:"ebook-library",children:[t.jsxs("div",{className:"ebook-library-header",children:[t.jsxs("div",{className:"ebook-header-content",children:[t.jsx("h1",{children:" Bibliothque PedaClic"}),t.jsxs("p",{className:"ebook-subtitle",children:["Manuels, annales, fiches de rvision et bien plus encore",!e&&t.jsx("span",{className:"preview-badge",children:"Aperu gratuit disponible"})]})]}),t.jsxs("div",{className:"ebook-search-bar",children:[t.jsx("input",{type:"text",placeholder:"Rechercher un ebook (titre, auteur, mot-cl)...",value:f.recherche||"",onChange:w=>_("recherche",w.target.value),className:"search-input"}),t.jsx("span",{className:"search-icon",children:""})]})]}),t.jsxs("div",{className:"ebook-categories",children:[t.jsxs("button",{className:`category-tab ${f.categorie==="all"?"active":""}`,onClick:()=>_("categorie","all"),children:[" Tous",t.jsx("span",{className:"category-count",children:j.all||0})]}),Object.keys(Ji).map(w=>t.jsxs("button",{className:`category-tab ${f.categorie===w?"active":""}`,onClick:()=>_("categorie",w),children:[es[w]," ",Ji[w],t.jsx("span",{className:"category-count",children:j[w]||0})]},w))]}),t.jsxs("div",{className:"ebook-filters",children:[t.jsxs("select",{value:f.niveau||"all",onChange:w=>_("niveau",w.target.value),className:"filter-select",children:[t.jsx("option",{value:"all",children:"Tous les niveaux"}),t.jsx("option",{value:"college",children:"Collge"}),t.jsx("option",{value:"lycee",children:"Lyce"})]}),t.jsxs("select",{value:f.classe||"all",onChange:w=>_("classe",w.target.value),className:"filter-select",children:[t.jsx("option",{value:"all",children:"Toutes les classes"}),t.jsx("option",{value:"6eme",children:"6me"}),t.jsx("option",{value:"5eme",children:"5me"}),t.jsx("option",{value:"4eme",children:"4me"}),t.jsx("option",{value:"3eme",children:"3me"}),t.jsx("option",{value:"2nde",children:"2nde"}),t.jsx("option",{value:"1ere",children:"1re"}),t.jsx("option",{value:"Terminale",children:"Terminale"})]}),t.jsxs("select",{value:f.matiere||"",onChange:w=>_("matiere",w.target.value),className:"filter-select",children:[t.jsx("option",{value:"",children:"Toutes les matires"}),wM.map(w=>t.jsx("option",{value:w,children:w},w))]}),t.jsxs("div",{className:"view-toggle",children:[t.jsx("button",{className:h==="grid"?"active":"",onClick:()=>v("grid"),title:"Vue grille",children:""}),t.jsx("button",{className:h==="list"?"active":"",onClick:()=>v("list"),title:"Vue liste",children:""})]}),(f.categorie!=="all"||f.niveau!=="all"||f.classe!=="all"||f.matiere||f.recherche)&&t.jsx("button",{onClick:C,className:"btn-reset-filters",children:" Rinitialiser"})]}),t.jsx("div",{className:"ebook-results-info",children:t.jsxs("span",{children:[x.length," ebook",x.length>1?"s":""," trouv",x.length>1?"s":""]})}),x.length===0?t.jsxs("div",{className:"ebook-empty",children:[t.jsx("p",{children:" Aucun ebook trouv avec ces filtres."}),t.jsx("button",{onClick:C,className:"btn-reset-filters",children:"Voir tous les ebooks"})]}):t.jsx("div",{className:`ebook-grid ${h==="list"?"list-view":""}`,children:x.map(w=>t.jsx(Qee,{ebook:w,isPremium:e,onRead:()=>r(w),viewMode:h},w.id))}),!e&&x.length>0&&t.jsx("div",{className:"ebook-premium-banner",children:t.jsxs("div",{className:"premium-banner-content",children:[t.jsx("h3",{children:" Accdez  tous les ebooks en illimit"}),t.jsx("p",{children:"Abonnez-vous  PedaClic Premium pour lire et tlcharger tous les manuels, annales et fiches de rvision sans limite."}),t.jsx("a",{href:"/premium",className:"btn-premium",children:"S'abonner  2 000 FCFA/mois"})]})})]})},Qee=({ebook:e,isPremium:r,onRead:n,viewMode:a})=>t.jsxs("div",{className:`ebook-card ${a==="list"?"ebook-card-list":""}`,children:[t.jsxs("div",{className:"ebook-cover",onClick:n,children:[e.couvertureURL?t.jsx("img",{src:e.couvertureURL,alt:e.titre,loading:"lazy"}):t.jsxs("div",{className:"ebook-cover-placeholder",children:[t.jsx("span",{className:"cover-icon",children:es[e.categorie]}),t.jsx("span",{className:"cover-title",children:e.titre})]}),!r&&t.jsx("div",{className:"ebook-badge-premium",children:t.jsx("span",{children:" Premium"})}),t.jsx("div",{className:"ebook-badge-category",children:Ji[e.categorie]})]}),t.jsxs("div",{className:"ebook-info",children:[t.jsx("h3",{className:"ebook-title",onClick:n,children:e.titre}),t.jsx("p",{className:"ebook-author",children:e.auteur}),t.jsx("p",{className:"ebook-description",children:e.description}),t.jsxs("div",{className:"ebook-meta",children:[e.classe!=="all"&&t.jsx("span",{className:"meta-tag",children:e.classe}),e.matiere&&t.jsx("span",{className:"meta-tag",children:e.matiere}),t.jsxs("span",{className:"meta-pages",children:[e.nombrePages," pages"]}),t.jsx("span",{className:"meta-size",children:$c(e.tailleFichier)})]}),t.jsxs("div",{className:"ebook-actions",children:[t.jsx("button",{className:"btn-read",onClick:n,children:r?" Lire":` Aperu (${e.pagesApercu} pages)`}),r&&t.jsx("a",{href:e.fichierURL,target:"_blank",rel:"noopener noreferrer",className:"btn-download",download:!0,children:" Tlcharger"})]})]})]}),Yee=({ebook:e,isPremium:r,onBack:n,onGoPremium:a})=>{const[l,o]=g.useState(!0),[u,d]=g.useState("info");g.useEffect(()=>{Fee(e.id)},[e.id]);const f=()=>r?e.fichierURL:e.aperuURL?e.aperuURL:null,p=async()=>{if(!r){a();return}await Gee(e.id),window.open(e.fichierURL,"_blank")},h=()=>{o(!1)};return t.jsxs("div",{className:"ebook-viewer",children:[t.jsxs("div",{className:"viewer-navbar",children:[t.jsx("button",{onClick:n,className:"btn-back",children:" Retour  la bibliothque"}),t.jsxs("div",{className:"viewer-title-bar",children:[t.jsxs("span",{className:"viewer-category",children:[es[e.categorie]," ",Ji[e.categorie]]}),t.jsx("h2",{className:"viewer-title",children:e.titre})]}),t.jsxs("div",{className:"viewer-actions-bar",children:[t.jsx("button",{className:`btn-tab ${u==="info"?"active":""}`,onClick:()=>d("info"),children:" Dtails"}),t.jsxs("button",{className:`btn-tab ${u==="read"?"active":""}`,onClick:()=>d("read"),children:[" ",r?"Lire":"Aperu"]})]})]}),u==="info"&&t.jsx("div",{className:"viewer-info-panel",children:t.jsxs("div",{className:"info-layout",children:[t.jsxs("div",{className:"info-cover-column",children:[e.couvertureURL?t.jsx("img",{src:e.couvertureURL,alt:e.titre,className:"info-cover-image"}):t.jsxs("div",{className:"info-cover-placeholder",children:[t.jsx("span",{children:es[e.categorie]}),t.jsx("span",{children:e.titre})]}),t.jsxs("div",{className:"info-actions",children:[t.jsxs("button",{className:"btn-action-read",onClick:()=>d("read"),children:[" ",r?"Lire le document":`Aperu (${e.pagesApercu} pages)`]}),r?t.jsx("button",{className:"btn-action-download",onClick:p,children:" Tlcharger le PDF"}):t.jsx("button",{className:"btn-action-premium",onClick:a,children:" Accs complet  Passer Premium"})]})]}),t.jsxs("div",{className:"info-details-column",children:[t.jsx("h1",{className:"info-title",children:e.titre}),t.jsxs("p",{className:"info-author",children:["par ",e.auteur]}),t.jsxs("div",{className:"info-description",children:[t.jsx("h3",{children:"Description"}),t.jsx("p",{children:e.description})]}),t.jsxs("div",{className:"info-metadata",children:[t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Catgorie"}),t.jsxs("span",{className:"metadata-value",children:[es[e.categorie]," ",Ji[e.categorie]]})]}),t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Niveau"}),t.jsx("span",{className:"metadata-value",children:e.niveau==="college"?"Collge":"Lyce"})]}),e.classe!=="all"&&t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Classe"}),t.jsx("span",{className:"metadata-value",children:e.classe})]}),e.matiere&&t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Matire"}),t.jsx("span",{className:"metadata-value",children:e.matiere})]}),t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Pages"}),t.jsx("span",{className:"metadata-value",children:e.nombrePages})]}),t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Taille"}),t.jsx("span",{className:"metadata-value",children:$c(e.tailleFichier)})]}),e.annee&&t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"Anne"}),t.jsx("span",{className:"metadata-value",children:e.annee})]}),e.editeur&&t.jsxs("div",{className:"metadata-item",children:[t.jsx("span",{className:"metadata-label",children:"diteur"}),t.jsx("span",{className:"metadata-value",children:e.editeur})]})]}),t.jsxs("div",{className:"info-stats",children:[t.jsxs("span",{children:[" ",e.nombreVues," vue",e.nombreVues>1?"s":""]}),t.jsxs("span",{children:[" ",e.nombreTelechargements," tlchargement",e.nombreTelechargements>1?"s":""]})]}),e.tags&&e.tags.length>0&&t.jsx("div",{className:"info-tags",children:e.tags.map((v,b)=>t.jsx("span",{className:"info-tag",children:v},b))})]})]})}),u==="read"&&t.jsx("div",{className:"viewer-read-panel",children:f()?t.jsxs(t.Fragment,{children:[l&&t.jsxs("div",{className:"viewer-loading",children:[t.jsx("div",{className:"loading-spinner"}),t.jsx("p",{children:"Chargement du document..."})]}),t.jsx("iframe",{src:`${f()}#toolbar=1&navpanes=0`,className:"pdf-iframe",title:e.titre,onLoad:h,style:{display:l?"none":"block"}}),!r&&t.jsx("div",{className:"viewer-premium-overlay",children:t.jsxs("div",{className:"overlay-content",children:[t.jsx("div",{className:"overlay-lock",children:""}),t.jsxs("h3",{children:["Aperu limit  ",e.pagesApercu," pages"]}),t.jsxs("p",{children:["Pour lire l'intgralit de ce document (",e.nombrePages," pages) et le tlcharger, passez  PedaClic Premium."]}),t.jsx("button",{onClick:a,className:"btn-overlay-premium",children:"Passer Premium  2 000 FCFA/mois"}),t.jsx("button",{onClick:n,className:"btn-overlay-back",children:"Retour  la bibliothque"})]})})]}):t.jsx("div",{className:"viewer-no-preview",children:t.jsxs("div",{className:"no-preview-content",children:[t.jsx("div",{className:"overlay-lock",children:""}),t.jsx("h3",{children:"Document rserv aux abonns Premium"}),t.jsxs("p",{children:["Ce document de ",e.nombrePages," pages est accessible uniquement avec un abonnement PedaClic Premium."]}),t.jsx("button",{onClick:a,className:"btn-overlay-premium",children:"Passer Premium  2 000 FCFA/mois"}),t.jsx("button",{onClick:n,className:"btn-overlay-back",children:"Retour  la bibliothque"})]})})})]})},Kee=()=>{const{currentUser:e}=Ke(),r=Je(),[n,a]=g.useState(null),l=d=>{a(d)},o=()=>{a(null)},u=()=>{r("/premium")};return n?t.jsx(Yee,{ebook:n,isPremium:e?.isPremium||!1,onBack:o,onGoPremium:u}):t.jsx(Vee,{isPremium:e?.isPremium||!1,onReadEbook:l})},Wee=()=>{const[e,r]=g.useState([]),[n,a]=g.useState(!0),[l,o]=g.useState(null),[u,d]=g.useState(null),[f,p]=g.useState(!1),[h,v]=g.useState(null),[b,x]=g.useState(Y()),[j,_]=g.useState(!1),[C,w]=g.useState(null),[E,S]=g.useState(null),[A,O]=g.useState(null),[k,P]=g.useState(null),D=g.useRef(null),B=g.useRef(null),U=g.useRef(null),[$,R]=g.useState(null);function Y(){return{titre:"",auteur:"",description:"",categorie:"manuel",niveau:"college",classe:"all",matiere:"",nombrePages:0,pagesApercu:5,annee:"",editeur:"",isbn:"",tags:[],ordre:0,isActive:!0}}g.useEffect(()=>{ae()},[]);const ae=async()=>{try{a(!0),o(null);const K=await qee();r(K),d(Hee(K))}catch(K){o("Erreur lors du chargement des ebooks"),console.error(K)}finally{a(!1)}},M=K=>{const{name:oe,value:xe,type:ve}=K.target;x(ve==="number"?H=>({...H,[oe]:parseInt(xe)||0}):ve==="checkbox"?H=>({...H,[oe]:K.target.checked}):H=>({...H,[oe]:xe}))},T=K=>{const oe=K.target.value.split(",").map(xe=>xe.trim()).filter(Boolean);x(xe=>({...xe,tags:oe}))},F=async K=>{if(K.preventDefault(),!b.titre.trim()){o("Le titre est obligatoire");return}if(!h&&!E){o("Le fichier PDF est obligatoire");return}try{_(!0),o(null),h?(await $ee(h.id,b,E,A,k),w(` Ebook "${b.titre}" modifi avec succs`)):(await Lee(b,E,A,k),w(` Ebook "${b.titre}" ajout avec succs`)),ne(),await ae(),setTimeout(()=>w(null),4e3)}catch(oe){o(oe.message||"Erreur lors de la sauvegarde")}finally{_(!1)}},I=K=>{v(K),x({titre:K.titre,auteur:K.auteur,description:K.description,categorie:K.categorie,niveau:K.niveau,classe:K.classe,matiere:K.matiere||"",nombrePages:K.nombrePages,pagesApercu:K.pagesApercu,annee:K.annee||"",editeur:K.editeur||"",isbn:K.isbn||"",tags:K.tags||[],ordre:K.ordre,isActive:K.isActive}),p(!0),window.scrollTo({top:0,behavior:"smooth"})},X=async K=>{try{await Bee(K),R(null),w(" Ebook supprim avec succs"),await ae(),setTimeout(()=>w(null),4e3)}catch(oe){o(oe.message||"Erreur lors de la suppression")}},L=async(K,oe)=>{try{await Uee(K,!oe),await ae()}catch(xe){o(xe.message)}},ne=()=>{x(Y()),v(null),S(null),O(null),P(null),p(!1),D.current&&(D.current.value=""),B.current&&(B.current.value=""),U.current&&(U.current.value="")};return n?t.jsx("div",{className:"admin-ebooks",children:t.jsxs("div",{className:"admin-loading",children:[t.jsx("div",{className:"loading-spinner"}),t.jsx("p",{children:"Chargement des ebooks..."})]})}):t.jsxs("div",{className:"admin-ebooks",children:[t.jsxs("div",{className:"admin-ebooks-header",children:[t.jsx("h1",{children:" Gestion de la Bibliothque"}),t.jsx("button",{className:"btn-add-ebook",onClick:()=>{ne(),p(!f)},children:f?" Fermer":"+ Ajouter un ebook"})]}),l&&t.jsxs("div",{className:"admin-alert error",children:[" ",l]}),C&&t.jsx("div",{className:"admin-alert success",children:C}),u&&t.jsxs("div",{className:"admin-stats-grid",children:[t.jsxs("div",{className:"stat-card",children:[t.jsx("span",{className:"stat-number",children:u.totalEbooks}),t.jsx("span",{className:"stat-label",children:"Total ebooks"})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("span",{className:"stat-number",children:u.ebooksActifs}),t.jsx("span",{className:"stat-label",children:"Actifs"})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("span",{className:"stat-number",children:u.totalVues}),t.jsx("span",{className:"stat-label",children:"Vues totales"})]}),t.jsxs("div",{className:"stat-card",children:[t.jsx("span",{className:"stat-number",children:u.totalTelechargements}),t.jsx("span",{className:"stat-label",children:"Tlchargements"})]})]}),f&&t.jsxs("div",{className:"admin-ebook-form-container",children:[t.jsx("h2",{children:h?" Modifier l'ebook":" Ajouter un ebook"}),t.jsxs("form",{onSubmit:F,className:"admin-ebook-form",children:[t.jsxs("div",{className:"form-row",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"titre",children:"Titre *"}),t.jsx("input",{id:"titre",name:"titre",type:"text",value:b.titre,onChange:M,placeholder:"Ex: Mathmatiques 3me - Programme complet",required:!0})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"auteur",children:"Auteur(s) *"}),t.jsx("input",{id:"auteur",name:"auteur",type:"text",value:b.auteur,onChange:M,placeholder:"Ex: Pr. Diallo Moussa",required:!0})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"description",children:"Description *"}),t.jsx("textarea",{id:"description",name:"description",value:b.description,onChange:M,placeholder:"Dcrivez le contenu de cet ebook...",rows:3,required:!0})]}),t.jsxs("div",{className:"form-row form-row-3",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"categorie",children:"Catgorie *"}),t.jsx("select",{id:"categorie",name:"categorie",value:b.categorie,onChange:M,children:Object.keys(Ji).map(K=>t.jsxs("option",{value:K,children:[es[K]," ",Ji[K]]},K))})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"niveau",children:"Niveau *"}),t.jsxs("select",{id:"niveau",name:"niveau",value:b.niveau,onChange:M,children:[t.jsx("option",{value:"college",children:"Collge"}),t.jsx("option",{value:"lycee",children:"Lyce"})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"classe",children:"Classe"}),t.jsxs("select",{id:"classe",name:"classe",value:b.classe,onChange:M,children:[t.jsx("option",{value:"all",children:"Toutes les classes"}),t.jsx("option",{value:"6eme",children:"6me"}),t.jsx("option",{value:"5eme",children:"5me"}),t.jsx("option",{value:"4eme",children:"4me"}),t.jsx("option",{value:"3eme",children:"3me"}),t.jsx("option",{value:"2nde",children:"2nde"}),t.jsx("option",{value:"1ere",children:"1re"}),t.jsx("option",{value:"Terminale",children:"Terminale"})]})]})]}),t.jsxs("div",{className:"form-row form-row-3",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"matiere",children:"Matire"}),t.jsxs("select",{id:"matiere",name:"matiere",value:b.matiere,onChange:M,children:[t.jsx("option",{value:"",children:"-- Slectionner --"}),wM.map(K=>t.jsx("option",{value:K,children:K},K))]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"annee",children:"Anne"}),t.jsx("input",{id:"annee",name:"annee",type:"text",value:b.annee,onChange:M,placeholder:"Ex: 2024-2025"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"editeur",children:"diteur"}),t.jsx("input",{id:"editeur",name:"editeur",type:"text",value:b.editeur,onChange:M,placeholder:"Ex: INEADE"})]})]}),t.jsxs("div",{className:"form-row form-row-3",children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"nombrePages",children:"Nombre de pages *"}),t.jsx("input",{id:"nombrePages",name:"nombrePages",type:"number",value:b.nombrePages,onChange:M,min:"1",required:!0})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"pagesApercu",children:"Pages en aperu gratuit"}),t.jsx("input",{id:"pagesApercu",name:"pagesApercu",type:"number",value:b.pagesApercu,onChange:M,min:"1",max:"20"}),t.jsx("small",{children:"Nombre de pages visibles sans Premium (1-20)"})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"ordre",children:"Ordre d'affichage"}),t.jsx("input",{id:"ordre",name:"ordre",type:"number",value:b.ordre,onChange:M,min:"0"})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{htmlFor:"tags",children:"Tags (spars par des virgules)"}),t.jsx("input",{id:"tags",type:"text",value:b.tags?.join(", ")||"",onChange:T,placeholder:"Ex: BFEM, annales, mathmatiques, gomtrie"})]}),t.jsxs("div",{className:"form-files-section",children:[t.jsx("h3",{children:" Fichiers"}),t.jsxs("div",{className:"form-group file-group",children:[t.jsxs("label",{children:["Fichier PDF complet ",!h&&"*",h&&t.jsx("small",{children:"(laisser vide pour garder l'actuel)"})]}),t.jsx("input",{ref:D,type:"file",accept:".pdf",onChange:K=>S(K.target.files?.[0]||null),className:"file-input"}),E&&t.jsxs("span",{className:"file-info",children:[" ",E.name," (",$c(E.size),")"]})]}),t.jsxs("div",{className:"form-group file-group",children:[t.jsxs("label",{children:["Image de couverture",t.jsx("small",{children:"(JPG, PNG  recommand : 400560px)"})]}),t.jsx("input",{ref:B,type:"file",accept:"image/*",onChange:K=>O(K.target.files?.[0]||null),className:"file-input"}),A&&t.jsxs("span",{className:"file-info",children:[" ",A.name," (",$c(A.size),")"]})]}),t.jsxs("div",{className:"form-group file-group",children:[t.jsxs("label",{children:["PDF Aperu (premires pages uniquement)",t.jsx("small",{children:"(optionnel  sinon le PDF complet est affich aux non-Premium)"})]}),t.jsx("input",{ref:U,type:"file",accept:".pdf",onChange:K=>P(K.target.files?.[0]||null),className:"file-input"}),k&&t.jsxs("span",{className:"file-info",children:[" ",k.name," (",$c(k.size),")"]})]})]}),t.jsx("div",{className:"form-group checkbox-group",children:t.jsxs("label",{children:[t.jsx("input",{type:"checkbox",name:"isActive",checked:b.isActive,onChange:M}),"Ebook actif (visible dans la bibliothque)"]})}),t.jsxs("div",{className:"form-actions",children:[t.jsx("button",{type:"submit",className:"btn-save",disabled:j,children:j?" Enregistrement...":h?" Modifier l'ebook":" Ajouter l'ebook"}),t.jsx("button",{type:"button",className:"btn-cancel",onClick:ne,children:"Annuler"})]})]})]}),t.jsxs("div",{className:"admin-ebooks-list",children:[t.jsxs("h2",{children:[" Liste des ebooks (",e.length,")"]}),e.length===0?t.jsxs("div",{className:"admin-empty",children:[t.jsx("p",{children:"Aucun ebook pour le moment."}),t.jsx("button",{className:"btn-add-ebook",onClick:()=>p(!0),children:"+ Ajouter le premier ebook"})]}):t.jsx("div",{className:"admin-ebooks-table-wrapper",children:t.jsxs("table",{className:"admin-ebooks-table",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Couverture"}),t.jsx("th",{children:"Titre / Auteur"}),t.jsx("th",{children:"Catgorie"}),t.jsx("th",{children:"Classe"}),t.jsx("th",{children:"Pages"}),t.jsx("th",{children:"Vues / DL"}),t.jsx("th",{children:"Statut"}),t.jsx("th",{children:"Actions"})]})}),t.jsx("tbody",{children:e.map(K=>t.jsxs("tr",{className:K.isActive?"":"row-inactive",children:[t.jsx("td",{className:"td-cover",children:K.couvertureURL?t.jsx("img",{src:K.couvertureURL,alt:"",className:"mini-cover"}):t.jsx("div",{className:"mini-cover-placeholder",children:es[K.categorie]})}),t.jsxs("td",{className:"td-title",children:[t.jsx("strong",{children:K.titre}),t.jsx("span",{className:"td-author",children:K.auteur})]}),t.jsx("td",{children:t.jsxs("span",{className:"badge-category",children:[es[K.categorie]," ",Ji[K.categorie]]})}),t.jsx("td",{children:K.classe==="all"?"Toutes":K.classe}),t.jsx("td",{children:K.nombrePages}),t.jsx("td",{children:t.jsxs("span",{className:"td-stats",children:[" ",K.nombreVues,t.jsx("br",{})," ",K.nombreTelechargements]})}),t.jsx("td",{children:t.jsx("button",{className:`btn-status ${K.isActive?"active":"inactive"}`,onClick:()=>L(K.id,K.isActive),title:K.isActive?"Dsactiver":"Activer",children:K.isActive?" Actif":" Inactif"})}),t.jsxs("td",{className:"td-actions",children:[t.jsx("button",{className:"btn-edit",onClick:()=>I(K),title:"Modifier",children:""}),$===K.id?t.jsxs("div",{className:"delete-confirm",children:[t.jsx("span",{children:"Supprimer ?"}),t.jsx("button",{className:"btn-confirm-yes",onClick:()=>X(K.id),children:"Oui"}),t.jsx("button",{className:"btn-confirm-no",onClick:()=>R(null),children:"Non"})]}):t.jsx("button",{className:"btn-delete",onClick:()=>R(K.id),title:"Supprimer",children:""})]})]},K.id))})]})})]})]})},Ln="mediatheque",CM="mediatheque_vues";async function oA(e={},r=50){let n=Ee(_e(Q,Ln),Ne("statut","==","publie"),Ve("createdAt","desc"),Ht(r));e.type&&e.type!=="all"&&(n=Ee(_e(Q,Ln),Ne("statut","==","publie"),Ne("type","==",e.type),Ve("createdAt","desc"),Ht(r)));let l=(await Ce(n)).docs.map(o=>({id:o.id,...o.data()}));if(e.discipline&&(l=l.filter(o=>o.discipline===e.discipline)),e.niveau&&(l=l.filter(o=>o.niveau===e.niveau)),e.acces==="gratuit"?l=l.filter(o=>!o.isPremium):e.acces==="premium"&&(l=l.filter(o=>o.isPremium)),e.recherche?.trim()){const o=e.recherche.toLowerCase().trim();l=l.filter(u=>u.titre.toLowerCase().includes(o)||u.description.toLowerCase().includes(o)||(u.tags??[]).some(d=>d.toLowerCase().includes(o)))}return l}async function Xee(e){const r=Ee(_e(Q,Ln),Ne("auteurId","==",e),Ve("createdAt","desc"));return(await Ce(r)).docs.map(a=>({id:a.id,...a.data()}))}async function Zee(){const e=Ee(_e(Q,Ln),Ve("createdAt","desc"));return(await Ce(e)).docs.map(n=>({id:n.id,...n.data()}))}async function EM(e){const r=await Et(je(Q,Ln,e));return r.exists()?{id:r.id,...r.data()}:null}async function Jee(e,r,n=4){const a=Ee(_e(Q,Ln),Ne("statut","==","publie"),Ne("discipline","==",r),Ve("vues","desc"),Ht(n+1));return(await Ce(a)).docs.map(o=>({id:o.id,...o.data()})).filter(o=>o.id!==e).slice(0,n)}async function ete(e,r,n){const a=Ae.now();return(await Pt(_e(Q,Ln),{...e,auteurId:r,auteurNom:n,vues:0,tags:e.tags??[],statut:e.statut??"brouillon",createdAt:a,updatedAt:a})).id}async function Bc(e,r){await He(je(Q,Ln,e),{...r,updatedAt:Ae.now()})}async function tte(e,r){await He(je(Q,Ln,e),{statut:r,updatedAt:Ae.now()})}async function rte(e,r){await He(je(Q,Ln,e),{isPremium:r,updatedAt:Ae.now()})}async function nte(e){if(await Br(je(Q,Ln,e.id)),e.url.includes("firebasestorage"))try{const r=sr(er,cA(e.url));await Is(r)}catch{console.warn("[Mdiathque] Fichier principal introuvable en Storage, ignor.")}if(e.thumbnailUrl?.includes("firebasestorage"))try{const r=sr(er,cA(e.thumbnailUrl));await Is(r)}catch{console.warn("[Mdiathque] Vignette introuvable en Storage, ignore.")}}async function ate(e,r,n,a,l){const o=new Date().getFullYear();let u,d;switch(n){case"video":u=`mediatheque/videos/${a}/${r}`,d="video.mp4";break;case"audio":u=`mediatheque/audios/${a}/${r}`,d="audio.mp3";break;case"podcast":u=`mediatheque/audios/${a}/${r}`,d="podcast.mp3";break;case"webinaire":u=`mediatheque/webinaires/${o}/${r}`,d="enregistrement.mp4";break}const f=sr(er,`${u}/${d}`),p=lu(f,e,{contentType:e.type,customMetadata:{mediaId:r,discipline:a}});return new Promise((h,v)=>{p.on("state_changed",b=>{const x=Math.round(b.bytesTransferred/b.totalBytes*100);l?.(x)},b=>{console.error("[Mdiathque] Erreur upload :",b),v(new Error(`chec de l'upload : ${b.message}`))},async()=>{const b=await Mn(p.snapshot.ref);h(b)})})}async function AM(e,r){const n=e.name.split(".").pop()?.toLowerCase()??"jpg",a=sr(er,`mediatheque/thumbnails/${r}/thumb.${n}`),l=lu(a,e,{contentType:e.type});return new Promise((o,u)=>{l.on("state_changed",()=>{},u,async()=>{const d=await Mn(l.snapshot.ref);o(d)})})}async function ite(e){await He(je(Q,Ln,e),{vues:as(1)})}async function ste(e,r,n,a,l){const o=`${e}_${r}`,u=l>0&&n/l>=.8;await su(je(Q,CM,o),{mediaId:r,userId:e,dureeVisionnee:n,positionReprise:a,estTermine:u,vueAt:Ae.now()},{merge:!0})}async function lte(e,r){const n=`${e}_${r}`,a=await Et(je(Q,CM,n));return a.exists()?{id:a.id,...a.data()}:null}function cA(e){try{const n=new URL(e).pathname.match(/\/o\/(.+)$/);if(n)return decodeURIComponent(n[1])}catch{}return""}const xa={video:{label:"Vido",emoji:"",couleur:"#2563eb",bg:"#eff6ff",accept:"video/*"},audio:{label:"Audio",emoji:"",couleur:"#7c3aed",bg:"#f5f3ff",accept:"audio/*"},podcast:{label:"Podcast",emoji:"",couleur:"#059669",bg:"#ecfdf5",accept:"audio/*"},webinaire:{label:"Webinaire",emoji:"",couleur:"#d97706",bg:"#fffbeb",accept:"video/*"}},jf={publie:{label:"Publi",couleur:"#16a34a",bg:"#f0fdf4"},brouillon:{label:"Brouillon",couleur:"#6b7280",bg:"#f3f4f6"},planifiee:{label:"Planifi",couleur:"#2563eb",bg:"#eff6ff"},archive:{label:"Archiv",couleur:"#9ca3af",bg:"#f9fafb"}},Ib=30;function _f(e){const r=Math.floor(e/3600),n=Math.floor(e%3600/60),a=Math.floor(e%60);return r>0?`${r}:${String(n).padStart(2,"0")}:${String(a).padStart(2,"0")}`:`${n}:${String(a).padStart(2,"0")}`}function ote({media:e,isPremium:r,onClick:n,isAdmin:a,onEdit:l,onDelete:o,onTogglePremium:u,onSetStatut:d}){const f=xa[e.type],p=!e.isPremium||r;return t.jsxs("article",{className:`media-card ${a?"media-card--admin":""}`,onClick:a?void 0:n,role:a?void 0:"button",tabIndex:a?void 0:0,onKeyDown:a?void 0:(h=>h.key==="Enter"&&n()),"aria-label":a?void 0:`Lire : ${e.titre}`,children:[t.jsxs("div",{className:"media-card__vignette",children:[e.thumbnailUrl?t.jsx("img",{src:e.thumbnailUrl,alt:e.titre,className:"media-card__image",loading:"lazy"}):t.jsx("div",{className:"media-card__vignette-default",children:t.jsx("span",{children:f.emoji})}),e.duree>0&&t.jsx("span",{className:"media-card__duree",children:_f(e.duree)}),e.isPremium?t.jsx("span",{className:"media-card__badge-premium",children:" Premium"}):t.jsx("span",{className:"media-card__badge-gratuit",children:" Gratuit"}),e.isPremium&&!p&&t.jsx("div",{className:"media-card__apercu-overlay",children:" Aperu 30 secondes"}),t.jsx("div",{className:"media-card__play","aria-hidden":"true",children:t.jsx("div",{className:"media-card__play-icone",children:""})})]}),a&&l&&o&&u&&d&&t.jsxs("div",{className:"media-card__admin-actions",onClick:h=>h.stopPropagation(),children:[t.jsx("button",{type:"button",className:"media-card__admin-btn media-card__admin-btn--edit",onClick:()=>l(e),title:"Modifier",children:""}),t.jsx("button",{type:"button",className:`media-card__admin-btn ${e.isPremium?"media-card__admin-btn--premium":""}`,onClick:()=>u(e),title:e.isPremium?"Passer en gratuit":"Passer en Premium",children:e.isPremium?"":""}),t.jsx("select",{className:"media-card__admin-select",value:e.statut,onChange:h=>d(e,h.target.value),onClick:h=>h.stopPropagation(),title:"Statut",children:Object.entries(jf).map(([h,v])=>t.jsx("option",{value:h,children:v.label},h))}),t.jsx("button",{type:"button",className:"media-card__admin-btn media-card__admin-btn--view",onClick:()=>n(),title:"Voir",children:""}),t.jsx("button",{type:"button",className:"media-card__admin-btn media-card__admin-btn--delete",onClick:()=>o(e),title:"Supprimer",children:""})]}),t.jsxs("div",{className:"media-card__corps",onClick:a?()=>n():void 0,style:a?{cursor:"pointer"}:void 0,children:[t.jsxs("span",{className:"media-card__type",style:{backgroundColor:f.bg,color:f.couleur},children:[f.emoji," ",f.label]}),t.jsx("h3",{className:"media-card__titre",children:e.titre}),t.jsxs("p",{className:"media-card__auteur",children:["Par ",e.auteurNom]}),t.jsxs("div",{className:"media-card__footer",children:[t.jsxs("div",{className:"media-card__meta",children:[t.jsx("span",{className:"media-card__discipline",children:e.discipline}),t.jsxs("span",{className:"media-card__classe",children:[e.niveau," ",e.classe?` ${e.classe}`:""]})]}),t.jsxs("span",{className:"media-card__vues",children:[" ",e.vues.toLocaleString("fr-SN")]})]})]})]})}function cte(){const{currentUser:e}=Ke(),r=Je(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState({type:"all",discipline:"",niveau:"",recherche:"",acces:"all",statut:""}),[h,v]=g.useState(null),[b,x]=g.useState(!1),[j,_]=g.useState(null),{matieres:C}=Ca(),w=g.useMemo(()=>{const R=n.length,Y=n.filter(T=>T.type==="video").length,ae=n.filter(T=>T.type==="audio"||T.type==="podcast").length,M=n.filter(T=>T.type==="webinaire").length;return{total:R,videos:Y,audios:ae,webs:M}},[n]),E=g.useMemo(()=>n.filter(R=>{if(f.type!=="all"&&R.type!==f.type||f.discipline&&R.discipline!==f.discipline||f.niveau&&R.niveau!==f.niveau||f.acces==="gratuit"&&R.isPremium||f.acces==="premium"&&!R.isPremium||f.statut&&R.statut!==f.statut)return!1;if(f.recherche.trim()){const Y=f.recherche.toLowerCase().trim();return R.titre.toLowerCase().includes(Y)||R.description.toLowerCase().includes(Y)||R.discipline.toLowerCase().includes(Y)||(R.tags??[]).some(ae=>ae.toLowerCase().includes(Y))}return!0}),[n,f]);g.useEffect(()=>{async function R(){try{o(!0),d(null);let Y;if(e?.role==="admin")Y=await Zee();else if(e?.role==="prof"){const[ae,M]=await Promise.all([oA(),Xee(e.uid)]),T=new Set(ae.map(I=>I.id)),F=M.filter(I=>!T.has(I.id));Y=[...ae,...F]}else Y=await oA();a(Y)}catch(Y){console.error("[Mdiathque] Erreur chargement :",Y),d("Impossible de charger la mdiathque. Vrifiez votre connexion.")}finally{o(!1)}}R()},[e]);const S=(R,Y)=>{p(ae=>({...ae,[R]:Y}))},A=()=>{p({type:"all",discipline:"",niveau:"",recherche:"",acces:"all",statut:""})},O=R=>{r(`/mediatheque/${R}`)},k=e?.role==="admin",P=R=>{r(`/mediatheque/${R.id}/modifier`)},D=R=>{v(R)},B=async()=>{if(h){x(!0);try{await nte(h),a(R=>R.filter(Y=>Y.id!==h.id)),_("Contenu supprim."),setTimeout(()=>_(null),2e3)}catch(R){console.error("[Mdiathque] Erreur suppression:",R),_("Erreur lors de la suppression.")}finally{x(!1),v(null)}}},U=async R=>{try{await rte(R.id,!R.isPremium),a(Y=>Y.map(ae=>ae.id===R.id?{...ae,isPremium:!ae.isPremium}:ae)),_(R.isPremium?"Pass en gratuit":"Pass en Premium"),setTimeout(()=>_(null),2e3)}catch{_("Erreur")}},$=async(R,Y)=>{try{await tte(R.id,Y),a(ae=>ae.map(M=>M.id===R.id?{...M,statut:Y}:M)),_(`Statut : ${jf[Y].label}`),setTimeout(()=>_(null),2e3)}catch{_("Erreur")}};return t.jsxs("div",{className:"mediatheque-page",children:[t.jsxs("section",{className:"mediatheque-hero","aria-label":"En-tte mdiathque",children:[t.jsx("h1",{className:"mediatheque-hero__titre",children:" Mdiathque PedaClic"}),t.jsx("p",{className:"mediatheque-hero__sous-titre",children:"Cours en vido, podcasts pdagogiques et webinaires  L'cole en un clic"}),t.jsxs("div",{className:"mediatheque-hero__stats","aria-label":"Statistiques des contenus",children:[t.jsxs("div",{className:"mediatheque-hero__stat",children:[t.jsx("span",{className:"mediatheque-hero__stat-nombre",children:w.total}),t.jsx("span",{className:"mediatheque-hero__stat-label",children:"Contenus"})]}),t.jsxs("div",{className:"mediatheque-hero__stat",children:[t.jsx("span",{className:"mediatheque-hero__stat-nombre",children:w.videos}),t.jsx("span",{className:"mediatheque-hero__stat-label",children:"Vidos"})]}),t.jsxs("div",{className:"mediatheque-hero__stat",children:[t.jsx("span",{className:"mediatheque-hero__stat-nombre",children:w.audios}),t.jsx("span",{className:"mediatheque-hero__stat-label",children:"Audio"})]}),t.jsxs("div",{className:"mediatheque-hero__stat",children:[t.jsx("span",{className:"mediatheque-hero__stat-nombre",children:w.webs}),t.jsx("span",{className:"mediatheque-hero__stat-label",children:"Webinaires"})]})]})]}),t.jsxs("nav",{className:"mediatheque-filtres","aria-label":"Filtres de la mdiathque",children:[t.jsxs("div",{className:"mediatheque-filtres__ligne",children:[t.jsxs("div",{className:"mediatheque-filtres__recherche",children:[t.jsx("span",{className:"mediatheque-filtres__recherche-icone","aria-hidden":!0,children:""}),t.jsx("input",{type:"search",className:"mediatheque-filtres__recherche-input",placeholder:"Rechercher un cours, une matire, un tag...",value:f.recherche,onChange:R=>S("recherche",R.target.value),"aria-label":"Rechercher dans la mdiathque"})]}),t.jsxs("select",{className:"mediatheque-filtres__select",value:f.discipline,onChange:R=>S("discipline",R.target.value),"aria-label":"Filtrer par discipline",children:[t.jsx("option",{value:"",children:"Toutes les matires"}),C.map(R=>t.jsx("option",{value:R.valeur,children:R.label},R.valeur))]}),t.jsxs("select",{className:"mediatheque-filtres__select",value:f.niveau,onChange:R=>S("niveau",R.target.value),"aria-label":"Filtrer par niveau",children:[t.jsx("option",{value:"",children:"Tous les niveaux"}),wa.map(R=>t.jsx("option",{value:R,children:R},R))]}),t.jsxs("select",{className:"mediatheque-filtres__select",value:f.acces,onChange:R=>S("acces",R.target.value),"aria-label":"Filtrer par type d'accs",children:[t.jsx("option",{value:"all",children:"Tout l'accs"}),t.jsx("option",{value:"gratuit",children:" Gratuit"}),t.jsx("option",{value:"premium",children:" Premium"})]}),k&&t.jsxs("select",{className:"mediatheque-filtres__select",value:f.statut||"",onChange:R=>p(Y=>({...Y,statut:R.target.value})),"aria-label":"Filtrer par statut",children:[t.jsx("option",{value:"",children:"Tous les statuts"}),Object.entries(jf).map(([R,Y])=>t.jsx("option",{value:R,children:Y.label},R))]}),(e?.role==="admin"||e?.role==="prof")&&t.jsx("button",{className:"btn-principal",onClick:()=>r("/mediatheque/ajouter"),"aria-label":"Ajouter un nouveau contenu",children:"+ Ajouter"})]}),t.jsxs("div",{className:"mediatheque-filtres__types",role:"group","aria-label":"Filtrer par type",children:[t.jsx("button",{className:`mediatheque-filtres__type-btn${f.type==="all"?" mediatheque-filtres__type-btn--actif":""}`,onClick:()=>S("type","all"),"aria-pressed":f.type==="all",children:" Tous"}),Object.entries(xa).map(([R,Y])=>t.jsxs("button",{className:`mediatheque-filtres__type-btn${f.type===R?" mediatheque-filtres__type-btn--actif":""}`,onClick:()=>S("type",R),"aria-pressed":f.type===R,children:[Y.emoji," ",Y.label]},R))]})]}),t.jsxs("main",{className:"mediatheque-contenu",children:[t.jsxs("div",{className:"mediatheque-catalogue__header",children:[t.jsx("h2",{className:"mediatheque-catalogue__titre",children:f.type==="all"?"Tous les contenus":xa[f.type]?.label??"Contenus"}),!l&&t.jsxs("span",{className:"mediatheque-catalogue__compteur",children:[E.length," rsultat",E.length!==1?"s":""]})]}),l&&t.jsxs("div",{className:"mediatheque-chargement",role:"status","aria-live":"polite",children:[t.jsx("div",{className:"mediatheque-spinner","aria-hidden":"true"}),t.jsx("p",{children:"Chargement de la mdiathque..."})]}),!l&&u&&t.jsxs("div",{className:"mediatheque-vide",role:"alert",children:[t.jsx("span",{className:"mediatheque-vide__emoji",children:""}),t.jsx("h3",{className:"mediatheque-vide__titre",children:"Erreur de chargement"}),t.jsx("p",{className:"mediatheque-vide__message",children:u}),t.jsx("button",{className:"btn-principal",onClick:()=>window.location.reload(),children:" Ressayer"})]}),!l&&!u&&E.length===0&&t.jsxs("div",{className:"mediatheque-vide",role:"status",children:[t.jsx("span",{className:"mediatheque-vide__emoji",children:""}),t.jsx("h3",{className:"mediatheque-vide__titre",children:"Aucun contenu trouv"}),t.jsx("p",{className:"mediatheque-vide__message",children:n.length===0?"La mdiathque ne contient pas encore de contenus publis.":"Aucun contenu ne correspond  vos critres de recherche."}),(f.type!=="all"||f.discipline||f.niveau||f.recherche||f.acces!=="all"||f.statut)&&t.jsx("button",{className:"btn-secondaire",onClick:A,children:"Rinitialiser les filtres"})]}),!l&&!u&&E.length>0&&t.jsx("div",{className:"mediatheque-grille",role:"list","aria-label":"Liste des contenus multimdias",children:E.map(R=>t.jsx("div",{role:"listitem",children:t.jsx(ote,{media:R,isPremium:e?.isPremium??!1,onClick:()=>O(R.id),isAdmin:k,onEdit:k?P:void 0,onDelete:k?D:void 0,onTogglePremium:k?U:void 0,onSetStatut:k?$:void 0})},R.id))}),j&&t.jsx("div",{className:"mediatheque-toast",role:"status",children:j}),h&&t.jsx("div",{className:"mediatheque-modal-overlay",onClick:()=>v(null),children:t.jsxs("div",{className:"mediatheque-modal",onClick:R=>R.stopPropagation(),children:[t.jsx("h3",{children:"Supprimer ce contenu ?"}),t.jsxs("p",{children:[" ",h.titre,"  sera dfinitivement supprim."]}),t.jsxs("div",{className:"mediatheque-modal__actions",children:[t.jsx("button",{type:"button",className:"btn-secondaire",onClick:()=>v(null),children:"Annuler"}),t.jsx("button",{type:"button",className:"btn-principal",style:{background:"#dc2626"},onClick:B,disabled:b,children:b?"Suppression":"Supprimer"})]})]})})]})]})}function ute(e){if(!e)return null;try{const r=new URL(e);if(r.hostname==="youtu.be")return r.pathname.slice(1).split("?")[0]||null;if(r.hostname.includes("youtube.com")){const n=r.searchParams.get("v");if(n)return n;const a=r.pathname.split("/").filter(Boolean),l=a.findIndex(o=>o==="embed"||o==="shorts");if(l!==-1&&a[l+1])return a[l+1]}}catch{}return null}function dte(e,r=0){const n=new URLSearchParams({rel:"0",modestbranding:"1",enablejsapi:"0",origin:window.location.origin,...r>5?{start:String(Math.floor(r))}:{}});return`https://www.youtube-nocookie.com/embed/${e}?${n.toString()}`}function mte({url:e,mimeType:r,titre:n,thumbnailUrl:a,aAccesPremium:l,positionInitiale:o,onTempsChange:u,onAperuTermine:d}){const f=g.useRef(null),p=g.useRef(null),[h,v]=g.useState(!1),[b,x]=g.useState(o>5),[j,_]=g.useState(null),C=ute(e),w=C!==null,E=w?dte(C,o):null;g.useEffect(()=>{if(v(!1),_(null),p.current&&clearInterval(p.current),w&&!l){let D=0;p.current=setInterval(()=>{D+=1,u(D),D>=Ib&&(clearInterval(p.current),v(!0),d())},1e3)}return()=>{p.current&&clearInterval(p.current)}},[e,l,w,u,d]);const S=()=>{if(!f.current)return;const D=f.current.currentTime;u(D),!l&&D>=Ib&&(f.current.pause(),v(!0),d())},A=()=>{const D=f.current;let B="Impossible de charger la vido.";if(!e||e.trim()==="")B="Aucune URL vido configure pour ce contenu.";else if(D?.error)switch(D.error.code){case MediaError.MEDIA_ERR_NETWORK:B="Erreur rseau  vrifiez votre connexion.";break;case MediaError.MEDIA_ERR_DECODE:B="Format vido non support par ce navigateur.";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:B="Fichier introuvable ou format non support.";break;default:B=`Erreur de lecture (code ${D.error.code}).`}_(B)},O=()=>{f.current&&(f.current.currentTime=o,f.current.play().catch(console.warn),x(!1))},k=()=>{f.current&&(f.current.currentTime=0,f.current.play().catch(console.warn),x(!1))},P=r||"video/mp4";return t.jsxs("div",{className:"media-player",children:[t.jsxs("div",{className:"media-player__video-wrapper",children:[w&&!h&&E&&t.jsx("iframe",{src:E,title:n,className:"media-player__video",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,style:{border:"none"},"aria-label":`Lecteur YouTube : ${n}`}),!w&&!j&&t.jsxs("video",{ref:f,className:"media-player__video",controls:!0,preload:"metadata",poster:a,onTimeUpdate:S,onError:A,playsInline:!0,"aria-label":`Lecteur vido : ${n}`,children:[e&&e.trim()!==""&&t.jsx("source",{src:e,type:P}),t.jsx("p",{children:"Votre navigateur ne supporte pas la lecture vido HTML5."})]}),!w&&j&&t.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#0f172a",color:"white",gap:"0.75rem",padding:"2rem",textAlign:"center"},role:"alert",children:[t.jsx("span",{style:{fontSize:"2.5rem"},children:""}),t.jsx("p",{style:{margin:0,fontWeight:700},children:"Vido indisponible"}),t.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7,maxWidth:300},children:j}),t.jsx("button",{type:"button",style:{marginTop:"0.5rem",background:"#2563eb",color:"white",border:"none",padding:"0.5rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem"},onClick:()=>{_(null),f.current&&f.current.load()},children:" Ressayer"})]}),!w&&!j&&(!e||e.trim()==="")&&t.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#0f172a",color:"rgba(255,255,255,0.5)",gap:"0.5rem"},children:[t.jsx("span",{style:{fontSize:"3rem"},children:""}),t.jsx("p",{style:{margin:0,fontSize:"0.9rem"},children:"Aucun fichier vido configur"})]}),h&&t.jsxs("div",{className:"media-player__overlay-premium",role:"dialog","aria-modal":!0,children:[t.jsx("div",{style:{fontSize:"3rem"},children:""}),t.jsx("h3",{children:"Aperu termin"}),t.jsx("p",{children:"Abonnez-vous  PedaClic Premium pour accder  la totalit de ce contenu et  toute la mdiathque."}),t.jsx(Le,{to:"/premium",className:"btn-premium-overlay",children:" Devenir Premium  2 000 FCFA/mois"})]})]}),!w&&b&&o>5&&t.jsxs("div",{className:"media-player__reprise",role:"complementary",children:[t.jsxs("span",{className:"media-player__reprise-texte",children:[" Reprendre  ",_f(o)]}),t.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[t.jsx("button",{type:"button",className:"btn-secondaire",style:{fontSize:"0.8rem",padding:"0.3rem 0.75rem"},onClick:k,children:"Depuis le dbut"}),t.jsx("button",{type:"button",className:"media-player__reprise-btn",onClick:O,children:"Reprendre"})]})]}),t.jsx("div",{className:"media-player__progression-barre","aria-hidden":"true",title:"Progression de visionnage",children:t.jsx("div",{className:"media-player__progression-rempli",style:{width:f.current?.duration?`${o/f.current.duration*100}%`:"0%"}})})]})}function fte({url:e,titre:r,thumbnailUrl:n,typeMedia:a,aAccesPremium:l,positionInitiale:o,onTempsChange:u,onAperuTermine:d}){const f=g.useRef(null),[p,h]=g.useState(!1),v=()=>{if(!f.current)return;const j=f.current.currentTime;u(j),!l&&j>=Ib&&(f.current.pause(),h(!0),d())},b=()=>{f.current&&o>5&&(f.current.currentTime=o)},x=xa[a];return t.jsxs("div",{className:"media-player",style:{position:"relative"},children:[t.jsxs("div",{className:"media-player__audio-wrapper",children:[n?t.jsx("img",{src:n,alt:r,className:"media-player__audio-art"}):t.jsx("div",{className:"media-player__audio-art-placeholder",children:x.emoji}),t.jsx("p",{className:"media-player__audio-titre",children:r}),t.jsxs("audio",{ref:f,className:"media-player__audio",controls:!0,preload:"metadata",onLoadedMetadata:b,onTimeUpdate:v,"aria-label":`Lecteur audio : ${r}`,children:[e&&e.trim()!==""&&t.jsx("source",{src:e,type:"audio/mpeg"}),t.jsx("p",{children:"Votre navigateur ne supporte pas la lecture audio."})]})]}),p&&t.jsxs("div",{className:"media-player__overlay-premium",role:"dialog",children:[t.jsx("div",{style:{fontSize:"3rem"},children:""}),t.jsx("h3",{children:"Aperu termin"}),t.jsx("p",{children:"Accdez  la totalit de cet audio avec PedaClic Premium."}),t.jsx(Le,{to:"/premium",className:"btn-premium-overlay",children:" Devenir Premium  2 000 FCFA/mois"})]})]})}function pte(){const{mediaId:e}=xn(),{currentUser:r}=Ke(),n=Je(),[a,l]=g.useState(null),[o,u]=g.useState([]),[d,f]=g.useState(null),[p,h]=g.useState(!0),[v,b]=g.useState(null),x=g.useRef(0),j=g.useRef(null),C=r?.role==="admin"||r?.role==="prof"||!a?.isPremium||(r?.isPremium??!1);g.useEffect(()=>{if(!e)return;async function A(){try{h(!0),b(null);const O=await EM(e);if(!O){b("Ce contenu est introuvable ou a t supprim.");return}l(O);const[k,P]=await Promise.all([Jee(e,O.discipline),r?lte(r.uid,e):Promise.resolve(null)]);u(k),f(P),P?.positionReprise&&(x.current=P.positionReprise),await ite(e)}catch(O){console.error("[MediaDetail] Erreur chargement :",O),b("Impossible de charger ce contenu. Ressayez plus tard.")}finally{h(!1)}}return A(),()=>{j.current&&clearInterval(j.current)}},[e,r]),g.useEffect(()=>{if(!(!r||!a))return j.current=setInterval(async()=>{x.current>0&&await ste(r.uid,a.id,x.current,x.current,a.duree)},3e4),()=>{j.current&&clearInterval(j.current)}},[r,a]);const w=g.useCallback(A=>{x.current=A},[]),E=g.useCallback(()=>{},[]);if(p)return t.jsx("div",{className:"media-detail-page",children:t.jsxs("div",{className:"mediatheque-chargement",role:"status",children:[t.jsx("div",{className:"mediatheque-spinner"}),t.jsx("p",{children:"Chargement du contenu..."})]})});if(v||!a)return t.jsxs("div",{className:"media-detail-page",children:[t.jsx("div",{className:"media-detail-header",children:t.jsx("button",{type:"button",className:"media-detail-retour",onClick:()=>n("/mediatheque"),children:" Retour  la mdiathque"})}),t.jsxs("div",{className:"mediatheque-vide",role:"alert",children:[t.jsx("span",{className:"mediatheque-vide__emoji",children:""}),t.jsx("h3",{className:"mediatheque-vide__titre",children:"Contenu introuvable"}),t.jsx("p",{className:"mediatheque-vide__message",children:v}),t.jsx("button",{type:"button",className:"btn-principal",onClick:()=>n("/mediatheque"),children:" Retour  la mdiathque"})]})]});const S=xa[a.type];return t.jsxs("div",{className:"media-detail-page",children:[t.jsxs("header",{className:"media-detail-header",children:[t.jsx("button",{type:"button",className:"media-detail-retour",onClick:()=>n("/mediatheque"),"aria-label":"Retourner au catalogue",children:" Mdiathque"}),t.jsxs("span",{style:{fontSize:"0.8rem",padding:"0.25rem 0.75rem",borderRadius:"4px",backgroundColor:S.bg,color:S.couleur,fontWeight:600},children:[S.emoji," ",S.label]}),a.isPremium&&t.jsx("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.6rem",borderRadius:"4px",backgroundColor:"#fffbeb",color:"#d97706",fontWeight:700},children:" Premium"})]}),t.jsxs("div",{className:"media-detail-layout",children:[t.jsxs("div",{children:[a.type==="video"||a.type==="webinaire"?t.jsx(mte,{url:a.url,mimeType:a.mimeType,titre:a.titre,thumbnailUrl:a.thumbnailUrl,aAccesPremium:C,positionInitiale:d?.positionReprise??0,onTempsChange:w,onAperuTermine:E}):t.jsx(fte,{url:a.url,titre:a.titre,thumbnailUrl:a.thumbnailUrl,typeMedia:a.type,aAccesPremium:C,positionInitiale:d?.positionReprise??0,onTempsChange:w,onAperuTermine:E}),t.jsxs("div",{className:"media-detail-infos",children:[t.jsx("h1",{className:"media-detail-infos__titre",children:a.titre}),t.jsxs("div",{className:"media-detail-infos__meta",children:[t.jsxs("span",{className:"media-detail-infos__meta-item",children:[" ",a.auteurNom]}),t.jsxs("span",{className:"media-detail-infos__meta-item",children:[" ",a.discipline]}),t.jsxs("span",{className:"media-detail-infos__meta-item",children:[" ",a.niveau,a.classe?`  ${a.classe}`:""]}),t.jsxs("span",{className:"media-detail-infos__meta-item",children:[" ",_f(a.duree)]}),t.jsxs("span",{className:"media-detail-infos__meta-item",children:[" ",a.vues.toLocaleString("fr-SN")," vue",a.vues!==1?"s":""]}),a.taille>0&&t.jsxs("span",{className:"media-detail-infos__meta-item",children:[" ",(a.taille/(1024*1024)).toFixed(1)," Mo"]})]}),t.jsx("p",{className:"media-detail-infos__description",children:a.description}),(a.tags??[]).length>0&&t.jsx("div",{className:"media-detail-infos__tags",children:(a.tags??[]).map(A=>t.jsxs("span",{className:"media-detail-infos__tag",children:["#",A]},A))})]})]}),t.jsxs("aside",{className:"media-detail-sidebar","aria-label":"Informations complmentaires",children:[a.isPremium&&!C&&t.jsxs("div",{className:"media-sidebar-premium",children:[t.jsx("p",{className:"media-sidebar-premium__titre",children:" Dbloquez tout le contenu"}),t.jsx("p",{className:"media-sidebar-premium__prix",children:"2 000 FCFA"}),t.jsx("p",{className:"media-sidebar-premium__prix-annuel",children:"ou 20 000 FCFA / an (2 mois offerts)"}),t.jsx(Le,{to:"/premium",className:"btn-abonnement",children:"S'abonner  Premium"}),t.jsxs("ul",{className:"media-sidebar-premium__avantages",children:[t.jsx("li",{children:"Vidos et audios illimits"}),t.jsx("li",{children:"Tous les cours en ligne"}),t.jsx("li",{children:"Quiz et exercices premium"}),t.jsx("li",{children:"Tlchargement pour mode hors-ligne"})]})]}),o.length>0&&t.jsxs("div",{className:"media-sidebar-similaires",children:[t.jsx("h2",{className:"media-sidebar-similaires__titre",children:" Contenus similaires"}),t.jsx("div",{className:"media-sidebar-similaires__liste",children:o.map(A=>t.jsxs(Le,{to:`/mediatheque/${A.id}`,className:"media-similaire-item","aria-label":`Voir : ${A.titre}`,children:[t.jsx("div",{className:"media-similaire-item__vignette",children:A.thumbnailUrl?t.jsx("img",{src:A.thumbnailUrl,alt:A.titre,loading:"lazy"}):t.jsx("span",{className:"media-similaire-item__vignette-emoji",children:xa[A.type].emoji})}),t.jsxs("div",{className:"media-similaire-item__infos",children:[t.jsx("p",{className:"media-similaire-item__titre",children:A.titre}),t.jsxs("div",{className:"media-similaire-item__meta",children:[t.jsx("span",{children:xa[A.type].label}),t.jsx("span",{children:""}),t.jsx("span",{children:_f(A.duree)}),A.isPremium&&t.jsx("span",{children:" "})]})]})]},A.id))})]}),t.jsxs("div",{style:{background:"#f0fdf4",border:"1px solid #bbf7d0",borderRadius:"8px",padding:"0.875rem",fontSize:"0.8rem",color:"#166534"},children:[t.jsx("strong",{children:" Connexion lente ?"}),t.jsx("br",{}),"Le lecteur s'adapte automatiquement  votre dbit. En cas de problme, rechargez la page ou essayez en Wi-Fi."]})]})]})]})}const hte={video:"video/mp4",audio:"audio/mpeg",podcast:"audio/mpeg",webinaire:"video/mp4"};function vte(){const{currentUser:e}=Ke(),r=Je(),{matieres:n}=Ca(),[a,l]=g.useState(!1),[o,u]=g.useState(null),[d,f]=g.useState(0),[p,h]=g.useState({titre:"",description:"",type:"video",url:"",urlBasse:"",thumbnailUrl:"",duree:0,taille:0,mimeType:"video/mp4",discipline:"",classe:"",niveau:"",tags:"",isPremium:!1,statut:"brouillon"}),[v,b]=g.useState(null),[x,j]=g.useState(null),_=w=>{const{name:E,value:S,type:A}=w.target;h(O=>({...O,[E]:A==="checkbox"?w.target.checked:S}))},C=async w=>{if(w.preventDefault(),!!e){l(!0),u(null);try{const E=p.discipline?p.discipline.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"_"):"general",S=p.tags?p.tags.split(/[,;]/).map(D=>D.trim()).filter(Boolean):[],A={titre:p.titre.trim(),description:p.description.trim(),type:p.type,url:p.url.trim(),urlBasse:p.urlBasse?.trim()||"",thumbnailUrl:p.thumbnailUrl?.trim()||"",duree:Number(p.duree)||0,taille:p.taille||0,mimeType:p.mimeType||hte[p.type],discipline:p.discipline||"Non spcifi",disciplineId:E,classe:p.classe||"",niveau:p.niveau||"",tags:S,isPremium:p.isPremium,statut:p.statut};if(!A.titre)throw new Error("Le titre est obligatoire.");if(!p.url.trim()&&!v)throw new Error("Indiquez une URL ou slectionnez un fichier.");const O=v?"upload://pending":p.url.trim(),k={...A,url:O};let P=await ete(k,e.uid,e.displayName||e.email||"Auteur");if(v){f(10);const D=await ate(v,P,p.type,E,B=>f(10+Math.round(B*.7)));await Bc(P,{url:D,mimeType:v.type}),A.taille===0&&await Bc(P,{taille:v.size})}if(x){f(85);const D=await AM(x,P);await Bc(P,{thumbnailUrl:D})}f(100),r(`/mediatheque/${P}`)}catch(E){console.error("[MediaAjout] Erreur:",E),u(E instanceof Error?E.message:"Erreur lors de l'enregistrement.")}finally{l(!1),f(0)}}};return t.jsxs("div",{className:"media-detail-page",children:[t.jsxs("header",{className:"media-detail-header",children:[t.jsx("button",{className:"media-detail-retour",onClick:()=>r("/mediatheque"),type:"button",children:" Mdiathque"}),t.jsx("span",{style:{fontSize:"1rem",fontWeight:700},children:" Ajouter un contenu"})]}),t.jsxs("div",{className:"media-form",style:{maxWidth:700,margin:"2rem auto"},children:[t.jsx("h1",{className:"media-form__titre",children:"Nouveau mdia"}),t.jsxs("form",{onSubmit:C,children:[o&&t.jsx("div",{style:{background:"#fef2f2",color:"#b91c1c",padding:"0.75rem",borderRadius:8,marginBottom:"1rem"},children:o}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsxs("label",{className:"media-form__label",children:["Type ",t.jsx("span",{children:"*"})]}),t.jsx("select",{name:"type",value:p.type,onChange:_,className:"media-form__select",required:!0,children:Object.entries(xa).map(([w,E])=>t.jsxs("option",{value:w,children:[E.emoji," ",E.label]},w))})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsxs("label",{className:"media-form__label",children:["Titre ",t.jsx("span",{children:"*"})]}),t.jsx("input",{name:"titre",value:p.titre,onChange:_,className:"media-form__input",placeholder:"Ex: Introduction aux fonctions affines",required:!0})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Description"}),t.jsx("textarea",{name:"description",value:p.description,onChange:_,className:"media-form__textarea",placeholder:"Description courte du contenu",rows:3})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"URL du fichier (vido/audio)"}),t.jsx("input",{name:"url",type:"url",value:p.url,onChange:_,className:"media-form__input",placeholder:"https://exemple.com/video.mp4",disabled:!!v}),t.jsx("p",{className:"media-form__upload-texte",style:{marginTop:"0.5rem"},children:"Ou utilisez l'upload ci-dessous pour un fichier local."})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Fichier mdia (optionnel)"}),t.jsxs("div",{className:`media-form__upload-zone ${v?"media-form__upload-zone--active":""}`,onClick:()=>document.getElementById("fichier-media")?.click(),children:[t.jsx("input",{id:"fichier-media",type:"file",accept:xa[p.type].accept,onChange:w=>{const E=w.target.files?.[0];b(E||null),E&&h(S=>({...S,url:E.name}))},style:{display:"none"}}),t.jsx("span",{className:"media-form__upload-icone",children:""}),t.jsx("p",{className:"media-form__upload-texte",children:v?t.jsx("strong",{children:v.name}):"Cliquez pour slectionner un fichier"})]})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Vignette (optionnel)"}),t.jsxs("div",{className:`media-form__upload-zone ${x?"media-form__upload-zone--active":""}`,onClick:()=>document.getElementById("fichier-thumb")?.click(),children:[t.jsx("input",{id:"fichier-thumb",type:"file",accept:"image/*",onChange:w=>j(w.target.files?.[0]||null),style:{display:"none"}}),t.jsx("span",{className:"media-form__upload-icone",children:""}),t.jsx("p",{className:"media-form__upload-texte",children:x?t.jsx("strong",{children:x.name}):"Cliquez pour une vignette"})]})]}),t.jsxs("div",{className:"media-form__grille-2",children:[t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Dure (secondes)"}),t.jsx("input",{name:"duree",type:"number",value:p.duree||"",onChange:_,className:"media-form__input",placeholder:"Ex: 600",min:0})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Discipline"}),t.jsxs("select",{name:"discipline",value:p.discipline,onChange:_,className:"media-form__select",children:[t.jsx("option",{value:"",children:"Toutes"}),n.map(w=>t.jsx("option",{value:w.valeur,children:w.label},w.valeur))]})]})]}),t.jsxs("div",{className:"media-form__grille-2",children:[t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Niveau"}),t.jsxs("select",{name:"niveau",value:p.niveau,onChange:_,className:"media-form__select",children:[t.jsx("option",{value:"",children:"Tous"}),wa.map(w=>t.jsx("option",{value:w,children:w},w))]})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Classe"}),t.jsx("input",{name:"classe",value:p.classe,onChange:_,className:"media-form__input",placeholder:"Ex: 3me / 2nde"})]})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Tags (spars par virgule)"}),t.jsx("input",{name:"tags",value:p.tags,onChange:_,className:"media-form__input",placeholder:"fonctions affines, algbre, BFEM"})]}),t.jsxs("div",{className:"media-form__grille-2",children:[t.jsx("div",{className:"media-form__groupe",children:t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[t.jsx("input",{name:"isPremium",type:"checkbox",checked:p.isPremium,onChange:_}),"Contenu Premium (aperu 30s)"]})}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Statut"}),t.jsxs("select",{name:"statut",value:p.statut,onChange:_,className:"media-form__select",children:[t.jsx("option",{value:"publie",children:"Publi"}),t.jsx("option",{value:"brouillon",children:"Brouillon"}),t.jsx("option",{value:"planifiee",children:"Planifi"}),t.jsx("option",{value:"archive",children:"Archiv"})]})]})]}),d>0&&d<100&&t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("div",{className:"media-form__progress",children:t.jsx("div",{className:"media-form__progress-bar",style:{width:`${d}%`}})}),t.jsxs("p",{className:"media-form__progress-texte",children:["Upload en cours ",d,"%"]})]}),t.jsxs("div",{className:"media-form__actions",children:[t.jsx("button",{type:"button",className:"btn-secondaire",onClick:()=>r("/mediatheque"),children:"Annuler"}),t.jsx("button",{type:"submit",className:"btn-principal",disabled:a||!p.url.trim()&&!v,children:a?"Enregistrement":"Enregistrer"})]})]})]})]})}const uA={video:"video/mp4",audio:"audio/mpeg",podcast:"audio/mpeg",webinaire:"video/mp4"};function gte(){const{mediaId:e}=xn(),{currentUser:r}=Ke(),n=Je(),{matieres:a}=Ca(),[l,o]=g.useState(!0),[u,d]=g.useState(!1),[f,p]=g.useState(null),[h,v]=g.useState(0),[b,x]=g.useState({titre:"",description:"",type:"video",url:"",urlBasse:"",thumbnailUrl:"",duree:0,taille:0,mimeType:"video/mp4",discipline:"",classe:"",niveau:"",tags:"",isPremium:!1,statut:"brouillon"}),[j,_]=g.useState(null);g.useEffect(()=>{if(!e)return;let E=!1;async function S(){try{const A=await EM(e);if(E||!A){p(A?null:"Contenu introuvable.");return}x({titre:A.titre||"",description:A.description||"",type:A.type||"video",url:A.url||"",urlBasse:A.urlBasse||"",thumbnailUrl:A.thumbnailUrl||"",duree:A.duree||0,taille:A.taille||0,mimeType:A.mimeType||uA[A.type||"video"],discipline:A.discipline||"",classe:A.classe||"",niveau:A.niveau||"",tags:(A.tags||[]).join(", "),isPremium:A.isPremium??!1,statut:A.statut||"brouillon"})}catch{E||p("Erreur lors du chargement.")}finally{E||o(!1)}}return S(),()=>{E=!0}},[e]);const C=E=>{const{name:S,value:A,type:O}=E.target;x(k=>({...k,[S]:O==="checkbox"?E.target.checked:A}))},w=async E=>{if(E.preventDefault(),!(!r||!e)){d(!0),p(null);try{const S=b.discipline?b.discipline.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"_"):"general",A=b.tags?b.tags.split(/[,;]/).map(O=>O.trim()).filter(Boolean):[];if(await Bc(e,{titre:b.titre.trim(),description:b.description.trim(),type:b.type,url:b.url.trim(),urlBasse:b.urlBasse?.trim()||"",duree:Number(b.duree)||0,taille:b.taille||0,mimeType:b.mimeType||uA[b.type],discipline:b.discipline||"Non spcifi",disciplineId:S,classe:b.classe||"",niveau:b.niveau||"",tags:A,isPremium:b.isPremium,statut:b.statut}),j){v(50);const O=await AM(j,e);await Bc(e,{thumbnailUrl:O})}v(100),n(`/mediatheque/${e}`)}catch(S){console.error("[MediaEdit] Erreur:",S),p(S instanceof Error?S.message:"Erreur lors de l'enregistrement.")}finally{d(!1),v(0)}}};return l?t.jsx("div",{className:"media-detail-page",children:t.jsxs("div",{className:"mediatheque-chargement",style:{padding:"4rem 2rem"},children:[t.jsx("div",{className:"mediatheque-spinner"}),t.jsx("p",{children:"Chargement"})]})}):t.jsxs("div",{className:"media-detail-page",children:[t.jsxs("header",{className:"media-detail-header",children:[t.jsx("button",{className:"media-detail-retour",onClick:()=>n("/mediatheque"),type:"button",children:" Mdiathque"}),t.jsx("span",{style:{fontSize:"1rem",fontWeight:700},children:" Modifier le contenu"})]}),t.jsxs("div",{className:"media-form",style:{maxWidth:700,margin:"2rem auto"},children:[t.jsx("h1",{className:"media-form__titre",children:"Modifier le mdia"}),t.jsxs("form",{onSubmit:w,children:[f&&t.jsx("div",{style:{background:"#fef2f2",color:"#b91c1c",padding:"0.75rem",borderRadius:8,marginBottom:"1rem"},children:f}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Type"}),t.jsx("select",{name:"type",value:b.type,onChange:C,className:"media-form__select",children:Object.entries(xa).map(([E,S])=>t.jsxs("option",{value:E,children:[S.emoji," ",S.label]},E))})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsxs("label",{className:"media-form__label",children:["Titre ",t.jsx("span",{children:"*"})]}),t.jsx("input",{name:"titre",value:b.titre,onChange:C,className:"media-form__input",required:!0})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Description"}),t.jsx("textarea",{name:"description",value:b.description,onChange:C,className:"media-form__textarea",rows:3})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"URL du fichier (vido/audio)"}),t.jsx("input",{name:"url",type:"url",value:b.url,onChange:C,className:"media-form__input"})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Vignette"}),t.jsxs("div",{className:`media-form__upload-zone ${j?"media-form__upload-zone--active":""}`,onClick:()=>document.getElementById("fichier-thumb-edit")?.click(),children:[t.jsx("input",{id:"fichier-thumb-edit",type:"file",accept:"image/*",onChange:E=>_(E.target.files?.[0]||null),style:{display:"none"}}),t.jsx("span",{className:"media-form__upload-icone",children:""}),t.jsx("p",{className:"media-form__upload-texte",children:j?t.jsx("strong",{children:j.name}):b.thumbnailUrl?"Remplacer la vignette":"Ajouter une vignette"})]})]}),t.jsxs("div",{className:"media-form__grille-2",children:[t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Dure (secondes)"}),t.jsx("input",{name:"duree",type:"number",value:b.duree||"",onChange:C,className:"media-form__input",min:0})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Discipline"}),t.jsxs("select",{name:"discipline",value:b.discipline,onChange:C,className:"media-form__select",children:[t.jsx("option",{value:"",children:"Toutes"}),a.map(E=>t.jsx("option",{value:E.valeur,children:E.label},E.valeur))]})]})]}),t.jsxs("div",{className:"media-form__grille-2",children:[t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Niveau"}),t.jsxs("select",{name:"niveau",value:b.niveau,onChange:C,className:"media-form__select",children:[t.jsx("option",{value:"",children:"Tous"}),wa.map(E=>t.jsx("option",{value:E,children:E},E))]})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Classe"}),t.jsx("input",{name:"classe",value:b.classe,onChange:C,className:"media-form__input",placeholder:"Ex: 3me"})]})]}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Tags (spars par virgule)"}),t.jsx("input",{name:"tags",value:b.tags,onChange:C,className:"media-form__input"})]}),t.jsxs("div",{className:"media-form__grille-2",children:[t.jsx("div",{className:"media-form__groupe",children:t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[t.jsx("input",{name:"isPremium",type:"checkbox",checked:b.isPremium,onChange:C}),"Contenu Premium (aperu 30s)"]})}),t.jsxs("div",{className:"media-form__groupe",children:[t.jsx("label",{className:"media-form__label",children:"Statut"}),t.jsx("select",{name:"statut",value:b.statut,onChange:C,className:"media-form__select",children:Object.entries(jf).map(([E,S])=>t.jsx("option",{value:E,children:S.label},E))})]})]}),h>0&&h<100&&t.jsx("div",{className:"media-form__groupe",children:t.jsx("div",{className:"media-form__progress",children:t.jsx("div",{className:"media-form__progress-bar",style:{width:`${h}%`}})})}),t.jsxs("div",{className:"media-form__actions",children:[t.jsx("button",{type:"button",className:"btn-secondaire",onClick:()=>n("/mediatheque"),children:"Annuler"}),t.jsx("button",{type:"submit",className:"btn-principal",disabled:u,children:u?"Enregistrement":"Enregistrer"})]})]})]})]})}function xte(e){return e.toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}const bte=({notif:e,onLire:r,onArchiver:n,onSupprimer:a,onNavigate:l})=>{const o=bm[e.type],u=e.statut==="non_lue";return t.jsxs("article",{className:`notif-page__item ${u?"notif-page__item--unread":""}`,"aria-label":`Notification : ${e.titre}`,children:[t.jsx("div",{className:"notif-page__item-icon",style:{background:o.couleur+"20",color:o.couleur},"aria-hidden":"true",children:o.icone}),t.jsxs("div",{className:"notif-page__item-body",children:[t.jsxs("div",{className:"notif-page__item-header",children:[t.jsx("h3",{className:"notif-page__item-titre",children:e.titre}),u&&t.jsx("span",{className:"notif-page__item-badge",children:"Nouvelle"})]}),t.jsx("p",{className:"notif-page__item-message",children:e.message}),t.jsxs("div",{className:"notif-page__item-meta",children:[e.emetteurNom&&t.jsxs("span",{className:"notif-page__item-emetteur",children:["De : ",e.emetteurNom]}),t.jsx("span",{className:"notif-page__item-date",children:xte(e.createdAt)}),t.jsx("span",{className:"notif-page__item-type",style:{color:o.couleur},children:Gb[e.type]})]}),e.lienAction&&t.jsx("button",{className:"notif-page__item-action-btn",onClick:()=>l(e),children:e.labelAction||"Voir "})]}),t.jsxs("div",{className:"notif-page__item-actions",children:[u&&t.jsx("button",{className:"notif-page__action-btn notif-page__action-btn--read",onClick:()=>r(e.id),title:"Marquer comme lu","aria-label":"Marquer comme lu",children:""}),e.statut!=="archivee"&&t.jsx("button",{className:"notif-page__action-btn notif-page__action-btn--archive",onClick:()=>n(e.id),title:"Archiver","aria-label":"Archiver la notification",children:""}),t.jsx("button",{className:"notif-page__action-btn notif-page__action-btn--delete",onClick:()=>a(e.id),title:"Supprimer","aria-label":"Supprimer la notification",children:""})]})]})},yte=()=>{const{currentUser:e}=Ke(),r=Je(),[n,a]=g.useState([]),[l,o]=g.useState(!0),[u,d]=g.useState(null),[f,p]=g.useState("toutes"),[h,v]=g.useState("tous"),[b,x]=g.useState(!1),j=g.useCallback(async()=>{if(e){o(!0),d(null);try{const k=await J3(e.uid,{includeArchived:f==="archivee",limitCount:100});a(k)}catch(k){d("Impossible de charger les notifications."),console.error("[Phase 26] Erreur chargement notifications:",k)}finally{o(!1)}}},[e,f]);g.useEffect(()=>{j()},[j]);const _=n.filter(k=>{const P=f==="toutes"||k.statut===f,D=h==="tous"||k.type===h;return P&&D}),C=n.filter(k=>k.statut==="non_lue").length,w=async k=>{await Dx(k),a(P=>P.map(D=>D.id===k?{...D,statut:"lue",luAt:new Date}:D))},E=async k=>{await t5(k),a(P=>P.map(D=>D.id===k?{...D,statut:"archivee"}:D))},S=async k=>{window.confirm("Supprimer cette notification ?")&&(await r5(k),a(P=>P.filter(D=>D.id!==k)))},A=async k=>{k.statut==="non_lue"&&await Dx(k.id),k.lienAction&&r(k.lienAction)},O=async()=>{if(!(!e||b)){x(!0);try{await _A(e.uid),a(k=>k.map(P=>P.statut==="non_lue"?{...P,statut:"lue",luAt:new Date}:P))}finally{x(!1)}}};return t.jsxs("div",{className:"notif-page",children:[t.jsxs("div",{className:"notif-page__header",children:[t.jsxs("div",{className:"notif-page__header-left",children:[t.jsx("h1",{className:"notif-page__title",children:" Notifications"}),C>0&&t.jsxs("span",{className:"notif-page__unread-count",children:[C," non ",C>1?"lues":"lue"]})]}),C>0&&t.jsx("button",{className:"notif-page__mark-all-btn",onClick:O,disabled:b,children:b?"En cours":" Tout marquer comme lu"})]}),t.jsxs("div",{className:"notif-page__filters",children:[t.jsxs("div",{className:"notif-page__filter-group",children:[t.jsx("label",{className:"notif-page__filter-label",children:"Statut"}),t.jsx("div",{className:"notif-page__filter-tabs",children:["toutes","non_lue","lue","archivee"].map(k=>t.jsx("button",{className:`notif-page__filter-tab ${f===k?"notif-page__filter-tab--active":""}`,onClick:()=>p(k),children:k==="toutes"?"Toutes":k==="non_lue"?" Non lues":k==="lue"?" Lues":" Archives"},k))})]}),t.jsxs("div",{className:"notif-page__filter-group",children:[t.jsx("label",{className:"notif-page__filter-label",children:"Type"}),t.jsxs("select",{className:"notif-page__filter-select",value:h,onChange:k=>v(k.target.value),children:[t.jsx("option",{value:"tous",children:"Tous les types"}),Object.entries(Gb).map(([k,P])=>t.jsx("option",{value:k,children:P},k))]})]})]}),l?t.jsx("div",{className:"notif-page__loading",children:[1,2,3].map(k=>t.jsx("div",{className:"notif-page__skeleton"},k))}):u?t.jsxs("div",{className:"notif-page__error",children:[t.jsxs("p",{children:[" ",u]}),t.jsx("button",{onClick:j,className:"notif-page__retry-btn",children:"Ressayer"})]}):_.length===0?t.jsxs("div",{className:"notif-page__empty",children:[t.jsx("span",{className:"notif-page__empty-icon",children:""}),t.jsx("p",{className:"notif-page__empty-title",children:"Aucune notification"}),t.jsx("p",{className:"notif-page__empty-sub",children:f==="non_lue"?"Vous tes  jour, aucune notification non lue.":"Aucune notification correspondant  vos filtres."})]}):t.jsx("div",{className:"notif-page__list",children:_.map(k=>t.jsx(bte,{notif:k,onLire:w,onArchiver:E,onSupprimer:S,onNavigate:A},k.id))})]})},dA={type:"annonce",titre:"",message:"",lienAction:"",labelAction:"",modeDestinataire:"role",destinataireEmail:"",destinataireId:"",groupeId:"",roleDestinataire:"eleve",canal:"les_deux"},mA=()=>{const{currentUser:e}=Ke(),r=Je(),[n,a]=g.useState(dA),[l,o]=g.useState([]),[u,d]=g.useState("idle"),[f,p]=g.useState(null),[h,v]=g.useState(0);g.useEffect(()=>{if(!e)return;const E=e.role==="admin"?Ee(_e(Q,"groupes_prof")):Ee(_e(Q,"groupes_prof"),Ne("profId","==",e.uid));Ce(E).then(S=>{o(S.docs.map(A=>({id:A.id,nom:A.data().nom,classe:A.data().classe,nombreInscrits:A.data().nombreInscrits??0})))})},[e]);const b=(w,E)=>{a(S=>({...S,[w]:E}))},x=w=>{const E=bm[w];a(S=>({...S,type:w,titre:E.titreDefaut,message:E.messageDefaut}))},j=()=>!(!n.titre.trim()||!n.message.trim()||n.modeDestinataire==="individuel"&&!n.destinataireEmail.trim()||n.modeDestinataire==="groupe"&&!n.groupeId),_=async()=>{if(!(!e||!j())){d("sending"),p(null);try{const w={type:n.type,titre:n.titre,message:n.message,lienAction:n.lienAction||void 0,labelAction:n.labelAction||void 0,emetteurId:e.uid,emetteurNom:e.displayName||e.email||"PedaClic",canal:n.canal};if(n.modeDestinataire==="individuel")await W3({...w,destinataireId:n.destinataireId||n.destinataireEmail,destinataireRole:"eleve",emailDestinataire:n.canal!=="in_app"?n.destinataireEmail:void 0,emailDestinatairNom:n.destinataireEmail}),v(1);else if(n.modeDestinataire==="groupe"){const E=await X3(n.groupeId,{...w,destinataireRole:"eleve"});v(E)}else{const E=await Z3(n.roleDestinataire,w);v(E)}d("success")}catch(w){p(w instanceof Error?w.message:"Erreur inconnue"),d("error")}}},C=()=>{a(dA),d("idle"),p(null),v(0)};return u==="success"?t.jsx("div",{className:"notif-composer notif-composer--success",children:t.jsxs("div",{className:"notif-composer__success-card",children:[t.jsx("span",{className:"notif-composer__success-icon",children:""}),t.jsx("h2",{children:"Notification envoye !"}),t.jsxs("p",{children:[t.jsx("strong",{children:h})," destinataire",h>1?"s":""," notifi",h>1?"s":"","."]}),t.jsxs("div",{className:"notif-composer__success-actions",children:[t.jsx("button",{className:"notif-composer__btn notif-composer__btn--primary",onClick:C,children:" Nouvelle notification"}),t.jsx("button",{className:"notif-composer__btn notif-composer__btn--secondary",onClick:()=>r(-1),children:" Retour"})]})]})}):t.jsxs("div",{className:"notif-composer",children:[t.jsxs("div",{className:"notif-composer__header",children:[t.jsx("button",{className:"notif-composer__back-btn",onClick:()=>r(-1),children:" Retour"}),t.jsx("h1",{className:"notif-composer__title",children:" Envoyer une notification"})]}),t.jsxs("div",{className:"notif-composer__form",children:[t.jsxs("section",{className:"notif-composer__section",children:[t.jsx("h2",{className:"notif-composer__section-title",children:"1. Type de notification"}),t.jsx("div",{className:"notif-composer__type-grid",children:Object.entries(Gb).filter(([w])=>!["bienvenue","nouveau_abonnement","resultat_quiz"].includes(w)).map(([w,E])=>{const S=bm[w];return t.jsxs("button",{className:`notif-composer__type-card ${n.type===w?"notif-composer__type-card--active":""}`,onClick:()=>x(w),style:n.type===w?{borderColor:S.couleur,background:S.couleur+"12"}:{},children:[t.jsx("span",{className:"notif-composer__type-icon",children:S.icone}),t.jsx("span",{className:"notif-composer__type-label",children:E})]},w)})})]}),t.jsxs("section",{className:"notif-composer__section",children:[t.jsx("h2",{className:"notif-composer__section-title",children:"2. Destinataires"}),t.jsx("div",{className:"notif-composer__mode-tabs",children:[{value:"role",label:" Par rle"},{value:"groupe",label:" Groupe-classe"},{value:"individuel",label:" Individuel"}].map(({value:w,label:E})=>t.jsx("button",{className:`notif-composer__mode-tab ${n.modeDestinataire===w?"notif-composer__mode-tab--active":""}`,onClick:()=>b("modeDestinataire",w),children:E},w))}),n.modeDestinataire==="role"&&t.jsxs("div",{className:"notif-composer__field",children:[t.jsx("label",{className:"notif-composer__label",children:"Envoyer  :"}),t.jsx("div",{className:"notif-composer__role-grid",children:Object.entries(n5).map(([w,E])=>t.jsx("button",{className:`notif-composer__role-card ${n.roleDestinataire===w?"notif-composer__role-card--active":""}`,onClick:()=>b("roleDestinataire",w),children:E},w))})]}),n.modeDestinataire==="groupe"&&t.jsxs("div",{className:"notif-composer__field",children:[t.jsx("label",{className:"notif-composer__label",children:"Groupe-classe :"}),l.length===0?t.jsx("p",{className:"notif-composer__hint",children:"Aucun groupe-classe disponible."}):t.jsxs("select",{className:"notif-composer__select",value:n.groupeId,onChange:w=>b("groupeId",w.target.value),children:[t.jsx("option",{value:"",children:" Choisir un groupe "}),l.map(w=>t.jsxs("option",{value:w.id,children:[w.nom,"  ",w.classe," (",w.nombreInscrits," lves)"]},w.id))]})]}),n.modeDestinataire==="individuel"&&t.jsxs("div",{className:"notif-composer__field",children:[t.jsx("label",{className:"notif-composer__label",children:"Email du destinataire :"}),t.jsx("input",{type:"email",className:"notif-composer__input",placeholder:"eleve@exemple.sn",value:n.destinataireEmail,onChange:w=>b("destinataireEmail",w.target.value)}),t.jsx("p",{className:"notif-composer__hint",children:"L'utilisateur doit tre inscrit sur PedaClic."})]})]}),t.jsxs("section",{className:"notif-composer__section",children:[t.jsx("h2",{className:"notif-composer__section-title",children:"3. Contenu"}),t.jsxs("div",{className:"notif-composer__field",children:[t.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-titre",children:["Titre ",t.jsx("span",{className:"notif-composer__required",children:"*"})]}),t.jsx("input",{id:"notif-titre",type:"text",className:"notif-composer__input",placeholder:"Ex : Nouveau devoir de mathmatiques",value:n.titre,onChange:w=>b("titre",w.target.value),maxLength:100}),t.jsxs("span",{className:"notif-composer__char-count",children:[n.titre.length,"/100"]})]}),t.jsxs("div",{className:"notif-composer__field",children:[t.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-message",children:["Message ",t.jsx("span",{className:"notif-composer__required",children:"*"})]}),t.jsx("textarea",{id:"notif-message",className:"notif-composer__textarea",placeholder:"Rdigez votre message ici",value:n.message,onChange:w=>b("message",w.target.value),rows:4,maxLength:500}),t.jsxs("span",{className:"notif-composer__char-count",children:[n.message.length,"/500"]})]}),t.jsxs("div",{className:"notif-composer__field-row",children:[t.jsxs("div",{className:"notif-composer__field",children:[t.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-lien",children:["Lien d'action ",t.jsx("span",{className:"notif-composer__optional",children:"(optionnel)"})]}),t.jsx("input",{id:"notif-lien",type:"text",className:"notif-composer__input",placeholder:"/cours/abc123",value:n.lienAction,onChange:w=>b("lienAction",w.target.value)})]}),t.jsxs("div",{className:"notif-composer__field",children:[t.jsxs("label",{className:"notif-composer__label",htmlFor:"notif-label",children:["Texte du bouton ",t.jsx("span",{className:"notif-composer__optional",children:"(optionnel)"})]}),t.jsx("input",{id:"notif-label",type:"text",className:"notif-composer__input",placeholder:"Voir le cours",value:n.labelAction,onChange:w=>b("labelAction",w.target.value)})]})]})]}),t.jsxs("section",{className:"notif-composer__section",children:[t.jsx("h2",{className:"notif-composer__section-title",children:"4. Canal d'envoi"}),t.jsx("div",{className:"notif-composer__canal-grid",children:[{value:"in_app",label:" In-app seulement",desc:"Cloche dans l'interface"},{value:"email",label:" Email seulement",desc:"Via Resend"},{value:"les_deux",label:" In-app + Email",desc:"Les deux canaux"}].map(({value:w,label:E,desc:S})=>t.jsxs("button",{className:`notif-composer__canal-card ${n.canal===w?"notif-composer__canal-card--active":""}`,onClick:()=>b("canal",w),children:[t.jsx("span",{className:"notif-composer__canal-label",children:E}),t.jsx("span",{className:"notif-composer__canal-desc",children:S})]},w))}),(n.canal==="email"||n.canal==="les_deux")&&n.modeDestinataire!=="individuel"&&t.jsx("p",{className:"notif-composer__canal-warning",children:" Pour l'envoi par email en mode groupe/rle, assurez-vous que Railway est bien dploy et que la cl API Resend est configure."})]}),u==="error"&&f&&t.jsxs("div",{className:"notif-composer__error",children:[" ",f]}),t.jsxs("div",{className:"notif-composer__footer",children:[t.jsx("button",{className:"notif-composer__btn notif-composer__btn--secondary",onClick:()=>r(-1),disabled:u==="sending",children:"Annuler"}),t.jsx("button",{className:"notif-composer__btn notif-composer__btn--primary",onClick:_,disabled:!j()||u==="sending",children:u==="sending"?" Envoi en cours":" Envoyer la notification"})]})]})]})},jte=()=>{const{currentUser:e}=Ke(),r=e?.uid||"",n=e?.displayName||"Parent",[a,l]=g.useState([]),[o,u]=g.useState(null),[d,f]=g.useState(null),[p,h]=g.useState(!0),[v,b]=g.useState(!1),[x,j]=g.useState(null),[_,C]=g.useState(!1),[w,E]=g.useState(""),[S,A]=g.useState(!1),[O,k]=g.useState(null),[P,D]=g.useState(null),[B,U]=g.useState("apercu");g.useEffect(()=>{$()},[r]),g.useEffect(()=>{o&&R(o)},[o]);const $=async()=>{try{h(!0),j(null);const M=await rZ(r);l(M),M.length===1&&u(M[0].enfantId)}catch(M){j("Erreur lors du chargement des enfants."),console.error(M)}finally{h(!1)}},R=async M=>{try{b(!0),j(null);const T=await aZ(r,M);f(T)}catch(T){j(T.message||"Erreur lors du chargement du suivi."),f(null)}finally{b(!1)}},Y=async M=>{if(M.preventDefault(),k(null),D(null),!w.trim()){k("Veuillez saisir le code d'invitation.");return}try{A(!0);const T=await tZ(r,w);D(`${T.enfantNom} a t ajout avec succs !`),E(""),C(!1),await $(),u(T.enfantId)}catch(T){k(T.message||"Erreur lors de la liaison.")}finally{A(!1)}},ae=async M=>{if(window.confirm(`tes-vous sr de vouloir retirer ${M.enfantNom} de votre suivi ? Cette action est irrversible.`))try{await nZ(M.id,r),o===M.enfantId&&(u(null),f(null)),await $()}catch(F){j(F.message||"Erreur lors de la suppression.")}};return p?t.jsxs("div",{className:"parent-loading",children:[t.jsx("div",{className:"parent-spinner"}),t.jsx("p",{children:"Chargement de votre espace parent..."})]}):t.jsxs("div",{className:"parent-dashboard",children:[t.jsxs("header",{className:"parent-header",children:[t.jsxs("div",{className:"parent-header-info",children:[t.jsx("h1",{className:"parent-titre",children:" Espace Parent"}),t.jsxs("p",{className:"parent-bienvenue",children:["Bienvenue, ",t.jsx("strong",{children:n}),"  Suivez la progression de vos enfants"]})]}),t.jsx("button",{className:"parent-btn parent-btn-primary",onClick:()=>{C(!_),k(null),D(null)},children:" Ajouter un enfant"})]}),x&&t.jsxs("div",{className:"parent-alerte parent-alerte-erreur",children:[t.jsxs("span",{children:[" ",x]}),t.jsx("button",{onClick:()=>j(null),children:""})]}),P&&t.jsxs("div",{className:"parent-alerte parent-alerte-succes",children:[t.jsxs("span",{children:[" ",P]}),t.jsx("button",{onClick:()=>D(null),children:""})]}),_&&t.jsxs("div",{className:"parent-form-liaison",children:[t.jsx("h3",{children:" Lier un enfant  votre compte"}),t.jsx("p",{className:"parent-form-aide",children:"Demandez le code d'invitation  votre enfant. Il peut le trouver dans son profil sur PedaClic (format: PEDA-XXXX-XXXX)."}),t.jsxs("form",{onSubmit:Y,className:"parent-form",children:[t.jsxs("div",{className:"parent-form-group",children:[t.jsx("label",{htmlFor:"code-invitation",children:"Code d'invitation"}),t.jsx("input",{id:"code-invitation",type:"text",placeholder:"PEDA-XXXX-XXXX",value:w,onChange:M=>E(M.target.value.toUpperCase()),maxLength:14,disabled:S,className:"parent-input"})]}),O&&t.jsxs("p",{className:"parent-form-erreur",children:[" ",O]}),t.jsxs("div",{className:"parent-form-actions",children:[t.jsx("button",{type:"submit",className:"parent-btn parent-btn-primary",disabled:S,children:S?"Vrification...":" Valider"}),t.jsx("button",{type:"button",className:"parent-btn parent-btn-secondary",onClick:()=>C(!1),children:"Annuler"})]})]})]}),a.length===0?t.jsxs("div",{className:"parent-empty-state",children:[t.jsx("div",{className:"parent-empty-icon",children:""}),t.jsx("h2",{children:"Aucun enfant li"}),t.jsx("p",{children:"Cliquez sur  Ajouter un enfant  et saisissez le code d'invitation de votre enfant pour commencer  suivre sa progression."}),t.jsx("button",{className:"parent-btn parent-btn-primary",onClick:()=>C(!0),children:" Ajouter mon premier enfant"})]}):t.jsxs("div",{className:"parent-content",children:[t.jsxs("aside",{className:"parent-sidebar",children:[t.jsx("h3",{className:"parent-sidebar-titre",children:"Mes enfants"}),t.jsx("ul",{className:"parent-enfants-liste",children:a.map(M=>t.jsxs("li",{className:`parent-enfant-card ${o===M.enfantId?"parent-enfant-actif":""}`,onClick:()=>u(M.enfantId),children:[t.jsx("div",{className:"parent-enfant-avatar",children:M.enfantNom.charAt(0).toUpperCase()}),t.jsxs("div",{className:"parent-enfant-info",children:[t.jsx("span",{className:"parent-enfant-nom",children:M.enfantNom}),M.enfantClasse&&t.jsx("span",{className:"parent-enfant-classe",children:M.enfantClasse})]}),t.jsx("button",{className:"parent-enfant-supprimer",onClick:T=>{T.stopPropagation(),ae(M)},title:"Retirer cet enfant",children:""})]},M.id))})]}),t.jsx("main",{className:"parent-main",children:o?v?t.jsxs("div",{className:"parent-loading",children:[t.jsx("div",{className:"parent-spinner"}),t.jsx("p",{children:"Chargement du suivi..."})]}):d?t.jsxs("div",{className:"parent-dashboard-detail",children:[t.jsxs("div",{className:"parent-enfant-header",children:[t.jsxs("div",{className:"parent-enfant-header-info",children:[t.jsx("h2",{children:d.enfant.nom}),d.enfant.classe&&t.jsx("span",{className:"parent-badge",children:d.enfant.classe}),d.enfant.derniereConnexion&&t.jsxs("span",{className:"parent-derniere-connexion",children:["Dernire connexion : ",Ex(d.enfant.derniereConnexion)]})]}),t.jsx("p",{className:"parent-message-motivation",children:uZ(d.scoreGlobal)})]}),t.jsxs("div",{className:"parent-indicateurs",children:[t.jsxs("div",{className:"parent-card parent-card-score",children:[t.jsx("div",{className:"parent-card-icon",children:""}),t.jsxs("div",{className:"parent-card-content",children:[t.jsx("span",{className:"parent-card-label",children:"Score Global"}),t.jsxs("span",{className:`parent-card-value parent-score-${d.scoreGlobal>=60?"bon":d.scoreGlobal>=40?"moyen":"bas"}`,children:[d.scoreGlobal,"/100"]})]})]}),t.jsxs("div",{className:"parent-card parent-card-streak",children:[t.jsx("div",{className:"parent-card-icon",children:""}),t.jsxs("div",{className:"parent-card-content",children:[t.jsx("span",{className:"parent-card-label",children:"Streak"}),t.jsxs("span",{className:"parent-card-value",children:[d.streak.actuel," jour",d.streak.actuel>1?"s":""]})]})]}),t.jsxs("div",{className:"parent-card parent-card-lacunes",children:[t.jsx("div",{className:"parent-card-icon",children:""}),t.jsxs("div",{className:"parent-card-content",children:[t.jsx("span",{className:"parent-card-label",children:"Lacunes"}),t.jsxs("span",{className:"parent-card-value",children:[d.lacunes.length," matire",d.lacunes.length>1?"s":""]})]})]}),t.jsxs("div",{className:"parent-card parent-card-objectifs",children:[t.jsx("div",{className:"parent-card-icon",children:""}),t.jsxs("div",{className:"parent-card-content",children:[t.jsx("span",{className:"parent-card-label",children:"Objectifs"}),t.jsxs("span",{className:"parent-card-value",children:[d.objectifs.filter(M=>M.statut==="atteint").length,"/",d.objectifs.length]})]})]})]}),t.jsxs("div",{className:"parent-section parent-section-semaine",children:[t.jsx("h3",{children:" Activit de la semaine"}),t.jsx("div",{className:"parent-semaine-jours",children:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"].map((M,T)=>t.jsxs("div",{className:`parent-jour ${d.streak.semaineCourante[T]?"parent-jour-actif":"parent-jour-inactif"}`,children:[t.jsx("span",{className:"parent-jour-label",children:M}),t.jsx("span",{className:"parent-jour-icon",children:d.streak.semaineCourante[T]?"":""})]},M))})]}),t.jsxs("div",{className:"parent-onglets",children:[t.jsx("button",{className:`parent-onglet ${B==="apercu"?"parent-onglet-actif":""}`,onClick:()=>U("apercu"),children:" Aperu"}),t.jsxs("button",{className:`parent-onglet ${B==="lacunes"?"parent-onglet-actif":""}`,onClick:()=>U("lacunes"),children:[" Lacunes (",d.lacunes.length,")"]}),t.jsxs("button",{className:`parent-onglet ${B==="alertes"?"parent-onglet-actif":""}`,onClick:()=>U("alertes"),children:[" Alertes (",d.alertes.length,")"]}),t.jsx("button",{className:`parent-onglet ${B==="resume"?"parent-onglet-actif":""}`,onClick:()=>U("resume"),children:" Rsum"})]}),t.jsxs("div",{className:"parent-onglet-contenu",children:[B==="apercu"&&t.jsxs("div",{className:"parent-tab-apercu",children:[t.jsxs("div",{className:"parent-section",children:[t.jsx("h3",{children:" Derniers quiz passs"}),d.derniersQuiz.length===0?t.jsx("p",{className:"parent-vide",children:"Aucun quiz pass rcemment."}):t.jsx("div",{className:"parent-quiz-liste",children:d.derniersQuiz.map((M,T)=>t.jsxs("div",{className:`parent-quiz-item ${M.reussi?"parent-quiz-reussi":"parent-quiz-echoue"}`,children:[t.jsxs("div",{className:"parent-quiz-info",children:[t.jsx("span",{className:"parent-quiz-discipline",children:M.disciplineNom}),t.jsx("span",{className:"parent-quiz-titre",children:M.quizTitre})]}),t.jsxs("div",{className:"parent-quiz-score",children:[t.jsxs("span",{className:`parent-quiz-note ${M.reussi?"note-ok":"note-ko"}`,children:[M.noteSur20,"/20"]}),t.jsx("span",{className:"parent-quiz-statut",children:M.reussi?" Russi":" chou"})]}),t.jsx("span",{className:"parent-quiz-date",children:Ex(M.datePassage)})]},T))})]}),t.jsxs("div",{className:"parent-section",children:[t.jsx("h3",{children:" Objectifs de la semaine"}),d.objectifs.length===0?t.jsx("p",{className:"parent-vide",children:"Aucun objectif cette semaine."}):t.jsx("div",{className:"parent-objectifs-liste",children:d.objectifs.map((M,T)=>t.jsxs("div",{className:"parent-objectif-item",children:[t.jsxs("div",{className:"parent-objectif-header",children:[t.jsx("span",{className:"parent-objectif-titre",children:M.titre}),t.jsx("span",{className:`parent-objectif-statut parent-statut-${M.statut}`,children:M.statut==="atteint"?" Atteint":M.statut==="en_cours"?" En cours":M.statut==="echoue"?" chou":" Non commenc"})]}),t.jsx("div",{className:"parent-progress-bar",children:t.jsx("div",{className:`parent-progress-fill parent-progress-${M.statut}`,style:{width:`${Math.min(M.progression/M.cible*100,100)}%`}})}),t.jsxs("span",{className:"parent-objectif-detail",children:[M.progression,"/",M.cible]})]},T))})]})]}),B==="lacunes"&&t.jsx("div",{className:"parent-tab-lacunes",children:d.lacunes.length===0?t.jsxs("div",{className:"parent-vide-section",children:[t.jsx("span",{className:"parent-vide-icon",children:""}),t.jsx("p",{children:"Aucune lacune dtecte ! Votre enfant est sur la bonne voie."})]}):t.jsx("div",{className:"parent-lacunes-liste",children:d.lacunes.map((M,T)=>t.jsxs("div",{className:"parent-lacune-item",style:{borderLeftColor:gf(M.niveauUrgence)},children:[t.jsxs("div",{className:"parent-lacune-header",children:[t.jsx("span",{className:"parent-lacune-discipline",children:M.disciplineNom}),t.jsx("span",{className:"parent-lacune-badge",style:{backgroundColor:gf(M.niveauUrgence),color:"#fff"},children:nM(M.niveauUrgence)})]}),t.jsxs("div",{className:"parent-lacune-details",children:[t.jsxs("span",{className:"parent-lacune-moyenne",children:["Moyenne : ",t.jsxs("strong",{children:[M.moyenne,"/20"]})]}),t.jsxs("span",{className:"parent-lacune-tendance",children:["Tendance : ",aM(M.tendance)," ",M.tendance==="hausse"?"En hausse":M.tendance==="baisse"?"En baisse":"Stable"]})]}),t.jsx("p",{className:"parent-lacune-conseil",children:M.niveauUrgence==="critique"?" Intervention recommande : discutez avec votre enfant et envisagez un soutien scolaire.":M.niveauUrgence==="important"?" Encouragez votre enfant  rviser cette matire rgulirement.":" Quelques rvisions suffiront pour consolider les acquis."})]},T))})}),B==="alertes"&&t.jsx("div",{className:"parent-tab-alertes",children:d.alertes.length===0?t.jsxs("div",{className:"parent-vide-section",children:[t.jsx("span",{className:"parent-vide-icon",children:""}),t.jsx("p",{children:"Aucune alerte pour le moment. Tout va bien !"})]}):t.jsx("div",{className:"parent-alertes-liste",children:d.alertes.map((M,T)=>t.jsxs("div",{className:`parent-alerte-item parent-alerte-${M.niveau}`,children:[t.jsxs("div",{className:"parent-alerte-header",children:[t.jsx("span",{className:"parent-alerte-titre",children:M.titre}),t.jsx("span",{className:"parent-alerte-badge",style:{backgroundColor:oZ(M.niveau),color:"#fff"},children:cZ(M.type)})]}),t.jsx("p",{className:"parent-alerte-message",children:M.message}),t.jsx("span",{className:"parent-alerte-date",children:Ex(M.dateCreation)})]},T))})}),B==="resume"&&d.resume&&t.jsxs("div",{className:"parent-tab-resume",children:[t.jsxs("div",{className:"parent-resume-header",children:[t.jsxs("h3",{children:[" Rsum : ",d.resume.semaine]}),t.jsxs("span",{className:"parent-resume-evolution",children:["Score : ",d.resume.scoreGlobal,"/100"," ",HE(d.resume.evolutionScore)]})]}),t.jsxs("div",{className:"parent-resume-stats",children:[t.jsxs("div",{className:"parent-resume-stat",children:[t.jsx("span",{className:"parent-resume-stat-value",children:d.resume.nombreQuizSemaine}),t.jsx("span",{className:"parent-resume-stat-label",children:"Quiz passs"})]}),t.jsxs("div",{className:"parent-resume-stat",children:[t.jsxs("span",{className:"parent-resume-stat-value",children:[d.resume.joursActifsSemaine,"/7"]}),t.jsx("span",{className:"parent-resume-stat-label",children:"Jours actifs"})]}),t.jsxs("div",{className:"parent-resume-stat",children:[t.jsxs("span",{className:"parent-resume-stat-value",children:[d.resume.tempsEstimeMinutes," min"]}),t.jsx("span",{className:"parent-resume-stat-label",children:"Temps d'tude"})]}),t.jsxs("div",{className:"parent-resume-stat",children:[t.jsxs("span",{className:"parent-resume-stat-value",children:[d.resume.objectifsAtteints,"/",d.resume.objectifsTotal]}),t.jsx("span",{className:"parent-resume-stat-label",children:"Objectifs atteints"})]})]}),d.resume.evolutionDisciplines.length>0&&t.jsxs("div",{className:"parent-section",children:[t.jsx("h4",{children:" volution par matire"}),t.jsx("div",{className:"parent-evolution-liste",children:d.resume.evolutionDisciplines.map((M,T)=>t.jsxs("div",{className:"parent-evolution-item",children:[t.jsx("span",{className:"parent-evolution-discipline",children:M.disciplineNom}),t.jsxs("div",{className:"parent-evolution-scores",children:[t.jsxs("span",{className:"parent-evolution-prec",children:[M.moyenneSemainePrecedente,"/20"]}),t.jsx("span",{className:"parent-evolution-fleche",children:HE(M.evolution)}),t.jsxs("span",{className:"parent-evolution-courante",children:[M.moyenneSemaineCourante,"/20"]}),t.jsxs("span",{className:`parent-evolution-ecart ${M.ecart>0?"ecart-positif":M.ecart<0?"ecart-negatif":""}`,children:["(",M.ecart>0?"+":"",M.ecart,")"]})]})]},T))})]}),d.resume.disciplinesEnDifficulte.length>0&&t.jsxs("div",{className:"parent-section parent-section-warning",children:[t.jsx("h4",{children:" Matires ncessitant une attention"}),t.jsx("ul",{className:"parent-disciplines-difficulte",children:d.resume.disciplinesEnDifficulte.map((M,T)=>t.jsx("li",{children:M},T))})]})]}),B==="resume"&&!d.resume&&t.jsxs("div",{className:"parent-vide-section",children:[t.jsx("span",{className:"parent-vide-icon",children:""}),t.jsx("p",{children:"Le rsum sera disponible une fois que votre enfant aura pass des quiz."})]})]})]}):t.jsxs("div",{className:"parent-erreur-dashboard",children:[t.jsx("p",{children:" Impossible de charger le suivi. Veuillez ressayer."}),t.jsx("button",{className:"parent-btn parent-btn-primary",onClick:()=>o&&R(o),children:" Ressayer"})]}):t.jsx("div",{className:"parent-select-enfant",children:t.jsx("p",{children:" Slectionnez un enfant dans la liste pour voir son suivi."})})})]})]})},zj="compiled_ebooks";async function _te(e,r,n,a){return(await Pt(_e(Q,zj),{userId:e,titre:r,description:n,sections:a,createdAt:Ae.now()})).id}async function fA(e,r=30){const n=Ee(_e(Q,zj),Ne("userId","==",e),Ve("createdAt","desc")),a=await Ce(n),l=[];return a.forEach(o=>{l.length<r&&l.push({id:o.id,...o.data()})}),l}async function Nte(e){await Br(je(Q,zj,e))}const Ste=({userId:e,history:r,onClose:n,onSaved:a,markdownToHtml:l})=>{const[o,u]=g.useState("select"),[d,f]=g.useState([]),[p,h]=g.useState(""),[v,b]=g.useState(""),[x,j]=g.useState(!1),[_,C]=g.useState(!1),[w,E]=g.useState(""),S=r.filter($=>$.type!=="quiz_auto"&&$.content);function A($){f(R=>R.some(ae=>ae.id===$.id)?R.filter(ae=>ae.id!==$.id):[...R,$])}function O($){$!==0&&f(R=>{const Y=[...R];return[Y[$-1],Y[$]]=[Y[$],Y[$-1]],Y})}function k($){f(R=>{if($===R.length-1)return R;const Y=[...R];return[Y[$],Y[$+1]]=[Y[$+1],Y[$]],Y})}const P=g.useCallback(($=!1)=>{const R=d.map((Y,ae)=>`
      <section class="ebook-section">
        <div class="section-header">
          <span class="section-num">${ae+1}</span>
          <div class="section-meta">
            <h2 class="section-title">${Y.chapitre}</h2>
            <p class="section-subtitle">
              ${pr[Y.type]} &nbsp;&nbsp;
              ${Y.discipline} &nbsp;&nbsp; Classe : ${Y.classe}
            </p>
          </div>
        </div>
        <div class="section-body">${l(Y.content||"")}</div>
      </section>`).join('<div class="page-break"></div>');return`<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>${p||"Ebook PedaClic"}</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Georgia', serif;
      font-size: 12pt;
      line-height: 1.75;
      color: #1a1a2e;
      background: #fff;
      padding: ${$?"0":"2rem"};
      max-width: 860px;
      margin: auto;
    }
    /*  Couverture  */
    .cover {
      min-height: ${$?"100vh":"280px"};
      background: linear-gradient(135deg, #1a56db 0%, #7c3aed 100%);
      border-radius: ${$?"0":"12px"};
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 3rem 2rem;
      color: #fff;
      margin-bottom: 2.5rem;
    }
    .cover-logo { font-size: 3rem; margin-bottom: 1rem; }
    .cover-title { font-size: 2rem; font-weight: 700; line-height: 1.2; margin-bottom: 0.75rem; }
    .cover-desc { font-size: 1rem; opacity: 0.85; max-width: 480px; }
    .cover-meta { margin-top: 1.5rem; font-size: 0.85rem; opacity: 0.7; }
    /*  Sommaire  */
    .toc {
      background: #f8faff;
      border: 1px solid #dbeafe;
      border-radius: 10px;
      padding: 1.5rem 2rem;
      margin-bottom: 2.5rem;
    }
    .toc h2 { font-size: 1.1rem; color: #1a56db; margin-bottom: 1rem; }
    .toc ol { padding-left: 1.25rem; }
    .toc li { padding: 0.3rem 0; font-size: 0.95rem; color: #374151; }
    .toc li span { color: #6b7280; font-size: 0.85rem; margin-left: 0.5rem; }
    /*  Sections  */
    .ebook-section { margin-bottom: 2.5rem; }
    .section-header {
      display: flex;
      gap: 1rem;
      align-items: flex-start;
      background: #eff6ff;
      border-left: 4px solid #1a56db;
      padding: 1rem 1.25rem;
      border-radius: 0 8px 8px 0;
      margin-bottom: 1.25rem;
    }
    .section-num {
      background: #1a56db;
      color: #fff;
      width: 32px; height: 32px;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-weight: 700; font-size: 0.9rem;
      flex-shrink: 0;
    }
    .section-title { font-size: 1.3rem; font-weight: 700; color: #1e3a8a; }
    .section-subtitle { font-size: 0.82rem; color: #6b7280; margin-top: 2px; }
    .section-body { padding: 0 0.5rem; }
    .section-body h1, .section-body h2 { color: #1a56db; margin: 1rem 0 0.5rem; }
    .section-body h3 { color: #4f46e5; margin: 0.75rem 0 0.4rem; }
    .section-body p { margin-bottom: 0.6rem; }
    .section-body ul, .section-body ol { margin: 0.4rem 0 0.8rem 1.5rem; }
    .section-body li { margin-bottom: 0.3rem; }
    .section-body strong { font-weight: 700; color: #111827; }
    .section-body em { font-style: italic; color: #374151; }
    .section-body code {
      font-family: 'Courier New', monospace;
      background: #f3f4f6;
      padding: 1px 5px;
      border-radius: 3px;
      font-size: 0.9em;
    }
    .section-body pre {
      background: #f3f4f6;
      padding: 0.75rem 1rem;
      border-radius: 6px;
      overflow-x: auto;
      margin: 0.8rem 0;
    }
    .section-body hr { border: none; border-top: 1px solid #e5e7eb; margin: 1rem 0; }
    /*  Sauts de page  */
    .page-break { page-break-after: always; break-after: page; height: 0; }
    /*  Pied de page  */
    .ebook-footer {
      margin-top: 3rem;
      text-align: center;
      font-size: 0.8rem;
      color: #9ca3af;
      border-top: 1px solid #e5e7eb;
      padding-top: 1rem;
    }
    @media print {
      body { padding: 0; max-width: none; }
      .cover { border-radius: 0; }
      @page { margin: 2cm; }
    }
  </style>
</head>
<body>
  <div class="cover">
    <div class="cover-logo"></div>
    <h1 class="cover-title">${p||"Ebook PedaClic"}</h1>
    ${v?`<p class="cover-desc">${v}</p>`:""}
    <p class="cover-meta">
      Gnr par PedaClic &nbsp;&nbsp;
      ${new Date().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}
    </p>
  </div>

  <div class="toc">
    <h2> Table des matires</h2>
    <ol>
      ${d.map(Y=>`<li>${Y.chapitre} <span> ${Y.discipline}  ${Y.classe}</span></li>`).join("")}
    </ol>
  </div>

  ${R}

  <div class="ebook-footer">
    PedaClic  L'cole en un clic &nbsp;&nbsp; www.pedaclic.sn
  </div>

  ${$?"<script>window.onload = () => window.print();<\/script>":""}
</body>
</html>`},[d,p,v,l]);function D(){const $=window.open("","_blank","width=920,height=720");$&&($.document.write(P(!0)),$.document.close())}function B(){const $=P(!1),R=`
<html xmlns:o="urn:schemas-microsoft-com:office:office"
      xmlns:w="urn:schemas-microsoft-com:office:word"
      xmlns="http://www.w3.org/TR/REC-html40">
<head><meta charset="utf-8"><title>${p}</title></head>
<body>${$}</body></html>`,Y=new Blob(["\uFEFF",R],{type:"application/msword;charset=utf-8"}),ae=URL.createObjectURL(Y),M=document.createElement("a");M.href=ae;const T=(p||"ebook_pedaclic").replace(/[^\w\u00C0-\u017E\s-]/g,"").replace(/\s+/g,"_").slice(0,60);M.download=`${T}.doc`,document.body.appendChild(M),M.click(),document.body.removeChild(M),URL.revokeObjectURL(ae)}async function U(){if(!p.trim()){E("Veuillez donner un titre  l'ebook.");return}j(!0),E("");try{const $=d.map(R=>({contenuId:R.id,type:R.type,discipline:R.discipline,classe:R.classe,chapitre:R.chapitre,content:R.content}));await _te(e,p,v,$),C(!0),a()}catch{E("Erreur lors de la sauvegarde. Veuillez ressayer.")}finally{j(!1)}}return o==="select"?t.jsx("div",{className:"ai-generator__modal-overlay",onClick:$=>{$.target===$.currentTarget&&n()},children:t.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:$=>$.stopPropagation(),children:[t.jsxs("div",{className:"ai-generator__modal-header",children:[t.jsxs("div",{className:"ai-generator__modal-title-block",children:[t.jsx("h2",{children:" Compiler un Ebook"}),t.jsx("span",{className:"ai-generator__modal-subtitle",children:"tape 1 / 3  Slectionner les chapitres  inclure"})]}),t.jsx("button",{className:"ai-generator__modal-close",onClick:n,children:""})]}),t.jsx("div",{className:"ai-generator__modal-body",children:S.length===0?t.jsx("p",{className:"ai-generator__empty",children:"Aucun contenu textuel sauvegard. Gnrez d'abord des cours, exercices ou sujets."}):t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"ebook-compiler__hint",children:"Cochez les chapitres  inclure dans l'ebook. Vous pourrez les rordonner ensuite."}),t.jsx("div",{className:"ebook-compiler__list",children:S.map($=>{const R=d.some(Y=>Y.id===$.id);return t.jsxs("label",{className:`ebook-compiler__item ${R?"ebook-compiler__item--selected":""}`,children:[t.jsx("input",{type:"checkbox",checked:R,onChange:()=>A($),className:"ebook-compiler__checkbox"}),t.jsx("div",{className:"ebook-compiler__item-icon",children:Ka[$.type]}),t.jsxs("div",{className:"ebook-compiler__item-info",children:[t.jsx("div",{className:"ebook-compiler__item-title",children:$.chapitre}),t.jsxs("div",{className:"ebook-compiler__item-meta",children:[pr[$.type],"  ",$.discipline,"  ",$.classe]})]}),R&&t.jsx("span",{className:"ebook-compiler__badge",children:""})]},$.id)})})]})}),t.jsxs("div",{className:"ai-generator__modal-footer",children:[t.jsx("button",{className:"btn btn--outline",onClick:n,children:"Annuler"}),t.jsx("button",{className:"btn btn--primary",onClick:()=>u("configure"),disabled:d.length===0,children:d.length===0?"Slectionnez au moins 1 chapitre":`Suivant  (${d.length} chapitre${d.length>1?"s":""})`})]})]})}):o==="configure"?t.jsx("div",{className:"ai-generator__modal-overlay",onClick:$=>{$.target===$.currentTarget&&n()},children:t.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:$=>$.stopPropagation(),children:[t.jsxs("div",{className:"ai-generator__modal-header",children:[t.jsxs("div",{className:"ai-generator__modal-title-block",children:[t.jsx("h2",{children:" Compiler un Ebook"}),t.jsx("span",{className:"ai-generator__modal-subtitle",children:"tape 2 / 3  Titre et ordre des chapitres"})]}),t.jsx("button",{className:"ai-generator__modal-close",onClick:n,children:""})]}),t.jsxs("div",{className:"ai-generator__modal-body",children:[t.jsxs("div",{className:"ebook-compiler__field",children:[t.jsx("label",{className:"ebook-compiler__label",children:"Titre de l'ebook *"}),t.jsx("input",{className:"ebook-compiler__input",type:"text",placeholder:"Ex : Cours de Mathmatiques  3me",value:p,onChange:$=>h($.target.value),autoFocus:!0})]}),t.jsxs("div",{className:"ebook-compiler__field",children:[t.jsx("label",{className:"ebook-compiler__label",children:"Description (optionnel)"}),t.jsx("textarea",{className:"ebook-compiler__textarea",rows:2,placeholder:"Ex : Recueil de cours et exercices pour la classe de 3me",value:v,onChange:$=>b($.target.value)})]}),t.jsxs("div",{className:"ebook-compiler__order-label",children:["Ordre des chapitres ",t.jsx("span",{children:"(glisser les flches pour rordonner)"})]}),t.jsx("div",{className:"ebook-compiler__order-list",children:d.map(($,R)=>t.jsxs("div",{className:"ebook-compiler__order-item",children:[t.jsx("span",{className:"ebook-compiler__order-num",children:R+1}),t.jsx("span",{className:"ebook-compiler__order-icon",children:Ka[$.type]}),t.jsxs("div",{className:"ebook-compiler__order-info",children:[t.jsx("div",{className:"ebook-compiler__order-title",children:$.chapitre}),t.jsxs("div",{className:"ebook-compiler__order-meta",children:[$.discipline,"  ",$.classe]})]}),t.jsxs("div",{className:"ebook-compiler__order-btns",children:[t.jsx("button",{type:"button",onClick:()=>O(R),disabled:R===0,title:"Monter",children:""}),t.jsx("button",{type:"button",onClick:()=>k(R),disabled:R===d.length-1,title:"Descendre",children:""})]})]},$.id))})]}),t.jsxs("div",{className:"ai-generator__modal-footer",children:[t.jsx("button",{className:"btn btn--outline",onClick:()=>u("select"),children:" Retour"}),t.jsx("button",{className:"btn btn--primary",onClick:()=>{if(!p.trim()){E("Titre requis.");return}E(""),u("preview")},children:"Aperu "})]}),w&&t.jsx("p",{className:"ebook-compiler__error",children:w})]})}):t.jsx("div",{className:"ai-generator__modal-overlay",onClick:$=>{$.target===$.currentTarget&&n()},children:t.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:$=>$.stopPropagation(),children:[t.jsxs("div",{className:"ai-generator__modal-header",children:[t.jsxs("div",{className:"ai-generator__modal-title-block",children:[t.jsxs("h2",{children:[" ",p]}),t.jsx("span",{className:"ai-generator__modal-subtitle",children:"tape 3 / 3  Aperu et tlchargement"})]}),t.jsxs("div",{className:"ai-generator__modal-header-actions",children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:D,title:"Enregistrer en PDF",children:" PDF"}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:B,title:"Tlcharger en Word",children:" Word"}),t.jsx("button",{className:"ai-generator__modal-close",onClick:n,children:""})]})]}),t.jsxs("div",{className:"ai-generator__modal-body",children:[t.jsxs("div",{className:"ebook-compiler__cover-preview",children:[t.jsx("span",{children:""}),t.jsxs("div",{children:[t.jsx("div",{className:"ebook-compiler__cover-title",children:p}),v&&t.jsx("div",{className:"ebook-compiler__cover-desc",children:v}),t.jsxs("div",{className:"ebook-compiler__cover-meta",children:[d.length," chapitre",d.length>1?"s":"","  PedaClic"]})]})]}),t.jsxs("div",{className:"ebook-compiler__toc",children:[t.jsx("div",{className:"ebook-compiler__toc-title",children:" Sommaire"}),t.jsx("ol",{children:d.map(($,R)=>t.jsxs("li",{children:[t.jsxs("span",{children:[R+1,". ",$.chapitre]}),t.jsxs("span",{className:"ebook-compiler__toc-meta",children:[$.discipline,"  ",$.classe]})]},$.id))})]}),_?t.jsx("div",{className:"ebook-compiler__success",children:" Ebook sauvegard avec succs dans votre bibliothque IA !"}):t.jsxs("div",{className:"ebook-compiler__save-row",children:[t.jsx("button",{className:"btn btn--primary btn--lg",onClick:U,disabled:x,children:x?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner spinner--sm"})," Sauvegarde"]}):" Sauvegarder dans PedaClic"}),t.jsx("p",{className:"ebook-compiler__save-hint",children:"L'ebook sera accessible depuis votre Bibliothque."})]}),w&&t.jsx("p",{className:"ebook-compiler__error",children:w})]}),t.jsxs("div",{className:"ai-generator__modal-footer",children:[t.jsx("button",{className:"btn btn--outline",onClick:()=>u("configure"),children:" Modifier"}),t.jsx("button",{className:"btn btn--outline",onClick:n,children:"Fermer"})]})]})})},wte=["6me","5me","4me","3me","2nde","1re","Terminale"],Cte=[30,45,60,90,120],Ete=()=>{const{currentUser:e}=Ke(),[r,n]=g.useState(1),[a,l]=g.useState([]),[o,u]=g.useState(null),[d,f]=g.useState(""),[p,h]=g.useState(""),[v,b]=g.useState(""),[x,j]=g.useState(null),[_,C]=g.useState({}),[w,E]=g.useState(!1),[S,A]=g.useState(null),[O,k]=g.useState(null),[P,D]=g.useState(!1),[B,U]=g.useState(!1),[$,R]=g.useState(null),[Y,ae]=g.useState(!1),[M,T]=g.useState([]),[F,I]=g.useState(!1),[X,L]=g.useState(null),[ne,K]=g.useState(!1),[oe,xe]=g.useState(!1),[ve,H]=g.useState([]),[he,Me]=g.useState(!1),[ue,Z]=g.useState(!0),V=g.useMemo(()=>{const ee=new Map;return a.forEach(Pe=>{ee.has(Pe.nom)||ee.set(Pe.nom,Pe)}),Array.from(ee.values())},[a]);g.useEffect(()=>{(async()=>{try{Z(!0);const Pe=Ee(_e(Q,"disciplines"),Ve("nom")),ct=await Ce(Pe),J=[];ct.forEach(ce=>{const Se=ce.data();Se.nom&&Se.nom.trim()&&J.push({id:ce.id,nom:Se.nom||"",classe:Se.classe||"",niveau:Se.niveau||""})}),l(J)}catch(Pe){console.error("[AIGenerator] Erreur chargement disciplines:",Pe),k("Impossible de charger les disciplines.")}finally{Z(!1)}})()},[]);const me=ee=>{u(ee),k(null)},we=()=>{const ee=[];if(o||ee.push("discipline"),d||ee.push("classe"),(!p||p<1)&&ee.push("dure de la leon"),ee.length>0){k(`Champs requis manquants : ${ee.join(", ")}`);return}n(2),k(null)},qe=()=>{if(!v.trim()){k("Veuillez saisir le titre du chapitre.");return}n(3),k(null)},Xe=ee=>{j(ee),n(4),k(null)},et=()=>{r>1&&(n(ee=>ee-1),k(null),r===5&&(A(null),U(!1),R(null)))},it=()=>{n(1),u(null),f(""),h(""),b(""),j(null),C({}),A(null),k(null),U(!1),R(null)},jr=async()=>{if(!o||!x||!v.trim()||!d){k("Paramtres incomplets. Veuillez reprendre depuis le dbut.");return}E(!0),k(null);try{const ee={..._,duree:typeof p=="number"?p:void 0},Pe={type:x,discipline:o.nom,classe:d,chapitre:v.trim(),options:Object.keys(ee).length>0?ee:void 0},ct=await wJ(Pe);A(ct),n(5)}catch(ee){const Pe=ee instanceof Error?ee.message:"Erreur inconnue";k(Pe)}finally{E(!1)}},Mr=async()=>{if(!(!e||!S||!o||!x)){D(!0),k(null);try{let ee;const ct=a.find(ce=>ce.nom===o.nom&&ce.classe===d)?.id||o.id,J={type:x,discipline:o.nom,classe:d,chapitre:v.trim(),options:{..._,duree:typeof p=="number"?p:void 0}};S.type==="quiz"&&S.data.questions?ee=await EJ(e.uid,J,S.data.questions,ct):ee=await CJ(e.uid,J,S.data.content||"",ct),R(ee),U(!0);try{const ce=await Rb(e.uid);T(ce)}catch{}}catch(ee){const Pe=ee instanceof Error?ee.message:"Erreur de sauvegarde";k(Pe)}finally{D(!1)}}},cr=async()=>{if(e){I(!0);try{const ee=await Rb(e.uid);T(ee),ae(!0)}catch(ee){console.error("[AIGenerator] Erreur historique:",ee)}finally{I(!1)}}},nn=ee=>ee.replace(/[^\w\u00C0-\u017E\s-]/g,"").trim().replace(/\s+/g,"_").slice(0,60)||"contenu_pedaclic",pe=(ee,Pe)=>{const ct=URL.createObjectURL(ee),J=document.createElement("a");J.href=ct,J.download=Pe,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(ct)},ze=(ee,Pe)=>{const ct=Gr(ee),J=`
<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office"
      xmlns:w="urn:schemas-microsoft-com:office:word"
      xmlns="http://www.w3.org/TR/REC-html40">
<head>
  <meta charset="utf-8">
  <title>${Pe}</title>
  <!--[if gte mso 9]><xml><w:WordDocument><w:View>Print</w:View><w:Zoom>100</w:Zoom></w:WordDocument></xml><![endif]-->
  <style>
    body { font-family: Arial, sans-serif; font-size: 12pt; line-height: 1.6; margin: 2cm; color: #1a1a1a; }
    h1 { font-size: 18pt; color: #1a56db; margin-bottom: 12pt; }
    h2 { font-size: 15pt; color: #1a56db; margin-top: 18pt; margin-bottom: 8pt; }
    h3 { font-size: 13pt; color: #333; margin-top: 14pt; }
    p  { margin-bottom: 8pt; }
    ul, ol { margin-left: 1cm; margin-bottom: 8pt; }
    li { margin-bottom: 4pt; }
    strong { font-weight: bold; }
    em { font-style: italic; }
    code { font-family: Courier New; background: #f5f5f5; padding: 1pt 3pt; }
    pre  { font-family: Courier New; background: #f5f5f5; padding: 8pt; margin: 8pt 0; }
    hr { border: none; border-top: 1px solid #ccc; margin: 12pt 0; }
  </style>
</head>
<body>
  <h1>${Pe}</h1>
  ${ct}
</body>
</html>`,ce=new Blob(["\uFEFF",J],{type:"application/msword;charset=utf-8"});pe(ce,`${nn(Pe)}.doc`)},Re=(ee,Pe)=>{const ct=Gr(ee),J=window.open("","_blank","width=900,height=700");J&&(J.document.write(`
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>${Pe}</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: Arial, sans-serif; font-size: 12pt; line-height: 1.7; color: #1a1a1a; padding: 2cm; max-width: 800px; margin: auto; }
    h1 { font-size: 20pt; color: #1a56db; margin-bottom: 14pt; padding-bottom: 6pt; border-bottom: 2px solid #1a56db; }
    h2 { font-size: 15pt; color: #1a56db; margin: 18pt 0 8pt; }
    h3 { font-size: 13pt; color: #333; margin: 14pt 0 6pt; }
    p  { margin-bottom: 8pt; }
    ul, ol { margin: 6pt 0 8pt 1.5cm; }
    li { margin-bottom: 4pt; }
    strong { font-weight: bold; }
    em { font-style: italic; }
    code { font-family: Courier New, monospace; background: #f5f5f5; padding: 1pt 4pt; border-radius: 3pt; font-size: 10pt; }
    pre  { font-family: Courier New, monospace; background: #f5f5f5; padding: 10pt; margin: 8pt 0; border-radius: 4pt; font-size: 10pt; white-space: pre-wrap; }
    hr { border: none; border-top: 1px solid #ddd; margin: 14pt 0; }
    .header-meta { font-size: 9pt; color: #888; margin-bottom: 18pt; }
    @media print {
      body { padding: 0; }
      @page { margin: 2cm; }
    }
  </style>
</head>
<body>
  <h1>${Pe}</h1>
  <p class="header-meta">PedaClic  Gnr le ${new Date().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}</p>
  ${ct}
  <script>window.onload = () => { window.print(); };<\/script>
</body>
</html>`),J.document.close())},Qe=async ee=>{if(window.confirm("Supprimer ce contenu gnr ?"))try{await AJ(ee),T(Pe=>Pe.filter(ct=>ct.id!==ee))}catch(Pe){console.error("[AIGenerator] Erreur suppression:",Pe)}},pt=async()=>{if(e){Me(!0);try{const ee=await fA(e.uid);H(ee),xe(!0)}catch(ee){console.error("[AIGenerator] Erreur chargement ebooks:",ee)}finally{Me(!1)}}},It=async ee=>{if(window.confirm("Supprimer cet ebook ?"))try{await Nte(ee),H(Pe=>Pe.filter(ct=>ct.id!==ee))}catch(Pe){console.error("[AIGenerator] Erreur suppression ebook:",Pe)}},nr=ee=>{const Pe=ee.sections.map((ct,J)=>`# ${J+1}. ${ct.chapitre}

**${pr[ct.type]}**  ${ct.discipline}  ${ct.classe}

${ct.content}`).join(`

---

`);L({id:ee.id,userId:ee.userId,type:"cours_complet",discipline:"Ebook compil",disciplineId:"",classe:"",chapitre:ee.titre,content:Pe,createdAt:ee.createdAt}),xe(!1)},Gr=g.useCallback(ee=>{if(!ee)return"";let Pe=ee.replace(/^### (.+)$/gm,"<h3>$1</h3>").replace(/^## (.+)$/gm,"<h2>$1</h2>").replace(/^# (.+)$/gm,"<h1>$1</h1>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/^- (.+)$/gm,"<li>$1</li>").replace(/^\d+\. (.+)$/gm,"<li>$1</li>").replace(/^---$/gm,"<hr />").replace(/```(\w*)\n([\s\S]*?)```/g,"<pre><code>$2</code></pre>").replace(/`(.+?)`/g,"<code>$1</code>").replace(/\n\n/g,"</p><p>").replace(/\n/g,"<br />");return Pe=Pe.replace(/(<li>.*?<\/li>(\s*<br \/>)?)+/g,ct=>"<ul>"+ct.replace(/<br \/>/g,"")+"</ul>"),`<p>${Pe}</p>`},[]);return e?e.isPremium?t.jsxs("div",{className:"ai-generator",children:[t.jsxs("div",{className:"ai-generator__header",children:[t.jsx("h1",{className:"ai-generator__title",children:" Gnrateur de Contenu IA"}),t.jsx("p",{className:"ai-generator__subtitle",children:"Crez des cours, exercices, quiz et sujets d'examen adapts au programme sngalais"}),t.jsxs("div",{className:"ai-generator__header-actions",children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:cr,disabled:F,children:F?" Chargement...":" Historique"}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>{cr(),K(!0)},title:"Compiler plusieurs contenus en un ebook",children:" Compiler un Ebook"}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:pt,disabled:he,title:"Voir mes ebooks compils",children:he?"...":" Mes Ebooks"}),r>1&&t.jsx("button",{className:"btn btn--outline btn--sm",onClick:it,children:" Recommencer"})]})]}),t.jsx("div",{className:"ai-generator__steps",children:[1,2,3,4,5].map(ee=>t.jsxs("div",{className:`ai-generator__step-indicator ${ee===r?"ai-generator__step-indicator--active":""} ${ee<r?"ai-generator__step-indicator--done":""}`,children:[t.jsx("span",{className:"ai-generator__step-number",children:ee<r?"":ee}),t.jsxs("span",{className:"ai-generator__step-label",children:[ee===1&&"Paramtres",ee===2&&"Chapitre",ee===3&&"Type",ee===4&&"Options",ee===5&&"Rsultat"]})]},ee))}),O&&t.jsxs("div",{className:"ai-generator__error",children:[t.jsx("span",{className:"ai-generator__error-icon",children:""}),O,t.jsx("button",{className:"ai-generator__error-close",onClick:()=>k(null),children:""})]}),t.jsxs("div",{className:"ai-generator__content",children:[r===1&&t.jsxs("div",{className:"ai-generator__step-content",children:[t.jsx("h2",{className:"ai-generator__step-title",children:" Paramtres de la leon"}),t.jsxs("div",{className:"ai-generator__field",children:[t.jsxs("label",{className:"ai-generator__label",children:["Discipline ",t.jsx("span",{className:"ai-generator__required",children:"*"})]}),ue?t.jsxs("div",{className:"ai-generator__loading",children:[t.jsx("div",{className:"spinner"}),t.jsx("p",{children:"Chargement des disciplines..."})]}):V.length===0?t.jsx("div",{className:"ai-generator__empty",children:t.jsx("p",{children:"Aucune discipline disponible."})}):t.jsx("div",{className:"ai-generator__discipline-grid",children:V.map(ee=>t.jsx("button",{className:`ai-generator__discipline-card ${o?.nom===ee.nom?"ai-generator__discipline-card--selected":""}`,onClick:()=>me(ee),children:t.jsx("span",{className:"ai-generator__discipline-name",children:ee.nom})},ee.id))})]}),t.jsxs("div",{className:"ai-generator__field",children:[t.jsxs("label",{className:"ai-generator__label",children:["Classe ",t.jsx("span",{className:"ai-generator__required",children:"*"})]}),t.jsx("div",{className:"ai-generator__classe-grid",children:wte.map(ee=>t.jsx("button",{className:`ai-generator__classe-btn ${d===ee?"ai-generator__classe-btn--selected":""}`,onClick:()=>{f(ee),k(null)},children:ee},ee))})]}),t.jsxs("div",{className:"ai-generator__field",children:[t.jsxs("label",{htmlFor:"dureeCours",className:"ai-generator__label",children:["Dure de la leon (minutes) ",t.jsx("span",{className:"ai-generator__required",children:"*"})]}),t.jsxs("div",{className:"ai-generator__duree-group",children:[t.jsx("div",{className:"ai-generator__duree-presets",children:Cte.map(ee=>t.jsxs("button",{className:`ai-generator__duree-btn ${p===ee?"ai-generator__duree-btn--selected":""}`,onClick:()=>{h(ee),k(null)},children:[ee," min"]},ee))}),t.jsx("input",{id:"dureeCours",type:"number",className:"ai-generator__input ai-generator__input--small",min:"15",max:"300",step:"5",value:p,onChange:ee=>{const Pe=parseInt(ee.target.value);h(isNaN(Pe)?"":Pe),k(null)},placeholder:"Autre dure..."})]})]}),t.jsxs("div",{className:"ai-generator__nav",children:[t.jsx("div",{})," ",t.jsx("button",{className:"btn btn--primary",onClick:we,disabled:!o||!d||!p,children:"Continuer "})]})]}),r===2&&t.jsxs("div",{className:"ai-generator__step-content",children:[t.jsx("h2",{className:"ai-generator__step-title",children:" Prcisez le chapitre"}),t.jsxs("div",{className:"ai-generator__recap",children:[t.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),t.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),t.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),t.jsx("span",{className:"ai-generator__recap-value",children:d}),t.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),t.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]})]}),t.jsxs("div",{className:"ai-generator__field",children:[t.jsx("label",{htmlFor:"chapitre",className:"ai-generator__label",children:"Titre du chapitre ou du thme"}),t.jsx("input",{id:"chapitre",type:"text",className:"ai-generator__input",placeholder:"Ex: Les fonctions affines, Le rcit autobiographique, La tectonique des plaques...",value:v,onChange:ee=>b(ee.target.value),onKeyDown:ee=>ee.key==="Enter"&&qe(),autoFocus:!0})]}),t.jsxs("div",{className:"ai-generator__nav",children:[t.jsx("button",{className:"btn btn--outline",onClick:et,children:" Retour"}),t.jsx("button",{className:"btn btn--primary",onClick:qe,disabled:!v.trim(),children:"Continuer "})]})]}),r===3&&t.jsxs("div",{className:"ai-generator__step-content",children:[t.jsx("h2",{className:"ai-generator__step-title",children:" Quel type de contenu ?"}),t.jsxs("div",{className:"ai-generator__recap",children:[t.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),t.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),t.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),t.jsx("span",{className:"ai-generator__recap-value",children:d}),t.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),t.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]}),t.jsx("span",{className:"ai-generator__recap-label",children:"Chapitre :"}),t.jsx("span",{className:"ai-generator__recap-value",children:v})]}),t.jsx("div",{className:"ai-generator__type-grid",children:Object.keys(pr).map(ee=>t.jsxs("button",{className:"ai-generator__type-card",onClick:()=>Xe(ee),children:[t.jsx("span",{className:"ai-generator__type-icon",children:Ka[ee]}),t.jsx("span",{className:"ai-generator__type-name",children:pr[ee]}),t.jsx("span",{className:"ai-generator__type-desc",children:NJ[ee]})]},ee))}),t.jsx("div",{className:"ai-generator__nav",children:t.jsx("button",{className:"btn btn--outline",onClick:et,children:" Retour"})})]}),r===4&&t.jsxs("div",{className:"ai-generator__step-content",children:[t.jsx("h2",{className:"ai-generator__step-title",children:" Options de gnration"}),t.jsxs("div",{className:"ai-generator__recap",children:[t.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),t.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),t.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),t.jsx("span",{className:"ai-generator__recap-value",children:d}),t.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),t.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]}),t.jsx("span",{className:"ai-generator__recap-label",children:"Chapitre :"}),t.jsx("span",{className:"ai-generator__recap-value",children:v}),t.jsx("span",{className:"ai-generator__recap-label",children:"Type :"}),t.jsxs("span",{className:"ai-generator__recap-value",children:[x&&Ka[x]," ",x&&pr[x]]})]}),t.jsxs("div",{className:"ai-generator__options",children:[t.jsxs("div",{className:"ai-generator__field",children:[t.jsx("label",{className:"ai-generator__label",children:"Niveau de difficult"}),t.jsx("div",{className:"ai-generator__radio-group",children:["facile","moyen","difficile"].map(ee=>t.jsxs("label",{className:"ai-generator__radio",children:[t.jsx("input",{type:"radio",name:"difficulte",value:ee,checked:_.difficulte===ee,onChange:()=>C(Pe=>({...Pe,difficulte:ee}))}),t.jsxs("span",{className:"ai-generator__radio-label",children:[ee==="facile"&&" Facile",ee==="moyen"&&" Moyen",ee==="difficile"&&" Difficile"]})]},ee))})]}),x==="sujet_examen"&&t.jsxs("div",{className:"ai-generator__field",children:[t.jsx("label",{className:"ai-generator__label",children:"Type d'examen"}),t.jsx("div",{className:"ai-generator__radio-group",children:["BFEM","BAC"].map(ee=>t.jsxs("label",{className:"ai-generator__radio",children:[t.jsx("input",{type:"radio",name:"typeExamen",value:ee,checked:_.typeExamen===ee,onChange:()=>C(Pe=>({...Pe,typeExamen:ee}))}),t.jsx("span",{className:"ai-generator__radio-label",children:ee})]},ee))})]}),t.jsxs("div",{className:"ai-generator__field",children:[t.jsx("label",{htmlFor:"objectifs",className:"ai-generator__label",children:"Objectifs pdagogiques (optionnel)"}),t.jsx("textarea",{id:"objectifs",className:"ai-generator__textarea",rows:3,placeholder:"Ex: L'lve doit tre capable de rsoudre une quation du 1er degr...",value:_.objectifs||"",onChange:ee=>C(Pe=>({...Pe,objectifs:ee.target.value||void 0}))})]}),t.jsxs("div",{className:"ai-generator__field",children:[t.jsx("label",{htmlFor:"consignes",className:"ai-generator__label",children:"Consignes spciales (optionnel)"}),t.jsx("textarea",{id:"consignes",className:"ai-generator__textarea",rows:2,placeholder:"Ex: Inclure un exercice sur les statistiques, utiliser des exemples avec le football...",value:_.consignesSpeciales||"",onChange:ee=>C(Pe=>({...Pe,consignesSpeciales:ee.target.value||void 0}))})]})]}),t.jsxs("div",{className:"ai-generator__nav",children:[t.jsx("button",{className:"btn btn--outline",onClick:et,children:" Retour"}),t.jsx("button",{className:"btn btn--primary btn--lg",onClick:jr,disabled:w,children:w?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner spinner--sm"}),"Gnration en cours..."]}):" Gnrer le contenu"})]}),w&&t.jsxs("div",{className:"ai-generator__generating",children:[t.jsxs("div",{className:"ai-generator__generating-animation",children:[t.jsx("span",{children:""}),t.jsx("span",{children:""}),t.jsx("span",{children:""})]}),t.jsxs("p",{children:["L'IA rdige votre"," ",x&&pr[x].toLowerCase(),"..."]}),t.jsx("p",{className:"ai-generator__generating-hint",children:"Cela peut prendre 15  30 secondes."})]})]}),r===5&&S&&t.jsxs("div",{className:"ai-generator__step-content",children:[t.jsx("h2",{className:"ai-generator__step-title",children:" Contenu gnr"}),t.jsxs("div",{className:"ai-generator__recap ai-generator__recap--success",children:[t.jsx("span",{className:"ai-generator__recap-label",children:"Type :"}),t.jsxs("span",{className:"ai-generator__recap-value",children:[x&&Ka[x]," ",x&&pr[x]]}),t.jsx("span",{className:"ai-generator__recap-label",children:"Discipline :"}),t.jsx("span",{className:"ai-generator__recap-value",children:o?.nom}),t.jsx("span",{className:"ai-generator__recap-label",children:"Classe :"}),t.jsx("span",{className:"ai-generator__recap-value",children:d}),t.jsx("span",{className:"ai-generator__recap-label",children:"Dure :"}),t.jsxs("span",{className:"ai-generator__recap-value",children:[p," minutes"]}),t.jsx("span",{className:"ai-generator__recap-label",children:"Chapitre :"}),t.jsx("span",{className:"ai-generator__recap-value",children:v})]}),t.jsxs("div",{className:"ai-generator__preview",children:[t.jsxs("div",{className:"ai-generator__preview-header",children:[t.jsx("h3",{children:"Prvisualisation"}),t.jsxs("div",{className:"ai-generator__preview-actions",children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>{const ee=S.type==="quiz"?JSON.stringify(S.data.questions,null,2):S.data.content||"";navigator.clipboard.writeText(ee),alert("Contenu copi dans le presse-papier !")},children:" Copier"}),S.type!=="quiz"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Re(S.data.content||"",`${pr[x]}  ${o?.nom} ${d}`),title:"Tlcharger en PDF (via impression)",children:" PDF"}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>ze(S.data.content||"",`${pr[x]}  ${o?.nom} ${d}`),title:"Tlcharger en Word (.doc)",children:" Word"})]})]})]}),t.jsx("div",{className:"ai-generator__preview-body",children:S.type==="quiz"&&S.data.questions?t.jsxs("div",{className:"ai-generator__quiz-preview",children:[t.jsxs("p",{className:"ai-generator__quiz-count",children:[S.data.questions.length," questions gnres"]}),S.data.questions.map((ee,Pe)=>t.jsxs("div",{className:"ai-generator__quiz-item",children:[t.jsxs("div",{className:"ai-generator__quiz-question",children:[t.jsxs("strong",{children:["Q",Pe+1,"."]})," ",ee.question,t.jsx("span",{className:`ai-generator__quiz-badge ai-generator__quiz-badge--${ee.difficulte}`,children:ee.difficulte})]}),t.jsx("div",{className:"ai-generator__quiz-options",children:ee.options.map((ct,J)=>t.jsxs("div",{className:`ai-generator__quiz-option ${J===ee.reponseCorrecte?"ai-generator__quiz-option--correct":""}`,children:[t.jsx("span",{className:"ai-generator__quiz-option-letter",children:String.fromCharCode(65+J)}),ct,J===ee.reponseCorrecte&&" "]},J))}),ee.explication&&t.jsxs("div",{className:"ai-generator__quiz-explanation",children:[" ",ee.explication]})]},Pe))]}):t.jsx("div",{className:"ai-generator__markdown-preview",dangerouslySetInnerHTML:{__html:Gr(S.data.content||"")}})})]}),t.jsxs("div",{className:"ai-generator__actions",children:[B?t.jsxs("div",{className:"ai-generator__save-success",children:[t.jsx("span",{children:" Sauvegard avec succs !"}),S.type==="quiz"&&$&&t.jsx(Le,{to:`/quiz/${$}`,className:"btn btn--outline btn--sm",children:" Voir le quiz"})]}):t.jsx("button",{className:"btn btn--primary btn--lg",onClick:Mr,disabled:P,children:P?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"spinner spinner--sm"}),"Sauvegarde..."]}):t.jsx(t.Fragment,{children:" Sauvegarder dans PedaClic"})}),t.jsx("button",{className:"btn btn--outline",onClick:it,children:" Nouvelle gnration"})]})]})]}),X&&t.jsx("div",{className:"ai-generator__modal-overlay",onClick:()=>L(null),children:t.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:ee=>ee.stopPropagation(),children:[t.jsxs("div",{className:"ai-generator__modal-header",children:[t.jsxs("div",{className:"ai-generator__modal-title-block",children:[t.jsxs("h2",{children:[Ka[X.type]," ",pr[X.type]]}),t.jsxs("span",{className:"ai-generator__modal-subtitle",children:[X.discipline," (",X.classe,")  ",X.chapitre]})]}),t.jsxs("div",{className:"ai-generator__modal-header-actions",children:[X.type!=="quiz_auto"&&X.content&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Re(X.content,`${pr[X.type]}  ${X.discipline} ${X.classe}`),title:"Enregistrer en PDF",children:" PDF"}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>ze(X.content,`${pr[X.type]}  ${X.discipline} ${X.classe}`),title:"Tlcharger en Word",children:" Word"})]}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:async()=>{L(null),await cr()},title:"Retour  l'historique",children:" Historique"}),t.jsx("button",{className:"ai-generator__modal-close",onClick:()=>L(null),children:""})]})]}),t.jsx("div",{className:"ai-generator__modal-body",children:t.jsx("div",{className:"ai-generator__markdown-preview",dangerouslySetInnerHTML:{__html:Gr(X.content||"")}})})]})}),ne&&t.jsx(Ste,{userId:e.uid,history:M,markdownToHtml:Gr,onClose:()=>K(!1),onSaved:async()=>{const ee=await fA(e.uid);H(ee)}}),oe&&t.jsx("div",{className:"ai-generator__modal-overlay",onClick:()=>xe(!1),children:t.jsxs("div",{className:"ai-generator__modal ai-generator__modal--wide",onClick:ee=>ee.stopPropagation(),children:[t.jsxs("div",{className:"ai-generator__modal-header",children:[t.jsx("h2",{children:" Mes Ebooks compils"}),t.jsxs("div",{className:"ai-generator__modal-header-actions",children:[t.jsx("button",{className:"btn btn--primary btn--sm",onClick:()=>{xe(!1),K(!0)},children:"+ Nouvel ebook"}),t.jsx("button",{className:"ai-generator__modal-close",onClick:()=>xe(!1),children:""})]})]}),t.jsx("div",{className:"ai-generator__modal-body",children:ve.length===0?t.jsx("p",{className:"ai-generator__empty",children:`Vous n'avez pas encore compil d'ebook. Cliquez sur "Compiler un Ebook" pour commencer.`}):t.jsx("div",{className:"ebook-compiler__my-list",children:ve.map(ee=>t.jsxs("div",{className:"ebook-compiler__my-item",children:[t.jsx("div",{className:"ebook-compiler__my-cover",children:""}),t.jsxs("div",{className:"ebook-compiler__my-info",children:[t.jsx("div",{className:"ebook-compiler__my-title",children:ee.titre}),ee.description&&t.jsx("div",{className:"ebook-compiler__my-desc",children:ee.description}),t.jsxs("div",{className:"ebook-compiler__my-meta",children:[ee.sections.length," chapitre",ee.sections.length>1?"s":""," "," ",ee.createdAt?.toDate?ee.createdAt.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}):""]})]}),t.jsxs("div",{className:"ai-generator__history-actions",children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>nr(ee),title:"Lire l'ebook",children:" Lire"}),t.jsx("button",{className:"btn btn--danger btn--sm",onClick:()=>ee.id&&It(ee.id),title:"Supprimer",children:""})]})]},ee.id))})})]})}),Y&&t.jsx("div",{className:"ai-generator__modal-overlay",onClick:()=>ae(!1),children:t.jsxs("div",{className:"ai-generator__modal",onClick:ee=>ee.stopPropagation(),children:[t.jsxs("div",{className:"ai-generator__modal-header",children:[t.jsx("h2",{children:" Historique des gnrations"}),t.jsx("button",{className:"ai-generator__modal-close",onClick:()=>ae(!1),children:""})]}),t.jsx("div",{className:"ai-generator__modal-body",children:M.length===0?t.jsx("p",{className:"ai-generator__empty",children:"Aucun contenu gnr pour le moment."}):t.jsx("div",{className:"ai-generator__history-list",children:M.map(ee=>t.jsxs("div",{className:"ai-generator__history-item",children:[t.jsxs("div",{className:"ai-generator__history-info",children:[t.jsxs("span",{className:"ai-generator__history-type",children:[Ka[ee.type]," ",pr[ee.type]]}),t.jsxs("span",{className:"ai-generator__history-details",children:[ee.discipline," (",ee.classe,")  ",ee.chapitre]}),t.jsx("span",{className:"ai-generator__history-date",children:ee.createdAt?.toDate?ee.createdAt.toDate().toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Date inconnue"})]}),t.jsxs("div",{className:"ai-generator__history-actions",children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>{L(ee),ae(!1)},title:"Lire le contenu",children:" Lire"}),ee.type!=="quiz_auto"&&ee.content&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>Re(ee.content,`${pr[ee.type]}  ${ee.discipline} ${ee.classe}`),title:"PDF",children:""}),t.jsx("button",{className:"btn btn--outline btn--sm",onClick:()=>ze(ee.content,`${pr[ee.type]}  ${ee.discipline} ${ee.classe}`),title:"Word",children:""})]}),t.jsx("button",{className:"btn btn--danger btn--sm",onClick:()=>ee.id&&Qe(ee.id),title:"Supprimer",children:""})]})]},ee.id))})})]})})]}):t.jsx("div",{className:"ai-generator",children:t.jsxs("div",{className:"ai-generator__gate",children:[t.jsx("div",{className:"ai-generator__gate-icon",children:""}),t.jsx("h2",{children:"Fonctionnalit Premium"}),t.jsx("p",{children:"Le gnrateur de contenu IA est rserv aux abonns Premium. Gnrez des cours, des exercices, des quiz et des sujets d'examen adapts au programme sngalais en un clic !"}),t.jsxs("div",{className:"ai-generator__gate-price",children:[t.jsx("span",{className:"price",children:"2 000 FCFA"}),t.jsx("span",{className:"period",children:"/mois"})]}),t.jsx(Le,{to:"/premium",className:"btn btn--primary btn--lg",children:"Devenir Premium"})]})}):t.jsx("div",{className:"ai-generator",children:t.jsxs("div",{className:"ai-generator__gate",children:[t.jsx("div",{className:"ai-generator__gate-icon",children:""}),t.jsx("h2",{children:"Connexion requise"}),t.jsx("p",{children:"Vous devez tre connect pour accder au gnrateur de contenu IA."}),t.jsx(Le,{to:"/connexion",className:"btn btn--primary",children:"Se connecter"})]})})},Ate=()=>{const[e,r]=g.useState(null),[n,a]=g.useState(!1),[l,o]=g.useState(!1),[u,d]=g.useState(!1),f=()=>/iPhone|iPad|iPod/.test(navigator.userAgent)&&!window.MSStream,p=()=>window.matchMedia("(display-mode: standalone)").matches||navigator.standalone===!0,h=g.useCallback(()=>{try{return parseInt(localStorage.getItem("pedaclic_visit_count")||"0",10)}catch{return 0}},[]),v=g.useCallback(()=>{try{const _=h()+1;localStorage.setItem("pedaclic_visit_count",_.toString())}catch{}},[h]),b=()=>{try{const _=localStorage.getItem("pedaclic_install_dismissed_at");if(!_)return!1;const C=720*60*60*1e3;return Date.now()-parseInt(_,10)<C}catch{return!1}};g.useEffect(()=>{if(p()||b())return;v();const _=w=>{w.preventDefault(),r(w),h()>=1&&a(!0)};window.addEventListener("beforeinstallprompt",_),f()&&h()>=1&&(o(!0),a(!0));const C=()=>{a(!1),r(null)};return window.addEventListener("appinstalled",C),()=>{window.removeEventListener("beforeinstallprompt",_),window.removeEventListener("appinstalled",C)}},[h,v]);const x=async()=>{if(e){d(!0);try{await e.prompt();const{outcome:_}=await e.userChoice;_==="accepted"&&a(!1)}catch(_){console.error("Erreur installation PWA:",_)}finally{d(!1),r(null)}}},j=()=>{a(!1);try{localStorage.setItem("pedaclic_install_dismissed_at",Date.now().toString()),localStorage.removeItem("pedaclic_install_dismissed")}catch{}};return n?t.jsx("div",{className:"install-prompt",children:t.jsxs("div",{className:"install-prompt__container",children:[t.jsxs("div",{className:"install-prompt__content",children:[t.jsx("div",{className:"install-prompt__icon",children:t.jsx(vA,{size:24})}),t.jsxs("div",{className:"install-prompt__text",children:[t.jsx("h3",{className:"install-prompt__title",children:"Installer PedaClic"}),t.jsx("p",{className:"install-prompt__description",children:l?"Accde  tes cours mme sans connexion !":"Installe l'app pour un accs rapide, mme hors-ligne !"})]})]}),t.jsxs("div",{className:"install-prompt__actions",children:[!l&&e&&t.jsx("button",{className:"install-prompt__btn install-prompt__btn--primary",onClick:x,disabled:u,children:u?"Installation...":"Installer"}),l&&t.jsx("div",{className:"install-prompt__ios",children:t.jsxs("p",{className:"install-prompt__ios-text",children:["Appuie sur ",t.jsx(P3,{size:16,className:"install-prompt__ios-icon"})," puis",t.jsxs("span",{className:"install-prompt__ios-highlight",children:[t.jsx(Dc,{size:14})," Sur l'cran d'accueil"]})]})}),t.jsx("button",{className:"install-prompt__btn install-prompt__btn--close",onClick:j,"aria-label":"Fermer la bannire d'installation",children:t.jsx(Ki,{size:20})})]})]})}):null};function zte(){const[e,r]=g.useState(typeof navigator<"u"?navigator.onLine:!0);return g.useEffect(()=>{const n=()=>r(!0),a=()=>r(!1);return window.addEventListener("online",n),window.addEventListener("offline",a),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",a)}},[]),e}const kte=()=>{const e=zte(),[r,n]=g.useState(!1),[a,l]=g.useState(!1);return g.useEffect(()=>{if(!e)l(!0),n(!1);else if(a){n(!0);const o=setTimeout(()=>{n(!1),l(!1)},3e3);return()=>clearTimeout(o)}},[e,a]),e&&!r?null:t.jsx("div",{className:`network-indicator ${e?"network-indicator--online":"network-indicator--offline"}`,children:t.jsx("div",{className:"network-indicator__content",children:e?t.jsxs(t.Fragment,{children:[t.jsx(M3,{size:14}),t.jsx("span",{children:"Connexion rtablie"})]}):t.jsxs(t.Fragment,{children:[t.jsx(T3,{size:14}),t.jsx("span",{children:"Pas de connexion  mode hors-ligne"})]})})})},Ote=()=>(g.useEffect(()=>{rA();const e=setInterval(rA,600*1e3);return()=>clearInterval(e)},[]),t.jsxs(V3,{children:[t.jsx(Ate,{}),t.jsx(kte,{}),t.jsxs(Fq,{children:[t.jsx(Ie,{path:"/",element:t.jsx(lt,{children:t.jsx(o5,{})})}),t.jsx(Ie,{path:"/disciplines",element:t.jsx(lt,{children:t.jsx(c5,{})})}),t.jsx(Ie,{path:"/disciplines/:id",element:t.jsx(lt,{children:t.jsx(p5,{})})}),t.jsx(Ie,{path:"/quiz-gratuits",element:t.jsx(lt,{children:t.jsx(r6,{})})}),t.jsx(Ie,{path:"/ebooks",element:t.jsx(lt,{children:t.jsx(Kee,{})})}),t.jsx(Ie,{path:"/mediatheque",element:t.jsx(lt,{children:t.jsx(cte,{})})}),t.jsx(Ie,{path:"/mediatheque/ajouter",element:t.jsx(Fi,{allowedRoles:["admin","prof"],children:t.jsx(lt,{children:t.jsx(vte,{})})})}),t.jsx(Ie,{path:"/mediatheque/:mediaId/modifier",element:t.jsx(Fi,{allowedRoles:["admin","prof"],children:t.jsx(lt,{children:t.jsx(gte,{})})})}),t.jsx(Ie,{path:"/mediatheque/:mediaId",element:t.jsx(lt,{children:t.jsx(pte,{})})}),t.jsx(Ie,{path:"/cours",element:t.jsx(lt,{children:t.jsx(pee,{})})}),t.jsx(Ie,{path:"/cours/:coursId",element:t.jsx(lt,{children:t.jsx(Eee,{})})}),t.jsx(Ie,{path:"/connexion",element:t.jsx(h5,{})}),t.jsx(Ie,{path:"/inscription",element:t.jsx(v5,{})}),t.jsx(Ie,{path:"/mot-de-passe-oublie",element:t.jsx(g5,{})}),t.jsx(Ie,{path:"/premium/confirmation",element:t.jsx(Q5,{})}),t.jsx(Ie,{path:"/premium/mes-cours",element:t.jsx(lt,{children:t.jsx(V5,{})})}),t.jsx(Ie,{path:"/premium",element:t.jsx(lt,{children:t.jsx(S5,{})})}),t.jsx(Ie,{path:"/quizzes",element:t.jsx(Fi,{allowedRoles:["eleve","prof","admin"],children:t.jsx(lt,{children:t.jsx(VR,{})})})}),t.jsx(Ie,{path:"/quiz/:quizId",element:t.jsx(lt,{children:t.jsx(v6,{})})}),t.jsx(Ie,{path:"/quiz-avance/:quizId",element:t.jsx(lt,{children:t.jsx(FR,{})})}),t.jsx(Ie,{path:"/generateur",element:t.jsx(lt,{children:t.jsx(Ete,{})})}),t.jsx(Ie,{path:"/eleve/dashboard",element:t.jsx(lt,{children:t.jsx(DZ,{})})}),t.jsx(Ie,{path:"/eleve/suivi",element:t.jsx(lt,{children:t.jsx(PZ,{})})}),t.jsx(Ie,{path:"/eleve/cahiers/:cahierId",element:t.jsx(Fi,{allowedRoles:["eleve","admin"],children:t.jsx(lt,{children:t.jsx(LJ,{})})})}),t.jsx(Ie,{path:"/parent/dashboard",element:t.jsx(Fi,{allowedRoles:["parent","admin"],children:t.jsx(lt,{children:t.jsx(jte,{})})})}),t.jsx(Ie,{path:"/prof/dashboard",element:t.jsx(Kn,{children:t.jsx(lt,{children:t.jsx(RZ,{})})})}),t.jsx(Ie,{path:"/prof/cahiers",element:t.jsx(Kn,{children:t.jsx(lt,{children:t.jsx(nJ,{})})})}),t.jsx(Ie,{path:"/prof/cahiers/:cahierId",element:t.jsx(Kn,{children:t.jsx(lt,{children:t.jsx(hJ,{})})})}),t.jsx(Ie,{path:"/prof/cahiers/:cahierId/nouvelle",element:t.jsx(Kn,{children:t.jsx(lt,{children:t.jsx(nA,{})})})}),t.jsx(Ie,{path:"/prof/cahiers/:cahierId/modifier/:entreeId",element:t.jsx(Kn,{children:t.jsx(lt,{children:t.jsx(nA,{})})})}),t.jsx(Ie,{path:"/prof/sequences",element:t.jsx(Kn,{children:t.jsx(lt,{children:t.jsx(XJ,{})})})}),t.jsx(Ie,{path:"/prof/sequences/nouvelle",element:t.jsx(Kn,{children:t.jsx(lt,{children:t.jsx(aA,{})})})}),t.jsx(Ie,{path:"/prof/sequences/:id",element:t.jsx(Kn,{children:t.jsx(lt,{children:t.jsx(dee,{})})})}),t.jsx(Ie,{path:"/prof/sequences/:id/modifier",element:t.jsx(Kn,{children:t.jsx(lt,{children:t.jsx(aA,{})})})}),t.jsx(Ie,{path:"/prof/cours",element:t.jsx(Kn,{children:t.jsx(lt,{children:t.jsx(Mee,{})})})}),t.jsx(Ie,{path:"/prof/cours/nouveau",element:t.jsx(qr,{children:t.jsx(lt,{children:t.jsx(sA,{})})})}),t.jsx(Ie,{path:"/prof/cours/:coursId/modifier",element:t.jsx(qr,{children:t.jsx(lt,{children:t.jsx(sA,{})})})}),t.jsx(Ie,{path:"/admin",element:t.jsx(qr,{children:t.jsx(mn,{children:t.jsx(W5,{})})})}),t.jsx(Ie,{path:"/admin/disciplines",element:t.jsx(qr,{children:t.jsx(mn,{children:t.jsx(X5,{})})})}),t.jsx(Ie,{path:"/admin/chapitres",element:t.jsx(qr,{children:t.jsx(mn,{children:t.jsx(Z5,{})})})}),t.jsx(Ie,{path:"/admin/ressources",element:t.jsx(qr,{children:t.jsx(mn,{children:t.jsx(J5,{})})})}),t.jsx(Ie,{path:"/admin/quiz",element:t.jsx(qr,{children:t.jsx(mn,{children:t.jsx(iR,{})})})}),t.jsx(Ie,{path:"/admin/quiz/nouveau",element:t.jsx(qr,{children:t.jsx(mn,{children:t.jsx(V1,{})})})}),t.jsx(Ie,{path:"/admin/quiz/modifier/:quizId",element:t.jsx(qr,{children:t.jsx(mn,{children:t.jsx(V1,{})})})}),t.jsx(Ie,{path:"/admin/quiz-avance",element:t.jsx(qr,{children:t.jsx(mn,{children:t.jsx(qR,{})})})}),t.jsx(Ie,{path:"/admin/utilisateurs",element:t.jsx(qr,{children:t.jsx(mn,{children:t.jsx(fR,{})})})}),t.jsx(Ie,{path:"/admin/resultats",element:t.jsx(qr,{children:t.jsx(mn,{children:t.jsx(pR,{})})})}),t.jsx(Ie,{path:"/admin/settings",element:t.jsx(qr,{children:t.jsx(mn,{children:t.jsx(hR,{})})})}),t.jsx(Ie,{path:"/admin/ebooks",element:t.jsx(qr,{children:t.jsx(mn,{children:t.jsx(Wee,{})})})}),t.jsx(Ie,{path:"/admin/premium",element:t.jsx(Ld,{to:"/admin/utilisateurs?filter=premium",replace:!0})}),t.jsx(Ie,{path:"/notifications",element:t.jsx(Fi,{allowedRoles:["eleve","prof","admin","parent"],children:t.jsx(lt,{children:t.jsx(yte,{})})})}),t.jsx(Ie,{path:"/prof/notifications/nouvelle",element:t.jsx(Kn,{children:t.jsx(lt,{children:t.jsx(mA,{})})})}),t.jsx(Ie,{path:"/admin/notifications/nouvelle",element:t.jsx(qr,{children:t.jsx(mn,{children:t.jsx(mA,{})})})}),t.jsx(Ie,{path:"/cahiers",element:t.jsx(Ld,{to:"/prof/cahiers",replace:!0})}),t.jsx(Ie,{path:"/sequences",element:t.jsx(Ld,{to:"/prof/sequences",replace:!0})}),t.jsx(Ie,{path:"*",element:t.jsx(Ld,{to:"/",replace:!0})})]})]})),zM=document.getElementById("root");if(!zM)throw new Error("L'lment #root n'existe pas");const Dte=F3.createRoot(zM);Dte.render(t.jsx(Gq.StrictMode,{children:t.jsx(Hq,{children:t.jsx(Ote,{})})}));
//# sourceMappingURL=index-Dh6LFyGF.js.map
